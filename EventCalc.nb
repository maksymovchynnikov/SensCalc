(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    148664,       3641]
NotebookOptionsPosition[    143118,       3527]
NotebookOutlinePosition[    143597,       3545]
CellTagsIndexPosition[    143554,       3542]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[""], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.93551631404766*^9, 3.9355163583921595`*^9}, 
   3.9355890890523853`*^9, {3.935589535604183*^9, 3.9355895360428143`*^9}, 
   3.94267541335264*^9},
 CellLabel->
  "In[134]:=",ExpressionUUID->"e48741f4-d7ea-4a1f-aeca-cc471a20eaa8"],

Cell[CellGroupData[{

Cell["Primary definitions", "Chapter",
 CellChangeTimes->{{3.9261322591017113`*^9, 
  3.9261322718931*^9}},ExpressionUUID->"309ca6dc-5dcd-4fac-bc36-d4ca34b042f1"],

Cell[CellGroupData[{

Cell["Restarting kernels", "Section",
 CellChangeTimes->{{3.952750857536848*^9, 
  3.952750860520462*^9}},ExpressionUUID->"b06f5bd6-0c91-9d43-bd67-\
f7554cbf5a90"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"inecessary", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ParallelEvaluate", "[", 
   RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CloseKernels", "[", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"LaunchKernels", "[", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"EventCalc", "=", "True"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$OutputSizeLimit", "=", "10000"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"<<", "FeynCalc`"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "indexenergy", ",", "indexmass", ",", "indexpx", ",", "indexpy", ",", 
       "indexpz", ",", "indexpm", ",", "indexc\[Theta]", ",", "indexpdec", ",",
        "indexxdec", ",", "indexydec", ",", "indexzdec", ",", "indexazacc"}], 
      "}"}], "=", 
     RowBox[{"Range", "[", 
      RowBox[{"1", ",", "12"}], "]"}]}], ";"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"inecessary", "=", 
   RowBox[{"{", "}"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellLabel->"In[2]:=",ExpressionUUID->"d1c265a8-6017-1641-acde-aba97604e0fe"]
}, Closed]],

Cell[CellGroupData[{

Cell["Launching baseline notebooks", "Section",
 CellChangeTimes->{{3.9527508718605957`*^9, 
  3.952750877208584*^9}},ExpressionUUID->"975d4b5b-fa34-304b-92d8-\
52ba48280626"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"DirectoryRoutinesEventCalc", "=", 
     RowBox[{"FileNameJoin", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"NotebookDirectory", "[", "]"}], 
        ",", "\"\<codes/EventCalc\>\""}], "}"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "indices", " ", "of", " ", "the", " ", "columns", " ", "corresponding", " ",
      "to", " ", "the", " ", "output", " ", "data", " ", "for", " ", 
     "decaying", " ", "LLPs"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "indexpx", ",", "indexpy", ",", "indexpz", ",", "indexenergy", ",", 
       "indexmass", ",", "indexc\[Theta]", ",", "indexptom", ",", "indexpdec",
        ",", "indexxdec", ",", "indexydec", ",", "indexzdec", ",", 
       "indexazacc", ",", "indexnprodtot", ",", "indexyield"}], "}"}], "=", 
     RowBox[{"Range", "[", 
      RowBox[{"1", ",", "14"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"valsComp", "=", 
     RowBox[{"Compile", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"data", ",", "_Real", ",", "1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "_Integer"}], "}"}]}], "}"}], ",", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Compile`GetElement", "[", 
           RowBox[{"data", ",", "i"}], "]"}], "\[Equal]", "0"}], ",", 
         RowBox[{"-", "90."}], ",", 
         RowBox[{"Log10", "[", 
          RowBox[{"Compile`GetElement", "[", 
           RowBox[{"data", ",", "i"}], "]"}], "]"}]}], "]"}], ",", 
       RowBox[{"CompilationTarget", "->", "\"\<C\>\""}], ",", 
       RowBox[{"RuntimeOptions", "->", "\"\<Speed\>\""}], ",", 
       RowBox[{"RuntimeAttributes", "->", 
        RowBox[{"{", "Listable", "}"}]}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"DataLogarithmiedComp", "=", 
     RowBox[{"Compile", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"data", ",", "_Real", ",", "1"}], "}"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Log", "[", 
          RowBox[{"Compile`GetElement", "[", 
           RowBox[{"data", ",", "1"}], "]"}], "]"}], ",", 
         RowBox[{"Log", "[", 
          RowBox[{"Compile`GetElement", "[", 
           RowBox[{"data", ",", "2"}], "]"}], "]"}], ",", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Compile`GetElement", "[", 
             RowBox[{"data", ",", "3"}], "]"}], "\[Equal]", "0"}], ",", 
           RowBox[{"Log", "[", 
            SuperscriptBox["10", 
             RowBox[{"-", "90."}]], "]"}], ",", 
           RowBox[{"Log", "[", 
            RowBox[{"Compile`GetElement", "[", 
             RowBox[{"data", ",", "3"}], "]"}], "]"}]}], "]"}]}], "}"}], ",", 
       RowBox[{"CompilationTarget", "\[Rule]", "\"\<MVM\>\""}], ",", 
       RowBox[{"RuntimeOptions", "\[Rule]", "\"\<Speed\>\""}], ",", 
       RowBox[{"RuntimeAttributes", "->", 
        RowBox[{"{", "Listable", "}"}]}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Length", "[", "inecessary", "]"}], "==", "0"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Block", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"Print", "=", "Identity"}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", "Definitions", "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"NotebookEvaluate", "[", 
          RowBox[{"FileNameJoin", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"DirectoryRoutinesEventCalc", "//", "ParentDirectory"}], 
             ",", "\"\<generic.nb\>\""}], "}"}], "]"}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", "Definitions", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"NotebookEvaluate", "[", 
          RowBox[{"FileNameJoin", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"DirectoryRoutinesEventCalc", "//", "ParentDirectory"}], 
             ",", "\"\<dialog-windows.nb\>\""}], "}"}], "]"}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{"Properties", " ", "of", " ", "SM", " ", "particles"}], 
          "*)"}], "\[IndentingNewLine]", 
         RowBox[{"NotebookEvaluate", "[", 
          RowBox[{"FileNameJoin", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"DirectoryRoutinesEventCalc", "//", "ParentDirectory"}], 
             ",", "\"\<SensCalc\>\"", ",", "\"\<SM particles.nb\>\""}], "}"}],
            "]"}], "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
          "Defining", " ", "the", " ", "implemented", " ", "experiments"}], 
          "*)"}], "\[IndentingNewLine]", 
         RowBox[{"NotebookEvaluate", "[", 
          RowBox[{"FileNameJoin", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"DirectoryRoutinesEventCalc", "//", "ParentDirectory"}], 
             ",", "\"\<experiments.nb\>\""}], "}"}], "]"}], "]"}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"inecessary", "=", 
       RowBox[{"{", 
        RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], ";"}]}], 
    "\[IndentingNewLine]", "]"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.9261332948829126`*^9, 3.9261332950858917`*^9}, {
   3.926133596136128*^9, 3.9261336288069053`*^9}, {3.9261337117958417`*^9, 
   3.9261337126866417`*^9}, {3.9261347017372847`*^9, 
   3.9261347025565386`*^9}, {3.926138127036932*^9, 3.9261381272496805`*^9}, {
   3.9261432358748007`*^9, 3.9261432661972666`*^9}, {3.9261432985805554`*^9, 
   3.9261433145297704`*^9}, {3.9261437631541753`*^9, 3.92614377401698*^9}, {
   3.928895749994609*^9, 3.9288957865751643`*^9}, {3.9288959317285075`*^9, 
   3.9288959331068316`*^9}, {3.929113589156104*^9, 3.929113592618227*^9}, {
   3.9292925429230485`*^9, 3.9292925571830063`*^9}, 3.9292927899867067`*^9, {
   3.9292932917127104`*^9, 3.929293294812845*^9}, {3.9292933857889514`*^9, 
   3.9292933888227434`*^9}, {3.93107154346705*^9, 3.931071547250351*^9}, {
   3.931249231849926*^9, 3.9312492321536016`*^9}, {3.931322725103999*^9, 
   3.9313227260649633`*^9}, {3.935508435959552*^9, 3.9355084385515347`*^9}, {
   3.9355163008979945`*^9, 3.935516323468027*^9}, {3.9355163555993032`*^9, 
   3.9355163561230526`*^9}, {3.9355164899218893`*^9, 3.935516491977979*^9}, {
   3.935516563385311*^9, 3.935516565581756*^9}, {3.935516716153146*^9, 
   3.935516716692788*^9}, {3.9355911580076485`*^9, 3.9355911582018967`*^9}, {
   3.9355938583316975`*^9, 3.935593858376093*^9}, {3.9421665491282215`*^9, 
   3.9421665684101963`*^9}, {3.9424726862047367`*^9, 3.942472686454693*^9}, {
   3.942675414661413*^9, 3.9426754153017864`*^9}, {3.952095429182003*^9, 
   3.9520954623857*^9}, {3.9520954924733105`*^9, 3.9520954979458313`*^9}, {
   3.952095593930889*^9, 3.9520955994258595`*^9}, {3.952097419457491*^9, 
   3.9520974218689804`*^9}, 3.952750882209276*^9},
 CellLabel->"In[11]:=",ExpressionUUID->"6b3da654-3646-40f6-9bdc-8840cd813b38"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Selecting experiment", "Chapter",
 CellChangeTimes->{{3.9288973237976465`*^9, 3.9288973273401184`*^9}, {
  3.9421692537443123`*^9, 
  3.9421692576125336`*^9}},ExpressionUUID->"05ff3def-5697-4842-a091-\
2dd9fc218e17"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SetDirectory", "[", 
   RowBox[{"NotebookDirectory", "[", "]"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DynamicModule", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"choice", "=", "None"}], ",", "options", ",", "rows", ",", 
      "cols", ",", "gridButtons", ",", "maxWidth", ",", "paneHeight"}], "}"}],
     ",", 
    RowBox[{
     RowBox[{"options", "=", "experimentlist"}], ";", 
     RowBox[{"(*", 
      RowBox[{
      "Replace", " ", "with", " ", "your", " ", "actual", " ", "list", " ", 
       "items"}], "*)"}], 
     RowBox[{"cols", "=", "3"}], ";", 
     RowBox[{"(*", 
      RowBox[{
      "Number", " ", "of", " ", "columns", " ", "in", " ", "the", " ", 
       "grid"}], "*)"}], 
     RowBox[{"rows", "=", 
      RowBox[{"Ceiling", "[", 
       RowBox[{
        RowBox[{"Length", "[", "options", "]"}], "/", "cols"}], "]"}]}], ";", 
     RowBox[{"(*", 
      RowBox[{"Number", " ", "of", " ", "rows"}], "*)"}], 
     RowBox[{"gridButtons", "=", 
      RowBox[{"Partition", "[", 
       RowBox[{
        RowBox[{"PadRight", "[", 
         RowBox[{"options", ",", 
          RowBox[{"rows", "*", "cols"}], ",", "\"\<\>\""}], "]"}], ",", 
        "cols"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "Estimate", " ", "the", " ", "width", " ", "of", " ", "the", " ", 
       "widest", " ", "button"}], "*)"}], 
     RowBox[{"maxWidth", "=", 
      RowBox[{
       RowBox[{"Max", "[", 
        RowBox[{"StringLength", "/@", 
         RowBox[{"ToString", "/@", "options"}]}], "]"}], "*", "5"}]}], ";", 
     RowBox[{"(*", 
      RowBox[{"Adjust", " ", "multiplier", " ", "as", " ", "needed"}], "*)"}], 
     RowBox[{"(*", 
      RowBox[{
      "Set", " ", "the", " ", "height", " ", "of", " ", "the", " ", "pane"}], 
      "*)"}], 
     RowBox[{"paneHeight", "=", "300"}], ";", 
     RowBox[{"(*", 
      RowBox[{
      "Adjust", " ", "this", " ", "value", " ", "based", " ", "on", " ", 
       "desired", " ", "height"}], "*)"}], 
     RowBox[{"GivenExperiment", "=", 
      RowBox[{"DialogInput", "[", 
       RowBox[{"Column", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"TextCell", "[", "\"\<Choose the experiment:\>\"", "]"}], ",", 
          RowBox[{"Pane", "[", 
           RowBox[{
            RowBox[{"Dynamic", "@", 
             RowBox[{"Grid", "[", 
              RowBox[{
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"With", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"opt", "=", 
                    RowBox[{"gridButtons", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}]}], "}"}], ",", 
                   RowBox[{"Button", "[", 
                    RowBox[{"opt", ",", 
                    RowBox[{"choice", "=", "opt"}], ",", 
                    RowBox[{"Background", "->", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"choice", "===", "opt"}], ",", "LightBlue", ",", 
                    "None"}], "]"}]}], ",", 
                    RowBox[{"ImageSize", "->", 
                    RowBox[{"{", 
                    RowBox[{"maxWidth", ",", "Automatic"}], "}"}]}]}], " ", 
                    RowBox[{"(*", 
                    RowBox[{"Set", " ", "width", " ", "to", " ", "maxWidth"}],
                     "*)"}], "]"}]}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"i", ",", "rows"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"j", ",", "cols"}], "}"}]}], "]"}], ",", 
               RowBox[{"Spacings", "->", 
                RowBox[{"{", 
                 RowBox[{"2", ",", "2"}], "}"}]}]}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"Automatic", ",", "paneHeight"}], "}"}], ",", 
            RowBox[{"Scrollbars", "->", 
             RowBox[{"{", 
              RowBox[{"False", ",", "True"}], "}"}]}]}], "]"}], ",", 
          RowBox[{"Button", "[", 
           RowBox[{"\"\<OK\>\"", ",", 
            RowBox[{"DialogReturn", "[", "choice", "]"}], ",", 
            RowBox[{"ImageSize", "->", "Automatic"}]}], "]"}]}], "}"}], "]"}],
        "]"}]}]}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"GivenExperiment", "==", "exp"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"width", "=", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"MemberQ", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"\"\<LHCb-downstream\>\"", ",", "\"\<DarkQuest\>\""}], 
             "}"}], ",", "exp"}], "]"}], ",", "170", ",", "100"}], "]"}]}], ";",
        "\[IndentingNewLine]", 
       RowBox[{"GivenExperiment", "=", 
        RowBox[{"selectionDialogExplanationOneOption", "[", 
         RowBox[{
          RowBox[{"SetupsOptions", "[", "exp", "]"}], ",", 
          RowBox[{"SetupsDescription", "[", "exp", "]"}], ",", 
          
          RowBox[{"\"\<Select the \>\"", "<>", "exp", 
           "<>", "\"\< setup:\>\""}], ",", "width"}], "]"}]}], ";"}]}], 
     "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", ",", 
   RowBox[{"{", 
    RowBox[{"exp", ",", "multiplesetups"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"MemberQ", "[", 
     RowBox[{"explistanub", ",", "GivenExperiment"}], "]"}], "==", "True"}], ",",
    "\[IndentingNewLine]", 
   RowBox[{
   "infoDialog", 
    "[", "\"\<One of the decay volumes of ANUBIS-shaft has been selected. The \
full sensitivity requires calculating the acceptances for all the three \
volumes. You need to generate them afterwards\>\"", "]"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DecayVolumeExperiment", "=", 
   RowBox[{"DecayVolumeGeometry", "[", "GivenExperiment", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"plotExperiment", "=", 
   RowBox[{"BoundaryMeshRegion", "[", 
    RowBox[{"DecayVolumeExperiment", ",", 
     RowBox[{"MeshCellStyle", "->", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"1", "->", 
         RowBox[{"Directive", "[", 
          RowBox[{"Thick", ",", "Black"}], "]"}]}], ",", 
        RowBox[{"2", "->", 
         RowBox[{"Directive", "[", 
          RowBox[{
           RowBox[{"Opacity", "[", "0.1", "]"}], ",", 
           RowBox[{
            RowBox[{"Interpreter", "[", "\"\<Color\>\"", "]"}], 
            "[", "\"\<aqua\>\"", "]"}]}], "]"}]}]}], "}"}]}], ",", 
     RowBox[{"BoxRatios", "->", 
      RowBox[{"{", 
       RowBox[{"1", ",", "1", ",", "1"}], "}"}]}], ",", 
     RowBox[{"Boxed", "->", "True"}], ",", 
     RowBox[{"Axes", "->", "True"}], ",", 
     RowBox[{"AxesStyle", "->", 
      RowBox[{"Directive", "[", 
       RowBox[{"Thick", ",", "Black"}], "]"}]}], ",", 
     RowBox[{"(*", 
      RowBox[{"Makes", " ", "the", " ", "axes", " ", "thicker"}], "*)"}], 
     RowBox[{"LabelStyle", "->", 
      RowBox[{"{", 
       RowBox[{"FontSize", "->", "20"}], "}"}]}], ",", 
     RowBox[{"(*", 
      RowBox[{
      "Increases", " ", "the", " ", "font", " ", "size", " ", "of", " ", 
       "labels"}], "*)"}], 
     RowBox[{"AxesLabel", "->", 
      RowBox[{"{", 
       RowBox[{"\"\<x [m]\>\"", ",", "\"\<y [m]\>\"", ",", "\"\<z [m]\>\""}], 
       "}"}]}]}], " ", 
    RowBox[{"(*", 
     RowBox[{"Adds", " ", "axes", " ", "labels"}], "*)"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"Row", "[", 
   RowBox[{"{", 
    RowBox[{"\"\<Selected experiment: \>\"", ",", "GivenExperiment"}], "}"}], 
   "]"}], "]"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.929093269216908*^9, 3.929093270244196*^9}, {
   3.929095906730321*^9, 3.9290959276825776`*^9}, {3.9291140912239227`*^9, 
   3.929114091924608*^9}, {3.931071864411477*^9, 3.9310718711717434`*^9}, {
   3.931074165558844*^9, 3.9310742138267765`*^9}, {3.931160093239794*^9, 
   3.93116009505394*^9}, {3.9421663499298134`*^9, 3.942166363809799*^9}, {
   3.9421664181568737`*^9, 3.942166455387575*^9}, {3.942166542638626*^9, 
   3.9421665429328136`*^9}, {3.9421665944009075`*^9, 
   3.9421666087235985`*^9}, {3.942168620065048*^9, 3.9421686358701687`*^9}, 
   3.942246959379347*^9, {3.9531750005179768`*^9, 
   3.9531750142998047`*^9}},ExpressionUUID->"3ff7e400-0b7d-4317-b982-\
2b96307f80cc"],

Cell[BoxData["plotExperiment"], "Input",
 CellLabel->
  "In[143]:=",ExpressionUUID->"22936e8a-adce-c046-891b-8abcd64da5c9"],

Cell[CellGroupData[{

Cell["Defining geometry", "Section",
 CellChangeTimes->{{3.942169271898529*^9, 
  3.9421692743767643`*^9}},ExpressionUUID->"fbf199d8-8255-a046-8485-\
515a118c9adf"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"FacilitySelected", "=", 
   RowBox[{"FacilityExperiment", "[", "GivenExperiment", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"IfCollider", "=", 
   RowBox[{"MemberQ", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\"\<LHC\>\"", ",", "\"\<FCC-hh\>\""}], "}"}], ",", 
     "FacilitySelected"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"EmaxGivenExperiment", "=", 
   RowBox[{"EmaxFacility", "[", "FacilitySelected", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ECALoptionGivenExperiment", "=", 
   RowBox[{"ECALoptionExperiment", "[", "GivenExperiment", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DipoleMagnetOptionGivenExperiment", "=", 
    RowBox[{"DipoleMagnetOptionExperiment", "[", "GivenExperiment", "]"}]}], 
   ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Decay", " ", "volume", " ", "as", " ", 
     RowBox[{"detector", ":", " ", "True"}]}], ",", " ", "False"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DecayVolumeAsDetectorGivenExperiment", "=", 
    RowBox[{
    "DecayVolumeAsDetectorExperiment", "[", "GivenExperiment", "]"}]}], ";"}],
   "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Default", " ", "list", " ", "of", " ", "detectable", " ", "decay", " ", 
    "products", " ", "at", " ", "the", " ", "given", " ", "experiment"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DetectablePDGsGivenExperiment", "=", 
    RowBox[{
     RowBox[{"DetectablePDGsExperiment", "[", "GivenExperiment", "]"}], "//", 
     "Sort"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "___", "___", "___", "___", "___", "___", "___", "___", "___", "___", 
    "___", "___", "___", "___", "___", "___", "___", "___", "___", "__"}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Box", ",", " ", "Cylinder", ",", " ", 
    RowBox[{"Annular", " ", "cylinder"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GeometryGivenExperiment", "=", 
    RowBox[{"GeometryExperiment", "[", "GivenExperiment", "]"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Beam", ",", " ", "Transverse"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DetectorPlaneOrientationGivenExperiment", "=", 
    RowBox[{
    "DetectorPlaneOrientationExperiment", "[", "GivenExperiment", "]"}]}], 
   ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Decay", " ", "volume", " ", "parameters"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"xToDecayVolumeCenterGivenExperiment", "[", "z_", "]"}], "=", 
   RowBox[{"xToDecayVolumeCenterExperiment", "[", 
    RowBox[{"z", ",", "GivenExperiment"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"yToDecayVolumeCenterGivenExperiment", "[", "z_", "]"}], "=", 
   RowBox[{"yToDecayVolumeCenterExperiment", "[", 
    RowBox[{"z", ",", "GivenExperiment"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dxDecayVolumeGivenExperiment", "[", "z_", "]"}], "=", 
   RowBox[{"dxDecayVolumeExperiment", "[", 
    RowBox[{"z", ",", "GivenExperiment"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dyDecayVolumeGivenExperiment", "[", "z_", "]"}], "=", 
   RowBox[{"dyDecayVolumeExperiment", "[", 
    RowBox[{"z", ",", "GivenExperiment"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"zDecVolMin", "=", 
   RowBox[{
    RowBox[{"zToDecayVolumeExperiment", "[", "GivenExperiment", "]"}], "//", 
    "N"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dzFidGivenExperiment", "=", 
   RowBox[{"dzDecayVolumeExperiment", "[", "GivenExperiment", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"zDecVolMax", "=", 
   RowBox[{
    RowBox[{"zMaxDecayVolumeExperiment", "[", "GivenExperiment", "]"}], "//", 
    "N"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"xLongMaxDetectorGivenExperiment", "=", 
   RowBox[{"xLongMaxDetectorExperiment", "[", "GivenExperiment", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dxDecayVolumeGivenExperimentMax", "=", 
   RowBox[{"dxDecayVolumeGivenExperiment", "[", "zDecVolMax", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dyDecayVolumeGivenExperimentMax", "=", 
   RowBox[{"dyDecayVolumeGivenExperiment", "[", "zDecVolMax", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RinnerDecayVolumeGivenExperiment", "[", "z_", "]"}], "=", 
   RowBox[{"RinnerDecayVolumeExperiment", "[", 
    RowBox[{"GivenExperiment", ",", "z"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RouterDecayVolumeGivenExperiment", "[", "z_", "]"}], "=", 
   RowBox[{"RouterDecayVolumeExperiment", "[", 
    RowBox[{"GivenExperiment", ",", "z"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DecayVolumeGeometryGivenExperiment", "=", 
    RowBox[{"DecayVolumeGeometry", "[", "GivenExperiment", "]"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Detector", " ", "parameters"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dxDetectorGivenExperiment", "[", "z_", "]"}], "=", 
   RowBox[{"dxDetectorExperiment", "[", 
    RowBox[{"GivenExperiment", ",", "z"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dyDetectorGivenExperiment", "[", "z_", "]"}], "=", 
   RowBox[{"dyDetectorExperiment", "[", 
    RowBox[{"GivenExperiment", ",", "z"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dzDetectorGivenExperiment", "=", 
   RowBox[{"dzDetectorExperiment", "[", "GivenExperiment", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dx2PerpDetectorGivenExperiment", "[", "z_", "]"}], "=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
     "DetectorPlaneOrientationGivenExperiment", 
      "\[Equal]", "\"\<Transverse\>\""}], ",", 
     RowBox[{"dyDetectorGivenExperiment", "[", "z", "]"}], ",", 
     "dzDetectorGivenExperiment"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "xToDetectorCenterGivenExperiment", ",", 
     "yToDetectorCenterGivenExperiment", ",", 
     "zToDetectorCenterGivenExperiment"}], "}"}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"Symbol", "[", 
         RowBox[{"#", "<>", "\"\<ToDetectorCenterExperiment\>\""}], "]"}], "[",
         "GivenExperiment", "]"}], "//", "N"}], ")"}], "&"}], "/@", 
    RowBox[{"{", 
     RowBox[{"\"\<x\>\"", ",", "\"\<y\>\"", ",", "\"\<z\>\""}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"x2PerpToDetectorCenterGivenExperiment", "=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
     "DetectorPlaneOrientationGivenExperiment", 
      "\[Equal]", "\"\<Transverse\>\""}], ",", 
     "yToDetectorCenterGivenExperiment", ",", 
     "zToDetectorCenterGivenExperiment"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"RinnerDetectorGivenExperiment", "[", "z_", "]"}], ",", 
      RowBox[{"RouterDetectorGivenExperiment", "[", "z_", "]"}]}], "}"}], "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"RinnerDetectorExperiment", "[", 
       RowBox[{"GivenExperiment", ",", "z"}], "]"}], ",", 
      RowBox[{"RouterDetectorExperiment", "[", 
       RowBox[{"GivenExperiment", ",", "z"}], "]"}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "___", "___", "___", "___", "___", "___", "___", "___", "___", "___", 
    "___", "___", "___", "___", "___", "___", "___", "_"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Given", " ", "experiment", " ", "boundaries"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "___", "___", "___", "___", "___", "___", "___", "___", "___", "___", 
    "___", "___", "___", "___", "___", "___", "___", "_"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GivenExperimentBoundaries", "=", 
    RowBox[{"\[Theta]minmaxBlock", "[", "GivenExperiment", "]"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"Min", "/", "max"}], " ", "polar", " ", "angles", " ", "of", " ",
      "the", " ", "decay", " ", "volume", " ", "and", " ", "detector"}], ",", 
    " ", 
    RowBox[{"and", " ", "the", " ", "corresponding", " ", "points"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"\[Theta]minExp", ",", "\[Theta]maxExp"}], "}"}], "=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"GivenExperimentBoundaries", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "[", 
        RowBox[{"[", "2", "]"}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"GivenExperimentBoundaries", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "[", 
        RowBox[{"[", "2", "]"}], "]"}], "[", 
       RowBox[{"[", "2", "]"}], "]"}]}], "}"}], "//", "N"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"R\[Theta]minDecayVolume", ",", "R\[Theta]maxDecayVolume"}], 
    "}"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"GivenExperimentBoundaries", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"GivenExperimentBoundaries", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}], "[", 
      RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"DecayVolumeAsDetectorGivenExperiment", "==", "\"\<False\>\""}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "ThetaDetGivenExperimentMin", ",", "ThetaDetGivenExperimentMax"}], 
        "}"}], "=", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"GivenExperimentBoundaries", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "[", 
            RowBox[{"[", "2", "]"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"GivenExperimentBoundaries", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "[", 
            RowBox[{"[", "2", "]"}], "]"}], "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], "}"}], "//", "N"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"R\[Theta]minEndDetector", ",", "R\[Theta]maxEndDetector"}], 
        "}"}], "=", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"GivenExperimentBoundaries", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"GivenExperimentBoundaries", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}], "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], "}"}], "//", "N"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"DetectorGeometryGivenExperiment", "=", 
       RowBox[{"DetectorGeometry", "[", "GivenExperiment", "]"}]}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "ThetaDetGivenExperimentMin", ",", "ThetaDetGivenExperimentMax"}], 
       "}"}], "=", 
      RowBox[{"{", 
       RowBox[{"\[Theta]minExp", ",", "\[Theta]maxExp"}], "}"}]}]}], 
    "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Min", "/", "max"}], " ", "angles", " ", "of", " ", "the", " ", 
    "decay", " ", "volume", " ", "within", " ", "margin"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"margin", "=", "0.1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"\[Theta]minDistr", ",", "\[Theta]maxDistr"}], "}"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Max", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", "margin"}], ")"}], "\[Theta]minExp"}], ",", 
       SuperscriptBox["10", 
        RowBox[{"-", "5."}]]}], "]"}], ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "+", "margin"}], ")"}], "\[Theta]maxExp"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"margin", "=", "0.01"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"\[Theta]minExp", ",", "\[Theta]maxExp"}], "}"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "+", "margin"}], ")"}], "*", 
      RowBox[{"Max", "[", 
       RowBox[{"\[Theta]minExp", ",", 
        SuperscriptBox["10", 
         RowBox[{"-", "5."}]]}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "margin"}], ")"}], "*", "\[Theta]maxExp"}]}], 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FinalPlaneGivenExperiment", "=", 
    RowBox[{"PlaneEndOfDetectorExperiment", "[", "GivenExperiment", "]"}]}], 
   ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Parameters", " ", "of", " ", "the", " ", "dipole", " ", "magnet", " ", 
    "in", " ", "the", " ", "spectrometer", " ", 
    RowBox[{"(", 
     RowBox[{"if", " ", "present"}], ")"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"zMagnetMinGivenExperiment", "=", 
   RowBox[{"zMagnetMinExperiment", "[", "GivenExperiment", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"zMagnetMaxGivenExperiment", "=", 
   RowBox[{"zMagnetMaxExperiment", "[", "GivenExperiment", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Bval", "=", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"DipoleMagnetOptionGivenExperiment", "==", "\"\<False\>\""}], ",",
       "0.", ",", 
      RowBox[{"MagneticFieldExperiment", "[", "GivenExperiment", "]"}]}], 
     "]"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"ECAL", " ", "position"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ECALpositionGivenExperiment", "=", 
    RowBox[{"zECALminExperiment", "[", "GivenExperiment", "]"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"FinalPlaneGivenExperiment", "=", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
       "finalPlaneGivenExperiment", "\[Equal]", "\"\<EndOfDetector\>\""}], ",",
        "EndOfDetectorGivenExperiment", ",", "PlaneDetectorGivenExperiment"}],
       "]"}]}], ";"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TableParticlesNumbersGivenExperiment", "=", 
   RowBox[{"TableNumbersParticlesExperiment", "[", "GivenExperiment", "]"}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"xLongMuonPlaneGivenExperiment", "=", 
   RowBox[{"xLongMuonPlaneExperiment", "[", "GivenExperiment", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"xLongNonMuonPlaneGivenExperiment", "=", 
    RowBox[{"xLongNonMuonPlaneExperiment", "[", "GivenExperiment", "]"}]}], 
   ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Geometric", " ", "conditions"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"IfLLPinsideDecVol", "[", 
    RowBox[{"zLLP_", ",", "xLLP_", ",", "yLLP_"}], "]"}], "=", 
   RowBox[{"IfLLPinsideDecVol", "[", 
    RowBox[{"zLLP", ",", "xLLP", ",", "yLLP", ",", "GivenExperiment"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"IfLLPtoDet", "[", 
      RowBox[{"x1LLPproj_", ",", "x2LLPproj_", ",", "xLongProj_"}], "]"}], ",", 
     RowBox[{"IfLLPnotToDet", "[", 
      RowBox[{"x1LLPproj_", ",", "x2LLPproj_", ",", "xLongProj_"}], "]"}]}], 
    "}"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"IfLLPtoDet", "[", 
      RowBox[{
      "x1LLPproj", ",", "x2LLPproj", ",", "xLongProj", ",", 
       "GivenExperiment"}], "]"}], ",", 
     RowBox[{"IfLLPnotToDet", "[", 
      RowBox[{
      "x1LLPproj", ",", "x2LLPproj", ",", "xLongProj", ",", 
       "GivenExperiment"}], "]"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"IfLLPdecVolToDet", "[", 
    RowBox[{
    "zLLP_", ",", "xLLP_", ",", "yLLP_", ",", "x1LLPproj_", ",", "x2LLPproj_",
      ",", "xLongProj_"}], "]"}], "=", 
   RowBox[{"IfLLPdecVolToDet", "[", 
    RowBox[{
    "zLLP", ",", "xLLP", ",", "yLLP", ",", "x1LLPproj", ",", "x2LLPproj", ",",
      "xLongProj", ",", "GivenExperiment"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"IfLLPdecVolNotToDet", "[", 
    RowBox[{
    "zLLP_", ",", "xLLP_", ",", "yLLP_", ",", "x1LLPproj_", ",", "x2LLPproj_",
      ",", "xLongProj_"}], "]"}], "=", 
   RowBox[{"IfLLPdecVolNotToDet", "[", 
    RowBox[{
    "zLLP", ",", "xLLP", ",", "yLLP", ",", "x1LLPproj", ",", "x2LLPproj", ",",
      "xLongProj", ",", "GivenExperiment"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DecayAcceptanceGeometry", "[", 
    RowBox[{"x1LLPproj_", ",", "x2LLPproj_", ",", "xLongProj_"}], "]"}], "=", 
   RowBox[{"IfLLPtoDet", "[", 
    RowBox[{"x1LLPproj", ",", "x2LLPproj", ",", "xLongProj"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AtargetSelected", "=", 
   RowBox[{"AtargetExperiment", "[", "GivenExperiment", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NpotGivenExperiment", "=", 
   RowBox[{"NPOTexperiment", "[", "GivenExperiment", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"pointSecondCoordinate", "=", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
      "DetectorPlaneOrientationGivenExperiment", 
       "\[Equal]", "\"\<Transverse\>\""}], ",", "2", ",", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
        "DetectorPlaneOrientationGivenExperiment", 
         "\[Equal]", "\"\<Parallel\>\""}], ",", "3"}], "]"}]}], "]"}]}], 
   ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"___", "___", "___", "___", "___"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Efficiency", "[", "mLLP_", "]"}], "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"GivenExperiment", "==", "\"\<NuCal\>\""}], ",", 
    RowBox[{
     RowBox[{"Efficiency", "[", "mLLP_", "]"}], "=", "0.7"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"GivenExperiment", "==", "\"\<CHARM\>\""}], ",", 
     RowBox[{
      RowBox[{"Efficiency", "[", "mLLP_", "]"}], "=", "0.7"}]}], "]"}], ";"}],
   "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"___", "___", "___", "___", "___"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Creating", " ", "the", " ", "grid", " ", "of", " ", "z", " ", "values", " ",
     "within", " ", "the", " ", "range", " ", "of", " ", "the", " ", "decay", 
    " ", "volume"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"zvals", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"RandomReal", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"zDecVolMin", ",", "zDecVolMax"}], "}"}], ",", 
         SuperscriptBox["10", "4"]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"zDecVolMin", ",", "zDecVolMax"}], "}"}]}], "]"}], "//", 
     "Sort"}], "//", "DeleteDuplicates"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nfzvals", "=", 
   RowBox[{"Nearest", "[", 
    RowBox[{"zvals", "->", "\"\<Index\>\""}], "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.9290936393455954`*^9, 3.9290936425041847`*^9}, {
  3.929093685079212*^9, 3.9290938165295496`*^9}, {3.9290941767020583`*^9, 
  3.929094187483323*^9}, {3.929159175926421*^9, 3.929159176052741*^9}, {
  3.929163992299731*^9, 3.929164036552519*^9}, {3.9292090534593143`*^9, 
  3.9292090697779427`*^9}, {3.929291941418314*^9, 3.9292919433789606`*^9}, {
  3.9312386216731043`*^9, 3.9312386219852657`*^9}, {3.9312390995727725`*^9, 
  3.931239099756023*^9}, {3.931249751783604*^9, 3.9312497603294888`*^9}, {
  3.9312497925848894`*^9, 3.9312497953398714`*^9}},
 CellLabel->"In[23]:=",ExpressionUUID->"51a8fd1f-5b4c-4b48-82b5-ba2ff69fa881"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Specifying LLP", "Chapter",
 CellChangeTimes->{{3.9421692908830013`*^9, 3.9421692924863453`*^9}, {
  3.942202132978441*^9, 
  3.942202134821287*^9}},ExpressionUUID->"7f5c9fea-cd89-8046-905e-\
ab5a7bf5e5e2"],

Cell[CellGroupData[{

Cell["LLP selector", "Section",
 CellChangeTimes->{{3.942202144434435*^9, 
  3.942202147450617*^9}},ExpressionUUID->"58041813-d5c7-a642-a97b-\
b350e9efb100"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"LLPlist", "=", 
   RowBox[{"{", 
    RowBox[{"\"\<HNL\>\"", ",", "\"\<Scalar\>\"", ",", "\"\<DP\>\"", 
     ",", "\"\<ALP-photon\>\""}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DynamicModule", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"choice", "=", "None"}], ",", "options", ",", "rows", ",", 
      "cols", ",", "gridButtons", ",", "maxWidth", ",", "paneHeight"}], "}"}],
     ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"options", "=", "LLPlist"}], ";", 
     RowBox[{"(*", 
      RowBox[{
      "Replace", " ", "with", " ", "your", " ", "actual", " ", "list", " ", 
       "items"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"cols", "=", "3"}], ";", 
     RowBox[{"(*", 
      RowBox[{
      "Number", " ", "of", " ", "columns", " ", "in", " ", "the", " ", 
       "grid"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"rows", "=", 
      RowBox[{"Ceiling", "[", 
       RowBox[{
        RowBox[{"Length", "[", "options", "]"}], "/", "cols"}], "]"}]}], ";", 
     RowBox[{"(*", 
      RowBox[{"Number", " ", "of", " ", "rows"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"gridButtons", "=", 
      RowBox[{"Partition", "[", 
       RowBox[{
        RowBox[{"PadRight", "[", 
         RowBox[{"options", ",", 
          RowBox[{"rows", "*", "cols"}], ",", "\"\<\>\""}], "]"}], ",", 
        "cols"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "Estimate", " ", "the", " ", "width", " ", "of", " ", "the", " ", 
       "widest", " ", "button"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"maxWidth", "=", 
      RowBox[{
       RowBox[{"Max", "[", 
        RowBox[{"StringLength", "/@", 
         RowBox[{"ToString", "/@", "options"}]}], "]"}], "*", "15"}]}], ";", 
     RowBox[{"(*", 
      RowBox[{"Adjust", " ", "multiplier", " ", "as", " ", "needed"}], "*)"}],
      "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "Set", " ", "the", " ", "height", " ", "of", " ", "the", " ", "pane"}], 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"paneHeight", "=", "300"}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "Adjust", " ", "this", " ", "value", " ", "based", " ", "on", " ", 
       "desired", " ", "height"}], "*)"}], 
     RowBox[{"LLPdirName", "=", 
      RowBox[{"DialogInput", "[", 
       RowBox[{"Column", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"TextCell", "[", "\"\<Choose the LLP:\>\"", "]"}], ",", 
          RowBox[{"Pane", "[", 
           RowBox[{
            RowBox[{"Dynamic", "@", 
             RowBox[{"Grid", "[", 
              RowBox[{
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"With", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"opt", "=", 
                    RowBox[{"gridButtons", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}]}], "}"}], ",", 
                   RowBox[{"Button", "[", 
                    RowBox[{"opt", ",", 
                    RowBox[{"choice", "=", "opt"}], ",", 
                    RowBox[{"Background", "->", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"choice", "===", "opt"}], ",", "LightBlue", ",", 
                    "None"}], "]"}]}], ",", 
                    RowBox[{"ImageSize", "->", 
                    RowBox[{"{", 
                    RowBox[{"maxWidth", ",", "Automatic"}], "}"}]}]}], " ", 
                    RowBox[{"(*", 
                    RowBox[{"Set", " ", "width", " ", "to", " ", "maxWidth"}],
                     "*)"}], "]"}]}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"i", ",", "rows"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"j", ",", "cols"}], "}"}]}], "]"}], ",", 
               RowBox[{"Spacings", "->", 
                RowBox[{"{", 
                 RowBox[{"2", ",", "2"}], "}"}]}]}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"Automatic", ",", "paneHeight"}], "}"}], ",", 
            RowBox[{"Scrollbars", "->", 
             RowBox[{"{", 
              RowBox[{"False", ",", "True"}], "}"}]}]}], "]"}], ",", 
          RowBox[{"Button", "[", 
           RowBox[{"\"\<OK\>\"", ",", 
            RowBox[{"DialogReturn", "[", "choice", "]"}], ",", 
            RowBox[{"ImageSize", "->", "Automatic"}]}], "]"}]}], "}"}], "]"}],
        "]"}]}]}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"LLPdirName", "==", "\"\<HNL\>\""}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ListHNLtype", "=", 
     RowBox[{"{", 
      RowBox[{"\"\<Dirac\>\"", ",", "\"\<Majorana\>\""}], "}"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"HNLtype", "=", 
     RowBox[{"dropdownDialog", "[", 
      RowBox[{"ListHNLtype", ",", "\"\<Select the HNL type:\>\""}], "]"}]}], ";",
     "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "MixingPatterne", ",", "MixingPattern\[Mu]", ",", 
       "MixingPattern\[Tau]"}], "}"}], "=", 
     RowBox[{
      RowBox[{"DialogInput", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"pattern", "=", 
          RowBox[{"{", 
           RowBox[{"1.", ",", "0.", ",", "0."}], "}"}]}], "}"}], ",", 
        RowBox[{"Column", "[", 
         RowBox[{"{", 
          
          RowBox[{"\"\<Enter the mixing pattern \
\!\(\*SubscriptBox[SuperscriptBox[\(U\), \(2\)], \
\(e\)]\):\!\(\*SubscriptBox[SuperscriptBox[\(U\), \(2\)], \
\(\[Mu]\)]\):\!\(\*SubscriptBox[SuperscriptBox[\(U\), \(2\)], \(\[Tau]\)]\) = \
\!\(\*SuperscriptBox[\(U\), \(2\)]\)(\!\(\*SubscriptBox[\(x\), \
\(e\)]\):\!\(\*SubscriptBox[\(x\), \(\[Mu]\)]\):\!\(\*SubscriptBox[\(x\), \(\
\[Tau]\)]\)) (where \!\(\*SubscriptBox[\(\[CapitalSigma]\), \
\(i\)]\)\!\(\*SubscriptBox[\(x\), \(i\)]\) = 1) in the form \
{xe,x\[Mu],x\[Tau]}:\>\"", ",", 
           RowBox[{"InputField", "[", 
            RowBox[{
             RowBox[{"Dynamic", "[", "pattern", "]"}], ",", "Expression"}], 
            "]"}], ",", 
           RowBox[{"Button", "[", 
            RowBox[{"\"\<Proceed\>\"", ",", 
             RowBox[{"DialogReturn", "[", "pattern", "]"}], ",", 
             RowBox[{"ImageSize", "\[Rule]", "Automatic"}]}], "]"}]}], "}"}], 
         "]"}]}], "]"}], "//", "N"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"MixingPattern", "=", 
     RowBox[{
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
         "MixingPatterne", "+", "MixingPattern\[Mu]", "+", 
          "MixingPattern\[Tau]"}], ")"}], 
        RowBox[{"-", "1"}]], 
       RowBox[{"{", 
        RowBox[{
        "MixingPatterne", ",", "MixingPattern\[Mu]", ",", 
         "MixingPattern\[Tau]"}], "}"}]}], "//", "N"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\"\<HNL type\>\"", ",", "\"\<Mixing pattern:\>\""}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"HNLtype", ",", "MixingPattern"}], "}"}]}], "}"}]}]}], 
  "\[IndentingNewLine]", "]"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.9311601004853425`*^9, 3.9311601007493386`*^9}, {
  3.9311918318129272`*^9, 3.9311918519795*^9}, {3.931314163297886*^9, 
  3.9313143422546654`*^9}, {3.9355140104001026`*^9, 3.9355140118023815`*^9}, {
  3.9422319354526024`*^9, 3.9422319375168056`*^9}},
 CellLabel->"In[81]:=",ExpressionUUID->"33fb2175-df24-4a7c-b6dc-9d9be161cfc8"]
}, Closed]],

Cell[CellGroupData[{

Cell["Production probabilities and tabulated distributions", "Section",
 CellChangeTimes->{{3.942169305811716*^9, 
  3.9421693128891506`*^9}},ExpressionUUID->"de80b96a-dcc8-204c-b42a-\
5b696fab8938"],

Cell[CellGroupData[{

Cell["\<\
Loading probabilities and tabulated distribution for separate production \
channels\
\>", "Subsection",
 CellChangeTimes->{{3.931160227397683*^9, 3.93116024265158*^9}, {
  3.9311627828051786`*^9, 3.9311627919701943`*^9}, {3.9312299762815337`*^9, 
  3.9312299776383457`*^9}, {3.942169319229845*^9, 
  3.942169324419138*^9}},ExpressionUUID->"e5b02935-5ccf-4ab1-a6dc-\
a366ea6a2516"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Defining", " ", "the", " ", "following", " ", 
    RowBox[{"functions", ":"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"DoubleDistrLLPdata", "[", "proc", "]"}], ",", " ", 
    RowBox[{
    "which", " ", "is", " ", "the", " ", "tabulated", " ", "distribution", " ",
      "for", " ", "the", " ", "given", " ", "production", " ", "process"}]}], 
   "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"GridInFinal", "[", "process", "]"}], ",", " ", 
    RowBox[{"which", " ", "is", " ", "Log10grids", " ", 
     RowBox[{"{", 
      RowBox[{"mass", ",", " ", 
       RowBox[{"polar", " ", "angle"}], ",", " ", "energy"}], "}"}], " ", 
     "for", " ", "the", " ", "given", " ", "tabulated", " ", "distribution", " ",
      "function"}]}], "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"DistrVals", "[", "process", "]"}], ",", " ", 
    RowBox[{
    "which", " ", "are", " ", "reshaped", " ", "distribution", " ", "values", 
     " ", "for", " ", "this", " ", "grid"}]}], "\[IndentingNewLine]", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"PmotherToLLP", "[", 
     RowBox[{"mLLP", ",", "coupling1", ",", "coupling2", ",", "process"}], 
     "]"}], ",", " ", 
    RowBox[{
    "which", " ", "are", " ", "interpolations", " ", "of", " ", "the", " ", 
     "production", " ", "probabilities", " ", "\[IndentingNewLine]", 
     "coupling1"}], ",", " ", 
    RowBox[{
     RowBox[{
     "coupling2", " ", "are", " ", "two", " ", "couplings", " ", 
      "controlling", " ", "the", " ", "production", " ", "rates"}], ";", " ", 
     RowBox[{"for", " ", "some", " ", "models"}]}], ",", " ", 
    RowBox[{"there", " ", "is", " ", "only", " ", "one", " ", "coupling"}]}], 
   "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"inecessary", "=", 
     RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Length", "[", "inecessary", "]"}], "==", "0"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"NotebookEvaluate", "[", 
        RowBox[{"FileNameJoin", "[", 
         RowBox[{"{", 
          RowBox[{
          "DirectoryRoutinesEventCalc", 
           ",", "\"\<ProductionProbabilities.nb\>\""}], "}"}], "]"}], "]"}], ";",
        "\[IndentingNewLine]", 
       RowBox[{"inecessary", "=", 
        RowBox[{"{", 
         RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], ";"}]}], 
     "\[IndentingNewLine]", "]"}], "//", "AbsoluteTiming"}], "\[IndentingNewLine]", 
   RowBox[{"Print", "[", 
    RowBox[{"Row", "[", 
     RowBox[{"{", 
      RowBox[{"\"\<List of production channels and facilities implemented for \
\>\"", ",", "LLPdirName", ",", "\"\< at \>\"", ",", " ", "FacilitySelected", 
       ",", "\"\<:\>\""}], "}"}], "]"}], "]"}], "\[IndentingNewLine]", 
   "ListProcesses", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"productionlist", "=", 
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"{", "\"\<All\>\"", "}"}], ",", "ListProcesses"}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"DynamicModule", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"choice", "=", 
         RowBox[{"{", "\"\<All\>\"", "}"}]}], ",", "list", ",", "phrase"}], 
       "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"DialogInput", "[", 
       RowBox[{"Column", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Row", "[", 
           RowBox[{
           "{", "\"\<Select the production channels to be used for the \
sensitivity calculation:\>\"", "}"}], "]"}], ",", 
          RowBox[{"Pane", "[", 
           RowBox[{
            RowBox[{"TogglerBar", "[", 
             RowBox[{
              RowBox[{"Dynamic", "[", "choice", "]"}], ",", "productionlist", 
              ",", 
              RowBox[{"Appearance", "->", 
               RowBox[{"{", 
                RowBox[{"Automatic", ",", "Automatic"}], "}"}]}]}], "]"}], ",", 
            RowBox[{"ImageSize", "->", 
             RowBox[{"{", 
              RowBox[{"Automatic", ",", "Automatic"}], "}"}]}], ",", 
            RowBox[{"Scrollbars", "->", 
             RowBox[{"{", 
              RowBox[{"False", ",", "True"}], "}"}]}]}], "]"}], ",", 
          RowBox[{"Button", "[", 
           RowBox[{"\"\<Submit\>\"", ",", 
            RowBox[{"DialogReturn", "[", 
             RowBox[{
              RowBox[{"{", "ProdChannelsSelected", "}"}], "=", 
              RowBox[{"{", "choice", "}"}]}], "]"}], ",", 
            RowBox[{"ImageSize", "->", "Automatic"}]}], "]"}]}], "}"}], "]"}],
        "]"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"MemberQ", "[", 
      RowBox[{"ProdChannelsSelected", ",", "\"\<All\>\""}], "]"}], ",", 
     RowBox[{
      RowBox[{"ProdChannelsSelected", "=", "ListProcesses"}], ";"}]}], "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Print", "[", "\"\<Selected production channels:\>\"", "]"}], "\[IndentingNewLine]",
    "ProdChannelsSelected", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
    "Print", "[", "\"\<If there are production probabilities to all available \
distributions:\>\"", "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"LLPdirName", "!=", "\"\<HNL\>\""}], ",", "\[IndentingNewLine]", 
     RowBox[{"IfCondDistrToWeights", "=", 
      RowBox[{"ProdChannelsSelected", "==", 
       RowBox[{"Select", "[", 
        RowBox[{"WeightsCombinations", ",", 
         RowBox[{
          RowBox[{"MemberQ", "[", 
           RowBox[{"ProdChannelsSelected", ",", "#"}], "]"}], "&"}]}], 
        "]"}]}]}], "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
     RowBox[{"IfCondDistrToWeights", "=", 
      RowBox[{
       RowBox[{"Sort", "[", "ProdChannelsSelected", "]"}], "==", 
       RowBox[{"Sort", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"DeleteDuplicates", "[", 
           RowBox[{"WeightsCombinations", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"MemberQ", "[", 
            RowBox[{"ProdChannelsSelected", ",", "#"}], "]"}], "&"}]}], "]"}],
         "]"}]}]}]}], "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
   RowBox[{"Do", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"ProbabilityProcess", "[", 
       RowBox[{"mLLP_", ",", "coupling1_", ",", "coupling2_", ",", "proc"}], 
       "]"}], "=", 
      RowBox[{
       RowBox[{"MotherFraction", "[", "proc", "]"}], "*", 
       RowBox[{"PmotherToLLP", "[", 
        RowBox[{"mLLP", ",", "coupling1", ",", "coupling2", ",", "proc"}], 
        "]"}]}]}], "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{"proc", ",", "ProdChannelsSelected"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"LLPdirName", "==", "\"\<HNL\>\""}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"MixingPatternShortened", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"ToString", "[", 
          RowBox[{"NumberForm", "[", 
           RowBox[{"#", ",", 
            RowBox[{"{", 
             RowBox[{"Infinity", ",", "2"}], "}"}]}], "]"}], "]"}], "&"}], "/@",
         "MixingPattern"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"rowprodprob", "=", 
       RowBox[{"Row", "[", 
        RowBox[{"{", 
         RowBox[{
         "LLPdirName", ",", "\"\< with mixing pattern = \>\"", ",", 
          "MixingPatternShortened", ",", "\"\< at \>\"", ",", 
          "GivenExperiment"}], "}"}], "]"}]}], ";"}], "\[IndentingNewLine]", ",",
      "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"rowprodprob", "=", 
       RowBox[{"Row", "[", 
        RowBox[{"{", 
         RowBox[{"LLPdirName", ",", "\"\< at \>\"", ",", "GivenExperiment"}], 
         "}"}], "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"mLLPminSelected", ",", "mLLPmaxSelected"}], "}"}], "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Min", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"mLLPmin", "[", "#", "]"}], "&"}], "/@", 
         "ProdChannelsSelected"}], "]"}], ",", 
       RowBox[{"Max", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"mLLPmax", "[", "#", "]"}], "&"}], "/@", 
         "ProdChannelsSelected"}], "]"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.931162875162958*^9, 3.931162877461279*^9}, {
   3.9311922696791325`*^9, 3.931192269921592*^9}, {3.9311923386556892`*^9, 
   3.9311925147919135`*^9}, {3.931225900893506*^9, 3.9312259420780787`*^9}, {
   3.9312261844339733`*^9, 3.931226191049671*^9}, {3.9312300527344427`*^9, 
   3.9312300739063573`*^9}, {3.931249912143674*^9, 3.931249989288539*^9}, 
   3.9313151230392475`*^9, {3.9313151560403132`*^9, 3.9313151687194586`*^9}, 
   3.931315297030221*^9, 3.9313163286966467`*^9, {3.9355147730326324`*^9, 
   3.935514803774953*^9}, {3.9355149003994637`*^9, 3.935514901724867*^9}, {
   3.935514979343526*^9, 3.9355149794344254`*^9}, {3.9355167573099613`*^9, 
   3.9355167578793783`*^9}, {3.9421693781185703`*^9, 3.9421693793014393`*^9}, 
   3.9422477389249077`*^9},
 CellLabel->"In[84]:=",ExpressionUUID->"9587b454-c907-4dfb-a80b-695120fcf98a"]
}, Closed]],

Cell[CellGroupData[{

Cell["Gluing distributions for all production channels", "Subsection",
 CellChangeTimes->{{3.931160227397683*^9, 3.93116024265158*^9}, {
  3.9311627828051786`*^9, 3.9311627919701943`*^9}, {3.9312299762815337`*^9, 
  3.9312299776383457`*^9}, {3.942169319229845*^9, 
  3.942169338536417*^9}},ExpressionUUID->"aa20eb65-0e1d-124a-91d1-\
667e6ce1b76b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Defining", " ", "the", " ", "following", " ", "functions"}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"DistrMapperMassProd", "[", 
     RowBox[{"mLLP", ",", "ProdChannel"}], "]"}], ",", " ", 
    RowBox[{
    "that", " ", "maps", " ", "the", " ", "tabulated", " ", "distribution", " ", 
     RowBox[{"{", 
      RowBox[{"mass", ",", "theta", ",", "energy", ",", "distr"}], "}"}], " ",
      "on", " ", "the", " ", "given", " ", "mass", " ", "for", " ", "the", " ",
      "given", " ", "production", " ", "channel"}]}], "\[IndentingNewLine]", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"DistrMapperMass", "[", 
     RowBox[{
     "mLLP", ",", "coupling1", ",", " ", "coupling2", ",", "listprocesses"}], 
     "]"}], ",", " ", 
    RowBox[{
    "that", " ", "maps", " ", "the", " ", "tabulated", " ", "distribution", " ", 
     RowBox[{"{", 
      RowBox[{"mass", ",", "theta", ",", "energy", ",", "distr"}], "}"}], " ",
      "averaged", " ", "over", " ", "the", " ", "list", " ", "of", " ", "the",
      " ", "production", " ", "channels", " ", "`listprocesses`", " ", "on", " ",
      "the", " ", "given", " ", "mass"}]}], "\[IndentingNewLine]", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"DistrMapper", "[", 
     RowBox[{
     "mlist", ",", "coupling1", ",", " ", "coupling2", ",", "listprocesses"}],
      "]"}], ",", " ", 
    RowBox[{
    "that", " ", "maps", " ", "the", " ", "tabulated", " ", "distribution", " ", 
     RowBox[{"{", 
      RowBox[{"mass", ",", "theta", ",", "energy", ",", "distr"}], "}"}], " ",
      "averaged", " ", "over", " ", "the", " ", "list", " ", "of", " ", "the",
      " ", "production", " ", "channels", " ", "`listprocesses`", " ", "on", " ",
      "the", " ", "given", " ", "mass", " ", "list", " ", "mlist"}]}], 
   "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"FindingEmax\[Theta]", "[", 
     RowBox[{"mLLP", ",", "process", ",", "order"}], "]"}], ",", " ", 
    RowBox[{
     RowBox[{"that", " ", "returns", " ", "the", " ", "list", " ", 
      RowBox[{"{", 
       RowBox[{"\[Theta]", ",", " ", 
        RowBox[{
         SubscriptBox["E", "max"], 
         RowBox[{"(", "\[Theta]", ")"}]}]}], "}"}], " ", "for", " ", "the", " ",
       "given", " ", "LLP", " ", "mass", " ", "and", " ", "the", " ", 
      "production", " ", 
      RowBox[{"channel", ".", " ", "The"}], " ", "parameter", " ", "`order`", 
      " ", "defines", " ", 
      RowBox[{
       SubscriptBox["E", "max"], ":", " ", 
       RowBox[{"1", "-", 
        RowBox[{
         SubscriptBox["CDF", "distr"], 
         RowBox[{"(", 
          RowBox[{
           SubscriptBox["E", "max"], ",", "\[Theta]"}], ")"}]}]}]}]}], " ", "=",
      " ", 
     SuperscriptBox["10", 
      RowBox[{"-", "order"}]]}]}], "\[IndentingNewLine]", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"inecessary", "=", 
     RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Length", "[", "inecessary", "]"}], "==", "0"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"NotebookEvaluate", "[", 
        RowBox[{"FileNameJoin", "[", 
         RowBox[{"{", 
          RowBox[{
          "DirectoryRoutinesEventCalc", ",", "\"\<DistrMapper.nb\>\""}], 
          "}"}], "]"}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"inecessary", "=", 
        RowBox[{"{", 
         RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], ";"}]}], 
     "\[IndentingNewLine]", "]"}], "//", "AbsoluteTiming"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.942314764488676*^9, 3.942314764905817*^9}},
 CellLabel->"In[98]:=",ExpressionUUID->"85149bd2-dab6-4bcf-bfaa-a52428db954e"]
}, Closed]],

Cell[CellGroupData[{

Cell["Total production probability and plots", "Subsection",
 CellChangeTimes->{{3.9422477330888596`*^9, 
  3.9422477494933777`*^9}},ExpressionUUID->"3930e280-d7b3-fa4b-bf70-\
2821fd788c99"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Total", " ", 
    RowBox[{"LLP", "'"}], "s", " ", "production", " ", "probability", " ", 
    "defined", " ", "as", " ", 
    RowBox[{
     SubscriptBox["N", 
      RowBox[{"prod", ",", "total"}]], "/", 
     SubscriptBox["N", "PoT"]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"ProbabilityProcess", "[", 
       RowBox[{"mLLP_", ",", "coupling1_", ",", "coupling2_", ",", "proc"}], 
       "]"}], "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"mLLPmin", "[", "proc", "]"}], "<=", "mLLP", "<=", 
         RowBox[{"mLLPmax", "[", "proc", "]"}]}], ",", 
        RowBox[{"Evaluate", "[", 
         RowBox[{"ProbabilityProcess", "[", 
          RowBox[{"mLLP", ",", "coupling1", ",", "coupling2", ",", "proc"}], 
          "]"}], "]"}], ",", "0"}], "]"}]}], "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{"proc", ",", "ProdChannelsSelected"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ProbabilityLLPprodTot", "[", 
      RowBox[{"mLLP_", ",", "coupling1_", ",", "coupling2_"}], "]"}], "=", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{"ProbabilityProcess", "[", 
        RowBox[{"mLLP", ",", "coupling1", ",", "coupling2", ",", "proc"}], 
        "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"proc", ",", "ProdChannelsSelected"}], "}"}]}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{"ptprodprob", "=", 
    RowBox[{"Quiet", "[", 
     RowBox[{"LogLogPlot", "[", 
      RowBox[{
       RowBox[{"Evaluate", "[", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"ProbabilityLLPprodTot", "[", 
            RowBox[{"mLLP", ",", "1", ",", "1"}], "]"}], "}"}], ",", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"ProbabilityProcess", "[", 
             RowBox[{"mLLP", ",", "1", ",", "1", ",", "proc"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"proc", ",", "ProdChannelsSelected"}], "}"}]}], "]"}]}], 
         "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"mLLP", ",", 
         RowBox[{"Max", "[", 
          RowBox[{"mLLPminSelected", ",", "0.02"}], "]"}], ",", 
         "mLLPmaxSelected"}], "}"}], ",", 
       RowBox[{"Frame", "->", "True"}], ",", 
       RowBox[{"ImageSize", "->", "Large"}], ",", 
       RowBox[{"PlotLegends", "\[Rule]", 
        RowBox[{"Placed", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Style", "[", 
             RowBox[{"#", ",", "16"}], "]"}], "&"}], "/@", 
           RowBox[{"Join", "[", 
            RowBox[{
             RowBox[{"{", "\"\<Total\>\"", "}"}], ",", 
             "ProdChannelsSelected"}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"0.23", ",", "0.32"}], "}"}]}], "]"}]}], ",", " ", 
       RowBox[{"FrameStyle", "\[Rule]", 
        RowBox[{"Directive", "[", 
         RowBox[{"Black", ",", "Thick", ",", " ", "25"}], "]"}]}], ",", 
       RowBox[{"PlotRange", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Max", "[", 
             RowBox[{"mLLPminSelected", ",", "0.02"}], "]"}], ",", 
            RowBox[{"1.1", "mLLPmaxSelected"}]}], "}"}], ",", "All"}], 
         "}"}]}], ",", 
       RowBox[{"PlotStyle", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"Thick", ",", "Gray", ",", 
            RowBox[{"Dashing", "[", "0.02", "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"Thick", ",", "Blue"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"Thick", ",", 
            RowBox[{"Darker", "@", "Red"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"Thick", ",", 
            RowBox[{"Darker", "@", 
             RowBox[{"Darker", "@", "Green"}]}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"Thick", ",", 
            RowBox[{"Darker", "@", "Cyan"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"Thick", ",", "Magenta"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"Thick", ",", "Brown"}], "}"}]}], "}"}]}], ",", 
       RowBox[{"AspectRatio", "\[Rule]", "0.66"}], ",", 
       RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
       RowBox[{"FrameLabel", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"\"\<\!\(\*SubscriptBox[\(m\), \(LLP\)]\) [GeV]\>\"", 
          ",", "\"\<\!\(\*SubscriptBox[\(P\), \(LLP, \
prod\)]\)/\!\(\*SuperscriptBox[\(g\), \(2\)]\)\>\""}], "}"}]}], ",", 
       RowBox[{"PlotLabel", "\[Rule]", 
        RowBox[{"Style", "[", 
         RowBox[{"rowprodprob", ",", "16", ",", "Black"}], "]"}]}], ",", 
       RowBox[{"PlotPoints", "->", "200"}]}], "]"}], "]"}]}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.9422477415265694`*^9, 3.9422478304815693`*^9}, 
   3.9422479009807205`*^9, {3.9423044179355774`*^9, 3.9423044337940617`*^9}},
 CellLabel->
  "In[100]:=",ExpressionUUID->"f8e0def4-fcc3-6d42-9c60-754a4b50817b"]
}, Closed]],

Cell[CellGroupData[{

Cell["Exporting some data", "Subsection",
 CellChangeTimes->{{3.9422479598320312`*^9, 
  3.942247974211775*^9}},ExpressionUUID->"9c6ac358-6cf1-fe44-89d0-\
81cd108bc747"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ifExport", "=", "True"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{"ifExport", ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"fastExport", "[", 
      RowBox[{"filename_", ",", "tab_"}], "]"}], ":=", 
     RowBox[{"Export", "[", 
      RowBox[{"filename", ",", 
       RowBox[{"StringJoin", "[", 
        RowBox[{"Riffle", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Riffle", "[", 
             RowBox[{"#", ",", "\"\<\\t\>\""}], "]"}], "&"}], "/@", 
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Internal`MRealToString", "[", 
               RowBox[{"#", ",", "False", ",", "17"}], "]"}], "&"}], ",", 
             "tab", ",", 
             RowBox[{"{", "2", "}"}]}], "]"}]}], ",", "\"\<\\n\>\""}], "]"}], 
        "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"direxportdata", "=", 
     RowBox[{"FileNameJoin", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"NotebookDirectory", "[", "]"}], ",", "\"\<temp1\>\"", 
        ",", "\"\<EventCalc-python-data\>\"", ",", "LLPdirName"}], "}"}], 
      "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"!", 
       RowBox[{"MemberQ", "[", 
        RowBox[{
         RowBox[{"{", "\"\<Scalar\>\"", "}"}], ",", "LLPdirName"}], "]"}]}], ",",
       "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"mminexp", ",", "mmaxexp"}], "}"}], "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Max", "[", 
           RowBox[{
            RowBox[{"Min", "[", 
             RowBox[{
              RowBox[{"DoubleDistrLLPdata", "[", "\"\<Total\>\"", "]"}], "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}], ",", "0.02"}], 
           "]"}], ",", 
          RowBox[{"Max", "[", 
           RowBox[{
            RowBox[{"DoubleDistrLLPdata", "[", "\"\<Total\>\"", "]"}], "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}]}], "}"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"\[CapitalDelta]mexp", "=", "0.002"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Export", "[", 
        RowBox[{
         RowBox[{"FileNameJoin", "[", 
          RowBox[{"{", 
           RowBox[{"direxportdata", ",", 
            
            RowBox[{"\"\<DoubleDistr-\>\"", "<>", "LLPdirName", 
             "<>", "\"\<.txt\>\""}]}], "}"}], "]"}], ",", 
         RowBox[{"DoubleDistrLLPdata", "[", "\"\<Total\>\"", "]"}], 
         ",", "\"\<Table\>\""}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Export", "[", 
        RowBox[{
         RowBox[{"FileNameJoin", "[", 
          RowBox[{"{", 
           RowBox[{"direxportdata", ",", 
            
            RowBox[{"\"\<Total-yield-\>\"", "<>", "LLPdirName", 
             "<>", "\"\<.txt\>\""}]}], "}"}], "]"}], ",", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"m", ",", 
             RowBox[{"ProbabilityLLPprodTot", "[", 
              RowBox[{"m", ",", "1", ",", "1"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
            "m", ",", "mminexp", ",", "mmaxexp", ",", "\[CapitalDelta]mexp"}],
             "}"}]}], "]"}], ",", "\"\<Table\>\""}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Export", "[", 
        RowBox[{
         RowBox[{"FileNameJoin", "[", 
          RowBox[{"{", 
           RowBox[{"direxportdata", ",", 
            
            RowBox[{"\"\<Emax-\>\"", "<>", "LLPdirName", 
             "<>", "\"\<.txt\>\""}]}], "}"}], "]"}], ",", 
         RowBox[{"EmaxTabulatedData", "[", "\"\<Total\>\"", "]"}], 
         ",", "\"\<Table\>\""}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}],
     ";", "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"LLPdirName", "==", "\"\<Scalar\>\""}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"mminexp", ",", "mmaxexp"}], "}"}], "=", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Max", "[", 
              RowBox[{
               RowBox[{"Min", "[", 
                RowBox[{
                 RowBox[{"DoubleDistrLLPdata", "[", 
                  RowBox[{"\"\<Total-\>\"", "<>", "patt"}], "]"}], "[", 
                 RowBox[{"[", 
                  RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}], ",", 
               "0.02"}], "]"}], ",", 
             RowBox[{"Max", "[", 
              RowBox[{
               RowBox[{"DoubleDistrLLPdata", "[", 
                RowBox[{"\"\<Total-\>\"", "<>", "patt"}], "]"}], "[", 
               RowBox[{"[", 
                RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}]}], "}"}]}], ";",
           "\[IndentingNewLine]", 
          RowBox[{"\[CapitalDelta]mexp", "=", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"patt", "==", "\"\<mixing\>\""}], ",", "0.002", ",", 
             "0.002"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"coupl1exp", ",", "coupl2exp"}], "}"}], "=", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"patt", "==", "\"\<mixing\>\""}], ",", "1", ",", 
               "0."}], "]"}], ",", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"patt", "==", "\"\<mixing\>\""}], ",", "0", ",", 
               "1."}], "]"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"Export", "[", 
           RowBox[{
            RowBox[{"FileNameJoin", "[", 
             RowBox[{"{", 
              RowBox[{"direxportdata", ",", 
               
               RowBox[{"\"\<DoubleDistr-\>\"", "<>", "LLPdirName", 
                "<>", "\"\<-\>\"", "<>", "patt", "<>", "\"\<.txt\>\""}]}], 
              "}"}], "]"}], ",", 
            RowBox[{"DoubleDistrLLPdata", "[", 
             RowBox[{"\"\<Total-\>\"", "<>", "patt"}], "]"}], 
            ",", "\"\<Table\>\""}], "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"Export", "[", 
           RowBox[{
            RowBox[{"FileNameJoin", "[", 
             RowBox[{"{", 
              RowBox[{"direxportdata", ",", 
               
               RowBox[{"\"\<Total-yield-\>\"", "<>", "LLPdirName", 
                "<>", "\"\<-\>\"", "<>", "patt", "<>", "\"\<.txt\>\""}]}], 
              "}"}], "]"}], ",", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"m", ",", 
                RowBox[{"ProbabilityLLPprodTot", "[", 
                 RowBox[{"m", ",", "coupl1exp", ",", "coupl2exp"}], "]"}]}], 
               "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
               "m", ",", "mminexp", ",", "mmaxexp", ",", 
                "\[CapitalDelta]mexp"}], "}"}]}], "]"}], 
            ",", "\"\<Table\>\""}], "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"Export", "[", 
           RowBox[{
            RowBox[{"FileNameJoin", "[", 
             RowBox[{"{", 
              RowBox[{"direxportdata", ",", 
               
               RowBox[{"\"\<Emax-\>\"", "<>", "LLPdirName", "<>", "\"\<-\>\"",
                 "<>", "patt", "<>", "\"\<.txt\>\""}]}], "}"}], "]"}], ",", 
            RowBox[{"EmaxTabulatedData", "[", 
             RowBox[{"\"\<Total-\>\"", "<>", "patt"}], "]"}], 
            ",", "\"\<Table\>\""}], "]"}], ";"}], "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"patt", ",", 
           RowBox[{"{", 
            RowBox[{"\"\<mixing\>\"", ",", "\"\<quartic\>\""}], "}"}]}], 
          "}"}]}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]}]}], 
  "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"ff1", ",", "ff2", ",", "ff3"}], "}"}], "=", 
     RowBox[{
      RowBox[{
       RowBox[{"Import", "[", 
        RowBox[{
         RowBox[{"FileNameJoin", "[", 
          RowBox[{"{", 
           RowBox[{"direxportdata", ",", 
            
            RowBox[{"\"\<DoubleDistr-\>\"", "<>", "LLPdirName", "<>", "#", 
             "<>", "\"\<.txt\>\""}]}], "}"}], "]"}], ",", "\"\<Table\>\""}], 
        "]"}], "&"}], "/@", 
      RowBox[{"{", 
       RowBox[{"\"\<-mixing-e\>\"", ",", "\"\<-mixing-mu\>\"", 
        ",", "\"\<-mixing-tau\>\""}], "}"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"Do", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Print", "[", 
       RowBox[{
        RowBox[{"DeleteDuplicates", "[", 
         RowBox[{"ff1", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "i"}], "]"}], "]"}], "]"}], "==", 
        RowBox[{"DeleteDuplicates", "[", 
         RowBox[{"ff2", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "i"}], "]"}], "]"}], "]"}], "==", 
        RowBox[{"DeleteDuplicates", "[", 
         RowBox[{"ff3", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "i"}], "]"}], "]"}], "]"}]}], "]"}], 
      "\[IndentingNewLine]", ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", 
        RowBox[{"{", 
         RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], "}"}]}], "]"}]}], 
   "*)"}]}]}], "Input",
 CellChangeTimes->{
  3.942254337607252*^9, 3.9422543694579678`*^9, {3.942311606961811*^9, 
   3.9423116072049923`*^9}, {3.942312904618164*^9, 3.9423129181617928`*^9}, {
   3.942312950244564*^9, 3.9423129699664097`*^9}, {3.942331733805273*^9, 
   3.942331786398367*^9}, {3.9423323840854073`*^9, 3.9423323880614376`*^9}},
 CellLabel->
  "In[102]:=",ExpressionUUID->"368444b8-ff9c-8043-b284-f41cf1da286c"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["LLP\[CloseCurlyQuote]s decays", "Section",
 CellChangeTimes->{{3.94216934555418*^9, 
  3.9421693472960224`*^9}},ExpressionUUID->"da9ff4e5-da5e-a24d-a082-\
a0d19220af51"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"___", "___", "___", "___", "___", "___", "___", "___", "__"}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Defines", " ", "the", " ", "following", " ", "functions"}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"c\[Tau]LLP", "[", 
     RowBox[{"mass", ",", "coupling"}], "]"}], " ", "-", " ", 
    RowBox[{
    "c\[Tau]", " ", "of", " ", "the", " ", "LLP", " ", "in", " ", 
     "meters"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"ListProcessesLLP", " ", "-", " ", 
    RowBox[{
    "list", " ", "of", " ", "all", " ", "implemented", " ", "decay", " ", 
     "channels"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"ListBrRatios", "[", 
     RowBox[{"LLPdirName", ",", "mLLP", ",", "process"}], "]"}], " ", "-", 
    " ", 
    RowBox[{
    "branching", " ", "ratio", " ", "for", " ", "the", " ", "given", " ", 
     "process", " ", "`process`", " ", 
     RowBox[{"(", 
      RowBox[{"from", " ", "`ListProcessesLLP`"}], ")"}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"PhaseSpacePerDecay", "[", 
      RowBox[{
      "LLP", ",", "mLLP", ",", "ListDecays", ",", "Nevents", ",", 
       "HadronizationOption", ",", "DecayUnstable"}], "]"}], " ", "-", " ", 
     RowBox[{
     "the", " ", "block", " ", "simulating", " ", "phase", " ", "space", " ", 
      "for", " ", "the", " ", "given", " ", "LLP", " ", "with", " ", 
      "particular", " ", "mass", " ", "`mLLP`"}]}], ",", " ", 
    RowBox[{
     RowBox[{
     "averaging", " ", "over", " ", "the", " ", "list", " ", "of", " ", 
      "decays", " ", "specified", " ", "by", " ", 
      RowBox[{"`ListDecays`", ".", " ", "The"}], " ", "partons", " ", "are", " ",
       "hadronized", " ", "if", " ", "HadronizationOption"}], " ", "=", " ", 
     RowBox[{
      RowBox[{"\"\<True\>\"", " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"not", " ", "supported", " ", "yet"}], ")"}], ".", " ", 
        "Unstable"}], " ", "decay", " ", "products", " ", "are", " ", 
       "decayed", " ", "if", " ", "`DecayUnstable`"}], " ", "=", " ", 
      "True"}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"inecessary", "=", 
     RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Length", "[", "inecessary", "]"}], "==", "0"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"NotebookEvaluate", "[", 
        RowBox[{"FileNameJoin", "[", 
         RowBox[{"{", 
          RowBox[{
          "DirectoryRoutinesEventCalc", 
           ",", "\"\<DecayProductsSampler.nb\>\""}], "}"}], "]"}], "]"}], ";",
        "\[IndentingNewLine]", 
       RowBox[{"inecessary", "=", 
        RowBox[{"{", 
         RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], ";"}]}], 
     "\[IndentingNewLine]", "]"}], "//", "AbsoluteTiming"}], "\[IndentingNewLine]", 
   RowBox[{
   "Print", "[", "\"\<List of all implemented decay channels:\>\"", "]"}], "\[IndentingNewLine]",
    "ListProcessesLLP", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"decaylist", "=", 
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"{", "\"\<All\>\"", "}"}], ",", "ListProcessesLLP"}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"DynamicModule", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"choice", "=", 
         RowBox[{"{", "\"\<All\>\"", "}"}]}], ",", "list", ",", "phrase"}], 
       "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"DialogInput", "[", 
       RowBox[{"Column", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Row", "[", 
           RowBox[{
           "{", "\"\<Select the production channels to be used for the \
sensitivity calculation:\>\"", "}"}], "]"}], ",", 
          RowBox[{"Pane", "[", 
           RowBox[{
            RowBox[{"TogglerBar", "[", 
             RowBox[{
              RowBox[{"Dynamic", "[", "choice", "]"}], ",", "decaylist", ",", 
              RowBox[{"Appearance", "->", 
               RowBox[{"\"\<Vertical\>\"", "->", 
                RowBox[{"{", 
                 RowBox[{"Automatic", ",", "Automatic"}], "}"}]}]}]}], "]"}], 
            ",", 
            RowBox[{"ImageSize", "->", 
             RowBox[{"{", 
              RowBox[{"Automatic", ",", "Automatic"}], "}"}]}], ",", 
            RowBox[{"Scrollbars", "->", 
             RowBox[{"{", 
              RowBox[{"False", ",", "True"}], "}"}]}]}], "]"}], ",", 
          RowBox[{"Button", "[", 
           RowBox[{"\"\<Submit\>\"", ",", 
            RowBox[{"DialogReturn", "[", 
             RowBox[{
              RowBox[{"{", "ListDecaysLLPselected", "}"}], "=", 
              RowBox[{"{", "choice", "}"}]}], "]"}], ",", 
            RowBox[{"ImageSize", "->", "Automatic"}]}], "]"}]}], "}"}], "]"}],
        "]"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"MemberQ", "[", 
      RowBox[{"ListDecaysLLPselected", ",", "\"\<All\>\""}], "]"}], ",", 
     RowBox[{
      RowBox[{"ListDecaysLLPselected", "=", "ListProcessesLLP"}], ";"}]}], 
    "]"}], "\[IndentingNewLine]", 
   RowBox[{"Print", "[", "\"\<List of selected decay channels:\>\"", "]"}], "\[IndentingNewLine]",
    "ListDecaysLLPselected", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"PhaseSpacePerDecayFinal", "[", 
     RowBox[{
     "mLLP_", ",", "Nevents_", ",", "HadronizationOption_", ",", 
      "DecayUnstable_"}], "]"}], ":=", 
    RowBox[{"PhaseSpacePerDecay", "[", 
     RowBox[{
     "LLPdirName", ",", "mLLP", ",", "ListDecaysLLPselected", ",", "Nevents", 
      ",", "HadronizationOption", ",", "DecayUnstable"}], 
     "]"}]}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.9312277391578703`*^9, 3.9312278980450897`*^9}, {
   3.9312297402671137`*^9, 3.9312297652324624`*^9}, {3.931229827397325*^9, 
   3.931229842771202*^9}, {3.9312358878161173`*^9, 3.9312359000425067`*^9}, 
   3.9312365530184727`*^9, {3.931236585004176*^9, 3.931236657257436*^9}, 
   3.9312370103086123`*^9, {3.9312370529396114`*^9, 3.9312370745786867`*^9}, {
   3.9312746351133165`*^9, 3.9312746729433484`*^9}, {3.9313177370049305`*^9, 
   3.931317812550228*^9}, {3.9313178771637793`*^9, 3.9313179621060495`*^9}, {
   3.9313180191701555`*^9, 3.9313180224930253`*^9}, {3.931320280327448*^9, 
   3.931320460420297*^9}},
 CellLabel->
  "In[103]:=",ExpressionUUID->"c9d59fab-e8b4-43ed-af15-ac64c94ae3be"],

Cell[CellGroupData[{

Cell["Plots", "Subsection",
 CellChangeTimes->{{3.942169367265003*^9, 
  3.9421693679645023`*^9}},ExpressionUUID->"d7f43c24-e1b6-db4b-b684-\
9a1bcae79463"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ptprodprob", "=", 
   RowBox[{"LogLogPlot", "[", 
    RowBox[{
     RowBox[{"Evaluate", "[", 
      RowBox[{"c\[Tau]LLP", "[", 
       RowBox[{"mLLP", ",", "1"}], "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"mLLP", ",", "mLLPminSelected", ",", 
       RowBox[{"1.1", "mLLPmaxSelected"}]}], "}"}], ",", 
     RowBox[{"Frame", "->", "True"}], ",", 
     RowBox[{"ImageSize", "->", "Large"}], ",", " ", 
     RowBox[{"FrameStyle", "\[Rule]", 
      RowBox[{"Directive", "[", 
       RowBox[{"Black", ",", " ", "25"}], "]"}]}], ",", 
     RowBox[{"PlotRange", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"mLLPminSelected", ",", 
          RowBox[{"1.1", "mLLPmaxSelected"}]}], "}"}], ",", "All"}], "}"}]}], 
     ",", 
     RowBox[{"PlotStyle", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"Thick", ",", "Blue"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Thick", ",", 
          RowBox[{"Darker", "@", "Red"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Thick", ",", 
          RowBox[{"Darker", "@", 
           RowBox[{"Darker", "@", "Green"}]}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Thick", ",", 
          RowBox[{"Darker", "@", "Cyan"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Thick", ",", "Magenta"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Thick", ",", "Brown"}], "}"}]}], "}"}]}], ",", 
     RowBox[{"AspectRatio", "\[Rule]", "0.66"}], ",", 
     RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
     RowBox[{"FrameLabel", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"\"\<\!\(\*SubscriptBox[\(m\), \(LLP\)]\) [GeV]\>\"", 
        ",", "\"\<\!\(\*SubscriptBox[\(c\[Tau]\), \(LLP\)]\) [m]\>\""}], 
       "}"}]}], ",", 
     RowBox[{"PlotLabel", "\[Rule]", 
      RowBox[{"Style", "[", 
       RowBox[{
        RowBox[{"Row", "[", 
         RowBox[{"{", 
          
          RowBox[{"\"\<c\[Tau] of \>\"", ",", " ", "LLPdirName", 
           ",", "\"\< for coupling = 1 [units]\>\""}], "}"}], "]"}], ",", 
        "20", ",", "Black"}], "]"}]}], ",", 
     RowBox[{"PlotPoints", "->", "200"}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"prdecaybrs", "=", 
  RowBox[{"LogLogPlot", "[", 
   RowBox[{
    RowBox[{"Evaluate", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Max", "[", 
        RowBox[{
         RowBox[{"ListBrRatios", "[", 
          RowBox[{
          "LLPdirName", ",", "mLLP", ",", "#", ",", "decayDescrSelected"}], 
          "]"}], ",", 
         SuperscriptBox["10", 
          RowBox[{"-", "5"}]]}], "]"}], "&"}], "/@", 
      "ListDecaysLLPselected"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"mLLP", ",", 
      RowBox[{"Max", "[", 
       RowBox[{"mLLPminSelected", ",", "0.02"}], "]"}], ",", 
      RowBox[{"1.1", "mLLPmaxSelected"}]}], "}"}], ",", 
    RowBox[{"Frame", "->", "True"}], ",", 
    RowBox[{"ImageSize", "->", "Large"}], ",", " ", 
    RowBox[{"FrameStyle", "\[Rule]", 
     RowBox[{"Directive", "[", 
      RowBox[{"Black", ",", " ", "25"}], "]"}]}], ",", 
    RowBox[{"PlotRange", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Max", "[", 
          RowBox[{"mLLPminSelected", ",", "0.02"}], "]"}], ",", 
         RowBox[{"1.1", "mLLPmaxSelected"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         SuperscriptBox["10", 
          RowBox[{"-", "4"}]], ",", "2"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"PlotStyle", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"Thick", ",", "Blue"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"Thick", ",", 
         RowBox[{"Darker", "@", "Red"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"Thick", ",", 
         RowBox[{"Darker", "@", 
          RowBox[{"Darker", "@", "Green"}]}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"Thick", ",", 
         RowBox[{"Darker", "@", "Cyan"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"Thick", ",", "Magenta"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"Thick", ",", "Brown"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"Thick", ",", "Gray"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"Thick", ",", "Black"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"Thick", ",", "Blue", ",", 
         RowBox[{"Dashing", "[", "0.02", "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"Thick", ",", 
         RowBox[{"Darker", "@", "Red"}], ",", 
         RowBox[{"Dashing", "[", "0.02", "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"Thick", ",", 
         RowBox[{"Darker", "@", 
          RowBox[{"Darker", "@", "Green"}]}], ",", 
         RowBox[{"Dashing", "[", "0.02", "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"Thick", ",", 
         RowBox[{"Darker", "@", "Cyan"}], ",", 
         RowBox[{"Dashing", "[", "0.02", "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"Thick", ",", "Magenta", ",", 
         RowBox[{"Dashing", "[", "0.02", "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"Thick", ",", "Brown", ",", 
         RowBox[{"Dashing", "[", "0.02", "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"Thick", ",", "Gray", ",", 
         RowBox[{"Dashing", "[", "0.02", "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"Thick", ",", "Black", ",", 
         RowBox[{"Dashing", "[", "0.02", "]"}]}], "}"}]}], "}"}]}], ",", 
    RowBox[{"AspectRatio", "\[Rule]", "0.66"}], ",", 
    RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
    RowBox[{"FrameLabel", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"\"\<\!\(\*SubscriptBox[\(m\), \(LLP\)]\) [GeV]\>\"", 
       ",", "\"\<Br(LLP\[Rule]SM)\>\""}], "}"}]}], ",", 
    RowBox[{"PlotLabel", "\[Rule]", 
     RowBox[{"Style", "[", 
      RowBox[{
       RowBox[{"Row", "[", 
        RowBox[{"{", 
         RowBox[{"\"\<Br ratios of selected decay channels for \>\"", ",", 
          " ", "LLPdirName"}], "}"}], "]"}], ",", "20", ",", "Black"}], 
      "]"}]}], ",", 
    RowBox[{"PlotPoints", "->", "200"}], ",", 
    RowBox[{"PlotLegends", "\[Rule]", 
     RowBox[{"Placed", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Style", "[", 
          RowBox[{"#", ",", "16"}], "]"}], "&"}], "/@", 
        RowBox[{"Join", "[", "ListDecaysLLPselected", "]"}]}], ",", "Right"}],
       "]"}]}]}], "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.931318067771903*^9, 3.9313181596884356`*^9}, 
   3.931318418581018*^9, {3.935570461669542*^9, 3.935570461941164*^9}, {
   3.9355705535880027`*^9, 3.9355705606289654`*^9}, {3.9355901673768845`*^9, 
   3.9355901707608147`*^9}, 3.9355910748350143`*^9, {3.9422060959609127`*^9, 
   3.942206156242605*^9}, {3.942206228410721*^9, 3.942206228979473*^9}, {
   3.9429200176979866`*^9, 3.942920020131422*^9}, {3.952753805796232*^9, 
   3.952753808052862*^9}, {3.9527540429952087`*^9, 3.9527540458292255`*^9}},
 CellLabel->
  "In[113]:=",ExpressionUUID->"5529301e-0d2d-4586-85f2-e6b1304bdb25"]
}, Closed]]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Sampling events", "Chapter",
 CellChangeTimes->{{3.926132216716505*^9, 3.9261322475945764`*^9}, {
  3.92929181595365*^9, 3.92929182265767*^9}, {3.9310677441146407`*^9, 
  3.931067757637799*^9}, {3.931230143690308*^9, 
  3.931230144612982*^9}},ExpressionUUID->"5a2822fb-3011-49c1-80ce-\
9a4847be30a5"],

Cell[CellGroupData[{

Cell["Sampling 4-momenta of the LLPs ", "Section",
 CellChangeTimes->{{3.9261330498483353`*^9, 3.9261330628910875`*^9}, {
  3.9261334880086555`*^9, 3.926133489794159*^9}, {3.9261363916769857`*^9, 
  3.9261364038019*^9}, {3.9261370128336334`*^9, 3.926137014873536*^9}, {
  3.929291795611291*^9, 
  3.9292918019804325`*^9}},ExpressionUUID->"14f8e125-dfca-42ae-9d52-\
eda2e4b53396"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Defining", " ", "the", " ", "following", " ", "functions"}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"KinematicsFromTabulatedDistribution", "[", 
      RowBox[{
      "mLLP", ",", "coupling1", ",", "coupling2", ",", "Nevents", ",", 
       "c\[Tau]"}], "]"}], " ", "-", " ", 
     RowBox[{"takes", " ", "the", " ", "tabulated", " ", "distribution", " ", 
      RowBox[{"{", 
       RowBox[{"\[Theta]", ",", "E", ",", "distr"}], "}"}], " ", "as", " ", 
      "an", " ", "input"}]}], ",", " ", 
    RowBox[{"samples", " ", "from", " ", "it", " ", 
     SubscriptBox["N", "events"], " ", "values", " ", 
     RowBox[{"{", 
      RowBox[{
       SubscriptBox["\[Theta]", "LLP"], ",", 
       SubscriptBox["E", "LLP"]}], "}"}], " ", "in", " ", "the", " ", "range",
      " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        SubscriptBox["\[Theta]", 
         RowBox[{"min", ",", "experiment"}]], ",", 
        SubscriptBox["\[Theta]", 
         RowBox[{"max", ",", "experiment"}]]}], ")"}], ".", " ", "Uses"}], " ",
      "the", " ", "function", " ", "EmaxMapperMassToDecayTot", " ", "to", " ",
      "sample", " ", "only", " ", "the", " ", "relevant", " ", "energy", " ", 
     "range", " ", "for", " ", "the", " ", "given", " ", "polar", " ", 
     RowBox[{"angles", ".", " ", "Also"}]}], ",", " ", 
    RowBox[{
    "takes", " ", "into", " ", "account", " ", "that", " ", "for", " ", 
     "small", " ", "lifetimes", " ", "the", " ", "decay", " ", "probability", 
     " ", "is", " ", "not", " ", "exponentially", " ", "suppressed", " ", 
     "only", " ", "for", " ", "sufficiently", " ", "large", " ", 
     RowBox[{"LLPs", "'"}], " ", 
     RowBox[{"energies", ".", " ", "So"}], " ", "effectively"}], ",", " ", 
    RowBox[{"for", " ", "the", " ", "given", " ", "polar", " ", "angle", " ", 
     SubscriptBox["\[Theta]", "rand"]}], ",", " ", 
    RowBox[{
    "the", " ", "energies", " ", "are", " ", "sampled", " ", "from", " ", 
     "some", " ", 
     SubscriptBox["E", "min"], " ", "for", " ", "which", " ", 
     SubscriptBox["P", "decay"], " ", "is", " ", "not", " ", "too", " ", 
     "suppressed", " ", "and", " ", "to", " ", 
     SubscriptBox["E", 
      RowBox[{"max", " ", "possible"}]], 
     RowBox[{"(", 
      SubscriptBox["\[Theta]", "rand"], ")"}]}]}], "\[IndentingNewLine]", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"LLPyield\[Theta]", "[", 
      RowBox[{
      "mLLP", ",", "coupling1", ",", "coupling2", ",", "\[Theta]min", ",", 
       "\[Theta]max", ",", "Emin", ",", "Emax"}], "]"}], " ", "-", " ", 
     RowBox[{
     "quickly", " ", "calculates", " ", "the", " ", "amount", " ", "of", " ", 
      "LLPs", " ", "with", " ", "mass", " ", "mLLP", " ", "flying", " ", "in",
       " ", "the", " ", "angular", " ", "domain", " ", 
      RowBox[{"{", 
       RowBox[{
        SubscriptBox["\[Theta]", "min"], ",", 
        SubscriptBox["\[Theta]", "max"]}], "}"}], " ", "and", " ", "having", " ",
       "energies", " ", "within", " ", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         SubscriptBox["E", "min"], ",", 
         SubscriptBox["E", "max"]}], "}"}], ".", " ", "In"}], " ", 
      "general"}]}], ",", " ", 
    RowBox[{
    "it", " ", "is", " ", "controlled", " ", "by", " ", "two", " ", 
     "production", " ", 
     RowBox[{"couplings", ".", " ", "In"}], " ", "case", " ", "of", " ", 
     "particles", " ", "that", " ", "have", " ", "only", " ", "1", " ", 
     "production", " ", "couplings"}], ",", " ", 
    RowBox[{
    "their", " ", "values", " ", "are", " ", "not", " ", "relevant"}]}], 
   "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Momenta", "[", 
     RowBox[{"pts", ",", 
      RowBox[{"-", "Pi"}], ",", "Pi"}], "]"}], " ", "-", " ", 
    RowBox[{"evalutes", " ", "the", " ", "4"}], "-", 
    RowBox[{
    "momenta", " ", "given", " ", "`pts`", " ", "generated", " ", "by", " ", 
     RowBox[{"KinematicsFromTabulatedDistribution", ".", " ", "The"}], " ", 
     "4"}], "-", 
    RowBox[{
    "momenta", " ", "are", " ", "fixed", " ", "in", " ", "a", " ", "way", " ",
      "such", " ", "that", " ", "the", " ", 
     RowBox[{"LLP", "'"}], "s", " ", "trajectory", " ", "intersects", " ", 
     "the", " ", "decay", " ", "volume"}]}], "  ", "\[IndentingNewLine]", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"\[Theta]minYield", "=", "\[Theta]minExp"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Theta]maxYield", "=", "\[Theta]maxExp"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"inecessary", "=", 
     RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Length", "[", "inecessary", "]"}], "==", "0"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"NotebookEvaluate", "[", 
        RowBox[{"FileNameJoin", "[", 
         RowBox[{"{", 
          RowBox[{
          "DirectoryRoutinesEventCalc", 
           ",", "\"\<LLPkinematicsSampler.nb\>\""}], "}"}], "]"}], "]"}], ";",
        "\[IndentingNewLine]", 
       RowBox[{"inecessary", "=", 
        RowBox[{"{", 
         RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], ";"}]}], 
     "\[IndentingNewLine]", "]"}], "//", "AbsoluteTiming"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"KinematicsFromTabulatedDistribution", "[", 
     RowBox[{
     "datatest", ",", "\"\<SPS\>\"", ",", "mLLPtest", ",", "\[Theta]mintest", 
      ",", "\[Theta]maxtest", ",", "Neventstest", ",", 
      "EmaxMapperMassToDecay"}], "]"}], "*)"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.9261362987174006`*^9, 3.926136353600007*^9}, {
   3.9261363896321*^9, 3.9261363902515388`*^9}, {3.926136460001872*^9, 
   3.926136488641905*^9}, {3.926136998876279*^9, 3.92613700570158*^9}, {
   3.9261373662508674`*^9, 3.9261373866956587`*^9}, {3.926137416746775*^9, 
   3.9261374247746325`*^9}, {3.9261381644839497`*^9, 3.926138220325587*^9}, {
   3.9261382622827244`*^9, 3.926138268048256*^9}, {3.9261389805363083`*^9, 
   3.926138992954913*^9}, {3.926139061890219*^9, 3.9261390627680607`*^9}, {
   3.926140245020727*^9, 3.9261402510251913`*^9}, 3.926143229382925*^9, {
   3.9261437544908075`*^9, 3.926143779538148*^9}, {3.9261444553171864`*^9, 
   3.926144537205815*^9}, {3.9288968813562455`*^9, 3.928896906017115*^9}, 
   3.9288972938871183`*^9, {3.928903203038129*^9, 3.928903205895273*^9}, {
   3.9289155588286324`*^9, 3.9289156070546474`*^9}, 3.928921840028822*^9, {
   3.928921888314379*^9, 3.9289219614580317`*^9}, 3.9289829328252993`*^9, {
   3.9291578916089897`*^9, 3.929157918233343*^9}, {3.929161984579134*^9, 
   3.9291620501686115`*^9}, {3.9291621106377115`*^9, 3.929162131966776*^9}, {
   3.929291766453992*^9, 3.9292917748772883`*^9}, {3.9292918473050776`*^9, 
   3.9292918503484344`*^9}, {3.92929201045978*^9, 3.9292920733358607`*^9}, {
   3.9292922815349617`*^9, 3.929292295772217*^9}, {3.9311628200658083`*^9, 
   3.9311628208780017`*^9}, {3.9311635575366106`*^9, 
   3.9311635653395767`*^9}, {3.9312405690377893`*^9, 
   3.9312405694161882`*^9}, {3.931247401733965*^9, 3.9312474524255457`*^9}, {
   3.931248824887521*^9, 3.9312489294922056`*^9}, {3.931248999862697*^9, 
   3.931249044656966*^9}, 3.931272546096649*^9, {3.952097360164894*^9, 
   3.952097368625267*^9}, 3.952755464641922*^9},
 CellLabel->
  "In[115]:=",ExpressionUUID->"bb0b7a41-9a64-4c51-93a3-128333c981fb"]
}, Closed]],

Cell[CellGroupData[{

Cell["Sampling decay vertices of the LLPs", "Section",
 CellChangeTimes->{{3.9261330498483353`*^9, 3.9261330628910875`*^9}, {
  3.9261334880086555`*^9, 3.926133489794159*^9}, {3.9261363916769857`*^9, 
  3.9261364038019*^9}, {3.9261370128336334`*^9, 3.926137014873536*^9}, {
  3.929291795611291*^9, 3.9292918019804325`*^9}, {3.9292921035607333`*^9, 
  3.9292921069406385`*^9}},ExpressionUUID->"ce0758e7-5ee0-4c8f-9e31-\
a168f366d390"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Defining", " ", "the", " ", "following", " ", "functions"}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"EventBlockFinal", "[", 
      RowBox[{
      "mLLP", ",", "coupling1", ",", "coupling2", ",", "Nev", ",", 
       "c\[Tau]"}], "]"}], " ", "-", " ", 
     RowBox[{"samples", " ", "4"}], "-", 
     RowBox[{
     "momenta", " ", "of", " ", "LLPs", " ", "in", " ", "the", " ", 
      "direction", " ", "of", " ", "the", " ", "decay", " ", "volume"}]}], ",",
     " ", 
    RowBox[{
    "decay", " ", "vertices", " ", "inside", " ", "it", " ", "from", " ", 
     "the", " ", "value", " ", "of", " ", "c\[Tau]"}], ",", " ", 
    RowBox[{
    "together", " ", "with", " ", "computing", " ", "the", " ", "yield", " ", 
     "of", " ", "LLPs", " ", "flying", " ", "to", " ", "the", " ", "decay", " ",
      "volume", " ", "and", " ", "the", " ", "azimuthal", " ", "acceptance", " ",
      "defined", " ", "for", " ", "the", " ", "given", " ", "decay", " ", 
     "vertex", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"it", " ", "depends", " ", "on", " ", 
        SubscriptBox["\[Theta]", "decay"]}], ",", " ", 
       SubscriptBox["z", "decay"]}], ")"}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"SimulateFullEvent", "[", 
      RowBox[{
      "mLLP", ",", "coupling1", ",", "coupling2", ",", "Nev", ",", "c\[Tau]", 
       ",", "HadronizationOption", ",", "DecayUnstable"}], "]"}], " ", "-", 
     " ", 
     RowBox[{"includes", " ", "the", " ", "output", " ", "from", " ", 
      RowBox[{"EventBlockFinal", "[", 
       RowBox[{
       "mLLP", ",", "coupling1", ",", "coupling2", ",", "Nev", ",", 
        "c\[Tau]"}], "]"}], " ", "plus", " ", "the", " ", "simulated", " ", 
      "phase", " ", "space", " ", "of", " ", "the", " ", "decay", " ", 
      "products"}]}], ",", " ", 
    RowBox[{
    "as", " ", "described", " ", "in", " ", "the", " ", "previous", " ", 
     "section"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"inecessary", "=", 
     RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Length", "[", "inecessary", "]"}], "==", "0"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"NotebookEvaluate", "[", 
        RowBox[{"FileNameJoin", "[", 
         RowBox[{"{", 
          RowBox[{
          "DirectoryRoutinesEventCalc", 
           ",", "\"\<DecayVerticesSampler.nb\>\""}], "}"}], "]"}], "]"}], ";",
        "\[IndentingNewLine]", 
       RowBox[{"inecessary", "=", 
        RowBox[{"{", 
         RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], ";"}]}], 
     "\[IndentingNewLine]", "]"}], "//", "AbsoluteTiming"}], "\[IndentingNewLine]", 
   RowBox[{
   "Print", "[", "\"\<Meanings of columns of the output data for LLP:\>\"", 
    "]"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\"\<Column index\>\"", ",", "indexpx", ",", "indexpy", ",", 
        "indexpz", ",", "indexenergy", ",", "indexmass", ",", 
        "indexc\[Theta]", ",", "indexptom", ",", "indexpdec", ",", 
        "indexxdec", ",", "indexydec", ",", "indexzdec", ",", "indexazacc", ",",
         "indexnprodtot", ",", "indexyield"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"\"\<Meaning\>\"", 
        ",", "\"\<\!\(\*FractionBox[SubscriptBox[\(p\), \(LLP, x\)], \(GeV\)]\
\)\>\"", ",", "\"\<\!\(\*FractionBox[SubscriptBox[\(p\), \(LLP, y\)], \
\(GeV\)]\)\>\"", 
        ",", "\"\<\!\(\*FractionBox[SubscriptBox[\(p\), \(LLP, z\)], \(GeV\)]\
\)\>\"", ",", "\"\<\!\(\*FractionBox[SubscriptBox[\(E\), \(LLP\)], \(GeV\)]\)\
\>\"", ",", "\"\<\!\(\*FractionBox[SubscriptBox[\(m\), \(LLP\)], \(GeV\)]\)\>\
\"", ",", "\"\<cos(\!\(\*SubscriptBox[\(\[Theta]\), \(LLP\)]\))\>\"", 
        ",", "\"\<\!\(\*FractionBox[SubscriptBox[\(p\), \(LLP\)], \
SubscriptBox[\(m\), \(LLP\)]]\)\>\"", 
        ",", "\"\<\!\(\*SubscriptBox[\(P\), \(decay\)]\)\>\"", 
        ",", "\"\<\!\(\*SubscriptBox[\(x\), \(dec\)]\)\>\"", 
        ",", "\"\<\!\(\*SubscriptBox[\(y\), \(dec\)]\)\>\"", 
        ",", "\"\<\!\(\*SubscriptBox[\(z\), \(dec\)]\)\>\"", 
        ",", "\"\<\!\(\*SubscriptBox[\(\[Epsilon]\), \(az\)]\)\>\"", 
        ",", "\"\<\!\(\*SubscriptBox[\(N\), \(prod, tot\)]\)\>\"", 
        ",", "\"\<\!\(\*SubscriptBox[\(\[Epsilon]\), \(geom\)]\)\>\""}], 
       "}"}]}], "}"}], "//", "TableForm"}], "\[IndentingNewLine]", 
   RowBox[{
   "Print", "[", "\"\<Meanings of columns of the output data for decay \
products (each decay product corresponds to its 8 columns):\>\"", "]"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\"\<Column index\>\"", ",", "indexpx1", ",", "indexpy1", ",", 
        "indexpz1", ",", "indexE1", ",", "indexm1", ",", "indexpdg1", ",", 
        "indexcharge1", ",", "indexstability1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"\"\<Meaning\>\"", 
        ",", "\"\<\!\(\*FractionBox[SubscriptBox[\(p\), \(decay\\\ product, x\
\)], \(GeV\)]\)\>\"", 
        ",", "\"\<\!\(\*FractionBox[SubscriptBox[\(p\), \(decay\\\ product, y\
\)], \(GeV\)]\)\>\"", 
        ",", "\"\<\!\(\*FractionBox[SubscriptBox[\(p\), \(decay\\\ product, z\
\)], \(GeV\)]\)\>\"", 
        ",", "\"\<\!\(\*FractionBox[SubscriptBox[\(E\), \(decay\\\ \
product\)], \(GeV\)]\)\>\"", 
        ",", "\"\<\!\(\*FractionBox[SubscriptBox[\(m\), \(decay\\\ \
product\)], \(GeV\)]\)\>\"", 
        ",", "\"\<\!\(\*SubscriptBox[\(pdg\), \(decay\\\ product\)]\)\>\"", 
        ",", "\"\<electric \!\(\*SubscriptBox[\(charge\), \(decay\\\ \
product\)]\)\>\"", 
        ",", "\"\<\!\(\*SubscriptBox[\(stability\), \(decay\\\ product\)]\)\>\
\""}], "}"}]}], "}"}], "//", "TableForm"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.929292118136931*^9, 3.9292921254002676`*^9}, {
  3.9312372039058485`*^9, 3.931237205446406*^9}, {3.9312380653151054`*^9, 
  3.931238066634385*^9}, {3.9312487713798647`*^9, 3.9312488191687794`*^9}, {
  3.9312489509093294`*^9, 3.9312489622348194`*^9}, {3.9312490679573393`*^9, 
  3.9312491012475705`*^9}, {3.9312491500974503`*^9, 3.9312491746982813`*^9}, {
  3.931249272567936*^9, 3.9312492867794867`*^9}, {3.9312493762511973`*^9, 
  3.931249480139018*^9}, {3.9312495997067676`*^9, 3.9312496479559345`*^9}, {
  3.9312724553263426`*^9, 3.9312724643412085`*^9}, {3.9312725148489175`*^9, 
  3.931272517505901*^9}, {3.9312725622036037`*^9, 3.9312725653738647`*^9}, {
  3.9313201617805567`*^9, 3.931320214580812*^9}, {3.931320261940819*^9, 
  3.931320265652108*^9}, {3.9355932939213657`*^9, 3.93559330150922*^9}, {
  3.9355938783226604`*^9, 3.9355939737823887`*^9}},
 CellLabel->
  "In[119]:=",ExpressionUUID->"8f2a69c2-865b-4de9-8a45-878413b88af0"]
}, Closed]],

Cell[CellGroupData[{

Cell["Number of events", "Section",
 CellChangeTimes->{{3.935592737932188*^9, 
  3.9355927398197117`*^9}},ExpressionUUID->"396582a5-1fe7-fb48-b777-\
620fa4237a15"],

Cell[BoxData[
 RowBox[{
  RowBox[{"NeventsBlock", "[", 
   RowBox[{"mass_", ",", "coupling1_", ",", "coupling2_", ",", "Nevents_"}], 
   "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"c1", ",", "c2", ",", "m1"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"llpinfodata", ",", "decayproductsdata"}], "}"}], "=", 
      RowBox[{"SimulateFullEvent", "[", 
       RowBox[{"mass", ",", "coupling1", ",", "coupling2", ",", "Nevents"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "Computing", " ", "the", " ", "number", " ", "of", " ", "events", " ", 
       "with", " ", "decays", " ", "of", " ", "LLPs"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"NeventsVal", "=", 
      RowBox[{"NeventsLLP", "[", "llpinfodata", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "Converting", " ", "the", " ", "parameters", " ", "to", " ", 
       "strings"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"c1", ",", "c2"}], "}"}], "=", 
      RowBox[{
       RowBox[{
        RowBox[{"ToString", "[", 
         RowBox[{"ScientificForm", "[", 
          RowBox[{
           RowBox[{"N", "[", "#", "]"}], ",", 
           RowBox[{"NumberFormat", "->", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Row", "[", 
               RowBox[{"{", 
                RowBox[{"#1", ",", "\"\<e\>\"", ",", "#3"}], "}"}], "]"}], 
              "&"}], ")"}]}]}], "]"}], "]"}], "&"}], "/@", 
       RowBox[{"{", 
        RowBox[{"coupling1", ",", "coupling2"}], "}"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"m1", "=", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"mass", "//", "CForm"}], "//", "ToString"}], ")"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Export", "[", 
      RowBox[{
       RowBox[{"FileNameJoin", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"NotebookDirectory", "[", "]"}], 
          ",", "\"\<Sampled Nevents\>\"", ",", "GivenExperiment", ",", 
          "LLPdirName", ",", 
          
          RowBox[{"\"\<DecayEvents_mass=\>\"", "<>", "m1", 
           "<>", "\"\<_coupling1=\>\"", "<>", "c1", 
           "<>", "\"\<_coupling2=\>\"", "<>", "c2", "<>", "\"\<.mx\>\""}]}], 
         "}"}], "]"}], ",", "decayproductsdata", ",", "\"\<MX\>\""}], "]"}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"Export", "[", 
      RowBox[{
       RowBox[{"FileNameJoin", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"NotebookDirectory", "[", "]"}], 
          ",", "\"\<Sampled Nevents\>\"", ",", "GivenExperiment", ",", 
          "LLPdirName", ",", 
          
          RowBox[{"\"\<LLPinfo_mass=\>\"", "<>", "m1", 
           "<>", "\"\<_coupling1=\>\"", "<>", "c1", 
           "<>", "\"\<_coupling2=\>\"", "<>", "c2", "<>", "\"\<.mx\>\""}]}], 
         "}"}], "]"}], ",", "llpinfodata", ",", "\"\<MX\>\""}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"NeventsVal", ",", "llpinfodata", ",", "decayproductsdata"}], 
      "}"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.935592742185587*^9, 3.9355929386818542`*^9}, {
   3.9355930103148804`*^9, 3.9355930193230343`*^9}, {3.9355932514526615`*^9, 
   3.9355932667886734`*^9}, 3.935593331533554*^9, {3.952754693209215*^9, 
   3.952754698576994*^9}},
 CellLabel->
  "In[125]:=",ExpressionUUID->"25e2f44f-2a84-4448-b0ea-b3bf2d255fb6"],

Cell[CellGroupData[{

Cell["Test", "Subsection",
 CellChangeTimes->{{3.9355145085618043`*^9, 
  3.9355145091535654`*^9}},ExpressionUUID->"b0cc6841-d84b-4e45-8542-\
889956770896"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.952755769151144*^9, 3.952755770300045*^9}, {
  3.952755828139124*^9, 
  3.952755854544029*^9}},ExpressionUUID->"cf517137-e25a-a341-b9c5-\
c71512772f70"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"mt", "=", "4.2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"proctot", "=", 
   RowBox[{
    RowBox[{"Select", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Keys", "[", 
        RowBox[{"DownValues", "@", "GridInFinal"}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "1", ",", "1"}], "]"}], "]"}], ",", 
      RowBox[{
       RowBox[{"StringContainsQ", "[", 
        RowBox[{"#", ",", "\"\<Total\>\""}], "]"}], "&"}]}], "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mommax", "=", 
   RowBox[{
    RowBox[{"10", "^", 
     RowBox[{
      RowBox[{"GridInFinal", "[", "proctot", "]"}], "[", 
      RowBox[{"[", "3", "]"}], "]"}]}], "//", "Max"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"coupling1val", "=", 
  RowBox[{"3", 
   FractionBox[
    RowBox[{
     RowBox[{"c\[Tau]LLP", "[", 
      RowBox[{"mt", ",", "1"}], "]"}], 
     FractionBox["mommax", "mt"]}], "zDecVolMin"]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"coupling2val", "=", "0."}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Exp", "[", 
     RowBox[{
      RowBox[{"-", "zDecVolMin"}], "/", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"c\[Tau]LLP", "[", 
         RowBox[{"mt", ",", "coupling1val"}], "]"}], 
        FractionBox["mommax", "mt"]}], ")"}]}], "]"}], ">", 
    SuperscriptBox["10", 
     RowBox[{"-", "10."}]]}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"NeventsVal", ",", "llpinfodata", ",", "decayproductsdata"}], 
      "}"}], "=", 
     RowBox[{"NeventsBlock", "[", 
      RowBox[{"mt", ",", "coupling1val", ",", "coupling2val", ",", 
       SuperscriptBox["10", "6"]}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"Print", "[", 
     RowBox[{"Row", "[", 
      RowBox[{"{", 
       RowBox[{"\"\<Number of events: \>\"", ",", "NeventsVal"}], "}"}], 
      "]"}], "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"___", "___", "___", "___", "___", "___", "__"}], "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
     "Plot", " ", "decay", " ", "vertices", " ", "and", " ", "energies", " ", 
      "distributions"}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"___", "___", "___", "___", "___", "___", "__"}], "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{"energies", "=", 
     RowBox[{"llpinfodata", "[", 
      RowBox[{"[", 
       RowBox[{"All", ",", "indexenergy"}], "]"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"DecPos", "=", 
     RowBox[{"llpinfodata", "[", 
      RowBox[{"[", 
       RowBox[{"All", ",", 
        RowBox[{"{", 
         RowBox[{"indexxdec", ",", "indexydec", ",", "indexzdec"}], "}"}]}], 
       "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"wts1", "=", 
     RowBox[{"wts2", "=", 
      RowBox[{
       RowBox[{"llpinfodata", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "indexpdec"}], "]"}], "]"}], "*", 
       RowBox[{"llpinfodata", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "indexazacc"}], "]"}], "]"}]}]}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"TruePos", "=", 
     RowBox[{"RandomChoice", "[", 
      RowBox[{
       RowBox[{"wts1", "->", "DecPos"}], ",", 
       SuperscriptBox["10", "4"]}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"TrueEn", "=", 
     RowBox[{"RandomChoice", "[", 
      RowBox[{
       RowBox[{"wts2", "->", "energies"}], ",", 
       SuperscriptBox["10", "4"]}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"xminmaxplot", ",", "yminmaxplot", ",", "zminmaxplot"}], "}"}], 
     "=", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"DecPos", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "#"}], "]"}], "]"}], "//", "MinMax"}], ")"}], 
       "&"}], "/@", 
      RowBox[{"{", 
       RowBox[{"1", ",", "2", ",", "3"}], "}"}]}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"yminmaxplot", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "3"}], ",", "3"}], "}"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"zminmaxplot", "=", 
     RowBox[{"zminmaxplot", "+", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1"}], ",", "1"}], "}"}], 
       RowBox[{"Min", "[", 
        RowBox[{"1", ",", 
         FractionBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"zminmaxplot", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "-", 
            RowBox[{"zminmaxplot", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "10"]}], "]"}]}]}]}], ";",
     "\[IndentingNewLine]", 
    RowBox[{"pt1", "=", 
     RowBox[{"Show", "[", 
      RowBox[{
       RowBox[{"ListPointPlot3D", "[", 
        RowBox[{"TruePos", ",", 
         RowBox[{"PlotStyle", "->", 
          RowBox[{"{", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Thickness", "[", "0.01", "]"}], ",", "Blue"}], "}"}], 
           "}"}]}]}], "]"}], ",", "plotExperiment"}], 
      RowBox[{"(*", 
       RowBox[{",", 
        RowBox[{"PlotRange", "->", 
         RowBox[{"{", 
          RowBox[{"xminmaxplot", ",", "yminmaxplot", ",", "zminmaxplot"}], 
          "}"}]}]}], "*)"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"pt2", "=", 
     RowBox[{"Histogram", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"TrueEn", ",", "energies"}], "}"}], ",", "100", 
       ",", "\"\<ProbabilityDensity\>\"", ",", 
       RowBox[{"PlotRange", "->", "All"}], ",", 
       RowBox[{"ScalingFunctions", "->", 
        RowBox[{"{", 
         RowBox[{"\"\<Linear\>\"", ",", "\"\<Log\>\""}], "}"}]}]}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
   RowBox[{
   "Print", "[", "\"\<The selected combination of masses and couplings gives \
too small decay lengths for the given experiment!\>\"", "]"}]}], 
  "\[IndentingNewLine]", 
  "]"}], "\[IndentingNewLine]", "pt1", "\[IndentingNewLine]", "pt2"}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.9355145129228897`*^9, 3.9355145180313697`*^9}, {
   3.93551524589025*^9, 3.935515248343539*^9}, {3.9355165252114844`*^9, 
   3.935516538293006*^9}, {3.9355185391812334`*^9, 3.935518552753319*^9}, {
   3.935518695041445*^9, 3.935518723449641*^9}, {3.9355187608716726`*^9, 
   3.935518763378657*^9}, {3.9355901868625298`*^9, 3.935590211948803*^9}, {
   3.9355911675403576`*^9, 3.9355911677784615`*^9}, {3.935591519232479*^9, 
   3.9355915291480427`*^9}, {3.935592201353079*^9, 3.9355922678044453`*^9}, {
   3.9355923411224613`*^9, 3.9355923418910904`*^9}, {3.935592387186737*^9, 
   3.9355925521936264`*^9}, {3.9355927168753357`*^9, 3.935592720009775*^9}, {
   3.935592959591543*^9, 3.9355930293936863`*^9}, {3.93689235446905*^9, 
   3.9368923544870863`*^9}, {3.936892415955196*^9, 3.936892456066779*^9}, {
   3.9368931872123823`*^9, 3.9368931963525343`*^9}, {3.936894780333334*^9, 
   3.936894780399886*^9}, {3.942382164411627*^9, 3.9423821732933464`*^9}, {
   3.94238643924275*^9, 3.9423864492902718`*^9}, {3.94238736235256*^9, 
   3.9423873939422855`*^9}, {3.942388537156513*^9, 3.9423885392155247`*^9}, {
   3.9423885832122383`*^9, 3.942388608039427*^9}, {3.942388641211546*^9, 
   3.942388664912052*^9}, {3.9423906618277016`*^9, 3.942390664157633*^9}, {
   3.942390754902113*^9, 3.9423907807530384`*^9}, {3.9423913542376537`*^9, 
   3.9423913563234673`*^9}, {3.94239214651906*^9, 3.942392148291954*^9}, {
   3.942392397340143*^9, 3.9423923997061653`*^9}, {3.9423924351560364`*^9, 
   3.942392436526701*^9}, {3.9423944344400444`*^9, 3.9423944347439804`*^9}, {
   3.9424029134507465`*^9, 3.942402913800028*^9}, {3.942404363913088*^9, 
   3.942404364108612*^9}, {3.9424044410926456`*^9, 3.9424044411437073`*^9}, {
   3.942416203956867*^9, 3.942416214909418*^9}, {3.9424164236170444`*^9, 
   3.9424164238230457`*^9}, {3.9424165750866013`*^9, 
   3.9424165753461914`*^9}, {3.9424166082679214`*^9, 3.942416608582802*^9}, {
   3.942417382489702*^9, 3.942417383109398*^9}, {3.9424177163678493`*^9, 
   3.942417717014412*^9}, {3.9424181421167984`*^9, 3.942418142156975*^9}, {
   3.942469479587698*^9, 3.9424694797157154`*^9}, {3.942469637088991*^9, 
   3.9424696374503384`*^9}, {3.942469788155035*^9, 3.942469788421812*^9}, {
   3.94247107889415*^9, 3.9424710790932503`*^9}, {3.94268629086882*^9, 
   3.9426863055219364`*^9}, {3.9426870350109596`*^9, 
   3.9426870355286884`*^9}, {3.9426870881981754`*^9, 
   3.9426870883304214`*^9}, {3.9426871613963127`*^9, 
   3.9426872123288383`*^9}, {3.942689902981447*^9, 3.942690045817444*^9}, {
   3.942690131838808*^9, 3.942690150195631*^9}, {3.942690272137577*^9, 
   3.942690295220297*^9}, {3.942691031661577*^9, 3.942691031698183*^9}, {
   3.942719193975645*^9, 3.9427191940742702`*^9}, {3.942920085999201*^9, 
   3.942920294502367*^9}, {3.9527545091285343`*^9, 3.9527545260180073`*^9}, {
   3.952755566160324*^9, 3.9527556066430893`*^9}, {3.952755653039591*^9, 
   3.9527556555304184`*^9}, 3.952755773659933*^9, 3.9527558491376514`*^9, {
   3.953175089010351*^9, 3.953175106503187*^9}, {3.9531752917848396`*^9, 
   3.9531752951867256`*^9}},ExpressionUUID->"f6e7f234-afb7-4e28-9a3c-\
95c4419a9cbd"],

Cell[CellGroupData[{

Cell["Some plots", "Subsubsection",
 CellChangeTimes->{{3.942690174719019*^9, 
  3.9426901783165646`*^9}},ExpressionUUID->"cc999dc2-daa0-3540-b813-\
2bf9b119caf2"],

Cell[BoxData[
 RowBox[{"(*", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"binnedData", "[", 
     RowBox[{"data_", ",", "\[CapitalDelta]_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "datamin", ",", "datamax", ",", "binspos", ",", "bins", ",", 
         "dataconv", ",", "tot"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"datamin", ",", "datamax"}], "}"}], "=", 
         RowBox[{"MinMax", "[", "data", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"tot", "=", 
         RowBox[{"Total", "[", "data", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"binspos", "=", 
         RowBox[{"Table", "[", 
          RowBox[{"x", ",", 
           RowBox[{"{", 
            RowBox[{"x", ",", "datamin", ",", 
             RowBox[{"datamax", "-", "\[CapitalDelta]"}], ",", 
             "\[CapitalDelta]"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"bins", "=", 
         RowBox[{"BinCounts", "[", 
          RowBox[{"data", ",", 
           RowBox[{"{", 
            RowBox[{"datamin", ",", "datamax", ",", "\[CapitalDelta]"}], 
            "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"dataconv", "=", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"binspos", ",", "bins"}], "}"}], "//", "Transpose"}]}], ";",
         "\[IndentingNewLine]", 
        RowBox[{"tot", "=", 
         RowBox[{"Total", "[", 
          RowBox[{"dataconv", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"dataconv", "=", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"#", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", 
               FractionBox[
                RowBox[{"#", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], 
                RowBox[{"\[CapitalDelta]", "*", "tot"}]]}], "}"}], "&"}], "/@",
             "dataconv"}], ")"}], "//", "Developer`ToPackedArray"}]}]}]}], 
      "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
     RowBox[{"decproddatae", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Partition", "[", 
           RowBox[{
            RowBox[{"Flatten", "[", "decayproductsdata", "]"}], ",", 
            "LengthDataProduct"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Abs", "[", 
             RowBox[{"#", "[", 
              RowBox[{"[", "indexpdg1", "]"}], "]"}], "]"}], "==", "11."}], 
           "&"}]}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "indexE1"}], "]"}], "]"}], "//", "N"}]}]}]}], ";",
    "\[IndentingNewLine]", 
   RowBox[{"decproddata\[Mu]", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"Select", "[", 
       RowBox[{
        RowBox[{"Partition", "[", 
         RowBox[{
          RowBox[{"Flatten", "[", "decayproductsdata", "]"}], ",", 
          "LengthDataProduct"}], "]"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"Abs", "[", 
           RowBox[{"#", "[", 
            RowBox[{"[", "indexpdg1", "]"}], "]"}], "]"}], "==", "13."}], 
         "&"}]}], "]"}], "[", 
      RowBox[{"[", 
       RowBox[{"All", ",", "indexE1"}], "]"}], "]"}], "//", "N"}]}], ";", 
   "\[IndentingNewLine]", 
   RowBox[{"ListLogPlot", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"binnedData", "[", 
        RowBox[{"energies", ",", "10"}], "]"}], ",", 
       RowBox[{"binnedData", "[", 
        RowBox[{"decproddatae", ",", "10"}], "]"}], ",", 
       RowBox[{"binnedData", "[", 
        RowBox[{"decproddata\[Mu]", ",", "10"}], "]"}]}], "}"}], ",", 
     RowBox[{"InterpolationOrder", "->", "0"}], ",", 
     RowBox[{"Joined", "->", "True"}], ",", 
     RowBox[{"Frame", "->", "True"}], ",", 
     RowBox[{"FrameStyle", "->", 
      RowBox[{"Directive", "[", 
       RowBox[{"Black", ",", "Thick", ",", "18"}], "]"}]}], ",", 
     RowBox[{"FrameLabel", "->", 
      RowBox[{"{", 
       RowBox[{"\"\<E [GeV]\>\"", ",", "\"\<Yield\>\""}], "}"}]}], ",", 
     RowBox[{"ImageSize", "->", "Large"}], ",", 
     RowBox[{"PlotRange", "->", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0.5", ",", "1000"}], "}"}], ",", "All"}], "}"}]}]}], 
    "]"}]}], "\[IndentingNewLine]", "*)"}]], "Input",
 CellChangeTimes->{{3.942690420952881*^9, 3.9426906288732433`*^9}, {
  3.942690815619385*^9, 3.942690827817194*^9}, {3.942690870616783*^9, 
  3.942690874282749*^9}, {3.9426909988657913`*^9, 3.9426910131293564`*^9}, {
  3.9426910603157463`*^9, 3.942691064419012*^9}, {3.9426911994946175`*^9, 
  3.9426912090635986`*^9}, {3.9527545509225044`*^9, 3.9527545524395275`*^9}, {
  3.952754798040161*^9, 
  3.9527548023307*^9}},ExpressionUUID->"98e002cc-50db-fe42-8cc6-f15b550659f8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"datamerged", "=", 
                RowBox[{
                 RowBox[{"Join", "[", 
                  RowBox[{"decayproductsdata", ",", "llpinfodata", ",", "2"}],
                   "]"}], "//", "Developer`ToPackedArray"}]}], ";"}], "//", 
              RowBox[{
              "AbsoluteTiming", "\[IndentingNewLine]", "fastselector"}]}], "=", 
             RowBox[{
              RowBox[{
               RowBox[{"Hold", "@", 
                RowBox[{"Compile", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"{", 
                    RowBox[{"data", ",", "_Real", ",", "2"}], "}"}], "}"}], ",", 
                  RowBox[{"Select", "[", 
                   RowBox[{"data", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"11.", ",", "12."}], "}"}], ",", 
                    RowBox[{"Abs", "[", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "indexpdg1", "]"}], "]"}], "]"}]}], "]"}], "&&", 
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"11.", ",", "12."}], "}"}], ",", 
                    RowBox[{"Abs", "[", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", 
                    RowBox[{"LengthDataProduct", "+", "indexpdg1"}], "]"}], 
                    "]"}], "]"}]}], "]"}]}], "&"}]}], "]"}], ",", 
                  RowBox[{"CompilationTarget", "->", "\"\<C\>\""}], ",", 
                  RowBox[{"RuntimeOptions", "->", "\"\<Speed\>\""}]}], 
                 "]"}]}], "/.", 
               RowBox[{"ruleOwn", "[", 
                RowBox[{"{", 
                 RowBox[{"indexpdg1", ",", "LengthDataProduct"}], "}"}], 
                "]"}]}], "//", "ReleaseHold"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"subdata", "=", 
             RowBox[{"fastselector", "[", "decayproductsdata", "]"}]}], ";"}],
            "//", 
           RowBox[{"AbsoluteTiming", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"llpdatasel", "=", 
              RowBox[{"subdata", "[", 
               RowBox[{"[", 
                RowBox[{"All", ",", 
                 RowBox[{"Range", "[", 
                  RowBox[{
                   RowBox[{"-", "14"}], ",", 
                   RowBox[{"-", "1"}]}], "]"}]}], "]"}], "]"}]}], ";"}]}]}], "//", 
          RowBox[{"AbsoluteTiming", "\[IndentingNewLine]", 
           RowBox[{"llpdatasel", "=", 
            RowBox[{"Riffle", "[", 
             RowBox[{"llpdatasel", ",", "llpdatasel"}], "]"}]}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"epemdatasel", "=", 
          RowBox[{"Partition", "[", 
           RowBox[{
            RowBox[{"Flatten", "[", 
             RowBox[{"subdata", "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", 
                RowBox[{"Range", "[", 
                 RowBox[{"1", ",", "16"}], "]"}]}], "]"}], "]"}], "]"}], ",", 
            "LengthDataProduct"}], "]"}]}], ";"}], "//", 
        RowBox[{"AbsoluteTiming", "\[IndentingNewLine]", "pointingtodet"}]}], 
       "=", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Hold", "@", 
           RowBox[{"Compile", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"data", ",", "_Real", ",", "1"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"llpdata", ",", "_Real", ",", "1"}], "}"}]}], "}"}], ",", 
             RowBox[{"Module", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                "energies", ",", "px", ",", "py", ",", "pz", ",", "xmother", ",",
                  "ymother", ",", "zmother", ",", "xprojtodet", ",", 
                 "yprojtodet", ",", "cond"}], "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"energies", "=", 
                 RowBox[{"Compile`GetElement", "[", 
                  RowBox[{"data", ",", "indexE1"}], "]"}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"px", "=", 
                 RowBox[{"Compile`GetElement", "[", 
                  RowBox[{"data", ",", "indexpx"}], "]"}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"py", "=", 
                 RowBox[{"Compile`GetElement", "[", 
                  RowBox[{"data", ",", "indexpy"}], "]"}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"pz", "=", 
                 RowBox[{"Compile`GetElement", "[", 
                  RowBox[{"data", ",", "indexpz"}], "]"}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"xmother", "=", 
                 RowBox[{"Compile`GetElement", "[", 
                  RowBox[{"data", ",", "indexxdec"}], "]"}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"ymother", "=", 
                 RowBox[{"Compile`GetElement", "[", 
                  RowBox[{"data", ",", "indexydec"}], "]"}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"zmother", "=", 
                 RowBox[{"Compile`GetElement", "[", 
                  RowBox[{"data", ",", "indexzdec"}], "]"}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"xprojtodet", "=", 
                 RowBox[{"xmother", "+", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"zDecVolMax", "-", "zmother"}], ")"}], "*", 
                   RowBox[{"px", "/", "pz"}]}]}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"yprojtodet", "=", 
                 RowBox[{"ymother", "+", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"zDecVolMax", "-", "zmother"}], ")"}], "*", 
                   RowBox[{"py", "/", "pz"}]}]}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"cond", "=", 
                 RowBox[{"Boole", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    "xToDecayVolumeCenterGivenExperiment", "[", "zDecVolMax", 
                    "]"}], "-", 
                    RowBox[{
                    "dxDecayVolumeGivenExperiment", "[", "zDecVolMax", 
                    "]"}]}], "<=", "xprojtodet", "<=", 
                    RowBox[{
                    RowBox[{
                    "xToDecayVolumeCenterGivenExperiment", "[", "zDecVolMax", 
                    "]"}], "+", 
                    RowBox[{
                    "dxDecayVolumeGivenExperiment", "[", "zDecVolMax", 
                    "]"}]}]}], "&&", 
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    "yToDecayVolumeCenterGivenExperiment", "[", "zDecVolMax", 
                    "]"}], "-", 
                    RowBox[{
                    "dyDecayVolumeGivenExperiment", "[", "zDecVolMax", 
                    "]"}]}], "<=", "yprojtodet", "<=", 
                    RowBox[{
                    RowBox[{
                    "yToDecayVolumeCenterGivenExperiment", "[", "zDecVolMax", 
                    "]"}], "+", 
                    RowBox[{
                    "dyDecayVolumeGivenExperiment", "[", "zDecVolMax", 
                    "]"}]}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
                RowBox[{"{", 
                 RowBox[{"energies", ",", "cond"}], "}"}]}]}], 
              "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", ",", 
             RowBox[{"CompilationTarget", "->", "\"\<C\>\""}], ",", 
             RowBox[{"RuntimeOptions", "->", "\"\<Speed\>\""}], ",", 
             RowBox[{"RuntimeAttributes", "->", 
              RowBox[{"{", "Listable", "}"}]}]}], "]"}]}], "/.", 
          RowBox[{"ruleOwn", "[", 
           RowBox[{"{", 
            RowBox[{
            "indexE1", ",", "indexpx", ",", "indexpy", ",", "indexpz", ",", 
             "indexxdec", ",", "indexydec", ",", "indexzdec", ",", 
             "zDecVolMax"}], "}"}], "]"}]}], "/.", 
         RowBox[{"ruleDown", "[", 
          RowBox[{"{", 
           RowBox[{
           "xToDecayVolumeCenterExperiment", ",", 
            "dxDecayVolumeGivenExperiment", ",", 
            "yToDecayVolumeCenterGivenExperiment", ",", 
            "dyDecayVolumeGivenExperiment"}], "}"}], "]"}]}], "//", 
        "ReleaseHold"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"pointingelectrons", "=", 
       RowBox[{"pointingtodet", "[", 
        RowBox[{"epemdatasel", ",", "llpdatasel"}], "]"}]}], ";"}], "//", 
     RowBox[{"AbsoluteTiming", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"pointingelectrons", "=", 
        RowBox[{"Select", "[", 
         RowBox[{"pointingelectrons", ",", 
          RowBox[{
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "==", "1."}], "&"}]}], "]"}]}], 
       ";"}]}]}], "//", 
    RowBox[{"AbsoluteTiming", "\[IndentingNewLine]", 
     RowBox[{"ListLogPlot", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"binnedData", "[", 
          RowBox[{"energies", ",", "10"}], "]"}], ",", 
         RowBox[{"binnedData", "[", 
          RowBox[{
           RowBox[{"pointingelectrons", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", "10"}], "]"}]}], 
        "}"}], ",", 
       RowBox[{"InterpolationOrder", "->", "0"}], ",", 
       RowBox[{"Joined", "->", "True"}], ",", 
       RowBox[{"Frame", "->", "True"}], ",", 
       RowBox[{"FrameStyle", "->", 
        RowBox[{"Directive", "[", 
         RowBox[{"Black", ",", "Thick", ",", "18"}], "]"}]}], ",", 
       RowBox[{"FrameLabel", "->", 
        RowBox[{"{", 
         RowBox[{"\"\<E [GeV]\>\"", ",", "\"\<Yield\>\""}], "}"}]}], ",", 
       RowBox[{"ImageSize", "->", "Large"}], ",", 
       RowBox[{"PlotRange", "->", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0.5", ",", "1000"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            SuperscriptBox["10", 
             RowBox[{"-", "5"}]], ",", "0.02"}], "}"}]}], "}"}]}], ",", 
       RowBox[{"PlotStyle", "->", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"Thick", ",", "Blue"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"Thick", ",", 
            RowBox[{"Darker", "@", "Red"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"Thick", ",", 
            RowBox[{"Darker", "@", 
             RowBox[{"Darker", "@", "Green"}]}]}], "}"}]}], "}"}]}], ",", 
       RowBox[{"PlotLegends", "->", 
        RowBox[{"Placed", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Style", "[", 
             RowBox[{
              RowBox[{"Row", "[", 
               RowBox[{"{", "#", "}"}], "]"}], ",", "18"}], "]"}], "&"}], "/@", 
           RowBox[{"{", 
            
            RowBox[{"\"\<HNL\>\"", 
             ",", "\"\<\!\(\*SuperscriptBox[\(e\), \(+\(/\(-\)\)\)]\)\>\"", 
             ",", "\"\<\!\(\*SuperscriptBox[\(e\), \
\(+\)]\)+\!\(\*SuperscriptBox[\(e\), \(-\)]\)\>\""}], "}"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"0.8", ",", "0.8"}], "}"}]}], "]"}]}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"decproddatae1", "=", 
     RowBox[{
      RowBox[{"Select", "[", 
       RowBox[{
        RowBox[{"Partition", "[", 
         RowBox[{
          RowBox[{"Flatten", "[", "subdata", "]"}], ",", 
          "LengthDataProduct"}], "]"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"Abs", "[", 
           RowBox[{"#", "[", 
            RowBox[{"[", "indexpdg1", "]"}], "]"}], "]"}], "==", "11."}], 
         "&"}]}], "]"}], "[", 
      RowBox[{"[", 
       RowBox[{"All", ",", "indexE1"}], "]"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"decproddatae2", "=", 
     RowBox[{
      RowBox[{"subdata", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "indexE1"}], "]"}], "]"}], "+", 
      RowBox[{"subdata", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", 
         RowBox[{"LengthDataProduct", "+", "indexE1"}]}], "]"}], "]"}]}]}], ";",
     "\[IndentingNewLine]", 
    RowBox[{"ListLogPlot", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"binnedData", "[", 
         RowBox[{"energies", ",", "10"}], "]"}], ",", 
        RowBox[{"binnedData", "[", 
         RowBox[{"decproddatae1", ",", "10"}], "]"}], ",", 
        RowBox[{"binnedData", "[", 
         RowBox[{"decproddatae2", ",", "10"}], "]"}]}], "}"}], ",", 
      RowBox[{"InterpolationOrder", "->", "0"}], ",", 
      RowBox[{"Joined", "->", "True"}], ",", 
      RowBox[{"Frame", "->", "True"}], ",", 
      RowBox[{"FrameStyle", "->", 
       RowBox[{"Directive", "[", 
        RowBox[{"Black", ",", "Thick", ",", "18"}], "]"}]}], ",", 
      RowBox[{"FrameLabel", "->", 
       RowBox[{"{", 
        RowBox[{"\"\<E [GeV]\>\"", ",", "\"\<Yield\>\""}], "}"}]}], ",", 
      RowBox[{"ImageSize", "->", "Large"}], ",", 
      RowBox[{"PlotRange", "->", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0.5", ",", "1000"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SuperscriptBox["10", 
            RowBox[{"-", "5"}]], ",", "0.02"}], "}"}]}], "}"}]}], ",", 
      RowBox[{"PlotStyle", "->", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"Thick", ",", "Blue"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"Thick", ",", 
           RowBox[{"Darker", "@", "Red"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"Thick", ",", 
           RowBox[{"Darker", "@", 
            RowBox[{"Darker", "@", "Green"}]}]}], "}"}]}], "}"}]}], ",", 
      RowBox[{"PlotLegends", "->", 
       RowBox[{"Placed", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Style", "[", 
            RowBox[{
             RowBox[{"Row", "[", 
              RowBox[{"{", "#", "}"}], "]"}], ",", "18"}], "]"}], "&"}], "/@", 
          RowBox[{"{", 
           
           RowBox[{"\"\<HNL\>\"", 
            ",", "\"\<\!\(\*SuperscriptBox[\(e\), \(+\(/\(-\)\)\)]\)\>\"", 
            ",", "\"\<\!\(\*SuperscriptBox[\(e\), \
\(+\)]\)+\!\(\*SuperscriptBox[\(e\), \(-\)]\)\>\""}], "}"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"0.8", ",", "0.8"}], "}"}]}], "]"}]}]}], "]"}]}], 
   "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.942692032433481*^9, 3.9426920859307575`*^9}, {
  3.9427174364852886`*^9, 3.9427176019880657`*^9}, {3.942717633853071*^9, 
  3.942717639352848*^9}, {3.9427177167363396`*^9, 3.9427178188910103`*^9}, {
  3.9427178630050106`*^9, 3.9427179624681244`*^9}, {3.9427180077899895`*^9, 
  3.942718171896961*^9}, {3.9427183018790684`*^9, 3.942718349745983*^9}, {
  3.942718524246872*^9, 3.9427185244766197`*^9}, {3.942718564016407*^9, 
  3.942718583145252*^9}, {3.9527548047483273`*^9, 
  3.9527548250249577`*^9}},ExpressionUUID->"3419e02b-da8d-8b40-a781-\
3452defdbcb5"]
}, Closed]]
}, Closed]]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Deleting generated cells", "Title",
 CellChangeTimes->{{3.9025559465149946`*^9, 3.9025559494966087`*^9}, {
  3.952674884776943*^9, 
  3.952674885034134*^9}},ExpressionUUID->"7c97f940-7ead-b842-8095-\
45b248b622f1"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"FrontEndTokenExecute", "[", "\"\<DeleteGeneratedCells\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FrontEndTokenExecute", "[", "\"\<SelectAll\>\"", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
  "FrontEndTokenExecute", "[", "\"\<SelectionCloseAllGroups\>\"", "]"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.9025559062888603`*^9, 3.9025559062888603`*^9}, {
   3.902555964086707*^9, 3.902555989355214*^9}, 3.902763734669232*^9, {
   3.9028879544685755`*^9, 3.9028879657921314`*^9}, 3.90397199508119*^9, {
   3.918148957043585*^9, 3.918148960638934*^9}, 3.920048324604501*^9},
 CellLabel->"In[92]:=",ExpressionUUID->"e682b0d6-d98e-8b43-9236-aecd4d7a068d"]
}, Closed]]
},
WindowSize->{1430.25, 822.75},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
TaggingRules-><|"TryRealOnly" -> False|>,
Magnification:>0.8 Inherited,
FrontEndVersion->"14.2 for Microsoft Windows (64-bit) (December 26, 2024)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"23953e0f-70ed-4538-a808-a0d555182295"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 304, 6, 35, "Input",ExpressionUUID->"e48741f4-d7ea-4a1f-aeca-cc471a20eaa8",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[887, 30, 162, 2, 54, "Chapter",ExpressionUUID->"309ca6dc-5dcd-4fac-bc36-d4ca34b042f1"],
Cell[CellGroupData[{
Cell[1074, 36, 163, 3, 52, "Section",ExpressionUUID->"b06f5bd6-0c91-9d43-bd67-f7554cbf5a90"],
Cell[1240, 41, 1345, 33, 172, "Input",ExpressionUUID->"d1c265a8-6017-1641-acde-aba97604e0fe",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[2622, 79, 175, 3, 52, "Section",ExpressionUUID->"975d4b5b-fa34-304b-92d8-52ba48280626"],
Cell[2800, 84, 7270, 156, 328, "Input",ExpressionUUID->"6b3da654-3646-40f6-9bdc-8840cd813b38",
 InitializationCell->True]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[10119, 246, 222, 4, 46, "Chapter",ExpressionUUID->"05ff3def-5697-4842-a091-2dd9fc218e17"],
Cell[10344, 252, 8486, 204, 400, "Input",ExpressionUUID->"3ff7e400-0b7d-4317-b982-2b96307f80cc",
 InitializationCell->True],
Cell[18833, 458, 123, 2, 22, "Input",ExpressionUUID->"22936e8a-adce-c046-891b-8abcd64da5c9"],
Cell[CellGroupData[{
Cell[18981, 464, 164, 3, 52, "Section",ExpressionUUID->"fbf199d8-8255-a046-8485-515a118c9adf"],
Cell[19148, 469, 20702, 542, 1289, "Input",ExpressionUUID->"51a8fd1f-5b4c-4b48-82b5-ba2ff69fa881",
 InitializationCell->True]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[39899, 1017, 212, 4, 46, "Chapter",ExpressionUUID->"7f5c9fea-cd89-8046-905e-ab5a7bf5e5e2"],
Cell[CellGroupData[{
Cell[40136, 1025, 157, 3, 52, "Section",ExpressionUUID->"58041813-d5c7-a642-a97b-b350e9efb100"],
Cell[40296, 1030, 7553, 182, 424, "Input",ExpressionUUID->"33fb2175-df24-4a7c-b6dc-9d9be161cfc8",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[47886, 1217, 199, 3, 52, "Section",ExpressionUUID->"de80b96a-dcc8-204c-b42a-5b696fab8938"],
Cell[CellGroupData[{
Cell[48110, 1224, 390, 8, 42, "Subsection",ExpressionUUID->"e5b02935-5ccf-4ab1-a6dc-a366ea6a2516"],
Cell[48503, 1234, 9641, 225, 720, "Input",ExpressionUUID->"9587b454-c907-4dfb-a80b-695120fcf98a",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[58181, 1464, 347, 5, 42, "Subsection",ExpressionUUID->"aa20eb65-0e1d-124a-91d1-667e6ce1b76b"],
Cell[58531, 1471, 3989, 94, 294, "Input",ExpressionUUID->"85149bd2-dab6-4bcf-bfaa-a52428db954e",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[62557, 1570, 190, 3, 42, "Subsection",ExpressionUUID->"3930e280-d7b3-fa4b-bf70-2821fd788c99"],
Cell[62750, 1575, 5108, 126, 161, "Input",ExpressionUUID->"f8e0def4-fcc3-6d42-9c60-754a4b50817b",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[67895, 1706, 169, 3, 42, "Subsection",ExpressionUUID->"9c6ac358-6cf1-fe44-89d0-81cd108bc747"],
Cell[68067, 1711, 9854, 247, 403, "Input",ExpressionUUID->"368444b8-ff9c-8043-b284-f41cf1da286c"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[77970, 1964, 175, 3, 52, "Section",ExpressionUUID->"da9ff4e5-da5e-a24d-a082-a0d19220af51"],
Cell[78148, 1969, 6569, 157, 370, "Input",ExpressionUUID->"c9d59fab-e8b4-43ed-af15-ac64c94ae3be",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[84742, 2130, 155, 3, 42, "Subsection",ExpressionUUID->"d7f43c24-e1b6-db4b-b684-9a1bcae79463"],
Cell[84900, 2135, 7121, 181, 178, "Input",ExpressionUUID->"5529301e-0d2d-4586-85f2-e6b1304bdb25",
 InitializationCell->True]
}, Closed]]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[92082, 2323, 306, 5, 46, "Chapter",ExpressionUUID->"5a2822fb-3011-49c1-80ce-9a4847be30a5"],
Cell[CellGroupData[{
Cell[92413, 2332, 379, 6, 52, "Section",ExpressionUUID->"14f8e125-dfca-42ae-9d52-eda2e4b53396"],
Cell[92795, 2340, 7646, 159, 356, "Input",ExpressionUUID->"bb0b7a41-9a64-4c51-93a3-128333c981fb",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[100478, 2504, 433, 6, 52, "Section",ExpressionUUID->"ce0758e7-5ee0-4c8f-9e31-a168f366d390"],
Cell[100914, 2512, 6877, 143, 311, "Input",ExpressionUUID->"8f2a69c2-865b-4de9-8a45-878413b88af0",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[107828, 2660, 163, 3, 52, "Section",ExpressionUUID->"396582a5-1fe7-fb48-b777-620fa4237a15"],
Cell[107994, 2665, 3560, 89, 187, "Input",ExpressionUUID->"25e2f44f-2a84-4448-b0ea-b3bf2d255fb6",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[111579, 2758, 156, 3, 42, "Subsection",ExpressionUUID->"b0cc6841-d84b-4e45-8542-889956770896"],
Cell[111738, 2763, 201, 4, 22, "Input",ExpressionUUID->"cf517137-e25a-a341-b9c5-c71512772f70"],
Cell[111942, 2769, 9275, 213, 483, "Input",ExpressionUUID->"f6e7f234-afb7-4e28-9a3c-95c4419a9cbd",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[121242, 2986, 163, 3, 35, "Subsubsection",ExpressionUUID->"cc999dc2-daa0-3540-b813-2bf9b119caf2"],
Cell[121408, 2991, 5024, 128, 256, "Input",ExpressionUUID->"98e002cc-50db-fe42-8cc6-f15b550659f8"],
Cell[126435, 3121, 15644, 375, 580, "Input",ExpressionUUID->"3419e02b-da8d-8b40-a781-3452defdbcb5"]
}, Closed]]
}, Closed]]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[142152, 3504, 220, 4, 57, "Title",ExpressionUUID->"7c97f940-7ead-b842-8095-45b248b622f1"],
Cell[142375, 3510, 727, 14, 59, "Input",ExpressionUUID->"e682b0d6-d98e-8b43-9236-aecd4d7a068d"]
}, Closed]]
}
]
*)

