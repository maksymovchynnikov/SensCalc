(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Wolfram 14.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       154,          7]
NotebookDataLength[    199297,       4388]
NotebookOptionsPosition[    191960,       4236]
NotebookOutlinePosition[    195625,       4307]
CellTagsIndexPosition[    195550,       4302]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Preliminary code: mother particles sampling", "Title",
 CellChangeTimes->{{3.913276942888595*^9, 3.9132769474755597`*^9}, {
  3.9132812505098085`*^9, 3.913281268291277*^9}, {3.9137148921405487`*^9, 
  3.9137149208189754`*^9}},
 CellTags->
  "Evaluation",ExpressionUUID->"e66f3502-2655-4647-8c0e-295abab6dc91"],

Cell[CellGroupData[{

Cell["Importing tabulated mother particles distributions", "Chapter",
 CellChangeTimes->{{3.913217578471983*^9, 3.9132175858480544`*^9}, {
  3.913221168302366*^9, 3.9132211692461157`*^9}, {3.9132769138630667`*^9, 
  3.9132769156991987`*^9}, {3.915704831034233*^9, 3.915704833365085*^9}},
 CellTags->
  "Evaluation",ExpressionUUID->"c5fa1a07-3d9b-9147-a47b-e2e700ea9f33"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "List", " ", "all", " ", "files", " ", "matching", " ", "the", " ", 
    "distribution", " ", "name", " ", "pattern"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"files", "=", 
     RowBox[{"FileNames", "[", 
      RowBox[{"\"\<DoubleDistr_*_*.txt\>\"", ",", 
       RowBox[{"FileNameJoin", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"NotebookDirectory", "[", "]"}], "//", 
            "ParentDirectory"}], "//", "ParentDirectory"}], ",", 
          "\"\<spectra/SM particles\>\""}], "}"}], "]"}], ",", "Infinity"}], 
      "]"}]}], ";"}], "\n", 
   RowBox[{"(*", 
    RowBox[{
    "Extracting", " ", "the", " ", "information", " ", "about", " ", "the", 
     " ", "facility", " ", "and", " ", "particle", " ", "from", " ", "the", 
     " ", "filename"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"extractData", "[", "filename_", "]"}], ":=", 
    RowBox[{
     RowBox[{"StringCases", "[", 
      RowBox[{
       RowBox[{"FileNameTake", "[", "filename", "]"}], ",", 
       RowBox[{
        RowBox[{"\"\<DoubleDistr_\>\"", "~~", 
         RowBox[{"facility", ":", 
          RowBox[{"(", 
           RowBox[{"Shortest", "[", "___", "]"}], ")"}]}], "~~", "\"\<_\>\"", 
         "~~", 
         RowBox[{"particle", ":", 
          RowBox[{"(", 
           RowBox[{"ShortestMatch", "[", "___", "]"}], ")"}]}], "~~", 
         "\"\<.txt\>\""}], ":>", 
        RowBox[{"{", 
         RowBox[{"facility", ",", "particle"}], "}"}]}]}], "]"}], "[", 
     RowBox[{"[", "1", "]"}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Extract", "<", "Particle", ">"}], ",", " ", 
     RowBox[{"<", "Facility", ">", 
      RowBox[{"pairs", " ", "and", " ", "remove", " ", "duplicates"}]}]}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"dataPairs", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"extractData", "[", "#", "]"}], "&"}], "/@", "files"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Sort", " ", "the", " ", "pairs", " ", "by", " ", "Facility"}], 
    "*)"}], "\n", 
   RowBox[{
    RowBox[{"sortedDataPairs", "=", 
     RowBox[{"SortBy", "[", 
      RowBox[{"dataPairs", ",", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{"#", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], "}"}], "&"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Importing", " ", "all", " ", "the", " ", "distributions"}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MotherImportingBlock", "[", 
     RowBox[{"Facility_", ",", "Particle_"}], "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"filenameimport", "=", 
        RowBox[{"ToString", "@", 
         RowBox[{"StringForm", "[", 
          RowBox[{"\"\<DoubleDistr_``_``.txt\>\"", ",", 
           RowBox[{"Sequence", "@@", 
            RowBox[{"{", 
             RowBox[{"Facility", ",", "Particle"}], "}"}]}]}], "]"}]}]}], ";",
        "\[IndentingNewLine]", 
       RowBox[{"dataimport", "=", 
        RowBox[{"Import", "[", 
         RowBox[{
          RowBox[{"FileNameJoin", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"NotebookDirectory", "[", "]"}], "//", 
               "ParentDirectory"}], "//", "ParentDirectory"}], ",", 
             "\"\<spectra/SM particles\>\"", ",", "filenameimport"}], "}"}], 
           "]"}], ",", "\"\<Table\>\""}], "]"}]}]}]}], "\[IndentingNewLine]", 
     "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"DataDistr", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"sortedDataPairs", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", 
         RowBox[{
          RowBox[{"sortedDataPairs", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "=", 
       RowBox[{"MotherImportingBlock", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"sortedDataPairs", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", 
         RowBox[{
          RowBox[{"sortedDataPairs", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", 
        RowBox[{"Length", "[", "sortedDataPairs", "]"}]}], "}"}]}], "]"}], "//",
     "AbsoluteTiming"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"sortedDataPairs", "=", 
     RowBox[{"Join", "[", 
      RowBox[{"sortedDataPairs", ",", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"Facility", ",", "\"\<p\>\""}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"Facility", ",", 
           RowBox[{"Select", "[", 
            RowBox[{"FacilitiesList", ",", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"\"\<SLAC-E137\>\"", ",", "\"\<SuperKEKB\>\""}], 
                  "}"}], ",", "#"}], "]"}]}], "&"}]}], "]"}]}], "}"}]}], 
        "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"sortedDataPairs", "=", 
     RowBox[{"Join", "[", 
      RowBox[{"sortedDataPairs", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"\"\<ESS\>\"", ",", "\"\<PiCharged\>\""}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"\"\<ESS\>\"", ",", "\"\<mu\>\""}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"\"\<SLAC-E137\>\"", ",", "\"\<e\>\""}], "}"}], "}"}]}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"sortedDataPairs", "=", 
     RowBox[{"Join", "[", 
      RowBox[{"sortedDataPairs", ",", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"\"\<SuperKEKB\>\"", ",", "#"}], "}"}], "&"}], "/@", 
        RowBox[{"{", 
         RowBox[{"\"\<Bcharged\>\"", ",", "\"\<B0\>\"", ",", "\"\<Bs\>\""}], 
         "}"}]}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"sortedDataPairs", "=", 
     RowBox[{"SortBy", "[", 
      RowBox[{"sortedDataPairs", ",", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{"#", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], "}"}], "&"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "In", " ", "case", " ", "some", " ", "of", " ", "the", " ", 
      "distributions", " ", "are", " ", "absent"}], ",", " ", 
     RowBox[{
     "the", " ", "notebook", " ", "will", " ", "replace", " ", "them", " ", 
      "with", " ", "the", " ", "distribution", " ", "of", " ", "the", " ", 
      "\"\<similar\>\"", " ", 
      RowBox[{"particle", ".", " ", "This"}], " ", "is", " ", "a", " ", 
      "temporary", " ", "approximation"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"SimilarParticle", "[", 
      RowBox[{"\"\<FCC-hh\>\"", ",", "\"\<Bc\>\""}], "]"}], "=", 
     RowBox[{
      RowBox[{"SimilarParticle", "[", 
       RowBox[{"\"\<LHC\>\"", ",", "\"\<Bc\>\""}], "]"}], "=", 
      RowBox[{
       RowBox[{"SimilarParticle", "[", 
        RowBox[{"\"\<SPS\>\"", ",", "\"\<Bc\>\""}], "]"}], "=", 
       RowBox[{
        RowBox[{"SimilarParticle", "[", 
         RowBox[{"\"\<FermilabBD\>\"", ",", "\"\<Bc\>\""}], "]"}], "=", 
        "\"\<Bcharged\>\""}]}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"SimilarParticle", "[", 
      RowBox[{"\"\<FCC-hh\>\"", ",", "\"\<B0\>\""}], "]"}], "=", 
     RowBox[{
      RowBox[{"SimilarParticle", "[", 
       RowBox[{"\"\<LHC\>\"", ",", "\"\<B0\>\""}], "]"}], "=", 
      RowBox[{
       RowBox[{"SimilarParticle", "[", 
        RowBox[{"\"\<SPS\>\"", ",", "\"\<B0\>\""}], "]"}], "=", 
       RowBox[{
        RowBox[{"SimilarParticle", "[", 
         RowBox[{"\"\<FermilabBD\>\"", ",", "\"\<B0\>\""}], "]"}], "=", 
        RowBox[{
         RowBox[{"SimilarParticle", "[", 
          RowBox[{"\"\<SuperKEKB\>\"", ",", "\"\<B0\>\""}], "]"}], "=", 
         "\"\<Bcharged\>\""}]}]}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"SimilarParticle", "[", 
      RowBox[{"\"\<FCC-hh\>\"", ",", "\"\<Bs\>\""}], "]"}], "=", 
     RowBox[{
      RowBox[{"SimilarParticle", "[", 
       RowBox[{"\"\<LHC\>\"", ",", "\"\<Bs\>\""}], "]"}], "=", 
      RowBox[{
       RowBox[{"SimilarParticle", "[", 
        RowBox[{"\"\<SPS\>\"", ",", "\"\<Bs\>\""}], "]"}], "=", 
       RowBox[{
        RowBox[{"SimilarParticle", "[", 
         RowBox[{"\"\<FermilabBD\>\"", ",", "\"\<Bs\>\""}], "]"}], "=", 
        "\"\<Bcharged\>\""}]}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"SimilarParticle", "[", 
      RowBox[{"\"\<FCC-hh\>\"", ",", "\"\<tau\>\""}], "]"}], "=", 
     RowBox[{
      RowBox[{"SimilarParticle", "[", 
       RowBox[{"\"\<LHC\>\"", ",", "\"\<tau\>\""}], "]"}], "=", 
      RowBox[{
       RowBox[{"SimilarParticle", "[", 
        RowBox[{"\"\<SPS\>\"", ",", "\"\<tau\>\""}], "]"}], "=", 
       RowBox[{
        RowBox[{"SimilarParticle", "[", 
         RowBox[{"\"\<FermilabBD\>\"", ",", "\"\<tau\>\""}], "]"}], "=", 
        "\"\<Ds\>\""}]}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"SimilarParticle", "[", 
      RowBox[{"\"\<FCC-hh\>\"", ",", "\"\<D0\>\""}], "]"}], "=", 
     RowBox[{
      RowBox[{"SimilarParticle", "[", 
       RowBox[{"\"\<FCC-hh\>\"", ",", "\"\<Ds\>\""}], "]"}], "=", 
      "\"\<Dcharged\>\""}]}], ";"}], "\[IndentingNewLine]", 
   "sortedDataPairs"}]}]], "Input",
 CellChangeTimes->{{3.913217164971033*^9, 3.913217201930162*^9}, 
   3.9132172692908635`*^9, {3.913217344025357*^9, 3.913217346582526*^9}, {
   3.913217491925939*^9, 3.913217541103717*^9}, {3.9132183339250293`*^9, 
   3.9132183636262083`*^9}, {3.9132199658349442`*^9, 
   3.9132200563150406`*^9}, {3.9132204177147603`*^9, 
   3.9132204399298105`*^9}, {3.913220478825943*^9, 3.9132204839912148`*^9}, 
   3.913221174021563*^9, {3.9133976923445945`*^9, 3.913397712693364*^9}, {
   3.913449291936092*^9, 3.9134493311111135`*^9}, {3.9134493688459277`*^9, 
   3.913449372195831*^9}, {3.9134515764360905`*^9, 3.913451579835991*^9}, {
   3.9144884419671197`*^9, 3.914488446421652*^9}, {3.9154389308747478`*^9, 
   3.915438930996276*^9}, {3.915702862288344*^9, 3.915702918311591*^9}, {
   3.9157063778312306`*^9, 3.91570638038387*^9}, {3.9341327312382426`*^9, 
   3.934132761429245*^9}, {3.943378352056116*^9, 3.943378377274458*^9}, {
   3.9493740979811974`*^9, 3.9493741111448574`*^9}, {3.949638768673189*^9, 
   3.949638820495308*^9}, {3.9496444202642765`*^9, 3.9496445294316196`*^9}, 
   3.949645031283865*^9, {3.949994941449606*^9, 3.949995048521221*^9}, {
   3.9499965938568134`*^9, 3.949996600928211*^9}},
 CellTags->"Evaluation",
 CellLabel->
  "In[102]:=",ExpressionUUID->"7876d6a2-9b21-7040-aaa9-2b95aaae2f3a"],

Cell[BoxData[
 FormBox[
  RowBox[{"{", 
   RowBox[{"3.0861264`", ",", "Null"}], "}"}], TraditionalForm]], "Output",
 CellChangeTimes->{
  3.943416182208721*^9, 3.947738415105591*^9, 3.947738703238428*^9, 
   3.9477392504263134`*^9, 3.947740372102787*^9, 3.947744221327711*^9, 
   3.9482491110871944`*^9, 3.948250413209036*^9, 3.9483042792204494`*^9, 
   3.9483350189402256`*^9, {3.9496445204208145`*^9, 3.9496445340207253`*^9}, {
   3.9499950094099407`*^9, 3.949995051990694*^9}, 3.9499965690045166`*^9, 
   3.9499966043427353`*^9},
 CellTags->"Evaluation",
 CellLabel->
  "Out[107]=",ExpressionUUID->"39d6c1c3-6be2-3146-900e-88f8562440d2"],

Cell[BoxData[
 FormBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"\<\"ESS\"\>", "\<\"mu\"\>"},
     {"\<\"ESS\"\>", "\<\"p\"\>"},
     {"\<\"ESS\"\>", "\<\"Pi0\"\>"},
     {"\<\"ESS\"\>", "\<\"PiCharged\"\>"},
     {"\<\"FCC-hh\"\>", "\<\"Bcharged\"\>"},
     {"\<\"FCC-hh\"\>", "\<\"Dcharged\"\>"},
     {"\<\"FCC-hh\"\>", "\<\"Eta\"\>"},
     {"\<\"FCC-hh\"\>", "\<\"EtaPr\"\>"},
     {"\<\"FCC-hh\"\>", "\<\"h\"\>"},
     {"\<\"FCC-hh\"\>", "\<\"Omega\"\>"},
     {"\<\"FCC-hh\"\>", "\<\"p\"\>"},
     {"\<\"FCC-hh\"\>", "\<\"Phi\"\>"},
     {"\<\"FCC-hh\"\>", "\<\"Pi0\"\>"},
     {"\<\"FCC-hh\"\>", "\<\"Rho0\"\>"},
     {"\<\"FCC-hh\"\>", "\<\"W\"\>"},
     {"\<\"FermilabBD\"\>", "\<\"Bcharged\"\>"},
     {"\<\"FermilabBD\"\>", "\<\"Ds\"\>"},
     {"\<\"FermilabBD\"\>", "\<\"Eta\"\>"},
     {"\<\"FermilabBD\"\>", "\<\"EtaPr\"\>"},
     {"\<\"FermilabBD\"\>", "\<\"JPsi\"\>"},
     {"\<\"FermilabBD\"\>", "\<\"KS\"\>"},
     {"\<\"FermilabBD\"\>", "\<\"Omega\"\>"},
     {"\<\"FermilabBD\"\>", "\<\"p\"\>"},
     {"\<\"FermilabBD\"\>", "\<\"Phi\"\>"},
     {"\<\"FermilabBD\"\>", "\<\"photon\"\>"},
     {"\<\"FermilabBD\"\>", "\<\"Pi0\"\>"},
     {"\<\"FermilabBD\"\>", "\<\"Rho0\"\>"},
     {"\<\"FermilabBD\"\>", "\<\"RhoCh\"\>"},
     {"\<\"LHC\"\>", "\<\"Bcharged\"\>"},
     {"\<\"LHC\"\>", "\<\"Ds\"\>"},
     {"\<\"LHC\"\>", "\<\"Eta\"\>"},
     {"\<\"LHC\"\>", "\<\"EtaPr\"\>"},
     {"\<\"LHC\"\>", "\<\"h\"\>"},
     {"\<\"LHC\"\>", "\<\"JPsi\"\>"},
     {"\<\"LHC\"\>", "\<\"KS\"\>"},
     {"\<\"LHC\"\>", "\<\"Omega\"\>"},
     {"\<\"LHC\"\>", "\<\"p\"\>"},
     {"\<\"LHC\"\>", "\<\"Phi\"\>"},
     {"\<\"LHC\"\>", "\<\"photon\"\>"},
     {"\<\"LHC\"\>", "\<\"Pi0\"\>"},
     {"\<\"LHC\"\>", "\<\"Rho0\"\>"},
     {"\<\"LHC\"\>", "\<\"RhoCh\"\>"},
     {"\<\"LHC\"\>", "\<\"Upsilon\"\>"},
     {"\<\"LHC\"\>", "\<\"W\"\>"},
     {"\<\"LHC\"\>", "\<\"Z\"\>"},
     {"\<\"Serpukhov\"\>", "\<\"Eta\"\>"},
     {"\<\"Serpukhov\"\>", "\<\"EtaPr\"\>"},
     {"\<\"Serpukhov\"\>", "\<\"KS\"\>"},
     {"\<\"Serpukhov\"\>", "\<\"Omega\"\>"},
     {"\<\"Serpukhov\"\>", "\<\"p\"\>"},
     {"\<\"Serpukhov\"\>", "\<\"Phi\"\>"},
     {"\<\"Serpukhov\"\>", "\<\"photon\"\>"},
     {"\<\"Serpukhov\"\>", "\<\"Pi0\"\>"},
     {"\<\"Serpukhov\"\>", "\<\"Rho0\"\>"},
     {"\<\"Serpukhov\"\>", "\<\"RhoCh\"\>"},
     {"\<\"SLAC-E137\"\>", "\<\"e\"\>"},
     {"\<\"SPS\"\>", "\<\"Bcharged\"\>"},
     {"\<\"SPS\"\>", "\<\"Ds\"\>"},
     {"\<\"SPS\"\>", "\<\"Eta\"\>"},
     {"\<\"SPS\"\>", "\<\"EtaPr\"\>"},
     {"\<\"SPS\"\>", "\<\"JPsi\"\>"},
     {"\<\"SPS\"\>", "\<\"Kcharged\"\>"},
     {"\<\"SPS\"\>", "\<\"KS\"\>"},
     {"\<\"SPS\"\>", "\<\"Omega\"\>"},
     {"\<\"SPS\"\>", "\<\"p\"\>"},
     {"\<\"SPS\"\>", "\<\"Phi\"\>"},
     {"\<\"SPS\"\>", "\<\"photon\"\>"},
     {"\<\"SPS\"\>", "\<\"Pi0\"\>"},
     {"\<\"SPS\"\>", "\<\"Rho0\"\>"},
     {"\<\"SPS\"\>", "\<\"RhoCh\"\>"},
     {"\<\"SuperKEKB\"\>", "\<\"B0\"\>"},
     {"\<\"SuperKEKB\"\>", "\<\"Bcharged\"\>"},
     {"\<\"SuperKEKB\"\>", "\<\"Bs\"\>"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}], TraditionalForm]], "Output",
 CellChangeTimes->{
  3.943416182208721*^9, 3.947738415105591*^9, 3.947738703238428*^9, 
   3.9477392504263134`*^9, 3.947740372102787*^9, 3.947744221327711*^9, 
   3.9482491110871944`*^9, 3.948250413209036*^9, 3.9483042792204494`*^9, 
   3.9483350189402256`*^9, {3.9496445204208145`*^9, 3.9496445340207253`*^9}, {
   3.9499950094099407`*^9, 3.949995051990694*^9}, 3.9499965690045166`*^9, 
   3.9499966043773823`*^9},
 CellTags->"Evaluation",
 CellLabel->
  "Out[117]=",ExpressionUUID->"7187f19a-08f6-884f-b12b-0f9432c36afa"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Sampling 4-momenta of mother particles from tabulated distribution\
\>", "Chapter",
 CellChangeTimes->{{3.8851416803896036`*^9, 3.885141685436587*^9}, {
  3.8855454831028385`*^9, 3.8855454843672285`*^9}, {3.8878174844501143`*^9, 
  3.8878174845684476`*^9}, {3.913276964664763*^9, 3.913276988959453*^9}, {
  3.934132948364663*^9, 3.934132954229455*^9}},
 CellTags->
  "Evaluation",ExpressionUUID->"6c3163a5-8512-d34e-953b-bf606135cde0"],

Cell[CellGroupData[{

Cell["Preliminary definitions", "Section",
 CellChangeTimes->{{3.8851417075362697`*^9, 3.8851417130791903`*^9}, 
   3.9132646042181706`*^9},
 CellTags->
  "Evaluation",ExpressionUUID->"88664530-1104-304e-b269-f0d10ff8ad00"],

Cell[CellGroupData[{

Cell["\<\
Quick mapping the data {x,y,f[x,y]} \
->{x\[CloseCurlyQuote],y\[CloseCurlyQuote],f[x\[CloseCurlyQuote],y\
\[CloseCurlyQuote]]} for some structured grids {x,y} and \
{x\[CloseCurlyQuote], y\[CloseCurlyQuote]}\
\>", "Subsection",
 CellChangeTimes->{{3.913107151768467*^9, 3.9131071573912096`*^9}, {
  3.913264603355554*^9, 3.9132646061065936`*^9}},
 CellTags->
  "Evaluation",ExpressionUUID->"076ce08b-54dc-d24b-a181-7cdf3cf75a97"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"nd", "=", "2"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"cf2", "=", 
   RowBox[{
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"xgvars", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Unique", "[", "\"\<xg\>\"", "]"}], "&"}], "/@", 
          RowBox[{"slist", "@@", 
           RowBox[{"Range", "@", "nd"}]}]}]}], ",", 
        RowBox[{"igvars", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Unique", "[", "\"\<ig\>\"", "]"}], "&"}], "/@", 
          RowBox[{"slist", "@@", 
           RowBox[{"Range", "@", "nd"}]}]}]}], ",", 
        RowBox[{"tgvars", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Unique", "[", "\"\<tg\>\"", "]"}], "&"}], "/@", 
          RowBox[{"slist", "@@", 
           RowBox[{"Range", "@", "nd"}]}]}]}], ",", 
        RowBox[{"ivars", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Unique", "[", "\"\<i\>\"", "]"}], "&"}], "/@", 
          RowBox[{"slist", "@@", 
           RowBox[{"Range", "@", "nd"}]}]}]}], ",", 
        RowBox[{"svars", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Unique", "[", "\"\<s\>\"", "]"}], "&"}], "/@", 
          RowBox[{"slist", "@@", 
           RowBox[{"Range", "@", "nd"}]}]}]}], ",", 
        RowBox[{"tvars", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Unique", "[", "\"\<t\>\"", "]"}], "&"}], "/@", 
          RowBox[{"slist", "@@", 
           RowBox[{"Range", "@", "nd"}]}]}]}], ",", 
        RowBox[{"jvars", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Unique", "[", "\"\<j\>\"", "]"}], "&"}], "/@", 
          RowBox[{"slist", "@@", 
           RowBox[{"Range", "@", "nd"}]}]}]}]}], "}"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"Inactivate", "[", 
         RowBox[{
          RowBox[{"Compile", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"seq", "@", 
               RowBox[{"{", 
                RowBox[{"xgvars", ",", "_Real", ",", "1"}], "}"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"y", ",", "_Real", ",", "nd"}], "}"}]}], "}"}], ",", 
            RowBox[{"Module", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"seq", "@", "igvars"}], ",", 
                RowBox[{"seq", "@", "tgvars"}], ",", 
                RowBox[{"seq", "@", "ivars"}], ",", 
                RowBox[{"seq", "@", "svars"}], ",", 
                RowBox[{"seq", "@", "tvars"}]}], "}"}], ",", 
              RowBox[{
               RowBox[{"seq", "[", 
                RowBox[{"igvars", "=", 
                 RowBox[{
                  RowBox[{"Floor", "[", "xgvars", "]"}], "-", 
                  RowBox[{"UnitStep", "[", 
                   RowBox[{"xgvars", "-", 
                    RowBox[{"indexed", "@", 
                    RowBox[{"Dimensions", "@", "y"}]}]}], "]"}]}]}], "]"}], 
               ";", "\[IndentingNewLine]", 
               RowBox[{"seq", "[", 
                RowBox[{"tgvars", "=", 
                 RowBox[{"xgvars", "-", "igvars"}]}], "]"}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"seq", "[", 
                   RowBox[{"tvars", "=", 
                    RowBox[{"Compile`GetElement", "[", 
                    RowBox[{"tgvars", ",", "jvars"}], "]"}]}], "]"}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"seq", "[", 
                   RowBox[{"ivars", "=", 
                    RowBox[{"Compile`GetElement", "[", 
                    RowBox[{"igvars", ",", "jvars"}], "]"}]}], "]"}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"seq", "[", 
                   RowBox[{"svars", "=", 
                    RowBox[{"1.", "-", "tvars"}]}], "]"}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"eval", "@", 
                   RowBox[{"Total", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"Times", "@@", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "1"}], "]"}], "]"}]}], " ", 
                    RowBox[{"Compile`GetElement", "[", 
                    RowBox[{"y", ",", 
                    RowBox[{"Sequence", "@@", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "2"}], "]"}], "]"}]}]}], "]"}]}], 
                    "&"}], "/@", 
                    RowBox[{"Tuples", "@", 
                    RowBox[{"Transpose", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"svars", ",", "ivars"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"tvars", ",", 
                    RowBox[{"ivars", "+", "1"}]}], "}"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"2", ",", "3", ",", "1"}], "}"}]}], "]"}]}]}], 
                    "]"}]}]}], ",", 
                 RowBox[{"seq", "@", 
                  RowBox[{"{", 
                   RowBox[{"jvars", ",", 
                    RowBox[{"Length", "@", "igvars"}]}], "}"}]}]}], "]"}]}]}],
              "]"}], ",", 
            RowBox[{"CompilationTarget", "\[Rule]", "\"\<C\>\""}], ",", 
            RowBox[{"RuntimeAttributes", "\[Rule]", 
             RowBox[{"{", "Listable", "}"}]}], ",", 
            RowBox[{"Parallelization", "\[Rule]", "True"}], ",", 
            RowBox[{"RuntimeOptions", "\[Rule]", "\"\<Speed\>\""}]}], "]"}], 
          ",", 
          RowBox[{"Except", "[", 
           RowBox[{"seq", "|", "eval", "|", "indexed"}], "]"}]}], "]"}], "/.", 
        RowBox[{
         RowBox[{"seq", "[", "expr_", "]"}], "\[RuleDelayed]", 
         RowBox[{"RuleCondition", "@", 
          RowBox[{"(", 
           RowBox[{"Sequence", "@@", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Inactivate", "[", 
                RowBox[{"expr", ",", 
                 RowBox[{"Except", "[", 
                  RowBox[{"slist", "|", "indexed"}], "]"}]}], "]"}], "/.", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"l_slist", "\[RuleDelayed]", 
                  RowBox[{"l", "[", 
                   RowBox[{"[", "i", "]"}], "]"}]}], ",", 
                 RowBox[{
                  RowBox[{"indexed", "[", "l_", "]"}], "\[RuleDelayed]", 
                  RowBox[{
                   RowBox[{"Inactive", "[", "Compile`GetElement", "]"}], "[", 
                   RowBox[{"l", ",", "i"}], "]"}]}]}], "}"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "nd"}], "}"}]}], "]"}]}], ")"}]}]}]}], "/.", 
       RowBox[{
        RowBox[{"eval", "@", "expr_"}], "\[RuleDelayed]", 
        RowBox[{"RuleCondition", "[", 
         RowBox[{"Activate", "[", 
          RowBox[{"expr", "/.", 
           RowBox[{"slist", "\[Rule]", "List"}]}], "]"}], "]"}]}]}]}], "]"}], 
    "//", "Activate"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.9131071773051744`*^9, 3.913107177361599*^9}, {
  3.913109162396256*^9, 3.913109162499637*^9}},
 CellTags->"Evaluation",
 CellLabel->"In[16]:=",ExpressionUUID->"efe5fa6a-c47e-994e-b965-0100aca88733"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Compiled linear interpolations - for mapping from {x,y,f[x,y]} to ",
 Cell[BoxData[
  FormBox[
   RowBox[{"{", 
    RowBox[{
     SubscriptBox["x", "random"], ",", 
     SubscriptBox["y", "random"], ",", 
     RowBox[{"f", "[", 
      RowBox[{
       SubscriptBox["x", "random"], ",", 
       SubscriptBox["y", "random"]}], "]"}]}]}], TraditionalForm]],
  ExpressionUUID->"892996d1-33a7-d24b-8c99-c7fda184c744"],
 "}"
}], "Subsection",
 CellChangeTimes->{{3.913107151768467*^9, 3.9131071573912096`*^9}, {
  3.913264603355554*^9, 3.913264611963004*^9}},
 CellTags->
  "Evaluation",ExpressionUUID->"e92be444-a57a-0e4a-bb52-ab5ad727e8b4"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Random", " ", 
     RowBox[{"Log", "[", "\[Theta]", "]"}], " ", "points"}], ",", " ", 
    RowBox[{"random", " ", 
     RowBox[{"Log", "[", "E", "]"}], " ", "points"}], ","}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"linint2", "=", 
    RowBox[{"Compile", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"rand\[Theta]log", ",", "_Real"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"randElog", ",", "_Real"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"grid\[Theta]log", ",", "_Real", ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"gridElog", ",", "_Real", ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"index\[Theta]", ",", "_Integer"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"indexE", ",", "_Integer"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"distrlog", ",", "_Real", ",", "2"}], "}"}]}], "}"}], ",", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "\[Theta]el", ",", "Eel", ",", "x1", ",", "x2", ",", "y1", ",", "y2",
           ",", "z11", ",", "z21", ",", "z12", ",", "z22", ",", 
          "\[CapitalDelta]", ",", "indexlarger\[Theta]", ",", "indexlargerE", 
          ",", "lenE"}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "Finding", " ", "the", " ", "index", " ", "of", " ", "the", " ", 
          "grids", " ", "with", " ", "the", " ", "elements", " ", "larged", 
          " ", "than", " ", "the", " ", "given", " ", "random", " ", 
          "point"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"\[Theta]el", "=", 
          RowBox[{"Compile`GetElement", "[", 
           RowBox[{"grid\[Theta]log", ",", "index\[Theta]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"indexlarger\[Theta]", "=", 
          RowBox[{"index\[Theta]", "+", 
           RowBox[{"UnitStep", "[", 
            RowBox[{"rand\[Theta]log", "-", "\[Theta]el"}], "]"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Eel", "=", 
          RowBox[{"Compile`GetElement", "[", 
           RowBox[{"gridElog", ",", "indexE"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"indexlargerE", "=", 
          RowBox[{"indexE", "+", 
           RowBox[{"UnitStep", "[", 
            RowBox[{"randElog", "-", "Eel"}], "]"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"The", " ", "two", " ", "points", " ", "x1"}], ",", " ", 
           RowBox[{
            RowBox[{"x2", " ", "with", " ", "x1"}], " ", "<", " ", "x", " ", 
            "<", " ", "x2"}]}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"x1", "=", 
          RowBox[{"Compile`GetElement", "[", 
           RowBox[{"grid\[Theta]log", ",", 
            RowBox[{"indexlarger\[Theta]", "-", "1"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"x2", "=", 
          RowBox[{"Compile`GetElement", "[", 
           RowBox[{"grid\[Theta]log", ",", "indexlarger\[Theta]"}], "]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"y1", "=", 
          RowBox[{"Compile`GetElement", "[", 
           RowBox[{"gridElog", ",", 
            RowBox[{"indexlargerE", "-", "1"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"y2", "=", 
          RowBox[{"Compile`GetElement", "[", 
           RowBox[{"gridElog", ",", "indexlargerE"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
          "Corresponding", " ", "values", " ", "of", " ", "the", " ", 
           "function"}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"lenE", "=", 
          RowBox[{"Length", "[", "gridElog", "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"z11", "=", 
          RowBox[{"Compile`GetElement", "[", 
           RowBox[{"distrlog", ",", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"indexlarger\[Theta]", "-", "2"}], ")"}], "*", 
              "lenE"}], "+", "indexlargerE", "-", "1"}], ",", "3"}], "]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"z21", "=", 
          RowBox[{"Compile`GetElement", "[", 
           RowBox[{"distrlog", ",", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"indexlarger\[Theta]", "-", "1"}], ")"}], "*", 
              "lenE"}], "+", "indexlargerE", "-", "1"}], ",", "3"}], "]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"z12", "=", 
          RowBox[{"Compile`GetElement", "[", 
           RowBox[{"distrlog", ",", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"indexlarger\[Theta]", "-", "2"}], ")"}], "*", 
              "lenE"}], "+", "indexlargerE"}], ",", "3"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"z22", "=", 
          RowBox[{"Compile`GetElement", "[", 
           RowBox[{"distrlog", ",", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"indexlarger\[Theta]", "-", "1"}], ")"}], "*", 
              "lenE"}], "+", "indexlargerE"}], ",", "3"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"\[CapitalDelta]", "=", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"x2", "-", "x1"}], ")"}], 
           RowBox[{"(", 
            RowBox[{"y2", "-", "y1"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"Exp", "[", 
          RowBox[{"(*", 
           RowBox[{"{", 
            RowBox[{
            "rand\[Theta]log", ",", "x1", ",", "x2", ",", "randElog", ",", 
             "y1", ",", "y2", ",", "z11", ",", "z21", ",", "z12", ",", "z22", 
             ","}]}], "*)"}], 
          RowBox[{
           RowBox[{
            FractionBox[
             RowBox[{
              RowBox[{"(", 
               RowBox[{"x2", "-", "rand\[Theta]log"}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{"y2", "-", "randElog"}], ")"}]}], "\[CapitalDelta]"], 
            "*", "z11"}], "+", 
           RowBox[{
            FractionBox[
             RowBox[{
              RowBox[{"(", 
               RowBox[{"rand\[Theta]log", "-", "x1"}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{"y2", "-", "randElog"}], ")"}]}], "\[CapitalDelta]"], 
            "z21"}], "+", 
           RowBox[{
            FractionBox[
             RowBox[{
              RowBox[{"(", 
               RowBox[{"x2", "-", "rand\[Theta]log"}], ")"}], 
              RowBox[{"(", 
               RowBox[{"randElog", "-", "y1"}], ")"}]}], "\[CapitalDelta]"], 
            "*", "z12"}], "+", 
           RowBox[{
            FractionBox[
             RowBox[{
              RowBox[{"(", 
               RowBox[{"rand\[Theta]log", "-", "x1"}], ")"}], 
              RowBox[{"(", 
               RowBox[{"randElog", "-", "y1"}], ")"}]}], 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"x2", "-", "x1"}], ")"}], 
              RowBox[{"(", 
               RowBox[{"y2", "-", "y1"}], ")"}]}]], "z22"}]}], 
          RowBox[{"(*", "}", "*)"}], "]"}]}]}], "\[IndentingNewLine]", "]"}], 
      ",", 
      RowBox[{"CompilationTarget", "->", "\"\<C\>\""}], ",", 
      RowBox[{"RuntimeOptions", "->", "\"\<Speed\>\""}], ",", 
      RowBox[{"RuntimeAttributes", "->", 
       RowBox[{"{", "Listable", "}"}]}], ",", 
      RowBox[{"Parallelization", "->", "True"}]}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"<<", "CompiledFunctionTools`"}], "\n", 
   RowBox[{
    RowBox[{"CompilePrint", "@", "linint2"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"linint1", "=", 
    RowBox[{"Compile", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"rand\[Theta]log", ",", "_Real"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"grid\[Theta]log", ",", "_Real", ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"index\[Theta]", ",", "_Integer"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"distrlog", ",", "_Real", ",", "2"}], "}"}]}], "}"}], ",", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "\[Theta]el", ",", "x1", ",", "x2", ",", "z1", ",", "z2", ",", 
          "\[CapitalDelta]", ",", "indexlarger\[Theta]"}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "Finding", " ", "the", " ", "index", " ", "of", " ", "the", " ", 
          "grids", " ", "with", " ", "the", " ", "elements", " ", "larged", 
          " ", "than", " ", "the", " ", "given", " ", "random", " ", 
          "point"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"\[Theta]el", "=", 
          RowBox[{"Compile`GetElement", "[", 
           RowBox[{"grid\[Theta]log", ",", "index\[Theta]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"indexlarger\[Theta]", "=", 
          RowBox[{"index\[Theta]", "+", 
           RowBox[{"UnitStep", "[", 
            RowBox[{"rand\[Theta]log", "-", "\[Theta]el"}], "]"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"The", " ", "two", " ", "points", " ", "x1"}], ",", " ", 
           RowBox[{
            RowBox[{"x2", " ", "with", " ", "x1"}], " ", "<", " ", "x", " ", 
            "<", " ", "x2"}]}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"x1", "=", 
          RowBox[{"Compile`GetElement", "[", 
           RowBox[{"grid\[Theta]log", ",", 
            RowBox[{"indexlarger\[Theta]", "-", "1"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"x2", "=", 
          RowBox[{"Compile`GetElement", "[", 
           RowBox[{"grid\[Theta]log", ",", "indexlarger\[Theta]"}], "]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
          "Corresponding", " ", "values", " ", "of", " ", "the", " ", 
           "function"}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"z1", "=", 
          RowBox[{"Compile`GetElement", "[", 
           RowBox[{"distrlog", ",", "indexlarger\[Theta]", ",", "2"}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"z2", "=", 
          RowBox[{"Compile`GetElement", "[", 
           RowBox[{"distrlog", ",", 
            RowBox[{"indexlarger\[Theta]", "-", "1"}], ",", "2"}], "]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"\[CapitalDelta]", "=", 
          RowBox[{"(", 
           RowBox[{"x2", "-", "x1"}], ")"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{"{", 
           RowBox[{
           "rand\[Theta]log", ",", "x1", ",", "x2", ",", "z1", ",", "z2", 
            ","}]}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"z1", "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"rand\[Theta]log", "-", "x1"}], ")"}], "*", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"z2", "-", "z1"}], ")"}], "/", 
            "\[CapitalDelta]"}]}]}]}]}], 
       RowBox[{"(*", "}", "*)"}], "\[IndentingNewLine]", "]"}], ",", 
      RowBox[{"CompilationTarget", "->", "\"\<C\>\""}], ",", 
      RowBox[{"RuntimeOptions", "->", "\"\<Speed\>\""}], ",", 
      RowBox[{"RuntimeAttributes", "->", 
       RowBox[{"{", "Listable", "}"}]}], ",", 
      RowBox[{"Parallelization", "->", "True"}]}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"<<", "CompiledFunctionTools`"}], "\n", 
   RowBox[{
    RowBox[{"CompilePrint", "@", "linint1"}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.9131747708258057`*^9, 3.9131747755776577`*^9}, {
   3.913175754441927*^9, 3.9131758328488884`*^9}, 3.913175876968843*^9, {
   3.913176070505515*^9, 3.9131762163920517`*^9}, {3.9131780905130444`*^9, 
   3.913178092141858*^9}, {3.9131785218992834`*^9, 3.9131785337348056`*^9}, {
   3.913178589289935*^9, 3.9131786589896235`*^9}, {3.913178809847124*^9, 
   3.9131788326987643`*^9}, {3.9131793012179437`*^9, 3.9131793223255987`*^9}},
 CellTags->"Evaluation",
 CellLabel->"In[18]:=",ExpressionUUID->"025f7586-96e8-5e42-ac1c-cbc1286bc10e"],

Cell[BoxData[
 FormBox[
  InterpretationBox[
   RowBox[{
    TagBox["CompiledFunction",
     "SummaryHead"], "[", 
    DynamicModuleBox[{Typeset`open$$ = False, Typeset`embedState$$ = "Ready"}, 
     TemplateBox[{
       PaneSelectorBox[{False -> GridBox[{{
             PaneBox[
              ButtonBox[
               DynamicBox[
                FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxOpener"], 
                ImageSizeCache -> {
                 9.771662737098522, {0., 9.771662737098522}}], Appearance -> 
               None, BaseStyle -> {}, 
               ButtonFunction :> (Typeset`open$$ = True), Evaluator -> 
               Automatic, Method -> "Preemptive"], 
              Alignment -> {Center, Center}, ImageSize -> 
              Dynamic[{
                Automatic, 
                 3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                  Magnification])}]], 
             GraphicsBox[{
               Thickness[0.038461538461538464`], {
                FaceForm[{
                  GrayLevel[0.93], 
                  Opacity[1.]}], 
                
                FilledCurveBox[{{{1, 4, 3}, {0, 1, 0}, {1, 3, 3}, {0, 1, 0}, {
                 1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {0, 1, 0}}}, {{{
                 25.499999999999996`, 2.5}, {25.499999999999996`, 
                 1.3953100000000003`}, {24.604699999999998`, 
                 0.49999999999999994`}, {23.5, 0.49999999999999994`}, {2.5, 
                 0.49999999999999994`}, {1.3953100000000003`, 
                 0.49999999999999994`}, {0.49999999999999994`, 
                 1.3953100000000003`}, {0.49999999999999994`, 2.5}, {
                 0.49999999999999994`, 23.5}, {0.49999999999999994`, 
                 24.604699999999998`}, {1.3953100000000003`, 
                 25.499999999999996`}, {2.5, 25.499999999999996`}, {23.5, 
                 25.499999999999996`}, {24.604699999999998`, 
                 25.499999999999996`}, {25.499999999999996`, 
                 24.604699999999998`}, {25.499999999999996`, 23.5}, {
                 25.499999999999996`, 2.5}}}]}, {
                FaceForm[{
                  RGBColor[0.5, 0.5, 0.5], 
                  Opacity[1.]}], 
                
                FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {
                 0, 1, 0}, {0, 1, 0}, {0, 1, 0}}}, {{{20.5426, 
                 19.116799999999998`}, {16.3832, 21.876199999999997`}, {
                 16.3832, 20.021499999999996`}, {6.930469999999999, 
                 20.021499999999996`}, {6.930469999999999, 
                 18.212100000000003`}, {16.3832, 18.212100000000003`}, {
                 16.3832, 16.357399999999995`}, {20.5426, 
                 19.116799999999998`}}}], 
                
                FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {
                 0, 1, 0}, {0, 1, 0}, {0, 1, 0}}}, {{{5.30508, 13.8391}, {
                 9.46445, 11.079700000000003`}, {9.46445, 
                 12.933999999999997`}, {18.917199999999998`, 
                 12.933999999999997`}, {18.917199999999998`, 14.7438}, {
                 9.46445, 14.7438}, {9.46445, 16.598}, {5.30508, 13.8391}}}], 
                
                FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {
                 0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
                 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {
                 1, 3, 3}, {1, 3, 3}, {1, 3, 3}}}, CompressedData["
1:eJxTTMoPSmVmYGBgBGJjIGYCYq4u+eR3VWoOxhkv5j+Qk3SA8fu/r5rKOVHM
Yd2vmNyjZ9Qcrt9QXbW9S8RBg59767IidQcPMYPGaHFhB+Nn61SfiGo4xBwp
T7o2V9Dh0Iolfg6/NBxEHv/x1Xgi4FB1XNNqkqQWnP+axUTQjFkbzn+oO2HB
j/3aDg/Xn5T6WiDoYLs3aJpiqI7DrHN+bO6tQg4zfUR7vF7pQOyfIQyRd9d1
WLL0U1kLoyjEPdm6DpoTXfQX7xBzKPjQejLkhDacL5J4+LL2Gm2HtNnSl4Vf
iELM69J2qPZM3tLnJerQX1oozZugDfHPUxGI/4W1HQ5p3TthoyDi4D7lG1v8
Mi2HgqL9zoEHhB1inOxe3BRG8MH62zXhfIbN1Z82CGhC/GMg4nCm3mN/7TYN
iHlCUPdGakDc/1kUEr46GhD/eYnD+d9iBf/kC0vC+TuCrSL+X5Vy2HGR4R5T
uAbEfxYykPBYp+HQqsCuesZAFhL+rJoQ/2rIQdxTpwkJ7yVycPfD+GDzVqLx
xbUd5HYt2JfqBdWfpA2Jj9mykPDpgYaXtaxDy7yzq86vg8qvlIHE5ylY/Eo7
XAt7o787TxfOB5ufqesQ9PbyxxkPZSDhZ6nrMAGU3u7LQtLLEx2HN2253UbX
ofZ76jis/Pay4oynAsT8QG0HKZMv/gW7FCDyTFpwPsz/MD44/Mw1HFjb1uR9
TVVwWKy880/7FHWIexrkIfLX1RzOMDZZVjHIOaDkh3vSDuj5AwCF11Vc
                 "]]}}, AspectRatio -> 1, Axes -> False, Background -> 
              GrayLevel[0.93], Frame -> True, FrameStyle -> Directive[
                Thickness[Tiny], 
                GrayLevel[0.7]], FrameTicks -> None, ImageSize -> 
              Dynamic[{
                Automatic, 
                 3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                  Magnification])}]], 
             GridBox[{{
                RowBox[{
                  TagBox["\"Argument count: \"", "SummaryItemAnnotation"], 
                  "\[InvisibleSpace]", 
                  TagBox["7", "SummaryItem"]}]}, {
                RowBox[{
                  TagBox["\"Argument types: \"", "SummaryItemAnnotation"], 
                  "\[InvisibleSpace]", 
                  TagBox[
                   StyleBox[
                    PaneBox[
                    RowBox[{"{", 
                    RowBox[{"_Real", ",", "_Real", ",", 
                    RowBox[{"{", 
                    RowBox[{"_Real", ",", "1"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"_Real", ",", "1"}], "}"}], ",", "_Integer", ",", 
                    "_Integer", ",", 
                    RowBox[{"{", 
                    RowBox[{"_Real", ",", "2"}], "}"}]}], "}"}], 
                    BaselinePosition -> Baseline, ContentPadding -> False, 
                    FrameMargins -> 0, ImageSize -> {{1, 300}, Automatic}, 
                    StripOnInput -> True], LineBreakWithin -> False], 
                   "SummaryItem"]}]}}, AutoDelete -> False, 
              BaseStyle -> {
               ShowStringCharacters -> False, NumberMarks -> False, 
                PrintPrecision -> 3, ShowSyntaxStyles -> False}, 
              GridBoxAlignment -> {
               "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, 
              GridBoxItemSize -> {
               "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
              GridBoxSpacings -> {
               "Columns" -> {{2}}, "Rows" -> {{Automatic}}}]}}, AutoDelete -> 
           False, BaselinePosition -> {1, 1}, 
           GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
           GridBoxItemSize -> {
            "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}], True -> 
         GridBox[{{
             PaneBox[
              ButtonBox[
               DynamicBox[
                FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxCloser"]], 
               Appearance -> None, BaseStyle -> {}, 
               ButtonFunction :> (Typeset`open$$ = False), Evaluator -> 
               Automatic, Method -> "Preemptive"], 
              Alignment -> {Center, Center}, ImageSize -> 
              Dynamic[{
                Automatic, 
                 3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                  Magnification])}]], 
             GraphicsBox[{
               Thickness[0.038461538461538464`], {
                FaceForm[{
                  GrayLevel[0.93], 
                  Opacity[1.]}], 
                
                FilledCurveBox[{{{1, 4, 3}, {0, 1, 0}, {1, 3, 3}, {0, 1, 0}, {
                 1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {0, 1, 0}}}, {{{
                 25.499999999999996`, 2.5}, {25.499999999999996`, 
                 1.3953100000000003`}, {24.604699999999998`, 
                 0.49999999999999994`}, {23.5, 0.49999999999999994`}, {2.5, 
                 0.49999999999999994`}, {1.3953100000000003`, 
                 0.49999999999999994`}, {0.49999999999999994`, 
                 1.3953100000000003`}, {0.49999999999999994`, 2.5}, {
                 0.49999999999999994`, 23.5}, {0.49999999999999994`, 
                 24.604699999999998`}, {1.3953100000000003`, 
                 25.499999999999996`}, {2.5, 25.499999999999996`}, {23.5, 
                 25.499999999999996`}, {24.604699999999998`, 
                 25.499999999999996`}, {25.499999999999996`, 
                 24.604699999999998`}, {25.499999999999996`, 23.5}, {
                 25.499999999999996`, 2.5}}}]}, {
                FaceForm[{
                  RGBColor[0.5, 0.5, 0.5], 
                  Opacity[1.]}], 
                
                FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {
                 0, 1, 0}, {0, 1, 0}, {0, 1, 0}}}, {{{20.5426, 
                 19.116799999999998`}, {16.3832, 21.876199999999997`}, {
                 16.3832, 20.021499999999996`}, {6.930469999999999, 
                 20.021499999999996`}, {6.930469999999999, 
                 18.212100000000003`}, {16.3832, 18.212100000000003`}, {
                 16.3832, 16.357399999999995`}, {20.5426, 
                 19.116799999999998`}}}], 
                
                FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {
                 0, 1, 0}, {0, 1, 0}, {0, 1, 0}}}, {{{5.30508, 13.8391}, {
                 9.46445, 11.079700000000003`}, {9.46445, 
                 12.933999999999997`}, {18.917199999999998`, 
                 12.933999999999997`}, {18.917199999999998`, 14.7438}, {
                 9.46445, 14.7438}, {9.46445, 16.598}, {5.30508, 13.8391}}}], 
                
                FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {
                 0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
                 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {
                 1, 3, 3}, {1, 3, 3}, {1, 3, 3}}}, CompressedData["
1:eJxTTMoPSmVmYGBgBGJjIGYCYq4u+eR3VWoOxhkv5j+Qk3SA8fu/r5rKOVHM
Yd2vmNyjZ9Qcrt9QXbW9S8RBg59767IidQcPMYPGaHFhB+Nn61SfiGo4xBwp
T7o2V9Dh0Iolfg6/NBxEHv/x1Xgi4FB1XNNqkqQWnP+axUTQjFkbzn+oO2HB
j/3aDg/Xn5T6WiDoYLs3aJpiqI7DrHN+bO6tQg4zfUR7vF7pQOyfIQyRd9d1
WLL0U1kLoyjEPdm6DpoTXfQX7xBzKPjQejLkhDacL5J4+LL2Gm2HtNnSl4Vf
iELM69J2qPZM3tLnJerQX1oozZugDfHPUxGI/4W1HQ5p3TthoyDi4D7lG1v8
Mi2HgqL9zoEHhB1inOxe3BRG8MH62zXhfIbN1Z82CGhC/GMg4nCm3mN/7TYN
iHlCUPdGakDc/1kUEr46GhD/eYnD+d9iBf/kC0vC+TuCrSL+X5Vy2HGR4R5T
uAbEfxYykPBYp+HQqsCuesZAFhL+rJoQ/2rIQdxTpwkJ7yVycPfD+GDzVqLx
xbUd5HYt2JfqBdWfpA2Jj9mykPDpgYaXtaxDy7yzq86vg8qvlIHE5ylY/Eo7
XAt7o787TxfOB5ufqesQ9PbyxxkPZSDhZ6nrMAGU3u7LQtLLEx2HN2253UbX
ofZ76jis/Pay4oynAsT8QG0HKZMv/gW7FCDyTFpwPsz/MD44/Mw1HFjb1uR9
TVVwWKy880/7FHWIexrkIfLX1RzOMDZZVjHIOaDkh3vSDuj5AwCF11Vc
                 "]]}}, AspectRatio -> 1, Axes -> False, Background -> 
              GrayLevel[0.93], Frame -> True, FrameStyle -> Directive[
                Thickness[Tiny], 
                GrayLevel[0.7]], FrameTicks -> None, ImageSize -> 
              Dynamic[{
                Automatic, 
                 3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                  Magnification])}]], 
             GridBox[{{
                RowBox[{
                  TagBox["\"Argument count: \"", "SummaryItemAnnotation"], 
                  "\[InvisibleSpace]", 
                  TagBox["7", "SummaryItem"]}]}, {
                RowBox[{
                  TagBox["\"Argument types: \"", "SummaryItemAnnotation"], 
                  "\[InvisibleSpace]", 
                  TagBox[
                   PaneBox[
                    RowBox[{"{", 
                    RowBox[{"_Real", ",", "_Real", ",", 
                    RowBox[{"{", 
                    RowBox[{"_Real", ",", "1"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"_Real", ",", "1"}], "}"}], ",", "_Integer", ",", 
                    "_Integer", ",", 
                    RowBox[{"{", 
                    RowBox[{"_Real", ",", "2"}], "}"}]}], "}"}], 
                    BaselinePosition -> Baseline, ContentPadding -> False, 
                    FrameMargins -> 0, ImageSize -> {{1, 500}, Automatic}, 
                    StripOnInput -> True], "SummaryItem"]}]}, {
                RowBox[{
                  TagBox["\"Variables: \"", "SummaryItemAnnotation"], 
                  "\[InvisibleSpace]", 
                  TagBox[
                   RowBox[{"{", 
                    
                    RowBox[{
                    "rand\[Theta]log", ",", "randElog", ",", 
                    "grid\[Theta]log", ",", "gridElog", ",", "index\[Theta]", 
                    ",", "indexE", ",", "distrlog"}], "}"}], 
                   "SummaryItem"]}]}, {
                RowBox[{
                  TagBox["\"Expression: \"", "SummaryItemAnnotation"], 
                  "\[InvisibleSpace]", 
                  TagBox[
                   PaneBox[
                    RowBox[{"Block", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    
                    RowBox[{
                    "Compile`$45", ",", "Compile`$46", ",", "Compile`$48", 
                    ",", "Compile`$43", ",", "Compile`$44", ",", 
                    "Compile`$52", ",", "Compile`$53", ",", "Compile`$57", 
                    ",", "Compile`$58"}], "}"}], ",", 
                    RowBox[{"Module", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    
                    RowBox[{"\[Theta]el", ",", "Eel", ",", "x1", ",", "x2", 
                    ",", "y1", ",", "y2", ",", "z11", ",", "z21", ",", "z12", 
                    ",", "z22", ",", "\[CapitalDelta]", ",", 
                    "indexlarger\[Theta]", ",", "indexlargerE", ",", "lenE"}],
                     "}"}], ",", 
                    RowBox[{
                    RowBox[{"\[Theta]el", "=", 
                    RowBox[{"Compile`GetElement", "(", 
                    RowBox[{"grid\[Theta]log", ",", "index\[Theta]"}], 
                    ")"}]}], ";", 
                    RowBox[{"indexlarger\[Theta]", "=", 
                    RowBox[{"index\[Theta]", "+", 
                    TemplateBox[{
                    RowBox[{
                    RowBox[{"rand\[Theta]log", "-", "\[Theta]el"}]}]}, 
                    "UnitStepSeq"]}]}], ";", 
                    RowBox[{"Eel", "=", 
                    RowBox[{"Compile`GetElement", "(", 
                    RowBox[{"gridElog", ",", "indexE"}], ")"}]}], ";", 
                    RowBox[{"indexlargerE", "=", 
                    RowBox[{
                    TemplateBox[{
                    RowBox[{
                    RowBox[{"randElog", "-", "Eel"}]}]}, "UnitStepSeq"], "+", 
                    "indexE"}]}], ";", 
                    RowBox[{"x1", "=", 
                    RowBox[{"Compile`GetElement", "(", 
                    RowBox[{"grid\[Theta]log", ",", 
                    RowBox[{"indexlarger\[Theta]", "-", "1"}]}], ")"}]}], ";", 
                    RowBox[{"x2", "=", 
                    RowBox[{"Compile`GetElement", "(", 
                    RowBox[{"grid\[Theta]log", ",", "indexlarger\[Theta]"}], 
                    ")"}]}], ";", 
                    RowBox[{"y1", "=", 
                    RowBox[{"Compile`GetElement", "(", 
                    RowBox[{"gridElog", ",", 
                    RowBox[{"indexlargerE", "-", "1"}]}], ")"}]}], ";", 
                    RowBox[{"y2", "=", 
                    RowBox[{"Compile`GetElement", "(", 
                    RowBox[{"gridElog", ",", "indexlargerE"}], ")"}]}], ";", 
                    RowBox[{"lenE", "=", 
                    RowBox[{"Length", "[", "gridElog", "]"}]}], ";", 
                    RowBox[{"z11", "=", 
                    RowBox[{"Compile`GetElement", "(", 
                    RowBox[{"distrlog", ",", 
                    RowBox[{"indexlargerE", "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"indexlarger\[Theta]", "-", "2"}], ")"}], " ", 
                    "lenE"}], "-", "1"}], ",", "3"}], ")"}]}], ";", 
                    RowBox[{"z21", "=", 
                    RowBox[{"Compile`GetElement", "(", 
                    RowBox[{"distrlog", ",", 
                    RowBox[{"indexlargerE", "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"indexlarger\[Theta]", "-", "1"}], ")"}], " ", 
                    "lenE"}], "-", "1"}], ",", "3"}], ")"}]}], ";", 
                    RowBox[{"z12", "=", 
                    RowBox[{"Compile`GetElement", "(", 
                    RowBox[{"distrlog", ",", 
                    RowBox[{"indexlargerE", "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"indexlarger\[Theta]", "-", "2"}], ")"}], " ", 
                    "lenE"}]}], ",", "3"}], ")"}]}], ";", 
                    RowBox[{"z22", "=", 
                    RowBox[{"Compile`GetElement", "(", 
                    RowBox[{"distrlog", ",", 
                    RowBox[{"indexlargerE", "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"indexlarger\[Theta]", "-", "1"}], ")"}], " ", 
                    "lenE"}]}], ",", "3"}], ")"}]}], ";", 
                    RowBox[{"\[CapitalDelta]", "=", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"x2", "-", "x1"}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{"y2", "-", "y1"}], ")"}]}]}], ";", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Compile`$45", "=", 
                    RowBox[{"-", "randElog"}]}], ";", 
                    RowBox[{"Compile`$46", "=", 
                    RowBox[{"Compile`$45", "+", "y2"}]}], ";", 
                    RowBox[{"Compile`$48", "=", 
                    FractionBox["1", "\[CapitalDelta]"]}], ";", 
                    RowBox[{"Compile`$43", "=", 
                    RowBox[{"-", "rand\[Theta]log"}]}], ";", 
                    RowBox[{"Compile`$44", "=", 
                    RowBox[{"Compile`$43", "+", "x2"}]}], ";", 
                    RowBox[{"Compile`$52", "=", 
                    RowBox[{"-", "x1"}]}], ";", 
                    RowBox[{"Compile`$53", "=", 
                    RowBox[{"Compile`$52", "+", "rand\[Theta]log"}]}], ";", 
                    RowBox[{"Compile`$57", "=", 
                    RowBox[{"-", "y1"}]}], ";", 
                    RowBox[{"Compile`$58", "=", 
                    RowBox[{"Compile`$57", "+", "randElog"}]}], ";", 
                    RowBox[{"exp", "(", 
                    RowBox[{
                    RowBox[{"z11", " ", 
                    RowBox[{"(", 
                    
                    RowBox[{"Compile`$44", " ", "Compile`$46", " ", 
                    "Compile`$48"}], ")"}]}], "+", 
                    RowBox[{"z12", " ", 
                    RowBox[{"(", 
                    
                    RowBox[{"Compile`$44", " ", "Compile`$48", " ", 
                    "Compile`$58"}], ")"}]}], "+", 
                    RowBox[{"z21", " ", 
                    RowBox[{"(", 
                    
                    RowBox[{"Compile`$46", " ", "Compile`$48", " ", 
                    "Compile`$53"}], ")"}]}], "+", 
                    FractionBox[
                    RowBox[{"z22", " ", 
                    RowBox[{"(", 
                    RowBox[{"Compile`$53", " ", "Compile`$58"}], ")"}]}], 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"Compile`$52", "+", "x2"}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{"Compile`$57", "+", "y2"}], ")"}]}]]}], ")"}]}], 
                    ")"}]}]}], "]"}]}], "]"}], BaselinePosition -> Baseline, 
                    ContentPadding -> False, FrameMargins -> 0, 
                    ImageSize -> {{1, 500}, Automatic}, StripOnInput -> True],
                    "SummaryItem"]}]}}, AutoDelete -> False, 
              BaseStyle -> {
               ShowStringCharacters -> False, NumberMarks -> False, 
                PrintPrecision -> 3, ShowSyntaxStyles -> False}, 
              GridBoxAlignment -> {
               "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, 
              GridBoxItemSize -> {
               "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
              GridBoxSpacings -> {
               "Columns" -> {{2}}, "Rows" -> {{Automatic}}}]}}, AutoDelete -> 
           False, BaselinePosition -> {1, 1}, 
           GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
           GridBoxItemSize -> {
            "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}]}, 
        Dynamic[Typeset`open$$], ImageSize -> Automatic]},
      "SummaryPanel"],
     DynamicModuleValues:>{}], "]"}],
   CompiledFunction[{11, 14.1, 5848}, {
     Blank[Real], 
     Blank[Real], {
      Blank[Real], 1}, {
      Blank[Real], 1}, 
     Blank[Integer], 
     Blank[Integer], {
      Blank[Real], 2}}, {{3, 0, 0}, {3, 0, 1}, {3, 1, 0}, {3, 1, 1}, {2, 0, 
    0}, {2, 0, 1}, {3, 2, 2}, {3, 0, 
    23}}, {{-1, {2, 0, 5}}, {-2, {2, 0, 6}}, {3, {2, 0, 8}}}, {0, 9, 27, 0, 
    3}, {{37, 0, 0, 3, 2}, {19, 2, 3}, {13, 0, 3, 4}, {40, 66, 3, 0, 4, 2, 0, 
     2}, {12, 0, 2, 3}, {37, 1, 1, 3, 4}, {19, 4, 3}, {13, 1, 3, 5}, {40, 66, 
     3, 0, 5, 2, 0, 2}, {12, 1, 2, 4}, {12, 3, 5, 2}, {37, 0, 2, 3, 5}, {37, 
     0, 3, 3, 3}, {12, 4, 5, 2}, {37, 1, 2, 3, 6}, {37, 1, 4, 3, 7}, {33, 1, 
     2}, {12, 3, 6, 7}, {15, 7, 2, 7}, {12, 7, 4, 5, 7}, {37, 2, 7, 8, 3, 
     8}, {12, 3, 5, 7}, {15, 7, 2, 7}, {12, 7, 4, 5, 7}, {37, 2, 7, 8, 3, 
     9}, {12, 3, 6, 7}, {15, 7, 2, 7}, {12, 7, 4, 7}, {37, 2, 7, 8, 3, 10}, {
     12, 3, 5, 7}, {15, 7, 2, 7}, {12, 7, 4, 7}, {37, 2, 7, 8, 3, 11}, {19, 5,
      12}, {13, 3, 12, 13}, {19, 6, 12}, {13, 7, 12, 14}, {16, 13, 14, 13}, {
     19, 1, 14}, {13, 7, 14, 12}, {40, 60, 3, 0, 13, 3, 0, 15}, {19, 0, 16}, {
     13, 3, 16, 17}, {19, 5, 18}, {13, 0, 18, 19}, {19, 6, 20}, {13, 1, 20, 
     21}, {16, 17, 12, 15, 22}, {16, 22, 8, 22}, {16, 19, 12, 15, 23}, {16, 
     23, 9, 23}, {16, 17, 21, 15, 24}, {16, 24, 10, 24}, {13, 3, 18, 25}, {13,
      7, 20, 26}, {16, 25, 26, 25}, {40, 60, 3, 0, 25, 3, 0, 26}, {16, 19, 21,
      26, 25}, {16, 25, 11, 25}, {13, 22, 23, 24, 25, 22}, {40, 32, 3, 0, 22, 
     3, 0, 23}, {1}}, 
    Function[{$CellContext`rand\[Theta]log, $CellContext`randElog, \
$CellContext`grid\[Theta]log, $CellContext`gridElog, $CellContext`index\
\[Theta], $CellContext`indexE, $CellContext`distrlog}, 
     Block[{
      Compile`$45, Compile`$46, Compile`$48, Compile`$43, Compile`$44, 
       Compile`$52, Compile`$53, Compile`$57, Compile`$58}, 
      Module[{$CellContext`\[Theta]el, $CellContext`Eel, $CellContext`x1, \
$CellContext`x2, $CellContext`y1, $CellContext`y2, $CellContext`z11, \
$CellContext`z21, $CellContext`z12, $CellContext`z22, $CellContext`\
\[CapitalDelta], $CellContext`indexlarger\[Theta], $CellContext`indexlargerE, \
$CellContext`lenE}, $CellContext`\[Theta]el = 
        Compile`GetElement[$CellContext`grid\[Theta]log, $CellContext`index\
\[Theta]]; $CellContext`indexlarger\[Theta] = $CellContext`index\[Theta] + 
         UnitStep[$CellContext`rand\[Theta]log - $CellContext`\[Theta]el]; \
$CellContext`Eel = 
        Compile`GetElement[$CellContext`gridElog, $CellContext`indexE]; \
$CellContext`indexlargerE = $CellContext`indexE + 
         UnitStep[$CellContext`randElog - $CellContext`Eel]; $CellContext`x1 = 
        Compile`GetElement[$CellContext`grid\[Theta]log, \
$CellContext`indexlarger\[Theta] - 1]; $CellContext`x2 = 
        Compile`GetElement[$CellContext`grid\[Theta]log, \
$CellContext`indexlarger\[Theta]]; $CellContext`y1 = 
        Compile`GetElement[$CellContext`gridElog, $CellContext`indexlargerE - 
          1]; $CellContext`y2 = 
        Compile`GetElement[$CellContext`gridElog, $CellContext`indexlargerE]; \
$CellContext`lenE = Length[$CellContext`gridElog]; $CellContext`z11 = 
        Compile`GetElement[$CellContext`distrlog, ($CellContext`indexlarger\
\[Theta] - 2) $CellContext`lenE + $CellContext`indexlargerE - 1, 
          3]; $CellContext`z21 = 
        Compile`GetElement[$CellContext`distrlog, ($CellContext`indexlarger\
\[Theta] - 1) $CellContext`lenE + $CellContext`indexlargerE - 1, 
          3]; $CellContext`z12 = 
        Compile`GetElement[$CellContext`distrlog, ($CellContext`indexlarger\
\[Theta] - 2) $CellContext`lenE + $CellContext`indexlargerE, 
          3]; $CellContext`z22 = 
        Compile`GetElement[$CellContext`distrlog, ($CellContext`indexlarger\
\[Theta] - 1) $CellContext`lenE + $CellContext`indexlargerE, 
          3]; $CellContext`\[CapitalDelta] = ($CellContext`x2 - \
$CellContext`x1) ($CellContext`y2 - $CellContext`y1); (
        Compile`$45 = -$CellContext`randElog; 
        Compile`$46 = $CellContext`y2 + Compile`$45; 
        Compile`$48 = $CellContext`\[CapitalDelta]^(-1); 
        Compile`$43 = -$CellContext`rand\[Theta]log; 
        Compile`$44 = $CellContext`x2 + Compile`$43; 
        Compile`$52 = -$CellContext`x1; 
        Compile`$53 = $CellContext`rand\[Theta]log + Compile`$52; 
        Compile`$57 = -$CellContext`y1; 
        Compile`$58 = $CellContext`randElog + Compile`$57; 
        Exp[(Compile`$44 Compile`$46 Compile`$48) $CellContext`z11 + (
            Compile`$53 Compile`$46 Compile`$48) $CellContext`z21 + (
            Compile`$44 Compile`$58 Compile`$48) $CellContext`z12 + (
            Compile`$53 (
             Compile`$58/(($CellContext`x2 + Compile`$52) ($CellContext`y2 + 
              Compile`$57)))) $CellContext`z22])]], Listable], Evaluate, 
    LibraryFunction[
    "C:\\Users\\miksi\\AppData\\Roaming\\Wolfram\\ApplicationData\\\
CCompilerDriver\\BuildFolder\\laptop-u485fl4q-35124\\compiledFunction4.dll", 
     "compiledFunction4", {{Real, 0, "Constant"}, {Real, 0, "Constant"}, {
      Real, 1, "Constant"}, {Real, 1, "Constant"}, {Integer, 0, "Constant"}, {
      Integer, 0, "Constant"}, {Real, 2, "Constant"}}, Real]],
   Editable->False,
   SelectWithContents->True,
   Selectable->False], TraditionalForm]], "Output",
 CellChangeTimes->{3.943416185403698*^9, 3.947738418544241*^9, 
  3.947738706807247*^9, 3.947739253891569*^9, 3.9477403755723248`*^9, 
  3.947744224190386*^9, 3.948249114552164*^9, 3.948250416332775*^9, 
  3.94830428290584*^9, 3.9483350224128456`*^9},
 CellTags->"Evaluation",
 CellLabel->"Out[53]=",ExpressionUUID->"ee46892d-ed84-ec48-b3a8-bb05159229bb"],

Cell[BoxData[
 FormBox[
  InterpretationBox[
   RowBox[{
    TagBox["CompiledFunction",
     "SummaryHead"], "[", 
    DynamicModuleBox[{Typeset`open$$ = False, Typeset`embedState$$ = "Ready"}, 
     TemplateBox[{
       PaneSelectorBox[{False -> GridBox[{{
             PaneBox[
              ButtonBox[
               DynamicBox[
                FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxOpener"], 
                ImageSizeCache -> {
                 9.771662737098522, {0., 9.771662737098522}}], Appearance -> 
               None, BaseStyle -> {}, 
               ButtonFunction :> (Typeset`open$$ = True), Evaluator -> 
               Automatic, Method -> "Preemptive"], 
              Alignment -> {Center, Center}, ImageSize -> 
              Dynamic[{
                Automatic, 
                 3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                  Magnification])}]], 
             GraphicsBox[{
               Thickness[0.038461538461538464`], {
                FaceForm[{
                  GrayLevel[0.93], 
                  Opacity[1.]}], 
                
                FilledCurveBox[{{{1, 4, 3}, {0, 1, 0}, {1, 3, 3}, {0, 1, 0}, {
                 1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {0, 1, 0}}}, {{{
                 25.499999999999996`, 2.5}, {25.499999999999996`, 
                 1.3953100000000003`}, {24.604699999999998`, 
                 0.49999999999999994`}, {23.5, 0.49999999999999994`}, {2.5, 
                 0.49999999999999994`}, {1.3953100000000003`, 
                 0.49999999999999994`}, {0.49999999999999994`, 
                 1.3953100000000003`}, {0.49999999999999994`, 2.5}, {
                 0.49999999999999994`, 23.5}, {0.49999999999999994`, 
                 24.604699999999998`}, {1.3953100000000003`, 
                 25.499999999999996`}, {2.5, 25.499999999999996`}, {23.5, 
                 25.499999999999996`}, {24.604699999999998`, 
                 25.499999999999996`}, {25.499999999999996`, 
                 24.604699999999998`}, {25.499999999999996`, 23.5}, {
                 25.499999999999996`, 2.5}}}]}, {
                FaceForm[{
                  RGBColor[0.5, 0.5, 0.5], 
                  Opacity[1.]}], 
                
                FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {
                 0, 1, 0}, {0, 1, 0}, {0, 1, 0}}}, {{{20.5426, 
                 19.116799999999998`}, {16.3832, 21.876199999999997`}, {
                 16.3832, 20.021499999999996`}, {6.930469999999999, 
                 20.021499999999996`}, {6.930469999999999, 
                 18.212100000000003`}, {16.3832, 18.212100000000003`}, {
                 16.3832, 16.357399999999995`}, {20.5426, 
                 19.116799999999998`}}}], 
                
                FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {
                 0, 1, 0}, {0, 1, 0}, {0, 1, 0}}}, {{{5.30508, 13.8391}, {
                 9.46445, 11.079700000000003`}, {9.46445, 
                 12.933999999999997`}, {18.917199999999998`, 
                 12.933999999999997`}, {18.917199999999998`, 14.7438}, {
                 9.46445, 14.7438}, {9.46445, 16.598}, {5.30508, 13.8391}}}], 
                
                FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {
                 0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
                 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {
                 1, 3, 3}, {1, 3, 3}, {1, 3, 3}}}, CompressedData["
1:eJxTTMoPSmVmYGBgBGJjIGYCYq4u+eR3VWoOxhkv5j+Qk3SA8fu/r5rKOVHM
Yd2vmNyjZ9Qcrt9QXbW9S8RBg59767IidQcPMYPGaHFhB+Nn61SfiGo4xBwp
T7o2V9Dh0Iolfg6/NBxEHv/x1Xgi4FB1XNNqkqQWnP+axUTQjFkbzn+oO2HB
j/3aDg/Xn5T6WiDoYLs3aJpiqI7DrHN+bO6tQg4zfUR7vF7pQOyfIQyRd9d1
WLL0U1kLoyjEPdm6DpoTXfQX7xBzKPjQejLkhDacL5J4+LL2Gm2HtNnSl4Vf
iELM69J2qPZM3tLnJerQX1oozZugDfHPUxGI/4W1HQ5p3TthoyDi4D7lG1v8
Mi2HgqL9zoEHhB1inOxe3BRG8MH62zXhfIbN1Z82CGhC/GMg4nCm3mN/7TYN
iHlCUPdGakDc/1kUEr46GhD/eYnD+d9iBf/kC0vC+TuCrSL+X5Vy2HGR4R5T
uAbEfxYykPBYp+HQqsCuesZAFhL+rJoQ/2rIQdxTpwkJ7yVycPfD+GDzVqLx
xbUd5HYt2JfqBdWfpA2Jj9mykPDpgYaXtaxDy7yzq86vg8qvlIHE5ylY/Eo7
XAt7o787TxfOB5ufqesQ9PbyxxkPZSDhZ6nrMAGU3u7LQtLLEx2HN2253UbX
ofZ76jis/Pay4oynAsT8QG0HKZMv/gW7FCDyTFpwPsz/MD44/Mw1HFjb1uR9
TVVwWKy880/7FHWIexrkIfLX1RzOMDZZVjHIOaDkh3vSDuj5AwCF11Vc
                 "]]}}, AspectRatio -> 1, Axes -> False, Background -> 
              GrayLevel[0.93], Frame -> True, FrameStyle -> Directive[
                Thickness[Tiny], 
                GrayLevel[0.7]], FrameTicks -> None, ImageSize -> 
              Dynamic[{
                Automatic, 
                 3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                  Magnification])}]], 
             GridBox[{{
                RowBox[{
                  TagBox["\"Argument count: \"", "SummaryItemAnnotation"], 
                  "\[InvisibleSpace]", 
                  TagBox["4", "SummaryItem"]}]}, {
                RowBox[{
                  TagBox["\"Argument types: \"", "SummaryItemAnnotation"], 
                  "\[InvisibleSpace]", 
                  TagBox[
                   StyleBox[
                    PaneBox[
                    RowBox[{"{", 
                    RowBox[{"_Real", ",", 
                    RowBox[{"{", 
                    RowBox[{"_Real", ",", "1"}], "}"}], ",", "_Integer", ",", 
                    RowBox[{"{", 
                    RowBox[{"_Real", ",", "2"}], "}"}]}], "}"}], 
                    BaselinePosition -> Baseline, ContentPadding -> False, 
                    FrameMargins -> 0, ImageSize -> {{1, 300}, Automatic}, 
                    StripOnInput -> True], LineBreakWithin -> False], 
                   "SummaryItem"]}]}}, AutoDelete -> False, 
              BaseStyle -> {
               ShowStringCharacters -> False, NumberMarks -> False, 
                PrintPrecision -> 3, ShowSyntaxStyles -> False}, 
              GridBoxAlignment -> {
               "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, 
              GridBoxItemSize -> {
               "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
              GridBoxSpacings -> {
               "Columns" -> {{2}}, "Rows" -> {{Automatic}}}]}}, AutoDelete -> 
           False, BaselinePosition -> {1, 1}, 
           GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
           GridBoxItemSize -> {
            "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}], True -> 
         GridBox[{{
             PaneBox[
              ButtonBox[
               DynamicBox[
                FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxCloser"]], 
               Appearance -> None, BaseStyle -> {}, 
               ButtonFunction :> (Typeset`open$$ = False), Evaluator -> 
               Automatic, Method -> "Preemptive"], 
              Alignment -> {Center, Center}, ImageSize -> 
              Dynamic[{
                Automatic, 
                 3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                  Magnification])}]], 
             GraphicsBox[{
               Thickness[0.038461538461538464`], {
                FaceForm[{
                  GrayLevel[0.93], 
                  Opacity[1.]}], 
                
                FilledCurveBox[{{{1, 4, 3}, {0, 1, 0}, {1, 3, 3}, {0, 1, 0}, {
                 1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {0, 1, 0}}}, {{{
                 25.499999999999996`, 2.5}, {25.499999999999996`, 
                 1.3953100000000003`}, {24.604699999999998`, 
                 0.49999999999999994`}, {23.5, 0.49999999999999994`}, {2.5, 
                 0.49999999999999994`}, {1.3953100000000003`, 
                 0.49999999999999994`}, {0.49999999999999994`, 
                 1.3953100000000003`}, {0.49999999999999994`, 2.5}, {
                 0.49999999999999994`, 23.5}, {0.49999999999999994`, 
                 24.604699999999998`}, {1.3953100000000003`, 
                 25.499999999999996`}, {2.5, 25.499999999999996`}, {23.5, 
                 25.499999999999996`}, {24.604699999999998`, 
                 25.499999999999996`}, {25.499999999999996`, 
                 24.604699999999998`}, {25.499999999999996`, 23.5}, {
                 25.499999999999996`, 2.5}}}]}, {
                FaceForm[{
                  RGBColor[0.5, 0.5, 0.5], 
                  Opacity[1.]}], 
                
                FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {
                 0, 1, 0}, {0, 1, 0}, {0, 1, 0}}}, {{{20.5426, 
                 19.116799999999998`}, {16.3832, 21.876199999999997`}, {
                 16.3832, 20.021499999999996`}, {6.930469999999999, 
                 20.021499999999996`}, {6.930469999999999, 
                 18.212100000000003`}, {16.3832, 18.212100000000003`}, {
                 16.3832, 16.357399999999995`}, {20.5426, 
                 19.116799999999998`}}}], 
                
                FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {
                 0, 1, 0}, {0, 1, 0}, {0, 1, 0}}}, {{{5.30508, 13.8391}, {
                 9.46445, 11.079700000000003`}, {9.46445, 
                 12.933999999999997`}, {18.917199999999998`, 
                 12.933999999999997`}, {18.917199999999998`, 14.7438}, {
                 9.46445, 14.7438}, {9.46445, 16.598}, {5.30508, 13.8391}}}], 
                
                FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {
                 0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
                 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {
                 1, 3, 3}, {1, 3, 3}, {1, 3, 3}}}, CompressedData["
1:eJxTTMoPSmVmYGBgBGJjIGYCYq4u+eR3VWoOxhkv5j+Qk3SA8fu/r5rKOVHM
Yd2vmNyjZ9Qcrt9QXbW9S8RBg59767IidQcPMYPGaHFhB+Nn61SfiGo4xBwp
T7o2V9Dh0Iolfg6/NBxEHv/x1Xgi4FB1XNNqkqQWnP+axUTQjFkbzn+oO2HB
j/3aDg/Xn5T6WiDoYLs3aJpiqI7DrHN+bO6tQg4zfUR7vF7pQOyfIQyRd9d1
WLL0U1kLoyjEPdm6DpoTXfQX7xBzKPjQejLkhDacL5J4+LL2Gm2HtNnSl4Vf
iELM69J2qPZM3tLnJerQX1oozZugDfHPUxGI/4W1HQ5p3TthoyDi4D7lG1v8
Mi2HgqL9zoEHhB1inOxe3BRG8MH62zXhfIbN1Z82CGhC/GMg4nCm3mN/7TYN
iHlCUPdGakDc/1kUEr46GhD/eYnD+d9iBf/kC0vC+TuCrSL+X5Vy2HGR4R5T
uAbEfxYykPBYp+HQqsCuesZAFhL+rJoQ/2rIQdxTpwkJ7yVycPfD+GDzVqLx
xbUd5HYt2JfqBdWfpA2Jj9mykPDpgYaXtaxDy7yzq86vg8qvlIHE5ylY/Eo7
XAt7o787TxfOB5ufqesQ9PbyxxkPZSDhZ6nrMAGU3u7LQtLLEx2HN2253UbX
ofZ76jis/Pay4oynAsT8QG0HKZMv/gW7FCDyTFpwPsz/MD44/Mw1HFjb1uR9
TVVwWKy880/7FHWIexrkIfLX1RzOMDZZVjHIOaDkh3vSDuj5AwCF11Vc
                 "]]}}, AspectRatio -> 1, Axes -> False, Background -> 
              GrayLevel[0.93], Frame -> True, FrameStyle -> Directive[
                Thickness[Tiny], 
                GrayLevel[0.7]], FrameTicks -> None, ImageSize -> 
              Dynamic[{
                Automatic, 
                 3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                  Magnification])}]], 
             GridBox[{{
                RowBox[{
                  TagBox["\"Argument count: \"", "SummaryItemAnnotation"], 
                  "\[InvisibleSpace]", 
                  TagBox["4", "SummaryItem"]}]}, {
                RowBox[{
                  TagBox["\"Argument types: \"", "SummaryItemAnnotation"], 
                  "\[InvisibleSpace]", 
                  TagBox[
                   PaneBox[
                    RowBox[{"{", 
                    RowBox[{"_Real", ",", 
                    RowBox[{"{", 
                    RowBox[{"_Real", ",", "1"}], "}"}], ",", "_Integer", ",", 
                    RowBox[{"{", 
                    RowBox[{"_Real", ",", "2"}], "}"}]}], "}"}], 
                    BaselinePosition -> Baseline, ContentPadding -> False, 
                    FrameMargins -> 0, ImageSize -> {{1, 500}, Automatic}, 
                    StripOnInput -> True], "SummaryItem"]}]}, {
                RowBox[{
                  TagBox["\"Variables: \"", "SummaryItemAnnotation"], 
                  "\[InvisibleSpace]", 
                  TagBox[
                   RowBox[{"{", 
                    
                    RowBox[{
                    "rand\[Theta]log", ",", "grid\[Theta]log", ",", 
                    "index\[Theta]", ",", "distrlog"}], "}"}], 
                   "SummaryItem"]}]}, {
                RowBox[{
                  TagBox["\"Expression: \"", "SummaryItemAnnotation"], 
                  "\[InvisibleSpace]", 
                  TagBox[
                   PaneBox[
                    RowBox[{"Module", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    
                    RowBox[{
                    "\[Theta]el", ",", "x1", ",", "x2", ",", "z1", ",", "z2", 
                    ",", "\[CapitalDelta]", ",", "indexlarger\[Theta]"}], 
                    "}"}], ",", 
                    RowBox[{
                    RowBox[{"\[Theta]el", "=", 
                    RowBox[{"Compile`GetElement", "(", 
                    RowBox[{"grid\[Theta]log", ",", "index\[Theta]"}], 
                    ")"}]}], ";", 
                    RowBox[{"indexlarger\[Theta]", "=", 
                    RowBox[{"index\[Theta]", "+", 
                    TemplateBox[{
                    RowBox[{
                    RowBox[{"rand\[Theta]log", "-", "\[Theta]el"}]}]}, 
                    "UnitStepSeq"]}]}], ";", 
                    RowBox[{"x1", "=", 
                    RowBox[{"Compile`GetElement", "(", 
                    RowBox[{"grid\[Theta]log", ",", 
                    RowBox[{"indexlarger\[Theta]", "-", "1"}]}], ")"}]}], ";", 
                    RowBox[{"x2", "=", 
                    RowBox[{"Compile`GetElement", "(", 
                    RowBox[{"grid\[Theta]log", ",", "indexlarger\[Theta]"}], 
                    ")"}]}], ";", 
                    RowBox[{"z1", "=", 
                    RowBox[{"Compile`GetElement", "(", 
                    
                    RowBox[{"distrlog", ",", "indexlarger\[Theta]", ",", 
                    "2"}], ")"}]}], ";", 
                    RowBox[{"z2", "=", 
                    RowBox[{"Compile`GetElement", "(", 
                    RowBox[{"distrlog", ",", 
                    RowBox[{"indexlarger\[Theta]", "-", "1"}], ",", "2"}], 
                    ")"}]}], ";", 
                    RowBox[{"\[CapitalDelta]", "=", 
                    RowBox[{"x2", "-", "x1"}]}], ";", 
                    RowBox[{
                    FractionBox[
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"rand\[Theta]log", "-", "x1"}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{"z2", "-", "z1"}], ")"}]}], "\[CapitalDelta]"], 
                    "+", "z1"}]}]}], "]"}], BaselinePosition -> Baseline, 
                    ContentPadding -> False, FrameMargins -> 0, 
                    ImageSize -> {{1, 500}, Automatic}, StripOnInput -> True],
                    "SummaryItem"]}]}}, AutoDelete -> False, 
              BaseStyle -> {
               ShowStringCharacters -> False, NumberMarks -> False, 
                PrintPrecision -> 3, ShowSyntaxStyles -> False}, 
              GridBoxAlignment -> {
               "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, 
              GridBoxItemSize -> {
               "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
              GridBoxSpacings -> {
               "Columns" -> {{2}}, "Rows" -> {{Automatic}}}]}}, AutoDelete -> 
           False, BaselinePosition -> {1, 1}, 
           GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
           GridBoxItemSize -> {
            "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}]}, 
        Dynamic[Typeset`open$$], ImageSize -> Automatic]},
      "SummaryPanel"],
     DynamicModuleValues:>{}], "]"}],
   CompiledFunction[{11, 14.1, 5848}, {
     Blank[Real], {
      Blank[Real], 1}, 
     Blank[Integer], {
      Blank[Real], 2}}, {{3, 0, 0}, {3, 1, 0}, {2, 0, 0}, {3, 2, 1}, {3, 0, 
    9}}, {{-1, {2, 0, 3}}, {2, {2, 0, 4}}}, {0, 5, 10, 0, 
    2}, {{37, 0, 0, 3, 1}, {19, 1, 2}, {13, 0, 2, 3}, {40, 66, 3, 0, 3, 2, 0, 
     1}, {12, 0, 1, 2}, {12, 2, 3, 1}, {37, 0, 1, 3, 3}, {37, 0, 2, 3, 2}, {
     37, 1, 2, 4, 3, 4}, {12, 2, 3, 1}, {37, 1, 1, 4, 3, 5}, {19, 3, 6}, {13, 
     2, 6, 7}, {19, 3, 6}, {13, 0, 6, 8}, {19, 4, 6}, {13, 5, 6, 9}, {40, 60, 
     3, 0, 7, 3, 0, 6}, {16, 9, 6, 9}, {16, 8, 9, 8}, {13, 4, 8, 9}, {1}}, 
    Function[{$CellContext`rand\[Theta]log, $CellContext`grid\[Theta]log, \
$CellContext`index\[Theta], $CellContext`distrlog}, 
     Module[{$CellContext`\[Theta]el, $CellContext`x1, $CellContext`x2, \
$CellContext`z1, $CellContext`z2, $CellContext`\[CapitalDelta], \
$CellContext`indexlarger\[Theta]}, $CellContext`\[Theta]el = 
       Compile`GetElement[$CellContext`grid\[Theta]log, $CellContext`index\
\[Theta]]; $CellContext`indexlarger\[Theta] = $CellContext`index\[Theta] + 
        UnitStep[$CellContext`rand\[Theta]log - $CellContext`\[Theta]el]; \
$CellContext`x1 = 
       Compile`GetElement[$CellContext`grid\[Theta]log, \
$CellContext`indexlarger\[Theta] - 1]; $CellContext`x2 = 
       Compile`GetElement[$CellContext`grid\[Theta]log, \
$CellContext`indexlarger\[Theta]]; $CellContext`z1 = 
       Compile`GetElement[$CellContext`distrlog, $CellContext`indexlarger\
\[Theta], 2]; $CellContext`z2 = 
       Compile`GetElement[$CellContext`distrlog, $CellContext`indexlarger\
\[Theta] - 1, 
         2]; $CellContext`\[CapitalDelta] = $CellContext`x2 - $CellContext`x1; \
$CellContext`z1 + ($CellContext`rand\[Theta]log - $CellContext`x1) \
(($CellContext`z2 - $CellContext`z1)/$CellContext`\[CapitalDelta])], 
     Listable], Evaluate, 
    LibraryFunction[
    "C:\\Users\\miksi\\AppData\\Roaming\\Wolfram\\ApplicationData\\\
CCompilerDriver\\BuildFolder\\laptop-u485fl4q-35124\\compiledFunction5.dll", 
     "compiledFunction5", {{Real, 0, "Constant"}, {Real, 1, "Constant"}, {
      Integer, 0, "Constant"}, {Real, 2, "Constant"}}, Real]],
   Editable->False,
   SelectWithContents->True,
   Selectable->False], TraditionalForm]], "Output",
 CellChangeTimes->{3.943416185403698*^9, 3.947738418544241*^9, 
  3.947738706807247*^9, 3.947739253891569*^9, 3.9477403755723248`*^9, 
  3.947744224190386*^9, 3.948249114552164*^9, 3.948250416332775*^9, 
  3.94830428290584*^9, 3.948335024055187*^9},
 CellTags->"Evaluation",
 CellLabel->"Out[56]=",ExpressionUUID->"48f8d862-8c06-734b-a31b-285c9116370a"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Finding ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["E", "max"], "(", "\[Theta]", ")"}], TraditionalForm]],
  ExpressionUUID->"8b974601-2062-0049-9a64-43f65fa0bb17"],
 " - for efficient energy sampling for the given \[Theta]"
}], "Subsection",
 CellChangeTimes->{{3.913107151768467*^9, 3.9131071573912096`*^9}, {
  3.913264603355554*^9, 3.9132646294516373`*^9}},
 CellTags->
  "Evaluation",ExpressionUUID->"4ebf9064-21ad-ce4e-bcca-9c9189045b26"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Function", " ", "to", " ", "process", " ", "the", " ", "table"}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"FindingMaxEnergy", "[", 
     RowBox[{"tab_", ",", "order_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"Egrouped", ",", "tot"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"Group", " ", "by", " ", "y", " ", "values"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Egrouped", "=", 
        RowBox[{"GatherBy", "[", 
         RowBox[{"tab", ",", 
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "&"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "Sum", " ", "z", " ", "values", " ", "for", " ", "each", " ", "y", 
         " ", "and", " ", "create", " ", "new", " ", "table"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"\[Theta]summed", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Egrouped", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "1", ",", "2"}], "]"}], "]"}], ",", 
            RowBox[{"Total", "[", 
             RowBox[{"Egrouped", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "All", ",", "3"}], "]"}], "]"}], "]"}]}], 
           "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"Length", "[", "Egrouped", "]"}]}], "}"}]}], "]"}]}], ";",
        "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Max", "[", 
           RowBox[{"\[Theta]summed", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}], ">", 
          SuperscriptBox["10", 
           RowBox[{"-", "30."}]]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"tot", "=", 
           RowBox[{
            RowBox[{"\[Theta]summed", "[", 
             RowBox[{"[", 
              RowBox[{"All", ",", "2"}], "]"}], "]"}], "//", "Total"}]}], ";",
           "\[IndentingNewLine]", 
          RowBox[{"accum", "=", 
           FractionBox[
            RowBox[{"tot", "-", 
             RowBox[{"Accumulate", "[", 
              RowBox[{"\[Theta]summed", "[", 
               RowBox[{"[", 
                RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}]}], "tot"]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"sel", "=", 
           RowBox[{"Select", "[", 
            RowBox[{"accum", ",", 
             RowBox[{
              RowBox[{"#", ">=", 
               SuperscriptBox["10", 
                RowBox[{"-", "order"}]]}], "&"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", "sel", "]"}], "!=", "0."}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"emaxpos", "=", 
              RowBox[{"Min", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"Position", "[", 
                    RowBox[{"accum", ",", 
                    RowBox[{"sel", "[", 
                    RowBox[{"[", 
                    RowBox[{"-", "1"}], "]"}], "]"}]}], "]"}], "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "+", "1"}], ",", 
                RowBox[{"Length", "[", "accum", "]"}]}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"emaxval", "=", 
              RowBox[{
               RowBox[{"\[Theta]summed", "[", 
                RowBox[{"[", "emaxpos", "]"}], "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
            RowBox[{"emaxval", "=", 
             RowBox[{
              RowBox[{"\[Theta]summed", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}]}]}], "]"}]}]}], "]"}], ";", 
       "\[IndentingNewLine]", "emaxval"}]}], "\[IndentingNewLine]", "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"DataLogarithmiedComp", "=", 
     RowBox[{"Compile", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"data", ",", "_Real", ",", "1"}], "}"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Log", "[", 
          RowBox[{"Compile`GetElement", "[", 
           RowBox[{"data", ",", "1"}], "]"}], "]"}], ",", 
         RowBox[{"Log", "[", 
          RowBox[{"Compile`GetElement", "[", 
           RowBox[{"data", ",", "2"}], "]"}], "]"}], ",", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Compile`GetElement", "[", 
             RowBox[{"data", ",", "3"}], "]"}], "\[Equal]", "0"}], ",", 
           RowBox[{"Log", "[", 
            SuperscriptBox["10", 
             RowBox[{"-", "90."}]], "]"}], ",", 
           RowBox[{"Log", "[", 
            RowBox[{"Compile`GetElement", "[", 
             RowBox[{"data", ",", "3"}], "]"}], "]"}]}], "]"}]}], "}"}], ",", 
       RowBox[{"CompilationTarget", "\[Rule]", "\"\<C\>\""}], ",", 
       RowBox[{"RuntimeOptions", "\[Rule]", "\"\<Speed\>\""}], ",", 
       RowBox[{"RuntimeAttributes", "->", 
        RowBox[{"{", "Listable", "}"}]}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Do", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"\[Theta]gridForEmax", "[", "fac", "]"}], "=", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SuperscriptBox["10", 
            RowBox[{"-", "5."}]], ",", 
           SuperscriptBox["10", 
            RowBox[{"-", "4."}]], ",", "0.001", ",", "0.005", ",", "0.008", 
           ",", "0.01", ",", "0.02", ",", "0.03", ",", "0.04", ",", "0.06", 
           ",", "0.08", ",", "0.1", ",", "0.11", ",", "0.12", ",", "0.13", 
           ",", "0.15", ",", "0.17", ",", "0.2", ",", "0.3", ",", "0.4", ",", 
           "0.5", ",", "0.6", ",", "0.7", ",", "0.8", ",", "0.9", ",", "1.", 
           ",", "1.2", ",", "1.3", ",", 
           FractionBox["Pi", "2"]}], "}"}], "//", "N"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"fac", "==", "\"\<LHC\>\""}], ",", 
         RowBox[{
          RowBox[{"\[Theta]gridForEmax", "[", "fac", "]"}], "=", 
          RowBox[{
           RowBox[{
            RowBox[{"Join", "[", 
             RowBox[{
              RowBox[{"\[Theta]gridForEmax", "[", "fac", "]"}], ",", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"3", "*", 
                  SuperscriptBox["10", 
                   RowBox[{"-", "4."}]]}], ",", 
                 RowBox[{"6", "*", 
                  SuperscriptBox["10", 
                   RowBox[{"-", "4."}]]}], ",", 
                 RowBox[{"2", "*", 
                  SuperscriptBox["10", 
                   RowBox[{"-", "3"}]]}], ",", 
                 RowBox[{"3", "*", 
                  SuperscriptBox["10", 
                   RowBox[{"-", "3"}]]}], ",", 
                 RowBox[{"4", "*", 
                  SuperscriptBox["10", 
                   RowBox[{"-", "3"}]]}], ",", 
                 RowBox[{"6", "*", 
                  SuperscriptBox["10", 
                   RowBox[{"-", "3"}]]}], ",", 
                 RowBox[{"7", "*", 
                  SuperscriptBox["10", 
                   RowBox[{"-", "3"}]]}], ",", 
                 RowBox[{"9", "*", 
                  SuperscriptBox["10", 
                   RowBox[{"-", "3."}]]}], ",", "0.011", ",", "0.013", ",", 
                 "0.016", ",", "0.018", ",", "0.022", ",", "0.024", ",", 
                 "0.027", ",", "0.033", ",", "0.036", ",", "0.045", ",", 
                 "0.05", ",", "0.07", ",", "0.09"}], "}"}], "//", "N"}]}], 
             "]"}], "//", "Sort"}], "//", "DeleteDuplicates"}]}]}], "]"}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"fac", "==", "\"\<FCC-hh\>\""}], ",", 
         RowBox[{
          RowBox[{"\[Theta]gridForEmax", "[", "fac", "]"}], "=", 
          RowBox[{
           RowBox[{
            RowBox[{"Join", "[", 
             RowBox[{
              RowBox[{"\[Theta]gridForEmax", "[", "fac", "]"}], ",", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"5", "*", 
                  SuperscriptBox["10", 
                   RowBox[{"-", "5."}]]}], ",", 
                 RowBox[{"2", "*", 
                  SuperscriptBox["10", 
                   RowBox[{"-", "4."}]]}], ",", 
                 RowBox[{"4", "*", 
                  SuperscriptBox["10", 
                   RowBox[{"-", "4."}]]}], ",", 
                 RowBox[{"6", "*", 
                  SuperscriptBox["10", 
                   RowBox[{"-", "4."}]]}], ",", 
                 RowBox[{"8", "*", 
                  SuperscriptBox["10", 
                   RowBox[{"-", "4."}]]}], ",", 
                 RowBox[{"2", "*", 
                  SuperscriptBox["10", 
                   RowBox[{"-", "3"}]]}], ",", 
                 RowBox[{"3", "*", 
                  SuperscriptBox["10", 
                   RowBox[{"-", "3"}]]}], ",", 
                 RowBox[{"4", "*", 
                  SuperscriptBox["10", 
                   RowBox[{"-", "3."}]]}]}], "}"}], "//", "N"}]}], "]"}], "//",
             "Sort"}], "//", "DeleteDuplicates"}]}]}], "]"}], ";"}], 
      "\[IndentingNewLine]", ",", 
      RowBox[{"{", 
       RowBox[{"fac", ",", "FacilitiesList"}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"FindingEmax\[Theta]", "[", 
     RowBox[{"data_", ",", "Facility_", ",", "order_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"(*", 
        RowBox[{
        "\[Theta]minmax", ",", "eminmax", ",", "GridIn", ",", "distrv", ",", 
         "GridOut", ",", "xigDistr", ",", "distrvals", ",", "mappeddistr", 
         ",", "\[Theta]emax", ",", "emax", ",", "\[Theta]ranges", ",", 
         "distrdatalog"}], "*)"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"IfCollider", "=", 
        RowBox[{"MemberQ", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"\"\<LHC\>\"", ",", "\"\<FCC-hh\>\""}], "}"}], ",", 
          "Facility"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"distrdatalog", "=", 
        RowBox[{"DataLogarithmiedComp", "[", "data", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"GridIn", "=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"DeleteDuplicates", "[", 
             RowBox[{"distrdatalog", "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", "#"}], "]"}], "]"}], "]"}], "&"}], "/@", 
           RowBox[{"{", 
            RowBox[{"1", ",", "2"}], "}"}]}], ")"}], "//", "N"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"distrv", "=", 
        RowBox[{"ArrayReshape", "[", 
         RowBox[{
          RowBox[{"distrdatalog", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "3"}], "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"GridIn", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
            RowBox[{"Length", "[", 
             RowBox[{"GridIn", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"\[Theta]minmax", ",", "eminmax"}], "}"}], "=", 
        RowBox[{
         RowBox[{
          RowBox[{"MinMax", "[", 
           RowBox[{"data", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "#"}], "]"}], "]"}], "]"}], "&"}], "/@", 
         RowBox[{"{", 
          RowBox[{"1", ",", "2"}], "}"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"\[Theta]ranges", "=", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{"IfCollider", ",", 
           RowBox[{"Select", "[", 
            RowBox[{
             RowBox[{"\[Theta]gridForEmax", "[", "Facility", "]"}], ",", 
             RowBox[{
              RowBox[{
               RowBox[{"\[Theta]minmax", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "<=", "#"}], "&"}]}], "]"}], 
           ",", 
           RowBox[{"Select", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"Flatten", "[", 
                 RowBox[{"Join", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"#", ",", 
                    RowBox[{"Pi", "-", "#"}]}], "}"}], "&"}], "/@", 
                   RowBox[{"Join", "[", 
                    RowBox[{
                    RowBox[{"\[Theta]gridForEmax", "[", "Facility", "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"\[Theta]minmax", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "}"}]}], "]"}]}], "]"}], 
                 "]"}], "//", "N"}], "//", "Sort"}], "//", 
              "DeleteDuplicates"}], ",", 
             RowBox[{
              RowBox[{
               RowBox[{"\[Theta]minmax", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "<=", "#", "<=", 
               RowBox[{"\[Theta]minmax", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "&"}]}], "]"}]}], "]"}], "//",
          "N"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"\[Theta]emax", "=", 
        RowBox[{"{", 
         RowBox[{"{", "}"}], "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"nintervals", "=", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"\[Theta]ranges", "[", 
                RowBox[{"[", 
                 RowBox[{"i", "+", "1"}], "]"}], "]"}], "-", 
               RowBox[{"\[Theta]ranges", "[", 
                RowBox[{"[", "i", "]"}], "]"}]}], ">", 
              SuperscriptBox["10", 
               RowBox[{"-", "3"}]]}], ",", "10", ",", "3"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"GridOut", "=", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Table", "[", 
               RowBox[{"th", ",", 
                RowBox[{"{", 
                 RowBox[{"th", ",", 
                  RowBox[{"\[Theta]ranges", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], ",", 
                  RowBox[{"\[Theta]ranges", "[", 
                   RowBox[{"[", 
                    RowBox[{"i", "+", "1"}], "]"}], "]"}], ",", 
                  FractionBox[
                   RowBox[{
                    RowBox[{"\[Theta]ranges", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", "+", "1"}], "]"}], "]"}], "-", 
                    RowBox[{"\[Theta]ranges", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], "nintervals"]}], 
                 "}"}]}], "]"}], ",", 
              RowBox[{
               RowBox[{"Join", "[", 
                RowBox[{
                 RowBox[{"Table", "[", 
                  RowBox[{
                   RowBox[{"Exp", "[", "e", "]"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"e", ",", 
                    RowBox[{"Log", "[", 
                    RowBox[{"eminmax", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Log", "[", 
                    RowBox[{"eminmax", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Max", "[", 
                    RowBox[{"0.1", ",", 
                    FractionBox[
                    RowBox[{
                    RowBox[{"Log", "[", 
                    RowBox[{"eminmax", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "]"}], "-", 
                    RowBox[{"Log", "[", 
                    RowBox[{"eminmax", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "100"]}], 
                    "]"}]}], "}"}]}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"eminmax", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "}"}]}], "]"}], "//", 
               "DeleteDuplicates"}]}], "}"}], "//", "Log"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"xigDistr", "=", 
           RowBox[{"MapThread", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Interpolation", "[", 
                RowBox[{
                 RowBox[{"Transpose", "@", 
                  RowBox[{"{", 
                   RowBox[{"#", ",", 
                    RowBox[{"Range", "@", 
                    RowBox[{"Length", "@", "#"}]}]}], "}"}]}], ",", 
                 RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[",
                "#2", "]"}], "&"}], ",", 
             RowBox[{"{", 
              RowBox[{"GridIn", ",", "GridOut"}], "}"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"distrvals", "=", 
           RowBox[{"Flatten", "@", 
            RowBox[{"cf2", "[", 
             RowBox[{
              RowBox[{"Sequence", "@@", "xigDistr"}], ",", "distrv"}], 
             "]"}]}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"mappeddistr", "=", 
           RowBox[{"Exp", "[", 
            RowBox[{"Join", "[", 
             RowBox[{
              RowBox[{"Tuples", "[", "GridOut", "]"}], ",", 
              RowBox[{"Partition", "[", 
               RowBox[{"distrvals", ",", "1"}], "]"}], ",", "2"}], "]"}], 
            "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"emax", "=", 
           RowBox[{"FindingMaxEnergy", "[", 
            RowBox[{"mappeddistr", ",", "order"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"\[Theta]emax", "=", 
           RowBox[{"Join", "[", 
            RowBox[{"\[Theta]emax", ",", 
             RowBox[{"{", 
              RowBox[{"{", 
               RowBox[{
                FractionBox[
                 RowBox[{
                  RowBox[{"\[Theta]ranges", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], "+", 
                  RowBox[{"\[Theta]ranges", "[", 
                   RowBox[{"[", 
                    RowBox[{"i", "+", "1"}], "]"}], "]"}]}], "2"], ",", 
                "emax"}], "}"}], "}"}]}], "]"}]}], ";"}], 
         "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{
            RowBox[{"Length", "[", "\[Theta]ranges", "]"}], "-", "1"}], ",", 
           "1"}], "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"\[Theta]emax", "=", 
        RowBox[{"Drop", "[", 
         RowBox[{"\[Theta]emax", ",", "1"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"\[Theta]emax", "=", 
        RowBox[{"Log", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{"IfCollider", ",", 
              RowBox[{"Flatten", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Join", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"#", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Pi", "-", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ",", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "}"}], "&"}], "/@", 
                    "#"}]}], "}"}], "&"}], "/@", 
                   RowBox[{"{", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\[Theta]minmax", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"\[Theta]emax", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "}"}], "}"}], ",", 
                    "\[Theta]emax"}], "]"}], "}"}]}], "]"}], "[", 
                 RowBox[{"[", "1", "]"}], "]"}], ",", "1"}], "]"}], ",", 
              RowBox[{"Join", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"\[Theta]minmax", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                   RowBox[{
                    RowBox[{"\[Theta]emax", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "}"}], "}"}], ",", 
                "\[Theta]emax", ",", 
                RowBox[{"{", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"\[Theta]minmax", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                   RowBox[{
                    RowBox[{"\[Theta]emax", "[", 
                    RowBox[{"[", 
                    RowBox[{"-", "1"}], "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "}"}], "}"}]}], "]"}]}],
              "]"}], "//", "Sort"}], "//", "DeleteDuplicates"}], "//", "N"}], 
         "]"}]}]}]}], "\[IndentingNewLine]", "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.9131762698586264`*^9, 3.913176313358836*^9}, {
   3.9131763563091617`*^9, 3.9131764611215096`*^9}, {3.913176874789384*^9, 
   3.9131769130859327`*^9}, {3.9131769659977584`*^9, 
   3.9131770687054243`*^9}, {3.913177268212186*^9, 3.9131772685946093`*^9}, {
   3.913177307637892*^9, 3.9131773135090656`*^9}, {3.9131773446825495`*^9, 
   3.913177361004506*^9}, {3.913177409277397*^9, 3.9131774424090986`*^9}, {
   3.9131778525452347`*^9, 3.9131778833041906`*^9}, {3.91317903671218*^9, 
   3.9131790394087143`*^9}, {3.9131791215239305`*^9, 
   3.9131791219144664`*^9}, {3.913179276784492*^9, 3.9131792798928676`*^9}, {
   3.9131801463915854`*^9, 3.9131801771928606`*^9}, 3.9131802316178336`*^9, 
   3.9131803256337175`*^9, {3.9131804249086747`*^9, 3.913180436471838*^9}, {
   3.913180484525958*^9, 3.9131805203630977`*^9}, 3.9131834695391173`*^9, {
   3.9131880736839914`*^9, 3.9131880763988543`*^9}, {3.913188274501943*^9, 
   3.913188324541342*^9}, {3.9131884097454286`*^9, 3.913188410483885*^9}, 
   3.9131884711019278`*^9, {3.913202185755698*^9, 3.9132021884381733`*^9}, {
   3.9132022370660295`*^9, 3.9132022373782296`*^9}, {3.9132023140592966`*^9, 
   3.913202334078602*^9}, {3.9132024165220957`*^9, 3.913202416773042*^9}, {
   3.913202808990028*^9, 3.913202881203199*^9}, 3.914143172893423*^9, {
   3.9141432680580235`*^9, 3.914143269412343*^9}, {3.914488700474924*^9, 
   3.9144887005366697`*^9}, {3.9157035989405704`*^9, 3.915703615958143*^9}, 
   3.9157036507890577`*^9, {3.9157037653217144`*^9, 3.9157037654731054`*^9}, {
   3.9157040188054347`*^9, 3.915704038562193*^9}, {3.915704105378541*^9, 
   3.9157041435899963`*^9}, {3.9157042257790623`*^9, 3.915704253480098*^9}, {
   3.9157043013651543`*^9, 3.915704307933041*^9}, {3.9157043617223835`*^9, 
   3.9157043740567102`*^9}, {3.9157047419157534`*^9, 3.915704806916683*^9}, {
   3.915704844811511*^9, 3.915704978148676*^9}, {3.9157050247002707`*^9, 
   3.915705048526478*^9}, {3.9157051109542418`*^9, 3.9157052450514493`*^9}, {
   3.9157052765857515`*^9, 3.9157053389897156`*^9}, {3.9157056363607125`*^9, 
   3.915705703694833*^9}, {3.915705744444703*^9, 3.915705765392256*^9}, {
   3.915705795522413*^9, 3.915705818388652*^9}, {3.91745161513745*^9, 
   3.917451615340181*^9}, {3.917451678532138*^9, 3.917451724908331*^9}, {
   3.9174518952729225`*^9, 3.9174519106810184`*^9}, {3.9174519522323275`*^9, 
   3.917451959773726*^9}, {3.9174558842889967`*^9, 3.9174558898041863`*^9}},
 CellTags->"Evaluation",
 CellLabel->"In[24]:=",ExpressionUUID->"161d6bc4-7d02-334e-9526-1961fc0f1979"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Sampling points", "Section",
 CellChangeTimes->{{3.9132646383244524`*^9, 3.9132646431434236`*^9}},
 CellTags->
  "Evaluation",ExpressionUUID->"9d0f8af7-bcd9-5b4f-a2bc-7ac901668df5"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"erandcomp", "=", 
   RowBox[{
    RowBox[{"Compile", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"eminv", ",", "_Real"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"emaxv", ",", "_Real"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Nev", ",", "_Integer"}], "}"}]}], "}"}], ",", 
      RowBox[{"Log", "[", 
       RowBox[{"RandomReal", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Exp", "[", "eminv", "]"}], ",", 
          RowBox[{"Exp", "[", "emaxv", "]"}]}], "}"}], "]"}], "]"}], ",", 
      RowBox[{"CompilationTarget", "\[Rule]", "\"\<C\>\""}], ",", 
      RowBox[{"RuntimeOptions", "\[Rule]", "\"\<Speed\>\""}], ",", 
      RowBox[{"RuntimeAttributes", "->", 
       RowBox[{"{", "Listable", "}"}]}]}], "]"}], "//", "ReleaseHold"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"MotherDataCompiled", "=", 
  RowBox[{"Compile", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"Events", ",", "_Real", ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"m", ",", "_Real"}], "}"}]}], "}"}], ",", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"thv", ",", "ev", ",", "\[Phi]v", ",", "pv"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"thv", "=", 
        RowBox[{"Compile`GetElement", "[", 
         RowBox[{"Events", ",", "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"ev", "=", 
        RowBox[{"Compile`GetElement", "[", 
         RowBox[{"Events", ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"\[Phi]v", "=", 
        RowBox[{"RandomReal", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "Pi"}], ",", "Pi"}], "}"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"pv", "=", 
        SqrtBox[
         RowBox[{
          SuperscriptBox["ev", "2"], "-", 
          SuperscriptBox["m", "2"]}]]}], ";", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"pv", "*", 
          RowBox[{"Cos", "[", "\[Phi]v", "]"}], "*", 
          RowBox[{"Sin", "[", "thv", "]"}]}], ",", 
         RowBox[{"pv", "*", 
          RowBox[{"Sin", "[", "\[Phi]v", "]"}], "*", 
          RowBox[{"Sin", "[", "thv", "]"}]}], ",", 
         RowBox[{"pv", "*", 
          RowBox[{"Cos", "[", "thv", "]"}]}], ",", "ev", ",", "m"}], 
        "}"}]}]}], "\[IndentingNewLine]", "]"}], ",", 
    RowBox[{"CompilationTarget", "\[Rule]", "\"\<C\>\""}], ",", 
    RowBox[{"RuntimeOptions", "\[Rule]", "\"\<Speed\>\""}], ",", 
    RowBox[{"RuntimeAttributes", "->", 
     RowBox[{"{", "Listable", "}"}]}], ",", 
    RowBox[{"Parallelization", "->", "True"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BlockPointsFromSmoothDistribution1", "[", 
   RowBox[{
   "data_", ",", "m_", ",", "Nevents_", ",", "order_", ",", "Facility_"}], 
   "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "Emaxlist", ",", "\[Theta]minmax", ",", "Data\[Phi]", ",", "Nev", ",", 
      "eminmax", ",", "NevSampl"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"IfCollider", "=", 
      RowBox[{"MemberQ", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"\"\<LHC\>\"", ",", "\"\<FCC-hh\>\""}], "}"}], ",", 
        "Facility"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"distrdatalog", "=", 
      RowBox[{"DataLogarithmiedComp", "[", "data", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"GridIn", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"DeleteDuplicates", "[", 
           RowBox[{"distrdatalog", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "#"}], "]"}], "]"}], "]"}], "&"}], "/@", 
         RowBox[{"{", 
          RowBox[{"1", ",", "2"}], "}"}]}], ")"}], "//", "N"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Theta]minmax", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Min", "[", "#", "]"}], ",", 
            RowBox[{"If", "[", 
             RowBox[{"IfCollider", ",", 
              FractionBox["Pi", "2."], ",", 
              RowBox[{"Max", "[", "#", "]"}]}], "]"}]}], "}"}], "&"}], "/@", 
         RowBox[{"{", 
          RowBox[{"data", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "1"}], "]"}], "]"}], "}"}]}], ")"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"emin", "=", 
      RowBox[{"Log", "[", 
       RowBox[{"Min", "[", 
        RowBox[{"data", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"Computing", " ", "table", " ", 
       SubscriptBox["E", "max"], 
       RowBox[{"(", "\[Theta]", ")"}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Nev", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"!", "IfCollider"}], ",", "Nevents", ",", 
        RowBox[{"IntegerPart", "[", 
         RowBox[{"Nevents", "/", "2"}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"NevSampl", "=", 
      RowBox[{"Max", "[", 
       RowBox[{
        RowBox[{"3", "*", "Nev"}], ",", 
        SuperscriptBox["10", "6"]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Theta]emaxdata", "=", 
      RowBox[{"FindingEmax\[Theta]", "[", 
       RowBox[{"data", ",", "Facility", ",", "order"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "___", "___", "___", "___", "___", "___", "___", "___", "___", "___", 
       "___", "_"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Generating", " ", "the", " ", "grid", " ", "of", " ", 
        SubscriptBox["\[Theta]", "rand"]}], ",", 
       SubscriptBox["E", "rand"]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "___", "___", "___", "___", "___", "___", "___", "___", "___", "___", 
       "___", "_"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"Generating", " ", "random", " ", "\[Theta]"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"\[Theta]rand", "=", 
      RowBox[{"Log", "[", 
       RowBox[{"RandomReal", "[", 
        RowBox[{"\[Theta]minmax", ",", "NevSampl"}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"For", " ", "each", " ", "\[Theta]"}], ",", " ", 
       RowBox[{
        RowBox[{"generaring", " ", "random", " ", "E"}], "\[Element]", 
        RowBox[{"{", 
         RowBox[{
          SubscriptBox["E", "min"], ",", 
          RowBox[{
           SubscriptBox["E", "max"], 
           RowBox[{"(", "\[Theta]", ")"}]}]}], "}"}]}]}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"nf\[Theta]Emaxlog", "=", 
      RowBox[{"Nearest", "[", 
       RowBox[{
        RowBox[{"\[Theta]emaxdata", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "1"}], "]"}], "]"}], "->", "\"\<Index\>\""}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"index\[Theta]Emaxlog", "=", 
      RowBox[{
       RowBox[{"nf\[Theta]Emaxlog", "[", "\[Theta]rand", "]"}], "//", 
       "Flatten"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"emaxrand", "=", 
      RowBox[{"linint1", "[", 
       RowBox[{"\[Theta]rand", ",", 
        RowBox[{"\[Theta]emaxdata", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", 
        "index\[Theta]Emaxlog", ",", "\[Theta]emaxdata"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"erand", "=", 
      RowBox[{"erandcomp", "[", 
       RowBox[{"emin", ",", "emaxrand", ",", "NevSampl"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"Now", ",", " ", 
       RowBox[{
       "calculating", " ", "the", " ", "weights", " ", "for", " ", "the", " ",
         "generated", " ", 
        SubscriptBox["\[Theta]", "rand"]}], ",", 
       SubscriptBox["E", "rand"]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"nf\[Theta]log", "=", 
      RowBox[{"Nearest", "[", 
       RowBox[{
        RowBox[{"GridIn", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "->", "\"\<Index\>\""}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"nfElog", "=", 
      RowBox[{"Nearest", "[", 
       RowBox[{
        RowBox[{"GridIn", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "->", "\"\<Index\>\""}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"index\[Theta]rand", ",", "indexerand"}], "}"}], "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"nf\[Theta]log", "[", "\[Theta]rand", "]"}], "//", 
         "Flatten"}], ",", 
        RowBox[{
         RowBox[{"nfElog", "[", "erand", "]"}], "//", "Flatten"}]}], "}"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"weights", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Exp", "[", "emaxrand", "]"}], "-", 
         RowBox[{"Exp", "[", "emin", "]"}]}], ")"}], "*", 
       RowBox[{"linint2", "[", 
        RowBox[{"\[Theta]rand", ",", "erand", ",", 
         RowBox[{"GridIn", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", 
         RowBox[{"GridIn", "[", 
          RowBox[{"[", "2", "]"}], "]"}], ",", "index\[Theta]rand", ",", 
         "indexerand", ",", "distrdatalog"}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Generating", " ", "\"\<True\>\"", " ", "\[Theta]"}], ",", 
       RowBox[{"E", " ", "based", " ", "on", " ", "the", " ", "weights"}]}], 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"PTS", "=", 
      RowBox[{"RandomChoice", "[", 
       RowBox[{
        RowBox[{"weights", "->", 
         RowBox[{"Transpose", "[", 
          RowBox[{"Exp", "[", 
           RowBox[{"{", 
            RowBox[{"\[Theta]rand", ",", "erand"}], "}"}], "]"}], "]"}]}], 
        ",", "Nev"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"motherdata", "=", 
      RowBox[{"MotherDataCompiled", "[", 
       RowBox[{"PTS", ",", "m"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{"IfCollider", ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"motherdataExtended", "=", "motherdata"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"motherdataExtended", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "3"}], "]"}], "]"}], "=", 
         RowBox[{"-", 
          RowBox[{"motherdataExtended", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "3"}], "]"}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"motherdata", "=", 
         RowBox[{"Join", "[", 
          RowBox[{"motherdata", ",", "motherdataExtended"}], "]"}]}]}]}], 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "motherdata", "]"}], "!=", "Nevents"}], ",", 
        RowBox[{"motherdata", "=", 
         RowBox[{"Join", "[", 
          RowBox[{"motherdata", ",", 
           RowBox[{"{", 
            RowBox[{"motherdata", "[", 
             RowBox[{"[", 
              RowBox[{"-", "1"}], "]"}], "]"}], "}"}]}], "]"}]}]}], "]"}], "//",
       "Developer`ToPackedArray"}], ";", "\[IndentingNewLine]", 
     "motherdata"}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"DataConverted", "=", 
  RowBox[{"Compile", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"data", ",", "_Real", ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"m", ",", "_Real"}], "}"}]}], "}"}], ",", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"px", ",", "py", ",", "pz", ",", "e"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"px", "=", 
        RowBox[{"Compile`GetElement", "[", 
         RowBox[{"data", ",", "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"py", "=", 
        RowBox[{"Compile`GetElement", "[", 
         RowBox[{"data", ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"pz", "=", 
        RowBox[{"Compile`GetElement", "[", 
         RowBox[{"data", ",", "3"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"e", "=", 
        SqrtBox[
         RowBox[{
          SuperscriptBox["px", "2"], "+", 
          SuperscriptBox["py", "2"], "+", 
          SuperscriptBox["pz", "2"], "+", 
          SuperscriptBox["m", "2"]}]]}], ";", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"px", ",", "py", ",", "pz", ",", "e", ",", "m"}], "}"}]}]}], 
     "]"}], ",", 
    RowBox[{"CompilationTarget", "\[Rule]", "\"\<C\>\""}], ",", 
    RowBox[{"RuntimeOptions", "\[Rule]", "\"\<Speed\>\""}], ",", 
    RowBox[{"RuntimeAttributes", "\[Rule]", 
     RowBox[{"{", "Listable", "}"}]}], ",", 
    RowBox[{"Parallelization", "->", "True"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.9131065874720078`*^9, 3.913106594439848*^9}, {
   3.9131066301476555`*^9, 3.913106654577142*^9}, {3.9131066961468306`*^9, 
   3.9131067840146995`*^9}, {3.9131074758628445`*^9, 
   3.9131075085659676`*^9}, {3.9131085342395687`*^9, 
   3.9131085426297264`*^9}, {3.91310862730369*^9, 3.9131086389070997`*^9}, {
   3.913109386725669*^9, 3.9131093994871893`*^9}, {3.9131094832851667`*^9, 
   3.9131094833591976`*^9}, {3.9131095462819114`*^9, 3.9131095516081376`*^9}, 
   3.913174017227763*^9, {3.913174053027907*^9, 3.9131740556087627`*^9}, {
   3.9131740904276886`*^9, 3.9131740934878674`*^9}, {3.9131743716179256`*^9, 
   3.9131743816271763`*^9}, {3.9131745160168314`*^9, 3.913174591663071*^9}, {
   3.913174677947095*^9, 3.9131746851279287`*^9}, {3.91317479979908*^9, 
   3.91317484641241*^9}, {3.9131748816789017`*^9, 3.9131750119977427`*^9}, 
   3.913175083007023*^9, {3.9131751147576723`*^9, 3.913175158407481*^9}, {
   3.9131752664175854`*^9, 3.9131752755991335`*^9}, {3.913175315668645*^9, 
   3.9131753296276565`*^9}, 3.913175398716926*^9, {3.913175435858427*^9, 
   3.9131754362089596`*^9}, {3.913175496706813*^9, 3.9131755341878996`*^9}, {
   3.913175565741685*^9, 3.9131755992978177`*^9}, {3.9131756882445*^9, 
   3.9131756918067503`*^9}, {3.913175728958982*^9, 3.9131757324721193`*^9}, {
   3.913176268518656*^9, 3.913176280237647*^9}, {3.913176471116912*^9, 
   3.9131765862151375`*^9}, {3.913176632436755*^9, 3.9131766536077366`*^9}, {
   3.913176687111824*^9, 3.913176691813552*^9}, {3.9131767258416567`*^9, 
   3.9131768552436323`*^9}, {3.9131771109629297`*^9, 3.913177162881609*^9}, {
   3.913177251721398*^9, 3.913177251943059*^9}, 3.9131780063767977`*^9, 
   3.9131780552724333`*^9, {3.9131780941339865`*^9, 3.9131780949850297`*^9}, {
   3.913179348457934*^9, 3.913179500022968*^9}, {3.91317956966864*^9, 
   3.913179633182292*^9}, {3.9131797988608284`*^9, 3.9131798526177983`*^9}, 
   3.913180144135728*^9, {3.9131806188300743`*^9, 3.913180619405963*^9}, {
   3.9131806546599474`*^9, 3.913180721233328*^9}, {3.9131807550814943`*^9, 
   3.913180758350403*^9}, {3.913180888261049*^9, 3.9131810134372225`*^9}, {
   3.9131813605309505`*^9, 3.913181364247963*^9}, {3.913181773476987*^9, 
   3.9131817951370816`*^9}, {3.913181938322895*^9, 3.9131819406974792`*^9}, {
   3.9131820788929667`*^9, 3.9131820819291444`*^9}, {3.913182351489479*^9, 
   3.9131823935088367`*^9}, {3.9131826084978266`*^9, 
   3.9131826115693445`*^9}, {3.9131826525869884`*^9, 3.913182718838679*^9}, {
   3.913182756286029*^9, 3.9131827603788958`*^9}, {3.9131828254322186`*^9, 
   3.913182869568014*^9}, {3.9131829106078825`*^9, 3.913182911517872*^9}, {
   3.913182948723506*^9, 3.9131829506286964`*^9}, {3.913182982408037*^9, 
   3.913182986457778*^9}, {3.913183062012779*^9, 3.9131830786975765`*^9}, {
   3.9131832212597675`*^9, 3.9131832466078124`*^9}, {3.9132245309540696`*^9, 
   3.913224535674638*^9}, {3.913224783404888*^9, 3.9132247869827995`*^9}, {
   3.913225395345085*^9, 3.9132253989079027`*^9}, {3.9132619284693756`*^9, 
   3.9132619287017317`*^9}, {3.913356017491578*^9, 3.913356029011331*^9}, {
   3.91344943487611*^9, 3.9134494763373623`*^9}, {3.913449561895245*^9, 
   3.9134495706957607`*^9}, {3.913450019207034*^9, 3.9134500433273287`*^9}, {
   3.91345012555602*^9, 3.9134501256460323`*^9}, {3.913450166465826*^9, 
   3.9134501702329273`*^9}, 3.9134509736691866`*^9, {3.913451480805791*^9, 
   3.913451481955962*^9}, {3.91345151337609*^9, 3.913451513936138*^9}, {
   3.914489155891657*^9, 3.9144892220474916`*^9}, {3.9157053619239707`*^9, 
   3.915705402668686*^9}, {3.917947689018881*^9, 3.9179477036439457`*^9}, {
   3.9179477633886843`*^9, 3.9179478071601057`*^9}, {3.9179478545731974`*^9, 
   3.9179478574288626`*^9}},
 CellTags->"Evaluation",
 CellLabel->"In[28]:=",ExpressionUUID->"39942510-ac3a-5043-b336-9c7339dd6459"],

Cell[BoxData[
 FormBox[
  InterpretationBox[
   RowBox[{
    TagBox["CompiledFunction",
     "SummaryHead"], "[", 
    DynamicModuleBox[{Typeset`open$$ = False, Typeset`embedState$$ = "Ready"}, 
     TemplateBox[{
       PaneSelectorBox[{False -> GridBox[{{
             PaneBox[
              ButtonBox[
               DynamicBox[
                FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxOpener"], 
                ImageSizeCache -> {
                 9.771662737098522, {0., 9.771662737098522}}], Appearance -> 
               None, BaseStyle -> {}, 
               ButtonFunction :> (Typeset`open$$ = True), Evaluator -> 
               Automatic, Method -> "Preemptive"], 
              Alignment -> {Center, Center}, ImageSize -> 
              Dynamic[{
                Automatic, 
                 3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                  Magnification])}]], 
             GraphicsBox[{
               Thickness[0.038461538461538464`], {
                FaceForm[{
                  GrayLevel[0.93], 
                  Opacity[1.]}], 
                
                FilledCurveBox[{{{1, 4, 3}, {0, 1, 0}, {1, 3, 3}, {0, 1, 0}, {
                 1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {0, 1, 0}}}, {{{
                 25.499999999999996`, 2.5}, {25.499999999999996`, 
                 1.3953100000000003`}, {24.604699999999998`, 
                 0.49999999999999994`}, {23.5, 0.49999999999999994`}, {2.5, 
                 0.49999999999999994`}, {1.3953100000000003`, 
                 0.49999999999999994`}, {0.49999999999999994`, 
                 1.3953100000000003`}, {0.49999999999999994`, 2.5}, {
                 0.49999999999999994`, 23.5}, {0.49999999999999994`, 
                 24.604699999999998`}, {1.3953100000000003`, 
                 25.499999999999996`}, {2.5, 25.499999999999996`}, {23.5, 
                 25.499999999999996`}, {24.604699999999998`, 
                 25.499999999999996`}, {25.499999999999996`, 
                 24.604699999999998`}, {25.499999999999996`, 23.5}, {
                 25.499999999999996`, 2.5}}}]}, {
                FaceForm[{
                  RGBColor[0.5, 0.5, 0.5], 
                  Opacity[1.]}], 
                
                FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {
                 0, 1, 0}, {0, 1, 0}, {0, 1, 0}}}, {{{20.5426, 
                 19.116799999999998`}, {16.3832, 21.876199999999997`}, {
                 16.3832, 20.021499999999996`}, {6.930469999999999, 
                 20.021499999999996`}, {6.930469999999999, 
                 18.212100000000003`}, {16.3832, 18.212100000000003`}, {
                 16.3832, 16.357399999999995`}, {20.5426, 
                 19.116799999999998`}}}], 
                
                FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {
                 0, 1, 0}, {0, 1, 0}, {0, 1, 0}}}, {{{5.30508, 13.8391}, {
                 9.46445, 11.079700000000003`}, {9.46445, 
                 12.933999999999997`}, {18.917199999999998`, 
                 12.933999999999997`}, {18.917199999999998`, 14.7438}, {
                 9.46445, 14.7438}, {9.46445, 16.598}, {5.30508, 13.8391}}}], 
                
                FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {
                 0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
                 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {
                 1, 3, 3}, {1, 3, 3}, {1, 3, 3}}}, CompressedData["
1:eJxTTMoPSmVmYGBgBGJjIGYCYq4u+eR3VWoOxhkv5j+Qk3SA8fu/r5rKOVHM
Yd2vmNyjZ9Qcrt9QXbW9S8RBg59767IidQcPMYPGaHFhB+Nn61SfiGo4xBwp
T7o2V9Dh0Iolfg6/NBxEHv/x1Xgi4FB1XNNqkqQWnP+axUTQjFkbzn+oO2HB
j/3aDg/Xn5T6WiDoYLs3aJpiqI7DrHN+bO6tQg4zfUR7vF7pQOyfIQyRd9d1
WLL0U1kLoyjEPdm6DpoTXfQX7xBzKPjQejLkhDacL5J4+LL2Gm2HtNnSl4Vf
iELM69J2qPZM3tLnJerQX1oozZugDfHPUxGI/4W1HQ5p3TthoyDi4D7lG1v8
Mi2HgqL9zoEHhB1inOxe3BRG8MH62zXhfIbN1Z82CGhC/GMg4nCm3mN/7TYN
iHlCUPdGakDc/1kUEr46GhD/eYnD+d9iBf/kC0vC+TuCrSL+X5Vy2HGR4R5T
uAbEfxYykPBYp+HQqsCuesZAFhL+rJoQ/2rIQdxTpwkJ7yVycPfD+GDzVqLx
xbUd5HYt2JfqBdWfpA2Jj9mykPDpgYaXtaxDy7yzq86vg8qvlIHE5ylY/Eo7
XAt7o787TxfOB5ufqesQ9PbyxxkPZSDhZ6nrMAGU3u7LQtLLEx2HN2253UbX
ofZ76jis/Pay4oynAsT8QG0HKZMv/gW7FCDyTFpwPsz/MD44/Mw1HFjb1uR9
TVVwWKy880/7FHWIexrkIfLX1RzOMDZZVjHIOaDkh3vSDuj5AwCF11Vc
                 "]]}}, AspectRatio -> 1, Axes -> False, Background -> 
              GrayLevel[0.93], Frame -> True, FrameStyle -> Directive[
                Thickness[Tiny], 
                GrayLevel[0.7]], FrameTicks -> None, ImageSize -> 
              Dynamic[{
                Automatic, 
                 3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                  Magnification])}]], 
             GridBox[{{
                RowBox[{
                  TagBox["\"Argument count: \"", "SummaryItemAnnotation"], 
                  "\[InvisibleSpace]", 
                  TagBox["2", "SummaryItem"]}]}, {
                RowBox[{
                  TagBox["\"Argument types: \"", "SummaryItemAnnotation"], 
                  "\[InvisibleSpace]", 
                  TagBox[
                   StyleBox[
                    PaneBox[
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"_Real", ",", "1"}], "}"}], ",", "_Real"}], "}"}],
                     BaselinePosition -> Baseline, ContentPadding -> False, 
                    FrameMargins -> 0, ImageSize -> {{1, 300}, Automatic}, 
                    StripOnInput -> True], LineBreakWithin -> False], 
                   "SummaryItem"]}]}}, AutoDelete -> False, 
              BaseStyle -> {
               ShowStringCharacters -> False, NumberMarks -> False, 
                PrintPrecision -> 3, ShowSyntaxStyles -> False}, 
              GridBoxAlignment -> {
               "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, 
              GridBoxItemSize -> {
               "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
              GridBoxSpacings -> {
               "Columns" -> {{2}}, "Rows" -> {{Automatic}}}]}}, AutoDelete -> 
           False, BaselinePosition -> {1, 1}, 
           GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
           GridBoxItemSize -> {
            "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}], True -> 
         GridBox[{{
             PaneBox[
              ButtonBox[
               DynamicBox[
                FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxCloser"]], 
               Appearance -> None, BaseStyle -> {}, 
               ButtonFunction :> (Typeset`open$$ = False), Evaluator -> 
               Automatic, Method -> "Preemptive"], 
              Alignment -> {Center, Center}, ImageSize -> 
              Dynamic[{
                Automatic, 
                 3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                  Magnification])}]], 
             GraphicsBox[{
               Thickness[0.038461538461538464`], {
                FaceForm[{
                  GrayLevel[0.93], 
                  Opacity[1.]}], 
                
                FilledCurveBox[{{{1, 4, 3}, {0, 1, 0}, {1, 3, 3}, {0, 1, 0}, {
                 1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {0, 1, 0}}}, {{{
                 25.499999999999996`, 2.5}, {25.499999999999996`, 
                 1.3953100000000003`}, {24.604699999999998`, 
                 0.49999999999999994`}, {23.5, 0.49999999999999994`}, {2.5, 
                 0.49999999999999994`}, {1.3953100000000003`, 
                 0.49999999999999994`}, {0.49999999999999994`, 
                 1.3953100000000003`}, {0.49999999999999994`, 2.5}, {
                 0.49999999999999994`, 23.5}, {0.49999999999999994`, 
                 24.604699999999998`}, {1.3953100000000003`, 
                 25.499999999999996`}, {2.5, 25.499999999999996`}, {23.5, 
                 25.499999999999996`}, {24.604699999999998`, 
                 25.499999999999996`}, {25.499999999999996`, 
                 24.604699999999998`}, {25.499999999999996`, 23.5}, {
                 25.499999999999996`, 2.5}}}]}, {
                FaceForm[{
                  RGBColor[0.5, 0.5, 0.5], 
                  Opacity[1.]}], 
                
                FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {
                 0, 1, 0}, {0, 1, 0}, {0, 1, 0}}}, {{{20.5426, 
                 19.116799999999998`}, {16.3832, 21.876199999999997`}, {
                 16.3832, 20.021499999999996`}, {6.930469999999999, 
                 20.021499999999996`}, {6.930469999999999, 
                 18.212100000000003`}, {16.3832, 18.212100000000003`}, {
                 16.3832, 16.357399999999995`}, {20.5426, 
                 19.116799999999998`}}}], 
                
                FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {
                 0, 1, 0}, {0, 1, 0}, {0, 1, 0}}}, {{{5.30508, 13.8391}, {
                 9.46445, 11.079700000000003`}, {9.46445, 
                 12.933999999999997`}, {18.917199999999998`, 
                 12.933999999999997`}, {18.917199999999998`, 14.7438}, {
                 9.46445, 14.7438}, {9.46445, 16.598}, {5.30508, 13.8391}}}], 
                
                FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {
                 0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
                 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {
                 1, 3, 3}, {1, 3, 3}, {1, 3, 3}}}, CompressedData["
1:eJxTTMoPSmVmYGBgBGJjIGYCYq4u+eR3VWoOxhkv5j+Qk3SA8fu/r5rKOVHM
Yd2vmNyjZ9Qcrt9QXbW9S8RBg59767IidQcPMYPGaHFhB+Nn61SfiGo4xBwp
T7o2V9Dh0Iolfg6/NBxEHv/x1Xgi4FB1XNNqkqQWnP+axUTQjFkbzn+oO2HB
j/3aDg/Xn5T6WiDoYLs3aJpiqI7DrHN+bO6tQg4zfUR7vF7pQOyfIQyRd9d1
WLL0U1kLoyjEPdm6DpoTXfQX7xBzKPjQejLkhDacL5J4+LL2Gm2HtNnSl4Vf
iELM69J2qPZM3tLnJerQX1oozZugDfHPUxGI/4W1HQ5p3TthoyDi4D7lG1v8
Mi2HgqL9zoEHhB1inOxe3BRG8MH62zXhfIbN1Z82CGhC/GMg4nCm3mN/7TYN
iHlCUPdGakDc/1kUEr46GhD/eYnD+d9iBf/kC0vC+TuCrSL+X5Vy2HGR4R5T
uAbEfxYykPBYp+HQqsCuesZAFhL+rJoQ/2rIQdxTpwkJ7yVycPfD+GDzVqLx
xbUd5HYt2JfqBdWfpA2Jj9mykPDpgYaXtaxDy7yzq86vg8qvlIHE5ylY/Eo7
XAt7o787TxfOB5ufqesQ9PbyxxkPZSDhZ6nrMAGU3u7LQtLLEx2HN2253UbX
ofZ76jis/Pay4oynAsT8QG0HKZMv/gW7FCDyTFpwPsz/MD44/Mw1HFjb1uR9
TVVwWKy880/7FHWIexrkIfLX1RzOMDZZVjHIOaDkh3vSDuj5AwCF11Vc
                 "]]}}, AspectRatio -> 1, Axes -> False, Background -> 
              GrayLevel[0.93], Frame -> True, FrameStyle -> Directive[
                Thickness[Tiny], 
                GrayLevel[0.7]], FrameTicks -> None, ImageSize -> 
              Dynamic[{
                Automatic, 
                 3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                  Magnification])}]], 
             GridBox[{{
                RowBox[{
                  TagBox["\"Argument count: \"", "SummaryItemAnnotation"], 
                  "\[InvisibleSpace]", 
                  TagBox["2", "SummaryItem"]}]}, {
                RowBox[{
                  TagBox["\"Argument types: \"", "SummaryItemAnnotation"], 
                  "\[InvisibleSpace]", 
                  TagBox[
                   PaneBox[
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"_Real", ",", "1"}], "}"}], ",", "_Real"}], "}"}],
                     BaselinePosition -> Baseline, ContentPadding -> False, 
                    FrameMargins -> 0, ImageSize -> {{1, 500}, Automatic}, 
                    StripOnInput -> True], "SummaryItem"]}]}, {
                RowBox[{
                  TagBox["\"Variables: \"", "SummaryItemAnnotation"], 
                  "\[InvisibleSpace]", 
                  TagBox[
                   RowBox[{"{", 
                    RowBox[{"Events", ",", "m"}], "}"}], "SummaryItem"]}]}, {
                RowBox[{
                  TagBox["\"Expression: \"", "SummaryItemAnnotation"], 
                  "\[InvisibleSpace]", 
                  TagBox[
                   PaneBox[
                    RowBox[{"Block", "[", 
                    RowBox[{
                    RowBox[{"{", "Compile`$10", "}"}], ",", 
                    RowBox[{"Module", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"thv", ",", "ev", ",", "\[Phi]v", ",", "pv"}], 
                    "}"}], ",", 
                    RowBox[{
                    RowBox[{"thv", "=", 
                    RowBox[{"Compile`GetElement", "(", 
                    RowBox[{"Events", ",", "1"}], ")"}]}], ";", 
                    RowBox[{"ev", "=", 
                    RowBox[{"Compile`GetElement", "(", 
                    RowBox[{"Events", ",", "2"}], ")"}]}], ";", 
                    RowBox[{"\[Phi]v", "=", 
                    RowBox[{"RandomReal", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "\[Pi]"}], ",", "\[Pi]"}], "}"}], "]"}]}], 
                    ";", 
                    RowBox[{"pv", "=", 
                    SqrtBox[
                    RowBox[{
                    SuperscriptBox["ev", "2"], "-", 
                    SuperscriptBox["m", "2"]}]]}], ";", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Compile`$10", "=", 
                    RowBox[{"sin", "(", "thv", ")"}]}], ";", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Compile`$10", " ", "pv", " ", 
                    RowBox[{"cos", "(", "\[Phi]v", ")"}]}], ",", 
                    RowBox[{"Compile`$10", " ", "pv", " ", 
                    RowBox[{"sin", "(", "\[Phi]v", ")"}]}], ",", 
                    RowBox[{"pv", " ", 
                    RowBox[{"cos", "(", "thv", ")"}]}], ",", "ev", ",", "m"}],
                     "}"}]}], ")"}]}]}], "]"}]}], "]"}], BaselinePosition -> 
                    Baseline, ContentPadding -> False, FrameMargins -> 0, 
                    ImageSize -> {{1, 500}, Automatic}, StripOnInput -> True],
                    "SummaryItem"]}]}}, AutoDelete -> False, 
              BaseStyle -> {
               ShowStringCharacters -> False, NumberMarks -> False, 
                PrintPrecision -> 3, ShowSyntaxStyles -> False}, 
              GridBoxAlignment -> {
               "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, 
              GridBoxItemSize -> {
               "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
              GridBoxSpacings -> {
               "Columns" -> {{2}}, "Rows" -> {{Automatic}}}]}}, AutoDelete -> 
           False, BaselinePosition -> {1, 1}, 
           GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
           GridBoxItemSize -> {
            "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}]}, 
        Dynamic[Typeset`open$$], ImageSize -> Automatic]},
      "SummaryPanel"],
     DynamicModuleValues:>{}], "]"}],
   CompiledFunction[{11, 14.1, 5848}, {{
      Blank[Real], 1}, 
     Blank[Real]}, {{3, 1, 0}, {3, 0, 0}, {3, 1, 
    1}}, {{2, {2, 0, 1}}, {1, {2, 0, 0}}, {3.141592653589793, {3, 0, 3}}}, {0,
     2, 11, 0, 
    2}, {{37, 0, 0, 3, 1}, {37, 0, 1, 3, 2}, {19, 3, 4}, {
     42, "RandomReal", 3, 0, 4, 3, 0, 3, 3, 0, 5}, {40, 56, 3, 0, 2, 3, 0, 
     4}, {40, 56, 3, 0, 0, 3, 0, 6}, {19, 6, 7}, {13, 4, 7, 4}, {40, 57, 3, 0,
      4, 3, 0, 7}, {40, 1, 3, 0, 1, 3, 0, 4}, {40, 2, 3, 0, 5, 3, 0, 6}, {16, 
     7, 6, 4, 8}, {40, 1, 3, 0, 5, 3, 0, 6}, {16, 7, 6, 4, 9}, {40, 2, 3, 0, 
     1, 3, 0, 6}, {16, 7, 6, 10}, {34, 1, 5, 8, 9, 10, 2, 0, 3, 1}, {1}}, 
    Function[{$CellContext`Events, $CellContext`m}, 
     Block[{Compile`$10}, 
      Module[{$CellContext`thv, $CellContext`ev, $CellContext`\[Phi]v, \
$CellContext`pv}, $CellContext`thv = 
        Compile`GetElement[$CellContext`Events, 1]; $CellContext`ev = 
        Compile`GetElement[$CellContext`Events, 2]; $CellContext`\[Phi]v = 
        RandomReal[{-Pi, Pi}]; $CellContext`pv = 
        Sqrt[$CellContext`ev^2 - $CellContext`m^2]; (
        Compile`$10 = 
         Sin[$CellContext`thv]; {$CellContext`pv Cos[$CellContext`\[Phi]v] 
          Compile`$10, $CellContext`pv Sin[$CellContext`\[Phi]v] 
          Compile`$10, $CellContext`pv 
          Cos[$CellContext`thv], $CellContext`ev, $CellContext`m})]], 
     Listable], Evaluate, 
    LibraryFunction[
    "C:\\Users\\miksi\\AppData\\Roaming\\Wolfram\\ApplicationData\\\
CCompilerDriver\\BuildFolder\\laptop-u485fl4q-35124\\compiledFunction8.dll", 
     "compiledFunction8", {{Real, 1, "Constant"}, {Real, 0, "Constant"}}, {
     Real, 1}]],
   Editable->False,
   SelectWithContents->True,
   Selectable->False], TraditionalForm]], "Output",
 CellChangeTimes->{3.9434161920483055`*^9, 3.947738425022585*^9, 
  3.9477387134434185`*^9, 3.9477392603873177`*^9, 3.9477403821277103`*^9, 
  3.9477442298090553`*^9, 3.9482491210098343`*^9, 3.9482504222295227`*^9, 
  3.9483042903248005`*^9, 3.9483350291162567`*^9},
 CellTags->"Evaluation",
 CellLabel->"Out[64]=",ExpressionUUID->"3465a19e-ee6e-ac4b-8aeb-0232d3e1eef5"],

Cell[BoxData[
 FormBox[
  InterpretationBox[
   RowBox[{
    TagBox["CompiledFunction",
     "SummaryHead"], "[", 
    DynamicModuleBox[{Typeset`open$$ = False, Typeset`embedState$$ = "Ready"}, 
     TemplateBox[{
       PaneSelectorBox[{False -> GridBox[{{
             PaneBox[
              ButtonBox[
               DynamicBox[
                FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxOpener"], 
                ImageSizeCache -> {
                 9.771662737098522, {0., 9.771662737098522}}], Appearance -> 
               None, BaseStyle -> {}, 
               ButtonFunction :> (Typeset`open$$ = True), Evaluator -> 
               Automatic, Method -> "Preemptive"], 
              Alignment -> {Center, Center}, ImageSize -> 
              Dynamic[{
                Automatic, 
                 3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                  Magnification])}]], 
             GraphicsBox[{
               Thickness[0.038461538461538464`], {
                FaceForm[{
                  GrayLevel[0.93], 
                  Opacity[1.]}], 
                
                FilledCurveBox[{{{1, 4, 3}, {0, 1, 0}, {1, 3, 3}, {0, 1, 0}, {
                 1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {0, 1, 0}}}, {{{
                 25.499999999999996`, 2.5}, {25.499999999999996`, 
                 1.3953100000000003`}, {24.604699999999998`, 
                 0.49999999999999994`}, {23.5, 0.49999999999999994`}, {2.5, 
                 0.49999999999999994`}, {1.3953100000000003`, 
                 0.49999999999999994`}, {0.49999999999999994`, 
                 1.3953100000000003`}, {0.49999999999999994`, 2.5}, {
                 0.49999999999999994`, 23.5}, {0.49999999999999994`, 
                 24.604699999999998`}, {1.3953100000000003`, 
                 25.499999999999996`}, {2.5, 25.499999999999996`}, {23.5, 
                 25.499999999999996`}, {24.604699999999998`, 
                 25.499999999999996`}, {25.499999999999996`, 
                 24.604699999999998`}, {25.499999999999996`, 23.5}, {
                 25.499999999999996`, 2.5}}}]}, {
                FaceForm[{
                  RGBColor[0.5, 0.5, 0.5], 
                  Opacity[1.]}], 
                
                FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {
                 0, 1, 0}, {0, 1, 0}, {0, 1, 0}}}, {{{20.5426, 
                 19.116799999999998`}, {16.3832, 21.876199999999997`}, {
                 16.3832, 20.021499999999996`}, {6.930469999999999, 
                 20.021499999999996`}, {6.930469999999999, 
                 18.212100000000003`}, {16.3832, 18.212100000000003`}, {
                 16.3832, 16.357399999999995`}, {20.5426, 
                 19.116799999999998`}}}], 
                
                FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {
                 0, 1, 0}, {0, 1, 0}, {0, 1, 0}}}, {{{5.30508, 13.8391}, {
                 9.46445, 11.079700000000003`}, {9.46445, 
                 12.933999999999997`}, {18.917199999999998`, 
                 12.933999999999997`}, {18.917199999999998`, 14.7438}, {
                 9.46445, 14.7438}, {9.46445, 16.598}, {5.30508, 13.8391}}}], 
                
                FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {
                 0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
                 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {
                 1, 3, 3}, {1, 3, 3}, {1, 3, 3}}}, CompressedData["
1:eJxTTMoPSmVmYGBgBGJjIGYCYq4u+eR3VWoOxhkv5j+Qk3SA8fu/r5rKOVHM
Yd2vmNyjZ9Qcrt9QXbW9S8RBg59767IidQcPMYPGaHFhB+Nn61SfiGo4xBwp
T7o2V9Dh0Iolfg6/NBxEHv/x1Xgi4FB1XNNqkqQWnP+axUTQjFkbzn+oO2HB
j/3aDg/Xn5T6WiDoYLs3aJpiqI7DrHN+bO6tQg4zfUR7vF7pQOyfIQyRd9d1
WLL0U1kLoyjEPdm6DpoTXfQX7xBzKPjQejLkhDacL5J4+LL2Gm2HtNnSl4Vf
iELM69J2qPZM3tLnJerQX1oozZugDfHPUxGI/4W1HQ5p3TthoyDi4D7lG1v8
Mi2HgqL9zoEHhB1inOxe3BRG8MH62zXhfIbN1Z82CGhC/GMg4nCm3mN/7TYN
iHlCUPdGakDc/1kUEr46GhD/eYnD+d9iBf/kC0vC+TuCrSL+X5Vy2HGR4R5T
uAbEfxYykPBYp+HQqsCuesZAFhL+rJoQ/2rIQdxTpwkJ7yVycPfD+GDzVqLx
xbUd5HYt2JfqBdWfpA2Jj9mykPDpgYaXtaxDy7yzq86vg8qvlIHE5ylY/Eo7
XAt7o787TxfOB5ufqesQ9PbyxxkPZSDhZ6nrMAGU3u7LQtLLEx2HN2253UbX
ofZ76jis/Pay4oynAsT8QG0HKZMv/gW7FCDyTFpwPsz/MD44/Mw1HFjb1uR9
TVVwWKy880/7FHWIexrkIfLX1RzOMDZZVjHIOaDkh3vSDuj5AwCF11Vc
                 "]]}}, AspectRatio -> 1, Axes -> False, Background -> 
              GrayLevel[0.93], Frame -> True, FrameStyle -> Directive[
                Thickness[Tiny], 
                GrayLevel[0.7]], FrameTicks -> None, ImageSize -> 
              Dynamic[{
                Automatic, 
                 3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                  Magnification])}]], 
             GridBox[{{
                RowBox[{
                  TagBox["\"Argument count: \"", "SummaryItemAnnotation"], 
                  "\[InvisibleSpace]", 
                  TagBox["2", "SummaryItem"]}]}, {
                RowBox[{
                  TagBox["\"Argument types: \"", "SummaryItemAnnotation"], 
                  "\[InvisibleSpace]", 
                  TagBox[
                   StyleBox[
                    PaneBox[
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"_Real", ",", "1"}], "}"}], ",", "_Real"}], "}"}],
                     BaselinePosition -> Baseline, ContentPadding -> False, 
                    FrameMargins -> 0, ImageSize -> {{1, 300}, Automatic}, 
                    StripOnInput -> True], LineBreakWithin -> False], 
                   "SummaryItem"]}]}}, AutoDelete -> False, 
              BaseStyle -> {
               ShowStringCharacters -> False, NumberMarks -> False, 
                PrintPrecision -> 3, ShowSyntaxStyles -> False}, 
              GridBoxAlignment -> {
               "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, 
              GridBoxItemSize -> {
               "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
              GridBoxSpacings -> {
               "Columns" -> {{2}}, "Rows" -> {{Automatic}}}]}}, AutoDelete -> 
           False, BaselinePosition -> {1, 1}, 
           GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
           GridBoxItemSize -> {
            "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}], True -> 
         GridBox[{{
             PaneBox[
              ButtonBox[
               DynamicBox[
                FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxCloser"]], 
               Appearance -> None, BaseStyle -> {}, 
               ButtonFunction :> (Typeset`open$$ = False), Evaluator -> 
               Automatic, Method -> "Preemptive"], 
              Alignment -> {Center, Center}, ImageSize -> 
              Dynamic[{
                Automatic, 
                 3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                  Magnification])}]], 
             GraphicsBox[{
               Thickness[0.038461538461538464`], {
                FaceForm[{
                  GrayLevel[0.93], 
                  Opacity[1.]}], 
                
                FilledCurveBox[{{{1, 4, 3}, {0, 1, 0}, {1, 3, 3}, {0, 1, 0}, {
                 1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {0, 1, 0}}}, {{{
                 25.499999999999996`, 2.5}, {25.499999999999996`, 
                 1.3953100000000003`}, {24.604699999999998`, 
                 0.49999999999999994`}, {23.5, 0.49999999999999994`}, {2.5, 
                 0.49999999999999994`}, {1.3953100000000003`, 
                 0.49999999999999994`}, {0.49999999999999994`, 
                 1.3953100000000003`}, {0.49999999999999994`, 2.5}, {
                 0.49999999999999994`, 23.5}, {0.49999999999999994`, 
                 24.604699999999998`}, {1.3953100000000003`, 
                 25.499999999999996`}, {2.5, 25.499999999999996`}, {23.5, 
                 25.499999999999996`}, {24.604699999999998`, 
                 25.499999999999996`}, {25.499999999999996`, 
                 24.604699999999998`}, {25.499999999999996`, 23.5}, {
                 25.499999999999996`, 2.5}}}]}, {
                FaceForm[{
                  RGBColor[0.5, 0.5, 0.5], 
                  Opacity[1.]}], 
                
                FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {
                 0, 1, 0}, {0, 1, 0}, {0, 1, 0}}}, {{{20.5426, 
                 19.116799999999998`}, {16.3832, 21.876199999999997`}, {
                 16.3832, 20.021499999999996`}, {6.930469999999999, 
                 20.021499999999996`}, {6.930469999999999, 
                 18.212100000000003`}, {16.3832, 18.212100000000003`}, {
                 16.3832, 16.357399999999995`}, {20.5426, 
                 19.116799999999998`}}}], 
                
                FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {
                 0, 1, 0}, {0, 1, 0}, {0, 1, 0}}}, {{{5.30508, 13.8391}, {
                 9.46445, 11.079700000000003`}, {9.46445, 
                 12.933999999999997`}, {18.917199999999998`, 
                 12.933999999999997`}, {18.917199999999998`, 14.7438}, {
                 9.46445, 14.7438}, {9.46445, 16.598}, {5.30508, 13.8391}}}], 
                
                FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {
                 0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
                 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {
                 1, 3, 3}, {1, 3, 3}, {1, 3, 3}}}, CompressedData["
1:eJxTTMoPSmVmYGBgBGJjIGYCYq4u+eR3VWoOxhkv5j+Qk3SA8fu/r5rKOVHM
Yd2vmNyjZ9Qcrt9QXbW9S8RBg59767IidQcPMYPGaHFhB+Nn61SfiGo4xBwp
T7o2V9Dh0Iolfg6/NBxEHv/x1Xgi4FB1XNNqkqQWnP+axUTQjFkbzn+oO2HB
j/3aDg/Xn5T6WiDoYLs3aJpiqI7DrHN+bO6tQg4zfUR7vF7pQOyfIQyRd9d1
WLL0U1kLoyjEPdm6DpoTXfQX7xBzKPjQejLkhDacL5J4+LL2Gm2HtNnSl4Vf
iELM69J2qPZM3tLnJerQX1oozZugDfHPUxGI/4W1HQ5p3TthoyDi4D7lG1v8
Mi2HgqL9zoEHhB1inOxe3BRG8MH62zXhfIbN1Z82CGhC/GMg4nCm3mN/7TYN
iHlCUPdGakDc/1kUEr46GhD/eYnD+d9iBf/kC0vC+TuCrSL+X5Vy2HGR4R5T
uAbEfxYykPBYp+HQqsCuesZAFhL+rJoQ/2rIQdxTpwkJ7yVycPfD+GDzVqLx
xbUd5HYt2JfqBdWfpA2Jj9mykPDpgYaXtaxDy7yzq86vg8qvlIHE5ylY/Eo7
XAt7o787TxfOB5ufqesQ9PbyxxkPZSDhZ6nrMAGU3u7LQtLLEx2HN2253UbX
ofZ76jis/Pay4oynAsT8QG0HKZMv/gW7FCDyTFpwPsz/MD44/Mw1HFjb1uR9
TVVwWKy880/7FHWIexrkIfLX1RzOMDZZVjHIOaDkh3vSDuj5AwCF11Vc
                 "]]}}, AspectRatio -> 1, Axes -> False, Background -> 
              GrayLevel[0.93], Frame -> True, FrameStyle -> Directive[
                Thickness[Tiny], 
                GrayLevel[0.7]], FrameTicks -> None, ImageSize -> 
              Dynamic[{
                Automatic, 
                 3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                  Magnification])}]], 
             GridBox[{{
                RowBox[{
                  TagBox["\"Argument count: \"", "SummaryItemAnnotation"], 
                  "\[InvisibleSpace]", 
                  TagBox["2", "SummaryItem"]}]}, {
                RowBox[{
                  TagBox["\"Argument types: \"", "SummaryItemAnnotation"], 
                  "\[InvisibleSpace]", 
                  TagBox[
                   PaneBox[
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"_Real", ",", "1"}], "}"}], ",", "_Real"}], "}"}],
                     BaselinePosition -> Baseline, ContentPadding -> False, 
                    FrameMargins -> 0, ImageSize -> {{1, 500}, Automatic}, 
                    StripOnInput -> True], "SummaryItem"]}]}, {
                RowBox[{
                  TagBox["\"Variables: \"", "SummaryItemAnnotation"], 
                  "\[InvisibleSpace]", 
                  TagBox[
                   RowBox[{"{", 
                    RowBox[{"data", ",", "m"}], "}"}], "SummaryItem"]}]}, {
                RowBox[{
                  TagBox["\"Expression: \"", "SummaryItemAnnotation"], 
                  "\[InvisibleSpace]", 
                  TagBox[
                   PaneBox[
                    RowBox[{"Module", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"px", ",", "py", ",", "pz", ",", "e"}], "}"}], 
                    ",", 
                    RowBox[{
                    RowBox[{"px", "=", 
                    RowBox[{"Compile`GetElement", "(", 
                    RowBox[{"data", ",", "1"}], ")"}]}], ";", 
                    RowBox[{"py", "=", 
                    RowBox[{"Compile`GetElement", "(", 
                    RowBox[{"data", ",", "2"}], ")"}]}], ";", 
                    RowBox[{"pz", "=", 
                    RowBox[{"Compile`GetElement", "(", 
                    RowBox[{"data", ",", "3"}], ")"}]}], ";", 
                    RowBox[{"e", "=", 
                    SqrtBox[
                    RowBox[{
                    SuperscriptBox["m", "2"], "+", 
                    SuperscriptBox["px", "2"], "+", 
                    SuperscriptBox["py", "2"], "+", 
                    SuperscriptBox["pz", "2"]}]]}], ";", 
                    RowBox[{"{", 
                    RowBox[{"px", ",", "py", ",", "pz", ",", "e", ",", "m"}], 
                    "}"}]}]}], "]"}], BaselinePosition -> Baseline, 
                    ContentPadding -> False, FrameMargins -> 0, 
                    ImageSize -> {{1, 500}, Automatic}, StripOnInput -> True],
                    "SummaryItem"]}]}}, AutoDelete -> False, 
              BaseStyle -> {
               ShowStringCharacters -> False, NumberMarks -> False, 
                PrintPrecision -> 3, ShowSyntaxStyles -> False}, 
              GridBoxAlignment -> {
               "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, 
              GridBoxItemSize -> {
               "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
              GridBoxSpacings -> {
               "Columns" -> {{2}}, "Rows" -> {{Automatic}}}]}}, AutoDelete -> 
           False, BaselinePosition -> {1, 1}, 
           GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
           GridBoxItemSize -> {
            "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}]}, 
        Dynamic[Typeset`open$$], ImageSize -> Automatic]},
      "SummaryPanel"],
     DynamicModuleValues:>{}], "]"}],
   CompiledFunction[{11, 14.1, 5848}, {{
      Blank[Real], 1}, 
     Blank[Real]}, {{3, 1, 0}, {3, 0, 0}, {3, 1, 
    1}}, {{2, {2, 0, 1}}, {1, {2, 0, 0}}, {3, {2, 0, 2}}}, {0, 3, 8, 0, 
    2}, {{37, 0, 0, 3, 1}, {37, 0, 1, 3, 2}, {37, 0, 2, 3, 3}, {40, 56, 3, 0, 
     1, 3, 0, 4}, {40, 56, 3, 0, 2, 3, 0, 5}, {40, 56, 3, 0, 3, 3, 0, 6}, {40,
      56, 3, 0, 0, 3, 0, 7}, {13, 4, 5, 6, 7, 4}, {40, 57, 3, 0, 4, 3, 0, 
     5}, {34, 1, 5, 1, 2, 3, 5, 0, 3, 1}, {1}}, 
    Function[{$CellContext`data, $CellContext`m}, 
     Module[{$CellContext`px, $CellContext`py, $CellContext`pz, \
$CellContext`e}, $CellContext`px = 
       Compile`GetElement[$CellContext`data, 1]; $CellContext`py = 
       Compile`GetElement[$CellContext`data, 2]; $CellContext`pz = 
       Compile`GetElement[$CellContext`data, 3]; $CellContext`e = 
       Sqrt[$CellContext`px^2 + $CellContext`py^2 + $CellContext`pz^2 + \
$CellContext`m^2]; {$CellContext`px, $CellContext`py, $CellContext`pz, \
$CellContext`e, $CellContext`m}], Listable], Evaluate, 
    LibraryFunction[
    "C:\\Users\\miksi\\AppData\\Roaming\\Wolfram\\ApplicationData\\\
CCompilerDriver\\BuildFolder\\laptop-u485fl4q-35124\\compiledFunction9.dll", 
     "compiledFunction9", {{Real, 1, "Constant"}, {Real, 0, "Constant"}}, {
     Real, 1}]],
   Editable->False,
   SelectWithContents->True,
   Selectable->False], TraditionalForm]], "Output",
 CellChangeTimes->{3.9434161920483055`*^9, 3.947738425022585*^9, 
  3.9477387134434185`*^9, 3.9477392603873177`*^9, 3.9477403821277103`*^9, 
  3.9477442298090553`*^9, 3.9482491210098343`*^9, 3.9482504222295227`*^9, 
  3.9483042903248005`*^9, 3.948335030672598*^9},
 CellTags->"Evaluation",
 CellLabel->"Out[66]=",ExpressionUUID->"e70ef994-d8aa-4646-82ce-fe8333380b69"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Interpolation and phase space sampling", "Chapter",
 CellChangeTimes->{{3.913217803376299*^9, 3.91321780605317*^9}, {
  3.9132210602617135`*^9, 3.9132210604119883`*^9}, {3.9132213069931307`*^9, 
  3.913221325215193*^9}},
 CellTags->
  "Evaluation",ExpressionUUID->"ca536f19-eef7-784b-bb1e-e3f34b8fd633"],

Cell[CellGroupData[{

Cell["Phase space sampling", "Section",
 CellChangeTimes->{{3.9148315647325287`*^9, 3.9148315686183367`*^9}},
 CellTags->
  "Evaluation",ExpressionUUID->"54abbca7-f3a0-904b-b208-6f34fbca81dc"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"MotherInterpolation", "[", 
   RowBox[{"Facility_", ",", "Particle_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"data", ",", "datalog"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"data", "=", 
      RowBox[{"DataDistr", "[", 
       RowBox[{"Facility", ",", "Particle"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"datalog", "=", 
      RowBox[{"DataLogarithmiedComp", "[", "data", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Theta]MinMax", "[", 
       RowBox[{"Facility", ",", "Particle"}], "]"}], "=", 
      RowBox[{"MinMax", "[", 
       RowBox[{"data", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Emax", "[", 
       RowBox[{"\[Theta]X_", ",", "Facility", ",", "Particle"}], "]"}], "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Interpolation", "[", 
         RowBox[{
          RowBox[{"FindingEmax\[Theta]", "[", 
           RowBox[{
            RowBox[{"DataDistr", "[", 
             RowBox[{"Facility", ",", "Particle"}], "]"}], ",", "Facility", 
            ",", "7"}], "]"}], ",", 
          RowBox[{"InterpolationOrder", "->", "1"}]}], "]"}], "[", 
        RowBox[{"Log", "[", "\[Theta]X", "]"}], "]"}], "//", "Exp"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"DoubleDistrMotherInt", "[", 
       RowBox[{"\[Theta]X_", ",", "EX_", ",", "Facility", ",", "Particle"}], 
       "]"}], "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"mSM", "[", "Particle", "]"}], "<=", "EX", "<=", 
          RowBox[{"Emax", "[", 
           RowBox[{"\[Theta]X", ",", "Facility", ",", "Particle"}], "]"}]}], "&&", 
         RowBox[{
          RowBox[{
           RowBox[{"\[Theta]MinMax", "[", 
            RowBox[{"Facility", ",", "Particle"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}], "<=", "\[Theta]X", "<=", 
          RowBox[{
           RowBox[{"\[Theta]MinMax", "[", 
            RowBox[{"Facility", ",", "Particle"}], "]"}], "[", 
           RowBox[{"[", "2", "]"}], "]"}]}]}], ",", 
        RowBox[{"Evaluate", "[", 
         RowBox[{"Exp", "[", 
          RowBox[{
           RowBox[{"Interpolation", "[", 
            RowBox[{"datalog", ",", 
             RowBox[{"InterpolationOrder", "->", "1"}]}], "]"}], "[", 
           RowBox[{
            RowBox[{"Log", "[", "\[Theta]X", "]"}], ",", 
            RowBox[{"Log", "[", "EX", "]"}]}], "]"}], "]"}], "]"}], ",", 
        "0."}], "]"}]}], ";"}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MotherInterpolation", "[", 
   RowBox[{"\"\<LHC\>\"", ",", "\"\<Upsilon\>\""}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"IfMotherInterpolated", "[", 
   RowBox[{"Facility_", ",", "Mother_"}], "]"}], ":=", 
  RowBox[{"MemberQ", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"Keys", "[", 
         RowBox[{"DownValues", "@", "DoubleDistrMotherInt"}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "1", ",", 
          RowBox[{"-", "2"}]}], "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{"Keys", "[", 
         RowBox[{"DownValues", "@", "DoubleDistrMotherInt"}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "1", ",", 
          RowBox[{"-", "1"}]}], "]"}], "]"}]}], "}"}], "//", "Transpose"}], 
    ",", 
    RowBox[{"{", 
     RowBox[{"Facility", ",", "Mother"}], "}"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"{", 
  RowBox[{
   RowBox[{"IfMotherInterpolated", "[", 
    RowBox[{"\"\<LHC\>\"", ",", "\"\<Upsilon\>\""}], "]"}], ",", 
   RowBox[{"IfMotherInterpolated", "[", 
    RowBox[{"\"\<SPS\>\"", ",", "\"\<Kplus\>\""}], "]"}]}], 
  "}"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PointsSampler", "[", 
   RowBox[{"Facility_", ",", "Particle_", ",", "Nevents_", ",", "IfTwo_"}], 
   "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "data", ",", "Nev", ",", "IfPresent", ",", "particle", ",", 
      "motherpoints", ",", "datafin", ",", 
      RowBox[{"condESS", "=", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Facility", "==", "\"\<ESS\>\""}], "&&", 
         RowBox[{"MemberQ", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"\"\<PiCharged\>\"", ",", "\"\<mu\>\""}], "}"}], ",", 
           "Particle"}], "]"}]}], ")"}]}], ",", 
      RowBox[{"condKEKB", "=", 
       RowBox[{"(", 
        RowBox[{"Facility", "==", "\"\<SuperKEKB\>\""}], ")"}]}]}], "}"}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"For", " ", "the", " ", "moment"}], ",", " ", 
      RowBox[{
      "for", " ", "some", " ", "distributions", " ", "that", " ", "are", " ", 
       "absent"}], ",", " ", 
      RowBox[{
      "they", " ", "will", " ", "be", " ", "approximated", " ", "by", " ", 
       "the", " ", "distributions", " ", "of", " ", "similar", " ", 
       "particles"}]}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{"condESS", ",", "\[IndentingNewLine]", 
       RowBox[{"datafin", "=", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0.", ",", "0.", ",", "0.", ",", 
            RowBox[{"mSM", "[", "Particle", "]"}], ",", 
            RowBox[{"mSM", "[", "Particle", "]"}]}], "}"}], ",", "Nevents"}], 
         "]"}]}], "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Option", " ", 
          RowBox[{"IfTwo", ":", " ", 
           RowBox[{"if", " ", "\"\<True\>\""}]}]}], ",", " ", 
         RowBox[{
         "then", " ", "the", " ", "mother", " ", "particle", " ", "is", " ", 
          "supposed", " ", "to", " ", "decay", " ", "into", " ", "two", " ", 
          RowBox[{"LLPs", ".", " ", "If"}], " ", "\"\<False\>\""}], ",", " ", 
         RowBox[{
         "then", " ", "it", " ", "will", " ", "produce", " ", "only", " ", 
          "one", " ", "LLP"}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"If", " ", "\"\<True\>\""}], ",", " ", 
         RowBox[{"then", " ", 
          RowBox[{
           SubscriptBox["N", "events"], "/", "2"}], " ", "mother", " ", 
          "particles", " ", "will", " ", "be", " ", "sampled"}], ",", " ", 
         RowBox[{
         "and", " ", "then", " ", "the", " ", "data", " ", "will", " ", "be", 
          " ", "doubled"}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Nev", "=", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"IfTwo", "==", "\"\<True\>\""}], "&&", "LLPdistr"}], ",", 
           FractionBox["Nevents", "2"], ",", "Nevents"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"!", "condKEKB"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"IfPresent", "=", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Length", "[", 
                RowBox[{"DataDistr", "[", 
                 RowBox[{"Facility", ",", "Particle"}], "]"}], "]"}], "==", 
               "2"}], ",", "False", ",", "True"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"particle", "=", 
            RowBox[{"If", "[", 
             RowBox[{"IfPresent", ",", "Particle", ",", 
              RowBox[{"SimilarParticle", "[", 
               RowBox[{"Facility", ",", "Particle"}], "]"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"data", "=", 
            RowBox[{"DataDistr", "[", 
             RowBox[{"Facility", ",", "particle"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"datafin", "=", 
            RowBox[{"BlockPointsFromSmoothDistribution1", "[", 
             RowBox[{"data", ",", 
              RowBox[{"mSM", "[", "particle", "]"}], ",", "Nev", ",", "9", 
              ",", "Facility"}], "]"}]}], ";"}], "\[IndentingNewLine]", ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"MemberQ", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                "\"\<Bcharged\>\"", ",", "\"\<B0\>\"", ",", "\"\<Bs\>\""}], 
                "}"}], ",", "Particle"}], "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"MemberQ", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"\"\<Bcharged\>\"", ",", "\"\<B0\>\""}], "}"}], 
                  ",", "Particle"}], "]"}], ",", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"motherp", "=", "\"\<Upsilon(4S)\>\""}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"\[CapitalUpsilon]data", "=", 
                  RowBox[{
                   RowBox[{"ConstantArray", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0.", ",", "0.125", ",", "3.", ",", "11.006", ",", 
                    RowBox[{"mSM", "[", "motherp", "]"}]}], "}"}], ",", 
                    "Nevents"}], "]"}], "//", "Developer`ToPackedArray"}]}], 
                 ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"MemberQ", "[", 
                 RowBox[{
                  RowBox[{"{", "\"\<Bs\>\"", "}"}], ",", "Particle"}], "]"}], 
                ",", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"motherp", "=", "\"\<Upsilon(5S)\>\""}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"\[CapitalUpsilon]data", "=", 
                  RowBox[{"With", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"e", "=", 
                    SqrtBox[
                    RowBox[{
                    SuperscriptBox["0.125", "2"], "+", 
                    SuperscriptBox["3.", "2"], "+", 
                    SuperscriptBox[
                    RowBox[{"mSM", "[", "motherp", "]"}], "2"]}]]}], "}"}], 
                    ",", 
                    RowBox[{
                    RowBox[{"ConstantArray", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0.", ",", "0.125", ",", "3.", ",", "e", ",", 
                    RowBox[{"mSM", "[", "motherp", "]"}]}], "}"}], ",", 
                    "Nevents"}], "]"}], "//", "Developer`ToPackedArray"}]}], 
                   "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"particle", "=", "Particle"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"BdataRest", "=", 
               RowBox[{
                RowBox[{"TwoBodyDecaysEventsAtRestNonLLP", "[", 
                 RowBox[{
                 "motherp", ",", "Particle", ",", "Particle", ",", 
                  "Nevents"}], "]"}], "[", 
                RowBox[{"[", 
                 RowBox[{"All", ",", 
                  RowBox[{"Range", "[", 
                   RowBox[{"1", ",", "indexm"}], "]"}]}], "]"}], "]"}]}], ";",
               "\[IndentingNewLine]", 
              RowBox[{"datafin", "=", 
               RowBox[{"BoostedLLPsFromDecaysTable", "[", 
                RowBox[{"\[CapitalUpsilon]data", ",", "BdataRest"}], "]"}]}], 
              ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"IfTwo", "==", "\"\<True\>\""}], "&&", "LLPdistr"}], ",", 
          RowBox[{"datafin", "=", 
           RowBox[{"Riffle", "[", 
            RowBox[{"datafin", ",", "datafin"}], "]"}]}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"particle", "!=", "Particle"}], ",", 
          RowBox[{"datafin", "=", 
           RowBox[{"DataConverted", "[", 
            RowBox[{"datafin", ",", 
             RowBox[{"mSM", "[", "Particle", "]"}]}], "]"}]}], ",", 
          "datafin"}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", "datafin"}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.9132214623446712`*^9, 3.913221476903121*^9}, {
   3.9132216028548927`*^9, 3.9132216581740437`*^9}, {3.9132216961880336`*^9, 
   3.913221697991794*^9}, {3.913221730861147*^9, 3.913222028594967*^9}, {
   3.913222080440143*^9, 3.913222087962355*^9}, {3.913222120855889*^9, 
   3.913222389117504*^9}, {3.913222443249443*^9, 3.9132224434095573`*^9}, {
   3.9132228671467404`*^9, 3.9132228672719164`*^9}, {3.913223365195081*^9, 
   3.913223517148328*^9}, {3.913223748961215*^9, 3.913223762354862*^9}, {
   3.913261623833496*^9, 3.9132617795253515`*^9}, {3.9132619545622206`*^9, 
   3.9132620155852365`*^9}, {3.91326968750252*^9, 3.9132696964527335`*^9}, {
   3.9133680238303022`*^9, 3.913368031484419*^9}, 3.913449172405038*^9, 
   3.9138877098724527`*^9, {3.9144894651298323`*^9, 3.9144894720020137`*^9}, {
   3.914831380188117*^9, 3.914831473630134*^9}, {3.9148316181130323`*^9, 
   3.914831663384596*^9}, {3.914831705535822*^9, 3.9148318047793612`*^9}, {
   3.9148318500151596`*^9, 3.914831887646638*^9}, {3.914833863935631*^9, 
   3.914833928637499*^9}, {3.915438799591983*^9, 3.915438799595004*^9}, 
   3.915703436151754*^9, {3.91570543956771*^9, 3.915705483718461*^9}, 
   3.9157058588876553`*^9, 3.9157059985840487`*^9, {3.916331592367295*^9, 
   3.9163316218374033`*^9}, {3.934132978117755*^9, 3.934132986846059*^9}, {
   3.9493867256432896`*^9, 3.9493867261329403`*^9}, 3.9493877518001766`*^9, {
   3.9496389217644825`*^9, 3.949639021876644*^9}, {3.949639080378954*^9, 
   3.949639096037548*^9}, {3.9496391366699657`*^9, 3.949639140981943*^9}, {
   3.94964037385742*^9, 3.9496403959854355`*^9}, {3.9496406815050983`*^9, 
   3.9496408427698708`*^9}, {3.949640898017252*^9, 3.9496410536291237`*^9}, {
   3.9496422049596252`*^9, 3.9496422371558456`*^9}, {3.949644875387686*^9, 
   3.9496448813870087`*^9}, {3.949645310519535*^9, 3.949645325232378*^9}, 
   3.9499949414863644`*^9, {3.9499961297942696`*^9, 3.9499963187803745`*^9}},
 CellTags->"Evaluation",
 CellLabel->"In[93]:=",ExpressionUUID->"4b8e5463-d83a-d346-9cb2-19a58f881b71"],

Cell[BoxData[
 FormBox[
  RowBox[{"{", 
   RowBox[{"True", ",", "False"}], "}"}], TraditionalForm]], "Output",
 CellChangeTimes->{3.9434161938146152`*^9, 3.947738426723955*^9, 
  3.9477387151670494`*^9, 3.9477392621328354`*^9, 3.94774038391251*^9, 
  3.9477442312547455`*^9, 3.948249122712473*^9, 3.9482504237131596`*^9, 
  3.9483042922559853`*^9, 3.948335030800396*^9, 3.949386762937887*^9, 
  3.949388083070305*^9, 3.9496453261246777`*^9, 3.94965700318116*^9, 
  3.949996320269312*^9},
 CellTags->"Evaluation",
 CellLabel->"Out[96]=",ExpressionUUID->"9fda700b-f09a-ec40-93f5-6df196764632"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Test", "Section",
 CellChangeTimes->{{3.9132224116825085`*^9, 3.9132224122060623`*^9}},
 CellTags->
  "Evaluation",ExpressionUUID->"93fcc13b-37d5-c84a-87ce-d8d595e9d3e2"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"factest", "=", "\"\<Serpukhov\>\""}], ";", "\[IndentingNewLine]", 
   RowBox[{"ptest", "=", "\"\<EtaPr\>\""}], ";", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Length", "[", 
        RowBox[{"DataDistr", "[", 
         RowBox[{"factest", ",", "ptest"}], "]"}], "]"}], "!=", "2"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"pts", "=", 
        RowBox[{"PointsSampler", "[", 
         RowBox[{"factest", ",", "ptest", ",", 
          SuperscriptBox["10", "6"], ",", "\"\<False\>\""}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"MotherInterpolation", "[", 
        RowBox[{"factest", ",", "ptest"}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"angdistrIntDat", "=", 
        RowBox[{"With", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"thmin", "=", 
             RowBox[{
              RowBox[{"\[Theta]MinMax", "[", 
               RowBox[{"factest", ",", "ptest"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], ",", 
            RowBox[{"thmax", "=", 
             RowBox[{
              RowBox[{"\[Theta]MinMax", "[", 
               RowBox[{"factest", ",", "ptest"}], "]"}], "[", 
              RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}], ",", 
          RowBox[{"ParallelTable", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              SuperscriptBox["10", "x"], ",", 
              RowBox[{"Quiet", "[", 
               RowBox[{"NIntegrate", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"DoubleDistrMotherInt", "[", 
                   RowBox[{
                    SuperscriptBox["10", "x"], ",", 
                    RowBox[{"Exp", "[", "e", "]"}], ",", "factest", ",", 
                    "ptest"}], "]"}], 
                  RowBox[{"Exp", "[", "e", "]"}]}], ",", 
                 RowBox[{"{", 
                  RowBox[{"e", ",", 
                   RowBox[{"Log", "[", 
                    RowBox[{
                    RowBox[{"pts", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "4"}], "]"}], "]"}], "//", "Min"}], 
                    "]"}], ",", 
                   RowBox[{"Log", "[", 
                    RowBox[{
                    RowBox[{"pts", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "4"}], "]"}], "]"}], "//", "Max"}], 
                    "]"}]}], "}"}], ",", 
                 RowBox[{
                 "Method", "->", "\"\<InterpolationPointsSubdivision\>\""}]}],
                 "]"}], "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"x", ",", 
              RowBox[{"Log10", "[", "thmin", "]"}], ",", 
              RowBox[{"Log10", "[", "thmax", "]"}], ",", 
              FractionBox[
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Log10", "[", "thmax", "]"}], "-", 
                 RowBox[{"Log10", "[", "thmin", "]"}]}], ")"}], "100"]}], 
             "}"}]}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"angdistrInt", "[", "\[Theta]X_", "]"}], "=", 
        RowBox[{
         RowBox[{"Interpolation", "[", 
          RowBox[{"angdistrIntDat", ",", 
           RowBox[{"InterpolationOrder", "->", "1"}]}], "]"}], "[", 
         "\[Theta]X", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"norm1", "=", 
        RowBox[{"NIntegrate", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"angdistrInt", "[", 
            RowBox[{"Exp", "[", "x", "]"}], "]"}], 
           RowBox[{"Exp", "[", "x", "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"x", ",", 
            RowBox[{"Log", "[", 
             RowBox[{"Min", "[", 
              RowBox[{"PTS", "[", 
               RowBox[{"[", 
                RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}], "]"}], ",", 
            RowBox[{"Log", "[", 
             RowBox[{"Max", "[", 
              RowBox[{"PTS", "[", 
               RowBox[{"[", 
                RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}], "]"}]}], 
           "}"}], ",", 
          RowBox[{
          "Method", "->", "\"\<InterpolationPointsSubdivision\>\""}]}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"thvs", "=", 
        RowBox[{"\[Theta]Nlist", "[", "factest", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"angles", "=", 
        RowBox[{"PTS", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "1"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"bns", "=", 
        RowBox[{"BinCounts", "[", 
         RowBox[{"angles", ",", 
          RowBox[{"{", "thvs", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"tabpdf", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Log", "[", 
             FractionBox[
              RowBox[{
               RowBox[{"thvs", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "+", 
               RowBox[{"thvs", "[", 
                RowBox[{"[", 
                 RowBox[{"i", "+", "1"}], "]"}], "]"}]}], "2"], "]"}], ",", 
            RowBox[{"Log", "[", 
             RowBox[{"Max", "[", 
              RowBox[{
               SuperscriptBox["10", 
                RowBox[{"-", "90."}]], ",", 
               FractionBox[
                RowBox[{"bns", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"thvs", "[", 
                   RowBox[{"[", 
                    RowBox[{"i", "+", "1"}], "]"}], "]"}], "-", 
                  RowBox[{"thvs", "[", 
                   RowBox[{"[", "i", "]"}], "]"}]}], ")"}]]}], "]"}], "]"}]}],
            "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{
             RowBox[{"Length", "[", "thvs", "]"}], "-", "1"}], ",", "1"}], 
           "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"pdfint", "[", "x_", "]"}], "=", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Min", "[", 
            RowBox[{"PTS", "[", 
             RowBox[{"[", 
              RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}], "<=", "x", "<=", 
           RowBox[{"Max", "[", 
            RowBox[{"PTS", "[", 
             RowBox[{"[", 
              RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}]}], ",", 
          RowBox[{"Evaluate", "[", 
           RowBox[{"Exp", "[", 
            RowBox[{
             RowBox[{"Interpolation", "[", 
              RowBox[{"tabpdf", ",", 
               RowBox[{"InterpolationOrder", "->", "1"}]}], "]"}], "[", 
             RowBox[{"Log", "[", "x", "]"}], "]"}], "]"}], "]"}], ",", "0."}],
          "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"norm2", "=", 
        RowBox[{"Quiet", "[", 
         RowBox[{"NIntegrate", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"pdfint", "[", 
             RowBox[{"Exp", "[", "x", "]"}], "]"}], 
            RowBox[{"Exp", "[", "x", "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"x", ",", 
             RowBox[{"Log", "[", 
              RowBox[{"Min", "[", 
               RowBox[{"PTS", "[", 
                RowBox[{"[", 
                 RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}], "]"}], ",", 
             RowBox[{"Log", "[", 
              RowBox[{"Max", "[", 
               RowBox[{"PTS", "[", 
                RowBox[{"[", 
                 RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}], "]"}]}], 
            "}"}], ",", 
           RowBox[{
           "Method", "->", "\"\<InterpolationPointsSubdivision\>\""}]}], 
          "]"}], "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], "//", 
    RowBox[{"AbsoluteTiming", "\[IndentingNewLine]", 
     RowBox[{"Quiet", "[", 
      RowBox[{"{", 
       RowBox[{
        FractionBox[
         RowBox[{"NIntegrate", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"pdfint", "[", "x", "]"}], "x"}], ",", 
           RowBox[{"{", 
            RowBox[{"x", ",", 
             SuperscriptBox["10", 
              RowBox[{"-", "5"}]], ",", 
             FractionBox["Pi", "2"]}], "}"}]}], "]"}], 
         RowBox[{"NIntegrate", "[", 
          RowBox[{
           RowBox[{"pdfint", "[", "x", "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"x", ",", 
             SuperscriptBox["10", 
              RowBox[{"-", "5"}]], ",", 
             FractionBox["Pi", "2"]}], "}"}]}], "]"}]], ",", 
        RowBox[{
         RowBox[{"NIntegrate", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"angdistrInt", "[", 
             RowBox[{"Exp", "[", "x", "]"}], "]"}], 
            RowBox[{"Exp", "[", 
             RowBox[{"2", "x"}], "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"x", ",", 
             RowBox[{"Log", "[", 
              RowBox[{"Min", "[", 
               RowBox[{"PTS", "[", 
                RowBox[{"[", 
                 RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}], "]"}], ",", 
             RowBox[{"Min", "[", 
              RowBox[{
               FractionBox["Pi", "2"], ",", 
               RowBox[{"Log", "[", 
                RowBox[{"Max", "[", 
                 RowBox[{"PTS", "[", 
                  RowBox[{"[", 
                   RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}], "]"}]}], 
              "]"}]}], "}"}]}], "]"}], "/", 
         RowBox[{"NIntegrate", "[", 
          RowBox[{
           RowBox[{"angdistrInt", "[", 
            RowBox[{"Exp", "[", "x", "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"x", ",", 
             RowBox[{"Log", "[", 
              RowBox[{"Min", "[", 
               RowBox[{"PTS", "[", 
                RowBox[{"[", 
                 RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}], "]"}], ",", 
             RowBox[{"Min", "[", 
              RowBox[{
               FractionBox["Pi", "2"], ",", 
               RowBox[{"Log", "[", 
                RowBox[{"Max", "[", 
                 RowBox[{"PTS", "[", 
                  RowBox[{"[", 
                   RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}], "]"}]}], 
              "]"}]}], "}"}]}], "]"}]}]}], "}"}], "]"}], 
     "\[IndentingNewLine]", 
     RowBox[{"Quiet", "[", 
      RowBox[{"LogLogPlot", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           FractionBox["1", "norm1"], 
           FractionBox[
            RowBox[{"angdistrInt", "[", "x", "]"}], "x"]}], ",", 
          RowBox[{
           FractionBox["1", "norm2"], 
           FractionBox[
            RowBox[{"pdfint", "[", "x", "]"}], "x"]}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", 
          SuperscriptBox["10", 
           RowBox[{"-", "5."}]], ",", 
          FractionBox["Pi", "2"]}], "}"}]}], "]"}], "]"}]}]}]}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.9132224191596427`*^9, 3.9132226911806145`*^9}, {
   3.9132229260224285`*^9, 3.9132229493744926`*^9}, {3.9132230210631657`*^9, 
   3.9132230212470293`*^9}, {3.913223060219344*^9, 3.9132231258547716`*^9}, {
   3.9132232558149805`*^9, 3.9132232705269227`*^9}, {3.913223311520055*^9, 
   3.9132233128660583`*^9}, {3.913223536325856*^9, 3.913223536646686*^9}, {
   3.9132235722174172`*^9, 3.913223642784997*^9}, {3.9132237301702237`*^9, 
   3.9132237311546392`*^9}, {3.913224415566942*^9, 3.9132244209412565`*^9}, {
   3.913224462539878*^9, 3.913224465465001*^9}, {3.913224618748373*^9, 
   3.9132246500065746`*^9}, {3.91322468792672*^9, 3.9132246891281567`*^9}, {
   3.9132247288759284`*^9, 3.9132247294099827`*^9}, 3.9132247975849686`*^9, {
   3.9132248589071856`*^9, 3.9132248903230743`*^9}, {3.913226399995117*^9, 
   3.9132264566046944`*^9}, {3.9132265651346493`*^9, 3.913226565854848*^9}, {
   3.913226677256049*^9, 3.9132267051664333`*^9}, {3.913227017134261*^9, 
   3.913227026614871*^9}, {3.9132270716178846`*^9, 3.913227078704997*^9}, 
   3.9132272449517593`*^9, {3.9132272843958254`*^9, 3.913227284684663*^9}, {
   3.913227330448598*^9, 3.9132273310609283`*^9}, {3.913227375105749*^9, 
   3.9132273761846724`*^9}, {3.9132602651306515`*^9, 
   3.9132602825324793`*^9}, {3.913260407618323*^9, 3.9132604373798294`*^9}, {
   3.9132605324267397`*^9, 3.913260532628066*^9}, {3.913260663290922*^9, 
   3.9132606636133366`*^9}, {3.9132607289222555`*^9, 
   3.9132607544772635`*^9}, {3.9132607885762925`*^9, 3.913260795276429*^9}, {
   3.913260830370474*^9, 3.9132609764252605`*^9}, {3.91326109951063*^9, 
   3.913261119446557*^9}, {3.913261196897052*^9, 3.9132612155556726`*^9}, {
   3.913261264930546*^9, 3.9132612910279055`*^9}, {3.913261359235361*^9, 
   3.9132613920267525`*^9}, {3.9132614644183073`*^9, 
   3.9132614649134226`*^9}, {3.913281228524306*^9, 3.913281231030325*^9}, 
   3.913286311123146*^9, 3.913887719546791*^9, {3.917947271744625*^9, 
   3.9179472777701645`*^9}, 3.917947553918462*^9, {3.917947631970441*^9, 
   3.917947632104694*^9}, {3.917947711716378*^9, 3.917947711860165*^9}, {
   3.9179482314067926`*^9, 3.9179482337296257`*^9}, {3.9181463836496377`*^9, 
   3.9181463964581356`*^9}, {3.9181465204713387`*^9, 3.918146524068757*^9}},
 CellTags->"Evaluation",
 CellLabel->"In[37]:=",ExpressionUUID->"681ec147-1e53-a24e-91d3-6d36c060cc61"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Final definitions", "Chapter",
 CellChangeTimes->{{3.94999344869182*^9, 
  3.9499934522942543`*^9}},ExpressionUUID->"ed6bfe8b-c8e9-aa42-97b0-\
5ef4f93076e4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Whether", " ", "the", " ", "given", " ", "SM", " ", "particle", " ", 
    "may", " ", "be", " ", "produced", " ", "at", " ", "the", " ", "fiven", 
    " ", "facility"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Do", "[", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{
      "How", " ", "many", " ", "particles", " ", "are", " ", "produced", " ", 
       "per", " ", "direct", " ", "production", " ", "process"}], ";", " ", 
      RowBox[{
      "the", " ", "lowest", " ", "possible", " ", "number", " ", "is", " ", 
       "considered"}]}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"nSMperProd", "[", "particle", "]"}], "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"StringContainsQ", "[", 
           RowBox[{"particle", ",", "\"\<B\>\""}], "]"}], "||", 
          RowBox[{"StringContainsQ", "[", 
           RowBox[{"particle", ",", "\"\<D\>\""}], "]"}], "||", 
          RowBox[{"StringContainsQ", "[", 
           RowBox[{"particle", ",", "\"\<K\>\""}], "]"}]}], ",", "2", ",", 
         "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"IfSMatFacility", "[", 
           RowBox[{"particle", ",", "Facility"}], "]"}], "=", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"nSMperProd", "[", "particle", "]"}], "*", 
              RowBox[{"mSM", "[", "particle", "]"}]}], ">", 
             RowBox[{"EcmFacility", "[", "Facility", "]"}]}], ",", "0", ",", 
            "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
          "Artificial", " ", "condition", " ", "to", " ", "include", " ", 
           "Bs", " ", "mesons", " ", "at", " ", "Belle", " ", "II", " ", 
           RowBox[{"(", 
            RowBox[{"from", " ", "the", " ", "\[CapitalUpsilon]", 
             RowBox[{"(", 
              RowBox[{"5", "S"}], ")"}], " ", "resonance"}], ")"}]}], "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"particle", "==", "\"\<Bs\>\""}], "&&", 
            RowBox[{"Facility", "==", "\"\<SuperKEKB\>\""}]}], ",", 
           RowBox[{
            RowBox[{"IfSMatFacility", "[", 
             RowBox[{"particle", ",", "Facility"}], "]"}], "=", "1"}]}], 
          "]"}], ";"}], "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"Facility", ",", "FacilitiesList"}], "}"}]}], "]"}]}], 
     "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{"particle", ",", "SMparticles"}], "}"}]}], "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Do", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"fbtobc", "[", "Facility", "]"}], "==", "0."}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"IfSMatFacility", "[", 
         RowBox[{"\"\<Bc\>\"", ",", "Facility"}], "]"}], "=", "0"}]}], "]"}], 
     "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{"Facility", ",", "FacilitiesList"}], "}"}]}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.949994372627783*^9, 3.9499944002973156`*^9}},
 CellLabel->"In[38]:=",ExpressionUUID->"3d6ddaf7-9eaf-2546-b74a-87a9cca0afc8"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1908, 999.75},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
Magnification:>0.9 Inherited,
FrontEndVersion->"14.1 for Microsoft Windows (64-bit) (July 16, 2024)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"039777e7-b7e5-c246-a01a-a158a11f5482"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{
 "Evaluation"->{
  Cell[576, 22, 315, 5, 86, "Title",ExpressionUUID->"e66f3502-2655-4647-8c0e-295abab6dc91",
   CellTags->"Evaluation"],
  Cell[916, 31, 370, 5, 60, "Chapter",ExpressionUUID->"c5fa1a07-3d9b-9147-a47b-e2e700ea9f33",
   CellTags->"Evaluation"],
  Cell[1311, 40, 11435, 286, 436, "Input",ExpressionUUID->"7876d6a2-9b21-7040-aaa9-2b95aaae2f3a",
   CellTags->"Evaluation"],
  Cell[12749, 328, 640, 13, 28, "Output",ExpressionUUID->"39d6c1c3-6be2-3146-900e-88f8562440d2",
   CellTags->"Evaluation"],
  Cell[13392, 343, 3907, 94, 1129, "Output",ExpressionUUID->"7187f19a-08f6-884f-b12b-0f9432c36afa",
   CellTags->"Evaluation"],
  Cell[17348, 443, 445, 8, 60, "Chapter",ExpressionUUID->"6c3163a5-8512-d34e-953b-bf606135cde0",
   CellTags->"Evaluation"],
  Cell[17818, 455, 223, 4, 59, "Section",ExpressionUUID->"88664530-1104-304e-b269-f0d10ff8ad00",
   CellTags->"Evaluation"],
  Cell[18066, 463, 439, 9, 47, "Subsection",ExpressionUUID->"076ce08b-54dc-d24b-a181-7cdf3cf75a97",
   CellTags->"Evaluation"],
  Cell[18508, 474, 7498, 181, 213, "Input",ExpressionUUID->"efe5fa6a-c47e-994e-b965-0100aca88733",
   CellTags->"Evaluation"],
  Cell[26043, 660, 653, 18, 47, "Subsection",ExpressionUUID->"e92be444-a57a-0e4a-bb52-ab5ad727e8b4",
   CellTags->"Evaluation"],
  Cell[26721, 682, 12250, 287, 711, "Input",ExpressionUUID->"025f7586-96e8-5e42-ac1c-cbc1286bc10e",
   CellTags->"Evaluation"],
  Cell[38974, 971, 26353, 496, 53, "Output",ExpressionUUID->"ee46892d-ed84-ec48-b3a8-bb05159229bb",
   CellTags->"Evaluation"],
  Cell[65330, 1469, 18305, 347, 53, "Output",ExpressionUUID->"48f8d862-8c06-734b-a31b-285c9116370a",
   CellTags->"Evaluation"],
  Cell[83684, 1822, 477, 12, 47, "Subsection",ExpressionUUID->"4ebf9064-21ad-ce4e-bcca-9c9189045b26",
   CellTags->"Evaluation"],
  Cell[84164, 1836, 24391, 572, 905, "Input",ExpressionUUID->"161d6bc4-7d02-334e-9526-1961fc0f1979",
   CellTags->"Evaluation"],
  Cell[108604, 2414, 187, 3, 59, "Section",ExpressionUUID->"9d0f8af7-bcd9-5b4f-a2bc-7ac901668df5",
   CellTags->"Evaluation"],
  Cell[108816, 2421, 16944, 391, 922, "Input",ExpressionUUID->"39942510-ac3a-5043-b336-9c7339dd6459",
   CellTags->"Evaluation"],
  Cell[125763, 2814, 16998, 324, 53, "Output",ExpressionUUID->"3465a19e-ee6e-ac4b-8aeb-0232d3e1eef5",
   CellTags->"Evaluation"],
  Cell[142764, 3140, 15968, 302, 53, "Output",ExpressionUUID->"e70ef994-d8aa-4646-82ce-fe8333380b69",
   CellTags->"Evaluation"],
  Cell[158793, 3449, 309, 5, 60, "Chapter",ExpressionUUID->"ca536f19-eef7-784b-bb1e-e3f34b8fd633",
   CellTags->"Evaluation"],
  Cell[159127, 3458, 192, 3, 59, "Section",ExpressionUUID->"54abbca7-f3a0-904b-b208-6f34fbca81dc",
   CellTags->"Evaluation"],
  Cell[159344, 3465, 14691, 331, 846, "Input",ExpressionUUID->"4b8e5463-d83a-d346-9cb2-19a58f881b71",
   CellTags->"Evaluation"],
  Cell[174038, 3798, 591, 11, 28, "Output",ExpressionUUID->"9fda700b-f09a-ec40-93f5-6df196764632",
   CellTags->"Evaluation"],
  Cell[174678, 3815, 176, 3, 59, "Section",ExpressionUUID->"93fcc13b-37d5-c84a-87ce-d8d595e9d3e2",
   CellTags->"Evaluation"],
  Cell[174857, 3820, 13391, 317, 392, "Input",ExpressionUUID->"681ec147-1e53-a24e-91d3-6d36c060cc61",
   CellTags->"Evaluation"]}
 }
*)
(*CellTagsIndex
CellTagsIndex->{
 {"Evaluation", 192342, 4248}
 }
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[576, 22, 315, 5, 86, "Title",ExpressionUUID->"e66f3502-2655-4647-8c0e-295abab6dc91",
 CellTags->"Evaluation"],
Cell[CellGroupData[{
Cell[916, 31, 370, 5, 60, "Chapter",ExpressionUUID->"c5fa1a07-3d9b-9147-a47b-e2e700ea9f33",
 CellTags->"Evaluation"],
Cell[CellGroupData[{
Cell[1311, 40, 11435, 286, 436, "Input",ExpressionUUID->"7876d6a2-9b21-7040-aaa9-2b95aaae2f3a",
 CellTags->"Evaluation"],
Cell[12749, 328, 640, 13, 28, "Output",ExpressionUUID->"39d6c1c3-6be2-3146-900e-88f8562440d2",
 CellTags->"Evaluation"],
Cell[13392, 343, 3907, 94, 1129, "Output",ExpressionUUID->"7187f19a-08f6-884f-b12b-0f9432c36afa",
 CellTags->"Evaluation"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[17348, 443, 445, 8, 60, "Chapter",ExpressionUUID->"6c3163a5-8512-d34e-953b-bf606135cde0",
 CellTags->"Evaluation"],
Cell[CellGroupData[{
Cell[17818, 455, 223, 4, 59, "Section",ExpressionUUID->"88664530-1104-304e-b269-f0d10ff8ad00",
 CellTags->"Evaluation"],
Cell[CellGroupData[{
Cell[18066, 463, 439, 9, 47, "Subsection",ExpressionUUID->"076ce08b-54dc-d24b-a181-7cdf3cf75a97",
 CellTags->"Evaluation"],
Cell[18508, 474, 7498, 181, 213, "Input",ExpressionUUID->"efe5fa6a-c47e-994e-b965-0100aca88733",
 CellTags->"Evaluation"]
}, Open  ]],
Cell[CellGroupData[{
Cell[26043, 660, 653, 18, 47, "Subsection",ExpressionUUID->"e92be444-a57a-0e4a-bb52-ab5ad727e8b4",
 CellTags->"Evaluation"],
Cell[CellGroupData[{
Cell[26721, 682, 12250, 287, 711, "Input",ExpressionUUID->"025f7586-96e8-5e42-ac1c-cbc1286bc10e",
 CellTags->"Evaluation"],
Cell[38974, 971, 26353, 496, 53, "Output",ExpressionUUID->"ee46892d-ed84-ec48-b3a8-bb05159229bb",
 CellTags->"Evaluation"],
Cell[65330, 1469, 18305, 347, 53, "Output",ExpressionUUID->"48f8d862-8c06-734b-a31b-285c9116370a",
 CellTags->"Evaluation"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[83684, 1822, 477, 12, 47, "Subsection",ExpressionUUID->"4ebf9064-21ad-ce4e-bcca-9c9189045b26",
 CellTags->"Evaluation"],
Cell[84164, 1836, 24391, 572, 905, "Input",ExpressionUUID->"161d6bc4-7d02-334e-9526-1961fc0f1979",
 CellTags->"Evaluation"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[108604, 2414, 187, 3, 59, "Section",ExpressionUUID->"9d0f8af7-bcd9-5b4f-a2bc-7ac901668df5",
 CellTags->"Evaluation"],
Cell[CellGroupData[{
Cell[108816, 2421, 16944, 391, 922, "Input",ExpressionUUID->"39942510-ac3a-5043-b336-9c7339dd6459",
 CellTags->"Evaluation"],
Cell[125763, 2814, 16998, 324, 53, "Output",ExpressionUUID->"3465a19e-ee6e-ac4b-8aeb-0232d3e1eef5",
 CellTags->"Evaluation"],
Cell[142764, 3140, 15968, 302, 53, "Output",ExpressionUUID->"e70ef994-d8aa-4646-82ce-fe8333380b69",
 CellTags->"Evaluation"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[158793, 3449, 309, 5, 60, "Chapter",ExpressionUUID->"ca536f19-eef7-784b-bb1e-e3f34b8fd633",
 CellTags->"Evaluation"],
Cell[CellGroupData[{
Cell[159127, 3458, 192, 3, 59, "Section",ExpressionUUID->"54abbca7-f3a0-904b-b208-6f34fbca81dc",
 CellTags->"Evaluation"],
Cell[CellGroupData[{
Cell[159344, 3465, 14691, 331, 846, "Input",ExpressionUUID->"4b8e5463-d83a-d346-9cb2-19a58f881b71",
 CellTags->"Evaluation"],
Cell[174038, 3798, 591, 11, 28, "Output",ExpressionUUID->"9fda700b-f09a-ec40-93f5-6df196764632",
 CellTags->"Evaluation"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[174678, 3815, 176, 3, 59, "Section",ExpressionUUID->"93fcc13b-37d5-c84a-87ce-d8d595e9d3e2",
 CellTags->"Evaluation"],
Cell[174857, 3820, 13391, 317, 392, "Input",ExpressionUUID->"681ec147-1e53-a24e-91d3-6d36c060cc61",
 CellTags->"Evaluation"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[188297, 4143, 163, 3, 60, "Chapter",ExpressionUUID->"ed6bfe8b-c8e9-aa42-97b0-5ef4f93076e4"],
Cell[188463, 4148, 3469, 84, 248, "Input",ExpressionUUID->"3d6ddaf7-9eaf-2546-b74a-87a9cca0afc8"]
}, Open  ]]
}, Open  ]]
}
]
*)

