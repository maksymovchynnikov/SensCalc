(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    197047,       4925]
NotebookOptionsPosition[    188363,       4758]
NotebookOutlinePosition[    190255,       4801]
CellTagsIndexPosition[    190180,       4796]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Definitions", "Chapter",
 CellChangeTimes->{{3.9341010976256733`*^9, 
  3.9341010989260883`*^9}},ExpressionUUID->"558648bf-fa20-480d-a231-\
a30f128a6548"],

Cell[CellGroupData[{

Cell["Facilities info", "Section",
 CellChangeTimes->{{3.93513096928864*^9, 
  3.9351309720908146`*^9}},ExpressionUUID->"a5e60e60-13b5-4d59-a9e6-\
8ca48d910142"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Quiet", "[", 
   RowBox[{"NotebookEvaluate", "[", 
    RowBox[{"FileNameJoin", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"NotebookDirectory", "[", "]"}], "//", "ParentDirectory"}], 
       ",", "\"\<Generic.nb\>\""}], "}"}], "]"}], "]"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Quiet", "[", 
   RowBox[{"NotebookEvaluate", "[", 
    RowBox[{"FileNameJoin", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"NotebookDirectory", "[", "]"}], "//", "ParentDirectory"}], 
       ",", "\"\<SensCalc/SM particles.nb\>\""}], "}"}], "]"}], "]"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"mSM", "[", "\"\<p\>\"", "]"}], "=", 
   RowBox[{"ParamProductMass", "[", 
    RowBox[{"ParamProductToPDGid", "[", "\"\<p\>\"", "]"}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.935130972856436*^9, 3.935130988870923*^9}, {
  3.935131194031355*^9, 3.935131251212033*^9}, {3.9493728337468834`*^9, 
  3.9493728391590977`*^9}, {3.949859682044241*^9, 
  3.949859684383541*^9}},ExpressionUUID->"731dfc3a-29e7-449b-81e6-\
e77129ba20f8"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Proton form-factor in timelike region", "Section",
 CellChangeTimes->{{3.934092076040435*^9, 3.9340920832956676`*^9}, 
   3.934092121382082*^9},ExpressionUUID->"b1ae5fc5-b859-4f94-b8de-\
5d61691d787d"],

Cell[CellGroupData[{

Cell["DP", "Subsection",
 CellChangeTimes->{{3.9340920932957973`*^9, 3.9340920945068884`*^9}, {
  3.934101085420679*^9, 
  3.934101086039871*^9}},ExpressionUUID->"47ee9e23-c41f-42d3-bb9b-\
a22db7781545"],

Cell[CellGroupData[{

Cell["The FR approach (unitary analytic model)", "Subsubsection",
 CellChangeTimes->{{3.934093707168272*^9, 3.9340937121479497`*^9}, {
  3.935130749675787*^9, 
  3.9351307617278223`*^9}},ExpressionUUID->"e546c7d4-aa7e-4c2d-bbdc-\
6940beb041f7"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"F1", "[", 
      RowBox[{"mX_", ",", "\"\<DP\>\"", ",", "\"\<Lower\>\""}], "]"}], ",", 
     RowBox[{"F1", "[", 
      RowBox[{"mX_", ",", "\"\<DP\>\"", ",", "\"\<Central\>\""}], "]"}], ",", 
     RowBox[{"F1", "[", 
      RowBox[{"mX_", ",", "\"\<DP\>\"", ",", "\"\<Upper\>\""}], "]"}], ",", 
     RowBox[{"F2", "[", 
      RowBox[{"mX_", ",", "\"\<DP\>\"", ",", "\"\<Lower\>\""}], "]"}], ",", 
     RowBox[{"F2", "[", 
      RowBox[{"mX_", ",", "\"\<DP\>\"", ",", "\"\<Central\>\""}], "]"}], ",", 
     RowBox[{"F2", "[", 
      RowBox[{"mX_", ",", "\"\<DP\>\"", ",", "\"\<Upper\>\""}], "]"}]}], 
    "}"}], "=", 
   RowBox[{"Import", "[", 
    RowBox[{
     RowBox[{"FileNameJoin", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"NotebookDirectory", "[", "]"}], "//", "ParentDirectory"}], 
         "//", "ParentDirectory"}], ",", 
        "\"\<phenomenology/DP/Production \
probabilities/FR-form-factors-total.mx\>\""}], "}"}], "]"}], ",", 
     "\"\<mx\>\""}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"uncertainties", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Keys", "[", 
      RowBox[{"DownValues", "@", "F1"}], "]"}], "[", 
     RowBox[{"[", 
      RowBox[{"All", ",", "1", ",", 
       RowBox[{"-", "1"}]}], "]"}], "]"}], "//", "DeleteDuplicates"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"LogLogPlot", "[", 
    RowBox[{
     RowBox[{"Evaluate", "[", 
      RowBox[{"{", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"F1", "[", 
          RowBox[{"mX", ",", "\"\<DP\>\"", ",", "\"\<Central\>\""}], "]"}], 
         "2"], ",", 
        SuperscriptBox[
         RowBox[{"F1", "[", 
          RowBox[{"mX", ",", "\"\<DP\>\"", ",", "\"\<Upper\>\""}], "]"}], 
         "2"], ",", 
        SuperscriptBox[
         RowBox[{"F1", "[", 
          RowBox[{"mX", ",", "\"\<DP\>\"", ",", "\"\<Lower\>\""}], "]"}], 
         "2"]}], "}"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"mX", ",", "0.02", ",", "2"}], "}"}], ",", 
     RowBox[{"Filling", "->", 
      RowBox[{"{", 
       RowBox[{"2", "->", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", "3", "}"}], ",", 
          RowBox[{"Opacity", "[", "0.1", "]"}]}], "}"}]}], "}"}]}]}], "]"}], 
   "*)"}]}]}], "Input",
 CellChangeTimes->{{3.934098010510158*^9, 3.934098123410131*^9}, {
  3.934098248759262*^9, 3.9340982706047106`*^9}, {3.9341196703587675`*^9, 
  3.934119742250952*^9}, {3.9341228674363804`*^9, 3.9341228691062093`*^9}, {
  3.9351307652046795`*^9, 3.935130765401196*^9}, {3.9351428749466157`*^9, 
  3.9351428838234205`*^9}, {3.9404359804890423`*^9, 3.940435997499241*^9}, {
  3.949372848167076*^9, 3.9493728499570904`*^9}},
 CellLabel->"In[97]:=",ExpressionUUID->"ec327216-5a20-4dc7-a905-3a0460b08e09"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.9404359873880844`*^9, 3.940435992539446*^9}},
 CellLabel->"In[99]:=",ExpressionUUID->"691ea99c-81b6-a94d-8a02-c939af530db3"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Older studies", "Subsubsection",
 CellChangeTimes->{{3.934092103700075*^9, 3.934092103926055*^9}, {
   3.9341011042858424`*^9, 3.9341011057062116`*^9}, 
   3.9404359837018185`*^9},ExpressionUUID->"7aefda7f-b658-456f-9cc7-\
e4d858549eee"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"The", " ", "form"}], "-", 
      RowBox[{
      "factor", " ", "is", " ", "derived", " ", "assuming", " ", "the", " ", 
       "mixing", " ", "of", " ", "DPs", " ", "with", " ", "3", " ", "\[Rho]", 
       " ", "and", " ", "3", " ", "\[Omega]", " ", "resonances"}]}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{
       "with", " ", "the", " ", "6", " ", "couplings", " ", "fixed", " ", 
        "from", " ", "experiment", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"lowest", " ", "\[Rho]"}], ",", 
          RowBox[{"\[Omega]", " ", "resonances"}]}], ")"}]}], " ", "+", 
       RowBox[{
       "boundary", " ", "conditions", " ", "in", " ", "the", " ", "limit", 
        " ", "m"}]}], " ", "->", " ", "\[Infinity]"}]}], ")"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Masses", " ", "and", " ", "other", " ", "parameters"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"f\[Omega]DP", "=", "1.011"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"f\[Rho]DP", "=", "0.616"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"M\[Omega]780", ",", "M\[Omega]1420", ",", "M\[Omega]1650"}], 
      "}"}], "=", 
     RowBox[{"{", 
      RowBox[{"0.78", ",", "1.42", ",", "1.65"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "Gamma\[Omega]780", ",", "Gamma\[Omega]1420", ",", 
       "Gamma\[Omega]1650"}], "}"}], "=", 
     RowBox[{"{", 
      RowBox[{"0.0084", ",", "0.29", ",", "0.315"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"M\[Rho]780", ",", "M\[Rho]1450", ",", "M\[Rho]1700"}], "}"}], 
     "=", 
     RowBox[{"{", 
      RowBox[{"0.77", ",", "1.45", ",", "1.7"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "Gamma\[Rho]780", ",", "Gamma\[Rho]1450", ",", "Gamma\[Rho]1700"}], 
      "}"}], "=", 
     RowBox[{"{", 
      RowBox[{"0.15", ",", "0.4", ",", "0.25"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"FormFactorBremDPTemp", "[", 
      RowBox[{"mV_", ",", "mx_", ",", "\[CapitalGamma]x_", ",", "fx_"}], 
      "]"}], "=", 
     FractionBox[
      RowBox[{"fx", "*", 
       SuperscriptBox["mx", "2"]}], 
      RowBox[{
       SuperscriptBox["mx", "2"], "-", 
       SuperscriptBox["mV", "2"], "-", 
       RowBox[{"I", "*", "\[CapitalGamma]x", "*", "mx"}]}]]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"FormFactorBremDP\[Omega]Temp", "[", "mV_", "]"}], "=", 
     RowBox[{"Chop", "[", 
      RowBox[{
       RowBox[{"FormFactorBremDPTemp", "[", 
        RowBox[{
         RowBox[{"I", "*", "mV"}], ",", "M\[Omega]780", ",", "0", ",", 
         "f\[Omega]DP"}], "]"}], "+", 
       RowBox[{"FormFactorBremDPTemp", "[", 
        RowBox[{
         RowBox[{"I", "*", "mV"}], ",", "M\[Omega]1420", ",", "0", ",", 
         "f\[Omega]Pr"}], "]"}], "+", 
       RowBox[{"FormFactorBremDPTemp", "[", 
        RowBox[{
         RowBox[{"I", "*", "mV"}], ",", "M\[Omega]1650", ",", "0", ",", 
         "f\[Omega]PrPr"}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"FormFactorBremDP\[Rho]Temp", "[", "mV_", "]"}], "=", 
     RowBox[{"Chop", "[", 
      RowBox[{
       RowBox[{"FormFactorBremDPTemp", "[", 
        RowBox[{
         RowBox[{"I", "*", "mV"}], ",", "M\[Rho]780", ",", "0", ",", 
         "f\[Rho]DP"}], "]"}], "+", 
       RowBox[{"FormFactorBremDPTemp", "[", 
        RowBox[{
         RowBox[{"I", "*", "mV"}], ",", "M\[Rho]1450", ",", "0", ",", 
         "f\[Rho]Pr"}], "]"}], "+", 
       RowBox[{"FormFactorBremDPTemp", "[", 
        RowBox[{
         RowBox[{"I", "*", "mV"}], ",", "M\[Rho]1700", ",", "0", ",", 
         "f\[Rho]PrPr"}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"sol\[Omega]", "=", 
     RowBox[{
      RowBox[{"Solve", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"FormFactorBremDP\[Omega]Temp", "[", "0", "]"}], 
           "\[Equal]", "0.5"}], "&&", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"Limit", "[", 
             RowBox[{
              RowBox[{
               SuperscriptBox["mV", "2"], 
               RowBox[{"FormFactorBremDP\[Omega]Temp", "[", "mV", "]"}]}], 
              ",", 
              RowBox[{"mV", "\[Rule]", "Infinity"}]}], "]"}], ")"}], 
           "\[Equal]", "0"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"f\[Omega]Pr", ",", "f\[Omega]PrPr"}], "}"}]}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"sol\[Rho]", "=", 
     RowBox[{
      RowBox[{"Solve", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"FormFactorBremDP\[Rho]Temp", "[", "0", "]"}], "\[Equal]", 
           "0.5"}], "&&", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"Limit", "[", 
             RowBox[{
              RowBox[{
               SuperscriptBox["mV", "2"], 
               RowBox[{"FormFactorBremDP\[Rho]Temp", "[", "mV", "]"}]}], ",", 
              RowBox[{"mV", "\[Rule]", "Infinity"}]}], "]"}], ")"}], 
           "\[Equal]", "0"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"f\[Rho]Pr", ",", "f\[Rho]PrPr"}], "}"}]}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"FormFactorSquaredBrem", "[", 
      RowBox[{"mV_", ",", "\"\<DP\>\""}], "]"}], "=", 
     SuperscriptBox[
      RowBox[{"Abs", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"FormFactorBremDPTemp", "[", 
           RowBox[{
           "mV", ",", "M\[Omega]780", ",", "Gamma\[Omega]780", ",", 
            "f\[Omega]DP"}], "]"}], "+", 
          RowBox[{"FormFactorBremDPTemp", "[", 
           RowBox[{"mV", ",", "M\[Omega]1420", ",", "Gamma\[Omega]1420", ",", 
            RowBox[{"f\[Omega]Pr", "/.", "sol\[Omega]"}]}], "]"}], "+", 
          RowBox[{"FormFactorBremDPTemp", "[", 
           RowBox[{"mV", ",", "M\[Omega]1650", ",", "Gamma\[Omega]1650", ",", 
            RowBox[{"f\[Omega]PrPr", "/.", "sol\[Omega]"}]}], "]"}]}], ")"}], 
        "+", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"FormFactorBremDPTemp", "[", 
           RowBox[{
           "mV", ",", "M\[Rho]780", ",", "Gamma\[Rho]780", ",", "f\[Rho]DP"}],
            "]"}], "+", 
          RowBox[{"FormFactorBremDPTemp", "[", 
           RowBox[{"mV", ",", "M\[Rho]1450", ",", "Gamma\[Rho]1450", ",", 
            RowBox[{"f\[Rho]Pr", "/.", "sol\[Rho]"}]}], "]"}], "+", 
          RowBox[{"FormFactorBremDPTemp", "[", 
           RowBox[{"mV", ",", "M\[Rho]1700", ",", "Gamma\[Rho]1700", ",", 
            RowBox[{"f\[Rho]PrPr", "/.", "sol\[Rho]"}]}], "]"}]}], ")"}]}], 
       "]"}], "2"]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"LogLogPlot", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"Abs", "[", 
        RowBox[{"FormFactorBremDP", "[", "mV", "]"}], "]"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"mV", ",", "0.1", ",", "2"}], "}"}], ",", 
      RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
      RowBox[{"Frame", "\[Rule]", "True"}], ",", 
      RowBox[{"ImageSize", "\[Rule]", "Large"}]}], "]"}], "*)"}]}]}]], "Input",
 CellChangeTimes->{{3.822472937377986*^9, 3.822472958787899*^9}, {
   3.822473164264882*^9, 3.8224732169513645`*^9}, {3.8224732650870314`*^9, 
   3.82247340649076*^9}, {3.8224739149924173`*^9, 3.8224739215133142`*^9}, {
   3.8224739584042616`*^9, 3.8224739701273427`*^9}, 3.822474249386196*^9, {
   3.822474485929841*^9, 3.822474542582522*^9}, {3.8224748380407495`*^9, 
   3.8224748464105816`*^9}, {3.8765031553789*^9, 3.8765031570765734`*^9}, {
   3.8867410352643704`*^9, 3.886741035534209*^9}, {3.8867410760390997`*^9, 
   3.8867410783231735`*^9}, {3.886741117233474*^9, 3.886741208713107*^9}, {
   3.886759249554492*^9, 3.8867592836208363`*^9}, {3.88675937342173*^9, 
   3.8867594003906803`*^9}, {3.886759559571762*^9, 3.8867596483855095`*^9}, {
   3.913456552763573*^9, 3.9134565605031033`*^9}, {3.914054477519086*^9, 
   3.914054507785887*^9}, {3.9345553707403755`*^9, 3.934555382280676*^9}},
 CellTags->"Evaluation",
 CellLabel->
  "In[100]:=",ExpressionUUID->"d0e187fa-6371-4d5d-8a3a-cb347c8df152"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Scalar", "Subsection",
 CellChangeTimes->{{3.9340920932957973`*^9, 3.9340920945068884`*^9}, {
  3.934092129590144*^9, 
  3.9340921414773817`*^9}},ExpressionUUID->"1627a979-3cce-42b5-b827-\
47d96c618651"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Phenomenological", " ", "form", " ", "factor", " ", "from", " ", 
     RowBox[{"https", ":"}]}], "//", 
    RowBox[{
     RowBox[{
      RowBox[{"arxiv", ".", "org"}], "/", "abs"}], "/", "2008.08108"}]}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"FormFactorSquaredBrem", "[", 
     RowBox[{"mS_", ",", "\"\<Scalar\>\""}], "]"}], "=", 
    RowBox[{
     RowBox[{"Interpolation", "[", 
      RowBox[{
       RowBox[{"Import", "[", 
        RowBox[{
         RowBox[{"FileNameJoin", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"NotebookDirectory", "[", "]"}], "//", 
              "ParentDirectory"}], "//", "ParentDirectory"}], ",", 
            "\"\<phenomenology/Scalar/Production \
probabilities/proton-timelike-form-factor-scalar.txt\>\""}], "}"}], "]"}], 
         ",", "\"\<Table\>\""}], "]"}], ",", 
       RowBox[{"InterpolationOrder", "->", "1"}]}], "]"}], "[", "mS", "]"}]}],
    ";"}]}]], "Input",
 CellChangeTimes->{{3.9341011162018785`*^9, 3.934101118286307*^9}, {
  3.9345553895226774`*^9, 3.934555413645164*^9}, {3.9505867826530514`*^9, 
  3.950586790964596*^9}},
 CellLabel->
  "In[112]:=",ExpressionUUID->"40bf4291-e9ca-447e-b454-3fb2bce2be17"]
}, Open  ]],

Cell[CellGroupData[{

Cell["B-L", "Subsection",
 CellChangeTimes->{{3.9340920932957973`*^9, 3.9340920945068884`*^9}, {
  3.934092134597225*^9, 
  3.9340921349572086`*^9}},ExpressionUUID->"2e1aa088-bec3-4340-aeb8-\
c4246486406a"],

Cell[CellGroupData[{

Cell["The FR approach (unitary analytic model)", "Subsubsection",
 CellChangeTimes->{{3.934093707168272*^9, 3.9340937121479497`*^9}, {
  3.935130749675787*^9, 
  3.9351307617278223`*^9}},ExpressionUUID->"523cb825-c645-fd4f-a682-\
91b51c04b004"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"F1", "[", 
      RowBox[{"mX_", ",", "\"\<B-L\>\"", ",", "\"\<Lower\>\""}], "]"}], ",", 
     RowBox[{"F1", "[", 
      RowBox[{"mX_", ",", "\"\<B-L\>\"", ",", "\"\<Central\>\""}], "]"}], ",", 
     RowBox[{"F1", "[", 
      RowBox[{"mX_", ",", "\"\<B-L\>\"", ",", "\"\<Upper\>\""}], "]"}], ",", 
     RowBox[{"F2", "[", 
      RowBox[{"mX_", ",", "\"\<B-L\>\"", ",", "\"\<Lower\>\""}], "]"}], ",", 
     RowBox[{"F2", "[", 
      RowBox[{"mX_", ",", "\"\<B-L\>\"", ",", "\"\<Central\>\""}], "]"}], ",", 
     RowBox[{"F2", "[", 
      RowBox[{"mX_", ",", "\"\<B-L\>\"", ",", "\"\<Upper\>\""}], "]"}]}], 
    "}"}], "=", 
   RowBox[{"Import", "[", 
    RowBox[{
     RowBox[{"FileNameJoin", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"NotebookDirectory", "[", "]"}], "//", "ParentDirectory"}], 
         "//", "ParentDirectory"}], ",", 
        "\"\<phenomenology/B-L/Production \
probabilities/FR-form-factors-total.mx\>\""}], "}"}], "]"}], ",", 
     "\"\<MX\>\""}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BLlist", "=", 
   RowBox[{"{", 
    RowBox[{
    "\"\<B-L\>\"", ",", "\"\<B-3Lmu\>\"", ",", "\"\<B-3Le-Lmu+Ltau\>\"", ",", 
     "\"\<B-Le-3Lmu+Ltau\>\"", ",", "\"\<B\>\""}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"F1", "[", 
       RowBox[{"mX_", ",", "model", ",", "\"\<Lower\>\""}], "]"}], ",", 
      RowBox[{"F1", "[", 
       RowBox[{"mX_", ",", "model", ",", "\"\<Central\>\""}], "]"}], ",", 
      RowBox[{"F1", "[", 
       RowBox[{"mX_", ",", "model", ",", "\"\<Upper\>\""}], "]"}], ",", 
      RowBox[{"F2", "[", 
       RowBox[{"mX_", ",", "model", ",", "\"\<Lower\>\""}], "]"}], ",", 
      RowBox[{"F2", "[", 
       RowBox[{"mX_", ",", "model", ",", "\"\<Central\>\""}], "]"}], ",", 
      RowBox[{"F2", "[", 
       RowBox[{"mX_", ",", "model", ",", "\"\<Upper\>\""}], "]"}]}], "}"}], 
    "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"F1", "[", 
       RowBox[{"mX", ",", "\"\<B-L\>\"", ",", "\"\<Lower\>\""}], "]"}], ",", 
      RowBox[{"F1", "[", 
       RowBox[{"mX", ",", "\"\<B-L\>\"", ",", "\"\<Central\>\""}], "]"}], ",", 
      RowBox[{"F1", "[", 
       RowBox[{"mX", ",", "\"\<B-L\>\"", ",", "\"\<Upper\>\""}], "]"}], ",", 
      RowBox[{"F2", "[", 
       RowBox[{"mX", ",", "\"\<B-L\>\"", ",", "\"\<Lower\>\""}], "]"}], ",", 
      RowBox[{"F2", "[", 
       RowBox[{"mX", ",", "\"\<B-L\>\"", ",", "\"\<Central\>\""}], "]"}], ",", 
      RowBox[{"F2", "[", 
       RowBox[{"mX", ",", "\"\<B-L\>\"", ",", "\"\<Upper\>\""}], "]"}]}], 
     "}"}]}], "\[IndentingNewLine]", ",", 
   RowBox[{"{", 
    RowBox[{"model", ",", 
     RowBox[{"Drop", "[", 
      RowBox[{"BLlist", ",", "1"}], "]"}]}], "}"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"LogLogPlot", "[", 
    RowBox[{
     RowBox[{"Evaluate", "[", 
      RowBox[{"{", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"F1", "[", 
          RowBox[{"mX", ",", "\"\<DP\>\"", ",", "\"\<Central\>\""}], "]"}], 
         "2"], ",", 
        SuperscriptBox[
         RowBox[{"F1", "[", 
          RowBox[{"mX", ",", "\"\<DP\>\"", ",", "\"\<Upper\>\""}], "]"}], 
         "2"], ",", 
        SuperscriptBox[
         RowBox[{"F1", "[", 
          RowBox[{"mX", ",", "\"\<DP\>\"", ",", "\"\<Lower\>\""}], "]"}], 
         "2"]}], "}"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"mX", ",", "0.02", ",", "2"}], "}"}], ",", 
     RowBox[{"Filling", "->", 
      RowBox[{"{", 
       RowBox[{"2", "->", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", "3", "}"}], ",", 
          RowBox[{"Opacity", "[", "0.1", "]"}]}], "}"}]}], "}"}]}]}], "]"}], 
   "*)"}]}]}], "Input",
 CellChangeTimes->{{3.934098010510158*^9, 3.934098123410131*^9}, {
  3.934098248759262*^9, 3.9340982706047106`*^9}, {3.9341196703587675`*^9, 
  3.934119742250952*^9}, {3.9341228674363804`*^9, 3.9341228691062093`*^9}, {
  3.9351307652046795`*^9, 3.935130765401196*^9}, {3.9351428749466157`*^9, 
  3.9351428838234205`*^9}, {3.940435746050337*^9, 3.940435855787977*^9}, {
  3.9404362354613514`*^9, 3.940436282817751*^9}, {3.940527414487749*^9, 
  3.9405274190194836`*^9}, {3.9493728558615894`*^9, 3.9493728575480614`*^9}},
 CellLabel->
  "In[113]:=",ExpressionUUID->"ef069999-55ba-9f44-8e07-ef12d383b53a"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Older studies", "Subsubsection",
 CellChangeTimes->{{3.934092103700075*^9, 3.934092103926055*^9}, {
  3.9341011042858424`*^9, 
  3.9341011057062116`*^9}},ExpressionUUID->"ca54ef82-6239-5e4b-ba43-\
2586aa979d3b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"The", " ", "form"}], "-", 
      RowBox[{
      "factor", " ", "is", " ", "derived", " ", "assuming", " ", "the", " ", 
       "mixing", " ", "of", " ", "BLs", " ", "with", " ", "3", " ", "\[Rho]", 
       " ", "and", " ", "3", " ", "\[Omega]", " ", "resonances"}]}], ",", 
     RowBox[{
      RowBox[{
      "with", " ", "the", " ", "6", " ", "couplings", " ", "fixed", " ", 
       "from", " ", "experiment", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"lowest", " ", "\[Rho]"}], ",", 
         RowBox[{"\[Omega]", " ", "resonances"}]}], ")"}]}], " ", "+", 
      RowBox[{"boundary", " ", "conditions"}]}]}], ")"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Masses", " ", "and", " ", "other", " ", "parameters"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"f\[Omega]BL", "=", "1.011"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"f\[Rho]BL", "=", "0.616"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"M\[Omega]780", ",", "M\[Omega]1420", ",", "M\[Omega]1650"}], 
      "}"}], "=", 
     RowBox[{"{", 
      RowBox[{"0.78", ",", "1.42", ",", "1.65"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "Gamma\[Omega]780", ",", "Gamma\[Omega]1420", ",", 
       "Gamma\[Omega]1650"}], "}"}], "=", 
     RowBox[{"{", 
      RowBox[{"0.0084", ",", "0.29", ",", "0.315"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Qel", "=", 
     RowBox[{"DiagonalMatrix", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"2", "/", "3"}], ",", 
        RowBox[{"-", 
         RowBox[{"(", 
          RowBox[{"1", "/", "3"}], ")"}]}], ",", 
        RowBox[{"-", 
         RowBox[{"(", 
          RowBox[{"1", "/", "3"}], ")"}]}]}], "}"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"T\[Omega]", " ", "=", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "/", "2"}], ")"}], 
      RowBox[{"DiagonalMatrix", "[", 
       RowBox[{"{", 
        RowBox[{"1", ",", "1", ",", "0"}], "}"}], "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"T\[Phi]", " ", "=", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "/", 
        RowBox[{"(", 
         RowBox[{"\[Sqrt]", "2"}], ")"}]}], ")"}], 
      RowBox[{"DiagonalMatrix", "[", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "1"}], "}"}], "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"f\[Omega]N", "=", "17.2"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"g\[Omega]", "=", 
     RowBox[{"17.1", "*", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "/", "3"}], ")"}], 
          RowBox[{"Tr", "[", "T\[Omega]", "]"}]}], ")"}], "/", 
        RowBox[{"Tr", "[", 
         RowBox[{"Qel", ".", "T\[Omega]"}], "]"}]}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"G\[Omega]", "=", 
     RowBox[{"4", 
      RowBox[{"(", 
       RowBox[{"f\[Omega]N", "/", "g\[Omega]"}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"FVectorMeson", "[", 
      RowBox[{"q2_", ",", "mV_", ",", "\[CapitalGamma]V_"}], "]"}], "=", 
     RowBox[{"-", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["mV", "2"], "/", 
        RowBox[{"(", 
         RowBox[{"q2", "-", 
          SuperscriptBox["mV", "2"], "+", 
          RowBox[{"I", "*", "\[CapitalGamma]V", "*", "mV"}]}], ")"}]}], 
       ")"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"FormFactorBremBL3\[Omega]Temp", "[", 
      RowBox[{
      "q2_", ",", "m\[Omega]780_", ",", "m\[Omega]1420_", ",", 
       "m\[Omega]1650_", ",", "\[CapitalGamma]\[Omega]780_", ",", 
       "\[CapitalGamma]\[Omega]1420_", ",", "\[CapitalGamma]\[Omega]1650_"}], 
      "]"}], "=", 
     RowBox[{
      RowBox[{"G\[Omega]", "*", 
       RowBox[{"FVectorMeson", "[", 
        RowBox[{
        "q2", ",", "m\[Omega]780", ",", "\[CapitalGamma]\[Omega]780"}], 
        "]"}]}], "+", 
      RowBox[{"G\[Omega]1420", "*", 
       RowBox[{"FVectorMeson", "[", 
        RowBox[{
        "q2", ",", "m\[Omega]1420", ",", "\[CapitalGamma]\[Omega]1420"}], 
        "]"}]}], "+", 
      RowBox[{"G\[Omega]1650", "*", 
       RowBox[{"FVectorMeson", "[", 
        RowBox[{
        "q2", ",", "m\[Omega]1650", ",", "\[CapitalGamma]\[Omega]1650"}], 
        "]"}]}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"EquationsBL3\[Omega]", "[", 
      RowBox[{"m\[Omega]780_", ",", "m\[Omega]1420_", ",", "m\[Omega]1650_"}],
       "]"}], ":=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"Limit", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"FormFactorBremBL3\[Omega]Temp", "[", 
             RowBox[{
              RowBox[{"-", "q2"}], ",", "m\[Omega]780", ",", "m\[Omega]1420", 
              ",", "m\[Omega]1650", ",", "Gamma\[Omega]780", ",", 
              "Gamma\[Omega]1420", ",", "Gamma\[Omega]1650"}], "]"}], "q2"}], 
           ",", 
           RowBox[{"q2", "\[Rule]", "Infinity"}]}], "]"}], ")"}], "\[Equal]", 
        "0"}], "&&", 
       RowBox[{
        RowBox[{"FormFactorBremBL3\[Omega]Temp", "[", 
         RowBox[{
         "0", ",", "m\[Omega]780", ",", "m\[Omega]1420", ",", "m\[Omega]1650",
           ",", "Gamma\[Omega]780", ",", "Gamma\[Omega]1420", ",", 
          "Gamma\[Omega]1650"}], "]"}], "\[Equal]", "1"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"solFormBL3\[Omega]", "=", 
     RowBox[{
      RowBox[{"Solve", "[", 
       RowBox[{
        RowBox[{"EquationsBL3\[Omega]", "[", 
         RowBox[{"M\[Omega]780", ",", "M\[Omega]1420", ",", "M\[Omega]1650"}],
          "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"G\[Omega]1420", ",", "G\[Omega]1650"}], "}"}]}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"FormFactorSquaredBrem", "[", 
        RowBox[{"q_", ",", "LLP"}], "]"}], "=", 
       SuperscriptBox[
        RowBox[{"Abs", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"FormFactorBremBL3\[Omega]Temp", "[", 
            RowBox[{
             SuperscriptBox["q", "2"], ",", "M\[Omega]780", ",", 
             "M\[Omega]1420", ",", "M\[Omega]1650", ",", "Gamma\[Omega]780", 
             ",", "Gamma\[Omega]1420", ",", "Gamma\[Omega]1650"}], "]"}], "/.", 
           RowBox[{"{", 
            RowBox[{"G\[Omega]1420", "\[Rule]", 
             RowBox[{"(", 
              RowBox[{"G\[Omega]1420", "/.", "solFormBL3\[Omega]"}], ")"}]}], 
            "}"}]}], "/.", 
          RowBox[{"{", 
           RowBox[{"G\[Omega]1650", "\[Rule]", 
            RowBox[{"(", 
             RowBox[{"G\[Omega]1650", "/.", "solFormBL3\[Omega]"}], ")"}]}], 
           "}"}]}], "]"}], "2"]}], ",", 
      RowBox[{"{", 
       RowBox[{"LLP", ",", "BLlist"}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"LogPlot", "[", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"FormFactorBremBL", "[", "mV", "]"}], "2"], ",", 
      RowBox[{"{", 
       RowBox[{"mV", ",", "0.0", ",", "5"}], "}"}], ",", 
      RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
      RowBox[{"Frame", "\[Rule]", "True"}], ",", 
      RowBox[{"ImageSize", "\[Rule]", "Large"}]}], "]"}], "*)"}]}]}]], "Input",
 CellChangeTimes->{{3.9341000518026447`*^9, 3.9341001147097645`*^9}, {
  3.940436231410433*^9, 3.940436232716921*^9}},
 CellLabel->
  "In[116]:=",ExpressionUUID->"c981cd8e-27ee-4142-9818-5ca94fdf6451"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["ALPs", "Subsection",
 CellChangeTimes->{{3.945234784029583*^9, 
  3.9452347844193*^9}},ExpressionUUID->"0fa7f26b-61d8-8f48-9d5d-bfee39a54816"],

Cell[BoxData[
 RowBox[{"Do", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"The", " ", "low"}], "-", 
       RowBox[{
       "momentum", " ", "transfer", " ", "coupling", " ", "of", " ", "ALPs", 
        " ", "to", " ", "the", " ", 
        RowBox[{"nucleons", ".", " ", "Produced"}], " ", "by", " ", "the", 
        " ", "notebook", " ", "ALP"}], "-", "phenomenology"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"gppA", "[", 
        RowBox[{"mLLP_", ",", "model"}], "]"}], "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Import", "[", 
          RowBox[{
           RowBox[{"FileNameJoin", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"NotebookDirectory", "[", "]"}], "//", 
                "ParentDirectory"}], "//", "ParentDirectory"}], ",", 
              "\"\<phenomenology\>\"", ",", "model", ",", 
              "\"\<production probabilities\>\"", ",", 
              RowBox[{
              "\"\<Coefficients-\>\"", "<>", "model", "<>", 
               "\"\<-Lambda=1.-TeV.mx\>\""}]}], "}"}], "]"}], ",", 
           "\"\<MX\>\""}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"-", "1"}], "]"}], "]"}], "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
        "Phenomenological", " ", "form", " ", "factor", " ", "from", " ", 
         RowBox[{"2112.09814", ".", " ", "To"}], " ", "simplify", " ", 
         "using", " ", "the", " ", "routines", " ", "below"}], ",", " ", 
        RowBox[{
         RowBox[{
         "I", " ", "simply", " ", "multiply", " ", "the", " ", "form"}], "-", 
         RowBox[{"factor", " ", "and", " ", "the", " ", "coupling"}]}]}], 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"FormFactorSquaredBrem", "[", 
        RowBox[{"mS_", ",", "model"}], "]"}], "=", 
       RowBox[{"Abs", "[", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"gppA", "[", 
           RowBox[{"mS", ",", "model"}], "]"}], "2"], "*", 
         RowBox[{"With", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"\[Gamma]", "=", "0.515"}], ",", 
             RowBox[{"\[Delta]", "=", "0.397"}], ",", 
             RowBox[{"\[CapitalGamma]a1", "=", "0.4"}], ",", 
             RowBox[{"ma1", "=", "1.36"}], ",", 
             RowBox[{"\[Alpha]", "=", "0.95"}]}], "}"}], ",", 
           RowBox[{
            RowBox[{
             SuperscriptBox[
              RowBox[{"Abs", "[", 
               RowBox[{
                FractionBox["1", 
                 RowBox[{"(", 
                  RowBox[{"1", "-", 
                   RowBox[{"\[Gamma]", "*", 
                    RowBox[{"Exp", "[", 
                    RowBox[{"I", "*", "\[Delta]"}], "]"}], "*", 
                    SuperscriptBox["mS", "2"]}]}], ")"}]], "*", 
                RowBox[{"(", 
                 RowBox[{"1", "-", "\[Alpha]", "+", 
                  RowBox[{"\[Alpha]", "*", 
                   FractionBox[
                    RowBox[{
                    SuperscriptBox["ma1", "2"], 
                    RowBox[{"(", 
                    RowBox[{
                    SuperscriptBox["ma1", "2"], "-", 
                    SuperscriptBox["mS", "2"], "-", 
                    RowBox[{"I", "*", "ma1", "*", "\[CapitalGamma]a1"}]}], 
                    ")"}]}], 
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    SuperscriptBox["ma1", "2"], "-", 
                    SuperscriptBox["mS", "2"]}], ")"}], "2"], "+", 
                    RowBox[{
                    SuperscriptBox["ma1", "2"], "*", 
                    SuperscriptBox["\[CapitalGamma]a1", "2"]}]}]]}]}], 
                 ")"}]}], "]"}], "2"], "//", "ComplexExpand"}], "//", 
            "Simplify"}]}], "]"}]}], "]"}]}], ";"}]}], "\[IndentingNewLine]", 
    "]"}], "\[IndentingNewLine]", ",", 
   RowBox[{"{", 
    RowBox[{"model", ",", 
     RowBox[{"{", 
      RowBox[{"\"\<ALP-fermion\>\"", ",", "\"\<ALP-gluon\>\""}], "}"}]}], 
    "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.9452371620927753`*^9, 3.945237438528696*^9}, {
  3.94524171995652*^9, 3.945241730294674*^9}, {3.949372861988703*^9, 
  3.9493728647961674`*^9}, {3.950610079176628*^9, 3.950610172343004*^9}, {
  3.9506103061202374`*^9, 3.950610334595196*^9}, {3.950610419779852*^9, 
  3.95061049901618*^9}},
 CellLabel->
  "In[183]:=",ExpressionUUID->"ba8a0b50-7127-7e4d-b7fb-7f1afe4b824c"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Kinematics, angle-energy grid for the tabulation", "Section",
 CellChangeTimes->{{3.917161638423164*^9, 3.9171616465026054`*^9}, {
   3.9171617141090364`*^9, 3.9171617164457235`*^9}, {3.9171642070781965`*^9, 
   3.9171642140051765`*^9}, {3.9340929800710807`*^9, 
   3.9340929813407345`*^9}, {3.934093279118565*^9, 3.934093279338272*^9}, 
   3.93409981392787*^9},
 CellTags->
  "Evaluation",ExpressionUUID->"c8a9d46c-87cc-40ca-ae2b-5292a9d7b606"],

Cell[CellGroupData[{

Cell["Kinematics (approach-independent)", "Subsection",
 CellChangeTimes->{{3.9340933625312176`*^9, 
  3.9340933956520376`*^9}},ExpressionUUID->"cf56f7c4-1182-457e-8129-\
050202667f03"],

Cell[CellGroupData[{

Cell["Quasi-real approximation", "Subsubsection",
 CellChangeTimes->{{3.9340985478321457`*^9, 
  3.934098552102063*^9}},ExpressionUUID->"b6885f34-afa9-448a-b0dd-\
015c3b2850fb"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"EpApprox", "=", 
   RowBox[{"Pp", "+", 
    FractionBox[
     SuperscriptBox["mp", "2"], 
     RowBox[{"2", "*", "Pp"}]]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"EpprimeApprox", "=", 
   RowBox[{
    RowBox[{"Pp", "*", 
     RowBox[{"(", 
      RowBox[{"1", "-", "z"}], ")"}]}], "+", 
    FractionBox[
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["mp", "2"], "+", 
       SuperscriptBox["pT", "2"]}], ")"}], 
     RowBox[{"2", "*", "Pp", 
      RowBox[{"(", 
       RowBox[{"1", "-", "z"}], ")"}]}]]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ppApprox", "=", "Pp"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ppprimeApprox", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "-", "z"}], ")"}], "*", "Pp"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"EVvApprox", "=", 
   RowBox[{
    RowBox[{"Pp", "*", "z"}], "+", 
    FractionBox[
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["pT", "2"], "+", 
       SuperscriptBox["mX", "2"]}], ")"}], 
     RowBox[{"2", "*", "Pp", "*", "z"}]]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"pVvApprox", "=", 
    RowBox[{"ppApprox", "-", "ppprimeApprox"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Scalar", " ", "products"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"EpExpr", "=", 
   SqrtBox[
    RowBox[{
     SuperscriptBox["Pp", "2"], "+", 
     SuperscriptBox["mp", "2"]}]]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"EpApprox", "=", 
   RowBox[{"Refine", "[", 
    RowBox[{
     RowBox[{"Normal", "@", 
      RowBox[{"Series", "[", 
       RowBox[{"EpExpr", ",", 
        RowBox[{"{", 
         RowBox[{"mp", ",", "0", ",", "2"}], "}"}]}], "]"}]}], ",", 
     RowBox[{"Pp", ">", "0"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Epprime", "=", 
   SqrtBox[
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"Pp", 
        RowBox[{"(", 
         RowBox[{"1", "-", "z"}], ")"}]}], ")"}], "2"], "+", 
     SuperscriptBox["mp", "2"], "+", 
     SuperscriptBox["pT", "2"]}]]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", "\"\<Energy of the virtual proton:\>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"EpprimeApprox", "=", 
   RowBox[{"Refine", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"Epprime", "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"pT", "->", "0"}], ",", 
          RowBox[{"mp", "->", "0"}]}], "}"}]}], ")"}], "+", 
      RowBox[{
       FractionBox[
        SuperscriptBox["mp", "2"], "2"], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"D", "[", 
          RowBox[{"Epprime", ",", "mp", ",", "mp"}], "]"}], "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"mp", "->", "0"}], ",", 
           RowBox[{"pT", "->", "0"}]}], "}"}]}], ")"}]}], "+", 
      RowBox[{
       FractionBox[
        SuperscriptBox["pT", "2"], "2"], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"D", "[", 
          RowBox[{"Epprime", ",", "pT", ",", "pT"}], "]"}], "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"mp", "->", "0"}], ",", 
           RowBox[{"pT", "->", "0"}]}], "}"}]}], ")"}]}]}], ",", 
     RowBox[{
      RowBox[{"Pp", ">", "0"}], "&&", 
      RowBox[{"0", "<", "z", "<", "1"}]}]}], "]"}]}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"3", "-", 
    RowBox[{
    "vectors", " ", "of", " ", "the", " ", "incoming", " ", "and", " ", 
     "virtual", " ", "protons"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ppApprox", "=", 
   RowBox[{"{", 
    RowBox[{"0", ",", "Pp"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ppprimeApprox", "=", 
   RowBox[{"{", 
    RowBox[{"pT", ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "z"}], ")"}], "*", "Pp"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"EVexpr", "=", 
   SqrtBox[
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"Pp", "*", "z"}], ")"}], "2"], "+", 
     SuperscriptBox["pT", "2"], "+", 
     SuperscriptBox["mX", "2"]}]]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", "\"\<Energy of the outgoing mediator\>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"EVvApprox", "=", 
   RowBox[{"Refine", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"EVexpr", "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"pT", "->", "0"}], ",", 
          RowBox[{"mX", "->", "0"}]}], "}"}]}], ")"}], "+", 
      RowBox[{
       FractionBox[
        SuperscriptBox["mX", "2"], "2"], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"D", "[", 
          RowBox[{"EVexpr", ",", "mX", ",", "mX"}], "]"}], "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"mX", "->", "0"}], ",", 
           RowBox[{"pT", "->", "0"}]}], "}"}]}], ")"}]}], "+", 
      RowBox[{
       FractionBox[
        SuperscriptBox["pT", "2"], "2"], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"D", "[", 
          RowBox[{"EVexpr", ",", "pT", ",", "pT"}], "]"}], "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"mX", "->", "0"}], ",", 
           RowBox[{"pT", "->", "0"}]}], "}"}]}], ")"}]}]}], ",", 
     RowBox[{
      RowBox[{"Pp", ">", "0"}], "&&", 
      RowBox[{"z", ">", "0"}]}]}], "]"}]}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"3", "-", 
    RowBox[{"vector", " ", "of", " ", "the", " ", "outgoing", " ", "X"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"pVvApprox", "=", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"ppApprox", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "-", 
        RowBox[{"ppprimeApprox", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ",", 
       RowBox[{
        RowBox[{"ppApprox", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "-", 
        RowBox[{"ppprimeApprox", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}], "//", "Simplify"}]}], 
   ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"This", " ", "factor", " ", "must", " ", "be", " ", 
    RowBox[{"<<", " ", "1"}], " ", "in", " ", "order", " ", "to", " ", "drop",
     " ", "the", " ", "forward", " ", 
    RowBox[{"diagram", ":"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[CapitalDelta]EdominateDiagram", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"EpprimeApprox", "+", "EVvApprox", "-", "EpApprox"}], ")"}], "//",
     "Simplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Hfactor", "[", 
    RowBox[{"z_", ",", "pT_", ",", "mp_", ",", "mX_"}], "]"}], "=", 
   RowBox[{
    RowBox[{"2", "*", "Pp", "*", "z", 
     RowBox[{"(", 
      RowBox[{"1", "-", "z"}], ")"}], "*", 
     "\[CapitalDelta]EdominateDiagram"}], "//", "Simplify"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"pTsolH", "[", "H_", "]"}], "=", 
   SqrtBox[
    RowBox[{"pT2", "/.", 
     RowBox[{
      RowBox[{"Solve", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Hfactor", "[", 
            RowBox[{"z", ",", "pT", ",", "mp", ",", "mX"}], "]"}], "/.", 
           RowBox[{"{", 
            RowBox[{"pT", "->", 
             SqrtBox["pT2"]}], "}"}]}], ")"}], "==", "H"}], ",", "pT2"}], 
       "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}]}]]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ApplicabilityParameter", "[", 
    RowBox[{"z_", ",", "pT_", ",", "mX_", ",", "Pp_", ",", "mp_"}], "]"}], 
   "=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Refine", "[", 
        RowBox[{
         RowBox[{"Simplify", "[", 
          FractionBox["\[CapitalDelta]EdominateDiagram", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"EpprimeApprox", "-", "EVvApprox", "+", "EpApprox"}], 
              ")"}], "/.", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"pT", "\[Rule]", "0"}], ",", 
               RowBox[{"mp", "\[Rule]", "0"}], ",", 
               RowBox[{"mX", "\[Rule]", "0"}]}], "}"}]}], ")"}]], "]"}], ",", 
         RowBox[{
          RowBox[{"Pp", ">", "0"}], "&&", 
          RowBox[{"0", "<", "z", "<", "1"}]}]}], "]"}], "//", "Expand"}], 
      ")"}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        SuperscriptBox["mp", "2"], 
        SuperscriptBox["pT", "2"]}], "->", "0"}], "}"}]}], "//", 
    "Simplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"zMinBrem", "[", "\"\<FermilabBD\>\"", "]"}], ",", 
     RowBox[{"zMinBrem", "[", "\"\<SPS\>\"", "]"}], ",", 
     RowBox[{"zMinBrem", "[", "\"\<LHC\>\"", "]"}], ",", 
     RowBox[{"zMinBrem", "[", "\"\<FCC-hh\>\"", "]"}], ",", 
     RowBox[{"zMinBrem", "[", "\"\<Serpukhov\>\"", "]"}], ",", 
     RowBox[{"zMinBrem", "[", "\"\<ESS\>\"", "]"}]}], "}"}], "=", 
   RowBox[{"{", 
    RowBox[{
    "0.1", ",", "0.1", ",", "0.005", ",", "0.001", ",", "0.1", ",", "0.4"}], 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"zMaxBrem", "[", "\"\<FermilabBD\>\"", "]"}], ",", 
     RowBox[{"zMaxBrem", "[", "\"\<SPS\>\"", "]"}], ",", 
     RowBox[{"zMaxBrem", "[", "\"\<LHC\>\"", "]"}], ",", 
     RowBox[{"zMaxBrem", "[", "\"\<FCC-hh\>\"", "]"}], ",", 
     RowBox[{"zMaxBrem", "[", "\"\<Serpukhov\>\"", "]"}], ",", 
     RowBox[{"zMaxBrem", "[", "\"\<ESS\>\"", "]"}]}], "}"}], "=", 
   RowBox[{"{", 
    RowBox[{
    "0.9", ",", "0.95", ",", "0.99", ",", "0.99", ",", "0.9", ",", "0.6"}], 
    "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.934098567382298*^9, 3.9340985960735703`*^9}, 
   3.9341203023007107`*^9, {3.9341207097180843`*^9, 3.9341207418480606`*^9}, {
   3.9345928016827807`*^9, 3.9345928233805876`*^9}},
 CellLabel->
  "In[147]:=",ExpressionUUID->"9a54d833-55ba-4682-87ac-8ce520e03537"],

Cell[BoxData[
 FormBox["\<\"Energy of the virtual proton:\"\>", TraditionalForm]], "Print",
 CellChangeTimes->{{3.9340985572370195`*^9, 3.934098596536895*^9}, {
   3.9341202788571596`*^9, 3.9341203027262106`*^9}, 3.9341207420599504`*^9, 
   3.9341292813519955`*^9, 3.9341340469079905`*^9, 3.9342181375625267`*^9, 
   3.9346979468917418`*^9, 3.935130778479252*^9, 3.9351310780370874`*^9, 
   3.935517026593363*^9, 3.9505867990549736`*^9},
 CellLabel->
  "During evaluation of \
In[147]:=",ExpressionUUID->"59cca136-5a4f-e24e-b4f3-37287225db5f"],

Cell[BoxData[
 FormBox[
  RowBox[{
   FractionBox[
    SuperscriptBox["mp", "2"], 
    RowBox[{"2", " ", "Pp", " ", 
     RowBox[{"(", 
      RowBox[{"1", "-", "z"}], ")"}]}]], "+", 
   FractionBox[
    SuperscriptBox["pT", "2"], 
    RowBox[{"2", " ", "Pp", " ", 
     RowBox[{"(", 
      RowBox[{"1", "-", "z"}], ")"}]}]], "+", 
   RowBox[{"Pp", " ", 
    RowBox[{"(", 
     RowBox[{"1", "-", "z"}], ")"}]}]}], TraditionalForm]], "Output",
 CellChangeTimes->{{3.934098557242416*^9, 3.934098596545083*^9}, {
   3.9341202788656216`*^9, 3.93412030273619*^9}, 3.9341207420682592`*^9, 
   3.9341292813579955`*^9, 3.934134046914523*^9, 3.9342181375742683`*^9, 
   3.934697946899516*^9, 3.9351307784862556`*^9, 3.9351310780420885`*^9, 
   3.9355170266073675`*^9, 3.9505867990836296`*^9},
 CellLabel->
  "Out[157]=",ExpressionUUID->"c9c0bc09-92d4-b141-971f-397f06489ef2"],

Cell[BoxData[
 FormBox["\<\"Energy of the outgoing mediator\"\>", TraditionalForm]], "Print",
 CellChangeTimes->{{3.9340985572370195`*^9, 3.934098596536895*^9}, {
   3.9341202788571596`*^9, 3.9341203027262106`*^9}, 3.9341207420599504`*^9, 
   3.9341292813519955`*^9, 3.9341340469079905`*^9, 3.9342181375625267`*^9, 
   3.9346979468917418`*^9, 3.935130778479252*^9, 3.9351310780370874`*^9, 
   3.935517026593363*^9, 3.9505867990909176`*^9},
 CellLabel->
  "During evaluation of \
In[147]:=",ExpressionUUID->"0fac8e9d-9013-3e44-93c0-d3732bc89387"],

Cell[BoxData[
 FormBox[
  RowBox[{
   FractionBox[
    SuperscriptBox["mX", "2"], 
    RowBox[{"2", " ", "Pp", " ", "z"}]], "+", 
   FractionBox[
    SuperscriptBox["pT", "2"], 
    RowBox[{"2", " ", "Pp", " ", "z"}]], "+", 
   RowBox[{"Pp", " ", "z"}]}], TraditionalForm]], "Output",
 CellChangeTimes->{{3.934098557242416*^9, 3.934098596545083*^9}, {
   3.9341202788656216`*^9, 3.93412030273619*^9}, 3.9341207420682592`*^9, 
   3.9341292813579955`*^9, 3.934134046914523*^9, 3.9342181375742683`*^9, 
   3.934697946899516*^9, 3.9351307784862556`*^9, 3.9351310780420885`*^9, 
   3.9355170266073675`*^9, 3.9505867990934887`*^9},
 CellLabel->
  "Out[162]=",ExpressionUUID->"3cb67271-1e72-8a49-b98d-b0266397af48"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Scalar products", "Item",
 CellChangeTimes->{{3.9340987053878217`*^9, 
  3.9340987072830696`*^9}},ExpressionUUID->"3caa2ce0-b9ec-41f2-9031-\
e274a853916a"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Various", " ", "scalar", " ", "products"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"ppToppprimeApprox", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"EpApprox", "*", "EpprimeApprox"}], "-", 
       RowBox[{
        RowBox[{"ppApprox", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "*", 
        RowBox[{"ppprimeApprox", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], "-", 
       RowBox[{
        RowBox[{"ppApprox", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "*", 
        RowBox[{"ppprimeApprox", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}]}], "//", "Simplify"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"ppToppprimeApprox", "=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"ppToppprimeApprox", "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"mp", "->", "0"}], ",", 
         RowBox[{"mX", "->", "0"}], ",", 
         RowBox[{"pT", "->", "0"}]}], "}"}]}], ")"}], "+", 
     RowBox[{
      FractionBox[
       SuperscriptBox["mp", "2"], "2"], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{"ppToppprimeApprox", ",", "mp", ",", "mp"}], "]"}], "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"mp", "->", "0"}], ",", 
          RowBox[{"mX", "->", "0"}], ",", 
          RowBox[{"pT", "->", "0"}]}], "}"}]}], ")"}]}], "+", 
     RowBox[{
      FractionBox[
       SuperscriptBox["pT", "2"], "2"], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{"ppToppprimeApprox", ",", "pT", ",", "pT"}], "]"}], "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"mp", "->", "0"}], ",", 
          RowBox[{"mX", "->", "0"}], ",", 
          RowBox[{"pT", "->", "0"}]}], "}"}]}], ")"}]}], "+", 
     RowBox[{
      FractionBox[
       SuperscriptBox["mX", "2"], "2"], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{"ppToppprimeApprox", ",", "mX", ",", "mX"}], "]"}], "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"mp", "->", "0"}], ",", 
          RowBox[{"mX", "->", "0"}], ",", 
          RowBox[{"pT", "->", "0"}]}], "}"}]}], ")"}]}]}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ppTopVApprox", "=", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"EpApprox", "*", "EVvApprox"}], "-", 
        RowBox[{
         RowBox[{"ppApprox", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "*", 
         RowBox[{"pVvApprox", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], "-", 
        RowBox[{
         RowBox[{"ppApprox", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "*", 
         RowBox[{"pVvApprox", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}]}], "//", "Simplify"}], ")"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{"ppTopVApprox", "=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"ppTopVApprox", "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"mp", "->", "0"}], ",", 
         RowBox[{"mX", "->", "0"}], ",", 
         RowBox[{"pT", "->", "0"}]}], "}"}]}], ")"}], "+", 
     RowBox[{
      FractionBox[
       SuperscriptBox["mp", "2"], "2"], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{"ppTopVApprox", ",", "mp", ",", "mp"}], "]"}], "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"mp", "->", "0"}], ",", 
          RowBox[{"mX", "->", "0"}], ",", 
          RowBox[{"pT", "->", "0"}]}], "}"}]}], ")"}]}], "+", 
     RowBox[{
      FractionBox[
       SuperscriptBox["pT", "2"], "2"], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{"ppTopVApprox", ",", "pT", ",", "pT"}], "]"}], "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"mp", "->", "0"}], ",", 
          RowBox[{"mX", "->", "0"}], ",", 
          RowBox[{"pT", "->", "0"}]}], "}"}]}], ")"}]}], "+", 
     RowBox[{
      FractionBox[
       SuperscriptBox["mX", "2"], "2"], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{"ppTopVApprox", ",", "mX", ",", "mX"}], "]"}], "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"mp", "->", "0"}], ",", 
          RowBox[{"mX", "->", "0"}], ",", 
          RowBox[{"pT", "->", "0"}]}], "}"}]}], ")"}]}]}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"pVToppprimeApprox", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"EpprimeApprox", "*", "EVvApprox"}], "-", 
         RowBox[{
          RowBox[{"ppprimeApprox", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "*", 
          RowBox[{"pVvApprox", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], "-", 
         RowBox[{
          RowBox[{"ppprimeApprox", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "*", 
          RowBox[{"pVvApprox", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}]}], ")"}], "//", "Expand"}], "//", 
      "Simplify"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"pVToppprimeApprox", "=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"pVToppprimeApprox", "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"mp", "->", "0"}], ",", 
         RowBox[{"mX", "->", "0"}], ",", 
         RowBox[{"pT", "->", "0"}]}], "}"}]}], ")"}], "+", 
     RowBox[{
      FractionBox[
       SuperscriptBox["mp", "2"], "2"], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{"pVToppprimeApprox", ",", "mp", ",", "mp"}], "]"}], "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"mp", "->", "0"}], ",", 
          RowBox[{"mX", "->", "0"}], ",", 
          RowBox[{"pT", "->", "0"}]}], "}"}]}], ")"}]}], "+", 
     RowBox[{
      FractionBox[
       SuperscriptBox["pT", "2"], "2"], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{"pVToppprimeApprox", ",", "pT", ",", "pT"}], "]"}], "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"mp", "->", "0"}], ",", 
          RowBox[{"mX", "->", "0"}], ",", 
          RowBox[{"pT", "->", "0"}]}], "}"}]}], ")"}]}], "+", 
     RowBox[{
      FractionBox[
       SuperscriptBox["mX", "2"], "2"], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{"pVToppprimeApprox", ",", "mX", ",", "mX"}], "]"}], "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"mp", "->", "0"}], ",", 
          RowBox[{"mX", "->", "0"}], ",", 
          RowBox[{"pT", "->", "0"}]}], "}"}]}], ")"}]}]}]}]}]}]], "Input",
 CellChangeTimes->{{3.92704046755252*^9, 3.9270405190109673`*^9}, {
  3.927043761074517*^9, 3.9270437633948565`*^9}, {3.92704381096634*^9, 
  3.9270438846198473`*^9}},
 CellLabel->
  "In[170]:=",ExpressionUUID->"eea95df7-add6-4def-b6de-50a4ed1fd110"],

Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{"-", 
    FractionBox[
     RowBox[{
      SuperscriptBox["mp", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["z", "2"], "-", 
        RowBox[{"2", " ", "z"}], "+", "2"}], ")"}]}], 
     RowBox[{"2", " ", 
      RowBox[{"(", 
       RowBox[{"z", "-", "1"}], ")"}]}]]}], "-", 
   FractionBox[
    SuperscriptBox["pT", "2"], 
    RowBox[{"2", " ", 
     RowBox[{"(", 
      RowBox[{"z", "-", "1"}], ")"}]}]]}], TraditionalForm]], "Output",
 CellChangeTimes->{{3.9270404633484526`*^9, 3.927040520217839*^9}, 
   3.927041016963621*^9, 3.927041488785869*^9, 3.9270438446428657`*^9, 
   3.9270438865660324`*^9, 3.930465114813795*^9, 3.93409871212738*^9, 
   3.9341202789053116`*^9, 3.9341292814185696`*^9, 3.934134046949774*^9, 
   3.934218137602928*^9, 3.9346979469412622`*^9, 3.935130778562275*^9, 
   3.935131078092616*^9, 3.9355170267013927`*^9, 3.9505867993255634`*^9},
 CellLabel->
  "Out[171]=",ExpressionUUID->"53703840-0dc3-4a4e-8cf2-7ecea8b98b8f"],

Cell[BoxData[
 FormBox[
  RowBox[{
   FractionBox[
    RowBox[{
     SuperscriptBox["mp", "2"], " ", "z"}], "2"], "+", 
   FractionBox[
    SuperscriptBox["mX", "2"], 
    RowBox[{"2", " ", "z"}]], "+", 
   FractionBox[
    SuperscriptBox["pT", "2"], 
    RowBox[{"2", " ", "z"}]]}], TraditionalForm]], "Output",
 CellChangeTimes->{{3.9270404633484526`*^9, 3.927040520217839*^9}, 
   3.927041016963621*^9, 3.927041488785869*^9, 3.9270438446428657`*^9, 
   3.9270438865660324`*^9, 3.930465114813795*^9, 3.93409871212738*^9, 
   3.9341202789053116`*^9, 3.9341292814185696`*^9, 3.934134046949774*^9, 
   3.934218137602928*^9, 3.9346979469412622`*^9, 3.935130778562275*^9, 
   3.935131078092616*^9, 3.9355170267013927`*^9, 3.9505867993691483`*^9},
 CellLabel->
  "Out[173]=",ExpressionUUID->"b3abc0ab-5926-f446-ab61-1055aa1d394c"],

Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{"-", 
    FractionBox[
     RowBox[{
      SuperscriptBox["mp", "2"], " ", "z"}], 
     RowBox[{"2", " ", 
      RowBox[{"(", 
       RowBox[{"z", "-", "1"}], ")"}]}]]}], "-", 
   FractionBox[
    RowBox[{
     SuperscriptBox["mX", "2"], " ", 
     RowBox[{"(", 
      RowBox[{"z", "-", "1"}], ")"}]}], 
    RowBox[{"2", " ", "z"}]], "-", 
   FractionBox[
    SuperscriptBox["pT", "2"], 
    RowBox[{"2", " ", 
     RowBox[{"(", 
      RowBox[{"z", "-", "1"}], ")"}], " ", "z"}]]}], 
  TraditionalForm]], "Output",
 CellChangeTimes->{{3.9270404633484526`*^9, 3.927040520217839*^9}, 
   3.927041016963621*^9, 3.927041488785869*^9, 3.9270438446428657`*^9, 
   3.9270438865660324`*^9, 3.930465114813795*^9, 3.93409871212738*^9, 
   3.9341202789053116`*^9, 3.9341292814185696`*^9, 3.934134046949774*^9, 
   3.934218137602928*^9, 3.9346979469412622`*^9, 3.935130778562275*^9, 
   3.935131078092616*^9, 3.9355170267013927`*^9, 3.950586799471548*^9},
 CellLabel->
  "Out[175]=",ExpressionUUID->"9443937f-7bcb-2344-b478-98327e8e1b0d"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Jacobians", "Subsubsection",
 CellChangeTimes->{{3.9340986116542873`*^9, 
  3.934098612819727*^9}},ExpressionUUID->"d3e2e84b-1105-4428-8dc0-\
b8b671032673"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    SubscriptBox["p", "T"], ",", 
    RowBox[{"z", " ", "\[Rule]", " ", 
     SubscriptBox["\[Theta]", "V"]}], ",", 
    SubscriptBox["E", "V"]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"pTv", "[", 
      RowBox[{"mV_", ",", "EV_", ",", "\[Theta]_"}], "]"}], "=", 
     RowBox[{
      SqrtBox[
       RowBox[{
        SuperscriptBox["EV", "2"], "-", 
        SuperscriptBox["mV", "2"]}]], "*", 
      RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"zvp", "[", 
      RowBox[{"EV_", ",", "pBeam_"}], "]"}], "=", 
     FractionBox["EV", "pBeam"]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Jacobian", " ", 
      SubscriptBox["p", "T"]}], ",", 
     RowBox[{"z", "->", "\[Theta]"}], ",", "E"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"JacobianpTzToEV\[Theta]", "[", 
      RowBox[{"mV_", ",", "EV_", ",", "pBeam_", ",", "\[Theta]_"}], "]"}], 
     "=", 
     RowBox[{"-", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{"pTv", "[", 
            RowBox[{"mV", ",", "EV", ",", "\[Theta]"}], "]"}], ",", "EV"}], 
          "]"}], "*", 
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{"zvp", "[", 
            RowBox[{"EV", ",", "pBeam"}], "]"}], ",", "\[Theta]"}], "]"}]}], 
        "-", 
        RowBox[{
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{"pTv", "[", 
            RowBox[{"mV", ",", "EV", ",", "\[Theta]"}], "]"}], ",", 
           "\[Theta]"}], "]"}], "*", 
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{"zvp", "[", 
            RowBox[{"EV", ",", "pBeam"}], "]"}], ",", "EV"}], "]"}]}]}], 
       ")"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"KinematicsApplicabilityzpT", "[", 
      RowBox[{"mV_", ",", "z_", ",", "pT_", ",", "pBeam_"}], "]"}], "=", 
     RowBox[{"UnitStep", "[", 
      RowBox[{"0.1", "-", 
       RowBox[{"ApplicabilityParameter", "[", 
        RowBox[{"z", ",", "pT", ",", "mV", ",", "pBeam", ",", 
         RowBox[{"mSM", "[", "\"\<p\>\"", "]"}]}], "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"KinematicsApplicability\[Theta]E", "[", 
      RowBox[{"mV_", ",", "\[Theta]V_", ",", "EV_", ",", "pBeam_"}], "]"}], 
     "=", 
     RowBox[{"UnitStep", "[", 
      RowBox[{"0.1", "-", 
       RowBox[{"ApplicabilityParameter", "[", 
        RowBox[{
         RowBox[{"zvp", "[", 
          RowBox[{"EV", ",", "pBeam"}], "]"}], ",", 
         RowBox[{"pTv", "[", 
          RowBox[{"mV", ",", "EV", ",", "\[Theta]V"}], "]"}], ",", "mV", ",", 
         "pBeam", ",", 
         RowBox[{"mSM", "[", "\"\<p\>\"", "]"}]}], "]"}]}], "]"}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.934093404971816*^9, 3.9340934416729803`*^9}, {
   3.934098592623455*^9, 3.934098603054162*^9}, {3.9341008126289268`*^9, 
   3.934100812710969*^9}, 3.934443669732173*^9, {3.934592826053749*^9, 
   3.9345929082111206`*^9}},
 CellLabel->
  "In[176]:=",ExpressionUUID->"350689b9-cf6c-4348-97b4-b2ae3a99294e"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Blumlein-Brunner", "Subsection",
 CellChangeTimes->{{3.9340933625312176`*^9, 3.9340934173622684`*^9}, {
   3.9341288077319846`*^9, 3.9341288113319335`*^9}, 
   3.935131064898828*^9},ExpressionUUID->"8e2de048-59db-4109-ad95-\
c24e56948c5e"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    SubscriptBox["p", 
     RowBox[{"T", ",", "max"}]], " ", "assumed", " ", "by", " ", "default", 
    " ", "in", " ", "the", " ", "Baseline", " ", "approach"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"pTmaxBrem", "[", "\"\<FermilabBD\>\"", "]"}], ",", 
       RowBox[{"pTmaxBrem", "[", "\"\<SPS\>\"", "]"}], ",", 
       RowBox[{"pTmaxBrem", "[", "\"\<LHC\>\"", "]"}], ",", 
       RowBox[{"pTmaxBrem", "[", "\"\<FCC-hh\>\"", "]"}], ",", 
       RowBox[{"pTmaxBrem", "[", "\"\<Serpukhov\>\"", "]"}], ",", 
       RowBox[{"pTmaxBrem", "[", "\"\<ESS\>\"", "]"}]}], "}"}], "=", 
     RowBox[{"{", 
      RowBox[{"1.", ",", "1.", ",", "1.", ",", "1.", ",", "1.", ",", "1."}], 
      "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Theta]listSmall", "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"i", "*", 
              SuperscriptBox["10", "j"]}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "0.2", ",", "9.8", ",", "0.1"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"j", ",", 
               RowBox[{"-", "5"}], ",", 
               RowBox[{"-", "2"}], ",", "1"}], "}"}]}], "]"}], ",", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"i", "*", 
              SuperscriptBox["10", "j"]}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "0.2", ",", "9.8", ",", "0.05"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"j", ",", 
               RowBox[{"-", "2"}], ",", 
               RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "]"}]}], "]"}], "//", 
         "Flatten"}], "//", "N"}], "//", "Sort"}], "//", 
      "DeleteDuplicates"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"EVfiltered", "[", 
     RowBox[{"data_", ",", "Facility_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"filteredData", ",", "displ", ",", "j", ",", "el"}], "}"}], 
      ",", "\n", 
      RowBox[{"(*", 
       RowBox[{
       "Initialize", " ", "the", " ", "filtered", " ", "list", " ", "with", 
        " ", "the", " ", "first", " ", "element"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"filteredData", "=", 
        RowBox[{"{", 
         RowBox[{"First", "[", "data", "]"}], "}"}]}], ";", "\n", 
       RowBox[{"(*", 
        RowBox[{
        "Iterate", " ", "over", " ", "the", " ", "list", " ", "starting", " ",
          "from", " ", "the", " ", "second", " ", "element"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"displ", "=", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"Facility", "==", "\"\<ESS\>\""}], ",", "0.05", ",", "1"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"j", "=", "1"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"el", "=", 
           RowBox[{"filteredData", "[", 
            RowBox[{"[", "j", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Abs", "[", 
              RowBox[{
               RowBox[{"data", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "-", "el"}], "]"}], ">=", 
             "displ"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"AppendTo", "[", 
              RowBox[{"filteredData", ",", 
               RowBox[{"data", "[", 
                RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"j", "+=", "1"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
          ";"}], "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "2", ",", 
           RowBox[{"Length", "[", "data", "]"}]}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", "filteredData"}]}], "\[IndentingNewLine]", 
     "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Theta]filteredList", "[", "list_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"filteredList", "=", 
        RowBox[{"{", 
         RowBox[{"First", "[", "list", "]"}], "}"}]}], "}"}], ",", 
      RowBox[{
       RowBox[{"Do", "[", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Abs", "[", 
             RowBox[{
              RowBox[{"list", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "-", 
              RowBox[{"Last", "[", "filteredList", "]"}]}], "]"}], ">=", 
            RowBox[{"10", "^", 
             RowBox[{"-", "5"}]}]}], ",", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"filteredList", ",", 
             RowBox[{"list", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "2", ",", 
           RowBox[{"Length", "[", "list", "]"}]}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", "filteredList"}]}], "]"}]}], "\n", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Finding", " ", 
      SubscriptBox["E", 
       RowBox[{"LLP", ",", "max"}]], 
      RowBox[{"(", "\[Theta]", ")"}], " ", "and", " ", "defining", " ", 
      "detailed", " ", "angle"}], "-", 
     RowBox[{
     "energy", " ", "grid", " ", "for", " ", "the", " ", "tabulations"}]}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{"Do", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"ptmax", ",", "emaxabs", ",", "eminabs"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ptmax", "=", 
         RowBox[{"pTmaxBrem", "[", "Facility", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"emaxabs", "=", 
         RowBox[{
          RowBox[{"zMaxBrem", "[", "Facility", "]"}], "*", 
          RowBox[{"EmaxFacility", "[", "Facility", "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"ELLPminBrem", "[", "Facility", "]"}], "=", 
         RowBox[{
          RowBox[{"zMinBrem", "[", "Facility", "]"}], "*", 
          RowBox[{"EmaxFacility", "[", "Facility", "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"ELLPmaxBremBaseline", "[", 
          RowBox[{"Facility", ",", "mLLP_", ",", "\[Theta]LLP_"}], "]"}], "=", 
         RowBox[{"Quiet", "[", 
          RowBox[{"Min", "[", 
           RowBox[{"emaxabs", ",", 
            RowBox[{"ELLP", "/.", 
             RowBox[{
              RowBox[{"Solve", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"pTv", "[", 
                  RowBox[{"mLLP", ",", "ELLP", ",", 
                   RowBox[{"\[Theta]LLP", "+", 
                    SuperscriptBox["10", 
                    RowBox[{"-", "7."}]]}]}], "]"}], "==", "ptmax"}], ",", 
                "ELLP"}], "]"}], "[", 
              RowBox[{"[", "2", "]"}], "]"}]}]}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Maximal", " ", "angle", " ", "for", " ", "which", " ", 
           SubscriptBox["E", "max"]}], ">", 
          SubscriptBox["E", "min"]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"\[Theta]maxBremBaseline", "[", "Facility", "]"}], "=", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"ELLPminBrem", "[", "Facility", "]"}], "<", "ptmax"}], 
           ",", "Pi", ",", 
           RowBox[{"Quiet", "[", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"\[Theta]LLP", "/.", 
               RowBox[{
                RowBox[{"Solve", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"ELLPminBrem", "[", "Facility", "]"}], "\[Equal]", 
                   FractionBox["ptmax", 
                    RowBox[{"Sin", "[", "\[Theta]LLP", "]"}]]}], ",", 
                  "\[Theta]LLP"}], "]"}], "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], "/.", 
              RowBox[{"{", 
               RowBox[{
                TemplateBox[{"1"},
                 "C"], "\[Rule]", "0"}], "}"}]}], ")"}], "]"}]}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"The", " ", "angle", " ", 
           SubscriptBox["\[Theta]", "fall"], " ", "at", " ", "which", " ", 
           SubscriptBox["E", "max"], 
           RowBox[{"(", 
            SubscriptBox["\[Theta]", "fall"], ")"}], " ", "starts", " ", 
           "being"}], " ", "<", " ", 
          RowBox[{
           SubscriptBox["z", "max"], 
           SubscriptBox["E", "p"]}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"\[Theta]EfallBaseline", "[", "Facility", "]"}], "=", 
         RowBox[{"Quiet", "[", 
          RowBox[{"\[Theta]LLP", "/.", 
           RowBox[{
            RowBox[{"Solve", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Refine", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"ELLPmaxBremBaseline", "[", 
                   RowBox[{"Facility", ",", "0", ",", "\[Theta]LLP"}], "]"}], 
                  "[", 
                  RowBox[{"[", "2", "]"}], "]"}], ",", 
                 RowBox[{"0", "<", "\[Theta]LLP", "<", 
                  FractionBox["Pi", "2"]}]}], "]"}], "==", 
               RowBox[{
                RowBox[{"zMaxBrem", "[", "Facility", "]"}], "*", 
                RowBox[{"EmaxFacility", "[", "Facility", "]"}]}]}], ",", 
              "\[Theta]LLP"}], "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "Bremsstrahlung", " ", "polar", " ", "angle", " ", "grid", " ", 
          "for", " ", "the", " ", "tabulated", " ", "distribution"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"\[Theta]gridBremTemp", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"\[Theta]EfallBaseline", "[", "Facility", "]"}], ">", 
              SuperscriptBox["10", 
               RowBox[{"-", "5."}]]}], ",", 
             RowBox[{"With", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"thmin", "=", 
                  RowBox[{"\[Theta]EfallBaseline", "[", "Facility", "]"}]}], 
                 ",", 
                 RowBox[{"thmax", "=", 
                  RowBox[{
                  "\[Theta]maxBremBaseline", "[", "Facility", "]"}]}]}], 
                "}"}], ",", 
               RowBox[{"Join", "[", 
                RowBox[{
                 RowBox[{"Select", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    SuperscriptBox["10", 
                    RowBox[{"-", "5."}]], ",", 
                    RowBox[{"3", "*", 
                    SuperscriptBox["10", 
                    RowBox[{"-", "5."}]]}], ",", 
                    RowBox[{"6", "*", 
                    SuperscriptBox["10", 
                    RowBox[{"-", "5."}]]}], ",", 
                    RowBox[{"8", "*", 
                    SuperscriptBox["10", 
                    RowBox[{"-", "5."}]]}], ",", 
                    SuperscriptBox["10", 
                    RowBox[{"-", "4."}]], ",", 
                    RowBox[{"2", "*", 
                    SuperscriptBox["10", 
                    RowBox[{"-", "4."}]]}], ",", 
                    RowBox[{"4", "*", 
                    SuperscriptBox["10", 
                    RowBox[{"-", "4."}]]}], ",", 
                    RowBox[{"6", "*", 
                    SuperscriptBox["10", 
                    RowBox[{"-", "4."}]]}], ",", 
                    RowBox[{"8", "*", 
                    SuperscriptBox["10", 
                    RowBox[{"-", "4."}]]}], ",", 
                    SuperscriptBox["10", 
                    RowBox[{"-", "3."}]], ",", 
                    RowBox[{"2", "*", 
                    SuperscriptBox["10", 
                    RowBox[{"-", "3."}]]}]}], "}"}], ",", 
                   RowBox[{
                    RowBox[{"#", "<", "thmin"}], "&"}]}], "]"}], ",", 
                 RowBox[{"Select", "[", 
                  RowBox[{"\[Theta]listSmall", ",", 
                   RowBox[{
                    RowBox[{"thmin", "<=", "#", "<", "thmax"}], "&"}]}], 
                  "]"}], ",", 
                 RowBox[{"{", "thmax", "}"}]}], "]"}]}], "]"}]}], "]"}], "//",
            "N"}], "//", "DeleteDuplicates"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"\[Theta]LLPgridBremBaseline", "[", "Facility", "]"}], "=", 
         RowBox[{"\[Theta]filteredList", "[", 
          RowBox[{"Join", "[", 
           RowBox[{"\[Theta]gridBremTemp", ",", 
            RowBox[{"Select", "[", 
             RowBox[{
              RowBox[{"\[Theta]Nlist", "[", "Facility", "]"}], ",", 
              RowBox[{
               RowBox[{"#", ">", 
                RowBox[{"Max", "[", "\[Theta]gridBremTemp", "]"}]}], "&"}]}], 
             "]"}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"ELLPgridBrem0", "[", "Facility", "]"}], "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Join", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"ELLPminBrem", "[", "Facility", "]"}], "}"}], ",", 
             RowBox[{"Select", "[", 
              RowBox[{
               RowBox[{"ENlist", "[", "Facility", "]"}], ",", 
               RowBox[{
                RowBox[{"#", ">", 
                 RowBox[{"ELLPminBrem", "[", "Facility", "]"}]}], "&"}]}], 
              "]"}], ",", " ", 
             RowBox[{
              RowBox[{
               RowBox[{"ELLPmaxBremBaseline", "[", 
                RowBox[{"Facility", ",", "0", ",", "#"}], "]"}], "&"}], "/@", 
              "\[Theta]gridBremTemp"}]}], "]"}], "//", "Sort"}], "//", 
          "DeleteDuplicates"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"ELLPgridBremBaseline", "[", "Facility", "]"}], "=", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"Select", "[", 
            RowBox[{
             RowBox[{"ENlist", "[", "Facility", "]"}], ",", 
             RowBox[{
              RowBox[{"#", "<", 
               RowBox[{"ELLPminBrem", "[", "Facility", "]"}]}], "&"}]}], 
            "]"}], ",", 
           RowBox[{"EVfiltered", "[", 
            RowBox[{
             RowBox[{"ELLPgridBrem0", "[", "Facility", "]"}], ",", 
             "Facility"}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           FractionBox[
            RowBox[{
             RowBox[{
              RowBox[{"ELLPgridBremBaseline", "[", "Facility", "]"}], "[", 
              RowBox[{"[", 
               RowBox[{"-", "1"}], "]"}], "]"}], "-", 
             RowBox[{
              RowBox[{"ELLPgridBremBaseline", "[", "Facility", "]"}], "[", 
              RowBox[{"[", 
               RowBox[{"-", "2"}], "]"}], "]"}]}], 
            RowBox[{
             RowBox[{"ELLPgridBremBaseline", "[", "Facility", "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"-", "1"}], "]"}], "]"}]], ">", "0.05"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"ELLPgridBremBaseline", "[", "Facility", "]"}], "=", 
            RowBox[{
             RowBox[{
              RowBox[{"Join", "[", 
               RowBox[{
                RowBox[{"ELLPgridBremBaseline", "[", "Facility", "]"}], ",", 
                RowBox[{"Table", "[", 
                 RowBox[{"EV", ",", 
                  RowBox[{"{", 
                   RowBox[{"EV", ",", 
                    RowBox[{"ELLPminBrem", "[", "Facility", "]"}], ",", 
                    RowBox[{
                    RowBox[{"EmaxFacility", "[", "Facility", "]"}], "*", 
                    RowBox[{"zMaxBrem", "[", "Facility", "]"}]}], ",", 
                    RowBox[{"0.04", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"EmaxFacility", "[", "Facility", "]"}], "*", 
                    RowBox[{"zMaxBrem", "[", "Facility", "]"}]}], "-", 
                    RowBox[{"ELLPminBrem", "[", "Facility", "]"}]}], 
                    ")"}]}]}], "}"}]}], "]"}]}], "]"}], "//", "Sort"}], "//", 
             "DeleteDuplicates"}]}], ";"}]}], "\[IndentingNewLine]", 
         "]"}]}]}], "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{"Facility", ",", "FacilitiesList"}], "}"}]}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.9171621836907463`*^9, 3.917162244368416*^9}, {
   3.917162299736909*^9, 3.9171624879054527`*^9}, {3.9171629389022927`*^9, 
   3.9171629390282207`*^9}, {3.9171629764748573`*^9, 3.917163007681755*^9}, {
   3.9171630981889696`*^9, 3.9171630982722263`*^9}, 3.917163182974003*^9, 
   3.9171632147908354`*^9, 3.917163691509415*^9, {3.917163808528348*^9, 
   3.9171638582876873`*^9}, {3.917163929495495*^9, 3.9171639597433043`*^9}, {
   3.9171639902655168`*^9, 3.9171639903301754`*^9}, {3.917164049379137*^9, 
   3.9171640496680045`*^9}, {3.9171641284899626`*^9, 
   3.9171641743849816`*^9}, {3.9171642630722585`*^9, 
   3.9171642631712523`*^9}, {3.917164404797939*^9, 3.917164415541307*^9}, {
   3.9174951924712653`*^9, 3.917495223733839*^9}, {3.917495277190592*^9, 
   3.9174952913190384`*^9}, {3.917496142033193*^9, 3.917496143800173*^9}, {
   3.9174962567315187`*^9, 3.917496355972249*^9}, {3.917496418745105*^9, 
   3.9174964759774055`*^9}, {3.9178598319619074`*^9, 3.917859835142969*^9}, {
   3.919012868655442*^9, 3.9190128786467123`*^9}, 3.9289899945844297`*^9, {
   3.928990607273936*^9, 3.9289906147192545`*^9}, {3.9289906452625046`*^9, 
   3.9289906497020125`*^9}, {3.9305502669891376`*^9, 3.930550270989956*^9}, {
   3.93409339243524*^9, 3.9340934693775425`*^9}, 3.934093534415986*^9, {
   3.9340986205140934`*^9, 3.9340986330314693`*^9}, {3.9341248311165476`*^9, 
   3.934124842730756*^9}, {3.9341286838880205`*^9, 3.934128684428071*^9}, {
   3.934128740559914*^9, 3.9341287688461194`*^9}, {3.934128837924361*^9, 
   3.9341288762883005`*^9}, {3.9341300182472067`*^9, 3.934130095077856*^9}, {
   3.934130231678173*^9, 3.9341302341545305`*^9}, {3.9341310628538504`*^9, 
   3.9341310634733047`*^9}, {3.93421809054797*^9, 3.9342181302174187`*^9}, {
   3.934605271832117*^9, 3.934605292739564*^9}, 3.9347026595284853`*^9, {
   3.935134917984482*^9, 3.9351349180180116`*^9}, {3.9355172720039043`*^9, 
   3.9355173234325647`*^9}},
 CellTags->"Evaluation",
 CellLabel->
  "In[181]:=",ExpressionUUID->"80c66734-05ec-42fc-88c4-24186c7c8bf0"],

Cell[BoxData[
 FormBox[
  TemplateBox[{
   "Join", "heads", 
    "\"Heads \\!\\(\\*FormBox[\\\"If\\\", TraditionalForm]\\) and \
\\!\\(\\*FormBox[\\\"List\\\", TraditionalForm]\\) at positions \
\\!\\(\\*FormBox[\\\"1\\\", TraditionalForm]\\) and \
\\!\\(\\*FormBox[\\\"2\\\", TraditionalForm]\\) are expected to be the \
same.\"", 2, 185, 8, 26316706751589650788, "Local"},
   "MessageTemplate"], TraditionalForm]], "Message", "MSG",
 CellChangeTimes->{3.950586799771263*^9},
 CellTags->"Evaluation",
 CellLabel->
  "During evaluation of \
In[181]:=",ExpressionUUID->"534114e2-e9d2-124f-ad12-72e7576761b7"],

Cell[BoxData[
 FormBox[
  TemplateBox[{
   "Join", "heads", 
    "\"Heads \\!\\(\\*FormBox[\\\"List\\\", TraditionalForm]\\) and \
\\!\\(\\*FormBox[\\\"If\\\", TraditionalForm]\\) at positions \
\\!\\(\\*FormBox[\\\"1\\\", TraditionalForm]\\) and \
\\!\\(\\*FormBox[\\\"3\\\", TraditionalForm]\\) are expected to be the \
same.\"", 2, 185, 9, 26316706751589650788, "Local"},
   "MessageTemplate"], TraditionalForm]], "Message", "MSG",
 CellChangeTimes->{3.950586799775276*^9},
 CellTags->"Evaluation",
 CellLabel->
  "During evaluation of \
In[181]:=",ExpressionUUID->"eaa11f37-097a-ab4d-8b36-225d5d38f3b7"],

Cell[BoxData[
 FormBox[
  TemplateBox[{
   "Join", "heads", 
    "\"Heads \\!\\(\\*FormBox[\\\"If\\\", TraditionalForm]\\) and \
\\!\\(\\*FormBox[\\\"List\\\", TraditionalForm]\\) at positions \
\\!\\(\\*FormBox[\\\"1\\\", TraditionalForm]\\) and \
\\!\\(\\*FormBox[\\\"2\\\", TraditionalForm]\\) are expected to be the \
same.\"", 2, 185, 10, 26316706751589650788, "Local"},
   "MessageTemplate"], TraditionalForm]], "Message", "MSG",
 CellChangeTimes->{3.95058679978928*^9},
 CellTags->"Evaluation",
 CellLabel->
  "During evaluation of \
In[181]:=",ExpressionUUID->"94b0191c-8a1b-864b-bdfa-c6d440a0d466"],

Cell[BoxData[
 FormBox[
  TemplateBox[{
   "General", "stop", 
    "\"Further output of \\!\\(\\*FormBox[StyleBox[RowBox[{\\\"Join\\\", \
\\\"::\\\", \\\"heads\\\"}], \\\"MessageName\\\"], TraditionalForm]\\) will \
be suppressed during this calculation.\"", 2, 185, 11, 26316706751589650788, 
    "Local"},
   "MessageTemplate"], TraditionalForm]], "Message", "MSG",
 CellChangeTimes->{3.950586799802166*^9},
 CellTags->"Evaluation",
 CellLabel->
  "During evaluation of \
In[181]:=",ExpressionUUID->"b4ec25da-54d5-fd4c-bcf4-508d9e439719"],

Cell[BoxData[
 FormBox[
  TemplateBox[{
   "Part", "partw", 
    "\"Part \\!\\(\\*FormBox[RowBox[{\\\"-\\\", \\\"2\\\"}], TraditionalForm]\
\\) of \\!\\(\\*FormBox[RowBox[{\\\"{\\\", RowBox[{\\\"If\\\", \\\"[\\\", \
RowBox[{RowBox[{\\\"min\\\", \\\"(\\\", \
RowBox[{SqrtBox[RowBox[{RowBox[{SuperscriptBox[\\\"csc\\\", \\\"2\\\"], \\\"(\
\\\", RowBox[{\\\"Plus\\\", \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"2\
\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\\\"}], \\\")\\\"}], \\\" \\\", \
SuperscriptBox[RowBox[{\\\"pTmaxBrem\\\", \\\"(\\\", \
\\\"\\\\\\\"SLAC-E137\\\\\\\"\\\", \\\")\\\"}], \\\"2\\\"]}]], \\\",\\\", \
RowBox[{\\\"20.`\\\", \\\" \\\", RowBox[{\\\"zMaxBrem\\\", \\\"(\\\", \
\\\"\\\\\\\"SLAC-E137\\\\\\\"\\\", \\\")\\\"}]}]}], \\\")\\\"}], \\\",\\\", \
RowBox[{RowBox[{\\\"(\\\", RowBox[{RowBox[{\\\"ELLPmaxBremBaseline\\\", \\\"(\
\\\", RowBox[{\\\"Facility\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \
\\\"#1\\\"}], \\\")\\\"}], \\\"&\\\"}], \\\")\\\"}], \\\"\
\[InvisibleApplication]\\\", RowBox[{\\\"(\\\", RowBox[{\\\"With\\\", \\\"[\\\
\", RowBox[{RowBox[{\\\"{\\\", RowBox[{RowBox[{\\\"thmin\\\", \\\"=\\\", \
RowBox[{\\\"\[Theta]EfallBaseline\\\", \\\"(\\\", \\\"Facility\\\", \
\\\")\\\"}]}], \\\",\\\", RowBox[{\\\"thmax\\\", \\\"=\\\", RowBox[{\\\"\
\[Theta]maxBremBaseline\\\", \\\"(\\\", \\\"Facility\\\", \\\")\\\"}]}]}], \\\
\"}\\\"}], \\\",\\\", RowBox[{\\\"Join\\\", \\\"[\\\", \
RowBox[{RowBox[{\\\"Select\\\", \\\"[\\\", RowBox[{RowBox[{\\\"{\\\", \
RowBox[{\\\"0.00001`\\\", \\\",\\\", RowBox[{\\\"Times\\\", \\\"[\\\", \
RowBox[{\\\"\[LeftSkeleton]\\\", \\\"2\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\
\\\"}], \\\",\\\", RowBox[{\\\"Times\\\", \\\"[\\\", RowBox[{\\\"\
\[LeftSkeleton]\\\", \\\"2\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\\\"}], \
\\\",\\\", RowBox[{\\\"Times\\\", \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \
\\\"2\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\\\"}], \\\",\\\", \
\\\"0.0001`\\\", \\\",\\\", RowBox[{\\\"Times\\\", \\\"[\\\", RowBox[{\\\"\
\[LeftSkeleton]\\\", \\\"2\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\\\"}], \
\\\",\\\", RowBox[{\\\"Times\\\", \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \
\\\"2\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\\\"}], \\\",\\\", \
RowBox[{\\\"Times\\\", \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"2\\\", \
\\\"\[RightSkeleton]\\\"}], \\\"]\\\"}], \\\",\\\", RowBox[{\\\"Times\\\", \\\
\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"2\\\", \
\\\"\[RightSkeleton]\\\"}], \\\"]\\\"}], \\\",\\\", \\\"0.001`\\\", \
\\\",\\\", RowBox[{\\\"Times\\\", \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \
\\\"2\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\\\"}]}], \\\"}\\\"}], \\\",\\\", \
RowBox[{RowBox[{\\\"Less\\\", \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \
\\\"2\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\\\"}], \\\"&\\\"}]}], \
\\\"]\\\"}], \\\",\\\", RowBox[{\\\"Select\\\", \\\"[\\\", RowBox[{\\\"\
\[Theta]listSmall\\\", \\\",\\\", RowBox[{RowBox[{\\\"Inequality\\\", \\\"[\\\
\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"5\\\", \\\"\[RightSkeleton]\\\"}], \
\\\"]\\\"}], \\\"&\\\"}]}], \\\"]\\\"}], \\\",\\\", RowBox[{\\\"{\\\", \
\\\"thmax\\\", \\\"}\\\"}]}], \\\"]\\\"}]}], \\\"]\\\"}], \\\")\\\"}]}]}], \\\
\"]\\\"}], \\\"}\\\"}], TraditionalForm]\\) does not exist.\"", 2, 185, 12, 
    26316706751589650788, "Local"},
   "MessageTemplate"], TraditionalForm]], "Message", "MSG",
 CellChangeTimes->{3.9505867998164577`*^9},
 CellTags->"Evaluation",
 CellLabel->
  "During evaluation of \
In[181]:=",ExpressionUUID->"10b3ea13-9a7b-1f4a-ab1a-c653496a6237"],

Cell[BoxData[
 FormBox[
  TemplateBox[{
   "Part", "partw", 
    "\"Part \\!\\(\\*FormBox[RowBox[{\\\"-\\\", \\\"2\\\"}], TraditionalForm]\
\\) of \\!\\(\\*FormBox[RowBox[{\\\"{\\\", RowBox[{\\\"If\\\", \\\"[\\\", \
RowBox[{RowBox[{\\\"min\\\", \\\"(\\\", \
RowBox[{SqrtBox[RowBox[{RowBox[{SuperscriptBox[\\\"csc\\\", \\\"2\\\"], \\\"(\
\\\", RowBox[{\\\"Plus\\\", \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"2\
\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\\\"}], \\\")\\\"}], \\\" \\\", \
SuperscriptBox[RowBox[{\\\"pTmaxBrem\\\", \\\"(\\\", \
\\\"\\\\\\\"SuperKEKB\\\\\\\"\\\", \\\")\\\"}], \\\"2\\\"]}]], \\\",\\\", \
RowBox[{\\\"11.006`\\\", \\\" \\\", RowBox[{\\\"zMaxBrem\\\", \\\"(\\\", \\\"\
\\\\\\\"SuperKEKB\\\\\\\"\\\", \\\")\\\"}]}]}], \\\")\\\"}], \\\",\\\", \
RowBox[{RowBox[{\\\"(\\\", RowBox[{RowBox[{\\\"ELLPmaxBremBaseline\\\", \\\"(\
\\\", RowBox[{\\\"Facility\\\", \\\",\\\", \\\"0\\\", \\\",\\\", \
\\\"#1\\\"}], \\\")\\\"}], \\\"&\\\"}], \\\")\\\"}], \\\"\
\[InvisibleApplication]\\\", RowBox[{\\\"(\\\", RowBox[{\\\"With\\\", \\\"[\\\
\", RowBox[{RowBox[{\\\"{\\\", RowBox[{RowBox[{\\\"thmin\\\", \\\"=\\\", \
RowBox[{\\\"\[Theta]EfallBaseline\\\", \\\"(\\\", \\\"Facility\\\", \
\\\")\\\"}]}], \\\",\\\", RowBox[{\\\"thmax\\\", \\\"=\\\", RowBox[{\\\"\
\[Theta]maxBremBaseline\\\", \\\"(\\\", \\\"Facility\\\", \\\")\\\"}]}]}], \\\
\"}\\\"}], \\\",\\\", RowBox[{\\\"Join\\\", \\\"[\\\", \
RowBox[{RowBox[{\\\"Select\\\", \\\"[\\\", RowBox[{RowBox[{\\\"{\\\", \
RowBox[{\\\"0.00001`\\\", \\\",\\\", RowBox[{\\\"Times\\\", \\\"[\\\", \
RowBox[{\\\"\[LeftSkeleton]\\\", \\\"2\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\
\\\"}], \\\",\\\", RowBox[{\\\"Times\\\", \\\"[\\\", RowBox[{\\\"\
\[LeftSkeleton]\\\", \\\"2\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\\\"}], \
\\\",\\\", RowBox[{\\\"Times\\\", \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \
\\\"2\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\\\"}], \\\",\\\", \
\\\"0.0001`\\\", \\\",\\\", RowBox[{\\\"Times\\\", \\\"[\\\", RowBox[{\\\"\
\[LeftSkeleton]\\\", \\\"2\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\\\"}], \
\\\",\\\", RowBox[{\\\"Times\\\", \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \
\\\"2\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\\\"}], \\\",\\\", \
RowBox[{\\\"Times\\\", \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"2\\\", \
\\\"\[RightSkeleton]\\\"}], \\\"]\\\"}], \\\",\\\", RowBox[{\\\"Times\\\", \\\
\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"2\\\", \
\\\"\[RightSkeleton]\\\"}], \\\"]\\\"}], \\\",\\\", \\\"0.001`\\\", \
\\\",\\\", RowBox[{\\\"Times\\\", \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \
\\\"2\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\\\"}]}], \\\"}\\\"}], \\\",\\\", \
RowBox[{RowBox[{\\\"Less\\\", \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \
\\\"2\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\\\"}], \\\"&\\\"}]}], \
\\\"]\\\"}], \\\",\\\", RowBox[{\\\"Select\\\", \\\"[\\\", RowBox[{\\\"\
\[Theta]listSmall\\\", \\\",\\\", RowBox[{RowBox[{\\\"Inequality\\\", \\\"[\\\
\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"5\\\", \\\"\[RightSkeleton]\\\"}], \
\\\"]\\\"}], \\\"&\\\"}]}], \\\"]\\\"}], \\\",\\\", RowBox[{\\\"{\\\", \
\\\"thmax\\\", \\\"}\\\"}]}], \\\"]\\\"}]}], \\\"]\\\"}], \\\")\\\"}]}]}], \\\
\"]\\\"}], \\\"}\\\"}], TraditionalForm]\\) does not exist.\"", 2, 185, 13, 
    26316706751589650788, "Local"},
   "MessageTemplate"], TraditionalForm]], "Message", "MSG",
 CellChangeTimes->{3.9505867998459816`*^9},
 CellTags->"Evaluation",
 CellLabel->
  "During evaluation of \
In[181]:=",ExpressionUUID->"8137579f-4695-c740-b5de-70e055da89cf"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Altarelli-Parisi && Foroughi-Ritz", "Subsection",
 CellChangeTimes->{{3.9340933625312176`*^9, 3.9340934173622684`*^9}, {
  3.9341288077319846`*^9, 3.934128821094805*^9}, {3.935131070033628*^9, 
  3.9351310744069967`*^9}},ExpressionUUID->"1d3c9bf9-cf14-40ee-ac7e-\
e7965ade4747"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"Virtuality", " ", "form"}], "-", "factor"}], ",", " ", 
    RowBox[{"assuming", " ", "to", " ", "be", " ", 
     RowBox[{"Eq", ".", " ", "25"}], " ", "of", " ", "2108.05900"}]}], "*)"}],
   "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"H1", "[", 
      RowBox[{"z_", ",", "pT_", ",", "mp_", ",", "mV_"}], "]"}], "=", 
     RowBox[{
      SuperscriptBox["pT", "2"], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", "z"}], ")"}], "*", 
       SuperscriptBox["mV", "2"]}], "+", 
      RowBox[{
       SuperscriptBox["z", "2"], "*", 
       SuperscriptBox["mp", "2"]}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Fvirtuality", "[", 
      RowBox[{
      "z_", ",", "pT_", ",", "mp_", ",", "mV_", ",", "\[CapitalLambda]p_"}], 
      "]"}], "=", 
     FractionBox["1", 
      RowBox[{"1", "+", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"-", 
          FractionBox[
           RowBox[{"H1", "[", 
            RowBox[{"z", ",", "pT", ",", "mp", ",", "mV"}], "]"}], 
           RowBox[{"z", "*", 
            SuperscriptBox["\[CapitalLambda]p", "2"]}]]}], ")"}], "2"]}]]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "Finding", " ", "the", " ", "maximal", " ", "angle", " ", "for", " ", 
      "the", " ", "given", " ", "facility", " ", "at", " ", "which", " ", 
      "bremsstrahlung", " ", "probability", " ", "is", " ", "non"}], "-", 
     "negligible"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"Finding", " ", 
       SubscriptBox["E", 
        RowBox[{"LLP", ",", "max"}]], 
       RowBox[{"(", "\[Theta]", ")"}], " ", "from", " ", "the", " ", 
       "condition", " ", 
       SubscriptBox["F", "virtual"], 
       RowBox[{"(", 
        RowBox[{"m", ",", "\[Theta]", ",", 
         SubscriptBox["E", "max"]}], ")"}]}], "=", 
      SuperscriptBox["10", 
       RowBox[{"-", "3"}]]}], ",", " ", 
     RowBox[{
      RowBox[{"and", " ", "defining", " ", "detailed", " ", "angle"}], "-", 
      RowBox[{
      "energy", " ", "grid", " ", "for", " ", "the", " ", "tabulations"}]}]}],
     "*)"}], "\[IndentingNewLine]", 
   RowBox[{"Do", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "Emax", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Finding", " ", 
         SubscriptBox["E", 
          RowBox[{"LLP", ",", "max"}]], 
         RowBox[{"(", "\[Theta]", ")"}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"zmaxTemp", "[", 
          RowBox[{
          "mV_", ",", "\[Theta]V_", ",", "\[CapitalLambda]p_", ",", 
           "Facility"}], "]"}], "=", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"z", "/.", 
            RowBox[{"Solve", "[", 
             RowBox[{
              RowBox[{
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"-", 
                  FractionBox[
                   RowBox[{"H1", "[", 
                    RowBox[{"z", ",", 
                    RowBox[{"pTv", "[", 
                    RowBox[{"mV", ",", 
                    RowBox[{"Emax", "*", "z"}], ",", "\[Theta]V"}], "]"}], 
                    ",", "mp", ",", "mV"}], "]"}], 
                   RowBox[{"z", "*", 
                    SuperscriptBox["\[CapitalLambda]p", "2"]}]]}], ")"}], 
                "2"], "==", 
               SuperscriptBox["10", "3"]}], ",", "z"}], "]"}]}], ")"}], "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"mp", "->", 
             RowBox[{"mSM", "[", "\"\<p\>\"", "]"}]}], ",", 
            RowBox[{"Emax", "->", 
             RowBox[{"EmaxFacility", "[", "Facility", "]"}]}]}], "}"}]}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"ELLPmaxBremAP", "[", 
          RowBox[{
          "Facility", ",", "mV_", ",", "\[Theta]V_", ",", 
           "\[CapitalLambda]p_"}], "]"}], "=", 
         RowBox[{"Min", "[", 
          RowBox[{
           RowBox[{"Max", "[", 
            RowBox[{
             RowBox[{"Re", "[", 
              RowBox[{
               RowBox[{"EmaxFacility", "[", "Facility", "]"}], "*", 
               RowBox[{
                RowBox[{"zmaxTemp", "[", 
                 RowBox[{
                 "mV", ",", "\[Theta]V", ",", "\[CapitalLambda]p", ",", 
                  "Facility"}], "]"}], "[", 
                RowBox[{"[", 
                 RowBox[{"-", "1"}], "]"}], "]"}]}], "]"}], ",", 
             RowBox[{
              RowBox[{"EmaxFacility", "[", "Facility", "]"}], "*", 
              RowBox[{"zMinBrem", "[", "Facility", "]"}]}]}], "]"}], ",", 
           RowBox[{
            RowBox[{"EmaxFacility", "[", "Facility", "]"}], "*", 
            RowBox[{"zMaxBrem", "[", "Facility", "]"}]}]}], "]"}]}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{"Facility", ",", "FacilitiesList"}], "}"}]}], "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Calculating", " ", "the", " ", 
      SubscriptBox["\[CapitalLambda]", "p"]}], "-", 
     RowBox[{
     "dependent", " ", "grids", " ", "for", " ", "polar", " ", "angles", " ", 
      "and", " ", "energies"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"GridBremAP", "[", 
     RowBox[{"\[CapitalLambda]p_", ",", "Facility_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"mmin", "=", "0.02"}], ",", 
        RowBox[{"mmax", "=", "2"}], ",", "tabbmmin", ",", "tabbmmax", ",", 
        "\[Theta]maxAbs", ",", "\[Theta]startFallMax", ",", 
        "\[Theta]gridBremTemp", ",", "ELLPgridBrem"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"tabbmmin", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"th", ",", 
            RowBox[{"ELLPmaxBremAP", "[", 
             RowBox[{
             "Facility", ",", "mmin", ",", "th", ",", "\[CapitalLambda]p"}], 
             "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"th", ",", 
            RowBox[{"Sort", "[", 
             RowBox[{"Flatten", "[", 
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"i", "*", 
                 SuperscriptBox["10", "j"]}], ",", 
                RowBox[{"{", 
                 RowBox[{"i", ",", "1", ",", "9", ",", "0.02"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"j", ",", 
                  RowBox[{"-", "5"}], ",", 
                  RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "]"}], "]"}], 
             "]"}]}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"tabbmmax", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"th", ",", 
            RowBox[{"ELLPmaxBremAP", "[", 
             RowBox[{
             "Facility", ",", "mmax", ",", "th", ",", "\[CapitalLambda]p"}], 
             "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"th", ",", 
            RowBox[{"Sort", "[", 
             RowBox[{"Flatten", "[", 
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"i", "*", 
                 SuperscriptBox["10", "j"]}], ",", 
                RowBox[{"{", 
                 RowBox[{"i", ",", "1", ",", "9", ",", "0.02"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"j", ",", 
                  RowBox[{"-", "5"}], ",", 
                  RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "]"}], "]"}], 
             "]"}]}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Finding", " ", 
          SubscriptBox["\[Theta]", "max"], " ", "at", " ", "which", " ", 
          SubscriptBox["E", 
           RowBox[{"LLP", ",", "max"}]]}], " ", "=", " ", 
         RowBox[{
          SubscriptBox["E", 
           RowBox[{"LLP", ",", "min"}]], " ", "=", " ", 
          RowBox[{
           SubscriptBox["z", "min"], 
           SubscriptBox["E", 
            RowBox[{"p", ",", "Facility"}]]}]}]}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"\[Theta]maxAbs", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"SortBy", "[", 
           RowBox[{
            RowBox[{"Select", "[", 
             RowBox[{"tabbmmin", ",", 
              RowBox[{
               RowBox[{
                RowBox[{"#", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], ">", 
                RowBox[{
                 RowBox[{"EmaxFacility", "[", "Facility", "]"}], "*", 
                 RowBox[{"zMinBrem", "[", "Facility", "]"}]}]}], "&"}]}], 
             "]"}], ",", 
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "&"}]}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"-", "1"}], "]"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"The", " ", "angle", " ", 
          SubscriptBox["\[Theta]", "fall"], " ", "at", " ", "which", " ", 
          SubscriptBox["E", "max"], 
          RowBox[{"(", 
           SubscriptBox["\[Theta]", "fall"], ")"}], " ", "starts", " ", 
          "being"}], " ", "<", " ", 
         RowBox[{
          SubscriptBox["z", "max"], 
          SubscriptBox["E", "p"]}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"\[Theta]startFallMax", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"SortBy", "[", 
           RowBox[{
            RowBox[{"Select", "[", 
             RowBox[{"tabbmmax", ",", 
              RowBox[{
               RowBox[{
                RowBox[{"#", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "<", 
                RowBox[{
                 RowBox[{"EmaxFacility", "[", "Facility", "]"}], "*", 
                 RowBox[{"zMaxBrem", "[", "Facility", "]"}]}]}], "&"}]}], 
             "]"}], ",", 
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "&"}]}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "Defining", " ", "the", " ", "polar", " ", "angle", " ", "grid"}], 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{"\[Theta]gridBremTemp", "=", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"\[Theta]startFallMax", ">", 
              SuperscriptBox["10", 
               RowBox[{"-", "5."}]]}], ",", 
             RowBox[{"With", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"thmin", "=", "\[Theta]startFallMax"}], ",", 
                 RowBox[{"thmax", "=", "\[Theta]maxAbs"}]}], "}"}], ",", 
               RowBox[{"Join", "[", 
                RowBox[{
                 RowBox[{"Select", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    SuperscriptBox["10", 
                    RowBox[{"-", "5."}]], ",", 
                    RowBox[{"3", "*", 
                    SuperscriptBox["10", 
                    RowBox[{"-", "5."}]]}], ",", 
                    RowBox[{"6", "*", 
                    SuperscriptBox["10", 
                    RowBox[{"-", "5."}]]}], ",", 
                    RowBox[{"8", "*", 
                    SuperscriptBox["10", 
                    RowBox[{"-", "5."}]]}], ",", 
                    SuperscriptBox["10", 
                    RowBox[{"-", "4."}]], ",", 
                    RowBox[{"2", "*", 
                    SuperscriptBox["10", 
                    RowBox[{"-", "4."}]]}], ",", 
                    RowBox[{"4", "*", 
                    SuperscriptBox["10", 
                    RowBox[{"-", "4."}]]}], ",", 
                    RowBox[{"6", "*", 
                    SuperscriptBox["10", 
                    RowBox[{"-", "4."}]]}], ",", 
                    RowBox[{"8", "*", 
                    SuperscriptBox["10", 
                    RowBox[{"-", "4."}]]}], ",", 
                    SuperscriptBox["10", 
                    RowBox[{"-", "3."}]], ",", 
                    RowBox[{"3", "*", 
                    SuperscriptBox["10", 
                    RowBox[{"-", "3."}]]}], ",", 
                    RowBox[{"6", "*", 
                    SuperscriptBox["10", 
                    RowBox[{"-", "3."}]]}], ",", 
                    SuperscriptBox["10", 
                    RowBox[{"-", "2."}]], ",", 
                    RowBox[{"3", "*", 
                    SuperscriptBox["10", 
                    RowBox[{"-", "2."}]]}], ",", 
                    RowBox[{"6", "*", 
                    SuperscriptBox["10", 
                    RowBox[{"-", "2."}]]}]}], "}"}], ",", 
                   RowBox[{
                    RowBox[{"#", "<", "thmin"}], "&"}]}], "]"}], ",", 
                 RowBox[{"Select", "[", 
                  RowBox[{"\[Theta]listSmall", ",", 
                   RowBox[{
                    RowBox[{"thmin", "<=", "#", "<", "thmax"}], "&"}]}], 
                  "]"}], ",", 
                 RowBox[{"{", "thmax", "}"}]}], "]"}]}], "]"}]}], "]"}], "//",
            "Sort"}], "//", "N"}], "//", "DeleteDuplicates"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"\[Theta]gridBremTemp", "=", 
        RowBox[{"Join", "[", 
         RowBox[{"\[Theta]gridBremTemp", ",", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"\[Theta]Nlist", "[", "Facility", "]"}], ",", 
            RowBox[{
             RowBox[{"#", ">", 
              RowBox[{"Max", "[", "\[Theta]gridBremTemp", "]"}]}], "&"}]}], 
           "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"\[Theta]gridBremTemp", "=", 
        RowBox[{"\[Theta]filteredList", "[", "\[Theta]gridBremTemp", "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"ELLPgridBrem", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"Select", "[", 
             RowBox[{
              RowBox[{"ENlist", "[", "Facility", "]"}], ",", 
              RowBox[{
               RowBox[{"#", "<", 
                RowBox[{"ELLPminBrem", "[", "Facility", "]"}]}], "&"}]}], 
             "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"ELLPminBrem", "[", "Facility", "]"}], "}"}], ",", 
            RowBox[{"Select", "[", 
             RowBox[{
              RowBox[{"ENlist", "[", "Facility", "]"}], ",", 
              RowBox[{
               RowBox[{"#", ">", 
                RowBox[{"ELLPminBrem", "[", "Facility", "]"}]}], "&"}]}], 
             "]"}], ",", " ", 
            RowBox[{
             RowBox[{
              RowBox[{"ELLPmaxBremAP", "[", 
               RowBox[{
               "Facility", ",", "#", ",", "mmin", ",", "\[CapitalLambda]p"}], 
               "]"}], "&"}], "/@", "\[Theta]gridBremTemp"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"ELLPmaxBremAP", "[", 
               RowBox[{
               "Facility", ",", "#", ",", "mmax", ",", "\[CapitalLambda]p"}], 
               "]"}], "&"}], "/@", "\[Theta]gridBremTemp"}]}], "]"}], "//", 
          "Sort"}], "//", "DeleteDuplicates"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"ELLPgridBrem", "=", 
        RowBox[{"EVfiltered", "[", 
         RowBox[{"ELLPgridBrem", ",", "Facility"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          FractionBox[
           RowBox[{
            RowBox[{"ELLPgridBrem", "[", 
             RowBox[{"[", 
              RowBox[{"-", "1"}], "]"}], "]"}], "-", 
            RowBox[{"ELLPgridBrem", "[", 
             RowBox[{"[", 
              RowBox[{"-", "2"}], "]"}], "]"}]}], 
           RowBox[{"ELLPgridBrem", "[", 
            RowBox[{"[", 
             RowBox[{"-", "1"}], "]"}], "]"}]], ">", "0.05"}], ",", 
         RowBox[{
          RowBox[{"ELLPgridBrem", "=", 
           RowBox[{
            RowBox[{
             RowBox[{"Join", "[", 
              RowBox[{"ELLPgridBrem", ",", 
               RowBox[{"Table", "[", 
                RowBox[{"EV", ",", 
                 RowBox[{"{", 
                  RowBox[{"EV", ",", 
                   RowBox[{"ELLPminBrem", "[", "Facility", "]"}], ",", 
                   RowBox[{
                    RowBox[{"EmaxFacility", "[", "Facility", "]"}], "*", 
                    RowBox[{"zMaxBrem", "[", "Facility", "]"}]}], ",", 
                   RowBox[{"0.04", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"EmaxFacility", "[", "Facility", "]"}], "*", 
                    RowBox[{"zMaxBrem", "[", "Facility", "]"}]}], "-", 
                    RowBox[{"ELLPminBrem", "[", "Facility", "]"}]}], 
                    ")"}]}]}], "}"}]}], "]"}]}], "]"}], "//", "Sort"}], "//", 
            "DeleteDuplicates"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
        "\[Theta]maxAbs", ",", "\[Theta]gridBremTemp", ",", "ELLPgridBrem"}], 
        "}"}]}]}], "\[IndentingNewLine]", "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.934128895059797*^9, 3.9341289304949083`*^9}, {
   3.9341290481628895`*^9, 3.934129048402607*^9}, {3.934129089692517*^9, 
   3.9341291386707478`*^9}, {3.9341292858862133`*^9, 
   3.9341293046271515`*^9}, {3.934129708469746*^9, 3.9341298456473513`*^9}, {
   3.934129889682163*^9, 3.934129904816268*^9}, {3.934129952919136*^9, 
   3.934129953530404*^9}, {3.934130112160958*^9, 3.9341301879074783`*^9}, {
   3.9341302406848845`*^9, 3.9341303736732726`*^9}, {3.9341304127407436`*^9, 
   3.93413046981993*^9}, {3.9341305109392805`*^9, 3.934130513828191*^9}, {
   3.934130546831688*^9, 3.9341305539458437`*^9}, {3.934130941309826*^9, 
   3.9341309433879347`*^9}, 3.9341310827435107`*^9, {3.9344450122492437`*^9, 
   3.934445015662307*^9}, {3.934445109374604*^9, 3.9344451124761524`*^9}, {
   3.9344451619495163`*^9, 3.934445168370078*^9}, {3.9344452131508646`*^9, 
   3.934445213837435*^9}, {3.9344453007873354`*^9, 3.934445331774721*^9}, {
   3.934445506454956*^9, 3.934445688024389*^9}, {3.9344457650528507`*^9, 
   3.934445766931134*^9}, {3.9346991606555643`*^9, 3.934699183126037*^9}, {
   3.935517089235838*^9, 3.935517092201663*^9}, {3.9452334004121456`*^9, 
   3.9452334028225594`*^9}},
 CellLabel->
  "In[186]:=",ExpressionUUID->"5cd5fe21-8832-4f66-a7db-f31a2bc2f399"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Fits for the cross-sections", "Section",
 CellChangeTimes->{{3.934606149278904*^9, 3.9346061533271956`*^9}, {
  3.9346061904900637`*^9, 3.934606193179393*^9}, {3.934606287010795*^9, 
  3.934606289981095*^9}},ExpressionUUID->"0af00c60-02f3-4ac6-ae12-\
0d395d6bf76d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"mpval", "=", "0.938"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"pp", " ", "total", " ", "cross"}], "-", 
    RowBox[{
    "section", " ", "in", " ", "mb", " ", "in", " ", "terms", " ", "of", " ", 
     "invariant", " ", "mass", " ", "s"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Z", "=", "35.45"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"B", "=", "0.308"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Y1", "=", "42.53"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Y2", "=", "33.34"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"s0", "=", 
   SuperscriptBox["5.38", "2"]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"s1", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Eta]1", "=", "0.458"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Eta]2", "=", "0.545"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Sinv", "[", 
    RowBox[{"Pp_", ",", "mp_"}], "]"}], "=", 
   RowBox[{"2", "*", "Pp", "*", "mp"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Sprime", "[", 
    RowBox[{"Pp_", ",", "mp_", ",", "z_"}], "]"}], "=", 
   RowBox[{
    RowBox[{"2", "*", "mp", "*", "Pp", 
     RowBox[{"(", 
      RowBox[{"1", "-", "z"}], ")"}]}], "+", 
    RowBox[{"2", "*", 
     SuperscriptBox["mp", "2"]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Sigma]TotFit", "[", "s_", "]"}], "=", 
   RowBox[{"Z", "+", 
    RowBox[{"B", "*", 
     SuperscriptBox[
      RowBox[{"Log", "[", 
       RowBox[{"s", "/", "s0"}], "]"}], "2"]}], "+", 
    RowBox[{"Y1", "*", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"s1", "/", "s"}], ")"}], "\[Eta]1"]}], "-", 
    RowBox[{"Y2", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"s1", "/", "s"}], ")"}], "\[Eta]2"]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Sigma]NSDFit", "[", "s_", "]"}], "=", 
   RowBox[{"1.76", "+", 
    RowBox[{"19.8", 
     SuperscriptBox["s", "0.057"]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Sigma]RatiosFit", "[", 
    RowBox[{"pBeam_", ",", "z_"}], "]"}], "=", 
   FractionBox[
    RowBox[{"\[Sigma]NSDFit", "[", 
     RowBox[{"\[Sigma]NSDFit", "[", 
      RowBox[{"Sprime", "[", 
       RowBox[{"pBeam", ",", "mpval", ",", "z"}], "]"}], "]"}], "]"}], 
    RowBox[{"\[Sigma]TotFit", "[", 
     RowBox[{"Sinv", "[", 
      RowBox[{"pBeam", ",", "mpval"}], "]"}], "]"}]]}], ";"}]}], "Input",
 CellChangeTimes->{{3.934606199868082*^9, 3.9346062327043676`*^9}, {
  3.934606291645035*^9, 3.9346064390229726`*^9}, {3.9351311039091005`*^9, 
  3.935131136377761*^9}},
 CellLabel->
  "In[133]:=",ExpressionUUID->"1e839c05-c83f-4800-b096-11cbc0ede7fd"]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Splitting probabilities and probability of the process", "Chapter",
 CellChangeTimes->{{3.9340998286515217`*^9, 
  3.934099838326029*^9}},ExpressionUUID->"42c7c861-08b3-489f-aaf7-\
781a3a38fb96"],

Cell[CellGroupData[{

Cell["DP", "Section",
 CellChangeTimes->{{3.93409216099249*^9, 3.9340921684717674`*^9}, {
  3.9341010421191597`*^9, 
  3.934101042514372*^9}},ExpressionUUID->"d7cf56ca-31b6-4b71-84d2-\
ae24fd9531d1"],

Cell[CellGroupData[{

Cell["Blumlein-Brunner", "Subsection",
 CellChangeTimes->{{3.8867412669050264`*^9, 3.8867412688103676`*^9}, {
   3.913457093447189*^9, 3.9134570947858305`*^9}, {3.913807362240102*^9, 
   3.9138073717509847`*^9}, {3.9340921777582693`*^9, 3.934092177998282*^9}, {
   3.934093554675906*^9, 3.9340935612395616`*^9}, {3.9345554331051493`*^9, 
   3.9345554375434437`*^9}, 3.9351311551279964`*^9},
 CellTags->
  "Evaluation",ExpressionUUID->"a14fc704-b252-4503-9f91-5b85cfc2c1db"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"A", "-", 
    RowBox[{"la", " ", "Bluemlein"}], "-", "Brunner"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"\[Omega]splBaselineDP", "[", 
      RowBox[{
      "mp_", ",", "z_", ",", "pT_", ",", "Pp_", ",", "mV_", ",", 
       "\[Epsilon]2_", ",", "\[Alpha]EM_"}], "]"}], "=", 
     RowBox[{
      FractionBox[
       RowBox[{"2", "*", "pT", "*", "\[Epsilon]2", "*", "\[Alpha]EM"}], 
       RowBox[{"2", "*", "Pi", "*", 
        RowBox[{"H1", "[", 
         RowBox[{"z", ",", "pT", ",", "mp", ",", "mV"}], "]"}]}]], "*", 
      RowBox[{"(", 
       RowBox[{
        FractionBox[
         RowBox[{"(", 
          RowBox[{"1", "+", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"1", "-", "z"}], ")"}], "2"]}], ")"}], "z"], "-", 
        RowBox[{"2", "*", "z", "*", 
         RowBox[{"(", 
          RowBox[{"1", "-", "z"}], ")"}], "*", 
         RowBox[{"(", 
          RowBox[{
           FractionBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", "*", 
               SuperscriptBox["mp", "2"]}], "+", 
              SuperscriptBox["mV", "2"]}], ")"}], 
            RowBox[{"H1", "[", 
             RowBox[{"z", ",", "pT", ",", "mp", ",", "mV"}], "]"}]], "-", 
           FractionBox[
            RowBox[{
             SuperscriptBox["z", "2"], "*", "2", "*", 
             SuperscriptBox["mp", "4"]}], 
            SuperscriptBox[
             RowBox[{"H1", "[", 
              RowBox[{"z", ",", "pT", ",", "mp", ",", "mV"}], "]"}], "2"]]}], 
          ")"}]}], "+", 
        FractionBox[
         RowBox[{"2", "*", "z", "*", 
          RowBox[{"(", 
           RowBox[{"1", "-", "z"}], ")"}], "*", 
          RowBox[{"(", 
           RowBox[{"1", "+", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"1", "-", "z"}], ")"}], "2"]}], ")"}], "*", 
          SuperscriptBox["mp", "2"], "*", 
          SuperscriptBox["mV", "2"]}], 
         SuperscriptBox[
          RowBox[{"H1", "[", 
           RowBox[{"z", ",", "pT", ",", "mp", ",", "mV"}], "]"}], "2"]], "+", 
        FractionBox[
         RowBox[{"2", "*", "z", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"1", "-", "z"}], ")"}], "2"], 
          SuperscriptBox["mV", "4"]}], 
         SuperscriptBox[
          RowBox[{"H1", "[", 
           RowBox[{"z", ",", "pT", ",", "mp", ",", "mV"}], "]"}], "2"]]}], 
       ")"}], 
      RowBox[{"FormFactorSquaredBrem", "[", 
       RowBox[{"mV", ",", "\"\<DP\>\""}], "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Do", "[", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
     "Producing", " ", "normalized", " ", "distribution", " ", "and", " ", 
      "normalization", " ", 
      RowBox[{"(", 
       RowBox[{"==", 
        RowBox[{"total", " ", "flux"}]}], ")"}]}], "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "eminabs", ",", "emaxabs", ",", "pbeam", ",", "ptmax", ",", "norm", 
         ",", "distr", ",", "normdata"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"pbeam", "=", 
         RowBox[{"EmaxFacility", "[", "Facility", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"eminabs", "=", 
         RowBox[{"ELLPminBrem", "[", "Facility", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"emaxabs", "=", 
         RowBox[{
          RowBox[{"zMaxBrem", "[", "Facility", "]"}], "*", "pbeam"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"ptmax", "=", 
         RowBox[{"pTmaxBrem", "[", "Facility", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Double", " ", "distribution", " ", "for", " ", 
           RowBox[{"bremsstrahlung", ".", " ", "The"}], " ", "cut", " ", 
           "E"}], "<=", 
          RowBox[{
           SubscriptBox["E", "max"], 
           RowBox[{"(", "\[Theta]", ")"}], " ", "is", " ", "not", " ", 
           "included", " ", "for", " ", "more", " ", "robust", " ", "work", 
           " ", "with", " ", "tabulating", " ", "the", " ", 
           "distribution"}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"FluxBrem", "[", 
          RowBox[{
          "mV_", ",", "\[Theta]V_", ",", "EV_", ",", "\"\<DP\>\"", ",", 
           "\"\<Baseline\>\"", ",", "Facility"}], "]"}], "=", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"\[Theta]V", "<=", 
             RowBox[{"\[Theta]maxBremBaseline", "[", "Facility", "]"}]}], "&&", 
            RowBox[{"eminabs", "<=", "EV", "<=", "emaxabs"}]}], ",", 
           RowBox[{"Evaluate", "[", 
            RowBox[{
             RowBox[{"JacobianpTzToEV\[Theta]", "[", 
              RowBox[{"mV", ",", "EV", ",", "pbeam", ",", "\[Theta]V"}], 
              "]"}], "*", 
             RowBox[{"\[Omega]splBaselineDP", "[", 
              RowBox[{
               RowBox[{"mSM", "[", "\"\<p\>\"", "]"}], ",", 
               RowBox[{"zvp", "[", 
                RowBox[{"EV", ",", "pbeam"}], "]"}], ",", 
               RowBox[{"pTv", "[", 
                RowBox[{"mV", ",", "EV", ",", "\[Theta]V"}], "]"}], ",", 
               "pbeam", ",", "mV", ",", "1", ",", "\[Alpha]EMval"}], "]"}], 
             "*", 
             RowBox[{"KinematicsApplicability\[Theta]E", "[", 
              RowBox[{"mV", ",", "\[Theta]V", ",", "EV", ",", "pbeam"}], 
              "]"}], "*", 
             RowBox[{"\[Sigma]RatiosFit", "[", 
              RowBox[{"pbeam", ",", 
               RowBox[{"zvp", "[", 
                RowBox[{"EV", ",", "pbeam"}], "]"}]}], "]"}]}], "]"}], ",", 
           SuperscriptBox["10", 
            RowBox[{"-", "90."}]]}], "]"}]}], ";"}]}], "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
         RowBox[{"distr", "[", 
          RowBox[{"mV_", ",", "\[Theta]V_", ",", "EV_"}], "]"}], "=", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"eminabs", "<=", "EV", "<=", 
             RowBox[{"ELLPmaxBremBaseline", "[", 
              RowBox[{"Facility", ",", "mV", ",", "\[Theta]V"}], "]"}]}], "&&", 
            RowBox[{"\[Theta]V", "<=", 
             RowBox[{"\[Theta]maxBremBaseline", "[", "Facility", "]"}]}]}], 
           ",", 
           RowBox[{"Evaluate", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"JacobianpTzToEV\[Theta]", "[", 
               RowBox[{"mV", ",", "EV", ",", "pbeam", ",", "\[Theta]V"}], 
               "]"}], "*", 
              RowBox[{"\[Omega]spl", "[", 
               RowBox[{
                RowBox[{"mSM", "[", "\"\<p\>\"", "]"}], ",", 
                RowBox[{"zvp", "[", 
                 RowBox[{"EV", ",", "pbeam"}], "]"}], ",", 
                RowBox[{"pTv", "[", 
                 RowBox[{"mV", ",", "EV", ",", "\[Theta]V"}], "]"}], ",", 
                "pbeam", ",", "mV", ",", "1", ",", "\[Alpha]EMval"}], "]"}]}], 
             RowBox[{"(*", 
              RowBox[{"*", 
               RowBox[{"UnitStep", "[", 
                RowBox[{"0.1", "-", 
                 RowBox[{"ApplicabilityParameter", "[", 
                  RowBox[{
                   RowBox[{"zvp", "[", 
                    RowBox[{"EV", ",", "pBeam"}], "]"}], ",", 
                   RowBox[{"pTv", "[", 
                    RowBox[{"EV", ",", "\[Theta]V"}], "]"}], ",", "mV", ",", 
                   "pBeam", ",", "MP"}], "]"}]}], "]"}]}], "*)"}], ",", 
             SuperscriptBox["10", 
              RowBox[{"-", "90."}]]}], "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"normdata", "=", 
         RowBox[{"ParallelTable", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"mV", ",", 
             RowBox[{"NIntegrate", "[", 
              RowBox[{
               RowBox[{"distr", "[", 
                RowBox[{"mV", ",", "\[Theta]V", ",", "EV"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"\[Theta]V", ",", "0", ",", 
                 RowBox[{"\[Theta]maxBremBaseline", "[", "Facility", "]"}]}], 
                "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"EV", ",", "eminabs", ",", 
                 RowBox[{"Max", "[", 
                  RowBox[{"eminabs", ",", 
                   RowBox[{"ELLPmaxBremBaseline", "[", 
                    RowBox[{"Facility", ",", "mV", ",", "\[Theta]V"}], 
                    "]"}]}], "]"}]}], "}"}]}], 
              RowBox[{"(*", 
               RowBox[{",", 
                RowBox[{"Method", "\[Rule]", "\"\<AdaptiveMonteCarlo\>\""}]}],
                "*)"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"mV", ",", "mVminFromBrem", ",", "mVmaxFromBrem", ",", 
             FractionBox[
              RowBox[{"(", 
               RowBox[{"mVmaxFromBrem", "-", "mVminFromBrem"}], ")"}], 
              "20"]}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"norm", "[", "mV_", "]"}], "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Interpolation", "[", 
            RowBox[{
             RowBox[{"normdata", "//", "Log"}], ",", 
             RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[", 
           RowBox[{"Log", "[", "mV", "]"}], "]"}], "//", "Exp"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"DoubleDistrBrem", "[", 
          RowBox[{
          "mV_", ",", "\[Theta]V_", ",", "EV_", ",", "\"\<DP\>\"", ",", 
           "Facility"}], "]"}], "=", 
         FractionBox[
          RowBox[{"distr", "[", 
           RowBox[{"mV", ",", "\[Theta]V", ",", "EV"}], "]"}], 
          RowBox[{"norm", "[", "mV", "]"}]]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"NormalizationBremDP", "[", 
          RowBox[{"mV_", ",", "Facility"}], "]"}], "=", 
         RowBox[{
          RowBox[{"norm", "[", "mV", "]"}], "*", 
          SuperscriptBox[
           RowBox[{"Abs", "[", 
            RowBox[{"FormFactorBremDP", "[", "mV", "]"}], "]"}], "2"]}]}], 
        ";"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"Export", "[", 
        RowBox[{
         RowBox[{"FileNameJoin", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"NotebookDirectory", "[", "]"}], ",", 
            "\"\<phenomenology/Dark photon/Production probabilities/Pbrem.m\>\
\""}], "}"}], "]"}], ",", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"Facility", ",", 
             RowBox[{"NormalizationBremDP", "[", 
              RowBox[{"mV", ",", "Facility"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"Facility", ",", "FacilitiesList"}], "}"}]}], "]"}], ",", 
         "\"\<MX\>\""}], "]"}], "*)"}], "\[IndentingNewLine]", "]"}], 
     "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{"Facility", ",", "FacilitiesList"}], "}"}]}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.8867413870113516`*^9, 3.886741540701558*^9}, {
   3.8867416150085926`*^9, 3.8867416858917875`*^9}, {3.886741763910581*^9, 
   3.886741873463111*^9}, {3.8867431693622923`*^9, 3.88674317047512*^9}, {
   3.88675912650349*^9, 3.886759206087909*^9}, {3.8867597043528013`*^9, 
   3.886759755586966*^9}, {3.8867603578143253`*^9, 3.8867604196106296`*^9}, {
   3.886760617244815*^9, 3.886760865322702*^9}, {3.8867611750575757`*^9, 
   3.88676119071132*^9}, {3.886822306577469*^9, 3.886822316571784*^9}, {
   3.886832736983899*^9, 3.8868328526588106`*^9}, {3.8868376225654526`*^9, 
   3.8868376275089264`*^9}, {3.8868377047500257`*^9, 
   3.8868377500423417`*^9}, {3.8868391692356443`*^9, 
   3.8868391981720943`*^9}, {3.8921752130780435`*^9, 
   3.8921752473571453`*^9}, {3.892175350303725*^9, 3.892175351846941*^9}, {
   3.892175521630472*^9, 3.8921755238840203`*^9}, {3.8921756208211412`*^9, 
   3.892175674689103*^9}, {3.89217595151208*^9, 3.8921759832833643`*^9}, {
   3.8921761179182405`*^9, 3.8921761298085823`*^9}, {3.8921763172151895`*^9, 
   3.892176651308589*^9}, {3.8921768037891006`*^9, 3.8921769939727063`*^9}, {
   3.893471786674537*^9, 3.893471944190617*^9}, {3.8934719923316636`*^9, 
   3.893472120538704*^9}, {3.893472172040388*^9, 3.893472237278451*^9}, {
   3.8934724280610037`*^9, 3.8934724478702726`*^9}, {3.8934724906214085`*^9, 
   3.8934726100231547`*^9}, {3.8934726965780334`*^9, 3.893472719078771*^9}, 
   3.893472814711776*^9, {3.8934728976727943`*^9, 3.8934730876325455`*^9}, {
   3.8934731519633265`*^9, 3.893473184555513*^9}, 3.8934733383368425`*^9, {
   3.8934743664461913`*^9, 3.8934743955646086`*^9}, {3.89347444304001*^9, 
   3.893474491803772*^9}, {3.893520967114831*^9, 3.8935209671303005`*^9}, {
   3.8936004209704275`*^9, 3.893600421656349*^9}, {3.8936018530142164`*^9, 
   3.8936018531888504`*^9}, 3.8936019581529026`*^9, {3.893602164820368*^9, 
   3.8936021993678665`*^9}, {3.8936041500444*^9, 3.893604150255808*^9}, {
   3.8936049169399033`*^9, 3.893604967103578*^9}, {3.8939498042442403`*^9, 
   3.8939498280077534`*^9}, {3.9134555293231945`*^9, 
   3.9134558380159445`*^9}, {3.9134559627931924`*^9, 
   3.9134560311708765`*^9}, {3.9134560713132343`*^9, 
   3.9134561267045097`*^9}, {3.9134563937525263`*^9, 3.913456567924281*^9}, {
   3.913456608833413*^9, 3.9134566603641357`*^9}, {3.913456755197287*^9, 
   3.913456811278873*^9}, {3.913456851632535*^9, 3.913457051861486*^9}, {
   3.913457085908905*^9, 3.91345725302555*^9}, {3.9134572910544057`*^9, 
   3.913457342020426*^9}, {3.9134575050401444`*^9, 3.9134575228384466`*^9}, {
   3.913458367116445*^9, 3.913458367725425*^9}, {3.9134584488065186`*^9, 
   3.913458459285909*^9}, {3.9134611697649083`*^9, 3.913461174138076*^9}, {
   3.9138273138463836`*^9, 3.913827321126279*^9}, 3.913883326138311*^9, 
   3.914050870893146*^9, {3.9140509269493012`*^9, 3.914050936644663*^9}, {
   3.914054301094025*^9, 3.9140543083811846`*^9}, {3.9140543666031165`*^9, 
   3.9140543705222855`*^9}, {3.914054599455654*^9, 3.9140547578002625`*^9}, {
   3.9140548039699793`*^9, 3.9140548090843987`*^9}, {3.9148324538419247`*^9, 
   3.914832552194564*^9}, {3.914832796306642*^9, 3.9148328175808053`*^9}, {
   3.914832953316688*^9, 3.91483296836609*^9}, {3.917161669043167*^9, 
   3.9171616758761253`*^9}, {3.9171618375573683`*^9, 
   3.9171618378285713`*^9}, {3.91716201525734*^9, 3.9171620418812046`*^9}, {
   3.917164304719488*^9, 3.917164310694111*^9}, {3.9171647316150618`*^9, 
   3.9171647321391945`*^9}, {3.9186710146684227`*^9, 3.918671014773458*^9}, {
   3.9304661027650404`*^9, 3.930466233068865*^9}, {3.930466307250738*^9, 
   3.9304663975012894`*^9}, {3.9304664394012604`*^9, 3.930466466938199*^9}, {
   3.930466807492587*^9, 3.930466809181304*^9}, {3.9304669366020503`*^9, 
   3.930466971222889*^9}, {3.9304671010699344`*^9, 3.9304671574007263`*^9}, {
   3.930467921911873*^9, 3.930467978904624*^9}, {3.930470681806797*^9, 
   3.9304707221396165`*^9}, {3.9304915896574745`*^9, 3.930491589793442*^9}, {
   3.930500103200986*^9, 3.930500155023238*^9}, 3.9305500873505735`*^9, {
   3.934091840057723*^9, 3.934091865149926*^9}, {3.934092182831781*^9, 
   3.9340921831286273`*^9}, 3.9340983699307075`*^9, 3.9340984217950525`*^9, {
   3.9340991542867217`*^9, 3.9340991760094805`*^9}, {3.93409928117021*^9, 
   3.9340992864723296`*^9}, {3.934099640526923*^9, 3.9340996441618867`*^9}, {
   3.9341004968803587`*^9, 3.9341005244273043`*^9}, {3.93410074100461*^9, 
   3.934100757038024*^9}, {3.934100795618922*^9, 3.934100803647857*^9}, {
   3.934120547317546*^9, 3.9341205563231225`*^9}, {3.9341286838981867`*^9, 
   3.9341286839109273`*^9}, {3.9341287405640135`*^9, 
   3.9341287405786057`*^9}, {3.934129300252322*^9, 3.9341293005035286`*^9}, 
   3.9341306593722777`*^9, {3.9341340100435658`*^9, 3.934134041709943*^9}, 
   3.9345553190197973`*^9, {3.9345930952437353`*^9, 3.934593095259164*^9}, {
   3.9346053156699944`*^9, 3.9346053162178187`*^9}, {3.934606646222557*^9, 
   3.9346066724609065`*^9}, {3.9346997362469783`*^9, 3.934699739376977*^9}, {
   3.9346998455249395`*^9, 3.9346998456691055`*^9}, {3.934702141067733*^9, 
   3.934702141154849*^9}, {3.935134918401905*^9, 3.9351349184211054`*^9}},
 CellTags->"Evaluation",
 CellLabel->
  "In[190]:=",ExpressionUUID->"0387d079-c8f8-48b4-a3a7-d63945d99129"]
}, Closed]],

Cell[CellGroupData[{

Cell["A-la Altarelli-Parisi and Foroughi-Abari&Ritz", "Subsection",
 CellChangeTimes->{{3.9340922044890056`*^9, 3.934092205569416*^9}, {
  3.9340998631477447`*^9, 3.934099869809759*^9}, {3.9346045982943764`*^9, 
  3.9346046031743994`*^9}},ExpressionUUID->"9d54e504-28c9-45df-b85e-\
a11e0db269f2"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"\[Omega]splAP", "[", 
    RowBox[{
    "mp_", ",", "z_", ",", "pT_", ",", "Pp_", ",", "mX_", ",", "\[Epsilon]2_",
      ",", "\[Alpha]EM_"}], "]"}], "=", 
   RowBox[{
    FractionBox[
     RowBox[{"\[Alpha]EM", "*", "\[Epsilon]2"}], 
     RowBox[{"2", "Pi", "*", 
      RowBox[{"H1", "[", 
       RowBox[{"z", ",", "pT", ",", "mp", ",", "mX"}], "]"}]}]], 
    RowBox[{"(", 
     RowBox[{"z", "-", 
      RowBox[{"z", 
       RowBox[{"(", 
        RowBox[{"1", "-", "z"}], ")"}], 
       FractionBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", "*", 
           SuperscriptBox["mp", "2"]}], "+", 
          SuperscriptBox["mX", "2"]}], ")"}], 
        RowBox[{"H1", "[", 
         RowBox[{"z", ",", "pT", ",", "mp", ",", "mX"}], "]"}]]}], "+", 
      FractionBox[
       RowBox[{"H1", "[", 
        RowBox[{"z", ",", "pT", ",", "mp", ",", "mX"}], "]"}], 
       RowBox[{"2", "z", "*", 
        SuperscriptBox["mX", "2"]}]]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Omega]1eff", "[", 
    RowBox[{
    "mp_", ",", "z_", ",", "pT_", ",", "Pp_", ",", "mX_", ",", "\[Epsilon]2_",
      ",", "\[Alpha]EM_"}], "]"}], "=", 
   RowBox[{
    FractionBox[
     RowBox[{"\[Alpha]EM", "*", "\[Epsilon]2"}], 
     RowBox[{"2", "Pi", "*", 
      RowBox[{"H1", "[", 
       RowBox[{"z", ",", "pT", ",", "mp", ",", "mX"}], "]"}]}]], 
    RowBox[{"(", 
     RowBox[{
      FractionBox[
       RowBox[{"1", "+", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "-", "z"}], ")"}], "2"]}], "z"], "-", 
      RowBox[{"z", 
       RowBox[{"(", 
        RowBox[{"1", "-", "z"}], ")"}], 
       FractionBox[
        RowBox[{
         RowBox[{"2", 
          SuperscriptBox["mp", "2"]}], "+", 
         SuperscriptBox["mX", "2"]}], 
        RowBox[{"H1", "[", 
         RowBox[{"z", ",", "pT", ",", "mp", ",", "mV"}], "]"}]]}]}], 
     ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Omega]2eff", "[", 
    RowBox[{
    "mp_", ",", "z_", ",", "pT_", ",", "Pp_", ",", "mX_", ",", "\[Epsilon]2_",
      ",", "\[Alpha]EM_"}], "]"}], "=", 
   RowBox[{
    RowBox[{"\[Omega]1eff", "[", 
     RowBox[{
     "mp", ",", "z", ",", "pT", ",", "Pp", ",", "mX", ",", "\[Epsilon]2", ",",
       "\[Alpha]EM"}], "]"}], "+", 
    RowBox[{
     FractionBox[
      RowBox[{"\[Alpha]EM", "*", "\[Epsilon]2"}], 
      RowBox[{"4", "Pi", "*", 
       SuperscriptBox["mp", "2"]}]], 
     RowBox[{"(", 
      RowBox[{"1", "-", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", "z"}], ")"}], 
        FractionBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"4", "*", 
            SuperscriptBox["mp", "2"]}], "+", 
           SuperscriptBox["mX", "2"]}], ")"}], 
         RowBox[{"H1", "[", 
          RowBox[{"z", ",", "pT", ",", "mp", ",", "mX"}], "]"}]]}]}], ")"}], 
     "*", 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "z"], "-", 
       RowBox[{
        FractionBox["z", "4"], 
        FractionBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"4", 
            SuperscriptBox["mp", "2"]}], "-", 
           SuperscriptBox["mX", "2"]}], ")"}], 
         RowBox[{"H1", "[", 
          RowBox[{"z", ",", "pT", ",", "mp", ",", "mX"}], "]"}]]}]}], 
      ")"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Omega]12eff", "[", 
    RowBox[{
    "mp_", ",", "z_", ",", "pT_", ",", "Pp_", ",", "mX_", ",", "\[Epsilon]2_",
      ",", "\[Alpha]EM_"}], "]"}], "=", 
   RowBox[{
    FractionBox[
     RowBox[{"\[Alpha]EM", "*", "\[Epsilon]2"}], 
     RowBox[{"2", "Pi", "*", 
      RowBox[{"H1", "[", 
       RowBox[{"z", ",", "pT", ",", "mp", ",", "mX"}], "]"}]}]], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", "*", "z"}], "-", 
      RowBox[{"z", "*", 
       RowBox[{"(", 
        RowBox[{"1", "-", "z"}], ")"}], "*", 
       FractionBox[
        RowBox[{"3", "*", 
         SuperscriptBox["mX", "2"]}], 
        RowBox[{"H1", "[", 
         RowBox[{"z", ",", "pT", ",", "mp", ",", "mX"}], "]"}]]}]}], 
     ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"\[Omega]splFR", "[", 
      RowBox[{
      "mp_", ",", "z_", ",", "pT_", ",", "Pp_", ",", "mV_", ",", 
       "\[Epsilon]2_", ",", "\[Alpha]EM_", ",", "\[CapitalLambda]p_", ",", 
       "ff"}], "]"}], "=", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"Fvirtuality", "[", 
        RowBox[{
        "z", ",", "pT", ",", "mp", ",", "mV", ",", "\[CapitalLambda]p"}], 
        "]"}], "2"], "*", "2", "*", "pT", "*", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SuperscriptBox[
          RowBox[{"Abs", "[", 
           RowBox[{"F1", "[", 
            RowBox[{"mV", ",", "\"\<DP\>\"", ",", "ff"}], "]"}], "]"}], "2"], 
         "*", 
         RowBox[{"\[Omega]1eff", "[", 
          RowBox[{
          "mp", ",", "z", ",", "pT", ",", "Pp", ",", "mV", ",", "\[Epsilon]2",
            ",", "\[Alpha]EM"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"\[Omega]2eff", "[", 
          RowBox[{
          "mp", ",", "z", ",", "pT", ",", "Pp", ",", "mV", ",", "\[Epsilon]2",
            ",", "\[Alpha]EM"}], "]"}], "*", 
         SuperscriptBox[
          RowBox[{"Abs", "[", 
           RowBox[{"F2", "[", 
            RowBox[{"mV", ",", "\"\<DP\>\"", ",", "ff"}], "]"}], "]"}], 
          "2"]}], "+", 
        RowBox[{
         RowBox[{"\[Omega]12eff", "[", 
          RowBox[{
          "mp", ",", "z", ",", "pT", ",", "Pp", ",", "mV", ",", "\[Epsilon]2",
            ",", "\[Alpha]EM"}], "]"}], "*", 
         RowBox[{"Re", "[", 
          RowBox[{
           RowBox[{"F1", "[", 
            RowBox[{"mV", ",", "\"\<DP\>\"", ",", "ff"}], "]"}], "*", 
           RowBox[{"F2", "[", 
            RowBox[{"mV", ",", "\"\<DP\>\"", ",", "ff"}], "]"}]}], "]"}]}]}], 
       ")"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\[Omega]splAP", "[", 
      RowBox[{
      "mp_", ",", "z_", ",", "pT_", ",", "Pp_", ",", "mV_", ",", 
       "\[Epsilon]2_", ",", "\[Alpha]EM_", ",", "\[CapitalLambda]p_", ",", 
       "ff"}], "]"}], "=", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"Fvirtuality", "[", 
        RowBox[{
        "z", ",", "pT", ",", "mp", ",", "mV", ",", "\[CapitalLambda]p"}], 
        "]"}], "2"], "*", "2", "*", "pT", "*", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"FormFactorSquaredBrem", "[", 
         RowBox[{"mV", ",", "\"\<DP\>\""}], "]"}], "*", 
        RowBox[{"\[Omega]splAP", "[", 
         RowBox[{
         "mp", ",", "z", ",", "pT", ",", "Pp", ",", "mV", ",", "\[Epsilon]2", 
          ",", "\[Alpha]EM"}], "]"}]}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", ",", 
   RowBox[{"{", 
    RowBox[{"ff", ",", "uncertainties"}], "}"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "eminabs", ",", "emaxabs", ",", "pbeam", ",", "ptmax", ",", "norm", 
        ",", "distr", ",", "normdata"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"pbeam", "=", 
        RowBox[{"EmaxFacility", "[", "Facility", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"eminabs", "=", 
        RowBox[{"ELLPminBrem", "[", "Facility", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"emaxabs", "=", 
        RowBox[{
         RowBox[{"zMaxBrem", "[", "Facility", "]"}], "*", "pbeam"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"FluxBrem", "[", 
         RowBox[{
         "mV_", ",", "\[Theta]V_", ",", "EV_", ",", "\"\<DP\>\"", ",", 
          "\"\<FR\>\"", ",", "Facility", ",", "FormFactor", ",", 
          "\[CapitalLambda]p_"}], "]"}], "=", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"eminabs", "<=", "EV", "<=", "emaxabs"}], ",", 
          RowBox[{"Evaluate", "[", 
           RowBox[{
            RowBox[{"JacobianpTzToEV\[Theta]", "[", 
             RowBox[{"mV", ",", "EV", ",", "pbeam", ",", "\[Theta]V"}], "]"}],
             "*", 
            RowBox[{"\[Omega]splFR", "[", 
             RowBox[{
              RowBox[{"mSM", "[", "\"\<p\>\"", "]"}], ",", 
              RowBox[{"zvp", "[", 
               RowBox[{"EV", ",", "pbeam"}], "]"}], ",", 
              RowBox[{"pTv", "[", 
               RowBox[{"mV", ",", "EV", ",", "\[Theta]V"}], "]"}], ",", 
              "pbeam", ",", "mV", ",", "1", ",", "\[Alpha]EMval", ",", 
              "\[CapitalLambda]p", ",", "FormFactor"}], "]"}], "*", 
            RowBox[{"KinematicsApplicability\[Theta]E", "[", 
             RowBox[{"mV", ",", "\[Theta]V", ",", "EV", ",", "pbeam"}], "]"}],
             "*", 
            RowBox[{"\[Sigma]RatiosFit", "[", 
             RowBox[{"pbeam", ",", 
              RowBox[{"zvp", "[", 
               RowBox[{"EV", ",", "pbeam"}], "]"}]}], "]"}]}], "]"}], ",", 
          SuperscriptBox["10", 
           RowBox[{"-", "90."}]]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"FluxBrem", "[", 
         RowBox[{
         "mV_", ",", "\[Theta]V_", ",", "EV_", ",", "\"\<DP\>\"", ",", 
          "\"\<AP\>\"", ",", "Facility", ",", "FormFactor", ",", 
          "\[CapitalLambda]p_"}], "]"}], "=", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"eminabs", "<=", "EV", "<=", "emaxabs"}], ",", 
          RowBox[{"Evaluate", "[", 
           RowBox[{
            RowBox[{"JacobianpTzToEV\[Theta]", "[", 
             RowBox[{"mV", ",", "EV", ",", "pbeam", ",", "\[Theta]V"}], "]"}],
             "*", 
            RowBox[{"\[Omega]splAP", "[", 
             RowBox[{
              RowBox[{"mSM", "[", "\"\<p\>\"", "]"}], ",", 
              RowBox[{"zvp", "[", 
               RowBox[{"EV", ",", "pbeam"}], "]"}], ",", 
              RowBox[{"pTv", "[", 
               RowBox[{"mV", ",", "EV", ",", "\[Theta]V"}], "]"}], ",", 
              "pbeam", ",", "mV", ",", "1", ",", "\[Alpha]EMval", ",", 
              "\[CapitalLambda]p", ",", "FormFactor"}], "]"}], "*", 
            RowBox[{"KinematicsApplicability\[Theta]E", "[", 
             RowBox[{"mV", ",", "\[Theta]V", ",", "EV", ",", "pbeam"}], "]"}],
             "*", 
            RowBox[{"\[Sigma]RatiosFit", "[", 
             RowBox[{"pbeam", ",", 
              RowBox[{"zvp", "[", 
               RowBox[{"EV", ",", "pbeam"}], "]"}]}], "]"}]}], "]"}], ",", 
          SuperscriptBox["10", 
           RowBox[{"-", "90."}]]}], "]"}]}], ";"}]}], "\[IndentingNewLine]", 
     "]"}], "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{"Facility", ",", "FacilitiesList"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"FormFactor", ",", "uncertainties"}], "}"}]}], "]"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"scale", "=", "1"}], ";", "\[IndentingNewLine]", 
    RowBox[{"tabnorms", "=", 
     RowBox[{"Quiet", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"#", ",", 
          RowBox[{"NIntegrate", "[", 
           RowBox[{
            RowBox[{"FluxBrem", "[", 
             RowBox[{
             "#", ",", "\[Theta]V", ",", "EV", ",", "\"\<DP\>\"", ",", 
              "\"\<FR\>\"", ",", "\"\<SPS\>\"", ",", "\"\<Central\>\"", ",", 
              "scale"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"\[Theta]V", ",", 
              SuperscriptBox["10", 
               RowBox[{"-", "5."}]], ",", "0.02"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"EV", ",", 
              RowBox[{"ELLPminBrem", "[", "\"\<SPS\>\"", "]"}], ",", 
              RowBox[{
               RowBox[{"zMaxBrem", "[", "\"\<SPS\>\"", "]"}], "*", "400"}]}], 
             "}"}], ",", 
            RowBox[{"Method", "->", "\"\<AdaptiveMonteCarlo\>\""}]}], "]"}], 
          ",", 
          RowBox[{"NIntegrate", "[", 
           RowBox[{
            RowBox[{"FluxBrem", "[", 
             RowBox[{
             "#", ",", "\[Theta]V", ",", "EV", ",", "\"\<DP\>\"", ",", 
              "\"\<FR\>\"", ",", "\"\<SPS\>\"", ",", "\"\<Lower\>\"", ",", 
              "scale"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"\[Theta]V", ",", 
              SuperscriptBox["10", 
               RowBox[{"-", "5."}]], ",", "0.02"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"EV", ",", 
              RowBox[{"ELLPminBrem", "[", "\"\<SPS\>\"", "]"}], ",", 
              RowBox[{
               RowBox[{"zMaxBrem", "[", "\"\<SPS\>\"", "]"}], "*", "400"}]}], 
             "}"}], ",", 
            RowBox[{"Method", "->", "\"\<AdaptiveMonteCarlo\>\""}]}], "]"}], 
          ",", 
          RowBox[{"NIntegrate", "[", 
           RowBox[{
            RowBox[{"FluxBrem", "[", 
             RowBox[{
             "#", ",", "\[Theta]V", ",", "EV", ",", "\"\<DP\>\"", ",", 
              "\"\<FR\>\"", ",", "\"\<SPS\>\"", ",", "\"\<Upper\>\"", ",", 
              "scale"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"\[Theta]V", ",", 
              SuperscriptBox["10", 
               RowBox[{"-", "5."}]], ",", "0.02"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"EV", ",", 
              RowBox[{"ELLPminBrem", "[", "\"\<SPS\>\"", "]"}], ",", 
              RowBox[{
               RowBox[{"zMaxBrem", "[", "\"\<SPS\>\"", "]"}], "*", "400"}]}], 
             "}"}], ",", 
            RowBox[{"Method", "->", "\"\<AdaptiveMonteCarlo\>\""}]}], "]"}], 
          ",", 
          RowBox[{"NIntegrate", "[", 
           RowBox[{
            RowBox[{"FluxBrem", "[", 
             RowBox[{
             "#", ",", "\[Theta]V", ",", "EV", ",", "\"\<DP\>\"", ",", 
              "\"\<Baseline\>\"", ",", "\"\<SPS\>\""}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"\[Theta]V", ",", 
              SuperscriptBox["10", 
               RowBox[{"-", "5."}]], ",", "0.02"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"EV", ",", 
              RowBox[{"ELLPminBrem", "[", "\"\<SPS\>\"", "]"}], ",", 
              RowBox[{"Min", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"zMaxBrem", "[", "\"\<SPS\>\"", "]"}], "*", "400"}], 
                ",", 
                FractionBox["4", 
                 RowBox[{"Sin", "[", "\[Theta]V", "]"}]]}], "]"}]}], "}"}], 
            ",", 
            RowBox[{"Method", "->", "\"\<AdaptiveMonteCarlo\>\""}]}], "]"}]}],
          "}"}], "&"}], "/@", 
       RowBox[{"{", 
        RowBox[{
        "0.02", ",", "0.05", ",", "0.1", ",", "0.2", ",", "0.3", ",", "0.4", 
         ",", "0.5", ",", "0.6", ",", "0.7", ",", "0.72", ",", "0.75", ",", 
         "0.76", ",", "0.77", ",", "0.775", ",", "0.777", ",", "0.78", ",", 
         "0.785", ",", "0.79", ",", "0.8", ",", "0.81", ",", "0.82", ",", 
         "0.83", ",", "0.85", ",", "0.87", ",", "0.89", ",", "0.9", ",", 
         "0.92", ",", "0.93", ",", "0.95", ",", "0.97", ",", "1.", ",", 
         "1.01", ",", "1.015", ",", "1.02", ",", "1.025", ",", "1.03", ",", 
         "1.04", ",", "1.05", ",", "1.07", ",", "1.1", ",", "1.15", ",", 
         "1.2", ",", "1.25", ",", "1.3", ",", "1.35", ",", "1.4", ",", 
         "1.45"}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"ListLogPlot", "[", 
     RowBox[{
      RowBox[{"Evaluate", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"tabnorms", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", "#"}], "}"}]}], "]"}], "]"}], "&"}], "/@", 
        RowBox[{"{", 
         RowBox[{"2", ",", "3", ",", "4", ",", "5"}], "}"}]}], "]"}], ",", 
      RowBox[{"Joined", "->", "True"}], ",", 
      RowBox[{"Filling", "->", 
       RowBox[{"{", 
        RowBox[{"2", "->", 
         RowBox[{"{", 
          RowBox[{"3", ",", 
           RowBox[{"Opacity", "[", "0.1", "]"}]}], "}"}]}], "}"}]}]}], 
     "]"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"facc", "=", "\"\<SPS\>\""}], ";", "\[IndentingNewLine]", 
    RowBox[{"\[CapitalLambda]pv", "=", "0.5"}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "\[Theta]maxAbsV", ",", "\[Theta]gridBremV", ",", "ELLPgridBremV"}], 
      "}"}], "=", 
     RowBox[{"GridBremAP", "[", 
      RowBox[{"\[CapitalLambda]pv", ",", "facc"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"normdata", "=", 
     RowBox[{"ParallelTable", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"mV", ",", 
         RowBox[{"Quiet", "[", 
          RowBox[{"NIntegrate", "[", 
           RowBox[{
            RowBox[{"FluxBrem", "[", 
             RowBox[{
             "mV", ",", "\[Theta]V", ",", "EV", ",", "\"\<DP\>\"", ",", 
              "\"\<FR\>\"", ",", "facc", ",", "\"\<Central\>\"", ",", 
              "\[CapitalLambda]pv"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"\[Theta]V", ",", "0", ",", "\[Theta]maxAbsV"}], "}"}], 
            ",", 
            RowBox[{"{", 
             RowBox[{"EV", ",", 
              RowBox[{
               RowBox[{"zMinBrem", "[", "facc", "]"}], "*", 
               RowBox[{"EmaxFacility", "[", "facc", "]"}]}], ",", 
              RowBox[{"ELLPmaxBremAP", "[", 
               RowBox[{
               "facc", ",", "mV", ",", "\[Theta]V", ",", 
                "\[CapitalLambda]pv"}], "]"}]}], "}"}], ",", 
            RowBox[{"Method", "->", "\"\<AdaptiveMonteCarlo\>\""}]}], "]"}], 
          "]"}], ",", 
         RowBox[{"Quiet", "[", 
          RowBox[{"NIntegrate", "[", 
           RowBox[{
            RowBox[{"FluxBrem", "[", 
             RowBox[{
             "mV", ",", "\[Theta]V", ",", "EV", ",", "\"\<DP\>\"", ",", 
              "\"\<FR\>\"", ",", "\"\<SPS\>\"", ",", "\"\<Upper\>\"", ",", 
              "\[CapitalLambda]pv"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"\[Theta]V", ",", 
              SuperscriptBox["10", 
               RowBox[{"-", "5."}]], ",", "0.2"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"EV", ",", 
              RowBox[{
               RowBox[{"zMinBrem", "[", "facc", "]"}], "*", 
               RowBox[{"EmaxFacility", "[", "facc", "]"}]}], ",", 
              RowBox[{
               RowBox[{"zMaxBrem", "[", "\"\<SPS\>\"", "]"}], "*", 
               RowBox[{"EmaxFacility", "[", "facc", "]"}]}]}], "}"}], ",", 
            RowBox[{"Method", "->", "\"\<AdaptiveMonteCarlo\>\""}]}], "]"}], 
          "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"mV", ",", 
         RowBox[{"{", "1.", "}"}]}], "}"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "*)"}]}]}], "Input",
 CellChangeTimes->{{3.934093586567132*^9, 3.9340936284184394`*^9}, {
   3.934093665469143*^9, 3.934093680259837*^9}, {3.9340983519267817`*^9, 
   3.934098354185608*^9}, {3.934098877129713*^9, 3.9340989546712775`*^9}, {
   3.934098988194278*^9, 3.9340989909955015`*^9}, {3.9340992192901816`*^9, 
   3.934099273018852*^9}, {3.934099307562952*^9, 3.934099460456751*^9}, {
   3.9340995137824097`*^9, 3.9340996516519117`*^9}, {3.934099714533742*^9, 
   3.934099785671074*^9}, {3.9341001437119045`*^9, 3.9341001486255436`*^9}, {
   3.9341008315187154`*^9, 3.934100843959175*^9}, {3.934101322644637*^9, 
   3.9341013242220383`*^9}, {3.9341013736729717`*^9, 
   3.9341013907936115`*^9}, {3.934118983318472*^9, 3.934118993936229*^9}, {
   3.9341196406882973`*^9, 3.934119649608379*^9}, {3.934119787881878*^9, 
   3.9341198927245073`*^9}, {3.9341199787175536`*^9, 3.934119979017297*^9}, {
   3.934120036449155*^9, 3.934120040829156*^9}, {3.9341201075706806`*^9, 
   3.9341201211411543`*^9}, {3.9341203340570803`*^9, 3.934120335417302*^9}, {
   3.9341203920281277`*^9, 3.9341203920684896`*^9}, {3.934120882736723*^9, 
   3.934120883016844*^9}, {3.9341209259940653`*^9, 3.9341209387990603`*^9}, {
   3.9341213628484993`*^9, 3.9341214204912667`*^9}, {3.9341221539428167`*^9, 
   3.934122154185938*^9}, {3.934128904514032*^9, 3.9341289058343697`*^9}, {
   3.9341306588120832`*^9, 3.934130658842368*^9}, {3.9341316791304865`*^9, 
   3.934131686975326*^9}, {3.9345552891457925`*^9, 3.9345553190197973`*^9}, {
   3.934555465132079*^9, 3.934555484957498*^9}, {3.934592927276572*^9, 
   3.934592939651337*^9}, {3.934593095259164*^9, 3.934593095275039*^9}, {
   3.9346045396032376`*^9, 3.9346045538435664`*^9}, {3.934604608904688*^9, 
   3.9346046550253716`*^9}, 3.934604716166666*^9, {3.9346066852804556`*^9, 
   3.9346066867920184`*^9}, {3.934700047398975*^9, 3.9347000522140293`*^9}, {
   3.934700104184679*^9, 3.9347001042249455`*^9}, {3.935131339284039*^9, 
   3.935131350791644*^9}, 3.9351349184355955`*^9, 3.9404360129862976`*^9, {
   3.9404361678690624`*^9, 3.9404361688712826`*^9}},
 CellLabel->
  "In[192]:=",ExpressionUUID->"cd7db6f2-2373-46ae-b391-0ee9695761c8"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Scalar", "Section",
 CellChangeTimes->{{3.934099847347184*^9, 3.934099850297454*^9}, {
  3.934101043904232*^9, 
  3.9341010446141853`*^9}},ExpressionUUID->"ce0060d4-1e35-4b0a-adc4-\
b0e500a607fb"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"GSNN", "=", 
   RowBox[{"1.2", "*", 
    SuperscriptBox["10", 
     RowBox[{"-", "3"}]]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Msplit", "=", 
    RowBox[{
     RowBox[{
      SqrtBox["\[Theta]2"], "gppS", "*", 
      RowBox[{
       RowBox[{"SpinorUBar", "[", 
        RowBox[{"ppfin", ",", "mp"}], "]"}], ".", 
       RowBox[{"SpinorU", "[", 
        RowBox[{"ppini", ",", "mp"}], "]"}]}]}], "//", "Contract"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Squared", " ", "matrix", " ", "element", " ", "for", " ", "the", " ", 
    "splitting"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Msplit2", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"FermionSpinSum", "[", 
       RowBox[{"Msplit", "*", 
        RowBox[{"ComplexConjugate", "[", "Msplit", "]"}]}], "]"}], "/.", 
      RowBox[{"DiracTrace", "\[Rule]", "TR"}]}], "//", "Contract"}], "//", 
    "Simplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Msplit2", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"Msplit2", "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"ScalarProduct", "[", 
           RowBox[{"pX", ",", "pX"}], "]"}], "->", 
          SuperscriptBox["mX", "2"]}], ",", 
         RowBox[{
          RowBox[{"ScalarProduct", "[", 
           RowBox[{"ppfin", ",", "ppini"}], "]"}], "->", 
          "ppToppprimeApprox"}]}], "}"}]}], "//", "Expand"}], "//", 
     "Simplify"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Expression", " ", "for", " ", "the", " ", "splitting", " ", "probability",
     " ", 
    SuperscriptBox["d", "2"], 
    RowBox[{
     SubscriptBox["P", "spl"], "/", 
     SuperscriptBox[
      SubscriptBox["dp", "T"], "2"]}], "dz", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"compare", " ", "to", " ", 
       RowBox[{"Eq", ".", " ", "D22"}], " ", "of", " ", 
       RowBox[{"https", ":"}]}], "//", 
      RowBox[{
       RowBox[{
        RowBox[{"arxiv", ".", "org"}], "/", "pdf"}], "/", "1904.10447"}]}], 
     ")"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"\[Omega]splS", "[", 
       RowBox[{
       "mp_", ",", "z_", ",", "pT_", ",", "Pp_", ",", "mX_", ",", 
        "\[Theta]2_", ",", "gppS_", ",", "\[CapitalLambda]p_", ",", "ff"}], 
       "]"}], "=", 
      RowBox[{
       RowBox[{
        SuperscriptBox[
         RowBox[{"Fvirtuality", "[", 
          RowBox[{
          "z", ",", "pT", ",", "mp", ",", "mX", ",", "\[CapitalLambda]p"}], 
          "]"}], "2"], "*", 
        RowBox[{"FormFactorSquaredBrem", "[", 
         RowBox[{"mX", ",", "\"\<Scalar\>\""}], "]"}], 
        FractionBox["1", 
         RowBox[{"16", 
          SuperscriptBox["Pi", "2"], "z"}]], 
        FractionBox["Msplit2", 
         RowBox[{"4", "*", 
          RowBox[{"(", 
           RowBox[{"EpprimeApprox", "/.", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"mp", "->", "0"}], ",", 
              RowBox[{"pT", "->", "0"}]}], "}"}]}], ")"}], "*", 
          RowBox[{"(", 
           RowBox[{"EpApprox", "/.", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"mp", "->", "0"}], ",", 
              RowBox[{"pT", "->", "0"}]}], "}"}]}], ")"}], "*", 
          SuperscriptBox["\[CapitalDelta]EdominateDiagram", "2"]}]]}], "//", 
       "Simplify"}]}], ";"}], "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{"ff", ",", 
      RowBox[{
       RowBox[{"Keys", "[", 
        RowBox[{"DownValues", "@", "F1"}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "1", ",", 
         RowBox[{"-", "1"}]}], "]"}], "]"}]}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Producing", " ", "normalized", " ", "distribution", " ", "and", " ", 
    "normalization", " ", 
    RowBox[{"(", 
     RowBox[{"==", 
      RowBox[{"total", " ", "flux"}]}], ")"}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "eminabs", ",", "emaxabs", ",", "pbeam", ",", "ptmax", ",", "norm", ",", 
       RowBox[{"(*", 
        RowBox[{"distr", ","}], "*)"}], "normdata"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"pbeam", "=", 
       RowBox[{"EmaxFacility", "[", "Facility", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"eminabs", "=", 
       RowBox[{"ELLPminBrem", "[", "Facility", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"emaxabs", "=", 
       RowBox[{
        RowBox[{"zMaxBrem", "[", "Facility", "]"}], "*", "pbeam"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ptmax", "=", 
       RowBox[{"pTmaxBrem", "[", "Facility", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"FluxBrem", "[", 
           RowBox[{
           "mV_", ",", "\[Theta]V_", ",", "EV_", ",", "\"\<Scalar\>\"", ",", 
            "\"\<AP\>\"", ",", "Facility", ",", "ff", ",", 
            "\[CapitalLambda]p_"}], "]"}], "=", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"eminabs", "<=", "EV", "<=", "emaxabs"}], ",", 
            RowBox[{"Evaluate", "[", 
             RowBox[{
              RowBox[{"JacobianpTzToEV\[Theta]", "[", 
               RowBox[{"mV", ",", "EV", ",", "pbeam", ",", "\[Theta]V"}], 
               "]"}], "*", 
              RowBox[{"\[Omega]splS", "[", 
               RowBox[{
                RowBox[{"mSM", "[", "\"\<p\>\"", "]"}], ",", 
                RowBox[{"zvp", "[", 
                 RowBox[{"EV", ",", "pbeam"}], "]"}], ",", 
                RowBox[{"pTv", "[", 
                 RowBox[{"mV", ",", "EV", ",", "\[Theta]V"}], "]"}], ",", 
                "pbeam", ",", "mV", ",", "1", ",", "GSNN", ",", 
                "\[CapitalLambda]p", ",", "ff"}], "]"}], "*", 
              RowBox[{"KinematicsApplicability\[Theta]E", "[", 
               RowBox[{"mV", ",", "\[Theta]V", ",", "EV", ",", "pbeam"}], 
               "]"}], "*", 
              RowBox[{"\[Sigma]RatiosFit", "[", 
               RowBox[{"pbeam", ",", 
                RowBox[{"zvp", "[", 
                 RowBox[{"EV", ",", "pbeam"}], "]"}]}], "]"}]}], "]"}], ",", 
            SuperscriptBox["10", 
             RowBox[{"-", "90."}]]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
        ",", 
        RowBox[{"{", 
         RowBox[{"ff", ",", "uncertainties"}], "}"}]}], "]"}]}]}], 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"normdata", "=", 
       RowBox[{"ParallelTable", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"mV", ",", 
           RowBox[{"NIntegrate", "[", 
            RowBox[{
             RowBox[{"distr", "[", 
              RowBox[{"mV", ",", "\[Theta]V", ",", "EV"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"\[Theta]V", ",", "0", ",", 
               RowBox[{"\[Theta]maxBremBaseline", "[", "Facility", "]"}]}], 
              "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"EV", ",", "eminabs", ",", 
               RowBox[{"Max", "[", 
                RowBox[{"eminabs", ",", 
                 RowBox[{"ELLPmaxBremBaseline", "[", 
                  RowBox[{"Facility", ",", "mV", ",", "\[Theta]V"}], "]"}]}], 
                "]"}]}], "}"}], ",", 
             RowBox[{"Method", "\[Rule]", "\"\<AdaptiveMonteCarlo\>\""}]}], 
            "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"mV", ",", "mVminFromBrem", ",", "mVmaxFromBrem", ",", 
           FractionBox[
            RowBox[{"(", 
             RowBox[{"mVmaxFromBrem", "-", "mVminFromBrem"}], ")"}], "20"]}], 
          "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"norm", "[", "mV_", "]"}], "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Interpolation", "[", 
          RowBox[{
           RowBox[{"normdata", "//", "Log"}], ",", 
           RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[", 
         RowBox[{"Log", "[", "mV", "]"}], "]"}], "//", "Exp"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"DoubleDistrBrem", "[", 
        RowBox[{
        "mV_", ",", "\[Theta]V_", ",", "EV_", ",", "\"\<Scalar\>\"", ",", 
         "Facility"}], "]"}], "=", 
       FractionBox[
        RowBox[{"distr", "[", 
         RowBox[{"mV", ",", "\[Theta]V", ",", "EV"}], "]"}], 
        RowBox[{"norm", "[", "mV", "]"}]]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"NormalizationBremScalar", "[", 
        RowBox[{"mV_", ",", "Facility"}], "]"}], "=", 
       RowBox[{
        RowBox[{"norm", "[", "mV", "]"}], "*", 
        RowBox[{"BremFormFactorSquared", "[", "mV", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Export", "[", 
       RowBox[{
        RowBox[{"FileNameJoin", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"NotebookDirectory", "[", "]"}], ",", 
           "\"\<phenomenology/Scalar/Production probabilities/Pbrem.m\>\""}], 
          "}"}], "]"}], ",", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"Facility", ",", 
            RowBox[{"NormalizationBremScalar", "[", 
             RowBox[{"mS", ",", "Facility"}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"Facility", ",", "FacilitiesList"}], "}"}]}], "]"}], ",", 
        "\"\<MX\>\""}], "]"}]}], "*)"}], "\[IndentingNewLine]", "]"}], 
   "\[IndentingNewLine]", ",", 
   RowBox[{"{", 
    RowBox[{"Facility", ",", "FacilitiesList"}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.934119015599255*^9, 3.9341190979715*^9}, 
   3.9341193302936115`*^9, {3.9341236363963327`*^9, 3.934123667117241*^9}, {
   3.9341256148917866`*^9, 3.9341256320836043`*^9}, {3.934128683917869*^9, 
   3.934128683917869*^9}, 3.9341287405840797`*^9, 3.934130658842368*^9, 
   3.934555301249134*^9, {3.934592945753924*^9, 3.9345929753312798`*^9}, {
   3.934593031555997*^9, 3.93459305352421*^9}, {3.9345931712186627`*^9, 
   3.9345933247276087`*^9}, {3.9345933610948553`*^9, 3.93459339694382*^9}, 
   3.9345946568158727`*^9, 3.934606691063442*^9, {3.934699427406783*^9, 
   3.9346994328011365`*^9}, {3.9351349184447703`*^9, 3.935134918446771*^9}, {
   3.940436178445593*^9, 3.9404361791766033`*^9}},
 CellLabel->
  "In[198]:=",ExpressionUUID->"291c9321-ad9e-416b-9575-3d59cb89f570"]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[Cell[BoxData[
 FormBox[
  RowBox[{"B", "-", 
   SubscriptBox["L", "\[Alpha]"]}], 
  TraditionalForm]],ExpressionUUID->"d2b13f7f-9594-4492-bd4d-8e6b44fee0dc"]], \
"Section",
 CellChangeTimes->{{3.934099847347184*^9, 3.934099859559382*^9}, {
  3.934100000011305*^9, 
  3.934100004441785*^9}},ExpressionUUID->"8b9abd4f-3583-4814-9a5d-\
043b6f505e74"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"\[Omega]splBaselineBL", "[", 
     RowBox[{
     "mp_", ",", "z_", ",", "pT_", ",", "Pp_", ",", "mV_", ",", 
      "\[Alpha]B_"}], "]"}], "=", 
    RowBox[{
     FractionBox[
      RowBox[{"2", "*", "pT", "*", "4", "*", "Pi", "*", "\[Alpha]B"}], 
      RowBox[{"2", "*", "Pi", "*", 
       RowBox[{"H1", "[", 
        RowBox[{"z", ",", "pT", ",", "mp", ",", "mV"}], "]"}]}]], "*", 
     RowBox[{"(", 
      RowBox[{
       FractionBox[
        RowBox[{"(", 
         RowBox[{"1", "+", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"1", "-", "z"}], ")"}], "2"]}], ")"}], "z"], "-", 
       RowBox[{"2", "*", "z", "*", 
        RowBox[{"(", 
         RowBox[{"1", "-", "z"}], ")"}], "*", 
        RowBox[{"(", 
         RowBox[{
          FractionBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", "*", 
              SuperscriptBox["mp", "2"]}], "+", 
             SuperscriptBox["mV", "2"]}], ")"}], 
           RowBox[{"H1", "[", 
            RowBox[{"z", ",", "pT", ",", "mp", ",", "mV"}], "]"}]], "-", 
          FractionBox[
           RowBox[{
            SuperscriptBox["z", "2"], "*", "2", "*", 
            SuperscriptBox["mp", "4"]}], 
           SuperscriptBox[
            RowBox[{"H1", "[", 
             RowBox[{"z", ",", "pT", ",", "mp", ",", "mV"}], "]"}], "2"]]}], 
         ")"}]}], "+", 
       FractionBox[
        RowBox[{"2", "*", "z", "*", 
         RowBox[{"(", 
          RowBox[{"1", "-", "z"}], ")"}], "*", 
         RowBox[{"(", 
          RowBox[{"1", "+", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"1", "-", "z"}], ")"}], "2"]}], ")"}], "*", 
         SuperscriptBox["mp", "2"], "*", 
         SuperscriptBox["mV", "2"]}], 
        SuperscriptBox[
         RowBox[{"H1", "[", 
          RowBox[{"z", ",", "pT", ",", "mp", ",", "mV"}], "]"}], "2"]], "+", 
       FractionBox[
        RowBox[{"2", "*", "z", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"1", "-", "z"}], ")"}], "2"], 
         SuperscriptBox["mV", "4"]}], 
        SuperscriptBox[
         RowBox[{"H1", "[", 
          RowBox[{"z", ",", "pT", ",", "mp", ",", "mV"}], "]"}], "2"]]}], 
      ")"}], "*", 
     RowBox[{"FormFactorSquaredBrem", "[", 
      RowBox[{"mV", ",", "\"\<B-L\>\""}], "]"}]}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"A", "-", 
     RowBox[{"la", " ", "Altarelli"}], "-", "Parisi"}], ",", " ", 
    RowBox[{"see", " ", "1904.10447", " ", "and", " ", "2108.05900"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"\[Omega]splAPBL", "[", 
     RowBox[{
     "mp_", ",", "z_", ",", "pT_", ",", "Pp_", ",", "mV_", ",", "\[Alpha]B_", 
      ",", "\[CapitalLambda]p_"}], "]"}], "=", 
    RowBox[{"2", "*", "pT", "*", 
     RowBox[{"\[Omega]splAP", "[", 
      RowBox[{"mp", ",", "z", ",", "pT", ",", "Pp", ",", "mV", ",", "1", ",", 
       RowBox[{"4", "*", "Pi", "*", "\[Alpha]B"}]}], "]"}], "*", 
     SuperscriptBox[
      RowBox[{"Fvirtuality", "[", 
       RowBox[{
       "z", ",", "pT", ",", "mp", ",", "mV", ",", "\[CapitalLambda]p"}], 
       "]"}], "2"], "*", 
     RowBox[{"FormFactorSquaredBrem", "[", 
      RowBox[{"mV", ",", "\"\<B-L\>\""}], "]"}]}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"A", "-", 
    RowBox[{"la", " ", "Foroughi"}], "-", "Ritz"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"\[Omega]splFRBL", "[", 
      RowBox[{
      "mp_", ",", "z_", ",", "pT_", ",", "Pp_", ",", "mV_", ",", "\[Alpha]B_",
        ",", "\[CapitalLambda]p_", ",", "ff"}], "]"}], "=", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"Fvirtuality", "[", 
        RowBox[{
        "z", ",", "pT", ",", "mp", ",", "mV", ",", "\[CapitalLambda]p"}], 
        "]"}], "2"], "*", "2", "*", "pT", "*", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SuperscriptBox[
          RowBox[{"Abs", "[", 
           RowBox[{"F1", "[", 
            RowBox[{"mV", ",", "fipname", ",", "ff"}], "]"}], "]"}], "2"], 
         "*", 
         RowBox[{"\[Omega]1eff", "[", 
          RowBox[{
          "mp", ",", "z", ",", "pT", ",", "Pp", ",", "mV", ",", "1", ",", 
           RowBox[{"4", "Pi", "*", "\[Alpha]B"}]}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"\[Omega]2eff", "[", 
          RowBox[{
          "mp", ",", "z", ",", "pT", ",", "Pp", ",", "mV", ",", "1", ",", 
           RowBox[{"4", "Pi", "*", "\[Alpha]B"}]}], "]"}], "*", 
         SuperscriptBox[
          RowBox[{"Abs", "[", 
           RowBox[{"F2", "[", 
            RowBox[{"mV", ",", "fipname", ",", "ff"}], "]"}], "]"}], "2"]}], 
        "+", 
        RowBox[{
         RowBox[{"\[Omega]12eff", "[", 
          RowBox[{
          "mp", ",", "z", ",", "pT", ",", "Pp", ",", "mV", ",", "1", ",", 
           RowBox[{"4", "Pi", "*", "\[Alpha]B"}]}], "]"}], "*", 
         RowBox[{"Re", "[", 
          RowBox[{
           RowBox[{"F1", "[", 
            RowBox[{"mV", ",", "fipname", ",", "ff"}], "]"}], "*", 
           RowBox[{"F2", "[", 
            RowBox[{"mV", ",", "fipname", ",", "ff"}], "]"}]}], "]"}]}]}], 
       ")"}]}]}], ";"}], "\[IndentingNewLine]", ",", 
   RowBox[{"{", 
    RowBox[{"fipname", ",", "BLlist"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"ff", ",", "uncertainties"}], "}"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Producing", " ", "normalized", " ", "distribution", " ", "and", " ", 
     "normalization", " ", 
     RowBox[{"(", 
      RowBox[{"==", 
       RowBox[{"total", " ", "flux"}]}], ")"}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "eminabs", ",", "emaxabs", ",", "pbeam", ",", "ptmax", ",", "norm", 
        ",", "distr", ",", "normdata", ",", "LLPname"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"LLPname", "=", "fipname"}], ";", "\[IndentingNewLine]", 
       RowBox[{"pbeam", "=", 
        RowBox[{"EmaxFacility", "[", "Facility", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"eminabs", "=", 
        RowBox[{"ELLPminBrem", "[", "Facility", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"emaxabs", "=", 
        RowBox[{
         RowBox[{"zMaxBrem", "[", "Facility", "]"}], "*", "pbeam"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"ptmax", "=", 
        RowBox[{"pTmaxBrem", "[", "Facility", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Double", " ", "distribution", " ", "for", " ", 
          RowBox[{"bremsstrahlung", ".", " ", "The"}], " ", "cut", " ", "E"}],
          "<=", 
         RowBox[{
          SubscriptBox["E", "max"], 
          RowBox[{"(", "\[Theta]", ")"}], " ", "is", " ", "not", " ", 
          "included", " ", "for", " ", "more", " ", "robust", " ", "work", 
          " ", "with", " ", "tabulating", " ", "the", " ", "distribution"}]}],
         "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"FluxBrem", "[", 
         RowBox[{
         "mV_", ",", "\[Theta]V_", ",", "EV_", ",", "LLPname", ",", 
          "\"\<Baseline\>\"", ",", "Facility"}], "]"}], "=", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"\[Theta]V", "<=", 
            RowBox[{"\[Theta]maxBremBaseline", "[", "Facility", "]"}]}], "&&", 
           RowBox[{"EV", ">", "eminabs"}]}], ",", 
          RowBox[{"Evaluate", "[", 
           RowBox[{
            RowBox[{"JacobianpTzToEV\[Theta]", "[", 
             RowBox[{"mV", ",", "EV", ",", "pbeam", ",", "\[Theta]V"}], "]"}],
             "*", 
            RowBox[{"\[Omega]splBaselineBL", "[", 
             RowBox[{
              RowBox[{"mSM", "[", "\"\<p\>\"", "]"}], ",", 
              RowBox[{"zvp", "[", 
               RowBox[{"EV", ",", "pbeam"}], "]"}], ",", 
              RowBox[{"pTv", "[", 
               RowBox[{"mV", ",", "EV", ",", "\[Theta]V"}], "]"}], ",", 
              "pbeam", ",", "mV", ",", "1"}], "]"}], "*", 
            RowBox[{"KinematicsApplicability\[Theta]E", "[", 
             RowBox[{"mV", ",", "\[Theta]V", ",", "EV", ",", "pbeam"}], "]"}],
             "*", 
            RowBox[{"\[Sigma]RatiosFit", "[", 
             RowBox[{"pbeam", ",", 
              RowBox[{"zvp", "[", 
               RowBox[{"EV", ",", "pbeam"}], "]"}]}], "]"}]}], "]"}], ",", 
          SuperscriptBox["10", 
           RowBox[{"-", "90."}]]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"FluxBrem", "[", 
            RowBox[{
            "mV_", ",", "\[Theta]V_", ",", "EV_", ",", "LLPname", ",", 
             "\"\<FR\>\"", ",", "Facility", ",", "ff", ",", 
             "\[CapitalLambda]p_"}], "]"}], "=", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"eminabs", "<=", "EV", "<=", "emaxabs"}], ",", 
             RowBox[{"Evaluate", "[", 
              RowBox[{
               RowBox[{"JacobianpTzToEV\[Theta]", "[", 
                RowBox[{"mV", ",", "EV", ",", "pbeam", ",", "\[Theta]V"}], 
                "]"}], "*", 
               RowBox[{"\[Omega]splFRBL", "[", 
                RowBox[{
                 RowBox[{"mSM", "[", "\"\<p\>\"", "]"}], ",", 
                 RowBox[{"zvp", "[", 
                  RowBox[{"EV", ",", "pbeam"}], "]"}], ",", 
                 RowBox[{"pTv", "[", 
                  RowBox[{"mV", ",", "EV", ",", "\[Theta]V"}], "]"}], ",", 
                 "pbeam", ",", "mV", ",", "1", ",", "\[CapitalLambda]p", ",", 
                 "ff"}], "]"}], "*", 
               RowBox[{"KinematicsApplicability\[Theta]E", "[", 
                RowBox[{"mV", ",", "\[Theta]V", ",", "EV", ",", "pbeam"}], 
                "]"}], "*", 
               RowBox[{"\[Sigma]RatiosFit", "[", 
                RowBox[{"pbeam", ",", 
                 RowBox[{"zvp", "[", 
                  RowBox[{"EV", ",", "pbeam"}], "]"}]}], "]"}]}], "]"}], ",", 
             SuperscriptBox["10", 
              RowBox[{"-", "90."}]]}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"FluxBrem", "[", 
            RowBox[{
            "mV_", ",", "\[Theta]V_", ",", "EV_", ",", "LLPname", ",", 
             "\"\<AP\>\"", ",", "Facility", ",", "ff", ",", 
             "\[CapitalLambda]p_"}], "]"}], "=", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"eminabs", "<=", "EV", "<=", "emaxabs"}], ",", 
             RowBox[{"Evaluate", "[", 
              RowBox[{
               RowBox[{"JacobianpTzToEV\[Theta]", "[", 
                RowBox[{"mV", ",", "EV", ",", "pbeam", ",", "\[Theta]V"}], 
                "]"}], "*", 
               RowBox[{"\[Omega]splAPBL", "[", 
                RowBox[{
                 RowBox[{"mSM", "[", "\"\<p\>\"", "]"}], ",", 
                 RowBox[{"zvp", "[", 
                  RowBox[{"EV", ",", "pbeam"}], "]"}], ",", 
                 RowBox[{"pTv", "[", 
                  RowBox[{"mV", ",", "EV", ",", "\[Theta]V"}], "]"}], ",", 
                 "pbeam", ",", "mV", ",", "1", ",", "\[CapitalLambda]p"}], 
                "]"}], "*", 
               RowBox[{"KinematicsApplicability\[Theta]E", "[", 
                RowBox[{"mV", ",", "\[Theta]V", ",", "EV", ",", "pbeam"}], 
                "]"}], "*", 
               RowBox[{"\[Sigma]RatiosFit", "[", 
                RowBox[{"pbeam", ",", 
                 RowBox[{"zvp", "[", 
                  RowBox[{"EV", ",", "pbeam"}], "]"}]}], "]"}]}], "]"}], ",", 
             SuperscriptBox["10", 
              RowBox[{"-", "90."}]]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
         ",", 
         RowBox[{"{", 
          RowBox[{"ff", ",", "uncertainties"}], "}"}]}], "]"}], ";"}]}], 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{
        RowBox[{"NormalizationBremBL", "[", 
         RowBox[{"mV_", ",", "Facility"}], "]"}], "=", 
        RowBox[{
         RowBox[{
          RowBox[{"NormalizationBremDP", "[", 
           RowBox[{"mV", ",", "Facility"}], "]"}], "*", 
          FractionBox[
           RowBox[{"4", "Pi"}], "\[Alpha]EMval"], 
          FractionBox[
           RowBox[{"FormFactorSquaredBrem", "[", 
            RowBox[{"mV", ",", "LLPname"}], "]"}], 
           RowBox[{"FormFactorSquaredBrem", "[", 
            RowBox[{"mV", ",", "\"\<DP\>\""}], "]"}]]}], "//", "Simplify"}]}],
        ";", "\[IndentingNewLine]", 
       RowBox[{"Export", "[", 
        RowBox[{
         RowBox[{"FileNameJoin", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"NotebookDirectory", "[", "]"}], ",", 
            "\"\<phenomenology\>\"", ",", "LLPname", ",", 
            "\"\<Production probabilities/Pbrem.m\>\""}], "}"}], "]"}], ",", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"Facility", ",", 
             RowBox[{"NormalizationBremBL", "[", 
              RowBox[{"mV", ",", "Facility"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"Facility", ",", "FacilitiesList"}], "}"}]}], "]"}], ",", 
         "\"\<MX\>\""}], "]"}]}], "*)"}], "\[IndentingNewLine]", "]"}], 
    "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{"fipname", ",", "BLlist"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"Facility", ",", "FacilitiesList"}], "}"}]}], "]"}], 
  ";"}]}], "Input",
 CellChangeTimes->{
  3.934100007034339*^9, {3.9341002100636163`*^9, 3.934100227741296*^9}, {
   3.9341002601935296`*^9, 3.9341002991995077`*^9}, {3.93410035335574*^9, 
   3.934100356687628*^9}, {3.934100438339679*^9, 3.934100489946617*^9}, {
   3.934100555373107*^9, 3.9341006311809344`*^9}, {3.934100693462018*^9, 
   3.9341007195026646`*^9}, {3.934100858009489*^9, 3.934100960565435*^9}, {
   3.9341009924628887`*^9, 3.934101021855587*^9}, {3.9341013433085437`*^9, 
   3.9341013439449196`*^9}, {3.934123693728105*^9, 3.934123710428928*^9}, 
   3.934128740593152*^9, {3.9341306588558483`*^9, 3.934130658861986*^9}, {
   3.934555300818965*^9, 3.934555319029607*^9}, {3.934592986087944*^9, 
   3.934592989366305*^9}, {3.934593095290699*^9, 3.934593095290699*^9}, {
   3.9345951454681654`*^9, 3.9345951455366693`*^9}, {3.9346038780306034`*^9, 
   3.93460388620984*^9}, {3.934604018212607*^9, 3.9346040331173267`*^9}, {
   3.934604937575927*^9, 3.934604938454424*^9}, {3.9346049688402524`*^9, 
   3.9346049710606003`*^9}, {3.934606694828912*^9, 3.93460669623057*^9}, 
   3.934698048621814*^9, {3.9346984280597143`*^9, 3.9346984446608477`*^9}, {
   3.934699285560003*^9, 3.9346992983582497`*^9}, 3.9346994454810133`*^9, {
   3.9346997831178875`*^9, 3.934699807179006*^9}, {3.934699867477004*^9, 
   3.9346998834401627`*^9}, {3.935134918458983*^9, 3.9351349184709873`*^9}, {
   3.9404358989908905`*^9, 3.940435905411661*^9}, {3.9404359395030937`*^9, 
   3.940435956726099*^9}, {3.940436021218588*^9, 3.9404361386011543`*^9}, {
   3.9404361878704643`*^9, 3.9404361994091587`*^9}},
 CellLabel->
  "In[204]:=",ExpressionUUID->"20ae7918-ed85-4349-bb6e-7aa4a3e4ae10"]
}, Closed]],

Cell[CellGroupData[{

Cell["ALPs", "Section",
 CellChangeTimes->{{3.945237125340372*^9, 
  3.9452371311905804`*^9}},ExpressionUUID->"650609e8-39b8-3941-99da-\
120e7097a683"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Msplit", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"FV", "[", 
       RowBox[{
        RowBox[{"ppfin", "-", "ppini"}], ",", "\[Mu]"}], "]"}], "*", 
      RowBox[{
       RowBox[{"SpinorUBar", "[", 
        RowBox[{"ppfin", ",", "mp"}], "]"}], ".", 
       RowBox[{"GA", "[", "\[Mu]", "]"}], ".", "GA5", ".", 
       RowBox[{"SpinorU", "[", 
        RowBox[{"ppini", ",", "mp"}], "]"}]}]}], "//", "Contract"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Squared", " ", "matrix", " ", "element", " ", "for", " ", "the", " ", 
    "splitting"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Msplit2", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"FermionSpinSum", "[", 
       RowBox[{"Msplit", "*", 
        RowBox[{"ComplexConjugate", "[", "Msplit", "]"}]}], "]"}], "/.", 
      RowBox[{"DiracTrace", "\[Rule]", "TR"}]}], "//", "Contract"}], "//", 
    "Simplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Msplit2", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"Msplit2", "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"ScalarProduct", "[", 
           RowBox[{"pX", ",", "pX"}], "]"}], "->", 
          SuperscriptBox["mX", "2"]}], ",", 
         RowBox[{
          RowBox[{"ScalarProduct", "[", 
           RowBox[{"ppfin", ",", "ppini"}], "]"}], "->", 
          "ppToppprimeApprox"}], ",", 
         RowBox[{
          RowBox[{"ScalarProduct", "[", 
           RowBox[{"ppini", ",", "ppini"}], "]"}], "->", 
          SuperscriptBox["mp", "2"]}], ",", 
         RowBox[{
          RowBox[{"ScalarProduct", "[", 
           RowBox[{"ppfin", ",", "ppfin"}], "]"}], "->", 
          SuperscriptBox["mp", "2"]}]}], "}"}]}], "//", "Expand"}], "//", 
     "Simplify"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Expression", " ", "for", " ", "the", " ", "splitting", " ", "probability",
     " ", 
    SuperscriptBox["d", "2"], 
    RowBox[{
     SubscriptBox["P", "spl"], "/", 
     SuperscriptBox[
      SubscriptBox["dp", "T"], "2"]}], "dz", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"compare", " ", "to", " ", 
       RowBox[{"Eq", ".", " ", "D22"}], " ", "of", " ", 
       RowBox[{"https", ":"}]}], "//", 
      RowBox[{
       RowBox[{
        RowBox[{"arxiv", ".", "org"}], "/", "pdf"}], "/", "1904.10447"}]}], 
     ")"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"\[Omega]splA", "[", 
       RowBox[{
       "mp_", ",", "z_", ",", "pT_", ",", "Pp_", ",", "mX_", ",", 
        "\[Theta]2_", ",", "model", ",", "\[CapitalLambda]p_", ",", "ff"}], 
       "]"}], "=", 
      RowBox[{
       RowBox[{
        SuperscriptBox[
         RowBox[{"Fvirtuality", "[", 
          RowBox[{
          "z", ",", "pT", ",", "mp", ",", "mX", ",", "\[CapitalLambda]p"}], 
          "]"}], "2"], "*", 
        RowBox[{"FormFactorSquaredBrem", "[", 
         RowBox[{"mX", ",", "model"}], "]"}], 
        FractionBox["1", 
         RowBox[{"16", 
          SuperscriptBox["Pi", "2"], "z"}]], 
        FractionBox["Msplit2", 
         RowBox[{"4", "*", 
          RowBox[{"(", 
           RowBox[{"EpprimeApprox", "/.", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"mp", "->", "0"}], ",", 
              RowBox[{"pT", "->", "0"}]}], "}"}]}], ")"}], "*", 
          RowBox[{"(", 
           RowBox[{"EpApprox", "/.", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"mp", "->", "0"}], ",", 
              RowBox[{"pT", "->", "0"}]}], "}"}]}], ")"}], "*", 
          SuperscriptBox["\[CapitalDelta]EdominateDiagram", "2"]}]]}], "//", 
       "Simplify"}]}], ";"}], "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{"model", ",", 
      RowBox[{"{", 
       RowBox[{"\"\<ALP-fermion\>\"", ",", "\"\<ALP-gluon\>\""}], "}"}]}], 
     "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"ff", ",", "uncertainties"}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Producing", " ", "normalized", " ", "distribution", " ", "and", " ", 
    "normalization", " ", 
    RowBox[{"(", 
     RowBox[{"==", 
      RowBox[{"total", " ", "flux"}]}], ")"}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "eminabs", ",", "emaxabs", ",", "pbeam", ",", "ptmax", ",", "norm", ",", 
       RowBox[{"(*", 
        RowBox[{"distr", ","}], "*)"}], "normdata"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"pbeam", "=", 
       RowBox[{"EmaxFacility", "[", "Facility", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"eminabs", "=", 
       RowBox[{"ELLPminBrem", "[", "Facility", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"emaxabs", "=", 
       RowBox[{
        RowBox[{"zMaxBrem", "[", "Facility", "]"}], "*", "pbeam"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ptmax", "=", 
       RowBox[{"pTmaxBrem", "[", "Facility", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"FluxBrem", "[", 
           RowBox[{
           "mV_", ",", "\[Theta]V_", ",", "EV_", ",", "LLP", ",", 
            "\"\<AP\>\"", ",", "Facility", ",", "ff", ",", 
            "\[CapitalLambda]p_"}], "]"}], "=", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"eminabs", "<=", "EV", "<=", "emaxabs"}], ",", 
            RowBox[{"Evaluate", "[", 
             RowBox[{
              RowBox[{"JacobianpTzToEV\[Theta]", "[", 
               RowBox[{"mV", ",", "EV", ",", "pbeam", ",", "\[Theta]V"}], 
               "]"}], "*", 
              RowBox[{"\[Omega]splA", "[", 
               RowBox[{
                RowBox[{"mSM", "[", "\"\<p\>\"", "]"}], ",", 
                RowBox[{"zvp", "[", 
                 RowBox[{"EV", ",", "pbeam"}], "]"}], ",", 
                RowBox[{"pTv", "[", 
                 RowBox[{"mV", ",", "EV", ",", "\[Theta]V"}], "]"}], ",", 
                "pbeam", ",", "mV", ",", "1", ",", "LLP", ",", 
                "\[CapitalLambda]p", ",", "ff"}], "]"}], "*", 
              RowBox[{"KinematicsApplicability\[Theta]E", "[", 
               RowBox[{"mV", ",", "\[Theta]V", ",", "EV", ",", "pbeam"}], 
               "]"}], "*", 
              RowBox[{"\[Sigma]RatiosFit", "[", 
               RowBox[{"pbeam", ",", 
                RowBox[{"zvp", "[", 
                 RowBox[{"EV", ",", "pbeam"}], "]"}]}], "]"}]}], "]"}], ",", 
            SuperscriptBox["10", 
             RowBox[{"-", "90."}]]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
        ",", 
        RowBox[{"{", 
         RowBox[{"LLP", ",", 
          RowBox[{"{", 
           RowBox[{"\"\<ALP-fermion\>\"", ",", "\"\<ALP-gluon\>\""}], "}"}]}],
          "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"ff", ",", "uncertainties"}], "}"}]}], "]"}]}]}], 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"normdata", "=", 
       RowBox[{"ParallelTable", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"mV", ",", 
           RowBox[{"NIntegrate", "[", 
            RowBox[{
             RowBox[{"distr", "[", 
              RowBox[{"mV", ",", "\[Theta]V", ",", "EV"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"\[Theta]V", ",", "0", ",", 
               RowBox[{"\[Theta]maxBremBaseline", "[", "Facility", "]"}]}], 
              "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"EV", ",", "eminabs", ",", 
               RowBox[{"Max", "[", 
                RowBox[{"eminabs", ",", 
                 RowBox[{"ELLPmaxBremBaseline", "[", 
                  RowBox[{"Facility", ",", "mV", ",", "\[Theta]V"}], "]"}]}], 
                "]"}]}], "}"}], ",", 
             RowBox[{"Method", "\[Rule]", "\"\<AdaptiveMonteCarlo\>\""}]}], 
            "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"mV", ",", "mVminFromBrem", ",", "mVmaxFromBrem", ",", 
           FractionBox[
            RowBox[{"(", 
             RowBox[{"mVmaxFromBrem", "-", "mVminFromBrem"}], ")"}], "20"]}], 
          "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"norm", "[", "mV_", "]"}], "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Interpolation", "[", 
          RowBox[{
           RowBox[{"normdata", "//", "Log"}], ",", 
           RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[", 
         RowBox[{"Log", "[", "mV", "]"}], "]"}], "//", "Exp"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"DoubleDistrBrem", "[", 
        RowBox[{
        "mV_", ",", "\[Theta]V_", ",", "EV_", ",", "\"\<Scalar\>\"", ",", 
         "Facility"}], "]"}], "=", 
       FractionBox[
        RowBox[{"distr", "[", 
         RowBox[{"mV", ",", "\[Theta]V", ",", "EV"}], "]"}], 
        RowBox[{"norm", "[", "mV", "]"}]]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"NormalizationBremScalar", "[", 
        RowBox[{"mV_", ",", "Facility"}], "]"}], "=", 
       RowBox[{
        RowBox[{"norm", "[", "mV", "]"}], "*", 
        RowBox[{"BremFormFactorSquared", "[", "mV", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Export", "[", 
       RowBox[{
        RowBox[{"FileNameJoin", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"NotebookDirectory", "[", "]"}], ",", 
           "\"\<phenomenology/Scalar/Production probabilities/Pbrem.m\>\""}], 
          "}"}], "]"}], ",", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"Facility", ",", 
            RowBox[{"NormalizationBremScalar", "[", 
             RowBox[{"mS", ",", "Facility"}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"Facility", ",", "FacilitiesList"}], "}"}]}], "]"}], ",", 
        "\"\<MX\>\""}], "]"}]}], "*)"}], "\[IndentingNewLine]", "]"}], 
   "\[IndentingNewLine]", ",", 
   RowBox[{"{", 
    RowBox[{"Facility", ",", "FacilitiesList"}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.9452375005130005`*^9, 3.945237538731428*^9}, {
   3.945237629169132*^9, 3.9452376306351433`*^9}, 3.9505442303222313`*^9, {
   3.950546571292507*^9, 3.9505465973510437`*^9}, 3.950637701908165*^9, 
   3.950666846894214*^9},
 CellLabel->"In[53]:=",ExpressionUUID->"fd9ffd6a-8b96-a64b-9104-1534ae8a52d3"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1016.25, 606.75},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
Magnification:>1. Inherited,
FrontEndVersion->"13.2 for Microsoft Windows (64-bit) (November 18, 2022)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"732a6dff-5f6d-4021-883c-98da45f40aa7"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{
 "Evaluation"->{
  Cell[6179, 181, 8589, 216, 494, "Input",ExpressionUUID->"d0e187fa-6371-4d5d-8a3a-cb347c8df152",
   CellTags->"Evaluation"],
  Cell[34433, 932, 451, 7, 67, "Section",ExpressionUUID->"c8a9d46c-87cc-40ca-ae2b-5292a9d7b606",
   CellTags->"Evaluation"],
  Cell[61715, 1728, 19019, 444, 1194, "Input",ExpressionUUID->"80c66734-05ec-42fc-88c4-24186c7c8bf0",
   CellTags->"Evaluation"],
  Cell[80737, 2174, 607, 14, 70, "Message",ExpressionUUID->"534114e2-e9d2-124f-ad12-72e7576761b7",
   CellTags->"Evaluation"],
  Cell[81347, 2190, 607, 14, 70, "Message",ExpressionUUID->"eaa11f37-097a-ab4d-8b36-225d5d38f3b7",
   CellTags->"Evaluation"],
  Cell[81957, 2206, 607, 14, 70, "Message",ExpressionUUID->"94b0191c-8a1b-864b-bdfa-c6d440a0d466",
   CellTags->"Evaluation"],
  Cell[82567, 2222, 540, 13, 70, "Message",ExpressionUUID->"b4ec25da-54d5-fd4c-bcf4-508d9e439719",
   CellTags->"Evaluation"],
  Cell[83110, 2237, 3534, 54, 70, "Message",ExpressionUUID->"10b3ea13-9a7b-1f4a-ab1a-c653496a6237",
   CellTags->"Evaluation"],
  Cell[86647, 2293, 3537, 54, 70, "Message",ExpressionUUID->"8137579f-4695-c740-b5de-70e055da89cf",
   CellTags->"Evaluation"],
  Cell[112961, 2932, 473, 7, 53, "Subsection",ExpressionUUID->"a14fc704-b252-4503-9f91-5b85cfc2c1db",
   CellTags->"Evaluation"],
  Cell[113437, 2941, 16363, 345, 712, "Input",ExpressionUUID->"0387d079-c8f8-48b4-a3a7-d63945d99129",
   CellTags->"Evaluation"]}
 }
*)
(*CellTagsIndex
CellTagsIndex->{
 {"Evaluation", 188751, 4770}
 }
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 160, 3, 69, "Chapter",ExpressionUUID->"558648bf-fa20-480d-a231-a30f128a6548"],
Cell[CellGroupData[{
Cell[765, 29, 161, 3, 67, "Section",ExpressionUUID->"a5e60e60-13b5-4d59-a9e6-8ca48d910142"],
Cell[929, 34, 1161, 31, 67, "Input",ExpressionUUID->"731dfc3a-29e7-449b-81e6-e77129ba20f8"]
}, Open  ]],
Cell[CellGroupData[{
Cell[2127, 70, 207, 3, 67, "Section",ExpressionUUID->"b1ae5fc5-b859-4f94-b8de-5d61691d787d"],
Cell[CellGroupData[{
Cell[2359, 77, 203, 4, 54, "Subsection",ExpressionUUID->"47ee9e23-c41f-42d3-bb9b-a22db7781545"],
Cell[CellGroupData[{
Cell[2587, 85, 244, 4, 43, "Subsubsection",ExpressionUUID->"e546c7d4-aa7e-4c2d-bbdc-6940beb041f7"],
Cell[2834, 91, 2886, 75, 146, "Input",ExpressionUUID->"ec327216-5a20-4dc7-a905-3a0460b08e09"],
Cell[5723, 168, 173, 2, 28, "Input",ExpressionUUID->"691ea99c-81b6-a94d-8a02-c939af530db3"]
}, Open  ]],
Cell[CellGroupData[{
Cell[5933, 175, 243, 4, 43, "Subsubsection",ExpressionUUID->"7aefda7f-b658-456f-9cc7-e4d858549eee"],
Cell[6179, 181, 8589, 216, 494, "Input",ExpressionUUID->"d0e187fa-6371-4d5d-8a3a-cb347c8df152",
 CellTags->"Evaluation"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[14817, 403, 209, 4, 38, "Subsection",ExpressionUUID->"1627a979-3cce-42b5-b827-47d96c618651"],
Cell[15029, 409, 1326, 35, 124, "Input",ExpressionUUID->"40bf4291-e9ca-447e-b454-3fb2bce2be17"]
}, Open  ]],
Cell[CellGroupData[{
Cell[16392, 449, 206, 4, 54, "Subsection",ExpressionUUID->"2e1aa088-bec3-4340-aeb8-c4246486406a"],
Cell[CellGroupData[{
Cell[16623, 457, 244, 4, 43, "Subsubsection",ExpressionUUID->"523cb825-c645-fd4f-a682-91b51c04b004"],
Cell[16870, 463, 4470, 112, 223, "Input",ExpressionUUID->"ef069999-55ba-9f44-8e07-ef12d383b53a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[21377, 580, 217, 4, 43, "Subsubsection",ExpressionUUID->"ca54ef82-6239-5e4b-ba43-2586aa979d3b"],
Cell[21597, 586, 7846, 216, 480, "Input",ExpressionUUID->"c981cd8e-27ee-4142-9818-5ca94fdf6451"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[29492, 808, 148, 2, 38, "Subsection",ExpressionUUID->"0fa7f26b-61d8-8f48-9d5d-bfee39a54816"],
Cell[29643, 812, 4741, 114, 331, "Input",ExpressionUUID->"ba8a0b50-7127-7e4d-b7fb-7f1afe4b824c"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[34433, 932, 451, 7, 67, "Section",ExpressionUUID->"c8a9d46c-87cc-40ca-ae2b-5292a9d7b606",
 CellTags->"Evaluation"],
Cell[CellGroupData[{
Cell[34909, 943, 185, 3, 53, "Subsection",ExpressionUUID->"cf56f7c4-1182-457e-8129-050202667f03"],
Cell[CellGroupData[{
Cell[35119, 950, 177, 3, 43, "Subsubsection",ExpressionUUID->"b6885f34-afa9-448a-b0dd-015c3b2850fb"],
Cell[CellGroupData[{
Cell[35321, 957, 10042, 300, 809, "Input",ExpressionUUID->"9a54d833-55ba-4682-87ac-8ce520e03537"],
Cell[45366, 1259, 543, 9, 70, "Print",ExpressionUUID->"59cca136-5a4f-e24e-b4f3-37287225db5f"],
Cell[45912, 1270, 865, 22, 70, "Output",ExpressionUUID->"c9c0bc09-92d4-b141-971f-397f06489ef2"],
Cell[46780, 1294, 545, 9, 70, "Print",ExpressionUUID->"0fac8e9d-9013-3e44-93c0-d3732bc89387"],
Cell[47328, 1305, 708, 16, 70, "Output",ExpressionUUID->"3cb67271-1e72-8a49-b98d-b0266397af48"]
}, Open  ]],
Cell[CellGroupData[{
Cell[48073, 1326, 161, 3, 30, "Item",ExpressionUUID->"3caa2ce0-b9ec-41f2-9031-e274a853916a"],
Cell[CellGroupData[{
Cell[48259, 1333, 6726, 198, 329, "Input",ExpressionUUID->"eea95df7-add6-4def-b6de-50a4ed1fd110"],
Cell[54988, 1533, 1022, 26, 70, "Output",ExpressionUUID->"53703840-0dc3-4a4e-8cf2-7ecea8b98b8f"],
Cell[56013, 1561, 826, 19, 70, "Output",ExpressionUUID->"b3abc0ab-5926-f446-ab61-1055aa1d394c"],
Cell[56842, 1582, 1072, 29, 70, "Output",ExpressionUUID->"9443937f-7bcb-2344-b478-98327e8e1b0d"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[57975, 1618, 162, 3, 43, "Subsubsection",ExpressionUUID->"d3e2e84b-1105-4428-8dc0-b8b671032673"],
Cell[58140, 1623, 3256, 91, 187, "Input",ExpressionUUID->"350689b9-cf6c-4348-97b4-b2ae3a99294e"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[61445, 1720, 245, 4, 53, "Subsection",ExpressionUUID->"8e2de048-59db-4109-ad95-c24e56948c5e"],
Cell[CellGroupData[{
Cell[61715, 1728, 19019, 444, 1194, "Input",ExpressionUUID->"80c66734-05ec-42fc-88c4-24186c7c8bf0",
 CellTags->"Evaluation"],
Cell[80737, 2174, 607, 14, 70, "Message",ExpressionUUID->"534114e2-e9d2-124f-ad12-72e7576761b7",
 CellTags->"Evaluation"],
Cell[81347, 2190, 607, 14, 70, "Message",ExpressionUUID->"eaa11f37-097a-ab4d-8b36-225d5d38f3b7",
 CellTags->"Evaluation"],
Cell[81957, 2206, 607, 14, 70, "Message",ExpressionUUID->"94b0191c-8a1b-864b-bdfa-c6d440a0d466",
 CellTags->"Evaluation"],
Cell[82567, 2222, 540, 13, 70, "Message",ExpressionUUID->"b4ec25da-54d5-fd4c-bcf4-508d9e439719",
 CellTags->"Evaluation"],
Cell[83110, 2237, 3534, 54, 70, "Message",ExpressionUUID->"10b3ea13-9a7b-1f4a-ab1a-c653496a6237",
 CellTags->"Evaluation"],
Cell[86647, 2293, 3537, 54, 70, "Message",ExpressionUUID->"8137579f-4695-c740-b5de-70e055da89cf",
 CellTags->"Evaluation"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[90233, 2353, 284, 4, 53, "Subsection",ExpressionUUID->"1d3c9bf9-cf14-40ee-ac7e-e7965ade4747"],
Cell[90520, 2359, 18794, 459, 968, "Input",ExpressionUUID->"5cd5fe21-8832-4f66-a7db-f31a2bc2f399"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[109363, 2824, 271, 4, 53, "Section",ExpressionUUID->"0af00c60-02f3-4ac6-ae12-0d395d6bf76d"],
Cell[109637, 2830, 2825, 81, 315, "Input",ExpressionUUID->"1e839c05-c83f-4800-b096-11cbc0ede7fd"]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[112511, 2917, 201, 3, 69, "Chapter",ExpressionUUID->"42c7c861-08b3-489f-aaf7-781a3a38fb96"],
Cell[CellGroupData[{
Cell[112737, 2924, 199, 4, 67, "Section",ExpressionUUID->"d7cf56ca-31b6-4b71-84d2-ae24fd9531d1"],
Cell[CellGroupData[{
Cell[112961, 2932, 473, 7, 53, "Subsection",ExpressionUUID->"a14fc704-b252-4503-9f91-5b85cfc2c1db",
 CellTags->"Evaluation"],
Cell[113437, 2941, 16363, 345, 712, "Input",ExpressionUUID->"0387d079-c8f8-48b4-a3a7-d63945d99129",
 CellTags->"Evaluation"]
}, Closed]],
Cell[CellGroupData[{
Cell[129837, 3291, 296, 4, 37, "Subsection",ExpressionUUID->"9d54e504-28c9-45df-b85e-a11e0db269f2"],
Cell[130136, 3297, 20899, 509, 1163, "Input",ExpressionUUID->"cd7db6f2-2373-46ae-b391-0ee9695761c8"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[151084, 3812, 202, 4, 53, "Section",ExpressionUUID->"ce0060d4-1e35-4b0a-adc4-b0e500a607fb"],
Cell[151289, 3818, 10596, 272, 802, "Input",ExpressionUUID->"291c9321-ad9e-416b-9575-3d59cb89f570"]
}, Closed]],
Cell[CellGroupData[{
Cell[161922, 4095, 361, 9, 52, "Section",ExpressionUUID->"8b9abd4f-3583-4814-9a5d-043b6f505e74"],
Cell[162286, 4106, 15301, 363, 836, "Input",ExpressionUUID->"20ae7918-ed85-4349-bb6e-7aa4a3e4ae10"]
}, Closed]],
Cell[CellGroupData[{
Cell[177624, 4474, 151, 3, 53, "Section",ExpressionUUID->"650609e8-39b8-3941-99da-120e7097a683"],
Cell[177778, 4479, 10557, 275, 827, "Input",ExpressionUUID->"fd9ffd6a-8b96-a64b-9104-1534ae8a52d3"]
}, Open  ]]
}, Open  ]]
}
]
*)

