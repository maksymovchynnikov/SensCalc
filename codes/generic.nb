(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    125069,       3204]
NotebookOptionsPosition[    119020,       3082]
NotebookOutlinePosition[    120379,       3116]
CellTagsIndexPosition[    120304,       3111]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Own/DownValues", "Chapter",
 CellChangeTimes->{{3.9520952254466133`*^9, 
  3.952095230744879*^9}},ExpressionUUID->"c00d73d4-6b40-f747-a12f-\
e31a7c5757a2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Shortland", " ", "notations", " ", "for", " ", 
    RowBox[{"RuleOwn", "@", " ", "and"}], " ", 
    RowBox[{"RuleDown", "@"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"SetAttributes", "[", 
     RowBox[{"ruleDown", ",", "HoldAll"}], "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ruleDown", "[", "list_", "]"}], ":=", 
    RowBox[{"Flatten", "[", 
     RowBox[{"DownValues", "/@", 
      RowBox[{"(", 
       RowBox[{"Unevaluated", "@", "list"}], ")"}]}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SetAttributes", "[", 
     RowBox[{"ruleOwn", ",", "HoldAll"}], "]"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"ruleOwn", "[", "list_", "]"}], ":=", 
    RowBox[{"Flatten", "[", 
     RowBox[{"OwnValues", "/@", 
      RowBox[{"(", 
       RowBox[{"Unevaluated", "@", "list"}], ")"}]}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"ToString", "[", 
        RowBox[{"Head", "[", "AccCode", "]"}], "]"}], 
       "==", "\"\<Symbol\>\""}], ",", 
      RowBox[{"AccCode", "=", "False"}]}], "]"}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.9546834950827885`*^9, 3.954683537073992*^9}},
 CellLabel->"In[19]:=",ExpressionUUID->"1b6ad74e-d544-5e4a-952b-ad38c2bed513"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Compilable interpolation function mapping one regular grid into another\
\>", "Chapter",
 CellChangeTimes->{{3.891315426588935*^9, 3.891315432542842*^9}, {
  3.952095382716114*^9, 
  3.9520953837515335`*^9}},ExpressionUUID->"6a9fc57c-5e9d-4b7d-961e-\
a6fe99a0d7ee"],

Cell[CellGroupData[{

Cell["2D to 2D", "Section",
 CellChangeTimes->{{3.890732625178977*^9, 3.890732634660539*^9}, 
   3.8927117366160936`*^9, {3.9141413232643905`*^9, 
   3.9141413254787335`*^9}},ExpressionUUID->"c53be3f0-8cb4-4809-9a6c-\
cad3f46048e4"],

Cell[BoxData[
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"!", "AccCode"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"nd", "=", "2"}], ";", "\n", 
    RowBox[{"cf2", "=", 
     RowBox[{
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"xgvars", "=", 
           RowBox[{
            RowBox[{
             RowBox[{"Unique", "[", "\"\<xg\>\"", "]"}], "&"}], "/@", 
            RowBox[{"slist", "@@", 
             RowBox[{"Range", "@", "nd"}]}]}]}], ",", 
          RowBox[{"igvars", "=", 
           RowBox[{
            RowBox[{
             RowBox[{"Unique", "[", "\"\<ig\>\"", "]"}], "&"}], "/@", 
            RowBox[{"slist", "@@", 
             RowBox[{"Range", "@", "nd"}]}]}]}], ",", 
          RowBox[{"tgvars", "=", 
           RowBox[{
            RowBox[{
             RowBox[{"Unique", "[", "\"\<tg\>\"", "]"}], "&"}], "/@", 
            RowBox[{"slist", "@@", 
             RowBox[{"Range", "@", "nd"}]}]}]}], ",", 
          RowBox[{"ivars", "=", 
           RowBox[{
            RowBox[{
             RowBox[{"Unique", "[", "\"\<i\>\"", "]"}], "&"}], "/@", 
            RowBox[{"slist", "@@", 
             RowBox[{"Range", "@", "nd"}]}]}]}], ",", 
          RowBox[{"svars", "=", 
           RowBox[{
            RowBox[{
             RowBox[{"Unique", "[", "\"\<s\>\"", "]"}], "&"}], "/@", 
            RowBox[{"slist", "@@", 
             RowBox[{"Range", "@", "nd"}]}]}]}], ",", 
          RowBox[{"tvars", "=", 
           RowBox[{
            RowBox[{
             RowBox[{"Unique", "[", "\"\<t\>\"", "]"}], "&"}], "/@", 
            RowBox[{"slist", "@@", 
             RowBox[{"Range", "@", "nd"}]}]}]}], ",", 
          RowBox[{"jvars", "=", 
           RowBox[{
            RowBox[{
             RowBox[{"Unique", "[", "\"\<j\>\"", "]"}], "&"}], "/@", 
            RowBox[{"slist", "@@", 
             RowBox[{"Range", "@", "nd"}]}]}]}]}], "}"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"Inactivate", "[", 
           RowBox[{
            RowBox[{"Compile", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"seq", "@", 
                 RowBox[{"{", 
                  RowBox[{"xgvars", ",", "_Real", ",", "1"}], "}"}]}], ",", 
                RowBox[{"{", 
                 RowBox[{"y", ",", "_Real", ",", "nd"}], "}"}]}], "}"}], ",", 
              RowBox[{"Module", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"seq", "@", "igvars"}], ",", 
                  RowBox[{"seq", "@", "tgvars"}], ",", 
                  RowBox[{"seq", "@", "ivars"}], ",", 
                  RowBox[{"seq", "@", "svars"}], ",", 
                  RowBox[{"seq", "@", "tvars"}]}], "}"}], ",", 
                RowBox[{
                 RowBox[{"seq", "[", 
                  RowBox[{"igvars", "=", 
                   RowBox[{
                    RowBox[{"Floor", "[", "xgvars", "]"}], "-", 
                    RowBox[{"UnitStep", "[", 
                    RowBox[{"xgvars", "-", 
                    RowBox[{"indexed", "@", 
                    RowBox[{"Dimensions", "@", "y"}]}]}], "]"}]}]}], "]"}], ";",
                  "\[IndentingNewLine]", 
                 RowBox[{"seq", "[", 
                  RowBox[{"tgvars", "=", 
                   RowBox[{"xgvars", "-", "igvars"}]}], "]"}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Table", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"seq", "[", 
                    RowBox[{"tvars", "=", 
                    RowBox[{"Compile`GetElement", "[", 
                    RowBox[{"tgvars", ",", "jvars"}], "]"}]}], "]"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"seq", "[", 
                    RowBox[{"ivars", "=", 
                    RowBox[{"Compile`GetElement", "[", 
                    RowBox[{"igvars", ",", "jvars"}], "]"}]}], "]"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"seq", "[", 
                    RowBox[{"svars", "=", 
                    RowBox[{"1.", "-", "tvars"}]}], "]"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"eval", "@", 
                    RowBox[{"Total", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"Times", "@@", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "1"}], "]"}], "]"}]}], " ", 
                    RowBox[{"Compile`GetElement", "[", 
                    RowBox[{"y", ",", 
                    RowBox[{"Sequence", "@@", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "2"}], "]"}], "]"}]}]}], "]"}]}], 
                    "&"}], "/@", 
                    RowBox[{"Tuples", "@", 
                    RowBox[{"Transpose", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"svars", ",", "ivars"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"tvars", ",", 
                    RowBox[{"ivars", "+", "1"}]}], "}"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"2", ",", "3", ",", "1"}], "}"}]}], "]"}]}]}], 
                    "]"}]}]}], ",", 
                   RowBox[{"seq", "@", 
                    RowBox[{"{", 
                    RowBox[{"jvars", ",", 
                    RowBox[{"Length", "@", "igvars"}]}], "}"}]}]}], "]"}]}]}],
                "]"}], ",", 
              RowBox[{"CompilationTarget", "\[Rule]", "\"\<C\>\""}], ",", 
              RowBox[{"RuntimeAttributes", "\[Rule]", 
               RowBox[{"{", "Listable", "}"}]}], ",", 
              RowBox[{"Parallelization", "\[Rule]", "True"}], ",", 
              RowBox[{"RuntimeOptions", "\[Rule]", "\"\<Speed\>\""}]}], "]"}],
             ",", 
            RowBox[{"Except", "[", 
             RowBox[{"seq", "|", "eval", "|", "indexed"}], "]"}]}], "]"}], "/.", 
          RowBox[{
           RowBox[{"seq", "[", "expr_", "]"}], "\[RuleDelayed]", 
           RowBox[{"RuleCondition", "@", 
            RowBox[{"(", 
             RowBox[{"Sequence", "@@", 
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Inactivate", "[", 
                  RowBox[{"expr", ",", 
                   RowBox[{"Except", "[", 
                    RowBox[{"slist", "|", "indexed"}], "]"}]}], "]"}], "/.", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"l_slist", "\[RuleDelayed]", 
                    RowBox[{"l", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], ",", 
                   RowBox[{
                    RowBox[{"indexed", "[", "l_", "]"}], "\[RuleDelayed]", 
                    RowBox[{
                    RowBox[{"Inactive", "[", "Compile`GetElement", "]"}], "[", 
                    RowBox[{"l", ",", "i"}], "]"}]}]}], "}"}]}], ",", 
                RowBox[{"{", 
                 RowBox[{"i", ",", "nd"}], "}"}]}], "]"}]}], ")"}]}]}]}], "/.", 
         RowBox[{
          RowBox[{"eval", "@", "expr_"}], "\[RuleDelayed]", 
          RowBox[{"RuleCondition", "[", 
           RowBox[{"Activate", "[", 
            RowBox[{"expr", "/.", 
             RowBox[{"slist", "\[Rule]", "List"}]}], "]"}], "]"}]}]}]}], 
       "]"}], "//", "Activate"}]}], ";"}]}], "\[IndentingNewLine]", 
  "]"}]], "Input",
 CellChangeTimes->{{3.890711783488103*^9, 3.89071178348964*^9}, {
  3.8907121412539587`*^9, 3.8907121413711557`*^9}, {3.890712694841427*^9, 
  3.8907126950000925`*^9}, {3.890712790376151*^9, 3.8907128219919777`*^9}, {
  3.891018553068019*^9, 3.8910185548862777`*^9}, {3.914141327087761*^9, 
  3.9141413282588053`*^9}, {3.9546627522165184`*^9, 
  3.9546627582007465`*^9}},ExpressionUUID->"d54cf136-403d-4b2a-85d2-\
cc1e872c4502"]
}, Open  ]],

Cell[CellGroupData[{

Cell["3D to 3D", "Section",
 CellChangeTimes->{{3.890732625178977*^9, 3.890732634660539*^9}, 
   3.8927117366160936`*^9},ExpressionUUID->"a86aa69f-68f0-4048-88b5-\
3f939c7e6c37"],

Cell[BoxData[
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"!", "AccCode"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"nd", "=", "3"}], ";", "\n", 
    RowBox[{"cf3", "=", 
     RowBox[{
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"xgvars", "=", 
           RowBox[{
            RowBox[{
             RowBox[{"Unique", "[", "\"\<xg\>\"", "]"}], "&"}], "/@", 
            RowBox[{"slist", "@@", 
             RowBox[{"Range", "@", "nd"}]}]}]}], ",", 
          RowBox[{"igvars", "=", 
           RowBox[{
            RowBox[{
             RowBox[{"Unique", "[", "\"\<ig\>\"", "]"}], "&"}], "/@", 
            RowBox[{"slist", "@@", 
             RowBox[{"Range", "@", "nd"}]}]}]}], ",", 
          RowBox[{"tgvars", "=", 
           RowBox[{
            RowBox[{
             RowBox[{"Unique", "[", "\"\<tg\>\"", "]"}], "&"}], "/@", 
            RowBox[{"slist", "@@", 
             RowBox[{"Range", "@", "nd"}]}]}]}], ",", 
          RowBox[{"ivars", "=", 
           RowBox[{
            RowBox[{
             RowBox[{"Unique", "[", "\"\<i\>\"", "]"}], "&"}], "/@", 
            RowBox[{"slist", "@@", 
             RowBox[{"Range", "@", "nd"}]}]}]}], ",", 
          RowBox[{"svars", "=", 
           RowBox[{
            RowBox[{
             RowBox[{"Unique", "[", "\"\<s\>\"", "]"}], "&"}], "/@", 
            RowBox[{"slist", "@@", 
             RowBox[{"Range", "@", "nd"}]}]}]}], ",", 
          RowBox[{"tvars", "=", 
           RowBox[{
            RowBox[{
             RowBox[{"Unique", "[", "\"\<t\>\"", "]"}], "&"}], "/@", 
            RowBox[{"slist", "@@", 
             RowBox[{"Range", "@", "nd"}]}]}]}], ",", 
          RowBox[{"jvars", "=", 
           RowBox[{
            RowBox[{
             RowBox[{"Unique", "[", "\"\<j\>\"", "]"}], "&"}], "/@", 
            RowBox[{"slist", "@@", 
             RowBox[{"Range", "@", "nd"}]}]}]}]}], "}"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"Inactivate", "[", 
           RowBox[{
            RowBox[{"Compile", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"seq", "@", 
                 RowBox[{"{", 
                  RowBox[{"xgvars", ",", "_Real", ",", "1"}], "}"}]}], ",", 
                RowBox[{"{", 
                 RowBox[{"y", ",", "_Real", ",", "nd"}], "}"}]}], "}"}], ",", 
              RowBox[{"Module", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"seq", "@", "igvars"}], ",", 
                  RowBox[{"seq", "@", "tgvars"}], ",", 
                  RowBox[{"seq", "@", "ivars"}], ",", 
                  RowBox[{"seq", "@", "svars"}], ",", 
                  RowBox[{"seq", "@", "tvars"}]}], "}"}], ",", 
                RowBox[{
                 RowBox[{"seq", "[", 
                  RowBox[{"igvars", "=", 
                   RowBox[{
                    RowBox[{"Floor", "[", "xgvars", "]"}], "-", 
                    RowBox[{"UnitStep", "[", 
                    RowBox[{"xgvars", "-", 
                    RowBox[{"indexed", "@", 
                    RowBox[{"Dimensions", "@", "y"}]}]}], "]"}]}]}], "]"}], ";",
                  "\[IndentingNewLine]", 
                 RowBox[{"seq", "[", 
                  RowBox[{"tgvars", "=", 
                   RowBox[{"xgvars", "-", "igvars"}]}], "]"}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Table", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"seq", "[", 
                    RowBox[{"tvars", "=", 
                    RowBox[{"Compile`GetElement", "[", 
                    RowBox[{"tgvars", ",", "jvars"}], "]"}]}], "]"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"seq", "[", 
                    RowBox[{"ivars", "=", 
                    RowBox[{"Compile`GetElement", "[", 
                    RowBox[{"igvars", ",", "jvars"}], "]"}]}], "]"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"seq", "[", 
                    RowBox[{"svars", "=", 
                    RowBox[{"1.", "-", "tvars"}]}], "]"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"eval", "@", 
                    RowBox[{"Total", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"Times", "@@", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "1"}], "]"}], "]"}]}], " ", 
                    RowBox[{"Compile`GetElement", "[", 
                    RowBox[{"y", ",", 
                    RowBox[{"Sequence", "@@", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "2"}], "]"}], "]"}]}]}], "]"}]}], 
                    "&"}], "/@", 
                    RowBox[{"Tuples", "@", 
                    RowBox[{"Transpose", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"svars", ",", "ivars"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"tvars", ",", 
                    RowBox[{"ivars", "+", "1"}]}], "}"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"2", ",", "3", ",", "1"}], "}"}]}], "]"}]}]}], 
                    "]"}]}]}], ",", 
                   RowBox[{"seq", "@", 
                    RowBox[{"{", 
                    RowBox[{"jvars", ",", 
                    RowBox[{"Length", "@", "igvars"}]}], "}"}]}]}], "]"}]}]}],
                "]"}], ",", 
              RowBox[{"CompilationTarget", "\[Rule]", "\"\<C\>\""}], ",", 
              RowBox[{"RuntimeAttributes", "\[Rule]", 
               RowBox[{"{", "Listable", "}"}]}], ",", 
              RowBox[{"Parallelization", "\[Rule]", "True"}], ",", 
              RowBox[{"RuntimeOptions", "\[Rule]", "\"\<Speed\>\""}]}], "]"}],
             ",", 
            RowBox[{"Except", "[", 
             RowBox[{"seq", "|", "eval", "|", "indexed"}], "]"}]}], "]"}], "/.", 
          RowBox[{
           RowBox[{"seq", "[", "expr_", "]"}], "\[RuleDelayed]", 
           RowBox[{"RuleCondition", "@", 
            RowBox[{"(", 
             RowBox[{"Sequence", "@@", 
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Inactivate", "[", 
                  RowBox[{"expr", ",", 
                   RowBox[{"Except", "[", 
                    RowBox[{"slist", "|", "indexed"}], "]"}]}], "]"}], "/.", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"l_slist", "\[RuleDelayed]", 
                    RowBox[{"l", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], ",", 
                   RowBox[{
                    RowBox[{"indexed", "[", "l_", "]"}], "\[RuleDelayed]", 
                    RowBox[{
                    RowBox[{"Inactive", "[", "Compile`GetElement", "]"}], "[", 
                    RowBox[{"l", ",", "i"}], "]"}]}]}], "}"}]}], ",", 
                RowBox[{"{", 
                 RowBox[{"i", ",", "nd"}], "}"}]}], "]"}]}], ")"}]}]}]}], "/.", 
         RowBox[{
          RowBox[{"eval", "@", "expr_"}], "\[RuleDelayed]", 
          RowBox[{"RuleCondition", "[", 
           RowBox[{"Activate", "[", 
            RowBox[{"expr", "/.", 
             RowBox[{"slist", "\[Rule]", "List"}]}], "]"}], "]"}]}]}]}], 
       "]"}], "//", "Activate"}]}], ";"}]}], "\[IndentingNewLine]", 
  "]"}]], "Input",
 CellChangeTimes->{{3.890711783488103*^9, 3.89071178348964*^9}, {
  3.8907121412539587`*^9, 3.8907121413711557`*^9}, {3.890712694841427*^9, 
  3.8907126950000925`*^9}, {3.890712790376151*^9, 3.8907128219919777`*^9}, {
  3.891018553068019*^9, 3.8910185548862777`*^9}, {3.9546627626908894`*^9, 
  3.954662767891243*^9}},ExpressionUUID->"be5f9589-886e-4d54-b550-\
9b133897abef"]
}, Open  ]],

Cell[CellGroupData[{

Cell["4D to 4D", "Section",
 CellChangeTimes->{{3.890732625178977*^9, 3.890732634660539*^9}, {
  3.8927117366160936`*^9, 
  3.8927117442965827`*^9}},ExpressionUUID->"c48e1bb4-4fdf-48f1-9b87-\
b1d1c7310dd9"],

Cell[BoxData[
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"!", "AccCode"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"nd", "=", "4"}], ";", "\n", 
    RowBox[{"cf4", "=", 
     RowBox[{
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"xgvars", "=", 
           RowBox[{
            RowBox[{
             RowBox[{"Unique", "[", "\"\<xg\>\"", "]"}], "&"}], "/@", 
            RowBox[{"slist", "@@", 
             RowBox[{"Range", "@", "nd"}]}]}]}], ",", 
          RowBox[{"igvars", "=", 
           RowBox[{
            RowBox[{
             RowBox[{"Unique", "[", "\"\<ig\>\"", "]"}], "&"}], "/@", 
            RowBox[{"slist", "@@", 
             RowBox[{"Range", "@", "nd"}]}]}]}], ",", 
          RowBox[{"tgvars", "=", 
           RowBox[{
            RowBox[{
             RowBox[{"Unique", "[", "\"\<tg\>\"", "]"}], "&"}], "/@", 
            RowBox[{"slist", "@@", 
             RowBox[{"Range", "@", "nd"}]}]}]}], ",", 
          RowBox[{"ivars", "=", 
           RowBox[{
            RowBox[{
             RowBox[{"Unique", "[", "\"\<i\>\"", "]"}], "&"}], "/@", 
            RowBox[{"slist", "@@", 
             RowBox[{"Range", "@", "nd"}]}]}]}], ",", 
          RowBox[{"svars", "=", 
           RowBox[{
            RowBox[{
             RowBox[{"Unique", "[", "\"\<s\>\"", "]"}], "&"}], "/@", 
            RowBox[{"slist", "@@", 
             RowBox[{"Range", "@", "nd"}]}]}]}], ",", 
          RowBox[{"tvars", "=", 
           RowBox[{
            RowBox[{
             RowBox[{"Unique", "[", "\"\<t\>\"", "]"}], "&"}], "/@", 
            RowBox[{"slist", "@@", 
             RowBox[{"Range", "@", "nd"}]}]}]}], ",", 
          RowBox[{"jvars", "=", 
           RowBox[{
            RowBox[{
             RowBox[{"Unique", "[", "\"\<j\>\"", "]"}], "&"}], "/@", 
            RowBox[{"slist", "@@", 
             RowBox[{"Range", "@", "nd"}]}]}]}]}], "}"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"Inactivate", "[", 
           RowBox[{
            RowBox[{"Compile", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"seq", "@", 
                 RowBox[{"{", 
                  RowBox[{"xgvars", ",", "_Real", ",", "1"}], "}"}]}], ",", 
                RowBox[{"{", 
                 RowBox[{"y", ",", "_Real", ",", "nd"}], "}"}]}], "}"}], ",", 
              RowBox[{"Module", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"seq", "@", "igvars"}], ",", 
                  RowBox[{"seq", "@", "tgvars"}], ",", 
                  RowBox[{"seq", "@", "ivars"}], ",", 
                  RowBox[{"seq", "@", "svars"}], ",", 
                  RowBox[{"seq", "@", "tvars"}]}], "}"}], ",", 
                RowBox[{
                 RowBox[{"seq", "[", 
                  RowBox[{"igvars", "=", 
                   RowBox[{
                    RowBox[{"Floor", "[", "xgvars", "]"}], "-", 
                    RowBox[{"UnitStep", "[", 
                    RowBox[{"xgvars", "-", 
                    RowBox[{"indexed", "@", 
                    RowBox[{"Dimensions", "@", "y"}]}]}], "]"}]}]}], "]"}], ";",
                  "\[IndentingNewLine]", 
                 RowBox[{"seq", "[", 
                  RowBox[{"tgvars", "=", 
                   RowBox[{"xgvars", "-", "igvars"}]}], "]"}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Table", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"seq", "[", 
                    RowBox[{"tvars", "=", 
                    RowBox[{"Compile`GetElement", "[", 
                    RowBox[{"tgvars", ",", "jvars"}], "]"}]}], "]"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"seq", "[", 
                    RowBox[{"ivars", "=", 
                    RowBox[{"Compile`GetElement", "[", 
                    RowBox[{"igvars", ",", "jvars"}], "]"}]}], "]"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"seq", "[", 
                    RowBox[{"svars", "=", 
                    RowBox[{"1.", "-", "tvars"}]}], "]"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"eval", "@", 
                    RowBox[{"Total", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"Times", "@@", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "1"}], "]"}], "]"}]}], " ", 
                    RowBox[{"Compile`GetElement", "[", 
                    RowBox[{"y", ",", 
                    RowBox[{"Sequence", "@@", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "2"}], "]"}], "]"}]}]}], "]"}]}], 
                    "&"}], "/@", 
                    RowBox[{"Tuples", "@", 
                    RowBox[{"Transpose", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"svars", ",", "ivars"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"tvars", ",", 
                    RowBox[{"ivars", "+", "1"}]}], "}"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"2", ",", "3", ",", "1"}], "}"}]}], "]"}]}]}], 
                    "]"}]}]}], ",", 
                   RowBox[{"seq", "@", 
                    RowBox[{"{", 
                    RowBox[{"jvars", ",", 
                    RowBox[{"Length", "@", "igvars"}]}], "}"}]}]}], "]"}]}]}],
                "]"}], ",", 
              RowBox[{"CompilationTarget", "\[Rule]", "\"\<C\>\""}], ",", 
              RowBox[{"RuntimeAttributes", "\[Rule]", 
               RowBox[{"{", "Listable", "}"}]}], ",", 
              RowBox[{"Parallelization", "\[Rule]", "True"}], ",", 
              RowBox[{"RuntimeOptions", "\[Rule]", "\"\<Speed\>\""}]}], "]"}],
             ",", 
            RowBox[{"Except", "[", 
             RowBox[{"seq", "|", "eval", "|", "indexed"}], "]"}]}], "]"}], "/.", 
          RowBox[{
           RowBox[{"seq", "[", "expr_", "]"}], "\[RuleDelayed]", 
           RowBox[{"RuleCondition", "@", 
            RowBox[{"(", 
             RowBox[{"Sequence", "@@", 
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Inactivate", "[", 
                  RowBox[{"expr", ",", 
                   RowBox[{"Except", "[", 
                    RowBox[{"slist", "|", "indexed"}], "]"}]}], "]"}], "/.", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"l_slist", "\[RuleDelayed]", 
                    RowBox[{"l", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], ",", 
                   RowBox[{
                    RowBox[{"indexed", "[", "l_", "]"}], "\[RuleDelayed]", 
                    RowBox[{
                    RowBox[{"Inactive", "[", "Compile`GetElement", "]"}], "[", 
                    RowBox[{"l", ",", "i"}], "]"}]}]}], "}"}]}], ",", 
                RowBox[{"{", 
                 RowBox[{"i", ",", "nd"}], "}"}]}], "]"}]}], ")"}]}]}]}], "/.", 
         RowBox[{
          RowBox[{"eval", "@", "expr_"}], "\[RuleDelayed]", 
          RowBox[{"RuleCondition", "[", 
           RowBox[{"Activate", "[", 
            RowBox[{"expr", "/.", 
             RowBox[{"slist", "\[Rule]", "List"}]}], "]"}], "]"}]}]}]}], 
       "]"}], "//", "Activate"}]}], ";"}]}], "\[IndentingNewLine]", 
  "]"}]], "Input",
 CellChangeTimes->{{3.8907148978688216`*^9, 3.890714898931299*^9}, {
  3.8910185630697727`*^9, 3.8910185650759544`*^9}, {3.954662770264576*^9, 
  3.9546627733219604`*^9}},ExpressionUUID->"9761727f-dd4c-4b64-bef4-\
b83c06d1e371"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Linear and bilinear interpolations mapping ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"{", 
     RowBox[{"x", ",", "y", ",", "f"}], "}"}], "->", 
    RowBox[{"{", 
     RowBox[{"f", "(", 
      RowBox[{
       SubscriptBox["x", "rand"], ",", 
       SubscriptBox["y", "rand"]}], ")"}], "}"}]}], TraditionalForm]],
  ExpressionUUID->"aeea7840-f501-0348-975e-1ff186f37a60"]
}], "Chapter",
 CellChangeTimes->{
  3.9520953927174644`*^9},ExpressionUUID->"347c023b-10d9-3e4c-892c-\
e61e22be8241"],

Cell[BoxData[
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"!", "AccCode"}], ",", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"For", " ", "mapping", " ", "from", " ", 
      RowBox[{"{", 
       RowBox[{"x", ",", "y", ",", 
        RowBox[{"f", "[", 
         RowBox[{"x", ",", "y"}], "]"}]}], "}"}], " ", "to", 
      FormBox[
       RowBox[{" ", 
        RowBox[{"{", 
         RowBox[{
          SubscriptBox["x", "random"], ",", 
          SubscriptBox["y", "random"], ",", 
          RowBox[{"f", "[", 
           RowBox[{
            SubscriptBox["x", "random"], ",", 
            SubscriptBox["y", "random"]}], "]"}]}]}]}],
       TraditionalForm]}], "}"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"linint2", "=", 
     RowBox[{"Compile", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"rand\[Theta]log", ",", "_Real"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"randElog", ",", "_Real"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"grid\[Theta]log", ",", "_Real", ",", "1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"gridElog", ",", "_Real", ",", "1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"index\[Theta]", ",", "_Integer"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"indexE", ",", "_Integer"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"distrlog", ",", "_Real", ",", "2"}], "}"}]}], "}"}], ",", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "\[Theta]el", ",", "Eel", ",", "x1", ",", "x2", ",", "y1", ",", 
           "y2", ",", "z11", ",", "z21", ",", "z12", ",", "z22", ",", 
           "\[CapitalDelta]", ",", "indexlarger\[Theta]", ",", "indexlargerE",
            ",", "lenE"}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
          "Finding", " ", "the", " ", "index", " ", "of", " ", "the", " ", 
           "grids", " ", "with", " ", "the", " ", "elements", " ", "larged", " ",
            "than", " ", "the", " ", "given", " ", "random", " ", "point"}], 
          "*)"}], "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"\[Theta]el", "=", 
           RowBox[{"Compile`GetElement", "[", 
            RowBox[{"grid\[Theta]log", ",", "index\[Theta]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"indexlarger\[Theta]", "=", 
           RowBox[{"index\[Theta]", "+", 
            RowBox[{"UnitStep", "[", 
             RowBox[{"rand\[Theta]log", "-", "\[Theta]el"}], "]"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Eel", "=", 
           RowBox[{"Compile`GetElement", "[", 
            RowBox[{"gridElog", ",", "indexE"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"indexlargerE", "=", 
           RowBox[{"indexE", "+", 
            RowBox[{"UnitStep", "[", 
             RowBox[{"randElog", "-", "Eel"}], "]"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"The", " ", "two", " ", "points", " ", "x1"}], ",", " ", 
            RowBox[{
             RowBox[{"x2", " ", "with", " ", "x1"}], " ", "<", " ", "x", " ", 
             "<", " ", "x2"}]}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{"x1", "=", 
           RowBox[{"Compile`GetElement", "[", 
            RowBox[{"grid\[Theta]log", ",", 
             RowBox[{"indexlarger\[Theta]", "-", "1"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"x2", "=", 
           RowBox[{"Compile`GetElement", "[", 
            RowBox[{"grid\[Theta]log", ",", "indexlarger\[Theta]"}], "]"}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"y1", "=", 
           RowBox[{"Compile`GetElement", "[", 
            RowBox[{"gridElog", ",", 
             RowBox[{"indexlargerE", "-", "1"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"y2", "=", 
           RowBox[{"Compile`GetElement", "[", 
            RowBox[{"gridElog", ",", "indexlargerE"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
           "Corresponding", " ", "values", " ", "of", " ", "the", " ", 
            "function"}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{"lenE", "=", 
           RowBox[{"Length", "[", "gridElog", "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"z11", "=", 
           RowBox[{"Compile`GetElement", "[", 
            RowBox[{"distrlog", ",", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"indexlarger\[Theta]", "-", "2"}], ")"}], "*", 
               "lenE"}], "+", "indexlargerE", "-", "1"}], ",", "3"}], "]"}]}],
           ";", "\[IndentingNewLine]", 
          RowBox[{"z21", "=", 
           RowBox[{"Compile`GetElement", "[", 
            RowBox[{"distrlog", ",", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"indexlarger\[Theta]", "-", "1"}], ")"}], "*", 
               "lenE"}], "+", "indexlargerE", "-", "1"}], ",", "3"}], "]"}]}],
           ";", "\[IndentingNewLine]", 
          RowBox[{"z12", "=", 
           RowBox[{"Compile`GetElement", "[", 
            RowBox[{"distrlog", ",", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"indexlarger\[Theta]", "-", "2"}], ")"}], "*", 
               "lenE"}], "+", "indexlargerE"}], ",", "3"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"z22", "=", 
           RowBox[{"Compile`GetElement", "[", 
            RowBox[{"distrlog", ",", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"indexlarger\[Theta]", "-", "1"}], ")"}], "*", 
               "lenE"}], "+", "indexlargerE"}], ",", "3"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"\[CapitalDelta]", "=", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"x2", "-", "x1"}], ")"}], 
            RowBox[{"(", 
             RowBox[{"y2", "-", "y1"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"Exp", "[", 
           RowBox[{"(*", 
            RowBox[{"{", 
             RowBox[{
             "rand\[Theta]log", ",", "x1", ",", "x2", ",", "randElog", ",", 
              "y1", ",", "y2", ",", "z11", ",", "z21", ",", "z12", ",", "z22",
               ","}]}], "*)"}], 
           RowBox[{
            RowBox[{
             FractionBox[
              RowBox[{
               RowBox[{"(", 
                RowBox[{"x2", "-", "rand\[Theta]log"}], ")"}], "*", 
               RowBox[{"(", 
                RowBox[{"y2", "-", "randElog"}], ")"}]}], "\[CapitalDelta]"], 
             "*", "z11"}], "+", 
            RowBox[{
             FractionBox[
              RowBox[{
               RowBox[{"(", 
                RowBox[{"rand\[Theta]log", "-", "x1"}], ")"}], "*", 
               RowBox[{"(", 
                RowBox[{"y2", "-", "randElog"}], ")"}]}], "\[CapitalDelta]"], 
             "z21"}], "+", 
            RowBox[{
             FractionBox[
              RowBox[{
               RowBox[{"(", 
                RowBox[{"x2", "-", "rand\[Theta]log"}], ")"}], 
               RowBox[{"(", 
                RowBox[{"randElog", "-", "y1"}], ")"}]}], "\[CapitalDelta]"], 
             "*", "z12"}], "+", 
            RowBox[{
             FractionBox[
              RowBox[{
               RowBox[{"(", 
                RowBox[{"rand\[Theta]log", "-", "x1"}], ")"}], 
               RowBox[{"(", 
                RowBox[{"randElog", "-", "y1"}], ")"}]}], 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"x2", "-", "x1"}], ")"}], 
               RowBox[{"(", 
                RowBox[{"y2", "-", "y1"}], ")"}]}]], "z22"}]}], "]"}]}]}], 
        RowBox[{"(*", "}", "*)"}], "\[IndentingNewLine]", "]"}], ",", 
       RowBox[{"CompilationTarget", "->", "\"\<C\>\""}], ",", 
       RowBox[{"RuntimeOptions", "->", "\"\<Speed\>\""}], ",", 
       RowBox[{"RuntimeAttributes", "->", 
        RowBox[{"{", "Listable", "}"}]}], ",", 
       RowBox[{"Parallelization", "->", "True"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"<<", "CompiledFunctionTools`"}], ";", "\n", 
    RowBox[{"CompilePrint", "@", "linint2"}], ";", "\[IndentingNewLine]", 
    RowBox[{"linint1", "=", 
     RowBox[{"Compile", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"rand\[Theta]log", ",", "_Real"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"grid\[Theta]log", ",", "_Real", ",", "1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"index\[Theta]", ",", "_Integer"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"distrlog", ",", "_Real", ",", "2"}], "}"}]}], "}"}], ",", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "\[Theta]el", ",", "x1", ",", "x2", ",", "z1", ",", "z2", ",", 
           "\[CapitalDelta]", ",", "indexlarger\[Theta]"}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
          "Finding", " ", "the", " ", "index", " ", "of", " ", "the", " ", 
           "grids", " ", "with", " ", "the", " ", "elements", " ", "larged", " ",
            "than", " ", "the", " ", "given", " ", "random", " ", "point"}], 
          "*)"}], "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"\[Theta]el", "=", 
           RowBox[{"Compile`GetElement", "[", 
            RowBox[{"grid\[Theta]log", ",", "index\[Theta]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"indexlarger\[Theta]", "=", 
           RowBox[{"index\[Theta]", "+", 
            RowBox[{"UnitStep", "[", 
             RowBox[{"rand\[Theta]log", "-", "\[Theta]el"}], "]"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"The", " ", "two", " ", "points", " ", "x1"}], ",", " ", 
            RowBox[{
             RowBox[{"x2", " ", "with", " ", "x1"}], " ", "<", " ", "x", " ", 
             "<", " ", "x2"}]}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{"x1", "=", 
           RowBox[{"Compile`GetElement", "[", 
            RowBox[{"grid\[Theta]log", ",", 
             RowBox[{"indexlarger\[Theta]", "-", "1"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"x2", "=", 
           RowBox[{"Compile`GetElement", "[", 
            RowBox[{"grid\[Theta]log", ",", "indexlarger\[Theta]"}], "]"}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
           "Corresponding", " ", "values", " ", "of", " ", "the", " ", 
            "function"}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{"z1", "=", 
           RowBox[{"Compile`GetElement", "[", 
            RowBox[{"distrlog", ",", "indexlarger\[Theta]", ",", "2"}], 
            "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"z2", "=", 
           RowBox[{"Compile`GetElement", "[", 
            RowBox[{"distrlog", ",", 
             RowBox[{"indexlarger\[Theta]", "-", "1"}], ",", "2"}], "]"}]}], ";",
           "\[IndentingNewLine]", 
          RowBox[{"\[CapitalDelta]", "=", 
           RowBox[{"(", 
            RowBox[{"x2", "-", "x1"}], ")"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{"{", 
            RowBox[{
            "rand\[Theta]log", ",", "x1", ",", "x2", ",", "z1", ",", "z2", 
             ","}]}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{"z1", "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"rand\[Theta]log", "-", "x1"}], ")"}], "*", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"z2", "-", "z1"}], ")"}], "/", 
             "\[CapitalDelta]"}]}]}]}]}], 
        RowBox[{"(*", "}", "*)"}], "\[IndentingNewLine]", "]"}], ",", 
       RowBox[{"CompilationTarget", "->", "\"\<C\>\""}], ",", 
       RowBox[{"RuntimeOptions", "->", "\"\<Speed\>\""}], ",", 
       RowBox[{"RuntimeAttributes", "->", 
        RowBox[{"{", "Listable", "}"}]}], ",", 
       RowBox[{"Parallelization", "->", "True"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"<<", "CompiledFunctionTools`"}], ";", "\n", 
    RowBox[{"CompilePrint", "@", "linint1"}], ";", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
     "Basic", " ", "linear", " ", "search", " ", "function", " ", "adjusted", 
      " ", "to", " ", "return", " ", "the", " ", "index", " ", "of", " ", 
      "the", " ", "largest", " ", "element", " ", "smaller", " ", "than", " ",
       "or", " ", "equal", " ", "to", " ", "val"}], "*)"}], 
    RowBox[{"nearestIndexSearch", "=", 
     RowBox[{"Compile", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"arr", ",", "_Real", ",", "1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"val", ",", "_Real"}], "}"}]}], "}"}], ",", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"i", "=", "1"}], "}"}], ",", 
         RowBox[{
          RowBox[{"While", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"i", "<=", 
              RowBox[{"Length", "[", "arr", "]"}]}], "&&", 
             RowBox[{"val", ">=", 
              RowBox[{"arr", "[", 
               RowBox[{"[", "i", "]"}], "]"}]}]}], ",", 
            RowBox[{"i", "++"}]}], "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"i", "-", "1"}]}]}], "]"}], ",", 
       RowBox[{"CompilationTarget", "->", "\"\<C\>\""}], ",", 
       RowBox[{"RuntimeOptions", "->", "\"\<Speed\>\""}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"linint2WithNearest", "=", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"nf", "=", "nearestIndexSearch"}], "}"}], ",", 
       RowBox[{"Compile", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"xlogrand", ",", "_Real"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"ylogrand", ",", "_Real"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"gridxlog", ",", "_Real", ",", "1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"gridylog", ",", "_Real", ",", "1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"distrlog", ",", "_Real", ",", "1"}], "}"}]}], "}"}], ",", 
         RowBox[{"Module", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
            "xel", ",", "yel", ",", "x1", ",", "x2", ",", "y1", ",", "y2", ",",
              "z11", ",", "z21", ",", "z12", ",", "z22", ",", 
             "\[CapitalDelta]", ",", "leny", ",", "indexlargerx", ",", 
             "indexlargery", ",", "nearestindexx", ",", "nearestindexy"}], 
            "}"}], ",", 
           RowBox[{"(*", 
            RowBox[{
            "Finding", " ", "the", " ", "index", " ", "of", " ", "the", " ", 
             "grids", " ", "with", " ", "the", " ", "elements", " ", "larger",
              " ", "than", " ", "the", " ", "given", " ", "random", " ", 
             "point"}], "*)"}], "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"nearestindexx", "=", 
             RowBox[{"nf", "[", 
              RowBox[{"gridxlog", ",", "xlogrand"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"nearestindexy", "=", 
             RowBox[{"nf", "[", 
              RowBox[{"gridylog", ",", "ylogrand"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{
             "Adjust", " ", "indices", " ", "to", " ", "ensure", " ", "the", " ",
               "correct", " ", "bounding", " ", "values"}], "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{"indexlargerx", "=", 
             RowBox[{"nearestindexx", "+", "1"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"indexlargery", "=", 
             RowBox[{"nearestindexy", "+", "1"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{"The", " ", "two", " ", "points", " ", "x1"}], ",", " ", 
              RowBox[{
               RowBox[{"x2", " ", "with", " ", "x1"}], " ", "<", " ", "x", 
               " ", "<", " ", "x2"}]}], "*)"}], "\[IndentingNewLine]", 
            RowBox[{"x1", "=", 
             RowBox[{"Compile`GetElement", "[", 
              RowBox[{"gridxlog", ",", 
               RowBox[{"indexlargerx", "-", "1"}]}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"x2", "=", 
             RowBox[{"Compile`GetElement", "[", 
              RowBox[{"gridxlog", ",", "indexlargerx"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"y1", "=", 
             RowBox[{"Compile`GetElement", "[", 
              RowBox[{"gridylog", ",", 
               RowBox[{"indexlargery", "-", "1"}]}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"y2", "=", 
             RowBox[{"Compile`GetElement", "[", 
              RowBox[{"gridylog", ",", "indexlargery"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{
             "Corresponding", " ", "values", " ", "of", " ", "the", " ", 
              "function"}], "*)"}], "\[IndentingNewLine]", 
            RowBox[{"leny", "=", 
             RowBox[{"Length", "[", "gridylog", "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"z11", "=", 
             RowBox[{"Compile`GetElement", "[", 
              RowBox[{"distrlog", ",", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"indexlargerx", "-", "2"}], ")"}], "*", "leny"}], "+",
                 "indexlargery", "-", "1"}]}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"z21", "=", 
             RowBox[{"Compile`GetElement", "[", 
              RowBox[{"distrlog", ",", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"indexlargerx", "-", "1"}], ")"}], "*", "leny"}], "+",
                 "indexlargery", "-", "1"}]}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"z12", "=", 
             RowBox[{"Compile`GetElement", "[", 
              RowBox[{"distrlog", ",", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"indexlargerx", "-", "2"}], ")"}], "*", "leny"}], "+",
                 "indexlargery"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"z22", "=", 
             RowBox[{"Compile`GetElement", "[", 
              RowBox[{"distrlog", ",", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"indexlargerx", "-", "1"}], ")"}], "*", "leny"}], "+",
                 "indexlargery"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"\[CapitalDelta]", "=", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"x2", "-", "x1"}], ")"}], 
              RowBox[{"(", 
               RowBox[{"y2", "-", "y1"}], ")"}]}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"Exp", "[", 
             RowBox[{"(*", 
              RowBox[{"{", 
               RowBox[{
               "rand\[Theta]log", ",", "x1", ",", "x2", ",", "randElog", ",", 
                "y1", ",", "y2", ",", "z11", ",", "z21", ",", "z12", ",", 
                "z22", ","}]}], "*)"}], 
             RowBox[{
              RowBox[{
               FractionBox[
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"x2", "-", "xlogrand"}], ")"}], "*", 
                 RowBox[{"(", 
                  RowBox[{"y2", "-", "ylogrand"}], ")"}]}], 
                "\[CapitalDelta]"], "*", "z11"}], "+", 
              RowBox[{
               FractionBox[
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"xlogrand", "-", "x1"}], ")"}], "*", 
                 RowBox[{"(", 
                  RowBox[{"y2", "-", "ylogrand"}], ")"}]}], 
                "\[CapitalDelta]"], "z21"}], "+", 
              RowBox[{
               FractionBox[
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"x2", "-", "xlogrand"}], ")"}], 
                 RowBox[{"(", 
                  RowBox[{"ylogrand", "-", "y1"}], ")"}]}], 
                "\[CapitalDelta]"], "*", "z12"}], "+", 
              RowBox[{
               FractionBox[
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"xlogrand", "-", "x1"}], ")"}], 
                 RowBox[{"(", 
                  RowBox[{"ylogrand", "-", "y1"}], ")"}]}], 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"x2", "-", "x1"}], ")"}], 
                 RowBox[{"(", 
                  RowBox[{"y2", "-", "y1"}], ")"}]}]], "z22"}]}], "]"}]}]}], 
          RowBox[{"(*", "}", "*)"}], "]"}], "\[IndentingNewLine]", ",", 
         RowBox[{"CompilationTarget", "->", "\"\<C\>\""}], ",", 
         RowBox[{"RuntimeOptions", "->", "\"\<Speed\>\""}], ",", 
         RowBox[{"RuntimeAttributes", "->", 
          RowBox[{"{", "Listable", "}"}]}], ",", 
         RowBox[{"Parallelization", "->", "True"}], ",", 
         RowBox[{"CompilationOptions", "->", 
          RowBox[{"{", 
           RowBox[{"\"\<InlineCompiledFunctions\>\"", "->", "True"}], 
           "}"}]}]}], "]"}]}], "]"}]}], ";"}]}], "\[IndentingNewLine]", 
  "]"}]], "Input",
 CellChangeTimes->{{3.9546627759715004`*^9, 
  3.9546628087322826`*^9}},ExpressionUUID->"be73174a-8d0d-4157-8a73-\
61dd1317e2e4"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Various parameters", "Chapter",
 CellChangeTimes->{{3.9340922577659883`*^9, 
  3.9340922599112806`*^9}},ExpressionUUID->"b21696a6-6550-4593-bb2f-\
3412d4a5190a"],

Cell[CellGroupData[{

Cell["Facilities properties", "Section",
 CellChangeTimes->{{3.935130849440071*^9, 
  3.9351308575034857`*^9}},ExpressionUUID->"79df926b-49b8-452d-8cfd-\
9a98d29fac88"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"EmaxFacility", "[", "\"\<SPS\>\"", "]"}], "=", "400."}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"EmaxFacility", "[", "\"\<FermilabBD\>\"", "]"}], "=", "120."}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"EmaxFacility", "[", "\"\<Serpukhov\>\"", "]"}], "=", "70."}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"EmaxFacility", "[", "\"\<LHC\>\"", "]"}], "=", "6500."}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"EmaxFacility", "[", "\"\<FCC-hh\>\"", "]"}], "=", "50000."}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"EmaxFacility", "[", "\"\<ESS\>\"", "]"}], "=", "2."}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"EmaxFacility", "[", "\"\<SLAC-E137\>\"", "]"}], "=", "20."}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"EmaxFacility", "[", "\"\<SuperKEKB\>\"", "]"}], "=", "11.006"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"FacilitiesList", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"Keys", "[", 
     RowBox[{"DownValues", "@", "EmaxFacility"}], "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", "1", ",", "1"}], "]"}], "]"}], "//", "Sort"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FacilityDescription", "[", "\"\<SuperKEKB\>\"", "]"}], 
   "=", "\"\<Facility housing Belle II. Asymmetric collisions of electrons \
and positrons with \!\(\*SubscriptBox[\(m\), \(ee\)]\) close to the mass of \
the \[CapitalUpsilon] resonances\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FacilityDescription", "[", "\"\<ESS\>\"", "]"}], 
   "=", "\"\<Neutrino spallation experiment, proton beam dump producing pions \
decaying at rest into neutrinos. The proton beam has small energy \
\!\(\*SubscriptBox[\(E\), \(p\)]\) ~ 2 GeV\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FacilityDescription", "[", "\"\<SPS\>\"", "]"}], 
   "=", "\"\<Proton beam dump facilities at SPS. May differ in target \
material and location, but the main feature is intense 400 GeV proton \
beam\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FacilityDescription", "[", "\"\<LHC\>\"", "]"}], " ", "=", 
   " ", "\"\<LHC, with \!\(\*SqrtBox[\(s\)]\) = 13 TeV\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FacilityDescription", "[", "\"\<FermilabBD\>\"", "]"}], " ", "=", 
   " ", "\"\<Proton beam dump facilities at Fermilab. May differ in target \
material and location, but the main feature is intense 120 GeV proton \
beam\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FacilityDescription", "[", "\"\<Serpukhov\>\"", "]"}], " ", "=", 
   " ", "\"\<Proton beam dump facility that housed NuCal experiment. The \
proton beam had energy 70 GeV\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FacilityDescription", "[", "\"\<SLAC-E137\>\"", "]"}], " ", "=", 
   " ", "\"\<Electron beam dump facility at SLAC that housed E137 experiment. \
The electron beam energy was 20 GeV\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"EcmFacility", "[", "Fac", "]"}], "=", 
    SqrtBox[
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"EmaxFacility", "[", "Fac", "]"}], "+", "0.938"}], ")"}], 
       "2"], "-", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"EmaxFacility", "[", "Fac", "]"}], "2"], "-", 
        SuperscriptBox["0.938", "2"]}], ")"}]}]]}], "\[IndentingNewLine]", ",", 
   RowBox[{"{", 
    RowBox[{"Fac", ",", 
     RowBox[{"{", 
      RowBox[{"\"\<Serpukhov\>\"", ",", "\"\<SPS\>\"", 
       ",", "\"\<FermilabBD\>\"", ",", "\"\<ESS\>\""}], "}"}]}], "}"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"EcmFacility", "[", "Fac", "]"}], "=", 
    SqrtBox[
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"EmaxFacility", "[", "Fac", "]"}], "+", 
         RowBox[{"0.511", "*", 
          SuperscriptBox["10", 
           RowBox[{"-", "3"}]]}]}], ")"}], "2"], "-", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"EmaxFacility", "[", "Fac", "]"}], "2"], "-", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"0.511", "*", 
           SuperscriptBox["10", 
            RowBox[{"-", "3"}]]}], ")"}], "2"]}], ")"}]}]]}], 
   "\[IndentingNewLine]", ",", 
   RowBox[{"{", 
    RowBox[{"Fac", ",", 
     RowBox[{"{", "\"\<SLAC-E137\>\"", "}"}]}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"EcmFacility", "[", "Fac", "]"}], "=", 
    RowBox[{"2", 
     RowBox[{"EmaxFacility", "[", "Fac", "]"}]}]}], "\[IndentingNewLine]", ",", 
   RowBox[{"{", 
    RowBox[{"Fac", ",", 
     RowBox[{"{", 
      RowBox[{"\"\<LHC\>\"", ",", "\"\<FCC-hh\>\""}], "}"}]}], "}"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"EcmFacility", "[", "\"\<SuperKEKB\>\"", "]"}], " ", "=", 
   SqrtBox[
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"7.004", "+", "4.002"}], ")"}], "2"], "-", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"7.004", "-", "4.002"}], ")"}], "2"]}]]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"vCMbeamDump", "[", 
    RowBox[{"Eplab_", ",", "MP_"}], "]"}], "=", 
   RowBox[{"v", "/.", 
    RowBox[{
     RowBox[{"Solve", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         SqrtBox[
          RowBox[{
           SuperscriptBox["Eplab", "2"], "-", 
           SuperscriptBox["MP", "2"]}]], "-", 
         RowBox[{"Eplab", "*", "v"}]}], "\[Equal]", 
        RowBox[{"MP", "*", "v"}]}], ",", "v"}], "]"}], "[", 
     RowBox[{"[", "1", "]"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Gamma]CMbeamDump", "[", 
    RowBox[{"Eplab_", ",", "MP_"}], "]"}], "=", 
   RowBox[{
    FractionBox["1", 
     SqrtBox[
      RowBox[{"1", "-", 
       SuperscriptBox[
        RowBox[{"vCMbeamDump", "[", 
         RowBox[{"Eplab", ",", "MP"}], "]"}], "2"]}]]], "//", "Simplify"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.9351310324221835`*^9, 3.9351310326069994`*^9}, {
  3.9433762521399193`*^9, 3.9433763001653976`*^9}, {3.9433778803357887`*^9, 
  3.943377900556139*^9}, {3.9496426869824696`*^9, 3.949642695611063*^9}, {
  3.949642729959736*^9, 3.9496427307420025`*^9}, {3.9496428186310177`*^9, 
  3.949642875522892*^9}, {3.94964291423876*^9, 3.949642919095375*^9}, {
  3.95069721647723*^9, 3.9506972212004337`*^9}, {3.950697372175089*^9, 
  3.9506973780408688`*^9}, {3.950697410888548*^9, 3.950697700666136*^9}, {
  3.9506977748447533`*^9, 3.950697781186058*^9}},
 CellLabel->"In[19]:=",ExpressionUUID->"a89bd970-0d75-4bd8-a8f3-5d2f1fc34d8b"],

Cell[BoxData[
 FormBox[
  RowBox[{"{", 
   RowBox[{"\<\"ESS\"\>", ",", "\<\"FCC-hh\"\>", ",", "\<\"FermilabBD\"\>", 
    ",", "\<\"LHC\"\>", ",", "\<\"Serpukhov\"\>", ",", "\<\"SLAC-E137\"\>", 
    ",", "\<\"SPS\"\>", ",", "\<\"SuperKEKB\"\>"}], "}"}], 
  TraditionalForm]], "Output",
 CellChangeTimes->{
  3.9433779008101883`*^9, 3.9496429194991016`*^9, 3.9506975073546696`*^9, 
   3.951470120070425*^9, {3.9514702267584248`*^9, 3.9514702299346676`*^9}},
 CellLabel->
  "Out[416]=",ExpressionUUID->"d25164da-4d97-a542-a4e4-3df8dcecf533"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Angle-energy grids for the tabulated distributions", "Subsection",
 CellChangeTimes->{{3.9351309031037602`*^9, 
  3.93513091035882*^9}},ExpressionUUID->"33579614-1aa2-4319-b032-\
dbd0bab63a0c"],

Cell[BoxData[
 RowBox[{"If", "[", 
  RowBox[{"LLPdistr", ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"StepEtemp", "[", "Efip_", "]"}], "=", 
     RowBox[{"Piecewise", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0.05", ",", 
          RowBox[{"0", "<=", "Efip", "<", "0.5"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0.2", ",", 
          RowBox[{"0.5", "<=", "Efip", "\[LessEqual]", "2.5"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0.3", ",", 
          RowBox[{"2.5", "<", "Efip", "<=", "7"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0.5", ",", 
          RowBox[{"7", "<", "Efip", "<=", "10"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"1", ",", 
          RowBox[{"10", "<", "Efip", "<", "35"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"2", ",", 
          RowBox[{"35", "\[LessEqual]", "Efip", "\[LessEqual]", "50"}]}], 
         "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"5", ",", 
          RowBox[{"50", "<", "Efip", "<", "200"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"10", ",", 
          RowBox[{"200", "<=", "Efip", "<", "400"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"20", ",", 
          RowBox[{"400", "\[LessEqual]", "Efip", "<", "700"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"50", ",", 
          RowBox[{"700", "\[LessEqual]", "Efip", "<", "2000"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"200", ",", 
          RowBox[{"2000", "\[LessEqual]", "Efip", "<", "4000"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"400", ",", 
          RowBox[{"4000", "\[LessEqual]", "Efip", "<", "7000"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"500", ",", 
          RowBox[{"7000", "\[LessEqual]", "Efip", "\[LessEqual]", "50000"}]}],
          "}"}]}], "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ENlist", "[", "\"\<SuperKEKB\>\"", "]"}], "=", 
     RowBox[{
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"With", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"start", "=", "0.005"}], ",", 
            RowBox[{"end", "=", 
             RowBox[{"EmaxFacility", "[", "\"\<SuperKEKB\>\"", "]"}]}]}], 
           "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{"NestWhileList", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"#", "+", 
              RowBox[{"StepEtemp", "[", "#", "]"}]}], "&"}], ",", "start", ",", 
            RowBox[{
             RowBox[{"#", "\[LessEqual]", "end"}], "&"}], ",", "1", ",", 
            "\[Infinity]", ",", 
            RowBox[{"-", "1"}]}], "]"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"EmaxFacility", "[", "\"\<SuperKEKB\>\"", "]"}], "}"}]}], 
       "]"}], "//", "N"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\[Theta]Nlist", "[", "\"\<SuperKEKB\>\"", "]"}], "=", 
     RowBox[{
      RowBox[{"\[Theta]NlistLight", "[", "\"\<SuperKEKB\>\"", "]"}], "=", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          SuperscriptBox["10", 
           RowBox[{"-", "5."}]], ",", 
          SuperscriptBox["10", 
           RowBox[{"-", "4."}]], ",", 
          SuperscriptBox["10", 
           RowBox[{"-", "3."}]], ",", 
          RowBox[{"3", "*", 
           SuperscriptBox["10", 
            RowBox[{"-", "3."}]]}], ",", 
          RowBox[{"6", "*", 
           SuperscriptBox["10", 
            RowBox[{"-", "3."}]]}], ",", 
          SuperscriptBox["10", 
           RowBox[{"-", "2."}]]}], "}"}], ",", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"2", "*", "k", "*", 
           SuperscriptBox["10", 
            RowBox[{"-", "2."}]]}], ",", 
          RowBox[{"{", 
           RowBox[{"k", ",", "1", ",", "5", ",", "1"}], "}"}]}], "]"}], ",", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"k", "*", 
           SuperscriptBox["10", 
            RowBox[{"-", "1."}]]}], ",", 
          RowBox[{"{", 
           RowBox[{"k", ",", "1", ",", "15", ",", "1"}], "}"}]}], "]"}]}], 
       "]"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\[Theta]Nlist", "[", "\"\<SuperKEKB\>\"", "]"}], "=", 
     RowBox[{
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"\[Theta]Nlist", "[", "\"\<SuperKEKB\>\"", "]"}], ",", 
        RowBox[{"Pi", "-", 
         RowBox[{"\[Theta]Nlist", "[", "\"\<SuperKEKB\>\"", "]"}]}]}], "]"}], 
      "//", "Sort"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ENlist", "[", "\"\<SLAC-E137\>\"", "]"}], "=", 
     RowBox[{
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"With", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"start", "=", "0.005"}], ",", 
            RowBox[{"end", "=", 
             RowBox[{"EmaxFacility", "[", "\"\<SLAC-E137\>\"", "]"}]}]}], 
           "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{"NestWhileList", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"#", "+", 
              RowBox[{"StepEtemp", "[", "#", "]"}]}], "&"}], ",", "start", ",", 
            RowBox[{
             RowBox[{"#", "\[LessEqual]", "end"}], "&"}], ",", "1", ",", 
            "\[Infinity]", ",", 
            RowBox[{"-", "1"}]}], "]"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"EmaxFacility", "[", "\"\<SLAC-E137\>\"", "]"}], "}"}]}], 
       "]"}], "//", "N"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\[Theta]Nlist", "[", "\"\<SLAC-E137\>\"", "]"}], "=", 
     RowBox[{
      RowBox[{"\[Theta]NlistLight", "[", "\"\<SLAC-E137\>\"", "]"}], "=", 
      RowBox[{
       RowBox[{"Join", "[", 
        RowBox[{"{", 
         RowBox[{
          SuperscriptBox["10", 
           RowBox[{"-", "5."}]], ",", 
          RowBox[{"5", "*", 
           SuperscriptBox["10", 
            RowBox[{"-", "5."}]]}], ",", 
          SuperscriptBox["10", 
           RowBox[{"-", "4."}]], ",", 
          RowBox[{"3", "*", 
           SuperscriptBox["10", 
            RowBox[{"-", "4."}]]}], ",", 
          RowBox[{"6", "*", 
           SuperscriptBox["10", 
            RowBox[{"-", "4."}]]}], ",", 
          SuperscriptBox["10", 
           RowBox[{"-", "3."}]], ",", 
          RowBox[{"2", "*", 
           SuperscriptBox["10", 
            RowBox[{"-", "3."}]]}], ",", 
          RowBox[{"3", "*", 
           SuperscriptBox["10", 
            RowBox[{"-", "3."}]]}], ",", 
          RowBox[{"4", "*", 
           SuperscriptBox["10", 
            RowBox[{"-", "3."}]]}], ",", 
          RowBox[{"5", "*", 
           SuperscriptBox["10", 
            RowBox[{"-", "3."}]]}], ",", 
          RowBox[{"6", "*", 
           SuperscriptBox["10", 
            RowBox[{"-", "3."}]]}], ",", 
          RowBox[{"7", "*", 
           SuperscriptBox["10", 
            RowBox[{"-", "3."}]]}], ",", 
          RowBox[{"8", "*", 
           SuperscriptBox["10", 
            RowBox[{"-", "3."}]]}], ",", 
          RowBox[{"9", "*", 
           SuperscriptBox["10", 
            RowBox[{"-", "3."}]]}], ",", "0.01"}], "}"}], 
        RowBox[{"(*", 
         RowBox[{",", 
          RowBox[{"Table", "[", 
           RowBox[{
            SuperscriptBox["10", "\[Theta]N"], ",", 
            RowBox[{"{", 
             RowBox[{"\[Theta]N", ",", 
              RowBox[{"Log10", "[", 
               SuperscriptBox["10", 
                RowBox[{"-", "2."}]], "]"}], ",", 
              RowBox[{"Log10", "[", "0.8", "]"}], ",", "0.05"}], "}"}]}], 
           "]"}], ",", 
          RowBox[{"{", 
           RowBox[{
           "0.85", ",", "0.95", ",", "1.05", ",", "1.2", ",", "1.4", ",", 
            "1.6", ",", "1.9", ",", "2.2", ",", "2.4", ",", "2.7", ",", "3.", 
            ",", "Pi"}], "}"}]}], "*)"}], "]"}], "//", "N"}]}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ENlist", "[", "\"\<SPS\>\"", "]"}], "=", 
     RowBox[{
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"With", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"start", "=", "0.005"}], ",", 
            RowBox[{"end", "=", 
             RowBox[{"EmaxFacility", "[", "\"\<SPS\>\"", "]"}]}]}], "}"}], ",",
           "\[IndentingNewLine]", 
          RowBox[{"NestWhileList", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"#", "+", 
              RowBox[{"StepEtemp", "[", "#", "]"}]}], "&"}], ",", "start", ",", 
            RowBox[{
             RowBox[{"#", "\[LessEqual]", "end"}], "&"}], ",", "1", ",", 
            "\[Infinity]", ",", 
            RowBox[{"-", "1"}]}], "]"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"EmaxFacility", "[", "\"\<SPS\>\"", "]"}], "}"}]}], "]"}], "//",
       "N"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\[Theta]Nlist", "[", "\"\<SPS\>\"", "]"}], "=", 
     RowBox[{
      RowBox[{"\[Theta]NlistLight", "[", "\"\<SPS\>\"", "]"}], "=", 
      RowBox[{
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SuperscriptBox["10", 
            RowBox[{"-", "5."}]], ",", 
           RowBox[{"5", "*", 
            SuperscriptBox["10", 
             RowBox[{"-", "5."}]]}], ",", 
           SuperscriptBox["10", 
            RowBox[{"-", "4."}]], ",", 
           RowBox[{"3", "*", 
            SuperscriptBox["10", 
             RowBox[{"-", "4."}]]}], ",", 
           RowBox[{"6", "*", 
            SuperscriptBox["10", 
             RowBox[{"-", "4."}]]}], ",", 
           SuperscriptBox["10", 
            RowBox[{"-", "3."}]], ",", 
           RowBox[{"2", "*", 
            SuperscriptBox["10", 
             RowBox[{"-", "3."}]]}], ",", 
           RowBox[{"4", "*", 
            SuperscriptBox["10", 
             RowBox[{"-", "3."}]]}], ",", 
           RowBox[{"6", "*", 
            SuperscriptBox["10", 
             RowBox[{"-", "3."}]]}], ",", 
           RowBox[{"8", "*", 
            SuperscriptBox["10", 
             RowBox[{"-", "3."}]]}]}], "}"}], ",", 
         RowBox[{"Table", "[", 
          RowBox[{
           SuperscriptBox["10", "\[Theta]N"], ",", 
           RowBox[{"{", 
            RowBox[{"\[Theta]N", ",", 
             RowBox[{"Log10", "[", 
              SuperscriptBox["10", 
               RowBox[{"-", "2"}]], "]"}], ",", 
             RowBox[{"Log10", "[", "0.8", "]"}], ",", "0.05"}], "}"}]}], 
          "]"}], ",", 
         RowBox[{"{", 
          RowBox[{
          "0.85", ",", "0.95", ",", "1.05", ",", "1.2", ",", "1.4", ",", 
           "1.6", ",", "1.9", ",", "2.2", ",", "2.4", ",", "2.7", ",", "3.", ",",
            "Pi"}], "}"}]}], "]"}], "//", "N"}]}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\[Theta]NlistB", "[", "\"\<SPS\>\"", "]"}], "=", 
     RowBox[{
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          SuperscriptBox["10", 
           RowBox[{"-", "5."}]], ",", 
          RowBox[{"5", "*", 
           SuperscriptBox["10", 
            RowBox[{"-", "5."}]]}], ",", 
          SuperscriptBox["10", 
           RowBox[{"-", "4."}]], ",", 
          RowBox[{"3", "*", 
           SuperscriptBox["10", 
            RowBox[{"-", "4."}]]}], ",", 
          RowBox[{"6", "*", 
           SuperscriptBox["10", 
            RowBox[{"-", "4."}]]}], ",", 
          SuperscriptBox["10", 
           RowBox[{"-", "3."}]], ",", 
          RowBox[{"2", "*", 
           SuperscriptBox["10", 
            RowBox[{"-", "3."}]]}], ",", 
          RowBox[{"4", "*", 
           SuperscriptBox["10", 
            RowBox[{"-", "3."}]]}], ",", 
          RowBox[{"6", "*", 
           SuperscriptBox["10", 
            RowBox[{"-", "3."}]]}], ",", 
          RowBox[{"8", "*", 
           SuperscriptBox["10", 
            RowBox[{"-", "3."}]]}]}], "}"}], ",", 
        RowBox[{"Table", "[", 
         RowBox[{
          SuperscriptBox["10", "\[Theta]N"], ",", 
          RowBox[{"{", 
           RowBox[{"\[Theta]N", ",", 
            RowBox[{"Log10", "[", 
             SuperscriptBox["10", 
              RowBox[{"-", "2"}]], "]"}], ",", 
            RowBox[{"Log10", "[", "0.8", "]"}], ",", "0.03"}], "}"}]}], "]"}],
         ",", 
        RowBox[{"{", 
         RowBox[{
         "0.85", ",", "0.95", ",", "1.05", ",", "1.2", ",", "1.4", ",", "1.6",
           ",", "1.9", ",", "2.2", ",", "2.4", ",", "2.7", ",", "3.", ",", 
          "Pi"}], "}"}]}], "]"}], "//", "N"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ENlist", "[", "\"\<LHC\>\"", "]"}], "=", 
     RowBox[{
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"With", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"start", "=", "0.005"}], ",", 
            RowBox[{"end", "=", 
             RowBox[{"EmaxFacility", "[", "\"\<LHC\>\"", "]"}]}]}], "}"}], ",",
           "\[IndentingNewLine]", 
          RowBox[{"NestWhileList", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"#", "+", 
              RowBox[{"StepEtemp", "[", "#", "]"}]}], "&"}], ",", "start", ",", 
            RowBox[{
             RowBox[{"#", "\[LessEqual]", "end"}], "&"}], ",", "1", ",", 
            "\[Infinity]", ",", 
            RowBox[{"-", "1"}]}], "]"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"EmaxFacility", "[", "\"\<LHC\>\"", "]"}], "}"}]}], "]"}], "//",
       "N"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ENlist", "[", "\"\<FCC-hh\>\"", "]"}], "=", 
     RowBox[{
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"With", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"start", "=", "0.005"}], ",", 
            RowBox[{"end", "=", 
             RowBox[{"EmaxFacility", "[", "\"\<FCC-hh\>\"", "]"}]}]}], "}"}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"NestWhileList", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"#", "+", 
              RowBox[{"StepEtemp", "[", "#", "]"}]}], "&"}], ",", "start", ",", 
            RowBox[{
             RowBox[{"#", "\[LessEqual]", "end"}], "&"}], ",", "1", ",", 
            "\[Infinity]", ",", 
            RowBox[{"-", "1"}]}], "]"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"EmaxFacility", "[", "\"\<FCC-hh\>\"", "]"}], "}"}]}], "]"}],
       "//", "N"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"\[Theta]NlistTemp", "=", 
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         SuperscriptBox["10", 
          RowBox[{"-", "5."}]], ",", 
         RowBox[{"3", "*", 
          SuperscriptBox["10", 
           RowBox[{"-", "5."}]]}], ",", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"6", "*", 
            SuperscriptBox["10", 
             RowBox[{"-", "5."}]]}], ","}], "*)"}], 
         RowBox[{"6", "*", 
          SuperscriptBox["10", 
           RowBox[{"-", "5."}]]}], ",", 
         SuperscriptBox["10", 
          RowBox[{"-", "4."}]], ",", 
         RowBox[{"2", "*", 
          SuperscriptBox["10", 
           RowBox[{"-", "4."}]]}], ",", 
         RowBox[{"4", "*", 
          SuperscriptBox["10", 
           RowBox[{"-", "4."}]]}], ",", 
         RowBox[{"6", "*", 
          SuperscriptBox["10", 
           RowBox[{"-", "4."}]]}], ",", 
         SuperscriptBox["10", 
          RowBox[{"-", "3."}]], ",", 
         RowBox[{"2", "*", 
          SuperscriptBox["10", 
           RowBox[{"-", "3."}]]}], ",", 
         RowBox[{"3", "*", 
          SuperscriptBox["10", 
           RowBox[{"-", "3."}]]}], ",", 
         RowBox[{"4", "*", 
          SuperscriptBox["10", 
           RowBox[{"-", "3."}]]}], ",", 
         RowBox[{"5", "*", 
          SuperscriptBox["10", 
           RowBox[{"-", "3."}]]}], ",", 
         RowBox[{"6", "*", 
          SuperscriptBox["10", 
           RowBox[{"-", "3."}]]}], ",", 
         RowBox[{"8", "*", 
          SuperscriptBox["10", 
           RowBox[{"-", "3."}]]}], ",", 
         RowBox[{"9", "*", 
          SuperscriptBox["10", 
           RowBox[{"-", "3."}]]}]}], "}"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{
         SuperscriptBox["10", "\[Theta]N"], ",", 
         RowBox[{"{", 
          RowBox[{"\[Theta]N", ",", 
           RowBox[{"Log10", "[", 
            SuperscriptBox["10", 
             RowBox[{"-", "2"}]], "]"}], ",", 
           RowBox[{"Log10", "[", "0.5", "]"}], ",", "0.025"}], "}"}]}], "]"}],
        ",", 
       RowBox[{"Table", "[", 
        RowBox[{
         SuperscriptBox["10", "\[Theta]N"], ",", 
         RowBox[{"{", 
          RowBox[{"\[Theta]N", ",", 
           RowBox[{"Log10", "[", "0.52", "]"}], ",", 
           RowBox[{"Log10", "[", "1.55", "]"}], ",", "0.015"}], "}"}]}], 
        "]"}], ",", 
       RowBox[{"{", "1.57", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\[Theta]Nlist", "[", "\"\<LHC\>\"", "]"}], "=", 
     RowBox[{
      RowBox[{"SortBy", "[", 
       RowBox[{
        RowBox[{"Partition", "[", 
         RowBox[{
          RowBox[{"Join", "[", 
           RowBox[{"\[Theta]NlistTemp", ",", 
            RowBox[{"Pi", "-", "\[Theta]NlistTemp"}]}], "]"}], ",", "1"}], 
         "]"}], ",", "1"}], "]"}], "//", "Flatten"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"\[Theta]NlistLightTemp", "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            SuperscriptBox["10", 
             RowBox[{"-", "5."}]], ",", 
            RowBox[{"3", "*", 
             SuperscriptBox["10", 
              RowBox[{"-", "5."}]]}], ",", 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{"6", "*", 
               SuperscriptBox["10", 
                RowBox[{"-", "5."}]]}], ","}], "*)"}], 
            RowBox[{"6", "*", 
             SuperscriptBox["10", 
              RowBox[{"-", "5."}]]}], ",", 
            RowBox[{"8", "*", 
             SuperscriptBox["10", 
              RowBox[{"-", "5."}]]}], ",", 
            SuperscriptBox["10", 
             RowBox[{"-", "4."}]], ",", 
            RowBox[{"2", "*", 
             SuperscriptBox["10", 
              RowBox[{"-", "4."}]]}], ",", 
            RowBox[{"3", "*", 
             SuperscriptBox["10", 
              RowBox[{"-", "4."}]]}], ",", 
            RowBox[{"4", "*", 
             SuperscriptBox["10", 
              RowBox[{"-", "4."}]]}], ",", 
            RowBox[{"5", "*", 
             SuperscriptBox["10", 
              RowBox[{"-", "4."}]]}], ",", 
            RowBox[{"6", "*", 
             SuperscriptBox["10", 
              RowBox[{"-", "4."}]]}], ",", 
            RowBox[{"7", "*", 
             SuperscriptBox["10", 
              RowBox[{"-", "4."}]]}], ",", 
            RowBox[{"8", "*", 
             SuperscriptBox["10", 
              RowBox[{"-", "4."}]]}], ",", 
            RowBox[{"9", "*", 
             SuperscriptBox["10", 
              RowBox[{"-", "4."}]]}], ",", 
            SuperscriptBox["10", 
             RowBox[{"-", "3."}]], ",", 
            RowBox[{"1.5", "*", 
             SuperscriptBox["10", 
              RowBox[{"-", "3."}]]}], ",", 
            RowBox[{"2", "*", 
             SuperscriptBox["10", 
              RowBox[{"-", "3."}]]}], ",", 
            RowBox[{"3", "*", 
             SuperscriptBox["10", 
              RowBox[{"-", "3."}]]}], ",", 
            RowBox[{"4", "*", 
             SuperscriptBox["10", 
              RowBox[{"-", "3."}]]}], ",", 
            RowBox[{"5", "*", 
             SuperscriptBox["10", 
              RowBox[{"-", "3."}]]}], ",", 
            RowBox[{"6", "*", 
             SuperscriptBox["10", 
              RowBox[{"-", "3."}]]}], ",", 
            RowBox[{"7", "*", 
             SuperscriptBox["10", 
              RowBox[{"-", "3."}]]}], ",", 
            RowBox[{"8", "*", 
             SuperscriptBox["10", 
              RowBox[{"-", "3."}]]}], ",", 
            RowBox[{"9", "*", 
             SuperscriptBox["10", 
              RowBox[{"-", "3."}]]}]}], "}"}], ",", 
          RowBox[{"Table", "[", 
           RowBox[{
            SuperscriptBox["10", "\[Theta]N"], ",", 
            RowBox[{"{", 
             RowBox[{"\[Theta]N", ",", 
              RowBox[{"Log10", "[", 
               SuperscriptBox["10", 
                RowBox[{"-", "2"}]], "]"}], ",", 
              RowBox[{"Log10", "[", "0.5", "]"}], ",", "0.025"}], "}"}]}], 
           "]"}], ",", 
          RowBox[{"Table", "[", 
           RowBox[{
            SuperscriptBox["10", "\[Theta]N"], ",", 
            RowBox[{"{", 
             RowBox[{"\[Theta]N", ",", 
              RowBox[{"Log10", "[", "0.52", "]"}], ",", 
              RowBox[{"Log10", "[", "1.55", "]"}], ",", "0.015"}], "}"}]}], 
           "]"}], ",", 
          RowBox[{"{", "1.57", "}"}]}], "]"}], "//", "Sort"}], "//", "N"}], "//",
       "DeleteDuplicates"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\[Theta]NlistLight", "[", "\"\<LHC\>\"", "]"}], "=", 
     RowBox[{
      RowBox[{"SortBy", "[", 
       RowBox[{
        RowBox[{"Partition", "[", 
         RowBox[{
          RowBox[{"Join", "[", 
           RowBox[{"\[Theta]NlistLightTemp", ",", 
            RowBox[{"Pi", "-", "\[Theta]NlistLightTemp"}]}], "]"}], ",", 
          "1"}], "]"}], ",", "1"}], "]"}], "//", "Flatten"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"\[Theta]NlistFCChhTemp", "=", "\[Theta]NlistTemp"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\[Theta]Nlist", "[", "\"\<FCC-hh\>\"", "]"}], "=", 
     RowBox[{
      RowBox[{"SortBy", "[", 
       RowBox[{
        RowBox[{"Partition", "[", 
         RowBox[{
          RowBox[{"Join", "[", 
           RowBox[{"\[Theta]NlistTemp", ",", 
            RowBox[{"Pi", "-", "\[Theta]NlistFCChhTemp"}]}], "]"}], ",", 
          "1"}], "]"}], ",", "1"}], "]"}], "//", "Flatten"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\[Theta]NlistLight", "[", "\"\<FCC-hh\>\"", "]"}], "=", 
     RowBox[{
      RowBox[{"SortBy", "[", 
       RowBox[{
        RowBox[{"Partition", "[", 
         RowBox[{
          RowBox[{"Join", "[", 
           RowBox[{"\[Theta]NlistLightTemp", ",", 
            RowBox[{"Pi", "-", "\[Theta]NlistLightTemp"}]}], "]"}], ",", 
          "1"}], "]"}], ",", "1"}], "]"}], "//", "Flatten"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ENlist", "[", "\"\<FermilabBD\>\"", "]"}], "=", 
     RowBox[{
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"With", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"start", "=", "0.005"}], ",", 
            RowBox[{"end", "=", 
             RowBox[{"EmaxFacility", "[", "\"\<FermilabBD\>\"", "]"}]}]}], 
           "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{"NestWhileList", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"#", "+", 
              RowBox[{"StepEtemp", "[", "#", "]"}]}], "&"}], ",", "start", ",", 
            RowBox[{
             RowBox[{"#", "\[LessEqual]", "end"}], "&"}], ",", "1", ",", 
            "\[Infinity]", ",", 
            RowBox[{"-", "1"}]}], "]"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"EmaxFacility", "[", "\"\<FermilabBD\>\"", "]"}], "}"}]}], 
       "]"}], "//", "N"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\[Theta]Nlist", "[", "\"\<FermilabBD\>\"", "]"}], "=", 
     RowBox[{
      RowBox[{"\[Theta]NlistLight", "[", "\"\<FermilabBD\>\"", "]"}], "=", 
      RowBox[{"\[Theta]Nlist", "[", "\"\<SPS\>\"", "]"}]}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ENlist", "[", "\"\<Serpukhov\>\"", "]"}], "=", 
     RowBox[{
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          SuperscriptBox["10", "EN"], ",", 
          RowBox[{"{", 
           RowBox[{"EN", ",", 
            RowBox[{"Log10", "[", "0.005", "]"}], ",", 
            RowBox[{"Log10", "[", 
             RowBox[{"EmaxFacility", "[", "\"\<Serpukhov\>\"", "]"}], "]"}], ",",
             "0.05"}], "}"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"EmaxFacility", "[", "\"\<Serpukhov\>\"", "]"}], "}"}]}], 
       "]"}], "//", "N"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\[Theta]Nlist", "[", "\"\<Serpukhov\>\"", "]"}], "=", 
     RowBox[{
      RowBox[{"\[Theta]NlistLight", "[", "\"\<Serpukhov\>\"", "]"}], "=", 
      RowBox[{"\[Theta]Nlist", "[", "\"\<SPS\>\"", "]"}]}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\[Theta]Nlist", "[", "\"\<ESS\>\"", "]"}], "=", 
     RowBox[{
      RowBox[{"\[Theta]NlistLight", "[", "\"\<ESS\>\"", "]"}], "=", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             SuperscriptBox["10", 
              RowBox[{"-", "6."}]], ",", 
             SuperscriptBox["10", 
              RowBox[{"-", "5."}]], ",", 
             RowBox[{"(*", 
              RowBox[{
               RowBox[{"3", "*", 
                SuperscriptBox["10", 
                 RowBox[{"-", "5."}]]}], ",", 
               RowBox[{"6", "*", 
                SuperscriptBox["10", 
                 RowBox[{"-", "5."}]]}], ","}], "*)"}], 
             SuperscriptBox["10", 
              RowBox[{"-", "4."}]], ",", 
             SuperscriptBox["10", 
              RowBox[{"-", "3."}]], ",", 
             SuperscriptBox["10", 
              RowBox[{"-", "2."}]]}], "}"}], ",", 
           RowBox[{"Table", "[", 
            RowBox[{
             SuperscriptBox["10", "\[Theta]N"], ",", 
             RowBox[{"{", 
              RowBox[{"\[Theta]N", ",", 
               RowBox[{"Log10", "[", 
                RowBox[{"3", "*", 
                 SuperscriptBox["10", 
                  RowBox[{"-", "2."}]]}], "]"}], ",", 
               RowBox[{"Log10", "[", "0.5", "]"}], ",", "0.25"}], "}"}]}], 
            "]"}], ",", 
           RowBox[{"Table", "[", 
            RowBox[{
             SuperscriptBox["10", "\[Theta]N"], ",", 
             RowBox[{"{", 
              RowBox[{"\[Theta]N", ",", 
               RowBox[{"Log10", "[", "0.52", "]"}], ",", 
               RowBox[{"Log10", "[", "Pi", "]"}], ",", "0.01"}], "}"}]}], 
            "]"}], ",", 
           RowBox[{"{", "Pi", "}"}]}], "]"}], "//", "N"}], "//", 
        "DeleteDuplicates"}], "//", "Developer`ToPackedArray"}]}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ENlist", "[", "\"\<ESS\>\"", "]"}], "=", 
     RowBox[{
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{"e", ",", 
          RowBox[{"{", 
           RowBox[{"e", ",", "0.0051", ",", "0.1401", ",", "0.001"}], "}"}]}],
          "]"}], ",", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"10", "^", "EN"}], ",", 
          RowBox[{"{", 
           RowBox[{"EN", ",", 
            RowBox[{"Log10", "[", "0.145", "]"}], ",", 
            RowBox[{"Log10", "[", "2.", "]"}], ",", "0.02"}], "}"}]}], "]"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"EmaxFacility", "[", "\"\<ESS\>\"", "]"}], "}"}]}], "]"}], "//",
       "N"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"ELLPfromKlistSPS", "=", 
     RowBox[{"{", 
      RowBox[{
      "0.02", ",", "0.05", ",", "0.1", ",", "0.25", ",", "0.5", ",", "1.", ",",
        "1.5", ",", "2.", ",", "2.5", ",", "3.", ",", "3.5", ",", "4.", ",", 
       "5.", ",", "6.", ",", "7.", ",", "8."}], "}"}]}], ";"}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.935130918386976*^9, 3.9351309281805153`*^9}, {
   3.935131005690218*^9, 3.9351310065557547`*^9}, {3.9433764306719704`*^9, 
   3.943376430916191*^9}, 3.9433797551596375`*^9, {3.9433800026160984`*^9, 
   3.943380010384472*^9}, {3.9496429401914787`*^9, 3.9496429691834564`*^9}, {
   3.9496431144413643`*^9, 3.94964313835985*^9}, 3.9499797490899315`*^9, 
   3.9521011773603706`*^9},ExpressionUUID->"d3f58867-5730-48be-bfdf-\
c31e8c0d0d87"],

Cell[CellGroupData[{

Cell["Binning", "Subsubsection",
 CellChangeTimes->{{3.952101171509802*^9, 
  3.9521011723999557`*^9}},ExpressionUUID->"da019169-6bd3-8d40-a094-\
fd6783ad26e5"],

Cell[BoxData[
 RowBox[{"If", "[", 
  RowBox[{"LLPdistr", ",", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "___", "___", "___", "___", "___", "___", "___", "___", "___", "___", 
     "__"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Converting", " ", "\[Theta]"}], ",", 
     RowBox[{
     "E", " ", "data", " ", "into", " ", "binned", " ", "distribution"}]}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "___", "___", "___", "___", "___", "___", "___", "___", "___", "___", 
     "__"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Theta]listBinning", "[", "\"\<SLAC-E137\>\"", "]"}], "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            SuperscriptBox["10", 
             RowBox[{"-", "6."}]], ",", 
            SuperscriptBox["10", 
             RowBox[{"-", "5."}]], ",", 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{"3", "*", 
               SuperscriptBox["10", 
                RowBox[{"-", "5."}]]}], ",", 
              RowBox[{"6", "*", 
               SuperscriptBox["10", 
                RowBox[{"-", "5."}]]}], ","}], "*)"}], ",", 
            SuperscriptBox["10", 
             RowBox[{"-", "4."}]], ",", 
            RowBox[{"5", "*", 
             SuperscriptBox["10", 
              RowBox[{"-", "4."}]]}], ",", 
            SuperscriptBox["10", 
             RowBox[{"-", "3."}]], ",", 
            RowBox[{"2", "*", 
             SuperscriptBox["10", 
              RowBox[{"-", "3."}]]}], ",", 
            RowBox[{"3", "*", 
             SuperscriptBox["10", 
              RowBox[{"-", "3."}]]}], ",", 
            RowBox[{"4", "*", 
             SuperscriptBox["10", 
              RowBox[{"-", "3."}]]}], ",", 
            RowBox[{"5", "*", 
             SuperscriptBox["10", 
              RowBox[{"-", "3."}]]}], ",", 
            RowBox[{"6", "*", 
             SuperscriptBox["10", 
              RowBox[{"-", "3."}]]}], ",", 
            RowBox[{"7", "*", 
             SuperscriptBox["10", 
              RowBox[{"-", "3."}]]}], ",", 
            RowBox[{"8", "*", 
             SuperscriptBox["10", 
              RowBox[{"-", "3."}]]}], ",", 
            RowBox[{"9", "*", 
             SuperscriptBox["10", 
              RowBox[{"-", "3."}]]}]}], "}"}], ",", 
          RowBox[{"Table", "[", 
           RowBox[{
            SuperscriptBox["10", "\[Theta]N"], ",", 
            RowBox[{"{", 
             RowBox[{"\[Theta]N", ",", 
              RowBox[{"Log10", "[", 
               SuperscriptBox["10", 
                RowBox[{"-", "2"}]], "]"}], ",", 
              RowBox[{"Log10", "[", "0.5", "]"}], ",", "0.025"}], "}"}]}], 
           "]"}], ",", 
          RowBox[{"Table", "[", 
           RowBox[{
            SuperscriptBox["10", "\[Theta]N"], ",", 
            RowBox[{"{", 
             RowBox[{"\[Theta]N", ",", 
              RowBox[{"Log10", "[", "0.52", "]"}], ",", 
              RowBox[{"Log10", "[", "Pi", "]"}], ",", "0.015"}], "}"}]}], 
           "]"}], ",", 
          RowBox[{"{", "Pi", "}"}]}], "]"}], "//", "N"}], "//", 
       "DeleteDuplicates"}], "//", "Developer`ToPackedArray"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\[Theta]listBinning", "[", "\"\<SPS\>\"", "]"}], "=", 
     RowBox[{
      RowBox[{"\[Theta]listBinning", "[", "\"\<Serpukhov\>\"", "]"}], "=", 
      RowBox[{
       RowBox[{"\[Theta]listBinning", "[", "\"\<FermilabBD\>\"", "]"}], "=", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              SuperscriptBox["10", 
               RowBox[{"-", "6."}]], ",", 
              SuperscriptBox["10", 
               RowBox[{"-", "5."}]], ",", 
              RowBox[{"(*", 
               RowBox[{
                RowBox[{"3", "*", 
                 SuperscriptBox["10", 
                  RowBox[{"-", "5."}]]}], ",", 
                RowBox[{"6", "*", 
                 SuperscriptBox["10", 
                  RowBox[{"-", "5."}]]}], ","}], "*)"}], 
              SuperscriptBox["10", 
               RowBox[{"-", "4."}]], ",", 
              RowBox[{"5", "*", 
               SuperscriptBox["10", 
                RowBox[{"-", "4."}]]}], ",", 
              SuperscriptBox["10", 
               RowBox[{"-", "3."}]], ",", 
              RowBox[{"2", "*", 
               SuperscriptBox["10", 
                RowBox[{"-", "3."}]]}], ",", 
              RowBox[{"4", "*", 
               SuperscriptBox["10", 
                RowBox[{"-", "3."}]]}], ",", 
              RowBox[{"6", "*", 
               SuperscriptBox["10", 
                RowBox[{"-", "3."}]]}], ",", 
              RowBox[{"8", "*", 
               SuperscriptBox["10", 
                RowBox[{"-", "3."}]]}]}], "}"}], ",", 
            RowBox[{"Table", "[", 
             RowBox[{
              SuperscriptBox["10", "\[Theta]N"], ",", 
              RowBox[{"{", 
               RowBox[{"\[Theta]N", ",", 
                RowBox[{"Log10", "[", 
                 SuperscriptBox["10", 
                  RowBox[{"-", "2"}]], "]"}], ",", 
                RowBox[{"Log10", "[", "0.5", "]"}], ",", "0.025"}], "}"}]}], 
             "]"}], ",", 
            RowBox[{"Table", "[", 
             RowBox[{
              SuperscriptBox["10", "\[Theta]N"], ",", 
              RowBox[{"{", 
               RowBox[{"\[Theta]N", ",", 
                RowBox[{"Log10", "[", "0.52", "]"}], ",", 
                RowBox[{"Log10", "[", "Pi", "]"}], ",", "0.015"}], "}"}]}], 
             "]"}], ",", 
            RowBox[{"{", "Pi", "}"}]}], "]"}], "//", "N"}], "//", 
         "DeleteDuplicates"}], "//", "Developer`ToPackedArray"}]}]}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\[Theta]listBinning", "[", "\"\<LHC\>\"", "]"}], "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            SuperscriptBox["10", 
             RowBox[{"-", "6."}]], ",", 
            SuperscriptBox["10", 
             RowBox[{"-", "5."}]], ",", 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{"3", "*", 
               SuperscriptBox["10", 
                RowBox[{"-", "5."}]]}], ",", 
              RowBox[{"6", "*", 
               SuperscriptBox["10", 
                RowBox[{"-", "5."}]]}], ","}], "*)"}], 
            RowBox[{"5", "*", 
             SuperscriptBox["10", 
              RowBox[{"-", "5."}]]}], ",", 
            SuperscriptBox["10", 
             RowBox[{"-", "4."}]], ",", 
            RowBox[{"3", "*", 
             SuperscriptBox["10", 
              RowBox[{"-", "4."}]]}], ",", 
            RowBox[{"6", "*", 
             SuperscriptBox["10", 
              RowBox[{"-", "4."}]]}], ",", 
            SuperscriptBox["10", 
             RowBox[{"-", "3."}]], ",", 
            RowBox[{"2", "*", 
             SuperscriptBox["10", 
              RowBox[{"-", "3."}]]}], ",", 
            RowBox[{"4", "*", 
             SuperscriptBox["10", 
              RowBox[{"-", "3."}]]}], ",", 
            RowBox[{"6", "*", 
             SuperscriptBox["10", 
              RowBox[{"-", "3."}]]}], ",", 
            RowBox[{"8", "*", 
             SuperscriptBox["10", 
              RowBox[{"-", "3."}]]}]}], "}"}], ",", 
          RowBox[{"Table", "[", 
           RowBox[{
            SuperscriptBox["10", "\[Theta]N"], ",", 
            RowBox[{"{", 
             RowBox[{"\[Theta]N", ",", 
              RowBox[{"Log10", "[", 
               SuperscriptBox["10", 
                RowBox[{"-", "2."}]], "]"}], ",", 
              RowBox[{"Log10", "[", "0.5", "]"}], ",", "0.025"}], "}"}]}], 
           "]"}], ",", 
          RowBox[{"Table", "[", 
           RowBox[{
            SuperscriptBox["10", "\[Theta]N"], ",", 
            RowBox[{"{", 
             RowBox[{"\[Theta]N", ",", 
              RowBox[{"Log10", "[", "0.52", "]"}], ",", 
              RowBox[{"Log10", "[", "1.", "]"}], ",", "0.015"}], "}"}]}], 
           "]"}], ",", 
          RowBox[{"Table", "[", 
           RowBox[{
            SuperscriptBox["10", "\[Theta]N"], ",", 
            RowBox[{"{", 
             RowBox[{"\[Theta]N", ",", 
              RowBox[{"Log10", "[", "1.02", "]"}], ",", 
              RowBox[{"Log10", "[", 
               FractionBox["Pi", "2"], "]"}], ",", "0.01"}], "}"}]}], "]"}], ",", 
          RowBox[{"{", 
           FractionBox["Pi", "2"], "}"}]}], "]"}], "//", "N"}], "//", 
       "DeleteDuplicates"}], "//", "Developer`ToPackedArray"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\[Theta]listBinning", "[", "\"\<FCC-hh\>\"", "]"}], "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            SuperscriptBox["10", 
             RowBox[{"-", "6."}]], ",", 
            SuperscriptBox["10", 
             RowBox[{"-", "5."}]], ",", 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{"3", "*", 
               SuperscriptBox["10", 
                RowBox[{"-", "5."}]]}], ",", 
              RowBox[{"6", "*", 
               SuperscriptBox["10", 
                RowBox[{"-", "5."}]]}], ","}], "*)"}], 
            RowBox[{"7", "*", 
             SuperscriptBox["10", 
              RowBox[{"-", "5."}]]}], ",", 
            SuperscriptBox["10", 
             RowBox[{"-", "4."}]], ",", 
            RowBox[{"3", "*", 
             SuperscriptBox["10", 
              RowBox[{"-", "4."}]]}], ",", 
            RowBox[{"6", "*", 
             SuperscriptBox["10", 
              RowBox[{"-", "4."}]]}], ",", 
            SuperscriptBox["10", 
             RowBox[{"-", "3."}]], ",", 
            RowBox[{"2", "*", 
             SuperscriptBox["10", 
              RowBox[{"-", "3."}]]}], ",", 
            RowBox[{"4", "*", 
             SuperscriptBox["10", 
              RowBox[{"-", "3."}]]}], ",", 
            RowBox[{"6", "*", 
             SuperscriptBox["10", 
              RowBox[{"-", "3."}]]}], ",", 
            RowBox[{"8", "*", 
             SuperscriptBox["10", 
              RowBox[{"-", "3."}]]}]}], "}"}], ",", 
          RowBox[{"Table", "[", 
           RowBox[{
            SuperscriptBox["10", "\[Theta]N"], ",", 
            RowBox[{"{", 
             RowBox[{"\[Theta]N", ",", 
              RowBox[{"Log10", "[", 
               SuperscriptBox["10", 
                RowBox[{"-", "2"}]], "]"}], ",", 
              RowBox[{"Log10", "[", "0.5", "]"}], ",", "0.025"}], "}"}]}], 
           "]"}], ",", 
          RowBox[{"Table", "[", 
           RowBox[{
            SuperscriptBox["10", "\[Theta]N"], ",", 
            RowBox[{"{", 
             RowBox[{"\[Theta]N", ",", 
              RowBox[{"Log10", "[", "0.52", "]"}], ",", 
              RowBox[{"Log10", "[", 
               FractionBox["Pi", "2"], "]"}], ",", "0.02"}], "}"}]}], "]"}], ",", 
          RowBox[{"{", 
           FractionBox["Pi", "2"], "}"}]}], "]"}], "//", "N"}], "//", 
       "DeleteDuplicates"}], "//", "Developer`ToPackedArray"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\[Theta]listBinning", "[", "\"\<ESS\>\"", "]"}], "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            SuperscriptBox["10", 
             RowBox[{"-", "6."}]], ",", 
            SuperscriptBox["10", 
             RowBox[{"-", "5."}]], ",", 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{"3", "*", 
               SuperscriptBox["10", 
                RowBox[{"-", "5."}]]}], ",", 
              RowBox[{"6", "*", 
               SuperscriptBox["10", 
                RowBox[{"-", "5."}]]}], ","}], "*)"}], 
            SuperscriptBox["10", 
             RowBox[{"-", "4."}]], ",", 
            SuperscriptBox["10", 
             RowBox[{"-", "3."}]], ",", 
            SuperscriptBox["10", 
             RowBox[{"-", "2."}]]}], "}"}], ",", 
          RowBox[{"Table", "[", 
           RowBox[{
            SuperscriptBox["10", "\[Theta]N"], ",", 
            RowBox[{"{", 
             RowBox[{"\[Theta]N", ",", 
              RowBox[{"Log10", "[", 
               RowBox[{"3", "*", 
                SuperscriptBox["10", 
                 RowBox[{"-", "2."}]]}], "]"}], ",", 
              RowBox[{"Log10", "[", "0.5", "]"}], ",", "0.25"}], "}"}]}], 
           "]"}], ",", 
          RowBox[{"Table", "[", 
           RowBox[{
            SuperscriptBox["10", "\[Theta]N"], ",", 
            RowBox[{"{", 
             RowBox[{"\[Theta]N", ",", 
              RowBox[{"Log10", "[", "0.52", "]"}], ",", 
              RowBox[{"Log10", "[", "Pi", "]"}], ",", "0.1"}], "}"}]}], "]"}],
           ",", 
          RowBox[{"{", "Pi", "}"}]}], "]"}], "//", "N"}], "//", 
       "DeleteDuplicates"}], "//", "Developer`ToPackedArray"}]}], ";"}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.9546628220425396`*^9, 
  3.954662828517256*^9}},ExpressionUUID->"13a1b95d-7b9c-bd48-8572-\
836e18a0dd6d"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Constants, conversion units", "Section",
 CellChangeTimes->{{3.934092327032702*^9, 
  3.9340923303294964`*^9}},ExpressionUUID->"bd046188-669d-4d82-b080-\
7c27c6442fb4"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"GeVm2Topb", "=", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"2", "*", 
       SuperscriptBox["10", 
        RowBox[{"-", "16"}]]}], ")"}], "2"], "*", 
    SuperscriptBox["10", "28"], "*", 
    SuperscriptBox["10", "12."]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"GeVm2Tob", "=", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"2", "*", 
       SuperscriptBox["10", 
        RowBox[{"-", "16"}]]}], ")"}], "2"], "*", 
    SuperscriptBox["10", "28"]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Alpha]EMval", "=", 
   RowBox[{"1", "/", "137."}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"chbar", "=", 
   RowBox[{"3", "*", 
    SuperscriptBox["10", "8"], "*", "6.58", "*", 
    SuperscriptBox["10", 
     RowBox[{"-", "25"}]]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vh", "=", "246."}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"F\[Pi]", "=", "0.093"}], ";"}]}], "Input",
 CellChangeTimes->{{3.9476438880068893`*^9, 3.947643895642521*^9}, {
  3.950867494697895*^9, 3.950867494856331*^9}, {3.952591451095583*^9, 
  3.9525914541683407`*^9}, {3.9525915205380993`*^9, 
  3.9525915508620853`*^9}},ExpressionUUID->"6aecfd3c-5461-4d9f-ab7d-\
cc5c88abf96f"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Parameters of nuclei", "Section",
 CellChangeTimes->{{3.9340927279742994`*^9, 
  3.9340927313838673`*^9}},ExpressionUUID->"1830c887-6440-434c-8e62-\
b0c9e018f561"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Parameters", " ", "of", " ", "nuclei"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"mnucleus", "[", "\"\<Mo\>\"", "]"}], ",", 
       RowBox[{"anucleus", "[", "\"\<Mo\>\"", "]"}], ",", 
       RowBox[{"znucleus", "[", "\"\<Mo\>\"", "]"}]}], "}"}], "=", 
     RowBox[{"{", 
      RowBox[{"89.38", ",", "96", ",", "42"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"mnucleus", "[", "\"\<Fe\>\"", "]"}], ",", 
       RowBox[{"anucleus", "[", "\"\<Fe\>\"", "]"}], ",", 
       RowBox[{"znucleus", "[", "\"\<Fe\>\"", "]"}]}], "}"}], "=", 
     RowBox[{"{", 
      RowBox[{"54.43", ",", "56", ",", "28"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"mnucleus", "[", "\"\<C\>\"", "]"}], ",", 
       RowBox[{"anucleus", "[", "\"\<C\>\"", "]"}], ",", 
       RowBox[{"znucleus", "[", "\"\<C\>\"", "]"}]}], "}"}], "=", 
     RowBox[{"{", 
      RowBox[{"11.188", ",", "12", ",", "6"}], "}"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{3.9340927336256256`*^9},
 CellLabel->"In[47]:=",ExpressionUUID->"212cca0a-a6b9-4c80-98e3-d5d59a2de6f7"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Fragmentation fractions of mesons", "Section",
 CellChangeTimes->{{3.8777157785909414`*^9, 3.877715784221675*^9}},
 CellTags->
  "Evaluation",ExpressionUUID->"16dbf08b-1200-4ac4-ad9a-ed04d15b41ef"],

Cell[CellGroupData[{

Cell["LHC and FCC-hh", "Subsection",
 CellChangeTimes->{{3.877715793467651*^9, 3.8777157937028675`*^9}, {
  3.888575444983039*^9, 3.8885754475682592`*^9}},
 CellTags->
  "Evaluation",ExpressionUUID->"be5850ea-72d1-4eb6-b945-f4862fadb6d4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Fragmentation", " ", "fractions"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"fdstau", " ", "=", " ", "0.0543"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"fctod0", "[", "\"\<LHC\>\"", "]"}], "=", 
     RowBox[{
      RowBox[{"fctod0", "[", "\"\<FCC-hh\>\"", "]"}], "=", "0.553"}]}], ";"}],
    "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"fctodplus", "[", "\"\<LHC\>\"", "]"}], "=", 
     RowBox[{
      RowBox[{"fctodplus", "[", "\"\<FCC-hh\>\"", "]"}], " ", "=", " ", 
      "0.225"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      SubscriptBox["D", "s"], " ", "mesons"}], " ", "-", " ", 
     RowBox[{"including", " ", 
      SuperscriptBox[
       SubscriptBox["D", "s"], "*"], " ", "contribution"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"fctods", "[", "\"\<LHC\>\"", "]"}], "=", 
     RowBox[{
      RowBox[{"fctods", "[", "\"\<FCC-hh\>\"", "]"}], "=", "0.105"}]}], ";"}],
    "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"fbtobc", "[", "\"\<LHC\>\"", "]"}], "=", 
     RowBox[{
      RowBox[{"fbtobc", "[", "\"\<FCC-hh\>\"", "]"}], "=", " ", 
      RowBox[{"2.6", "*", 
       SuperscriptBox["10", 
        RowBox[{"-", "3"}]]}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"fbtob0", "[", "\"\<LHC\>\"", "]"}], "=", 
     RowBox[{
      RowBox[{"fbtobplus", "[", "\"\<LHC\>\"", "]"}], "=", 
      RowBox[{
       RowBox[{"fbtob0", "[", "\"\<FCC-hh\>\"", "]"}], "=", 
       RowBox[{
        RowBox[{"fbtobplus", "[", "\"\<FCC-hh\>\"", "]"}], "=", 
        "0.324"}]}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"fbtobs", "[", "\"\<LHC\>\"", "]"}], "=", 
     RowBox[{
      RowBox[{"fbtobs", "[", "\"\<FCC-hh\>\"", "]"}], "=", "0.09"}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.8242854336450047`*^9, 3.8242854469558754`*^9}, {
  3.888575449118577*^9, 3.8885754782501616`*^9}, {3.9132694653727913`*^9, 
  3.9132695105449934`*^9}, {3.9493765585989304`*^9, 3.949376559004713*^9}},
 CellTags->"Evaluation",
 CellLabel->"In[50]:=",ExpressionUUID->"57b13a59-bbda-47bd-bcb1-94321ca663e9"]
}, Open  ]],

Cell[CellGroupData[{

Cell["SPS", "Subsection",
 CellChangeTimes->{{3.877715802039713*^9, 3.877715802196947*^9}},
 CellTags->
  "Evaluation",ExpressionUUID->"22b5bbc3-3951-46d3-ad9a-83114d344b4c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"fctod0", "[", "\"\<SPS\>\"", "]"}], "=", " ", "0.632"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"fctodplus", "[", "\"\<SPS\>\"", "]"}], "=", "0.207"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"fctods", "[", "\"\<SPS\>\"", "]"}], "=", "0.088"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"fbtobplus", "[", "\"\<SPS\>\"", "]"}], "=", "0.411"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"fbtob0", "[", "\"\<SPS\>\"", "]"}], "=", "0.411"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"fbtobc", "[", "\"\<SPS\>\"", "]"}], "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"fbtobs", "[", "\"\<SPS\>\"", "]"}], "=", "0.11"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NccbarSHiP", " ", "=", " ", 
   RowBox[{"2.3", "*", "3.4", "*", 
    SuperscriptBox["10", "17"]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NbbbarSHiP", " ", "=", " ", 
   RowBox[{"1.7", "*", "3.2", "*", 
    SuperscriptBox["10", "13"]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NpotSHiP", "=", 
   RowBox[{"2", "*", 
    SuperscriptBox["10", "20"]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Chi]bbbarSPS", "=", 
   FractionBox["NbbbarSHiP", "NpotSHiP"]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Chi]ccbarSPS", "=", 
   FractionBox["NccbarSHiP", "NpotSHiP"]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Chi]ssbarSPS", "=", 
   FractionBox["1", "7"]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"fstokplus", "[", "\"\<SPS\>\"", "]"}], "=", "0.5"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"fstok0l", "[", "\"\<SPS\>\"", "]"}], "=", "0.25"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.9132695181069517`*^9, 3.913269526708232*^9}, {
  3.913269560631452*^9, 3.913269564226587*^9}, {3.949376574823826*^9, 
  3.949376604017164*^9}, {3.9497211188469944`*^9, 3.9497211199715977`*^9}},
 CellTags->"Evaluation",
 CellLabel->"In[57]:=",ExpressionUUID->"d9f77161-a435-4e0d-a1e7-77d7f183b93b"]
}, Open  ]],

Cell[CellGroupData[{

Cell["FermilabBD (assumed to be the same as at SPS; to be fixed)", \
"Subsection",
 CellChangeTimes->{{3.877715802039713*^9, 3.877715802196947*^9}, {
  3.8935771764769607`*^9, 3.89357717897411*^9}, {3.8935786632797337`*^9, 
  3.8935786709876175`*^9}},
 CellTags->
  "Evaluation",ExpressionUUID->"095611fb-9a2e-4c4f-91d9-5d2e63f6be49"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"fctod0", "[", "\"\<FermilabBD\>\"", "]"}], "=", " ", "0.632"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"fctodplus", "[", "\"\<FermilabBD\>\"", "]"}], "=", "0.207"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"fctods", "[", "\"\<FermilabBD\>\"", "]"}], "=", "0.088"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"fbtobplus", "[", "\"\<FermilabBD\>\"", "]"}], "=", "0.4"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"fbtob0", "[", "\"\<FermilabBD\>\"", "]"}], "=", "0.4"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"fbtobc", "[", "\"\<FermilabBD\>\"", "]"}], "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"fbtobs", "[", "\"\<FermilabBD\>\"", "]"}], "=", "0.11"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.8935771814640203`*^9, 3.89357720422649*^9}, {
  3.913269536485689*^9, 3.9132695769711275`*^9}, {3.9493766015182037`*^9, 
  3.949376601748678*^9}},
 CellTags->"Evaluation",
 CellLabel->"In[72]:=",ExpressionUUID->"79c3c6d2-bec6-41b6-9818-7d5c26b7676d"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Serpukhov", "Subsection",
 CellChangeTimes->{{3.9493766120795555`*^9, 
  3.9493766133668537`*^9}},ExpressionUUID->"8dc21479-e70c-1f4a-897d-\
b6de05a5cc9f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"fbtobs", "[", "\"\<Serpukhov\>\"", "]"}], "=", "0."}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"fbtob0", "[", "\"\<Serpukhov\>\"", "]"}], "=", 
   RowBox[{
    RowBox[{"fbtobplus", "[", "\"\<Serpukhov\>\"", "]"}], "=", 
    RowBox[{
     RowBox[{"fbtobc", "[", "\"\<Serpukhov\>\"", "]"}], "=", "0."}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"fctod0", "[", "\"\<Serpukhov\>\"", "]"}], "=", 
   RowBox[{
    RowBox[{"fctods", "[", "\"\<Serpukhov\>\"", "]"}], "=", 
    RowBox[{
     RowBox[{"fctodplus", "[", "\"\<Serpukhov\>\"", "]"}], "=", "0."}]}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.950698557040001*^9, 3.9506985794649734`*^9}},
 CellLabel->"In[79]:=",ExpressionUUID->"bae47109-e377-7646-99bf-6f50ae798967"]
}, Open  ]],

Cell[CellGroupData[{

Cell["SuperKEKB", "Subsection",
 CellChangeTimes->{{3.9496382830427284`*^9, 3.9496382839549503`*^9}, {
  3.949979757762697*^9, 
  3.94997976070298*^9}},ExpressionUUID->"17d36820-4e8b-514f-ab2a-\
8bf445a60a7e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"fbtob0", "[", "\"\<SuperKEKB\>\"", "]"}], "=", 
    RowBox[{
     RowBox[{"fbtobplus", "[", "\"\<SuperKEKB\>\"", "]"}], "=", "0.5"}]}], 
   ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Assuming", " ", "that", " ", "Belle", " ", "II", " ", "will", " ", 
     "collect", " ", "10", "%", " ", "of", " ", "data", " ", "in", " ", 
     "\[CapitalUpsilon]", 
     RowBox[{"(", 
      RowBox[{"5", "S"}], ")"}], " ", "resonance", " ", 
     RowBox[{"mode", ".", " ", "0.19"}], " ", "is", " ", "the", " ", "Br", " ",
      "ratio", " ", "of", " ", "the", " ", "decay", " ", "\[CapitalUpsilon]", 
     RowBox[{"(", 
      RowBox[{"5", "S"}], ")"}]}], "->", 
    RowBox[{"2", 
     SubscriptBox["B", "s"]}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"fbtobs", "[", "\"\<SuperKEKB\>\"", "]"}], " ", "=", " ", 
   RowBox[{"0.1", "*", "0.19"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"fbtobc", "[", "\"\<SuperKEKB\>\"", "]"}], "=", "0."}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"fctod0", "[", "\"\<SuperKEKB\>\"", "]"}], "=", 
   RowBox[{
    RowBox[{"fctods", "[", "\"\<SuperKEKB\>\"", "]"}], "=", 
    RowBox[{
     RowBox[{"fctodplus", "[", "\"\<SuperKEKB\>\"", "]"}], "=", "0."}]}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.949644976599495*^9, 3.9496449821877575`*^9}, {
  3.949979770997408*^9, 3.94997980683832*^9}, {3.949995955702799*^9, 
  3.949995977476675*^9}, {3.950548986420229*^9, 3.950549008466404*^9}, {
  3.9506983867650146`*^9, 3.950698402397732*^9}},
 CellLabel->"In[82]:=",ExpressionUUID->"71cc9362-638b-6449-8b32-cc9ebc2af364"]
}, Open  ]],

Cell[CellGroupData[{

Cell["ESS", "Subsection",
 CellChangeTimes->{{3.9496382830427284`*^9, 3.9496382839549503`*^9}, {
  3.949979757762697*^9, 3.94997976070298*^9}, {3.950549018209709*^9, 
  3.950549030245655*^9}},ExpressionUUID->"0db9805a-a4a8-0f4b-8d93-\
b7cbdcc8e02e"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"fbtob0", "[", "\"\<ESS\>\"", "]"}], "=", 
   RowBox[{
    RowBox[{"fbtobplus", "[", "\"\<ESS\>\"", "]"}], "=", 
    RowBox[{
     RowBox[{"fbtobs", "[", "\"\<ESS\>\"", "]"}], "=", 
     RowBox[{
      RowBox[{"fbtobc", "[", "\"\<ESS\>\"", "]"}], "=", 
      RowBox[{
       RowBox[{"fctod0", "[", "\"\<ESS\>\"", "]"}], "=", 
       RowBox[{
        RowBox[{"fctods", "[", "\"\<ESS\>\"", "]"}], "=", 
        RowBox[{
         RowBox[{"fctodplus", "[", "\"\<ESS\>\"", "]"}], "=", 
         "0."}]}]}]}]}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.949644976599495*^9, 3.9496449821877575`*^9}, {
  3.949979770997408*^9, 3.94997980683832*^9}, {3.949995955702799*^9, 
  3.949995977476675*^9}, {3.950549034175949*^9, 3.950549065888214*^9}},
 CellLabel->"In[86]:=",ExpressionUUID->"36d683e8-0e01-9d44-9047-d5864d6e5cfa"]
}, Open  ]],

Cell[CellGroupData[{

Cell["SLAC-E137", "Subsection",
 CellChangeTimes->{{3.9496382830427284`*^9, 3.9496382839549503`*^9}, {
  3.949979757762697*^9, 3.94997976070298*^9}, {3.950549018209709*^9, 
  3.950549030245655*^9}, {3.950698460510723*^9, 
  3.950698463362339*^9}},ExpressionUUID->"1c67d832-797a-2144-b4fc-\
34b9dcaefe81"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"fbtob0", "[", "\"\<SLAC-E137\>\"", "]"}], "=", 
   RowBox[{
    RowBox[{"fbtobplus", "[", "\"\<SLAC-E137\>\"", "]"}], "=", 
    RowBox[{
     RowBox[{"fbtobs", "[", "\"\<SLAC-E137\>\"", "]"}], "=", 
     RowBox[{
      RowBox[{"fbtobc", "[", "\"\<SLAC-E137\>\"", "]"}], "=", 
      RowBox[{
       RowBox[{"fctod0", "[", "\"\<SLAC-E137\>\"", "]"}], "=", 
       RowBox[{
        RowBox[{"fctods", "[", "\"\<SLAC-E137\>\"", "]"}], "=", 
        RowBox[{
         RowBox[{"fctodplus", "[", "\"\<SLAC-E137\>\"", "]"}], "=", 
         "0."}]}]}]}]}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.949644976599495*^9, 3.9496449821877575`*^9}, {
  3.949979770997408*^9, 3.94997980683832*^9}, {3.949995955702799*^9, 
  3.949995977476675*^9}, {3.950549034175949*^9, 3.950549065888214*^9}, {
  3.95069846661034*^9, 3.95069847789674*^9}},
 CellLabel->"In[87]:=",ExpressionUUID->"28915e64-9b7f-db47-893d-04ba0b14a137"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Cross-sections and branching ratios", "Section",
 CellChangeTimes->{{3.9340924327458744`*^9, 3.934092435155797*^9}, {
  3.9340926270162425`*^9, 
  3.9340926299459643`*^9}},ExpressionUUID->"06e91bf1-cd1c-4037-a60c-\
c794d0e3abeb"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Br", " ", "ratios", " ", "of", " ", "EM", " ", "decays", " ", "of", " ", 
    "light", " ", "mesons"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Br\[Pi]To\[Gamma]\[Gamma]", "=", "0.98799"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Br\[Eta]To\[Gamma]\[Gamma]", "=", "0.3931181"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Br\[Omega]To\[Pi]0\[Gamma]", "=", "0.0834941"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Br\[Eta]prTo\[Gamma]\[Gamma]", "=", "0.0219297"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"pN", " ", "cross"}], "-", 
     RowBox[{"section", " ", "in", " ", "pb"}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Sigma]pNucleonInpb", "[", "Atarget_", "]"}], "=", 
     RowBox[{"51", "*", 
      SuperscriptBox["Atarget", 
       RowBox[{"-", "0.29"}]], "*", 
      SuperscriptBox["10", "9"]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Sigma]ppLHC", "=", 
     RowBox[{"72", "*", 
      SuperscriptBox["10", "9"]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Photon", " ", "absorption", " ", "cross"}], "-", "sections"}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\[Sigma]\[Gamma]Abs", "[", "\"\<Mo\>\"", "]"}], ",", 
       RowBox[{"\[Sigma]\[Gamma]Abs", "[", "\"\<Fe\>\"", "]"}]}], "}"}], "=", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"12.7", ",", "5.1"}], "}"}], "*", 
      SuperscriptBox["GeVm2Tob", 
       RowBox[{"-", "1"}]]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Sigma]\[Gamma]Abs", "[", "\"\<C\>\"", "]"}], "=", 
     RowBox[{
      RowBox[{"\[Sigma]\[Gamma]Abs", "[", "\"\<Fe\>\"", "]"}], "*", 
      FractionBox[
       RowBox[{
        RowBox[{"znucleus", "[", "\"\<C\>\"", "]"}], "*", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"znucleus", "[", "\"\<C\>\"", "]"}], "+", "1"}], ")"}], 
        RowBox[{"Log", "[", 
         FractionBox["183", 
          SuperscriptBox[
           RowBox[{"znucleus", "[", "\"\<C\>\"", "]"}], 
           FractionBox["1", "3."]]], "]"}]}], 
       RowBox[{
        RowBox[{"znucleus", "[", "\"\<Fe\>\"", "]"}], "*", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"znucleus", "[", "\"\<Fe\>\"", "]"}], "+", "1"}], ")"}], 
        RowBox[{"Log", "[", 
         FractionBox["183", 
          SuperscriptBox[
           RowBox[{"znucleus", "[", "\"\<Fe\>\"", "]"}], 
           FractionBox["1", "3."]]], "]"}]}]]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Nucleus", "-", 
     RowBox[{"proton", " ", "cross"}], "-", 
     RowBox[{"section", " ", "in", " ", "pb"}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Sigma]pNucleus", "[", "Z", "]"}], "=", 
       RowBox[{"53", "*", 
        SuperscriptBox["10", "9"], "*", 
        SuperscriptBox[
         RowBox[{"anucleus", "[", "Z", "]"}], "0.77"]}]}], ",", 
      RowBox[{"{", 
       RowBox[{"Z", ",", 
        RowBox[{"{", 
         RowBox[{"\"\<Mo\>\"", ",", "\"\<Fe\>\"", ",", "\"\<C\>\""}], "}"}]}],
        "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"proton", "-", 
     RowBox[{"proton", " ", "cross"}], "-", 
     RowBox[{"section", " ", "in", " ", "pb"}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\[Sigma]pp", "[", "\"\<Serpukhov\>\"", "]"}], ",", 
       RowBox[{"\[Sigma]pp", "[", "\"\<FermilabBD\>\"", "]"}], ",", 
       RowBox[{"\[Sigma]pp", "[", "\"\<SPS\>\"", "]"}], ",", 
       RowBox[{"\[Sigma]pp", "[", "\"\<LHC\>\"", "]"}], ",", 
       RowBox[{"\[Sigma]pp", "[", "\"\<FCC-hh\>\"", "]"}], ",", 
       RowBox[{"\[Sigma]pp", "[", "\"\<ESS\>\"", "]"}]}], "}"}], "=", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "40.", ",", "40.", ",", "40.", ",", "78.", ",", "104.", ",", "44."}], 
       "}"}], "*", 
      SuperscriptBox["10", "9"]}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.952095278903137*^9, 3.9520952827688637`*^9}, {
  3.952591545325348*^9, 
  3.9525915455774593`*^9}},ExpressionUUID->"266da48e-a6ff-47d5-a38b-\
a47657d2e421"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1430.25, 822.75},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"14.2 for Microsoft Windows (64-bit) (December 26, 2024)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"52ee9786-8ebb-4f5c-9ba1-f90d0180d15b"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{
 "Evaluation"->{
  Cell[102255, 2618, 203, 3, 66, "Section",ExpressionUUID->"16dbf08b-1200-4ac4-ad9a-ed04d15b41ef",
   CellTags->"Evaluation"],
  Cell[102483, 2625, 238, 4, 53, "Subsection",ExpressionUUID->"be5850ea-72d1-4eb6-b945-f4862fadb6d4",
   CellTags->"Evaluation"],
  Cell[102724, 2631, 2272, 60, 180, "Input",ExpressionUUID->"57b13a59-bbda-47bd-bcb1-94321ca663e9",
   CellTags->"Evaluation"],
  Cell[105033, 2696, 174, 3, 53, "Subsection",ExpressionUUID->"22b5bbc3-3951-46d3-ad9a-83114d344b4c",
   CellTags->"Evaluation"],
  Cell[105210, 2701, 2149, 54, 358, "Input",ExpressionUUID->"d9f77161-a435-4e0d-a1e7-77d7f183b93b",
   CellTags->"Evaluation"],
  Cell[107396, 2760, 334, 6, 53, "Subsection",ExpressionUUID->"095611fb-9a2e-4c4f-91d9-5d2e63f6be49",
   CellTags->"Evaluation"],
  Cell[107733, 2768, 1152, 31, 142, "Input",ExpressionUUID->"79c3c6d2-bec6-41b6-9818-7d5c26b7676d",
   CellTags->"Evaluation"]}
 }
*)
(*CellTagsIndex
CellTagsIndex->{
 {"Evaluation", 119379, 3093}
 }
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 161, 3, 67, "Chapter",ExpressionUUID->"c00d73d4-6b40-f747-a12f-e31a7c5757a2"],
Cell[744, 27, 1338, 34, 149, "Input",ExpressionUUID->"1b6ad74e-d544-5e4a-952b-ad38c2bed513"]
}, Open  ]],
Cell[CellGroupData[{
Cell[2119, 66, 275, 6, 67, "Chapter",ExpressionUUID->"6a9fc57c-5e9d-4b7d-961e-a6fe99a0d7ee"],
Cell[CellGroupData[{
Cell[2419, 76, 232, 4, 66, "Section",ExpressionUUID->"c53be3f0-8cb4-4809-9a6c-cad3f46048e4"],
Cell[2654, 82, 8091, 187, 313, "Input",ExpressionUUID->"d54cf136-403d-4b2a-85d2-cc1e872c4502"]
}, Open  ]],
Cell[CellGroupData[{
Cell[10782, 274, 178, 3, 66, "Section",ExpressionUUID->"a86aa69f-68f0-4048-88b5-3f939c7e6c37"],
Cell[10963, 279, 8038, 186, 313, "Input",ExpressionUUID->"be5f9589-886e-4d54-b550-9b133897abef"]
}, Open  ]],
Cell[CellGroupData[{
Cell[19038, 470, 206, 4, 66, "Section",ExpressionUUID->"c48e1bb4-4fdf-48f1-9b87-b1d1c7310dd9"],
Cell[19247, 476, 7891, 184, 313, "Input",ExpressionUUID->"9761727f-dd4c-4b64-bef4-b83c06d1e371"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[27187, 666, 518, 16, 67, "Chapter",ExpressionUUID->"347c023b-10d9-3e4c-892c-e61e22be8241"],
Cell[27708, 684, 21756, 506, 1471, "Input",ExpressionUUID->"be73174a-8d0d-4157-8a73-61dd1317e2e4"]
}, Open  ]],
Cell[CellGroupData[{
Cell[49501, 1195, 167, 3, 67, "Chapter",ExpressionUUID->"b21696a6-6550-4593-bb2f-3412d4a5190a"],
Cell[CellGroupData[{
Cell[49693, 1202, 168, 3, 66, "Section",ExpressionUUID->"79df926b-49b8-452d-8cfd-9a98d29fac88"],
Cell[CellGroupData[{
Cell[49886, 1209, 6989, 182, 641, "Input",ExpressionUUID->"a89bd970-0d75-4bd8-a8f3-5d2f1fc34d8b"],
Cell[56878, 1393, 538, 11, 31, "Output",ExpressionUUID->"d25164da-4d97-a542-a4e4-3df8dcecf533"]
}, Open  ]],
Cell[CellGroupData[{
Cell[57453, 1409, 199, 3, 53, "Subsection",ExpressionUUID->"33579614-1aa2-4319-b032-dbd0bab63a0c"],
Cell[57655, 1414, 28101, 746, 924, "Input",ExpressionUUID->"d3f58867-5730-48be-bfdf-c31e8c0d0d87"],
Cell[CellGroupData[{
Cell[85781, 2164, 160, 3, 43, "Subsubsection",ExpressionUUID->"da019169-6bd3-8d40-a094-fd6783ad26e5"],
Cell[85944, 2169, 13233, 351, 512, "Input",ExpressionUUID->"13a1b95d-7b9c-bd48-8572-836e18a0dd6d"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[99238, 2527, 174, 3, 66, "Section",ExpressionUUID->"bd046188-669d-4d82-b080-7c27c6442fb4"],
Cell[99415, 2532, 1292, 37, 128, "Input",ExpressionUUID->"6aecfd3c-5461-4d9f-ab7d-cc5c88abf96f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[100744, 2574, 169, 3, 66, "Section",ExpressionUUID->"1830c887-6440-434c-8e62-b0c9e018f561"],
Cell[100916, 2579, 1302, 34, 85, "Input",ExpressionUUID->"212cca0a-a6b9-4c80-98e3-d5d59a2de6f7"]
}, Open  ]],
Cell[CellGroupData[{
Cell[102255, 2618, 203, 3, 66, "Section",ExpressionUUID->"16dbf08b-1200-4ac4-ad9a-ed04d15b41ef",
 CellTags->"Evaluation"],
Cell[CellGroupData[{
Cell[102483, 2625, 238, 4, 53, "Subsection",ExpressionUUID->"be5850ea-72d1-4eb6-b945-f4862fadb6d4",
 CellTags->"Evaluation"],
Cell[102724, 2631, 2272, 60, 180, "Input",ExpressionUUID->"57b13a59-bbda-47bd-bcb1-94321ca663e9",
 CellTags->"Evaluation"]
}, Open  ]],
Cell[CellGroupData[{
Cell[105033, 2696, 174, 3, 53, "Subsection",ExpressionUUID->"22b5bbc3-3951-46d3-ad9a-83114d344b4c",
 CellTags->"Evaluation"],
Cell[105210, 2701, 2149, 54, 358, "Input",ExpressionUUID->"d9f77161-a435-4e0d-a1e7-77d7f183b93b",
 CellTags->"Evaluation"]
}, Open  ]],
Cell[CellGroupData[{
Cell[107396, 2760, 334, 6, 53, "Subsection",ExpressionUUID->"095611fb-9a2e-4c4f-91d9-5d2e63f6be49",
 CellTags->"Evaluation"],
Cell[107733, 2768, 1152, 31, 142, "Input",ExpressionUUID->"79c3c6d2-bec6-41b6-9818-7d5c26b7676d",
 CellTags->"Evaluation"]
}, Open  ]],
Cell[CellGroupData[{
Cell[108922, 2804, 161, 3, 53, "Subsection",ExpressionUUID->"8dc21479-e70c-1f4a-897d-b6de05a5cc9f"],
Cell[109086, 2809, 821, 21, 66, "Input",ExpressionUUID->"bae47109-e377-7646-99bf-6f50ae798967"]
}, Open  ]],
Cell[CellGroupData[{
Cell[109944, 2835, 209, 4, 53, "Subsection",ExpressionUUID->"17d36820-4e8b-514f-ab2a-8bf445a60a7e"],
Cell[110156, 2841, 1708, 41, 104, "Input",ExpressionUUID->"71cc9362-638b-6449-8b32-cc9ebc2af364"]
}, Open  ]],
Cell[CellGroupData[{
Cell[111901, 2887, 249, 4, 53, "Subsection",ExpressionUUID->"0db9805a-a4a8-0f4b-8d93-b7cbdcc8e02e"],
Cell[112153, 2893, 862, 20, 28, "Input",ExpressionUUID->"36d683e8-0e01-9d44-9047-d5864d6e5cfa"]
}, Open  ]],
Cell[CellGroupData[{
Cell[113052, 2918, 304, 5, 53, "Subsection",ExpressionUUID->"1c67d832-797a-2144-b4fc-34b9dcaefe81"],
Cell[113359, 2925, 951, 21, 28, "Input",ExpressionUUID->"28915e64-9b7f-db47-893d-04ba0b14a137"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[114359, 2952, 235, 4, 66, "Section",ExpressionUUID->"06e91bf1-cd1c-4037-a60c-c794d0e3abeb"],
Cell[114597, 2958, 4395, 120, 368, "Input",ExpressionUUID->"266da48e-a6ff-47d5-a38b-a47657d2e421"]
}, Open  ]]
}, Open  ]]
}
]
*)

