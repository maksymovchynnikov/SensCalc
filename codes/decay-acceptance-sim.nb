(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    248659,       5587]
NotebookOptionsPosition[    241972,       5462]
NotebookOutlinePosition[    242403,       5479]
CellTagsIndexPosition[    242360,       5476]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Decay acceptance definitions", "Chapter",
 CellChangeTimes->{{3.8913221765123215`*^9, 3.891322205486955*^9}, {
  3.9152556331041536`*^9, 
  3.9152556364819984`*^9}},ExpressionUUID->"70c08414-8e83-48c2-82e8-\
8fa5758d7241"],

Cell[CellGroupData[{

Cell["A kink in the trajectory due to magnetic field", "Section",
 CellChangeTimes->{{3.889241769668279*^9, 3.889241776377763*^9}, {
  3.8892450953409357`*^9, 
  3.8892450955208035`*^9}},ExpressionUUID->"ade4bc47-2ae5-4f6a-b1b0-\
171e857f7102"],

Cell[CellGroupData[{

Cell["Parameters", "Subsection",
 CellChangeTimes->{{3.916156229020624*^9, 
  3.9161562314142723`*^9}},ExpressionUUID->"8729d17f-1d3a-4eaa-98ec-\
8f49f54815e3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"electric", " ", "charge", " ", "in", " ", "SI", " ", "units"}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"qValSI", "=", 
     RowBox[{"1.6", "*", 
      SuperscriptBox["10", 
       RowBox[{"-", "19"}]]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Magnetic", " ", "field", " ", "in", " ", "SI", " ", "units"}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BvalFCCee", "=", "1"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Electron", " ", "mass", " ", "in", " ", "SI", " ", "units"}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"mekG", "=", 
     RowBox[{"9.1", "*", 
      SuperscriptBox["10", 
       RowBox[{"-", "31"}]]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"m\[Mu]kG", "=", 
     RowBox[{
      FractionBox["105", 
       RowBox[{"0.5", "*", 
        SuperscriptBox["10", 
         RowBox[{"-", "3"}]]}]], "9.1", "*", 
      SuperscriptBox["10", 
       RowBox[{"-", "31"}]]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"hbar", "=", 
     RowBox[{"6.58", "*", 
      SuperscriptBox["10", 
       RowBox[{"-", "25"}]]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"cval", "=", 
     RowBox[{"3", "*", 
      SuperscriptBox["10", "8"]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"1", " ", "kg", " ", "in", " ", "terms", " ", "of", " ", 
     RowBox[{"GeV", ".", " ", "Converted"}], " ", "using", " ", "the", " ", 
     "electron", " ", "mass", " ", "in", " ", "GeV", " ", "and", " ", "in", 
     " ", "kg"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"kgToGeVval", "=", 
     FractionBox[
      RowBox[{"0.5", "*", 
       SuperscriptBox["10", 
        RowBox[{"-", "3"}]]}], 
      RowBox[{"9.1", "*", 
       SuperscriptBox["10", 
        RowBox[{"-", "31"}]]}]]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"GeVTokgVal", "=", 
     SuperscriptBox["kgToGeVval", 
      RowBox[{"-", "1"}]]}], ";"}]}]}]], "Input",
 CellLabel->"In[1]:=",ExpressionUUID->"cbfbbe02-6751-49e4-964b-aa59849db48d"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Constant magnetic field", "Subsection",
 CellChangeTimes->{{3.8891723271521983`*^9, 
  3.88917232970436*^9}},ExpressionUUID->"f02e9a12-c92c-422c-a166-\
2b8ff8267683"],

Cell[CellGroupData[{

Cell["Exact expressions", "Subsubsection",
 CellChangeTimes->{{3.898699158303877*^9, 
  3.8986991608177204`*^9}},ExpressionUUID->"f9291186-597c-407c-8842-\
0139f518ac2d"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Velocities", " ", "in", " ", "SI", " ", "in", " ", "terms", " ", "of", 
     " ", "p"}], ",", " ", 
    RowBox[{"E", " ", "in", " ", "GeV"}], ",", " ", 
    RowBox[{"and", " ", "speed", " ", "of", " ", "light"}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"vxEnergy", "=", 
     RowBox[{"c", "*", 
      FractionBox["pxGeV", "EGeV"]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"vyEnergy", "=", 
     RowBox[{"c", "*", 
      FractionBox["pyGeV", "EGeV"]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"vzEnergy", "=", 
     RowBox[{"c", "*", 
      FractionBox["pzGeV", "EGeV"]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Gamma]Energy", "=", 
     FractionBox["EGeV", "mGeV"]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"EOMs", " ", "\[Gamma]", " ", 
       FractionBox[
        RowBox[{"d", 
         OverscriptBox["v", "_"]}], "dt"]}], " ", "=", " ", 
      RowBox[{"q", "[", 
       RowBox[{
        OverscriptBox["v", "_"], "\[Times]", 
        OverscriptBox["B", "_"]}], "]"}]}], ",", " ", 
     RowBox[{"where", " ", 
      OverscriptBox["B", "_"], " ", "is", " ", "assumed", " ", "to", " ", 
      "be", " ", "located", " ", "along", " ", "the", " ", "y", " ", "axis", 
      " ", "in", " ", "the", " ", "positive", " ", 
      RowBox[{"direction", ".", " ", "All"}], " ", "the", " ", "quantities", 
      " ", "entering", " ", "the", " ", "EOM", " ", "are", " ", "in", " ", 
      "SI", " ", "units"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"EQsHelicalTrajectory", "=", 
     RowBox[{
      RowBox[{"DSolve", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"x", "''"}], "[", "t", "]"}], "\[Equal]", 
           RowBox[{
            FractionBox["1", 
             RowBox[{"m", "*", "\[Gamma]"}]], "q", "*", 
            RowBox[{
             RowBox[{"Cross", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{"x", "'"}], "[", "t", "]"}], ",", 
                 RowBox[{
                  RowBox[{"y", "'"}], "[", "t", "]"}], ",", 
                 RowBox[{
                  RowBox[{"z", "'"}], "[", "t", "]"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"0", ",", "B", ",", "0"}], "}"}]}], "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}]}]}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"y", "''"}], "[", "t", "]"}], "\[Equal]", 
           RowBox[{
            FractionBox["1", 
             RowBox[{"m", "*", "\[Gamma]"}]], "q", "*", 
            RowBox[{
             RowBox[{"Cross", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{"x", "'"}], "[", "t", "]"}], ",", 
                 RowBox[{
                  RowBox[{"y", "'"}], "[", "t", "]"}], ",", 
                 RowBox[{
                  RowBox[{"z", "'"}], "[", "t", "]"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"0", ",", "B", ",", "0"}], "}"}]}], "]"}], "[", 
             RowBox[{"[", "2", "]"}], "]"}]}]}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"z", "''"}], "[", "t", "]"}], "\[Equal]", 
           RowBox[{
            FractionBox["q", 
             RowBox[{"m", "*", "\[Gamma]"}]], "*", 
            RowBox[{
             RowBox[{"Cross", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{"x", "'"}], "[", "t", "]"}], ",", 
                 RowBox[{
                  RowBox[{"y", "'"}], "[", "t", "]"}], ",", 
                 RowBox[{
                  RowBox[{"z", "'"}], "[", "t", "]"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"0", ",", "B", ",", "0"}], "}"}]}], "]"}], "[", 
             RowBox[{"[", "3", "]"}], "]"}]}]}], ",", 
          RowBox[{
           RowBox[{"x", "[", "0", "]"}], "\[Equal]", "x0"}], ",", 
          RowBox[{
           RowBox[{"y", "[", "0", "]"}], "\[Equal]", "y0"}], ",", 
          RowBox[{
           RowBox[{"z", "[", "0", "]"}], "\[Equal]", "z0"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"x", "'"}], "[", "0", "]"}], "\[Equal]", "vx"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"y", "'"}], "[", "0", "]"}], "\[Equal]", "vy"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"z", "'"}], "[", "0", "]"}], "\[Equal]", "vz"}]}], "}"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", "t"}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
   "Print", "[", 
    "\"\<Helical trajectories - x, y, z. Here, \!\(\*SubscriptBox[\(p\), \
\(i\)]\) in the units of GeV:\>\"", "]"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"xHelicalTemp1", "[", 
       RowBox[{
       "x0m_", ",", "pxGeV_", ",", "pzGeV_", ",", "EGeV_", ",", "BTl_", ",", 
        "qCoulomb_", ",", "tsecond_", ",", "GeVTokg_"}], "]"}], ",", 
      RowBox[{"yHelicalTemp1", "[", 
       RowBox[{"y0m_", ",", "pyGeV_", ",", "EGeV_", ",", "tsecond_"}], "]"}], 
      ",", 
      RowBox[{"zHelicalTemp1", "[", 
       RowBox[{
       "z0m_", ",", "pxGeV_", ",", "pzGeV_", ",", "EGeV_", ",", "BTl_", ",", 
        "qCoulomb_", ",", "tsecond_", ",", "GeVTokg_"}], "]"}]}], "}"}], "=", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"x", "[", "t", "]"}], "/.", "EQsHelicalTrajectory"}], ")"}], 
       ",", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"y", "[", "t", "]"}], "/.", "EQsHelicalTrajectory"}], ")"}], 
       ",", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"z", "[", "t", "]"}], "/.", "EQsHelicalTrajectory"}], 
        ")"}]}], "}"}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"vx", "\[Rule]", "vxEnergy"}], ",", 
       RowBox[{"vy", "\[Rule]", "vyEnergy"}], ",", 
       RowBox[{"vz", "\[Rule]", "vzEnergy"}], ",", 
       RowBox[{"\[Gamma]", "\[Rule]", "\[Gamma]Energy"}], ",", 
       RowBox[{"m", "\[Rule]", " ", 
        RowBox[{"mGeV", "*", "GeVTokg"}]}], ",", 
       RowBox[{"B", "\[Rule]", "BTl"}], ",", 
       RowBox[{"q", "\[Rule]", "qCoulomb"}], ",", 
       RowBox[{"x0", "\[Rule]", "x0m"}], ",", 
       RowBox[{"t", "\[Rule]", "tsecond"}]}], "}"}]}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"Print", "[", "\"\<Velocities dx/dt, dy/dt, dz/dt:\>\"", "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"vxHelicalTemp1", "[", 
       RowBox[{
       "pxGeV_", ",", "pzGeV_", ",", "EGeV_", ",", "BTl_", ",", "qCoulomb_", 
        ",", "tsecond_", ",", "GeVTokg_"}], "]"}], ",", 
      RowBox[{"vyHelicalTemp1", "[", 
       RowBox[{"pyGeV_", ",", "EGeV_"}], "]"}], ",", 
      RowBox[{"vzHelicalTemp1", "[", 
       RowBox[{
       "pxGeV_", ",", "pzGeV_", ",", "EGeV_", ",", "BTl_", ",", "qCoulomb_", 
        ",", "tsecond_", ",", "GeVTokg_"}], "]"}]}], "}"}], "=", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"xHelicalTemp1", "[", 
          RowBox[{
          "x0m", ",", "pxGeV", ",", "pzGeV", ",", "EGeV", ",", "BTl", ",", 
           "qCoulomb", ",", "tsecond", ",", "GeVTokg"}], "]"}], ",", 
         "tsecond"}], "]"}], ",", 
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"yHelicalTemp1", "[", 
          RowBox[{"y0m", ",", "pyGeV", ",", "EGeV", ",", "tsecond"}], "]"}], 
         ",", "tsecond"}], "]"}], ",", 
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"zHelicalTemp1", "[", 
          RowBox[{
          "z0m", ",", "pxGeV", ",", "pzGeV", ",", "EGeV", ",", "BTl", ",", 
           "qCoulomb", ",", "tsecond", ",", "GeVTokg"}], "]"}], ",", 
         "tsecond"}], "]"}]}], "}"}], "//", "Simplify"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
   "Print", "[", 
    "\"\<Momenta \!\(\*SubscriptBox[\(p\), \(i\)]\)(t) = E \
\!\(\*SubscriptBox[\(v\), \(i\)]\)(t)/\!\(\*SuperscriptBox[\(c\), \(2\)]\):\>\
\"", "]"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"pxHelicalTemp1", "[", 
       RowBox[{
       "pxGeV_", ",", "pzGeV_", ",", "BTl_", ",", "qCoulomb_", ",", 
        "tsecond_", ",", "GeVTokg_"}], "]"}], ",", 
      RowBox[{"pyHelicalTemp1", "[", "pyGeV_", "]"}], ",", 
      RowBox[{"pzHelicalTemp1", "[", 
       RowBox[{
       "pxGeV_", ",", "pzGeV_", ",", "BTl_", ",", "qCoulomb_", ",", 
        "tsecond_", ",", "GeVTokg_"}], "]"}]}], "}"}], "=", 
    RowBox[{
     RowBox[{
      FractionBox["EGeV", "c"], 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"vxHelicalTemp1", "[", 
         RowBox[{
         "pxGeV", ",", "pzGeV", ",", "EGeV", ",", "BTl", ",", "qCoulomb", ",",
           "tsecond", ",", "GeVTokg"}], "]"}], ",", 
        RowBox[{"vyHelicalTemp1", "[", 
         RowBox[{"pyGeV", ",", "EGeV"}], "]"}], ",", 
        RowBox[{"vzHelicalTemp1", "[", 
         RowBox[{
         "pxGeV", ",", "pzGeV", ",", "EGeV", ",", "BTl", ",", "qCoulomb", ",",
           "tsecond", ",", "GeVTokg"}], "]"}]}], "}"}]}], "//", 
     "Simplify"}]}], "\[IndentingNewLine]", 
   RowBox[{
   "Print", "[", 
    "\"\<Cross-check: \!\(\*SuperscriptBox[OverscriptBox[\(v\), \(_\)], \
\(2\)]\)(t) = \!\(\*SubscriptBox[SuperscriptBox[\(v\), \(2\)], \(x\)]\)(t)+\!\
\(\*SubscriptBox[SuperscriptBox[\(v\), \(2\)], \
\(y\)]\)(t)+\!\(\*SubscriptBox[SuperscriptBox[\(v\), \(2\)], \(z\)]\)(t) is \
equal to \!\(\*SuperscriptBox[\(v\), \(2\)]\)(t = 0) = \
\!\(\*SubscriptBox[SuperscriptBox[\(v\), \(2\)], \(x, \
0\)]\)+\!\(\*SubscriptBox[SuperscriptBox[\(v\), \(2\)], \(y, \
0\)]\)+\!\(\*SubscriptBox[SuperscriptBox[\(v\), \(2\)], \(z, 0\)]\) = \
\!\(\*SuperscriptBox[\(c\), \(2\)]\)\!\(\*SuperscriptBox[OverscriptBox[\(p\), \
\(_\)], \(2\)]\)/\!\(\*SuperscriptBox[\(E\), \(2\)]\)\>\"", "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      SuperscriptBox[
       RowBox[{"vxHelicalTemp1", "[", 
        RowBox[{
        "pxGeV", ",", "pzGeV", ",", "EGeV", ",", "BTl", ",", "qCoulomb", ",", 
         "tsecond", ",", "GeVTokg"}], "]"}], "2"], "+", 
      SuperscriptBox[
       RowBox[{"vyHelicalTemp1", "[", 
        RowBox[{"pyGeV", ",", "EGeV"}], "]"}], "2"], "+", 
      SuperscriptBox[
       RowBox[{"vzHelicalTemp1", "[", 
        RowBox[{
        "pxGeV", ",", "pzGeV", ",", "EGeV", ",", "BTl", ",", "qCoulomb", ",", 
         "tsecond", ",", "GeVTokg"}], "]"}], "2"]}], "//", "Expand"}], "//", 
    "Simplify"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Therefore", ",", " ", 
     RowBox[{
     "after", " ", "passing", " ", "the", " ", "domain", " ", "with", " ", 
      "the", " ", "magnetic", " ", "field"}], ",", " ", 
     RowBox[{"the", " ", "new", " ", 
      SubscriptBox[
       RowBox[{"p", "'"}], "x"]}], ",", 
     RowBox[{
      RowBox[{
       SubscriptBox[
        RowBox[{"p", "'"}], "z"], " ", "are", " ", 
       SubscriptBox[
        RowBox[{"p", "'"}], "x"]}], " ", "=", " ", 
      RowBox[{
       SubscriptBox["p", 
        RowBox[{"x", ",", "0"}]], "\[Times]", 
       FractionBox[
        RowBox[{
         SubscriptBox["v", "x"], 
         RowBox[{"(", 
          SubscriptBox["t", "passing"], ")"}]}], 
        SubscriptBox["v", 
         RowBox[{"x", ",", "0"}]]]}]}], ",", " ", 
     RowBox[{
      SubscriptBox[
       RowBox[{"p", "'"}], "z"], " ", "=", " ", 
      RowBox[{
       SubscriptBox["p", 
        RowBox[{"z", ",", "0"}]], "\[Times]", 
       FractionBox[
        RowBox[{
         SubscriptBox["v", "z"], 
         RowBox[{"(", 
          SubscriptBox["t", "passing"], ")"}]}], 
        SubscriptBox["v", 
         RowBox[{"z", ",", "0"}]]]}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Approximate", " ", "value", " ", "of", " ", "the", " ", "period", " ", 
     "of", " ", "time", " ", "for", " ", "which", " ", "the", " ", "charged", 
     " ", "particle", " ", "passes", " ", "through", " ", "the", " ", 
     "domain", " ", "with", " ", "magnetic", " ", 
     RowBox[{"field", ".", " ", "It"}], " ", "is", " ", "estimated", " ", 
     "roughly", " ", "assuming", " ", "that", " ", "the", " ", "momentum", 
     " ", 
     SubscriptBox["p", "z"], " ", "is", " ", "left", " ", "unchanged"}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"tz0", "[", 
      RowBox[{
      "zprojm_", ",", "z0m_", ",", "c_", ",", "pzGeV_", ",", "EGeV_"}], "]"}],
      "=", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"t", "/.", 
        RowBox[{
         RowBox[{"Solve", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"zHelicalTemp1", "[", 
             RowBox[{
             "z0m", ",", "pxGeV", ",", "pzGeV", ",", "EGeV", ",", "BTl", ",", 
              "qCoulomb", ",", "t", ",", "GeVTokg"}], "]"}], "\[Equal]", 
            "zproj"}], ",", "t"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], "/.", 
       RowBox[{"{", 
        RowBox[{
         TemplateBox[{"1"},
          "C"], "\[Rule]", "0"}], "}"}]}], "*)"}], 
     RowBox[{"t", "/.", 
      RowBox[{
       RowBox[{"Solve", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"z0m", "+", 
           RowBox[{"vzEnergy", "*", "t"}]}], "==", "zprojm"}], ",", "t"}], 
        "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Helical", " ", "trajectories", " ", 
      RowBox[{"x", "[", 
       SubscriptBox["t", 
        RowBox[{"z", " ", "=", " ", "0"}]], "]"}]}], ",", " ", 
     RowBox[{
      RowBox[{"y", "[", 
       SubscriptBox["t", 
        RowBox[{"z", " ", "=", " ", "0"}]], "]"}], "."}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"xHelicalTemp2", "[", 
      RowBox[{
      "x0m_", ",", "z0m_", ",", "pxGeV_", ",", "pzGeV_", ",", "BTl_", ",", 
       "qsign_", ",", "zprojm_"}], "]"}], "=", 
     RowBox[{
      RowBox[{"xHelicalTemp1", "[", 
       RowBox[{
       "x0m", ",", "pxGeV", ",", "pzGeV", ",", "EGeV", ",", "BTl", ",", 
        "qCoulomb", ",", 
        RowBox[{"tz0", "[", 
         RowBox[{"zprojm", ",", "z0m", ",", "c", ",", "pzGeV", ",", "EGeV"}], 
         "]"}], ",", "GeVTokg"}], "]"}], "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"c", "\[Rule]", "cval"}], ",", 
        RowBox[{"qCoulomb", "\[Rule]", " ", 
         RowBox[{"qValSI", "*", "qsign"}]}], ",", 
        RowBox[{"GeVTokg", "\[Rule]", "GeVTokgVal"}]}], "}"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"yHelicalTemp2", "[", 
      RowBox[{
      "y0m_", ",", "z0m_", ",", "pyGeV_", ",", "pzGeV_", ",", "zprojm_"}], 
      "]"}], "=", 
     RowBox[{
      RowBox[{
       RowBox[{"yHelicalTemp1", "[", 
        RowBox[{"y0m", ",", "pyGeV", ",", "EGeV", ",", 
         RowBox[{"tz0", "[", 
          RowBox[{"zprojm", ",", "z0m", ",", "c", ",", "pzGeV", ",", "EGeV"}],
           "]"}]}], "]"}], "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"m", "\[Rule]", "mlkg"}], ",", 
         RowBox[{"\[Gamma]", "\[Rule]", "\[Gamma]Energy"}], ",", 
         RowBox[{"vz", "\[Rule]", "vzEnergy"}], ",", 
         RowBox[{"vx", "\[Rule]", "vxEnergy"}], ",", 
         RowBox[{"vy", "\[Rule]", "vyEnergy"}]}], "}"}]}], "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"c", "\[Rule]", "cval"}], ",", 
        RowBox[{"qCoulomb", "\[Rule]", " ", 
         RowBox[{"qValSI", "*", "qsign"}]}], ",", 
        RowBox[{"GeVTokg", "\[Rule]", "GeVTokgVal"}]}], "}"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"zHelicalTemp2", "[", 
      RowBox[{
      "z0m_", ",", "pxGeV_", ",", "pzGeV_", ",", "BTl_", ",", "qsign_", ",", 
       "zprojm_"}], "]"}], "=", 
     RowBox[{
      RowBox[{"zHelicalTemp1", "[", 
       RowBox[{
       "z0m", ",", "pxGeV", ",", "pzGeV", ",", "EGeV", ",", "BTl", ",", 
        "qCoulomb", ",", 
        RowBox[{"tz0", "[", 
         RowBox[{"zprojm", ",", "z0m", ",", "c", ",", "pzGeV", ",", "EGeV"}], 
         "]"}], ",", "GeVTokg"}], "]"}], "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"c", "\[Rule]", 
         RowBox[{"3", "*", 
          SuperscriptBox["10", "8"]}]}], ",", 
        RowBox[{"qCoulomb", "\[Rule]", " ", 
         RowBox[{"qValSI", "*", "qsign"}]}], ",", 
        RowBox[{"GeVTokg", "\[Rule]", "GeVTokgVal"}]}], "}"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"pxHelicalTemp2", "[", 
        RowBox[{
        "z0m_", ",", "pxGeV_", ",", "pzGeV_", ",", "BTl_", ",", "qsign_", ",",
          "zprojm_"}], "]"}], ",", 
       RowBox[{"pyHelicalTemp2", "[", "pyGeV_", "]"}], ",", 
       RowBox[{"pzHelicalTemp2", "[", 
        RowBox[{
        "z0m_", ",", "pxGeV_", ",", "pzGeV_", ",", "BTl_", ",", "qsign_", ",",
          "zprojm_"}], "]"}]}], "}"}], "=", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"pxHelicalTemp1", "[", 
          RowBox[{"pxGeV", ",", "pzGeV", ",", "BTl", ",", "qCoulomb", ",", 
           RowBox[{"tz0", "[", 
            RowBox[{
            "zprojm", ",", "z0m", ",", "c", ",", "pzGeV", ",", "EGeV"}], 
            "]"}], ",", "GeVTokg"}], "]"}], ",", 
         RowBox[{"pyHelicalTemp1", "[", "pyGeV", "]"}], ",", 
         RowBox[{"pzHelicalTemp1", "[", 
          RowBox[{"pxGeV", ",", "pzGeV", ",", "BTl", ",", "qCoulomb", ",", 
           RowBox[{"tz0", "[", 
            RowBox[{
            "zprojm", ",", "z0m", ",", "c", ",", "pzGeV", ",", "EGeV"}], 
            "]"}], ",", "GeVTokg"}], "]"}]}], "}"}], "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"c", "\[Rule]", "cval"}], ",", 
         RowBox[{"qCoulomb", "\[Rule]", " ", 
          RowBox[{"qValSI", "*", "qsign"}]}], ",", 
         RowBox[{"GeVTokg", "\[Rule]", "GeVTokgVal"}]}], "}"}]}], "//", 
      "Simplify"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"Print", "[", "\"\<Larmor radius (in m):\>\"", "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"LarmorRadius", "[", 
     RowBox[{"EGeV_", ",", "BTl_"}], "]"}], "=", 
    RowBox[{"cval", "*", 
     FractionBox[
      RowBox[{"EGeV", "*", "GeVTokgVal"}], 
      RowBox[{"qValSI", "*", "BTl"}]]}]}]}]}]], "Input",
 CellChangeTimes->{{3.8891715835639944`*^9, 3.889171607572118*^9}, {
   3.8891716708460007`*^9, 3.8891716996685534`*^9}, {3.889171730927663*^9, 
   3.8891718025651083`*^9}, {3.8891718552539015`*^9, 3.889171936952908*^9}, {
   3.8891720111828213`*^9, 3.8891720113107405`*^9}, {3.8891721699050617`*^9, 
   3.8891721757644434`*^9}, {3.889174147055462*^9, 3.889174160006665*^9}, {
   3.8891958521046643`*^9, 3.8891958522468634`*^9}, {3.8891962026454644`*^9, 
   3.889196237599688*^9}, {3.8891963121202774`*^9, 3.8891963141583824`*^9}, {
   3.88919688391845*^9, 3.889196923198343*^9}, {3.889196971720621*^9, 
   3.8891969735276012`*^9}, {3.8891970264289846`*^9, 3.889197089936922*^9}, {
   3.889197123724253*^9, 3.88919712488072*^9}, {3.889197347990362*^9, 
   3.8891973643290424`*^9}, {3.88919926025797*^9, 3.8891992911784053`*^9}, {
   3.8891993830334735`*^9, 3.889199383419773*^9}, {3.8891995274596653`*^9, 
   3.8891995275987587`*^9}, {3.889199965458976*^9, 3.8892000128043385`*^9}, {
   3.889200051029212*^9, 3.8892001179983997`*^9}, {3.889200558271455*^9, 
   3.8892005655297513`*^9}, {3.889200723395628*^9, 3.8892007266926556`*^9}, {
   3.889201692567236*^9, 3.889201704299495*^9}, {3.889201997677557*^9, 
   3.8892020059634314`*^9}, {3.889203858706788*^9, 3.889204001096776*^9}, {
   3.889204035386567*^9, 3.889204263742028*^9}, {3.8892043081832323`*^9, 
   3.889204391264265*^9}, {3.889204531648478*^9, 3.889204689106662*^9}, {
   3.8892050634914045`*^9, 3.8892051702023964`*^9}, {3.8892057677033467`*^9, 
   3.8892061222105474`*^9}, {3.8892061644903955`*^9, 3.889206164856732*^9}, {
   3.889206222470356*^9, 3.8892062225708046`*^9}, {3.889206285420225*^9, 
   3.889206490520496*^9}, {3.889206595121992*^9, 3.8892067009458857`*^9}, {
   3.8892067476541643`*^9, 3.8892067773218117`*^9}, 3.889206968504375*^9, {
   3.8892418443893285`*^9, 3.889241942034682*^9}, {3.889242604413707*^9, 
   3.8892426111403365`*^9}, {3.8892427246470413`*^9, 
   3.8892428336617985`*^9}, {3.889242935829185*^9, 3.8892429516691093`*^9}, {
   3.8892429861876316`*^9, 3.889243028970298*^9}, {3.889244735048849*^9, 
   3.8892448846934404`*^9}, 3.889244933960964*^9, {3.889244966522671*^9, 
   3.8892450312974296`*^9}, {3.8892451080983906`*^9, 3.889245155339543*^9}, {
   3.889245198863324*^9, 3.889245277568147*^9}, {3.889245346682953*^9, 
   3.889245375548482*^9}, {3.889245434706152*^9, 3.8892454400324965`*^9}, {
   3.889245562969037*^9, 3.8892455831975603`*^9}, {3.8892457231983676`*^9, 
   3.8892457268208*^9}, {3.8892462439945955`*^9, 3.889246326384137*^9}, {
   3.889246363667035*^9, 3.8892464030715723`*^9}, {3.889255024952756*^9, 
   3.8892551225447063`*^9}, {3.889263922692747*^9, 3.8892639450822616`*^9}, {
   3.8892639756443453`*^9, 3.8892640303101296`*^9}, 3.8969283922022552`*^9, {
   3.898699281483991*^9, 3.8986992942793465`*^9}, {3.898699337954791*^9, 
   3.898699338542406*^9}, {3.9049623366587543`*^9, 3.9049623369687014`*^9}, {
   3.9112843536969843`*^9, 3.9112843577140183`*^9}, {3.911284636577899*^9, 
   3.9112848131555805`*^9}, {3.9112864519207497`*^9, 3.911286452740077*^9}, {
   3.911287015036559*^9, 3.911287021036378*^9}, {3.911287097132141*^9, 
   3.9112870973086987`*^9}, {3.9112872001496377`*^9, 3.911287202871893*^9}, {
   3.9112872852329645`*^9, 3.911287321735216*^9}, {3.9112895845189333`*^9, 
   3.9112895942065487`*^9}, {3.91128965891726*^9, 3.911289659966033*^9}},
 CellLabel->"In[9]:=",ExpressionUUID->"0b9d437f-d2eb-4420-93a0-e8c91803cc37"],

Cell[BoxData[
 FormBox["\<\"Helical trajectories - x, y, z. Here, \
\\!\\(\\*SubscriptBox[\\(p\\), \\(i\\)]\\) in the units of GeV:\"\>", 
  TraditionalForm]], "Print",
 CellChangeTimes->{3.9156385923144894`*^9, 3.915639459955377*^9, 
  3.915640301443778*^9, 3.915641482126387*^9, 3.91564169456841*^9, 
  3.915681161169697*^9, 3.915681505948893*^9, 3.9156856579832497`*^9, 
  3.9157698829697094`*^9, 3.9157709917280345`*^9, 3.9157813490046716`*^9, 
  3.915781594422082*^9, 3.915787353587736*^9, 3.915814752427195*^9, 
  3.9158551909562826`*^9, 3.9158573863147974`*^9, 3.9158576524095235`*^9, 
  3.9158591308477077`*^9, 3.9158631081490498`*^9, 3.915865421117629*^9, 
  3.9158674312847605`*^9, 3.91587876872263*^9, 3.9161263899562645`*^9, 
  3.9161282291485643`*^9, 3.917688710284793*^9, 3.9190102755673895`*^9},
 CellLabel->
  "During evaluation of \
In[534]:=",ExpressionUUID->"8f6e0663-f852-47e4-9353-dbda86717701"],

Cell[BoxData[
 FormBox[
  RowBox[{"{", 
   RowBox[{
    FractionBox[
     RowBox[{
      RowBox[{"c", " ", "GeVTokg", " ", "pxGeV", " ", 
       RowBox[{"sin", "(", 
        FractionBox[
         RowBox[{"BTl", " ", "qCoulomb", " ", "tsecond"}], 
         RowBox[{"EGeV", " ", "GeVTokg"}]], ")"}]}], "+", 
      RowBox[{"c", " ", "GeVTokg", " ", "pzGeV", " ", 
       RowBox[{"cos", "(", 
        FractionBox[
         RowBox[{"BTl", " ", "qCoulomb", " ", "tsecond"}], 
         RowBox[{"EGeV", " ", "GeVTokg"}]], ")"}]}], "+", 
      RowBox[{"BTl", " ", "qCoulomb", " ", "x0m"}], "-", 
      RowBox[{"c", " ", "GeVTokg", " ", "pzGeV"}]}], 
     RowBox[{"BTl", " ", "qCoulomb"}]], ",", 
    RowBox[{
     FractionBox[
      RowBox[{"c", " ", "pyGeV", " ", "tsecond"}], "EGeV"], "+", "y0"}], ",", 
    FractionBox[
     RowBox[{
      RowBox[{"-", 
       RowBox[{"c", " ", "GeVTokg", " ", "pxGeV", " ", 
        RowBox[{"cos", "(", 
         FractionBox[
          RowBox[{"BTl", " ", "qCoulomb", " ", "tsecond"}], 
          RowBox[{"EGeV", " ", "GeVTokg"}]], ")"}]}]}], "+", 
      RowBox[{"c", " ", "GeVTokg", " ", "pzGeV", " ", 
       RowBox[{"sin", "(", 
        FractionBox[
         RowBox[{"BTl", " ", "qCoulomb", " ", "tsecond"}], 
         RowBox[{"EGeV", " ", "GeVTokg"}]], ")"}]}], "+", 
      RowBox[{"BTl", " ", "qCoulomb", " ", "z0"}], "+", 
      RowBox[{"c", " ", "GeVTokg", " ", "pxGeV"}]}], 
     RowBox[{"BTl", " ", "qCoulomb"}]]}], "}"}], TraditionalForm]], "Output",
 CellChangeTimes->{3.9156385923546815`*^9, 3.9156394599962053`*^9, 
  3.91564030148531*^9, 3.915641482164633*^9, 3.9156416946093917`*^9, 
  3.9156811612116528`*^9, 3.915681505964819*^9, 3.915685657999922*^9, 
  3.9157698829817095`*^9, 3.915770991744034*^9, 3.9157813490166173`*^9, 
  3.9157815944579873`*^9, 3.915787353594746*^9, 3.9158147524590297`*^9, 
  3.9158551909875236`*^9, 3.915857386346075*^9, 3.9158576524423504`*^9, 
  3.915859130878953*^9, 3.915863108164671*^9, 3.9158654211249847`*^9, 
  3.915867431316414*^9, 3.9158787687698884`*^9, 3.916126389974609*^9, 
  3.91612822915064*^9, 3.9176887103082867`*^9, 3.9190102755833473`*^9},
 CellLabel->
  "Out[540]=",ExpressionUUID->"dadffa63-9e5d-4284-b0b9-a350bd78870e"],

Cell[BoxData[
 FormBox["\<\"Velocities dx/dt, dy/dt, dz/dt:\"\>", TraditionalForm]], "Print",
 CellChangeTimes->{3.9156385923144894`*^9, 3.915639459955377*^9, 
  3.915640301443778*^9, 3.915641482126387*^9, 3.91564169456841*^9, 
  3.915681161169697*^9, 3.915681505948893*^9, 3.9156856579832497`*^9, 
  3.9157698829697094`*^9, 3.9157709917280345`*^9, 3.9157813490046716`*^9, 
  3.915781594422082*^9, 3.915787353587736*^9, 3.915814752427195*^9, 
  3.9158551909562826`*^9, 3.9158573863147974`*^9, 3.9158576524095235`*^9, 
  3.9158591308477077`*^9, 3.9158631081490498`*^9, 3.915865421117629*^9, 
  3.9158674312847605`*^9, 3.91587876872263*^9, 3.9161263899562645`*^9, 
  3.9161282291485643`*^9, 3.917688710284793*^9, 3.919010275585342*^9},
 CellLabel->
  "During evaluation of \
In[534]:=",ExpressionUUID->"40ad9396-ffb4-462e-901a-0c98400f09e8"],

Cell[BoxData[
 FormBox[
  RowBox[{"{", 
   RowBox[{
    FractionBox[
     RowBox[{"c", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"pxGeV", " ", 
         RowBox[{"cos", "(", 
          FractionBox[
           RowBox[{"BTl", " ", "qCoulomb", " ", "tsecond"}], 
           RowBox[{"EGeV", " ", "GeVTokg"}]], ")"}]}], "-", 
        RowBox[{"pzGeV", " ", 
         RowBox[{"sin", "(", 
          FractionBox[
           RowBox[{"BTl", " ", "qCoulomb", " ", "tsecond"}], 
           RowBox[{"EGeV", " ", "GeVTokg"}]], ")"}]}]}], ")"}]}], "EGeV"], 
    ",", 
    FractionBox[
     RowBox[{"c", " ", "pyGeV"}], "EGeV"], ",", 
    FractionBox[
     RowBox[{"c", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"pxGeV", " ", 
         RowBox[{"sin", "(", 
          FractionBox[
           RowBox[{"BTl", " ", "qCoulomb", " ", "tsecond"}], 
           RowBox[{"EGeV", " ", "GeVTokg"}]], ")"}]}], "+", 
        RowBox[{"pzGeV", " ", 
         RowBox[{"cos", "(", 
          FractionBox[
           RowBox[{"BTl", " ", "qCoulomb", " ", "tsecond"}], 
           RowBox[{"EGeV", " ", "GeVTokg"}]], ")"}]}]}], ")"}]}], "EGeV"]}], 
   "}"}], TraditionalForm]], "Output",
 CellChangeTimes->{3.9156385923546815`*^9, 3.9156394599962053`*^9, 
  3.91564030148531*^9, 3.915641482164633*^9, 3.9156416946093917`*^9, 
  3.9156811612116528`*^9, 3.915681505964819*^9, 3.915685657999922*^9, 
  3.9157698829817095`*^9, 3.915770991744034*^9, 3.9157813490166173`*^9, 
  3.9157815944579873`*^9, 3.915787353594746*^9, 3.9158147524590297`*^9, 
  3.9158551909875236`*^9, 3.915857386346075*^9, 3.9158576524423504`*^9, 
  3.915859130878953*^9, 3.915863108164671*^9, 3.9158654211249847`*^9, 
  3.915867431316414*^9, 3.9158787687698884`*^9, 3.916126389974609*^9, 
  3.91612822915064*^9, 3.9176887103082867`*^9, 3.9190102756123*^9},
 CellLabel->
  "Out[542]=",ExpressionUUID->"e0aabe16-6597-463d-bb1f-f1c65f797655"],

Cell[BoxData[
 FormBox["\<\"Momenta \\!\\(\\*SubscriptBox[\\(p\\), \\(i\\)]\\)(t) = E \
\\!\\(\\*SubscriptBox[\\(v\\), \
\\(i\\)]\\)(t)/\\!\\(\\*SuperscriptBox[\\(c\\), \\(2\\)]\\):\"\>", 
  TraditionalForm]], "Print",
 CellChangeTimes->{3.9156385923144894`*^9, 3.915639459955377*^9, 
  3.915640301443778*^9, 3.915641482126387*^9, 3.91564169456841*^9, 
  3.915681161169697*^9, 3.915681505948893*^9, 3.9156856579832497`*^9, 
  3.9157698829697094`*^9, 3.9157709917280345`*^9, 3.9157813490046716`*^9, 
  3.915781594422082*^9, 3.915787353587736*^9, 3.915814752427195*^9, 
  3.9158551909562826`*^9, 3.9158573863147974`*^9, 3.9158576524095235`*^9, 
  3.9158591308477077`*^9, 3.9158631081490498`*^9, 3.915865421117629*^9, 
  3.9158674312847605`*^9, 3.91587876872263*^9, 3.9161263899562645`*^9, 
  3.9161282291485643`*^9, 3.917688710284793*^9, 3.919010275615291*^9},
 CellLabel->
  "During evaluation of \
In[534]:=",ExpressionUUID->"1aff690f-c9a0-40ec-a3de-5e36466ffe5d"],

Cell[BoxData[
 FormBox[
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{"pxGeV", " ", 
      RowBox[{"cos", "(", 
       FractionBox[
        RowBox[{"BTl", " ", "qCoulomb", " ", "tsecond"}], 
        RowBox[{"EGeV", " ", "GeVTokg"}]], ")"}]}], "-", 
     RowBox[{"pzGeV", " ", 
      RowBox[{"sin", "(", 
       FractionBox[
        RowBox[{"BTl", " ", "qCoulomb", " ", "tsecond"}], 
        RowBox[{"EGeV", " ", "GeVTokg"}]], ")"}]}]}], ",", "pyGeV", ",", 
    RowBox[{
     RowBox[{"pxGeV", " ", 
      RowBox[{"sin", "(", 
       FractionBox[
        RowBox[{"BTl", " ", "qCoulomb", " ", "tsecond"}], 
        RowBox[{"EGeV", " ", "GeVTokg"}]], ")"}]}], "+", 
     RowBox[{"pzGeV", " ", 
      RowBox[{"cos", "(", 
       FractionBox[
        RowBox[{"BTl", " ", "qCoulomb", " ", "tsecond"}], 
        RowBox[{"EGeV", " ", "GeVTokg"}]], ")"}]}]}]}], "}"}], 
  TraditionalForm]], "Output",
 CellChangeTimes->{3.9156385923546815`*^9, 3.9156394599962053`*^9, 
  3.91564030148531*^9, 3.915641482164633*^9, 3.9156416946093917`*^9, 
  3.9156811612116528`*^9, 3.915681505964819*^9, 3.915685657999922*^9, 
  3.9157698829817095`*^9, 3.915770991744034*^9, 3.9157813490166173`*^9, 
  3.9157815944579873`*^9, 3.915787353594746*^9, 3.9158147524590297`*^9, 
  3.9158551909875236`*^9, 3.915857386346075*^9, 3.9158576524423504`*^9, 
  3.915859130878953*^9, 3.915863108164671*^9, 3.9158654211249847`*^9, 
  3.915867431316414*^9, 3.9158787687698884`*^9, 3.916126389974609*^9, 
  3.91612822915064*^9, 3.9176887103082867`*^9, 3.9190102756322174`*^9},
 CellLabel->
  "Out[544]=",ExpressionUUID->"b2265da1-bf56-44bc-ad6f-b8652fe70963"],

Cell[BoxData[
 FormBox["\<\"Cross-check: \\!\\(\\*SuperscriptBox[OverscriptBox[\\(v\\), \
\\(_\\)], \\(2\\)]\\)(t) = \\!\\(\\*SubscriptBox[SuperscriptBox[\\(v\\), \\(2\
\\)], \\(x\\)]\\)(t)+\\!\\(\\*SubscriptBox[SuperscriptBox[\\(v\\), \\(2\\)], \
\\(y\\)]\\)(t)+\\!\\(\\*SubscriptBox[SuperscriptBox[\\(v\\), \\(2\\)], \
\\(z\\)]\\)(t) is equal to \\!\\(\\*SuperscriptBox[\\(v\\), \\(2\\)]\\)(t = \
0) = \\!\\(\\*SubscriptBox[SuperscriptBox[\\(v\\), \\(2\\)], \\(x, \
0\\)]\\)+\\!\\(\\*SubscriptBox[SuperscriptBox[\\(v\\), \\(2\\)], \\(y, \
0\\)]\\)+\\!\\(\\*SubscriptBox[SuperscriptBox[\\(v\\), \\(2\\)], \\(z, \
0\\)]\\) = \\!\\(\\*SuperscriptBox[\\(c\\), \
\\(2\\)]\\)\\!\\(\\*SuperscriptBox[OverscriptBox[\\(p\\), \\(_\\)], \
\\(2\\)]\\)/\\!\\(\\*SuperscriptBox[\\(E\\), \\(2\\)]\\)\"\>", 
  TraditionalForm]], "Print",
 CellChangeTimes->{3.9156385923144894`*^9, 3.915639459955377*^9, 
  3.915640301443778*^9, 3.915641482126387*^9, 3.91564169456841*^9, 
  3.915681161169697*^9, 3.915681505948893*^9, 3.9156856579832497`*^9, 
  3.9157698829697094`*^9, 3.9157709917280345`*^9, 3.9157813490046716`*^9, 
  3.915781594422082*^9, 3.915787353587736*^9, 3.915814752427195*^9, 
  3.9158551909562826`*^9, 3.9158573863147974`*^9, 3.9158576524095235`*^9, 
  3.9158591308477077`*^9, 3.9158631081490498`*^9, 3.915865421117629*^9, 
  3.9158674312847605`*^9, 3.91587876872263*^9, 3.9161263899562645`*^9, 
  3.9161282291485643`*^9, 3.917688710284793*^9, 3.919010275634214*^9},
 CellLabel->
  "During evaluation of \
In[534]:=",ExpressionUUID->"ac63bc52-dd2e-4307-9035-c2fe47d5628b"],

Cell[BoxData[
 FormBox[
  FractionBox[
   RowBox[{
    SuperscriptBox["c", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["pxGeV", "2"], "+", 
      SuperscriptBox["pyGeV", "2"], "+", 
      SuperscriptBox["pzGeV", "2"]}], ")"}]}], 
   SuperscriptBox["EGeV", "2"]], TraditionalForm]], "Output",
 CellChangeTimes->{3.9156385923546815`*^9, 3.9156394599962053`*^9, 
  3.91564030148531*^9, 3.915641482164633*^9, 3.9156416946093917`*^9, 
  3.9156811612116528`*^9, 3.915681505964819*^9, 3.915685657999922*^9, 
  3.9157698829817095`*^9, 3.915770991744034*^9, 3.9157813490166173`*^9, 
  3.9157815944579873`*^9, 3.915787353594746*^9, 3.9158147524590297`*^9, 
  3.9158551909875236`*^9, 3.915857386346075*^9, 3.9158576524423504`*^9, 
  3.915859130878953*^9, 3.915863108164671*^9, 3.9158654211249847`*^9, 
  3.915867431316414*^9, 3.9158787687698884`*^9, 3.916126389974609*^9, 
  3.91612822915064*^9, 3.9176887103082867`*^9, 3.919010275637206*^9},
 CellLabel->
  "Out[546]=",ExpressionUUID->"9e1501ba-73c1-42d5-b99d-6bd2ea88a791"],

Cell[BoxData[
 FormBox["\<\"Larmor radius (in m):\"\>", TraditionalForm]], "Print",
 CellChangeTimes->{3.9156385923144894`*^9, 3.915639459955377*^9, 
  3.915640301443778*^9, 3.915641482126387*^9, 3.91564169456841*^9, 
  3.915681161169697*^9, 3.915681505948893*^9, 3.9156856579832497`*^9, 
  3.9157698829697094`*^9, 3.9157709917280345`*^9, 3.9157813490046716`*^9, 
  3.915781594422082*^9, 3.915787353587736*^9, 3.915814752427195*^9, 
  3.9158551909562826`*^9, 3.9158573863147974`*^9, 3.9158576524095235`*^9, 
  3.9158591308477077`*^9, 3.9158631081490498`*^9, 3.915865421117629*^9, 
  3.9158674312847605`*^9, 3.91587876872263*^9, 3.9161263899562645`*^9, 
  3.9161282291485643`*^9, 3.917688710284793*^9, 3.9190102756526756`*^9},
 CellLabel->
  "During evaluation of \
In[534]:=",ExpressionUUID->"8a7d1992-eb60-4d99-bdd0-f13d9ed05ff5"],

Cell[BoxData[
 FormBox[
  FractionBox[
   RowBox[{"3.4124999999999996`", " ", "EGeV"}], "BTl"], 
  TraditionalForm]], "Output",
 CellChangeTimes->{3.9156385923546815`*^9, 3.9156394599962053`*^9, 
  3.91564030148531*^9, 3.915641482164633*^9, 3.9156416946093917`*^9, 
  3.9156811612116528`*^9, 3.915681505964819*^9, 3.915685657999922*^9, 
  3.9157698829817095`*^9, 3.915770991744034*^9, 3.9157813490166173`*^9, 
  3.9157815944579873`*^9, 3.915787353594746*^9, 3.9158147524590297`*^9, 
  3.9158551909875236`*^9, 3.915857386346075*^9, 3.9158576524423504`*^9, 
  3.915859130878953*^9, 3.915863108164671*^9, 3.9158654211249847`*^9, 
  3.915867431316414*^9, 3.9158787687698884`*^9, 3.916126389974609*^9, 
  3.91612822915064*^9, 3.9176887103082867`*^9, 3.9190102756546707`*^9},
 CellLabel->
  "Out[553]=",ExpressionUUID->"8b231285-b8f9-4171-9bd8-fbbc2005d07b"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Approx expressions", "Subsubsection",
 CellChangeTimes->{{3.898699204110855*^9, 
  3.898699206168812*^9}},ExpressionUUID->"c86adca8-b666-4af8-9bf2-\
0ba78eb48425"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "The", " ", "minimal", " ", "value", " ", "of", " ", "momentum", " ", "at",
     " ", "which", " ", "the", " ", "trigonometric", " ", "functions", " ", 
    "may", " ", "be", " ", "replaced", " ", "with", " ", "their", " ", 
    "expansion"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"pzKickApprox", "[", 
      RowBox[{"BTl_", ",", "zprojm_", ",", "z0m_"}], "]"}], "=", 
     RowBox[{"Quiet", "[", 
      RowBox[{
       RowBox[{"pzGeV", "/.", 
        RowBox[{
         RowBox[{"Solve", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             FractionBox[
              RowBox[{"BTl", "*", "qValSI"}], "EGeV"], "*", 
             RowBox[{"tz0", "[", 
              RowBox[{
              "zprojm", ",", "z0m", ",", "cval", ",", "pzGeV", ",", "EGeV"}], 
              "]"}], 
             FractionBox["1", "GeVTokgVal"]}], "==", "0.2"}], ",", "pzGeV"}], 
          "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], "//", "Simplify"}], "]"}]}], ";"}],
    "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Expansions", " ", "of", " ", "the", " ", "coordinate", " ", "and", " ", 
     "momenta"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"xHelicalApproxTemp2", "[", 
      RowBox[{
      "x0m_", ",", "z0m_", ",", "pxGeV_", ",", "pzGeV_", ",", "BTl_", ",", 
       "qsign_", ",", "zprojm_"}], "]"}], "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Normal", "@", 
         RowBox[{"Series", "[", 
          RowBox[{
           RowBox[{"xHelicalTemp1", "[", 
            RowBox[{
            "x0m", ",", "pxGeV", ",", "pzGeV", ",", "EGeV", ",", "BTl", ",", 
             "qValSI", ",", "tsecond", ",", "GeVTokgVal"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"tsecond", ",", "0", ",", "2"}], "}"}]}], "]"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{"c", "->", "cval"}], "}"}]}], "/.", 
       RowBox[{"{", 
        RowBox[{"tsecond", "->", " ", 
         RowBox[{"tz0", "[", 
          RowBox[{
          "zprojm", ",", "z0m", ",", "cval", ",", "pzGeV", ",", "EGeV"}], 
          "]"}]}], "}"}]}], "//", "Simplify"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"zHelicalApproxTemp2", "[", 
      RowBox[{
      "z0m_", ",", "pxGeV_", ",", "pzGeV_", ",", "BTl_", ",", "qsign_", ",", 
       "zprojm_"}], "]"}], "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Normal", "@", 
         RowBox[{"Series", "[", 
          RowBox[{
           RowBox[{"zHelicalTemp1", "[", 
            RowBox[{
            "z0m", ",", "pxGeV", ",", "pzGeV", ",", "EGeV", ",", "BTl", ",", 
             RowBox[{"qValSI", "*", "qsign"}], ",", "tsecond", ",", 
             "GeVTokgVal"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"tsecond", ",", "0", ",", "2"}], "}"}]}], "]"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{"c", "->", "cval"}], "}"}]}], "/.", 
       RowBox[{"{", 
        RowBox[{"tsecond", "->", " ", 
         RowBox[{"tz0", "[", 
          RowBox[{
          "zprojm", ",", "z0m", ",", "cval", ",", "pzGeV", ",", "EGeV"}], 
          "]"}]}], "}"}]}], "//", "Simplify"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"pxHelicalApproxTemp2", "[", 
      RowBox[{
      "z0m_", ",", "pxGeV_", ",", "pzGeV_", ",", "BTl_", ",", "qsign_", ",", 
       "zprojm_"}], "]"}], "=", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"Normal", "@", 
         RowBox[{"Series", "[", 
          RowBox[{
           RowBox[{"pxHelicalTemp1", "[", 
            RowBox[{"pxGeV", ",", "pzGeV", ",", "BTl", ",", 
             RowBox[{"qValSI", "*", "qsign"}], ",", "tsecond", ",", 
             "GeVTokgVal"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"tsecond", ",", "0", ",", "1"}], "}"}]}], "]"}]}], ")"}], 
       "/.", 
       RowBox[{"{", 
        RowBox[{"tsecond", "->", " ", 
         RowBox[{"tz0", "[", 
          RowBox[{
          "zprojm", ",", "z0m", ",", "cval", ",", "pzGeV", ",", "EGeV"}], 
          "]"}]}], "}"}]}], "//", "Simplify"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"pzHelicalApproxTemp2", "[", 
      RowBox[{
      "z0m_", ",", "pxGeV_", ",", "pzGeV_", ",", "BTl_", ",", "qsign_", ",", 
       "zprojm_"}], "]"}], "=", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"Normal", "@", 
         RowBox[{"Series", "[", 
          RowBox[{
           RowBox[{"pzHelicalTemp1", "[", 
            RowBox[{"pxGeV", ",", "pzGeV", ",", "BTl", ",", 
             RowBox[{"qValSI", "*", "qsign"}], ",", "tsecond", ",", 
             "GeVTokgVal"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"tsecond", ",", "0", ",", "1"}], "}"}]}], "]"}]}], ")"}], 
       "/.", 
       RowBox[{"{", 
        RowBox[{"tsecond", "->", " ", 
         RowBox[{"tz0", "[", 
          RowBox[{
          "zprojm", ",", "z0m", ",", "cval", ",", "pzGeV", ",", "EGeV"}], 
          "]"}]}], "}"}]}], "//", "Simplify"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"pzHelicalApprox", "[", 
      RowBox[{
      "z0m_", ",", "pxGeV_", ",", "pzGeV_", ",", "BTl_", ",", "qsign_", ",", 
       "zprojm_"}], "]"}], "=", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"pzGeV", ">", 
        RowBox[{"pzKickApprox", "[", 
         RowBox[{"BTl", ",", "zprojm", ",", "z0m"}], "]"}]}], ",", 
       RowBox[{"Evaluate", "[", 
        RowBox[{"pzHelicalApproxTemp2", "[", 
         RowBox[{
         "z0m", ",", "pxGeV", ",", "pzGeV", ",", "BTl", ",", "qsign", ",", 
          "zprojm"}], "]"}], "]"}], ",", 
       RowBox[{"Evaluate", "[", 
        RowBox[{"pzHelicalTemp2", "[", 
         RowBox[{
         "z0m", ",", "pxGeV", ",", "pzGeV", ",", "BTl", ",", "qsign", ",", 
          "zprojm"}], "]"}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"pxHelicalApprox", "[", 
      RowBox[{
      "z0m_", ",", "pxGeV_", ",", "pzGeV_", ",", "BTl_", ",", "qsign_", ",", 
       "zprojm_"}], "]"}], "=", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"pzGeV", ">", 
        RowBox[{"pzKickApprox", "[", 
         RowBox[{"BTl", ",", "zprojm", ",", "z0m"}], "]"}]}], ",", 
       RowBox[{"Evaluate", "[", 
        RowBox[{"pxHelicalApproxTemp2", "[", 
         RowBox[{
         "z0m", ",", "pxGeV", ",", "pzGeV", ",", "BTl", ",", "qsign", ",", 
          "zprojm"}], "]"}], "]"}], ",", 
       RowBox[{"Evaluate", "[", 
        RowBox[{"pxHelicalTemp2", "[", 
         RowBox[{
         "z0m", ",", "pxGeV", ",", "pzGeV", ",", "BTl", ",", "qsign", ",", 
          "zprojm"}], "]"}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"xHelicalApprox", "[", 
      RowBox[{
      "x0m_", ",", "z0m_", ",", "pxGeV_", ",", "pzGeV_", ",", "BTl_", ",", 
       "qsign_", ",", "zprojm_"}], "]"}], "=", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"pzGeV", ">", 
        RowBox[{"pzKickApprox", "[", 
         RowBox[{"BTl", ",", "zprojm", ",", "z0m"}], "]"}]}], ",", 
       RowBox[{"Evaluate", "[", 
        RowBox[{"xHelicalApproxTemp2", "[", 
         RowBox[{
         "x0m", ",", "z0m", ",", "pxGeV", ",", "pzGeV", ",", "BTl", ",", 
          "qsign", ",", "zprojm"}], "]"}], "]"}], ",", 
       RowBox[{"Evaluate", "[", 
        RowBox[{"xHelicalTemp2", "[", 
         RowBox[{
         "x0m", ",", "z0m", ",", "pxGeV", ",", "pzGeV", ",", "BTl", ",", 
          "qsign", ",", "zprojm"}], "]"}], "]"}]}], "]"}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.8986992098236685`*^9, 3.898699270769168*^9}, {
  3.8986993624704514`*^9, 3.898699753914085*^9}, {3.8986998019339123`*^9, 
  3.898699905581258*^9}, {3.8987000863441525`*^9, 3.8987002575821333`*^9}, {
  3.9515554755155983`*^9, 3.95155547858922*^9}},
 CellLabel->
  "In[244]:=",ExpressionUUID->"e8ab0043-e9a1-41b4-b797-4c6c5b631938"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Pre-definitions", "Section",
 CellChangeTimes->{{3.8913232134212017`*^9, 
  3.8913232154204464`*^9}},ExpressionUUID->"9f7d2cd2-1d3c-45ce-8997-\
9a78ca960c9c"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Consider", " ", "the", " ", "table", " ", 
     SubscriptBox["E", "LLP"]}], ",", 
    SubscriptBox["\[Theta]", "LLP"], ",", 
    SubscriptBox["z", "LLP"], ",", 
    SubscriptBox["\[Epsilon]", "az"], ",", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        SubscriptBox["\[Phi]", "LLP"], ".", " ", "The"}], " ", "compiled", 
       " ", "code", " ", "below", " ", "removes", " ", "rows", " ", "for", 
       " ", "which", " ", 
       SubscriptBox["E", "LLP"]}], " ", "<", " ", 
      RowBox[{
       SubscriptBox["m", "LLP"], " ", "or", " ", 
       SubscriptBox["\[Epsilon]", "azimuthal"]}]}], " ", "=", " ", "0"}]}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"TableLLPnonZeroCompiled", "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Hold", "@", 
        RowBox[{"Compile", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"TableLLPgridWithELLP", ",", "_Real", ",", "2"}], "}"}], 
            ",", 
            RowBox[{"{", 
             RowBox[{"mLLP", ",", "_Real"}], "}"}]}], "}"}], ",", 
          RowBox[{"Select", "[", 
           RowBox[{"TableLLPgridWithELLP", ",", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"#", "[", 
                RowBox[{"[", "indexELLP", "]"}], "]"}], ">", "mLLP"}], "&&", 
              RowBox[{
               RowBox[{"#", "[", 
                RowBox[{"[", "indexLLPazAcc", "]"}], "]"}], "\[NotEqual]", 
               "0."}]}], "&"}]}], "]"}], ",", 
          RowBox[{"CompilationTarget", "\[Rule]", "\"\<C\>\""}], ",", 
          RowBox[{"RuntimeOptions", "\[Rule]", "\"\<Speed\>\""}]}], "]"}]}], "/.", 
       RowBox[{"OwnValues", "@", "indexELLP"}]}], "/.", 
      RowBox[{"OwnValues", "@", "indexLLPazAcc"}]}], "//", "ReleaseHold"}]}], 
   ";", "\[IndentingNewLine]", 
   RowBox[{"TableLLPzeroCompiled", "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Hold", "@", 
        RowBox[{"Compile", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"TableLLPgridWithELLP", ",", "_Real", ",", "2"}], "}"}], 
            ",", 
            RowBox[{"{", 
             RowBox[{"mLLP", ",", "_Real"}], "}"}]}], "}"}], ",", 
          RowBox[{"Select", "[", 
           RowBox[{"TableLLPgridWithELLP", ",", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"#", "[", 
                RowBox[{"[", "indexELLP", "]"}], "]"}], "\[LessEqual]", 
               "mLLP"}], "||", 
              RowBox[{
               RowBox[{"#", "[", 
                RowBox[{"[", "indexLLPazAcc", "]"}], "]"}], "\[Equal]", 
               "0."}]}], "&"}]}], " ", "]"}], ",", 
          RowBox[{"CompilationTarget", "\[Rule]", "\"\<C\>\""}], ",", 
          RowBox[{"RuntimeOptions", "\[Rule]", "\"\<Speed\>\""}]}], "]"}]}], "/.", 
       RowBox[{"OwnValues", "@", "indexELLP"}]}], "/.", 
      RowBox[{"OwnValues", "@", "indexLLPazAcc"}]}], "//", "ReleaseHold"}]}], 
   ";", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Consider", " ", "a", " ", "table", " ", "of", " ", 
      SubscriptBox["\[Epsilon]", "decay"]}], ",", " ", 
     RowBox[{
     "where", " ", "each", " ", "NofPhiVals", " ", "values", " ", 
      "correspond", " ", "to", " ", "the", " ", "same", " ", 
      SubscriptBox["E", "LLP"]}], ",", 
     SubscriptBox["\[Theta]", "LLP"], ",", 
     RowBox[{
      SubscriptBox["z", "LLP"], " ", "but", " ", "to", " ", "different", " ", 
      RowBox[{
       SubscriptBox["\[Phi]", "LLP"], ".", " ", "The"}], " ", "compiled", " ",
       "code", " ", "below", " ", "averages", " ", "over", " ", "\[Phi]"}]}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{"\[Epsilon]DecayE\[Theta]zcompiled", "=", 
    RowBox[{
     RowBox[{"Hold", "@", 
      RowBox[{"Compile", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "DecayAcceptanceE\[Theta]z\[Phi]", ",", "_Real", ",", "2"}], "}"}],
           ",", 
          RowBox[{"{", 
           RowBox[{"NofPhiVals", ",", "_Integer"}], "}"}]}], "}"}], ",", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "/", "NofPhiVals"}], ")"}], 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"Sum", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"DecayAcceptanceE\[Theta]z\[Phi]", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"i0", "-", "1"}], ")"}], "*", "NofPhiVals"}], "+", 
                 "1"}], ",", 
                RowBox[{"i0", "*", "NofPhiVals"}]}], "}"}]}], "]"}], "}"}], 
           ",", 
           RowBox[{"{", 
            RowBox[{"i0", ",", "1", ",", 
             RowBox[{
              RowBox[{"Length", "[", "DecayAcceptanceE\[Theta]z\[Phi]", "]"}],
               "/", "NofPhiVals"}], ",", "1"}], "}"}]}], "]"}]}], ",", 
        RowBox[{"CompilationTarget", "\[Rule]", "\"\<C\>\""}], ",", 
        RowBox[{"RuntimeOptions", "\[Rule]", "\"\<Speed\>\""}]}], "]"}]}], "//",
      "ReleaseHold"}]}], ";", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "This", " ", "code", " ", "averages", " ", "the", " ", "decay", " ", 
     "acceptance", " ", "over", " ", "the", " ", "domains", " ", "where", " ",
      "the", " ", "LLP", " ", 
     RowBox[{"points", "/", "does"}], " ", "not", " ", "point", " ", "to", 
     " ", "the", " ", "detector"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"\[Epsilon]dec1Compiled", "=", "  ", 
    RowBox[{"Compile", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"tabToDet", ",", "_Real", ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"tabNotToDet", ",", "_Real", ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"mLLP", ",", "_Real"}], "}"}]}], "}"}], ",", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "angles", ",", "energies", ",", "zs", ",", "\[Epsilon]azToDet", ",", 
          "\[Epsilon]azNotToDet", ",", "\[Epsilon]DecToDet", ",", 
          "\[Epsilon]DecNotToDet", ",", "\[Epsilon]DecAv"}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"angles", "=", 
          RowBox[{"Compile`GetElement", "[", 
           RowBox[{"tabToDet", ",", "1"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"energies", "=", 
          RowBox[{"Compile`GetElement", "[", 
           RowBox[{"tabToDet", ",", "2"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"zs", "=", 
          RowBox[{"Compile`GetElement", "[", 
           RowBox[{"tabToDet", ",", "3"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"\[Epsilon]azToDet", "=", 
          RowBox[{"Compile`GetElement", "[", 
           RowBox[{"tabToDet", ",", "4"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"\[Epsilon]azNotToDet", "=", 
          RowBox[{"Compile`GetElement", "[", 
           RowBox[{"tabNotToDet", ",", "4"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"\[Epsilon]DecToDet", "=", 
          RowBox[{"Compile`GetElement", "[", 
           RowBox[{"tabToDet", ",", "5"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"\[Epsilon]DecNotToDet", "=", 
          RowBox[{"Compile`GetElement", "[", 
           RowBox[{"tabNotToDet", ",", "5"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"\[Epsilon]DecAv", "=", 
          RowBox[{
           FractionBox[
            RowBox[{
             RowBox[{"\[Epsilon]azToDet", "*", "\[Epsilon]DecToDet"}], "+", 
             RowBox[{"\[Epsilon]azNotToDet", "*", "\[Epsilon]DecNotToDet"}]}], 
            RowBox[{"\[Epsilon]azToDet", "+", "\[Epsilon]azNotToDet", "+", 
             SuperscriptBox["10", 
              RowBox[{"-", "90."}]]}]], "+", 
           SuperscriptBox["10", 
            RowBox[{"-", "90."}]]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"mLLP", ",", "angles", ",", "energies", ",", "zs", ",", 
           RowBox[{"\[Epsilon]azToDet", "+", "\[Epsilon]azNotToDet"}], ",", 
           "\[Epsilon]DecAv"}], "}"}]}]}], "]"}], ",", 
      RowBox[{"CompilationTarget", "\[Rule]", "\"\<C\>\""}], ",", 
      RowBox[{"RuntimeOptions", "\[Rule]", "\"\<Speed\>\""}], ",", 
      RowBox[{"RuntimeAttributes", "\[Rule]", 
       RowBox[{"{", "Listable", "}"}]}]}], "]"}]}], ";", 
   "\[IndentingNewLine]", 
   RowBox[{"\[Epsilon]dec2Compiled", "=", 
    RowBox[{"Compile", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"tabToDet", ",", "_Real", ",", "2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"mLLP", ",", "_Real"}], "}"}]}], "}"}], ",", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", "mLLP", "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"Length", "[", "tabToDet", "]"}], ",", "1"}], "}"}]}], 
         "]"}], ",", "tabToDet", ",", "2"}], "]"}], ",", 
      RowBox[{"CompilationTarget", "\[Rule]", "\"\<C\>\""}], ",", 
      RowBox[{"RuntimeOptions", "\[Rule]", "\"\<Speed\>\""}]}], "]"}]}], 
   ";"}], "*)"}]], "Input",
 CellChangeTimes->{{3.891323425613412*^9, 3.8913234262407055`*^9}, {
   3.8913238399582214`*^9, 3.891323847526287*^9}, {3.8913255785192947`*^9, 
   3.8913255788075237`*^9}, 3.892400433217348*^9, {3.8924013129987416`*^9, 
   3.8924013721111608`*^9}, {3.892401432446088*^9, 3.8924014438053293`*^9}, {
   3.8929706737534137`*^9, 3.8929706747731624`*^9}, {3.893126737081957*^9, 
   3.8931267460222306`*^9}, {3.8931269128161592`*^9, 3.893126916228994*^9}, {
   3.8931269750473337`*^9, 3.893126975982995*^9}, {3.8931278765726953`*^9, 
   3.893127943544958*^9}, {3.893170202893709*^9, 3.893170235634016*^9}, {
   3.8931729550715637`*^9, 3.8931729702153053`*^9}, 3.8932167659281693`*^9, {
   3.893238826855266*^9, 3.893238827422778*^9}, {3.893238990503442*^9, 
   3.8932390173268595`*^9}, {3.893307112327159*^9, 3.893307112797879*^9}, {
   3.893349249828478*^9, 3.8933492768123436`*^9}, 3.8934168965127287`*^9, {
   3.8934367655490627`*^9, 3.893436765768009*^9}, {3.893492304771756*^9, 
   3.8934923048211656`*^9}, {3.8935148575886617`*^9, 
   3.8935149747260275`*^9}, {3.8966856378196077`*^9, 
   3.8966856403378763`*^9}, {3.897464879906437*^9, 3.8974648916145506`*^9}, {
   3.89849745254428*^9, 3.8984975200755043`*^9}, {3.89849783093812*^9, 
   3.8984978327617855`*^9}, {3.89849789911205*^9, 3.898497905651516*^9}, {
   3.89849804302676*^9, 3.89849808310581*^9}, {3.9028082791832495`*^9, 
   3.90280831262866*^9}, {3.902808353472077*^9, 3.902808403915349*^9}, {
   3.9028085887704525`*^9, 3.902808594663042*^9}, {3.902909485630412*^9, 
   3.9029095029209323`*^9}, {3.905010040087011*^9, 3.9050100816397285`*^9}, {
   3.9050598962772408`*^9, 3.9050599381033163`*^9}, {3.9050599715634604`*^9, 
   3.9050599740271473`*^9}, {3.9050603739496737`*^9, 3.905060395788929*^9}, {
   3.9053981266474476`*^9, 3.905398127386133*^9}, 3.907406782241393*^9, {
   3.912151266790866*^9, 3.9121512764128575`*^9}, {3.9149188969726925`*^9, 
   3.9149188983672924`*^9}, {3.9149200874903536`*^9, 3.914920089295472*^9}, {
   3.91492035491601*^9, 3.914920362850228*^9}, {3.9149482459680758`*^9, 
   3.9149482488357863`*^9}, {3.9154371514767675`*^9, 3.915437151611869*^9}, {
   3.9176887020290704`*^9, 3.9176887044779253`*^9}},
 CellLabel->"In[37]:=",ExpressionUUID->"81a42d38-67b7-45c9-ba7d-7dd464bf7b31"],

Cell[CellGroupData[{

Cell["Kinematic variables used for imposing cuts", "Subsection",
 CellChangeTimes->{{3.8931702432138014`*^9, 3.8931702435906425`*^9}, {
  3.8934366714771786`*^9, 3.8934366726381407`*^9}, {3.9161264470186653`*^9, 
  3.9161264567450504`*^9}},ExpressionUUID->"8d6d3c37-fa52-4138-9634-\
51c566617a6c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"IP", " ", "cut"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Consider", " ", "two", " ", "particles", " ", "originating", " ", "from", 
    " ", "the", " ", "same", " ", "point", " ", 
    RowBox[{
     SubscriptBox["r", "prod"], ".", " ", "Their"}], " ", "trajectory", " ", 
    "is", " ", "given", " ", "by", " ", "the", " ", "formula", " ", "below"}],
    "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"TrajectoryProducts", "[", 
      RowBox[{
      "xprod_", ",", "yprod_", ",", "zprod_", ",", "px1_", ",", "px2_", ",", 
       "py1_", ",", "py2_", ",", "pz1_", ",", "pz2_", ",", "zproj_"}], "]"}], 
     "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"xprod", "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"zproj", "-", "zprod"}], ")"}], "*", 
         FractionBox[
          RowBox[{"(", 
           RowBox[{"px1", "+", "px2"}], ")"}], 
          RowBox[{"pz1", "+", "pz2"}]]}]}], ",", 
       RowBox[{"yprod", "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"zproj", "-", "zprod"}], ")"}], "*", 
         FractionBox[
          RowBox[{"(", 
           RowBox[{"py1", "+", "py2"}], ")"}], 
          RowBox[{"pz1", "+", "pz2"}]]}]}], ",", "zproj"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Transverse", " ", "impact", " ", "parameter"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"IPproductsSquared", "[", 
      RowBox[{
      "xprod_", ",", "yprod_", ",", "zprod_", ",", "px1_", ",", "px2_", ",", 
       "py1_", ",", "py2_", ",", "pz1_", ",", "pz2_", ",", "zproj_"}], "]"}], 
     "=", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{
         SuperscriptBox[
          RowBox[{
           RowBox[{"TrajectoryProducts", "[", 
            RowBox[{
            "xprod", ",", "yprod", ",", "zprod", ",", "px1", ",", "px2", ",", 
             "py1", ",", "py2", ",", "pz1", ",", "pz2", ",", "zproj"}], "]"}],
            "[", 
           RowBox[{"[", "1", "]"}], "]"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{
           RowBox[{"TrajectoryProducts", "[", 
            RowBox[{
            "xprod", ",", "yprod", ",", "zprod", ",", "px1", ",", "px2", ",", 
             "py1", ",", "py2", ",", "pz1", ",", "pz2", ",", "zproj"}], "]"}],
            "[", 
           RowBox[{"[", "2", "]"}], "]"}], "2"]}], "//", "Expand"}], "//", 
       "Simplify"}], ")"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"IPproductzTargetSquared", "[", 
      RowBox[{
      "xprod_", ",", "yprod_", ",", "zprod_", ",", "px1_", ",", "px2_", ",", 
       "py1_", ",", "py2_", ",", "pz1_", ",", "pz2_"}], "]"}], "=", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"IPproductsSquared", "[", 
        RowBox[{
        "xprod", ",", "yprod", ",", "zprod", ",", "px1", ",", "px2", ",", 
         "py1", ",", "py2", ",", "pz1", ",", "pz2", ",", "0"}], "]"}], "2"], "//",
       "Simplify"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Spatial", " ", "separation", " ", 
     RowBox[{"cut", ":", " ", 
      RowBox[{"for", " ", "photons"}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"TrajectoryDifferenceProducts", "[", 
      RowBox[{
      "xprod_", ",", "yprod_", ",", "zprod_", ",", "px1_", ",", "px2_", ",", 
       "py1_", ",", "py2_", ",", "pz1_", ",", "pz2_", ",", "CoordProj_"}], 
      "]"}], "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"CoordProj", "-", "zprod"}], ")"}], "*", 
         FractionBox["px1", "pz1"]}], "-", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"CoordProj", "-", "zprod"}], ")"}], "*", 
         FractionBox["px2", "pz2"]}]}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"CoordProj", "-", "zprod"}], ")"}], "*", 
         FractionBox["py1", "pz1"]}], "-", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"CoordProj", "-", "zprod"}], ")"}], "*", 
         FractionBox["py2", "pz2"]}]}], ",", "0"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "For", " ", "the", " ", "experiments", " ", "for", " ", "which", " ", 
      "the", " ", "decay", " ", "volume", " ", "is", " ", "detector"}], ",", 
     " ", 
     RowBox[{
     "the", " ", "ECAL", " ", "position", " ", "is", " ", "formally", " ", 
      "assumed", " ", "to", " ", "be", " ", "at", " ", "the", " ", "end", " ",
       "of", " ", "the", " ", "decay", " ", "volume"}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ecalpos", "=", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
       "DecayVolumeAsDetectorGivenExperiment", "\[Equal]", "\"\<False\>\""}], 
       ",", "ECALpositionGivenExperiment", ",", 
       "xLongMaxDetectorGivenExperiment"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"SSproductsSquaredOld", "[", 
      RowBox[{
      "zprod_", ",", "px1_", ",", "px2_", ",", "py1_", ",", "py2_", ",", 
       "pz1_", ",", "pz2_", ",", "zproj_"}], "]"}], "=", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{
         SuperscriptBox[
          RowBox[{
           RowBox[{"TrajectoryDifferenceProducts", "[", 
            RowBox[{
            "xprod", ",", "yprod", ",", "zprod", ",", "px1", ",", "px2", ",", 
             "py1", ",", "py2", ",", "pz1", ",", "pz2", ",", "zproj"}], "]"}],
            "[", 
           RowBox[{"[", "1", "]"}], "]"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{
           RowBox[{"TrajectoryDifferenceProducts", "[", 
            RowBox[{
            "xprod", ",", "yprod", ",", "zprod", ",", "px1", ",", "px2", ",", 
             "py1", ",", "py2", ",", "pz1", ",", "pz2", ",", "zproj"}], "]"}],
            "[", 
           RowBox[{"[", "2", "]"}], "]"}], "2"]}], "//", "Expand"}], "//", 
       "Simplify"}], ")"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"SSproductsSquared", "[", 
      RowBox[{"xfin1_", ",", "xfin2_", ",", "yfin1_", ",", "yfin2_"}], "]"}], 
     "=", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"xfin1", "-", "xfin2"}], ")"}], "2"], "+", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"yfin1", "-", "yfin2"}], ")"}], "2"]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"minvProductsSquared", "[", 
      RowBox[{
      "px1_", ",", "py1_", ",", "pz1_", ",", "E1_", ",", "px2_", ",", "py2_", 
       ",", "pz2_", ",", "E2_"}], "]"}], "=", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"E1", "+", "E2"}], ")"}], "2"], "-", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"px1", "+", "px2"}], ")"}], "2"], "-", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"py1", "+", "py2"}], ")"}], "2"], "-", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"pz1", "+", "pz2"}], ")"}], "2"]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"CosAngleProducts", "[", 
      RowBox[{
      "px1_", ",", "px2_", ",", "py1_", ",", "py2_", ",", "pz1_", ",", 
       "pz2_"}], "]"}], "=", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"p1", "=", 
          RowBox[{"{", 
           RowBox[{"px1", ",", "py1", ",", "pz1"}], "}"}]}], ",", 
         RowBox[{"p2", "=", 
          RowBox[{"{", 
           RowBox[{"px2", ",", "py2", ",", "pz2"}], "}"}]}]}], "}"}], ",", 
       FractionBox[
        RowBox[{"p1", ".", "p2"}], 
        RowBox[{
         RowBox[{"Norm", "[", "p1", "]"}], 
         RowBox[{"Norm", "[", "p2", "]"}]}]]}], "]"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.8933071952438316`*^9, 3.8933072032734623`*^9}, {
   3.8933074175295415`*^9, 3.893307434409528*^9}, {3.893307473098591*^9, 
   3.8933076920095034`*^9}, {3.8933077664095755`*^9, 3.893307813369112*^9}, {
   3.8933078933257732`*^9, 3.893307989519503*^9}, {3.893308142483653*^9, 
   3.893308315464196*^9}, {3.8933493197384043`*^9, 3.8933493199088306`*^9}, {
   3.893351168661603*^9, 3.8933511697337036`*^9}, {3.893385684282936*^9, 
   3.893385697900014*^9}, {3.893385832620135*^9, 3.893385839988839*^9}, {
   3.8933858732988167`*^9, 3.89338587598905*^9}, 3.893386094920165*^9, {
   3.8933867351629553`*^9, 3.8933867748254848`*^9}, {3.893386806678708*^9, 
   3.893386808478114*^9}, {3.8933868593890333`*^9, 3.8933868596480465`*^9}, 
   3.89339137759552*^9, {3.8934020326953444`*^9, 3.893402033553975*^9}, {
   3.8934021208059835`*^9, 3.8934021209381385`*^9}, {3.8934021777401266`*^9, 
   3.8934023413799915`*^9}, {3.893403069106703*^9, 3.8934031051278195`*^9}, {
   3.89342542261907*^9, 3.893425436031149*^9}, {3.8934270687581086`*^9, 
   3.8934271848120565`*^9}, {3.893427836860332*^9, 3.893427884192929*^9}, {
   3.893519495798237*^9, 3.8935195906546307`*^9}, {3.9055135347919893`*^9, 
   3.905513581143739*^9}, 3.910246320784568*^9, {3.9149936594716187`*^9, 
   3.914993734330103*^9}, {3.918664951791253*^9, 3.918664959237224*^9}, {
   3.9190103510520253`*^9, 3.919010403046818*^9}},
 CellLabel->"In[38]:=",ExpressionUUID->"09dfabe2-92c3-495a-9593-b813ce33c544"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Routine of calculating the decay acceptance", "Section",
 CellChangeTimes->{{3.891323732291453*^9, 3.89132374118683*^9}, {
   3.891323823354575*^9, 3.8913238234662757`*^9}, {3.893436795887788*^9, 
   3.8934368016086535`*^9}, 
   3.893436831726281*^9},ExpressionUUID->"f5d42416-0563-43ca-b5d5-\
8d454d305ff8"],

Cell[CellGroupData[{

Cell["Trajectory of the decay products", "Subsection",
 CellChangeTimes->{{3.898614789891785*^9, 3.898614820307907*^9}, 
   3.90553199482168*^9},ExpressionUUID->"045ec994-987a-453d-9df8-\
924e58feae6c"],

Cell[CellGroupData[{

Cell["No magnetic field", "Subsubsection",
 CellChangeTimes->{{3.8986148284352465`*^9, 
  3.898614831554184*^9}},ExpressionUUID->"ee020017-ea44-4e2a-878a-\
71d6154738b7"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"FinalPlaneSign", "=", 
   RowBox[{"Sign", "[", "xLongMaxDetectorGivenExperiment", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MomDirection", "[", 
     RowBox[{"py_", ",", "pz_"}], "]"}], "=", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
      "DetectorPlaneOrientationGivenExperiment", "\[Equal]", 
       "\"\<Transverse\>\""}], ",", "pz", ",", "py"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"LLP", "'"}], "s", " ", "decay", " ", "poing", " ", "as", " ", 
     "a", " ", "function", " ", "of", " ", "z"}], ",", "\[Theta]", ",", 
    "\[Phi]"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"LLPdecayVertex", "[", 
      RowBox[{"zLLP_", ",", "\[Theta]LLP_", ",", "\[Phi]LLP_"}], "]"}], "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"LLPdecVTXatGivenZx", "[", 
        RowBox[{"zLLP", ",", "\[Theta]LLP", ",", "\[Phi]LLP"}], "]"}], ",", 
       RowBox[{"LLPdecVTXatGivenZy", "[", 
        RowBox[{"zLLP", ",", "\[Theta]LLP", ",", "\[Phi]LLP"}], "]"}], ",", 
       "zLLP"}], "}"}]}], ";"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"LLPdecayVertexX", "[", 
    RowBox[{"zLLP_", ",", "\[Theta]LLP_", ",", "\[Phi]LLP_"}], "]"}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"LLPdecVTXatGivenZx", "[", 
       RowBox[{"zLLP", ",", "\[Theta]LLP", ",", "\[Phi]LLP"}], "]"}], "/.", 
      " ", 
      RowBox[{
       RowBox[{"Cot", "[", "x_", "]"}], ":>", 
       RowBox[{"1", "/", 
        RowBox[{"Tan", "[", "x", "]"}]}]}]}], "/.", " ", 
     RowBox[{
      RowBox[{"Csc", "[", "x_", "]"}], ":>", 
      RowBox[{"1", "/", 
       RowBox[{"Sin", "[", "x", "]"}]}]}]}], "/.", 
    RowBox[{
     RowBox[{"Sec", "[", "x_", "]"}], "\[RuleDelayed]", 
     RowBox[{"1", "/", 
      RowBox[{"Cos", "[", "x", "]"}]}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"LLPdecayVertexY", "[", 
    RowBox[{"zLLP_", ",", "\[Theta]LLP_", ",", "\[Phi]LLP_"}], "]"}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"LLPdecVTXatGivenZy", "[", 
       RowBox[{"zLLP", ",", "\[Theta]LLP", ",", "\[Phi]LLP"}], "]"}], "/.", 
      " ", 
      RowBox[{
       RowBox[{"Cot", "[", "x_", "]"}], ":>", 
       RowBox[{"1", "/", 
        RowBox[{"Tan", "[", "x", "]"}]}]}]}], "/.", " ", 
     RowBox[{
      RowBox[{"Csc", "[", "x_", "]"}], ":>", 
      RowBox[{"1", "/", 
       RowBox[{"Sin", "[", "x", "]"}]}]}]}], "/.", 
    RowBox[{
     RowBox[{"Sec", "[", "x_", "]"}], "\[RuleDelayed]", 
     RowBox[{"1", "/", 
      RowBox[{"Cos", "[", "x", "]"}]}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"LLPdecayVertexZ", "[", 
    RowBox[{"zLLP_", ",", "\[Theta]LLP_", ",", "\[Phi]LLP_"}], "]"}], "=", 
   "zLLP"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"GivenExperiment", "!=", "\"\<ANUBIS-ceiling\>\""}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Trajectory", " ", "of", " ", "the", " ", 
      RowBox[{"daughter", "'"}], "s", " ", "particles", " ", "given", " ", 
      "the", " ", "LLP", " ", "decay", " ", "position", " ", "and", " ", 
      "the", " ", 
      RowBox[{"daughter", "'"}], "s", " ", "3"}], "-", 
     RowBox[{
     "momenta", " ", "in", " ", "the", " ", "lab", " ", "frame", " ", "of", 
      " ", "the", " ", "decaying", " ", "LLP"}], " ", "-", " ", 
     RowBox[{
     "at", " ", "the", " ", "position", " ", "of", " ", "the", " ", "final", 
      " ", "plane", " ", "of", " ", "the", " ", "detector"}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"DaughterTrajectory", "[", 
     RowBox[{
     "xLLPdecay_", ",", "yLLPdecay_", ",", "zLLPdecay_", ",", "XlongProj_", 
      ",", "px_", ",", "py_", ",", "pz_"}], "]"}], "=", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
      "DetectorPlaneOrientationGivenExperiment", "\[Equal]", 
       "\"\<Transverse\>\""}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"xLLPdecay", "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"XlongProj", "-", "zLLPdecay"}], ")"}], 
          RowBox[{"(", 
           RowBox[{"px", "/", "pz"}], ")"}]}]}], ",", 
        RowBox[{"yLLPdecay", "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"XlongProj", "-", "zLLPdecay"}], ")"}], 
          RowBox[{"(", 
           RowBox[{"py", "/", "pz"}], ")"}]}]}], ",", "XlongProj"}], "}"}], 
      ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"xLLPdecay", "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"XlongProj", "-", "yLLPdecay"}], ")"}], 
          RowBox[{"(", 
           RowBox[{"px", "/", "py"}], ")"}]}]}], ",", "XlongProj", ",", 
        RowBox[{"zLLPdecay", "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"XlongProj", "-", "yLLPdecay"}], ")"}], 
          RowBox[{"(", 
           RowBox[{"pz", "/", "py"}], ")"}]}]}]}], "}"}]}], "]"}]}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "___", "___", "___", "___", "___", "___", "___", "___", "___", "___", 
     "___", "___", "___", "___", "_"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "Projection", " ", "of", " ", "the", " ", "decay", " ", "products", " ", 
      "trajectory", " ", "onto", " ", "the", " ", "detector", " ", "final", 
      " ", "surface"}], " ", "-", " ", 
     RowBox[{"for", " ", "ANUBIS"}], "-", "ceiling"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "___", "___", "___", "___", "___", "___", "___", "___", "___", "___", 
     "___", "___", "___", "___", "_"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"xx", "[", 
      RowBox[{"x0_", ",", "vx_", ",", "t_"}], "]"}], "=", 
     RowBox[{"x0", "+", 
      RowBox[{"vx", "*", "t"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"yy", "[", 
      RowBox[{"y0_", ",", "vy_", ",", "t_"}], "]"}], "=", 
     RowBox[{"y0", "+", 
      RowBox[{"vy", "*", "t"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"zz", "[", 
      RowBox[{"z0_", ",", "vz_", ",", "t_"}], "]"}], "=", 
     RowBox[{"z0", "+", 
      RowBox[{"vz", "*", "t"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{
      "The", " ", "condition", " ", "that", " ", "the", " ", "trajectory", 
       " ", "intersects", " ", "the", " ", "surface", " ", "of", " ", "the", 
       " ", 
       RowBox[{"cavern", ".", " ", "Here"}]}], ",", " ", "xshift", ",", " ", 
      RowBox[{
      "yshift", " ", "are", " ", "just", " ", "the", " ", "shiftings", " ", 
       "of", " ", "the", " ", "beamline", " ", "from", " ", "the", " ", 
       "center", " ", "of", " ", "the", " ", "cavern", " ", "where", " ", 
       "ATLAS", " ", "is", " ", "located"}]}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"rho2", "[", 
      RowBox[{
      "x0_", ",", "y0_", ",", "vx_", ",", "vy_", ",", "t_", ",", "xshift_", 
       ",", "yshift_"}], "]"}], "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"xx", "[", 
            RowBox[{"x0", ",", "vx", ",", "t"}], "]"}], "+", "xshift"}], 
          ")"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"yy", "[", 
            RowBox[{"y0", ",", "vy", ",", "t"}], "]"}], "+", "yshift"}], 
          ")"}], "2"]}], "//", "Expand"}], "//", "Simplify"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
     "The", " ", "moment", " ", "of", " ", "time", " ", "at", " ", "which", 
      " ", "the", " ", "trajectory", " ", "intersects", " ", "the", " ", 
      "surface", " ", "of", " ", "the", " ", "cavern"}], "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"tsol", "[", 
      RowBox[{
      "x0_", ",", "y0_", ",", "vx_", ",", "vy_", ",", "\[Rho]det_", ",", 
       "xshift_", ",", "yshift_"}], "]"}], "=", 
     RowBox[{"t", "/.", 
      RowBox[{"Solve", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"rho2", "[", 
          RowBox[{
          "x0", ",", "y0", ",", "vx", ",", "vy", ",", "t", ",", "xshift", ",",
            "yshift"}], "]"}], "==", 
         SuperscriptBox["\[Rho]det", "2"]}], ",", "t"}], "]"}]}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
     "The", " ", "values", " ", "of", " ", "the", " ", "coordinates", " ", 
      "of", " ", "the", " ", "decay", " ", "product", " ", "at", " ", "this", 
      " ", "moment", " ", "of", " ", "time"}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"DaughterTrajectory", "[", 
      RowBox[{
      "xLLPdecay_", ",", "yLLPdecay_", ",", "zLLPdecay_", ",", "XlongProj_", 
       ",", "px_", ",", "py_", ",", "pz_"}], "]"}], "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"xx", "[", 
          RowBox[{"xLLPdecay", ",", "px", ",", 
           RowBox[{
            RowBox[{"tsol", "[", 
             RowBox[{"xLLPdecay", ",", "yLLPdecay", ",", "px", ",", "py", ",", 
              RowBox[{"RouterDecayVolumeGivenExperiment", "[", "z", "]"}], 
              ",", "xshiftval", ",", "yshiftval"}], "]"}], "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "//", "Expand"}], "//", 
        "Simplify"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"yy", "[", 
          RowBox[{"yLLPdecay", ",", "py", ",", 
           RowBox[{
            RowBox[{"tsol", "[", 
             RowBox[{"xLLPdecay", ",", "yLLPdecay", ",", "px", ",", "py", ",", 
              RowBox[{"RouterDecayVolumeGivenExperiment", "[", "z", "]"}], 
              ",", "xshiftval", ",", "yshiftval"}], "]"}], "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "//", "Expand"}], "//", 
        "Simplify"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"zz", "[", 
          RowBox[{"zLLPdecay", ",", "pz", ",", 
           RowBox[{
            RowBox[{"tsol", "[", 
             RowBox[{"xLLPdecay", ",", "yLLPdecay", ",", "px", ",", "py", ",", 
              RowBox[{"RouterDecayVolumeGivenExperiment", "[", "z", "]"}], 
              ",", "xshiftval", ",", "yshiftval"}], "]"}], "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "//", "Expand"}], "//", 
        "Simplify"}]}], "}"}]}], ";"}]}], "\[IndentingNewLine]", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DaughterTrajectoryCoord1", "[", 
    RowBox[{
    "xLLPdecay_", ",", "yLLPdecay_", ",", "zLLPdecay_", ",", "XlongProj_", 
     ",", "px_", ",", "py_", ",", "pz_"}], "]"}], "=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"FinalPlaneSign", "*", 
       RowBox[{"MomDirection", "[", 
        RowBox[{"py", ",", "pz"}], "]"}]}], ">", "0"}], ",", 
     RowBox[{"Evaluate", "[", 
      RowBox[{
       RowBox[{"DaughterTrajectory", "[", 
        RowBox[{
        "xLLPdecay", ",", "yLLPdecay", ",", "zLLPdecay", ",", "XlongProj", 
         ",", "px", ",", "py", ",", "pz"}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", "99999."}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DaughterTrajectoryCoord2", "[", 
    RowBox[{
    "xLLPdecay_", ",", "yLLPdecay_", ",", "zLLPdecay_", ",", "XlongProj_", 
     ",", "px_", ",", "py_", ",", "pz_"}], "]"}], "=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"FinalPlaneSign", "*", 
       RowBox[{"MomDirection", "[", 
        RowBox[{"py", ",", "pz"}], "]"}]}], ">", "0"}], ",", 
     RowBox[{"Evaluate", "[", 
      RowBox[{
       RowBox[{"DaughterTrajectory", "[", 
        RowBox[{
        "xLLPdecay", ",", "yLLPdecay", ",", "zLLPdecay", ",", "XlongProj", 
         ",", "px", ",", "py", ",", "pz"}], "]"}], "[", 
       RowBox[{"[", "pointSecondCoordinate", "]"}], "]"}], "]"}], ",", 
     "99999."}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.898614978089488*^9, 3.898615077315208*^9}, {
   3.8986175229025187`*^9, 3.898617584515291*^9}, {3.9050596496106524`*^9, 
   3.9050596506849985`*^9}, {3.9050597026377735`*^9, 3.9050597359539022`*^9}, 
   3.905060520070547*^9, {3.905102078975509*^9, 3.9051020789868574`*^9}, {
   3.9102413157099667`*^9, 3.910241378089466*^9}, 3.910246320789631*^9, {
   3.915263683504957*^9, 3.915263703568968*^9}, {3.915263733878626*^9, 
   3.9152637449774914`*^9}, {3.9152638206065493`*^9, 
   3.9152638252248697`*^9}, {3.915263868838834*^9, 3.9152639075937576`*^9}, {
   3.9152939917117295`*^9, 3.9152939920077915`*^9}, {3.9154371516178536`*^9, 
   3.9154371519664435`*^9}, {3.9161281145029883`*^9, 3.916128117569877*^9}},
 CellLabel->"In[47]:=",ExpressionUUID->"98f961b0-4fc6-4ac2-9887-c6c819a52732"],

Cell[BoxData[
 FormBox[
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     FractionBox[
      RowBox[{"px", " ", 
       RowBox[{"(", 
        RowBox[{"XlongProj", "-", "zLLPdecay"}], ")"}]}], "pz"], "+", 
     "xLLPdecay"}], ",", 
    RowBox[{
     FractionBox[
      RowBox[{"py", " ", 
       RowBox[{"(", 
        RowBox[{"XlongProj", "-", "zLLPdecay"}], ")"}]}], "pz"], "+", 
     "yLLPdecay"}], ",", "XlongProj"}], "}"}], TraditionalForm]], "Output",
 CellChangeTimes->{3.9161281203520956`*^9, 3.916128235011429*^9, 
  3.917688715443492*^9, 3.9177103202608147`*^9, 3.9190102798817945`*^9},
 CellLabel->
  "Out[575]=",ExpressionUUID->"25403852-8594-42da-8e14-9523345e88ad"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["With magnetic field", "Subsubsection",
 CellChangeTimes->{{3.8986148284352465`*^9, 
  3.898614837282953*^9}},ExpressionUUID->"5312240b-2fca-47c6-82b5-\
c47a3254613a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "The", " ", "magnetic", " ", "field", " ", "is", " ", "assumed", " ", "to",
     " ", "be", " ", "parallel", " ", "to", " ", "the", " ", "y", " ", 
    "axis"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "___", "___", "___", "___", "___", "___", "___", "___", "___", "___", 
    "___", "___", "___"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"Trajectory", " ", "of", " ", "the", " ", 
      RowBox[{"daughter", "'"}], "s", " ", "particle", " ", "before", " ", 
      "being", " ", "affected", " ", "by", " ", "the", " ", "magnet", " ", 
      "at", " ", "z"}], " ", "=", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"zProj", ".", " ", "It"}], " ", "is", " ", "a", " ", 
       "function", " ", "of", " ", "the", " ", "LLP", " ", "decay", " ", 
       "vertex", " ", "and", " ", "the", " ", 
       RowBox[{"daughter", "'"}], "s", " ", "kinematics", " ", "before", " ", 
       "the", " ", "magnet"}], " ", "-", " ", 
      SubscriptBox["p", "x"]}]}], ",", 
    SubscriptBox["p", "y"], ",", 
    SubscriptBox["p", "z"]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"For", " ", "the", " ", "x", " ", "coordinate"}], ",", " ", 
    RowBox[{
    "the", " ", "value", " ", "of", " ", "zProj", " ", "is", " ", "taken", 
     " ", "to", " ", "be", " ", "the", " ", "beginning", " ", "of", " ", 
     "the", " ", 
     RowBox[{"magnet", "/", "the"}], " ", 
     RowBox[{"LLP", "'"}], "s", " ", 
     SubscriptBox["z", "decay"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"here", " ", "and", " ", "below"}], ",", " ", 
       RowBox[{
        RowBox[{
        "it", " ", "is", " ", "always", " ", "assumed", " ", "that", " ", 
         SubscriptBox["z", "decay"]}], " ", ">", " ", 
        SubscriptBox["z", 
         RowBox[{"magnet", ",", "max"}]]}]}], ")"}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"For", " ", "the", " ", "y", " ", "coordinate"}], ",", " ", 
    RowBox[{
    "the", " ", "value", " ", "is", " ", "taken", " ", "to", " ", "be", " ", 
     "the", " ", "end", " ", "of", " ", "the", " ", 
     RowBox[{"magnet", ".", " ", "This"}], " ", "is", " ", "because", " ", 
     "it", " ", "is", " ", "assumed", " ", "for", " ", "simplicity", " ", 
     "that", " ", "the", " ", "evolution", " ", "of", " ", "the", " ", "y", 
     " ", "coordinate", " ", "up", " ", "to", " ", "the", " ", "end", " ", 
     "of", " ", "the", " ", "magnet", " ", "is", " ", "the", " ", "same", " ",
      "as", " ", "it", " ", "would", " ", "be", " ", "without", " ", "the", 
     " ", "magnet"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"LarmorRadiusGivenExperiment", "[", "EGeV_", "]"}], "=", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"DipoleMagnetOptionGivenExperiment", "==", "\"\<False\>\""}], 
       ",", "0", ",", 
       RowBox[{"LarmorRadius", "[", 
        RowBox[{"EGeV", ",", "Bval"}], "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"xAtMagnetStart", "[", 
      RowBox[{
      "xLLPdecay_", ",", "yLLPdecay_", ",", "zLLPdecay_", ",", "px_", ",", 
       "py_", ",", "pz_"}], "]"}], "=", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"FinalPlaneSign", "*", 
         RowBox[{"MomDirection", "[", 
          RowBox[{"py", ",", "pz"}], "]"}]}], ">", "0"}], ",", 
       RowBox[{"Evaluate", "[", 
        RowBox[{"xLLPdecay", "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Max", "[", 
             RowBox[{"zMagnetMinGivenExperiment", ",", "zLLPdecay"}], "]"}], 
            "-", "zLLPdecay"}], ")"}], 
          RowBox[{"(", 
           RowBox[{"px", "/", "pz"}], ")"}]}]}], "]"}], ",", "99999."}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "The", " ", "coordinate", " ", "2", " ", "is", " ", "assumed", " ", "to", 
     " ", "be", " ", "the", " ", "same", " ", "just", " ", "after", " ", 
     "the", " ", "magnet", " ", "as", " ", "if", " ", "there", " ", "would", 
     " ", "not", " ", "be", " ", "any", " ", "magnetic", " ", "field"}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"yAtMagnetEnd", "[", 
      RowBox[{
      "xLLPdecay_", ",", "yLLPdecay_", ",", "zLLPdecay_", ",", "px_", ",", 
       "py_", ",", "pz_"}], "]"}], "=", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"FinalPlaneSign", "*", 
         RowBox[{"MomDirection", "[", 
          RowBox[{"py", ",", "pz"}], "]"}]}], ">", "0"}], ",", 
       RowBox[{"Evaluate", "[", 
        RowBox[{"yLLPdecay", "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"zMagnetMaxGivenExperiment", "-", "zLLPdecay"}], ")"}], 
          RowBox[{"(", 
           RowBox[{"py", "/", "pz"}], ")"}]}]}], "]"}], ",", "99999."}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "___", "___", "___", "___", "___", "___", "___", "___", "___", "___", 
     "___", "___", "___", "___", "__"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Trajectory", " ", "of", " ", "the", " ", 
     RowBox[{"daughter", "'"}], "s", " ", "particle", " ", "after", " ", 
     "passing", " ", "the", " ", "domain", " ", "with", " ", "magnetic", " ", 
     "field"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "___", "___", "___", "___", "___", "___", "___", "___", "___", "___", 
     "___", "___", "___", "___", "__"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"The", " ", "x"}], "-", "coordinate"}], ",", " ", 
     RowBox[{"as", " ", "well", " ", "as", " ", "the", " ", "momenta", " ", 
      SubscriptBox["p", "x"]}], ",", 
     RowBox[{
      SubscriptBox["p", "z"], " ", "get", " ", "changed", " ", "depending", 
      " ", "on", " ", "the", " ", "charge", " ", "sign", " ", "of", " ", 
      "the", " ", 
      RowBox[{"particle", ".", " ", "This"}], " ", "is", " ", "taken", " ", 
      "into", " ", "account", " ", "by", " ", "kinking", " ", "of", " ", 
      "their", " ", "values"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"xAtDetectorEndMagnetEffectTemp", "[", 
      RowBox[{
      "zLLPdecay_", ",", "xprojBeforeMagnet_", ",", "pxaftermagnet_", ",", 
       "py_", ",", "pzaftermagnet_", ",", "qval_"}], "]"}], "=", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"DipoleMagnetOptionGivenExperiment", "==", "\"\<True\>\""}], 
       ",", 
       RowBox[{
        RowBox[{
         RowBox[{"xHelicalApprox", "[", 
          RowBox[{"xprojBeforeMagnet", ",", 
           RowBox[{"Max", "[", 
            RowBox[{"zMagnetMinGivenExperiment", ",", "zLLPdecay"}], "]"}], 
           ",", "pxaftermagnet", ",", "pzaftermagnet", ",", "Bval", ",", 
           "qval", ",", "zMagnetMaxGivenExperiment"}], "]"}], "//", 
         "Expand"}], "//", "Simplify"}], ",", "999999."}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"yAtDetectorEndMagnetEffectTemp", "[", 
      RowBox[{
      "zLLPdecay_", ",", "yprojAfterMagnet_", ",", "py_", ",", 
       "pzaftermagnet_"}], "]"}], "=", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"DipoleMagnetOptionGivenExperiment", "==", "\"\<True\>\""}], 
       ",", 
       RowBox[{"yprojAfterMagnet", "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
          "xLongMaxDetectorGivenExperiment", "-", 
           "zMagnetMaxGivenExperiment"}], ")"}], 
         RowBox[{"(", 
          RowBox[{"py", "/", "pzaftermagnet"}], ")"}]}]}], ",", "99999."}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"pxAfterMagnet", "[", 
      RowBox[{"zLLPdecay_", ",", "px_", ",", "pz_", ",", "qval_"}], "]"}], 
     "=", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"DipoleMagnetOptionGivenExperiment", "==", "\"\<True\>\""}], 
       ",", 
       RowBox[{"pxHelicalApprox", "[", 
        RowBox[{
         RowBox[{"Max", "[", 
          RowBox[{"zLLPdecay", ",", "zMagnetMinGivenExperiment"}], "]"}], ",",
          "px", ",", "pz", ",", "Bval", ",", "qval", ",", 
         "zMagnetMaxGivenExperiment"}], "]"}], ",", "100000."}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"pzAfterMagnet", "[", 
      RowBox[{"zLLPdecay_", ",", "px_", ",", "pz_", ",", "qval_"}], "]"}], 
     "=", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"DipoleMagnetOptionGivenExperiment", "==", "\"\<True\>\""}], 
       ",", 
       RowBox[{"pzHelicalApprox", "[", 
        RowBox[{
         RowBox[{"Max", "[", 
          RowBox[{"zLLPdecay", ",", "zMagnetMinGivenExperiment"}], "]"}], ",",
          "px", ",", "pz", ",", "Bval", ",", "qval", ",", 
         "zMagnetMaxGivenExperiment"}], "]"}], ",", "0.00001"}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"xAtDetectorEndMagnetEffect", "[", 
      RowBox[{
      "zLLPdecay_", ",", "xprojBeforeMagnet_", ",", "px_", ",", "py_", ",", 
       "pz_", ",", "qval_"}], "]"}], "=", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"DipoleMagnetOptionGivenExperiment", "==", "\"\<True\>\""}], 
       ",", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"FinalPlaneSign", "*", 
           RowBox[{"MomDirection", "[", 
            RowBox[{"py", ",", "pz"}], "]"}]}], ">", "0"}], ",", 
         RowBox[{"Evaluate", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"xAtDetectorEndMagnetEffectTemp", "[", 
               RowBox[{"zLLPdecay", ",", "xprojBeforeMagnet", ",", 
                RowBox[{"pxAfterMagnet", "[", 
                 RowBox[{"zLLPdecay", ",", "px", ",", "pz", ",", "qval"}], 
                 "]"}], ",", "py", ",", 
                RowBox[{"pzAfterMagnet", "[", 
                 RowBox[{"zLLPdecay", ",", "px", ",", "pz", ",", "qval"}], 
                 "]"}], ",", "qval"}], "]"}], "//", "Simplify"}], ")"}], "/.",
             " ", 
            RowBox[{
             RowBox[{"Cot", "[", "x_", "]"}], ":>", 
             RowBox[{"1", "/", 
              RowBox[{"Tan", "[", "x", "]"}]}]}]}], "/.", " ", 
           RowBox[{
            RowBox[{"Csc", "[", "x_", "]"}], ":>", 
            RowBox[{"1", "/", 
             RowBox[{"Sin", "[", "x", "]"}]}]}]}], "]"}], ",", "99999."}], 
        "]"}], ",", "999999."}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"yAtDetectorEndMagnetEffect", "[", 
      RowBox[{
      "zLLPdecay_", ",", "yprojAfterMagnet_", ",", "px_", ",", "py_", ",", 
       "pz_", ",", "qval_"}], "]"}], "=", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"DipoleMagnetOptionGivenExperiment", "==", "\"\<True\>\""}], 
       ",", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"FinalPlaneSign", "*", 
           RowBox[{"MomDirection", "[", 
            RowBox[{"py", ",", "pz"}], "]"}]}], ">", "0"}], ",", 
         RowBox[{"Evaluate", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"yAtDetectorEndMagnetEffectTemp", "[", 
              RowBox[{"zLLPdecay", ",", "yprojAfterMagnet", ",", "py", ",", 
               RowBox[{"pzAfterMagnet", "[", 
                RowBox[{"zLLPdecay", ",", "px", ",", "pz", ",", "qval"}], 
                "]"}]}], "]"}], "/.", " ", 
             RowBox[{
              RowBox[{"Cot", "[", "x_", "]"}], ":>", 
              RowBox[{"1", "/", 
               RowBox[{"Tan", "[", "x", "]"}]}]}]}], "/.", " ", 
            RowBox[{
             RowBox[{"Csc", "[", "x_", "]"}], ":>", 
             RowBox[{"1", "/", 
              RowBox[{"Sin", "[", "x", "]"}]}]}]}], "//", "Simplify"}], "]"}],
          ",", "99999."}], "]"}], ",", "999999."}], "]"}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.8986148998175273`*^9, 3.8986149126960583`*^9}, {
   3.898614950786856*^9, 3.8986149781555157`*^9}, {3.898615090713854*^9, 
   3.8986150939927764`*^9}, {3.898615129813939*^9, 3.898615137591441*^9}, {
   3.898615177272547*^9, 3.898615187621873*^9}, {3.898615229545967*^9, 
   3.8986152788371277`*^9}, {3.8986153920715065`*^9, 
   3.8986153953710594`*^9}, {3.8986154328300467`*^9, 
   3.8986156569172697`*^9}, {3.898615753327162*^9, 3.898616101987913*^9}, {
   3.8986161442885065`*^9, 3.898616181571365*^9}, {3.8986167661397047`*^9, 
   3.898616831027446*^9}, {3.898616908613021*^9, 3.898617030688631*^9}, {
   3.8986170651961308`*^9, 3.8986173762547626`*^9}, {3.8986174289362993`*^9, 
   3.89861748850333*^9}, {3.8986175626819754`*^9, 3.898617583440949*^9}, {
   3.8987002702900033`*^9, 3.8987002771101446`*^9}, {3.898700850668104*^9, 
   3.8987008635169897`*^9}, {3.8987012898616943`*^9, 
   3.8987012973552027`*^9}, {3.902912877611253*^9, 3.9029128848144073`*^9}, {
   3.9029151757034235`*^9, 3.902915245191349*^9}, {3.905505402555734*^9, 
   3.9055054076948338`*^9}, 3.910246320789631*^9, {3.91543715197209*^9, 
   3.9154371520997596`*^9}, {3.91612812599009*^9, 3.9161281439072056`*^9}, {
   3.916130225014806*^9, 3.9161302252290354`*^9}},
 CellLabel->"In[55]:=",ExpressionUUID->"3aa3b887-b65c-40c3-a614-ee4fe0b9db40"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Blocks computing various cuts", "Subsection",
 CellChangeTimes->{{3.905532004482563*^9, 3.9055320148212833`*^9}, {
  3.9055320746103935`*^9, 3.9055320812728267`*^9}, {3.9055341476241693`*^9, 
  3.905534153508107*^9}, {3.9154362650657945`*^9, 
  3.9154362702977705`*^9}},ExpressionUUID->"53204555-742a-4581-b490-\
679c494e0d09"],

Cell[CellGroupData[{

Cell["Particular decay product - geometric part", "Subsubsection",
 CellChangeTimes->{{3.905532022451865*^9, 3.905532027175404*^9}, {
  3.9055320835244646`*^9, 3.9055320853151717`*^9}, {3.905534086867423*^9, 
  3.905534090497462*^9}},ExpressionUUID->"d1605ee8-ce6d-4055-be95-\
1e16e0571b24"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"conditionDecayAcceptanceGeometric", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Hold", "@", 
       RowBox[{"Compile", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"charge1", ",", "_Real"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"pdg1", ",", "_Real"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"xdecayfip", ",", "_Real"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"ydecayfip", ",", "_Real"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"zfip", ",", "_Real"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"px1lab", ",", "_Real"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"py1lab", ",", "_Real"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"pz1lab", ",", "_Real"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"E1lab", ",", "_Real"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"zmagnMzfip", ",", "_Real"}], "}"}]}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Module", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"cond", "=", "0."}], ",", 
             RowBox[{"FirstCoordinateProduct1", "=", "0."}], ",", 
             RowBox[{"SecondCoordinateProduct1", "=", "0."}], ",", 
             RowBox[{"xAtMagnetStartProduct1", "=", "0."}], ",", 
             RowBox[{"yAfterMagnetProduct1", "=", "0."}], ",", 
             RowBox[{"xFinalPlaneProduct1", "=", "0."}], ",", 
             RowBox[{"yFinalPlaneProduct1", "=", "0."}], ",", 
             RowBox[{"xLongProjVal", "=", "0."}]}], "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"Depending", " ", "on", " ", "pdg", " ", "id"}], ",", 
             " ", 
             RowBox[{
             "the", " ", "final", " ", "plane", " ", "required", " ", "to", 
              " ", "be", " ", "reached", " ", "in", " ", "order", " ", "to", 
              " ", "be", " ", "reconstructed"}]}], "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"xLongProjVal", "=", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Abs", "[", "pdg1", "]"}], "==", "13."}], ",", 
               "xLongMuonPlaneGivenExperiment", ",", 
               "xLongNonMuonPlaneGivenExperiment"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{
              "If", " ", "product", " ", "is", " ", "uncharged", " ", "OR", 
               " ", "there", " ", "is", " ", "no", " ", "magnet", " ", "OR", 
               " ", "the", " ", "LLP", " ", "decays", " ", "after", " ", 
               "the", " ", "region", " ", "with", " ", "the", " ", "magnetic",
                " ", "field"}], ",", " ", 
              RowBox[{
              "then", " ", "the", " ", "trajectory", " ", "of", " ", "the", 
               " ", "decay", " ", "product", " ", "is", " ", "a", " ", 
               "straight", " ", "line", " ", "and", " ", "the", " ", "decay", 
               " ", "acceptance", " ", "may", " ", "be", " ", "easily", " ", 
               "computed"}]}], "*)"}], "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Bval", "==", "0"}], "||", 
               RowBox[{"charge1", "==", "0."}], "||", 
               RowBox[{"zmagnMzfip", "<", "0"}]}], ",", "\[IndentingNewLine]", 
              RowBox[{"(*", 
               RowBox[{
               "Coordinates", " ", "of", " ", "the", " ", "decay", " ", 
                "products", " ", "at", " ", "the", " ", "detector", " ", 
                "plane"}], "*)"}], "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"FirstCoordinateProduct1", "=", 
                RowBox[{"DaughterTrajectoryCoord1", "[", 
                 RowBox[{
                 "xdecayfip", ",", "ydecayfip", ",", "zfip", ",", 
                  "xLongProjVal", ",", "px1lab", ",", "py1lab", ",", 
                  "pz1lab"}], "]"}]}], ";", "\[IndentingNewLine]", 
               RowBox[{"SecondCoordinateProduct1", "=", 
                RowBox[{"DaughterTrajectoryCoord2", "[", 
                 RowBox[{
                 "xdecayfip", ",", "ydecayfip", ",", "zfip", ",", 
                  "xLongProjVal", ",", "px1lab", ",", "py1lab", ",", 
                  "pz1lab"}], "]"}]}], ";", "\[IndentingNewLine]", 
               RowBox[{"(*", 
                RowBox[{
                "Condition", " ", "whether", " ", "product1", " ", 
                 "intersects", " ", "the", " ", "detector"}], "*)"}], 
               "\[IndentingNewLine]", 
               RowBox[{"cond", "=", 
                RowBox[{"DecayAcceptanceGeometry", "[", 
                 RowBox[{
                 "FirstCoordinateProduct1", ",", "SecondCoordinateProduct1", 
                  ",", "xLongProjVal"}], "]"}]}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"(*", 
               RowBox[{
                RowBox[{
                 RowBox[{
                 "If", " ", "the", " ", "magnetic", " ", "field", " ", "and", 
                  " ", "electric", " ", "charge", " ", "of", " ", "the", " ", 
                  "product", " ", "are", " ", "non"}], "-", 
                 RowBox[{
                 "zero", " ", "AND", " ", "the", " ", "LLP", " ", "decays", 
                  " ", "before", " ", "the", " ", "end", " ", "of", " ", 
                  "the", " ", "magnet"}]}], ",", " ", 
                RowBox[{
                "then", " ", "the", " ", "trajectory", " ", "is", " ", 
                 "affected", " ", "by", " ", "the", " ", "magnetic", " ", 
                 RowBox[{"field", ".", " ", "However"}]}], ",", " ", 
                RowBox[{"to", " ", "be", " ", "affected"}]}], "*)"}], 
              "\[IndentingNewLine]", 
              RowBox[{"(*", 
               RowBox[{
                RowBox[{
                "If", " ", "the", " ", "product", " ", "has", " ", "large", 
                 " ", "enough", " ", "energy", " ", 
                 RowBox[{"(", 
                  RowBox[{"==", " ", 
                   RowBox[{
                   "Larmor", " ", "radius", " ", "is", " ", "smaller", " ", 
                    "than", " ", "the", " ", "domain", " ", "with", " ", 
                    "the", " ", "magnetic", " ", "field"}]}], ")"}]}], ",", 
                " ", 
                RowBox[{
                "proceed", " ", "to", " ", "the", " ", "acceptance", " ", 
                 "routine", " ", "calculation"}]}], "*)"}], 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"LarmorRadiusGivenExperiment", "[", "E1lab", "]"}], 
                  ">", "zmagnMzfip"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"(*", 
                  RowBox[{
                   RowBox[{
                   "x", " ", "coordinate", " ", "of", " ", "the", " ", 
                    "decay", " ", "products", " ", "just", " ", "before", " ",
                     "the", " ", "magnet", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    "or", " ", "at", " ", "the", " ", "LLP", " ", "decay", 
                    " ", "point", " ", "if", " ", "it", " ", "is", " ", 
                    "inside", " ", "the", " ", "magnet"}], ")"}]}], ",", " ", 
                   RowBox[{
                   "and", " ", "y", " ", "coordinate", " ", "at", " ", "the", 
                    " ", "end", " ", "of", " ", "the", " ", 
                    RowBox[{"magnet", ".", " ", "Due"}], " ", "to", " ", 
                    "the", " ", "approximation"}], ",", " ", 
                   RowBox[{
                   "the", " ", "mentioned", " ", "y", " ", "coordinate", " ", 
                    "is", " ", "unaffected", " ", "by", " ", "the", " ", 
                    "magnet"}]}], "*)"}], "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"xAtMagnetStartProduct1", "=", 
                   RowBox[{"xAtMagnetStart", "[", 
                    RowBox[{
                    "xdecayfip", ",", "ydecayfip", ",", "zfip", ",", "px1lab",
                     ",", "py1lab", ",", "pz1lab"}], "]"}]}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"yAfterMagnetProduct1", "=", 
                   RowBox[{"yAtMagnetEnd", "[", 
                    RowBox[{
                    "xdecayfip", ",", "ydecayfip", ",", "zfip", ",", "px1lab",
                     ",", "py1lab", ",", "pz1lab"}], "]"}]}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"(*", 
                   RowBox[{
                   "These", " ", "coordinates", " ", "must", " ", "be", " ", 
                    "within", " ", "the", " ", "detector", " ", 
                    RowBox[{"coverage", ".", " ", "Here"}], " ", "it", " ", 
                    "is", " ", "assumed", " ", "that", " ", "the", " ", 
                    "transverse", " ", "size", " ", "of", " ", "the", " ", 
                    "detector", " ", "does", " ", "not", " ", "change", " ", 
                    "from", " ", 
                    SubscriptBox["z", 
                    RowBox[{"magnet", ",", "min"}]], " ", "to", " ", 
                    SubscriptBox["z", 
                    RowBox[{"magnet", ",", "max"}]]}], "*)"}], 
                  "\[IndentingNewLine]", 
                  RowBox[{"cond", "=", 
                   RowBox[{"DecayAcceptanceGeometry", "[", 
                    RowBox[{
                    "xAtMagnetStartProduct1", ",", "yAfterMagnetProduct1", 
                    ",", "zMagnetMaxGivenExperiment"}], "]"}]}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"(*", 
                   RowBox[{
                    RowBox[{
                    "If", " ", "this", " ", "is", " ", "the", " ", "case"}], 
                    ",", " ", 
                    RowBox[{
                    "then", " ", "the", " ", "routine", " ", "below", " ", 
                    "evaluates", " ", "the", " ", "change", " ", "of", " ", 
                    "the", " ", "trajectory", " ", "due", " ", "to", " ", 
                    "the", " ", "magnetic", " ", "field"}]}], "*)"}], 
                  "\[IndentingNewLine]", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"cond", "==", "1"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{
                    RowBox[{"Coordinates", " ", "x"}], ",", 
                    RowBox[{"y", " ", "at", " ", "the", " ", "final", " ", 
                    RowBox[{"plane", ".", " ", "Both"}], " ", "of", " ", 
                    "them", " ", "are", " ", "affected", " ", "by", " ", 
                    "magnet"}]}], "*)"}], "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{
                    RowBox[{
                    "The", " ", "x", " ", "coordinate", " ", "gets", " ", 
                    "affected", " ", "by", " ", "a", " ", "kick", " ", "in", 
                    " ", "x"}], ",", 
                    SubscriptBox["p", "x"], ",", 
                    RowBox[{
                    SubscriptBox["p", "z"], " ", "after", " ", "the", " ", 
                    "magnet"}]}], "*)"}], "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{
                    "The", " ", "y", " ", "coordinate", " ", "gets", " ", 
                    "affected", " ", "by", " ", "a", " ", "kick", " ", "in", 
                    " ", 
                    SubscriptBox["p", "z"], " ", "after", " ", "the", " ", 
                    "magnet"}], "*)"}], "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"FirstCoordinateProduct1", "=", 
                    RowBox[{"xAtDetectorEndMagnetEffect", "[", 
                    RowBox[{
                    "zfip", ",", "xAtMagnetStartProduct1", ",", "px1lab", ",",
                     "py1lab", ",", "pz1lab", ",", "charge1"}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"SecondCoordinateProduct1", "=", 
                    RowBox[{"yAtDetectorEndMagnetEffect", "[", 
                    RowBox[{
                    "zfip", ",", "yAfterMagnetProduct1", ",", "px1lab", ",", 
                    "py1lab", ",", "pz1lab", ",", "charge1"}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{
                    "Condition", " ", "whether", " ", "decay", " ", 
                    "products", " ", "intersect", " ", "the", " ", "detector",
                     " ", "and", " ", "have", " ", "large", " ", "enough", 
                    " ", "energy"}], "*)"}], "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{
                    "The", " ", "first", " ", "condition", " ", "corresponds",
                     " ", "to", " ", "the", " ", "requirement", " ", "that", 
                    " ", "x", " ", "before", " ", "the", " ", "magnet", " ", 
                    "and", " ", "y", " ", "after", " ", "the", " ", "magnet", 
                    " ", "are", " ", "within", " ", "the", " ", "detector"}], 
                    "*)"}], "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{
                    RowBox[{
                    "The", " ", "second", " ", "one", " ", "requires", " ", 
                    "that", " ", "kicked", " ", "x"}], ",", " ", 
                    RowBox[{"y", " ", "at", " ", 
                    SubscriptBox["z", 
                    RowBox[{"final", " "}]], "are", " ", "within", " ", "the",
                     " ", "detector"}]}], "*)"}], "\[IndentingNewLine]", 
                    RowBox[{"cond", "=", 
                    RowBox[{"DecayAcceptanceGeometry", "[", 
                    RowBox[{
                    "FirstCoordinateProduct1", ",", 
                    "SecondCoordinateProduct1", ",", "xLongProjVal"}], 
                    "]"}]}]}]}], "]"}]}], "\[IndentingNewLine]", 
                 RowBox[{"(*", 
                  RowBox[{
                   RowBox[{
                   "If", " ", "the", " ", "product", " ", "has", " ", "too", 
                    " ", "low", " ", "energy", " ", 
                    RowBox[{"(", 
                    RowBox[{"==", " ", 
                    RowBox[{
                    "Larmor", " ", "radius", " ", "is", " ", "smaller", " ", 
                    "than", " ", "the", " ", "domain", " ", "with", " ", 
                    "the", " ", "magnetic", " ", "field"}]}], ")"}]}], ",", 
                   " ", 
                   RowBox[{
                   "it", " ", "would", " ", "be", " ", "trapped", " ", 
                    "inside", " ", "the", " ", "magnetic", " ", 
                    RowBox[{"field", ".", " ", "In"}], " ", "this", " ", 
                    "case"}], ",", " ", 
                   RowBox[{"acceptance", " ", "=", " ", "0"}]}], "*)"}], 
                 "\[IndentingNewLine]", ",", 
                 RowBox[{"cond", "=", "0"}]}], "]"}], ";"}]}], 
             "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{
             "cond", ",", "FirstCoordinateProduct1", ",", 
              "SecondCoordinateProduct1"}], "}"}]}]}], "\[IndentingNewLine]", 
          "]"}], ",", 
         RowBox[{"CompilationTarget", "->", "\"\<C\>\""}], ",", 
         RowBox[{"RuntimeOptions", "->", "\"\<Speed\>\""}], ",", 
         RowBox[{"RuntimeAttributes", "->", 
          RowBox[{"{", "Listable", "}"}]}], ",", 
         RowBox[{"Parallelization", "->", "True"}]}], "]"}]}], "/.", 
      RowBox[{"ruleDown", "[", 
       RowBox[{"{", 
        RowBox[{
        "DaughterTrajectoryCoord1", ",", "DaughterTrajectoryCoord2", ",", 
         "DecayAcceptanceGeometry", ",", "xAtDetectorEndMagnetEffect", ",", 
         "yAtDetectorEndMagnetEffect", ",", "xAtMagnetStart", ",", 
         "yAtMagnetEnd", ",", "LarmorRadiusGivenExperiment"}], "}"}], "]"}]}],
      "/.", 
     RowBox[{"ruleOwn", "[", 
      RowBox[{"{", 
       RowBox[{
       "Bval", ",", "xLongMuonPlaneGivenExperiment", ",", 
        "xLongNonMuonPlaneGivenExperiment", ",", 
        "zMagnetMaxGivenExperiment"}], "}"}], "]"}]}], "//", 
    "ReleaseHold"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"<<", "CompiledFunctionTools`"}], "\n", 
 RowBox[{
  RowBox[{"CompilePrint", "@", "conditionDecayAcceptanceGeometric"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.9190099864586735`*^9, 3.9190099880051546`*^9}, 
   3.9190101430302677`*^9, {3.9190102042823553`*^9, 3.9190102158623853`*^9}, {
   3.9190102530509815`*^9, 3.9190103185076265`*^9}, {3.9190680812043915`*^9, 
   3.9190680853409634`*^9}, 3.9190681190319443`*^9},
 CellLabel->
  "In[920]:=",ExpressionUUID->"39533115-0bd5-4302-9b8c-6f8564499393"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Decay products pair - Energy cut", "Subsubsection",
 CellChangeTimes->{{3.9055320949676332`*^9, 3.905532096895308*^9}, {
  3.905532540249052*^9, 3.9055325418192863`*^9}, {3.9055340991757836`*^9, 
  3.9055341053457465`*^9}},ExpressionUUID->"8d07c91f-2179-4077-8d72-\
1f198ad662cb"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"distff", "[", "\[Sigma]_", "]"}], "=", 
   RowBox[{"ProbabilityDistribution", "[", 
    RowBox[{
     RowBox[{
      FractionBox["1", 
       RowBox[{
        SqrtBox[
         RowBox[{"2", "*", "Pi"}]], "\[Sigma]"}]], 
      RowBox[{"Exp", "[", 
       RowBox[{"-", 
        FractionBox[
         SuperscriptBox[
          RowBox[{"(", "x", ")"}], "2"], 
         RowBox[{"2", 
          SuperscriptBox["\[Sigma]", "2"]}]]}], "]"}]}], " ", ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", 
       RowBox[{"-", "Infinity"}], ",", "Infinity"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"InverseCDFffplus", "[", 
    RowBox[{"\[Sigma]_", ",", "u_"}], "]"}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{"InverseCDF", "[", 
      RowBox[{
       RowBox[{"distff", "[", "\[Sigma]", "]"}], ",", "u"}], "]"}], "[", 
     RowBox[{"[", "1", "]"}], "]"}], "[", 
    RowBox[{"[", "2", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"enres", "[", "Eval_", "]"}], "=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"GivenExperiment", "==", "\"\<SHiNESS\>\""}], ",", 
     FractionBox["0.15", 
      SqrtBox[
       RowBox[{
        SuperscriptBox["10", "3"], "Eval"}]]]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"conditionEnergyCuts", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"ecutLowerid", "=", "ecutLowerID"}], ",", 
       RowBox[{"ecutUpperid", "=", "ecutUpperID"}], ",", 
       RowBox[{"EtotCutLowerid", "=", "EtotCutLowerID"}], ",", 
       RowBox[{"EtotCutUpperid", "=", "EtotCutUpperID"}]}], "}"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"Hold", "@", 
        RowBox[{"Compile", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"pdg1", ",", "_Real"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"charge1", ",", "_Real"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"pdg2", ",", "_Real"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"E1lab", ",", "_Real"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"E2lab", ",", "_Real"}], "}"}]}], "}"}], ",", 
          RowBox[{"Module", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
             "ecutlow1", ",", "ecutlow2", ",", "ecutup1", ",", "ecutup2", ",", 
              RowBox[{"ecuttotlow", "=", "eTotCutLowerZero"}], ",", 
              RowBox[{"ecuttotupp", "=", "eTotCutUpperZero"}]}], "}"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ecutlow1", "=", 
              RowBox[{"ecutLowerid", "[", 
               RowBox[{"pdg1", ",", "charge1"}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"ecutlow2", "=", 
              RowBox[{"ecutLowerid", "[", 
               RowBox[{"pdg2", ",", "charge1"}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"ecutup1", "=", 
              RowBox[{"ecutUpperid", "[", 
               RowBox[{"pdg1", ",", "charge1"}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"ecutup2", "=", 
              RowBox[{"ecutUpperid", "[", 
               RowBox[{"pdg2", ",", "charge1"}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"IfEtotLowercuts", "==", "1"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"ecuttotlow", "=", 
                RowBox[{"EtotCutLowerid", "[", 
                 RowBox[{"pdg1", ",", "charge1", ",", "pdg2"}], "]"}]}]}], 
              "]"}], ";", "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"IfEtotUppercuts", "==", "1"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"ecuttotupp", "=", 
                RowBox[{"EtotCutUpperid", "[", 
                 RowBox[{"pdg1", ",", "charge1", ",", "pdg2"}], "]"}]}]}], 
              "]"}], ";", "\[IndentingNewLine]", 
             RowBox[{"Boole", "[", 
              RowBox[{
               RowBox[{"ecutlow1", "<=", "E1lab", "<=", "ecutup1"}], "&&", 
               RowBox[{"ecutlow2", "<=", "E2lab", "<=", "ecutup2"}], "&&", 
               RowBox[{"ecuttotlow", "<=", 
                RowBox[{"E1lab", "+", "E2lab"}], "<=", "ecuttotupp"}]}], 
              "]"}]}]}], "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
          ",", 
          RowBox[{"CompilationTarget", "->", "\"\<C\>\""}], ",", 
          RowBox[{"RuntimeOptions", "->", "\"\<Speed\>\""}], ",", 
          RowBox[{"RuntimeAttributes", "->", 
           RowBox[{"{", "Listable", "}"}]}], ",", 
          RowBox[{"Parallelization", "->", "True"}]}], "]"}]}], "/.", 
       RowBox[{"ruleOwn", "[", 
        RowBox[{"{", 
         RowBox[{
         "eTotCutLowerZero", ",", "eTotCutUpperZero", ",", "IfEtotLowercuts", 
          ",", "IfEtotUppercuts"}], "}"}], "]"}]}], "//", "ReleaseHold"}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"<<", "CompiledFunctionTools`"}], "\n", 
 RowBox[{
  RowBox[{"CompilePrint", "@", "conditionEnergyCuts"}], ";"}]}], "Input",
 CellChangeTimes->{{3.9055321545666084`*^9, 3.905532308371714*^9}, {
   3.9055323848426237`*^9, 3.9055324645536222`*^9}, {3.9055325115442104`*^9, 
   3.9055325339285145`*^9}, 3.905533847673461*^9, 3.9055338845804467`*^9, {
   3.9056674361712217`*^9, 3.9056674462085285`*^9}, {3.9056739258987217`*^9, 
   3.905673937160644*^9}, {3.9058412485693026`*^9, 3.905841253902861*^9}, {
   3.905841284005067*^9, 3.9058413187161975`*^9}, {3.9058413781832232`*^9, 
   3.9058414100958643`*^9}, {3.905846696782211*^9, 3.9058467605940037`*^9}, {
   3.906801176497629*^9, 3.906801179548951*^9}, {3.910176120818011*^9, 
   3.9101761480327454`*^9}, {3.9121512857627974`*^9, 3.9121512904114666`*^9}, 
   3.9125011083554907`*^9, {3.9125011862782507`*^9, 3.9125011997184687`*^9}, {
   3.9125343497610435`*^9, 3.9125345592950416`*^9}, {3.915639238357266*^9, 
   3.915639278156277*^9}, 3.9156393126768823`*^9, 3.915860670024149*^9, {
   3.9168903964478765`*^9, 3.916890409111637*^9}, {3.9177103455679646`*^9, 
   3.9177103532243843`*^9}, {3.9186648789170957`*^9, 3.918664883509919*^9}},
 CellLabel->"In[69]:=",ExpressionUUID->"7b470239-7269-4c6b-8908-fc957fa58f5a"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Decay products pair - ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["p", "T"], TraditionalForm]],ExpressionUUID->
  "5da090f2-3036-47e1-9f52-f19d1c137a5d"],
 " cut"
}], "Subsubsection",
 CellChangeTimes->{{3.905532547151104*^9, 3.9055325606376743`*^9}, 
   3.9055341111798687`*^9},ExpressionUUID->"0714da82-4a9d-48d5-b035-\
e74e6965c9bb"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"conditionpTcuts", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"pTcutLowerid", "=", "pTcutLowerID"}], ",", 
       RowBox[{"pTcutUpperid", "=", "pTcutUpperID"}]}], "}"}], ",", 
     RowBox[{
      RowBox[{"Hold", "@", 
       RowBox[{"Compile", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"pdg1", ",", "_Real"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"charge1", ",", "_Real"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"pdg2", ",", "_Real"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"px1lab", ",", "_Real"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"py1lab", ",", "_Real"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"px2lab", ",", "_Real"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"py2lab", ",", "_Real"}], "}"}]}], "}"}], ",", 
         RowBox[{"Module", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
            "pTsquaredCutLow1", ",", "pTsquaredCutLow2", ",", 
             "pTsquaredCutUpp1", ",", "pTsquaredCutUpp2", ",", 
             "pT1squaredlab", ",", "pT2squaredlab"}], "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"pTsquaredCutLow1", "=", 
             SuperscriptBox[
              RowBox[{"pTcutLowerid", "[", 
               RowBox[{"pdg1", ",", "charge1"}], "]"}], "2"]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"pTsquaredCutLow2", "=", 
             SuperscriptBox[
              RowBox[{"pTcutLowerid", "[", 
               RowBox[{"pdg2", ",", "charge1"}], "]"}], "2"]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"pTsquaredCutUpp1", "=", 
             SuperscriptBox[
              RowBox[{"pTcutUpperid", "[", 
               RowBox[{"pdg1", ",", "charge1"}], "]"}], "2"]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"pTsquaredCutUpp2", "=", 
             SuperscriptBox[
              RowBox[{"pTcutUpperid", "[", 
               RowBox[{"pdg2", ",", "charge1"}], "]"}], "2"]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"pT1squaredlab", "=", 
             RowBox[{
              SuperscriptBox["px1lab", "2"], "+", 
              SuperscriptBox["py1lab", "2"]}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"pT2squaredlab", "=", 
             RowBox[{
              SuperscriptBox["px2lab", "2"], "+", 
              SuperscriptBox["py2lab", "2"]}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"Boole", "[", 
             RowBox[{
              RowBox[{
              "pTsquaredCutLow1", "<=", "pT1squaredlab", "<=", 
               "pTsquaredCutUpp1"}], "&&", 
              RowBox[{
              "pTsquaredCutLow2", "<=", "pT2squaredlab", "<=", 
               "pTsquaredCutUpp2"}]}], "]"}]}]}], "\[IndentingNewLine]", 
          "]"}], ",", 
         RowBox[{"CompilationTarget", "->", "\"\<C\>\""}], ",", 
         RowBox[{"RuntimeOptions", "->", "\"\<Speed\>\""}], ",", 
         RowBox[{"RuntimeAttributes", "->", 
          RowBox[{"{", "Listable", "}"}]}], ",", 
         RowBox[{"Parallelization", "->", "True"}]}], "]"}]}], "//", 
      "ReleaseHold"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"<<", "CompiledFunctionTools`"}], "\n", 
 RowBox[{
  RowBox[{"CompilePrint", "@", "conditionpTcuts"}], ";"}]}], "Input",
 CellChangeTimes->{{3.9055326298577223`*^9, 3.9055328326419477`*^9}, {
   3.905533244366785*^9, 3.9055332465225167`*^9}, 3.9055338822304444`*^9, {
   3.910176164824113*^9, 3.910176168304602*^9}, {3.912504383534126*^9, 
   3.9125043835352573`*^9}, {3.912534564608594*^9, 3.912534653708722*^9}, {
   3.9186648905328026`*^9, 3.918664895156022*^9}},
 CellLabel->"In[75]:=",ExpressionUUID->"2b046f74-4229-4675-9a3c-8a7068a28ae9"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Decay products pair - Impact parameter cut", "Subsubsection",
 CellChangeTimes->{{3.905532547151104*^9, 3.905532550125354*^9}, 
   3.9055341132116985`*^9},ExpressionUUID->"323ac7f5-a051-4f34-b6c4-\
0bbccaf757a4"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"conditionIPcuts", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"IPcutid", "=", "IPcutID"}], "}"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Hold", "@", 
         RowBox[{"Compile", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"pdg1", ",", "_Real"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"pdg2", ",", "_Real"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"xdecayfip", ",", "_Real"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"ydecayfip", ",", "_Real"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"zfip", ",", "_Real"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"px1lab", ",", "_Real"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"px2lab", ",", "_Real"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"py1lab", ",", "_Real"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"py2lab", ",", "_Real"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"pz1lab", ",", "_Real"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"pz2lab", ",", "_Real"}], "}"}]}], "}"}], ",", 
           RowBox[{"Module", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"cond", "=", "1."}], ",", "ipcut", ",", "ip12"}], 
              "}"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"ipcut", "=", 
               SuperscriptBox[
                RowBox[{"IPcutid", "[", 
                 RowBox[{"pdg1", ",", "pdg2"}], "]"}], "2"]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"ipcut", "\[NotEqual]", 
                 SuperscriptBox["IPcutZero", "2"]}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"ip12", "=", 
                  RowBox[{"IPproductzTargetSquared", "[", 
                   RowBox[{
                   "xdecayfip", ",", "ydecayfip", ",", "zfip", ",", "px1lab", 
                    ",", "px2lab", ",", "py1lab", ",", "py2lab", ",", 
                    "pz1lab", ",", "pz2lab"}], "]"}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"cond", "=", 
                  RowBox[{"Boole", "[", 
                   RowBox[{"ip12", "<", "ipcut"}], "]"}]}]}]}], "]"}], ";", 
              "\[IndentingNewLine]", "cond"}]}], "\[IndentingNewLine]", "]"}],
            ",", 
           RowBox[{"CompilationTarget", "->", "\"\<C\>\""}], ",", 
           RowBox[{"RuntimeOptions", "->", "\"\<Speed\>\""}], ",", 
           RowBox[{"RuntimeAttributes", "->", 
            RowBox[{"{", "Listable", "}"}]}], ",", 
           RowBox[{"Parallelization", "->", "True"}]}], "]"}]}], "/.", 
        RowBox[{"ruleDown", "[", 
         RowBox[{"{", "IPproductzTargetSquared", "}"}], "]"}]}], "/.", 
       RowBox[{"ruleOwn", "[", 
        RowBox[{"{", "IPcutZero", "}"}], "]"}]}], "//", "ReleaseHold"}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"<<", "CompiledFunctionTools`"}], "\n", 
 RowBox[{
  RowBox[{"CompilePrint", "@", "conditionIPcuts"}], ";"}]}], "Input",
 CellChangeTimes->{{3.905532838134986*^9, 3.905532879137568*^9}, {
   3.905532922473439*^9, 3.90553309818943*^9}, 3.905533880228113*^9, 
   3.9056739470479393`*^9, {3.912534693358762*^9, 3.912534773251195*^9}, {
   3.917710952569955*^9, 3.9177109584186616`*^9}, {3.9186648994261446`*^9, 
   3.91866490660804*^9}},
 CellLabel->"In[78]:=",ExpressionUUID->"aa247068-1609-4472-8412-bf180521a78e"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Decay products pair - angular cut ", "Subsubsection",
 CellChangeTimes->{{3.905532547151104*^9, 3.9055325827367506`*^9}, {
   3.9055341162903185`*^9, 3.9055341166128693`*^9}, {3.914993624695646*^9, 
   3.9149936347097588`*^9}, 
   3.9151896063065534`*^9},ExpressionUUID->"c2ac6355-4f9c-442e-a462-\
bbb27e3ced44"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"angres", "=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"GivenExperiment", "==", "\"\<SHiNESS\>\""}], ",", 
     RowBox[{"10", "*", 
      FractionBox["Pi", "180."]}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"GivenExperiment", "!=", "\"\<SHiNESS\>\""}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"conditionAngSepCuts", "=", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"AngSepCutid", "=", "AngSepCutID"}], "}"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Hold", "@", 
           RowBox[{"Compile", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"pdg1", ",", "_Real"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"pdg2", ",", "_Real"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"zfip", ",", "_Real"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"px1lab", ",", "_Real"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"px2lab", ",", "_Real"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"py1lab", ",", "_Real"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"py2lab", ",", "_Real"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"pz1lab", ",", "_Real"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"pz2lab", ",", "_Real"}], "}"}]}], "}"}], ",", 
             RowBox[{"Module", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"cond", "=", "1."}], ",", "angsepcut", ",", "ss12"}],
                 "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"(*", 
                RowBox[{"Minimal", " ", "separation", " ", "in", " ", "rad"}],
                 "*)"}], "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"angsepcut", "=", 
                 RowBox[{"AngSepCutid", "[", 
                  RowBox[{"pdg1", ",", "pdg2"}], "]"}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"angsepcut", "\[NotEqual]", "AngSepCutZero"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"(*", 
                   RowBox[{"cos", 
                    RowBox[{"(", 
                    SubscriptBox["\[Theta]", 
                    RowBox[{"between", " ", "decay", " ", "products"}]], 
                    ")"}]}], "*)"}], "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"ss12", "=", 
                    RowBox[{"CosAngleProducts", "[", 
                    RowBox[{
                    "px1lab", ",", "px2lab", ",", "py1lab", ",", "py2lab", 
                    ",", "pz1lab", ",", "pz2lab"}], "]"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"(*", 
                    RowBox[{"Boolean", " ", "condition"}], "*)"}], 
                   "\[IndentingNewLine]", 
                   RowBox[{"cond", "=", 
                    RowBox[{"Boole", "[", 
                    RowBox[{"ss12", "<", 
                    RowBox[{"Cos", "[", "angsepcut", "]"}]}], "]"}]}]}]}], 
                 "]"}], ";", "\[IndentingNewLine]", "cond"}]}], 
              "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", ",", 
             RowBox[{"CompilationTarget", "->", "\"\<C\>\""}], ",", 
             RowBox[{"RuntimeOptions", "->", "\"\<Speed\>\""}], ",", 
             RowBox[{"RuntimeAttributes", "->", 
              RowBox[{"{", "Listable", "}"}]}], ",", 
             RowBox[{"Parallelization", "->", "True"}]}], "]"}]}], "/.", 
          RowBox[{"ruleDown", "[", 
           RowBox[{"{", 
            RowBox[{"AngSepCutID", ",", "CosAngleProducts"}], "}"}], "]"}]}], 
         "/.", 
         RowBox[{"ruleOwn", "[", 
          RowBox[{"{", "AngSepCutZero", "}"}], "]"}]}], "//", 
        "ReleaseHold"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", ",", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"conditionAngSepCuts", "=", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"AngSepCutid", "=", "AngSepCutID"}], "}"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Hold", "@", 
           RowBox[{"Compile", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"pdg1", ",", "_Real"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"pdg2", ",", "_Real"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"zfip", ",", "_Real"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"px1lab", ",", "_Real"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"px2lab", ",", "_Real"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"py1lab", ",", "_Real"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"py2lab", ",", "_Real"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"pz1lab", ",", "_Real"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"pz2lab", ",", "_Real"}], "}"}]}], "}"}], ",", 
             RowBox[{"Module", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"cond", "=", "1."}], ",", "angsepcut", ",", "ss12", 
                 ",", 
                 RowBox[{"u1", "=", "0."}], ",", 
                 RowBox[{"u2", "=", "0."}], ",", 
                 RowBox[{"z", "=", "0."}]}], "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"(*", 
                RowBox[{"Minimal", " ", "separation", " ", "in", " ", "rad"}],
                 "*)"}], "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"angsepcut", "=", 
                 RowBox[{"AngSepCutid", "[", 
                  RowBox[{"pdg1", ",", "pdg2"}], "]"}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"angsepcut", "\[NotEqual]", "AngSepCutZero"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"(*", 
                   RowBox[{
                    RowBox[{"cos", 
                    RowBox[{"(", 
                    SubscriptBox["\[Theta]", 
                    RowBox[{"between", " ", "decay", " ", "products"}]], 
                    ")"}]}], ",", " ", 
                    RowBox[{
                    "including", " ", "the", " ", "gaussian", " ", "smearing",
                     " ", "from", " ", 
                    RowBox[{"detector", "'"}], "s", " ", "resolution"}]}], 
                   "*)"}], "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"u1", "=", 
                    RowBox[{"RandomReal", "[", 
                    RowBox[{"{", 
                    RowBox[{"0.", ",", "1."}], "}"}], "]"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"u2", "=", 
                    RowBox[{"RandomReal", "[", 
                    RowBox[{"{", 
                    RowBox[{"0.", ",", "1."}], "}"}], "]"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"z", "=", 
                    RowBox[{
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"-", "2."}], " ", 
                    RowBox[{"Log", "[", "u1", "]"}]}], "]"}], " ", 
                    RowBox[{"Cos", "[", 
                    RowBox[{"2.", " ", "Pi", " ", "u2"}], "]"}]}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"ss12", "=", 
                    RowBox[{"ArcCos", "[", 
                    RowBox[{"Cos", "[", 
                    RowBox[{
                    RowBox[{"ArcCos", "[", 
                    RowBox[{"CosAngleProducts", "[", 
                    RowBox[{
                    "px1lab", ",", "px2lab", ",", "py1lab", ",", "py2lab", 
                    ",", "pz1lab", ",", "pz2lab"}], "]"}], "]"}], "+", 
                    RowBox[{"angres", "*", "z"}]}], "]"}], "]"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"(*", 
                    RowBox[{"Boolean", " ", "condition"}], "*)"}], 
                   "\[IndentingNewLine]", 
                   RowBox[{"cond", "=", 
                    RowBox[{"Boole", "[", 
                    RowBox[{"ss12", ">", "angsepcut"}], "]"}]}]}]}], "]"}], 
                ";", "\[IndentingNewLine]", "cond"}]}], "\[IndentingNewLine]",
               "]"}], "\[IndentingNewLine]", ",", 
             RowBox[{"CompilationTarget", "->", "\"\<C\>\""}], ",", 
             RowBox[{"RuntimeOptions", "->", "\"\<Speed\>\""}], ",", 
             RowBox[{"RuntimeAttributes", "->", 
              RowBox[{"{", "Listable", "}"}]}], ",", 
             RowBox[{"Parallelization", "->", "True"}]}], "]"}]}], "/.", 
          RowBox[{"ruleDown", "[", 
           RowBox[{"{", 
            RowBox[{
            "AngSepCutID", ",", "CosAngleProducts", ",", "InverseCDFffplus"}],
             "}"}], "]"}]}], "/.", 
         RowBox[{"ruleOwn", "[", 
          RowBox[{"{", 
           RowBox[{"AngSepCutZero", ",", "angres"}], "}"}], "]"}]}], "//", 
        "ReleaseHold"}]}], "]"}]}], ";"}]}], "\[IndentingNewLine]", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"<<", "CompiledFunctionTools`"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"CompilePrint", "@", "conditionAngSepCuts"}], ";"}]}], "Input",
 CellChangeTimes->{{3.9055331880335803`*^9, 3.905533227740013*^9}, {
   3.9055332587958794`*^9, 3.9055333488766437`*^9}, 3.9055341200082865`*^9, {
   3.9125347829629927`*^9, 3.912534814263256*^9}, {3.9149934654293003`*^9, 
   3.914993465444955*^9}, {3.914993746928336*^9, 3.914993837683897*^9}, {
   3.9151896025630646`*^9, 3.9151896261796837`*^9}, {3.915189767092677*^9, 
   3.9151897826396627`*^9}, {3.9151898390658555`*^9, 3.915189861619813*^9}, 
   3.91520659484346*^9, 3.915637993764516*^9, {3.9156383983716383`*^9, 
   3.9156385613285894`*^9}, 3.915638753808144*^9, {3.915639231757437*^9, 
   3.915639232471761*^9}, {3.9158608819722357`*^9, 3.915860929786686*^9}, {
   3.915865289151552*^9, 3.9158653066992006`*^9}, {3.9158665040979395`*^9, 
   3.9158665061303263`*^9}, {3.917710941664226*^9, 3.917710948760466*^9}, {
   3.9186649111126723`*^9, 3.9186649170767107`*^9}},
 CellLabel->"In[81]:=",ExpressionUUID->"bc804652-2340-4eb2-8be5-ebfb08c0447e"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Decay products pair - spatial separation cut ", "Subsubsection",
 CellChangeTimes->{{3.905532547151104*^9, 3.9055325827367506`*^9}, {
   3.9055341162903185`*^9, 3.9055341166128693`*^9}, {3.914993624695646*^9, 
   3.9149936347097588`*^9}, 3.9151896063065534`*^9, {3.918663151499013*^9, 
   3.9186631540048018`*^9}},ExpressionUUID->"788b5518-807f-472b-8354-\
341fb679729f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"conditionSScutsOld", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"SScutid", "=", "SScutID"}], "}"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Hold", "@", 
         RowBox[{"Compile", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"pdg1", ",", "_Real"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"pdg2", ",", "_Real"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"zfip", ",", "_Real"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"px1lab", ",", "_Real"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"px2lab", ",", "_Real"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"py1lab", ",", "_Real"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"py2lab", ",", "_Real"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"pz1lab", ",", "_Real"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"pz2lab", ",", "_Real"}], "}"}]}], "}"}], ",", 
           RowBox[{"Module", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"cond", "=", "1."}], ",", "sscut", ",", 
               RowBox[{"sssquared", "=", "0."}], ",", 
               RowBox[{"coordprojval", "=", "0."}]}], "}"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{"Minimal", " ", "separation", " ", "in", " ", "rad"}], 
              "*)"}], "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"sscut", "=", 
               RowBox[{"SScutID", "[", 
                RowBox[{"pdg1", ",", "pdg2"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"sscut", "\[NotEqual]", "SScutZero"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"coordprojval", "=", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"pdg1", "==", "22."}], "||", 
                    RowBox[{"pdg1", "==", "130."}]}], ",", 
                    "ECALpositionGivenExperiment", ",", 
                    "zMaxDecayVolumeGivenExperiment"}], "]"}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"sssquared", "=", 
                  RowBox[{"SSproductsSquaredOld", "[", 
                   RowBox[{
                   "zfip", ",", "px1lab", ",", "px2lab", ",", "py1lab", ",", 
                    "py2lab", ",", "pz1lab", ",", "pz2lab", ",", 
                    "coordprojval"}], "]"}]}], ";", "\[IndentingNewLine]", 
                 RowBox[{"(*", 
                  RowBox[{"Boolean", " ", "condition"}], "*)"}], 
                 "\[IndentingNewLine]", 
                 RowBox[{"cond", "=", 
                  RowBox[{"Boole", "[", 
                   RowBox[{"sssquared", ">", 
                    SuperscriptBox["sscut", "2"]}], "]"}]}]}]}], "]"}], ";", 
              "\[IndentingNewLine]", "cond"}]}], "\[IndentingNewLine]", "]"}],
            "\[IndentingNewLine]", ",", 
           RowBox[{"CompilationTarget", "->", "\"\<C\>\""}], ",", 
           RowBox[{"RuntimeOptions", "->", "\"\<Speed\>\""}], ",", 
           RowBox[{"RuntimeAttributes", "->", 
            RowBox[{"{", "Listable", "}"}]}], ",", 
           RowBox[{"Parallelization", "->", "True"}], ",", 
           RowBox[{"CompilationOptions", "->", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"\"\<InlineExternalDefinitions\>\"", "->", "True"}], 
              ",", 
              RowBox[{"\"\<InlineCompiledFunctions\>\"", "->", "True"}]}], 
             "}"}]}]}], "]"}]}], "/.", 
        RowBox[{"ruleDown", "[", 
         RowBox[{"{", 
          RowBox[{"SScutID", ",", "SSproductsSquaredOld"}], "}"}], "]"}]}], "/.", 
       RowBox[{"ruleOwn", "[", 
        RowBox[{"{", 
         RowBox[{
         "SScutZero", ",", "ECALpositionGivenExperiment", ",", 
          "zMaxDecayVolumeGivenExperiment"}], "}"}], "]"}]}], "//", 
      "ReleaseHold"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"<<", "CompiledFunctionTools`"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"CompilePrint", "@", "conditionSScutsOld"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"conditionSScuts", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"SScutid", "=", "SScutID"}], "}"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Hold", "@", 
         RowBox[{"Compile", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"pdg1", ",", "_Real"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"pdg2", ",", "_Real"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"xfin1", ",", "_Real"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"xfin2", ",", "_Real"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"yfin1", ",", "_Real"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"yfin2", ",", "_Real"}], "}"}]}], "}"}], ",", 
           RowBox[{"Module", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"cond", "=", "1."}], ",", "sscut", ",", 
               RowBox[{"sssquared", "=", "0."}], ",", 
               RowBox[{"coordprojval", "=", "0."}]}], "}"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{"Minimal", " ", "separation", " ", "in", " ", "rad"}], 
              "*)"}], "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"sscut", "=", 
               RowBox[{"SScutID", "[", 
                RowBox[{"pdg1", ",", "pdg2"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"sscut", "\[NotEqual]", "SScutZero"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"sssquared", "=", 
                  RowBox[{"SSproductsSquared", "[", 
                   RowBox[{
                   "xfin1", ",", "xfin2", ",", "yfin1", ",", "yfin2"}], 
                   "]"}]}], ";", "\[IndentingNewLine]", 
                 RowBox[{"(*", 
                  RowBox[{"Boolean", " ", "condition"}], "*)"}], 
                 "\[IndentingNewLine]", 
                 RowBox[{"cond", "=", 
                  RowBox[{"Boole", "[", 
                   RowBox[{"sssquared", ">", 
                    SuperscriptBox["sscut", "2"]}], "]"}]}]}]}], "]"}], ";", 
              "\[IndentingNewLine]", "cond"}]}], "\[IndentingNewLine]", "]"}],
            "\[IndentingNewLine]", ",", 
           RowBox[{"CompilationTarget", "->", "\"\<C\>\""}], ",", 
           RowBox[{"RuntimeOptions", "->", "\"\<Speed\>\""}], ",", 
           RowBox[{"RuntimeAttributes", "->", 
            RowBox[{"{", "Listable", "}"}]}], ",", 
           RowBox[{"Parallelization", "->", "True"}], ",", 
           RowBox[{"CompilationOptions", "->", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"\"\<InlineExternalDefinitions\>\"", "->", "True"}], 
              ",", 
              RowBox[{"\"\<InlineCompiledFunctions\>\"", "->", "True"}]}], 
             "}"}]}]}], "]"}]}], "/.", 
        RowBox[{"ruleDown", "[", 
         RowBox[{"{", 
          RowBox[{"SScutID", ",", "SSproductsSquared"}], "}"}], "]"}]}], "/.", 
       RowBox[{"ruleOwn", "[", 
        RowBox[{"{", "SScutZero", "}"}], "]"}]}], "//", "ReleaseHold"}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"<<", "CompiledFunctionTools`"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"CompilePrint", "@", "conditionSScuts"}], ";"}]}], "Input",
 CellChangeTimes->{{3.9055331880335803`*^9, 3.905533227740013*^9}, {
   3.9055332587958794`*^9, 3.9055333488766437`*^9}, 3.9055341200082865`*^9, {
   3.9125347829629927`*^9, 3.912534814263256*^9}, {3.9149934654293003`*^9, 
   3.914993465444955*^9}, {3.914993746928336*^9, 3.914993837683897*^9}, {
   3.9151896025630646`*^9, 3.9151896261796837`*^9}, {3.915189767092677*^9, 
   3.9151897826396627`*^9}, {3.9151898390658555`*^9, 3.915189861619813*^9}, 
   3.91520659484346*^9, 3.915637993764516*^9, {3.9156383983716383`*^9, 
   3.9156385613285894`*^9}, 3.915638753808144*^9, {3.915639231757437*^9, 
   3.915639232471761*^9}, {3.9158608819722357`*^9, 3.915860929786686*^9}, {
   3.915865289151552*^9, 3.9158653066992006`*^9}, {3.9158665040979395`*^9, 
   3.9158665061303263`*^9}, {3.9186631663509665`*^9, 
   3.9186632476310177`*^9}, {3.9186632960470977`*^9, 
   3.9186634097489343`*^9}, {3.918663446811565*^9, 3.9186634797061815`*^9}, {
   3.9186635647224903`*^9, 3.9186636074555073`*^9}, {3.91866366202991*^9, 
   3.9186636621893425`*^9}, {3.918663773718376*^9, 3.9186637863848286`*^9}, {
   3.9186638657049093`*^9, 3.918663877700884*^9}, {3.9186639201372433`*^9, 
   3.918663941598735*^9}, 3.9186649214909472`*^9, {3.918664965852807*^9, 
   3.918664972492541*^9}, {3.918665062283615*^9, 3.9186650702147465`*^9}, {
   3.9186651075220647`*^9, 3.9186651129568744`*^9}, {3.919010428061661*^9, 
   3.9190105237161236`*^9}},
 CellLabel->"In[85]:=",ExpressionUUID->"1abe4436-0741-4770-8209-f900e1a9baa1"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Decay products pair - Invariant mass cut", "Subsubsection",
 CellChangeTimes->{{3.905532547151104*^9, 3.9055325827367506`*^9}, {
   3.9055326722485633`*^9, 3.905532675159629*^9}, 
   3.905534118019686*^9},ExpressionUUID->"12771194-9fc3-48a6-8133-\
04f746a35664"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"conditionminvCuts", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"minvCutLowerid", "=", "minvCutLowerID"}], ",", 
       RowBox[{"minvCutUpperid", "=", "minvCutUpperID"}]}], "}"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Hold", "@", 
         RowBox[{"Compile", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"pdg1", ",", "_Real"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"charge1", ",", "_Real"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"pdg2", ",", "_Real"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"px1lab", ",", "_Real"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"py1lab", ",", "_Real"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"pz1lab", ",", "_Real"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"E1lab", ",", "_Real"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"px2lab", ",", "_Real"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"py2lab", ",", "_Real"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"pz2lab", ",", "_Real"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"E2lab", ",", "_Real"}], "}"}]}], "}"}], ",", 
           RowBox[{"Module", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"cond", "=", "1."}], ",", 
               RowBox[{"minv2cutlow", "=", 
                SuperscriptBox["minvCutLowerZero", "2"]}], ",", 
               RowBox[{"minv2cutupp", "=", 
                SuperscriptBox["minvCutUpperZero", "2"]}], ",", "minv2val"}], 
              "}"}], ",", "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{
              "Minimal", " ", "spatial", " ", "separation", " ", "cut", " ", 
               "for", " ", "the", " ", "decay", " ", "products"}], "*)"}], 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"IfminvLowerCuts", "==", "1"}], ",", 
                RowBox[{"minv2cutlow", "=", 
                 SuperscriptBox[
                  RowBox[{"minvCutLowerid", "[", 
                   RowBox[{"pdg1", ",", "charge1", ",", "pdg2"}], "]"}], 
                  "2"]}]}], "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"IfminvUpperCuts", "==", "1"}], ",", 
                RowBox[{"minv2cutupp", "=", 
                 SuperscriptBox[
                  RowBox[{"minvCutUpperid", "[", 
                   RowBox[{"pdg1", ",", "charge1", ",", "pdg2"}], "]"}], 
                  "2"]}]}], "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"minv2cutlow", "\[NotEqual]", 
                   SuperscriptBox["minvCutLowerZero", "2"]}], "||", 
                  RowBox[{"minv2cutupp", "\[NotEqual]", 
                   SuperscriptBox["minvCutUpperZero", "2"]}]}], ")"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"minv2val", "=", 
                  RowBox[{"minvProductsSquared", "[", 
                   RowBox[{
                   "px1lab", ",", "py1lab", ",", "pz1lab", ",", "E1lab", ",", 
                    "px2lab", ",", "py2lab", ",", "pz2lab", ",", "E2lab"}], 
                   "]"}]}], ";", "\[IndentingNewLine]", 
                 RowBox[{"cond", "=", 
                  RowBox[{"Boole", "[", 
                   RowBox[{
                   "minv2cutlow", "<=", "minv2val", "<=", "minv2cutupp"}], 
                   "]"}]}]}]}], "]"}], ";", "\[IndentingNewLine]", "cond"}]}],
             "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", ",", 
           RowBox[{"CompilationTarget", "->", "\"\<C\>\""}], ",", 
           RowBox[{"RuntimeOptions", "->", "\"\<Speed\>\""}], ",", 
           RowBox[{"RuntimeAttributes", "->", 
            RowBox[{"{", "Listable", "}"}]}], ",", 
           RowBox[{"Parallelization", "->", "True"}]}], "]"}]}], "/.", 
        RowBox[{"ruleDown", "[", 
         RowBox[{"{", "minvProductsSquared", "}"}], "]"}]}], "/.", 
       RowBox[{"ruleOwn", "[", 
        RowBox[{"{", 
         RowBox[{
         "minvCutLowerZero", ",", "minvCutUpperZero", ",", "IfminvLowerCuts", 
          ",", "IfminvUpperCuts"}], "}"}], "]"}]}], "//", "ReleaseHold"}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"<<", "CompiledFunctionTools`"}], "\n", 
 RowBox[{
  RowBox[{"CompilePrint", "@", "conditionminvCuts"}], ";"}]}], "Input",
 CellChangeTimes->{{3.905533232079184*^9, 3.905533238078718*^9}, {
   3.9055333661554675`*^9, 3.9055335187311*^9}, 3.9055339005920033`*^9, {
   3.9058468091766605`*^9, 3.9058468832558556`*^9}, {3.912534819977749*^9, 
   3.912534895817213*^9}, {3.9177109313329067`*^9, 3.9177109393185472`*^9}},
 CellLabel->"In[91]:=",ExpressionUUID->"1ecf763b-bf2e-4a41-8c4a-2c3c507abac6"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Full routine calculating the decay products acceptance", "Subsection",
 CellChangeTimes->{{3.9055341759863997`*^9, 
  3.905534187349038*^9}},ExpressionUUID->"b696c8fe-c8d5-4cd7-a9cd-\
3cd5b84c7eab"],

Cell[CellGroupData[{

Cell["At least two particles pass the acceptance criteria", "Subsubsection",
 CellChangeTimes->{
  3.9055274151004214`*^9, {3.90553407587924*^9, 3.9055340775446243`*^9}, {
   3.905534124633428*^9, 3.9055341308552237`*^9}, {3.905534192713667*^9, 
   3.9055342031436033`*^9}},ExpressionUUID->"51295e41-4d8b-4871-a652-\
b56ef4cecf3d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"DecayAcceptanceComp", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"CondGeom", "=", "conditionDecayAcceptanceGeometric"}], ",", 
       RowBox[{"CondMinv", "=", "conditionminvCuts"}], ",", 
       RowBox[{"CondAS", "=", "conditionAngSepCuts"}], ",", 
       RowBox[{"CondSS", "=", "conditionSScuts"}], ",", 
       RowBox[{"CondIP", "=", "conditionIPcuts"}], ",", 
       RowBox[{"CondPT", "=", "conditionpTcuts"}], ",", 
       RowBox[{"CondE", "=", "conditionEnergyCuts"}]}], "}"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Hold", "@", 
         RowBox[{"Compile", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"MotherData", ",", "_Real", ",", "1"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"DaughterData", ",", "_Real", ",", "1"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"nprodmax", ",", "_Integer"}], "}"}]}], "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Module", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
              "mLLP", ",", "cond", ",", "count", ",", 
               "FirstCoordinateProduct1", ",", "SecondCoordinateProduct1", 
               ",", "FirstCoordinateProduct2", ",", 
               "SecondCoordinateProduct2", ",", "efip", ",", "xfip", ",", 
               "yfip", ",", "zfip", ",", 
               RowBox[{"px1lab", "=", "0."}], ",", 
               RowBox[{"px2lab", "=", "0."}], ",", 
               RowBox[{"py1lab", "=", "0."}], ",", 
               RowBox[{"py2lab", "=", "0."}], ",", 
               RowBox[{"pz1lab", "=", "0."}], ",", 
               RowBox[{"pz2lab", "=", "0."}], ",", "pdg1", ",", "pdg2", ",", 
               RowBox[{"E1lab", "=", "0."}], ",", 
               RowBox[{"E2lab", "=", "0."}], ",", "charge1", ",", "charge2", 
               ",", 
               RowBox[{"nproducts", "=", "0"}], ",", 
               RowBox[{"f1max", "=", "0"}], ",", "zmagnMzfip", ",", 
               RowBox[{"in1", "=", "0"}], ",", 
               RowBox[{"in2", "=", "0"}], ",", 
               RowBox[{"min", "=", "0"}], ",", "pxfip", ",", "pyfip", ",", 
               "pzfip", ",", "pfip", ",", 
               RowBox[{"coord1fin1", "=", "0."}], ",", 
               RowBox[{"coord2fin1", "=", "0."}], ",", 
               RowBox[{"coord1fin2", "=", "0."}], ",", 
               RowBox[{"coord2fin2", "=", "0."}]}], "}"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"count", "=", " ", "0."}], ";", "\[IndentingNewLine]", 
              RowBox[{"(*", 
               RowBox[{
                RowBox[{"Values", " ", "of", " ", "the", " ", "LLP", " ", 
                 SubscriptBox["\[Epsilon]", "az"]}], ",", " ", "E", ",", " ", 
                "\[Theta]", ",", " ", "\[Phi]", ",", " ", 
                SubscriptBox["x", "long"]}], "*)"}], "\[IndentingNewLine]", 
              RowBox[{"xfip", "=", 
               RowBox[{"Compile`GetElement", "[", 
                RowBox[{"MotherData", ",", "indexxdec"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"yfip", "=", 
               RowBox[{"Compile`GetElement", "[", 
                RowBox[{"MotherData", ",", "indexydec"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"zfip", "=", 
               RowBox[{"Compile`GetElement", "[", 
                RowBox[{"MotherData", ",", "indexzdec"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"mLLP", "=", 
               RowBox[{"Compile`GetElement", "[", 
                RowBox[{"MotherData", ",", "indexm1"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"(*", 
               RowBox[{
               "Distance", " ", "between", " ", "the", " ", "end", " ", "of", 
                " ", "the", " ", "dipole", " ", "magnet", " ", "and", " ", 
                "the", " ", "LLP", " ", "decay", " ", "point"}], "*)"}], 
              "\[IndentingNewLine]", 
              RowBox[{"zmagnMzfip", "=", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"zfip", "<", "zMagnetMinGivenExperiment"}], ",", 
                 RowBox[{
                 "zMagnetMaxGivenExperiment", "-", 
                  "zMagnetMinGivenExperiment"}], ",", 
                 RowBox[{"zMagnetMaxGivenExperiment", "-", "zfip"}]}], 
                "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"f1max", "=", 
               RowBox[{"nprodmax", "-", "1"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"cond", "=", "0."}], ";", "\[IndentingNewLine]", 
              RowBox[{"(*", 
               RowBox[{"Looping", " ", "over", " ", "product1"}], "*)"}], 
              "\[IndentingNewLine]", 
              RowBox[{"Do", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{
                 RowBox[{"in1", "=", "f1"}], ";", "\[IndentingNewLine]", 
                 RowBox[{"(*", 
                  RowBox[{
                  "Electric", " ", "charge", " ", "of", " ", "the", " ", 
                   "decay", " ", "product"}], "*)"}], "\[IndentingNewLine]", 
                 RowBox[{"charge1", "=", 
                  RowBox[{"Compile`GetElement", "[", 
                   RowBox[{"DaughterData", ",", 
                    RowBox[{
                    RowBox[{"LengthDataProduct1", "*", 
                    RowBox[{"(", 
                    RowBox[{"in1", "-", "1"}], ")"}]}], "+", 
                    "indexcharge1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"charge1", "==", "999."}], ",", 
                   RowBox[{"Break", "[", "]"}]}], "]"}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"(*", 
                  RowBox[{
                  "Calculating", " ", "the", " ", "geometric", " ", "part", 
                   " ", "of", " ", "the", " ", "decay", " ", "acceptance", 
                   " ", "for", " ", "the", " ", "first", " ", "decay", " ", 
                   "product"}], "*)"}], "\[IndentingNewLine]", 
                 RowBox[{"pdg1", "=", 
                  RowBox[{"Compile`GetElement", "[", 
                   RowBox[{"DaughterData", ",", 
                    RowBox[{
                    RowBox[{"LengthDataProduct1", "*", 
                    RowBox[{"(", 
                    RowBox[{"in1", "-", "1"}], ")"}]}], "+", "indexpdg1"}]}], 
                   "]"}]}], ";", "\[IndentingNewLine]", 
                 RowBox[{"(*", 
                  RowBox[{"4", "-", 
                   RowBox[{
                   "momentum", " ", "of", " ", "the", " ", "decay", " ", 
                    "product", " ", "at", " ", 
                    RowBox[{"LLP", "'"}], "s", " ", "lab", " ", "frame"}]}], 
                  "*)"}], "\[IndentingNewLine]", 
                 RowBox[{"px1lab", "=", 
                  RowBox[{"Compile`GetElement", "[", 
                   RowBox[{"DaughterData", ",", 
                    RowBox[{
                    RowBox[{"LengthDataProduct1", "*", 
                    RowBox[{"(", 
                    RowBox[{"in1", "-", "1"}], ")"}]}], "+", "indexpx1"}]}], 
                   "]"}]}], ";", "\[IndentingNewLine]", 
                 RowBox[{"py1lab", "=", 
                  RowBox[{"Compile`GetElement", "[", 
                   RowBox[{"DaughterData", ",", 
                    RowBox[{
                    RowBox[{"LengthDataProduct1", "*", 
                    RowBox[{"(", 
                    RowBox[{"in1", "-", "1"}], ")"}]}], "+", "indexpy1"}]}], 
                   "]"}]}], ";", "\[IndentingNewLine]", 
                 RowBox[{"pz1lab", "=", 
                  RowBox[{"Compile`GetElement", "[", 
                   RowBox[{"DaughterData", ",", 
                    RowBox[{
                    RowBox[{"LengthDataProduct1", "*", 
                    RowBox[{"(", 
                    RowBox[{"in1", "-", "1"}], ")"}]}], "+", "indexpz1"}]}], 
                   "]"}]}], ";", "\[IndentingNewLine]", 
                 RowBox[{"E1lab", "=", 
                  RowBox[{"Compile`GetElement", "[", 
                   RowBox[{"DaughterData", ",", 
                    RowBox[{
                    RowBox[{"LengthDataProduct1", "*", 
                    RowBox[{"(", 
                    RowBox[{"in1", "-", "1"}], ")"}]}], "+", "indexE1"}]}], 
                   "]"}]}], ";", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"cond", ",", "coord1fin1", ",", "coord2fin1"}], 
                   "}"}], "=", 
                  RowBox[{"CondGeom", "[", 
                   RowBox[{
                   "charge1", ",", "pdg1", ",", "xfip", ",", "yfip", ",", 
                    "zfip", ",", "px1lab", ",", "py1lab", ",", "pz1lab", ",", 
                    "E1lab", ",", "zmagnMzfip"}], "]"}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"(*", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    "If", " ", "geometric", " ", "part", " ", "of", " ", 
                    "the", " ", "decay", " ", "acceptance", " ", "for", " ", 
                    "product1", " ", "is", " ", "non"}], "-", 
                    RowBox[{
                    "zero", " ", "then", " ", "proceeding", " ", "to", " ", 
                    RowBox[{"product2", ".", " ", "If"}], " ", "not"}]}], ",",
                    " ", 
                   RowBox[{
                   "then", " ", "go", " ", "to", " ", "the", " ", "other", 
                    " ", "product1"}]}], "*)"}], "\[IndentingNewLine]", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"cond", "==", "1"}], ",", "\[IndentingNewLine]", 
                   RowBox[{"Do", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"in2", "=", 
                    RowBox[{"in1", "+", "f2"}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{"charge2", "=", 
                    RowBox[{"Compile`GetElement", "[", 
                    RowBox[{"DaughterData", ",", 
                    RowBox[{
                    RowBox[{"LengthDataProduct1", "*", 
                    RowBox[{"(", 
                    RowBox[{"in2", "-", "1"}], ")"}]}], "+", 
                    "indexcharge1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"charge2", "==", "999."}], ",", 
                    RowBox[{"Break", "[", "]"}]}], "]"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{
                    RowBox[{
                    "If", " ", "the", " ", "total", " ", "electric", " ", 
                    "charge", " ", "of", " ", "the", " ", "pair", " ", "is", 
                    " ", "not", " ", "zero"}], ",", " ", 
                    RowBox[{
                    "then", " ", "the", " ", "acceptance", " ", "is", " ", 
                    "automatically", " ", "0.", " ", "If", " ", "zero"}], ",",
                     " ", 
                    RowBox[{
                    "the", " ", "the", " ", "routine", " ", "below", " ", 
                    "is", " ", "launched"}]}], "*)"}], "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"charge1", "!=", 
                    RowBox[{"-", "charge2"}]}], ",", " ", 
                    RowBox[{"cond", "=", "0"}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"px2lab", "=", 
                    RowBox[{"Compile`GetElement", "[", 
                    RowBox[{"DaughterData", ",", 
                    RowBox[{
                    RowBox[{"LengthDataProduct1", "*", 
                    RowBox[{"(", 
                    RowBox[{"in2", "-", "1"}], ")"}]}], "+", "indexpx1"}]}], 
                    "]"}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{"py2lab", "=", 
                    RowBox[{"Compile`GetElement", "[", 
                    RowBox[{"DaughterData", ",", 
                    RowBox[{
                    RowBox[{"LengthDataProduct1", "*", 
                    RowBox[{"(", 
                    RowBox[{"in2", "-", "1"}], ")"}]}], "+", "indexpy1"}]}], 
                    "]"}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{"pz2lab", "=", 
                    RowBox[{"Compile`GetElement", "[", 
                    RowBox[{"DaughterData", ",", 
                    RowBox[{
                    RowBox[{"LengthDataProduct1", "*", 
                    RowBox[{"(", 
                    RowBox[{"in2", "-", "1"}], ")"}]}], "+", "indexpz1"}]}], 
                    "]"}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{"E2lab", "=", 
                    RowBox[{"Compile`GetElement", "[", 
                    RowBox[{"DaughterData", ",", 
                    RowBox[{
                    RowBox[{"LengthDataProduct1", "*", 
                    RowBox[{"(", 
                    RowBox[{"in2", "-", "1"}], ")"}]}], "+", "indexE1"}]}], 
                    "]"}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Abs", "[", 
                    RowBox[{"px1rest", "+", "px2rest"}], "]"}], ">", 
                    SuperscriptBox["10", 
                    RowBox[{"-", "5."}]]}], ",", 
                    RowBox[{
                    RowBox[{"cond", "=", "0."}], ";", 
                    RowBox[{"Break", "[", "]"}], ";"}]}], "]"}], ";"}], 
                    "*)"}], "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{
                    "Calculating", " ", "the", " ", "geometric", " ", "part", 
                    " ", "of", " ", "the", " ", "decay", " ", "acceptance", 
                    " ", "for", " ", "the", " ", "second", " ", "decay", " ", 
                    "product"}], "*)"}], "\[IndentingNewLine]", 
                    RowBox[{"pdg2", "=", 
                    RowBox[{"Compile`GetElement", "[", 
                    RowBox[{"DaughterData", ",", 
                    RowBox[{
                    RowBox[{"LengthDataProduct1", "*", 
                    RowBox[{"(", 
                    RowBox[{"in2", "-", "1"}], ")"}]}], "+", "indexpdg1"}]}], 
                    "]"}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"cond", ",", "coord1fin2", ",", "coord2fin2"}], 
                    "}"}], "=", 
                    RowBox[{"CondGeom", "[", 
                    RowBox[{
                    "charge2", ",", "pdg2", ",", "xfip", ",", "yfip", ",", 
                    "zfip", ",", "px2lab", ",", "py2lab", ",", "pz2lab", ",", 
                    "E2lab", ",", "zmagnMzfip"}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{
                    "If", " ", "other", " ", "cuts", " ", "are", " ", 
                    "required", " ", "and", " ", "the", " ", "geometric", " ",
                     "condition", " ", "for", " ", "product2", " ", "is", " ",
                     "1", " ", "then", " ", "evaluate", " ", "the", " ", 
                    "acceptance", " ", "for", " ", "these", " ", "cuts"}], 
                    "*)"}], "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"cond", "==", "1."}], "&&", 
                    RowBox[{"WhetherCuts", "==", "1"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{
                    "PDG", " ", "identifiers", " ", "of", " ", "the", " ", 
                    "decay", " ", "products"}], "*)"}], "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{
                    "Values", " ", "of", " ", "the", " ", "energy", " ", 
                    "cuts", " ", "for", " ", "the", " ", "decay", " ", 
                    "products"}], "*)"}], "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"IfEcuts", "==", "1"}], "&&", 
                    RowBox[{"cond", "==", "1."}]}], ",", 
                    RowBox[{"cond", "=", 
                    RowBox[{"CondE", "[", 
                    RowBox[{
                    "pdg1", ",", "charge1", ",", "pdg2", ",", "E1lab", ",", 
                    "E2lab"}], "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{"The", " ", 
                    SubscriptBox["p", "T"], " ", 
                    RowBox[{"cut", ".", " ", "If"}], " ", "it", " ", "is", 
                    " ", "present", " ", "then", " ", "evaluate", " ", "the", 
                    " ", 
                    RowBox[{"acceptance", ".", " ", "If"}], " ", "not", " ", 
                    "then", " ", "proceeding", " ", "to", " ", "the", " ", 
                    "next", " ", "cut"}], "*)"}], "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"IfpTcuts", "==", "1"}], "&&", 
                    RowBox[{"cond", "\[Equal]", "1."}]}], ",", 
                    RowBox[{"cond", "=", 
                    RowBox[{"CondPT", "[", 
                    RowBox[{
                    "pdg1", ",", "charge1", ",", "pdg2", ",", "px1lab", ",", 
                    "py1lab", ",", "px2lab", ",", "py2lab"}], "]"}]}]}], 
                    "]"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{"The", " ", "IP", " ", 
                    RowBox[{"cut", ".", " ", "If"}], " ", "it", " ", "is", 
                    " ", "present", " ", "then", " ", "evaluate", " ", "the", 
                    " ", 
                    RowBox[{"acceptance", ".", " ", "If"}], " ", "not", " ", 
                    "then", " ", "proceeding", " ", "to", " ", "the", " ", 
                    "next", " ", "cut"}], "*)"}], "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"IfIPcuts", "==", "1"}], "&&", 
                    RowBox[{"cond", "\[Equal]", "1."}]}], ",", 
                    RowBox[{"cond", "=", 
                    RowBox[{"CondIP", "[", 
                    RowBox[{
                    "pdg1", ",", "pdg2", ",", "xfip", ",", "yfip", ",", 
                    "zfip", ",", "px1lab", ",", "px2lab", ",", "py1lab", ",", 
                    "py2lab", ",", "pz1lab", ",", "pz2lab"}], "]"}]}]}], 
                    "]"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{"The", " ", "spatial", " ", "separation", " ", 
                    RowBox[{"cut", ".", " ", "If"}], " ", "it", " ", "is", 
                    " ", "present", " ", "then", " ", "evaluate", " ", "the", 
                    " ", 
                    RowBox[{"acceptance", ".", " ", "If"}], " ", "not", " ", 
                    "then", " ", "proceeding", " ", "to", " ", "the", " ", 
                    "next", " ", "cut"}], "*)"}], "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"IfAngSepCuts", "==", "1"}], "&&", 
                    RowBox[{"cond", "\[Equal]", "1."}]}], ",", 
                    RowBox[{"cond", "=", 
                    RowBox[{"CondAS", "[", 
                    RowBox[{
                    "pdg1", ",", "pdg2", ",", "zfip", ",", "px1lab", ",", 
                    "px2lab", ",", "py1lab", ",", "py2lab", ",", "pz1lab", 
                    ",", "pz2lab"}], "]"}]}]}], "]"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{"The", " ", "spatial", " ", "separation", " ", 
                    RowBox[{"cut", ".", " ", "If"}], " ", "it", " ", "is", 
                    " ", "present", " ", "then", " ", "evaluate", " ", "the", 
                    " ", 
                    RowBox[{"acceptance", ".", " ", "If"}], " ", "not", " ", 
                    "then", " ", "proceeding", " ", "to", " ", "the", " ", 
                    "next", " ", "cut"}], "*)"}], "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"IfSScuts", "==", "1"}], "&&", 
                    RowBox[{"cond", "\[Equal]", "1."}]}], ",", 
                    RowBox[{"cond", "=", 
                    RowBox[{"CondSS", "[", 
                    RowBox[{
                    "pdg1", ",", "pdg2", ",", "coord1fin1", ",", "coord1fin2",
                     ",", "coord2fin1", ",", "coord2fin2"}], "]"}]}]}], "]"}],
                     ";", "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{
                    "The", " ", "invariant", " ", "mass", " ", "cut"}], 
                    "*)"}], "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"IfminvCuts", "==", "1"}], "&&", 
                    RowBox[{"cond", "\[Equal]", "1."}]}], ",", 
                    RowBox[{"cond", "=", 
                    RowBox[{"CondMinv", "[", 
                    RowBox[{
                    "pdg1", ",", "charge1", ",", "pdg2", ",", "px1lab", ",", 
                    "py1lab", ",", "pz1lab", ",", "E1lab", ",", "px2lab", ",",
                     "py2lab", ",", "pz2lab", ",", "E2lab"}], "]"}]}]}], 
                    "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{
                    RowBox[{
                    "If", " ", "the", " ", "acceptance", " ", "after", " ", 
                    "all", " ", "cuts", " ", "is", " ", "1"}], ",", " ", 
                    RowBox[{
                    "then", " ", "add", " ", "it", " ", "to", " ", "the", " ",
                     "counter", " ", "and", " ", "break", " ", "the", " ", 
                    "cycle"}]}], "*)"}], "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"cond", "==", "1."}], ",", 
                    RowBox[{"Break", "[", "]"}]}], "]"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"f2", ",", "1", ",", 
                    RowBox[{"nprodmax", "-", "f1"}], ",", "1"}], "}"}]}], 
                    "]"}]}], "\[IndentingNewLine]", "]"}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"(*", 
                  RowBox[{
                  "If", " ", "the", " ", "acceptance", " ", "is", " ", "1", 
                   " ", "then", " ", "exit", " ", "the", " ", "cycle"}], 
                  "*)"}], "\[IndentingNewLine]", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"cond", "==", "1."}], ",", 
                   RowBox[{"Break", "[", "]"}]}], "]"}]}], ",", 
                RowBox[{"{", 
                 RowBox[{"f1", ",", "1", ",", "f1max", ",", "1"}], "}"}]}], 
               "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"(*", 
               RowBox[{
               "Returns", " ", "the", " ", "decay", " ", "acceptance"}], 
               "*)"}], "\[IndentingNewLine]", 
              RowBox[{"{", "cond", "}"}]}]}], "\[IndentingNewLine]", "]"}], 
           ",", 
           RowBox[{"CompilationTarget", "\[Rule]", "\"\<C\>\""}], ",", 
           RowBox[{"RuntimeOptions", "\[Rule]", "\"\<Speed\>\""}], ",", 
           RowBox[{"RuntimeAttributes", "\[Rule]", 
            RowBox[{"{", "Listable", "}"}]}], ",", 
           RowBox[{"CompilationOptions", "->", 
            RowBox[{"{", 
             RowBox[{"\"\<InlineCompiledFunctions\>\"", "->", "True"}], 
             "}"}]}], ",", 
           RowBox[{"Parallelization", "\[Rule]", "True"}]}], "]"}]}], "/.", 
        RowBox[{"ruleDown", "[", 
         RowBox[{"{", 
          RowBox[{
          "LLPdecayVertexX", ",", "LLPdecayVertexY", ",", "pproductLab1Cart", 
           ",", "pproductLab2Cart", ",", "pproductLab3Cart", ",", 
           "EproductLabCart"}], "}"}], "]"}]}], "/.", 
       RowBox[{"ruleOwn", "[", 
        RowBox[{"{", 
         RowBox[{
         "indexpdg1", ",", "indexpx1", ",", "indexpy1", ",", "indexpz1", ",", 
          "indexE1", ",", "indexm1", ",", "LengthDataProduct1", ",", 
          "WhetherCuts", ",", "indexcharge1", ",", 
          "zMagnetMinGivenExperiment", ",", "zMagnetMaxGivenExperiment", ",", 
          "IfEcuts", ",", "IfpTcuts", ",", "IfAngSepCuts", ",", "IfIPcuts", 
          ",", "IfminvCuts", ",", "IfSScuts", ",", "indexxdec", ",", 
          "indexydec", ",", "indexzdec"}], "}"}], "]"}]}], "//", 
      "ReleaseHold"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"<<", "CompiledFunctionTools`"}], "\n", 
 RowBox[{
  RowBox[{"CompilePrint", "@", "DecayAcceptanceComp"}], ";"}]}], "Input",
 CellChangeTimes->{{3.9176877061119404`*^9, 3.917687765294483*^9}, {
   3.91768785510343*^9, 3.9176878558600416`*^9}, {3.917687910731824*^9, 
   3.9176879122251277`*^9}, {3.9176882844533987`*^9, 
   3.9176883851332903`*^9}, {3.9176884199914346`*^9, 3.917688553820019*^9}, {
   3.9176885872731543`*^9, 3.9176886611731176`*^9}, {3.9177107385686955`*^9, 
   3.9177107512271743`*^9}, {3.9177107883065653`*^9, 
   3.9177108186668663`*^9}, {3.9177108503519545`*^9, 3.91771091084111*^9}, {
   3.9177110438746233`*^9, 3.917711072047325*^9}, {3.91771660537302*^9, 
   3.917716639614005*^9}, {3.917717073769109*^9, 3.917717082108246*^9}, {
   3.9177172025927787`*^9, 3.917717210507467*^9}, 3.9177172935417356`*^9, {
   3.917717336463469*^9, 3.917717336603959*^9}, {3.91866418906499*^9, 
   3.9186642779579983`*^9}, 3.9186650163669596`*^9, 3.9186651299024115`*^9, {
   3.9190105357199697`*^9, 3.919010620000542*^9}, 3.9190107795010023`*^9, 
   3.9190108543999968`*^9, {3.9190662967288833`*^9, 3.9190662977401295`*^9}, {
   3.919067951800889*^9, 3.919067976010167*^9}, {3.919068637894473*^9, 
   3.9190686424738717`*^9}},
 CellLabel->
  "In[991]:=",ExpressionUUID->"7ce1b7af-b6f0-4d4e-9d92-6e607a71e454"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Block computing the acceptance for the specific LLP and its decay channel\
\>", "Subsection",
 CellChangeTimes->{{3.89343683860028*^9, 3.8934368458774233`*^9}, {
   3.905841684939583*^9, 3.9058417056993647`*^9}, 
   3.91543715302625*^9},ExpressionUUID->"a1452150-38b6-4279-8669-\
3ce99cd99d9d"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"PhaseSpacePerDecayChannel", "[", 
    RowBox[{
    "LLP_", ",", "mLLP_", ",", "SpecificDecay_", ",", "isim_", ",", 
     "HadronizationOption_"}], "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"HadronizationOption", "==", "\"\<True\>\""}], "&&", 
      RowBox[{
       RowBox[{"JetsPresence", "[", 
        RowBox[{"LLP", ",", "SpecificDecay"}], "]"}], "==", "\"\<Yes\>\""}]}],
      ",", 
     RowBox[{"Take", "[", 
      RowBox[{
       RowBox[{"RandomSample", "[", 
        RowBox[{"PhaseSpaceDecaysRestJets", "[", 
         RowBox[{"LLP", ",", "SpecificDecay", ",", "mLLP"}], "]"}], "]"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "isim"}], "}"}]}], "]"}], ",", 
     RowBox[{"PhaseSpaceDecaysRest", "[", 
      RowBox[{"LLP", ",", "mLLP", ",", "SpecificDecay", ",", "isim"}], 
      "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"detectableproducts", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"Hold", "@", 
     RowBox[{"Compile", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"pdglists", ",", "_Real", ",", "2"}], "}"}], "}"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"pdglists", "[", 
             RowBox[{"[", "i", "]"}], "]"}], ",", 
            RowBox[{
             RowBox[{"MemberQ", "[", 
              RowBox[{"DetectablePDGsGivenExperiment", ",", "#"}], "]"}], 
             "&"}]}], "]"}], "//", "Length"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "pdglists", "]"}], ",", "1"}], "}"}]}], 
        "]"}], ",", 
       RowBox[{"CompilationTarget", "->", "\"\<C\>\""}], ",", 
       RowBox[{"RuntimeOptions", "->", "\"\<Speed\>\""}], ",", 
       RowBox[{"RuntimeAttributes", "->", 
        RowBox[{"{", "Listable", "}"}]}], ",", 
       RowBox[{"Parallelization", "->", "True"}]}], "]"}]}], "/.", 
    RowBox[{"OwnValues", "@", "DetectablePDGsGivenExperiment"}]}], "//", 
   "ReleaseHold"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CompilePrint", "@", "detectableproducts"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "This", " ", "block", " ", "generates", " ", "the", " ", "phase", " ", 
    "space", " ", "per", " ", "LLP", " ", "decay", " ", "by", " ", 
    "averaging", " ", "over", " ", "various", " ", "decay", " ", "channels"}],
    "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PhaseSpacePerDecay", "[", 
    RowBox[{
    "LLP_", ",", "mLLP_", ",", "proclist_", ",", "isimlist_", ",", 
     "HadronizationOption_"}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"pss0", "=", 
       RowBox[{"Developer`ToPackedArray", "@", 
        RowBox[{"PadRight", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Join", "[", "##", "]"}], "&"}], "@@", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"PhaseSpacePerDecayChannel", "[", 
              RowBox[{"LLP", ",", "mLLP", ",", 
               RowBox[{"proclist", "[", 
                RowBox[{"[", "i", "]"}], "]"}], ",", 
               RowBox[{"isimlist", "[", 
                RowBox[{"[", "i", "]"}], "]"}], ",", "HadronizationOption"}], 
              "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", 
               RowBox[{"Length", "[", "proclist", "]"}], ",", "1"}], "}"}]}], 
            "]"}]}], ",", "Automatic", ",", 
          RowBox[{"-", "999."}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "List", " ", "of", " ", "decay", " ", "products", " ", "pdg", " ", 
        "IDs", " ", "per", " ", "decay"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"pdglists", "=", 
       RowBox[{"pss0", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", 
          RowBox[{
           RowBox[{"-", "LengthDataProduct"}], "+", "indexpdg1", "+", 
           RowBox[{"LengthDataProduct", "*", 
            RowBox[{"Range", "[", 
             RowBox[{"1", ",", 
              FractionBox[
               RowBox[{"Length", "[", 
                RowBox[{"pss0", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "]"}], "8"]}], "]"}]}]}]}], 
         "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "The", " ", "amount", " ", "of", " ", "particles", " ", "that", " ", 
        "may", " ", "be", " ", "detected", " ", "per", " ", "given", " ", 
        "experiment"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"numdetectableproducts", "=", 
       RowBox[{"detectableproducts", "[", "pdglists", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"pss", "=", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Flatten", "[", 
             RowBox[{"SortBy", "[", 
              RowBox[{
               RowBox[{"Partition", "[", 
                RowBox[{"#", ",", "LengthDataProduct"}], "]"}], ",", 
               RowBox[{
                RowBox[{"-", 
                 RowBox[{"#", "[", 
                  RowBox[{"[", "indexE1", "]"}], "]"}]}], "&"}]}], "]"}], 
             "]"}], "&"}], ",", "pss"}], "]"}]}], ";"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "The", " ", "phase", " ", "space", " ", "sorted", " ", "in", " ", 
        "descending", " ", "order", " ", "by", " ", "the", " ", "number", " ",
         "of", " ", "detectable", " ", "products"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"pss", "=", 
       RowBox[{"pss0", "[", 
        RowBox[{"[", 
         RowBox[{"Ordering", "[", 
          RowBox[{"numdetectableproducts", ",", "All", ",", "Greater"}], 
          "]"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", "pss"}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "This", " ", "block", " ", "takes", " ", "the", " ", "phase", " ", 
     "space", " ", "generated", " ", "by", " ", "the", " ", "previous", " ", 
     "block", " ", "and", " ", "converts", " ", "it", " ", "in", " ", "the", 
     " ", "form", " ", "or", " ", "rows", " ", "decay", " ", "product", " ", 
     "data"}], ",", 
    RowBox[{"decay", " ", "product", " ", 
     RowBox[{"data", ".", " ", "To"}], " ", "distinguish", " ", "various", 
     " ", "decays"}], ",", " ", 
    RowBox[{"eventlengths", " ", "is", " ", "used"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PhaseSpacePerDecayReshaped", "[", 
    RowBox[{
    "LLP_", ",", "mLLP_", ",", "proclist_", ",", "isimlist_", ",", 
     "HadronizationOption_"}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ps", "=", 
       RowBox[{"PhaseSpacePerDecay", "[", 
        RowBox[{
        "LLP", ",", "mLLP", ",", "proclist", ",", "isimlist", ",", 
         "HadronizationOption"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ps1", "=", 
       RowBox[{
        RowBox[{"ArrayReshape", "[", 
         RowBox[{
          RowBox[{"Flatten", "[", "ps", "]"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", "ps", "]"}], 
             FractionBox[
              RowBox[{"Length", "[", 
               RowBox[{"ps", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "]"}], "LengthDataProduct"]}],
             ",", "LengthDataProduct"}], "}"}]}], "]"}], "//", 
        "Developer`ToPackedArray"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ps1", "=", 
       RowBox[{
        RowBox[{"Select", "[", 
         RowBox[{"ps1", ",", 
          RowBox[{
           RowBox[{
            RowBox[{"MemberQ", "[", 
             RowBox[{"DetectablePDGsGivenExperiment", ",", 
              RowBox[{"#", "[", 
               RowBox[{"[", "indexpdg1", "]"}], "]"}]}], "]"}], "==", 
            "True"}], "&"}]}], "]"}], "//", "Developer`ToPackedArray"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"eventlengths", "=", 
         RowBox[{"nprodscomp", "[", "ps", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"eventlengths", "=", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Drop", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Accumulate", "[", 
                RowBox[{"Prepend", "[", 
                 RowBox[{"eventlengths", ",", "0"}], "]"}], "]"}], "+", "1"}],
               ",", 
              RowBox[{"-", "1"}]}], "]"}], ",", "eventlengths"}], "}"}], "//",
           "Transpose"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"eventlengths", "=", 
       RowBox[{"SortBy", "[", 
        RowBox[{"numdetectableproducts", ",", 
         RowBox[{
          RowBox[{"-", "#"}], "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"eventlengths", "=", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Drop", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Accumulate", "[", 
              RowBox[{"Prepend", "[", 
               RowBox[{"eventlengths", ",", "0"}], "]"}], "]"}], "+", "1"}], 
            ",", 
            RowBox[{"-", "1"}]}], "]"}], ",", "eventlengths"}], "}"}], "//", 
        "Transpose"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"eventlengths", "=", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Range", "[", 
             RowBox[{"1", ",", 
              RowBox[{"isimlist", "//", "Total"}]}], "]"}], ",", 
            RowBox[{"SortBy", "[", 
             RowBox[{"numdetectableproducts", ",", 
              RowBox[{
               RowBox[{"-", "#"}], "&"}]}], "]"}]}], "}"}], "//", 
          "Transpose"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"ps1", ",", "eventlengths"}], "}"}]}]}], "\[IndentingNewLine]",
     "]"}]}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Block", " ", "computing", " ", "decay", " ", "acceptance"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DecayAcceptanceELLP\[Theta]LLPzLLPoverall", "[", 
   RowBox[{
   "LLP_", ",", "mLLP_", ",", "proclist_", ",", "isimlist_", ",", 
    "gridNonZero_", ",", "HadronizationOption_", ",", 
    "AllProductsWithinAcceptance_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"(*", 
      RowBox[{"PhaseSpaceGiven", ","}], "*)"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{
       RowBox[{
       "Phase", " ", "space", " ", "of", " ", "LLP", " ", "decays", " ", "at",
         " ", "rest"}], " ", "-", " ", 
       RowBox[{"up", " ", "to", " ", "stable", " ", "decay", " ", 
        RowBox[{"products", ":", " ", 
         RowBox[{"charged", " ", "pions"}]}]}]}], ",", " ", 
      RowBox[{"charged", " ", "kaons"}], ",", " ", 
      SubscriptBox["K", "L"], ",", " ", 
      RowBox[{"and", " ", "photons"}]}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"PhaseSpaceGiven", ",", "eventslengths"}], "}"}], "=", 
      RowBox[{"PhaseSpacePerDecayReshaped", "[", 
       RowBox[{
       "LLP", ",", "mLLP", ",", "proclist", ",", "isimlist", ",", 
        "HadronizationOption"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "Averaging", " ", "over", " ", "distinct", " ", "decay", " ", 
       "products", " ", "set", " ", "for", " ", "the", " ", "given", " ", 
       "phase", " ", "space"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Computing", " ", "the", " ", "decay", " ", "products", " ", 
        RowBox[{"acceptance", ":", " ", 
         RowBox[{"at", " ", "this", " ", "step"}]}]}], ",", " ", 
       RowBox[{"no", " ", "averaging", " ", "over", " ", "\[Phi]"}]}], "*)"}],
      "\[IndentingNewLine]", 
     RowBox[{"ifcharm", "=", 
      RowBox[{"MemberQ", "[", 
       RowBox[{
        RowBox[{"{", "\"\<CHARM-photon\>\"", "}"}], ",", "GivenExperiment"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"isimvv", "=", 
      RowBox[{"isimlist", "//", "Total"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"ifcharm", "==", "True"}], ",", 
       RowBox[{"\[Epsilon]Decay\[Phi]Unaveraged", "=", 
        RowBox[{"DecayAcceptanceCHARM\[Gamma]Comp", "[", 
         RowBox[{"gridNonZero", ",", "mLLP", ",", "PhaseSpaceGiven"}], 
         "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"AllProductsWithinAcceptance", "==", "\"\<>=2\>\""}], "&&", 
        RowBox[{"ifcharm", "==", "False"}]}], ",", 
       RowBox[{"\[Epsilon]Decay\[Phi]Unaveraged", "=", 
        RowBox[{"DecayAcceptanceComp", "[", 
         RowBox[{
         "gridNonZero", ",", "PhaseSpaceGiven", ",", "mLLP", ",", 
          "eventslengths"}], "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
        "AllProductsWithinAcceptance", "==", "\"\<All detectable\>\""}], "&&", 
        RowBox[{"ifcharm", "==", "False"}]}], ",", 
       RowBox[{"\[Epsilon]Decay\[Phi]Unaveraged", "=", 
        RowBox[{"DecayAcceptanceAllProductsComp", "[", 
         RowBox[{"gridNonZero", ",", "mLLP", ",", "PhaseSpaceGiven"}], 
         "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "And", " ", "then", " ", "averaging", " ", "over", " ", "\[Phi]"}], 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"\[Epsilon]av", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"\[Epsilon]Decay\[Phi]Unaveraged", "\[NotEqual]", 
         RowBox[{"{", "}"}]}], ",", 
        RowBox[{"\[Epsilon]DecayE\[Theta]zcompiled", "[", 
         RowBox[{"\[Epsilon]Decay\[Phi]Unaveraged", ",", "NofPhiVals"}], 
         "]"}], ",", 
        RowBox[{"{", "}"}]}], "]"}]}]}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.891323957620606*^9, 3.8913240240436583`*^9}, 
   3.891324187747533*^9, {3.891324255034959*^9, 3.8913243536830673`*^9}, {
   3.891325209472799*^9, 3.891325209680338*^9}, {3.891441238151249*^9, 
   3.8914412484442453`*^9}, {3.8914498140771713`*^9, 
   3.8914498140771713`*^9}, {3.8915012539731226`*^9, 3.891501286318918*^9}, {
   3.89239500907771*^9, 3.892395051886007*^9}, {3.8923952289032564`*^9, 
   3.8923952336003675`*^9}, {3.8923953786948557`*^9, 3.892395381991894*^9}, {
   3.8923955060701127`*^9, 3.8923955272859077`*^9}, {3.8923955673557796`*^9, 
   3.8923955839369893`*^9}, {3.8923956277868586`*^9, 
   3.8923956289969416`*^9}, {3.892395695664096*^9, 3.8923956965801477`*^9}, 
   3.8923960576396327`*^9, {3.892396145533648*^9, 3.892396178633185*^9}, {
   3.892396225841028*^9, 3.89239629904659*^9}, {3.8923963485789595`*^9, 
   3.89239635449782*^9}, {3.8923983525059958`*^9, 3.892398416566023*^9}, {
   3.8923985958061323`*^9, 3.892398721647341*^9}, {3.892398762166195*^9, 
   3.8923988356771135`*^9}, {3.8923994497214513`*^9, 
   3.8923994501658316`*^9}, {3.8923994984787354`*^9, 
   3.8923996169558177`*^9}, {3.8923997054770575`*^9, 3.892399762994342*^9}, {
   3.892399798435878*^9, 3.892399948386163*^9}, {3.892400059252329*^9, 
   3.8924001779450474`*^9}, {3.8924002084271746`*^9, 3.892400212881799*^9}, {
   3.892400312810155*^9, 3.8924003964646645`*^9}, {3.8924004332258873`*^9, 
   3.8924004332258873`*^9}, {3.8924004667458878`*^9, 
   3.8924004699170513`*^9}, {3.8924005065978136`*^9, 3.892400585104961*^9}, {
   3.8924007578318014`*^9, 3.8924008045349913`*^9}, {3.8924009723677635`*^9, 
   3.892400974040879*^9}, {3.89240105384111*^9, 3.8924010554070377`*^9}, {
   3.892401389095854*^9, 3.8924013984751053`*^9}, {3.892401514826091*^9, 
   3.892401517071723*^9}, {3.892534245847158*^9, 3.892534248454938*^9}, {
   3.892872187826863*^9, 3.892872190757622*^9}, {3.8933493561890125`*^9, 
   3.8933493683619947`*^9}, {3.8934874214538107`*^9, 3.893487436062696*^9}, {
   3.893492304838162*^9, 3.8934923048461585`*^9}, {3.8982719497939672`*^9, 
   3.8982719533211184`*^9}, {3.898272048167898*^9, 3.8982720515052614`*^9}, {
   3.8984167300559325`*^9, 3.898416772830679*^9}, {3.898416886512401*^9, 
   3.8984168866595182`*^9}, {3.8984169524188447`*^9, 
   3.8984169612300177`*^9}, {3.898417447156699*^9, 3.8984174716249857`*^9}, {
   3.898417775584815*^9, 3.898417784009431*^9}, {3.89841810767848*^9, 
   3.8984181097778225`*^9}, {3.8984981493744936`*^9, 
   3.8984982243750596`*^9}, {3.898498258438574*^9, 3.898498288440093*^9}, {
   3.898498338377733*^9, 3.898498486312986*^9}, {3.8986127855741825`*^9, 
   3.8986128141750174`*^9}, {3.8986197691118207`*^9, 3.898619769261925*^9}, {
   3.8986215206340117`*^9, 3.8986215207966948`*^9}, {3.901721849485814*^9, 
   3.9017218567517257`*^9}, {3.90172223001527*^9, 3.901722300642374*^9}, {
   3.9017235011709423`*^9, 3.9017235018180194`*^9}, {3.901723903491409*^9, 
   3.901723912587018*^9}, {3.9028084503415017`*^9, 3.902808462748777*^9}, 
   3.902808568792131*^9, {3.9029088470116005`*^9, 3.902908862792575*^9}, {
   3.9029096004377184`*^9, 3.9029096573879814`*^9}, {3.902909794985092*^9, 
   3.902909880860897*^9}, {3.9029099329100056`*^9, 3.90290996585912*^9}, {
   3.902910079695611*^9, 3.9029100890246334`*^9}, {3.9029101935812845`*^9, 
   3.90291023303977*^9}, 3.902910402104411*^9, {3.902910733120657*^9, 
   3.9029107385290227`*^9}, {3.902910852571861*^9, 3.9029108531112223`*^9}, {
   3.902914221207258*^9, 3.9029143431880045`*^9}, {3.902914381784239*^9, 
   3.9029145044382715`*^9}, {3.9029150861183853`*^9, 3.902915086683072*^9}, {
   3.904058884498025*^9, 3.9040588947291155`*^9}, {3.904066241972974*^9, 
   3.904066242494639*^9}, {3.9058452272510767`*^9, 3.9058452509268055`*^9}, {
   3.9058453767949944`*^9, 3.9058454152641797`*^9}, {3.9101652814245453`*^9, 
   3.910165304947756*^9}, {3.910165707852807*^9, 3.910165712481017*^9}, {
   3.911975651225398*^9, 3.9119756699832287`*^9}, {3.911975702079359*^9, 
   3.911975846257121*^9}, {3.9119760869978914`*^9, 3.9119760961232615`*^9}, {
   3.9120760618500943`*^9, 3.9120761115238714`*^9}, {3.912076540903468*^9, 
   3.9120765549209013`*^9}, {3.912076766787343*^9, 3.912076768785372*^9}, {
   3.912078031451913*^9, 3.912078049594858*^9}, {3.912078883438263*^9, 
   3.912078883558423*^9}, {3.9120790320811267`*^9, 3.9120790322063847`*^9}, {
   3.912079181257861*^9, 3.912079182019356*^9}, 3.9120940119433517`*^9, {
   3.912145667075636*^9, 3.912145670158077*^9}, {3.9121505564878373`*^9, 
   3.912150630982073*^9}, 3.9121605288988934`*^9, {3.9121611926818237`*^9, 
   3.9121611928477197`*^9}, {3.9126770240863276`*^9, 3.912677059402796*^9}, {
   3.9126777571494217`*^9, 3.9126777668054447`*^9}, {3.912845896782793*^9, 
   3.912845899255166*^9}, {3.912846043088033*^9, 3.912846047550837*^9}, {
   3.9128464050284004`*^9, 3.9128464084977846`*^9}, 3.912846506738236*^9, {
   3.9128465901162996`*^9, 3.9128465980032988`*^9}, {3.9128485524572144`*^9, 
   3.9128485582494507`*^9}, {3.912850104572579*^9, 3.9128501289809904`*^9}, {
   3.912850558742343*^9, 3.912850564068616*^9}, {3.9128750456197023`*^9, 
   3.9128750523802633`*^9}, {3.912875094515668*^9, 3.9128752418078127`*^9}, {
   3.9128754264692764`*^9, 3.912875432083063*^9}, {3.912875548159252*^9, 
   3.912875550774439*^9}, {3.9128757099591923`*^9, 3.912875759854226*^9}, 
   3.9140905636283827`*^9, {3.9140912898268147`*^9, 3.9140913463068895`*^9}, {
   3.9140914205747576`*^9, 3.91409151407685*^9}, {3.915437153036351*^9, 
   3.915437153232602*^9}, {3.916157113680105*^9, 3.916157114237549*^9}, {
   3.916157145032995*^9, 3.916157145451127*^9}, {3.916157179670205*^9, 
   3.9161571801917343`*^9}},
 CellLabel->"In[97]:=",ExpressionUUID->"1758969e-467e-482a-9d29-3b1f5444d1ec"],

Cell[BoxData[
 FormBox[
  InterpretationBox[
   RowBox[{
    TagBox["CompiledFunction",
     "SummaryHead"], "[", 
    DynamicModuleBox[{Typeset`open$$ = False, Typeset`embedState$$ = "Ready"}, 
     TemplateBox[{
       PaneSelectorBox[{False -> GridBox[{{
             PaneBox[
              ButtonBox[
               DynamicBox[
                FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxOpener"]], 
               ButtonFunction :> (Typeset`open$$ = True), Appearance -> None, 
               BaseStyle -> {}, Evaluator -> Automatic, Method -> 
               "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
              Dynamic[{
                Automatic, 
                 3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                  Magnification])}]], 
             GraphicsBox[{
               Thickness[0.038461538461538464`], {
                FaceForm[{
                  GrayLevel[0.93], 
                  Opacity[1.]}], 
                
                FilledCurveBox[{{{1, 4, 3}, {0, 1, 0}, {1, 3, 3}, {0, 1, 0}, {
                 1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {0, 1, 0}}}, {{{
                 25.499999999999996`, 2.5}, {25.499999999999996`, 
                 1.3953100000000003`}, {24.604699999999998`, 
                 0.49999999999999994`}, {23.5, 0.49999999999999994`}, {2.5, 
                 0.49999999999999994`}, {1.3953100000000003`, 
                 0.49999999999999994`}, {0.49999999999999994`, 
                 1.3953100000000003`}, {0.49999999999999994`, 2.5}, {
                 0.49999999999999994`, 23.5}, {0.49999999999999994`, 
                 24.604699999999998`}, {1.3953100000000003`, 
                 25.499999999999996`}, {2.5, 25.499999999999996`}, {23.5, 
                 25.499999999999996`}, {24.604699999999998`, 
                 25.499999999999996`}, {25.499999999999996`, 
                 24.604699999999998`}, {25.499999999999996`, 23.5}, {
                 25.499999999999996`, 2.5}}}]}, {
                FaceForm[{
                  RGBColor[0.5, 0.5, 0.5], 
                  Opacity[1.]}], 
                
                FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {
                 0, 1, 0}, {0, 1, 0}, {0, 1, 0}}}, {{{20.5426, 
                 19.116799999999998`}, {16.3832, 21.876199999999997`}, {
                 16.3832, 20.021499999999996`}, {6.930469999999999, 
                 20.021499999999996`}, {6.930469999999999, 
                 18.212100000000003`}, {16.3832, 18.212100000000003`}, {
                 16.3832, 16.357399999999995`}, {20.5426, 
                 19.116799999999998`}}}], 
                
                FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {
                 0, 1, 0}, {0, 1, 0}, {0, 1, 0}}}, {{{5.30508, 13.8391}, {
                 9.46445, 11.079700000000003`}, {9.46445, 
                 12.933999999999997`}, {18.917199999999998`, 
                 12.933999999999997`}, {18.917199999999998`, 14.7438}, {
                 9.46445, 14.7438}, {9.46445, 16.598}, {5.30508, 13.8391}}}], 
                
                FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {
                 0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
                 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {
                 1, 3, 3}, {1, 3, 3}, {1, 3, 3}}}, CompressedData["
1:eJxTTMoPSmVmYGBgBGJjIGYCYq4u+eR3VWoOxhkv5j+Qk3SA8fu/r5rKOVHM
Yd2vmNyjZ9Qcrt9QXbW9S8RBg59767IidQcPMYPGaHFhB+Nn61SfiGo4xBwp
T7o2V9Dh0Iolfg6/NBxEHv/x1Xgi4FB1XNNqkqQWnP+axUTQjFkbzn+oO2HB
j/3aDg/Xn5T6WiDoYLs3aJpiqI7DrHN+bO6tQg4zfUR7vF7pQOyfIQyRd9d1
WLL0U1kLoyjEPdm6DpoTXfQX7xBzKPjQejLkhDacL5J4+LL2Gm2HtNnSl4Vf
iELM69J2qPZM3tLnJerQX1oozZugDfHPUxGI/4W1HQ5p3TthoyDi4D7lG1v8
Mi2HgqL9zoEHhB1inOxe3BRG8MH62zXhfIbN1Z82CGhC/GMg4nCm3mN/7TYN
iHlCUPdGakDc/1kUEr46GhD/eYnD+d9iBf/kC0vC+TuCrSL+X5Vy2HGR4R5T
uAbEfxYykPBYp+HQqsCuesZAFhL+rJoQ/2rIQdxTpwkJ7yVycPfD+GDzVqLx
xbUd5HYt2JfqBdWfpA2Jj9mykPDpgYaXtaxDy7yzq86vg8qvlIHE5ylY/Eo7
XAt7o787TxfOB5ufqesQ9PbyxxkPZSDhZ6nrMAGU3u7LQtLLEx2HN2253UbX
ofZ76jis/Pay4oynAsT8QG0HKZMv/gW7FCDyTFpwPsz/MD44/Mw1HFjb1uR9
TVVwWKy880/7FHWIexrkIfLX1RzOMDZZVjHIOaDkh3vSDuj5AwCF11Vc
                 "]]}}, Background -> GrayLevel[0.93], Axes -> False, 
              AspectRatio -> 1, ImageSize -> 
              Dynamic[{
                Automatic, 
                 3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                  Magnification])}], Frame -> True, FrameTicks -> None, 
              FrameStyle -> Directive[
                Thickness[Tiny], 
                GrayLevel[0.7]]], 
             GridBox[{{
                RowBox[{
                  TagBox["\"Argument count: \"", "SummaryItemAnnotation"], 
                  "\[InvisibleSpace]", 
                  TagBox["1", "SummaryItem"]}]}, {
                RowBox[{
                  TagBox["\"Argument types: \"", "SummaryItemAnnotation"], 
                  "\[InvisibleSpace]", 
                  TagBox[
                   StyleBox[
                    PaneBox[
                    RowBox[{"(", "\[NoBreak]", 
                    
                    GridBox[{{"_Real", "2"}}, RowSpacings -> 1, 
                    ColumnSpacings -> 1, RowAlignments -> Baseline, 
                    ColumnAlignments -> Center], "\[NoBreak]", ")"}], 
                    ContentPadding -> False, FrameMargins -> 0, StripOnInput -> 
                    True, BaselinePosition -> Baseline, 
                    ImageSize -> {{1, 300}, Automatic}], LineBreakWithin -> 
                    False], "SummaryItem"]}]}}, 
              GridBoxAlignment -> {
               "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
              False, GridBoxItemSize -> {
               "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
              GridBoxSpacings -> {
               "Columns" -> {{2}}, "Rows" -> {{Automatic}}}, 
              BaseStyle -> {
               ShowStringCharacters -> False, NumberMarks -> False, 
                PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
           GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
           AutoDelete -> False, 
           GridBoxItemSize -> {
            "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
           BaselinePosition -> {1, 1}], True -> GridBox[{{
             PaneBox[
              ButtonBox[
               DynamicBox[
                FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxCloser"]], 
               ButtonFunction :> (Typeset`open$$ = False), Appearance -> None,
                BaseStyle -> {}, Evaluator -> Automatic, Method -> 
               "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
              Dynamic[{
                Automatic, 
                 3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                  Magnification])}]], 
             GraphicsBox[{
               Thickness[0.038461538461538464`], {
                FaceForm[{
                  GrayLevel[0.93], 
                  Opacity[1.]}], 
                
                FilledCurveBox[{{{1, 4, 3}, {0, 1, 0}, {1, 3, 3}, {0, 1, 0}, {
                 1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {0, 1, 0}}}, {{{
                 25.499999999999996`, 2.5}, {25.499999999999996`, 
                 1.3953100000000003`}, {24.604699999999998`, 
                 0.49999999999999994`}, {23.5, 0.49999999999999994`}, {2.5, 
                 0.49999999999999994`}, {1.3953100000000003`, 
                 0.49999999999999994`}, {0.49999999999999994`, 
                 1.3953100000000003`}, {0.49999999999999994`, 2.5}, {
                 0.49999999999999994`, 23.5}, {0.49999999999999994`, 
                 24.604699999999998`}, {1.3953100000000003`, 
                 25.499999999999996`}, {2.5, 25.499999999999996`}, {23.5, 
                 25.499999999999996`}, {24.604699999999998`, 
                 25.499999999999996`}, {25.499999999999996`, 
                 24.604699999999998`}, {25.499999999999996`, 23.5}, {
                 25.499999999999996`, 2.5}}}]}, {
                FaceForm[{
                  RGBColor[0.5, 0.5, 0.5], 
                  Opacity[1.]}], 
                
                FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {
                 0, 1, 0}, {0, 1, 0}, {0, 1, 0}}}, {{{20.5426, 
                 19.116799999999998`}, {16.3832, 21.876199999999997`}, {
                 16.3832, 20.021499999999996`}, {6.930469999999999, 
                 20.021499999999996`}, {6.930469999999999, 
                 18.212100000000003`}, {16.3832, 18.212100000000003`}, {
                 16.3832, 16.357399999999995`}, {20.5426, 
                 19.116799999999998`}}}], 
                
                FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {
                 0, 1, 0}, {0, 1, 0}, {0, 1, 0}}}, {{{5.30508, 13.8391}, {
                 9.46445, 11.079700000000003`}, {9.46445, 
                 12.933999999999997`}, {18.917199999999998`, 
                 12.933999999999997`}, {18.917199999999998`, 14.7438}, {
                 9.46445, 14.7438}, {9.46445, 16.598}, {5.30508, 13.8391}}}], 
                
                FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {
                 0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
                 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {
                 1, 3, 3}, {1, 3, 3}, {1, 3, 3}}}, CompressedData["
1:eJxTTMoPSmVmYGBgBGJjIGYCYq4u+eR3VWoOxhkv5j+Qk3SA8fu/r5rKOVHM
Yd2vmNyjZ9Qcrt9QXbW9S8RBg59767IidQcPMYPGaHFhB+Nn61SfiGo4xBwp
T7o2V9Dh0Iolfg6/NBxEHv/x1Xgi4FB1XNNqkqQWnP+axUTQjFkbzn+oO2HB
j/3aDg/Xn5T6WiDoYLs3aJpiqI7DrHN+bO6tQg4zfUR7vF7pQOyfIQyRd9d1
WLL0U1kLoyjEPdm6DpoTXfQX7xBzKPjQejLkhDacL5J4+LL2Gm2HtNnSl4Vf
iELM69J2qPZM3tLnJerQX1oozZugDfHPUxGI/4W1HQ5p3TthoyDi4D7lG1v8
Mi2HgqL9zoEHhB1inOxe3BRG8MH62zXhfIbN1Z82CGhC/GMg4nCm3mN/7TYN
iHlCUPdGakDc/1kUEr46GhD/eYnD+d9iBf/kC0vC+TuCrSL+X5Vy2HGR4R5T
uAbEfxYykPBYp+HQqsCuesZAFhL+rJoQ/2rIQdxTpwkJ7yVycPfD+GDzVqLx
xbUd5HYt2JfqBdWfpA2Jj9mykPDpgYaXtaxDy7yzq86vg8qvlIHE5ylY/Eo7
XAt7o787TxfOB5ufqesQ9PbyxxkPZSDhZ6nrMAGU3u7LQtLLEx2HN2253UbX
ofZ76jis/Pay4oynAsT8QG0HKZMv/gW7FCDyTFpwPsz/MD44/Mw1HFjb1uR9
TVVwWKy880/7FHWIexrkIfLX1RzOMDZZVjHIOaDkh3vSDuj5AwCF11Vc
                 "]]}}, Background -> GrayLevel[0.93], Axes -> False, 
              AspectRatio -> 1, ImageSize -> 
              Dynamic[{
                Automatic, 
                 3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                  Magnification])}], Frame -> True, FrameTicks -> None, 
              FrameStyle -> Directive[
                Thickness[Tiny], 
                GrayLevel[0.7]]], 
             GridBox[{{
                RowBox[{
                  TagBox["\"Argument count: \"", "SummaryItemAnnotation"], 
                  "\[InvisibleSpace]", 
                  TagBox["1", "SummaryItem"]}]}, {
                RowBox[{
                  TagBox["\"Argument types: \"", "SummaryItemAnnotation"], 
                  "\[InvisibleSpace]", 
                  TagBox[
                   PaneBox[
                    RowBox[{"(", "\[NoBreak]", 
                    
                    GridBox[{{"_Real", "2"}}, RowSpacings -> 1, 
                    ColumnSpacings -> 1, RowAlignments -> Baseline, 
                    ColumnAlignments -> Center], "\[NoBreak]", ")"}], 
                    ImageSize -> {{1, 500}, Automatic}, BaselinePosition -> 
                    Baseline, ContentPadding -> False, FrameMargins -> 0, 
                    StripOnInput -> True], "SummaryItem"]}]}, {
                RowBox[{
                  TagBox["\"Variables: \"", "SummaryItemAnnotation"], 
                  "\[InvisibleSpace]", 
                  TagBox[
                   RowBox[{"{", "pdglists", "}"}], "SummaryItem"]}]}, {
                RowBox[{
                  TagBox["\"Expression: \"", "SummaryItemAnnotation"], 
                  "\[InvisibleSpace]", 
                  TagBox[
                   PaneBox[
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"Select", "[", 
                    RowBox[{
                    
                    RowBox[{"pdglists", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}], ",", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "2212.`"}], ",", 
                    RowBox[{"-", "2112.`"}], ",", 
                    RowBox[{"-", "321.`"}], ",", 
                    RowBox[{"-", "211.`"}], ",", 
                    RowBox[{"-", "21.`"}], ",", 
                    RowBox[{"-", "13.`"}], ",", 
                    RowBox[{"-", "11.`"}], ",", 
                    RowBox[{"-", "5.`"}], ",", 
                    RowBox[{"-", "4.`"}], ",", 
                    RowBox[{"-", "3.`"}], ",", 
                    RowBox[{"-", "2.`"}], ",", 
                    RowBox[{"-", "1.`"}], ",", "1.`", ",", "2.`", ",", "3.`", 
                    ",", "4.`", ",", "5.`", ",", "11.`", ",", "13.`", ",", 
                    "21.`", ",", "22.`", ",", "130.`", ",", "211.`", ",", 
                    "321.`", ",", "2112.`", ",", "2212.`"}], "}"}], ",", 
                    "#1"}], "]"}], "&"}]}], "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "1", ",", 
                    RowBox[{"Length", "[", "pdglists", "]"}], ",", "1"}], 
                    "}"}]}], "]"}], ImageSize -> {{1, 500}, Automatic}, 
                    BaselinePosition -> Baseline, ContentPadding -> False, 
                    FrameMargins -> 0, StripOnInput -> True], 
                   "SummaryItem"]}]}}, 
              GridBoxAlignment -> {
               "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
              False, GridBoxItemSize -> {
               "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
              GridBoxSpacings -> {
               "Columns" -> {{2}}, "Rows" -> {{Automatic}}}, 
              BaseStyle -> {
               ShowStringCharacters -> False, NumberMarks -> False, 
                PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
           GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
           AutoDelete -> False, 
           GridBoxItemSize -> {
            "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
           BaselinePosition -> {1, 1}]}, 
        Dynamic[Typeset`open$$], ImageSize -> Automatic]},
      "SummaryPanel"],
     DynamicModuleValues:>{}], "]"}],
   CompiledFunction[{11, 13.2, 5848}, {{
      Blank[Real], 2}}, {{3, 2, 0}, {2, 1, 
    5}}, {{{-2212., -2112., -321., -211., -21., -13., -11., -5., -4., -3., \
-2., -1., 1., 2., 3., 4., 5., 11., 13., 21., 22., 130., 211., 321., 2112., 
      2212.}, {3, 1, 2}}, {0, {2, 0, 4}}, {-1, {2, 0, 10}}, {1, {2, 0, 0}}}, {
    1, 17, 3, 0, 
    7}, {{33, 0, 2}, {6, 4, 3}, {35, 2, 2, 5}, {6, 4, 9}, {3, 38}, {6, 4, 
     14}, {6, 4, 8}, {38, 0, 0, 9, 1, 4}, {33, 4, 13}, {6, 4, 5}, {35, 13, 2, 
     1}, {6, 4, 15}, {3, 11}, {37, 4, 15, 3, 0}, {7, 0, 1}, {
     42, "MemberQ", 3, 1, 2, -3, 0, 1, 1, 0, 0}, {2, 0, 5}, {12, 14, 0, 16}, {
     6, 16, 14}, {6, 15, 16}, {3, 2}, {6, 10, 16}, {36, 5, 16, 2, 1}, {4, 15, 
     13, -10}, {6, 14, 11}, {6, 4, 12}, {35, 11, 3, 6}, {6, 4, 7}, {3, 11}, {
     12, 8, 0, 5}, {6, 5, 8}, {37, 1, 8, 2, 5}, {24, 5, 10, 0}, {2, 0, 4}, {
     12, 8, 0, 5}, {6, 5, 8}, {3, -5}, {37, 4, 8, 3, 2}, {36, 12, 2, 3, 6}, {
     4, 7, 11, -10}, {33, 6, 8}, {36, 3, 8, 2, 5}, {4, 9, 2, -37}, {1}}, 
    Function[{$CellContext`pdglists}, 
     Table[
      Length[
       Select[
        Part[$CellContext`pdglists, $CellContext`i], 
        MemberQ[{-2212., -2112., -321., -211., -21., -13., -11., -5., -4., \
-3., -2., -1., 1., 2., 3., 4., 5., 11., 13., 21., 22., 130., 211., 321., 
         2112., 2212.}, #]& ]], {$CellContext`i, 1, 
       Length[$CellContext`pdglists], 1}], Listable], Evaluate, 
    LibraryFunction[
    "C:\\Users\\miksi\\AppData\\Roaming\\Mathematica\\ApplicationData\\\
CCompilerDriver\\BuildFolder\\iap-nb-109-10516\\compiledFunction72.dll", 
     "compiledFunction72", {{Real, 2, "Constant"}}, {Integer, 1}]],
   Editable->False,
   SelectWithContents->True,
   Selectable->False], TraditionalForm]], "Output",
 CellChangeTimes->{3.914994106426088*^9, 3.9149946594695168`*^9, 
  3.9150025194137774`*^9, 3.915012850995468*^9, 3.915015248996187*^9, 
  3.915123752330534*^9, 3.9151832690956135`*^9, 3.915183450164019*^9, 
  3.9151848683991213`*^9, 3.9151850727315207`*^9, 3.915185248529698*^9, 
  3.915188297120842*^9, 3.915206723780719*^9, 3.915294017291902*^9, 
  3.916128248637062*^9, 3.916130255669451*^9, 3.9161571205117016`*^9, 
  3.91616242278653*^9, 3.9186649811857405`*^9},
 CellLabel->
  "Out[762]=",ExpressionUUID->"7f34f167-7989-499b-b61b-138cd29cd4c9"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "If the LLP, its mass, and the grid ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["E", "LLP"], ",", 
    SubscriptBox["\[Theta]", "LLP"], ",", 
    SubscriptBox["z", "LLP"]}], TraditionalForm]],ExpressionUUID->
  "27420bc7-439d-49ab-96dd-6db0bd9993c8"],
 " are fixed (uses the routine for the fixed phase space of decay products \
from the previous section)"
}], "Subsection",
 CellChangeTimes->{{3.8934368873069787`*^9, 3.893436934036857*^9}, {
  3.893437066903433*^9, 3.893437076636647*^9}, {3.9154371532477307`*^9, 
  3.915437153262238*^9}},ExpressionUUID->"dae2eb05-38c6-4723-b448-\
9fb5a8d67e08"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Block", " ", "that", " ", "takes", " ", "the", " ", "table", " ", 
    RowBox[{"{", 
     RowBox[{
      SubscriptBox["E", "LLP"], ",", 
      SubscriptBox["z", "LLP"], ",", 
      SubscriptBox["\[Theta]", "LLP"], ",", 
      SubscriptBox["z", "LLP"], ",", 
      SubscriptBox["\[Epsilon]", 
       RowBox[{"az", ",", "LLP"}]], ",", 
      SubscriptBox["\[Phi]", "LLP"]}], "}"}], " ", "and", " ", "computes", 
    " ", 
    RowBox[{"{", 
     RowBox[{
      SubscriptBox["E", "LLP"], ",", 
      SubscriptBox["z", "LLP"], ",", 
      SubscriptBox["\[Theta]", "LLP"], ",", 
      SubscriptBox["z", "LLP"], ",", 
      SubscriptBox["\[Epsilon]", 
       RowBox[{"az", ",", "LLP"}]], ",", 
      RowBox[{"<", 
       SubscriptBox["\[Epsilon]", 
        RowBox[{"decay", ",", "LLP"}]], 
       SubscriptBox[">", 
        SubscriptBox["\[Phi]", "LLP"]]}]}], "}"}], " ", "for", " ", "the", 
    " ", "given", " ", "LLP", " ", "and", " ", 
    RowBox[{"mass", ".", " ", "It"}], " ", "averages", " ", "over", " ", 
    "dominant", " ", 
    RowBox[{"LLP", "'"}], "s", " ", 
    RowBox[{"decays", "."}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"DecayAcceptanceBlock", "[", 
    RowBox[{
    "LLP_", ",", "mLLP_", ",", "proclist_", ",", "grid_", ",", "gridreduced_",
      ",", "isim_", ",", "HadronizationOption_", ",", 
     "AllProductsWithinAcceptance_"}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "List", " ", "of", " ", "processes", " ", "for", " ", "the", " ", 
       "given", " ", "LLP"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ProcessesListGivenComputation", "=", "proclist"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "Br", " ", "ratios", " ", "associated", " ", "with", " ", "the", " ", 
        "given", " ", "processes"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"ListBrRatiosGivenComputation", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"ListBrRatios", "[", 
          RowBox[{"LLP", ",", "mLLP", ",", "#"}], "]"}], "&"}], "/@", 
        "ProcessesListGivenComputation"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Total", "[", "ListBrRatiosGivenComputation", "]"}], "!=", 
         "0"}], ",", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
          "Number", " ", "of", " ", "decays", " ", "simulated", " ", "for", 
           " ", "each", " ", "particular", " ", "channel"}], ",", " ", 
          RowBox[{
          "joined", " ", "with", " ", "the", " ", "channel", " ", 
           "identifiers"}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"isimulvalPerDecayChannelTemp", "=", 
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"Partition", "[", 
             RowBox[{
              RowBox[{"NeventsSplitted", "[", 
               RowBox[{"isim", ",", "ListBrRatiosGivenComputation"}], "]"}], 
              ",", "1"}], "]"}], ",", 
            RowBox[{"Partition", "[", 
             RowBox[{"ProcessesListGivenComputation", ",", "1"}], "]"}], ",", 
            "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{
           "Selecting", " ", "only", " ", "those", " ", "channels", " ", 
            "for", " ", "which", " ", "the", " ", "number", " ", "of", " ", 
            "simulated", " ", "decays", " ", "is"}], " ", ">", " ", 
           RowBox[{
            SuperscriptBox["10", 
             RowBox[{"-", "2"}]], 
            SubscriptBox["N", "ev"]}]}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"isimulvalPerDecayChannel", "=", 
          RowBox[{"Select", "[", 
           RowBox[{"isimulvalPerDecayChannelTemp", ",", 
            RowBox[{
             RowBox[{
              RowBox[{"#", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ">=", 
              RowBox[{"IntegerPart", "[", 
               RowBox[{"0.01", "*", "isim"}], "]"}]}], "&"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{
            RowBox[{"Removing", " ", "rows", " ", "for", " ", "which", " ", 
             SubscriptBox["E", "LLP"]}], " ", "<", " ", 
            RowBox[{
             SubscriptBox["m", "LLP"], " ", "or", " ", 
             SubscriptBox["\[Epsilon]", "azimuthal"]}]}], " ", "=", " ", 
           "0"}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"gridNonZero", "=", 
          RowBox[{"TableLLPnonZeroCompiled", "[", 
           RowBox[{"grid", ",", "mLLP"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
          "The", " ", "same", " ", "table", " ", "as", " ", "gridNonZero", 
           " ", "but", " ", "with", " ", "removed", " ", "column", " ", 
           SubscriptBox["\[Phi]", "LLP"], " ", 
           RowBox[{"(", 
            RowBox[{"equivalent", " ", "to", " ", 
             RowBox[{
              RowBox[{"DeleteDuplicatesBy", "[", 
               RowBox[{"gridNonZero", ",", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                   RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                   RowBox[{"#", "[", 
                    RowBox[{"[", 
                    RowBox[{"[", "3", "]"}], "]"}]}]}], "}"}], "&"}]}], "]"}],
               "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", 
                RowBox[{"{", 
                 RowBox[{"1", ",", "2", ",", "3", ",", "4"}], "}"}]}], "]"}], 
              "]"}]}], ")"}]}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"gridReducedNonZero", "=", 
          RowBox[{"TableLLPnonZeroCompiled", "[", 
           RowBox[{"gridreduced", ",", "mLLP"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{
           "The", " ", "table", " ", "with", " ", "the", " ", "remaining", 
            " ", "grid", " ", "for", " ", "which", " ", 
            SubscriptBox["\[Epsilon]", "az"]}], " ", "=", " ", "0"}], "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"gridReducedZero", "=", 
          RowBox[{"TableLLPzeroCompiled", "[", 
           RowBox[{"gridreduced", ",", "mLLP"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", "gridReducedNonZero", "]"}], "\[NotEqual]",
             "0"}], ",", "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
            "___", "___", "___", "___", "___", "___", "___", "___", "___", 
             "___", "___", "___", "___", "___"}], "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{
             "Evaluating", " ", "decay", " ", "acceptances", " ", "per", " ", 
              "each", " ", "channel", " ", "and", " ", "averaging", " ", 
              "over", " ", "simulated", " ", 
              RowBox[{"decays", ".", " ", "At"}], " ", "this", " ", "step"}], 
             ",", " ", 
             RowBox[{
              RowBox[{"some", " ", "values", " ", "may", " ", "be"}], " ", 
              ">", " ", 
              RowBox[{
              "1", " ", "if", " ", "the", " ", "number", " ", "of", " ", 
               "combinations", " ", "of", " ", "pairs", " ", "of", " ", "the",
                " ", "decay", " ", "products", " ", "is"}], " ", ">", " ", 
              "1"}]}], "*)"}], "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
            "___", "___", "___", "___", "___", "___", "___", "___", "___", 
             "___", "___", "___", "___", "___"}], "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"proclistgiven", "=", 
             RowBox[{"isimulvalPerDecayChannel", "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", "2"}], "]"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"isimlistgiven", "=", 
             RowBox[{"isimulvalPerDecayChannel", "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", "1"}], "]"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"DecayAcceptancesList", "=", 
             RowBox[{"DecayAcceptanceELLP\[Theta]LLPzLLPoverall", "[", 
              RowBox[{
              "LLP", ",", "mLLP", ",", "proclistgiven", ",", "isimlistgiven", 
               ",", "gridNonZero", ",", "HadronizationOption", ",", 
               "AllProductsWithinAcceptance"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{
              "This", " ", "code", " ", "replaces", " ", "the", " ", 
               "values"}], " ", ">", " ", 
              RowBox[{"1", " ", "with", " ", "1."}]}], "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{"Table", " ", 
               SubscriptBox["E", "LLP"]}], ",", 
              SubscriptBox["\[Theta]", "LLP"], ",", 
              SubscriptBox["z", "LLP"], ",", 
              SubscriptBox["\[Epsilon]", 
               RowBox[{"az", ",", "LLP"}]], ",", 
              SubscriptBox["\[Epsilon]", "decay"], ",", " ", 
              RowBox[{
              "where", " ", "the", " ", "decay", " ", "acceptance", " ", "is",
                " ", "averaged", " ", "over", " ", "channels"}]}], "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{"t1", "=", 
             RowBox[{"Join", "[", 
              RowBox[{
              "gridReducedNonZero", ",", "DecayAcceptancesList", ",", "2"}], 
              "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Length", "[", "gridReducedZero", "]"}], "\[NotEqual]",
                "0"}], ",", "\[IndentingNewLine]", 
              RowBox[{"(*", 
               RowBox[{
               "Merging", " ", "the", " ", "table", " ", "computed", " ", 
                "above", " ", "with", " ", "tables", " ", "with", " ", "zero",
                 " ", "acceptance"}], "*)"}], "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"t2", "=", 
                RowBox[{"Join", "[", 
                 RowBox[{"gridReducedZero", ",", 
                  RowBox[{"Table", "[", 
                   RowBox[{
                    RowBox[{"{", "0.", "}"}], ",", 
                    RowBox[{"Length", "[", "gridReducedZero", "]"}]}], "]"}], 
                  ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
               RowBox[{"(*", 
                RowBox[{"Final", " ", "output"}], "*)"}], 
               "\[IndentingNewLine]", 
               RowBox[{"finaldata", "=", 
                RowBox[{"SortBy", "[", 
                 RowBox[{
                  RowBox[{"Join", "[", 
                   RowBox[{"t1", ",", "t2"}], "]"}], ",", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "3", "]"}], "]"}]}], "}"}], "&"}]}], 
                 "]"}]}]}], ",", 
              RowBox[{"finaldata", "=", 
               RowBox[{"SortBy", "[", 
                RowBox[{"t1", ",", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "3", "]"}], "]"}]}], "}"}], "&"}]}], 
                "]"}]}]}], "]"}]}], ",", 
           RowBox[{"finaldata", "=", 
            RowBox[{"Join", "[", 
             RowBox[{"gridreduced", ",", 
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"{", "0.", "}"}], ",", 
                RowBox[{"Length", "[", "gridreduced", "]"}]}], "]"}], ",", 
              "2"}], "]"}]}]}], "]"}]}]}], "\[IndentingNewLine]", "]"}], ";", 
      "\[IndentingNewLine]", "finaldata"}]}], "\[IndentingNewLine]", 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.8935013279878063`*^9, 3.893501408818131*^9}, {
   3.893582686026419*^9, 3.893582687582264*^9}, 3.893582777150035*^9, {
   3.893582905854031*^9, 3.8935829155253963`*^9}, {3.8945318196185684`*^9, 
   3.8945318216042967`*^9}, {3.894531892812183*^9, 3.894531936889783*^9}, {
   3.8983234026557837`*^9, 3.8983234030904875`*^9}, {3.898501094837611*^9, 
   3.898501095575096*^9}, 3.898671676642496*^9, 3.898671835880391*^9, 
   3.8986736828958817`*^9, 3.8986737209966764`*^9, 3.8986738053828163`*^9, 
   3.8986762723594136`*^9, {3.898676325487214*^9, 3.8986763457690244`*^9}, {
   3.898676866083459*^9, 3.8986768686623063`*^9}, {3.8986771073659534`*^9, 
   3.898677107538133*^9}, {3.8986771694529095`*^9, 3.8986772046738443`*^9}, {
   3.898698343853408*^9, 3.8986983445809174`*^9}, {3.9017231237129755`*^9, 
   3.9017231302758055`*^9}, {3.904794414756953*^9, 3.9047944161055107`*^9}, {
   3.904794617236865*^9, 3.9047946209886703`*^9}, {3.9049002924951935`*^9, 
   3.904900317096446*^9}, {3.905845259870467*^9, 3.905845274650733*^9}, {
   3.9058453583083286`*^9, 3.9058453615242596`*^9}, {3.9119758733092823`*^9, 
   3.911975895511446*^9}, {3.912076179915456*^9, 3.912076183918428*^9}, {
   3.9120762400255055`*^9, 3.9120763256793785`*^9}, {3.9120778297171803`*^9, 
   3.912077853900365*^9}, {3.912150211629831*^9, 3.912150236332773*^9}, {
   3.9121503257733097`*^9, 3.9121504194277124`*^9}, {3.912150465322407*^9, 
   3.912150467378523*^9}, 3.9121506435034223`*^9, {3.914750761688745*^9, 
   3.9147507808780293`*^9}, {3.9154371532662325`*^9, 
   3.9154371536720304`*^9}, {3.916157203134308*^9, 3.9161572511085944`*^9}, {
   3.9161576125799246`*^9, 3.9161576132205596`*^9}},
 CellLabel->
  "In[103]:=",ExpressionUUID->"caac9d16-cc9d-4157-9318-fd5033b0970c"]
}, Open  ]],

Cell[CellGroupData[{

Cell["If the LLP and mass only is fixed", "Subsection",
 CellChangeTimes->{{3.8934369462970867`*^9, 3.893436953008216*^9}, {
   3.8934370629670296`*^9, 3.893437063858898*^9}, 
   3.915437153680625*^9},ExpressionUUID->"9671cacd-eedf-46a8-a742-\
5242b99d4dcd"],

Cell[BoxData[
 RowBox[{
  RowBox[{"FinalBlockMass", "[", 
   RowBox[{
   "LLP_", ",", "mLLP_", ",", "proclist_", ",", "isim_", ",", 
    "HadronizationOption_", ",", "AllProductsWithinAcceptance_"}], "]"}], ":=",
   "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
     "Block", " ", "computing", " ", "the", " ", "decay", " ", "acceptance", 
      " ", "for", " ", "LLPs", " ", "that", " ", "point", " ", "or", " ", 
      "not", " ", "point", " ", "to", " ", "the", " ", "detector"}], "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"tabAccToDet", ",", "tabAccNotToDet"}], "}"}], "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
         "DecayVolumeAsDetectorGivenExperiment", "\[Equal]", 
          "\"\<False\>\""}], "&&", 
         RowBox[{"!", 
          RowBox[{"(", 
           RowBox[{"GivenExperiment", "==", "\"\<ANUBIS-ceiling\>\""}], 
           ")"}]}]}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"DecayAcceptanceBlock", "[", 
           RowBox[{
           "LLP", ",", "mLLP", ",", "proclist", ",", "gridLLPtoDet", ",", 
            "gridReducedLLPtoDet", ",", "isim", ",", "HadronizationOption", 
            ",", "AllProductsWithinAcceptance"}], "]"}], ",", 
          RowBox[{"DecayAcceptanceBlock", "[", 
           RowBox[{
           "LLP", ",", "mLLP", ",", "proclist", ",", "gridLLPnotToDet", ",", 
            "gridReducedLLPnotToDet", ",", "isim", ",", "HadronizationOption",
             ",", "AllProductsWithinAcceptance"}], "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"DecayAcceptanceBlock", "[", 
           RowBox[{
           "LLP", ",", "mLLP", ",", "proclist", ",", "gridLLPtoDet", ",", 
            "gridReducedLLPtoDet", ",", "isim", ",", "HadronizationOption", 
            ",", "AllProductsWithinAcceptance"}], "]"}], ",", "0"}], "}"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Table", " ", 
        SubscriptBox["m", "LLP"]}], ",", " ", 
       SubscriptBox["E", "LLP"], ",", " ", 
       SubscriptBox["\[Theta]", "LLP"], ",", " ", 
       SubscriptBox["z", "LLP"], ",", " ", 
       RowBox[{"<", 
        SubscriptBox["\[Epsilon]", "decay"], 
        SubscriptBox[">", 
         RowBox[{"\[Phi]", ",", " ", 
          RowBox[{
           RowBox[{"to", " ", "det"}], " ", "+", " ", 
           RowBox[{"not", " ", "to", " ", "det"}]}]}]]}], ",", " ", 
       RowBox[{"<", 
        RowBox[{
         SubscriptBox["\[Epsilon]", "decay"], "*", 
         SubscriptBox["\[Epsilon]", 
          RowBox[{"other", " ", "cuts"}]]}], 
        SubscriptBox[">", 
         RowBox[{"\[Phi]", ",", " ", 
          RowBox[{
           RowBox[{"to", " ", "det"}], " ", "+", " ", 
           RowBox[{"not", " ", "to", " ", "det"}]}]}]]}]}], "*)"}], " ", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"By", " ", 
        SubscriptBox["<>", 
         RowBox[{"\[Phi]", ",", " ", 
          RowBox[{
           RowBox[{"to", " ", "det"}], " ", "+", " ", 
           RowBox[{"not", " ", "to", " ", "det"}]}]}]]}], ",", " ", 
       RowBox[{
       "one", " ", "averages", " ", "over", " ", "the", " ", "LLP", " ", 
        "directions", " ", "pointing", " ", "to", " ", "the", " ", "end", " ",
         "of", " ", "detector", " ", "and", " ", "directions", " ", "that", 
        " ", "do", " ", "not", " ", "point", " ", "to", " ", "it"}], ",", " ", 
       RowBox[{
       "with", " ", "the", " ", "weights", " ", "being", " ", "the", " ", 
        "azimuthal", " ", "acceptance"}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "tabAccToDet", "]"}], "!=", "0"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
          "DecayVolumeAsDetectorGivenExperiment", "\[Equal]", 
           "\"\<False\>\""}], "&&", 
          RowBox[{"!", 
           RowBox[{"(", 
            RowBox[{"GivenExperiment", "==", "\"\<ANUBIS-ceiling\>\""}], 
            ")"}]}]}], ",", 
         RowBox[{"\[Epsilon]dec1Compiled", "[", 
          RowBox[{"tabAccToDet", ",", "tabAccNotToDet", ",", "mLLP"}], "]"}], 
         ",", 
         RowBox[{"\[Epsilon]dec2Compiled", "[", 
          RowBox[{"tabAccToDet", ",", "mLLP"}], "]"}]}], "]"}]}], 
      "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.8935147134534073`*^9, 3.893514713949625*^9}, 
   3.893514857430545*^9, {3.893515036345576*^9, 3.8935150427908497`*^9}, {
   3.893519901454827*^9, 3.893519934261715*^9}, {3.893582271707983*^9, 
   3.8935822725908127`*^9}, {3.8986772134528956`*^9, 3.898677222028368*^9}, {
   3.9017232314449778`*^9, 3.9017232436908264`*^9}, {3.902914677735798*^9, 
   3.9029147172092967`*^9}, {3.9037193498054953`*^9, 3.90371935238286*^9}, {
   3.9047945896146975`*^9, 3.9047946031785574`*^9}, {3.9058452838471003`*^9, 
   3.9058452920703783`*^9}, {3.905845347664421*^9, 3.9058453666948028`*^9}, {
   3.911975918083952*^9, 3.9119759305152473`*^9}, {3.9121454426978407`*^9, 
   3.91214544314142*^9}, {3.9147509779909973`*^9, 3.914750993941861*^9}, {
   3.9154371536860657`*^9, 3.9154371537640057`*^9}, {3.9161572683256907`*^9, 
   3.9161573283363104`*^9}, {3.916161996736026*^9, 3.916162015236701*^9}, {
   3.9161624343967385`*^9, 3.916162435018072*^9}, {3.916897514322591*^9, 
   3.9168975465863476`*^9}},
 CellLabel->
  "In[104]:=",ExpressionUUID->"3eeda535-17d6-48f5-ad62-a6df19ebf8c1"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1428., 729.75},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
Magnification:>0.9 Inherited,
FrontEndVersion->"14.1 for Microsoft Windows (64-bit) (July 16, 2024)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"9934dbf3-3188-4005-b111-1d1e33a1a328"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 228, 4, 60, "Chapter",ExpressionUUID->"70c08414-8e83-48c2-82e8-8fa5758d7241"],
Cell[CellGroupData[{
Cell[833, 30, 244, 4, 59, "Section",ExpressionUUID->"ade4bc47-2ae5-4f6a-b1b0-171e857f7102"],
Cell[CellGroupData[{
Cell[1102, 38, 160, 3, 47, "Subsection",ExpressionUUID->"8729d17f-1d3a-4eaa-98ec-8f49f54815e3"],
Cell[1265, 43, 2154, 60, 252, "Input",ExpressionUUID->"cbfbbe02-6751-49e4-964b-aa59849db48d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[3456, 108, 172, 3, 47, "Subsection",ExpressionUUID->"f02e9a12-c92c-422c-a166-2b8ff8267683"],
Cell[CellGroupData[{
Cell[3653, 115, 170, 3, 39, "Subsubsection",ExpressionUUID->"f9291186-597c-407c-8842-0139f518ac2d"],
Cell[CellGroupData[{
Cell[3848, 122, 22022, 530, 817, "Input",ExpressionUUID->"0b9d437f-d2eb-4420-93a0-e8c91803cc37"],
Cell[25873, 654, 916, 15, 19, "Print",ExpressionUUID->"8f6e0663-f852-47e4-9353-dbda86717701"],
Cell[26792, 671, 2214, 48, 108, "Output",ExpressionUUID->"dadffa63-9e5d-4284-b0b9-a350bd78870e"],
Cell[29009, 721, 839, 13, 19, "Print",ExpressionUUID->"40ad9396-ffb4-462e-901a-0c98400f09e8"],
Cell[29851, 736, 1901, 46, 54, "Output",ExpressionUUID->"e0aabe16-6597-463d-bb1f-f1c65f797655"],
Cell[31755, 784, 964, 16, 19, "Print",ExpressionUUID->"1aff690f-c9a0-40ec-a3de-5e36466ffe5d"],
Cell[32722, 802, 1623, 37, 45, "Output",ExpressionUUID->"b2265da1-bf56-44bc-ad6f-b8652fe70963"],
Cell[34348, 841, 1569, 24, 20, "Print",ExpressionUUID->"ac63bc52-dd2e-4307-9035-c2fe47d5628b"],
Cell[35920, 867, 1035, 21, 46, "Output",ExpressionUUID->"9e1501ba-73c1-42d5-b99d-6bd2ea88a791"],
Cell[36958, 890, 831, 13, 19, "Print",ExpressionUUID->"8a7d1992-eb60-4d99-bdd0-f13d9ed05ff5"],
Cell[37792, 905, 852, 15, 42, "Output",ExpressionUUID->"8b231285-b8f9-4171-9bd8-fbbc2005d07b"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[38693, 926, 169, 3, 39, "Subsubsection",ExpressionUUID->"c86adca8-b666-4af8-9bf2-0ba78eb48425"],
Cell[38865, 931, 8000, 211, 319, "Input",ExpressionUUID->"e8ab0043-e9a1-41b4-b797-4c6c5b631938"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[46926, 1149, 164, 3, 59, "Section",ExpressionUUID->"9f7d2cd2-1d3c-45ce-8997-9a78ca960c9c"],
Cell[47093, 1154, 11920, 266, 441, "Input",ExpressionUUID->"81a42d38-67b7-45c9-ba7d-7dd464bf7b31"],
Cell[CellGroupData[{
Cell[59038, 1424, 297, 4, 47, "Subsection",ExpressionUUID->"8d6d3c37-fa52-4138-9634-51c566617a6c"],
Cell[59338, 1430, 9324, 235, 362, "Input",ExpressionUUID->"09dfabe2-92c3-495a-9593-b813ce33c544"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[68711, 1671, 314, 5, 59, "Section",ExpressionUUID->"f5d42416-0563-43ca-b5d5-8d454d305ff8"],
Cell[CellGroupData[{
Cell[69050, 1680, 202, 3, 47, "Subsection",ExpressionUUID->"045ec994-987a-453d-9df8-924e58feae6c"],
Cell[CellGroupData[{
Cell[69277, 1687, 170, 3, 39, "Subsubsection",ExpressionUUID->"ee020017-ea44-4e2a-878a-71d6154738b7"],
Cell[CellGroupData[{
Cell[69472, 1694, 12817, 323, 563, "Input",ExpressionUUID->"98f961b0-4fc6-4ac2-9887-c6c819a52732"],
Cell[82292, 2019, 673, 19, 45, "Output",ExpressionUUID->"25403852-8594-42da-8e14-9523345e88ad"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[83014, 2044, 172, 3, 39, "Subsubsection",ExpressionUUID->"5312240b-2fca-47c6-82b5-c47a3254613a"],
Cell[83189, 2049, 13354, 311, 575, "Input",ExpressionUUID->"3aa3b887-b65c-40c3-a614-ee4fe0b9db40"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[96592, 2366, 333, 5, 47, "Subsection",ExpressionUUID->"53204555-742a-4581-b490-679c494e0d09"],
Cell[CellGroupData[{
Cell[96950, 2375, 291, 4, 39, "Subsubsection",ExpressionUUID->"d1605ee8-ce6d-4055-be95-1e16e0571b24"],
Cell[97244, 2381, 17185, 339, 762, "Input",ExpressionUUID->"39533115-0bd5-4302-9b8c-6f8564499393"]
}, Open  ]],
Cell[CellGroupData[{
Cell[114466, 2725, 286, 4, 39, "Subsubsection",ExpressionUUID->"8d07c91f-2179-4077-8d72-1f198ad662cb"],
Cell[114755, 2731, 6427, 148, 383, "Input",ExpressionUUID->"7b470239-7269-4c6b-8908-fc957fa58f5a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[121219, 2884, 355, 10, 39, "Subsubsection",ExpressionUUID->"0714da82-4a9d-48d5-b035-e74e6965c9bb"],
Cell[121577, 2896, 3910, 89, 240, "Input",ExpressionUUID->"2b046f74-4229-4675-9a3c-8a7068a28ae9"]
}, Open  ]],
Cell[CellGroupData[{
Cell[125524, 2990, 218, 3, 39, "Subsubsection",ExpressionUUID->"323ac7f5-a051-4f34-b6c4-0bbccaf757a4"],
Cell[125745, 2995, 3742, 85, 228, "Input",ExpressionUUID->"aa247068-1609-4472-8412-bf180521a78e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[129524, 3085, 318, 5, 39, "Subsubsection",ExpressionUUID->"c2ac6355-4f9c-442e-a462-bbb27e3ced44"],
Cell[129845, 3092, 10639, 233, 659, "Input",ExpressionUUID->"bc804652-2340-4eb2-8be5-ebfb08c0447e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[140521, 3330, 377, 5, 40, "Subsubsection",ExpressionUUID->"788b5518-807f-472b-8354-341fb679729f"],
Cell[140901, 3337, 9422, 207, 590, "Input",ExpressionUUID->"1abe4436-0741-4770-8209-f900e1a9baa1"]
}, Open  ]],
Cell[CellGroupData[{
Cell[150360, 3549, 268, 4, 40, "Subsubsection",ExpressionUUID->"12771194-9fc3-48a6-8133-04f746a35664"],
Cell[150631, 3555, 5189, 113, 292, "Input",ExpressionUUID->"1ecf763b-bf2e-4a41-8c4a-2c3c507abac6"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[155869, 3674, 204, 3, 48, "Subsection",ExpressionUUID->"b696c8fe-c8d5-4cd7-a9cd-3cd5b84c7eab"],
Cell[CellGroupData[{
Cell[156098, 3681, 331, 5, 40, "Subsubsection",ExpressionUUID->"51295e41-4d8b-4871-a652-b56ef4cecf3d"],
Cell[156432, 3688, 26932, 522, 1332, "Input",ExpressionUUID->"7ce1b7af-b6f0-4d4e-9d92-6e607a71e454"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[183413, 4216, 304, 6, 48, "Subsection",ExpressionUUID->"a1452150-38b6-4279-8669-3ce99cd99d9d"],
Cell[CellGroupData[{
Cell[183742, 4226, 20068, 434, 851, "Input",ExpressionUUID->"1758969e-467e-482a-9d29-3b1f5444d1ec"],
Cell[203813, 4662, 17012, 319, 57, "Output",ExpressionUUID->"7f34f167-7989-499b-b61b-138cd29cd4c9"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[220874, 4987, 630, 15, 48, "Subsection",ExpressionUUID->"dae2eb05-38c6-4723-b448-9fb5a8d67e08"],
Cell[221507, 5004, 14427, 314, 623, "Input",ExpressionUUID->"caac9d16-cc9d-4157-9318-fd5033b0970c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[235971, 5323, 258, 4, 48, "Subsection",ExpressionUUID->"9671cacd-eedf-46a8-a742-5242b99d4dcd"],
Cell[236232, 5329, 5700, 128, 235, "Input",ExpressionUUID->"3eeda535-17d6-48f5-ad62-a6df19ebf8c1"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

