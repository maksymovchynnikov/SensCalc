(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     82598,       2118]
NotebookOptionsPosition[     78491,       2035]
NotebookOutlinePosition[     78928,       2052]
CellTagsIndexPosition[     78885,       2049]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Definitions", "Chapter",
 CellChangeTimes->{{3.931067878524694*^9, 
  3.9310678798377237`*^9}},ExpressionUUID->"50176953-4ca1-44c9-87c3-\
6e438dff1183"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"dirpheno", "=", 
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"NotebookDirectory", "[", "]"}], "//", "ParentDirectory"}], "//",
        "ParentDirectory"}], ",", "\"\<phenomenology\>\""}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"{", 
   RowBox[{"p1", ",", "p2", ",", "p3", ",", "p4", ",", "p"}], "}"}], "//", 
  "Clear"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"chbarval", "=", 
   RowBox[{"3", "*", 
    SuperscriptBox["10", "8"], "*", "6.58", "*", 
    SuperscriptBox["10", 
     RowBox[{"-", "25"}]]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.931070540853923*^9, 3.931070552921802*^9}, {
  3.931154514741552*^9, 3.931154528777212*^9}, {3.9311582120108376`*^9, 
  3.931158212220131*^9}, {3.931228108711256*^9, 3.9312281396304984`*^9}},
 CellLabel->
  "In[102]:=",ExpressionUUID->"e6884e6e-3090-4640-ab83-b1165cfb15c9"],

Cell[CellGroupData[{

Cell["Indices", "Section",
 CellChangeTimes->{{3.931068650454211*^9, 
  3.9310686512222557`*^9}},ExpressionUUID->"471c60cf-4ea7-46db-a39e-\
9cf75ed2cc32"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Indices", " ", "Definitions"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"indexpx1", "=", "1"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"indexpy1", "=", "2"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"indexpz1", "=", "3"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"indexE1", "=", "4"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"indexm1", "=", "5"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"indexpdg1", "=", "6"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"indexcharge1", "=", "7"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"indexstability1", "=", "8"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"LengthDataProduct", "=", "indexstability1"}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.9310681493338566`*^9, 3.931068150916479*^9}},
 CellLabel->
  "In[105]:=",ExpressionUUID->"225208d1-cdc5-4b84-8a87-0412bebfc537"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Boosting decay products to the lab frame ", "Section",
 CellChangeTimes->{{3.931068705047839*^9, 
  3.9310687234136534`*^9}},ExpressionUUID->"8139c5e2-7a6c-4ef4-a847-\
eca44df1bacb"],

Cell[CellGroupData[{

Cell["Formulas for Lorentz boosts", "Subsection",
 CellChangeTimes->{{3.931068745383543*^9, 
  3.9310687495025215`*^9}},ExpressionUUID->"8838b665-eb82-4f38-afbd-\
df4ae7480d9d"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Mother", " ", "Particle", " ", "and", " ", "Decay", " ", "Calculations"}],
    "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"pvecMotherLab", "[", 
      RowBox[{"pMotherLab1_", ",", "pMotherLab2_", ",", "pMotherLab3_"}], 
      "]"}], "=", 
     RowBox[{"{", 
      RowBox[{"pMotherLab1", ",", "pMotherLab2", ",", "pMotherLab3"}], 
      "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"vvecMotherLab", "[", 
      RowBox[{
      "EmotherLab_", ",", "pMotherLab1_", ",", "pMotherLab2_", ",", 
       "pMotherLab3_"}], "]"}], "=", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"pvecMotherLab", "[", 
        RowBox[{"pMotherLab1", ",", "pMotherLab2", ",", "pMotherLab3"}], 
        "]"}], "/", "EmotherLab"}], ")"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Gamma]Factor", "[", 
      RowBox[{"Energy_", ",", "m_"}], "]"}], ":=", 
     RowBox[{"Energy", "/", "m"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"\[CapitalGamma]factorMotherLab", "[", 
      RowBox[{"EmotherLab_", ",", "mMother_"}], "]"}], "=", 
     RowBox[{"Simplify", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"\[Gamma]Factor", "[", 
          RowBox[{"EmotherLab", ",", "mMother"}], "]"}], "-", "1"}], ")"}], "/", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"v", "/.", " ", 
            RowBox[{"Solve", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"\[Gamma]Factor", "[", 
                RowBox[{"EmotherLab", ",", "mMother"}], "]"}], "==", 
               RowBox[{"1", "/", 
                RowBox[{"Sqrt", "[", 
                 RowBox[{"1", "-", 
                  RowBox[{"v", "^", "2"}]}], "]"}]}]}], ",", "v"}], "]"}]}], 
           ")"}], "^", "2"}], ")"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"pVecProdRest", "[", 
      RowBox[{"pProdRest1_", ",", "pProdRest2_", ",", "pProdRest3_"}], "]"}], 
     "=", 
     RowBox[{"{", 
      RowBox[{"pProdRest1", ",", "pProdRest2", ",", "pProdRest3"}], "}"}]}], 
    ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"pVecProdLab", "[", 
      RowBox[{
      "EmotherLab_", ",", "mMother_", ",", "pMotherLab1_", ",", 
       "pMotherLab2_", ",", "pMotherLab3_", ",", "EProdRest_", ",", 
       "pProdRest1_", ",", "pProdRest2_", ",", "pProdRest3_"}], "]"}], "=", 
     RowBox[{
      RowBox[{"Simplify", "[", 
       RowBox[{
        RowBox[{"pVecProdRest", "[", 
         RowBox[{"pProdRest1", ",", "pProdRest2", ",", "pProdRest3"}], "]"}], 
        "+", 
        RowBox[{
         RowBox[{"\[Gamma]Factor", "[", 
          RowBox[{"EmotherLab", ",", "mMother"}], "]"}], "*", 
         RowBox[{"vvecMotherLab", "[", 
          RowBox[{
          "EmotherLab", ",", "pMotherLab1", ",", "pMotherLab2", ",", 
           "pMotherLab3"}], "]"}], "*", "EProdRest"}], "+", 
        RowBox[{
         RowBox[{"\[CapitalGamma]factorMotherLab", "[", 
          RowBox[{"EmotherLab", ",", "mMother"}], "]"}], "*", 
         RowBox[{"vvecMotherLab", "[", 
          RowBox[{
          "EmotherLab", ",", "pMotherLab1", ",", "pMotherLab2", ",", 
           "pMotherLab3"}], "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"vvecMotherLab", "[", 
            RowBox[{
            "EmotherLab", ",", "pMotherLab1", ",", "pMotherLab2", ",", 
             "pMotherLab3"}], "]"}], ".", 
           RowBox[{"pVecProdRest", "[", 
            RowBox[{"pProdRest1", ",", "pProdRest2", ",", "pProdRest3"}], 
            "]"}]}], ")"}]}]}], "]"}], "//", "Expand"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"EProdLab", "[", 
      RowBox[{
      "EmotherLab_", ",", "mMother_", ",", "pMotherLab1_", ",", 
       "pMotherLab2_", ",", "pMotherLab3_", ",", "EProdRest_", ",", 
       "pProdRest1_", ",", "pProdRest2_", ",", "pProdRest3_"}], "]"}], "=", 
     RowBox[{"Simplify", "[", 
      RowBox[{
       RowBox[{"\[Gamma]Factor", "[", 
        RowBox[{"EmotherLab", ",", "mMother"}], "]"}], " ", 
       RowBox[{"(", 
        RowBox[{"EProdRest", "+", 
         RowBox[{
          RowBox[{"vvecMotherLab", "[", 
           RowBox[{
           "EmotherLab", ",", "pMotherLab1", ",", "pMotherLab2", ",", 
            "pMotherLab3"}], "]"}], ".", 
          RowBox[{"pVecProdRest", "[", 
           RowBox[{"pProdRest1", ",", "pProdRest2", ",", "pProdRest3"}], 
           "]"}]}]}], ")"}]}], "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"pProductLab1", "[", 
      RowBox[{
      "EmotherLab_", ",", "mMother_", ",", "pMotherLab1_", ",", 
       "pMotherLab2_", ",", "pMotherLab3_", ",", "EProdRest_", ",", 
       "pProdRest1_", ",", "pProdRest2_", ",", "pProdRest3_"}], "]"}], "=", 
     RowBox[{
      RowBox[{"pVecProdLab", "[", 
       RowBox[{
       "EmotherLab", ",", "mMother", ",", "pMotherLab1", ",", "pMotherLab2", ",",
         "pMotherLab3", ",", "EProdRest", ",", "pProdRest1", ",", 
        "pProdRest2", ",", "pProdRest3"}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"pProductLab2", "[", 
      RowBox[{
      "EmotherLab_", ",", "mMother_", ",", "pMotherLab1_", ",", 
       "pMotherLab2_", ",", "pMotherLab3_", ",", "EProdRest_", ",", 
       "pProdRest1_", ",", "pProdRest2_", ",", "pProdRest3_"}], "]"}], "=", 
     RowBox[{
      RowBox[{"pVecProdLab", "[", 
       RowBox[{
       "EmotherLab", ",", "mMother", ",", "pMotherLab1", ",", "pMotherLab2", ",",
         "pMotherLab3", ",", "EProdRest", ",", "pProdRest1", ",", 
        "pProdRest2", ",", "pProdRest3"}], "]"}], "[", 
      RowBox[{"[", "2", "]"}], "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"pProductLab3", "[", 
      RowBox[{
      "EmotherLab_", ",", "mMother_", ",", "pMotherLab1_", ",", 
       "pMotherLab2_", ",", "pMotherLab3_", ",", "EProdRest_", ",", 
       "pProdRest1_", ",", "pProdRest2_", ",", "pProdRest3_"}], "]"}], "=", 
     RowBox[{
      RowBox[{"pVecProdLab", "[", 
       RowBox[{
       "EmotherLab", ",", "mMother", ",", "pMotherLab1", ",", "pMotherLab2", ",",
         "pMotherLab3", ",", "EProdRest", ",", "pProdRest1", ",", 
        "pProdRest2", ",", "pProdRest3"}], "]"}], "[", 
      RowBox[{"[", "3", "]"}], "]"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.931068653024907*^9, 3.931068663347831*^9}, {
  3.931229097410858*^9, 3.931229111979993*^9}},
 CellLabel->
  "In[114]:=",ExpressionUUID->"48d11298-d6a9-4f53-9736-873f311c6a09"],

Cell[BoxData[
 FormBox[
  TemplateBox[{
   "Solve", "nongen", 
    "\"There may be values of the parameters for which some or all solutions \
are not valid.\"", 2, 117, 1, 23777492601901756285, "Local"},
   "MessageTemplate",
   BaseStyle->"MSG"], TraditionalForm]], "Message",
 CellChangeTimes->{3.9312291122846437`*^9, 3.9313153677165537`*^9, 
  3.93131638321842*^9, 3.931317233114545*^9, 3.9313173887820864`*^9, 
  3.935513720105507*^9, 3.94220588905608*^9, 3.9527532974433784`*^9, 
  3.952756956739212*^9, 3.952762420855173*^9},
 CellLabel->
  "During evaluation of \
In[114]:=",ExpressionUUID->"41891f62-59c3-b942-a266-562c58990b75"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Boosting", "Subsection",
 CellChangeTimes->{{3.9310687349271135`*^9, 
  3.931068735659805*^9}},ExpressionUUID->"964d2146-e1cd-496b-928d-\
5b0194bc6551"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Decay", " ", "Product", " ", "Calculation", " ", "in", " ", "Lab", " ", 
    "Frame"}], "*)"}], 
  RowBox[{
   RowBox[{
    RowBox[{"TabBoostedDecayProductComp", "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Hold", "@", 
         RowBox[{"Compile", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"tablemother", ",", "_Real", ",", "1"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"tabledaughter", ",", "_Real", ",", "1"}], "}"}]}], 
            "}"}], ",", 
           RowBox[{"Module", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
              "motherE", ",", "motherpx", ",", "motherpy", ",", "motherpz", ",",
                "daughterErest", ",", "daughterpxrest", ",", "daughterpyrest",
                ",", "daughterpzrest", ",", "daughterElab", ",", 
               "daughterpxlab", ",", "daughterpylab", ",", "daughterpzlab", ",",
                "mmother", ",", "daughtercharge", ",", "daughterpdg", ",", 
               "daughterstability", ",", "daughterm"}], "}"}], ",", 
             RowBox[{
              RowBox[{"mmother", "=", 
               RowBox[{"Compile`GetElement", "[", 
                RowBox[{"tablemother", ",", "indexm1"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"motherE", "=", 
               RowBox[{"Compile`GetElement", "[", 
                RowBox[{"tablemother", ",", "indexE1"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"motherpx", "=", 
               RowBox[{"Compile`GetElement", "[", 
                RowBox[{"tablemother", ",", "indexpx1"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"motherpy", "=", 
               RowBox[{"Compile`GetElement", "[", 
                RowBox[{"tablemother", ",", "indexpy1"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"motherpz", "=", 
               RowBox[{"Compile`GetElement", "[", 
                RowBox[{"tablemother", ",", "indexpz1"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"daughterErest", "=", 
               RowBox[{"Compile`GetElement", "[", 
                RowBox[{"tabledaughter", ",", "indexE1"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"daughterpxrest", "=", 
               RowBox[{"Compile`GetElement", "[", 
                RowBox[{"tabledaughter", ",", "indexpx1"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"daughterpyrest", "=", 
               RowBox[{"Compile`GetElement", "[", 
                RowBox[{"tabledaughter", ",", "indexpy1"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"daughterpzrest", "=", 
               RowBox[{"Compile`GetElement", "[", 
                RowBox[{"tabledaughter", ",", "indexpz1"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"daughterm", "=", 
               RowBox[{"Compile`GetElement", "[", 
                RowBox[{"tabledaughter", ",", "indexm1"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"daughtercharge", "=", 
               RowBox[{"Compile`GetElement", "[", 
                RowBox[{"tabledaughter", ",", "indexcharge1"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"daughterpdg", "=", 
               RowBox[{"Compile`GetElement", "[", 
                RowBox[{"tabledaughter", ",", "indexpdg1"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"daughterstability", "=", 
               RowBox[{"Compile`GetElement", "[", 
                RowBox[{"tabledaughter", ",", "indexstability1"}], "]"}]}], ";",
               "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"daughterpdg", "!=", 
                 RowBox[{"-", "999."}]}], ",", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"daughterElab", "=", 
                  RowBox[{"EProdLab", "[", 
                   RowBox[{
                   "motherE", ",", "mmother", ",", "motherpx", ",", 
                    "motherpy", ",", "motherpz", ",", "daughterErest", ",", 
                    "daughterpxrest", ",", "daughterpyrest", ",", 
                    "daughterpzrest"}], "]"}]}], ";", "\[IndentingNewLine]", 
                 RowBox[{"daughterpxlab", "=", 
                  RowBox[{"pProductLab1", "[", 
                   RowBox[{
                   "motherE", ",", "mmother", ",", "motherpx", ",", 
                    "motherpy", ",", "motherpz", ",", "daughterErest", ",", 
                    "daughterpxrest", ",", "daughterpyrest", ",", 
                    "daughterpzrest"}], "]"}]}], ";", "\[IndentingNewLine]", 
                 RowBox[{"daughterpylab", "=", 
                  RowBox[{"pProductLab2", "[", 
                   RowBox[{
                   "motherE", ",", "mmother", ",", "motherpx", ",", 
                    "motherpy", ",", "motherpz", ",", "daughterErest", ",", 
                    "daughterpxrest", ",", "daughterpyrest", ",", 
                    "daughterpzrest"}], "]"}]}], ";", "\[IndentingNewLine]", 
                 RowBox[{"daughterpzlab", "=", 
                  RowBox[{"pProductLab3", "[", 
                   RowBox[{
                   "motherE", ",", "mmother", ",", "motherpx", ",", 
                    "motherpy", ",", "motherpz", ",", "daughterErest", ",", 
                    "daughterpxrest", ",", "daughterpyrest", ",", 
                    "daughterpzrest"}], "]"}]}], ";"}], "\[IndentingNewLine]",
                 ",", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"daughterElab", "=", 
                  RowBox[{"daughterpxlab", "=", 
                   RowBox[{"daughterpylab", "=", 
                    RowBox[{"daughterpzlab", "=", 
                    RowBox[{"-", "999."}]}]}]}]}], ";"}]}], 
               "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{
               "daughterpxlab", ",", "daughterpylab", ",", "daughterpzlab", ",",
                 "daughterElab", ",", "daughterm", ",", "daughterpdg", ",", 
                "daughtercharge", ",", "daughterstability"}], "}"}]}]}], 
            "]"}], ",", 
           RowBox[{"CompilationTarget", "->", "\"\<C\>\""}], ",", 
           RowBox[{"RuntimeOptions", "->", "\"\<Speed\>\""}], ",", 
           RowBox[{"RuntimeAttributes", "->", 
            RowBox[{"{", "Listable", "}"}]}]}], "]"}]}], "/.", " ", 
        RowBox[{"ruleDown", "[", 
         RowBox[{"{", 
          RowBox[{
          "pProductLab1", ",", "pProductLab2", ",", "pProductLab3", ",", 
           "EProdLab"}], "}"}], "]"}]}], "/.", " ", 
       RowBox[{"ruleOwn", "[", 
        RowBox[{"{", 
         RowBox[{
         "indexpx1", ",", "indexpy1", ",", "indexpz1", ",", "indexE1", ",", 
          "indexm1", ",", "indexcharge1", ",", "indexpdg1", ",", 
          "indexstability1"}], "}"}], "]"}]}], "//", "ReleaseHold"}]}], ";"}],
    "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.931068723905327*^9, 3.931068723905327*^9}, {
   3.931068800076068*^9, 3.931068800195593*^9}, 3.9312291312802877`*^9, {
   3.9312291747101192`*^9, 3.9312291771819577`*^9}, {3.93123410745654*^9, 
   3.931234128802349*^9}, {3.935590008488968*^9, 3.9355900613438835`*^9}},
 CellLabel->
  "In[124]:=",ExpressionUUID->"190e301c-4c15-42b8-bc09-740c7498719e"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Kinematics of 3-body decays", "Section",
 CellChangeTimes->{{3.9311576579404116`*^9, 
  3.9311576640703278`*^9}},ExpressionUUID->"92f1f467-a754-4df7-ab7e-\
2872d3553ec2"],

Cell[CellGroupData[{

Cell[TextData[{
 "Kinematics as a function of ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["E", "1"], ",", 
    SubscriptBox["E", "3"]}], TraditionalForm]],ExpressionUUID->
  "221caaba-d35f-4ae8-a137-7ed5ed7a287e"]
}], "Subsection",
 CellChangeTimes->{{3.93115770877415*^9, 3.9311577158296323`*^9}, {
  3.93132471649424*^9, 
  3.9313247182570763`*^9}},ExpressionUUID->"a7087293-bf06-4296-9fff-\
233428303b6e"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Kinematics", " ", "of", " ", "3"}], "-", 
    RowBox[{"body", " ", "decays"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"pPar", "[", 
      RowBox[{"En_", ",", "mn_"}], "]"}], "=", 
     SqrtBox[
      RowBox[{
       SuperscriptBox["En", "2"], "-", 
       SuperscriptBox["mn", "2"]}]]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      SubscriptBox["E", "2"], " ", "expressed", " ", "via", " ", "the", " ", 
      "decaying", " ", "particle", " ", "mass", " ", "and", " ", "the", " ", 
      "energies", " ", "of", " ", "other", " ", "products", " ", 
      SubscriptBox["E", "1"]}], ",", 
     RowBox[{
      RowBox[{
       SubscriptBox["E", "3"], " ", "in", " ", "the", " ", "process", " ", 
       "0"}], "->", 
      RowBox[{"1", "+", "2", "+", "3"}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"E2valEnergies", "[", 
      RowBox[{"m_", ",", "E1_", ",", "E3_"}], "]"}], "=", 
     RowBox[{"m", "-", "E1", "-", "E3"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "cos", " ", "of", " ", "the", " ", "angle", " ", "between", " ", 
      "particles", " ", "1"}], ",", 
     RowBox[{"2", " ", "and", " ", "1"}], ",", 
     RowBox[{
      RowBox[{
      "3", " ", "at", " ", "rest", " ", "frame", " ", "of", " ", "decaying", " ",
        "particle", " ", "0"}], " ", "\[Rule]", " ", 
      RowBox[{"1", "+", "2", "+", 
       RowBox[{"3", " ", "parametrized", " ", "in", " ", "terms", " ", "of", " ", 
        SubscriptBox["E", "1"]}]}]}], ",", 
     SubscriptBox["E", "3"]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"cos\[Theta]12", "[", 
      RowBox[{
      "E1_", ",", "E3_", ",", "m_", ",", "m1_", ",", "m2_", ",", "m3_"}], 
      "]"}], "=", 
     FractionBox[
      RowBox[{
       SuperscriptBox[
        RowBox[{"pPar", "[", 
         RowBox[{"E3", ",", "m3"}], "]"}], "2"], "-", 
       SuperscriptBox[
        RowBox[{"pPar", "[", 
         RowBox[{"E1", ",", "m1"}], "]"}], "2"], "-", 
       SuperscriptBox[
        RowBox[{"pPar", "[", 
         RowBox[{
          RowBox[{"E2valEnergies", "[", 
           RowBox[{"m", ",", "E1", ",", "E3"}], "]"}], ",", "m2"}], "]"}], 
        "2"]}], 
      RowBox[{"2", 
       RowBox[{"pPar", "[", 
        RowBox[{"E1", ",", "m1"}], "]"}], "*", 
       RowBox[{"pPar", "[", 
        RowBox[{
         RowBox[{"E2valEnergies", "[", 
          RowBox[{"m", ",", "E1", ",", "E3"}], "]"}], ",", "m2"}], "]"}]}]]}],
     ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"cos\[Theta]13", "[", 
      RowBox[{
      "E1_", ",", "E3_", ",", "m_", ",", "m1_", ",", "m2_", ",", "m3_"}], 
      "]"}], "=", 
     FractionBox[
      RowBox[{
       SuperscriptBox[
        RowBox[{"pPar", "[", 
         RowBox[{
          RowBox[{"E2valEnergies", "[", 
           RowBox[{"m", ",", "E1", ",", "E3"}], "]"}], ",", "m2"}], "]"}], 
        "2"], "-", 
       SuperscriptBox[
        RowBox[{"pPar", "[", 
         RowBox[{"E1", ",", "m1"}], "]"}], "2"], "-", 
       SuperscriptBox[
        RowBox[{"pPar", "[", 
         RowBox[{"E3", ",", "m3"}], "]"}], "2"]}], 
      RowBox[{"2", 
       RowBox[{"pPar", "[", 
        RowBox[{"E1", ",", "m1"}], "]"}], "*", 
       RowBox[{"pPar", "[", 
        RowBox[{"E3", ",", "m3"}], "]"}]}]]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Theta]12", "[", 
      RowBox[{
      "E1_", ",", "E3_", ",", "m_", ",", "m1_", ",", "m2_", ",", "m3_"}], 
      "]"}], "=", 
     RowBox[{"ArcCos", "[", 
      RowBox[{"cos\[Theta]12", "[", 
       RowBox[{"E1", ",", "E3", ",", "m", ",", "m1", ",", "m2", ",", "m3"}], 
       "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Theta]13", "[", 
      RowBox[{
      "E1_", ",", "E3_", ",", "m_", ",", "m1_", ",", "m2_", ",", "m3_"}], 
      "]"}], "=", 
     RowBox[{"ArcCos", "[", 
      RowBox[{"cos\[Theta]13", "[", 
       RowBox[{"E1", ",", "E3", ",", "m", ",", "m1", ",", "m2", ",", "m3"}], 
       "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"Domain", " ", "of", " ", "definition", " ", "of", " ", 
       SubscriptBox["E", "1"], " ", "and", " ", 
       SubscriptBox["E", "3"], " ", "in", " ", "decay", " ", "0"}], "\[Rule]", 
      RowBox[{"1", "+", "2", "+", 
       RowBox[{
       "3", " ", "at", " ", "rest", " ", "frame", " ", "of", " ", "0"}]}]}], ",",
      " ", 
     RowBox[{
      SubscriptBox["E", 
       RowBox[{"3", ",", 
        RowBox[{"min", "/", "max"}]}]], " ", "=", " ", 
      RowBox[{"f", 
       RowBox[{
        RowBox[{"(", 
         SubscriptBox["E", "1"], ")"}], ".", " ", "Found"}], " ", "from", " ",
        "the", " ", "requirement", " ", "that", " ", "the", " ", "cosine", 
       RowBox[{"(", 
        SubscriptBox["\[Alpha]", "12"], ")"}], " ", "should", " ", "not", " ",
        "exceed", " ", "1"}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"E3domain", "[", 
     RowBox[{"E1_", ",", "m_", ",", "m1_", ",", "m2_", ",", "m3_"}], "]"}], "=", 
    RowBox[{"E3", "/.", 
     RowBox[{"(*", 
      RowBox[{"Assuming", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"m", ">", "0"}], "&&", 
         RowBox[{"E1", ">", "m1", ">", "0"}]}], ","}]}], "*)"}], 
     RowBox[{"Simplify", "[", 
      RowBox[{"Solve", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"cos\[Theta]12", "[", 
          RowBox[{
          "E1", ",", "E3", ",", "m", ",", "m1", ",", "m2", ",", "m3"}], "]"}],
          "\[Equal]", "1"}], ",", "E3"}], "]"}], "]"}]}]}], 
   RowBox[{"(*", "]", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"E3domainMin", "[", 
      RowBox[{"E1_", ",", "m_", ",", "m1_", ",", "m2_", ",", "m3_"}], "]"}], "=", 
     RowBox[{
      RowBox[{"E3domain", "[", 
       RowBox[{"E1", ",", "m", ",", "m1", ",", "m2", ",", "m3"}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"E3domainMax", "[", 
      RowBox[{"E1_", ",", "m_", ",", "m1_", ",", "m2_", ",", "m3_"}], "]"}], "=", 
     RowBox[{
      RowBox[{"E3domain", "[", 
       RowBox[{"E1", ",", "m", ",", "m1", ",", "m2", ",", "m3"}], "]"}], "[", 
      RowBox[{"[", "2", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[CapitalDelta]E3", "[", 
     RowBox[{"E1_", ",", "m_", ",", "m1_", ",", "m2_", ",", "m3_"}], "]"}], "=", 
    RowBox[{
     RowBox[{
      RowBox[{"E3domainMax", "[", 
       RowBox[{"E1", ",", "m", ",", "m1", ",", "m2", ",", "m3"}], "]"}], "-", 
      RowBox[{"E3domainMin", "[", 
       RowBox[{"E1", ",", "m", ",", "m1", ",", "m2", ",", "m3"}], "]"}]}], "//",
      "Simplify"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"E1domainMin", "[", 
       RowBox[{"m_", ",", "m1_", ",", "m2_", ",", "m3_"}], "]"}], ",", 
      RowBox[{"E1domainMax", "[", 
       RowBox[{"m_", ",", "m1_", ",", "m2_", ",", "m3_"}], "]"}]}], "}"}], "=", 
    RowBox[{
     RowBox[{"E1domain", "[", 
      RowBox[{"m_", ",", "m1_", ",", "m2_", ",", "m3_"}], "]"}], "=", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"E1", "/.", 
         RowBox[{
          RowBox[{"Solve", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"\[CapitalDelta]E3", "[", 
               RowBox[{"E1", ",", "m", ",", "m1", ",", "m2", ",", "m3"}], 
               "]"}], "[", 
              RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", "0"}], ",", "E1"}], 
           "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ",", 
        RowBox[{"E1", "/.", 
         RowBox[{
          RowBox[{"Solve", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"\[CapitalDelta]E3", "[", 
               RowBox[{"E1", ",", "m", ",", "m1", ",", "m2", ",", "m3"}], 
               "]"}], "[", 
              RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", "0"}], ",", "E1"}], 
           "]"}], "[", 
          RowBox[{"[", "3", "]"}], "]"}]}]}], "}"}], "//", "Simplify"}]}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{
       RowBox[{"Domain", " ", "of", " ", "definition", " ", "of", " ", 
        SubscriptBox["E", "1"], " ", "and", " ", 
        SubscriptBox["E", "3"], " ", "in", " ", "decay", " ", "0"}], "\[Rule]", 
       RowBox[{"1", "+", "2", "+", 
        RowBox[{
        "3", " ", "at", " ", "rest", " ", "frame", " ", "of", " ", "0"}]}]}], 
      ",", " ", 
      RowBox[{
       RowBox[{"now", " ", 
        SubscriptBox["E", 
         RowBox[{"1", ",", 
          RowBox[{"min", "/", "max"}]}]]}], " ", "=", " ", 
       RowBox[{"f", 
        RowBox[{"(", 
         SubscriptBox["E", "3"], ")"}]}]}]}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"E1domain1", "[", 
       RowBox[{"E1_", ",", "m_", ",", "m1_", ",", "m2_", ",", "m3_"}], "]"}], 
      "=", 
      RowBox[{"E1", "/.", 
       RowBox[{"(*", 
        RowBox[{"Assuming", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"m", ">", "0"}], "&&", 
           RowBox[{"E1", ">", "m1", ">", "0"}]}], ","}]}], "*)"}], 
       RowBox[{"Simplify", "[", 
        RowBox[{"Solve", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"cos\[Theta]12", "[", 
            RowBox[{
            "E1", ",", "E3", ",", "m", ",", "m1", ",", "m2", ",", "m3"}], 
            "]"}], "\[Equal]", "1"}], ",", "E1"}], "]"}], "]"}]}]}], 
     RowBox[{"(*", "]", "*)"}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"E1domain1Min", "[", 
       RowBox[{"E1_", ",", "m_", ",", "m1_", ",", "m2_", ",", "m3_"}], "]"}], 
      "=", 
      RowBox[{
       RowBox[{"E1domain1", "[", 
        RowBox[{"E3", ",", "m", ",", "m1", ",", "m2", ",", "m3"}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"E1domain1Max", "[", 
       RowBox[{"E1_", ",", "m_", ",", "m1_", ",", "m2_", ",", "m3_"}], "]"}], 
      "=", 
      RowBox[{
       RowBox[{"E1domain1", "[", 
        RowBox[{"E3", ",", "m", ",", "m1", ",", "m2", ",", "m3"}], "]"}], "[", 
       RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[CapitalDelta]E1", "[", 
       RowBox[{"E3_", ",", "m_", ",", "m1_", ",", "m2_", ",", "m3_"}], "]"}], 
      "=", 
      RowBox[{
       RowBox[{
        RowBox[{"E1domain1Max", "[", 
         RowBox[{"E3", ",", "m", ",", "m1", ",", "m2", ",", "m3"}], "]"}], "-", 
        RowBox[{"E1domain1Min", "[", 
         RowBox[{"E3", ",", "m", ",", "m1", ",", "m2", ",", "m3"}], "]"}]}], "//",
        "Simplify"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"E3domain1Min", "[", 
         RowBox[{"m_", ",", "m1_", ",", "m2_", ",", "m3_"}], "]"}], ",", 
        RowBox[{"E3domain1Max", "[", 
         RowBox[{"m_", ",", "m1_", ",", "m2_", ",", "m3_"}], "]"}]}], "}"}], "=", 
      RowBox[{
       RowBox[{"E3domain1", "[", 
        RowBox[{"m_", ",", "m1_", ",", "m2_", ",", "m3_"}], "]"}], "=", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"E3", "/.", 
           RowBox[{
            RowBox[{"Solve", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"\[CapitalDelta]E1", "[", 
                 RowBox[{"E3", ",", "m", ",", "m1", ",", "m2", ",", "m3"}], 
                 "]"}], "[", 
                RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", "0"}], ",", 
              "E3"}], "]"}], "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], ",", 
          RowBox[{"E3", "/.", 
           RowBox[{
            RowBox[{"Solve", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"\[CapitalDelta]E1", "[", 
                 RowBox[{"E3", ",", "m", ",", "m1", ",", "m2", ",", "m3"}], 
                 "]"}], "[", 
                RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", "0"}], ",", 
              "E3"}], "]"}], "[", 
            RowBox[{"[", "3", "]"}], "]"}]}]}], "}"}], "//", "Simplify"}]}]}],
      ";"}], "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Mandelstam", " ", "invariants", " ", "in", " ", "terms", " ", "of", " ", 
     "energies"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"M13", "[", 
     RowBox[{"E1_", ",", "E3_"}], "]"}], "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"E1", "+", "E3"}], ")"}], "2"], "-", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"pPar", "[", 
           RowBox[{"E1", ",", "m1"}], "]"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{"pPar", "[", 
           RowBox[{"E3", ",", "m3"}], "]"}], "2"], "+", 
         RowBox[{"2", "*", 
          RowBox[{"pPar", "[", 
           RowBox[{"E1", ",", "m1"}], "]"}], "*", 
          RowBox[{"pPar", "[", 
           RowBox[{"E3", ",", "m3"}], "]"}], "*", 
          RowBox[{"cos\[Theta]13", "[", 
           RowBox[{
           "E1", ",", "E3", ",", "m", ",", "m1", ",", "m2", ",", "m3"}], 
           "]"}]}]}], ")"}]}], "//", "Expand"}], "//", "Simplify"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"M12", "[", 
     RowBox[{"E1_", ",", "E3_"}], "]"}], "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"E1", "+", 
          RowBox[{"E2valEnergies", "[", 
           RowBox[{"m", ",", "E1", ",", "E3"}], "]"}]}], ")"}], "2"], "-", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"pPar", "[", 
           RowBox[{"E1", ",", "m1"}], "]"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{"pPar", "[", 
           RowBox[{
            RowBox[{"E2valEnergies", "[", 
             RowBox[{"m", ",", "E1", ",", "E3"}], "]"}], ",", "m2"}], "]"}], 
          "2"], "+", 
         RowBox[{"2", "*", 
          RowBox[{"pPar", "[", 
           RowBox[{"E1", ",", "m1"}], "]"}], "*", 
          RowBox[{"pPar", "[", 
           RowBox[{
            RowBox[{"E2valEnergies", "[", 
             RowBox[{"m", ",", "E1", ",", "E3"}], "]"}], ",", "m2"}], "]"}], "*", 
          RowBox[{"cos\[Theta]12", "[", 
           RowBox[{
           "E1", ",", "E3", ",", "m", ",", "m1", ",", "m2", ",", "m3"}], 
           "]"}]}]}], ")"}]}], "//", "Expand"}], "//", "Simplify"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Q2", "[", 
      RowBox[{"E1_", ",", "E3_", ",", "m_", ",", "m2_"}], "]"}], "=", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["m", "2"], "+", 
       SuperscriptBox["m2", "2"], "-", 
       RowBox[{"2", "*", "m", "*", 
        RowBox[{"E2valEnergies", "[", 
         RowBox[{"m", ",", "E1", ",", "E3"}], "]"}]}]}], ")"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{
      "Domain", " ", "of", " ", "the", " ", "parameter", " ", "space", " ", 
       "E1"}], ",", 
      RowBox[{"E3", " ", "for", " ", 
       SubscriptBox["E", "1"], " ", "ranging", " ", "between", " ", 
       SubscriptBox["E", "min"]}], ",", 
      SubscriptBox["E", "max"]}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"E12E23domain", "[", 
      RowBox[{
      "m_", ",", "m1_", ",", "m2_", ",", "m3_", ",", "Emin_", ",", "Emax_"}], 
      "]"}], ":=", 
     RowBox[{"NIntegrate", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"UnitStep", "[", 
         RowBox[{"E3v", "-", "Emin"}], "]"}], "*", 
        RowBox[{"UnitStep", "[", 
         RowBox[{"Emax", "-", "E3v"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"E1v", ",", 
         RowBox[{
          RowBox[{"E1domain", "[", 
           RowBox[{"m", ",", "m1", ",", "m2", ",", "m3"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", 
         RowBox[{
          RowBox[{"E1domain", "[", 
           RowBox[{"m", ",", "m1", ",", "m2", ",", "m3"}], "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"E3v", ",", 
         RowBox[{"Max", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"E3domain", "[", 
             RowBox[{"E1v", ",", "m", ",", "m1", ",", "m2", ",", "m3"}], 
             "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", "Emin"}], "]"}], ",", 
         RowBox[{"Min", "[", 
          RowBox[{"Emax", ",", 
           RowBox[{
            RowBox[{"E3domain", "[", 
             RowBox[{"E1v", ",", "m", ",", "m1", ",", "m2", ",", "m3"}], 
             "]"}], "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "}"}], ",", 
       RowBox[{"Method", "\[Rule]", "\"\<AdaptiveMonteCarlo\>\""}]}], "]"}]}],
     "\[IndentingNewLine]", "*)"}]}]}]], "Input",
 CellChangeTimes->{{3.931322203421511*^9, 3.9313222035758967`*^9}, {
  3.931323329675337*^9, 3.9313233300545254`*^9}, {3.931324769389121*^9, 
  3.931324769513513*^9}, {3.931324830286233*^9, 3.93132483910528*^9}, {
  3.9313248704476504`*^9, 3.931324928060895*^9}, {3.9313267749531546`*^9, 
  3.931326775145919*^9}},
 CellLabel->
  "In[125]:=",ExpressionUUID->"57484377-8f92-482b-bc6e-2266e3906069"],

Cell[BoxData[
 FormBox[
  TemplateBox[{
   "Solve", "nongen", 
    "\"There may be values of the parameters for which some or all solutions \
are not valid.\"", 2, 131, 2, 23777492601901756285, "Local"},
   "MessageTemplate",
   BaseStyle->"MSG"], TraditionalForm]], "Message",
 CellChangeTimes->{
  3.9312276424799495`*^9, 3.9313153701645327`*^9, 3.9313163850211906`*^9, 
   3.931317235805554*^9, 3.93131739051888*^9, {3.93132487711631*^9, 
   3.9313248894654765`*^9}, 3.9313249321007147`*^9, 3.935513722119372*^9, 
   3.942205890752695*^9, 3.95275329947402*^9, 3.9527569587688885`*^9, 
   3.9527624228194103`*^9},
 CellLabel->
  "During evaluation of \
In[125]:=",ExpressionUUID->"0840cd85-aaeb-694b-8f1a-c7dcb0eb49ad"],

Cell[BoxData[
 FormBox[
  TemplateBox[<|"shortenedBoxes" -> TagBox[
      RowBox[{"{", 
        RowBox[{
          FractionBox[
           RowBox[{
             SqrtBox[
              RowBox[{
                RowBox[{"(", 
                  RowBox[{
                    SuperscriptBox["E1", "2"], "-", 
                    SuperscriptBox["m1", "2"]}], ")"}], " ", 
                RowBox[{"(", 
                  RowBox[{
                    RowBox[{"4", " ", 
                    SuperscriptBox["E1", "2"], " ", 
                    SuperscriptBox["m", "2"]}], "-", 
                    RowBox[{"4", " ", "E1", " ", "m", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    SuperscriptBox["m", "2"], "+", 
                    SuperscriptBox["m1", "2"], "-", 
                    SuperscriptBox["m2", "2"], "-", 
                    SuperscriptBox["m3", "2"]}], ")"}]}], "+", 
                    SuperscriptBox["m", "4"], "+", 
                    RowBox[{"2", " ", 
                    SuperscriptBox["m", "2"], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    SuperscriptBox["m1", "2"], "-", 
                    SuperscriptBox["m2", "2"], "-", 
                    SuperscriptBox["m3", "2"]}], ")"}]}], "+", 
                    SuperscriptBox["m1", "4"], "-", 
                    RowBox[{"2", " ", 
                    SuperscriptBox["m1", "2"], " ", 
                    SuperscriptBox["m2", "2"]}], "-", 
                    RowBox[{"2", " ", 
                    SuperscriptBox["m1", "2"], " ", 
                    SuperscriptBox["m3", "2"]}], "+", 
                    SuperscriptBox["m2", "4"], "-", 
                    RowBox[{"2", " ", 
                    SuperscriptBox["m2", "2"], " ", 
                    SuperscriptBox["m3", "2"]}], "+", 
                    SuperscriptBox["m3", "4"]}], ")"}]}]], "-", 
             RowBox[{"2", " ", 
               SuperscriptBox["E1", "2"], " ", "m"}], "+", 
             RowBox[{"3", " ", "E1", " ", 
               SuperscriptBox["m", "2"]}], "+", 
             RowBox[{"E1", " ", 
               SuperscriptBox["m1", "2"]}], "-", 
             RowBox[{"E1", " ", 
               SuperscriptBox["m2", "2"]}], "+", 
             RowBox[{"E1", " ", 
               SuperscriptBox["m3", "2"]}], "-", 
             RowBox[{
               SuperscriptBox["m", "3"]}], "-", 
             RowBox[{"m", " ", 
               SuperscriptBox["m1", "2"]}], "+", 
             RowBox[{"m", " ", 
               SuperscriptBox["m2", "2"]}], "-", 
             RowBox[{"m", " ", 
               SuperscriptBox["m3", "2"]}]}], 
           RowBox[{
             RowBox[{"4", " ", "E1", " ", "m"}], "-", 
             RowBox[{"2", " ", 
               RowBox[{"(", 
                 RowBox[{
                   SuperscriptBox["m", "2"], "+", 
                   SuperscriptBox["m1", "2"]}], ")"}]}]}]], ",", 
          RowBox[{"-", 
            FractionBox[
             RowBox[{
               SqrtBox[
                RowBox[{
                  RowBox[{"(", 
                    RowBox[{
                    SuperscriptBox["E1", "2"], "-", 
                    SuperscriptBox["m1", "2"]}], ")"}], " ", 
                  RowBox[{"(", 
                    RowBox[{
                    RowBox[{"4", " ", 
                    SuperscriptBox["E1", "2"], " ", 
                    SuperscriptBox["m", "2"]}], "-", 
                    RowBox[{"4", " ", "E1", " ", "m", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    SuperscriptBox["m", "2"], "+", 
                    SuperscriptBox["m1", "2"], "-", 
                    SuperscriptBox["m2", "2"], "-", 
                    SuperscriptBox["m3", "2"]}], ")"}]}], "+", 
                    SuperscriptBox["m", "4"], "+", 
                    RowBox[{"2", " ", 
                    SuperscriptBox["m", "2"], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    SuperscriptBox["m1", "2"], "-", 
                    SuperscriptBox["m2", "2"], "-", 
                    SuperscriptBox["m3", "2"]}], ")"}]}], "+", 
                    SuperscriptBox["m1", "4"], "-", 
                    RowBox[{"2", " ", 
                    SuperscriptBox["m1", "2"], " ", 
                    SuperscriptBox["m2", "2"]}], "-", 
                    RowBox[{"2", " ", 
                    SuperscriptBox["m1", "2"], " ", 
                    SuperscriptBox["m3", "2"]}], "+", 
                    SuperscriptBox["m2", "4"], "-", 
                    RowBox[{"2", " ", 
                    SuperscriptBox["m2", "2"], " ", 
                    SuperscriptBox["m3", "2"]}], "+", 
                    SuperscriptBox["m3", "4"]}], ")"}]}]], "+", 
               RowBox[{"2", " ", 
                 SuperscriptBox["E1", "2"], " ", "m"}], "-", 
               RowBox[{"3", " ", "E1", " ", 
                 SuperscriptBox["m", "2"]}], "-", 
               RowBox[{"E1", " ", 
                 SuperscriptBox["m1", "2"]}], "+", 
               RowBox[{"E1", " ", 
                 SuperscriptBox["m2", "2"]}], "-", 
               RowBox[{"E1", " ", 
                 SuperscriptBox["m3", "2"]}], "+", 
               SuperscriptBox["m", "3"], "+", 
               RowBox[{"m", " ", 
                 SuperscriptBox["m1", "2"]}], "-", 
               RowBox[{"m", " ", 
                 SuperscriptBox["m2", "2"]}], "+", 
               RowBox[{"m", " ", 
                 SuperscriptBox["m3", "2"]}]}], 
             RowBox[{
               RowBox[{"4", " ", "E1", " ", "m"}], "-", 
               RowBox[{"2", " ", 
                 RowBox[{"(", 
                   RowBox[{
                    SuperscriptBox["m", "2"], "+", 
                    SuperscriptBox["m1", "2"]}], ")"}]}]}]]}]}], "}"}], 
      Short[#, 8]& ], "line" -> 131, "sessionID" -> 23777492601901756285, 
    "byteCount" -> 9720, "size" -> 8, "stored" -> False, "expr" -> 
    Missing["NotStored"], "wrap" -> OutputSizeLimit`Defer, "version" -> 1|>,
   "OutputSizeLimitTemplate"], TraditionalForm]], "Output",
 CellChangeTimes->{
  3.931227642634259*^9, 3.9313153703198814`*^9, 3.931316385174094*^9, 
   3.931317235974084*^9, 3.9313173906726694`*^9, {3.9313248771524196`*^9, 
   3.931324889495285*^9}, 3.9313249321528788`*^9, 3.9355137222138886`*^9, 
   3.942205891049631*^9, 3.9527532997609673`*^9, 3.952756959058256*^9, 
   3.952762423100067*^9},
 CellLabel->
  "Out[131]=",ExpressionUUID->"0754df14-ee79-1d4c-9060-3d2ac7ca08ca"],

Cell[BoxData[
 FormBox[
  FractionBox[
   SqrtBox[
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["E1", "2"], "-", 
       SuperscriptBox["m1", "2"]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"4", " ", 
        SuperscriptBox["E1", "2"], " ", 
        SuperscriptBox["m", "2"]}], "-", 
       RowBox[{"4", " ", "E1", " ", "m", " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["m", "2"], "+", 
          SuperscriptBox["m1", "2"], "-", 
          SuperscriptBox["m2", "2"], "-", 
          SuperscriptBox["m3", "2"]}], ")"}]}], "+", 
       SuperscriptBox["m", "4"], "+", 
       RowBox[{"2", " ", 
        SuperscriptBox["m", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["m1", "2"], "-", 
          SuperscriptBox["m2", "2"], "-", 
          SuperscriptBox["m3", "2"]}], ")"}]}], "+", 
       SuperscriptBox["m1", "4"], "-", 
       RowBox[{"2", " ", 
        SuperscriptBox["m1", "2"], " ", 
        SuperscriptBox["m2", "2"]}], "-", 
       RowBox[{"2", " ", 
        SuperscriptBox["m1", "2"], " ", 
        SuperscriptBox["m3", "2"]}], "+", 
       SuperscriptBox["m2", "4"], "-", 
       RowBox[{"2", " ", 
        SuperscriptBox["m2", "2"], " ", 
        SuperscriptBox["m3", "2"]}], "+", 
       SuperscriptBox["m3", "4"]}], ")"}]}]], 
   RowBox[{
    RowBox[{"-", 
     RowBox[{"2", " ", "E1", " ", "m"}]}], "+", 
    SuperscriptBox["m", "2"], "+", 
    SuperscriptBox["m1", "2"]}]], TraditionalForm]], "Output",
 CellChangeTimes->{
  3.931227642634259*^9, 3.9313153703198814`*^9, 3.931316385174094*^9, 
   3.931317235974084*^9, 3.9313173906726694`*^9, {3.9313248771524196`*^9, 
   3.931324889495285*^9}, 3.9313249321528788`*^9, 3.9355137222138886`*^9, 
   3.942205891049631*^9, 3.9527532997609673`*^9, 3.952756959058256*^9, 
   3.952762423212038*^9},
 CellLabel->
  "Out[134]=",ExpressionUUID->"55c5e906-f9bb-274d-b033-8313ceb2075c"],

Cell[BoxData[
 FormBox[
  RowBox[{"{", 
   RowBox[{"m1", ",", 
    FractionBox[
     RowBox[{
      SuperscriptBox["m", "2"], "+", 
      SuperscriptBox["m1", "2"], "-", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"m2", "+", "m3"}], ")"}], "2"]}], 
     RowBox[{"2", " ", "m"}]]}], "}"}], TraditionalForm]], "Output",
 CellChangeTimes->{
  3.931227642634259*^9, 3.9313153703198814`*^9, 3.931316385174094*^9, 
   3.931317235974084*^9, 3.9313173906726694`*^9, {3.9313248771524196`*^9, 
   3.931324889495285*^9}, 3.9313249321528788`*^9, 3.9355137222138886`*^9, 
   3.942205891049631*^9, 3.9527532997609673`*^9, 3.952756959058256*^9, 
   3.952762423212038*^9},
 CellLabel->
  "Out[135]=",ExpressionUUID->"ffb2f44f-6544-9840-b35c-ac8e59624359"],

Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{"2", " ", "E1", " ", "m"}], "+", 
   RowBox[{"2", " ", "E3", " ", "m"}], "-", 
   SuperscriptBox["m", "2"], "+", 
   SuperscriptBox["m2", "2"]}], TraditionalForm]], "Output",
 CellChangeTimes->{
  3.931227642634259*^9, 3.9313153703198814`*^9, 3.931316385174094*^9, 
   3.931317235974084*^9, 3.9313173906726694`*^9, {3.9313248771524196`*^9, 
   3.931324889495285*^9}, 3.9313249321528788`*^9, 3.9355137222138886`*^9, 
   3.942205891049631*^9, 3.9527532997609673`*^9, 3.952756959058256*^9, 
   3.952762423212038*^9},
 CellLabel->
  "Out[136]=",ExpressionUUID->"0804dfc8-a46d-b845-9e8d-d44bea21ec53"],

Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{"-", 
    RowBox[{"2", " ", "E3", " ", "m"}]}], "+", 
   SuperscriptBox["m", "2"], "+", 
   SuperscriptBox["m3", "2"]}], TraditionalForm]], "Output",
 CellChangeTimes->{
  3.931227642634259*^9, 3.9313153703198814`*^9, 3.931316385174094*^9, 
   3.931317235974084*^9, 3.9313173906726694`*^9, {3.9313248771524196`*^9, 
   3.931324889495285*^9}, 3.9313249321528788`*^9, 3.9355137222138886`*^9, 
   3.942205891049631*^9, 3.9527532997609673`*^9, 3.952756959058256*^9, 
   3.952762423212038*^9},
 CellLabel->
  "Out[137]=",ExpressionUUID->"52f6d560-3a57-e547-b38d-951be1cc0439"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Scalar products", "Subsubsection",
 CellChangeTimes->{{3.931325357408755*^9, 
  3.9313253615321007`*^9}},ExpressionUUID->"97148706-5201-44b9-8426-\
b5bed4c4a2ec"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ProductKK", "=", 
   SuperscriptBox["m", "2"]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ProductK2K2", "=", 
   SuperscriptBox["m2", "2"]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ProductK3K3", "=", 
   SuperscriptBox["m3", "2"]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ProductK1K1", "=", 
   SuperscriptBox["m1", "2"]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ProductKK2energy", "=", 
   RowBox[{"m", "*", 
    RowBox[{"E2valEnergies", "[", 
     RowBox[{"m", ",", "E1", ",", "E3"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ProductKK1energy", "=", 
   RowBox[{"m", "*", "E1"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ProductKK3energy", "=", 
   RowBox[{"m", "*", "E3"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ProductK1K3energy", "=", 
   FractionBox[
    RowBox[{
     RowBox[{"M13", "[", 
      RowBox[{"E1", ",", "E3"}], "]"}], "-", 
     SuperscriptBox["m1", "2"], "-", 
     SuperscriptBox["m3", "2"]}], "2"]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ProductK1K2energy", "=", 
   FractionBox[
    RowBox[{
     RowBox[{"M12", "[", 
      RowBox[{"E1", ",", "E3"}], "]"}], "-", 
     SuperscriptBox["m1", "2"], "-", 
     SuperscriptBox["m2", "2"]}], "2"]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ProductK2K3energy", "=", 
   FractionBox[
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["m", "2"], "+", 
      SuperscriptBox["m1", "2"], "-", 
      RowBox[{"2", "*", "m", "*", "E1"}], "-", 
      SuperscriptBox["m2", "2"], "-", 
      SuperscriptBox["m3", "2"]}], ")"}], "2"]}], ";"}]}], "Input",
 CellLabel->
  "In[139]:=",ExpressionUUID->"9edd3da2-396d-4293-ad69-adf679365dba"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Momenta", "Subsubsection",
 CellChangeTimes->{{3.9311577437360563`*^9, 
  3.931157744596552*^9}},ExpressionUUID->"6d4dc4e2-2ca8-42d2-8784-\
09d94a9b1c08"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Rotation", " ", "matrices", " ", "with", " ", "around", " ", "z", " ", 
    "axis", " ", 
    RowBox[{"(", 
     RowBox[{"\[Phi]", " ", "angle"}], ")"}], " ", "and", " ", "x", " ", 
    "axis", " ", 
    RowBox[{"(", 
     RowBox[{"\[Theta]", " ", "angle"}], ")"}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"\[Phi]RotMatrix", "[", "\[Phi]_", "]"}], "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Sin", "[", "\[Phi]", "]"}], ",", 
         RowBox[{"Cos", "[", "\[Phi]", "]"}], ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", 
          RowBox[{"Cos", "[", "\[Phi]", "]"}]}], ",", 
         RowBox[{"Sin", "[", "\[Phi]", "]"}], ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Theta]RotMatrix", "[", "\[Theta]_", "]"}], "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{"Cos", "[", "\[Theta]", "]"}], ",", 
         RowBox[{"Sin", "[", "\[Theta]", "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{"-", 
          RowBox[{"Sin", "[", "\[Theta]", "]"}]}], ",", 
         RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "}"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"The", " ", "3"}], "-", 
     RowBox[{
     "vector", " ", "at", " ", "some", " ", "reference", " ", "frame", " ", 
      "rotated", " ", "using", " ", "the", " ", "rotation", " ", 
      "matrices"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"pvecUnrotated", "[", 
      RowBox[{"px_", ",", "py_", ",", "pz_"}], "]"}], "=", 
     RowBox[{"{", 
      RowBox[{"px", ",", "py", ",", "pz"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"pvecRotated", "[", 
      RowBox[{
      "px_", ",", "py_", ",", "pz_", ",", "\[Theta]V_", ",", "\[Phi]V_"}], 
      "]"}], "=", 
     RowBox[{
      RowBox[{"\[Phi]RotMatrix", "[", "\[Phi]V", "]"}], ".", 
      RowBox[{"\[Theta]RotMatrix", "[", "\[Theta]V", "]"}], ".", 
      RowBox[{"pvecUnrotated", "[", 
       RowBox[{"px", ",", "py", ",", "pz"}], "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Momenta", " ", "at", " ", "frame", " ", "where", " ", 
     SubscriptBox["p", "1"], " ", "is", " ", "aligned", " ", "along", " ", 
     "z", " ", "axis"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"p1unrotated", "=", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", 
       RowBox[{"pPar", "[", 
        RowBox[{"E1", ",", "m1"}], "]"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"p2unrotated", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"pPar", "[", 
         RowBox[{
          RowBox[{"E2valEnergies", "[", 
           RowBox[{"m", ",", "E1", ",", "E3"}], "]"}], ",", "m2"}], "]"}], "*", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Theta]12", "[", 
          RowBox[{
          "E1", ",", "E3", ",", "m", ",", "m1", ",", "m2", ",", "m3"}], "]"}],
          "]"}], "*", 
        RowBox[{"Sin", "[", "\[Kappa]", "]"}]}], ",", 
       RowBox[{
        RowBox[{"pPar", "[", 
         RowBox[{
          RowBox[{"E2valEnergies", "[", 
           RowBox[{"m", ",", "E1", ",", "E3"}], "]"}], ",", "m2"}], "]"}], "*", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Theta]12", "[", 
          RowBox[{
          "E1", ",", "E3", ",", "m", ",", "m1", ",", "m2", ",", "m3"}], "]"}],
          "]"}], "*", 
        RowBox[{"Cos", "[", "\[Kappa]", "]"}]}], ",", 
       RowBox[{
        RowBox[{"pPar", "[", 
         RowBox[{
          RowBox[{"E2valEnergies", "[", 
           RowBox[{"m", ",", "E1", ",", "E3"}], "]"}], ",", "m2"}], "]"}], "*", 
        RowBox[{"Cos", "[", 
         RowBox[{"\[Theta]12", "[", 
          RowBox[{
          "E1", ",", "E3", ",", "m", ",", "m1", ",", "m2", ",", "m3"}], "]"}],
          "]"}]}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"p3unrotated", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         RowBox[{"pPar", "[", 
          RowBox[{"E3", ",", "m3"}], "]"}]}], "*", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Theta]13", "[", 
          RowBox[{
          "E1", ",", "E3", ",", "m", ",", "m1", ",", "m2", ",", "m3"}], "]"}],
          "]"}], "*", 
        RowBox[{"Sin", "[", "\[Kappa]", "]"}]}], ",", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"pPar", "[", 
          RowBox[{"E3", ",", "m3"}], "]"}]}], "*", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Theta]13", "[", 
          RowBox[{
          "E1", ",", "E3", ",", "m", ",", "m1", ",", "m2", ",", "m3"}], "]"}],
          "]"}], "*", 
        RowBox[{"Cos", "[", "\[Kappa]", "]"}]}], ",", 
       RowBox[{
        RowBox[{"pPar", "[", 
         RowBox[{"E3", ",", "m3"}], "]"}], "*", 
        RowBox[{"Cos", "[", 
         RowBox[{"\[Theta]13", "[", 
          RowBox[{
          "E1", ",", "E3", ",", "m", ",", "m1", ",", "m2", ",", "m3"}], "]"}],
          "]"}]}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"\[Theta]rand", "=", 
      RowBox[{"RandomReal", "[", 
       RowBox[{"{", 
        RowBox[{"0", ",", "Pi"}], "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Phi]rand", "=", 
      RowBox[{"RandomReal", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "Pi"}], ",", "Pi"}], "}"}], "]"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"p1rotated", "[", 
      RowBox[{"E1_", ",", "m1_", ",", "\[Theta]V_", ",", "\[Phi]V_"}], "]"}], 
     "=", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"\[Phi]RotMatrix", "[", "\[Phi]V", "]"}], ".", 
       RowBox[{"\[Theta]RotMatrix", "[", "\[Theta]V", "]"}], ".", 
       "p1Unrotated"}], "*)"}], 
     RowBox[{"pvecRotated", "[", 
      RowBox[{
       RowBox[{"p1unrotated", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", 
       RowBox[{"p1unrotated", "[", 
        RowBox[{"[", "2", "]"}], "]"}], ",", 
       RowBox[{"p1unrotated", "[", 
        RowBox[{"[", "3", "]"}], "]"}], ",", "\[Theta]V", ",", "\[Phi]V"}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"p1rotatedX", "[", 
      RowBox[{"E1_", ",", "m1_", ",", "\[Theta]V_", ",", "\[Phi]V_"}], "]"}], 
     "=", 
     RowBox[{
      RowBox[{"p1rotated", "[", 
       RowBox[{"E1", ",", "m1", ",", "\[Theta]V", ",", "\[Phi]V"}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"p1rotatedY", "[", 
      RowBox[{"E1_", ",", "m1_", ",", "\[Theta]V_", ",", "\[Phi]V_"}], "]"}], 
     "=", 
     RowBox[{
      RowBox[{"p1rotated", "[", 
       RowBox[{"E1", ",", "m1", ",", "\[Theta]V", ",", "\[Phi]V"}], "]"}], "[", 
      RowBox[{"[", "2", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"p1rotatedZ", "[", 
      RowBox[{"E1_", ",", "m1_", ",", "\[Theta]V_", ",", "\[Phi]V_"}], "]"}], 
     "=", 
     RowBox[{
      RowBox[{"p1rotated", "[", 
       RowBox[{"E1", ",", "m1", ",", "\[Theta]V", ",", "\[Phi]V"}], "]"}], "[", 
      RowBox[{"[", "3", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"p2rotated", "[", 
      RowBox[{
      "E1_", ",", "E3_", ",", "m_", ",", "m1_", ",", "m2_", ",", "m3_", ",", 
       "\[Theta]V_", ",", "\[Phi]V_", ",", "\[Kappa]_"}], "]"}], "=", 
     RowBox[{
      RowBox[{"pvecRotated", "[", 
       RowBox[{
        RowBox[{"p2unrotated", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", 
        RowBox[{"p2unrotated", "[", 
         RowBox[{"[", "2", "]"}], "]"}], ",", 
        RowBox[{"p2unrotated", "[", 
         RowBox[{"[", "3", "]"}], "]"}], ",", "\[Theta]V", ",", "\[Phi]V"}], 
       "]"}], "//", "Simplify"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"p2rotatedX", "[", 
      RowBox[{
      "E1_", ",", "E3_", ",", "m_", ",", "m1_", ",", "m2_", ",", "m3_", ",", 
       "\[Theta]V_", ",", "\[Phi]V_", ",", "\[Kappa]_"}], "]"}], "=", 
     RowBox[{
      RowBox[{"p2rotated", "[", 
       RowBox[{
       "E1", ",", "E3", ",", "m", ",", "m1", ",", "m2", ",", "m3", ",", 
        "\[Theta]V", ",", "\[Phi]V", ",", "\[Kappa]"}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"p2rotatedY", "[", 
      RowBox[{
      "E1_", ",", "E3_", ",", "m_", ",", "m1_", ",", "m2_", ",", "m3_", ",", 
       "\[Theta]V_", ",", "\[Phi]V_", ",", "\[Kappa]_"}], "]"}], "=", 
     RowBox[{
      RowBox[{"p2rotated", "[", 
       RowBox[{
       "E1", ",", "E3", ",", "m", ",", "m1", ",", "m2", ",", "m3", ",", 
        "\[Theta]V", ",", "\[Phi]V", ",", "\[Kappa]"}], "]"}], "[", 
      RowBox[{"[", "2", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"p2rotatedZ", "[", 
      RowBox[{
      "E1_", ",", "E3_", ",", "m_", ",", "m1_", ",", "m2_", ",", "m3_", ",", 
       "\[Theta]V_", ",", "\[Phi]V_", ",", "\[Kappa]_"}], "]"}], "=", 
     RowBox[{
      RowBox[{"p2rotated", "[", 
       RowBox[{
       "E1", ",", "E3", ",", "m", ",", "m1", ",", "m2", ",", "m3", ",", 
        "\[Theta]V", ",", "\[Phi]V", ",", "\[Kappa]"}], "]"}], "[", 
      RowBox[{"[", "3", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"p3rotated", "[", 
      RowBox[{
      "E1_", ",", "E3_", ",", "m_", ",", "m1_", ",", "m2_", ",", "m3_", ",", 
       "\[Theta]V_", ",", "\[Phi]V_", ",", "\[Kappa]_"}], "]"}], "=", 
     RowBox[{
      RowBox[{"pvecRotated", "[", 
       RowBox[{
        RowBox[{"p3unrotated", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", 
        RowBox[{"p3unrotated", "[", 
         RowBox[{"[", "2", "]"}], "]"}], ",", 
        RowBox[{"p3unrotated", "[", 
         RowBox[{"[", "3", "]"}], "]"}], ",", "\[Theta]V", ",", "\[Phi]V"}], 
       "]"}], "//", "Simplify"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"p3rotatedX", "[", 
      RowBox[{
      "E1_", ",", "E3_", ",", "m_", ",", "m1_", ",", "m2_", ",", "m3_", ",", 
       "\[Theta]V_", ",", "\[Phi]V_", ",", "\[Kappa]_"}], "]"}], "=", 
     RowBox[{
      RowBox[{"p3rotated", "[", 
       RowBox[{
       "E1", ",", "E3", ",", "m", ",", "m1", ",", "m2", ",", "m3", ",", 
        "\[Theta]V", ",", "\[Phi]V", ",", "\[Kappa]"}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"p3rotatedY", "[", 
      RowBox[{
      "E1_", ",", "E3_", ",", "m_", ",", "m1_", ",", "m2_", ",", "m3_", ",", 
       "\[Theta]V_", ",", "\[Phi]V_", ",", "\[Kappa]_"}], "]"}], "=", 
     RowBox[{
      RowBox[{"p3rotated", "[", 
       RowBox[{
       "E1", ",", "E3", ",", "m", ",", "m1", ",", "m2", ",", "m3", ",", 
        "\[Theta]V", ",", "\[Phi]V", ",", "\[Kappa]"}], "]"}], "[", 
      RowBox[{"[", "2", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"p3rotatedZ", "[", 
      RowBox[{
      "E1_", ",", "E3_", ",", "m_", ",", "m1_", ",", "m2_", ",", "m3_", ",", 
       "\[Theta]V_", ",", "\[Phi]V_", ",", "\[Kappa]_"}], "]"}], "=", 
     RowBox[{
      RowBox[{"p3rotated", "[", 
       RowBox[{
       "E1", ",", "E3", ",", "m", ",", "m1", ",", "m2", ",", "m3", ",", 
        "\[Theta]V", ",", "\[Phi]V", ",", "\[Kappa]"}], "]"}], "[", 
      RowBox[{"[", "3", "]"}], "]"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.9313247365771894`*^9, 3.9313247597344875`*^9}, 
   3.9382506025616646`*^9},
 CellLabel->
  "In[149]:=",ExpressionUUID->"ab01fb90-be25-4e60-b853-fbeef012bbfb"]
}, Open  ]]
}, Open  ]]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Decay phenomenology and matrix elements", "Chapter",
 CellChangeTimes->{{3.931067906057948*^9, 3.9310679094847236`*^9}, {
  3.931228908284416*^9, 
  3.9312289136443515`*^9}},ExpressionUUID->"8ca0016f-9e5c-43f1-bd03-\
373b2ad4bd83"],

Cell[CellGroupData[{

Cell["Load decay phenomenology", "Section",
 CellChangeTimes->{{3.9312280392983303`*^9, 3.931228044798004*^9}, {
   3.931228453516575*^9, 3.931228457821278*^9}, 
   3.9312292965315485`*^9},ExpressionUUID->"852f5da9-96e6-4e8e-83b9-\
c5a21e80cdb3"],

Cell[CellGroupData[{

Cell["LLP", "Subsection",
 CellChangeTimes->{{3.93122873880179*^9, 
  3.931228739089241*^9}},ExpressionUUID->"41beceb9-bb11-4b17-85c6-\
598e555af8a9"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"ListBrRatios", "//", "Clear"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{"ListBrRatios", "[", 
         RowBox[{"LLPdirName", ",", "m", ",", "proc"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"proc", ",", "ListProcessesLLP"}], "}"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "m", ",", "mLLPminSelected", ",", "mLLPmaxSelected", ",", "0.02"}], 
       "}"}]}], "]"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"procList", "[", "LLP_", "]"}], ":=", 
    RowBox[{
     RowBox[{"Select", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Keys", "[", 
            RowBox[{"DownValues", "@", "ListBrRatiosTemp"}], "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "1", ",", "#"}], "]"}], "]"}], "&"}], "/@", 
         RowBox[{"{", 
          RowBox[{"1", ",", "3"}], "}"}]}], "//", "Transpose"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "==", "LLP"}], "&"}]}], "]"}], "[", 
     RowBox[{"[", 
      RowBox[{"All", ",", "2"}], "]"}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"procListnoecal", "[", "LLP_", "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"prl", "=", 
        RowBox[{"procList", "[", "LLP", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
         "For", " ", "the", " ", "list", " ", "of", " ", "final", " ", 
          "states", " ", "for", " ", "the", " ", "given", " ", "decays"}], ",",
          " ", 
         RowBox[{"select", " ", "only", " ", "charged"}]}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"chargedprods", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"prl", "[", 
             RowBox[{"[", "i", "]"}], "]"}], ",", 
            RowBox[{"Select", "[", 
             RowBox[{
              RowBox[{"ListDecayProducts", "[", 
               RowBox[{"LLP", ",", 
                RowBox[{"prl", "[", 
                 RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
              RowBox[{
               RowBox[{
                RowBox[{"MemberQ", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   
                   RowBox[{"\"\<\[Gamma]\>\"", 
                    ",", "\"\<\!\(\*SubscriptBox[\(K\), \(L\)]\)\>\"", 
                    ",", "\"\<\!\(\*SuperscriptBox[\(\[Pi]\), \(0\)]\)\>\"", 
                    ",", "\"\<Null\>\"", ",", "\"\<\[Nu]\>\"", 
                    ",", "\"\<\!\(\*OverscriptBox[\(\[Nu]\), \(_\)]\)\>\"", 
                    ",", "\"\<\!\(\*SubscriptBox[\(\[Nu]\), \(e\)]\)\>\"", 
                    ",", "\"\<\!\(\*SubscriptBox[OverscriptBox[\(\[Nu]\), \(_\
\)], \(e\)]\)\>\"", ",", "\"\<\!\(\*SubscriptBox[\(\[Nu]\), \(\[Mu]\)]\)\>\"",
                     ",", "\"\<\!\(\*SubscriptBox[OverscriptBox[\(\[Nu]\), \
\(_\)], \(\[Mu]\)]\)\>\"", 
                    ",", "\"\<\!\(\*SubscriptBox[\(\[Nu]\), \(\[Tau]\)]\)\>\"",
                     ",", "\"\<\!\(\*SubscriptBox[OverscriptBox[\(\[Nu]\), \
\(_\)], \(\[Tau]\)]\)\>\""}], "}"}], ",", "#"}], "]"}], "==", "False"}], 
               "&"}]}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"Length", "[", "prl", "]"}], ",", "1"}], "}"}]}], "]"}]}],
        ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Select", "[", 
         RowBox[{"chargedprods", ",", 
          RowBox[{
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "!=", 
            RowBox[{"{", "}"}]}], "&"}]}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "1"}], "]"}], "]"}]}]}], "\[IndentingNewLine]", 
     "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "___", "___", "___", "___", "___", "___", "___", "___", "___", "___", 
     "___", "___"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Defines", ":"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"The", " ", "proper", " ", "lifetime", " ", 
     RowBox[{"c\[Tau]LLP", "[", 
      RowBox[{"mLLP", ",", "coupling"}], "]"}], " ", "in", " ", "meters"}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"ListBrRatios", "[", 
      RowBox[{"LLP", ",", "mLLP", ",", "proc"}], "]"}], " ", "-", " ", 
     RowBox[{
     "branching", " ", "ratio", " ", "of", " ", "the", " ", "given", " ", 
      "process", " ", "proc", " ", "for", " ", "the", " ", "LLP", " ", "mass",
       " ", "mLLP"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Msquared3BodyLLP", "[", 
        RowBox[{"LLP", ",", "proc", ",", "E1", ",", "E3", ",", "mLLP"}], 
        "]"}], " ", "-", " ", 
       RowBox[{
       "squared", " ", "matrix", " ", "element", " ", "of", " ", "a", " ", 
        "3"}], "-", 
       RowBox[{"body", " ", "decay", " ", "of", " ", "the", " ", "LLP"}]}], "->", 
      RowBox[{"1", "+", "2", "+", 
       RowBox[{"3", " ", "in", " ", "terms", " ", "of", " ", "energies", " ", 
        SubscriptBox["E", 
         RowBox[{"1", ",", "3"}]], " ", "of", " ", "the", " ", "particles", " ",
         "1"}]}]}], ",", "3"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"Print", "=", "Identity"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"MemberQ", "[", 
        RowBox[{
         RowBox[{"{", 
          
          RowBox[{"\"\<B-L\>\"", ",", "\"\<B-3Le-Lmu+Ltau\>\"", 
           ",", "\"\<B-Le-3Lmu+Ltau\>\"", ",", "\"\<B-3Lmu\>\""}], "}"}], ",",
          "LLPdirName"}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"NotebookEvaluate", "[", 
         RowBox[{"FileNameJoin", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"NotebookDirectory", "[", "]"}], "//", 
             "ParentDirectory"}], ",", "\"\<Acceptances\>\"", 
            ",", "\"\<B-L.nb\>\""}], "}"}], "]"}], "]"}], ";"}], 
       "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"NotebookEvaluate", "[", 
         RowBox[{"FileNameJoin", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"NotebookDirectory", "[", "]"}], "//", 
             "ParentDirectory"}], ",", "\"\<Acceptances\>\"", ",", 
            RowBox[{"LLPdirName", "<>", "\"\<.nb\>\""}]}], "}"}], "]"}], 
         "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]}], 
    "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
   RowBox[{"decayDescrSelected", "=", 
    RowBox[{"selectionDialogExplanationOneOption", "[", 
     RowBox[{
      RowBox[{"listDecayDescriptions", "[", "LLPsel", "]"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"DecayDescriptionExplanation", "[", 
         RowBox[{"LLPsel", ",", "#"}], "]"}], "&"}], "/@", 
       RowBox[{"listDecayDescriptions", "[", "LLPsel", "]"}]}], ",", 
      RowBox[{"\"\<Select decay description for \>\"", "<>", "LLPdirName"}], ",",
       "200"}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"LLPdirName", "==", "\"\<HNL\>\""}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"NotebookEvaluate", "[", 
       RowBox[{"FileNameJoin", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"NotebookDirectory", "[", "]"}], ",", "\"\<decay pheno\>\"",
           ",", "\"\<HNL-merging.nb\>\""}], "}"}], "]"}], "]"}], ";"}], 
     "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"c\[Tau]LLP", "[", 
        RowBox[{"mLLP_", ",", "coupling_"}], "]"}], "=", 
       RowBox[{"c\[Tau]LLP", "[", 
        RowBox[{
        "LLPdirName", ",", "decayDescrSelected", ",", "mLLP", ",", 
         "coupling"}], "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ListProcessesLLP", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"Select", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"Keys", "[", 
               RowBox[{"DownValues", "@", "ListBrRatios"}], "]"}], "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", "1", ",", "#"}], "]"}], "]"}], "&"}], "/@", 
            RowBox[{"{", 
             RowBox[{"1", ",", "3", ",", "4"}], "}"}]}], ")"}], "//", 
          "Transpose"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "==", "LLPdirName"}], "&&", 
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "3", "]"}], "]"}], "==", "decayDescrSelected"}]}], 
          "&"}]}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "2"}], "]"}], "]"}], "//", "DeleteDuplicates"}]}],
     ";"}]}]}]], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQAWIQzVT694uF11vHlIoN30D0vddy/0B0RO97NksgXcPL
KA6ihTtDwHRH/yc5EM3zWEQBRLtwZKmB6AC/RVog+uV7N30Qfadd2wRE71g9
0QpEr7ZIsAfRGhsXzUgG0pzRObNB9BPOM3NSgLTFF8O5INrc1WtSatBbx1ft
/WB6yeKEGPfit45XIgXjQLTHh3+pINqAp7keRO+ZmzofROfkzVkAoucoNTwG
0V/6p4Dpnv4+OU8gXfNcXAlE/9n05yqIvvDqyjUQLTBnQoM3yLw5b1tB9JOu
Ez0g+oTyezA9ZdGNqSD6ytqbYHrClBvHQfQME+UTIBoA/cudvg==
  "],
 CellLabel->
  "In[174]:=",ExpressionUUID->"487ed701-8838-41fb-b13f-d9f742caa5cf"],

Cell[BoxData[
 FormBox["\<\"Default\"\>", TraditionalForm]], "Output",
 CellChangeTimes->{{3.9527535100580025`*^9, 3.952753590296564*^9}, {
   3.9527536283269978`*^9, 3.9527536578371525`*^9}, 3.9527539299397144`*^9, 
   3.952754014838661*^9, 3.9527544650900555`*^9, 3.9527569657634373`*^9, 
   3.952758460512583*^9, 3.952760389740532*^9, 3.952761907925396*^9, 
   3.9527619631099834`*^9, 3.9527620344996815`*^9, {3.952762439147936*^9, 
   3.9527624429639225`*^9}},
 CellLabel->
  "Out[178]=",ExpressionUUID->"bab665d9-0e21-9248-87c4-8c7c564af134"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Unstable SM particles", "Subsection",
 CellChangeTimes->{{3.93122873880179*^9, 
  3.931228746719358*^9}},ExpressionUUID->"c99807cf-56ef-402d-afa1-\
b8965586a6e2"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "___", "___", "___", "___", "___", "___", "___", "___", "___", "___", 
    "___", "___"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"The", " ", "same", " ", "for", " ", "SM", " ", "particles"}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"NotebookEvaluate", "[", 
     RowBox[{"FileNameJoin", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"NotebookDirectory", "[", "]"}], ",", "\"\<decay pheno\>\"", 
        ",", "\"\<SM.nb\>\""}], "}"}], "]"}], "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"If", "[", 
    RowBox[{"ifExport", ",", "\[IndentingNewLine]", 
     RowBox[{"Export", "[", 
      RowBox[{
       RowBox[{"FileNameJoin", "[", 
        RowBox[{"{", 
         RowBox[{"direxportdata", ",", 
          
          RowBox[{"\"\<ctau-\>\"", "<>", "LLPdirName", "<>", "\"\<-\>\"", "<>",
            "decayDescrSelected", "<>", "\"\<.txt\>\""}]}], "}"}], "]"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"mLLP", ",", 
           RowBox[{"c\[Tau]LLP", "[", 
            RowBox[{"mLLP", ",", "1"}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"mLLP", ",", "0.02", ",", "5.13", ",", "0.002"}], "}"}]}], 
        "]"}], ",", "\"\<Table\>\""}], "]"}]}], "\[IndentingNewLine]", 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.931228758372562*^9, 3.931228779001203*^9}, 
   3.9422061769192142`*^9, {3.942206224225685*^9, 3.9422062674587593`*^9}, {
   3.9527536747375927`*^9, 3.9527536895972023`*^9}, {3.9527554193848324`*^9, 
   3.952755426132622*^9}},
 CellLabel->
  "In[182]:=",ExpressionUUID->"c3178c43-532c-4715-83cf-3baec7645588"],

Cell[BoxData[
 FormBox[
  RowBox[{"If", "[", 
   RowBox[{"ifExport", ",", 
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{"FileNameJoin", "[", 
       RowBox[{"{", 
        RowBox[{"direxportdata", ",", 
         RowBox[{"\<\"ctau-\"\>", "<>", "LLPdirName", "<>", "\<\"-\"\>", "<>",
           "decayDescrSelected", "<>", "\<\".txt\"\>"}]}], "}"}], "]"}], ",", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"mLLP", ",", 
          RowBox[{"c\[Tau]LLP", "(", 
           RowBox[{"mLLP", ",", "1"}], ")"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"mLLP", ",", "0.02`", ",", "5.13`", ",", "0.002`"}], "}"}]}],
        "]"}], ",", "\<\"Table\"\>"}], "]"}]}], "]"}], 
  TraditionalForm]], "Output",
 CellChangeTimes->{
  3.9422062711301003`*^9, 3.9527535948038616`*^9, {3.952753665123911*^9, 
   3.952753690328556*^9}, 3.952754015113199*^9, 3.9527624509543877`*^9},
 CellLabel->
  "Out[183]=",ExpressionUUID->"4b7dc2c9-4c6f-6542-98a8-eaf39da0b57a"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Load codes generating the phase space", "Section",
 CellChangeTimes->{{3.9312295204680567`*^9, 
  3.9312295252070847`*^9}},ExpressionUUID->"003b503e-ddae-40d1-b2dc-\
265390815938"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Loading", " ", "the", " ", "folowing", " ", 
    RowBox[{"functions", ":"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"PhaseSpacePerDecay", "[", 
     RowBox[{
     "LLP", ",", "mLLP", ",", "proclist", ",", "isim", ",", 
      "HadronizationOption", ",", "DecayUnstable"}], "]"}], " ", "-", " ", 
    RowBox[{
    "the", " ", "function", " ", "obtaining", " ", "the", " ", "phase", " ", 
     "space", " ", "of", " ", "decay", " ", "products", " ", "at", " ", "the",
      " ", "rest", " ", "frame", " ", "of", " ", "the", " ", "decaying", " ", 
     "LLP"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Its", " ", 
    RowBox[{"arguments", ":"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Ilist", " ", "of", " ", "all", " ", "decay", " ", "processes", " ", 
    "`proclist`"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "number", " ", "of", " ", "events", " ", "to", " ", "simulate", " ", 
    "`isim`"}], "*)"}], " ", 
  RowBox[{"(*", 
   RowBox[{"`HadronizationOption`", " ", "-", " ", 
    RowBox[{
    "whether", " ", "use", " ", "hadronization", " ", "of", " ", "partons", " ",
      "pre"}], "-", 
    RowBox[{
    "computed", " ", "in", " ", "pythia", " ", "for", " ", "several", " ", 
     "masses", " ", 
     RowBox[{"(", 
      RowBox[{"\"\<True\>\"", ",", " ", "\"\<False\>\""}], ")"}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"`DecayUnstable`", " ", "-", " ", 
    RowBox[{
    "whether", " ", "to", " ", "decay", " ", "unstable", " ", "decay", " ", 
     "products", " ", 
     RowBox[{"(", 
      RowBox[{"True", ",", " ", "False"}], ")"}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"NotebookEvaluate", "[", 
    RowBox[{"FileNameJoin", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"NotebookDirectory", "[", "]"}], ",", "\"\<decay pheno\>\"", 
       ",", "\"\<decay-phase-space.nb\>\""}], "}"}], "]"}], "]"}], 
   ";"}]}]], "Input",
 CellChangeTimes->{{3.9312295319205227`*^9, 3.931229534058016*^9}, {
  3.931236224344515*^9, 3.9312363976157007`*^9}, {3.9312364474221735`*^9, 
  3.9312364840422764`*^9}},
 CellLabel->"In[75]:=",ExpressionUUID->"84deed46-30ae-436c-baaf-ebc10cfaedf4"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1430.25, 822.75},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
Magnification:>1.1 Inherited,
FrontEndVersion->"14.2 for Microsoft Windows (64-bit) (December 26, 2024)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"db0b606e-19ff-4bae-8260-94a466653bc7"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 158, 3, 74, "Chapter",ExpressionUUID->"50176953-4ca1-44c9-87c3-6e438dff1183"],
Cell[741, 27, 962, 25, 72, "Input",ExpressionUUID->"e6884e6e-3090-4640-ab83-b1165cfb15c9"],
Cell[CellGroupData[{
Cell[1728, 56, 154, 3, 72, "Section",ExpressionUUID->"471c60cf-4ea7-46db-a39e-9cf75ed2cc32"],
Cell[1885, 61, 876, 25, 219, "Input",ExpressionUUID->"225208d1-cdc5-4b84-8a87-0412bebfc537"]
}, Open  ]],
Cell[CellGroupData[{
Cell[2798, 91, 188, 3, 72, "Section",ExpressionUUID->"8139c5e2-7a6c-4ef4-a847-eca44df1bacb"],
Cell[CellGroupData[{
Cell[3011, 98, 177, 3, 58, "Subsection",ExpressionUUID->"8838b665-eb82-4f38-afbd-df4ae7480d9d"],
Cell[CellGroupData[{
Cell[3213, 105, 6625, 167, 596, "Input",ExpressionUUID->"48d11298-d6a9-4f53-9736-873f311c6a09"],
Cell[9841, 274, 638, 14, 70, "Message",ExpressionUUID->"41891f62-59c3-b942-a266-562c58990b75"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[10528, 294, 158, 3, 58, "Subsection",ExpressionUUID->"964d2146-e1cd-496b-928d-5b0194bc6551"],
Cell[10689, 299, 7629, 153, 596, "Input",ExpressionUUID->"190e301c-4c15-42b8-bc09-740c7498719e"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[18367, 458, 176, 3, 57, "Section",ExpressionUUID->"92f1f467-a754-4df7-ab7e-2872d3553ec2"],
Cell[CellGroupData[{
Cell[18568, 465, 422, 12, 58, "Subsection",ExpressionUUID->"a7087293-bf06-4296-9fff-233428303b6e"],
Cell[CellGroupData[{
Cell[19015, 481, 17441, 459, 962, "Input",ExpressionUUID->"57484377-8f92-482b-bc6e-2266e3906069"],
Cell[36459, 942, 721, 16, 70, "Message",ExpressionUUID->"0840cd85-aaeb-694b-8f1a-c7dcb0eb49ad"],
Cell[37183, 960, 6516, 146, 70, "Output",ExpressionUUID->"0754df14-ee79-1d4c-9060-3d2ac7ca08ca"],
Cell[43702, 1108, 1940, 53, 70, "Output",ExpressionUUID->"55c5e906-f9bb-274d-b033-8313ceb2075c"],
Cell[45645, 1163, 755, 19, 70, "Output",ExpressionUUID->"ffb2f44f-6544-9840-b35c-ac8e59624359"],
Cell[46403, 1184, 642, 14, 70, "Output",ExpressionUUID->"0804dfc8-a46d-b845-9e8d-d44bea21ec53"],
Cell[47048, 1200, 617, 14, 70, "Output",ExpressionUUID->"52f6d560-3a57-e547-b38d-951be1cc0439"]
}, Open  ]],
Cell[CellGroupData[{
Cell[47702, 1219, 168, 3, 48, "Subsubsection",ExpressionUUID->"97148706-5201-44b9-8426-b5bed4c4a2ec"],
Cell[47873, 1224, 1758, 51, 291, "Input",ExpressionUUID->"9edd3da2-396d-4293-ad69-adf679365dba"]
}, Open  ]],
Cell[CellGroupData[{
Cell[49668, 1280, 160, 3, 48, "Subsubsection",ExpressionUUID->"6d4dc4e2-2ca8-42d2-8784-09d94a9b1c08"],
Cell[49831, 1285, 11985, 313, 533, "Input",ExpressionUUID->"ab01fb90-be25-4e60-b853-fbeef012bbfb"]
}, Open  ]]
}, Open  ]]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[61889, 1606, 237, 4, 74, "Chapter",ExpressionUUID->"8ca0016f-9e5c-43f1-bd03-373b2ad4bd83"],
Cell[CellGroupData[{
Cell[62151, 1614, 246, 4, 72, "Section",ExpressionUUID->"852f5da9-96e6-4e8e-83b9-c5a21e80cdb3"],
Cell[CellGroupData[{
Cell[62422, 1622, 150, 3, 58, "Subsection",ExpressionUUID->"41beceb9-bb11-4b17-85c6-598e555af8a9"],
Cell[CellGroupData[{
Cell[62597, 1629, 9786, 240, 692, "Input",ExpressionUUID->"487ed701-8838-41fb-b13f-d9f742caa5cf"],
Cell[72386, 1871, 547, 9, 34, "Output",ExpressionUUID->"bab665d9-0e21-9248-87c4-8c7c564af134"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[72982, 1886, 168, 3, 58, "Subsection",ExpressionUUID->"c99807cf-56ef-402d-afa1-b8965586a6e2"],
Cell[CellGroupData[{
Cell[73175, 1893, 1721, 42, 135, "Input",ExpressionUUID->"c3178c43-532c-4715-83cf-3baec7645588"],
Cell[74899, 1937, 1005, 25, 52, "Output",ExpressionUUID->"4b7dc2c9-4c6f-6542-98a8-eaf39da0b57a"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[75965, 1969, 186, 3, 72, "Section",ExpressionUUID->"003b503e-ddae-40d1-b2dc-265390815938"],
Cell[76154, 1974, 2309, 57, 198, "Input",ExpressionUUID->"84deed46-30ae-436c-baaf-ebc10cfaedf4"]
}, Open  ]]
}, Open  ]]
}
]
*)

