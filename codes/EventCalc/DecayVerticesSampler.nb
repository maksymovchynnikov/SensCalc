(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    208439,       4250]
NotebookOptionsPosition[    203343,       4147]
NotebookOutlinePosition[    205143,       4188]
CellTagsIndexPosition[    205065,       4183]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"test", "=", "0"}], ";"}]], "Input",
 CellLabel->"In[1]:=",ExpressionUUID->"b3c65ec8-500f-4a04-85de-3df79324be2c"],

Cell[CellGroupData[{

Cell["\<\
Minimal values of z for which for the given direction LLP may decay inside \
the decay volume\
\>", "Section",
 CellChangeTimes->{{3.9114546526747723`*^9, 3.9114546701154594`*^9}, 
   3.931239316036483*^9},
 CellTags->
  "Re-evaluation",ExpressionUUID->"c59d4ca9-3a01-4964-942a-de9aba7e9814"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"test", "!=", "1"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"mtest", "=", "0.3"}], ";", "\[IndentingNewLine]", 
     RowBox[{"pts", "=", 
      RowBox[{"KinematicsFromTabulatedDistribution", "[", 
       RowBox[{"mtest", ",", "1", ",", "0", ",", 
        SuperscriptBox["10", "5"], ",", "10000"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"momenta", "=", 
      RowBox[{"Momenta", "[", 
       RowBox[{"pts", ",", 
        RowBox[{"-", "Pi"}], ",", "Pi"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"indexlist", "=", 
      RowBox[{
       RowBox[{"nfzvals", "[", 
        RowBox[{"momenta", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", 
           RowBox[{"-", "1"}]}], "]"}], "]"}], "]"}], "//", "Flatten"}]}], 
     ";"}]}], "]"}], "//", "AbsoluteTiming"}], "\[IndentingNewLine]", 
 RowBox[{"zminmaxVals", "=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Hold", "@", 
      RowBox[{"Compile", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"momenta", ",", "_Real", ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"zvals", ",", "_Real", ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"indexlist", ",", "_Integer"}], "}"}]}], "}"}], ",", 
        RowBox[{"Module", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"px", ",", "py", ",", "pz", ",", 
            RowBox[{"cond", "=", "0"}], ",", 
            RowBox[{"zval", "=", "0."}], ",", 
            RowBox[{"lenzval", "=", 
             RowBox[{"Length", "[", "zvals", "]"}]}], ",", 
            RowBox[{"zMin", "=", "0."}], ",", 
            RowBox[{"zMax", "=", "0."}], ",", "xtoz", ",", "ytoz", ",", 
            "condzmax", ",", "condzmin", ",", " ", 
            RowBox[{"lowMin", "=", "1"}], ",", 
            RowBox[{"lowMax", "=", " ", "1"}], ",", 
            RowBox[{"highMin", "=", 
             RowBox[{"Length", "[", "zvals", "]"}]}], ",", 
            RowBox[{"highMax", "=", 
             RowBox[{"Length", "[", "zvals", "]"}]}], ",", 
            RowBox[{"mid", "=", "0"}], ",", 
            RowBox[{"indexzinside", "=", "0"}], ",", 
            RowBox[{"z1in", "=", "0."}], ",", 
            RowBox[{"z2in", "=", "0."}], ",", 
            RowBox[{"z3in", "=", "0."}], ",", 
            RowBox[{"cond1", "=", "0."}], ",", 
            RowBox[{"cond2", "=", "0."}], ",", 
            RowBox[{"cond3", "=", "0."}], ",", "condfulltrajectory"}], "}"}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
           "Extracting", " ", "the", " ", "momenta", " ", "components"}], 
           "*)"}], "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"px", "=", 
            RowBox[{"Compile`GetElement", "[", 
             RowBox[{"momenta", ",", "indexpx"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"py", "=", 
            RowBox[{"Compile`GetElement", "[", 
             RowBox[{"momenta", ",", "indexpy"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"pz", "=", 
            RowBox[{"Compile`GetElement", "[", 
             RowBox[{"momenta", ",", "indexpz"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"xtoz", "=", 
            FractionBox["px", "pz"]}], ";", "\[IndentingNewLine]", 
           RowBox[{"ytoz", "=", 
            FractionBox["py", "pz"]}], ";", "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
            "Checking", " ", "if", " ", "the", " ", "trajectory", " ", "of", " ",
              "the", " ", "LLP", " ", "is", " ", "inside", " ", "the", " ", 
             "decay", " ", "volume", " ", "for", " ", "minimal", " ", "and", " ",
              "maximal", " ", "values", " ", "of", " ", "z", " ", "belonging",
              " ", "the", " ", "the", " ", "decay", " ", "volume"}], "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"condzmin", "=", 
            RowBox[{"IfLLPinsideDecVol", "[", 
             RowBox[{"zDecVolMin", ",", 
              RowBox[{"zDecVolMin", "*", "xtoz"}], ",", 
              RowBox[{"zDecVolMin", "*", "ytoz"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"condzmax", "=", 
            RowBox[{"IfLLPinsideDecVol", "[", 
             RowBox[{"zDecVolMax", ",", 
              RowBox[{"zDecVolMax", "*", "xtoz"}], ",", 
              RowBox[{"zDecVolMax", "*", "ytoz"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
            "___", "___", "___", "___", "___", "___", "___", "___", "___", 
             "___", "___", "___", "___", "___", "___", "___", "___", "___", 
             "___", "___", "___", "___", "___", "___"}], "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
            "Finding", " ", "the", " ", "value", " ", "of", " ", "z", " ", 
             "from", " ", "zvals", " ", "which", " ", "lies", " ", "inside", " ",
              "the", " ", "decay", " ", "volume"}], "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
            "___", "___", "___", "___", "___", "___", "___", "___", "___", 
             "___", "___", "___", "___", "___", "___", "___", "___", "___", 
             "___", "___", "___", "___", "___", "___"}], "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{"First", ",", " ", 
             RowBox[{
             "handle", " ", "the", " ", "case", " ", "where", " ", "at", " ", 
              "least", " ", "some", " ", "part", " ", "of", " ", "the", " ", 
              "LLP", " ", "trajectory", " ", "between", " ", 
              SubscriptBox["z", 
               RowBox[{"min", ",", 
                RowBox[{"decay", " ", "volume"}]}]], " ", "and", " ", 
              SubscriptBox["z", 
               RowBox[{"max", ",", 
                RowBox[{"decay", " ", "volume"}]}]], " ", "does", " ", "not", 
              " ", "intersect", " ", "the", " ", "decay", " ", "volume"}]}], 
            "*)"}], "\[IndentingNewLine]", 
           RowBox[{"condfulltrajectory", "=", 
            RowBox[{
             RowBox[{"condzmin", "*", "condzmax"}], "==", "1"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{"condfulltrajectory", ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"zMin", "=", "zDecVolMin"}], ";", "\[IndentingNewLine]",
               " ", 
              RowBox[{"zMax", "=", "zDecVolMax"}], ";"}]}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"!", "condfulltrajectory"}], ",", "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{
              "The", " ", "index", " ", "of", " ", "the", " ", "element", " ",
                "of", " ", "the", " ", "set", " ", "of", " ", "random", " ", 
               "zs", " ", "inside", " ", "the", " ", "decay", " ", "volume", " ", 
               RowBox[{"(", "zvals", ")"}], " ", "that", " ", "is", " ", 
               "nearest", " ", "to", " ", "the", " ", "pregenerated", " ", 
               "seed", " ", "decay", " ", "point", " ", 
               SubscriptBox["z", "seed"], " ", "inside", " ", "the", " ", 
               "decay", " ", "volume"}], "*)"}], "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"indexzinside", "=", "indexlist"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"(*", 
               RowBox[{
               "Extracting", " ", "the", " ", "three", " ", "nearest", " ", 
                "values", " ", "of", " ", "z", " ", "to", " ", 
                SubscriptBox["z", "seed"], " ", "from", " ", "zvals"}], 
               "*)"}], "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"z1in", ",", "z2in", ",", "z3in"}], "}"}], "=", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Compile`GetElement", "[", 
                  RowBox[{"zvals", ",", 
                   RowBox[{"indexzinside", "-", "1"}]}], "]"}], ",", 
                 RowBox[{"Compile`GetElement", "[", 
                  RowBox[{"zvals", ",", "indexzinside"}], "]"}], ",", 
                 RowBox[{"Compile`GetElement", "[", 
                  RowBox[{"zvals", ",", 
                   RowBox[{"indexzinside", "+", "1"}]}], "]"}]}], "}"}]}], ";",
               "\[IndentingNewLine]", 
              RowBox[{"(*", 
               RowBox[{
               "Checking", " ", "if", " ", "for", " ", "them", " ", "the", " ",
                 "LLP", " ", "seed", " ", "decay", " ", "point", " ", "is", " ",
                 "inside", " ", "the", " ", "decay", " ", "volume"}], "*)"}], 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"cond1", ",", "cond2", ",", "cond3"}], "}"}], "=", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"IfLLPinsideDecVol", "[", 
                  RowBox[{"z1in", ",", 
                   RowBox[{"z1in", "*", "xtoz"}], ",", 
                   RowBox[{"z1in", "*", "ytoz"}]}], "]"}], ",", 
                 RowBox[{"IfLLPinsideDecVol", "[", 
                  RowBox[{"z2in", ",", 
                   RowBox[{"z2in", "*", "xtoz"}], ",", 
                   RowBox[{"z2in", "*", "ytoz"}]}], "]"}], ",", 
                 RowBox[{"IfLLPinsideDecVol", "[", 
                  RowBox[{"z3in", ",", 
                   RowBox[{"z3in", "*", "xtoz"}], ",", 
                   RowBox[{"z3in", "*", "ytoz"}]}], "]"}]}], "}"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"(*", 
               RowBox[{
                RowBox[{
                "If", " ", "none", " ", "of", " ", "them", " ", "is", " ", 
                 "true", " ", 
                 RowBox[{"(", 
                  RowBox[{
                  "this", " ", "scenario", " ", "should", " ", "not", " ", 
                   "be", " ", "realized", " ", "in", " ", "practice"}], 
                  ")"}]}], ",", " ", 
                RowBox[{
                "then", " ", "just", " ", "sample", " ", "the", " ", "LLP", " ",
                  "decay", " ", "vertex", " ", "outside", " ", "the", " ", 
                 "decay", " ", "volume"}]}], "*)"}], "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"cond1", "==", "cond2", "==", "cond3", "==", "0"}], ",",
                 "\[IndentingNewLine]", 
                RowBox[{"zMin", "=", 
                 RowBox[{"zMax", "=", 
                  RowBox[{"0.99", "zDecVolMin"}]}]}], "\[IndentingNewLine]", ",",
                 "\[IndentingNewLine]", 
                RowBox[{"(*", 
                 RowBox[{"Otherwise", ",", " ", 
                  RowBox[{
                  "set", " ", "the", " ", "indices", " ", "to", " ", "be", " ",
                    "used", " ", "to", " ", "find", " ", 
                   SubscriptBox["z", "min"]}], ",", 
                  RowBox[{
                   SubscriptBox["z", "max"], " ", "for", " ", "the", " ", 
                   "LLP", " ", "intersecting", " ", "the", " ", "decay", " ", 
                   "volume", " ", "to", " ", "the", " ", "smallest", " ", "z",
                    " ", "among", " ", "the", " ", "three"}]}], "*)"}], 
                "\[IndentingNewLine]", 
                RowBox[{"highMin", "=", 
                 RowBox[{"lowMax", "=", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"cond1", "==", "1"}], ",", 
                    RowBox[{"indexzinside", "-", "1"}], ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"cond2", "==", "1"}], ",", "indexzinside", ",", 
                    RowBox[{"indexzinside", "+", "1"}]}], "]"}]}], 
                   "]"}]}]}]}], "\[IndentingNewLine]", "]"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"(*", 
               RowBox[{
               "Finding", " ", "the", " ", "minimal", " ", "z", " ", "for", " ",
                 "which", " ", "the", " ", "LLP", " ", "trajectory", " ", 
                "intersects", " ", "the", " ", "decay", " ", "volume"}], 
               "*)"}], "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"condzmin", "==", "1"}], ",", "\[IndentingNewLine]", 
                RowBox[{"zMin", "=", "zDecVolMin"}], "\[IndentingNewLine]", ",",
                 "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"While", "[", 
                  RowBox[{
                   RowBox[{"lowMin", "<", "highMin"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"mid", "=", 
                    RowBox[{"Floor", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"lowMin", "+", "highMin"}], ")"}], "/", "2"}], 
                    "]"}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{"zval", "=", 
                    RowBox[{"Compile`GetElement", "[", 
                    RowBox[{"zvals", ",", "mid"}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"cond", "=", 
                    RowBox[{"IfLLPinsideDecVol", "[", 
                    RowBox[{"zval", ",", 
                    RowBox[{"zval", "*", "xtoz"}], ",", 
                    RowBox[{"zval", "*", "ytoz"}]}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"cond", "==", "1"}], ",", 
                    RowBox[{"highMin", "=", "mid"}], ",", 
                    RowBox[{"lowMin", "=", 
                    RowBox[{"mid", "+", "1"}]}]}], "]"}]}]}], 
                  "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
                 RowBox[{"zMin", "=", 
                  RowBox[{"Compile`GetElement", "[", 
                   RowBox[{"zvals", ",", 
                    RowBox[{"mid", "+", "1"}]}], "]"}]}], ";"}]}], 
               "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"(*", 
               RowBox[{
               "Finding", " ", "the", " ", "maximal", " ", "z", " ", "for", " ",
                 "which", " ", "the", " ", "LLP", " ", "trajectory", " ", 
                "intersects", " ", "the", " ", "decay", " ", "volume"}], 
               "*)"}], "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"condzmax", "==", "1"}], ",", "\[IndentingNewLine]", 
                RowBox[{"zMax", "=", "zDecVolMax"}], "\[IndentingNewLine]", ",",
                 "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"While", "[", 
                  RowBox[{
                   RowBox[{"lowMax", "<", "highMax"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"mid", "=", 
                    RowBox[{"Floor", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"lowMax", "+", "highMax"}], ")"}], "/", "2"}], 
                    "]"}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{"zval", "=", 
                    RowBox[{"Compile`GetElement", "[", 
                    RowBox[{"zvals", ",", "mid"}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"cond", "=", 
                    RowBox[{"IfLLPinsideDecVol", "[", 
                    RowBox[{"zval", ",", 
                    RowBox[{"zval", "*", "xtoz"}], ",", 
                    RowBox[{"zval", "*", "ytoz"}]}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"cond", "==", "0"}], ",", 
                    RowBox[{"highMax", "=", "mid"}], ",", 
                    RowBox[{"lowMax", "=", 
                    RowBox[{"mid", "+", "1"}]}]}], "]"}]}]}], 
                  "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
                 RowBox[{"zMax", "=", 
                  RowBox[{"Compile`GetElement", "[", 
                   RowBox[{"zvals", ",", 
                    RowBox[{"lowMax", "-", "1"}]}], "]"}]}], ";"}]}], 
               "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
            "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"zMin", ",", "zMax"}], 
            RowBox[{"(*", 
             RowBox[{
             ",", "low", ",", "mid", ",", "high", ",", "condzmin", ",", 
              "condzmax", ",", "cond", ",", 
              RowBox[{"zval", "*", "xtoz"}], ",", 
              RowBox[{"zval", "*", "ytoz"}], ",", "zval"}], "*)"}], "}"}]}]}],
          "\[IndentingNewLine]", "]"}], ",", 
        RowBox[{"CompilationTarget", "->", "\"\<C\>\""}], ",", 
        RowBox[{"RuntimeOptions", "->", "\"\<Speed\>\""}], ",", 
        RowBox[{"RuntimeAttributes", "->", 
         RowBox[{"{", "Listable", "}"}]}], ",", 
        RowBox[{"Parallelization", "->", "True"}]}], "]"}]}], "/.", 
     RowBox[{"ruleDown", "[", 
      RowBox[{"{", "IfLLPinsideDecVol", "}"}], "]"}]}], "/.", 
    RowBox[{"ruleOwn", "[", 
     RowBox[{"{", 
      RowBox[{
      "zDecVolMin", ",", "zDecVolMax", ",", "indexpx", ",", "indexpy", ",", 
       "indexpz"}], "}"}], "]"}]}], "//", "ReleaseHold"}]}], "\[IndentingNewLine]", 
 RowBox[{"<<", "CompiledFunctionTools`"}], "\n", 
 RowBox[{
  RowBox[{"CompilePrint", "@", "zminmaxVals"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"test", "!=", "1"}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"tttt", "=", 
      RowBox[{"zminmaxVals", "[", 
       RowBox[{"momenta", ",", "zvals", ",", "indexlist"}], "]"}]}], ";"}], "//",
     "AbsoluteTiming"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"test", "!=", "1"}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"tttt", "[", 
      RowBox[{"[", 
       RowBox[{"All", ",", "2"}], "]"}], "]"}], "-", 
     RowBox[{"tttt", "[", 
      RowBox[{"[", 
       RowBox[{"All", ",", "1"}], "]"}], "]"}]}], "//", "MinMax"}]}], 
  "]"}]}], "Input",
 CellChangeTimes->{
  3.9114546769807663`*^9, {3.9114568537283444`*^9, 3.911456877144081*^9}, {
   3.911457290722334*^9, 3.9114572951352153`*^9}, {3.911457358109037*^9, 
   3.911457375656466*^9}, {3.911458191636885*^9, 3.911458220856561*^9}, {
   3.9114600475909877`*^9, 3.9114601860592384`*^9}, {3.9114621237153897`*^9, 
   3.91146212992635*^9}, {3.911463202706081*^9, 3.9114632428228083`*^9}, {
   3.91146332972499*^9, 3.911463348936509*^9}, {3.9114633831408405`*^9, 
   3.911463399747203*^9}, {3.911463458436544*^9, 3.9114634921610622`*^9}, {
   3.911465964198927*^9, 3.9114659693287315`*^9}, {3.911466539877324*^9, 
   3.911466567880271*^9}, {3.9114667162241964`*^9, 3.911466740935935*^9}, 
   3.9114670707617683`*^9, {3.9114676504926767`*^9, 3.911467660004251*^9}, {
   3.911471565643977*^9, 3.9114716233724995`*^9}, {3.91162110913342*^9, 
   3.9116211102281075`*^9}, {3.9118356377102814`*^9, 3.911835651438058*^9}, {
   3.9118360978222866`*^9, 3.911836098210989*^9}, {3.9118362241974106`*^9, 
   3.911836226653488*^9}, {3.9118362795653644`*^9, 3.9118362881757793`*^9}, {
   3.9118363628544636`*^9, 3.9118363644780807`*^9}, {3.9118367552573376`*^9, 
   3.9118367847830377`*^9}, {3.91183707761744*^9, 3.911837085176455*^9}, {
   3.911837273551116*^9, 3.9118372789541545`*^9}, {3.911837392557892*^9, 
   3.9118373976122694`*^9}, {3.91183749730196*^9, 3.9118375151923223`*^9}, {
   3.9118379724783263`*^9, 3.911837972773243*^9}, {3.9118380192289424`*^9, 
   3.9118380201423464`*^9}, {3.911838236196001*^9, 3.9118382542101326`*^9}, {
   3.9118383083471127`*^9, 3.9118383088290815`*^9}, {3.911838564045952*^9, 
   3.911838565438001*^9}, {3.9118391742010098`*^9, 3.911839175083452*^9}, {
   3.9118392829525414`*^9, 3.911839283247907*^9}, {3.9118393371376677`*^9, 
   3.911839337681361*^9}, {3.9118400061318984`*^9, 3.9118400562692184`*^9}, {
   3.9118404886434727`*^9, 3.911840532142655*^9}, {3.9118408287344103`*^9, 
   3.91184083673486*^9}, {3.911840894200062*^9, 3.9118408966699424`*^9}, {
   3.9118412332339373`*^9, 3.911841238677499*^9}, {3.911841279497637*^9, 
   3.9118413016317616`*^9}, {3.9118419532970457`*^9, 3.911841959716085*^9}, {
   3.911842267972332*^9, 3.9118422682261486`*^9}, {3.911843175271744*^9, 
   3.9118431970931993`*^9}, {3.9118433751617002`*^9, 
   3.9118433785361166`*^9}, {3.911843527372737*^9, 3.911843549287506*^9}, {
   3.9118436160475235`*^9, 3.911843616889239*^9}, {3.9118437475994797`*^9, 
   3.9118437648513174`*^9}, {3.9118438579614115`*^9, 3.911843939751031*^9}, {
   3.9118440149466457`*^9, 3.911844030960416*^9}, {3.9118440867198277`*^9, 
   3.91184409192723*^9}, {3.9118442738874483`*^9, 3.911844339407034*^9}, {
   3.9118443775717163`*^9, 3.9118443967519765`*^9}, 3.9118444275257635`*^9, {
   3.911844457541934*^9, 3.9118444747096567`*^9}, {3.9118446254076014`*^9, 
   3.911844625629001*^9}, {3.9118783628449225`*^9, 3.9118783706304607`*^9}, {
   3.9118787453305745`*^9, 3.9118787732164803`*^9}, {3.9118788212970257`*^9, 
   3.9118788228982115`*^9}, {3.91187901382848*^9, 3.911879115976733*^9}, {
   3.9118791531302185`*^9, 3.911879304229113*^9}, {3.9118794958646293`*^9, 
   3.911879809391348*^9}, {3.91187984811648*^9, 3.9118798516506543`*^9}, {
   3.9118798907190466`*^9, 3.911879924922209*^9}, {3.9118800282205057`*^9, 
   3.911880028831831*^9}, {3.9118800999068193`*^9, 3.91188027265547*^9}, {
   3.911880306928523*^9, 3.9118803114215403`*^9}, {3.9118804050202727`*^9, 
   3.911880554993826*^9}, {3.9118806390554857`*^9, 3.9118806405334587`*^9}, {
   3.911880673757743*^9, 3.9118807291138134`*^9}, {3.911880840451069*^9, 
   3.911880849517961*^9}, {3.9118808900813885`*^9, 3.9118808971097956`*^9}, {
   3.9118809273396497`*^9, 3.911880927857469*^9}, {3.911881258577714*^9, 
   3.91188127325253*^9}, 3.9118815144943676`*^9, {3.9118816043246827`*^9, 
   3.911881632629325*^9}, {3.9118830883613057`*^9, 3.911883088677211*^9}, {
   3.9176011177467375`*^9, 3.917601310121538*^9}, {3.917953548944107*^9, 
   3.917953550336608*^9}, {3.918663536012457*^9, 3.9186635360275106`*^9}, {
   3.9290954445991745`*^9, 3.929095453842433*^9}, {3.9290955136783204`*^9, 
   3.9290955141859045`*^9}, {3.9290955561152477`*^9, 
   3.9290955583268337`*^9}, {3.9290958008401155`*^9, 
   3.9290958054781947`*^9}, {3.929290935131481*^9, 3.9292909354922495`*^9}, {
   3.929291396939869*^9, 3.9292914917816935`*^9}, {3.9292915436360283`*^9, 
   3.9292915437824965`*^9}, {3.9292921573929453`*^9, 3.929292245342413*^9}, {
   3.9292924239717913`*^9, 3.9292924260988665`*^9}, {3.9292928111599584`*^9, 
   3.9292928120315776`*^9}, {3.931247520224969*^9, 3.931247521286347*^9}, {
   3.942401243928135*^9, 3.942401260840109*^9}, {3.942401339021803*^9, 
   3.9424013431400833`*^9}, {3.942464649752527*^9, 3.942464960427334*^9}, {
   3.9424650011803017`*^9, 3.9424652310517426`*^9}, {3.9424652862671947`*^9, 
   3.942465289875906*^9}},
 CellTags->"Re-evaluation",
 CellLabel->"In[2]:=",ExpressionUUID->"3253061f-7d26-4e91-947a-78eb50568166"],

Cell[BoxData[
 FormBox[
  RowBox[{"{", 
   RowBox[{"0.2774481`", ",", "Null"}], "}"}], TraditionalForm]], "Output",
 CellChangeTimes->{{3.91145474334199*^9, 3.9114547845911865`*^9}, 
   3.911454993765156*^9, 3.91145513775883*^9, 3.9114552183109503`*^9, 
   3.9114552643654757`*^9, 3.9114553099077063`*^9, 3.911455568547777*^9, 
   3.9114563805171995`*^9, 3.9114568792615232`*^9, 3.9114571281764765`*^9, {
   3.9114601794769526`*^9, 3.9114601874425373`*^9}, 3.9114619707073965`*^9, 
   3.9114620494555063`*^9, 3.9114621314435744`*^9, 3.9114632542253523`*^9, {
   3.911463347450334*^9, 3.911463350396001*^9}, 3.9114634015631685`*^9, 
   3.911463496292983*^9, 3.911463665365632*^9, 3.911463702150302*^9, 
   3.911463751603992*^9, {3.9114639331724787`*^9, 3.9114639615626163`*^9}, 
   3.9114640351449823`*^9, 3.9114652369427137`*^9, 3.9114659226909313`*^9, 
   3.911465970868927*^9, {3.911466548237937*^9, 3.911466569527745*^9}, 
   3.9114667438209224`*^9, 3.9114670724210715`*^9, 3.9114671371457043`*^9, 
   3.9114671691963434`*^9, 3.911467622138899*^9, 3.9114676539254894`*^9, {
   3.9114676840664577`*^9, 3.911467706562191*^9}, 3.911471531451127*^9, {
   3.911471603701623*^9, 3.9114716247373724`*^9}, 3.911471709610711*^9, 
   3.911471823522833*^9, 3.9114722396310377`*^9, 3.9114724582311115`*^9, 
   3.9114895425293756`*^9, {3.911489646671748*^9, 3.9114896727612085`*^9}, 
   3.9114897364615965`*^9, 3.9114897679619713`*^9, 3.911490298870763*^9, 
   3.91149394662414*^9, 3.9114956465893884`*^9, 3.9114960686914177`*^9, 
   3.911496129734969*^9, 3.91149624534585*^9, 3.9114963063434706`*^9, 
   3.911496345596057*^9, 3.9114964162623167`*^9, {3.9114967820266542`*^9, 
   3.911496795271021*^9}, 3.9114975420945034`*^9, 3.911497648038204*^9, 
   3.9115350018069396`*^9, {3.9115390098172803`*^9, 3.911539030077101*^9}, 
   3.911544137821062*^9, 3.9115443231488314`*^9, {3.9115461622850056`*^9, 
   3.9115461842245884`*^9}, 3.911547013037345*^9, 3.9115473992587185`*^9, 
   3.9115491129411106`*^9, 3.9115554163768635`*^9, 3.911555466768423*^9, {
   3.9115555109735594`*^9, 3.911555526777586*^9}, {3.9115597039148436`*^9, 
   3.911559727452448*^9}, 3.9115603291480837`*^9, 3.9115606580222516`*^9, 
   3.9116209023139863`*^9, 3.91162093718242*^9, 3.911620970343348*^9, 
   3.9116210058524785`*^9, {3.9116212357352715`*^9, 3.911621252738662*^9}, 
   3.911621739909871*^9, 3.91162178779749*^9, 3.9116220079199324`*^9, {
   3.9116220816772118`*^9, 3.9116221073381653`*^9}, 3.9116221583504696`*^9, 
   3.9116221884118156`*^9, {3.911622534168096*^9, 3.911622558800542*^9}, 
   3.9116268288636403`*^9, 3.911626977888198*^9, 3.911627073775736*^9, 
   3.9116271527252626`*^9, 3.911628171395385*^9, 3.911628325073557*^9, 
   3.9116283841711035`*^9, 3.911628451824483*^9, 3.911628525268447*^9, 
   3.911629651676647*^9, 3.911629706679515*^9, 3.911629840110173*^9, 
   3.9116302478544188`*^9, 3.9116302854009285`*^9, 3.9116360442102623`*^9, 
   3.9116404867939367`*^9, 3.911640606619769*^9, 3.911640895871807*^9, 
   3.911641063417348*^9, 3.9116411123698587`*^9, 3.9116416200271444`*^9, 
   3.9116418194777946`*^9, 3.9116427197766457`*^9, 3.911642765233509*^9, 
   3.911642983761607*^9, 3.911643031670534*^9, 3.911643209781483*^9, 
   3.911643966737159*^9, 3.9116442055829506`*^9, 3.9116445606362123`*^9, 
   3.91164479730468*^9, 3.911644831193672*^9, 3.91164510580863*^9, 
   3.9116451984547524`*^9, 3.9116456312254176`*^9, {3.9116459334930077`*^9, 
   3.9116459556141167`*^9}, 3.9116462261885033`*^9, 3.9116467828667107`*^9, 
   3.911664882010028*^9, 3.911669403923394*^9, 3.911669457153763*^9, {
   3.9116698579339714`*^9, 3.911669887911609*^9}, 3.911726995799249*^9, 
   3.911727062151407*^9, 3.9117995957332973`*^9, 3.911800736688052*^9, 
   3.9118018875600557`*^9, 3.9118020417730236`*^9, 3.9118356530864353`*^9, 
   3.9118357513803864`*^9, 3.9118358603642035`*^9, 3.9118361251060214`*^9, 
   3.911836229926869*^9, {3.911836285718889*^9, 3.911836289948048*^9}, {
   3.9118367890000067`*^9, 3.911836809720401*^9}, {3.911837082187626*^9, 
   3.911837086692898*^9}, 3.9118372821002617`*^9, {3.9118373950265765`*^9, 
   3.911837399157307*^9}, 3.911837500058262*^9, 3.911837916426985*^9, {
   3.9118380100160103`*^9, 3.9118380216881504`*^9}, {3.9118382392167845`*^9, 
   3.911838270353298*^9}, {3.911838310632957*^9, 3.9118383334971843`*^9}, 
   3.9118385672011447`*^9, 3.9118391780723004`*^9, 3.911839289330168*^9, 
   3.911839339321306*^9, 3.9118399077550926`*^9, 3.911840035558896*^9, {
   3.911840514643588*^9, 3.911840533908929*^9}, {3.9118408326400733`*^9, 
   3.9118408383989563`*^9}, 3.9118408983727646`*^9, 3.9118412404326134`*^9, 
   3.911841305182249*^9, 3.9118419630425854`*^9, 3.9118420158713946`*^9, 
   3.9118422700243835`*^9, 3.9118431773893433`*^9, 3.911843274010107*^9, 
   3.9118433802964582`*^9, 3.9118435509940968`*^9, 3.9118436191675344`*^9, {
   3.9118437500291305`*^9, 3.9118437667278585`*^9}, {3.9118438601652803`*^9, 
   3.911843927161518*^9}, 3.911844037420246*^9, {3.9118443372573805`*^9, 
   3.9118443409056587`*^9}, {3.9118443815556297`*^9, 3.911844407797851*^9}, 
   3.911844481376112*^9, 3.9118446419162645`*^9, 3.9118782372531514`*^9, 
   3.9118787749242263`*^9, 3.9118788247500753`*^9, 3.9118790228504715`*^9, {
   3.9118790866043787`*^9, 3.9118791162816515`*^9}, {3.911879157526742*^9, 
   3.9118791961384325`*^9}, 3.9118792527895093`*^9, 3.911879286560768*^9, 
   3.911879628205421*^9, 3.911879853031824*^9, {3.911880265867443*^9, 
   3.9118802730802755`*^9}, 3.9118803117879734`*^9, {3.911880407752562*^9, 
   3.9118804131660657`*^9}, 3.911880454393324*^9, {3.911880490680335*^9, 
   3.911880555325536*^9}, 3.9118806408885326`*^9, {3.911880716004258*^9, 
   3.9118807302809753`*^9}, 3.911880855195461*^9, {3.9118808987852*^9, 
   3.9118809281503096`*^9}, 3.9118812737399864`*^9, 3.91188132304208*^9, 
   3.911881585354257*^9, 3.911881632959221*^9, 3.9118817277996016`*^9, 
   3.911881835155317*^9, 3.911881877528159*^9, 3.9118828801820517`*^9, 
   3.9118830911803064`*^9, 3.9118831320444756`*^9, 3.9118832265426407`*^9, 
   3.9118974746283593`*^9, 3.911897966494974*^9, 3.911898091111656*^9, 
   3.9118981214234595`*^9, 3.911898152083319*^9, 3.9118982344346867`*^9, 
   3.911898279015938*^9, 3.911901996213585*^9, 3.911907390525029*^9, 
   3.9119074233066444`*^9, 3.911907471784422*^9, 3.9119075338278427`*^9, 
   3.9119075654716983`*^9, {3.9176012942712517`*^9, 3.9176013108800545`*^9}, 
   3.917622939670699*^9, 3.917625351774911*^9, 3.917625853107131*^9, 
   3.9176260571077876`*^9, 3.917626308708412*^9, 3.9176270702071133`*^9, 
   3.917627696028404*^9, 3.9176279856044536`*^9, 3.917628294218427*^9, 
   3.9176691123411093`*^9, 3.9176723459465375`*^9, 3.9176798691499863`*^9, 
   3.917680417940675*^9, 3.917681960075745*^9, 3.9177157240333557`*^9, 
   3.9177161569326134`*^9, 3.917721057526918*^9, 3.917771458986998*^9, 
   3.917773054255619*^9, 3.9177735572515035`*^9, 3.9177787802973576`*^9, 
   3.9177864355462446`*^9, 3.9177968520031943`*^9, 3.9177977394229517`*^9, 
   3.9178025119536934`*^9, 3.9178593956630044`*^9, 3.91786082989294*^9, 
   3.9178849000206776`*^9, 3.917887799840485*^9, 3.917953595351371*^9, 
   3.918121740135974*^9, 3.918192022753107*^9, 3.9181943520034547`*^9, 
   3.918197327311358*^9, 3.9182023357191567`*^9, 3.9182045682287827`*^9, 
   3.9182070312306876`*^9, 3.918228751002596*^9, 3.9183206806363487`*^9, 
   3.918371932892395*^9, 3.918372844582159*^9, 3.9183767736805596`*^9, 
   3.918397711774832*^9, 3.918410307151928*^9, 3.9184602630613313`*^9, 
   3.9184608818511467`*^9, 3.9184619209920373`*^9, {3.9184641519425344`*^9, 
   3.9184641648339787`*^9}, 3.9184650101541*^9, 3.918558542826268*^9, 
   3.91857377876164*^9, 3.918575442429981*^9, 3.918575783729145*^9, 
   3.9185763403627615`*^9, 3.918577317209777*^9, 3.9185777496146135`*^9, 
   3.9185793579149647`*^9, 3.9186185758958416`*^9, 3.9186188977237997`*^9, 
   3.918620731960244*^9, 3.918643936482832*^9, 3.9186451768880625`*^9, 
   3.918662124755746*^9, 3.9186647685755415`*^9, 3.918697775662156*^9, 
   3.9189258629626217`*^9, 3.9189263699854507`*^9, 3.918927183580812*^9, 
   3.9189765651969914`*^9, 3.9189767198780746`*^9, 3.918977406883527*^9, 
   3.9189999819722805`*^9, 3.919000724743616*^9, 3.919010775782225*^9, 
   3.9190121200489545`*^9, 3.9190134635950394`*^9, 3.919013982029353*^9, 
   3.919014315868288*^9, 3.919015195211028*^9, 3.919015409940066*^9, 
   3.919015790840151*^9, 3.919016089465935*^9, 3.9190163026203403`*^9, 
   3.9190167192268076`*^9, 3.91904472925984*^9, 3.919062731071312*^9, 
   3.919064273729312*^9, 3.9190665426710677`*^9, 3.919066927959499*^9, 
   3.919067229084193*^9, 3.9190696274788537`*^9, 3.9190816021169996`*^9, 
   3.9194429077479334`*^9, 3.9200502561509647`*^9, 3.9200929575819435`*^9, 
   3.9200957601243696`*^9, 3.920096416907871*^9, 3.9201296489460154`*^9, 
   3.9201810335934343`*^9, 3.920192835676855*^9, 3.9218127292140045`*^9, 
   3.921831950188362*^9, 3.9290955429036317`*^9, 3.929095611053911*^9, 
   3.929095817950506*^9, {3.92911356046829*^9, 3.9291135640599456`*^9}, 
   3.929290945178413*^9, 3.9292915921173415`*^9, 3.9292922084730215`*^9, {
   3.929292426579689*^9, 3.9292924322054944`*^9}, 3.929292816360818*^9, 
   3.929293405160679*^9, {3.931238095299296*^9, 3.9312381064764624`*^9}, {
   3.931247522657231*^9, 3.931247531513449*^9}, 3.9312482152044697`*^9, 
   3.9312486598020697`*^9, 3.9312762797139144`*^9, {3.9382422995668316`*^9, 
   3.9382423090424137`*^9}, 3.938248832955084*^9, 3.9383881484850655`*^9, 
   3.942403655579956*^9, 3.942465231647518*^9, 3.9424692280698605`*^9},
 CellTags->"Re-evaluation",
 CellLabel->
  "Out[177]=",ExpressionUUID->"cae2bdeb-63c2-f841-9ce7-520db8d6fa6d"],

Cell[BoxData[
 FormBox[
  InterpretationBox[
   RowBox[{
    TagBox["CompiledFunction",
     "SummaryHead"], "[", 
    DynamicModuleBox[{Typeset`open$$ = False, Typeset`embedState$$ = "Ready"}, 
     TemplateBox[{
       PaneSelectorBox[{False -> GridBox[{{
             PaneBox[
              ButtonBox[
               DynamicBox[
                FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxOpener"]], 
               ButtonFunction :> (Typeset`open$$ = True), Appearance -> None, 
               BaseStyle -> {}, Evaluator -> Automatic, Method -> 
               "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
              Dynamic[{
                Automatic, 
                 3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                  Magnification])}]], 
             GraphicsBox[{
               Thickness[0.038461538461538464`], {
                FaceForm[{
                  GrayLevel[0.93], 
                  Opacity[1.]}], 
                
                FilledCurveBox[{{{1, 4, 3}, {0, 1, 0}, {1, 3, 3}, {0, 1, 0}, {
                 1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {0, 1, 0}}}, {{{
                 25.499999999999996`, 2.5}, {25.499999999999996`, 
                 1.3953100000000003`}, {24.604699999999998`, 
                 0.49999999999999994`}, {23.5, 0.49999999999999994`}, {2.5, 
                 0.49999999999999994`}, {1.3953100000000003`, 
                 0.49999999999999994`}, {0.49999999999999994`, 
                 1.3953100000000003`}, {0.49999999999999994`, 2.5}, {
                 0.49999999999999994`, 23.5}, {0.49999999999999994`, 
                 24.604699999999998`}, {1.3953100000000003`, 
                 25.499999999999996`}, {2.5, 25.499999999999996`}, {23.5, 
                 25.499999999999996`}, {24.604699999999998`, 
                 25.499999999999996`}, {25.499999999999996`, 
                 24.604699999999998`}, {25.499999999999996`, 23.5}, {
                 25.499999999999996`, 2.5}}}]}, {
                FaceForm[{
                  RGBColor[0.5, 0.5, 0.5], 
                  Opacity[1.]}], 
                
                FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {
                 0, 1, 0}, {0, 1, 0}, {0, 1, 0}}}, {{{20.5426, 
                 19.116799999999998`}, {16.3832, 21.876199999999997`}, {
                 16.3832, 20.021499999999996`}, {6.930469999999999, 
                 20.021499999999996`}, {6.930469999999999, 
                 18.212100000000003`}, {16.3832, 18.212100000000003`}, {
                 16.3832, 16.357399999999995`}, {20.5426, 
                 19.116799999999998`}}}], 
                
                FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {
                 0, 1, 0}, {0, 1, 0}, {0, 1, 0}}}, {{{5.30508, 13.8391}, {
                 9.46445, 11.079700000000003`}, {9.46445, 
                 12.933999999999997`}, {18.917199999999998`, 
                 12.933999999999997`}, {18.917199999999998`, 14.7438}, {
                 9.46445, 14.7438}, {9.46445, 16.598}, {5.30508, 13.8391}}}], 
                
                FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {
                 0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
                 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {
                 1, 3, 3}, {1, 3, 3}, {1, 3, 3}}}, CompressedData["
1:eJxTTMoPSmVmYGBgBGJjIGYCYq4u+eR3VWoOxhkv5j+Qk3SA8fu/r5rKOVHM
Yd2vmNyjZ9Qcrt9QXbW9S8RBg59767IidQcPMYPGaHFhB+Nn61SfiGo4xBwp
T7o2V9Dh0Iolfg6/NBxEHv/x1Xgi4FB1XNNqkqQWnP+axUTQjFkbzn+oO2HB
j/3aDg/Xn5T6WiDoYLs3aJpiqI7DrHN+bO6tQg4zfUR7vF7pQOyfIQyRd9d1
WLL0U1kLoyjEPdm6DpoTXfQX7xBzKPjQejLkhDacL5J4+LL2Gm2HtNnSl4Vf
iELM69J2qPZM3tLnJerQX1oozZugDfHPUxGI/4W1HQ5p3TthoyDi4D7lG1v8
Mi2HgqL9zoEHhB1inOxe3BRG8MH62zXhfIbN1Z82CGhC/GMg4nCm3mN/7TYN
iHlCUPdGakDc/1kUEr46GhD/eYnD+d9iBf/kC0vC+TuCrSL+X5Vy2HGR4R5T
uAbEfxYykPBYp+HQqsCuesZAFhL+rJoQ/2rIQdxTpwkJ7yVycPfD+GDzVqLx
xbUd5HYt2JfqBdWfpA2Jj9mykPDpgYaXtaxDy7yzq86vg8qvlIHE5ylY/Eo7
XAt7o787TxfOB5ufqesQ9PbyxxkPZSDhZ6nrMAGU3u7LQtLLEx2HN2253UbX
ofZ76jis/Pay4oynAsT8QG0HKZMv/gW7FCDyTFpwPsz/MD44/Mw1HFjb1uR9
TVVwWKy880/7FHWIexrkIfLX1RzOMDZZVjHIOaDkh3vSDuj5AwCF11Vc
                 "]]}}, Background -> GrayLevel[0.93], Axes -> False, 
              AspectRatio -> 1, ImageSize -> 
              Dynamic[{
                Automatic, 
                 3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                  Magnification])}], Frame -> True, FrameTicks -> None, 
              FrameStyle -> Directive[
                Thickness[Tiny], 
                GrayLevel[0.7]]], 
             GridBox[{{
                RowBox[{
                  TagBox["\"Argument count: \"", "SummaryItemAnnotation"], 
                  "\[InvisibleSpace]", 
                  TagBox["3", "SummaryItem"]}]}, {
                RowBox[{
                  TagBox["\"Argument types: \"", "SummaryItemAnnotation"], 
                  "\[InvisibleSpace]", 
                  TagBox[
                   StyleBox[
                    PaneBox[
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"_Real", ",", "1"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"_Real", ",", "1"}], "}"}], ",", "_Integer"}], 
                    "}"}], ContentPadding -> False, FrameMargins -> 0, 
                    StripOnInput -> True, BaselinePosition -> Baseline, 
                    ImageSize -> {{1, 300}, Automatic}], LineBreakWithin -> 
                    False], "SummaryItem"]}]}}, 
              GridBoxAlignment -> {
               "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
              False, GridBoxItemSize -> {
               "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
              GridBoxSpacings -> {
               "Columns" -> {{2}}, "Rows" -> {{Automatic}}}, 
              BaseStyle -> {
               ShowStringCharacters -> False, NumberMarks -> False, 
                PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
           GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
           AutoDelete -> False, 
           GridBoxItemSize -> {
            "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
           BaselinePosition -> {1, 1}], True -> GridBox[{{
             PaneBox[
              ButtonBox[
               DynamicBox[
                FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxCloser"]], 
               ButtonFunction :> (Typeset`open$$ = False), Appearance -> None,
                BaseStyle -> {}, Evaluator -> Automatic, Method -> 
               "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
              Dynamic[{
                Automatic, 
                 3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                  Magnification])}]], 
             GraphicsBox[{
               Thickness[0.038461538461538464`], {
                FaceForm[{
                  GrayLevel[0.93], 
                  Opacity[1.]}], 
                
                FilledCurveBox[{{{1, 4, 3}, {0, 1, 0}, {1, 3, 3}, {0, 1, 0}, {
                 1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {0, 1, 0}}}, {{{
                 25.499999999999996`, 2.5}, {25.499999999999996`, 
                 1.3953100000000003`}, {24.604699999999998`, 
                 0.49999999999999994`}, {23.5, 0.49999999999999994`}, {2.5, 
                 0.49999999999999994`}, {1.3953100000000003`, 
                 0.49999999999999994`}, {0.49999999999999994`, 
                 1.3953100000000003`}, {0.49999999999999994`, 2.5}, {
                 0.49999999999999994`, 23.5}, {0.49999999999999994`, 
                 24.604699999999998`}, {1.3953100000000003`, 
                 25.499999999999996`}, {2.5, 25.499999999999996`}, {23.5, 
                 25.499999999999996`}, {24.604699999999998`, 
                 25.499999999999996`}, {25.499999999999996`, 
                 24.604699999999998`}, {25.499999999999996`, 23.5}, {
                 25.499999999999996`, 2.5}}}]}, {
                FaceForm[{
                  RGBColor[0.5, 0.5, 0.5], 
                  Opacity[1.]}], 
                
                FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {
                 0, 1, 0}, {0, 1, 0}, {0, 1, 0}}}, {{{20.5426, 
                 19.116799999999998`}, {16.3832, 21.876199999999997`}, {
                 16.3832, 20.021499999999996`}, {6.930469999999999, 
                 20.021499999999996`}, {6.930469999999999, 
                 18.212100000000003`}, {16.3832, 18.212100000000003`}, {
                 16.3832, 16.357399999999995`}, {20.5426, 
                 19.116799999999998`}}}], 
                
                FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {
                 0, 1, 0}, {0, 1, 0}, {0, 1, 0}}}, {{{5.30508, 13.8391}, {
                 9.46445, 11.079700000000003`}, {9.46445, 
                 12.933999999999997`}, {18.917199999999998`, 
                 12.933999999999997`}, {18.917199999999998`, 14.7438}, {
                 9.46445, 14.7438}, {9.46445, 16.598}, {5.30508, 13.8391}}}], 
                
                FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {
                 0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
                 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {
                 1, 3, 3}, {1, 3, 3}, {1, 3, 3}}}, CompressedData["
1:eJxTTMoPSmVmYGBgBGJjIGYCYq4u+eR3VWoOxhkv5j+Qk3SA8fu/r5rKOVHM
Yd2vmNyjZ9Qcrt9QXbW9S8RBg59767IidQcPMYPGaHFhB+Nn61SfiGo4xBwp
T7o2V9Dh0Iolfg6/NBxEHv/x1Xgi4FB1XNNqkqQWnP+axUTQjFkbzn+oO2HB
j/3aDg/Xn5T6WiDoYLs3aJpiqI7DrHN+bO6tQg4zfUR7vF7pQOyfIQyRd9d1
WLL0U1kLoyjEPdm6DpoTXfQX7xBzKPjQejLkhDacL5J4+LL2Gm2HtNnSl4Vf
iELM69J2qPZM3tLnJerQX1oozZugDfHPUxGI/4W1HQ5p3TthoyDi4D7lG1v8
Mi2HgqL9zoEHhB1inOxe3BRG8MH62zXhfIbN1Z82CGhC/GMg4nCm3mN/7TYN
iHlCUPdGakDc/1kUEr46GhD/eYnD+d9iBf/kC0vC+TuCrSL+X5Vy2HGR4R5T
uAbEfxYykPBYp+HQqsCuesZAFhL+rJoQ/2rIQdxTpwkJ7yVycPfD+GDzVqLx
xbUd5HYt2JfqBdWfpA2Jj9mykPDpgYaXtaxDy7yzq86vg8qvlIHE5ylY/Eo7
XAt7o787TxfOB5ufqesQ9PbyxxkPZSDhZ6nrMAGU3u7LQtLLEx2HN2253UbX
ofZ76jis/Pay4oynAsT8QG0HKZMv/gW7FCDyTFpwPsz/MD44/Mw1HFjb1uR9
TVVwWKy880/7FHWIexrkIfLX1RzOMDZZVjHIOaDkh3vSDuj5AwCF11Vc
                 "]]}}, Background -> GrayLevel[0.93], Axes -> False, 
              AspectRatio -> 1, ImageSize -> 
              Dynamic[{
                Automatic, 
                 3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                  Magnification])}], Frame -> True, FrameTicks -> None, 
              FrameStyle -> Directive[
                Thickness[Tiny], 
                GrayLevel[0.7]]], 
             GridBox[{{
                RowBox[{
                  TagBox["\"Argument count: \"", "SummaryItemAnnotation"], 
                  "\[InvisibleSpace]", 
                  TagBox["3", "SummaryItem"]}]}, {
                RowBox[{
                  TagBox["\"Argument types: \"", "SummaryItemAnnotation"], 
                  "\[InvisibleSpace]", 
                  TagBox[
                   PaneBox[
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"_Real", ",", "1"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"_Real", ",", "1"}], "}"}], ",", "_Integer"}], 
                    "}"}], ImageSize -> {{1, 500}, Automatic}, 
                    BaselinePosition -> Baseline, ContentPadding -> False, 
                    FrameMargins -> 0, StripOnInput -> True], 
                   "SummaryItem"]}]}, {
                RowBox[{
                  TagBox["\"Variables: \"", "SummaryItemAnnotation"], 
                  "\[InvisibleSpace]", 
                  TagBox[
                   RowBox[{"{", 
                    RowBox[{"momenta", ",", "zvals", ",", "indexlist"}], 
                    "}"}], "SummaryItem"]}]}, {
                RowBox[{
                  TagBox["\"Expression: \"", "SummaryItemAnnotation"], 
                  "\[InvisibleSpace]", 
                  TagBox[
                   PaneBox[
                    RowBox[{"Module", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"px", ",", "py", ",", "pz", ",", 
                    RowBox[{"cond", "=", "0"}], ",", 
                    RowBox[{"zval", "=", "0.`"}], ",", 
                    RowBox[{"lenzval", "=", 
                    RowBox[{"Length", "[", "zvals", "]"}]}], ",", 
                    RowBox[{"zMin", "=", "0.`"}], ",", 
                    RowBox[{"zMax", "=", "0.`"}], ",", "xtoz", ",", "ytoz", 
                    ",", "condzmax", ",", "condzmin", ",", 
                    RowBox[{"lowMin", "=", "1"}], ",", 
                    RowBox[{"lowMax", "=", "1"}], ",", 
                    RowBox[{"highMin", "=", 
                    RowBox[{"Length", "[", "zvals", "]"}]}], ",", 
                    RowBox[{"highMax", "=", 
                    RowBox[{"Length", "[", "zvals", "]"}]}], ",", 
                    RowBox[{"mid", "=", "0"}], ",", 
                    RowBox[{"indexzinside", "=", "0"}], ",", 
                    RowBox[{"z1in", "=", "0.`"}], ",", 
                    RowBox[{"z2in", "=", "0.`"}], ",", 
                    RowBox[{"z3in", "=", "0.`"}], ",", 
                    RowBox[{"cond1", "=", "0.`"}], ",", 
                    RowBox[{"cond2", "=", "0.`"}], ",", 
                    RowBox[{"cond3", "=", "0.`"}], ",", 
                    "condfulltrajectory"}], "}"}], ",", 
                    RowBox[{
                    RowBox[{"px", "=", 
                    RowBox[{"Compile`GetElement", "(", 
                    RowBox[{"momenta", ",", "1"}], ")"}]}], ";", 
                    RowBox[{"py", "=", 
                    RowBox[{"Compile`GetElement", "(", 
                    RowBox[{"momenta", ",", "2"}], ")"}]}], ";", 
                    RowBox[{"pz", "=", 
                    RowBox[{"Compile`GetElement", "(", 
                    RowBox[{"momenta", ",", "3"}], ")"}]}], ";", 
                    RowBox[{"xtoz", "=", 
                    FractionBox["px", "pz"]}], ";", 
                    RowBox[{"ytoz", "=", 
                    FractionBox["py", "pz"]}], ";", 
                    RowBox[{"condzmin", "=", 
                    RowBox[{"Boole", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "0.5`"}], "<", 
                    RowBox[{"32.`", " ", "xtoz"}], "<", "0.5`"}], "\[And]", 
                    RowBox[{
                    RowBox[{"-", "1.3500000000000003`"}], "<", 
                    RowBox[{"32.`", " ", "ytoz"}], "<", 
                    "1.3500000000000003`"}]}], "]"}]}], ";", 
                    RowBox[{"condzmax", "=", 
                    RowBox[{"Boole", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "2.`"}], "<", 
                    RowBox[{"82.`", " ", "xtoz"}], "<", "2.`"}], "\[And]", 
                    RowBox[{
                    RowBox[{"-", "3.1000000000000005`"}], "<", 
                    RowBox[{"82.`", " ", "ytoz"}], "<", 
                    "3.1000000000000005`"}]}], "]"}]}], ";", 
                    RowBox[{"condfulltrajectory", "=", 
                    RowBox[{
                    RowBox[{"condzmax", " ", "condzmin"}], "\[LongEqual]", 
                    "1"}]}], ";", 
                    RowBox[{"If", "[", 
                    RowBox[{"condfulltrajectory", ",", 
                    RowBox[{
                    RowBox[{"zMin", "=", "32.`"}], ";", 
                    RowBox[{"zMax", "=", "82.`"}], ";"}]}], "]"}], ";", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"\[Not]", "condfulltrajectory"}], ",", 
                    RowBox[{
                    RowBox[{"indexzinside", "=", "indexlist"}], ";", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"z1in", ",", "z2in", ",", "z3in"}], "}"}], "=", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Compile`GetElement", "(", 
                    RowBox[{"zvals", ",", 
                    RowBox[{"indexzinside", "-", "1"}]}], ")"}], ",", 
                    RowBox[{"Compile`GetElement", "(", 
                    RowBox[{"zvals", ",", "indexzinside"}], ")"}], ",", 
                    RowBox[{"Compile`GetElement", "(", 
                    RowBox[{"zvals", ",", 
                    RowBox[{"indexzinside", "+", "1"}]}], ")"}]}], "}"}]}], 
                    ";", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"cond1", ",", "cond2", ",", "cond3"}], "}"}], "=", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Boole", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"0.45999999999999996`", "\[VeryThinSpace]"}], "-", 
                    RowBox[{"0.03`", " ", "z1in"}]}], "<", 
                    RowBox[{"xtoz", " ", "z1in"}], "<", 
                    RowBox[{
                    RowBox[{"0.03`", " ", "z1in"}], "-", 
                    "0.45999999999999996`"}]}], "\[And]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{
                    RowBox[{"0.035`"}], " ", "z1in"}]}], "-", 
                    "0.2300000000000002`"}], "<", 
                    RowBox[{"ytoz", " ", "z1in"}], "<", 
                    RowBox[{
                    RowBox[{"0.035`", " ", "z1in"}], "+", 
                    "0.2300000000000002`"}]}]}], "]"}], ",", 
                    RowBox[{"Boole", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"0.45999999999999996`", "\[VeryThinSpace]"}], "-", 
                    RowBox[{"0.03`", " ", "z2in"}]}], "<", 
                    RowBox[{"xtoz", " ", "z2in"}], "<", 
                    RowBox[{
                    RowBox[{"0.03`", " ", "z2in"}], "-", 
                    "0.45999999999999996`"}]}], "\[And]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{
                    RowBox[{"0.035`"}], " ", "z2in"}]}], "-", 
                    "0.2300000000000002`"}], "<", 
                    RowBox[{"ytoz", " ", "z2in"}], "<", 
                    RowBox[{
                    RowBox[{"0.035`", " ", "z2in"}], "+", 
                    "0.2300000000000002`"}]}]}], "]"}], ",", 
                    RowBox[{"Boole", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"0.45999999999999996`", "\[VeryThinSpace]"}], "-", 
                    RowBox[{"0.03`", " ", "z3in"}]}], "<", 
                    RowBox[{"xtoz", " ", "z3in"}], "<", 
                    RowBox[{
                    RowBox[{"0.03`", " ", "z3in"}], "-", 
                    "0.45999999999999996`"}]}], "\[And]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{
                    RowBox[{"0.035`"}], " ", "z3in"}]}], "-", 
                    "0.2300000000000002`"}], "<", 
                    RowBox[{"ytoz", " ", "z3in"}], "<", 
                    RowBox[{
                    RowBox[{"0.035`", " ", "z3in"}], "+", 
                    "0.2300000000000002`"}]}]}], "]"}]}], "}"}]}], ";", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    
                    RowBox[{"cond1", "\[LongEqual]", "cond2", "\[LongEqual]", 
                    "cond3", "\[LongEqual]", "0"}], ",", 
                    RowBox[{"zMin", "=", 
                    RowBox[{"zMax", "=", "31.68`"}]}], ",", 
                    RowBox[{"highMin", "=", 
                    RowBox[{"lowMax", "=", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"cond1", "\[LongEqual]", "1"}], ",", 
                    RowBox[{"indexzinside", "-", "1"}], ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"cond2", "\[LongEqual]", "1"}], ",", 
                    "indexzinside", ",", 
                    RowBox[{"indexzinside", "+", "1"}]}], "]"}]}], 
                    "]"}]}]}]}], "]"}], ";", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"condzmin", "\[LongEqual]", "1"}], ",", 
                    RowBox[{"zMin", "=", "32.`"}], ",", 
                    RowBox[{
                    RowBox[{"While", "[", 
                    RowBox[{
                    RowBox[{"lowMin", "<", "highMin"}], ",", 
                    RowBox[{
                    RowBox[{"mid", "=", 
                    TemplateBox[{
                    FractionBox[
                    RowBox[{"highMin", "+", "lowMin"}], "2"]}, "Floor"]}], 
                    ";", 
                    RowBox[{"zval", "=", 
                    RowBox[{"Compile`GetElement", "(", 
                    RowBox[{"zvals", ",", "mid"}], ")"}]}], ";", 
                    RowBox[{"cond", "=", 
                    RowBox[{"Boole", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"0.45999999999999996`", "\[VeryThinSpace]"}], "-", 
                    RowBox[{"0.03`", " ", "zval"}]}], "<", 
                    RowBox[{"xtoz", " ", "zval"}], "<", 
                    RowBox[{
                    RowBox[{"0.03`", " ", "zval"}], "-", 
                    "0.45999999999999996`"}]}], "\[And]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{
                    RowBox[{"0.035`"}], " ", "zval"}]}], "-", 
                    "0.2300000000000002`"}], "<", 
                    RowBox[{"ytoz", " ", "zval"}], "<", 
                    RowBox[{
                    RowBox[{"0.035`", " ", "zval"}], "+", 
                    "0.2300000000000002`"}]}]}], "]"}]}], ";", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"cond", "\[LongEqual]", "1"}], ",", 
                    RowBox[{"highMin", "=", "mid"}], ",", 
                    RowBox[{"lowMin", "=", 
                    RowBox[{"mid", "+", "1"}]}]}], "]"}]}]}], "]"}], ";", 
                    RowBox[{"zMin", "=", 
                    RowBox[{"Compile`GetElement", "(", 
                    RowBox[{"zvals", ",", 
                    RowBox[{"mid", "+", "1"}]}], ")"}]}], ";"}]}], "]"}], ";", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"condzmax", "\[LongEqual]", "1"}], ",", 
                    RowBox[{"zMax", "=", "82.`"}], ",", 
                    RowBox[{
                    RowBox[{"While", "[", 
                    RowBox[{
                    RowBox[{"lowMax", "<", "highMax"}], ",", 
                    RowBox[{
                    RowBox[{"mid", "=", 
                    TemplateBox[{
                    FractionBox[
                    RowBox[{"highMax", "+", "lowMax"}], "2"]}, "Floor"]}], 
                    ";", 
                    RowBox[{"zval", "=", 
                    RowBox[{"Compile`GetElement", "(", 
                    RowBox[{"zvals", ",", "mid"}], ")"}]}], ";", 
                    RowBox[{"cond", "=", 
                    RowBox[{"Boole", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"0.45999999999999996`", "\[VeryThinSpace]"}], "-", 
                    RowBox[{"0.03`", " ", "zval"}]}], "<", 
                    RowBox[{"xtoz", " ", "zval"}], "<", 
                    RowBox[{
                    RowBox[{"0.03`", " ", "zval"}], "-", 
                    "0.45999999999999996`"}]}], "\[And]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{
                    RowBox[{"0.035`"}], " ", "zval"}]}], "-", 
                    "0.2300000000000002`"}], "<", 
                    RowBox[{"ytoz", " ", "zval"}], "<", 
                    RowBox[{
                    RowBox[{"0.035`", " ", "zval"}], "+", 
                    "0.2300000000000002`"}]}]}], "]"}]}], ";", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"cond", "\[LongEqual]", "0"}], ",", 
                    RowBox[{"highMax", "=", "mid"}], ",", 
                    RowBox[{"lowMax", "=", 
                    RowBox[{"mid", "+", "1"}]}]}], "]"}]}]}], "]"}], ";", 
                    RowBox[{"zMax", "=", 
                    RowBox[{"Compile`GetElement", "(", 
                    RowBox[{"zvals", ",", 
                    RowBox[{"lowMax", "-", "1"}]}], ")"}]}], ";"}]}], "]"}], 
                    ";"}]}], "]"}], ";", 
                    RowBox[{"{", 
                    RowBox[{"zMin", ",", "zMax"}], "}"}]}]}], "]"}], 
                    ImageSize -> {{1, 500}, Automatic}, BaselinePosition -> 
                    Baseline, ContentPadding -> False, FrameMargins -> 0, 
                    StripOnInput -> True], "SummaryItem"]}]}}, 
              GridBoxAlignment -> {
               "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
              False, GridBoxItemSize -> {
               "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
              GridBoxSpacings -> {
               "Columns" -> {{2}}, "Rows" -> {{Automatic}}}, 
              BaseStyle -> {
               ShowStringCharacters -> False, NumberMarks -> False, 
                PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
           GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
           AutoDelete -> False, 
           GridBoxItemSize -> {
            "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
           BaselinePosition -> {1, 1}]}, 
        Dynamic[Typeset`open$$], ImageSize -> Automatic]},
      "SummaryPanel"],
     DynamicModuleValues:>{}], "]"}],
   CompiledFunction[{11, 14.1, 5848}, {{
      Blank[Real], 1}, {
      Blank[Real], 1}, 
     Blank[Integer]}, {{3, 1, 0}, {3, 1, 1}, {2, 0, 0}, {3, 1, 
    3}}, {{0, {2, 0, 1}}, {False, {1, 0, 2}}, {
     0.2300000000000002, {3, 0, 26}}, {
     0.5, {3, 0, 9}}, {-0.035, {3, 0, 25}}, {82., {3, 0, 13}}, {
     0., {3, 0, 0}}, {-1, {2, 0, 11}}, {2., {3, 0, 14}}, {-0.5, {3, 0, 7}}, {
     32., {3, 0, 8}}, {-0.45999999999999996`, {3, 0, 21}}, {2, {2, 0, 6}}, {
     1, {2, 0, 3}}, {31.68, {3, 0, 28}}, {
     1.3500000000000003`, {3, 0, 11}}, {-3.1000000000000005`, {3, 0, 
      15}}, {-0.03, {3, 0, 20}}, {
     3, {2, 0, 7}}, {-1.3500000000000003`, {3, 0, 10}}, {0.035, {3, 0, 27}}, {
     3.1000000000000005`, {3, 0, 16}}, {
     0.03, {3, 0, 22}}, {-2., {3, 0, 12}}, {
     0.45999999999999996`, {3, 0, 19}}, {-0.2300000000000002, {3, 0, 24}}}, {
    8, 19, 38, 0, 
    4}, {{6, 1, 5}, {7, 0, 6}, {33, 1, 4}, {7, 0, 5}, {7, 0, 3}, {6, 3, 8}, {
     6, 3, 9}, {33, 1, 2}, {33, 1, 12}, {6, 1, 10}, {6, 1, 13}, {7, 0, 2}, {7,
      0, 1}, {7, 0, 23}, {7, 0, 18}, {7, 0, 4}, {7, 0, 17}, {37, 0, 3, 3, 
     29}, {37, 0, 6, 3, 30}, {37, 0, 7, 3, 31}, {40, 60, 3, 0, 31, 3, 0, 
     32}, {16, 29, 32, 33}, {40, 60, 3, 0, 31, 3, 0, 32}, {16, 30, 32, 34}, {
     16, 8, 33, 32}, {27, 3, 0, 7, 32, 9, 1}, {2, 1, 5}, {16, 8, 34, 32}, {27,
      3, 0, 10, 32, 11, 3}, {5, 3, 0}, {3, 2}, {5, 2, 0}, {9, 0, 14}, {16, 13,
      33, 32}, {27, 3, 0, 12, 32, 14, 0}, {2, 0, 5}, {16, 13, 34, 32}, {27, 3,
      0, 15, 32, 16, 1}, {5, 1, 3}, {3, 2}, {5, 2, 3}, {9, 3, 15}, {15, 14, 
     15, 16}, {24, 16, 3, 3}, {2, 3, 4}, {7, 8, 5}, {7, 13, 3}, {3, 1}, {32, 
     3, 0}, {2, 0, 196}, {6, 0, 13}, {12, 13, 11, 16}, {37, 1, 16, 3, 32}, {
     37, 1, 13, 3, 35}, {12, 13, 3, 16}, {37, 1, 16, 3, 36}, {34, 1, 3, 32, 
     35, 36, 3, 3}, {33, 3, 16}, {24, 16, 7, 1}, {32, 1, 1}, {2, 1, 3}, {
     49}, {3, 1}, {37, 3, 3, 3, 32}, {7, 32, 2}, {37, 3, 6, 3, 32}, {7, 32, 
     1}, {37, 3, 7, 3, 32}, {7, 32, 23}, {16, 20, 2, 32}, {13, 19, 32, 35}, {
     16, 2, 33, 32}, {16, 22, 2, 36}, {13, 21, 36, 37}, {27, 3, 0, 35, 32, 37,
      1}, {2, 1, 9}, {16, 25, 2, 35}, {13, 24, 35, 32}, {16, 2, 34, 35}, {16, 
     27, 2, 37}, {13, 26, 37, 36}, {27, 3, 0, 32, 35, 36, 4}, {5, 4, 6}, {3, 
     2}, {5, 2, 6}, {9, 6, 16}, {16, 20, 1, 32}, {13, 19, 32, 35}, {16, 1, 33,
      32}, {16, 22, 1, 36}, {13, 21, 36, 37}, {27, 3, 0, 35, 32, 37, 6}, {2, 
     6, 9}, {16, 25, 1, 35}, {13, 24, 35, 32}, {16, 1, 34, 35}, {16, 27, 1, 
     37}, {13, 26, 37, 36}, {27, 3, 0, 32, 35, 36, 1}, {5, 1, 4}, {3, 2}, {5, 
     2, 4}, {9, 4, 17}, {16, 20, 23, 32}, {13, 19, 32, 35}, {16, 23, 33, 
     32}, {16, 22, 23, 36}, {13, 21, 36, 37}, {27, 3, 0, 35, 32, 37, 4}, {2, 
     4, 9}, {16, 25, 23, 35}, {13, 24, 35, 32}, {16, 23, 34, 35}, {16, 27, 23,
      37}, {13, 26, 37, 36}, {27, 3, 0, 32, 35, 36, 6}, {5, 6, 1}, {3, 2}, {5,
      2, 1}, {9, 1, 18}, {34, 1, 3, 16, 17, 18, 2, 3}, {33, 3, 16}, {24, 16, 
     7, 1}, {32, 1, 1}, {2, 1, 3}, {49}, {3, 1}, {37, 3, 3, 2, 16}, {10, 16, 
     32}, {7, 32, 18}, {37, 3, 6, 2, 16}, {10, 16, 32}, {7, 32, 4}, {37, 3, 7,
      2, 16}, {10, 16, 32}, {7, 32, 17}, {10, 1, 32}, {27, 5, 0, 18, 4, 17, 
     32, 1}, {2, 1, 4}, {7, 28, 3}, {7, 3, 5}, {3, 17}, {10, 3, 32}, {27, 5, 
     0, 18, 32, 4}, {2, 4, 4}, {12, 13, 11, 16}, {6, 16, 17}, {3, 9}, {10, 3, 
     32}, {27, 5, 0, 4, 32, 6}, {2, 6, 3}, {6, 13, 18}, {3, 3}, {12, 13, 3, 
     17}, {6, 17, 18}, {6, 18, 17}, {6, 17, 9}, {6, 9, 2}, {24, 14, 3, 1}, {2,
      1, 3}, {7, 8, 5}, {3, 40}, {25, 8, 2, 4}, {2, 4, 35}, {12, 8, 2, 17}, {
     10, 6, 32}, {40, 60, 3, 0, 32, 3, 0, 35}, {10, 17, 32}, {16, 32, 35, 
     32}, {40, 50, 3, 0, 32, 2, 0, 17}, {6, 17, 10}, {37, 1, 10, 3, 32}, {7, 
     32, 6}, {16, 20, 6, 32}, {13, 19, 32, 35}, {16, 6, 33, 32}, {16, 22, 6, 
     36}, {13, 21, 36, 37}, {27, 3, 0, 35, 32, 37, 6}, {2, 6, 9}, {16, 25, 6, 
     35}, {13, 24, 35, 32}, {16, 6, 34, 35}, {16, 27, 6, 37}, {13, 26, 37, 
     36}, {27, 3, 0, 32, 35, 36, 7}, {5, 7, 5}, {3, 2}, {5, 2, 5}, {9, 5, 
     17}, {6, 17, 5}, {24, 5, 3, 5}, {2, 5, 3}, {6, 10, 2}, {3, 3}, {12, 10, 
     3, 17}, {6, 17, 8}, {3, -35}, {12, 10, 3, 17}, {37, 1, 17, 3, 32}, {7, 
     32, 5}, {24, 15, 3, 1}, {2, 1, 3}, {7, 13, 3}, {3, 40}, {25, 9, 12, 4}, {
     2, 4, 35}, {12, 9, 12, 17}, {10, 6, 32}, {40, 60, 3, 0, 32, 3, 0, 35}, {
     10, 17, 32}, {16, 32, 35, 32}, {40, 50, 3, 0, 32, 2, 0, 17}, {6, 17, 
     10}, {37, 1, 10, 3, 32}, {7, 32, 6}, {16, 20, 6, 32}, {13, 19, 32, 35}, {
     16, 6, 33, 32}, {16, 22, 6, 36}, {13, 21, 36, 37}, {27, 3, 0, 35, 32, 37,
      5}, {2, 5, 9}, {16, 25, 6, 35}, {13, 24, 35, 32}, {16, 6, 34, 35}, {16, 
     27, 6, 37}, {13, 26, 37, 36}, {27, 3, 0, 32, 35, 36, 6}, {5, 6, 7}, {3, 
     2}, {5, 2, 7}, {9, 7, 17}, {6, 17, 5}, {24, 5, 1, 7}, {2, 7, 3}, {6, 10, 
     12}, {3, 3}, {12, 10, 3, 17}, {6, 17, 9}, {3, -35}, {12, 9, 11, 17}, {37,
      1, 17, 3, 32}, {7, 32, 3}, {3, 1}, {34, 1, 2, 5, 3, 3, 3}, {1}}, 
    Function[{$CellContext`momenta, $CellContext`zvals, \
$CellContext`indexlist}, 
     Module[{$CellContext`px, $CellContext`py, $CellContext`pz, \
$CellContext`cond = 0, $CellContext`zval = 0., $CellContext`lenzval = 
       Length[$CellContext`zvals], $CellContext`zMin = 0., $CellContext`zMax = 
       0., $CellContext`xtoz, $CellContext`ytoz, $CellContext`condzmax, \
$CellContext`condzmin, $CellContext`lowMin = 1, $CellContext`lowMax = 
       1, $CellContext`highMin = 
       Length[$CellContext`zvals], $CellContext`highMax = 
       Length[$CellContext`zvals], $CellContext`mid = 
       0, $CellContext`indexzinside = 0, $CellContext`z1in = 
       0., $CellContext`z2in = 0., $CellContext`z3in = 0., $CellContext`cond1 = 
       0., $CellContext`cond2 = 0., $CellContext`cond3 = 
       0., $CellContext`condfulltrajectory}, $CellContext`px = 
       Compile`GetElement[$CellContext`momenta, 1]; $CellContext`py = 
       Compile`GetElement[$CellContext`momenta, 2]; $CellContext`pz = 
       Compile`GetElement[$CellContext`momenta, 
         3]; $CellContext`xtoz = $CellContext`px/$CellContext`pz; \
$CellContext`ytoz = $CellContext`py/$CellContext`pz; $CellContext`condzmin = 
       Boole[
         And[-0.5 < 32. $CellContext`xtoz < 0.5, -1.3500000000000003` < 
          32. $CellContext`ytoz < 
          1.3500000000000003`]]; $CellContext`condzmax = Boole[
         And[-2. < 82. $CellContext`xtoz < 2., -3.1000000000000005` < 
          82. $CellContext`ytoz < 
          3.1000000000000005`]]; $CellContext`condfulltrajectory = \
$CellContext`condzmin $CellContext`condzmax == 1; 
      If[$CellContext`condfulltrajectory, $CellContext`zMin = 
         32.; $CellContext`zMax = 82.; Null]; If[
        Not[$CellContext`condfulltrajectory], $CellContext`indexzinside = \
$CellContext`indexlist; {$CellContext`z1in, $CellContext`z2in, \
$CellContext`z3in} = {
           
           Compile`GetElement[$CellContext`zvals, $CellContext`indexzinside - 
            1], 
           Compile`GetElement[$CellContext`zvals, $CellContext`indexzinside], 
           
           Compile`GetElement[$CellContext`zvals, $CellContext`indexzinside + 
            1]}; {$CellContext`cond1, $CellContext`cond2, $CellContext`cond3} = {
           Boole[
            And[
            0.45999999999999996` - 
              0.03 $CellContext`z1in < $CellContext`z1in $CellContext`xtoz < \
-0.45999999999999996` + 0.03 $CellContext`z1in, -0.2300000000000002 - 
              0.035 $CellContext`z1in < $CellContext`z1in $CellContext`ytoz < 
             0.2300000000000002 + 0.035 $CellContext`z1in]], 
           Boole[
            And[
            0.45999999999999996` - 
              0.03 $CellContext`z2in < $CellContext`z2in $CellContext`xtoz < \
-0.45999999999999996` + 0.03 $CellContext`z2in, -0.2300000000000002 - 
              0.035 $CellContext`z2in < $CellContext`z2in $CellContext`ytoz < 
             0.2300000000000002 + 0.035 $CellContext`z2in]], 
           Boole[
            And[
            0.45999999999999996` - 
              0.03 $CellContext`z3in < $CellContext`z3in $CellContext`xtoz < \
-0.45999999999999996` + 0.03 $CellContext`z3in, -0.2300000000000002 - 
              0.035 $CellContext`z3in < $CellContext`z3in $CellContext`ytoz < 
             0.2300000000000002 + 0.035 $CellContext`z3in]]}; 
        If[$CellContext`cond1 == $CellContext`cond2 == $CellContext`cond3 == 
          0, $CellContext`zMin = ($CellContext`zMax = 
           31.68), $CellContext`highMin = ($CellContext`lowMax = 
           If[$CellContext`cond1 == 1, $CellContext`indexzinside - 1, 
             
             If[$CellContext`cond2 == 
              1, $CellContext`indexzinside, $CellContext`indexzinside + 1]])]; 
        If[$CellContext`condzmin == 1, $CellContext`zMin = 32., 
          While[$CellContext`lowMin < $CellContext`highMin, $CellContext`mid = 
             Floor[($CellContext`lowMin + $CellContext`highMin)/
               2]; $CellContext`zval = 
             Compile`GetElement[$CellContext`zvals, $CellContext`mid]; \
$CellContext`cond = Boole[
               And[
               0.45999999999999996` - 
                 0.03 $CellContext`zval < $CellContext`zval $CellContext`xtoz < \
-0.45999999999999996` + 0.03 $CellContext`zval, -0.2300000000000002 - 
                 0.035 $CellContext`zval < $CellContext`zval \
$CellContext`ytoz < 0.2300000000000002 + 0.035 $CellContext`zval]]; 
            If[$CellContext`cond == 
              1, $CellContext`highMin = $CellContext`mid, $CellContext`lowMin = \
$CellContext`mid + 1]]; $CellContext`zMin = 
           Compile`GetElement[$CellContext`zvals, $CellContext`mid + 1]; 
          Null]; If[$CellContext`condzmax == 1, $CellContext`zMax = 82., 
          While[$CellContext`lowMax < $CellContext`highMax, $CellContext`mid = 
             Floor[($CellContext`lowMax + $CellContext`highMax)/
               2]; $CellContext`zval = 
             Compile`GetElement[$CellContext`zvals, $CellContext`mid]; \
$CellContext`cond = Boole[
               And[
               0.45999999999999996` - 
                 0.03 $CellContext`zval < $CellContext`zval $CellContext`xtoz < \
-0.45999999999999996` + 0.03 $CellContext`zval, -0.2300000000000002 - 
                 0.035 $CellContext`zval < $CellContext`zval \
$CellContext`ytoz < 0.2300000000000002 + 0.035 $CellContext`zval]]; 
            If[$CellContext`cond == 
              0, $CellContext`highMax = $CellContext`mid, $CellContext`lowMax = \
$CellContext`mid + 1]]; $CellContext`zMax = 
           Compile`GetElement[$CellContext`zvals, $CellContext`lowMax - 1]; 
          Null]; Null]; {$CellContext`zMin, $CellContext`zMax}], Listable], 
    Evaluate, 
    LibraryFunction[
    "C:\\Users\\miksi\\AppData\\Roaming\\Wolfram\\ApplicationData\\\
CCompilerDriver\\BuildFolder\\maksyms_laptop-35604\\compiledFunction33.dll", 
     "compiledFunction33", {{Real, 1, "Constant"}, {Real, 1, "Constant"}, {
      Integer, 0, "Constant"}}, {Real, 1}]],
   Editable->False,
   SelectWithContents->True,
   Selectable->False], TraditionalForm]], "Output",
 CellChangeTimes->{{3.91145474334199*^9, 3.9114547845911865`*^9}, 
   3.911454993765156*^9, 3.91145513775883*^9, 3.9114552183109503`*^9, 
   3.9114552643654757`*^9, 3.9114553099077063`*^9, 3.911455568547777*^9, 
   3.9114563805171995`*^9, 3.9114568792615232`*^9, 3.9114571281764765`*^9, {
   3.9114601794769526`*^9, 3.9114601874425373`*^9}, 3.9114619707073965`*^9, 
   3.9114620494555063`*^9, 3.9114621314435744`*^9, 3.9114632542253523`*^9, {
   3.911463347450334*^9, 3.911463350396001*^9}, 3.9114634015631685`*^9, 
   3.911463496292983*^9, 3.911463665365632*^9, 3.911463702150302*^9, 
   3.911463751603992*^9, {3.9114639331724787`*^9, 3.9114639615626163`*^9}, 
   3.9114640351449823`*^9, 3.9114652369427137`*^9, 3.9114659226909313`*^9, 
   3.911465970868927*^9, {3.911466548237937*^9, 3.911466569527745*^9}, 
   3.9114667438209224`*^9, 3.9114670724210715`*^9, 3.9114671371457043`*^9, 
   3.9114671691963434`*^9, 3.911467622138899*^9, 3.9114676539254894`*^9, {
   3.9114676840664577`*^9, 3.911467706562191*^9}, 3.911471531451127*^9, {
   3.911471603701623*^9, 3.9114716247373724`*^9}, 3.911471709610711*^9, 
   3.911471823522833*^9, 3.9114722396310377`*^9, 3.9114724582311115`*^9, 
   3.9114895425293756`*^9, {3.911489646671748*^9, 3.9114896727612085`*^9}, 
   3.9114897364615965`*^9, 3.9114897679619713`*^9, 3.911490298870763*^9, 
   3.91149394662414*^9, 3.9114956465893884`*^9, 3.9114960686914177`*^9, 
   3.911496129734969*^9, 3.91149624534585*^9, 3.9114963063434706`*^9, 
   3.911496345596057*^9, 3.9114964162623167`*^9, {3.9114967820266542`*^9, 
   3.911496795271021*^9}, 3.9114975420945034`*^9, 3.911497648038204*^9, 
   3.9115350018069396`*^9, {3.9115390098172803`*^9, 3.911539030077101*^9}, 
   3.911544137821062*^9, 3.9115443231488314`*^9, {3.9115461622850056`*^9, 
   3.9115461842245884`*^9}, 3.911547013037345*^9, 3.9115473992587185`*^9, 
   3.9115491129411106`*^9, 3.9115554163768635`*^9, 3.911555466768423*^9, {
   3.9115555109735594`*^9, 3.911555526777586*^9}, {3.9115597039148436`*^9, 
   3.911559727452448*^9}, 3.9115603291480837`*^9, 3.9115606580222516`*^9, 
   3.9116209023139863`*^9, 3.91162093718242*^9, 3.911620970343348*^9, 
   3.9116210058524785`*^9, {3.9116212357352715`*^9, 3.911621252738662*^9}, 
   3.911621739909871*^9, 3.91162178779749*^9, 3.9116220079199324`*^9, {
   3.9116220816772118`*^9, 3.9116221073381653`*^9}, 3.9116221583504696`*^9, 
   3.9116221884118156`*^9, {3.911622534168096*^9, 3.911622558800542*^9}, 
   3.9116268288636403`*^9, 3.911626977888198*^9, 3.911627073775736*^9, 
   3.9116271527252626`*^9, 3.911628171395385*^9, 3.911628325073557*^9, 
   3.9116283841711035`*^9, 3.911628451824483*^9, 3.911628525268447*^9, 
   3.911629651676647*^9, 3.911629706679515*^9, 3.911629840110173*^9, 
   3.9116302478544188`*^9, 3.9116302854009285`*^9, 3.9116360442102623`*^9, 
   3.9116404867939367`*^9, 3.911640606619769*^9, 3.911640895871807*^9, 
   3.911641063417348*^9, 3.9116411123698587`*^9, 3.9116416200271444`*^9, 
   3.9116418194777946`*^9, 3.9116427197766457`*^9, 3.911642765233509*^9, 
   3.911642983761607*^9, 3.911643031670534*^9, 3.911643209781483*^9, 
   3.911643966737159*^9, 3.9116442055829506`*^9, 3.9116445606362123`*^9, 
   3.91164479730468*^9, 3.911644831193672*^9, 3.91164510580863*^9, 
   3.9116451984547524`*^9, 3.9116456312254176`*^9, {3.9116459334930077`*^9, 
   3.9116459556141167`*^9}, 3.9116462261885033`*^9, 3.9116467828667107`*^9, 
   3.911664882010028*^9, 3.911669403923394*^9, 3.911669457153763*^9, {
   3.9116698579339714`*^9, 3.911669887911609*^9}, 3.911726995799249*^9, 
   3.911727062151407*^9, 3.9117995957332973`*^9, 3.911800736688052*^9, 
   3.9118018875600557`*^9, 3.9118020417730236`*^9, 3.9118356530864353`*^9, 
   3.9118357513803864`*^9, 3.9118358603642035`*^9, 3.9118361251060214`*^9, 
   3.911836229926869*^9, {3.911836285718889*^9, 3.911836289948048*^9}, {
   3.9118367890000067`*^9, 3.911836809720401*^9}, {3.911837082187626*^9, 
   3.911837086692898*^9}, 3.9118372821002617`*^9, {3.9118373950265765`*^9, 
   3.911837399157307*^9}, 3.911837500058262*^9, 3.911837916426985*^9, {
   3.9118380100160103`*^9, 3.9118380216881504`*^9}, {3.9118382392167845`*^9, 
   3.911838270353298*^9}, {3.911838310632957*^9, 3.9118383334971843`*^9}, 
   3.9118385672011447`*^9, 3.9118391780723004`*^9, 3.911839289330168*^9, 
   3.911839339321306*^9, 3.9118399077550926`*^9, 3.911840035558896*^9, {
   3.911840514643588*^9, 3.911840533908929*^9}, {3.9118408326400733`*^9, 
   3.9118408383989563`*^9}, 3.9118408983727646`*^9, 3.9118412404326134`*^9, 
   3.911841305182249*^9, 3.9118419630425854`*^9, 3.9118420158713946`*^9, 
   3.9118422700243835`*^9, 3.9118431773893433`*^9, 3.911843274010107*^9, 
   3.9118433802964582`*^9, 3.9118435509940968`*^9, 3.9118436191675344`*^9, {
   3.9118437500291305`*^9, 3.9118437667278585`*^9}, {3.9118438601652803`*^9, 
   3.911843927161518*^9}, 3.911844037420246*^9, {3.9118443372573805`*^9, 
   3.9118443409056587`*^9}, {3.9118443815556297`*^9, 3.911844407797851*^9}, 
   3.911844481376112*^9, 3.9118446419162645`*^9, 3.9118782372531514`*^9, 
   3.9118787749242263`*^9, 3.9118788247500753`*^9, 3.9118790228504715`*^9, {
   3.9118790866043787`*^9, 3.9118791162816515`*^9}, {3.911879157526742*^9, 
   3.9118791961384325`*^9}, 3.9118792527895093`*^9, 3.911879286560768*^9, 
   3.911879628205421*^9, 3.911879853031824*^9, {3.911880265867443*^9, 
   3.9118802730802755`*^9}, 3.9118803117879734`*^9, {3.911880407752562*^9, 
   3.9118804131660657`*^9}, 3.911880454393324*^9, {3.911880490680335*^9, 
   3.911880555325536*^9}, 3.9118806408885326`*^9, {3.911880716004258*^9, 
   3.9118807302809753`*^9}, 3.911880855195461*^9, {3.9118808987852*^9, 
   3.9118809281503096`*^9}, 3.9118812737399864`*^9, 3.91188132304208*^9, 
   3.911881585354257*^9, 3.911881632959221*^9, 3.9118817277996016`*^9, 
   3.911881835155317*^9, 3.911881877528159*^9, 3.9118828801820517`*^9, 
   3.9118830911803064`*^9, 3.9118831320444756`*^9, 3.9118832265426407`*^9, 
   3.9118974746283593`*^9, 3.911897966494974*^9, 3.911898091111656*^9, 
   3.9118981214234595`*^9, 3.911898152083319*^9, 3.9118982344346867`*^9, 
   3.911898279015938*^9, 3.911901996213585*^9, 3.911907390525029*^9, 
   3.9119074233066444`*^9, 3.911907471784422*^9, 3.9119075338278427`*^9, 
   3.9119075654716983`*^9, {3.9176012942712517`*^9, 3.9176013108800545`*^9}, 
   3.917622939670699*^9, 3.917625351774911*^9, 3.917625853107131*^9, 
   3.9176260571077876`*^9, 3.917626308708412*^9, 3.9176270702071133`*^9, 
   3.917627696028404*^9, 3.9176279856044536`*^9, 3.917628294218427*^9, 
   3.9176691123411093`*^9, 3.9176723459465375`*^9, 3.9176798691499863`*^9, 
   3.917680417940675*^9, 3.917681960075745*^9, 3.9177157240333557`*^9, 
   3.9177161569326134`*^9, 3.917721057526918*^9, 3.917771458986998*^9, 
   3.917773054255619*^9, 3.9177735572515035`*^9, 3.9177787802973576`*^9, 
   3.9177864355462446`*^9, 3.9177968520031943`*^9, 3.9177977394229517`*^9, 
   3.9178025119536934`*^9, 3.9178593956630044`*^9, 3.91786082989294*^9, 
   3.9178849000206776`*^9, 3.917887799840485*^9, 3.917953595351371*^9, 
   3.918121740135974*^9, 3.918192022753107*^9, 3.9181943520034547`*^9, 
   3.918197327311358*^9, 3.9182023357191567`*^9, 3.9182045682287827`*^9, 
   3.9182070312306876`*^9, 3.918228751002596*^9, 3.9183206806363487`*^9, 
   3.918371932892395*^9, 3.918372844582159*^9, 3.9183767736805596`*^9, 
   3.918397711774832*^9, 3.918410307151928*^9, 3.9184602630613313`*^9, 
   3.9184608818511467`*^9, 3.9184619209920373`*^9, {3.9184641519425344`*^9, 
   3.9184641648339787`*^9}, 3.9184650101541*^9, 3.918558542826268*^9, 
   3.91857377876164*^9, 3.918575442429981*^9, 3.918575783729145*^9, 
   3.9185763403627615`*^9, 3.918577317209777*^9, 3.9185777496146135`*^9, 
   3.9185793579149647`*^9, 3.9186185758958416`*^9, 3.9186188977237997`*^9, 
   3.918620731960244*^9, 3.918643936482832*^9, 3.9186451768880625`*^9, 
   3.918662124755746*^9, 3.9186647685755415`*^9, 3.918697775662156*^9, 
   3.9189258629626217`*^9, 3.9189263699854507`*^9, 3.918927183580812*^9, 
   3.9189765651969914`*^9, 3.9189767198780746`*^9, 3.918977406883527*^9, 
   3.9189999819722805`*^9, 3.919000724743616*^9, 3.919010775782225*^9, 
   3.9190121200489545`*^9, 3.9190134635950394`*^9, 3.919013982029353*^9, 
   3.919014315868288*^9, 3.919015195211028*^9, 3.919015409940066*^9, 
   3.919015790840151*^9, 3.919016089465935*^9, 3.9190163026203403`*^9, 
   3.9190167192268076`*^9, 3.91904472925984*^9, 3.919062731071312*^9, 
   3.919064273729312*^9, 3.9190665426710677`*^9, 3.919066927959499*^9, 
   3.919067229084193*^9, 3.9190696274788537`*^9, 3.9190816021169996`*^9, 
   3.9194429077479334`*^9, 3.9200502561509647`*^9, 3.9200929575819435`*^9, 
   3.9200957601243696`*^9, 3.920096416907871*^9, 3.9201296489460154`*^9, 
   3.9201810335934343`*^9, 3.920192835676855*^9, 3.9218127292140045`*^9, 
   3.921831950188362*^9, 3.9290955429036317`*^9, 3.929095611053911*^9, 
   3.929095817950506*^9, {3.92911356046829*^9, 3.9291135640599456`*^9}, 
   3.929290945178413*^9, 3.9292915921173415`*^9, 3.9292922084730215`*^9, {
   3.929292426579689*^9, 3.9292924322054944`*^9}, 3.929292816360818*^9, 
   3.929293405160679*^9, {3.931238095299296*^9, 3.9312381064764624`*^9}, {
   3.931247522657231*^9, 3.931247531513449*^9}, 3.9312482152044697`*^9, 
   3.9312486598020697`*^9, 3.9312762797139144`*^9, {3.9382422995668316`*^9, 
   3.9382423090424137`*^9}, 3.938248832955084*^9, 3.9383881484850655`*^9, 
   3.942403655579956*^9, 3.942465231647518*^9, 3.9424692296614532`*^9},
 CellTags->"Re-evaluation",
 CellLabel->
  "Out[178]=",ExpressionUUID->"eb5d1116-6f78-9344-99ad-8ca8aadac77d"],

Cell[BoxData[
 FormBox[
  RowBox[{"{", 
   RowBox[{"0.0083444`", ",", "Null"}], "}"}], TraditionalForm]], "Output",
 CellChangeTimes->{{3.91145474334199*^9, 3.9114547845911865`*^9}, 
   3.911454993765156*^9, 3.91145513775883*^9, 3.9114552183109503`*^9, 
   3.9114552643654757`*^9, 3.9114553099077063`*^9, 3.911455568547777*^9, 
   3.9114563805171995`*^9, 3.9114568792615232`*^9, 3.9114571281764765`*^9, {
   3.9114601794769526`*^9, 3.9114601874425373`*^9}, 3.9114619707073965`*^9, 
   3.9114620494555063`*^9, 3.9114621314435744`*^9, 3.9114632542253523`*^9, {
   3.911463347450334*^9, 3.911463350396001*^9}, 3.9114634015631685`*^9, 
   3.911463496292983*^9, 3.911463665365632*^9, 3.911463702150302*^9, 
   3.911463751603992*^9, {3.9114639331724787`*^9, 3.9114639615626163`*^9}, 
   3.9114640351449823`*^9, 3.9114652369427137`*^9, 3.9114659226909313`*^9, 
   3.911465970868927*^9, {3.911466548237937*^9, 3.911466569527745*^9}, 
   3.9114667438209224`*^9, 3.9114670724210715`*^9, 3.9114671371457043`*^9, 
   3.9114671691963434`*^9, 3.911467622138899*^9, 3.9114676539254894`*^9, {
   3.9114676840664577`*^9, 3.911467706562191*^9}, 3.911471531451127*^9, {
   3.911471603701623*^9, 3.9114716247373724`*^9}, 3.911471709610711*^9, 
   3.911471823522833*^9, 3.9114722396310377`*^9, 3.9114724582311115`*^9, 
   3.9114895425293756`*^9, {3.911489646671748*^9, 3.9114896727612085`*^9}, 
   3.9114897364615965`*^9, 3.9114897679619713`*^9, 3.911490298870763*^9, 
   3.91149394662414*^9, 3.9114956465893884`*^9, 3.9114960686914177`*^9, 
   3.911496129734969*^9, 3.91149624534585*^9, 3.9114963063434706`*^9, 
   3.911496345596057*^9, 3.9114964162623167`*^9, {3.9114967820266542`*^9, 
   3.911496795271021*^9}, 3.9114975420945034`*^9, 3.911497648038204*^9, 
   3.9115350018069396`*^9, {3.9115390098172803`*^9, 3.911539030077101*^9}, 
   3.911544137821062*^9, 3.9115443231488314`*^9, {3.9115461622850056`*^9, 
   3.9115461842245884`*^9}, 3.911547013037345*^9, 3.9115473992587185`*^9, 
   3.9115491129411106`*^9, 3.9115554163768635`*^9, 3.911555466768423*^9, {
   3.9115555109735594`*^9, 3.911555526777586*^9}, {3.9115597039148436`*^9, 
   3.911559727452448*^9}, 3.9115603291480837`*^9, 3.9115606580222516`*^9, 
   3.9116209023139863`*^9, 3.91162093718242*^9, 3.911620970343348*^9, 
   3.9116210058524785`*^9, {3.9116212357352715`*^9, 3.911621252738662*^9}, 
   3.911621739909871*^9, 3.91162178779749*^9, 3.9116220079199324`*^9, {
   3.9116220816772118`*^9, 3.9116221073381653`*^9}, 3.9116221583504696`*^9, 
   3.9116221884118156`*^9, {3.911622534168096*^9, 3.911622558800542*^9}, 
   3.9116268288636403`*^9, 3.911626977888198*^9, 3.911627073775736*^9, 
   3.9116271527252626`*^9, 3.911628171395385*^9, 3.911628325073557*^9, 
   3.9116283841711035`*^9, 3.911628451824483*^9, 3.911628525268447*^9, 
   3.911629651676647*^9, 3.911629706679515*^9, 3.911629840110173*^9, 
   3.9116302478544188`*^9, 3.9116302854009285`*^9, 3.9116360442102623`*^9, 
   3.9116404867939367`*^9, 3.911640606619769*^9, 3.911640895871807*^9, 
   3.911641063417348*^9, 3.9116411123698587`*^9, 3.9116416200271444`*^9, 
   3.9116418194777946`*^9, 3.9116427197766457`*^9, 3.911642765233509*^9, 
   3.911642983761607*^9, 3.911643031670534*^9, 3.911643209781483*^9, 
   3.911643966737159*^9, 3.9116442055829506`*^9, 3.9116445606362123`*^9, 
   3.91164479730468*^9, 3.911644831193672*^9, 3.91164510580863*^9, 
   3.9116451984547524`*^9, 3.9116456312254176`*^9, {3.9116459334930077`*^9, 
   3.9116459556141167`*^9}, 3.9116462261885033`*^9, 3.9116467828667107`*^9, 
   3.911664882010028*^9, 3.911669403923394*^9, 3.911669457153763*^9, {
   3.9116698579339714`*^9, 3.911669887911609*^9}, 3.911726995799249*^9, 
   3.911727062151407*^9, 3.9117995957332973`*^9, 3.911800736688052*^9, 
   3.9118018875600557`*^9, 3.9118020417730236`*^9, 3.9118356530864353`*^9, 
   3.9118357513803864`*^9, 3.9118358603642035`*^9, 3.9118361251060214`*^9, 
   3.911836229926869*^9, {3.911836285718889*^9, 3.911836289948048*^9}, {
   3.9118367890000067`*^9, 3.911836809720401*^9}, {3.911837082187626*^9, 
   3.911837086692898*^9}, 3.9118372821002617`*^9, {3.9118373950265765`*^9, 
   3.911837399157307*^9}, 3.911837500058262*^9, 3.911837916426985*^9, {
   3.9118380100160103`*^9, 3.9118380216881504`*^9}, {3.9118382392167845`*^9, 
   3.911838270353298*^9}, {3.911838310632957*^9, 3.9118383334971843`*^9}, 
   3.9118385672011447`*^9, 3.9118391780723004`*^9, 3.911839289330168*^9, 
   3.911839339321306*^9, 3.9118399077550926`*^9, 3.911840035558896*^9, {
   3.911840514643588*^9, 3.911840533908929*^9}, {3.9118408326400733`*^9, 
   3.9118408383989563`*^9}, 3.9118408983727646`*^9, 3.9118412404326134`*^9, 
   3.911841305182249*^9, 3.9118419630425854`*^9, 3.9118420158713946`*^9, 
   3.9118422700243835`*^9, 3.9118431773893433`*^9, 3.911843274010107*^9, 
   3.9118433802964582`*^9, 3.9118435509940968`*^9, 3.9118436191675344`*^9, {
   3.9118437500291305`*^9, 3.9118437667278585`*^9}, {3.9118438601652803`*^9, 
   3.911843927161518*^9}, 3.911844037420246*^9, {3.9118443372573805`*^9, 
   3.9118443409056587`*^9}, {3.9118443815556297`*^9, 3.911844407797851*^9}, 
   3.911844481376112*^9, 3.9118446419162645`*^9, 3.9118782372531514`*^9, 
   3.9118787749242263`*^9, 3.9118788247500753`*^9, 3.9118790228504715`*^9, {
   3.9118790866043787`*^9, 3.9118791162816515`*^9}, {3.911879157526742*^9, 
   3.9118791961384325`*^9}, 3.9118792527895093`*^9, 3.911879286560768*^9, 
   3.911879628205421*^9, 3.911879853031824*^9, {3.911880265867443*^9, 
   3.9118802730802755`*^9}, 3.9118803117879734`*^9, {3.911880407752562*^9, 
   3.9118804131660657`*^9}, 3.911880454393324*^9, {3.911880490680335*^9, 
   3.911880555325536*^9}, 3.9118806408885326`*^9, {3.911880716004258*^9, 
   3.9118807302809753`*^9}, 3.911880855195461*^9, {3.9118808987852*^9, 
   3.9118809281503096`*^9}, 3.9118812737399864`*^9, 3.91188132304208*^9, 
   3.911881585354257*^9, 3.911881632959221*^9, 3.9118817277996016`*^9, 
   3.911881835155317*^9, 3.911881877528159*^9, 3.9118828801820517`*^9, 
   3.9118830911803064`*^9, 3.9118831320444756`*^9, 3.9118832265426407`*^9, 
   3.9118974746283593`*^9, 3.911897966494974*^9, 3.911898091111656*^9, 
   3.9118981214234595`*^9, 3.911898152083319*^9, 3.9118982344346867`*^9, 
   3.911898279015938*^9, 3.911901996213585*^9, 3.911907390525029*^9, 
   3.9119074233066444`*^9, 3.911907471784422*^9, 3.9119075338278427`*^9, 
   3.9119075654716983`*^9, {3.9176012942712517`*^9, 3.9176013108800545`*^9}, 
   3.917622939670699*^9, 3.917625351774911*^9, 3.917625853107131*^9, 
   3.9176260571077876`*^9, 3.917626308708412*^9, 3.9176270702071133`*^9, 
   3.917627696028404*^9, 3.9176279856044536`*^9, 3.917628294218427*^9, 
   3.9176691123411093`*^9, 3.9176723459465375`*^9, 3.9176798691499863`*^9, 
   3.917680417940675*^9, 3.917681960075745*^9, 3.9177157240333557`*^9, 
   3.9177161569326134`*^9, 3.917721057526918*^9, 3.917771458986998*^9, 
   3.917773054255619*^9, 3.9177735572515035`*^9, 3.9177787802973576`*^9, 
   3.9177864355462446`*^9, 3.9177968520031943`*^9, 3.9177977394229517`*^9, 
   3.9178025119536934`*^9, 3.9178593956630044`*^9, 3.91786082989294*^9, 
   3.9178849000206776`*^9, 3.917887799840485*^9, 3.917953595351371*^9, 
   3.918121740135974*^9, 3.918192022753107*^9, 3.9181943520034547`*^9, 
   3.918197327311358*^9, 3.9182023357191567`*^9, 3.9182045682287827`*^9, 
   3.9182070312306876`*^9, 3.918228751002596*^9, 3.9183206806363487`*^9, 
   3.918371932892395*^9, 3.918372844582159*^9, 3.9183767736805596`*^9, 
   3.918397711774832*^9, 3.918410307151928*^9, 3.9184602630613313`*^9, 
   3.9184608818511467`*^9, 3.9184619209920373`*^9, {3.9184641519425344`*^9, 
   3.9184641648339787`*^9}, 3.9184650101541*^9, 3.918558542826268*^9, 
   3.91857377876164*^9, 3.918575442429981*^9, 3.918575783729145*^9, 
   3.9185763403627615`*^9, 3.918577317209777*^9, 3.9185777496146135`*^9, 
   3.9185793579149647`*^9, 3.9186185758958416`*^9, 3.9186188977237997`*^9, 
   3.918620731960244*^9, 3.918643936482832*^9, 3.9186451768880625`*^9, 
   3.918662124755746*^9, 3.9186647685755415`*^9, 3.918697775662156*^9, 
   3.9189258629626217`*^9, 3.9189263699854507`*^9, 3.918927183580812*^9, 
   3.9189765651969914`*^9, 3.9189767198780746`*^9, 3.918977406883527*^9, 
   3.9189999819722805`*^9, 3.919000724743616*^9, 3.919010775782225*^9, 
   3.9190121200489545`*^9, 3.9190134635950394`*^9, 3.919013982029353*^9, 
   3.919014315868288*^9, 3.919015195211028*^9, 3.919015409940066*^9, 
   3.919015790840151*^9, 3.919016089465935*^9, 3.9190163026203403`*^9, 
   3.9190167192268076`*^9, 3.91904472925984*^9, 3.919062731071312*^9, 
   3.919064273729312*^9, 3.9190665426710677`*^9, 3.919066927959499*^9, 
   3.919067229084193*^9, 3.9190696274788537`*^9, 3.9190816021169996`*^9, 
   3.9194429077479334`*^9, 3.9200502561509647`*^9, 3.9200929575819435`*^9, 
   3.9200957601243696`*^9, 3.920096416907871*^9, 3.9201296489460154`*^9, 
   3.9201810335934343`*^9, 3.920192835676855*^9, 3.9218127292140045`*^9, 
   3.921831950188362*^9, 3.9290955429036317`*^9, 3.929095611053911*^9, 
   3.929095817950506*^9, {3.92911356046829*^9, 3.9291135640599456`*^9}, 
   3.929290945178413*^9, 3.9292915921173415`*^9, 3.9292922084730215`*^9, {
   3.929292426579689*^9, 3.9292924322054944`*^9}, 3.929292816360818*^9, 
   3.929293405160679*^9, {3.931238095299296*^9, 3.9312381064764624`*^9}, {
   3.931247522657231*^9, 3.931247531513449*^9}, 3.9312482152044697`*^9, 
   3.9312486598020697`*^9, 3.9312762797139144`*^9, {3.9382422995668316`*^9, 
   3.9382423090424137`*^9}, 3.938248832955084*^9, 3.9383881484850655`*^9, 
   3.942403655579956*^9, 3.942465231647518*^9, 3.9424692296812973`*^9},
 CellTags->"Re-evaluation",
 CellLabel->
  "Out[181]=",ExpressionUUID->"4d3c577a-775a-1b4a-ac4a-7beafbe7bbdf"],

Cell[BoxData[
 FormBox[
  RowBox[{"{", 
   RowBox[{"0.008747040709820908`", ",", "50.`"}], "}"}], 
  TraditionalForm]], "Output",
 CellChangeTimes->{{3.91145474334199*^9, 3.9114547845911865`*^9}, 
   3.911454993765156*^9, 3.91145513775883*^9, 3.9114552183109503`*^9, 
   3.9114552643654757`*^9, 3.9114553099077063`*^9, 3.911455568547777*^9, 
   3.9114563805171995`*^9, 3.9114568792615232`*^9, 3.9114571281764765`*^9, {
   3.9114601794769526`*^9, 3.9114601874425373`*^9}, 3.9114619707073965`*^9, 
   3.9114620494555063`*^9, 3.9114621314435744`*^9, 3.9114632542253523`*^9, {
   3.911463347450334*^9, 3.911463350396001*^9}, 3.9114634015631685`*^9, 
   3.911463496292983*^9, 3.911463665365632*^9, 3.911463702150302*^9, 
   3.911463751603992*^9, {3.9114639331724787`*^9, 3.9114639615626163`*^9}, 
   3.9114640351449823`*^9, 3.9114652369427137`*^9, 3.9114659226909313`*^9, 
   3.911465970868927*^9, {3.911466548237937*^9, 3.911466569527745*^9}, 
   3.9114667438209224`*^9, 3.9114670724210715`*^9, 3.9114671371457043`*^9, 
   3.9114671691963434`*^9, 3.911467622138899*^9, 3.9114676539254894`*^9, {
   3.9114676840664577`*^9, 3.911467706562191*^9}, 3.911471531451127*^9, {
   3.911471603701623*^9, 3.9114716247373724`*^9}, 3.911471709610711*^9, 
   3.911471823522833*^9, 3.9114722396310377`*^9, 3.9114724582311115`*^9, 
   3.9114895425293756`*^9, {3.911489646671748*^9, 3.9114896727612085`*^9}, 
   3.9114897364615965`*^9, 3.9114897679619713`*^9, 3.911490298870763*^9, 
   3.91149394662414*^9, 3.9114956465893884`*^9, 3.9114960686914177`*^9, 
   3.911496129734969*^9, 3.91149624534585*^9, 3.9114963063434706`*^9, 
   3.911496345596057*^9, 3.9114964162623167`*^9, {3.9114967820266542`*^9, 
   3.911496795271021*^9}, 3.9114975420945034`*^9, 3.911497648038204*^9, 
   3.9115350018069396`*^9, {3.9115390098172803`*^9, 3.911539030077101*^9}, 
   3.911544137821062*^9, 3.9115443231488314`*^9, {3.9115461622850056`*^9, 
   3.9115461842245884`*^9}, 3.911547013037345*^9, 3.9115473992587185`*^9, 
   3.9115491129411106`*^9, 3.9115554163768635`*^9, 3.911555466768423*^9, {
   3.9115555109735594`*^9, 3.911555526777586*^9}, {3.9115597039148436`*^9, 
   3.911559727452448*^9}, 3.9115603291480837`*^9, 3.9115606580222516`*^9, 
   3.9116209023139863`*^9, 3.91162093718242*^9, 3.911620970343348*^9, 
   3.9116210058524785`*^9, {3.9116212357352715`*^9, 3.911621252738662*^9}, 
   3.911621739909871*^9, 3.91162178779749*^9, 3.9116220079199324`*^9, {
   3.9116220816772118`*^9, 3.9116221073381653`*^9}, 3.9116221583504696`*^9, 
   3.9116221884118156`*^9, {3.911622534168096*^9, 3.911622558800542*^9}, 
   3.9116268288636403`*^9, 3.911626977888198*^9, 3.911627073775736*^9, 
   3.9116271527252626`*^9, 3.911628171395385*^9, 3.911628325073557*^9, 
   3.9116283841711035`*^9, 3.911628451824483*^9, 3.911628525268447*^9, 
   3.911629651676647*^9, 3.911629706679515*^9, 3.911629840110173*^9, 
   3.9116302478544188`*^9, 3.9116302854009285`*^9, 3.9116360442102623`*^9, 
   3.9116404867939367`*^9, 3.911640606619769*^9, 3.911640895871807*^9, 
   3.911641063417348*^9, 3.9116411123698587`*^9, 3.9116416200271444`*^9, 
   3.9116418194777946`*^9, 3.9116427197766457`*^9, 3.911642765233509*^9, 
   3.911642983761607*^9, 3.911643031670534*^9, 3.911643209781483*^9, 
   3.911643966737159*^9, 3.9116442055829506`*^9, 3.9116445606362123`*^9, 
   3.91164479730468*^9, 3.911644831193672*^9, 3.91164510580863*^9, 
   3.9116451984547524`*^9, 3.9116456312254176`*^9, {3.9116459334930077`*^9, 
   3.9116459556141167`*^9}, 3.9116462261885033`*^9, 3.9116467828667107`*^9, 
   3.911664882010028*^9, 3.911669403923394*^9, 3.911669457153763*^9, {
   3.9116698579339714`*^9, 3.911669887911609*^9}, 3.911726995799249*^9, 
   3.911727062151407*^9, 3.9117995957332973`*^9, 3.911800736688052*^9, 
   3.9118018875600557`*^9, 3.9118020417730236`*^9, 3.9118356530864353`*^9, 
   3.9118357513803864`*^9, 3.9118358603642035`*^9, 3.9118361251060214`*^9, 
   3.911836229926869*^9, {3.911836285718889*^9, 3.911836289948048*^9}, {
   3.9118367890000067`*^9, 3.911836809720401*^9}, {3.911837082187626*^9, 
   3.911837086692898*^9}, 3.9118372821002617`*^9, {3.9118373950265765`*^9, 
   3.911837399157307*^9}, 3.911837500058262*^9, 3.911837916426985*^9, {
   3.9118380100160103`*^9, 3.9118380216881504`*^9}, {3.9118382392167845`*^9, 
   3.911838270353298*^9}, {3.911838310632957*^9, 3.9118383334971843`*^9}, 
   3.9118385672011447`*^9, 3.9118391780723004`*^9, 3.911839289330168*^9, 
   3.911839339321306*^9, 3.9118399077550926`*^9, 3.911840035558896*^9, {
   3.911840514643588*^9, 3.911840533908929*^9}, {3.9118408326400733`*^9, 
   3.9118408383989563`*^9}, 3.9118408983727646`*^9, 3.9118412404326134`*^9, 
   3.911841305182249*^9, 3.9118419630425854`*^9, 3.9118420158713946`*^9, 
   3.9118422700243835`*^9, 3.9118431773893433`*^9, 3.911843274010107*^9, 
   3.9118433802964582`*^9, 3.9118435509940968`*^9, 3.9118436191675344`*^9, {
   3.9118437500291305`*^9, 3.9118437667278585`*^9}, {3.9118438601652803`*^9, 
   3.911843927161518*^9}, 3.911844037420246*^9, {3.9118443372573805`*^9, 
   3.9118443409056587`*^9}, {3.9118443815556297`*^9, 3.911844407797851*^9}, 
   3.911844481376112*^9, 3.9118446419162645`*^9, 3.9118782372531514`*^9, 
   3.9118787749242263`*^9, 3.9118788247500753`*^9, 3.9118790228504715`*^9, {
   3.9118790866043787`*^9, 3.9118791162816515`*^9}, {3.911879157526742*^9, 
   3.9118791961384325`*^9}, 3.9118792527895093`*^9, 3.911879286560768*^9, 
   3.911879628205421*^9, 3.911879853031824*^9, {3.911880265867443*^9, 
   3.9118802730802755`*^9}, 3.9118803117879734`*^9, {3.911880407752562*^9, 
   3.9118804131660657`*^9}, 3.911880454393324*^9, {3.911880490680335*^9, 
   3.911880555325536*^9}, 3.9118806408885326`*^9, {3.911880716004258*^9, 
   3.9118807302809753`*^9}, 3.911880855195461*^9, {3.9118808987852*^9, 
   3.9118809281503096`*^9}, 3.9118812737399864`*^9, 3.91188132304208*^9, 
   3.911881585354257*^9, 3.911881632959221*^9, 3.9118817277996016`*^9, 
   3.911881835155317*^9, 3.911881877528159*^9, 3.9118828801820517`*^9, 
   3.9118830911803064`*^9, 3.9118831320444756`*^9, 3.9118832265426407`*^9, 
   3.9118974746283593`*^9, 3.911897966494974*^9, 3.911898091111656*^9, 
   3.9118981214234595`*^9, 3.911898152083319*^9, 3.9118982344346867`*^9, 
   3.911898279015938*^9, 3.911901996213585*^9, 3.911907390525029*^9, 
   3.9119074233066444`*^9, 3.911907471784422*^9, 3.9119075338278427`*^9, 
   3.9119075654716983`*^9, {3.9176012942712517`*^9, 3.9176013108800545`*^9}, 
   3.917622939670699*^9, 3.917625351774911*^9, 3.917625853107131*^9, 
   3.9176260571077876`*^9, 3.917626308708412*^9, 3.9176270702071133`*^9, 
   3.917627696028404*^9, 3.9176279856044536`*^9, 3.917628294218427*^9, 
   3.9176691123411093`*^9, 3.9176723459465375`*^9, 3.9176798691499863`*^9, 
   3.917680417940675*^9, 3.917681960075745*^9, 3.9177157240333557`*^9, 
   3.9177161569326134`*^9, 3.917721057526918*^9, 3.917771458986998*^9, 
   3.917773054255619*^9, 3.9177735572515035`*^9, 3.9177787802973576`*^9, 
   3.9177864355462446`*^9, 3.9177968520031943`*^9, 3.9177977394229517`*^9, 
   3.9178025119536934`*^9, 3.9178593956630044`*^9, 3.91786082989294*^9, 
   3.9178849000206776`*^9, 3.917887799840485*^9, 3.917953595351371*^9, 
   3.918121740135974*^9, 3.918192022753107*^9, 3.9181943520034547`*^9, 
   3.918197327311358*^9, 3.9182023357191567`*^9, 3.9182045682287827`*^9, 
   3.9182070312306876`*^9, 3.918228751002596*^9, 3.9183206806363487`*^9, 
   3.918371932892395*^9, 3.918372844582159*^9, 3.9183767736805596`*^9, 
   3.918397711774832*^9, 3.918410307151928*^9, 3.9184602630613313`*^9, 
   3.9184608818511467`*^9, 3.9184619209920373`*^9, {3.9184641519425344`*^9, 
   3.9184641648339787`*^9}, 3.9184650101541*^9, 3.918558542826268*^9, 
   3.91857377876164*^9, 3.918575442429981*^9, 3.918575783729145*^9, 
   3.9185763403627615`*^9, 3.918577317209777*^9, 3.9185777496146135`*^9, 
   3.9185793579149647`*^9, 3.9186185758958416`*^9, 3.9186188977237997`*^9, 
   3.918620731960244*^9, 3.918643936482832*^9, 3.9186451768880625`*^9, 
   3.918662124755746*^9, 3.9186647685755415`*^9, 3.918697775662156*^9, 
   3.9189258629626217`*^9, 3.9189263699854507`*^9, 3.918927183580812*^9, 
   3.9189765651969914`*^9, 3.9189767198780746`*^9, 3.918977406883527*^9, 
   3.9189999819722805`*^9, 3.919000724743616*^9, 3.919010775782225*^9, 
   3.9190121200489545`*^9, 3.9190134635950394`*^9, 3.919013982029353*^9, 
   3.919014315868288*^9, 3.919015195211028*^9, 3.919015409940066*^9, 
   3.919015790840151*^9, 3.919016089465935*^9, 3.9190163026203403`*^9, 
   3.9190167192268076`*^9, 3.91904472925984*^9, 3.919062731071312*^9, 
   3.919064273729312*^9, 3.9190665426710677`*^9, 3.919066927959499*^9, 
   3.919067229084193*^9, 3.9190696274788537`*^9, 3.9190816021169996`*^9, 
   3.9194429077479334`*^9, 3.9200502561509647`*^9, 3.9200929575819435`*^9, 
   3.9200957601243696`*^9, 3.920096416907871*^9, 3.9201296489460154`*^9, 
   3.9201810335934343`*^9, 3.920192835676855*^9, 3.9218127292140045`*^9, 
   3.921831950188362*^9, 3.9290955429036317`*^9, 3.929095611053911*^9, 
   3.929095817950506*^9, {3.92911356046829*^9, 3.9291135640599456`*^9}, 
   3.929290945178413*^9, 3.9292915921173415`*^9, 3.9292922084730215`*^9, {
   3.929292426579689*^9, 3.9292924322054944`*^9}, 3.929292816360818*^9, 
   3.929293405160679*^9, {3.931238095299296*^9, 3.9312381064764624`*^9}, {
   3.931247522657231*^9, 3.931247531513449*^9}, 3.9312482152044697`*^9, 
   3.9312486598020697`*^9, 3.9312762797139144`*^9, {3.9382422995668316`*^9, 
   3.9382423090424137`*^9}, 3.938248832955084*^9, 3.9383881484850655`*^9, 
   3.942403655579956*^9, 3.942465231647518*^9, 3.9424692296874447`*^9},
 CellTags->"Re-evaluation",
 CellLabel->
  "Out[182]=",ExpressionUUID->"05fd896f-9fd8-754d-a441-45e21e7ca92b"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Test", "Subsection",
 CellChangeTimes->{{3.9424669060129776`*^9, 
  3.9424669065254955`*^9}},ExpressionUUID->"ba169508-5970-7d4c-9483-\
44400c1e3d17"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"testzminmax", "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"testzminmax", "==", "1"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"tttt", "=", 
     RowBox[{"zminmaxVals", "[", 
      RowBox[{"momenta", ",", "zvals", ",", "indexlist"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"datajoined", "=", 
     RowBox[{"Join", "[", 
      RowBox[{"momenta", ",", "tttt", ",", "2"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"selectorcomp", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"Hold", "@", 
        RowBox[{"Compile", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"datajoined", ",", "_Real", ",", "2"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"fraction1", ",", "_Real"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"fraction2", ",", "_Real"}], "}"}]}], "}"}], ",", 
          RowBox[{"Select", "[", 
           RowBox[{"datajoined", ",", 
            RowBox[{
             RowBox[{
              RowBox[{"fraction1", 
               RowBox[{"(", 
                RowBox[{"zDecVolMax", "-", "zDecVolMin"}], ")"}]}], "<=", 
              RowBox[{
               RowBox[{"#", "[", 
                RowBox[{"[", 
                 RowBox[{"-", "1"}], "]"}], "]"}], "-", 
               RowBox[{"#", "[", 
                RowBox[{"[", 
                 RowBox[{"-", "2"}], "]"}], "]"}]}], "<=", 
              RowBox[{"fraction2", 
               RowBox[{"(", 
                RowBox[{"zDecVolMax", "-", "zDecVolMin"}], ")"}]}]}], "&"}]}],
            "]"}], ",", 
          RowBox[{"CompilationTarget", "->", "\"\<MVM\>\""}], ",", 
          RowBox[{"RuntimeOptions", "->", "\"\<Speed\>\""}]}], "]"}]}], "/.", 
       RowBox[{"ruleOwn", "[", 
        RowBox[{"{", 
         RowBox[{"zDecVolMax", ",", "zDecVolMin"}], "}"}], "]"}]}], "//", 
      "ReleaseHold"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"datajoined1", "=", 
     RowBox[{"selectorcomp", "[", 
      RowBox[{"datajoined", ",", "0.", ",", "0.9"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"Step", " ", "3"}], ":", 
      RowBox[{
      "Proceed", " ", "only", " ", "if", " ", "there", " ", "are", " ", 
       "selected", " ", "data", " ", "points"}]}], "*)"}], 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Length", "[", "datajoined1", "]"}], "!=", "0"}], ",", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Step", " ", "4"}], ":", 
        RowBox[{
        "Take", " ", "the", " ", "first", " ", "100", " ", "data", " ", 
         "points", " ", "or", " ", "fewer", " ", "if", " ", "not", " ", 
         "available"}]}], "*)"}], 
      RowBox[{
       RowBox[{"momentumData", "=", 
        RowBox[{"Take", "[", 
         RowBox[{"datajoined1", ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", 
            RowBox[{"Min", "[", 
             RowBox[{"100", ",", 
              RowBox[{"Length", "[", "datajoined1", "]"}]}], "]"}]}], "}"}]}],
          "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Step", " ", "5"}], ":", 
         RowBox[{"Ensure", " ", "that", " ", "pz", " ", 
          RowBox[{"(", 
           RowBox[{"#", "[", 
            RowBox[{"[", "3", "]"}], "]"}], ")"}], " ", "is", " ", "not", " ",
           "zero", " ", "to", " ", "avoid", " ", "division", " ", "by", " ", 
          "zero"}]}], "*)"}], 
       RowBox[{"momentumData", "=", 
        RowBox[{"Select", "[", 
         RowBox[{"momentumData", ",", 
          RowBox[{
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "3", "]"}], "]"}], "!=", "0"}], "&"}]}], "]"}]}], ";",
        "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Step", " ", "6"}], ":", 
         RowBox[{
         "Compute", " ", "the", " ", "transformed", " ", "points", " ", "for",
           " ", "red", " ", "arrows"}]}], "*)"}], 
       RowBox[{"(*", 
        RowBox[{"Each", " ", "transformed", " ", "point", " ", "is", " ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"82", "*", 
            RowBox[{"px", "/", "pz"}]}], ",", 
           RowBox[{"82", "*", 
            RowBox[{"py", "/", "pz"}]}], ",", "82"}], "}"}]}], "*)"}], 
       RowBox[{"transformedPoints", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"82", " ", 
             RowBox[{
              RowBox[{"#", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "/", 
              RowBox[{"#", "[", 
               RowBox[{"[", "3", "]"}], "]"}]}]}], ",", 
            RowBox[{"82", " ", 
             RowBox[{
              RowBox[{"#", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "/", 
              RowBox[{"#", "[", 
               RowBox[{"[", "3", "]"}], "]"}]}]}], ",", "82"}], "}"}], "&"}], 
         "/@", "momentumData"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Step", " ", "7"}], ":", 
         RowBox[{
         "Create", " ", "red", " ", "arrows", " ", "from", " ", "the", " ", 
          "origin", " ", "to", " ", "each", " ", "transformed", " ", 
          "point"}]}], "*)"}], 
       RowBox[{"styledArrows", "=", 
        RowBox[{"{", 
         RowBox[{"Red", ",", 
          RowBox[{"(*", 
           RowBox[{"Arrow", " ", "color"}], "*)"}], 
          RowBox[{"Opacity", "[", "0.6", "]"}], ",", 
          RowBox[{"(*", 
           RowBox[{"Arrow", " ", "opacity"}], "*)"}], 
          RowBox[{"Arrowheads", "[", "0.005", "]"}], ",", 
          RowBox[{"(*", 
           RowBox[{"Arrowhead", " ", "size"}], "*)"}], 
          RowBox[{
           RowBox[{
            RowBox[{"Arrow", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", "#"}], "}"}], 
             "]"}], "&"}], "/@", "transformedPoints"}]}], "  ", 
         RowBox[{"(*", 
          RowBox[{"Arrow", " ", "definitions"}], "*)"}], "}"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Step", " ", "8"}], ":", 
         RowBox[{
         "Compute", " ", "the", " ", "start", " ", "and", " ", "end", " ", 
          "points", " ", "for", " ", "blue", " ", "segments"}]}], "*)"}], 
       RowBox[{"(*", 
        RowBox[{"Start", " ", 
         RowBox[{"Point", ":", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"z_min", "*", 
              RowBox[{"px", "/", "pz"}]}], ",", 
             RowBox[{"z_min", "*", 
              RowBox[{"py", "/", "pz"}]}], ",", "z_min"}], "}"}], " ", "End", 
           " ", "Point"}], ":", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"z_max", "*", 
             RowBox[{"px", "/", "pz"}]}], ",", 
            RowBox[{"z_max", "*", 
             RowBox[{"py", "/", "pz"}]}], ",", "z_max"}], "}"}]}]}], "*)"}], 
       RowBox[{"blueSegmentPointsStart", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", 
               RowBox[{"-", "2"}], "]"}], "]"}], "*", " ", 
             RowBox[{
              RowBox[{"#", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "/", 
              RowBox[{"#", "[", 
               RowBox[{"[", "3", "]"}], "]"}]}]}], ",", 
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", 
               RowBox[{"-", "2"}], "]"}], "]"}], "*", " ", 
             RowBox[{
              RowBox[{"#", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "/", 
              RowBox[{"#", "[", 
               RowBox[{"[", "3", "]"}], "]"}]}]}], ",", 
            RowBox[{"#", "[", 
             RowBox[{"[", 
              RowBox[{"-", "2"}], "]"}], "]"}]}], "}"}], "&"}], "/@", 
         "momentumData"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"blueSegmentPointsEnd", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", 
               RowBox[{"-", "1"}], "]"}], "]"}], " ", "*", 
             RowBox[{
              RowBox[{"#", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "/", 
              RowBox[{"#", "[", 
               RowBox[{"[", "3", "]"}], "]"}]}]}], ",", 
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", 
               RowBox[{"-", "1"}], "]"}], "]"}], "*", " ", 
             RowBox[{
              RowBox[{"#", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "/", 
              RowBox[{"#", "[", 
               RowBox[{"[", "3", "]"}], "]"}]}]}], ",", 
            RowBox[{"#", "[", 
             RowBox[{"[", 
              RowBox[{"-", "1"}], "]"}], "]"}]}], "}"}], "&"}], "/@", 
         "momentumData"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Step", " ", "9"}], ":", 
         RowBox[{
         "Create", " ", "blue", " ", "line", " ", "segments", " ", "between", 
          " ", "z_min", " ", "and", " ", "z_max", " ", "points"}]}], "*)"}], 
       RowBox[{"blueSegments", "=", 
        RowBox[{"Line", "/@", 
         RowBox[{"Transpose", "[", 
          RowBox[{"{", 
           RowBox[{"blueSegmentPointsStart", ",", "blueSegmentPointsEnd"}], 
           "}"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Step", " ", "10"}], ":", 
         RowBox[{"Style", " ", "the", " ", "blue", " ", "segments"}]}], 
        "*)"}], 
       RowBox[{"styledBlueSegments", "=", 
        RowBox[{"{", 
         RowBox[{"Blue", ",", 
          RowBox[{"(*", 
           RowBox[{"Segment", " ", "color"}], "*)"}], 
          RowBox[{"Thickness", "[", "0.005", "]"}], ",", 
          RowBox[{"(*", 
           RowBox[{"Segment", " ", "thickness"}], "*)"}], "blueSegments"}], 
         "            ", 
         RowBox[{"(*", 
          RowBox[{"Segment", " ", "definitions"}], "*)"}], "}"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Step", " ", "11"}], ":", 
         RowBox[{
         "Create", " ", "Graphics3D", " ", "objects", " ", "for", " ", "both",
           " ", "red", " ", "arrows", " ", "and", " ", "blue", " ", 
          "segments"}]}], "*)"}], 
       RowBox[{"vectorsGraphics", "=", 
        RowBox[{"Graphics3D", "[", "styledArrows", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"blueSegmentsGraphics", "=", 
        RowBox[{"Graphics3D", "[", "styledBlueSegments", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Step", " ", "12"}], ":", 
         RowBox[{
         "Combine", " ", "the", " ", "existing", " ", "plot", " ", "with", " ",
           "the", " ", "new", " ", "vectors", " ", "and", " ", "segments"}]}],
         "*)"}], 
       RowBox[{"combinedPlot", "=", 
        RowBox[{"Show", "[", 
         RowBox[{"plotExperiment", ",", 
          RowBox[{"(*", 
           RowBox[{"Existing", " ", "3", "D", " ", "plot"}], "*)"}], 
          "vectorsGraphics", ",", 
          RowBox[{"(*", 
           RowBox[{"Red", " ", "arrows"}], "*)"}], "blueSegmentsGraphics", ",", 
          RowBox[{"(*", 
           RowBox[{"Blue", " ", "segments"}], "*)"}], 
          RowBox[{"Lighting", "->", "\"\<Neutral\>\""}], ",", 
          RowBox[{"(*", 
           RowBox[{"Adjust", " ", "lighting", " ", "as", " ", "needed"}], 
           "*)"}], 
          RowBox[{"Boxed", "->", "True"}], ",", 
          RowBox[{"(*", 
           RowBox[{"Show", " ", "bounding", " ", "box"}], "*)"}], 
          RowBox[{"Axes", "->", "True"}], ",", 
          RowBox[{"(*", 
           RowBox[{"Show", " ", "axes"}], "*)"}], 
          RowBox[{"PlotRange", "->", "All"}]}], "        ", 
         RowBox[{"(*", 
          RowBox[{
          "Ensure", " ", "all", " ", "elements", " ", "are", " ", "visible"}],
           "*)"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Step", " ", "13"}], ":", 
         RowBox[{"Display", " ", "the", " ", "combined", " ", "plot"}]}], 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{"conds", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"IfLLPinsideDecVol", "[", 
             RowBox[{
              RowBox[{"#", "[", 
               RowBox[{"[", 
                RowBox[{"-", "2"}], "]"}], "]"}], ",", 
              RowBox[{
               RowBox[{"#", "[", 
                RowBox[{"[", 
                 RowBox[{"-", "2"}], "]"}], "]"}], 
               FractionBox[
                RowBox[{"#", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], 
                RowBox[{"#", "[", 
                 RowBox[{"[", "3", "]"}], "]"}]]}], ",", 
              RowBox[{
               RowBox[{"#", "[", 
                RowBox[{"[", 
                 RowBox[{"-", "2"}], "]"}], "]"}], 
               FractionBox[
                RowBox[{"#", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], 
                RowBox[{"#", "[", 
                 RowBox[{"[", "3", "]"}], "]"}]]}]}], "]"}], ",", 
            RowBox[{"IfLLPinsideDecVol", "[", 
             RowBox[{
              RowBox[{"#", "[", 
               RowBox[{"[", 
                RowBox[{"-", "1"}], "]"}], "]"}], ",", 
              RowBox[{
               RowBox[{"#", "[", 
                RowBox[{"[", 
                 RowBox[{"-", "1"}], "]"}], "]"}], 
               FractionBox[
                RowBox[{"#", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], 
                RowBox[{"#", "[", 
                 RowBox[{"[", "3", "]"}], "]"}]]}], ",", 
              RowBox[{
               RowBox[{"#", "[", 
                RowBox[{"[", 
                 RowBox[{"-", "1"}], "]"}], "]"}], 
               FractionBox[
                RowBox[{"#", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], 
                RowBox[{"#", "[", 
                 RowBox[{"[", "3", "]"}], "]"}]]}]}], "]"}]}], "}"}], "&"}], "/@",
          "datajoined1"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"conds2", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"IfLLPinsideDecVol", "[", 
              RowBox[{
               RowBox[{"0.99", 
                RowBox[{"#", "[", 
                 RowBox[{"[", 
                  RowBox[{"-", "2"}], "]"}], "]"}]}], ",", 
               RowBox[{"0.99", 
                RowBox[{"#", "[", 
                 RowBox[{"[", 
                  RowBox[{"-", "2"}], "]"}], "]"}], 
                FractionBox[
                 RowBox[{"#", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], 
                 RowBox[{"#", "[", 
                  RowBox[{"[", "3", "]"}], "]"}]]}], ",", 
               RowBox[{"0.99", 
                RowBox[{"#", "[", 
                 RowBox[{"[", 
                  RowBox[{"-", "2"}], "]"}], "]"}], 
                FractionBox[
                 RowBox[{"#", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], 
                 RowBox[{"#", "[", 
                  RowBox[{"[", "3", "]"}], "]"}]]}]}], "]"}], "*", 
             RowBox[{"Boole", "[", 
              RowBox[{"32", "<=", 
               RowBox[{"0.99", 
                RowBox[{"#", "[", 
                 RowBox[{"[", 
                  RowBox[{"-", "2"}], "]"}], "]"}]}], "<=", "82"}], "]"}]}], ",", 
            RowBox[{
             RowBox[{"IfLLPinsideDecVol", "[", 
              RowBox[{
               RowBox[{"1.01", 
                RowBox[{"#", "[", 
                 RowBox[{"[", 
                  RowBox[{"-", "1"}], "]"}], "]"}]}], ",", 
               RowBox[{"1.01", 
                RowBox[{"#", "[", 
                 RowBox[{"[", 
                  RowBox[{"-", "1"}], "]"}], "]"}], 
                FractionBox[
                 RowBox[{"#", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], 
                 RowBox[{"#", "[", 
                  RowBox[{"[", "3", "]"}], "]"}]]}], ",", 
               RowBox[{"1.01", 
                RowBox[{"#", "[", 
                 RowBox[{"[", 
                  RowBox[{"-", "1"}], "]"}], "]"}], 
                FractionBox[
                 RowBox[{"#", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], 
                 RowBox[{"#", "[", 
                  RowBox[{"[", "3", "]"}], "]"}]]}]}], "]"}], "*", 
             RowBox[{"Boole", "[", 
              RowBox[{"32", "<=", 
               RowBox[{"1.01", 
                RowBox[{"#", "[", 
                 RowBox[{"[", 
                  RowBox[{"-", "1"}], "]"}], "]"}]}], "<=", "82"}], "]"}]}]}],
            "}"}], "&"}], "/@", "datajoined1"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"datajoined2", "=", 
        RowBox[{
         RowBox[{"Join", "[", 
          RowBox[{"datajoined1", ",", 
           RowBox[{"conds2", "//", "N"}], ",", "2"}], "]"}], "//", 
         "Developer`ToPackedArray"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Style", "[", 
        RowBox[{
         RowBox[{"Row", "[", 
          RowBox[{"{", 
           RowBox[{"combinedPlot", ",", 
            RowBox[{"Histogram", "[", 
             RowBox[{
              RowBox[{"tttt", "[", 
               RowBox[{"[", 
                RowBox[{"All", ",", "2"}], "]"}], "]"}], "-", 
              RowBox[{"tttt", "[", 
               RowBox[{"[", 
                RowBox[{"All", ",", "1"}], "]"}], "]"}]}], "]"}], ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"Min", "[", 
                 RowBox[{
                  RowBox[{"#", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], ",", 
                  RowBox[{"#", "[", 
                   RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "&"}], "/@", 
               "conds"}], ")"}], "//", "Histogram"}], ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"Max", "[", 
                 RowBox[{
                  RowBox[{"#", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], ",", 
                  RowBox[{"#", "[", 
                   RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "&"}], "/@", 
               "conds2"}], ")"}], "//", "Histogram"}]}], "}"}], "]"}], ",", 
         RowBox[{"ImageSizeMultipliers", "->", 
          RowBox[{"{", 
           RowBox[{"1", ",", " ", "1"}], "}"}]}]}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], "Input",
 CellChangeTimes->{{3.942465483588686*^9, 3.94246552610343*^9}, {
   3.9424658089024944`*^9, 3.942465953041439*^9}, {3.942465992090639*^9, 
   3.942466017225462*^9}, {3.9424660726936245`*^9, 3.942466074860796*^9}, {
   3.9424662043776646`*^9, 3.9424662068448696`*^9}, {3.942466339345812*^9, 
   3.9424663955303535`*^9}, 3.9424664735980854`*^9, 3.9424665187188816`*^9, {
   3.9424666726017475`*^9, 3.942466696419197*^9}, {3.9424667423743515`*^9, 
   3.9424668765566635`*^9}, {3.942466922460993*^9, 3.942467061324667*^9}, {
   3.9424673807204113`*^9, 3.9424673826294537`*^9}, {3.9424675881941204`*^9, 
   3.9424675884331074`*^9}, {3.942467741236164*^9, 3.9424677634205723`*^9}, {
   3.9424678598384323`*^9, 3.942467915897665*^9}, {3.942468054707981*^9, 
   3.942468057974352*^9}, {3.942468206860138*^9, 3.942468211577114*^9}, {
   3.9424682814457016`*^9, 3.9424683053633785`*^9}, {3.942468335886921*^9, 
   3.9424684070306892`*^9}, {3.9424684666329746`*^9, 
   3.9424685016667824`*^9}, {3.942468553132206*^9, 3.942468555133316*^9}},
 CellLabel->"In[8]:=",ExpressionUUID->"e3ec3a1f-1598-724a-a3e6-6521986c6bde"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Generating decay/scattering vertices", "Section",
 CellChangeTimes->{{3.9176010086613836`*^9, 3.9176010129069557`*^9}, {
  3.917601064995943*^9, 3.9176010671247034`*^9}, {3.9382426300458584`*^9, 
  3.938242631593691*^9}},ExpressionUUID->"26128561-4d25-4624-85ef-\
517670b1cd9a"],

Cell[CellGroupData[{

Cell["\<\
Generating vertices prior to the decay/scattering probability\
\>", "Subsection",
 CellChangeTimes->{{3.917601054940011*^9, 3.9176010612944117`*^9}, {
  3.9382426379763412`*^9, 
  3.938242649535187*^9}},ExpressionUUID->"b7fb0259-fe52-4d19-97ee-\
fd459f554cf2"],

Cell[CellGroupData[{

Cell["Decays", "Subsubsection",
 CellChangeTimes->{{3.9382426713318596`*^9, 
  3.9382426719410534`*^9}},ExpressionUUID->"e6a6df27-0771-de4b-8ae9-\
3733d229d49b"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"!", 
    RowBox[{"StringContainsQ", "[", 
     RowBox[{"LLPdirName", ",", "\"\<LDM\>\""}], "]"}]}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"CDFpoisson", "[", 
      RowBox[{"xdecay_", ",", "ldecay_"}], "]"}], "=", 
     RowBox[{"Integrate", "[", 
      RowBox[{
       FractionBox[
        RowBox[{"Exp", "[", 
         RowBox[{
          RowBox[{"-", "x"}], "/", "ldecay"}], "]"}], "ldecay"], ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", "0", ",", "xdecay"}], "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"invCDFpoisson", "[", 
      RowBox[{"u_", ",", "ldecay_"}], "]"}], "=", 
     RowBox[{
      RowBox[{"x", "/.", 
       RowBox[{
        RowBox[{"Solve", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"CDFpoisson", "[", 
            RowBox[{"x", ",", "ldecay"}], "]"}], "\[Equal]", "u"}], ",", 
          "x"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], "/.", 
      RowBox[{"{", 
       RowBox[{
        TemplateBox[{"1"},
         "C"], "\[Rule]", "0"}], "}"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"uzmin", "[", 
      RowBox[{"ldecay_", ",", "cos\[Theta]_", ",", "zMIN_"}], "]"}], "=", 
     RowBox[{"u", "/.", 
      RowBox[{
       RowBox[{"Solve", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"invCDFpoisson", "[", 
           RowBox[{"u", ",", "ldecay"}], "]"}], "\[Equal]", 
          RowBox[{"zMIN", "/", 
           RowBox[{"Abs", "[", "cos\[Theta]", "]"}]}]}], ",", "u", ",", 
         "Reals"}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"uzmax", "[", 
      RowBox[{"ldecay_", ",", "cos\[Theta]_", ",", "zMAX_"}], "]"}], "=", 
     RowBox[{"u", "/.", 
      RowBox[{
       RowBox[{"Solve", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"invCDFpoisson", "[", 
           RowBox[{"u", ",", "ldecay"}], "]"}], "\[Equal]", 
          RowBox[{"zMAX", "/", 
           RowBox[{"Abs", "[", "cos\[Theta]", "]"}]}]}], ",", "u", ",", 
         "Reals"}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"SampledDecays", "=", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"zminmaxv", "=", "zminmaxVals"}], "}"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Hold", "@", 
           RowBox[{"Compile", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"c\[Tau]LLP", ",", 
               RowBox[{"{", 
                RowBox[{"momenta", ",", "_Real", ",", "1"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"zvals", ",", "_Real", ",", "1"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"indexlist", ",", "_Integer"}], "}"}]}], "}"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"Module", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"ptom", ",", "c\[Theta]", ",", "umin", ",", 
                 RowBox[{"umax", "=", "1."}], ",", "rdecrand", ",", "Pdec", ",",
                  "ldec", ",", "px", ",", "py", ",", "pz", ",", "e", ",", "m",
                  ",", "p", ",", "xdec", ",", "ydec", ",", "zdec", ",", 
                 "zmin", ",", "zmax"}], "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"zmin", ",", "zmax"}], "}"}], "=", 
                 RowBox[{"zminmaxv", "[", 
                  RowBox[{"momenta", ",", "zvals", ",", "indexlist"}], 
                  "]"}]}], ";", "\[IndentingNewLine]", 
                RowBox[{"px", "=", 
                 RowBox[{"Compile`GetElement", "[", 
                  RowBox[{"momenta", ",", "indexpx"}], "]"}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"py", "=", 
                 RowBox[{"Compile`GetElement", "[", 
                  RowBox[{"momenta", ",", "indexpy"}], "]"}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"pz", "=", 
                 RowBox[{"Compile`GetElement", "[", 
                  RowBox[{"momenta", ",", "indexpz"}], "]"}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"e", "=", 
                 RowBox[{"Compile`GetElement", "[", 
                  RowBox[{"momenta", ",", "indexenergy"}], "]"}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"m", "=", 
                 RowBox[{"Compile`GetElement", "[", 
                  RowBox[{"momenta", ",", "indexmass"}], "]"}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"p", "=", 
                 SqrtBox[
                  RowBox[{
                   SuperscriptBox["e", "2"], "-", 
                   SuperscriptBox["m", "2"]}]]}], ";", "\[IndentingNewLine]", 
                RowBox[{"ptom", "=", 
                 RowBox[{"p", "/", "m"}]}], ";", "\[IndentingNewLine]", 
                RowBox[{"c\[Theta]", "=", 
                 RowBox[{"pz", "/", "p"}]}], ";", "\[IndentingNewLine]", 
                RowBox[{"ldec", "=", 
                 RowBox[{"c\[Tau]LLP", "*", "ptom"}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"(*", 
                 RowBox[{
                  RowBox[{
                  "Sampling", " ", "of", " ", "decay", " ", "point", " ", 
                   "according", " ", "to", " ", "the", " ", "exponential", " ",
                    "decay", " ", "distribution", " ", "given", " ", "in", " ",
                    "terms", " ", "of", " ", "mass", " ", "m"}], ",", " ", 
                  RowBox[{"momentum", " ", "p"}], ",", " ", 
                  RowBox[{"cos", 
                   RowBox[{"(", "\[Theta]", ")"}]}], ",", " ", 
                  RowBox[{"and", " ", "c\[Tau]"}]}], "*)"}], 
                "\[IndentingNewLine]", 
                RowBox[{"umin", "=", 
                 RowBox[{"uzmin", "[", 
                  RowBox[{"ldec", ",", "c\[Theta]", ",", "zmin"}], "]"}]}], ";",
                 "\[IndentingNewLine]", 
                RowBox[{"(*", 
                 RowBox[{
                  RowBox[{"If", " ", 
                   SubscriptBox["l", "decay"], " ", "is", " ", "too", " ", 
                   "small"}], ",", " ", 
                  RowBox[{
                  "then", " ", "sample", "  ", "r", " ", "just", " ", "near", 
                   " ", "the", " ", "beginning", " ", "of", " ", "the", " ", 
                   "decay", " ", 
                   RowBox[{"volume", "."}]}]}], " ", "*)"}], 
                "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"umin", ">", "0.99999999995"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"rdecrand", "=", 
                    RowBox[{"1.000001", "*", 
                    FractionBox["zmin", 
                    RowBox[{"Abs", "[", "c\[Theta]", "]"}]]}]}], ";"}], 
                  "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
                  RowBox[{"(*", 
                   RowBox[{
                    RowBox[{"Case", " ", "of", " ", "vary", " ", "large", " ", 
                    SubscriptBox["l", "dec"]}], " ", "-", " ", 
                    RowBox[{
                    "then", " ", "just", " ", "isotropic", " ", 
                    "sampling"}]}], "*)"}], "\[IndentingNewLine]", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"ldec", ">", 
                    SuperscriptBox["10", "10"]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"rdecrand", "=", 
                    RowBox[{"RandomReal", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    FractionBox["zmin", 
                    RowBox[{"Abs", "[", "c\[Theta]", "]"}]], ",", 
                    FractionBox["zmax", 
                    RowBox[{"Abs", "[", "c\[Theta]", "]"}]]}], "}"}], "]"}]}],
                     "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{"Otherwise", ",", " ", 
                    RowBox[{
                    "sample", " ", "from", " ", "inverse", " ", "CDF"}]}], 
                    "*)"}], "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"umax", "=", 
                    RowBox[{"uzmax", "[", 
                    RowBox[{"ldec", ",", "c\[Theta]", ",", "zmax"}], "]"}]}], 
                    ";", "\[IndentingNewLine]", 
                    RowBox[{"rdecrand", "=", 
                    RowBox[{"invCDFpoisson", "[", 
                    RowBox[{
                    RowBox[{"RandomReal", "[", 
                    RowBox[{"{", 
                    RowBox[{"umin", ",", "umax"}], "}"}], "]"}], ",", 
                    "ldec"}], "]"}]}]}]}], "\[IndentingNewLine]", "]"}]}], 
                 "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
                RowBox[{"Pdec", "=", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"ldec", "<=", 
                    SuperscriptBox["10", "10"]}], ",", 
                   RowBox[{
                    RowBox[{"Exp", "[", 
                    RowBox[{"-", 
                    FractionBox["zmin", 
                    RowBox[{"ldec", "*", 
                    RowBox[{"Abs", "[", "c\[Theta]", "]"}]}]]}], "]"}], "-", 
                    RowBox[{"Exp", "[", 
                    RowBox[{"-", 
                    FractionBox["zmax", 
                    RowBox[{"ldec", "*", 
                    RowBox[{"Abs", "[", "c\[Theta]", "]"}]}]]}], "]"}]}], ",", 
                   FractionBox[
                    RowBox[{"(", 
                    RowBox[{"zmax", "-", "zmin"}], ")"}], 
                    RowBox[{"ldec", "*", 
                    RowBox[{"Abs", "[", "c\[Theta]", "]"}]}]]}], "]"}]}], ";",
                 "\[IndentingNewLine]", 
                RowBox[{"xdec", "=", 
                 RowBox[{"rdecrand", "*", 
                  FractionBox["px", "p"]}]}], ";", "\[IndentingNewLine]", 
                RowBox[{"ydec", "=", 
                 RowBox[{"rdecrand", "*", 
                  FractionBox["py", "p"]}]}], ";", "\[IndentingNewLine]", 
                RowBox[{"zdec", "=", 
                 RowBox[{"rdecrand", "*", 
                  RowBox[{"Abs", "[", "c\[Theta]", "]"}]}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"{", 
                 RowBox[{
                 "px", ",", "py", ",", "pz", ",", "e", ",", "m", ",", 
                  "c\[Theta]", ",", "ptom", ",", "Pdec", ",", "xdec", ",", 
                  "ydec", ",", "zdec"}], "}"}]}]}], "\[IndentingNewLine]", 
              "]"}], ",", 
             RowBox[{"CompilationTarget", "\[Rule]", "\"\<C\>\""}], ",", 
             RowBox[{"RuntimeOptions", "\[Rule]", "\"\<Speed\>\""}], ",", 
             RowBox[{"RuntimeAttributes", "->", 
              RowBox[{"{", "Listable", "}"}]}], ",", 
             RowBox[{"Parallelization", "->", "True"}]}], "]"}]}], "/.", 
          RowBox[{"ruleOwn", "[", 
           RowBox[{"{", 
            RowBox[{
            "indexpx", ",", "indexpy", ",", "indexpz", ",", "indexptom", ",", 
             "indexenergy", ",", "indexc\[Theta]", ",", "indexmass"}], "}"}], 
           "]"}]}], "/.", 
         RowBox[{"ruleDown", "[", 
          RowBox[{"{", 
           RowBox[{"invCDFpoisson", ",", "uzmin", ",", "uzmax"}], "}"}], 
          "]"}]}], "//", "ReleaseHold"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"<<", "CompiledFunctionTools`"}], ";", "\n", 
    RowBox[{"CompilePrint", "@", "SampledDecays"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"test", "!=", "1"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"ttt", "=", 
         RowBox[{"SampledDecays", "[", 
          RowBox[{"10", ",", "momenta", ",", "zvals", ",", "indexlist"}], 
          "]"}]}], ";"}], "//", "AbsoluteTiming"}]}], "]"}]}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.917669257586486*^9, 3.9176692591112733`*^9}, {
   3.92580646531468*^9, 3.9258065118825083`*^9}, {3.929292843865019*^9, 
   3.929292845204218*^9}, 3.929293302635665*^9, {3.9312393160458436`*^9, 
   3.9312393160518045`*^9}, {3.938243058178503*^9, 3.9382430867695713`*^9}, {
   3.9382432854064007`*^9, 3.938243285412924*^9}, {3.9382480592475204`*^9, 
   3.9382480599160347`*^9}, {3.9423996207988567`*^9, 3.9423996261766796`*^9}, 
   3.942404835031975*^9, {3.942468636184721*^9, 3.942468650153879*^9}, {
   3.9424687159927177`*^9, 3.94246878290938*^9}, {3.9424688963234367`*^9, 
   3.9424689842115974`*^9}, {3.9424690306417255`*^9, 
   3.9424690654903297`*^9}, {3.9424691574825*^9, 3.9424691850447216`*^9}},
 CellLabel->"In[10]:=",ExpressionUUID->"a355d38c-d700-4d03-be95-2cd9be076db4"],

Cell[BoxData[
 FormBox[
  RowBox[{"{", 
   RowBox[{"0.0071461`", ",", "Null"}], "}"}], TraditionalForm]], "Output",
 CellChangeTimes->{
  3.942403661652794*^9, {3.942469235997999*^9, 3.9424692390652256`*^9}},
 CellLabel->
  "Out[186]=",ExpressionUUID->"028b4264-b117-c544-bcf9-b2105d0bb2bb"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"mtest", "=", "2.6"}], ";", "\[IndentingNewLine]", 
   RowBox[{"pts", "=", 
    RowBox[{"KinematicsFromTabulatedDistribution", "[", 
     RowBox[{"mtest", ",", "1", ",", "0", ",", 
      SuperscriptBox["10", "5"], ",", "10000"}], "]"}]}], ";", 
   "\[IndentingNewLine]", 
   RowBox[{"momenta", "=", 
    RowBox[{"Momenta", "[", 
     RowBox[{"pts", ",", 
      RowBox[{"-", "Pi"}], ",", "Pi"}], "]"}]}], ";", "\[IndentingNewLine]", 
   RowBox[{"indexlist", "=", 
    RowBox[{
     RowBox[{"nfzvals", "[", 
      RowBox[{"momenta", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", 
         RowBox[{"-", "1"}]}], "]"}], "]"}], "]"}], "//", "Flatten"}]}], ";", 
   "\[IndentingNewLine]", 
   RowBox[{"c\[Tau]test", "=", "1."}], ";", "\[IndentingNewLine]", 
   RowBox[{"ttt", "=", 
    RowBox[{"SampledDecays", "[", 
     RowBox[{"c\[Tau]test", ",", "momenta", ",", "zvals", ",", "indexlist"}], 
     "]"}]}], ";", "\[IndentingNewLine]", 
   RowBox[{"tttz", "=", 
    RowBox[{"ttt", "[", 
     RowBox[{"[", 
      RowBox[{"All", ",", 
       RowBox[{"{", 
        RowBox[{"8", ",", 
         RowBox[{"-", "1"}]}], "}"}]}], "]"}], "]"}]}], ";", 
   "\[IndentingNewLine]", 
   RowBox[{"zsampled", "=", 
    RowBox[{"RandomChoice", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"tttz", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "1"}], "]"}], "]"}], "->", 
       RowBox[{"tttz", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "2"}], "]"}], "]"}]}], ",", 
      RowBox[{
       RowBox[{"Length", "[", 
        RowBox[{"tttz", "/", "10"}], "]"}], "//", "IntegerPart"}]}], "]"}]}], 
   ";", "\[IndentingNewLine]", 
   RowBox[{"\[CapitalDelta]z", "=", "2"}], ";", "\[IndentingNewLine]", 
   RowBox[{"sum", "=", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           FractionBox[
            RowBox[{"Exp", "[", 
             RowBox[{
              RowBox[{"-", "z"}], "*", 
              RowBox[{"mtest", "/", 
               RowBox[{"(", 
                RowBox[{"c\[Tau]test", "*", 
                 RowBox[{"#", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "*", 
                 RowBox[{"#", "[", 
                  RowBox[{"[", "2", "]"}], "]"}]}], ")"}]}]}], "]"}], 
            RowBox[{"c\[Tau]test", "*", 
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "*", 
             RowBox[{"#", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}]], "&"}], "/@", 
          RowBox[{"momenta", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", 
             RowBox[{"{", 
              RowBox[{"3", ",", "6"}], "}"}]}], "]"}], "]"}]}], ")"}], "//", 
        "Mean"}], ")"}], ",", 
      RowBox[{"{", 
       RowBox[{"z", ",", "32", ",", "82", ",", "\[CapitalDelta]z"}], "}"}]}], 
     "]"}]}], ";", "\[IndentingNewLine]", 
   RowBox[{"tabDistrDirect", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"#", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", 
        RowBox[{
         FractionBox["1", "\[CapitalDelta]z"], 
         FractionBox[
          RowBox[{"#", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "sum"]}]}], "}"}], "&"}], "/@", 
     RowBox[{"ParallelTable", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"z", ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             FractionBox[
              RowBox[{"Exp", "[", 
               RowBox[{
                RowBox[{"-", "z"}], "*", 
                RowBox[{"mtest", "/", 
                 RowBox[{"(", 
                  RowBox[{"c\[Tau]test", "*", 
                   RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "*", 
                   RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], ")"}]}]}], "]"}], 
              RowBox[{"c\[Tau]test", "*", 
               RowBox[{"#", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "*", 
               RowBox[{"#", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}]], "&"}], "/@", 
            RowBox[{"momenta", "[", 
             RowBox[{"[", 
              RowBox[{"All", ",", 
               RowBox[{"{", 
                RowBox[{"3", ",", "6"}], "}"}]}], "]"}], "]"}]}], ")"}], "//",
           "Mean"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"z", ",", "32", ",", "82", ",", "2"}], "}"}]}], "]"}]}]}], ";",
    "\[IndentingNewLine]", 
   RowBox[{"Show", "[", 
    RowBox[{
     RowBox[{"Histogram", "[", 
      RowBox[{"zsampled", ",", "50", ",", "\"\<ProbabilityDensity\>\""}], 
      "]"}], ",", 
     RowBox[{"ListPlot", "[", 
      RowBox[{"Evaluate", "[", "tabDistrDirect", "]"}], "]"}]}], "]"}]}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.942399657479103*^9, 3.9423997466299114`*^9}, {
  3.942400000851433*^9, 3.9424000026999474`*^9}, {3.942400221254574*^9, 
  3.942400223521305*^9}, {3.942400450673971*^9, 3.942400450974373*^9}, {
  3.9424004929600544`*^9, 3.9424004994085064`*^9}, {3.9424005592460136`*^9, 
  3.942400807530369*^9}, {3.942400840348543*^9, 3.9424008724683247`*^9}, {
  3.942403268940201*^9, 3.942403271090145*^9}},
 CellLabel->"In[11]:=",ExpressionUUID->"acaf0c5b-4e51-7343-8bcc-fecb5cbc65a0"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Scatterings", "Subsubsection",
 CellChangeTimes->{{3.9382426713318596`*^9, 
  3.9382426800780544`*^9}},ExpressionUUID->"f1fbf851-3676-9b48-8975-\
b5edcf3b6def"],

Cell[BoxData[
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"StringContainsQ", "[", 
    RowBox[{"LLPdirName", ",", "\"\<LDM\>\""}], "]"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "___", "___", "___", "___", "___", "___", "___", "___", "___", "_"}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Simulating", " ", "the", " ", "scattering", " ", "kinematics"}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "___", "___", "___", "___", "___", "___", "___", "___", "___", "_"}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Sampler", " ", "performing", " ", "the", " ", "scattered", " ", 
     RowBox[{"electron", "'"}], "s", " ", "energy", " ", "calculation"}], 
    "*)"}], "\[IndentingNewLine]", "  ", 
   RowBox[{
    RowBox[{"samplerEf", "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Hold", "@", 
         RowBox[{"Compile", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"m\[Chi]", ",", "_Real"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"mV", ",", "_Real"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"E\[Chi]", ",", "_Real"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"Ekmin", ",", "_Real"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"IfProton", ",", 
               RowBox[{"True", "|", "False"}]}], "}"}]}], "}"}], ",", 
           RowBox[{"Module", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"mass", "=", 
                RowBox[{"If", "[", 
                 RowBox[{"IfProton", ",", "MP", ",", "ME"}], "]"}]}], ",", 
               "Efrand", ",", 
               RowBox[{"uval", "=", "0."}], ",", "d\[Sigma]dEmax", ",", 
               "Emin"}], "}"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Efrand", "=", "mass"}], ";", "\[IndentingNewLine]", 
              RowBox[{"Emin", "=", 
               RowBox[{"Ekmin", "+", "mass"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"Emin", "<", 
                 RowBox[{"Efmax", "[", 
                  RowBox[{"E\[Chi]", ",", "m\[Chi]", ",", "mass"}], "]"}]}], ",",
                 "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"If", "[", 
                  RowBox[{"IfProton", ",", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"d\[Sigma]dEmax", "=", 
                    RowBox[{"d\[Sigma]dEfTempProtons", "[", 
                    RowBox[{
                    "Emin", ",", "E\[Chi]", ",", "m\[Chi]", ",", "mV", ",", 
                    "1", ",", "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{"While", "[", 
                    RowBox[{
                    RowBox[{"uval", "<", 
                    RowBox[{"RandomReal", "[", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "1"}], "}"}], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Efrand", "=", 
                    RowBox[{"RandomReal", "[", 
                    RowBox[{"{", 
                    RowBox[{"Emin", ",", 
                    RowBox[{"Efmax", "[", 
                    RowBox[{"E\[Chi]", ",", "m\[Chi]", ",", "mass"}], "]"}]}],
                     "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{"uval", "=", 
                    FractionBox[
                    RowBox[{"d\[Sigma]dEfTempProtons", "[", 
                    RowBox[{
                    "Efrand", ",", "E\[Chi]", ",", "m\[Chi]", ",", "mV", ",", 
                    "1", ",", "1"}], "]"}], "d\[Sigma]dEmax"]}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}], 
                   "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"d\[Sigma]dEmax", "=", 
                    RowBox[{"d\[Sigma]dEfTempElectrons", "[", 
                    RowBox[{
                    "Emin", ",", "E\[Chi]", ",", "m\[Chi]", ",", "mV", ",", 
                    "1", ",", "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{"While", "[", 
                    RowBox[{
                    RowBox[{"uval", "<", 
                    RowBox[{"RandomReal", "[", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "1"}], "}"}], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Efrand", "=", 
                    RowBox[{"RandomReal", "[", 
                    RowBox[{"{", 
                    RowBox[{"Emin", ",", 
                    RowBox[{"Efmax", "[", 
                    RowBox[{"E\[Chi]", ",", "m\[Chi]", ",", "mass"}], "]"}]}],
                     "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{"uval", "=", 
                    FractionBox[
                    RowBox[{"d\[Sigma]dEfTempElectrons", "[", 
                    RowBox[{
                    "Efrand", ",", "E\[Chi]", ",", "m\[Chi]", ",", "mV", ",", 
                    "1", ",", "1"}], "]"}], "d\[Sigma]dEmax"]}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}]}], 
                  "\[IndentingNewLine]", "]"}], ";"}]}], 
               "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
              "Efrand"}]}], "\[IndentingNewLine]", "]"}], ",", 
           RowBox[{"CompilationTarget", "->", "\"\<C\>\""}], ",", 
           RowBox[{"RuntimeOptions", "->", "\"\<Speed\>\""}], ",", 
           RowBox[{"RuntimeAttributes", "->", 
            RowBox[{"{", "Listable", "}"}]}]}], "]"}]}], "/.", 
        RowBox[{"ruleOwn", "[", 
         RowBox[{"{", 
          RowBox[{"ME", ",", "MP"}], "}"}], "]"}]}], "/.", 
       RowBox[{"ruleDown", "[", 
        RowBox[{"{", 
         RowBox[{
         "d\[Sigma]dEfTempElectrons", ",", "d\[Sigma]dEfTempProtons", ",", 
          "Efmax"}], "}"}], "]"}]}], "//", "ReleaseHold"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"<<", "CompiledFunctionTools`"}], ";", "\[IndentingNewLine]", 
    RowBox[{"CompilePrint", "@", " ", "samplerEf"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"pts", "=", 
       RowBox[{"ParallelTable", "[", 
        RowBox[{
         RowBox[{"samplerEf", "[", 
          RowBox[{"0.3", ",", "1.", ",", "20"}], "]"}], ",", 
         SuperscriptBox["10", "5"]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Show", "[", 
       RowBox[{
        RowBox[{"LogLogPlot", "[", 
         RowBox[{
          RowBox[{"Evaluate", "[", 
           RowBox[{"{", 
            RowBox[{
             FractionBox[
              RowBox[{"d\[Sigma]dEf", "[", 
               RowBox[{
               "Ee", ",", "20", ",", "0.3", ",", "1", ",", "1", ",", "1", 
                ",", "\"\<Electrons\>\""}], "]"}], 
              RowBox[{"\[Sigma]Total", "[", 
               RowBox[{
               "20", ",", "0.3", ",", "1", ",", "1", ",", "1", 
                ",", "\"\<Electrons\>\""}], "]"}]], ",", 
             RowBox[{"CDFscattering", "[", 
              RowBox[{"Ee", ",", "0.3", ",", "1.", ",", "20"}], "]"}]}], 
            "}"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"Ee", ",", "ME", ",", 
            RowBox[{"Efmax", "[", 
             RowBox[{"20.", ",", "0.3", ",", "ME"}], "]"}]}], "}"}]}], "]"}], 
        ",", 
        RowBox[{"Histogram", "[", 
         RowBox[{"pts", ",", "100", ",", "\"\<ProbabilityDensity\>\"", ",", 
          RowBox[{"ScalingFunctions", "->", 
           RowBox[{"{", 
            RowBox[{"\"\<Log\>\"", ",", "\"\<Log\>\""}], "}"}]}]}], "]"}]}], 
       "]"}]}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"Calculating", " ", "the", " ", "momentum", " ", "direction"}], 
     "*)"}], "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
     "Rotation", " ", "matrices", " ", "with", " ", "around", " ", "z", " ", 
      "axis", " ", 
      RowBox[{"(", 
       RowBox[{"\[Phi]", " ", "angle"}], ")"}], " ", "and", " ", "x", " ", 
      "axis", " ", 
      RowBox[{"(", 
       RowBox[{"\[Theta]", " ", "angle"}], ")"}]}], "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\[Phi]RotMatrix", "[", "\[Phi]_", "]"}], "=", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Cos", "[", "\[Phi]", "]"}], ",", 
           RowBox[{"Sin", "[", "\[Phi]", "]"}], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{"Sin", "[", "\[Phi]", "]"}]}], ",", 
           RowBox[{"Cos", "[", "\[Phi]", "]"}], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "}"}], ";"}], "*)"}], 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Sin", "[", "\[Phi]", "]"}], ",", 
         RowBox[{"Cos", "[", "\[Phi]", "]"}], ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", 
          RowBox[{"Cos", "[", "\[Phi]", "]"}]}], ",", 
         RowBox[{"Sin", "[", "\[Phi]", "]"}], ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\[Theta]RotMatrix", "[", "\[Theta]_", "]"}], "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{"Cos", "[", "\[Theta]", "]"}], ",", 
         RowBox[{"Sin", "[", "\[Theta]", "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{"-", 
          RowBox[{"Sin", "[", "\[Theta]", "]"}]}], ",", 
         RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "}"}]}], "}"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"The", " ", "3"}], "-", 
      RowBox[{
      "vector", " ", "at", " ", "some", " ", "reference", " ", "frame", " ", 
       "rotated", " ", "using", " ", "the", " ", "rotation", " ", 
       "matrices"}]}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"pvecUnrotated", "[", 
      RowBox[{"px_", ",", "py_", ",", "pz_"}], "]"}], "=", 
     RowBox[{"{", 
      RowBox[{"px", ",", "py", ",", "pz"}], "}"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"pvecRotated", "[", 
      RowBox[{
      "px_", ",", "py_", ",", "pz_", ",", "\[Theta]V_", ",", "\[Phi]V_"}], 
      "]"}], "=", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"pxRotated", "[", 
         RowBox[{
         "px_", ",", "py_", ",", "pz_", ",", "\[Theta]V_", ",", "\[Phi]V_"}], 
         "]"}], ",", 
        RowBox[{"pyRotated", "[", 
         RowBox[{
         "px_", ",", "py_", ",", "pz_", ",", "\[Theta]V_", ",", "\[Phi]V_"}], 
         "]"}], ",", 
        RowBox[{"pzRotated", "[", 
         RowBox[{
         "px_", ",", "py_", ",", "pz_", ",", "\[Theta]V_", ",", "\[Phi]V_"}], 
         "]"}]}], "}"}], "=", 
      RowBox[{
       RowBox[{"\[Phi]RotMatrix", "[", "\[Phi]V", "]"}], ".", 
       RowBox[{"\[Theta]RotMatrix", "[", "\[Theta]V", "]"}], ".", 
       RowBox[{"pvecUnrotated", "[", 
        RowBox[{"px", ",", "py", ",", "pz"}], "]"}]}]}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Phi]Val", "[", 
        RowBox[{"px_", ",", "py_"}], "]"}], "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"py", ">", "0"}], ",", 
         RowBox[{"ArcCos", "[", 
          FractionBox["px", 
           SqrtBox[
            RowBox[{
             SuperscriptBox["px", "2"], "+", 
             SuperscriptBox["py", "2"]}]]], "]"}], ",", 
         RowBox[{"-", 
          RowBox[{"ArcCos", "[", 
           FractionBox["px", 
            SqrtBox[
             RowBox[{
              SuperscriptBox["px", "2"], "+", 
              SuperscriptBox["py", "2"]}]]], "]"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\[Theta]Val", "[", 
        RowBox[{"px_", ",", "py_", ",", "pz_"}], "]"}], "=", 
       RowBox[{"ArcCos", "[", 
        RowBox[{"pz", "/", 
         RowBox[{"(", 
          RowBox[{"\[Sqrt]", 
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["px", "2"], "+", 
             SuperscriptBox["py", "2"], "+", 
             SuperscriptBox["pz", "2"]}], ")"}]}], ")"}]}], "]"}]}], ";"}], 
     "*)"}], "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"pvecRotated", "[", 
       RowBox[{"0", ",", "0", ",", "p", ",", "\[Theta]V", ",", "\[Phi]V"}], 
       "]"}], ";"}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{"recoilMomentum", "=", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"Efrand", "=", " ", "samplerEf"}], "}"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Hold", "@", 
           RowBox[{"Compile", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"m", ",", "_Real"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"mV", ",", "_Real"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"e", ",", "_Real"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"px", ",", "_Real"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"py", ",", "_Real"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"pz", ",", "_Real"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"Ekmin", ",", "_Real"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"IfProton", ",", 
                 RowBox[{"True", "|", "False"}]}], "}"}]}], "}"}], ",", 
             RowBox[{"Module", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                "Ef", ",", "pf", ",", "cos\[Theta]f", ",", "sin\[Theta]f", ",",
                  "\[Phi]rand", ",", "pxf", ",", "pyf", ",", "pzf", ",", 
                 "\[Phi]", ",", "\[Theta]", ",", "pxfunrot", ",", "pyfunrot", 
                 ",", "pzfunrot", ",", 
                 RowBox[{"mass", "=", 
                  RowBox[{"If", "[", 
                   RowBox[{"IfProton", ",", "MP", ",", "ME"}], "]"}]}]}], 
                "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"(*", 
                RowBox[{
                 RowBox[{"Electron", "'"}], "s", " ", "energy"}], "*)"}], 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"Ef", "=", 
                 RowBox[{"Efrand", "[", 
                  RowBox[{
                  "m", ",", "mV", ",", "e", ",", "Ekmin", ",", "IfProton"}], 
                  "]"}]}], ";", "\[IndentingNewLine]", 
                RowBox[{"pf", "=", 
                 SqrtBox[
                  RowBox[{
                   SuperscriptBox["Ef", "2"], "-", 
                   SuperscriptBox["mass", "2"]}]]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"(*", 
                 RowBox[{
                 "Angle", " ", "between", " ", "the", " ", "outgoing", " ", 
                  "electron", " ", "and", " ", "incoming", " ", "\[Chi]"}], 
                 "*)"}], "\[IndentingNewLine]", 
                RowBox[{"cos\[Theta]f", "=", 
                 RowBox[{"cos\[Theta]scatt", "[", 
                  RowBox[{"e", ",", "m", ",", "Ef", ",", "mass"}], "]"}]}], ";",
                 "\[IndentingNewLine]", 
                RowBox[{"sin\[Theta]f", "=", 
                 SqrtBox[
                  RowBox[{"1", "-", 
                   SuperscriptBox["cos\[Theta]f", "2"]}]]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"(*", 
                 RowBox[{
                  RowBox[{"Recovering", " ", "the", " ", "full", " ", "3"}], "-", 
                  RowBox[{
                  "momentum", " ", "of", " ", "recoil", " ", "electron", " ", 
                   "by", " ", "first", " ", "considering", " ", "the", " ", 
                   "frame", " ", "where", " ", "\[Chi]", " ", "has", " ", 
                   "momentum", " ", 
                   RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", "p"}], "}"}], " ", "and", " ",
                    "then", " ", "rotating", " ", "it", " ", "to", " ", "the",
                    " ", "frame", " ", "given", " ", "by", " ", "the", " ", 
                   "actual", " ", 
                   RowBox[{"{", 
                    RowBox[{"px", ",", "py", ",", "pz"}], "}"}]}]}], "*)"}], 
                "\[IndentingNewLine]", 
                RowBox[{"\[Phi]rand", "=", 
                 RowBox[{
                  RowBox[{"RandomReal", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}], "*", 
                  "Pi"}]}], ";", "\[IndentingNewLine]", 
                RowBox[{"\[Phi]", "=", 
                 RowBox[{"\[Phi]Val", "[", 
                  RowBox[{"px", ",", "py"}], "]"}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"\[Theta]", "=", 
                 RowBox[{"\[Theta]Val", "[", 
                  RowBox[{"px", ",", "py", ",", "pz"}], "]"}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"pxfunrot", "=", 
                 RowBox[{"pf", "*", "sin\[Theta]f", "*", 
                  RowBox[{"Cos", "[", "\[Phi]rand", "]"}]}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"pyfunrot", "=", 
                 RowBox[{"pf", "*", "sin\[Theta]f", "*", 
                  RowBox[{"Sin", "[", "\[Phi]rand", "]"}]}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"pzfunrot", "=", 
                 RowBox[{"pf", "*", "cos\[Theta]f"}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"pxf", "=", 
                 RowBox[{"pxRotated", "[", 
                  RowBox[{
                  "pxfunrot", ",", "pyfunrot", ",", "pzfunrot", ",", 
                   "\[Theta]", ",", "\[Phi]"}], "]"}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"pyf", "=", 
                 RowBox[{"pyRotated", "[", 
                  RowBox[{
                  "pxfunrot", ",", "pyfunrot", ",", "pzfunrot", ",", 
                   "\[Theta]", ",", "\[Phi]"}], "]"}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"pzf", "=", 
                 RowBox[{"pzRotated", "[", 
                  RowBox[{
                  "pxfunrot", ",", "pyfunrot", ",", "pzfunrot", ",", 
                   "\[Theta]", ",", "\[Phi]"}], "]"}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"{", 
                 RowBox[{
                 "cos\[Theta]f", ",", "Ef", ",", "pxf", ",", "pyf", ",", 
                  "pzf"}], "}"}]}]}], "\[IndentingNewLine]", "]"}], ",", 
             RowBox[{"CompilationTarget", "->", "\"\<C\>\""}], ",", 
             RowBox[{"RuntimeOptions", "->", "\"\<Speed\>\""}], ",", 
             RowBox[{"CompilationOptions", "->", 
              RowBox[{"{", 
               RowBox[{
                
                RowBox[{"\"\<InlineExternalDefinitions\>\"", " ", "->", " ", 
                 "True"}], ",", 
                RowBox[{"\"\<InlineCompiledFunctions\>\"", "->", "True"}]}], 
               "}"}]}]}], "]"}]}], "/.", 
          RowBox[{"ruleOwn", "[", 
           RowBox[{"{", 
            RowBox[{"ME", ",", "MP"}], "}"}], "]"}]}], "/.", 
         RowBox[{"ruleDown", "[", 
          RowBox[{"{", 
           RowBox[{
           "\[Phi]Val", ",", "\[Theta]Val", ",", "cos\[Theta]scatt", ",", 
            "pxRotated", ",", "pyRotated", ",", "pzRotated"}], "}"}], "]"}]}],
         "//", "ReleaseHold"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"SampledScattering", "=", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"zminmaxv", "=", "zminmaxVals"}], ",", 
         RowBox[{"rm", "=", "recoilMomentum"}]}], "}"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Hold", "@", 
           RowBox[{"Compile", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"\[Epsilon]2", ",", "_Real"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"\[Alpha]D", ",", "_Real"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"mV", ",", "_Real"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"momenta", ",", "_Real", ",", "1"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"zvals", ",", "_Real", ",", "1"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"indexlist", ",", "_Integer"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"Ekmin", ",", "_Real"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"IfProton", ",", 
                 RowBox[{"True", "|", "False"}]}], "}"}]}], "}"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"Module", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                "ptom", ",", "c\[Theta]", ",", "umin", ",", "umax", ",", 
                 "rscattrand", ",", "Pscatt", ",", "ldec", ",", "px", ",", 
                 "py", ",", "pz", ",", "e", ",", "m", ",", "p", ",", "xscatt",
                  ",", "yscatt", ",", "zscatt", ",", "zmin", ",", "zmax", ",",
                  "Ef", ",", "cos\[Theta]f", ",", "\[Phi]rand", ",", "pxf", ",",
                  "pyf", ",", "pzf", ",", "sin\[Theta]f", ",", "pf", ",", 
                 RowBox[{"mass", "=", 
                  RowBox[{"If", "[", 
                   RowBox[{"IfProton", ",", "MP", ",", "ME"}], "]"}]}]}], 
                "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"zmin", ",", "zmax"}], "}"}], "=", 
                 RowBox[{"zminmaxv", "[", 
                  RowBox[{"momenta", ",", "zvals", ",", "indexlist"}], 
                  "]"}]}], ";", "\[IndentingNewLine]", 
                RowBox[{"px", "=", 
                 RowBox[{"Compile`GetElement", "[", 
                  RowBox[{"momenta", ",", "indexpx"}], "]"}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"py", "=", 
                 RowBox[{"Compile`GetElement", "[", 
                  RowBox[{"momenta", ",", "indexpy"}], "]"}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"pz", "=", 
                 RowBox[{"Compile`GetElement", "[", 
                  RowBox[{"momenta", ",", "indexpz"}], "]"}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"e", "=", 
                 RowBox[{"Compile`GetElement", "[", 
                  RowBox[{"momenta", ",", "indexenergy"}], "]"}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"m", "=", 
                 RowBox[{"Compile`GetElement", "[", 
                  RowBox[{"momenta", ",", "indexmass"}], "]"}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"p", "=", 
                 SqrtBox[
                  RowBox[{
                   SuperscriptBox["e", "2"], "-", 
                   SuperscriptBox["m", "2"]}]]}], ";", "\[IndentingNewLine]", 
                RowBox[{"ptom", "=", 
                 RowBox[{"p", "/", "m"}]}], ";", "\[IndentingNewLine]", 
                RowBox[{"c\[Theta]", "=", 
                 RowBox[{"pz", "/", "p"}]}], ";", "\[IndentingNewLine]", 
                RowBox[{"(*", 
                 RowBox[{
                 "___", "___", "___", "___", "___", "___", "___", "___", 
                  "___", "___", "___", "___", "___", "___", "___", "___", 
                  "_"}], "*)"}], "\[IndentingNewLine]", 
                RowBox[{"(*", 
                 RowBox[{"Simulating", " ", "the", " ", "scattering"}], 
                 "*)"}], "\[IndentingNewLine]", 
                RowBox[{"(*", 
                 RowBox[{
                 "___", "___", "___", "___", "___", "___", "___", "___", 
                  "___", "___", "___", "___", "___", "___", "___", "___", 
                  "_"}], "*)"}], "\[IndentingNewLine]", 
                RowBox[{"(*", 
                 RowBox[{
                 "Simulating", " ", "the", " ", "coordinate", " ", "of", " ", 
                  "the", " ", "scattering"}], "*)"}], "\[IndentingNewLine]", 
                RowBox[{"rscattrand", "=", 
                 RowBox[{"RandomReal", "[", 
                  RowBox[{"{", 
                   RowBox[{
                    FractionBox["zmin", 
                    RowBox[{"Abs", "[", "c\[Theta]", "]"}]], ",", 
                    FractionBox["zmax", 
                    RowBox[{"Abs", "[", "c\[Theta]", "]"}]]}], "}"}], "]"}]}],
                 ";", "\[IndentingNewLine]", 
                RowBox[{"(*", 
                 RowBox[{
                 "Differential", " ", "scattering", " ", "probability"}], 
                 "*)"}], "\[IndentingNewLine]", 
                RowBox[{"Pscatt", "=", 
                 RowBox[{"If", "[", 
                  RowBox[{"IfProton", ",", 
                   RowBox[{"dPdEdzEminProtons", "[", 
                    RowBox[{"e", ",", "m", ",", "mV", ",", 
                    RowBox[{"Ekmin", "+", "mass"}], ",", "\[Epsilon]2", ",", 
                    "\[Alpha]D"}], "]"}], ",", 
                   RowBox[{"dPdEdzEminElectrons", "[", 
                    RowBox[{"e", ",", "m", ",", "mV", ",", 
                    RowBox[{"Ekmin", "+", "mass"}], ",", "\[Epsilon]2", ",", 
                    "\[Alpha]D"}], "]"}]}], "]"}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"(*", 
                 RowBox[{
                 "Kinematics", " ", "of", " ", "the", " ", "scattering"}], 
                 "*)"}], "\[IndentingNewLine]", 
                RowBox[{"xscatt", "=", 
                 RowBox[{"rscattrand", "*", 
                  FractionBox["px", "p"]}]}], ";", "\[IndentingNewLine]", 
                RowBox[{"yscatt", "=", 
                 RowBox[{"rscattrand", "*", 
                  FractionBox["py", "p"]}]}], ";", "\[IndentingNewLine]", 
                RowBox[{"zscatt", "=", 
                 RowBox[{"rscattrand", "*", 
                  FractionBox["pz", "p"]}]}], ";", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                  "cos\[Theta]f", ",", "Ef", ",", "pxf", ",", "pyf", ",", 
                   "pzf"}], "}"}], "=", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"Pscatt", "!=", "0."}], ",", 
                   RowBox[{"rm", "[", 
                    RowBox[{
                    "m", ",", "mV", ",", "e", ",", "px", ",", "py", ",", "pz",
                     ",", "Ekmin", ",", "IfProton"}], "]"}], ",", 
                   RowBox[{"{", 
                    RowBox[{
                    "0.", ",", "mass", ",", "0.", ",", "0.", ",", "0"}], 
                    "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
                RowBox[{"{", 
                 RowBox[{
                 "px", ",", "py", ",", "pz", ",", "e", ",", "m", ",", 
                  "c\[Theta]", ",", "ptom", ",", "Pscatt", ",", "xscatt", ",",
                   "yscatt", ",", "zscatt", ",", "cos\[Theta]f", ",", "pxf", ",",
                   "pyf", ",", "pzf", ",", "Ef", ",", 
                  RowBox[{"px", "-", "pxf"}], ",", 
                  RowBox[{"py", "-", "pyf"}], ",", 
                  RowBox[{"pz", "-", "pzf"}], ",", 
                  RowBox[{"e", "+", "mass", "-", "Ef"}]}], "}"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", 
             RowBox[{"CompilationTarget", "\[Rule]", "\"\<C\>\""}], ",", 
             RowBox[{"RuntimeOptions", "\[Rule]", "\"\<Speed\>\""}], ",", 
             RowBox[{"RuntimeAttributes", "->", 
              RowBox[{"{", "Listable", "}"}]}], ",", 
             RowBox[{"Parallelization", "->", "True"}], ",", 
             RowBox[{"CompilationOptions", "->", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"\"\<InlineCompiledFunctions\>\"", "->", "True"}], ",", 
                RowBox[{"\"\<InlineExternalDefinitions\>\"", "->", "True"}]}],
                "}"}]}]}], "]"}]}], "/.", 
          RowBox[{"ruleOwn", "[", 
           RowBox[{"{", 
            RowBox[{
            "ME", ",", "MP", ",", "indexpx", ",", "indexpy", ",", "indexpz", ",",
              "indexptom", ",", "indexenergy", ",", "indexc\[Theta]", ",", 
             "indexmass"}], "}"}], "]"}]}], "/.", 
         RowBox[{"ruleDown", "[", 
          RowBox[{"{", 
           RowBox[{
           "dPdEdzEminElectrons", ",", "dPdEdzEminProtons", ",", 
            "cos\[Theta]scatt"}], "}"}], "]"}]}], "//", "ReleaseHold"}]}], 
      "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"<<", "CompiledFunctionTools`"}], ";", "\[IndentingNewLine]", 
    RowBox[{"CompilePrint", "@", "SampledScattering"}], ";"}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.9382432537977734`*^9, 3.938243313336197*^9}, {
   3.938243349206835*^9, 3.9382433534916496`*^9}, {3.9382480195073853`*^9, 
   3.9382480196503754`*^9}, {3.9382480634706745`*^9, 3.9382480855892086`*^9}, 
   3.9382481841892223`*^9, {3.93824832299102*^9, 3.9382483736920643`*^9}, {
   3.9382484857607555`*^9, 3.9382485084304695`*^9}, {3.938248594454544*^9, 
   3.938248597055023*^9}, {3.9382486919025993`*^9, 3.938248805183014*^9}, {
   3.938248869035553*^9, 3.938248890485323*^9}, {3.938248927495552*^9, 
   3.9382490313056793`*^9}, {3.9382492144120865`*^9, 3.938249252244652*^9}, {
   3.9382493126458282`*^9, 3.9382494293591156`*^9}, {3.9382496796713943`*^9, 
   3.938249717772852*^9}, {3.9382503440367775`*^9, 3.9382503596836624`*^9}, 
   3.938250583489401*^9, {3.9382508691356716`*^9, 3.938251067759556*^9}, {
   3.9382511138037853`*^9, 3.9382513414067383`*^9}, {3.938251512278467*^9, 
   3.938251556531082*^9}, {3.938251701038151*^9, 3.938251815884262*^9}, {
   3.9383891584384823`*^9, 3.9383891653375263`*^9}, {3.9391177134312706`*^9, 
   3.9391177359697647`*^9}, {3.939118191962631*^9, 3.939118230199518*^9}, {
   3.939118268107134*^9, 3.93911831545463*^9}, {3.939118348759098*^9, 
   3.939118529767311*^9}, {3.939118562628668*^9, 3.939118609446327*^9}, {
   3.9391186566575947`*^9, 3.939118691303152*^9}, {3.9391187565088806`*^9, 
   3.9391189156599865`*^9}, {3.9391191101921577`*^9, 3.9391191525461845`*^9}, 
   3.9391200317150173`*^9, {3.9391203463444805`*^9, 3.9391203466832485`*^9}, {
   3.9391204744376335`*^9, 3.9391204873014183`*^9}, {3.939120819730196*^9, 
   3.9391208232743454`*^9}, {3.9403155540825176`*^9, 3.940315585181446*^9}, 
   3.942686914613697*^9},
 CellLabel->"In[12]:=",ExpressionUUID->"da26e628-0453-5540-9e35-ff0c84740e50"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Computing the azimuthal weight", "Subsection",
 CellChangeTimes->{{3.9116319041526337`*^9, 3.91163191593644*^9}, {
  3.9116392780604153`*^9, 3.9116392799634876`*^9}},
 CellTags->
  "Re-evaluation",ExpressionUUID->"0ed973a0-e9fa-4a90-b912-9cecdcbbc94e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Epsilon]AzRandomVals", "[", 
   RowBox[{
   "Events\[Phi]Unweighted_", ",", "outcos\[Theta]logdense_", ",", 
    "zgridlog_", ",", 
    RowBox[{"(*", 
     RowBox[{"nfAzc\[Theta]_", ",", "nfAzZ_", ","}], "*)"}], 
    "\[Epsilon]AzLog_"}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"randc\[Theta]log", ",", "randzlog"}], "}"}], "=", 
      RowBox[{"Log", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Events\[Phi]Unweighted", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "#"}], "]"}], "]"}], "&"}], "/@", 
        RowBox[{"{", 
         RowBox[{"6", ",", "11"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"indexLogc\[Theta]Az", "=", 
      RowBox[{
       RowBox[{"nfAzc\[Theta]", "[", "randc\[Theta]log", "]"}], "//", 
       "Flatten"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"indexLogzAz", "=", 
      RowBox[{
       RowBox[{"nfAzZ", "[", "randzlog", "]"}], "//", "Flatten"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"rand\[Epsilon]Az", "=", 
      RowBox[{"linint2", "[", 
       RowBox[{
       "randc\[Theta]log", ",", "randzlog", ",", "outcos\[Theta]logdense", ",",
         "zgridlog", ",", "indexLogc\[Theta]Az", ",", "indexLogzAz", ",", 
        "\[Epsilon]AzLog"}], "]"}]}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.911638984680003*^9, 3.9116390070543756`*^9}, {
   3.911639273985897*^9, 3.911639274103898*^9}, {3.911641210628705*^9, 
   3.911641218719493*^9}, {3.911641828459739*^9, 3.9116418330163803`*^9}, 
   3.9116420804714465`*^9, {3.911642125798625*^9, 3.9116421292674932`*^9}, {
   3.9116427878629026`*^9, 3.9116427952409554`*^9}, {3.911883203125651*^9, 
   3.9118832036855774`*^9}, {3.917627479204224*^9, 3.9176274802228613`*^9}, {
   3.917628454646085*^9, 3.917628457024316*^9}, {3.917629097951684*^9, 
   3.9176291017995076`*^9}, {3.917629661445813*^9, 3.9176296631231728`*^9}, {
   3.9201921396115046`*^9, 3.920192169751388*^9}, {3.920192247198319*^9, 
   3.9201922474528036`*^9}, {3.9201923561662807`*^9, 
   3.9201923768478785`*^9}, {3.9201924132481375`*^9, 
   3.9201924141841316`*^9}, {3.9290956532213774`*^9, 
   3.9290956632750444`*^9}, {3.9292912645201516`*^9, 3.929291267296177*^9}},
 CellTags->"Re-evaluation",
 CellLabel->"In[13]:=",ExpressionUUID->"57ca03e4-ce6b-4136-be1d-817942318aac"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Final blocks", "Section",
 CellChangeTimes->{{3.91164496726744*^9, 3.911644968442995*^9}, {
  3.9312743862772255`*^9, 3.9312743886721964`*^9}},
 CellTags->
  "Re-evaluation",ExpressionUUID->"16b5cd7c-9029-48ac-8056-0aba02e4af9a"],

Cell[CellGroupData[{

Cell["Decaying LLP", "Subsection",
 CellChangeTimes->{{3.931274396909507*^9, 3.9312744000917892`*^9}, {
  3.938247848637602*^9, 
  3.938247849104*^9}},ExpressionUUID->"b1716f1a-8a4f-497c-9978-408b82f66214"],

Cell[CellGroupData[{

Cell["Table with decaying LLP data", "Subsubsection",
 CellChangeTimes->{{3.9382478389145775`*^9, 
  3.938247846453575*^9}},ExpressionUUID->"7ab96a0b-5558-ed4d-8c5c-\
70f94b3ef82d"],

Cell[BoxData[
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"!", 
    RowBox[{"StringContainsQ", "[", 
     RowBox[{"LLPdirName", ",", "\"\<LDM\>\""}], "]"}]}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"EventBlockFinal", "[", 
      RowBox[{"mLLP_", ",", "coupling1_", ",", "coupling2_", ",", "Nev_"}], 
      "]"}], ":=", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"c\[Tau]LLPval", "=", 
         RowBox[{"c\[Tau]LLP", "[", 
          RowBox[{"mLLP", ",", "coupling1"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"___", "___", "___", "___", "___", "___", "___", "___"}], 
         "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Generating", " ", "the", " ", "kinematics"}], " ", "-", 
          " ", "4", "-", 
          RowBox[{
          "momenta", " ", "intersecting", " ", "the", " ", "decay", " ", 
           "volume"}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"___", "___", "___", "___", "___", "___", "___", "___"}], 
         "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "Total", " ", "number", " ", "of", " ", "LLPs", " ", "produced", " ",
           "at", " ", "the", " ", "given", " ", "facility", " ", "for", " ", 
          "the", " ", "given", " ", "values", " ", "of", " ", "coupling1", " ",
           "and", " ", "coupling2"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"Nprodtot", "=", 
         RowBox[{"NpotGivenExperiment", "*", 
          RowBox[{"ProbabilityLLPprodTot", "[", 
           RowBox[{"mLLP", ",", "coupling1", ",", "coupling2"}], "]"}]}]}], ";",
         "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"c\[Tau]", " ", "and", " ", 
           RowBox[{"experiment", "'"}], "s", " ", "geometry", " ", 
           "constrain", " ", "the", " ", "angles", " ", "and", " ", 
           "energies", " ", "of", " ", "interest", " ", "by", " ", 
           RowBox[{"{", 
            RowBox[{"\[Theta]minreduced", ",", "\[Theta]maxreduced"}], 
            "}"}]}], ",", " ", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"EminReduced", ",", "EmaxReduced"}], "}"}], " ", 
           "correspondingly"}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"EventsProd", "=", 
         RowBox[{"KinematicsFromTabulatedDistribution", "[", 
          RowBox[{
          "mLLP", ",", "coupling1", ",", "coupling2", ",", "Nev", ",", 
           "c\[Tau]LLPval"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "The", " ", "geometric", " ", "yield", " ", "of", " ", "LLPs", " ", 
          "flying", " ", "to", " ", "the", " ", 
          RowBox[{"experiment", ".", " ", "Defined"}], " ", "as", " ", 
          SubscriptBox["N", "prod"], 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              SubscriptBox["\[Theta]", 
               RowBox[{"min", ",", "eff"}]], "<", "\[Theta]", "<", 
              SubscriptBox["\[Theta]", 
               RowBox[{"max", ",", "eff"}]]}], " ", "&&", " ", 
             RowBox[{
              SubscriptBox["E", 
               RowBox[{"min", ",", "eff"}]], "<", "E"}]}], ")"}], "/", 
           SubscriptBox["N", "PoT"]}], 
          SubscriptBox["P", 
           RowBox[{"LLP", ",", "prod", ",", "total"}]]}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"yield", "=", 
         RowBox[{"LLPyield\[Theta]", "[", 
          RowBox[{
          "mLLP", ",", "coupling1", ",", "coupling2", ",", 
           "\[Theta]minreduced", ",", "\[Theta]maxreduced", ",", 
           "EminReduced", ",", "EmaxReduced"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
          "Convering", " ", "angles", " ", "and", " ", "energies", " ", "to", 
           " ", "the", " ", "4"}], "-", 
          RowBox[{
          "momenta", " ", "with", " ", "the", " ", "directions", " ", 
           "intersecting", " ", "the", " ", "decay", " ", "volume"}]}], 
         "*)"}], "\[IndentingNewLine]", 
        RowBox[{"momenta", "=", 
         RowBox[{"Momenta", "[", 
          RowBox[{"EventsProd", ",", 
           RowBox[{"-", "Pi"}], ",", "Pi"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "List", " ", "of", " ", "the", " ", "nearest", " ", "indices", " ", 
          "of", " ", "the", " ", "closest", " ", "neighbor", " ", "of", " ", 
          "zvals", " ", "to", " ", "the", " ", "randomly", " ", "generated", " ",
           "seed", " ", "zs", " ", "of", " ", "the", " ", "decay", " ", 
          "vertex", " ", "inside", " ", "the", " ", "decay", " ", "volume", " ", 
          RowBox[{"(", 
           RowBox[{"momenta", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", 
              RowBox[{"-", "1"}]}], "]"}], "]"}], ")"}]}], "*)"}], " ", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Here", ",", " ", 
          RowBox[{
          "zvals", " ", "is", " ", "a", " ", "large", " ", "list", " ", "of", 
           " ", "randomly", " ", "generated", " ", "z", " ", "values", " ", 
           "inside", " ", "the", " ", "decay", " ", "volume"}], ",", " ", 
          RowBox[{
          "defined", " ", "in", " ", "the", " ", "main", " ", "module"}]}], 
         "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Here", ",", " ", 
          RowBox[{"nfzvals", "=", 
           RowBox[{"Nearest", "[", 
            RowBox[{"zvals", "->", "\"\<Index\>\""}], "]"}]}]}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"indexlist", "=", 
         RowBox[{
          RowBox[{"nfzvals", "[", 
           RowBox[{"momenta", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", 
              RowBox[{"-", "1"}]}], "]"}], "]"}], "]"}], "//", "Flatten"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "Generating", " ", "true", " ", "decay", " ", "vertices", " ", 
          "solely", " ", "inside", " ", "the", " ", "decay", " ", "volume"}], 
         "*)"}], "\[IndentingNewLine]", 
        RowBox[{"EventsProdDecay\[Phi]Unweighted", "=", 
         RowBox[{"SampledDecays", "[", 
          RowBox[{
          "c\[Tau]LLPval", ",", "momenta", ",", "zvals", ",", "indexlist"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "Azimuthal", " ", "acceptances", " ", "for", " ", "the", " ", 
          "given", " ", "decay", " ", "vertices"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"AzAccs", "=", 
         RowBox[{"\[Epsilon]AzRandomVals", "[", 
          RowBox[{
          "EventsProdDecay\[Phi]Unweighted", ",", 
           "outcos\[Theta]logdenseAzAcc", ",", "zgridlog", ",", 
           RowBox[{"(*", 
            RowBox[{"nfAzc\[Theta]", ",", "nfAzZ", ","}], "*)"}], 
           "\[Epsilon]AzLog"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Join", "[", 
          RowBox[{"EventsProdDecay\[Phi]Unweighted", ",", 
           RowBox[{"Partition", "[", 
            RowBox[{"AzAccs", ",", "1"}], "]"}], ",", 
           RowBox[{"ConstantArray", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"Nprodtot", ",", "yield"}], "}"}], ",", "Nev"}], "]"}], 
           ",", "2"}], "]"}], "//", "Developer`ToPackedArray"}]}]}], 
      "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"NeventsLLP", "[", "data_", "]"}], ":=", 
     RowBox[{
      FractionBox[
       RowBox[{"Total", "[", 
        RowBox[{
         RowBox[{"data", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "8"}], "]"}], "]"}], "*", 
         RowBox[{"data", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "12"}], "]"}], "]"}]}], "]"}], 
       RowBox[{"Length", "[", "data", "]"}]], "*", 
      RowBox[{
       RowBox[{"data", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"-", "1"}], "]"}], "]"}], "*", 
      RowBox[{
       RowBox[{"data", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"-", "2"}], "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"Merged", " ", "data"}], " ", "-", " ", "LLPs", " ", "+", " ", 
      RowBox[{"their", " ", "decay", " ", "products"}]}], "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"SimulateFullEvent", "[", 
      RowBox[{
      "mLLP_", ",", "coupling1_", ",", "coupling2_", ",", "Nev_", ",", 
       "HadronizationOption_", ",", "DecayUnstable_"}], "]"}], ":=", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"llpevents", "=", 
         RowBox[{"EventBlockFinal", "[", 
          RowBox[{"mLLP", ",", "coupling1", ",", "coupling2", ",", "Nev"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"phasespacedecaysrest", "=", 
         RowBox[{"PhaseSpacePerDecayFinal", "[", 
          RowBox[{
          "mLLP", ",", "Nev", ",", "HadronizationOption", ",", 
           "DecayUnstable"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"boostedphasespace", "=", 
         RowBox[{"TabBoostedDecayProducts", "[", 
          RowBox[{"llpevents", ",", "phasespacedecaysrest"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"llpevents", ",", "boostedphasespace"}], "}"}]}]}], 
      "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"SimulateFullEvent", "[", 
      RowBox[{"mLLP_", ",", "coupling1_", ",", "coupling2_", ",", "Nev_"}], 
      "]"}], ":=", 
     RowBox[{"SimulateFullEvent", "[", 
      RowBox[{
      "mLLP", ",", "coupling1", ",", "coupling2", ",", "Nev", 
       ",", "\"\<False\>\"", ",", "False"}], "]"}]}]}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.911644969437228*^9, 3.911644970432927*^9}, {
   3.9116452677281904`*^9, 3.9116452727045813`*^9}, {3.9116694089998055`*^9, 
   3.9116694096756535`*^9}, {3.9118811611509714`*^9, 3.911881168298053*^9}, {
   3.9118812847776136`*^9, 3.911881285506384*^9}, {3.911881694264696*^9, 
   3.9118816944557724`*^9}, {3.9118832089114494`*^9, 3.911883212573458*^9}, {
   3.917623017752329*^9, 3.9176230804741263`*^9}, {3.917623133629085*^9, 
   3.917623213393922*^9}, {3.9176232756067867`*^9, 3.9176233039612985`*^9}, {
   3.9176253648554773`*^9, 3.917625377705963*^9}, {3.917625507058048*^9, 
   3.9176256539927855`*^9}, {3.9176260038902082`*^9, 3.917626018622908*^9}, {
   3.917626326239713*^9, 3.9176263740179977`*^9}, {3.9176264834321227`*^9, 
   3.917626484475614*^9}, {3.917626556667777*^9, 3.9176265692666073`*^9}, {
   3.917627098984126*^9, 3.91762711488721*^9}, {3.917627147943594*^9, 
   3.9176271590094357`*^9}, {3.9176274914554415`*^9, 3.917627492821791*^9}, {
   3.91762775290357*^9, 3.917627755802599*^9}, {3.917628100312602*^9, 
   3.9176281039402313`*^9}, {3.9176283937794633`*^9, 
   3.9176283967103643`*^9}, {3.917628459782074*^9, 3.917628461480065*^9}, {
   3.9176291078904285`*^9, 3.9176291108207417`*^9}, {3.9176296494557424`*^9, 
   3.9176296511362624`*^9}, 3.9176694457849884`*^9, {3.9177116495346622`*^9, 
   3.91771166410505*^9}, 3.9177219542483234`*^9, 3.917888155802519*^9, {
   3.9184630548791065`*^9, 3.9184630584010363`*^9}, 3.918663536036964*^9, 
   3.91866540364296*^9, {3.919066714401845*^9, 3.9190667146797915`*^9}, {
   3.929095707621456*^9, 3.929095718173401*^9}, {3.9291136010331607`*^9, 
   3.9291136020482616`*^9}, {3.9292913098787537`*^9, 
   3.9292913182189856`*^9}, {3.931247551795231*^9, 3.9312475675761557`*^9}, {
   3.9312476172043457`*^9, 3.9312477056632156`*^9}, {3.9312477670497503`*^9, 
   3.9312479581155767`*^9}, {3.9312479913623743`*^9, 
   3.9312480277215323`*^9}, {3.931248092115157*^9, 3.931248093859252*^9}, {
   3.931248752730275*^9, 3.9312487612936096`*^9}, {3.9312495374837255`*^9, 
   3.931249582487956*^9}, {3.931249669933941*^9, 3.9312497297214565`*^9}, {
   3.9312498069453373`*^9, 3.931249807467951*^9}, {3.931250023164051*^9, 
   3.931250053862242*^9}, 3.9312742058066325`*^9, {3.935514383879341*^9, 
   3.935514419198468*^9}, {3.935514659403081*^9, 3.9355146994608226`*^9}, {
   3.935515409630453*^9, 3.935515412760107*^9}, 3.9382432854230824`*^9, {
   3.938247792556896*^9, 3.9382478188797035`*^9}, {3.9382479788659897`*^9, 
   3.938247993728977*^9}, {3.938248053561268*^9, 3.9382480541952724`*^9}, {
   3.9424645251586514`*^9, 3.94246455354895*^9}, 3.9426870178291245`*^9},
 CellTags->"Re-evaluation",
 CellLabel->"In[14]:=",ExpressionUUID->"378d4346-8486-43a2-b8c7-35c332f7457f"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Test", "Subsubsection",
 CellChangeTimes->{{3.931274421522025*^9, 
  3.93127442210804*^9}},ExpressionUUID->"14a2129b-be34-4cab-8049-\
b31deae5c7c8"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"test", "!=", "1"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"mt", "=", "0.4"}], ";", "\[IndentingNewLine]", 
        RowBox[{"datt", "=", 
         RowBox[{"EventBlockFinal", "[", 
          RowBox[{"mt", ",", 
           SuperscriptBox["10", 
            RowBox[{"-", "15"}]], ",", "0", ",", 
           SuperscriptBox["10", "6"]}], "]"}]}], ";"}], "//", 
       "AbsoluteTiming"}]}], "]"}], "\[IndentingNewLine]", 
    RowBox[{"DecPos", "=", 
     RowBox[{"datt", "[", 
      RowBox[{"[", 
       RowBox[{"All", ",", 
        RowBox[{"{", 
         RowBox[{"indexxdec", ",", "indexydec", ",", "indexzdec"}], "}"}]}], 
       "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
   RowBox[{"ifinside", "=", 
    RowBox[{"IfLLPinsideDecVol", "@@@", 
     RowBox[{"DecPos", "[", 
      RowBox[{"[", 
       RowBox[{"All", ",", 
        RowBox[{"{", 
         RowBox[{"3", ",", "1", ",", "2"}], "}"}]}], "]"}], "]"}]}]}], ";", 
   "\[IndentingNewLine]", 
   RowBox[{"ifinside", "//", 
    RowBox[{"MinMax", "\[IndentingNewLine]", 
     RowBox[{"energies", "=", 
      RowBox[{"datt", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "4"}], "]"}], "]"}]}]}]}], ";", 
   "\[IndentingNewLine]", 
   RowBox[{"wts", "=", 
    RowBox[{
     RowBox[{"datt", "[", 
      RowBox[{"[", 
       RowBox[{"All", ",", "indexpdec"}], "]"}], "]"}], "*", 
     RowBox[{"datt", "[", 
      RowBox[{"[", 
       RowBox[{"All", ",", "indexazacc"}], "]"}], "]"}]}]}], ";", 
   "\[IndentingNewLine]", 
   RowBox[{"TruePos", "=", 
    RowBox[{"RandomChoice", "[", 
     RowBox[{
      RowBox[{"wts", "->", "DecPos"}], ",", 
      SuperscriptBox["10", "4"]}], "]"}]}], ";", "\[IndentingNewLine]", 
   RowBox[{"TrueEn", "=", 
    RowBox[{"RandomChoice", "[", 
     RowBox[{
      RowBox[{"wts", "->", "energies"}], ",", 
      SuperscriptBox["10", "4"]}], "]"}]}], ";", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"xminmaxplot", ",", "yminmaxplot", ",", "zminmaxplot"}], "}"}], "=", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"DecPos", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "#"}], "]"}], "]"}], "//", "MinMax"}], ")"}], 
      "&"}], "/@", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2", ",", "3"}], "}"}]}]}], ";", 
   "\[IndentingNewLine]", 
   RowBox[{"zminmaxplot", "=", 
    RowBox[{"zminmaxplot", "+", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "1"}], ",", "1"}], "}"}], 
      RowBox[{"Min", "[", 
       RowBox[{"1", ",", 
        FractionBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"zminmaxplot", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "-", 
           RowBox[{"zminmaxplot", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "10"]}], "]"}]}]}]}], ";",
    "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Show", "[", 
     RowBox[{
      RowBox[{"ListPointPlot3D", "[", 
       RowBox[{"TruePos", ",", 
        RowBox[{"PlotStyle", "->", 
         RowBox[{"{", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Thickness", "[", "0.01", "]"}], ",", "Blue"}], "}"}], 
          "}"}]}]}], "]"}], ",", "plotExperiment", ",", 
      RowBox[{"PlotRange", "->", 
       RowBox[{"{", 
        RowBox[{"xminmaxplot", ",", "yminmaxplot", ",", "zminmaxplot"}], 
        "}"}]}]}], "]"}], "\[IndentingNewLine]", 
    RowBox[{"Histogram", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"TrueEn", ",", "energies"}], "}"}], ",", "100", 
      ",", "\"\<ProbabilityDensity\>\"", ",", 
      RowBox[{"PlotRange", "->", "All"}], ",", 
      RowBox[{"ScalingFunctions", "->", 
       RowBox[{"{", 
        RowBox[{"\"\<Linear\>\"", ",", "\"\<Log\>\""}], "}"}]}]}], "]"}]}]}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.917669151101343*^9, 3.9176691515911436`*^9}, {
   3.9176693488512363`*^9, 3.9176695321171365`*^9}, {3.9177130656252327`*^9, 
   3.9177130784467697`*^9}, {3.917713149564518*^9, 3.917713150154813*^9}, {
   3.9178881654487023`*^9, 3.917888171434925*^9}, {3.9178892212148366`*^9, 
   3.917889228502762*^9}, {3.9179545225539637`*^9, 3.917954571335988*^9}, {
   3.9184604363268304`*^9, 3.9184604753783283`*^9}, {3.9184631683415623`*^9, 
   3.91846319785392*^9}, {3.9186654243398476`*^9, 3.918665425184121*^9}, {
   3.919015440731169*^9, 3.9190154452776237`*^9}, {3.9190648674132404`*^9, 
   3.9190648958483644`*^9}, {3.9190649434530315`*^9, 
   3.9190649485275507`*^9}, {3.919065003481273*^9, 3.919065005067029*^9}, {
   3.929095793438738*^9, 3.9290957972170706`*^9}, {3.9290958331086965`*^9, 
   3.929095857842127*^9}, {3.9290959716714263`*^9, 3.929096014585144*^9}, {
   3.929096062756893*^9, 3.9290961151683617`*^9}, {3.9291136172920213`*^9, 
   3.9291136976833534`*^9}, {3.929291627295681*^9, 3.929291630539795*^9}, 
   3.9292917030993013`*^9, {3.9292928777024684`*^9, 3.9292928803800025`*^9}, {
   3.929292964418432*^9, 3.929292981526045*^9}, {3.929293643091198*^9, 
   3.9292937563276434`*^9}, {3.929293928345518*^9, 3.9292940596565456`*^9}, {
   3.929294095494506*^9, 3.92929410491331*^9}, {3.9299857627553215`*^9, 
   3.929985765799593*^9}, {3.9299858024726653`*^9, 3.9299858299972973`*^9}, {
   3.9299861180181675`*^9, 3.9299861186351085`*^9}, {3.931238165933587*^9, 
   3.93123816615563*^9}, {3.931250086951096*^9, 3.9312501065357523`*^9}, {
   3.9312501700441947`*^9, 3.931250193642949*^9}, {3.9312502270559216`*^9, 
   3.931250272771588*^9}, {3.931250314359795*^9, 3.9312503438173947`*^9}, {
   3.9312503813112235`*^9, 3.93125053059177*^9}, {3.931250564516182*^9, 
   3.9312506321300116`*^9}, {3.9312507016688786`*^9, 3.931250743829096*^9}, {
   3.9312508153643503`*^9, 3.9312508336032324`*^9}, {3.9312508862678595`*^9, 
   3.931250890374934*^9}, {3.9312509263946805`*^9, 3.931250928460569*^9}, {
   3.9312509707362924`*^9, 3.931250972652506*^9}, {3.931251177416563*^9, 
   3.931251201013474*^9}, {3.9312742107558327`*^9, 3.9312742130323257`*^9}, {
   3.9312743483938055`*^9, 3.9312743484676294`*^9}, {3.9355144449998474`*^9, 
   3.9355144811590805`*^9}},
 CellLabel->"In[22]:=",ExpressionUUID->"474c5d83-59c5-470d-a895-2ee6609d0cc0"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Scattering LLP", "Subsection",
 CellChangeTimes->{{3.93825184029303*^9, 
  3.9382518422337837`*^9}},ExpressionUUID->"9f34f80b-f03d-e147-b4a0-\
5dcf9637979d"],

Cell[BoxData[
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"StringContainsQ", "[", 
    RowBox[{"LLPdirName", ",", "\"\<LDM\>\""}], "]"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"EventBlockFinal", "[", 
      RowBox[{
      "m\[Chi]_", ",", "mV_", ",", "\[Epsilon]2_", ",", "\[Alpha]D_", ",", 
       "Nev_", ",", "Ekmin_", ",", "IfProton_"}], "]"}], ":=", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"___", "___", "___", "___", "___", "___", "___", "___"}], 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Generating", " ", "the", " ", "kinematics"}], " ", "-", " ",
          "4", "-", 
         RowBox[{
         "momenta", " ", "intersecting", " ", "the", " ", "decay", " ", 
          "volume"}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"___", "___", "___", "___", "___", "___", "___", "___"}], 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "Total", " ", "number", " ", "of", " ", "LLPs", " ", "produced", " ", 
         "at", " ", "the", " ", "given", " ", "facility", " ", "for", " ", 
         "the", " ", "given", " ", "values", " ", "of", " ", "coupling1", " ",
          "and", " ", "coupling2"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Nprodtot", "=", 
         RowBox[{"NpotGivenExperiment", "*", 
          RowBox[{"ProbabilityLLPprodTot", "[", 
           RowBox[{"m\[Chi]", ",", "\[Epsilon]2", ",", "1"}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Experiment", "'"}], "s", " ", "geometry", " ", "constrain",
           " ", "the", " ", "angles", " ", "of", " ", "interest", " ", "by", " ", 
          RowBox[{"{", 
           RowBox[{"\[Theta]minreduced", ",", "\[Theta]maxreduced"}], "}"}]}],
          "*)"}], "\[IndentingNewLine]", 
        RowBox[{"EventsProd", "=", 
         RowBox[{"KinematicsFromTabulatedDistribution", "[", 
          RowBox[{
          "m\[Chi]", ",", "\[Epsilon]2", ",", "1", ",", "Nev", ",", 
           "c\[Tau]LLPval"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "The", " ", "geometric", " ", "yield", " ", "of", " ", "LLPs", " ", 
          "flying", " ", "to", " ", "the", " ", 
          RowBox[{"experiment", ".", " ", "Defined"}], " ", "as", " ", 
          SubscriptBox["N", "prod"], 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              SubscriptBox["\[Theta]", 
               RowBox[{"min", ",", "eff"}]], "<", "\[Theta]", "<", 
              SubscriptBox["\[Theta]", 
               RowBox[{"max", ",", "eff"}]]}], " ", "&&", " ", 
             RowBox[{
              SubscriptBox["E", 
               RowBox[{"min", ",", "eff"}]], "<", "E"}]}], ")"}], "/", 
           SubscriptBox["N", "PoT"]}], 
          SubscriptBox["P", 
           RowBox[{"LLP", ",", "prod", ",", "total"}]]}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"yield", "=", 
         RowBox[{"LLPyield\[Theta]", "[", 
          RowBox[{
          "m\[Chi]", ",", "\[Epsilon]2", ",", "1", ",", "\[Theta]minreduced", 
           ",", "\[Theta]maxreduced", ",", "EminReduced", ",", 
           "EmaxReduced"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
          "Convering", " ", "angles", " ", "and", " ", "energies", " ", "to", 
           " ", "the", " ", "4"}], "-", 
          RowBox[{
          "momenta", " ", "with", " ", "the", " ", "directions", " ", 
           "intersecting", " ", "the", " ", "decay", " ", "volume"}]}], 
         "*)"}], "\[IndentingNewLine]", 
        RowBox[{"momenta", "=", 
         RowBox[{"Momenta", "[", 
          RowBox[{"EventsProd", ",", 
           RowBox[{"-", "Pi"}], ",", "Pi"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "List", " ", "of", " ", "the", " ", "nearest", " ", "indices", " ", 
          "of", " ", "the", " ", "closest", " ", "neighbor", " ", "of", " ", 
          "zvals", " ", "to", " ", "the", " ", "randomly", " ", "generated", " ",
           "seed", " ", "zs", " ", "of", " ", "the", " ", "decay", " ", 
          "vertex", " ", "inside", " ", "the", " ", "decay", " ", "volume", " ", 
          RowBox[{"(", 
           RowBox[{"momenta", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", 
              RowBox[{"-", "1"}]}], "]"}], "]"}], ")"}]}], "*)"}], " ", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Here", ",", " ", 
          RowBox[{
          "zvals", " ", "is", " ", "a", " ", "large", " ", "list", " ", "of", 
           " ", "randomly", " ", "generated", " ", "z", " ", "values", " ", 
           "inside", " ", "the", " ", "decay", " ", "volume"}]}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Here", ",", " ", 
          RowBox[{"nfzvals", "=", 
           RowBox[{"Nearest", "[", 
            RowBox[{"zvals", "->", "\"\<Index\>\""}], "]"}]}]}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"indexlist", "=", 
         RowBox[{
          RowBox[{"nfzvals", "[", 
           RowBox[{"momenta", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", 
              RowBox[{"-", "1"}]}], "]"}], "]"}], "]"}], "//", "Flatten"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Returning", " ", "scattering", " ", "data"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"EventsProdDecay\[Phi]Unweighted", "=", 
         RowBox[{"SampledScattering", "[", 
          RowBox[{
          "\[Epsilon]2", ",", "\[Alpha]D", ",", "mV", ",", "momenta", ",", 
           "zvals", ",", "indexlist", ",", "Ekmin", ",", "IfProton"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "Azimuthal", " ", "acceptances", " ", "for", " ", "the", " ", 
          "given", " ", "decay", " ", "vertices"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"AzAccs", "=", 
         RowBox[{"\[Epsilon]AzRandomVals", "[", 
          RowBox[{
          "EventsProdDecay\[Phi]Unweighted", ",", 
           "outcos\[Theta]logdenseAzAcc", ",", "zgridlog", ",", 
           RowBox[{"(*", 
            RowBox[{"nfAzc\[Theta]", ",", "nfAzZ", ","}], "*)"}], 
           "\[Epsilon]AzLog"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Join", "[", 
          RowBox[{"EventsProdDecay\[Phi]Unweighted", ",", 
           RowBox[{"Partition", "[", 
            RowBox[{"AzAccs", ",", "1"}], "]"}], ",", 
           RowBox[{"ConstantArray", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"Nprodtot", ",", "yield"}], "}"}], ",", "Nev"}], "]"}], 
           ",", "2"}], "]"}], "//", "Developer`ToPackedArray"}]}]}], 
      "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{
       RowBox[{"Total", " ", "number", " ", "of", " ", "events"}], " ", "-", 
       " ", 
       RowBox[{
       "effectively", " ", "corresponds", " ", "to", " ", "the", " ", 
        "integral", " ", "over", " ", "energies"}]}], ",", " ", "angles", ",",
       " ", "z", ",", " ", 
      RowBox[{"and", " ", "recoil", " ", "electron", " ", "energies"}]}], 
     "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"NeventsLLP", "[", "data_", "]"}], ":=", 
     RowBox[{
      FractionBox[
       RowBox[{"Total", "[", 
        RowBox[{
         RowBox[{"data", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "8"}], "]"}], "]"}], "*", 
         RowBox[{"data", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "12"}], "]"}], "]"}]}], "]"}], 
       RowBox[{"Length", "[", "data", "]"}]], "*", 
      RowBox[{
       RowBox[{"data", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"-", "1"}], "]"}], "]"}], "*", 
      RowBox[{
       RowBox[{"data", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"-", "2"}], "]"}], "]"}]}]}], ";"}]}], "\[IndentingNewLine]", 
  "]"}]], "Input",
 CellChangeTimes->{{3.938251848278385*^9, 3.938251857460869*^9}, {
   3.9382519031425037`*^9, 3.9382519910724487`*^9}, {3.9382520481646957`*^9, 
   3.9382520702175465`*^9}, {3.938252158791147*^9, 3.938252159027817*^9}, {
   3.9382522053544254`*^9, 3.938252223447073*^9}, {3.9383926273825893`*^9, 
   3.938392627746521*^9}, {3.939119186620352*^9, 3.9391192166458473`*^9}, {
   3.9403119492915173`*^9, 3.940311952104431*^9}, {3.942464351804022*^9, 
   3.9424644995878334`*^9}, 3.942687004745695*^9},
 CellLabel->"In[23]:=",ExpressionUUID->"19a3f3bd-fd44-9949-8a21-be1375c1bbe4"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1430.25, 827.625},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
Magnification:>0.9 Inherited,
FrontEndVersion->"14.2 for Microsoft Windows (64-bit) (December 26, 2024)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"79b205c5-66e0-4359-a8f1-eb25f77ae473"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{
 "Re-evaluation"->{
  Cell[731, 27, 302, 7, 59, "Section",ExpressionUUID->"c59d4ca9-3a01-4964-942a-de9aba7e9814",
   CellTags->"Re-evaluation"],
  Cell[1058, 38, 23433, 458, 1307, "Input",ExpressionUUID->"3253061f-7d26-4e91-947a-78eb50568166",
   CellTags->"Re-evaluation"],
  Cell[24494, 498, 9667, 134, 28, "Output",ExpressionUUID->"cae2bdeb-63c2-f841-9ce7-520db8d6fa6d",
   CellTags->"Re-evaluation"],
  Cell[34164, 634, 46854, 832, 53, "Output",ExpressionUUID->"eb5d1116-6f78-9344-99ad-8ca8aadac77d",
   CellTags->"Re-evaluation"],
  Cell[81021, 1468, 9667, 134, 28, "Output",ExpressionUUID->"4d3c577a-775a-1b4a-ac4a-7beafbe7bbdf",
   CellTags->"Re-evaluation"],
  Cell[90691, 1604, 9681, 135, 28, "Output",ExpressionUUID->"05fd896f-9fd8-754d-a441-45e21e7ca92b",
   CellTags->"Re-evaluation"],
  Cell[171431, 3417, 258, 4, 47, "Subsection",ExpressionUUID->"0ed973a0-e9fa-4a90-b912-9cecdcbbc94e",
   CellTags->"Re-evaluation"],
  Cell[171692, 3423, 2480, 54, 111, "Input",ExpressionUUID->"57ca03e4-ce6b-4136-be1d-817942318aac",
   CellTags->"Re-evaluation"],
  Cell[174221, 3483, 235, 4, 59, "Section",ExpressionUUID->"16b5cd7c-9029-48ac-8056-0aba02e4af9a",
   CellTags->"Re-evaluation"],
  Cell[174896, 3503, 12874, 273, 625, "Input",ExpressionUUID->"378d4346-8486-43a2-b8c7-35c332f7457f",
   CellTags->"Re-evaluation"]}
 }
*)
(*CellTagsIndex
CellTagsIndex->{
 {"Re-evaluation", 203736, 4159}
 }
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 148, 3, 25, "Input",ExpressionUUID->"b3c65ec8-500f-4a04-85de-3df79324be2c"],
Cell[CellGroupData[{
Cell[731, 27, 302, 7, 59, "Section",ExpressionUUID->"c59d4ca9-3a01-4964-942a-de9aba7e9814",
 CellTags->"Re-evaluation"],
Cell[CellGroupData[{
Cell[1058, 38, 23433, 458, 1307, "Input",ExpressionUUID->"3253061f-7d26-4e91-947a-78eb50568166",
 CellTags->"Re-evaluation"],
Cell[24494, 498, 9667, 134, 28, "Output",ExpressionUUID->"cae2bdeb-63c2-f841-9ce7-520db8d6fa6d",
 CellTags->"Re-evaluation"],
Cell[34164, 634, 46854, 832, 53, "Output",ExpressionUUID->"eb5d1116-6f78-9344-99ad-8ca8aadac77d",
 CellTags->"Re-evaluation"],
Cell[81021, 1468, 9667, 134, 28, "Output",ExpressionUUID->"4d3c577a-775a-1b4a-ac4a-7beafbe7bbdf",
 CellTags->"Re-evaluation"],
Cell[90691, 1604, 9681, 135, 28, "Output",ExpressionUUID->"05fd896f-9fd8-754d-a441-45e21e7ca92b",
 CellTags->"Re-evaluation"]
}, Open  ]],
Cell[CellGroupData[{
Cell[100409, 1744, 156, 3, 47, "Subsection",ExpressionUUID->"ba169508-5970-7d4c-9483-44400c1e3d17"],
Cell[100568, 1749, 19923, 497, 625, "Input",ExpressionUUID->"e3ec3a1f-1598-724a-a3e6-6521986c6bde"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[120540, 2252, 284, 4, 59, "Section",ExpressionUUID->"26128561-4d25-4624-85ef-517670b1cd9a"],
Cell[CellGroupData[{
Cell[120849, 2260, 270, 6, 47, "Subsection",ExpressionUUID->"b7fb0259-fe52-4d19-97ee-fd459f554cf2"],
Cell[CellGroupData[{
Cell[121144, 2270, 161, 3, 39, "Subsubsection",ExpressionUUID->"e6a6df27-0771-de4b-8ae9-3733d229d49b"],
Cell[CellGroupData[{
Cell[121330, 2277, 13017, 284, 941, "Input",ExpressionUUID->"a355d38c-d700-4d03-be95-2cd9be076db4"],
Cell[134350, 2563, 291, 7, 28, "Output",ExpressionUUID->"028b4264-b117-c544-bcf9-b2105d0bb2bb"]
}, Open  ]],
Cell[134656, 2573, 5325, 141, 235, "Input",ExpressionUUID->"acaf0c5b-4e51-7343-8bcc-fecb5cbc65a0"]
}, Open  ]],
Cell[CellGroupData[{
Cell[140018, 2719, 166, 3, 39, "Subsubsection",ExpressionUUID->"f1fbf851-3676-9b48-8975-b5edcf3b6def"],
Cell[140187, 2724, 31195, 687, 1939, "Input",ExpressionUUID->"da26e628-0453-5540-9e35-ff0c84740e50"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[171431, 3417, 258, 4, 47, "Subsection",ExpressionUUID->"0ed973a0-e9fa-4a90-b912-9cecdcbbc94e",
 CellTags->"Re-evaluation"],
Cell[171692, 3423, 2480, 54, 111, "Input",ExpressionUUID->"57ca03e4-ce6b-4136-be1d-817942318aac",
 CellTags->"Re-evaluation"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[174221, 3483, 235, 4, 59, "Section",ExpressionUUID->"16b5cd7c-9029-48ac-8056-0aba02e4af9a",
 CellTags->"Re-evaluation"],
Cell[CellGroupData[{
Cell[174481, 3491, 206, 3, 47, "Subsection",ExpressionUUID->"b1716f1a-8a4f-497c-9978-408b82f66214"],
Cell[CellGroupData[{
Cell[174712, 3498, 181, 3, 39, "Subsubsection",ExpressionUUID->"7ab96a0b-5558-ed4d-8c5c-70f94b3ef82d"],
Cell[174896, 3503, 12874, 273, 625, "Input",ExpressionUUID->"378d4346-8486-43a2-b8c7-35c332f7457f",
 CellTags->"Re-evaluation"]
}, Open  ]],
Cell[CellGroupData[{
Cell[187807, 3781, 154, 3, 39, "Subsubsection",ExpressionUUID->"14a2129b-be34-4cab-8049-b31deae5c7c8"],
Cell[187964, 3786, 6243, 144, 263, "Input",ExpressionUUID->"474c5d83-59c5-470d-a895-2ee6609d0cc0"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[194256, 3936, 163, 3, 47, "Subsection",ExpressionUUID->"9f34f80b-f03d-e147-b4a0-5dcf9637979d"],
Cell[194422, 3941, 8893, 202, 488, "Input",ExpressionUUID->"19a3f3bd-fd44-9949-8a21-be1375c1bbe4"]
}, Open  ]]
}, Open  ]]
}
]
*)

