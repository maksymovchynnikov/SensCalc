(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    143562,       3351]
NotebookOptionsPosition[    139347,       3264]
NotebookOutlinePosition[    139784,       3281]
CellTagsIndexPosition[    139741,       3278]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["LLP kinematics sampler", "Chapter",
 CellChangeTimes->{{3.926145535517948*^9, 
  3.9261455434252605`*^9}},ExpressionUUID->"e873c8b5-bd61-46ab-b870-\
6ebc9d2a7669"],

Cell[CellGroupData[{

Cell["Some compiled codes", "Section",
 CellChangeTimes->{{3.926145552684466*^9, 3.926145555194989*^9}, {
  3.9292853803641195`*^9, 
  3.929285382010696*^9}},ExpressionUUID->"05640d86-f38f-4317-abec-\
93c404589b73"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"erandcomp", "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"eminv", ",", "_Real"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"emaxv", ",", "_Real"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"Nev", ",", "_Integer"}], "}"}]}], "}"}], ",", 
     RowBox[{"Log", "[", 
      RowBox[{"RandomReal", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Exp", "[", "eminv", "]"}], ",", 
         RowBox[{"Exp", "[", "emaxv", "]"}]}], "}"}], "]"}], "]"}], ",", 
     RowBox[{"CompilationTarget", "\[Rule]", "\"\<C\>\""}], ",", 
     RowBox[{"RuntimeOptions", "\[Rule]", "\"\<Speed\>\""}], ",", 
     RowBox[{"RuntimeAttributes", "->", 
      RowBox[{"{", "Listable", "}"}]}], ",", 
     RowBox[{"Parallelization", "->", "True"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"LLPdataCompiled", "=", 
  RowBox[{"Compile", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"Events", ",", "_Real", ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"m", ",", "_Real"}], "}"}]}], "}"}], ",", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"thv", ",", "ev", ",", "\[Phi]v", ",", "pv"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"thv", "=", 
        RowBox[{"Compile`GetElement", "[", 
         RowBox[{"Events", ",", "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"ev", "=", 
        RowBox[{"Compile`GetElement", "[", 
         RowBox[{"Events", ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"thv", ",", "ev", ",", "m"}], "}"}]}]}], 
     "\[IndentingNewLine]", "]"}], ",", 
    RowBox[{"CompilationTarget", "\[Rule]", "\"\<C\>\""}], ",", 
    RowBox[{"RuntimeOptions", "\[Rule]", "\"\<Speed\>\""}], ",", 
    RowBox[{"RuntimeAttributes", "->", 
     RowBox[{"{", "Listable", "}"}]}], ",", 
    RowBox[{"Parallelization", "->", "True"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rnd\[Theta]vals", "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"min", ",", "_Real"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"max", ",", "_Real"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"Nev", ",", "_Integer"}], "}"}]}], "}"}], ",", 
     RowBox[{"Log", "[", 
      RowBox[{"RandomReal", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"min", ",", "max"}], "}"}], ",", "Nev"}], "]"}], "]"}], ",", 
     RowBox[{"CompilationTarget", "->", "\"\<C\>\""}], ",", 
     RowBox[{"RuntimeOptions", "->", "\"\<Speed\>\""}], ",", 
     RowBox[{"RuntimeAttributes", "->", 
      RowBox[{"{", "Listable", "}"}]}], ",", 
     RowBox[{"Parallelization", "->", "True"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.9175176695852795`*^9, 3.9175176697626457`*^9}, {
   3.9175179277292223`*^9, 3.91751793670827*^9}, {3.9175188809986243`*^9, 
   3.9175188860361204`*^9}, {3.917519383037899*^9, 3.9175193850002737`*^9}, {
   3.9175198891736536`*^9, 3.917519889726827*^9}, {3.929079848673175*^9, 
   3.929079853355068*^9}, {3.9290854822319875`*^9, 3.9290854908322906`*^9}, 
   3.9290950652494016`*^9, {3.9290951412171063`*^9, 3.929095152842533*^9}, {
   3.9292523096232233`*^9, 3.929252335336094*^9}, {3.9292524499474964`*^9, 
   3.929252459240744*^9}, {3.9292526241740804`*^9, 3.9292526243195653`*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"ce971c1e-7a71-42f9-ad73-72ce21db4cf3"],

Cell[BoxData[
 FormBox[
  InterpretationBox[
   RowBox[{
    TagBox["CompiledFunction",
     "SummaryHead"], "[", 
    DynamicModuleBox[{Typeset`open$$ = False, Typeset`embedState$$ = "Ready"}, 
     TemplateBox[{
       PaneSelectorBox[{False -> GridBox[{{
             PaneBox[
              ButtonBox[
               DynamicBox[
                FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxOpener"]], 
               ButtonFunction :> (Typeset`open$$ = True), Appearance -> None, 
               BaseStyle -> {}, Evaluator -> Automatic, Method -> 
               "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
              Dynamic[{
                Automatic, 
                 3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                  Magnification])}]], 
             GraphicsBox[{
               Thickness[0.038461538461538464`], {
                FaceForm[{
                  GrayLevel[0.93], 
                  Opacity[1.]}], 
                
                FilledCurveBox[{{{1, 4, 3}, {0, 1, 0}, {1, 3, 3}, {0, 1, 0}, {
                 1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {0, 1, 0}}}, {{{
                 25.499999999999996`, 2.5}, {25.499999999999996`, 
                 1.3953100000000003`}, {24.604699999999998`, 
                 0.49999999999999994`}, {23.5, 0.49999999999999994`}, {2.5, 
                 0.49999999999999994`}, {1.3953100000000003`, 
                 0.49999999999999994`}, {0.49999999999999994`, 
                 1.3953100000000003`}, {0.49999999999999994`, 2.5}, {
                 0.49999999999999994`, 23.5}, {0.49999999999999994`, 
                 24.604699999999998`}, {1.3953100000000003`, 
                 25.499999999999996`}, {2.5, 25.499999999999996`}, {23.5, 
                 25.499999999999996`}, {24.604699999999998`, 
                 25.499999999999996`}, {25.499999999999996`, 
                 24.604699999999998`}, {25.499999999999996`, 23.5}, {
                 25.499999999999996`, 2.5}}}]}, {
                FaceForm[{
                  RGBColor[0.5, 0.5, 0.5], 
                  Opacity[1.]}], 
                
                FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {
                 0, 1, 0}, {0, 1, 0}, {0, 1, 0}}}, {{{20.5426, 
                 19.116799999999998`}, {16.3832, 21.876199999999997`}, {
                 16.3832, 20.021499999999996`}, {6.930469999999999, 
                 20.021499999999996`}, {6.930469999999999, 
                 18.212100000000003`}, {16.3832, 18.212100000000003`}, {
                 16.3832, 16.357399999999995`}, {20.5426, 
                 19.116799999999998`}}}], 
                
                FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {
                 0, 1, 0}, {0, 1, 0}, {0, 1, 0}}}, {{{5.30508, 13.8391}, {
                 9.46445, 11.079700000000003`}, {9.46445, 
                 12.933999999999997`}, {18.917199999999998`, 
                 12.933999999999997`}, {18.917199999999998`, 14.7438}, {
                 9.46445, 14.7438}, {9.46445, 16.598}, {5.30508, 13.8391}}}], 
                
                FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {
                 0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
                 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {
                 1, 3, 3}, {1, 3, 3}, {1, 3, 3}}}, CompressedData["
1:eJxTTMoPSmVmYGBgBGJjIGYCYq4u+eR3VWoOxhkv5j+Qk3SA8fu/r5rKOVHM
Yd2vmNyjZ9Qcrt9QXbW9S8RBg59767IidQcPMYPGaHFhB+Nn61SfiGo4xBwp
T7o2V9Dh0Iolfg6/NBxEHv/x1Xgi4FB1XNNqkqQWnP+axUTQjFkbzn+oO2HB
j/3aDg/Xn5T6WiDoYLs3aJpiqI7DrHN+bO6tQg4zfUR7vF7pQOyfIQyRd9d1
WLL0U1kLoyjEPdm6DpoTXfQX7xBzKPjQejLkhDacL5J4+LL2Gm2HtNnSl4Vf
iELM69J2qPZM3tLnJerQX1oozZugDfHPUxGI/4W1HQ5p3TthoyDi4D7lG1v8
Mi2HgqL9zoEHhB1inOxe3BRG8MH62zXhfIbN1Z82CGhC/GMg4nCm3mN/7TYN
iHlCUPdGakDc/1kUEr46GhD/eYnD+d9iBf/kC0vC+TuCrSL+X5Vy2HGR4R5T
uAbEfxYykPBYp+HQqsCuesZAFhL+rJoQ/2rIQdxTpwkJ7yVycPfD+GDzVqLx
xbUd5HYt2JfqBdWfpA2Jj9mykPDpgYaXtaxDy7yzq86vg8qvlIHE5ylY/Eo7
XAt7o787TxfOB5ufqesQ9PbyxxkPZSDhZ6nrMAGU3u7LQtLLEx2HN2253UbX
ofZ76jis/Pay4oynAsT8QG0HKZMv/gW7FCDyTFpwPsz/MD44/Mw1HFjb1uR9
TVVwWKy880/7FHWIexrkIfLX1RzOMDZZVjHIOaDkh3vSDuj5AwCF11Vc
                 "]]}}, Background -> GrayLevel[0.93], Axes -> False, 
              AspectRatio -> 1, ImageSize -> 
              Dynamic[{
                Automatic, 
                 3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                  Magnification])}], Frame -> True, FrameTicks -> None, 
              FrameStyle -> Directive[
                Thickness[Tiny], 
                GrayLevel[0.7]]], 
             GridBox[{{
                RowBox[{
                  TagBox["\"Argument count: \"", "SummaryItemAnnotation"], 
                  "\[InvisibleSpace]", 
                  TagBox["2", "SummaryItem"]}]}, {
                RowBox[{
                  TagBox["\"Argument types: \"", "SummaryItemAnnotation"], 
                  "\[InvisibleSpace]", 
                  TagBox[
                   StyleBox[
                    PaneBox[
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"_Real", ",", "1"}], "}"}], ",", "_Real"}], "}"}],
                     ContentPadding -> False, FrameMargins -> 0, StripOnInput -> 
                    True, BaselinePosition -> Baseline, 
                    ImageSize -> {{1, 300}, Automatic}], LineBreakWithin -> 
                    False], "SummaryItem"]}]}}, 
              GridBoxAlignment -> {
               "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
              False, GridBoxItemSize -> {
               "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
              GridBoxSpacings -> {
               "Columns" -> {{2}}, "Rows" -> {{Automatic}}}, 
              BaseStyle -> {
               ShowStringCharacters -> False, NumberMarks -> False, 
                PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
           GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
           AutoDelete -> False, 
           GridBoxItemSize -> {
            "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
           BaselinePosition -> {1, 1}], True -> GridBox[{{
             PaneBox[
              ButtonBox[
               DynamicBox[
                FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxCloser"]], 
               ButtonFunction :> (Typeset`open$$ = False), Appearance -> None,
                BaseStyle -> {}, Evaluator -> Automatic, Method -> 
               "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
              Dynamic[{
                Automatic, 
                 3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                  Magnification])}]], 
             GraphicsBox[{
               Thickness[0.038461538461538464`], {
                FaceForm[{
                  GrayLevel[0.93], 
                  Opacity[1.]}], 
                
                FilledCurveBox[{{{1, 4, 3}, {0, 1, 0}, {1, 3, 3}, {0, 1, 0}, {
                 1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {0, 1, 0}}}, {{{
                 25.499999999999996`, 2.5}, {25.499999999999996`, 
                 1.3953100000000003`}, {24.604699999999998`, 
                 0.49999999999999994`}, {23.5, 0.49999999999999994`}, {2.5, 
                 0.49999999999999994`}, {1.3953100000000003`, 
                 0.49999999999999994`}, {0.49999999999999994`, 
                 1.3953100000000003`}, {0.49999999999999994`, 2.5}, {
                 0.49999999999999994`, 23.5}, {0.49999999999999994`, 
                 24.604699999999998`}, {1.3953100000000003`, 
                 25.499999999999996`}, {2.5, 25.499999999999996`}, {23.5, 
                 25.499999999999996`}, {24.604699999999998`, 
                 25.499999999999996`}, {25.499999999999996`, 
                 24.604699999999998`}, {25.499999999999996`, 23.5}, {
                 25.499999999999996`, 2.5}}}]}, {
                FaceForm[{
                  RGBColor[0.5, 0.5, 0.5], 
                  Opacity[1.]}], 
                
                FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {
                 0, 1, 0}, {0, 1, 0}, {0, 1, 0}}}, {{{20.5426, 
                 19.116799999999998`}, {16.3832, 21.876199999999997`}, {
                 16.3832, 20.021499999999996`}, {6.930469999999999, 
                 20.021499999999996`}, {6.930469999999999, 
                 18.212100000000003`}, {16.3832, 18.212100000000003`}, {
                 16.3832, 16.357399999999995`}, {20.5426, 
                 19.116799999999998`}}}], 
                
                FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {
                 0, 1, 0}, {0, 1, 0}, {0, 1, 0}}}, {{{5.30508, 13.8391}, {
                 9.46445, 11.079700000000003`}, {9.46445, 
                 12.933999999999997`}, {18.917199999999998`, 
                 12.933999999999997`}, {18.917199999999998`, 14.7438}, {
                 9.46445, 14.7438}, {9.46445, 16.598}, {5.30508, 13.8391}}}], 
                
                FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {
                 0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
                 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {
                 1, 3, 3}, {1, 3, 3}, {1, 3, 3}}}, CompressedData["
1:eJxTTMoPSmVmYGBgBGJjIGYCYq4u+eR3VWoOxhkv5j+Qk3SA8fu/r5rKOVHM
Yd2vmNyjZ9Qcrt9QXbW9S8RBg59767IidQcPMYPGaHFhB+Nn61SfiGo4xBwp
T7o2V9Dh0Iolfg6/NBxEHv/x1Xgi4FB1XNNqkqQWnP+axUTQjFkbzn+oO2HB
j/3aDg/Xn5T6WiDoYLs3aJpiqI7DrHN+bO6tQg4zfUR7vF7pQOyfIQyRd9d1
WLL0U1kLoyjEPdm6DpoTXfQX7xBzKPjQejLkhDacL5J4+LL2Gm2HtNnSl4Vf
iELM69J2qPZM3tLnJerQX1oozZugDfHPUxGI/4W1HQ5p3TthoyDi4D7lG1v8
Mi2HgqL9zoEHhB1inOxe3BRG8MH62zXhfIbN1Z82CGhC/GMg4nCm3mN/7TYN
iHlCUPdGakDc/1kUEr46GhD/eYnD+d9iBf/kC0vC+TuCrSL+X5Vy2HGR4R5T
uAbEfxYykPBYp+HQqsCuesZAFhL+rJoQ/2rIQdxTpwkJ7yVycPfD+GDzVqLx
xbUd5HYt2JfqBdWfpA2Jj9mykPDpgYaXtaxDy7yzq86vg8qvlIHE5ylY/Eo7
XAt7o787TxfOB5ufqesQ9PbyxxkPZSDhZ6nrMAGU3u7LQtLLEx2HN2253UbX
ofZ76jis/Pay4oynAsT8QG0HKZMv/gW7FCDyTFpwPsz/MD44/Mw1HFjb1uR9
TVVwWKy880/7FHWIexrkIfLX1RzOMDZZVjHIOaDkh3vSDuj5AwCF11Vc
                 "]]}}, Background -> GrayLevel[0.93], Axes -> False, 
              AspectRatio -> 1, ImageSize -> 
              Dynamic[{
                Automatic, 
                 3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                  Magnification])}], Frame -> True, FrameTicks -> None, 
              FrameStyle -> Directive[
                Thickness[Tiny], 
                GrayLevel[0.7]]], 
             GridBox[{{
                RowBox[{
                  TagBox["\"Argument count: \"", "SummaryItemAnnotation"], 
                  "\[InvisibleSpace]", 
                  TagBox["2", "SummaryItem"]}]}, {
                RowBox[{
                  TagBox["\"Argument types: \"", "SummaryItemAnnotation"], 
                  "\[InvisibleSpace]", 
                  TagBox[
                   PaneBox[
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"_Real", ",", "1"}], "}"}], ",", "_Real"}], "}"}],
                     ImageSize -> {{1, 500}, Automatic}, BaselinePosition -> 
                    Baseline, ContentPadding -> False, FrameMargins -> 0, 
                    StripOnInput -> True], "SummaryItem"]}]}, {
                RowBox[{
                  TagBox["\"Variables: \"", "SummaryItemAnnotation"], 
                  "\[InvisibleSpace]", 
                  TagBox[
                   RowBox[{"{", 
                    RowBox[{"Events", ",", "m"}], "}"}], "SummaryItem"]}]}, {
                RowBox[{
                  TagBox["\"Expression: \"", "SummaryItemAnnotation"], 
                  "\[InvisibleSpace]", 
                  TagBox[
                   PaneBox[
                    RowBox[{"Module", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"thv", ",", "ev", ",", "\[Phi]v", ",", "pv"}], 
                    "}"}], ",", 
                    RowBox[{
                    RowBox[{"thv", "=", 
                    RowBox[{"Compile`GetElement", "(", 
                    RowBox[{"Events", ",", "1"}], ")"}]}], ";", 
                    RowBox[{"ev", "=", 
                    RowBox[{"Compile`GetElement", "(", 
                    RowBox[{"Events", ",", "2"}], ")"}]}], ";", 
                    RowBox[{"{", 
                    RowBox[{"thv", ",", "ev", ",", "m"}], "}"}]}]}], "]"}], 
                    ImageSize -> {{1, 500}, Automatic}, BaselinePosition -> 
                    Baseline, ContentPadding -> False, FrameMargins -> 0, 
                    StripOnInput -> True], "SummaryItem"]}]}}, 
              GridBoxAlignment -> {
               "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
              False, GridBoxItemSize -> {
               "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
              GridBoxSpacings -> {
               "Columns" -> {{2}}, "Rows" -> {{Automatic}}}, 
              BaseStyle -> {
               ShowStringCharacters -> False, NumberMarks -> False, 
                PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
           GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
           AutoDelete -> False, 
           GridBoxItemSize -> {
            "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
           BaselinePosition -> {1, 1}]}, 
        Dynamic[Typeset`open$$], ImageSize -> Automatic]},
      "SummaryPanel"],
     DynamicModuleValues:>{}], "]"}],
   CompiledFunction[{11, 14.2, 5848}, {{
      Blank[Real], 1}, 
     Blank[Real]}, {{3, 1, 0}, {3, 0, 0}, {3, 1, 
    1}}, {{2, {2, 0, 1}}, {1, {2, 0, 0}}}, {0, 2, 3, 0, 
    2}, {{37, 0, 0, 3, 1}, {37, 0, 1, 3, 2}, {34, 1, 3, 1, 2, 0, 3, 1}, {1}}, 
    Function[{$CellContext`Events, $CellContext`m}, 
     Module[{$CellContext`thv, $CellContext`ev, $CellContext`\[Phi]v, \
$CellContext`pv}, $CellContext`thv = 
       Compile`GetElement[$CellContext`Events, 1]; $CellContext`ev = 
       Compile`GetElement[$CellContext`Events, 
         2]; {$CellContext`thv, $CellContext`ev, $CellContext`m}], Listable], 
    Evaluate, 
    LibraryFunction[
    "C:\\Users\\miksi\\AppData\\Roaming\\Wolfram\\ApplicationData\\\
CCompilerDriver\\BuildFolder\\maksym-14516\\compiledFunction65.dll", 
     "compiledFunction65", {{Real, 1, "Constant"}, {Real, 0, "Constant"}}, {
     Real, 1}]],
   Editable->False,
   SelectWithContents->True,
   Selectable->False], TraditionalForm]], "Output",
 CellChangeTimes->{
  3.91751767431573*^9, 3.917517944050228*^9, 3.9175184491143055`*^9, 
   3.917518747299034*^9, 3.9175188906013927`*^9, 3.9175194409137754`*^9, 
   3.9175199063645334`*^9, 3.9175405612548666`*^9, 3.9175424419104233`*^9, 
   3.917544215302594*^9, 3.9175803568906937`*^9, 3.917593343215351*^9, 
   3.9175936346454787`*^9, 3.917594441855528*^9, 3.917600309299843*^9, 
   3.9176243632237806`*^9, 3.9176248113630238`*^9, 3.917625098343275*^9, 
   3.9176258029582663`*^9, 3.917626005070387*^9, 3.917626260330202*^9, 
   3.917626976717827*^9, 3.9176276288005114`*^9, 3.9176278949285903`*^9, 
   3.917628205624386*^9, 3.9176690363278556`*^9, 3.917679824272497*^9, 
   3.917680371919351*^9, 3.9176819141934834`*^9, 3.9177156536488547`*^9, 
   3.917716105445162*^9, 3.9177209872550883`*^9, 3.917771361519761*^9, 
   3.9177729882597513`*^9, 3.9177735030196266`*^9, 3.917778758107663*^9, 
   3.917786412894049*^9, 3.9177967854742255`*^9, 3.9177976766364603`*^9, 
   3.9178024748043118`*^9, 3.91780309754655*^9, 3.917859335773271*^9, 
   3.917860806448993*^9, 3.917860963605523*^9, 3.9178848435265036`*^9, 
   3.9178874192840466`*^9, 3.9179514464515495`*^9, 3.917953284710023*^9, 
   3.918056362859164*^9, 3.9180581192450867`*^9, 3.9180582305269794`*^9, 
   3.91805931263583*^9, 3.918113107295084*^9, 3.9181150051008644`*^9, 
   3.9181152422310114`*^9, 3.918118024952026*^9, 3.9181187010510464`*^9, 
   3.918118865574752*^9, 3.918120606010496*^9, 3.918191446258152*^9, 
   3.9181915832127776`*^9, 3.9181940215899453`*^9, 3.918196769544731*^9, 
   3.9182018066228123`*^9, 3.9182042236059885`*^9, 3.9182044070287247`*^9, 
   3.9182068633709493`*^9, 3.9182284099492617`*^9, 3.9182321164795876`*^9, 
   3.9182349363717117`*^9, 3.9182749668903894`*^9, 3.918276027734386*^9, 
   3.918285119380492*^9, 3.918371578325347*^9, 3.918376568338674*^9, 
   3.9184598237416162`*^9, 3.9184600801399546`*^9, 3.91846052341685*^9, 
   3.918461714002262*^9, 3.9184648372926965`*^9, 3.9185583459023952`*^9, 
   3.9185735914307284`*^9, 3.9185752434741707`*^9, 3.9185755839500165`*^9, 
   3.9185761445124116`*^9, 3.9185771988435297`*^9, 3.9185792390303984`*^9, 
   3.9186183902925296`*^9, 3.918618737033879*^9, 3.9186200393096256`*^9, 
   3.918620584150874*^9, 3.918643787513023*^9, 3.918661836876828*^9, 
   3.918664418006909*^9, 3.918697560813943*^9, 3.9189247995694413`*^9, 
   3.9189253672968435`*^9, 3.918926166863415*^9, 3.91892701545918*^9, 
   3.9189998021441793`*^9, 3.91900052439958*^9, 3.9190088597542353`*^9, 
   3.919011958682683*^9, 3.9190132946267653`*^9, 3.919013738927122*^9, 
   3.919014165365129*^9, 3.919015066040919*^9, 3.9190156647318316`*^9, 
   3.91901596578309*^9, 3.919016568655792*^9, 3.9190445415386252`*^9, 
   3.919066396894577*^9, 3.9190667658919725`*^9, 3.9190670707349396`*^9, 
   3.9190692952264566`*^9, 3.9190814714056444`*^9, 3.9194427230579643`*^9, 
   3.920049481701105*^9, 3.920050046018069*^9, 3.920092800268014*^9, 
   3.9200955775543213`*^9, 3.9200962090228868`*^9, 3.9201294644686513`*^9, 
   3.920180516200731*^9, 3.921812558443859*^9, 3.921831822513662*^9, 
   3.9219258791206675`*^9, 3.9261456725793314`*^9, 3.9290759745713215`*^9, 
   3.92907745256684*^9, 3.929079217053253*^9, 3.9290855322344017`*^9, 
   3.9290864506670246`*^9, 3.929094422864977*^9, 3.929095156500272*^9, 
   3.9291598124766335`*^9, 3.929160981546946*^9, 3.9291654200816674`*^9, 
   3.929165865604005*^9, 3.929204313899057*^9, 3.9292065661327066`*^9, 
   3.9292073219372435`*^9, 3.9292078980685635`*^9, 3.9292081280055647`*^9, 
   3.9292092374477262`*^9, 3.9292516608352833`*^9, {3.929252316467287*^9, 
   3.9292523377996597`*^9}, 3.929252463126239*^9, 3.929252626859557*^9, 
   3.929253159040557*^9, 3.9292532762255087`*^9, 3.9292848579861016`*^9, 
   3.9292865014910765`*^9, 3.9312403624263268`*^9, 3.931242192624648*^9, 
   3.9312471831069927`*^9, 3.9312485448008566`*^9, 3.938194090794733*^9, 
   3.9520969586955547`*^9, 3.9520976910366535`*^9, 3.952098011520479*^9, 
   3.9520984414589252`*^9, 3.9527541297433624`*^9},
 CellLabel->
  "Out[1437]=",ExpressionUUID->"58d35ab3-4625-ef4f-b633-b93e127b1bdb"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Generating random values ",
 Cell[BoxData[
  FormBox[
   RowBox[{"{", 
    RowBox[{
     SubscriptBox["\[Theta]", "rand"], ",", 
     SubscriptBox["E", "rand"]}], "}"}], TraditionalForm]],ExpressionUUID->
  "6a75c81a-4542-4d97-b218-18141a908e51"]
}], "Subsection",
 CellChangeTimes->{{3.9292854744901533`*^9, 
  3.9292854849392066`*^9}},ExpressionUUID->"5a35d9ea-52ee-4cce-b36d-\
756f7cd679c0"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]ErandGeneratorOld", "[", 
    RowBox[{
    "mLLP_", ",", "type_", ",", "\[Theta]minmax_", ",", "logemindat_", ",", 
     "NevSampl_"}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"Computing", " ", "tabulated", " ", "data", " ", 
       SubscriptBox["E", "max"], 
       RowBox[{"(", "\[Theta]", ")"}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"log\[Theta]emaxdata", "=", 
       RowBox[{"Log", "[", 
        RowBox[{"EmaxMapperMassToDecay", "[", 
         RowBox[{"mLLP", ",", "type"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"nf\[Theta]Emaxlog", "=", 
       RowBox[{"Nearest", "[", 
        RowBox[{
         RowBox[{"log\[Theta]emaxdata", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "1"}], "]"}], "]"}], "->", "\"\<Index\>\""}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "Generating", " ", "random", " ", "\[Theta]", " ", "values", " ", 
        "and", " ", "logarithmying", " ", "them"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"log\[Theta]rand", "=", 
       RowBox[{"Log", "[", 
        RowBox[{"RandomReal", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"\[Theta]minmax", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            RowBox[{"\[Theta]minmax", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", "NevSampl"}], 
         "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"For", " ", "each", " ", "\[Theta]"}], ",", " ", 
        RowBox[{
         RowBox[{"generaring", " ", "random", " ", 
          SubscriptBox["E", "rand"]}], " ", "\[Element]", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["E", "min"], ",", 
           RowBox[{
            SubscriptBox["E", "max"], 
            RowBox[{"(", "\[Theta]", ")"}]}]}], "}"}]}]}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"index\[Theta]Emaxlog", "=", 
       RowBox[{
        RowBox[{"nf\[Theta]Emaxlog", "[", "log\[Theta]rand", "]"}], "//", 
        "Flatten"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"logemaxrand", "=", 
       RowBox[{"linint1", "[", 
        RowBox[{"log\[Theta]rand", ",", 
         RowBox[{"log\[Theta]emaxdata", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", 
         "index\[Theta]Emaxlog", ",", "log\[Theta]emaxdata"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"logerand", "=", 
       RowBox[{"erandcomp", "[", 
        RowBox[{"logemindat", ",", "logemaxrand", ",", "NevSampl"}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"log\[Theta]rand", ",", "logerand", ",", "logemaxrand"}], 
       "}"}]}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "The", " ", "minimal", " ", "value", " ", "of", " ", "energy", " ", "for", 
    " ", "which", " ", "the", " ", "decay", " ", "probability", " ", "is", " ",
     "suppressed", " ", "by", " ", 
    RowBox[{"Exp", "[", 
     RowBox[{"-", "10."}], "]"}], " ", "at", " ", 
    SubscriptBox["z", 
     RowBox[{
      RowBox[{"dec", ".", "vol", "."}], ",", "min"}]], " ", "and", " ", 
    RowBox[{
     SubscriptBox["\[Theta]", 
      RowBox[{
       RowBox[{"dec", ".", "vol", "."}], ",", "min"}]], ".", " ", "May"}], " ",
     "inaccurately", " ", "capture", " ", "the", " ", "decay", " ", "volume", 
    " ", "geometry", " ", "where", " ", 
    SubscriptBox["z", 
     RowBox[{
      RowBox[{"dec", ".", "vol", "."}], ",", "min"}]], " ", "does", " ", 
    "not", " ", "correspond", " ", "to", " ", 
    SubscriptBox["\[Theta]", 
     RowBox[{
      RowBox[{"dec", ".", "vol", "."}], ",", "min"}]]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Eminc\[Tau]z", "[", 
    RowBox[{"c\[Tau]_", ",", "mLLP_"}], "]"}], "=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"LLPdirName", "!=", "\"\<LDM-DP\>\""}], "&&", 
      RowBox[{"!", 
       RowBox[{"StringContainsQ", "[", 
        RowBox[{"LLPdirName", ",", "\"\<Inelastic-DP-DM\>\""}], "]"}]}]}], ",", 
     RowBox[{"Evaluate", "[", 
      RowBox[{"Min", "[", 
       RowBox[{
        RowBox[{"0.5", 
         RowBox[{"ELLPmaxData", "[", 
          RowBox[{"keysMergedDistr", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ",", 
        RowBox[{"Quiet", "[", 
         RowBox[{"p", "/.", 
          RowBox[{
           RowBox[{"Solve", "[", 
            RowBox[{
             RowBox[{
              FractionBox[
               RowBox[{"Max", "[", 
                RowBox[{
                 FractionBox["zDecVolMin", 
                  RowBox[{"Cos", "[", "\[Theta]minExp", "]"}]], ",", 
                 FractionBox["zDecVolMin", 
                  RowBox[{"Cos", "[", "\[Theta]maxExp", "]"}]]}], "]"}], 
               RowBox[{"c\[Tau]", 
                FractionBox["p", "mLLP"]}]], "==", "15."}], ",", "p"}], "]"}],
            "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], "]"}], "]"}], ",", 
     "mLLP"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Theta]ErandGenerator", "[", 
   RowBox[{
   "mLLP_", ",", "type_", ",", "\[Theta]minmax_", ",", "logemindat_", ",", 
    "NevSampl_", ",", "c\[Tau]LLP_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"(*", 
      RowBox[{
      "Emax", ",", "Emin", ",", "EminReduced", ",", "EmaxReduced", ",", 
       "\[Theta]emaxdatareduced", ",", "\[Theta]minmaxreduced", ",", 
       "\[Theta]emaxdata"}], "*)"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Emax", "=", 
      RowBox[{"ELLPmaxData", "[", "type", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Emin", "=", 
      RowBox[{"Eminc\[Tau]z", "[", 
       RowBox[{"c\[Tau]LLP", ",", "mLLP"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"Computing", " ", "tabulated", " ", "data", " ", 
       SubscriptBox["E", 
        RowBox[{"max", " ", "possible"}]], 
       RowBox[{"(", "\[Theta]", ")"}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"\[Theta]emaxdata", "=", 
      RowBox[{"EmaxMapperMassToDecay", "[", 
       RowBox[{"mLLP", ",", "type"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{
        RowBox[{
        "Selecting", " ", "only", " ", "the", " ", "angles", " ", "for", " ", 
         "which", " ", 
         SubscriptBox["E", 
          RowBox[{"max", " ", "possible"}]]}], ">", 
        RowBox[{
         RowBox[{
          SubscriptBox["E", "min"], ".", " ", "If"}], " ", "there", " ", 
         "are", " ", "no", " ", "such", " ", "points"}]}], ",", " ", 
       RowBox[{
        SubscriptBox["E", "min"], " ", "is", " ", "replaced", " ", "with", " ",
         "0.6", "*", 
        SubscriptBox["E", 
         RowBox[{"max", ",", "possible"}]], 
        RowBox[{"(", 
         SubscriptBox["\[Theta]", "min"], ")"}]}]}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"EminReduced", "=", 
      RowBox[{"Max", "[", 
       RowBox[{"mLLP", ",", 
        RowBox[{"Min", "[", 
         RowBox[{
          RowBox[{"0.6", 
           RowBox[{
            RowBox[{"\[Theta]emaxdata", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], ",", "Emin"}], "]"}]}], "]"}]}],
      ";", "\[IndentingNewLine]", 
     RowBox[{"\[Theta]emaxdatareduced", "=", 
      RowBox[{"Select", "[", 
       RowBox[{"\[Theta]emaxdata", ",", 
        RowBox[{
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "2", "]"}], "]"}], ">", "EminReduced"}], "&"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Angular", " ", "domain", " ", "where", " ", 
        SubscriptBox["E", 
         RowBox[{"max", " ", "possible"}]]}], ">", 
       SubscriptBox["E", "min"]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"\[Theta]minmaxreduced", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\[Theta]minmax", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", 
        RowBox[{"Min", "[", 
         RowBox[{
          RowBox[{"\[Theta]minmax", "[", 
           RowBox[{"[", "2", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"\[Theta]emaxdatareduced", "[", 
            RowBox[{"[", 
             RowBox[{"-", "1"}], "]"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"log\[Theta]emaxdata", "=", 
      RowBox[{"Log", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", 
           RowBox[{"Min", "[", 
            RowBox[{"Emax", ",", 
             RowBox[{"#", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "}"}], "&"}], "/@", 
        "\[Theta]emaxdatareduced"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"nf\[Theta]Emaxlog", "=", 
      RowBox[{"Nearest", "[", 
       RowBox[{
        RowBox[{"log\[Theta]emaxdata", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "1"}], "]"}], "]"}], "->", "\"\<Index\>\""}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "Generating", " ", "random", " ", "\[Theta]", " ", "values", " ", "and",
        " ", "logarithmying", " ", "them"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"log\[Theta]rand", "=", 
      RowBox[{"Log", "[", 
       RowBox[{"RandomReal", "[", 
        RowBox[{"\[Theta]minmaxreduced", ",", "NevSampl"}], "]"}], "]"}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"For", " ", "each", " ", "\[Theta]"}], ",", " ", 
       RowBox[{
        RowBox[{"generaring", " ", "random", " ", 
         SubscriptBox["E", "rand"]}], " ", "\[Element]", 
        RowBox[{"{", 
         RowBox[{
          SubscriptBox["E", "min"], ",", 
          RowBox[{
           SubscriptBox["E", "max"], 
           RowBox[{"(", "\[Theta]", ")"}]}]}], "}"}]}]}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"index\[Theta]Emaxlog", "=", 
      RowBox[{
       RowBox[{"nf\[Theta]Emaxlog", "[", "log\[Theta]rand", "]"}], "//", 
       "Flatten"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"logemaxrand", "=", 
      RowBox[{"linint1", "[", 
       RowBox[{"log\[Theta]rand", ",", 
        RowBox[{"log\[Theta]emaxdata", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", 
        "index\[Theta]Emaxlog", ",", "log\[Theta]emaxdata"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"logerand", "=", 
      RowBox[{"erandcomp", "[", 
       RowBox[{
        RowBox[{"Max", "[", 
         RowBox[{"logemindat", ",", 
          RowBox[{"Log", "[", "EminReduced", "]"}]}], "]"}], ",", 
        "logemaxrand", ",", "NevSampl"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
      "log\[Theta]rand", ",", "logerand", ",", "logemaxrand", ",", 
       "EminReduced", ",", "Emax", ",", 
       RowBox[{"\[Theta]minmaxreduced", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", 
       RowBox[{"\[Theta]minmaxreduced", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.929285486469282*^9, 3.9292856867850904`*^9}, {
   3.9292857399732866`*^9, 3.929285740163228*^9}, {3.9292858164178143`*^9, 
   3.929285818271372*^9}, {3.929285998438611*^9, 3.929285998629141*^9}, {
   3.931245339356868*^9, 3.9312453397098465`*^9}, {3.931245577000451*^9, 
   3.931245663558282*^9}, {3.9312460627508235`*^9, 3.931246123742899*^9}, {
   3.931246171596841*^9, 3.9312463036066313`*^9}, {3.9312463417641773`*^9, 
   3.9312464045137196`*^9}, {3.931246451434023*^9, 3.9312464804429097`*^9}, 
   3.9312466702205753`*^9, {3.931246767720066*^9, 3.931246767766674*^9}, 
   3.9312468486162186`*^9, {3.9381916513299446`*^9, 3.9381916757138214`*^9}, {
   3.938191722600706*^9, 3.9381917323608246`*^9}, {3.942403927699951*^9, 
   3.942403930248043*^9}, {3.9424187673406696`*^9, 3.942418772012453*^9}, {
   3.9520977018249893`*^9, 3.952097721230772*^9}, {3.9520983686618233`*^9, 
   3.952098389634554*^9}},
 CellLabel->"In[4]:=",ExpressionUUID->"c8cc76ca-de20-4d09-a70a-7ad62b2337cb"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Interpolator ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"{", 
     RowBox[{"\[Theta]", ",", "E", ",", " ", 
      SubscriptBox["f", "m"]}], "}"}], "->", 
    RowBox[{
     SubscriptBox["f", "m"], "(", 
     RowBox[{
      SubscriptBox["\[Theta]", "rand"], ",", 
      SubscriptBox["E", "rand"]}], ")"}]}], TraditionalForm]],ExpressionUUID->
  "36ea6b99-4dea-4922-a10d-a735ad52a846"]
}], "Subsection",
 CellChangeTimes->{{3.929284578869903*^9, 3.92928462179004*^9}, {
  3.929284950416911*^9, 
  3.9292849633278074`*^9}},ExpressionUUID->"4bb37a33-2bd4-4af7-af84-\
153d4567d57d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]ErandWeights", "[", 
    RowBox[{
    "mLLP_", ",", "distrmapped_", ",", "log\[Theta]rand_", ",", "logErand_", ",",
      "logemaxrand_", ",", "emin_"}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"distrmapped1", "=", 
       RowBox[{"distrmapped", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", 
          RowBox[{"{", 
           RowBox[{"2", ",", "3", ",", "4"}], "}"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"Logarithmying", " ", "the", " ", "distribution"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"distrdatalog", "=", 
       RowBox[{"DataLogarithmiedComp", "[", "distrmapped1", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"Extracting", " ", "the", " ", "grid", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"log", 
           RowBox[{"(", "\[Theta]", ")"}]}], ",", " ", 
          RowBox[{"log", 
           RowBox[{"(", "E", ")"}]}]}], "}"}], " ", "from", " ", "the", " ", 
        "mapped", " ", "distribution"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"GridIn", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"DeleteDuplicates", "[", 
          RowBox[{"distrdatalog", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "#"}], "]"}], "]"}], "]"}], "&"}], "/@", 
        RowBox[{"{", 
         RowBox[{"1", ",", "2"}], "}"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "Building", " ", "the", " ", "function", " ", "finding", " ", "the", " ",
         "nearest", " ", "neighbor", " ", "for", " ", "the", " ", 
        "logarithmied", " ", "grid"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"nf\[Theta]log", "=", 
       RowBox[{"Nearest", "[", 
        RowBox[{
         RowBox[{"GridIn", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "->", "\"\<Index\>\""}], "]"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"nfElog", "=", 
       RowBox[{"Nearest", "[", 
        RowBox[{
         RowBox[{"GridIn", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "->", "\"\<Index\>\""}], "]"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "Finding", " ", "the", " ", "indices", " ", "of", " ", "the", " ", 
        "nearest", " ", "neighbors", " ", "of", " ", "the", " ", "grid", " ", 
        "to", " ", "the", " ", "random", " ", "points"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"indexlog\[Theta]rand", ",", "indexlogerand"}], "}"}], "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"nf\[Theta]log", "[", "log\[Theta]rand", "]"}], "//", 
          "Flatten"}], ",", 
         RowBox[{
          RowBox[{"nfElog", "[", "logerand", "]"}], "//", "Flatten"}]}], 
        "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Exp", "[", "logemaxrand", "]"}], "-", "emin"}], ")"}], "*", 
       RowBox[{"linint2", "[", 
        RowBox[{"log\[Theta]rand", ",", "logErand", ",", 
         RowBox[{"GridIn", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", 
         RowBox[{"GridIn", "[", 
          RowBox[{"[", "2", "]"}], "]"}], ",", "indexlog\[Theta]rand", ",", 
         "indexlogerand", ",", "distrdatalog"}], "]"}]}]}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Alternative", ",", " ", 
    RowBox[{
    "where", " ", "Nearest", " ", "is", " ", "replaced", " ", "with", " ", 
     "the", " ", "linear", " ", "search"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Theta]ErandWeights1", "[", 
   RowBox[{
   "mLLP_", ",", "distrmapped_", ",", "log\[Theta]rand_", ",", "logErand_", ",",
     "logemaxrand_", ",", "emin_"}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"distrmapped1", "=", 
      RowBox[{"distrmapped", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", 
         RowBox[{"{", 
          RowBox[{"2", ",", "3", ",", "4"}], "}"}]}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"Logarithmying", " ", "the", " ", "distribution"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"distrdatalog", "=", 
      RowBox[{"DataLogarithmiedComp", "[", "distrmapped1", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"Extracting", " ", "the", " ", "grid", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"log", 
          RowBox[{"(", "\[Theta]", ")"}]}], ",", " ", 
         RowBox[{"log", 
          RowBox[{"(", "E", ")"}]}]}], "}"}], " ", "from", " ", "the", " ", 
       "mapped", " ", "distribution"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"GridIn", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"DeleteDuplicates", "[", 
         RowBox[{"distrdatalog", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "#"}], "]"}], "]"}], "]"}], "&"}], "/@", 
       RowBox[{"{", 
        RowBox[{"1", ",", "2"}], "}"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Exp", "[", "logemaxrand", "]"}], "-", "emin"}], ")"}], "*", 
      RowBox[{"linint2WithNearest", "[", 
       RowBox[{"log\[Theta]rand", ",", "logErand", ",", 
        RowBox[{"GridIn", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", 
        RowBox[{"GridIn", "[", 
         RowBox[{"[", "2", "]"}], "]"}], ",", 
        RowBox[{"distrdatalog", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "3"}], "]"}], "]"}]}], "]"}]}]}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.929284625255565*^9, 3.9292846704149013`*^9}, {
   3.929284723613171*^9, 3.929284725170061*^9}, {3.9292848333842216`*^9, 
   3.929284833515351*^9}, {3.9292849472599792`*^9, 3.929284973036734*^9}, {
   3.929285092372554*^9, 3.9292851187779045`*^9}, {3.929285203682008*^9, 
   3.929285206988542*^9}, 3.929285279610708*^9, {3.9292854233907957`*^9, 
   3.929285442669877*^9}, {3.9292857827749496`*^9, 3.9292857856941423`*^9}, {
   3.929285849443548*^9, 3.9292858976097975`*^9}, {3.929286188778844*^9, 
   3.929286189744458*^9}, {3.9292862895127635`*^9, 3.929286317189825*^9}, {
   3.929286403982401*^9, 3.9292864047540026`*^9}, {3.929286719544594*^9, 
   3.9292867567140107`*^9}, {3.9312465614716253`*^9, 
   3.9312465705198755`*^9}, {3.931246832671645*^9, 3.9312468367514668`*^9}},
 CellLabel->"In[7]:=",ExpressionUUID->"ef58a9c0-022c-4e52-8329-0a464d305154"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Block that samples points", "Section",
 CellChangeTimes->{{3.9261455737605896`*^9, 
  3.9261455766986027`*^9}},ExpressionUUID->"97ad1f33-b2d4-4170-9df3-\
1b11f41a4c5a"],

Cell[CellGroupData[{

Cell["Per production channel controlled by one coupling", "Subsection",
 CellChangeTimes->{{3.92928540481313*^9, 3.929285405255499*^9}, {
  3.929290689959443*^9, 
  3.9292907053811436`*^9}},ExpressionUUID->"9492b1a6-e5ab-4e0f-9ba5-\
db722b2f666e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Kinematics", " ", "from", " ", "tabulated", " ", "distributions"}], " ", 
    "-", " ", 
    RowBox[{
    "per", " ", "channels", " ", "controlled", " ", "by", " ", "the", " ", 
     "same", " ", "coupling"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"KinematicsFromTabulatedDistributionTemp", "[", 
    RowBox[{"mLLP_", ",", "type_", ",", "Nevents_", ",", "c\[Tau]LLP_"}], 
    "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"Number", " ", "of", " ", "sampled", " ", "points"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"NevSampl", "=", 
       RowBox[{"Max", "[", 
        RowBox[{
         RowBox[{"10", "*", "Nevents"}], ",", 
         SuperscriptBox["10", "5"]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
         RowBox[{"Mapping", " ", "the", " ", "tabulated", " ", "data", " ", 
          RowBox[{"{", 
           RowBox[{"m", ",", "\[Theta]", ",", "E", ",", "distr"}], "}"}]}], 
         " ", "->", " ", 
         RowBox[{"{", 
          RowBox[{"\[Theta]", ",", "E", ",", 
           SubscriptBox["distr", 
            SubscriptBox["m", "LLP"]]}], "}"}]}], ",", " ", 
        RowBox[{"and", " ", "logarithmying", " ", "it"}]}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"distrmapped", "=", 
       RowBox[{"DistrMapperMassProd", "[", 
        RowBox[{"mLLP", ",", "type"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
        "Finding", " ", "the", " ", "range", " ", "of", " ", "energies", " ", 
         "and", " ", "angles", " ", "where", " ", "the", " ", "distribution", 
         " ", "is", " ", "non"}], "-", "negligible"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"emindat", ",", "emaxdat", ",", "thmindat", ",", "thmaxdat"}],
         "}"}], "=", 
       RowBox[{"minmaxcomp", "[", 
        RowBox[{"distrmapped", ",", "mLLP"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "logemindat", ",", "logemaxdat", ",", "logthmindat", ",", 
         "logthmaxdat"}], "}"}], "=", 
       RowBox[{"Log", "[", 
        RowBox[{"{", 
         RowBox[{
         "emindat", ",", "emaxdat", ",", "thmindat", ",", "thmaxdat"}], "}"}],
         "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
         RowBox[{"Min", "/", "max"}], " ", "values", " ", "of", " ", "the", " ",
          "polar", " ", 
         RowBox[{"angle", ":", " ", 
          RowBox[{
          "defined", " ", "by", " ", "the", " ", "data", " ", 
           "thmindata"}]}]}], ",", 
        RowBox[{"thmaxdata", " ", "+", " ", 
         RowBox[{
         "the", " ", "conditions", " ", "for", " ", "the", " ", "given", " ", 
          "experiment", " ", 
          SubscriptBox["\[Theta]", "min"]}]}], ",", 
        SubscriptBox["\[Theta]", "max"]}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"\[Theta]minmax", "=", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Max", "[", 
           RowBox[{
            RowBox[{"\[Theta]LLPminData", "[", "type", "]"}], ",", 
            "\[Theta]minYield", ",", "thmindat"}], "]"}], ",", 
          RowBox[{"Min", "[", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{"IfCollider", ",", 
              FractionBox["Pi", "2."], ",", 
              RowBox[{"\[Theta]LLPmaxData", "[", "type", "]"}]}], "]"}], ",", 
            "\[Theta]maxYield", ",", "thmaxdat"}], "]"}]}], "}"}], "//", 
        "N"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Generaring", " ", "uniform", " ", "random", " ", 
         SubscriptBox["\[Theta]", "rand"]}], ",", 
        RowBox[{
         SubscriptBox["E", "rand"], "\[Element]", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["E", "min"], ",", 
           RowBox[{
            SubscriptBox["E", "max"], 
            RowBox[{"(", 
             SubscriptBox["\[Theta]", "rand"], ")"}]}]}], "}"}]}]}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "log\[Theta]rand", ",", "logErand", ",", "logemaxrand", ",", 
         "EminReduced", ",", "EmaxReduced", ",", "\[Theta]minreduced", ",", 
         "\[Theta]maxreduced"}], "}"}], "=", 
       RowBox[{"\[Theta]ErandGenerator", "[", 
        RowBox[{
        "mLLP", ",", "type", ",", "\[Theta]minmax", ",", "logemindat", ",", 
         "NevSampl", ",", "c\[Tau]LLP"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
        "Calculating", " ", "the", " ", "weights", " ", "for", " ", "the", " ",
          "generated", " ", 
         SubscriptBox["\[Theta]", "rand"]}], ",", 
        RowBox[{
         SubscriptBox["E", "rand"], ":", " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             SubscriptBox["E", "max"], 
             RowBox[{"(", 
              SubscriptBox["\[Theta]", "rand"], ")"}]}], "-", 
            RowBox[{
             SubscriptBox["E", "min"], 
             RowBox[{"(", 
              SubscriptBox["\[Theta]", "rand"], ")"}]}]}], ")"}], "\[Times]", 
          RowBox[{"Distribution", "[", 
           RowBox[{
            SubscriptBox["\[Theta]", "rand"], ",", 
            SubscriptBox["E", "rand"]}], "]"}]}]}]}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"weights", "=", 
       RowBox[{"\[Theta]ErandWeights1", "[", 
        RowBox[{
        "mLLP", ",", "distrmapped", ",", "log\[Theta]rand", ",", "logErand", ",",
          "logemaxrand", ",", "EminReduced"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Generating", " ", "\"\<True\>\"", " ", "\[Theta]"}], ",", 
        RowBox[{"E", " ", "based", " ", "on", " ", "the", " ", "weights"}]}], 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"PTS", "=", 
       RowBox[{"RandomChoice", "[", 
        RowBox[{
         RowBox[{"weights", "->", 
          RowBox[{"Transpose", "[", 
           RowBox[{"Exp", "[", 
            RowBox[{"{", 
             RowBox[{"log\[Theta]rand", ",", "logErand"}], "}"}], "]"}], 
           "]"}]}], ",", "Nevents"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"Final", " ", "array", " ", 
        RowBox[{"{", 
         RowBox[{
          SubscriptBox["\[Theta]", "rand"], ",", 
          SubscriptBox["E", "rand"], ",", 
          SubscriptBox["m", "LLP"]}], "}"}]}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"motherdata", "=", 
       RowBox[{"LLPdataCompiled", "[", 
        RowBox[{"PTS", ",", "mLLP"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"motherdata", "//", "Developer`ToPackedArray"}]}]}], 
    "\[IndentingNewLine]", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.9292854379846563`*^9, 3.929285448273021*^9}, {
  3.929285633291097*^9, 3.9292856336089754`*^9}, {3.9292857028062897`*^9, 
  3.9292857978700504`*^9}, {3.929285912791667*^9, 3.9292859293198967`*^9}, {
  3.92928596799277*^9, 3.9292860015890374`*^9}, {3.929286033382407*^9, 
  3.929286038337572*^9}, {3.9292860990669107`*^9, 3.929286129306353*^9}, {
  3.9292863542454033`*^9, 3.929286362244155*^9}, {3.9312464976228175`*^9, 
  3.931246515355403*^9}, {3.9312465771951027`*^9, 3.9312466137985144`*^9}, {
  3.9312467835367823`*^9, 3.931246795293531*^9}, {3.9520979895706863`*^9, 
  3.9520979980607147`*^9}, {3.952098039881304*^9, 3.9520980441935177`*^9}, {
  3.9520980903260136`*^9, 3.9520980961266136`*^9}, {3.952098146009163*^9, 
  3.952098153523308*^9}, {3.9520984248406296`*^9, 3.952098427986269*^9}},
 CellLabel->"In[9]:=",ExpressionUUID->"f8c945bc-50b0-47ec-b136-147a6a4d770f"],

Cell[CellGroupData[{

Cell["Cross-check", "Subsubsection",
 CellChangeTimes->{{3.93124680322221*^9, 
  3.9312468044896555`*^9}},ExpressionUUID->"bc844418-836c-48e9-8c9b-\
0a8c382bd431"],

Cell[BoxData[
 RowBox[{"(*", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"md1", "=", 
           RowBox[{"KinematicsFromTabulatedDistributionTemp", "[", 
            RowBox[{"1", ",", 
             RowBox[{"keysMergedDistr", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", "100000", ",", "100"}], 
            "]"}]}], ";"}], "//", 
         RowBox[{"AbsoluteTiming", "\[IndentingNewLine]", "md2"}]}], "=", 
        RowBox[{"KinematicsFromTabulatedDistributionTemp", "[", 
         RowBox[{"1", ",", 
          RowBox[{"keysMergedDistr", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", "100000", ",", "1"}], "]"}]}],
        ";"}], "//", 
      RowBox[{"AbsoluteTiming", "\[IndentingNewLine]", "md3"}]}], "=", 
     RowBox[{"KinematicsFromTabulatedDistributionTemp", "[", 
      RowBox[{"1", ",", 
       RowBox[{"keysMergedDistr", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", "100000", ",", "0.05"}], "]"}]}],
     ";"}], "//", 
   RowBox[{"AbsoluteTiming", "\[IndentingNewLine]", 
    RowBox[{"Histogram", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"md1", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "2"}], "]"}], "]"}], ",", 
        RowBox[{"md2", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "2"}], "]"}], "]"}], ",", 
        RowBox[{"md3", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "2"}], "]"}], "]"}]}], "}"}], ",", "100"}], 
     "]"}]}]}], "\[IndentingNewLine]", "*)"}]], "Input",
 CellChangeTimes->{{3.9312468549373417`*^9, 3.9312468815091577`*^9}},
 CellLabel->"In[10]:=",ExpressionUUID->"f7e6d025-f4d2-4637-b744-e2d657449798"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Collecting over total channels controlled by various couplings\
\>", "Subsection",
 CellChangeTimes->{{3.9291226200409656`*^9, 3.9291226254448767`*^9}, {
  3.929290707484321*^9, 
  3.9292907119187574`*^9}},ExpressionUUID->"3236f0e3-2464-40b9-8a83-\
5ba872b1c439"],

Cell[CellGroupData[{

Cell["Only one coupling", "Subsubsection",
 CellChangeTimes->{{3.9291606455080023`*^9, 3.9291606559249487`*^9}, {
  3.9292907173532915`*^9, 
  3.929290719305314*^9}},ExpressionUUID->"d3a4bc06-bc2b-4772-810b-\
775d73143c57"],

Cell[BoxData[
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"MemberQ", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\"\<DP\>\"", ",", "\"\<ALP-photon\>\"", 
        ",", "\"\<ALP-fermion\>\"", ",", "\"\<ALP-gluon\>\"", 
        ",", "\"\<B-L\>\"", ",", "\"\<HNL\>\"", ",", "\"\<LDM-DP\>\""}], 
       "}"}], ",", "LLPdirName"}], "]"}], "||", 
    RowBox[{"StringContainsQ", "[", 
     RowBox[{"LLPdirName", ",", "\"\<Inelastic-DP-DM\>\""}], "]"}]}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"KinematicsFromTabulatedDistribution", "[", 
      RowBox[{
      "mLLP_", ",", "coupling1_", ",", "coupling2_", ",", "Nevents_", ",", 
       "c\[Tau]LLP_"}], "]"}], ":=", 
     RowBox[{"KinematicsFromTabulatedDistributionTemp", "[", 
      RowBox[{
      "mLLP", ",", "\"\<Total\>\"", ",", "Nevents", ",", "c\[Tau]LLP"}], 
      "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"weightKinematics", "[", 
      RowBox[{
      "mLLP_", ",", "coupling1_", ",", "coupling2_", ",", "\"\<Total\>\""}], 
      "]"}], "=", "1"}], ";"}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{
  3.9291606740679674`*^9, {3.929290894126072*^9, 3.9292909098478503`*^9}, {
   3.93123751128559*^9, 3.9312375134847126`*^9}, {3.9312376365004005`*^9, 
   3.931237647343356*^9}, {3.9312468870654936`*^9, 3.931246893444441*^9}, {
   3.9381917909966755`*^9, 3.9381917953004684`*^9}, {3.952096588086996*^9, 
   3.9520965924751167`*^9}, {3.9520971196313896`*^9, 3.9520971324964447`*^9}},
 CellLabel->"In[11]:=",ExpressionUUID->"4118790b-5b4d-4a98-9a16-4c5bc22bd5da"],

Cell[CellGroupData[{

Cell["Cross-check: HNLs", "Item",
 CellChangeTimes->{{3.931237521054824*^9, 
  3.931237524913682*^9}},ExpressionUUID->"b7c89c1d-a374-419b-b3d4-\
2a23b185ca13"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"mval", "=", "0.2"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Nev", "=", 
       SuperscriptBox["10", "6"]}], ";", "\[IndentingNewLine]", 
      RowBox[{"datt", "=", 
       RowBox[{"KinematicsFromTabulatedDistribution", "[", 
        RowBox[{
        "mval", ",", "\[Theta]2val", ",", "BrhToSSval", ",", "Nev", ",", 
         "10000"}], "]"}]}], ";"}], "//", 
     RowBox[{"AbsoluteTiming", "\[IndentingNewLine]", "norm"}]}], "=", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"weightKinematics", "[", 
        RowBox[{"mval", ",", "\[Theta]2val", ",", "BrhToSSval", ",", "key"}], 
        "]"}], "*", 
       RowBox[{"Quiet", "[", 
        RowBox[{"NIntegrate", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"DoubleDistrLLPint", "[", 
            RowBox[{"mval", ",", 
             RowBox[{"Exp", "[", "th", "]"}], ",", 
             RowBox[{"Exp", "[", "e", "]"}], ",", "key"}], "]"}], 
           RowBox[{"Exp", "[", 
            RowBox[{"th", "+", "e"}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"th", ",", 
            RowBox[{"Log", "[", "\[Theta]minExp", "]"}], ",", 
            RowBox[{"Log", "[", "\[Theta]maxExp", "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"e", ",", 
            RowBox[{"Log", "[", "mval", "]"}], ",", 
            RowBox[{"Log", "[", 
             RowBox[{"ELLPmaxData", "[", "key", "]"}], "]"}]}], "}"}], ",", 
          RowBox[{"Method", "->", "\"\<AdaptiveMonteCarlo\>\""}]}], "]"}], 
        "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"key", ",", "keysMergedDistr"}], "}"}]}], "]"}]}], ";", 
   "\[IndentingNewLine]", 
   RowBox[{"endistr", "=", 
    RowBox[{"ParallelTable", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        SuperscriptBox["10", "x"], ",", 
        RowBox[{"Max", "[", 
         RowBox[{
          SuperscriptBox["10", 
           RowBox[{"-", "8"}]], ",", 
          RowBox[{
           FractionBox["1", "norm"], 
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"weightKinematics", "[", 
               RowBox[{
               "mval", ",", "\[Theta]2val", ",", "BrhToSSval", ",", "key"}], 
               "]"}], "*", 
              RowBox[{"Quiet", "[", 
               RowBox[{"NIntegrate", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"DoubleDistrLLPint", "[", 
                   RowBox[{"mval", ",", 
                    RowBox[{"Exp", "[", "th", "]"}], ",", 
                    SuperscriptBox["10", "x"], ",", "key"}], "]"}], 
                  RowBox[{"Exp", "[", "th", "]"}]}], ",", 
                 RowBox[{"{", 
                  RowBox[{"th", ",", 
                   RowBox[{"Log", "[", "\[Theta]minExp", "]"}], ",", 
                   RowBox[{"Log", "[", "\[Theta]maxExp", "]"}]}], "}"}], ",", 
                 RowBox[{"Method", "->", "\"\<AdaptiveMonteCarlo\>\""}]}], 
                "]"}], "]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"key", ",", "keysMergedDistr"}], "}"}]}], "]"}]}]}], 
         "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", 
        RowBox[{"Log10", "[", "mval", "]"}], ",", 
        RowBox[{"Log10", "[", 
         RowBox[{"ELLPmaxData", "[", "\"\<Total\>\"", "]"}], "]"}], ",", 
        "0.03"}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
   RowBox[{"Show", "[", 
    RowBox[{
     RowBox[{"ListLogLogPlot", "[", 
      RowBox[{
       RowBox[{"{", "endistr", "}"}], ",", 
       RowBox[{"Joined", "->", "True"}], ",", 
       RowBox[{"PlotStyle", "->", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"Thick", ",", "Gray"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"Thick", ",", "Gray"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"Thick", ",", "Gray"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"Thick", ",", 
            RowBox[{"Lighter", "@", "Gray"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"Thick", ",", "Gray"}], "}"}]}], "}"}]}], ",", 
       RowBox[{"Frame", "\[Rule]", " ", "True"}], ",", 
       RowBox[{"FrameLabel", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"\"\<\!\(\*SubscriptBox[\(E\), \(S\)]\) [GeV]\>\"", " ", ",",
           " ", "\"\<Yield\>\""}], "}"}]}], ",", 
       RowBox[{"FrameStyle", "\[Rule]", 
        RowBox[{"Directive", "[", 
         RowBox[{"Black", ",", " ", "23"}], "]"}]}], ",", 
       RowBox[{"ImageSize", "->", "Large"}], ",", 
       RowBox[{"PlotRange", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"mval", ",", "300"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"5", "*", 
             SuperscriptBox["10", 
              RowBox[{"-", "5"}]]}], ",", 
            RowBox[{"1.2", 
             RowBox[{"Max", "[", 
              RowBox[{"endistr", "[", 
               RowBox[{"[", 
                RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}]}]}], "}"}]}], 
         "}"}]}], ",", 
       RowBox[{"PlotLabel", "\[Rule]", 
        RowBox[{"Style", "[", 
         RowBox[{
          RowBox[{"Row", "[", 
           RowBox[{"{", 
            
            RowBox[{"\"\<HNLs, \!\(\*SubscriptBox[\(m\), \(N\)]\) = \>\"", ",",
              " ", "mval", ",", "\"\< GeV\>\""}], "}"}], "]"}], ",", "18", ",",
           "Black"}], "]"}]}]}], "]"}], ",", 
     RowBox[{"Histogram", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"datt", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "2"}], "]"}], "]"}], "}"}], ",", "200", 
       ",", "\"\<ProbabilityDensity\>\"", ",", 
       RowBox[{"PlotRange", "->", "All"}], ",", 
       RowBox[{"ScalingFunctions", "->", 
        RowBox[{"{", 
         RowBox[{"\"\<Log\>\"", ",", "\"\<Log\>\""}], "}"}]}], ",", 
       RowBox[{"Frame", "->", "True"}], ",", 
       RowBox[{"ImageSize", "->", "Large"}]}], "]"}]}], "]"}]}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.9312375408585806`*^9, 3.931237547302496*^9}, 
   3.9312376092308545`*^9, {3.93123773222164*^9, 3.9312377633816867`*^9}, {
   3.9312377979808607`*^9, 3.9312379108961887`*^9}, {3.93123795403496*^9, 
   3.931237991014484*^9}, {3.931246901398044*^9, 3.9312469223170357`*^9}},
 CellLabel->"In[12]:=",ExpressionUUID->"152e8f7d-eaba-4616-b6db-94327db4bfac"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Case when there is more than 1 coupling: Higgs-like scalar", \
"Subsubsection",
 CellChangeTimes->{{3.9291606455080023`*^9, 3.9291606651596975`*^9}, {
  3.931247263715238*^9, 
  3.931247285517471*^9}},ExpressionUUID->"393fa699-1dda-41b8-ba8a-\
110ccd570c71"],

Cell[BoxData[
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"MemberQ", "[", 
    RowBox[{
     RowBox[{"{", "\"\<Scalar\>\"", "}"}], ",", "LLPdirName"}], "]"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "weightKinematics1", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"weightKinematics1", "[", 
           RowBox[{"mLLP_", ",", "coupling1_", ",", "coupling2_", ",", 
            RowBox[{"keysMergedDistr", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", 
          RowBox[{"weightKinematics1", "[", 
           RowBox[{"mLLP_", ",", "coupling1_", ",", "coupling2_", ",", 
            RowBox[{"keysMergedDistr", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "}"}], "=", 
        RowBox[{
         RowBox[{
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{"PmotherToLLP", "[", 
             RowBox[{
             "mLLP", ",", "coupling1", ",", "coupling2", ",", "prod"}], "]"}],
             ",", 
            RowBox[{"{", 
             RowBox[{"prod", ",", "#"}], "}"}]}], "]"}], "&"}], "/@", 
         RowBox[{"{", 
          RowBox[{"ProdChannelsMixing", ",", "ProdChannelsQuartic"}], 
          "}"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"weightKinematics", "[", 
            RowBox[{
            "mLLP_", ",", "coupling1_", ",", "coupling2_", ",", "key"}], 
            "]"}], "=", 
           FractionBox[
            RowBox[{"weightKinematics1", "[", 
             RowBox[{"mLLP", ",", "coupling1", ",", "coupling2", ",", "key"}],
              "]"}], 
            RowBox[{"Sum", "[", 
             RowBox[{
              RowBox[{"weightKinematics1", "[", 
               RowBox[{"mLLP", ",", "coupling1", ",", "coupling2", ",", "k"}],
                "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"k", ",", "keysMergedDistr"}], "}"}]}], "]"}]]}], 
          ";"}], "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"key", ",", "keysMergedDistr"}], "}"}]}], "]"}], ";"}]}], 
     "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"KinematicsFromTabulatedDistribution", "[", 
      RowBox[{
      "mLLP_", ",", "coupling1_", ",", "coupling2_", ",", "Nevents_", ",", 
       "c\[Tau]LLP_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "NevTemp", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Clear", "[", "sampledLLPs", "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Do", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"NeventsKinematics", "[", "key", "]"}], "=", 
            RowBox[{"IntegerPart", "[", 
             RowBox[{"Nevents", "*", 
              RowBox[{"weightKinematics", "[", 
               RowBox[{
               "mLLP", ",", "coupling1", ",", "coupling2", ",", "key"}], 
               "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", ",", 
          RowBox[{"{", 
           RowBox[{"key", ",", "keysMergedDistr"}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"NevTemp", "=", 
         RowBox[{"Total", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"NeventsKinematics", "[", "#", "]"}], "&"}], "/@", 
           "keysMergedDistr"}], "]"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"NeventsKinematics", "[", 
            RowBox[{"keysMergedDistr", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "]"}], ">", 
           RowBox[{"NeventsKinematics", "[", 
            RowBox[{"keysMergedDistr", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "]"}]}], ",", 
          RowBox[{
           RowBox[{"NeventsKinematics", "[", 
            RowBox[{"keysMergedDistr", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "]"}], "+=", 
           RowBox[{"Nevents", "-", "NevTemp"}]}], "\[IndentingNewLine]", ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"NeventsKinematics", "[", 
            RowBox[{"keysMergedDistr", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "]"}], "+=", 
           RowBox[{"Nevents", "-", "NevTemp"}]}]}], "\[IndentingNewLine]", 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Do", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"NeventsKinematics", "[", "key", "]"}], "!=", "0"}], ",",
             "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"sampledLLPs", "[", "key", "]"}], "=", 
              RowBox[{"KinematicsFromTabulatedDistributionTemp", "[", 
               RowBox[{"mLLP", ",", "key", ",", 
                RowBox[{"NeventsKinematics", "[", "key", "]"}], ",", 
                "c\[Tau]LLP"}], "]"}]}], ";"}]}], "\[IndentingNewLine]", 
           "]"}], "\[IndentingNewLine]", ",", 
          RowBox[{"{", 
           RowBox[{"key", ",", "keysMergedDistr"}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"Join", "[", "##", "]"}], "&"}], "@@", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"sampledLLPs", "[", "#", "]"}], "&"}], "/@", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Keys", "[", 
              RowBox[{"DownValues", "@", "sampledLLPs"}], "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"All", ",", "1", ",", "1"}], "]"}], "]"}], ")"}]}], 
          ")"}]}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.9291606357487926`*^9, 3.929160675385352*^9}, {
  3.9291611854556017`*^9, 3.9291611855781527`*^9}, {3.9292080296061554`*^9, 
  3.9292080309809437`*^9}, {3.93124693464509*^9, 3.931246968611088*^9}},
 CellLabel->"In[13]:=",ExpressionUUID->"7879b092-2b86-4c0e-9d45-70a489d334d4"],

Cell[CellGroupData[{

Cell["Cross-check", "Item",
 CellChangeTimes->{{3.9291613514542017`*^9, 
  3.9291613562583885`*^9}},ExpressionUUID->"ee58689f-2d3d-4a4d-b848-\
37e09d95b7f1"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"\[Theta]2val", "=", 
          SuperscriptBox["10", 
           RowBox[{"-", "1"}]]}], ";", "\[IndentingNewLine]", 
         RowBox[{"mval", "=", "1.5"}], ";", "\[IndentingNewLine]", 
         RowBox[{"BrhToSSval", "=", "0.01"}], ";", "\[IndentingNewLine]", 
         RowBox[{"Nev", "=", 
          SuperscriptBox["10", "5"]}], ";", "\[IndentingNewLine]", 
         RowBox[{"datt", "=", 
          RowBox[{"KinematicsFromTabulatedDistribution", "[", 
           RowBox[{
           "mval", ",", "\[Theta]2val", ",", "BrhToSSval", ",", "Nev"}], 
           "]"}]}], ";"}], "//", 
        RowBox[{"AbsoluteTiming", "\[IndentingNewLine]", "norm"}]}], "=", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"weightKinematics", "[", 
           RowBox[{
           "mval", ",", "\[Theta]2val", ",", "BrhToSSval", ",", "key"}], 
           "]"}], "*", 
          RowBox[{"Quiet", "[", 
           RowBox[{"NIntegrate", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"DoubleDistrLLPint", "[", 
               RowBox[{"mval", ",", 
                RowBox[{"Exp", "[", "th", "]"}], ",", 
                RowBox[{"Exp", "[", "e", "]"}], ",", "key"}], "]"}], 
              RowBox[{"Exp", "[", 
               RowBox[{"th", "+", "e"}], "]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"th", ",", 
               RowBox[{"Log", "[", "\[Theta]minExp", "]"}], ",", 
               RowBox[{"Log", "[", "\[Theta]maxExp", "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"e", ",", 
               RowBox[{"Log", "[", "mval", "]"}], ",", 
               RowBox[{"Log", "[", 
                RowBox[{"ELLPmaxData", "[", "\"\<Total-mixing\>\"", "]"}], 
                "]"}]}], "}"}], ",", 
             RowBox[{"Method", "->", "\"\<AdaptiveMonteCarlo\>\""}]}], "]"}], 
           "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"key", ",", "keysMergedDistr"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"endistr1", "=", 
       RowBox[{"ParallelTable", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SuperscriptBox["10", "x"], ",", 
           RowBox[{"Max", "[", 
            RowBox[{
             SuperscriptBox["10", 
              RowBox[{"-", "8"}]], ",", 
             RowBox[{
              FractionBox["1", "norm"], 
              RowBox[{"Sum", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"weightKinematics", "[", 
                  RowBox[{
                  "mval", ",", "\[Theta]2val", ",", "BrhToSSval", ",", 
                   "key"}], "]"}], "*", 
                 RowBox[{"Quiet", "[", 
                  RowBox[{"NIntegrate", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"DoubleDistrLLPint", "[", 
                    RowBox[{"mval", ",", 
                    RowBox[{"Exp", "[", "th", "]"}], ",", 
                    SuperscriptBox["10", "x"], ",", "key"}], "]"}], 
                    RowBox[{"Exp", "[", "th", "]"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"th", ",", 
                    RowBox[{"Log", "[", "\[Theta]minExp", "]"}], ",", 
                    RowBox[{"Log", "[", "\[Theta]maxExp", "]"}]}], "}"}], ",", 
                    RowBox[{"Method", "->", "\"\<AdaptiveMonteCarlo\>\""}]}], 
                   "]"}], "]"}]}], ",", 
                RowBox[{"{", 
                 RowBox[{"key", ",", "keysMergedDistr"}], "}"}]}], "]"}]}]}], 
            "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"x", ",", 
           RowBox[{"Log10", "[", "mval", "]"}], ",", 
           RowBox[{"Log10", "[", 
            RowBox[{"ELLPmaxData", "[", "\"\<Total-mixing\>\"", "]"}], "]"}], 
           ",", "0.03"}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Theta]2val", "=", "0"}], ";", "\[IndentingNewLine]", 
      RowBox[{"mval", "=", "1.5"}], ";", "\[IndentingNewLine]", 
      RowBox[{"BrhToSSval", "=", "0.01"}], ";", "\[IndentingNewLine]", 
      RowBox[{"datt2", "=", 
       RowBox[{"KinematicsFromTabulatedDistribution", "[", 
        RowBox[{"mval", ",", "\[Theta]2val", ",", "BrhToSSval", ",", "Nev"}], 
        "]"}]}], ";"}], "//", 
     RowBox[{"AbsoluteTiming", "\[IndentingNewLine]", "norm"}]}], "=", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"weightKinematics", "[", 
        RowBox[{"mval", ",", "\[Theta]2val", ",", "BrhToSSval", ",", "key"}], 
        "]"}], "*", 
       RowBox[{"Quiet", "[", 
        RowBox[{"NIntegrate", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"DoubleDistrLLPint", "[", 
            RowBox[{"mval", ",", 
             RowBox[{"Exp", "[", "th", "]"}], ",", 
             RowBox[{"Exp", "[", "e", "]"}], ",", "key"}], "]"}], 
           RowBox[{"Exp", "[", 
            RowBox[{"th", "+", "e"}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"th", ",", 
            RowBox[{"Log", "[", "\[Theta]minExp", "]"}], ",", 
            RowBox[{"Log", "[", "\[Theta]maxExp", "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"e", ",", 
            RowBox[{"Log", "[", "mval", "]"}], ",", 
            RowBox[{"Log", "[", 
             RowBox[{"ELLPmaxData", "[", "\"\<Total-mixing\>\"", "]"}], 
             "]"}]}], "}"}], ",", 
          RowBox[{"Method", "->", "\"\<AdaptiveMonteCarlo\>\""}]}], "]"}], 
        "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"key", ",", "keysMergedDistr"}], "}"}]}], "]"}]}], ";", 
   "\[IndentingNewLine]", 
   RowBox[{"endistr2", "=", 
    RowBox[{"ParallelTable", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        SuperscriptBox["10", "x"], ",", 
        RowBox[{"Max", "[", 
         RowBox[{
          SuperscriptBox["10", 
           RowBox[{"-", "7"}]], ",", 
          RowBox[{
           FractionBox["1", "norm"], 
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"weightKinematics", "[", 
               RowBox[{
               "mval", ",", "\[Theta]2val", ",", "BrhToSSval", ",", "key"}], 
               "]"}], "*", 
              RowBox[{"Quiet", "[", 
               RowBox[{"NIntegrate", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"DoubleDistrLLPint", "[", 
                   RowBox[{"mval", ",", 
                    RowBox[{"Exp", "[", "th", "]"}], ",", 
                    SuperscriptBox["10", "x"], ",", "key"}], "]"}], 
                  RowBox[{"Exp", "[", "th", "]"}]}], ",", 
                 RowBox[{"{", 
                  RowBox[{"th", ",", 
                   RowBox[{"Log", "[", "\[Theta]minExp", "]"}], ",", 
                   RowBox[{"Log", "[", "\[Theta]maxExp", "]"}]}], "}"}], ",", 
                 RowBox[{"Method", "->", "\"\<AdaptiveMonteCarlo\>\""}]}], 
                "]"}], "]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"key", ",", "keysMergedDistr"}], "}"}]}], "]"}]}]}], 
         "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", 
        RowBox[{"Log10", "[", "mval", "]"}], ",", 
        RowBox[{"Log10", "[", 
         RowBox[{"ELLPmaxData", "[", "\"\<Total-mixing\>\"", "]"}], "]"}], ",",
         "0.03"}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Show", "[", 
     RowBox[{
      RowBox[{"Histogram", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"datt", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "2"}], "]"}], "]"}], ",", 
          RowBox[{"datt2", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "2"}], "]"}], "]"}]}], "}"}], ",", "200", 
        ",", "\"\<ProbabilityDensity\>\"", ",", 
        RowBox[{"PlotRange", "->", "All"}], ",", 
        RowBox[{"ScalingFunctions", "->", 
         RowBox[{"{", 
          RowBox[{"\"\<Log\>\"", ",", "\"\<Log\>\""}], "}"}]}], ",", 
        RowBox[{"Frame", "->", "True"}], ",", 
        RowBox[{"ImageSize", "->", "Large"}]}], "]"}], ",", 
      RowBox[{"ListLogLogPlot", "[", 
       RowBox[{"{", 
        RowBox[{"endistr2", ",", "endistr1"}], "}"}], "]"}]}], "]"}], "\[IndentingNewLine]", 
    RowBox[{"Show", "[", 
     RowBox[{
      RowBox[{"ListLogLogPlot", "[", 
       RowBox[{
        RowBox[{"{", "endistr2", "}"}], ",", 
        RowBox[{"Joined", "->", "True"}], ",", 
        RowBox[{"PlotStyle", "->", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"Thick", ",", "Gray"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"Thick", ",", "Gray"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"Thick", ",", "Gray"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"Thick", ",", 
             RowBox[{"Lighter", "@", "Gray"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"Thick", ",", "Gray"}], "}"}]}], "}"}]}], ",", 
        RowBox[{"Frame", "\[Rule]", " ", "True"}], ",", 
        RowBox[{"FrameLabel", "\[Rule]", 
         RowBox[{"{", 
          
          RowBox[{"\"\<\!\(\*SubscriptBox[\(E\), \(S\)]\) [GeV]\>\"", " ", ",",
            " ", "\"\<Yield\>\""}], "}"}]}], ",", 
        RowBox[{"FrameStyle", "\[Rule]", 
         RowBox[{"Directive", "[", 
          RowBox[{"Black", ",", " ", "23"}], "]"}]}], ",", 
        RowBox[{"ImageSize", "->", "Large"}], ",", 
        RowBox[{"PlotRange", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1.5", ",", "300"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"5", "*", 
              SuperscriptBox["10", 
               RowBox[{"-", "5"}]]}], ",", "0.03"}], "}"}]}], "}"}]}], ",", 
        RowBox[{"PlotLabel", "\[Rule]", 
         RowBox[{"Style", "[", 
          RowBox[{
           RowBox[{"Row", "[", 
            RowBox[{
            "{", "\"\<Higgs-like scalars, \!\(\*SubscriptBox[\(m\), \(S\)]\) \
= 1.5 GeV\>\"", "}"}], "]"}], ",", "18", ",", "Black"}], "]"}]}]}], "]"}], ",", 
      RowBox[{"Histogram", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"datt2", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "2"}], "]"}], "]"}], "}"}], ",", "200", 
        ",", "\"\<ProbabilityDensity\>\"", ",", 
        RowBox[{"PlotRange", "->", "All"}], ",", 
        RowBox[{"ScalingFunctions", "->", 
         RowBox[{"{", 
          RowBox[{"\"\<Log\>\"", ",", "\"\<Log\>\""}], "}"}]}], ",", 
        RowBox[{"Frame", "->", "True"}], ",", 
        RowBox[{"ImageSize", "->", "Large"}]}], "]"}]}], "]"}]}]}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.9291194995449324`*^9, 3.9291195073500175`*^9}, {
   3.929121383474998*^9, 3.929121399663206*^9}, {3.9291611507971525`*^9, 
   3.929161151497992*^9}, {3.9291612578204637`*^9, 3.929161276914212*^9}, {
   3.9291613958761625`*^9, 3.929161507645341*^9}, {3.929161543079305*^9, 
   3.9291616778558083`*^9}, {3.9291617319364243`*^9, 3.929161792850301*^9}, {
   3.929161827750122*^9, 3.929161845847402*^9}, {3.9291654821767287`*^9, 
   3.929165549357268*^9}, {3.9291655999989986`*^9, 3.9291656042081184`*^9}, {
   3.9291657874138556`*^9, 3.929165788073716*^9}, {3.9291658835571632`*^9, 
   3.9291658844203568`*^9}, {3.9291660066257915`*^9, 3.9291660084323435`*^9}, 
   3.929166416863261*^9, 3.929166478503698*^9, {3.9291665286914115`*^9, 
   3.929166529107806*^9}, {3.929166575823943*^9, 3.929166587218215*^9}, {
   3.929166646709227*^9, 3.929166693966256*^9}, 3.9292075846006947`*^9, {
   3.9292092920306416`*^9, 3.9292092920940485`*^9}, 3.9292516669382224`*^9, 
   3.9292536231530995`*^9, {3.9292905485281954`*^9, 3.929290551198413*^9}, {
   3.929986191157898*^9, 3.929986194640443*^9}, {3.9299862548985677`*^9, 
   3.929986282772087*^9}, {3.929986365024571*^9, 3.9299863656195097`*^9}, 
   3.9299864533202505`*^9, {3.929987038152465*^9, 3.9299870411409826`*^9}},
 CellLabel->"In[14]:=",ExpressionUUID->"a36124ff-0faf-4dbd-8da8-d41528124021"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Yield of LLPs flying within ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[Theta]", "min"], "<", "\[Theta]", "<", 
    SubscriptBox["\[Theta]", "max"]}], TraditionalForm]],ExpressionUUID->
  "09d723d6-e16e-4b92-a6cc-27b822fc2408"]
}], "Section",
 CellChangeTimes->{{3.929092496966363*^9, 
  3.9290925122870817`*^9}},ExpressionUUID->"138d4793-2038-49e6-8a9d-\
4682ff4c83f8"],

Cell[CellGroupData[{

Cell["Dense grids of \[Theta]", "Subsection",
 CellChangeTimes->{{3.9312399287973824`*^9, 
  3.931239942401525*^9}},ExpressionUUID->"7361e2cd-87dd-4647-8b43-\
141b38be3912"],

Cell[BoxData[
 RowBox[{"If", "[", 
  RowBox[{"EventCalc", ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[CapitalDelta]xVals", "[", "list_", "]"}], ":=", 
     RowBox[{
      RowBox[{"Rest", "[", "list", "]"}], "-", 
      RowBox[{"Most", "[", "list", "]"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"\[CapitalDelta]xValsTotComp", "=", 
     RowBox[{
      RowBox[{"Hold", "@", 
       RowBox[{"Compile", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"\[CapitalDelta]\[Theta]vals", ",", "_Real", ",", "1"}], 
            "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"\[CapitalDelta]Evals", ",", "_Real", ",", "1"}], "}"}]}],
           "}"}], ",", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Compile`GetElement", "[", 
              RowBox[{"\[CapitalDelta]\[Theta]vals", ",", "i"}], "]"}], "*", 
             RowBox[{"Compile`GetElement", "[", 
              RowBox[{"\[CapitalDelta]Evals", ",", "j"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", 
             RowBox[{"Length", "[", "\[CapitalDelta]\[Theta]vals", "]"}]}], 
            "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "1", ",", 
             RowBox[{"Length", "[", "\[CapitalDelta]Evals", "]"}]}], "}"}]}], 
          "]"}], ",", 
         RowBox[{"CompilationTarget", "\[Rule]", "\"\<MVM\>\""}], ",", 
         RowBox[{"RuntimeOptions", "\[Rule]", "\"\<Speed\>\""}]}], "]"}]}], "//",
       "ReleaseHold"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
     "___", "___", "___", "___", "___", "___", "___", "___", "___", "__"}], 
     "*)"}], "\[IndentingNewLine]", 
    RowBox[{"(*", "\[Theta]", "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Step\[Theta]tempDense", "[", "\[Theta]fip_", "]"}], "=", 
     RowBox[{"Piecewise", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"3", "*", 
           SuperscriptBox["10", 
            RowBox[{"-", "5."}]]}], ",", 
          RowBox[{"\[Theta]fip", "<", 
           SuperscriptBox["10", 
            RowBox[{"-", "4."}]]}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"3", "*", 
           SuperscriptBox["10", 
            RowBox[{"-", "4."}]]}], ",", 
          RowBox[{
           SuperscriptBox["10", 
            RowBox[{"-", "4"}]], "<=", "\[Theta]fip", "<", 
           SuperscriptBox["10", 
            RowBox[{"-", "3."}]]}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"0.5", "*", 
           SuperscriptBox["10", 
            RowBox[{"-", "3."}]]}], ",", 
          RowBox[{
           SuperscriptBox["10", 
            RowBox[{"-", "3"}]], "\[LessEqual]", "\[Theta]fip", "\[LessEqual]", 
           SuperscriptBox["10", 
            RowBox[{"-", "2."}]]}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"0.1", "*", 
           SuperscriptBox["10", 
            RowBox[{"-", "2."}]]}], ",", 
          RowBox[{
           SuperscriptBox["10", 
            RowBox[{"-", "2."}]], "<", "\[Theta]fip", "<", 
           SuperscriptBox["10", 
            RowBox[{"-", "1."}]]}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0.0025", ",", 
          RowBox[{
           SuperscriptBox["10", 
            RowBox[{"-", "1."}]], "\[LessEqual]", "\[Theta]fip", "<", 
           "0.2"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0.01", ",", 
          RowBox[{"0.2", "\[LessEqual]", "\[Theta]fip", "<=", "0.5"}]}], 
         "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0.025", ",", 
          RowBox[{"0.5", "<", "\[Theta]fip", "<=", "Pi"}]}], "}"}]}], "}"}], 
      "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"OutGridAngleDense", "[", 
      RowBox[{"\[Theta]min_", ",", "\[Theta]max_"}], "]"}], ":=", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"With", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"start", "=", "\[Theta]min"}], ",", 
               RowBox[{"end", "=", "\[Theta]max"}]}], "}"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"NestWhileList", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"#", "+", 
                 RowBox[{"Step\[Theta]tempDense", "[", "#", "]"}]}], "&"}], ",",
                "start", ",", 
               RowBox[{
                RowBox[{"#", "\[LessEqual]", "end"}], "&"}], ",", "1", ",", 
               "\[Infinity]", ",", 
               RowBox[{"-", "1"}]}], "]"}]}], "]"}], "//", "N"}], ",", 
          RowBox[{"{", "\[Theta]max", "}"}]}], "]"}], "//", 
        "DeleteDuplicates"}]}], "\[IndentingNewLine]", "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
     "___", "___", "___", "___", "___", "___", "___", "___", "___", "__"}], 
     "*)"}], "\[IndentingNewLine]", 
    RowBox[{"(*", "E", "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"StepEtempDense", "[", "Efip_", "]"}], "=", 
     RowBox[{"Piecewise", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0.3", ",", 
          RowBox[{"Efip", "\[LessEqual]", "2.5"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0.5", ",", 
          RowBox[{"2.5", "<", "Efip", "<", "35"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"2", ",", 
          RowBox[{"35", "\[LessEqual]", "Efip", "\[LessEqual]", "300"}]}], 
         "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"5", ",", 
          RowBox[{"300", "\[LessEqual]", "Efip", "<", "400"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"10", ",", 
          RowBox[{"400", "<=", "Efip", "<", "700"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"40", ",", 
          RowBox[{"700", "\[LessEqual]", "Efip", "<", "2000"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"100", ",", 
          RowBox[{"2000", "\[LessEqual]", "Efip", "<", "4000"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"200", ",", 
          RowBox[{"4000", "\[LessEqual]", "Efip", "<", "7000"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"400", ",", 
          RowBox[{"7000", "\[LessEqual]", "Efip", "\[LessEqual]", "50000"}]}],
          "}"}]}], "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"OutGridEnergyDense", "[", 
      RowBox[{"Emin_", ",", "Emax_"}], "]"}], ":=", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"With", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"start", "=", 
               RowBox[{"1.01", "Emin"}]}], ",", 
              RowBox[{"end", "=", "Emax"}]}], "}"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"NestWhileList", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"#", "+", 
                RowBox[{"StepEtempDense", "[", "#", "]"}]}], "&"}], ",", 
              "start", ",", 
              RowBox[{
               RowBox[{"#", "\[LessEqual]", "end"}], "&"}], ",", "1", ",", 
              "\[Infinity]", ",", 
              RowBox[{"-", "1"}]}], "]"}]}], "]"}], "//", "N"}], ",", 
         RowBox[{"{", "Emax", "}"}]}], "]"}]}], "\[IndentingNewLine]", 
      "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"proctype", "=", 
     RowBox[{
      RowBox[{"Select", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Keys", "[", 
          RowBox[{"DownValues", "@", "GridInFinal"}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "1", ",", "1"}], "]"}], "]"}], ",", 
        RowBox[{
         RowBox[{"StringContainsQ", "[", 
          RowBox[{"#", ",", "\"\<Total\>\""}], "]"}], "&"}]}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"griddense", "[", 
      RowBox[{
      "mLLP_", ",", "\[Theta]min_", ",", "\[Theta]max_", ",", "Emin_", ",", 
       "Emax_"}], "]"}], ":=", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"gr\[Theta]", "=", 
         RowBox[{"OutGridAngleDense", "[", 
          RowBox[{"\[Theta]min", ",", "\[Theta]max"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"out\[Theta]logdense", "=", 
         RowBox[{"Log10", "[", 
          FractionBox[
           RowBox[{
            RowBox[{"Rest", "[", "gr\[Theta]", "]"}], "+", 
            RowBox[{"Most", "[", "gr\[Theta]", "]"}]}], "2"], "]"}]}], 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"GridInFinal", "[", 
           RowBox[{"FIP", ",", "Facility", ",", "ProdChannel"}], "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}], "*)"}], ";", "\[IndentingNewLine]", 
        RowBox[{"\[CapitalDelta]\[Theta]vals", "=", 
         RowBox[{"\[CapitalDelta]xVals", "[", "gr\[Theta]", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"gr", "=", 
         RowBox[{"OutGridEnergyDense", "[", 
          RowBox[{
           RowBox[{"Max", "[", 
            RowBox[{"mLLP", ",", 
             RowBox[{"ELLPminData", "[", "proctype", "]"}], ",", "Emin"}], 
            "]"}], ",", 
           RowBox[{"Min", "[", 
            RowBox[{"Emax", ",", 
             RowBox[{"ELLPmaxData", "[", "proctype", "]"}]}], "]"}]}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"outElogdense", "=", 
         RowBox[{"Log10", "[", 
          FractionBox[
           RowBox[{
            RowBox[{"Rest", "[", "gr", "]"}], "+", 
            RowBox[{"Most", "[", "gr", "]"}]}], "2"], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"outlogdense", "=", 
         RowBox[{"Tuples", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"10", "^", "out\[Theta]logdense"}], ",", 
            RowBox[{"10", "^", "outElogdense"}]}], "}"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"xgDistr", "=", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"Log10", "[", 
             RowBox[{"N", "[", "mLLP", "]"}], "]"}], "}"}], ",", 
           "out\[Theta]logdense", ",", "outElogdense"}], "}"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"\[CapitalDelta]Evals", "=", 
         RowBox[{"\[CapitalDelta]xVals", "[", "gr", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"\[CapitalDelta]xValsTot", "=", 
         RowBox[{"Flatten", "[", 
          RowBox[{
           RowBox[{"\[CapitalDelta]xValsTotComp", "[", 
            RowBox[{
            "\[CapitalDelta]\[Theta]vals", ",", "\[CapitalDelta]Evals"}], 
            "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", "2"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"xgDistr", ",", "\[CapitalDelta]xValsTot"}], "}"}]}]}], 
      "\[IndentingNewLine]", "]"}]}]}]}], "\[IndentingNewLine]", 
  "]"}]], "Input",
 CellChangeTimes->{{3.9312399436590824`*^9, 3.931239970942062*^9}, {
   3.931240025327153*^9, 3.9312400461779647`*^9}, {3.931240417881461*^9, 
   3.931240418400406*^9}, {3.9312482796429567`*^9, 3.9312483161465044`*^9}, {
   3.952098878015009*^9, 3.9520988862822094`*^9}, 3.9527543511991997`*^9},
 CellLabel->"In[15]:=",ExpressionUUID->"41b88e20-10d4-4aae-b9eb-b2c2a5e063c6"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Dense grid of E and overall", "Subsection",
 CellChangeTimes->{{3.9312399287973824`*^9, 
  3.9312399397371535`*^9}},ExpressionUUID->"777c898c-0ac0-4580-afb7-\
c07c8e0f97f7"],

Cell[BoxData[
 RowBox[{"If", "[", 
  RowBox[{"EventCalc", ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"test", "=", "0"}], ";", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"___", "___", "___", "___", "___", "___", "___", "___", "_"}], 
     "*)"}], "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"Grids", " ", "of", " ", "\[Theta]"}], ",", 
      RowBox[{
      "E", " ", "to", " ", "compute", " ", "the", " ", "yield", " ", "of", " ",
        "LLPs"}]}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"LLPyield\[Theta]temp", "[", 
      RowBox[{
      "mLLP_", ",", "proctype_", ",", "\[Theta]min_", ",", "\[Theta]max_", ",",
        "Emin_", ",", "Emax_"}], "]"}], ":=", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"mLLPmin", "[", "proctype", "]"}], "<=", "mLLP", "<=", 
           RowBox[{"mLLPmax", "[", "proctype", "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"gDistr", "=", 
            RowBox[{"GridInFinal", "[", "proctype", "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"xgDistr", ",", "\[CapitalDelta]xValsTot"}], "}"}], "=", 
            RowBox[{"griddense", "[", 
             RowBox[{
             "mLLP", ",", "\[Theta]min", ",", "\[Theta]max", ",", "Emin", ",",
               "Emax"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"xigDistr", "=", 
              RowBox[{"MapThread", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"Interpolation", "[", 
                   RowBox[{
                    RowBox[{"Transpose", "@", 
                    RowBox[{"{", 
                    RowBox[{"#", ",", 
                    RowBox[{"Range", "@", 
                    RowBox[{"Length", "@", "#"}]}]}], "}"}]}], ",", 
                    RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[",
                   "#2", "]"}], "&"}], ",", 
                RowBox[{"{", 
                 RowBox[{"gDistr", ",", "xgDistr"}], "}"}]}], "]"}]}], ";"}], 
            "*)"}], "\[IndentingNewLine]", 
           RowBox[{"xigDistr", "=", 
            RowBox[{"MapThread", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Module", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"interp", "=", 
                   RowBox[{
                    RowBox[{"Interpolation", "[", 
                    RowBox[{
                    RowBox[{"Transpose", "@", 
                    RowBox[{"{", 
                    RowBox[{"#", ",", 
                    RowBox[{"Range", "@", 
                    RowBox[{"Length", "@", "#"}]}]}], "}"}]}], ",", 
                    RowBox[{"InterpolationOrder", "->", "1"}]}], "]"}], "[", 
                    "#2", "]"}]}], "}"}], ",", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"ListQ", "[", "interp", "]"}], ",", "interp", ",", 
                   RowBox[{"{", "interp", "}"}]}], "]"}]}], "]"}], "&"}], ",", 
              RowBox[{"{", 
               RowBox[{"gDistr", ",", "xgDistr"}], "}"}]}], "]"}]}], ";", 
           "\n", 
           RowBox[{"DistrResult", "=", 
            RowBox[{"Partition", "[", 
             RowBox[{
              RowBox[{"Flatten", "@", 
               RowBox[{"cf3", "[", 
                RowBox[{
                 RowBox[{"Sequence", "@@", "xigDistr"}], ",", 
                 RowBox[{"DistrVals", "[", "proctype", "]"}]}], "]"}]}], ",", 
              "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"yield", "=", 
            RowBox[{
             RowBox[{"Total", "[", 
              RowBox[{
               RowBox[{"10", "^", "DistrResult"}], "*", 
               "\[CapitalDelta]xValsTot"}], "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", ",",
           "\[IndentingNewLine]", 
          RowBox[{"yield", "=", "0."}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Flatten", "[", 
          RowBox[{
           RowBox[{"Exp", "[", "DistrResult", "]"}], 
           "\[CapitalDelta]xValsTot"}], "]"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"yield", "<", 
           SuperscriptBox["10", 
            RowBox[{"-", "30."}]]}], ",", "0.", ",", "yield"}], "]"}]}]}], 
      "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"mLLPlistYield", "=", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"min", "=", 
          RowBox[{"Min", "[", 
           RowBox[{"mLLPlist", "[", "\"\<Total\>\"", "]"}], "]"}]}], ",", 
         RowBox[{"max", "=", 
          RowBox[{"Max", "[", 
           RowBox[{"mLLPlist", "[", "\"\<Total\>\"", "]"}], "]"}]}]}], "}"}], 
       ",", 
       RowBox[{"Table", "[", 
        RowBox[{"m", ",", 
         RowBox[{"{", 
          RowBox[{"m", ",", "min", ",", "max", ",", 
           FractionBox[
            RowBox[{"(", 
             RowBox[{"max", "-", "min"}], ")"}], "100"]}], "}"}]}], "]"}]}], 
      "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"MemberQ", "[", 
        RowBox[{
         RowBox[{"{", 
          
          RowBox[{"\"\<DP\>\"", ",", "\"\<HNL\>\"", ",", "\"\<LDM-DP\>\"", 
           ",", "\"\<ALP-photon\>\""}], "}"}], ",", "LLPdirName"}], "]"}], "||", 
       RowBox[{"StringContainsQ", "[", 
        RowBox[{"LLPdirName", ",", "\"\<Inelastic-DP-DM\>\""}], "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"LLPyield\[Theta]", "[", 
         RowBox[{
         "mLLP_", ",", "coupling1_", ",", "coupling2_", ",", "\[Theta]min_", ",",
           "\[Theta]max_", ",", "Emin_", ",", "Emax_"}], "]"}], ":=", 
        RowBox[{"LLPyield\[Theta]temp", "[", 
         RowBox[{
         "mLLP", ",", "\"\<Total\>\"", ",", "\[Theta]min", ",", "\[Theta]max",
           ",", "Emin", ",", "Emax"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"LLPyield\[Theta]All", "[", 
         RowBox[{"mLLP_", ",", "coupling1_", ",", "coupling2_"}], "]"}], "=", 
        RowBox[{
         RowBox[{"Interpolation", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{"#", ",", 
               RowBox[{"LLPyield\[Theta]temp", "[", 
                RowBox[{
                "#", ",", "\"\<Total\>\"", ",", "\[Theta]minYield", ",", 
                 "\[Theta]maxYield", ",", "#", ",", 
                 RowBox[{"ELLPmaxData", "[", "\"\<Total\>\"", "]"}]}], 
                "]"}]}], "}"}], "&"}], "/@", "mLLPlistYield"}], ",", 
           RowBox[{"InterpolationOrder", "->", "1"}]}], "]"}], "[", "mLLP", 
         "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"MemberQ", "[", 
       RowBox[{
        RowBox[{"{", "\"\<Scalar\>\"", "}"}], ",", "LLPdirName"}], "]"}], ",",
       "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"LLPyield\[Theta]", "[", 
         RowBox[{
         "mLLP_", ",", "coupling1_", ",", "coupling2_", ",", "\[Theta]min_", ",",
           "\[Theta]max_", ",", "Emin_", ",", "Emax_"}], "]"}], ":=", 
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"weightKinematics", "[", 
            RowBox[{"mLLP", ",", "coupling1", ",", "coupling2", ",", "key"}], 
            "]"}], "*", 
           RowBox[{"LLPyield\[Theta]temp", "[", 
            RowBox[{
            "mLLP", ",", "key", ",", "\[Theta]min", ",", "\[Theta]max", ",", 
             "Emin", ",", "Emax"}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"key", ",", "keysMergedDistr"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"LLPyield\[Theta]All", "[", 
         RowBox[{"mLLP_", ",", "coupling1_", ",", "coupling2_"}], "]"}], "=", 
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"weightKinematics", "[", 
            RowBox[{"mLLP", ",", "coupling1", ",", "coupling2", ",", "key"}], 
            "]"}], "*", 
           RowBox[{
            RowBox[{"Interpolation", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"#", ",", 
                  RowBox[{"LLPyield\[Theta]temp", "[", 
                   RowBox[{
                   "#", ",", "key", ",", "\[Theta]minYield", ",", 
                    "\[Theta]maxYield", ",", "#", ",", 
                    RowBox[{"ELLPmaxData", "[", "key", "]"}]}], "]"}]}], 
                 "}"}], "&"}], "/@", "mLLPlistYield"}], ",", 
              RowBox[{"InterpolationOrder", "->", "1"}]}], "]"}], "[", "mLLP",
             "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"key", ",", "keysMergedDistr"}], "}"}]}], "]"}]}], ";"}]}],
      "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"LogLogPlot", "[", 
    RowBox[{
     RowBox[{"Evaluate", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"LLPyield\[Theta]", "[", 
         RowBox[{"mLLP", ",", "1", ",", "0"}], "]"}], ",", 
        RowBox[{"LLPyield\[Theta]", "[", 
         RowBox[{"mLLP", ",", "0", ",", "1"}], "]"}]}], "}"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"mLLP", ",", "0.02", ",", "5.1"}], "}"}]}], "]"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"LogLogPlot", "[", 
     RowBox[{
      RowBox[{"LLPyield\[Theta]", "[", "mLLP", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"mLLP", ",", "0.02", ",", "3"}], "}"}], ",", 
      RowBox[{"PlotRange", "->", "All"}]}], "]"}], ";"}], "*)"}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->CompressedData["
1:eJwd0F1Ik2EAxfHXic0WGeEWuhRWgS0dNGmpNdyHsSljMbaBGQSS+U1gbhMN
bDjUiWs5qIShlkNHDFEaKSpDReaa9oF6MZnSQkQtUaYYGLXIes57cfjdnKv/
hbI6XQWDoig+GfQq5LkZyqg8xFoSQ973CRl89umnHsoqakpg9xfhQ6h7fCrj
MlG7VUUrevvbVErcHXrQABm2pCdQyBs3Q8He31ZoiqnaIOc8qxMWnRE+hWb/
q3A7sfzuaAQ+ej17CCmD9g8UqRMoK9FtZJ+ElSwLH760llyB0m5rNvR+m6Yt
X3HkwYuaIiUUHu6r4I9IugbybzFGoKtdQ8sdTt6GPCmXtst2wO4gHjTKODDT
ub4AJcHwB9i8MtMkUUXl/r1/tMr0lk5oKux5AXOmepwwZk/tg+GxfBdsTuMM
wI143xs49tzng/GeoB8ums8FoOro2keodjoW6V/qpRAstvPDMLL27iusrmVs
wJn5+gQp8cTndTaMTbpTYEjAFcB7NZtXYX9IlAsT95li2OJNyYe9yR2rBcT7
192b0NNfq7DpSJ+GX0rYFnd8w3KH9N7R34Q7TMtppoF0zZxLgiLt2UE4OXHb
DWfHjUGYJ5bMw8DWcaDQGJUvZ7veQ48hLktNFFQraP8Dzr8rhg==
  "],
 CellLabel->
  "In[131]:=",ExpressionUUID->"2b3ec2aa-f6d2-4061-8613-078ff227557b"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Azimuthal acceptance", "Section",
 CellChangeTimes->{{3.9290930905225534`*^9, 
  3.9290930940773435`*^9}},ExpressionUUID->"9cb9e4c6-5f4c-4ff8-b72d-\
ef8371124ad6"],

Cell[CellGroupData[{

Cell[TextData[Cell[BoxData[
 FormBox[
  RowBox[{"<", 
   SubscriptBox["\[Epsilon]", "az"], 
   SubscriptBox[">", "z"]}], 
  TraditionalForm]],ExpressionUUID->"12e7cb56-af19-4e29-96ff-8003b2d60cc0"]], \
"Subsection",
 CellChangeTimes->{{3.929094611805294*^9, 
  3.9290946249915857`*^9}},ExpressionUUID->"3bbacf9a-5eca-4201-845a-\
95a319037752"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{"EventCalc", ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\[Epsilon]AzZcomp", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Hold", "@", 
         RowBox[{"Compile", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"thvals", ",", "_Real"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"zvals", ",", "_Real", ",", "1"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"j", ",", "_Integer"}], "}"}]}], "}"}], ",", 
           RowBox[{"Module", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"cond", "=", "0"}], ",", 
               RowBox[{"th", "=", "thvals"}], ",", 
               RowBox[{"z", "=", "0."}], ",", 
               RowBox[{"acc", "=", "0"}], ",", 
               RowBox[{"ph", "=", "0."}], ",", 
               RowBox[{"xv", "=", "0."}], ",", 
               RowBox[{"yv", "=", "0."}], ",", 
               RowBox[{"phmax", "=", 
                RowBox[{"-", "Pi"}]}], ",", 
               RowBox[{"phmin", "=", "Pi"}]}], "}"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Do", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{
                 RowBox[{"ph", "=", 
                  RowBox[{"RandomReal", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "Pi"}], ",", "Pi"}], "}"}], "]"}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"z", "=", 
                  RowBox[{"Compile`GetElement", "[", 
                   RowBox[{"zvals", ",", "j"}], "]"}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"xv", "=", 
                  RowBox[{
                   FractionBox["z", 
                    RowBox[{"Cos", "[", "th", "]"}]], "*", 
                   RowBox[{"Sin", "[", "th", "]"}], "*", 
                   RowBox[{"Cos", "[", "ph", "]"}]}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"yv", "=", 
                  RowBox[{
                   FractionBox["z", 
                    RowBox[{"Cos", "[", "th", "]"}]], "*", 
                   RowBox[{"Sin", "[", "th", "]"}], "*", 
                   RowBox[{"Sin", "[", "ph", "]"}]}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"cond", "=", 
                  RowBox[{"IfLLPinsideDecVol", "[", 
                   RowBox[{"z", ",", "xv", ",", "yv"}], "]"}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"cond", "==", "1"}], ",", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"acc", "+=", "cond"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"phmin", "=", 
                    RowBox[{"Min", "[", 
                    RowBox[{"ph", ",", "phmin"}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"phmax", "=", 
                    RowBox[{"Max", "[", 
                    RowBox[{"ph", ",", "phmax"}], "]"}]}], ";"}]}], 
                  "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
                ",", 
                RowBox[{"{", 
                 RowBox[{"i", ",", "1", ",", 
                  SuperscriptBox["10", "4"], ",", "1"}], "}"}]}], "]"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{"thvals", ",", "z", ",", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"acc", "==", "0"}], ",", 
                  SuperscriptBox["10", 
                   RowBox[{"-", "90."}]], ",", 
                  FractionBox["acc", 
                   SuperscriptBox["10", "4."]]}], "]"}], ",", "phmin", ",", 
                "phmax"}], "}"}]}]}], "\[IndentingNewLine]", "]"}], ",", 
           RowBox[{"CompilationTarget", "->", "\"\<C\>\""}], ",", 
           RowBox[{"RuntimeOptions", "->", "\"\<Speed\>\""}], ",", 
           RowBox[{"RuntimeAttributes", "->", 
            RowBox[{"{", "Listable", "}"}]}], ",", 
           RowBox[{"Parallelization", "->", "True"}]}], "]"}]}], "/.", 
        RowBox[{"ruleDown", "[", 
         RowBox[{"{", "IfLLPinsideDecVol", "}"}], "]"}]}], "//", 
       "ReleaseHold"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"<<", "CompiledFunctionTools`"}], ";", "\n", 
     RowBox[{"CompilePrint", "@", "\[Epsilon]AzZcomp"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Epsilon]AzTotComp", "=", 
      RowBox[{"With", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"accz", "=", "\[Epsilon]AzZcomp"}], "}"}], ",", 
        RowBox[{
         RowBox[{"Hold", "@", 
          RowBox[{"Compile", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"thvals", ",", "_Real"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"zvals", ",", "_Real", ",", "1"}], "}"}]}], "}"}], ",",
             "\[IndentingNewLine]", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"accz", "[", 
               RowBox[{"thvals", ",", "zvals", ",", "j"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"j", ",", "1", ",", 
                RowBox[{"Length", "[", "zvals", "]"}], ",", "1"}], "}"}]}], 
             "]"}], ",", 
            RowBox[{"CompilationTarget", "->", "\"\<C\>\""}], ",", 
            RowBox[{"RuntimeOptions", "->", "\"\<Speed\>\""}], ",", 
            RowBox[{"RuntimeAttributes", "->", 
             RowBox[{"{", "Listable", "}"}]}], ",", 
            RowBox[{"Parallelization", "->", "True"}]}], "]"}]}], "//", 
         "ReleaseHold"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"<<", "CompiledFunctionTools`"}], ";", "\n", 
     RowBox[{"CompilePrint", "@", "\[Epsilon]AzTotComp"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"AzimuthalAcceptanceTabulatedBlock", ":=", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"zgrid", "=", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Join", "[", 
              RowBox[{
               RowBox[{"Table", "[", 
                RowBox[{"z", ",", 
                 RowBox[{"{", 
                  RowBox[{"z", ",", "zDecVolMin", ",", 
                   RowBox[{"zDecVolMin", "+", 
                    RowBox[{"0.99", 
                    RowBox[{"(", 
                    RowBox[{"zDecVolMax", "-", "zDecVolMin"}], ")"}]}]}], ",", 
                   RowBox[{"Max", "[", 
                    RowBox[{
                    FractionBox[
                    RowBox[{"0.99", 
                    RowBox[{"(", 
                    RowBox[{"zDecVolMax", "-", "zDecVolMin"}], ")"}]}], 
                    "100"], ",", "0.25"}], "]"}]}], "}"}]}], "]"}], ",", 
               RowBox[{"{", "zDecVolMax", "}"}]}], "]"}], "//", "Sort"}], "//",
             "DeleteDuplicates"}], "//", "N"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"\[Theta]minExp", "<", 
            SuperscriptBox["10", 
             RowBox[{"-", "5."}]]}], ",", 
           RowBox[{"\[Theta]minEff", "=", 
            SuperscriptBox["10", 
             RowBox[{"-", "5."}]]}], ",", 
           RowBox[{"\[Theta]minEff", "=", "\[Theta]minExp"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"out\[Theta]logdenseAzAcc", "=", 
          RowBox[{"Log", "[", 
           RowBox[{"OutGridAngleDense", "[", 
            RowBox[{"\[Theta]minEff", ",", "\[Theta]maxExp"}], "]"}], "]"}]}],
          ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"\[Theta]minExp", "<", 
            SuperscriptBox["10", 
             RowBox[{"-", "5."}]]}], ",", 
           RowBox[{"out\[Theta]logdenseAzAcc", "=", 
            RowBox[{"Join", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"Log", "[", "\[Theta]minExp", "]"}], "}"}], ",", 
              "out\[Theta]logdenseAzAcc"}], "]"}]}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"thgrid", ",", "zgridlog"}], "}"}], "=", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Exp", "[", "out\[Theta]logdenseAzAcc", "]"}], ",", 
            RowBox[{"Log", "[", "zgrid", "]"}]}], "}"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"Table", " ", 
            RowBox[{"Cos", "[", "\[Theta]", "]"}]}], ",", "z", ",", 
           RowBox[{
            SubscriptBox["\[Epsilon]", "az"], 
            RowBox[{"(", 
             RowBox[{"\[Theta]", ",", "z"}], ")"}]}]}], "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"\[Epsilon]AzTabTemp", "=", 
          RowBox[{"Flatten", "[", 
           RowBox[{
            RowBox[{"\[Epsilon]AzTotComp", "[", 
             RowBox[{"thgrid", ",", "zgrid"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", "2"}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"phmin", ",", "phmax"}], "}"}], "=", 
          RowBox[{
           RowBox[{"Select", "[", 
            RowBox[{
             RowBox[{"\[Epsilon]AzTabTemp", "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "2"}], ",", 
                  RowBox[{"-", "1"}]}], "}"}]}], "]"}], "]"}], ",", 
             RowBox[{
              RowBox[{
               RowBox[{"#", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "<=", 
               RowBox[{"#", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "&"}]}], "]"}], "//", 
           "MinMax"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"\[Epsilon]AzTab", "=", 
          RowBox[{"SortBy", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Cos", "[", 
                 RowBox[{"#", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
                RowBox[{"#", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], ",", 
                RowBox[{"#", "[", 
                 RowBox[{"[", "3", "]"}], "]"}]}], "}"}], "&"}], "/@", 
             "\[Epsilon]AzTabTemp"}], ",", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"#", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", 
               RowBox[{"#", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "}"}], "&"}]}], "]"}]}], ";",
          "\[IndentingNewLine]", 
         RowBox[{"\[Epsilon]AzLog", "=", 
          RowBox[{"Log", "[", "\[Epsilon]AzTab", "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"outcos\[Theta]logdenseAzAcc", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"thgrid", "//", "Cos"}], "//", "Log"}], "//", "Sort"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
          "Creating", " ", "NearestFunction", " ", "for", " ", "future", " ", 
           "use"}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"nfAzc\[Theta]", "=", 
          RowBox[{"Nearest", "[", 
           RowBox[{"outcos\[Theta]logdenseAzAcc", "->", "\"\<Index\>\""}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"nfAzZ", "=", 
          RowBox[{"Nearest", "[", 
           RowBox[{"zgridlog", "->", "\"\<Index\>\""}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"Table", " ", "\[Theta]"}], ",", " ", 
           RowBox[{"<", 
            SubscriptBox["\[Epsilon]", "az"], 
            SubscriptBox[">", "z"], 
            RowBox[{"(", "\[Theta]", ")"}]}]}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"\[Epsilon]AzPart", "=", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"thgrid", ",", 
             FractionBox[
              RowBox[{"Total", "[", 
               RowBox[{
                RowBox[{"Partition", "[", 
                 RowBox[{
                  RowBox[{"\[Epsilon]AzTab", "[", 
                   RowBox[{"[", 
                    RowBox[{"All", ",", "3"}], "]"}], "]"}], ",", 
                  RowBox[{"Length", "[", "zgrid", "]"}]}], "]"}], "//", 
                "Transpose"}], "]"}], 
              RowBox[{"Length", "[", "zgrid", "]"}]]}], "}"}], "//", 
           "Transpose"}]}], ";"}]}], "\[IndentingNewLine]", "]"}]}], ";", 
     "\[IndentingNewLine]", "AzimuthalAcceptanceTabulatedBlock"}]}], 
   "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Export", "[", 
    RowBox[{
     RowBox[{"FileNameJoin", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"NotebookDirectory", "[", "]"}], "//", "ParentDirectory"}], 
         "//", "ParentDirectory"}], 
        ",", "\"\<temp1/EventCalc-python-data/AzAcc.txt\>\""}], "}"}], "]"}], 
     ",", "\[Epsilon]AzLog", ",", "\"\<Table\>\""}], "]"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"test", "!=", "1"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"AzimuthalAcceptanceTabulatedBlock", "[", 
       RowBox[{
        RowBox[{"Max", "[", 
         RowBox[{
          SuperscriptBox["10", 
           RowBox[{"-", "9."}]], ",", "ThetaDecVolGivenExperimentMin"}], 
         "]"}], ",", "ThetaDecVolGivenExperimentMax", ",", "zDecVolMin", ",", 
        "zMaxDecayVolumeGivenExperiment"}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"phmin", ",", "phmax"}], "}"}]}]}], "]"}], "*)"}]}]}], "Input",
 CellChangeTimes->{
  3.929093115532864*^9, {3.9290944574995375`*^9, 3.929094542833584*^9}, {
   3.929094740254323*^9, 3.929094742532084*^9}, {3.93124700933644*^9, 
   3.931247009800284*^9}, {3.9424742099500904`*^9, 3.942474210570162*^9}, {
   3.9424779451344624`*^9, 3.942477961082878*^9}, {3.942477997915142*^9, 
   3.942478000778055*^9}, {3.952097431873806*^9, 3.952097450798683*^9}},
 CellLabel->"In[17]:=",ExpressionUUID->"dd74840a-cc5d-430b-8644-15a0a6c5eacf"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Generating \[Phi] values for which the trajectory intersects the decay volume\
\>", "Subsection",
 CellChangeTimes->{{3.9290948132423935`*^9, 
  3.929094827338704*^9}},ExpressionUUID->"8dbe79e2-27e6-4239-89b7-\
dffe4efdafb3"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"If", "[", 
  RowBox[{"EventCalc", ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"test", "=", "0"}], ";", "\[IndentingNewLine]", 
    RowBox[{"Momenta", "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Hold", "@", 
         RowBox[{"Compile", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"\[Theta]Elist", ",", "_Real", ",", "1"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"\[Phi]min", ",", "_Real"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"\[Phi]max", ",", "_Real"}], "}"}]}], "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Module", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"if", "=", "0."}], ",", 
               RowBox[{"\[Phi]v", "=", "0."}], ",", "pval", ",", 
               RowBox[{"xval", "=", "0."}], ",", 
               RowBox[{"yval", "=", "0."}], ",", 
               RowBox[{"zval", "=", "zDecVolMin"}], ",", "lenz", ",", 
               "\[Theta]list", ",", 
               RowBox[{"iv", "=", "0"}], ",", "Elist", ",", "\[Theta]minEff", 
               ",", "mass"}], "}"}], ",", "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{
               RowBox[{
               "Sample", " ", "the", " ", "value", " ", "of", " ", "\[Phi]", " ",
                 "for", " ", "which", " ", "for", " ", "a", " ", "random", " ",
                 "value", " ", "of", " ", "z"}], " ", "\[Element]", " ", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  SubscriptBox["z", "min"], ",", 
                  SubscriptBox["z", "max"]}], ")"}], " ", "the", " ", 
                "coordinate", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"x", 
                   RowBox[{"(", 
                    RowBox[{"\[Theta]", ",", "\[Phi]", ",", "z"}], ")"}]}], ",", 
                  RowBox[{"y", 
                   RowBox[{"(", 
                    RowBox[{"\[Theta]", ",", "\[Phi]", ",", "z"}], ")"}]}]}], 
                 ")"}], " ", "will", " ", "be", " ", "inside", " ", "the", " ",
                 "decay", " ", "volume"}]}], "*)"}], "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{
               RowBox[{"If", " ", "it", " ", "is", " ", "inside"}], ",", " ", 
               RowBox[{
               "then", " ", "the", " ", "value", " ", "of", " ", "\[Phi]", " ",
                 "is", " ", "used", " ", "to", " ", "sample", " ", "the", " ",
                 "random", " ", "direction"}]}], "*)"}], 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"\[Theta]list", "=", 
               RowBox[{"Compile`GetElement", "[", 
                RowBox[{"\[Theta]Elist", ",", "1"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"Elist", "=", 
               RowBox[{"Compile`GetElement", "[", 
                RowBox[{"\[Theta]Elist", ",", "2"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"mass", "=", 
               RowBox[{"Compile`GetElement", "[", 
                RowBox[{"\[Theta]Elist", ",", "3"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"(*", 
               RowBox[{
               "___", "___", "___", "___", "___", "___", "___", "___", "___", 
                "___", "___", "___", "___", "___"}], "*)"}], 
              "\[IndentingNewLine]", 
              RowBox[{"(*", 
               RowBox[{
                RowBox[{"Calculating", " ", "the", " ", "3"}], "-", 
                RowBox[{
                "momentum", " ", "for", " ", "which", " ", "the", " ", 
                 "trajectory", " ", "intersects", " ", "the", " ", "decay", " ",
                  "volume"}]}], "*)"}], "\[IndentingNewLine]", 
              RowBox[{"(*", 
               RowBox[{
               "___", "___", "___", "___", "___", "___", "___", "___", "___", 
                "___", "___", "___", "___", "___"}], "*)"}], 
              "\[IndentingNewLine]", 
              RowBox[{"(*", 
               RowBox[{
                RowBox[{
                "Sampling", " ", "seed", " ", "random", " ", "values", " ", 
                 "of", " ", "z"}], ",", 
                RowBox[{
                "\[Phi]", " ", "until", " ", "the", " ", "random", " ", "LLP",
                  " ", "decay", " ", "point", " ", "given", " ", "by", " ", 
                 "\[Theta]"}], ",", "z", ",", 
                RowBox[{
                "\[Phi]", " ", "is", " ", "inside", " ", "the", " ", "decay", 
                 " ", "volume"}]}], "*)"}], "\[IndentingNewLine]", 
              RowBox[{"While", "[", 
               RowBox[{
                RowBox[{"if", "==", "0."}], 
                RowBox[{"(*", 
                 RowBox[{"||", 
                  RowBox[{"iv", "<", "1000"}]}], "*)"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"(*", 
                 RowBox[{
                  RowBox[{"iv", "+=", "1"}], ";"}], "*)"}], 
                "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"\[Phi]v", "=", 
                  RowBox[{"RandomReal", "[", 
                   RowBox[{"{", 
                    RowBox[{"\[Phi]min", ",", "\[Phi]max"}], "}"}], "]"}]}], ";",
                  "\[IndentingNewLine]", 
                 RowBox[{"zval", "=", 
                  RowBox[{"RandomReal", "[", 
                   RowBox[{"{", 
                    RowBox[{"zDecVolMin", ",", "zDecVolMax"}], "}"}], "]"}]}],
                  ";", "\[IndentingNewLine]", 
                 RowBox[{"xval", "=", 
                  RowBox[{"zval", "*", 
                   RowBox[{"Tan", "[", "\[Theta]list", "]"}], 
                   RowBox[{"Cos", "[", "\[Phi]v", "]"}]}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"yval", "=", 
                  RowBox[{"zval", "*", 
                   RowBox[{"Tan", "[", "\[Theta]list", "]"}], 
                   RowBox[{"Sin", "[", "\[Phi]v", "]"}]}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"if", "=", 
                  RowBox[{"IfLLPinsideDecVol", "[", 
                   RowBox[{"zval", ",", "xval", ",", "yval"}], "]"}]}], 
                 ";"}]}], "\[IndentingNewLine]", 
               RowBox[{"(*", 
                RowBox[{
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                   "\[Theta]minmargin", "<=", "\[Theta]list", "<=", 
                    "\[Theta]maxmargin"}], ",", 
                   RowBox[{"if", "=", 
                    RowBox[{"IfInsideDecayVolume", "[", 
                    RowBox[{"xval", ",", "yval", ",", "zval"}], "]"}]}]}], 
                  "]"}], ";", "\[IndentingNewLine]", 
                 RowBox[{"(*", 
                  RowBox[{
                   RowBox[{
                   "Some", " ", "points", " ", "may", " ", "be", " ", "at", " ",
                     "the", " ", "boundaries", " ", "of", " ", "z"}], ",", 
                   " ", 
                   RowBox[{
                   "so", " ", "the", " ", "following", " ", "two", " ", 
                    "conditions", " ", "are", " ", "needed", " ", "in", " ", 
                    "order", " ", "to", " ", "avoid", " ", "infinite", " ", 
                    "loop", " ", "stuck"}]}], "*)"}], "\[IndentingNewLine]", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"\[Theta]list", "<", "\[Theta]minmargin"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"if", "=", 
                    RowBox[{"IfInsideDecayVolume", "[", 
                    RowBox[{
                    RowBox[{
                    FractionBox["zmax", "zval"], "xval"}], ",", 
                    RowBox[{
                    FractionBox["zmax", "zval"], "yval"}], ",", "zmax"}], 
                    "]"}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{"zval", "=", "zmax"}]}]}], "]"}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"\[Theta]list", ">", "\[Theta]maxmargin"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"if", "=", 
                    RowBox[{"IfInsideDecayVolume", "[", 
                    RowBox[{
                    RowBox[{
                    FractionBox["zmin", "zval"], "xval"}], ",", 
                    RowBox[{
                    FractionBox["zmin", "zval"], "yval"}], ",", "zmin"}], 
                    "]"}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{"zval", "=", "zmin"}]}]}], "]"}], ";"}], "*)"}], 
               "\[IndentingNewLine]", 
               RowBox[{"(*", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"iv", ">=", "100000"}], ",", 
                  RowBox[{"Break", "[", "]"}]}], "]"}], "*)"}], 
               "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"pval", "=", 
               SqrtBox[
                RowBox[{
                 SuperscriptBox["Elist", "2"], "-", 
                 SuperscriptBox["mass", "2"]}]]}], ";", "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"pval", "*", 
                 RowBox[{"Sin", "[", "\[Theta]list", "]"}], 
                 RowBox[{"Cos", "[", "\[Phi]v", "]"}]}], ",", 
                RowBox[{"pval", "*", 
                 RowBox[{"Sin", "[", "\[Theta]list", "]"}], 
                 RowBox[{"Sin", "[", "\[Phi]v", "]"}]}], ",", 
                RowBox[{"pval", "*", 
                 RowBox[{"Cos", "[", "\[Theta]list", "]"}]}], ",", "Elist", ",",
                 "mass", ",", 
                RowBox[{"Cos", "[", "\[Theta]list", "]"}], ",", 
                FractionBox["pval", "mass"], ",", "zval"}], "}"}]}]}], "]"}], 
           ",", 
           RowBox[{"CompilationTarget", "\[Rule]", "\"\<C\>\""}], ",", 
           RowBox[{"RuntimeOptions", "\[Rule]", "\"\<Speed\>\""}], ",", 
           RowBox[{"RuntimeAttributes", "->", 
            RowBox[{"{", "Listable", "}"}]}], ",", 
           RowBox[{"Parallelization", "->", "True"}]}], "]"}]}], "/.", 
        RowBox[{"ruleDown", "[", 
         RowBox[{"{", "IfLLPinsideDecVol", "}"}], "]"}]}], "/.", 
       RowBox[{"ruleOwn", "[", 
        RowBox[{"{", 
         RowBox[{"zDecVolMin", ",", "zDecVolMax"}], "}"}], "]"}]}], "//", 
      "ReleaseHold"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"<<", "CompiledFunctionTools`"}], ";", "\n", 
    RowBox[{"CompilePrint", "@", "Momenta"}], ";", "\[IndentingNewLine]", 
    RowBox[{"test", "=", "1"}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"test", "!=", "1"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"mtest", "=", "0.3"}], ";", "\[IndentingNewLine]", 
        RowBox[{"pts", "=", 
         RowBox[{"KinematicsFromTabulatedDistribution", "[", 
          RowBox[{"mtest", ",", "1", ",", "0", ",", 
           SuperscriptBox["10", "5"], ",", "1000"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"momenta", "=", 
         RowBox[{"Momenta", "[", 
          RowBox[{"pts", ",", 
           RowBox[{"-", "Pi"}], ",", "Pi"}], "]"}]}], ";"}]}], "]"}], "//", 
     "AbsoluteTiming"}]}]}], "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"ListPointPlot3D", "[", 
    RowBox[{"Evaluate", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"10", 
        RowBox[{"{", 
         RowBox[{
          FractionBox[
           RowBox[{"#", "[", 
            RowBox[{"[", "1", "]"}], "]"}], 
           SqrtBox[
            RowBox[{
             SuperscriptBox[
              RowBox[{"#", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"#", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"#", "[", 
               RowBox[{"[", "3", "]"}], "]"}], "2"]}]]], ",", 
          FractionBox[
           RowBox[{"#", "[", 
            RowBox[{"[", "2", "]"}], "]"}], 
           SqrtBox[
            RowBox[{
             SuperscriptBox[
              RowBox[{"#", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"#", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"#", "[", 
               RowBox[{"[", "3", "]"}], "]"}], "2"]}]]], ",", 
          FractionBox[
           RowBox[{"#", "[", 
            RowBox[{"[", "3", "]"}], "]"}], 
           SqrtBox[
            RowBox[{
             SuperscriptBox[
              RowBox[{"#", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"#", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"#", "[", 
               RowBox[{"[", "3", "]"}], "]"}], "2"]}]]]}], "}"}]}], "&"}], "/@", 
      RowBox[{"momenta", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], "]"}], "]"}]}], "]"}], 
    "]"}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.917599819853071*^9, 3.9175998200021567`*^9}, {
   3.9175998965126166`*^9, 3.9175999617367673`*^9}, {3.91759999883914*^9, 
   3.9176000416282563`*^9}, {3.9176000721480265`*^9, 3.917600080609462*^9}, {
   3.9176001378183823`*^9, 3.9176002209615183`*^9}, {3.91760046441298*^9, 
   3.9176006249663267`*^9}, {3.917600682516822*^9, 3.917600750439377*^9}, 
   3.9176008322844343`*^9, {3.917600964231558*^9, 3.9176009783434024`*^9}, {
   3.917625443308217*^9, 3.9176254599958425`*^9}, {3.9185777445602913`*^9, 
   3.9185777453058815`*^9}, 3.9186635360051327`*^9, {3.9290949380358*^9, 
   3.9290949413102036`*^9}, {3.929095251212618*^9, 3.9290952606509523`*^9}, {
   3.9290954377109127`*^9, 3.929095438795328*^9}, {3.9292902853809905`*^9, 
   3.9292903033165884`*^9}, {3.929290384759662*^9, 3.9292903901354094`*^9}, {
   3.9292904225106134`*^9, 3.9292905288446913`*^9}, {3.9292918643693085`*^9, 
   3.9292919065389814`*^9}, {3.929291977342455*^9, 3.9292919875565166`*^9}, {
   3.9292923760882883`*^9, 3.929292400454167*^9}, {3.931238027632615*^9, 
   3.9312380558327417`*^9}, {3.9312470230928636`*^9, 
   3.9312470527861824`*^9}, {3.931247387228672*^9, 3.931247391157764*^9}, {
   3.938194166511366*^9, 3.938194171383604*^9}, {3.9424639527557373`*^9, 
   3.9424639592444057`*^9}, {3.9424780266158943`*^9, 3.942478060179455*^9}, {
   3.9424786124947624`*^9, 3.942478657267906*^9}, {3.9520974564297123`*^9, 
   3.9520974655385723`*^9}},
 CellLabel->"In[18]:=",ExpressionUUID->"0544d6fe-53ff-4804-965c-2adf8c5e4696"],

Cell[BoxData[
 FormBox[
  RowBox[{"{", 
   RowBox[{"7.`*^-7", ",", "Null"}], "}"}], TraditionalForm]], "Output",
 CellChangeTimes->{
  3.917599997542648*^9, {3.9176000326231265`*^9, 3.9176000467366595`*^9}, 
   3.917600201785982*^9, 3.9176003608092203`*^9, 3.917600434392395*^9, {
   3.917600466482837*^9, 3.9176004752714167`*^9}, {3.9176005104514265`*^9, 
   3.9176005373572927`*^9}, {3.917600607668537*^9, 3.9176006282015743`*^9}, 
   3.917600728470772*^9, {3.9176008003422766`*^9, 3.917600838155593*^9}, {
   3.9176009829569607`*^9, 3.917600998064173*^9}, 3.9176229369194555`*^9, 
   3.917625351125293*^9, {3.9176254525998707`*^9, 3.917625462425289*^9}, 
   3.9176258519505467`*^9, 3.9176260558265305`*^9, 3.9176263079707637`*^9, 
   3.91762706957275*^9, 3.9176276947323265`*^9, 3.9176279843905153`*^9, 
   3.917628293607808*^9, 3.917669111744303*^9, 3.917672345326439*^9, 
   3.917679868535195*^9, 3.917680417331574*^9, 3.9176819595266867`*^9, 
   3.917715723110344*^9, 3.917716156379009*^9, 3.9177210560135727`*^9, 
   3.917771457692151*^9, 3.9177730534387655`*^9, 3.917773556329465*^9, 
   3.9177787797492065`*^9, 3.9177864350299387`*^9, 3.917796850749529*^9, 
   3.9177977379283934`*^9, 3.9178025113725033`*^9, 3.9178593942914567`*^9, 
   3.9178608293002324`*^9, 3.9178848989947057`*^9, {3.9178877819700265`*^9, 
   3.9178877890769453`*^9}, 3.9179535343158855`*^9, 3.9181217379623885`*^9, 
   3.9181920226458926`*^9, 3.918194351923752*^9, 3.9181973272440567`*^9, 
   3.9182023356324677`*^9, 3.918204568159458*^9, 3.9182070311808205`*^9, 
   3.9182287508527365`*^9, 3.918320680559003*^9, 3.9183719328360033`*^9, 
   3.918372844529046*^9, 3.9183767736252155`*^9, 3.9183977112938085`*^9, 
   3.9184103065870266`*^9, 3.918460262545706*^9, 3.918460881395835*^9, 
   3.918461920516239*^9, {3.918464149288637*^9, 3.918464162639962*^9}, 
   3.9184650096567144`*^9, 3.9185585427724032`*^9, 3.918573778674875*^9, 
   3.9185754423399935`*^9, 3.9185757836538973`*^9, 3.918576037862831*^9, 
   3.918576340299698*^9, 3.9185773171487923`*^9, 3.918577747355506*^9, 
   3.918579357859009*^9, 3.9186185758276415`*^9, 3.9186188976564846`*^9, 
   3.918620731846485*^9, 3.9186439364031754`*^9, 3.918645176557787*^9, 
   3.918662124658698*^9, 3.918664768484456*^9, 3.9186977755962973`*^9, 
   3.9189258628592763`*^9, 3.918926369874075*^9, 3.9189271835150185`*^9, 
   3.9189765651117086`*^9, 3.91897671982323*^9, 3.9189774068281364`*^9, 
   3.918999981904952*^9, 3.9190007246941805`*^9, 3.919010775715404*^9, 
   3.9190121199965825`*^9, 3.919013463094968*^9, 3.919013981598418*^9, 
   3.9190143112701845`*^9, 3.9190151947106085`*^9, 3.9190154094759636`*^9, 
   3.919015790432599*^9, 3.9190160890392017`*^9, 3.9190163021696334`*^9, 
   3.919016718623607*^9, 3.9190447286532917`*^9, 3.9190627310154686`*^9, 
   3.919064273671962*^9, 3.919066542617131*^9, 3.919066927896632*^9, 
   3.9190672290353236`*^9, 3.9190696274271173`*^9, 3.91908160153813*^9, 
   3.9194429076803617`*^9, 3.9200502556937914`*^9, 3.920092957137099*^9, 
   3.920095759493458*^9, 3.9200964162556987`*^9, 3.920129648475445*^9, 
   3.920181033118732*^9, 3.9201928327963467`*^9, 3.921812728751322*^9, 
   3.921831949715456*^9, 3.9290952644287963`*^9, {3.9292902876268334`*^9, 
   3.929290299494136*^9}, 3.9292919082404327`*^9, {3.9292919614232435`*^9, 
   3.929291989144368*^9}, {3.929292377979148*^9, 3.929292402919811*^9}, 
   3.9292927714014435`*^9, {3.931238021278776*^9, 3.9312380576819825`*^9}, {
   3.9312470207488303`*^9, 3.9312470293195972`*^9}, 3.9312472299641457`*^9, {
   3.9312473894764757`*^9, 3.93124739294841*^9}, 3.9312486498333597`*^9, {
   3.938194162385519*^9, 3.9381941691454067`*^9}, {3.942478017785961*^9, 
   3.942478032129133*^9}, 3.9527543890356865`*^9},
 CellLabel->
  "Out[1469]=",ExpressionUUID->"9fddfa87-45c3-2e44-a760-7ff4537db543"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1430.25, 827.625},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
Magnification:>1. Inherited,
FrontEndVersion->"14.2 for Microsoft Windows (64-bit) (December 26, 2024)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"3cedb5a2-b510-4541-a245-19b344518115"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 169, 3, 67, "Chapter",ExpressionUUID->"e873c8b5-bd61-46ab-b870-6ebc9d2a7669"],
Cell[CellGroupData[{
Cell[774, 29, 215, 4, 66, "Section",ExpressionUUID->"05640d86-f38f-4317-abec-93c404589b73"],
Cell[CellGroupData[{
Cell[1014, 37, 3558, 83, 180, "Input",ExpressionUUID->"ce971c1e-7a71-42f9-ad73-72ce21db4cf3"],
Cell[4575, 122, 18714, 337, 59, "Output",ExpressionUUID->"58d35ab3-4625-ef4f-b633-b93e127b1bdb"]
}, Open  ]],
Cell[CellGroupData[{
Cell[23326, 464, 412, 12, 53, "Subsection",ExpressionUUID->"5a35d9ea-52ee-4cce-b36d-756f7cd679c0"],
Cell[23741, 478, 12473, 305, 751, "Input",ExpressionUUID->"c8cc76ca-de20-4d09-a70a-7ad62b2337cb"]
}, Open  ]],
Cell[CellGroupData[{
Cell[36251, 788, 604, 18, 53, "Subsection",ExpressionUUID->"4bb37a33-2bd4-4af7-af84-153d4567d57d"],
Cell[36858, 808, 6689, 158, 427, "Input",ExpressionUUID->"ef58a9c0-022c-4e52-8329-0a464d305154"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[43596, 972, 174, 3, 66, "Section",ExpressionUUID->"97ad1f33-b2d4-4170-9df3-1b11f41a4c5a"],
Cell[CellGroupData[{
Cell[43795, 979, 247, 4, 53, "Subsection",ExpressionUUID->"9492b1a6-e5ab-4e0f-9ba5-db722b2f666e"],
Cell[44045, 985, 7904, 188, 448, "Input",ExpressionUUID->"f8c945bc-50b0-47ec-b136-147a6a4d770f"],
Cell[CellGroupData[{
Cell[51974, 1177, 163, 3, 43, "Subsubsection",ExpressionUUID->"bc844418-836c-48e9-8c9b-0a8c382bd431"],
Cell[52140, 1182, 1749, 44, 123, "Input",ExpressionUUID->"f7e6d025-f4d2-4637-b744-e2d657449798"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[53938, 1232, 273, 6, 53, "Subsection",ExpressionUUID->"3236f0e3-2464-40b9-8a83-5ba872b1c439"],
Cell[CellGroupData[{
Cell[54236, 1242, 223, 4, 43, "Subsubsection",ExpressionUUID->"d3a4bc06-bc2b-4772-810b-775d73143c57"],
Cell[54462, 1248, 1610, 35, 85, "Input",ExpressionUUID->"4118790b-5b4d-4a98-9a16-4c5bc22bd5da"],
Cell[CellGroupData[{
Cell[56097, 1287, 159, 3, 30, "Item",ExpressionUUID->"b7c89c1d-a374-419b-b3d4-2a23b185ca13"],
Cell[56259, 1292, 6437, 160, 375, "Input",ExpressionUUID->"152e8f7d-eaba-4616-b6db-94327db4bfac"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[62745, 1458, 264, 5, 43, "Subsubsection",ExpressionUUID->"393fa699-1dda-41b8-ba8a-110ccd570c71"],
Cell[63012, 1465, 6210, 148, 594, "Input",ExpressionUUID->"7879b092-2b86-4c0e-9d45-70a489d334d4"],
Cell[CellGroupData[{
Cell[69247, 1617, 157, 3, 30, "Item",ExpressionUUID->"ee58689f-2d3d-4a4d-b848-37e09d95b7f1"],
Cell[69407, 1622, 12123, 281, 733, "Input",ExpressionUUID->"a36124ff-0faf-4dbd-8da8-d41528124021"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[81603, 1911, 405, 11, 66, "Section",ExpressionUUID->"138d4793-2038-49e6-8a9d-4682ff4c83f8"],
Cell[CellGroupData[{
Cell[82033, 1926, 173, 3, 53, "Subsection",ExpressionUUID->"7361e2cd-87dd-4647-8b43-141b38be3912"],
Cell[82209, 1931, 11704, 295, 788, "Input",ExpressionUUID->"41b88e20-10d4-4aae-b9eb-b2c2a5e063c6"]
}, Open  ]],
Cell[CellGroupData[{
Cell[93950, 2231, 179, 3, 53, "Subsection",ExpressionUUID->"777c898c-0ac0-4580-afb7-c07c8e0f97f7"],
Cell[94132, 2236, 10895, 262, 706, "Input",ExpressionUUID->"2b3ec2aa-f6d2-4061-8613-078ff227557b"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[105076, 2504, 169, 3, 66, "Section",ExpressionUUID->"9cb9e4c6-5f4c-4ff8-b72d-ef8371124ad6"],
Cell[CellGroupData[{
Cell[105270, 2511, 343, 9, 53, "Subsection",ExpressionUUID->"3bbacf9a-5eca-4201-845a-95a319037752"],
Cell[105616, 2522, 14489, 340, 1061, "Input",ExpressionUUID->"dd74840a-cc5d-430b-8644-15a0a6c5eacf"]
}, Open  ]],
Cell[CellGroupData[{
Cell[120142, 2867, 235, 5, 53, "Subsection",ExpressionUUID->"8dbe79e2-27e6-4239-89b7-dffe4efdafb3"],
Cell[CellGroupData[{
Cell[120402, 2876, 15077, 325, 919, "Input",ExpressionUUID->"0544d6fe-53ff-4804-965c-2adf8c5e4696"],
Cell[135482, 3203, 3813, 55, 47, "Output",ExpressionUUID->"9fddfa87-45c3-2e44-a760-7ff4537db543"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

