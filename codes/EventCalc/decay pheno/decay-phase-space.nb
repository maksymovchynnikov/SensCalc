(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    167953,       3744]
NotebookOptionsPosition[    163010,       3641]
NotebookOutlinePosition[    164776,       3681]
CellTagsIndexPosition[    164701,       3676]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Generating phase space of LLP\[CloseCurlyQuote]s decays", "Chapter",
 CellChangeTimes->{{3.93115780483645*^9, 
  3.9311578228434286`*^9}},ExpressionUUID->"4d0219cc-26fe-4879-87be-\
7d18e85e2efe"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Boosted", " ", "Decay", " ", "Products"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"TabBoostedDecayProducts", "[", 
    RowBox[{"tablemother_", ",", "tabledaughters_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "numberdaughters", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"numberdaughters", "=", 
       RowBox[{
        RowBox[{"Length", "[", 
         RowBox[{"tabledaughters", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "]"}], "/", "LengthDataProduct"}]}],
       ";", "\[IndentingNewLine]", 
      RowBox[{"TableBoosted", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"TabBoostedDecayProductComp", "[", 
          RowBox[{"tablemother", ",", 
           RowBox[{"tabledaughters", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", 
              RowBox[{"Range", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"LengthDataProduct", "*", 
                  RowBox[{"(", 
                   RowBox[{"i", "-", "1"}], ")"}]}], "+", "1"}], ",", 
                RowBox[{"LengthDataProduct", "*", "i"}]}], "]"}]}], "]"}], 
            "]"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "numberdaughters", ",", "1"}], "}"}]}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Join", "[", 
         RowBox[{"##", ",", "2"}], "]"}], "&"}], "@@", "TableBoosted"}]}]}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.9312291526588387`*^9, 3.931229162412141*^9}, {
  3.931231616201765*^9, 3.931231647927081*^9}},
 CellLabel->
  "In[1348]:=",ExpressionUUID->"db7854da-eb4c-4abf-a8a5-7a1f767f2577"],

Cell[CellGroupData[{

Cell["Phase space of n-body decays", "Section",
 CellChangeTimes->{{3.9310678889946356`*^9, 
  3.9310678987973166`*^9}},ExpressionUUID->"46c199dd-cfd5-4cc6-a333-\
3b3429e6aa5f"],

Cell[CellGroupData[{

Cell["2-body", "Subsection",
 CellChangeTimes->{{3.9310681807160206`*^9, 
  3.9310681817859626`*^9}},ExpressionUUID->"59050a86-6e07-4aa5-8ae0-\
28145dcd83ab"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Vector", " ", "Particle", " ", "Simulation"}], "*)"}], 
  RowBox[{
   RowBox[{
    RowBox[{"nVectorParticles", "=", 
     RowBox[{"Compile", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"\[Theta]vals", ",", "_Real"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"\[Phi]vals", ",", "_Real"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"E1", ",", "_Real"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"E2", ",", "_Real"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"m1", ",", "_Real"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"m2", ",", "_Real"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"pdg1", ",", "_Real"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"pdg2", ",", "_Real"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"charge1", ",", "_Real"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"charge2", ",", "_Real"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"stability1", ",", "_Real"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"stability2", ",", "_Real"}], "}"}]}], "}"}], ",", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "pmod", ",", "px1", ",", "px2", ",", "py1", ",", "py2", ",", "pz1", 
           ",", "pz2"}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"pmod", "=", 
           RowBox[{"Sqrt", "[", 
            RowBox[{
             RowBox[{"E1", "^", "2"}], "-", 
             RowBox[{"m1", "^", "2"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"px1", "=", 
           RowBox[{"pmod", "*", 
            RowBox[{"Sin", "[", "\[Theta]vals", "]"}], "*", 
            RowBox[{"Cos", "[", "\[Phi]vals", "]"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"px2", "=", 
           RowBox[{"-", "px1"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"py1", "=", 
           RowBox[{"pmod", "*", 
            RowBox[{"Sin", "[", "\[Theta]vals", "]"}], "*", 
            RowBox[{"Sin", "[", "\[Phi]vals", "]"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"py2", "=", 
           RowBox[{"-", "py1"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"pz1", "=", 
           RowBox[{"pmod", "*", 
            RowBox[{"Cos", "[", "\[Theta]vals", "]"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"pz2", "=", 
           RowBox[{"-", "pz1"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{
           "px1", ",", "py1", ",", "pz1", ",", "E1", ",", "m1", ",", "pdg1", ",",
             "charge1", ",", "stability1", ",", "px2", ",", "py2", ",", "pz2",
             ",", "E2", ",", "m2", ",", "pdg2", ",", "charge2", ",", 
            "stability2"}], "}"}]}]}], "]"}], ",", 
       RowBox[{"CompilationTarget", "->", "\"\<C\>\""}], ",", 
       RowBox[{"RuntimeOptions", "->", "\"\<Speed\>\""}], ",", 
       RowBox[{"RuntimeAttributes", "->", 
        RowBox[{"{", "Listable", "}"}]}], ",", 
       RowBox[{"Parallelization", "->", "True"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Block2BodyDistrAtRest", "[", 
     RowBox[{"m_", ",", "product1_", ",", "product2_", ",", "Nevents_"}], 
     "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "\[Theta]tab", ",", "\[Phi]tab", ",", "E1v", ",", "E2v", ",", "mass1", 
        ",", "mass2", ",", "pdg1", ",", "pdg2", ",", "charge1", ",", 
        "charge2", ",", "stability1", ",", "stability2"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"pdg1", ",", "pdg2"}], "}"}], "=", 
        RowBox[{
         RowBox[{
          RowBox[{"ParamProductToPDGid", "[", "#", "]"}], "&"}], "/@", 
         RowBox[{"{", 
          RowBox[{"product1", ",", "product2"}], "}"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"mass1", ",", "mass2"}], "}"}], "=", 
        RowBox[{
         RowBox[{
          RowBox[{"ParamProductMass", "[", "#", "]"}], "&"}], "/@", 
         RowBox[{"{", 
          RowBox[{"pdg1", ",", "pdg2"}], "}"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"charge1", ",", "charge2"}], "}"}], "=", 
        RowBox[{
         RowBox[{
          RowBox[{"ParamProductCharge", "[", "#", "]"}], "&"}], "/@", 
         RowBox[{"{", 
          RowBox[{"pdg1", ",", "pdg2"}], "}"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"stability1", ",", "stability2"}], "}"}], "=", 
        RowBox[{
         RowBox[{
          RowBox[{"ParamProductStability", "[", "#", "]"}], "&"}], "/@", 
         RowBox[{"{", 
          RowBox[{"pdg1", ",", "pdg2"}], "}"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
         "Random", " ", "values", " ", "of", " ", "\[Theta]", " ", "and", " ", 
          RowBox[{"\[Phi]", ".", " ", "For"}], " ", "\[Theta]"}], ",", " ", 
         RowBox[{
         "the", " ", "distribution", " ", "in", " ", "cos\[Theta]", " ", "is",
           " ", "uniform"}], ",", " ", 
         RowBox[{
          RowBox[{
          "hence", " ", "one", " ", "first", " ", "generates", " ", "random", 
           " ", "values", " ", "from"}], " ", "-", 
          RowBox[{
          "1", " ", "to", " ", "1", " ", "and", " ", "then", " ", "computes", 
           " ", "ArcCos"}]}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"\[Theta]tab", "=", 
        RowBox[{"ArcCos", "[", 
         RowBox[{"RandomReal", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", "Nevents"}], "]"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"\[Phi]tab", "=", 
        RowBox[{"RandomReal", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "Pi"}], ",", "Pi"}], "}"}], ",", "Nevents"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"E1v", ",", "E2v"}], "}"}], "=", 
        RowBox[{"{", 
         RowBox[{
          FractionBox[
           RowBox[{
            SuperscriptBox["m", "2"], "+", 
            SuperscriptBox["mass1", "2"], "-", 
            SuperscriptBox["mass2", "2"]}], 
           RowBox[{"2", "*", "m"}]], ",", 
          FractionBox[
           RowBox[{
            SuperscriptBox["m", "2"], "+", 
            SuperscriptBox["mass2", "2"], "-", 
            SuperscriptBox["mass1", "2"]}], 
           RowBox[{"2", "*", "m"}]]}], "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"nVectorParticles", "[", 
        RowBox[{
        "\[Theta]tab", ",", "\[Phi]tab", ",", "E1v", ",", "E2v", ",", "mass1",
          ",", "mass2", ",", "pdg1", ",", "pdg2", ",", "charge1", ",", 
         "charge2", ",", "stability1", ",", "stability2"}], "]"}]}]}], 
     "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.9310688384234505`*^9, 3.93106899945373*^9}, 
   3.931157491821099*^9, 3.931157545410576*^9},
 CellLabel->
  "In[1349]:=",ExpressionUUID->"ef053d28-2f11-4173-b54e-249e36a1a226"]
}, Open  ]],

Cell[CellGroupData[{

Cell["3-body", "Subsection",
 CellChangeTimes->{{3.9310681807160206`*^9, 
  3.9310681855445795`*^9}},ExpressionUUID->"8e0532c7-22a1-44cb-bd32-\
86a09372a460"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"BlockRandomEnergiesOld", "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"m", ",", "m1", ",", "m2", ",", "m3"}], "}"}], ",", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"E1r", "=", "0."}], ",", 
         RowBox[{"E2v", "=", "0."}], ",", 
         RowBox[{"E3r", "=", "0."}]}], "}"}], ",", 
       RowBox[{
        RowBox[{"While", "[", 
         RowBox[{
          RowBox[{"E3r", "=", 
           RowBox[{"RandomReal", "[", 
            RowBox[{"{", 
             RowBox[{"m3", ",", 
              FractionBox[
               RowBox[{
                SuperscriptBox["m", "2"], "+", 
                SuperscriptBox["m3", "2"], "-", 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{"m1", "+", "m2"}], ")"}], "2"]}], 
               RowBox[{"2", "*", "m"}]]}], "}"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"E1r", "=", 
           RowBox[{"RandomReal", "[", 
            RowBox[{"{", 
             RowBox[{"m1", ",", 
              FractionBox[
               RowBox[{
                SuperscriptBox["m", "2"], "+", 
                SuperscriptBox["m1", "2"], "-", 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{"m2", "+", "m3"}], ")"}], "2"]}], 
               RowBox[{"2", "*", "m"}]]}], "}"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"E2v", "=", 
           RowBox[{"m", "-", "E1r", "-", "E3r"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"E2v", "\[LessEqual]", "m2"}], "||", 
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["E2v", "2"], "-", 
               SuperscriptBox["m2", "2"], "-", 
               RowBox[{"(", 
                RowBox[{
                 SuperscriptBox["E1r", "2"], "-", 
                 SuperscriptBox["m1", "2"]}], ")"}], "-", 
               RowBox[{"(", 
                RowBox[{
                 SuperscriptBox["E3r", "2"], "-", 
                 SuperscriptBox["m3", "2"]}], ")"}]}], ")"}], "2"], "\[GreaterEqual]", 
            RowBox[{"4", "*", 
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["E1r", "2"], "-", 
               SuperscriptBox["m1", "2"]}], ")"}], "*", 
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["E3r", "2"], "-", 
               SuperscriptBox["m3", "2"]}], ")"}]}]}]}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"E1r", ",", "E3r"}], "}"}]}]}], "]"}], ",", 
     RowBox[{"CompilationTarget", "\[Rule]", "\"\<C\>\""}], ",", 
     RowBox[{"RuntimeOptions", "\[Rule]", "\"\<Speed\>\""}], ",", 
     RowBox[{"RuntimeAttributes", "->", 
      RowBox[{"{", "Listable", "}"}]}], ",", 
     RowBox[{"Parallelization", "->", "True"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BlockRandomEnergiesOld1", "=", 
    RowBox[{"With", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"br", "=", "BlockRandomEnergiesOld"}], "}"}], ",", 
      RowBox[{
       RowBox[{"Hold", "@", 
        RowBox[{"Compile", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"m", ",", "m1", ",", "m2", ",", "m3", ",", 
            RowBox[{"{", 
             RowBox[{"Nevents", ",", "_Integer"}], "}"}]}], "}"}], ",", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"br", "[", 
             RowBox[{"m", ",", "m1", ",", "m2", ",", "m3"}], "]"}], ",", 
            "Nevents"}], "]"}], ",", 
          RowBox[{"CompilationTarget", "->", "\"\<C\>\""}], ",", 
          RowBox[{"RuntimeOptions", "->", "\"\<Speed\>\""}], ",", 
          RowBox[{"RuntimeAttributes", "->", 
           RowBox[{"{", "Listable", "}"}]}], ",", 
          RowBox[{"Parallelization", "->", "True"}], ",", 
          RowBox[{"CompilationOptions", "->", 
           RowBox[{"{", 
            RowBox[{"\"\<InlineCompiledFunctions\>\"", "->", "True"}], 
            "}"}]}]}], "]"}]}], "//", "ReleaseHold"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"The", " ", "idea", " ", 
     RowBox[{"(", 
      RowBox[{
      "following", " ", "\"\<Particle kinematics\>\"", " ", "by", " ", 
       "Byckling", " ", "and", " ", "Kajantie"}], ")"}]}], ":"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Generate", " ", "the", " ", "random", " ", "energies", " ", 
     SubscriptBox["E", "1"]}], ",", 
    RowBox[{
     SubscriptBox["E", "3"], " ", "with", " ", "the", " ", "weight", " ", 
     "being", " ", "the", " ", "squared", " ", "matrix", " ", "element", " ", 
     "of", " ", "the", " ", "decay", " ", "process"}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Restore", " ", "full", " ", "4"}], "-", "momenta"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"NN", "=", 
    SuperscriptBox["10", "5"]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "The", " ", "routine", " ", "that", " ", "computes", " ", "the", " ", 
     "weights", " ", 
     SuperscriptBox["M", "2"], 
     RowBox[{"(", 
      RowBox[{
       SubscriptBox["E", "1"], ",", 
       SubscriptBox["E", "3"]}], ")"}], 
     SubscriptBox["\[CapitalDelta]E", "3"], 
     RowBox[{"(", 
      SubscriptBox["E", "1"], ")"}], " ", "for", " ", "the", " ", "given", " ",
      "uniformly", " ", "distributed", " ", 
     SubscriptBox["E", "1"]}], ",", 
    SubscriptBox["E", "3"]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"weightsNonUniformComp", ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Hold", "@", 
      RowBox[{"Compile", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"tabe1e3", ",", "_Real", ",", "1"}], "}"}], ",", "MASSM", ",",
           "MASS1", ",", "MASS2", ",", "MASS3"}], "}"}], ",", 
        RowBox[{"Module", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"e1", ",", "e3"}], "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"e1", "=", 
            RowBox[{"Compile`GetElement", "[", 
             RowBox[{"tabe1e3", ",", "1"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"e3", "=", 
            RowBox[{"Compile`GetElement", "[", 
             RowBox[{"tabe1e3", ",", "2"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"distr", "[", 
            RowBox[{"e1", ",", "e3"}], "]"}]}]}], 
         RowBox[{"(*", 
          RowBox[{"*", 
           RowBox[{"\[CapitalDelta]E3", "[", 
            RowBox[{
            "e1", ",", "MASSM", ",", "MASS1", ",", "MASS2", ",", "MASS3"}], 
            "]"}]}], "*)"}], "\[IndentingNewLine]", "]"}], ",", 
        RowBox[{"CompilationTarget", "\[Rule]", "\"\<MVM\>\""}], ",", 
        RowBox[{"RuntimeOptions", "\[Rule]", "\"\<Speed\>\""}], ",", 
        RowBox[{"RuntimeAttributes", "->", 
         RowBox[{"{", "Listable", "}"}]}], ",", 
        RowBox[{"Parallelization", "->", "True"}]}], "]"}]}], "/.", 
     RowBox[{"ruleDown", "[", 
      RowBox[{"{", "distr", 
       RowBox[{"(*", 
        RowBox[{",", "\[CapitalDelta]E3"}], "*)"}], "}"}], "]"}]}], "//", 
    "ReleaseHold"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"weightsUniformComp", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Hold", "@", 
      RowBox[{"Compile", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"tabe1e3", ",", "_Real", ",", "1"}], "}"}], ",", "MASSM", ",",
           "MASS1", ",", "MASS2", ",", "MASS3"}], "}"}], ",", 
        RowBox[{"Module", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"e1", ",", "e3"}], "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"e1", "=", 
            RowBox[{"Compile`GetElement", "[", 
             RowBox[{"tabe1e3", ",", "1"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"\[CapitalDelta]E3", "[", 
            RowBox[{
            "e1", ",", "MASSM", ",", "MASS1", ",", "MASS2", ",", "MASS3"}], 
            "]"}]}]}], "\[IndentingNewLine]", "]"}], ",", 
        RowBox[{"CompilationTarget", "\[Rule]", "\"\<C\>\""}], ",", 
        RowBox[{"RuntimeOptions", "\[Rule]", "\"\<Speed\>\""}], ",", 
        RowBox[{"RuntimeAttributes", "->", 
         RowBox[{"{", "Listable", "}"}]}], ",", 
        RowBox[{"Parallelization", "->", "True"}]}], "]"}]}], "/.", 
     RowBox[{"ruleDown", "[", 
      RowBox[{"{", "\[CapitalDelta]E3", "}"}], "]"}]}], "//", 
    "ReleaseHold"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"E3valsComp", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Hold", "@", 
      RowBox[{"Compile", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"E1vals", ",", "_Real"}], "}"}], ",", "MASSM", ",", 
          "MASS1", ",", "MASS2", ",", "MASS3"}], "}"}], ",", 
        RowBox[{"Module", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"e3max", ",", "e3min"}], "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"e3min", "=", 
            RowBox[{"E3domainMin", "[", 
             RowBox[{
             "E1vals", ",", "MASSM", ",", "MASS1", ",", "MASS2", ",", 
              "MASS3"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"e3max", "=", 
            RowBox[{"E3domainMax", "[", 
             RowBox[{
             "E1vals", ",", "MASSM", ",", "MASS1", ",", "MASS2", ",", 
              "MASS3"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"RandomReal", "[", 
            RowBox[{"{", 
             RowBox[{"e3min", ",", "e3max"}], "}"}], "]"}]}]}], 
         "\[IndentingNewLine]", "]"}], ",", 
        RowBox[{"CompilationTarget", "->", "\"\<C\>\""}], ",", 
        RowBox[{"RuntimeOptions", "->", "\"\<Speed\>\""}], ",", 
        RowBox[{"RuntimeAttributes", "->", 
         RowBox[{"{", "Listable", "}"}]}], ",", 
        RowBox[{"Parallelization", "->", "True"}]}], "]"}]}], "/.", 
     RowBox[{"ruleDown", "[", 
      RowBox[{"{", 
       RowBox[{"E3domainMax", ",", "E3domainMin"}], "}"}], "]"}]}], "//", 
    "ReleaseHold"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BlockRandomEnergies", "[", 
    RowBox[{
    "m_", ",", "m1_", ",", "m2_", ",", "m3_", ",", "Nevents_", ",", 
     "distr_"}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"E1maxval", "=", 
        RowBox[{"E1domainMax", "[", 
         RowBox[{"m", ",", "m1", ",", "m2", ",", "m3"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"E1vals", "=", 
        RowBox[{"RandomReal", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"m1", ",", "E1maxval"}], "}"}], ",", 
          RowBox[{"Max", "[", 
           RowBox[{"NN", ",", "Nevents"}], "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"E3vals", "=", 
        RowBox[{"E3valsComp", "[", 
         RowBox[{"E1vals", ",", "m", ",", "m1", ",", "m2", ",", "m3"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"tabE1E3unweighted", "=", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"E1vals", ",", "E3vals"}], "}"}], "//", "Transpose"}]}], 
       ";"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "Weights", " ", "for", " ", "the", " ", "generated", " ", "values", " ",
        "of", " ", 
       RowBox[{"{", 
        RowBox[{"E1", ",", "E3"}], "}"}], " ", "from", " ", "matrix", " ", 
       "element", " ", "squared"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"distr", "[", 
          RowBox[{
           RowBox[{"RandomReal", "[", 
            RowBox[{"{", 
             RowBox[{"m1", ",", 
              RowBox[{"E1domainMax", "[", 
               RowBox[{"m", ",", "m1", ",", "m2", ",", "m3"}], "]"}]}], "}"}],
             "]"}], ",", 
           RowBox[{"RandomReal", "[", 
            RowBox[{"{", 
             RowBox[{"m3", ",", 
              FractionBox[
               RowBox[{"(", 
                RowBox[{
                 SuperscriptBox["m", "2"], "+", 
                 SuperscriptBox["m3", "2"], "-", 
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{"m1", "+", "m2"}], ")"}], "2"]}], ")"}], 
               RowBox[{"2", "*", "m"}]]}], "}"}], "]"}]}], "]"}], "!=", "1"}],
         ",", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "Table", " ", "with", " ", "random", " ", "energies", " ", 
          "distributed", " ", "in", " ", "the", " ", "Dalitz", " ", "range", " ",
           "before", " ", "accounting", " ", "for", " ", "weights"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"tabE1E3unweighted", "=", 
          RowBox[{"BlockRandomEnergiesOld1", "[", 
           RowBox[{"m", ",", "m1", ",", "m2", ",", "m3", ",", 
            RowBox[{"Max", "[", 
             RowBox[{"Nevents", ",", "NN"}], "]"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{"Weights", " ", "from", " ", "matrix", " ", "element"}], 
          "*)"}], "\[IndentingNewLine]", 
         RowBox[{"weights1", "=", "weightsNonUniformComp"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"weights", "=", 
          RowBox[{"Abs", "[", 
           RowBox[{"weights1", "[", 
            RowBox[{
            "tabE1E3unweighted", ",", "m", ",", "m1", ",", "m2", ",", "m3"}], 
            "]"}], 
           RowBox[{"(*", 
            RowBox[{"/.", 
             RowBox[{
              RowBox[{"_", "?", "Negative"}], "\[Rule]", "0"}]}], "*)"}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{"True", " ", "random", " ", 
           RowBox[{"energies", ".", " ", "Computed"}], " ", "via", " ", 
           "empirical", " ", "distribution", " ", "from", " ", "the", " ", 
           "weigthed", " ", "data"}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"tabsel", "=", 
          RowBox[{"RandomChoice", "[", 
           RowBox[{
            RowBox[{"weights", "->", "tabE1E3unweighted"}], ",", "Nevents"}], 
           "]"}]}], ";"}], "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"tabsel", "=", 
          RowBox[{"BlockRandomEnergiesOld1", "[", 
           RowBox[{"m", ",", "m1", ",", "m2", ",", "m3", ",", "Nevents"}], 
           "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
      "\[IndentingNewLine]", "tabsel"}]}], "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"(*", 
      RowBox[{"Weighted", " ", "random", " ", "points"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"weightedData", "=", 
       RowBox[{"WeightedData", "[", 
        RowBox[{"tabE1E3unweighted", ",", "weights"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"True", " ", "random", " ", 
        RowBox[{"energies", ".", " ", "Computed"}], " ", "via", " ", 
        "empirical", " ", "distribution", " ", "from", " ", "the", " ", 
        "weigthed", " ", "data"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"edist", "=", 
       RowBox[{"EmpiricalDistribution", "[", "weightedData", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"RandomVariate", "[", 
       RowBox[{"edist", ",", "Nevents"}], "]"}], ";"}], "*)"}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Phase", " ", "space", " ", "of", " ", "3"}], "-", 
      RowBox[{"body", " ", "decays", " ", "at", " ", 
       RowBox[{"rest", ".", " ", "Returns"}], " ", "blocks", " ", "with", " ",
        "the", " ", "following", " ", 
       RowBox[{"data", ":", " ", "productdata"}]}]}], " ", "=", " ", 
     SubscriptBox["p", "x"]}], ",", 
    SubscriptBox["p", "y"], ",", 
    SubscriptBox["p", "z"], ",", "E", ",", "m", ",", "pdg", ",", "charge", ",",
     "stability"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tabPS3bodyCompiled", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Hold", "@", 
      RowBox[{"Compile", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"tabPSenergies", ",", "_Real", ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"MASSM", ",", "_Real"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"MASS1", ",", "_Real"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"MASS2", ",", "_Real"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"MASS3", ",", "_Real"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"pdg1", ",", "_Real"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"pdg2", ",", "_Real"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"pdg3", ",", "_Real"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"charge1", ",", "_Real"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"charge2", ",", "_Real"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"charge3", ",", "_Real"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"stability1", ",", "_Real"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"stability2", ",", "_Real"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"stability3", ",", "_Real"}], "}"}]}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Module", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "eprod1", ",", "eprod2", ",", "eprod3", ",", "pxprod1", ",", 
            "pxprod2", ",", "pxprod3", ",", "pyprod1", ",", "pyprod2", ",", 
            "pyprod3", ",", "pzprod1", ",", "pzprod2", ",", "pzprod3", ",", 
            "\[Theta]randTab", ",", "\[Phi]randTab", ",", "\[Kappa]randTab"}],
            "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"eprod1", "=", 
            RowBox[{"Compile`GetElement", "[", 
             RowBox[{"tabPSenergies", ",", "1"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"eprod3", "=", 
            RowBox[{"Compile`GetElement", "[", 
             RowBox[{"tabPSenergies", ",", "2"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{
             "Angles", " ", "relating", " ", "generated", " ", "energies", " ",
               "to", " ", "the", " ", "4"}], "-", "momenta"}], "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"\[Theta]randTab", "=", 
            RowBox[{"ArcCos", "[", 
             RowBox[{"RandomReal", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"\[Phi]randTab", "=", 
            RowBox[{"RandomReal", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "Pi"}], ",", "Pi"}], "}"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"\[Kappa]randTab", "=", 
            RowBox[{"RandomReal", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "Pi"}], ",", "Pi"}], "}"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"eprod2", "=", 
            RowBox[{"MASSM", "-", "eprod1", "-", "eprod3"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"pxprod1", "=", 
            RowBox[{"p1rotatedX", "[", 
             RowBox[{
             "eprod1", ",", "MASS1", ",", "\[Theta]randTab", ",", 
              "\[Phi]randTab"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"pyprod1", "=", 
            RowBox[{"p1rotatedY", "[", 
             RowBox[{
             "eprod1", ",", "MASS1", ",", "\[Theta]randTab", ",", 
              "\[Phi]randTab"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"pzprod1", "=", 
            RowBox[{"p1rotatedZ", "[", 
             RowBox[{
             "eprod1", ",", "MASS1", ",", "\[Theta]randTab", ",", 
              "\[Phi]randTab"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"pxprod2", "=", 
            RowBox[{"p2rotatedX", "[", 
             RowBox[{
             "eprod1", ",", "eprod3", ",", "MASSM", ",", "MASS1", ",", 
              "MASS2", ",", "MASS3", ",", "\[Theta]randTab", ",", 
              "\[Phi]randTab", ",", "\[Kappa]randTab"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"pyprod2", "=", 
            RowBox[{"p2rotatedY", "[", 
             RowBox[{
             "eprod1", ",", "eprod3", ",", "MASSM", ",", "MASS1", ",", 
              "MASS2", ",", "MASS3", ",", "\[Theta]randTab", ",", 
              "\[Phi]randTab", ",", "\[Kappa]randTab"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"pzprod2", "=", 
            RowBox[{"p2rotatedZ", "[", 
             RowBox[{
             "eprod1", ",", "eprod3", ",", "MASSM", ",", "MASS1", ",", 
              "MASS2", ",", "MASS3", ",", "\[Theta]randTab", ",", 
              "\[Phi]randTab", ",", "\[Kappa]randTab"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"pxprod3", "=", 
            RowBox[{"p3rotatedX", "[", 
             RowBox[{
             "eprod1", ",", "eprod3", ",", "MASSM", ",", "MASS1", ",", 
              "MASS2", ",", "MASS3", ",", "\[Theta]randTab", ",", 
              "\[Phi]randTab", ",", "\[Kappa]randTab"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"pyprod3", "=", 
            RowBox[{"p3rotatedY", "[", 
             RowBox[{
             "eprod1", ",", "eprod3", ",", "MASSM", ",", "MASS1", ",", 
              "MASS2", ",", "MASS3", ",", "\[Theta]randTab", ",", 
              "\[Phi]randTab", ",", "\[Kappa]randTab"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"pzprod3", "=", 
            RowBox[{"p3rotatedZ", "[", 
             RowBox[{
             "eprod1", ",", "eprod3", ",", "MASSM", ",", "MASS1", ",", 
              "MASS2", ",", "MASS3", ",", "\[Theta]randTab", ",", 
              "\[Phi]randTab", ",", "\[Kappa]randTab"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
            "pxprod1", ",", "pyprod1", ",", "pzprod1", ",", "eprod1", ",", 
             "MASS1", ",", "pdg1", ",", "charge1", ",", "stability1", ",", 
             "pxprod2", ",", "pyprod2", ",", "pzprod2", ",", "eprod2", ",", 
             "MASS2", ",", "pdg2", ",", "charge2", ",", "stability2", ",", 
             "pxprod3", ",", "pyprod3", ",", "pzprod3", ",", "eprod3", ",", 
             "MASS3", ",", "pdg3", ",", "charge3", ",", "stability3"}], 
            "}"}]}]}], "\[IndentingNewLine]", "]"}], ",", 
        RowBox[{"CompilationTarget", "\[Rule]", "\"\<C\>\""}], ",", 
        RowBox[{"RuntimeOptions", "\[Rule]", "\"\<Speed\>\""}], ",", 
        RowBox[{"RuntimeAttributes", "\[Rule]", 
         RowBox[{"{", "Listable", "}"}]}]}], "]"}]}], "/.", 
     RowBox[{"ruleDown", "[", 
      RowBox[{"{", 
       RowBox[{
       "p1rotatedX", ",", "p1rotatedY", ",", "p1rotatedZ", ",", "p2rotatedX", 
        ",", "p2rotatedY", ",", "p2rotatedZ", ",", "p3rotatedX", ",", 
        "p3rotatedY", ",", "p3rotatedZ"}], "}"}], "]"}]}], "//", 
    "ReleaseHold"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"<<", "CompiledFunctionTools`"}], "\n", 
 RowBox[{
  RowBox[{"CompilePrint", "@", "tabPS3bodyCompiled"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ThreeBodyDecaysEventsAtRest", "[", 
   RowBox[{
   "particle_", ",", "SpecificDecay_", ",", "mparticle_", ",", "Nevents_"}], 
   "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"(*", 
      RowBox[{
      "pdg1", ",", "pdg2", ",", "pdg3", ",", "MASSM", ",", "MASS1", ",", 
       "MASS2", ",", "MASS3", ",", "charge1", ",", "charge2", ",", "charge3", 
       ",", "stability1", ",", "stability2", ",", "stability3", ",", 
       "\[Theta]randTab", ",", "\[Phi]randTab", ",", "\[Kappa]randTab", ",", 
       RowBox[{"(*", 
        RowBox[{"tabRPPS", ",", "weights1", ",", "weights", ","}], "*)"}], 
       "decayproductsset", ",", "weightedData", ",", "edist", ",", 
       "tabPSenergies"}], "*)"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
     "___", "___", "___", "___", "___", "___", "___", "___", "___", "___", 
      "___", "__"}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
     "Extracting", " ", "information", " ", "about", " ", "the", " ", 
      "decay"}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"MASSM", " ", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"!", 
         RowBox[{"(", 
          RowBox[{"particle", "==", "LLPdirName"}], ")"}]}], ",", 
        RowBox[{"ParamProductMass", "[", 
         RowBox[{"ParamProductToPDGid", "[", "particle", "]"}], "]"}], ",", 
        "mparticle"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"decayproductsset", "=", 
      RowBox[{"Select", "[", 
       RowBox[{
        RowBox[{"ListDecayProducts", "[", 
         RowBox[{"particle", ",", "SpecificDecay"}], "]"}], ",", 
        RowBox[{
         RowBox[{"#", "!=", "\"\<Null\>\""}], "&"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"pdg1", ",", "pdg2", ",", "pdg3"}], "}"}], "=", 
      RowBox[{
       RowBox[{
        RowBox[{"ParamProductToPDGid", "[", "#", "]"}], "&"}], "/@", 
       "decayproductsset"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"MASS1", ",", "MASS2", ",", "MASS3"}], "}"}], "=", 
      RowBox[{
       RowBox[{
        RowBox[{"ParamProductMass", "[", "#", "]"}], "&"}], "/@", 
       RowBox[{"{", 
        RowBox[{"pdg1", ",", "pdg2", ",", "pdg3"}], "}"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"charge1", ",", "charge2", ",", "charge3"}], "}"}], "=", 
      RowBox[{
       RowBox[{
        RowBox[{"ParamProductCharge", "[", "#", "]"}], "&"}], "/@", 
       RowBox[{"{", 
        RowBox[{"pdg1", ",", "pdg2", ",", "pdg3"}], "}"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"stability1", ",", "stability2", ",", "stability3"}], "}"}], "=", 
      RowBox[{
       RowBox[{
        RowBox[{"ParamProductStability", "[", "#", "]"}], "&"}], "/@", 
       RowBox[{"{", 
        RowBox[{"pdg1", ",", "pdg2", ",", "pdg3"}], "}"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{
       "The", " ", "squared", " ", "matrix", " ", "element", " ", "for", " ", 
        "the", " ", "process"}], " ", "-", " ", 
       RowBox[{"to", " ", "compute", " ", "weights"}]}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"distr", "[", 
       RowBox[{"E1_", ",", "E3_"}], "]"}], "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"!", 
         RowBox[{"(", 
          RowBox[{"particle", "==", "LLPdirName"}], ")"}]}], ",", 
        RowBox[{"Msquared3BodySMparticles", "[", 
         RowBox[{
         "particle", ",", "SpecificDecay", ",", "E1", ",", "E3", ",", 
          "MASSM"}], "]"}], ",", 
        RowBox[{"Msquared3BodyLLP", "[", 
         RowBox[{
         "particle", ",", "SpecificDecay", ",", "E1", ",", "E3", ",", "MASSM",
           ",", "decayDescrSelected"}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "___", "___", "___", "___", "___", "___", "___", "___", "___", "___", 
       "___", "__"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Generating", " ", "the", " ", "true", " ", 
        SubscriptBox["E", "1"]}], ",", 
       RowBox[{
        RowBox[{
         SubscriptBox["E", "3"], " ", "for", " ", "the", " ", "decay", " ", 
         "process", " ", "0"}], "->", 
        RowBox[{"1", "+", "2", "+", "3"}]}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "___", "___", "___", "___", "___", "___", "___", "___", "___", "___", 
       "___", "__"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"tabE1E3true", "=", 
      RowBox[{"BlockRandomEnergies", "[", 
       RowBox[{
       "MASSM", ",", "MASS1", ",", "MASS2", ",", "MASS3", ",", "Nevents", ",",
         "distr"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"tabPS3bodyCompiled", "[", 
      RowBox[{
      "tabE1E3true", ",", "MASSM", ",", "MASS1", ",", "MASS2", ",", "MASS3", ",",
        "pdg1", ",", "pdg2", ",", "pdg3", ",", "charge1", ",", "charge2", ",",
        "charge3", ",", "stability1", ",", "stability2", ",", "stability3"}], 
      "]"}]}]}], "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.93106928666072*^9, 3.9310692897691827`*^9}, {
  3.931157768390807*^9, 3.9311577710870123`*^9}, {3.931229413394782*^9, 
  3.9312294343269386`*^9}, {3.952756466319422*^9, 3.952756478057644*^9}},
 CellLabel->
  "In[133]:=",ExpressionUUID->"d4f445be-2584-4858-b647-9f9df9278a59"]
}, Open  ]],

Cell[CellGroupData[{

Cell["4-body", "Subsection",
 CellChangeTimes->{{3.9310681807160206`*^9, 
  3.931068186744728*^9}},ExpressionUUID->"93af4c5a-e811-41c5-b67c-\
21549db5632a"],

Cell[CellGroupData[{

Cell["Definitions", "Subsubsection",
 CellChangeTimes->{{3.8928220364284725`*^9, 3.892822038177458*^9}, {
  3.8928229138872695`*^9, 3.8928229153893785`*^9}},
 CellTags->
  "Evaluation",ExpressionUUID->"91ce9d68-c412-428c-b974-f172f1e4b024"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"The", " ", "idea", " ", 
     RowBox[{"(", 
      RowBox[{
      "following", " ", "\"\<Particle kinematics\>\"", " ", "by", " ", 
       "Byckling", " ", "and", " ", "Kajantie"}], ")"}]}], ":"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"Represent", " ", "the", " ", "process", " ", "0"}], "\[Rule]", 
     RowBox[{
      RowBox[{"1", "+", "2", "+", "3", "+", 
       RowBox[{"4", " ", "as", " ", "0"}]}], "\[Rule]", 
      RowBox[{"1", "+", "234"}]}]}], ",", " ", 
    RowBox[{"234", "\[Rule]", 
     RowBox[{"2", "+", "34"}]}], ",", 
    RowBox[{"34", "\[Rule]", 
     RowBox[{"3", "+", "4"}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Generate", " ", "the", " ", "random", " ", "\"\<masses\>\"", " ", 
     SubscriptBox["m", "234"]}], ",", 
    RowBox[{
     RowBox[{
      SubscriptBox["m", "34"], " ", "with", " ", "the", " ", "weight", " ", 
      "being", " ", "the", " ", "jacobian", " ", "of", " ", "the", " ", 
      "phase", " ", "space", " ", "represented", " ", "via", " ", "these", " ",
       "subsequent", " ", "2"}], "-", 
     RowBox[{"body", " ", "decays"}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{
     "Generate", " ", "the", " ", "phase", " ", "space", " ", "of", " ", 
      "these", " ", "2"}], "-", 
     RowBox[{"body", " ", "decays", " ", "at", " ", "rest"}]}], ",", " ", 
    RowBox[{
    "and", " ", "then", " ", "boost", " ", "it", " ", "by", " ", "the", " ", 
     "momentum", " ", "of", " ", "the", " ", "decaying", 
     " ", "\"\<particle\>\"", " ", "in", " ", "its", " ", "lab", " ", 
     "frame"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"nVectorParticlesIntermediateComp", "=", 
     RowBox[{"Compile", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"\[Theta]vals", ",", "_Real"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"\[Phi]vals", ",", "_Real"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"MassMatrix", ",", "_Real", ",", "1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"StabilityMatrix", ",", "_Real", ",", "1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"ChargeMatrix", ",", "_Real", ",", "1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"PDGMatrix", ",", "_Real", ",", "1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"ival", ",", "_Integer"}], "}"}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "pmod", ",", "m0val", ",", "m1val", ",", "m2val", ",", "E1val", ",",
            "E2val", ",", "px1", ",", "px2", ",", "py1", ",", "py2", ",", 
           "pz1", ",", "pz2", ",", "stability1", ",", "stability2", ",", 
           "charge1", ",", "charge2", ",", "pdg1", ",", "pdg2"}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"m0val", "=", 
           RowBox[{"Compile`GetElement", "[", 
            RowBox[{"MassMatrix", ",", 
             RowBox[{
              RowBox[{"2", "*", 
               RowBox[{"(", 
                RowBox[{"ival", "-", "1"}], ")"}]}], "+", "1"}]}], "]"}]}], ";",
           "\[IndentingNewLine]", 
          RowBox[{"m1val", "=", 
           RowBox[{"Compile`GetElement", "[", 
            RowBox[{"MassMatrix", ",", 
             RowBox[{
              RowBox[{"2", "*", 
               RowBox[{"(", 
                RowBox[{"ival", "-", "1"}], ")"}]}], "+", "2"}]}], "]"}]}], ";",
           "\[IndentingNewLine]", 
          RowBox[{"m2val", "=", 
           RowBox[{"Compile`GetElement", "[", 
            RowBox[{"MassMatrix", ",", 
             RowBox[{
              RowBox[{"2", "*", 
               RowBox[{"(", 
                RowBox[{"ival", "-", "1"}], ")"}]}], "+", "3"}]}], "]"}]}], ";",
           "\[IndentingNewLine]", 
          RowBox[{"stability1", "=", 
           RowBox[{"StabilityMatrix", "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{"2", "*", 
               RowBox[{"(", 
                RowBox[{"ival", "-", "1"}], ")"}]}], "+", "1"}], "]"}], 
            "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"stability2", "=", 
           RowBox[{"StabilityMatrix", "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{"2", "*", 
               RowBox[{"(", 
                RowBox[{"ival", "-", "1"}], ")"}]}], "+", "2"}], "]"}], 
            "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"charge1", "=", 
           RowBox[{"ChargeMatrix", "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{"2", "*", 
               RowBox[{"(", 
                RowBox[{"ival", "-", "1"}], ")"}]}], "+", "1"}], "]"}], 
            "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"charge2", "=", 
           RowBox[{"ChargeMatrix", "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{"2", "*", 
               RowBox[{"(", 
                RowBox[{"ival", "-", "1"}], ")"}]}], "+", "2"}], "]"}], 
            "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"pdg1", "=", 
           RowBox[{"PDGMatrix", "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{"2", "*", 
               RowBox[{"(", 
                RowBox[{"ival", "-", "1"}], ")"}]}], "+", "1"}], "]"}], 
            "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"pdg2", "=", 
           RowBox[{"PDGMatrix", "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{"2", "*", 
               RowBox[{"(", 
                RowBox[{"ival", "-", "1"}], ")"}]}], "+", "2"}], "]"}], 
            "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"E1val", "=", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["m0val", "2"], "+", 
              SuperscriptBox["m1val", "2"], "-", 
              SuperscriptBox["m2val", "2"]}], ")"}], "/", 
            RowBox[{"(", 
             RowBox[{"2", "m0val"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"E2val", "=", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["m0val", "2"], "-", 
              SuperscriptBox["m1val", "2"], "+", 
              SuperscriptBox["m2val", "2"]}], ")"}], "/", 
            RowBox[{"(", 
             RowBox[{"2", "m0val"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"pmod", "=", 
           RowBox[{"\[Sqrt]", 
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["E1val", "2"], "-", 
              SuperscriptBox["m1val", "2"]}], ")"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"px1", "=", 
           RowBox[{"pmod", "*", 
            RowBox[{"Sin", "[", "\[Theta]vals", "]"}], "*", 
            RowBox[{"Cos", "[", "\[Phi]vals", "]"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"px2", "=", 
           RowBox[{"-", "px1"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"py1", "=", 
           RowBox[{"pmod", "*", 
            RowBox[{"Sin", "[", "\[Theta]vals", "]"}], "*", 
            RowBox[{"Sin", "[", "\[Phi]vals", "]"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"py2", "=", 
           RowBox[{"-", "py1"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"pz1", "=", 
           RowBox[{"pmod", "*", 
            RowBox[{"Cos", "[", "\[Theta]vals", "]"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"pz2", "=", 
           RowBox[{"-", "pz1"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{
           "px1", ",", "py1", ",", "pz1", ",", "E1val", ",", "m1val", ",", 
            "pdg1", ",", "charge1", ",", "stability1", ",", "px2", ",", "py2",
             ",", "pz2", ",", "E2val", ",", "m2val", ",", "pdg2", ",", 
            "charge2", ",", "stability2"}], "}"}]}]}], "\[IndentingNewLine]", 
        "]"}], ",", 
       RowBox[{"CompilationTarget", "\[Rule]", "\"\<C\>\""}], ",", 
       RowBox[{"RuntimeOptions", "\[Rule]", "\"\<Speed\>\""}], ",", 
       RowBox[{"RuntimeAttributes", "\[Rule]", 
        RowBox[{"{", "Listable", "}"}]}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"nVectorParticlesIntermediate", "[", 
     RowBox[{
     "MassMatrix_", ",", "StabilityMatrix_", ",", "ChargeMatrix_", ",", 
      "PDGMatrix_", ",", "ival_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\[Theta]vals", ",", "\[Phi]vals"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\[Theta]vals", "=", 
        RowBox[{"ArcCos", "[", 
         RowBox[{"RandomReal", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
           RowBox[{"Length", "[", "MassMatrix", "]"}]}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"\[Phi]vals", "=", 
        RowBox[{"RandomReal", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "Pi"}], ",", "Pi"}], "}"}], ",", 
          RowBox[{"Length", "[", "MassMatrix", "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"nVectorParticlesIntermediateComp", "[", 
        RowBox[{
        "\[Theta]vals", ",", "\[Phi]vals", ",", "MassMatrix", ",", 
         "StabilityMatrix", ",", "ChargeMatrix", ",", "PDGMatrix", ",", 
         "ival"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Block", " ", "computing", " ", "random", " ", "masses"}], "*)"}],
    "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Lambda]f", "[", 
      RowBox[{"a_", ",", "b_", ",", "c_"}], "]"}], "=", 
     RowBox[{
      SuperscriptBox["a", "2"], "+", 
      SuperscriptBox["b", "2"], "+", 
      SuperscriptBox["c", "2"], "-", 
      RowBox[{"2", "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"a", "*", "b"}], "+", 
         RowBox[{"b", "*", "c"}], "+", 
         RowBox[{"a", "*", "c"}]}], ")"}]}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Jacobian4body", "[", 
      RowBox[{
      "m_", ",", "m1_", ",", "m2_", ",", "m3_", ",", "m4_", ",", "m234_", ",",
        "m34_"}], "]"}], "=", 
     RowBox[{
      RowBox[{"(", 
       FractionBox[
        SqrtBox[
         RowBox[{"\[Lambda]f", "[", 
          RowBox[{
           SuperscriptBox["m", "2"], ",", 
           SuperscriptBox["m1", "2"], ",", 
           SuperscriptBox["m234", "2"]}], "]"}]], 
        RowBox[{"2", "m"}]], ")"}], 
      RowBox[{"(", 
       FractionBox[
        SqrtBox[
         RowBox[{"\[Lambda]f", "[", 
          RowBox[{
           SuperscriptBox["m234", "2"], ",", 
           SuperscriptBox["m2", "2"], ",", 
           SuperscriptBox["m34", "2"]}], "]"}]], 
        RowBox[{"2", "m234"}]], ")"}], 
      RowBox[{"(", 
       FractionBox[
        SqrtBox[
         RowBox[{"\[Lambda]f", "[", 
          RowBox[{
           SuperscriptBox["m34", "2"], ",", 
           SuperscriptBox["m3", "2"], ",", 
           SuperscriptBox["m4", "2"]}], "]"}]], 
        RowBox[{"2", "m34"}]], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"BlockFalseRandomMasses", "=", 
    RowBox[{"Compile", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"m", ",", "m1", ",", "m2", ",", "m3", ",", "m4", ",", 
        RowBox[{"{", 
         RowBox[{"Nevents", ",", "_Integer"}], "}"}]}], "}"}], ",", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"m234list", ",", "m34list"}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"m234list", "=", 
          RowBox[{"RandomReal", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"m2", "+", "m3", "+", "m4"}], ",", 
              RowBox[{"m", "-", "m1"}]}], "}"}], ",", "Nevents"}], "]"}]}], ";",
          "\[IndentingNewLine]", 
         RowBox[{"m34list", "=", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"RandomReal", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"m3", "+", "m4"}], ",", 
               RowBox[{
                RowBox[{"m234list", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "-", "m2"}]}], "}"}], "]"}], 
            ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"Length", "[", "m234list", "]"}], ",", "1"}], "}"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"m234list", ",", "m34list"}], "}"}], "//", 
          "Transpose"}]}]}], "\[IndentingNewLine]", "]"}], ",", 
      RowBox[{"CompilationTarget", "\[Rule]", "\"\<C\>\""}], ",", 
      RowBox[{"RuntimeOptions", "\[Rule]", "\"\<Speed\>\""}]}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"WeightsComp", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"Hold", "@", 
       RowBox[{"Compile", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"m", ",", "m1", ",", "m2", ",", "m3", ",", "m4", ",", 
           RowBox[{"{", 
            RowBox[{"falserandmass", ",", "_Real", ",", "1"}], "}"}]}], "}"}],
          ",", "\[IndentingNewLine]", 
         RowBox[{"Module", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"m234", ",", "m34"}], "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"m234", "=", 
             RowBox[{"Compile`GetElement", "[", 
              RowBox[{"falserandmass", ",", "1"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"m34", "=", 
             RowBox[{"Compile`GetElement", "[", 
              RowBox[{"falserandmass", ",", "2"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"m234", "-", "m2", "-", "m3", "-", "m4"}], ")"}], 
             RowBox[{"Jacobian4body", "[", 
              RowBox[{
              "m", ",", "m1", ",", "m2", ",", "m3", ",", "m4", ",", "m234", ",",
                "m34"}], "]"}]}]}]}], "\[IndentingNewLine]", "]"}], ",", 
         RowBox[{"CompilationTarget", "\[Rule]", "\"\<C\>\""}], ",", 
         RowBox[{"RuntimeOptions", "\[Rule]", "\"\<Speed\>\""}], ",", 
         RowBox[{"Parallelization", "->", "True"}], ",", 
         RowBox[{"RuntimeAttributes", "->", 
          RowBox[{"{", "Listable", "}"}]}]}], "]"}]}], "/.", 
      RowBox[{"ruleDown", "[", 
       RowBox[{"{", "Jacobian4body", "}"}], "]"}]}], "//", "ReleaseHold"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BlockTrueRandomMasses", "[", 
     RowBox[{
     "m_", ",", "m1_", ",", "m2_", ",", "m3_", ",", "m4_", ",", "Nevents_"}], 
     "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "FalseRandMasses", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"NN", "=", 
        SuperscriptBox["10", "5"]}], ";", "\[IndentingNewLine]", 
       RowBox[{"FalseRandMasses", "=", 
        RowBox[{"BlockFalseRandomMasses", "[", 
         RowBox[{"m", ",", "m1", ",", "m2", ",", "m3", ",", "m4", ",", "NN"}],
          "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"WeightsVals", "=", 
        RowBox[{"WeightsComp", "[", 
         RowBox[{
         "m", ",", "m1", ",", "m2", ",", "m3", ",", "m4", ",", 
          "FalseRandMasses"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Weighted", " ", "random", " ", "points"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"weightedData", "=", 
          RowBox[{"WeightedData", "[", 
           RowBox[{"FalseRandMasses", ",", "WeightsVals"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{"True", " ", "random", " ", 
           RowBox[{"energies", ".", " ", "Computed"}], " ", "via", " ", 
           "empirical", " ", "distribution", " ", "from", " ", "the", " ", 
           "weigthed", " ", "data"}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"edist", "=", 
          RowBox[{"EmpiricalDistribution", "[", "weightedData", "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"tabMasses", "=", 
          RowBox[{"RandomVariate", "[", 
           RowBox[{"edist", ",", "Nevents"}], "]"}]}]}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"tabMasses", "=", 
        RowBox[{"RandomChoice", "[", 
         RowBox[{
          RowBox[{"WeightsVals", "->", "FalseRandMasses"}], ",", "Nevents"}], 
         "]"}]}]}]}], "\[IndentingNewLine]", "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.8928229459274297`*^9, 3.8928231140865407`*^9}, {
  3.8928237027715197`*^9, 3.8928237203407784`*^9}, {3.892823796301366*^9, 
  3.8928239628178263`*^9}, {3.8928240794677286`*^9, 3.8928242002796664`*^9}, {
  3.892824937352701*^9, 3.8928249391260147`*^9}, {3.892827131142872*^9, 
  3.892827142254938*^9}, {3.8928281659226713`*^9, 3.8928281678349085`*^9}, {
  3.8928283724191017`*^9, 3.892828384754986*^9}, {3.8928285964788666`*^9, 
  3.892828654894505*^9}, {3.892828710001687*^9, 3.892828787580044*^9}, {
  3.892828825391675*^9, 3.892828825525365*^9}, {3.916126649164712*^9, 
  3.916126806527561*^9}, {3.9161269771861925`*^9, 3.916126999388183*^9}, {
  3.9161273848381853`*^9, 3.9161274203984475`*^9}, {3.9161593491590605`*^9, 
  3.9161593561922445`*^9}, {3.9161610081358595`*^9, 3.9161610087174244`*^9}},
 CellTags->"Evaluation",
 CellLabel->
  "In[1362]:=",ExpressionUUID->"85a05016-3b4d-41d3-b5c1-cc23364c7940"],

Cell[BoxData[
 FormBox[
  InterpretationBox[
   RowBox[{
    TagBox["CompiledFunction",
     "SummaryHead"], "[", 
    DynamicModuleBox[{Typeset`open$$ = False, Typeset`embedState$$ = "Ready"}, 
     TemplateBox[{
       PaneSelectorBox[{False -> GridBox[{{
             PaneBox[
              ButtonBox[
               DynamicBox[
                FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxOpener"]], 
               ButtonFunction :> (Typeset`open$$ = True), Appearance -> None, 
               BaseStyle -> {}, Evaluator -> Automatic, Method -> 
               "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
              Dynamic[{
                Automatic, 
                 3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                  Magnification])}]], 
             GraphicsBox[{
               Thickness[0.038461538461538464`], {
                FaceForm[{
                  GrayLevel[0.93], 
                  Opacity[1.]}], 
                
                FilledCurveBox[{{{1, 4, 3}, {0, 1, 0}, {1, 3, 3}, {0, 1, 0}, {
                 1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {0, 1, 0}}}, {{{
                 25.499999999999996`, 2.5}, {25.499999999999996`, 
                 1.3953100000000003`}, {24.604699999999998`, 
                 0.49999999999999994`}, {23.5, 0.49999999999999994`}, {2.5, 
                 0.49999999999999994`}, {1.3953100000000003`, 
                 0.49999999999999994`}, {0.49999999999999994`, 
                 1.3953100000000003`}, {0.49999999999999994`, 2.5}, {
                 0.49999999999999994`, 23.5}, {0.49999999999999994`, 
                 24.604699999999998`}, {1.3953100000000003`, 
                 25.499999999999996`}, {2.5, 25.499999999999996`}, {23.5, 
                 25.499999999999996`}, {24.604699999999998`, 
                 25.499999999999996`}, {25.499999999999996`, 
                 24.604699999999998`}, {25.499999999999996`, 23.5}, {
                 25.499999999999996`, 2.5}}}]}, {
                FaceForm[{
                  RGBColor[0.5, 0.5, 0.5], 
                  Opacity[1.]}], 
                
                FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {
                 0, 1, 0}, {0, 1, 0}, {0, 1, 0}}}, {{{20.5426, 
                 19.116799999999998`}, {16.3832, 21.876199999999997`}, {
                 16.3832, 20.021499999999996`}, {6.930469999999999, 
                 20.021499999999996`}, {6.930469999999999, 
                 18.212100000000003`}, {16.3832, 18.212100000000003`}, {
                 16.3832, 16.357399999999995`}, {20.5426, 
                 19.116799999999998`}}}], 
                
                FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {
                 0, 1, 0}, {0, 1, 0}, {0, 1, 0}}}, {{{5.30508, 13.8391}, {
                 9.46445, 11.079700000000003`}, {9.46445, 
                 12.933999999999997`}, {18.917199999999998`, 
                 12.933999999999997`}, {18.917199999999998`, 14.7438}, {
                 9.46445, 14.7438}, {9.46445, 16.598}, {5.30508, 13.8391}}}], 
                
                FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {
                 0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
                 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {
                 1, 3, 3}, {1, 3, 3}, {1, 3, 3}}}, CompressedData["
1:eJxTTMoPSmVmYGBgBGJjIGYCYq4u+eR3VWoOxhkv5j+Qk3SA8fu/r5rKOVHM
Yd2vmNyjZ9Qcrt9QXbW9S8RBg59767IidQcPMYPGaHFhB+Nn61SfiGo4xBwp
T7o2V9Dh0Iolfg6/NBxEHv/x1Xgi4FB1XNNqkqQWnP+axUTQjFkbzn+oO2HB
j/3aDg/Xn5T6WiDoYLs3aJpiqI7DrHN+bO6tQg4zfUR7vF7pQOyfIQyRd9d1
WLL0U1kLoyjEPdm6DpoTXfQX7xBzKPjQejLkhDacL5J4+LL2Gm2HtNnSl4Vf
iELM69J2qPZM3tLnJerQX1oozZugDfHPUxGI/4W1HQ5p3TthoyDi4D7lG1v8
Mi2HgqL9zoEHhB1inOxe3BRG8MH62zXhfIbN1Z82CGhC/GMg4nCm3mN/7TYN
iHlCUPdGakDc/1kUEr46GhD/eYnD+d9iBf/kC0vC+TuCrSL+X5Vy2HGR4R5T
uAbEfxYykPBYp+HQqsCuesZAFhL+rJoQ/2rIQdxTpwkJ7yVycPfD+GDzVqLx
xbUd5HYt2JfqBdWfpA2Jj9mykPDpgYaXtaxDy7yzq86vg8qvlIHE5ylY/Eo7
XAt7o787TxfOB5ufqesQ9PbyxxkPZSDhZ6nrMAGU3u7LQtLLEx2HN2253UbX
ofZ76jis/Pay4oynAsT8QG0HKZMv/gW7FCDyTFpwPsz/MD44/Mw1HFjb1uR9
TVVwWKy880/7FHWIexrkIfLX1RzOMDZZVjHIOaDkh3vSDuj5AwCF11Vc
                 "]]}}, Background -> GrayLevel[0.93], Axes -> False, 
              AspectRatio -> 1, ImageSize -> 
              Dynamic[{
                Automatic, 
                 3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                  Magnification])}], Frame -> True, FrameTicks -> None, 
              FrameStyle -> Directive[
                Thickness[Tiny], 
                GrayLevel[0.7]]], 
             GridBox[{{
                RowBox[{
                  TagBox["\"Argument count: \"", "SummaryItemAnnotation"], 
                  "\[InvisibleSpace]", 
                  TagBox["6", "SummaryItem"]}]}, {
                RowBox[{
                  TagBox["\"Argument types: \"", "SummaryItemAnnotation"], 
                  "\[InvisibleSpace]", 
                  TagBox[
                   StyleBox[
                    PaneBox[
                    RowBox[{"{", 
                    
                    RowBox[{
                    "_Real", ",", "_Real", ",", "_Real", ",", "_Real", ",", 
                    "_Real", ",", "_Integer"}], "}"}], ContentPadding -> 
                    False, FrameMargins -> 0, StripOnInput -> True, 
                    BaselinePosition -> Baseline, 
                    ImageSize -> {{1, 300}, Automatic}], LineBreakWithin -> 
                    False], "SummaryItem"]}]}}, 
              GridBoxAlignment -> {
               "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
              False, GridBoxItemSize -> {
               "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
              GridBoxSpacings -> {
               "Columns" -> {{2}}, "Rows" -> {{Automatic}}}, 
              BaseStyle -> {
               ShowStringCharacters -> False, NumberMarks -> False, 
                PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
           GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
           AutoDelete -> False, 
           GridBoxItemSize -> {
            "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
           BaselinePosition -> {1, 1}], True -> GridBox[{{
             PaneBox[
              ButtonBox[
               DynamicBox[
                FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxCloser"]], 
               ButtonFunction :> (Typeset`open$$ = False), Appearance -> None,
                BaseStyle -> {}, Evaluator -> Automatic, Method -> 
               "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
              Dynamic[{
                Automatic, 
                 3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                  Magnification])}]], 
             GraphicsBox[{
               Thickness[0.038461538461538464`], {
                FaceForm[{
                  GrayLevel[0.93], 
                  Opacity[1.]}], 
                
                FilledCurveBox[{{{1, 4, 3}, {0, 1, 0}, {1, 3, 3}, {0, 1, 0}, {
                 1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {0, 1, 0}}}, {{{
                 25.499999999999996`, 2.5}, {25.499999999999996`, 
                 1.3953100000000003`}, {24.604699999999998`, 
                 0.49999999999999994`}, {23.5, 0.49999999999999994`}, {2.5, 
                 0.49999999999999994`}, {1.3953100000000003`, 
                 0.49999999999999994`}, {0.49999999999999994`, 
                 1.3953100000000003`}, {0.49999999999999994`, 2.5}, {
                 0.49999999999999994`, 23.5}, {0.49999999999999994`, 
                 24.604699999999998`}, {1.3953100000000003`, 
                 25.499999999999996`}, {2.5, 25.499999999999996`}, {23.5, 
                 25.499999999999996`}, {24.604699999999998`, 
                 25.499999999999996`}, {25.499999999999996`, 
                 24.604699999999998`}, {25.499999999999996`, 23.5}, {
                 25.499999999999996`, 2.5}}}]}, {
                FaceForm[{
                  RGBColor[0.5, 0.5, 0.5], 
                  Opacity[1.]}], 
                
                FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {
                 0, 1, 0}, {0, 1, 0}, {0, 1, 0}}}, {{{20.5426, 
                 19.116799999999998`}, {16.3832, 21.876199999999997`}, {
                 16.3832, 20.021499999999996`}, {6.930469999999999, 
                 20.021499999999996`}, {6.930469999999999, 
                 18.212100000000003`}, {16.3832, 18.212100000000003`}, {
                 16.3832, 16.357399999999995`}, {20.5426, 
                 19.116799999999998`}}}], 
                
                FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {
                 0, 1, 0}, {0, 1, 0}, {0, 1, 0}}}, {{{5.30508, 13.8391}, {
                 9.46445, 11.079700000000003`}, {9.46445, 
                 12.933999999999997`}, {18.917199999999998`, 
                 12.933999999999997`}, {18.917199999999998`, 14.7438}, {
                 9.46445, 14.7438}, {9.46445, 16.598}, {5.30508, 13.8391}}}], 
                
                FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {
                 0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
                 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {
                 1, 3, 3}, {1, 3, 3}, {1, 3, 3}}}, CompressedData["
1:eJxTTMoPSmVmYGBgBGJjIGYCYq4u+eR3VWoOxhkv5j+Qk3SA8fu/r5rKOVHM
Yd2vmNyjZ9Qcrt9QXbW9S8RBg59767IidQcPMYPGaHFhB+Nn61SfiGo4xBwp
T7o2V9Dh0Iolfg6/NBxEHv/x1Xgi4FB1XNNqkqQWnP+axUTQjFkbzn+oO2HB
j/3aDg/Xn5T6WiDoYLs3aJpiqI7DrHN+bO6tQg4zfUR7vF7pQOyfIQyRd9d1
WLL0U1kLoyjEPdm6DpoTXfQX7xBzKPjQejLkhDacL5J4+LL2Gm2HtNnSl4Vf
iELM69J2qPZM3tLnJerQX1oozZugDfHPUxGI/4W1HQ5p3TthoyDi4D7lG1v8
Mi2HgqL9zoEHhB1inOxe3BRG8MH62zXhfIbN1Z82CGhC/GMg4nCm3mN/7TYN
iHlCUPdGakDc/1kUEr46GhD/eYnD+d9iBf/kC0vC+TuCrSL+X5Vy2HGR4R5T
uAbEfxYykPBYp+HQqsCuesZAFhL+rJoQ/2rIQdxTpwkJ7yVycPfD+GDzVqLx
xbUd5HYt2JfqBdWfpA2Jj9mykPDpgYaXtaxDy7yzq86vg8qvlIHE5ylY/Eo7
XAt7o787TxfOB5ufqesQ9PbyxxkPZSDhZ6nrMAGU3u7LQtLLEx2HN2253UbX
ofZ76jis/Pay4oynAsT8QG0HKZMv/gW7FCDyTFpwPsz/MD44/Mw1HFjb1uR9
TVVwWKy880/7FHWIexrkIfLX1RzOMDZZVjHIOaDkh3vSDuj5AwCF11Vc
                 "]]}}, Background -> GrayLevel[0.93], Axes -> False, 
              AspectRatio -> 1, ImageSize -> 
              Dynamic[{
                Automatic, 
                 3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                  Magnification])}], Frame -> True, FrameTicks -> None, 
              FrameStyle -> Directive[
                Thickness[Tiny], 
                GrayLevel[0.7]]], 
             GridBox[{{
                RowBox[{
                  TagBox["\"Argument count: \"", "SummaryItemAnnotation"], 
                  "\[InvisibleSpace]", 
                  TagBox["6", "SummaryItem"]}]}, {
                RowBox[{
                  TagBox["\"Argument types: \"", "SummaryItemAnnotation"], 
                  "\[InvisibleSpace]", 
                  TagBox[
                   PaneBox[
                    RowBox[{"{", 
                    
                    RowBox[{
                    "_Real", ",", "_Real", ",", "_Real", ",", "_Real", ",", 
                    "_Real", ",", "_Integer"}], "}"}], 
                    ImageSize -> {{1, 500}, Automatic}, BaselinePosition -> 
                    Baseline, ContentPadding -> False, FrameMargins -> 0, 
                    StripOnInput -> True], "SummaryItem"]}]}, {
                RowBox[{
                  TagBox["\"Variables: \"", "SummaryItemAnnotation"], 
                  "\[InvisibleSpace]", 
                  TagBox[
                   RowBox[{"{", 
                    
                    RowBox[{
                    "m", ",", "m1", ",", "m2", ",", "m3", ",", "m4", ",", 
                    "Nevents"}], "}"}], "SummaryItem"]}]}, {
                RowBox[{
                  TagBox["\"Expression: \"", "SummaryItemAnnotation"], 
                  "\[InvisibleSpace]", 
                  TagBox[
                   PaneBox[
                    RowBox[{"Module", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"m234list", ",", "m34list"}], "}"}], ",", 
                    RowBox[{
                    RowBox[{"m234list", "=", 
                    RowBox[{"RandomReal", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"m2", "+", "m3", "+", "m4"}], ",", 
                    RowBox[{"m", "-", "m1"}]}], "}"}], ",", "Nevents"}], 
                    "]"}]}], ";", 
                    RowBox[{"m34list", "=", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"RandomReal", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"m3", "+", "m4"}], ",", 
                    RowBox[{
                    
                    RowBox[{"m234list", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}], "-", "m2"}]}], "}"}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "1", ",", 
                    RowBox[{"Length", "[", "m234list", "]"}], ",", "1"}], 
                    "}"}]}], "]"}]}], ";", 
                    TemplateBox[{
                    RowBox[{"{", 
                    RowBox[{"m234list", ",", "m34list"}], "}"}]}, "Transpose",
                     SyntaxForm -> SuperscriptBox]}]}], "]"}], 
                    ImageSize -> {{1, 500}, Automatic}, BaselinePosition -> 
                    Baseline, ContentPadding -> False, FrameMargins -> 0, 
                    StripOnInput -> True], "SummaryItem"]}]}}, 
              GridBoxAlignment -> {
               "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
              False, GridBoxItemSize -> {
               "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
              GridBoxSpacings -> {
               "Columns" -> {{2}}, "Rows" -> {{Automatic}}}, 
              BaseStyle -> {
               ShowStringCharacters -> False, NumberMarks -> False, 
                PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
           GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
           AutoDelete -> False, 
           GridBoxItemSize -> {
            "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
           BaselinePosition -> {1, 1}]}, 
        Dynamic[Typeset`open$$], ImageSize -> Automatic]},
      "SummaryPanel"],
     DynamicModuleValues:>{}], "]"}],
   CompiledFunction[{11, 14.2, 5464}, {
     Blank[Real], 
     Blank[Real], 
     Blank[Real], 
     Blank[Real], 
     Blank[Real], 
     Blank[Integer]}, {{3, 0, 0}, {3, 0, 1}, {3, 0, 2}, {3, 0, 3}, {3, 0, 
    4}, {2, 0, 0}, {3, 2, 3}}, {{0, {2, 0, 5}}, {1, {2, 0, 1}}}, {0, 7, 9, 0, 
    4}, {{34, 1, 1, 0, 2, 0}, {13, 2, 3, 4, 5}, {19, 1, 6}, {13, 0, 6, 7}, {
     42, "RandomReals", 3, 0, 5, 3, 0, 7, 2, 1, 0, 3, 1, 1}, {33, 1, 3}, {6, 
     5, 4}, {35, 3, 3, 0}, {6, 5, 6}, {3, 7}, {13, 3, 4, 5}, {38, 1, 0, 6, 0, 
     7}, {19, 2, 8}, {13, 7, 8, 7}, {
     42, "RandomReal", 3, 0, 5, 3, 0, 7, 3, 0, 8}, {36, 4, 8, 3, 0}, {4, 6, 
     3, -6}, {34, 1, 2, 1, 0, 0, 2}, {42, "Transpose", 3, 2, 2, 3, 2, 3}, {
     1}}, 
    Function[{$CellContext`m, $CellContext`m1, $CellContext`m2, \
$CellContext`m3, $CellContext`m4, $CellContext`Nevents}, 
     Module[{$CellContext`m234list, $CellContext`m34list}, \
$CellContext`m234list = 
       RandomReal[{$CellContext`m2 + $CellContext`m3 + $CellContext`m4, \
$CellContext`m - $CellContext`m1}, $CellContext`Nevents]; \
$CellContext`m34list = Table[
         RandomReal[{$CellContext`m3 + $CellContext`m4, 
           Part[$CellContext`m234list, $CellContext`i] - $CellContext`m2}], \
{$CellContext`i, 1, 
          Length[$CellContext`m234list], 1}]; 
      Transpose[{$CellContext`m234list, $CellContext`m34list}]]], Evaluate, 
    LibraryFunction[
    "C:\\Users\\miksi\\AppData\\Roaming\\Wolfram\\ApplicationData\\\
CCompilerDriver\\BuildFolder\\maksym-14516\\compiledFunction29.dll", 
     "compiledFunction29", {{Real, 0, "Constant"}, {Real, 0, "Constant"}, {
      Real, 0, "Constant"}, {Real, 0, "Constant"}, {Real, 0, "Constant"}, {
      Integer, 0, "Constant"}}, {Real, 2}]],
   Editable->False,
   SelectWithContents->True,
   Selectable->False], TraditionalForm]], "Output",
 CellChangeTimes->{3.9311545581931257`*^9, 3.952753743325741*^9},
 CellTags->"Evaluation",
 CellLabel->
  "Out[1366]=",ExpressionUUID->"f51f4622-8b66-ab4b-a370-6b53a989d76b"],

Cell[BoxData[
 FormBox[
  InterpretationBox[
   RowBox[{
    TagBox["CompiledFunction",
     "SummaryHead"], "[", 
    DynamicModuleBox[{Typeset`open$$ = False, Typeset`embedState$$ = "Ready"}, 
     TemplateBox[{
       PaneSelectorBox[{False -> GridBox[{{
             PaneBox[
              ButtonBox[
               DynamicBox[
                FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxOpener"]], 
               ButtonFunction :> (Typeset`open$$ = True), Appearance -> None, 
               BaseStyle -> {}, Evaluator -> Automatic, Method -> 
               "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
              Dynamic[{
                Automatic, 
                 3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                  Magnification])}]], 
             GraphicsBox[{
               Thickness[0.038461538461538464`], {
                FaceForm[{
                  GrayLevel[0.93], 
                  Opacity[1.]}], 
                
                FilledCurveBox[{{{1, 4, 3}, {0, 1, 0}, {1, 3, 3}, {0, 1, 0}, {
                 1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {0, 1, 0}}}, {{{
                 25.499999999999996`, 2.5}, {25.499999999999996`, 
                 1.3953100000000003`}, {24.604699999999998`, 
                 0.49999999999999994`}, {23.5, 0.49999999999999994`}, {2.5, 
                 0.49999999999999994`}, {1.3953100000000003`, 
                 0.49999999999999994`}, {0.49999999999999994`, 
                 1.3953100000000003`}, {0.49999999999999994`, 2.5}, {
                 0.49999999999999994`, 23.5}, {0.49999999999999994`, 
                 24.604699999999998`}, {1.3953100000000003`, 
                 25.499999999999996`}, {2.5, 25.499999999999996`}, {23.5, 
                 25.499999999999996`}, {24.604699999999998`, 
                 25.499999999999996`}, {25.499999999999996`, 
                 24.604699999999998`}, {25.499999999999996`, 23.5}, {
                 25.499999999999996`, 2.5}}}]}, {
                FaceForm[{
                  RGBColor[0.5, 0.5, 0.5], 
                  Opacity[1.]}], 
                
                FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {
                 0, 1, 0}, {0, 1, 0}, {0, 1, 0}}}, {{{20.5426, 
                 19.116799999999998`}, {16.3832, 21.876199999999997`}, {
                 16.3832, 20.021499999999996`}, {6.930469999999999, 
                 20.021499999999996`}, {6.930469999999999, 
                 18.212100000000003`}, {16.3832, 18.212100000000003`}, {
                 16.3832, 16.357399999999995`}, {20.5426, 
                 19.116799999999998`}}}], 
                
                FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {
                 0, 1, 0}, {0, 1, 0}, {0, 1, 0}}}, {{{5.30508, 13.8391}, {
                 9.46445, 11.079700000000003`}, {9.46445, 
                 12.933999999999997`}, {18.917199999999998`, 
                 12.933999999999997`}, {18.917199999999998`, 14.7438}, {
                 9.46445, 14.7438}, {9.46445, 16.598}, {5.30508, 13.8391}}}], 
                
                FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {
                 0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
                 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {
                 1, 3, 3}, {1, 3, 3}, {1, 3, 3}}}, CompressedData["
1:eJxTTMoPSmVmYGBgBGJjIGYCYq4u+eR3VWoOxhkv5j+Qk3SA8fu/r5rKOVHM
Yd2vmNyjZ9Qcrt9QXbW9S8RBg59767IidQcPMYPGaHFhB+Nn61SfiGo4xBwp
T7o2V9Dh0Iolfg6/NBxEHv/x1Xgi4FB1XNNqkqQWnP+axUTQjFkbzn+oO2HB
j/3aDg/Xn5T6WiDoYLs3aJpiqI7DrHN+bO6tQg4zfUR7vF7pQOyfIQyRd9d1
WLL0U1kLoyjEPdm6DpoTXfQX7xBzKPjQejLkhDacL5J4+LL2Gm2HtNnSl4Vf
iELM69J2qPZM3tLnJerQX1oozZugDfHPUxGI/4W1HQ5p3TthoyDi4D7lG1v8
Mi2HgqL9zoEHhB1inOxe3BRG8MH62zXhfIbN1Z82CGhC/GMg4nCm3mN/7TYN
iHlCUPdGakDc/1kUEr46GhD/eYnD+d9iBf/kC0vC+TuCrSL+X5Vy2HGR4R5T
uAbEfxYykPBYp+HQqsCuesZAFhL+rJoQ/2rIQdxTpwkJ7yVycPfD+GDzVqLx
xbUd5HYt2JfqBdWfpA2Jj9mykPDpgYaXtaxDy7yzq86vg8qvlIHE5ylY/Eo7
XAt7o787TxfOB5ufqesQ9PbyxxkPZSDhZ6nrMAGU3u7LQtLLEx2HN2253UbX
ofZ76jis/Pay4oynAsT8QG0HKZMv/gW7FCDyTFpwPsz/MD44/Mw1HFjb1uR9
TVVwWKy880/7FHWIexrkIfLX1RzOMDZZVjHIOaDkh3vSDuj5AwCF11Vc
                 "]]}}, Background -> GrayLevel[0.93], Axes -> False, 
              AspectRatio -> 1, ImageSize -> 
              Dynamic[{
                Automatic, 
                 3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                  Magnification])}], Frame -> True, FrameTicks -> None, 
              FrameStyle -> Directive[
                Thickness[Tiny], 
                GrayLevel[0.7]]], 
             GridBox[{{
                RowBox[{
                  TagBox["\"Argument count: \"", "SummaryItemAnnotation"], 
                  "\[InvisibleSpace]", 
                  TagBox["6", "SummaryItem"]}]}, {
                RowBox[{
                  TagBox["\"Argument types: \"", "SummaryItemAnnotation"], 
                  "\[InvisibleSpace]", 
                  TagBox[
                   StyleBox[
                    PaneBox[
                    RowBox[{"{", 
                    
                    RowBox[{
                    "_Real", ",", "_Real", ",", "_Real", ",", "_Real", ",", 
                    "_Real", ",", 
                    RowBox[{"{", 
                    RowBox[{"_Real", ",", "1"}], "}"}]}], "}"}], 
                    ContentPadding -> False, FrameMargins -> 0, StripOnInput -> 
                    True, BaselinePosition -> Baseline, 
                    ImageSize -> {{1, 300}, Automatic}], LineBreakWithin -> 
                    False], "SummaryItem"]}]}}, 
              GridBoxAlignment -> {
               "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
              False, GridBoxItemSize -> {
               "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
              GridBoxSpacings -> {
               "Columns" -> {{2}}, "Rows" -> {{Automatic}}}, 
              BaseStyle -> {
               ShowStringCharacters -> False, NumberMarks -> False, 
                PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
           GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
           AutoDelete -> False, 
           GridBoxItemSize -> {
            "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
           BaselinePosition -> {1, 1}], True -> GridBox[{{
             PaneBox[
              ButtonBox[
               DynamicBox[
                FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxCloser"]], 
               ButtonFunction :> (Typeset`open$$ = False), Appearance -> None,
                BaseStyle -> {}, Evaluator -> Automatic, Method -> 
               "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
              Dynamic[{
                Automatic, 
                 3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                  Magnification])}]], 
             GraphicsBox[{
               Thickness[0.038461538461538464`], {
                FaceForm[{
                  GrayLevel[0.93], 
                  Opacity[1.]}], 
                
                FilledCurveBox[{{{1, 4, 3}, {0, 1, 0}, {1, 3, 3}, {0, 1, 0}, {
                 1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {0, 1, 0}}}, {{{
                 25.499999999999996`, 2.5}, {25.499999999999996`, 
                 1.3953100000000003`}, {24.604699999999998`, 
                 0.49999999999999994`}, {23.5, 0.49999999999999994`}, {2.5, 
                 0.49999999999999994`}, {1.3953100000000003`, 
                 0.49999999999999994`}, {0.49999999999999994`, 
                 1.3953100000000003`}, {0.49999999999999994`, 2.5}, {
                 0.49999999999999994`, 23.5}, {0.49999999999999994`, 
                 24.604699999999998`}, {1.3953100000000003`, 
                 25.499999999999996`}, {2.5, 25.499999999999996`}, {23.5, 
                 25.499999999999996`}, {24.604699999999998`, 
                 25.499999999999996`}, {25.499999999999996`, 
                 24.604699999999998`}, {25.499999999999996`, 23.5}, {
                 25.499999999999996`, 2.5}}}]}, {
                FaceForm[{
                  RGBColor[0.5, 0.5, 0.5], 
                  Opacity[1.]}], 
                
                FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {
                 0, 1, 0}, {0, 1, 0}, {0, 1, 0}}}, {{{20.5426, 
                 19.116799999999998`}, {16.3832, 21.876199999999997`}, {
                 16.3832, 20.021499999999996`}, {6.930469999999999, 
                 20.021499999999996`}, {6.930469999999999, 
                 18.212100000000003`}, {16.3832, 18.212100000000003`}, {
                 16.3832, 16.357399999999995`}, {20.5426, 
                 19.116799999999998`}}}], 
                
                FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {
                 0, 1, 0}, {0, 1, 0}, {0, 1, 0}}}, {{{5.30508, 13.8391}, {
                 9.46445, 11.079700000000003`}, {9.46445, 
                 12.933999999999997`}, {18.917199999999998`, 
                 12.933999999999997`}, {18.917199999999998`, 14.7438}, {
                 9.46445, 14.7438}, {9.46445, 16.598}, {5.30508, 13.8391}}}], 
                
                FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {
                 0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
                 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {
                 1, 3, 3}, {1, 3, 3}, {1, 3, 3}}}, CompressedData["
1:eJxTTMoPSmVmYGBgBGJjIGYCYq4u+eR3VWoOxhkv5j+Qk3SA8fu/r5rKOVHM
Yd2vmNyjZ9Qcrt9QXbW9S8RBg59767IidQcPMYPGaHFhB+Nn61SfiGo4xBwp
T7o2V9Dh0Iolfg6/NBxEHv/x1Xgi4FB1XNNqkqQWnP+axUTQjFkbzn+oO2HB
j/3aDg/Xn5T6WiDoYLs3aJpiqI7DrHN+bO6tQg4zfUR7vF7pQOyfIQyRd9d1
WLL0U1kLoyjEPdm6DpoTXfQX7xBzKPjQejLkhDacL5J4+LL2Gm2HtNnSl4Vf
iELM69J2qPZM3tLnJerQX1oozZugDfHPUxGI/4W1HQ5p3TthoyDi4D7lG1v8
Mi2HgqL9zoEHhB1inOxe3BRG8MH62zXhfIbN1Z82CGhC/GMg4nCm3mN/7TYN
iHlCUPdGakDc/1kUEr46GhD/eYnD+d9iBf/kC0vC+TuCrSL+X5Vy2HGR4R5T
uAbEfxYykPBYp+HQqsCuesZAFhL+rJoQ/2rIQdxTpwkJ7yVycPfD+GDzVqLx
xbUd5HYt2JfqBdWfpA2Jj9mykPDpgYaXtaxDy7yzq86vg8qvlIHE5ylY/Eo7
XAt7o787TxfOB5ufqesQ9PbyxxkPZSDhZ6nrMAGU3u7LQtLLEx2HN2253UbX
ofZ76jis/Pay4oynAsT8QG0HKZMv/gW7FCDyTFpwPsz/MD44/Mw1HFjb1uR9
TVVwWKy880/7FHWIexrkIfLX1RzOMDZZVjHIOaDkh3vSDuj5AwCF11Vc
                 "]]}}, Background -> GrayLevel[0.93], Axes -> False, 
              AspectRatio -> 1, ImageSize -> 
              Dynamic[{
                Automatic, 
                 3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                  Magnification])}], Frame -> True, FrameTicks -> None, 
              FrameStyle -> Directive[
                Thickness[Tiny], 
                GrayLevel[0.7]]], 
             GridBox[{{
                RowBox[{
                  TagBox["\"Argument count: \"", "SummaryItemAnnotation"], 
                  "\[InvisibleSpace]", 
                  TagBox["6", "SummaryItem"]}]}, {
                RowBox[{
                  TagBox["\"Argument types: \"", "SummaryItemAnnotation"], 
                  "\[InvisibleSpace]", 
                  TagBox[
                   PaneBox[
                    RowBox[{"{", 
                    
                    RowBox[{
                    "_Real", ",", "_Real", ",", "_Real", ",", "_Real", ",", 
                    "_Real", ",", 
                    RowBox[{"{", 
                    RowBox[{"_Real", ",", "1"}], "}"}]}], "}"}], 
                    ImageSize -> {{1, 500}, Automatic}, BaselinePosition -> 
                    Baseline, ContentPadding -> False, FrameMargins -> 0, 
                    StripOnInput -> True], "SummaryItem"]}]}, {
                RowBox[{
                  TagBox["\"Variables: \"", "SummaryItemAnnotation"], 
                  "\[InvisibleSpace]", 
                  TagBox[
                   RowBox[{"{", 
                    
                    RowBox[{
                    "m", ",", "m1", ",", "m2", ",", "m3", ",", "m4", ",", 
                    "falserandmass"}], "}"}], "SummaryItem"]}]}, {
                RowBox[{
                  TagBox["\"Expression: \"", "SummaryItemAnnotation"], 
                  "\[InvisibleSpace]", 
                  TagBox[
                   PaneBox[
                    RowBox[{"Block", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    
                    RowBox[{
                    "Compile`$115", ",", "Compile`$116", ",", "Compile`$120", 
                    ",", "Compile`$103", ",", "Compile`$135", ",", 
                    "Compile`$143", ",", "Compile`$134", ",", "Compile`$179", 
                    ",", "Compile`$183"}], "}"}], ",", 
                    RowBox[{"Module", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"m234", ",", "m34"}], "}"}], ",", 
                    RowBox[{
                    RowBox[{"m234", "=", 
                    RowBox[{"Compile`GetElement", "(", 
                    RowBox[{"falserandmass", ",", "1"}], ")"}]}], ";", 
                    RowBox[{"m34", "=", 
                    RowBox[{"Compile`GetElement", "(", 
                    RowBox[{"falserandmass", ",", "2"}], ")"}]}], ";", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Compile`$115", "=", 
                    SuperscriptBox["m", "2"]}], ";", 
                    RowBox[{"Compile`$116", "=", 
                    SuperscriptBox["m1", "2"]}], ";", 
                    RowBox[{"Compile`$120", "=", 
                    SuperscriptBox["m234", "2"]}], ";", 
                    RowBox[{"Compile`$103", "=", 
                    SuperscriptBox["m234", "4"]}], ";", 
                    RowBox[{"Compile`$135", "=", 
                    SuperscriptBox["m2", "2"]}], ";", 
                    RowBox[{"Compile`$143", "=", 
                    SuperscriptBox["m34", "2"]}], ";", 
                    RowBox[{"Compile`$134", "=", 
                    SuperscriptBox["m34", "4"]}], ";", 
                    RowBox[{"Compile`$179", "=", 
                    SuperscriptBox["m3", "2"]}], ";", 
                    RowBox[{"Compile`$183", "=", 
                    SuperscriptBox["m4", "2"]}], ";", 
                    FractionBox[
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"m2"}]}], "+", "m234", "-", "m3", "-", "m4"}], 
                    ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    SqrtBox[
                    RowBox[{"Compile`$103", "-", 
                    RowBox[{"2", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Compile`$115", " ", "Compile`$116"}], "+", 
                    RowBox[{"Compile`$115", " ", "Compile`$120"}], "+", 
                    RowBox[{"Compile`$116", " ", "Compile`$120"}]}], ")"}]}], 
                    "+", 
                    SuperscriptBox["m", "4"], "+", 
                    SuperscriptBox["m1", "4"]}]], " ", 
                    SqrtBox[
                    RowBox[{"Compile`$103", "-", 
                    RowBox[{"2", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Compile`$120", " ", "Compile`$135"}], "+", 
                    RowBox[{"Compile`$120", " ", "Compile`$143"}], "+", 
                    RowBox[{"Compile`$135", " ", "Compile`$143"}]}], ")"}]}], 
                    "+", "Compile`$134", "+", 
                    SuperscriptBox["m2", "4"]}]], " ", 
                    SqrtBox[
                    RowBox[{"Compile`$134", "-", 
                    RowBox[{"2", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Compile`$143", " ", "Compile`$179"}], "+", 
                    RowBox[{"Compile`$143", " ", "Compile`$183"}], "+", 
                    RowBox[{"Compile`$179", " ", "Compile`$183"}]}], ")"}]}], 
                    "+", 
                    SuperscriptBox["m3", "4"], "+", 
                    SuperscriptBox["m4", "4"]}]]}], ")"}]}], 
                    RowBox[{"8", " ", "m", " ", "m234", " ", "m34"}]]}], 
                    ")"}]}]}], "]"}]}], "]"}], 
                    ImageSize -> {{1, 500}, Automatic}, BaselinePosition -> 
                    Baseline, ContentPadding -> False, FrameMargins -> 0, 
                    StripOnInput -> True], "SummaryItem"]}]}}, 
              GridBoxAlignment -> {
               "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
              False, GridBoxItemSize -> {
               "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
              GridBoxSpacings -> {
               "Columns" -> {{2}}, "Rows" -> {{Automatic}}}, 
              BaseStyle -> {
               ShowStringCharacters -> False, NumberMarks -> False, 
                PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
           GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
           AutoDelete -> False, 
           GridBoxItemSize -> {
            "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
           BaselinePosition -> {1, 1}]}, 
        Dynamic[Typeset`open$$], ImageSize -> Automatic]},
      "SummaryPanel"],
     DynamicModuleValues:>{}], "]"}],
   CompiledFunction[{11, 14.2, 5848}, {
     Blank[Real], 
     Blank[Real], 
     Blank[Real], 
     Blank[Real], 
     Blank[Real], {
      Blank[Real], 1}}, {{3, 0, 0}, {3, 0, 1}, {3, 0, 2}, {3, 0, 3}, {3, 0, 
    4}, {3, 1, 0}, {3, 0, 
    19}}, {{-2, {2, 0, 3}}, {0.125, {3, 0, 20}}, {2, {2, 0, 1}}, {
     1, {2, 0, 0}}, {4, {2, 0, 2}}}, {0, 4, 28, 0, 
    1}, {{37, 0, 0, 3, 5}, {37, 0, 1, 3, 6}, {40, 56, 3, 0, 0, 3, 0, 7}, {40, 
     56, 3, 0, 1, 3, 0, 8}, {40, 56, 3, 0, 5, 3, 0, 9}, {41, 263, 3, 0, 5, 2, 
     0, 2, 3, 0, 10}, {40, 56, 3, 0, 2, 3, 0, 11}, {40, 56, 3, 0, 6, 3, 0, 
     12}, {41, 263, 3, 0, 6, 2, 0, 2, 3, 0, 13}, {40, 56, 3, 0, 3, 3, 0, 
     14}, {40, 56, 3, 0, 4, 3, 0, 15}, {19, 2, 16}, {19, 3, 17}, {19, 4, 
     18}, {13, 5, 16, 17, 18, 19}, {40, 60, 3, 0, 0, 3, 0, 17}, {40, 60, 3, 0,
      5, 3, 0, 18}, {41, 263, 3, 0, 0, 2, 0, 2, 3, 0, 16}, {41, 263, 3, 0, 1, 
     2, 0, 2, 3, 0, 21}, {16, 7, 8, 22}, {16, 7, 9, 23}, {16, 8, 9, 24}, {13, 
     22, 23, 24, 22}, {10, 3, 23}, {16, 23, 22, 23}, {13, 16, 21, 10, 23, 
     16}, {40, 57, 3, 0, 16, 3, 0, 21}, {40, 60, 3, 0, 6, 3, 0, 16}, {41, 263,
      3, 0, 2, 2, 0, 2, 3, 0, 23}, {16, 11, 9, 22}, {16, 11, 12, 24}, {16, 9, 
     12, 25}, {13, 22, 24, 25, 22}, {10, 3, 24}, {16, 24, 22, 24}, {13, 23, 
     10, 13, 24, 23}, {40, 57, 3, 0, 23, 3, 0, 24}, {41, 263, 3, 0, 3, 2, 0, 
     2, 3, 0, 23}, {41, 263, 3, 0, 4, 2, 0, 2, 3, 0, 22}, {16, 14, 12, 25}, {
     16, 14, 15, 26}, {16, 12, 15, 27}, {13, 25, 26, 27, 25}, {10, 3, 26}, {
     16, 26, 25, 26}, {13, 23, 13, 22, 26, 23}, {40, 57, 3, 0, 23, 3, 0, 
     22}, {16, 20, 17, 18, 21, 16, 24, 22, 23}, {16, 19, 23, 19}, {1}}, 
    Function[{$CellContext`m, $CellContext`m1, $CellContext`m2, \
$CellContext`m3, $CellContext`m4, $CellContext`falserandmass}, 
     Block[{
      Compile`$115, Compile`$116, Compile`$120, Compile`$103, Compile`$135, 
       Compile`$143, Compile`$134, Compile`$179, Compile`$183}, 
      Module[{$CellContext`m234, $CellContext`m34}, $CellContext`m234 = 
        Compile`GetElement[$CellContext`falserandmass, 1]; $CellContext`m34 = 
        Compile`GetElement[$CellContext`falserandmass, 2]; (
        Compile`$115 = $CellContext`m^2; Compile`$116 = $CellContext`m1^2; 
        Compile`$120 = $CellContext`m234^2; 
        Compile`$103 = $CellContext`m234^4; Compile`$135 = $CellContext`m2^2; 
        Compile`$143 = $CellContext`m34^2; Compile`$134 = $CellContext`m34^4; 
        Compile`$179 = $CellContext`m3^2; 
        Compile`$183 = $CellContext`m4^2; ($CellContext`m234 - \
$CellContext`m2 - $CellContext`m3 - $CellContext`m4) (
          Rational[
           1, 8] $CellContext`m^(-1) $CellContext`m234^(-1) ($CellContext`m^4 + \
$CellContext`m1^4 + Compile`$103 - 
            2 (Compile`$115 Compile`$116 + Compile`$115 Compile`$120 + 
             Compile`$116 Compile`$120))^
           Rational[1, 2] $CellContext`m34^(-1) ($CellContext`m2^4 + 
            Compile`$103 + Compile`$134 - 
            2 (Compile`$135 Compile`$120 + Compile`$135 Compile`$143 + 
             Compile`$120 Compile`$143))^
           Rational[1, 2] ($CellContext`m3^4 + 
            Compile`$134 + $CellContext`m4^4 - 
            2 (Compile`$179 Compile`$143 + Compile`$179 Compile`$183 + 
             Compile`$143 Compile`$183))^Rational[1, 2]))]], Listable], 
    Evaluate, 
    LibraryFunction[
    "C:\\Users\\miksi\\AppData\\Roaming\\Wolfram\\ApplicationData\\\
CCompilerDriver\\BuildFolder\\maksym-14516\\compiledFunction30.dll", 
     "compiledFunction30", {{Real, 0, "Constant"}, {Real, 0, "Constant"}, {
      Real, 0, "Constant"}, {Real, 0, "Constant"}, {Real, 0, "Constant"}, {
      Real, 1, "Constant"}}, Real]],
   Editable->False,
   SelectWithContents->True,
   Selectable->False], TraditionalForm]], "Output",
 CellChangeTimes->{3.9311545581931257`*^9, 3.952753744995407*^9},
 CellTags->"Evaluation",
 CellLabel->
  "Out[1367]=",ExpressionUUID->"ebdd1b3f-b9ec-c748-8555-e12f88ce039c"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Final block producing phase space", "Subsubsection",
 CellChangeTimes->{{3.8928229417684107`*^9, 3.892822942070283*^9}, {
  3.892827781047364*^9, 3.8928277927015176`*^9}},
 CellTags->
  "Evaluation",ExpressionUUID->"3fee3c3d-15a9-4e05-a3de-42363dd61dcd"],

Cell[BoxData[
 RowBox[{
  RowBox[{"FourBodyDecaysEventsAtRest", "[", 
   RowBox[{
   "m_", ",", "product1_", ",", "product2_", ",", "product3_", ",", 
    "product4_", ",", "Nevents_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
     "List", " ", "of", " ", "pdg", " ", "products", " ", "involving", " ", 
      "in", " ", "the", " ", 
      RowBox[{"decay", ".", " ", "The"}], " ", "\"\<Intermediate\>\"", " ", 
      "products", " ", "correspond", " ", "to", " ", "the", " ", "fake", " ", 
      "234", " ", "and", " ", "34", " ", "particles"}], "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"pdglist", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"ParamProductToPDGid", "[", "product1", "]"}], ",", 
        RowBox[{"ParamProductToPDGid", "[", "\"\<Intermediate\>\"", "]"}], ",", 
        RowBox[{"ParamProductToPDGid", "[", "product2", "]"}], ",", 
        RowBox[{"ParamProductToPDGid", "[", "\"\<Intermediate\>\"", "]"}], ",", 
        RowBox[{"ParamProductToPDGid", "[", "product3", "]"}], ",", 
        RowBox[{"ParamProductToPDGid", "[", "product4", "]"}]}], "}"}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"Masses", ",", " ", 
       RowBox[{"electric", " ", "charges"}], ",", " ", 
       RowBox[{
       "and", " ", "stabilities", " ", "of", " ", "true", " ", "decay", " ", 
        "products"}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"finalproductmasses", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"ParamProductMass", "[", "#", "]"}], "&"}], "/@", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"pdglist", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", 
         RowBox[{"pdglist", "[", 
          RowBox[{"[", "3", "]"}], "]"}], ",", 
         RowBox[{"pdglist", "[", 
          RowBox[{"[", "5", "]"}], "]"}], ",", 
         RowBox[{"pdglist", "[", 
          RowBox[{"[", "6", "]"}], "]"}]}], "}"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"qlist", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"ParamProductCharge", "[", "#", "]"}], "&"}], "/@", 
       "pdglist"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"stabilitylist", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"ParamProductStability", "[", "#", "]"}], "&"}], "/@", 
       "pdglist"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Values", " ", "of", " ", "invariant", " ", "masses", " ", 
        SubscriptBox["m", "234"]}], ",", " ", 
       SubscriptBox["m", "34"]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"randommasses", "=", 
      RowBox[{"BlockTrueRandomMasses", "[", 
       RowBox[{"m", ",", 
        RowBox[{"finalproductmasses", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", 
        RowBox[{"finalproductmasses", "[", 
         RowBox[{"[", "2", "]"}], "]"}], ",", 
        RowBox[{"finalproductmasses", "[", 
         RowBox[{"[", "3", "]"}], "]"}], ",", 
        RowBox[{"finalproductmasses", "[", 
         RowBox[{"[", "4", "]"}], "]"}], ",", "Nevents"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"The", " ", "matrix", " ", "m"}], ",", " ", 
       SubscriptBox["m", "product1"], ",", 
       SubscriptBox["m", "234"], ",", 
       SubscriptBox["m", "product2"], ",", 
       SubscriptBox["m", "34"], ",", 
       SubscriptBox["m", "product3"], ",", 
       SubscriptBox["m", "product4"]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"mmatrix", "=", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"m", ",", 
            RowBox[{"finalproductmasses", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", "Nevents"}], "]"}],
         ",", 
        RowBox[{"randommasses", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", 
           RowBox[{"{", "1", "}"}]}], "]"}], "]"}], ",", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"finalproductmasses", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "}"}], ",", "Nevents"}], "]"}], ",", 
        RowBox[{"randommasses", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", 
           RowBox[{"{", "2", "}"}]}], "]"}], "]"}], ",", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"finalproductmasses", "[", 
             RowBox[{"[", "3", "]"}], "]"}], ",", 
            RowBox[{"finalproductmasses", "[", 
             RowBox[{"[", "4", "]"}], "]"}]}], "}"}], ",", "Nevents"}], "]"}],
         ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{
        RowBox[{
        "Producing", " ", "the", " ", "phase", " ", "space", " ", "of", " ", 
         "fake", " ", "2"}], "-", 
        RowBox[{"body", " ", "decays", " ", "234"}]}], "->", 
       RowBox[{
        RowBox[{"2", "+", 
         RowBox[{"34", " ", "and", " ", "34"}]}], "->", 
        RowBox[{"3", "+", 
         RowBox[{
         "4", " ", "at", " ", "rest", " ", "of", " ", "234", " ", "and", " ", 
          "34"}]}]}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"phasespacerest", "[", "ival", "]"}], "=", 
        RowBox[{"nVectorParticlesIntermediate", "[", 
         RowBox[{
         "mmatrix", ",", "stabilitylist", ",", "qlist", ",", "pdglist", ",", 
          "ival"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"ival", ",", "1", ",", "3", ",", "1"}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "Boosting", " ", "them", " ", "according", " ", "to", " ", "the", " ", 
       "lab", " ", "frames"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"phasespaceboosted2", "=", 
      RowBox[{"TabBoostedDecayProducts", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"phasespacerest", "[", "1", "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", 
           RowBox[{"LengthDataProduct", "+", 
            RowBox[{"Range", "[", 
             RowBox[{"1", ",", "LengthDataProduct"}], "]"}]}]}], "]"}], "]"}],
         ",", 
        RowBox[{"phasespacerest", "[", "2", "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"phasespaceboosted3", "=", 
      RowBox[{"TabBoostedDecayProducts", "[", 
       RowBox[{
        RowBox[{"phasespaceboosted2", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", 
           RowBox[{"LengthDataProduct", "+", 
            RowBox[{"Range", "[", 
             RowBox[{"1", ",", "LengthDataProduct"}], "]"}]}]}], "]"}], "]"}],
         ",", 
        RowBox[{"phasespacerest", "[", "3", "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"phasespacerest", "[", "1", "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", 
          RowBox[{"Range", "[", 
           RowBox[{"1", ",", "LengthDataProduct"}], "]"}]}], "]"}], "]"}], ",", 
       RowBox[{"phasespaceboosted2", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", 
          RowBox[{"Range", "[", 
           RowBox[{"1", ",", "LengthDataProduct"}], "]"}]}], "]"}], "]"}], ",",
        "phasespaceboosted3", ",", "2"}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{
  3.892822094060907*^9, {3.8928222573471985`*^9, 3.8928222938912797`*^9}, {
   3.8928225899578075`*^9, 3.8928228273275976`*^9}, {3.8928231639640007`*^9, 
   3.8928231803232417`*^9}, {3.8928232619212523`*^9, 
   3.8928233384958878`*^9}, {3.8928233721380205`*^9, 3.892823662875577*^9}, {
   3.8928240369852176`*^9, 3.8928240638237314`*^9}, {3.8928242280402436`*^9, 
   3.892824309458559*^9}, {3.892824431393654*^9, 3.892824479247761*^9}, {
   3.8928245314917526`*^9, 3.892824578933576*^9}, {3.89282539019839*^9, 
   3.8928253997776875`*^9}, {3.8928254343070464`*^9, 3.892825501610352*^9}, {
   3.8928262303140693`*^9, 3.8928262844328785`*^9}, {3.89282665609322*^9, 
   3.8928266830803576`*^9}, {3.8928270226056356`*^9, 3.892827030913838*^9}, 
   3.8928271300835094`*^9, 3.8928277944729805`*^9, {3.892828112515127*^9, 
   3.892828115598604*^9}, {3.8928723169870086`*^9, 3.892872317137663*^9}, {
   3.916127097067466*^9, 3.91612715868806*^9}, {3.9161274638912697`*^9, 
   3.916127589208093*^9}, {3.9161556101071978`*^9, 3.9161556733478794`*^9}, 
   3.9161557221301346`*^9},
 CellTags->"Evaluation",
 CellLabel->
  "In[1369]:=",ExpressionUUID->"b2f4900b-827c-4976-b8c1-1b51fe33c28e"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Decay of LLPs into stable particles", "Section",
 CellChangeTimes->{{3.931157843955039*^9, 3.9311578521014605`*^9}, {
  3.9311595797213235`*^9, 3.9311595810355415`*^9}, {3.9311596581245165`*^9, 
  3.931159658439028*^9}},ExpressionUUID->"f836d394-38e6-4a29-8425-\
e04f94fef133"],

Cell[CellGroupData[{

Cell["Particular decay channel - decays at rest", "Subsection",
 CellChangeTimes->{{3.8896810686474667`*^9, 3.8896810893992004`*^9}, 
   3.889681420224794*^9, 3.915437187122603*^9, {3.9311587912754197`*^9, 
   3.931158798341329*^9}, {3.9311595846595936`*^9, 3.9311595875393844`*^9}, {
   3.9311596597412558`*^9, 3.93115966216289*^9}},
 CellTags->
  "Evaluation",ExpressionUUID->"7a589ffb-6558-4d19-8b47-515193e2454e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"topology", "[", "2", "]"}], ",", 
     RowBox[{"topology", "[", "3", "]"}], ",", 
     RowBox[{"topology", "[", "4", "]"}]}], "}"}], "=", 
   RowBox[{"{", 
    RowBox[{"\"\<2-body\>\"", ",", "\"\<3-body\>\"", ",", "\"\<4-body\>\""}], 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NeventsSplitted", "[", 
   RowBox[{"Nev_", ",", "\[Omega]list_"}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"NevTemp", "=", 
      RowBox[{"IntegerPart", "[", 
       FractionBox[
        RowBox[{"Nev", "*", "\[Omega]list"}], 
        RowBox[{"\[Omega]list", "//", "Total"}]], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"PosMax", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Position", "[", 
         RowBox[{"NevTemp", ",", 
          RowBox[{"Max", "[", "NevTemp", "]"}]}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"NevTemp", "[", 
       RowBox[{"[", "PosMax", "]"}], "]"}], "+=", 
      RowBox[{"Nev", "-", 
       RowBox[{"Total", "[", "NevTemp", "]"}]}]}], ";", "\[IndentingNewLine]",
      "NevTemp"}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
  "PhaseSpaceStableFromUnstableBlock", "[", "DataUnstableAtLLPrestFrame_", 
   "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"pdgprod", "=", 
      RowBox[{
       RowBox[{"DataUnstableAtLLPrestFrame", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "[", 
       RowBox[{"[", "indexpdg1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"massUnstableDecayProduct", "=", 
      RowBox[{
       RowBox[{"DataUnstableAtLLPrestFrame", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "[", 
       RowBox[{"[", "indexm1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"UnstableDecayProduct", "=", 
      RowBox[{"ParamPDGidToProduct", "[", "pdgprod", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"DecProcList", "=", 
      RowBox[{
       RowBox[{"Select", "[", 
        RowBox[{"ListSMdecays", ",", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "==", "UnstableDecayProduct"}], 
          "&"}]}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "2"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"DecProdList", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"ListDecayProducts", "[", 
         RowBox[{"UnstableDecayProduct", ",", "#"}], "]"}], "&"}], "/@", 
       "DecProcList"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Omega]list", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"\[Omega]process", "[", 
         RowBox[{"UnstableDecayProduct", ",", "#"}], "]"}], "&"}], "/@", 
       "DecProcList"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"TopologyList", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"topology", "[", 
         RowBox[{"Length", "[", 
          RowBox[{"Select", "[", 
           RowBox[{"#", ",", 
            RowBox[{
             RowBox[{"#", "\[NotEqual]", "\"\<Null\>\""}], "&"}]}], "]"}], 
          "]"}], "]"}], "&"}], "/@", "DecProdList"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"NevList", "=", 
      RowBox[{"NeventsSplitted", "[", 
       RowBox[{
        RowBox[{"Length", "[", "DataUnstableAtLLPrestFrame", "]"}], ",", 
        "\[Omega]list"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"UnstableDecayProductSplitted", "=", 
      RowBox[{"Table", "[", 
       RowBox[{"UnstableDecayProduct", ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "\[Omega]list", "]"}], ",", "1"}], "}"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"phasespace", "=", 
      RowBox[{"{", 
       RowBox[{"{", "}"}], "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"NevList", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "!=", "0."}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"PhaseSpaceUnstableToStableAtUnstableRest", "=", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"TopologyList", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "\[Equal]", "\"\<3-body\>\""}],
              ",", 
             RowBox[{"ThreeBodyDecaysEventsAtRest", "[", 
              RowBox[{"UnstableDecayProduct", ",", 
               RowBox[{"DecProcList", "[", 
                RowBox[{"[", "i", "]"}], "]"}], ",", 
               "massUnstableDecayProduct", ",", 
               RowBox[{"NevList", "[", 
                RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
             RowBox[{"Block2BodyDistrAtRest", "[", 
              RowBox[{"massUnstableDecayProduct", ",", 
               RowBox[{
                RowBox[{"DecProdList", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", 
               RowBox[{
                RowBox[{"DecProdList", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "[", 
                RowBox[{"[", "2", "]"}], "]"}], ",", 
               RowBox[{"NevList", "[", 
                RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"phasespace", "=", 
           RowBox[{"Join", "[", 
            RowBox[{
            "phasespace", ",", "PhaseSpaceUnstableToStableAtUnstableRest"}], 
            "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], 
       "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "\[Omega]list", "]"}], ",", "1"}], "}"}]}], 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"phasespace", "=", 
      RowBox[{
       RowBox[{"Drop", "[", 
        RowBox[{
         RowBox[{"PadRight", "[", 
          RowBox[{"phasespace", ",", "Automatic", ",", 
           RowBox[{"-", "999."}]}], "]"}], ",", "1"}], "]"}], "//", 
       "Developer`ToPackedArray"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"TabBoostedDecayProducts", "[", 
      RowBox[{"DataUnstableAtLLPrestFrame", ",", 
       RowBox[{"RandomSample", "[", "phasespace", "]"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"DecayProductsList", "=", 
      RowBox[{"ListDecayProducts", "[", 
       RowBox[{"UnstableDecayProduct", ",", "SpecificProcessUnstable"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Topology", "=", 
      RowBox[{"topology", "[", 
       RowBox[{"Length", "[", 
        RowBox[{"Select", "[", 
         RowBox[{"DecayProductsList", ",", 
          RowBox[{
           RowBox[{"#", "\[NotEqual]", "\"\<Null\>\""}], "&"}]}], "]"}], 
        "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"PhaseSpaceUnstableToStableAtUnstableRest", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"Topology", "\[Equal]", "\"\<3-body\>\""}], ",", 
        RowBox[{"ThreeBodyDecaysEventsAtRest", "[", 
         RowBox[{
         "UnstableDecayProduct", ",", "SpecificProcessUnstable", ",", 
          "massUnstableDecayProduct", ",", "Nevents"}], "]"}], ",", 
        RowBox[{"Block2BodyDistrAtRest", "[", 
         RowBox[{"massUnstableDecayProduct", ",", 
          RowBox[{"DecayProductsList", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{"DecayProductsList", "[", 
           RowBox[{"[", "2", "]"}], "]"}], ",", "Nevents"}], "]"}]}], "]"}]}],
      ";", "\[IndentingNewLine]", 
     RowBox[{"TabBoostedDecayProducts", "[", 
      RowBox[{
      "DataUnstableAtLLPrestFrame", ",", 
       "PhaseSpaceUnstableToStableAtUnstableRest"}], "]"}]}], "*)"}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{
  3.9120981810942307`*^9, {3.912098723234372*^9, 3.912098945323427*^9}, {
   3.912098991853141*^9, 3.9120989930042286`*^9}, {3.91209941165335*^9, 
   3.9120994198434525`*^9}, {3.912099791074767*^9, 3.9120997950565977`*^9}, {
   3.91209995670325*^9, 3.9121000725257235`*^9}, {3.912100103313548*^9, 
   3.9121001211247077`*^9}, {3.9121003475863533`*^9, 3.912100369400236*^9}, {
   3.9121004001225977`*^9, 3.912100410904463*^9}, {3.912101078414239*^9, 
   3.9121011014951773`*^9}, {3.9121390077788963`*^9, 
   3.9121390561168995`*^9}, {3.9121392538691607`*^9, 3.912139254035003*^9}, {
   3.9121393447654037`*^9, 3.9121393739746747`*^9}, {3.91213946996723*^9, 
   3.912139475696269*^9}, {3.912139531068428*^9, 3.912139561378518*^9}, 
   3.9121449884334354`*^9, {3.914092032326936*^9, 3.9140920884568233`*^9}, {
   3.9140922120812426`*^9, 3.9140922137155647`*^9}, {3.9145764117946205`*^9, 
   3.9145764313517*^9}, {3.915437187128587*^9, 3.9154371871500854`*^9}, 
   3.9161556361586957`*^9, {3.916161663506551*^9, 3.916161665393705*^9}, {
   3.9161633532426453`*^9, 3.9161633532466974`*^9}},
 CellTags->"Evaluation",
 CellLabel->
  "In[1370]:=",ExpressionUUID->"7357c4e0-cb72-437c-b92a-e599f6ea3989"],

Cell[CellGroupData[{

Cell["Final table", "Subsubsection",
 CellChangeTimes->{{3.8896811226502504`*^9, 3.889681124051056*^9}},
 CellTags->
  "Evaluation",ExpressionUUID->"87e0410a-cc80-4c41-8ba8-cf9f615e7f7b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "The", " ", "code", " ", "checking", " ", "whether", " ", "the", " ", 
    "given", " ", "phase", " ", "space", " ", "contains", " ", "unstable", " ",
     "particles"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"stabilitycheck", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"Hold", "@", 
        RowBox[{"Compile", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"{", 
            RowBox[{"data", ",", "_Real", ",", "1"}], "}"}], "}"}], ",", 
          RowBox[{"Module", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"len", "=", 
               RowBox[{
                RowBox[{"Length", "[", "data", "]"}], "/", 
                "LengthDataProduct"}]}], ",", 
              RowBox[{"stabval", "=", "1."}]}], "}"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Do", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{"stabval", "=", 
                 RowBox[{"Boole", "[", 
                  RowBox[{"!", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Compile`GetElement", "[", 
                    RowBox[{"data", ",", 
                    RowBox[{
                    RowBox[{"LengthDataProduct", "*", 
                    RowBox[{"(", 
                    RowBox[{"i", "-", "1"}], ")"}]}], "+", 
                    "indexstability1"}]}], "]"}], "==", "0."}], ")"}]}], 
                  "]"}]}], ";", "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"stabval", "==", "0."}], ",", 
                  RowBox[{"Break", "[", "]"}]}], "]"}], ";"}], 
               "\[IndentingNewLine]", ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", "1", ",", "len", ",", "1"}], "}"}]}], "]"}],
              ";", "\[IndentingNewLine]", "stabval"}]}], 
           "\[IndentingNewLine]", "]"}], ",", 
          RowBox[{"CompilationTarget", "->", "\"\<C\>\""}], ",", 
          RowBox[{"RuntimeOptions", "->", "\"\<Speed\>\""}], ",", 
          RowBox[{"RuntimeAttributes", "->", 
           RowBox[{"{", "Listable", "}"}]}], ",", 
          RowBox[{"Parallelization", "->", "True"}]}], "]"}]}], "/.", 
       RowBox[{"ruleOwn", "[", 
        RowBox[{"{", 
         RowBox[{"LengthDataProduct", ",", "indexstability1"}], "}"}], 
        "]"}]}], "//", "ReleaseHold"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"<<", "CompiledFunctionTools`"}], "\n", 
   RowBox[{
    RowBox[{"CompilePrint", "@", "stabilitycheck"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Code", " ", "that", " ", "takes", " ", "the", " ", "given", " ", "set", " ",
      "of", " ", "columns", " ", "corresponding", " ", "to", " ", "ith", " ", 
     "decay", " ", "product", " ", "and", " ", "splits", " ", "it", " ", 
     "onto", " ", "different", " ", "decay", " ", "products"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"PhaseSpaceSplitter", "[", "phasespace_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "grouped", ",", "lengths", ",", "positions", ",", "ranges", ",", 
        "pdgs"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"pdgs", "=", 
        RowBox[{"phasespace", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "indexpdg1"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "Grouping", " ", "consecutive", " ", "identical", " ", "elements"}], 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{"grouped", "=", 
        RowBox[{"Split", "[", "pdgs", "]"}]}], ";", "\n", 
       RowBox[{"(*", 
        RowBox[{
        "Calculating", " ", "the", " ", "lengths", " ", "of", " ", "each", " ",
          "group"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"lengths", "=", 
        RowBox[{"Length", "/@", "grouped"}]}], ";", "\n", 
       RowBox[{"(*", 
        RowBox[{"Generating", " ", "the", " ", "start", " ", "positions"}], 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{"positions", "=", 
        RowBox[{"Accumulate", "[", 
         RowBox[{"Prepend", "[", 
          RowBox[{"lengths", ",", "0"}], "]"}], "]"}]}], ";", "\n", 
       RowBox[{"(*", 
        RowBox[{"Forming", " ", "ranges"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"ranges", "=", 
        RowBox[{"Transpose", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"Most", "[", "positions", "]"}], "+", "1"}], ",", 
           RowBox[{
            RowBox[{"Most", "[", "positions", "]"}], "+", "lengths"}]}], 
          "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"Take", "[", 
          RowBox[{"phasespace", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", 
             RowBox[{"#", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "]"}], "&"}], "/@", 
        "ranges"}]}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "The", " ", "code", " ", "that", " ", "goes", " ", "over", " ", "all", " ",
      "rows", " ", "of", " ", "the", " ", "given", " ", "phase", " ", "space",
      " ", "and", " ", "extracts"}], " ", "*)"}], "\n", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "Phase", " ", "space", " ", "of", " ", "the", " ", "STABLE", " ", 
      "decay", " ", "products", " ", 
      SubscriptBox["product", "1"]}], ",", " ", 
     RowBox[{
      RowBox[{
       SubscriptBox["product", "2"], " ", "from", " ", "the", " ", "process", 
       " ", "LLP"}], " ", "\[Rule]", " ", 
      RowBox[{
       RowBox[{
        RowBox[{
         SubscriptBox["product", "1"], " ", "+", " ", 
         SubscriptBox["product", "2"], " ", "+"}], " ", "..."}], " ", "at", " ",
        "the", " ", "LLP", " ", "rest", " ", "frame"}]}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "The", " ", "phase", " ", "space", " ", "is", " ", "in", " ", "the", " ", 
     "form", " ", "of", " ", "the", " ", "following", " ", 
     RowBox[{"columns", ":", " ", 
      RowBox[{"{", 
       RowBox[{
        SubscriptBox["\[Theta]", "product"], ",", " ", 
        SubscriptBox["\[Phi]", "product"], ",", " ", 
        SubscriptBox["E", "product"], ",", " ", 
        SubscriptBox["m", "product"], ",", " ", 
        SubscriptBox["pdg", "product"], ",", " ", 
        SubscriptBox["Q", 
         RowBox[{"EM", ",", "product"}]], ",", 
        SubscriptBox["stability", "product"]}], "}"}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"PhaseSpaceDecaysRest", "[", 
     RowBox[{
     "LLP_", ",", "mLLP_", ",", "SpecificProcess_", ",", "Nevents_", ",", 
      "DecayUnstable_"}], "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"List", " ", "of", " ", "the", " ", "decay", " ", "products"}],
        "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"productslist", "=", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"ListDecayProducts", "[", 
           RowBox[{"LLP", ",", "SpecificProcess"}], "]"}], ",", 
          RowBox[{
           RowBox[{"#", "\[NotEqual]", "\"\<Null\>\""}], "&"}]}], "]"}]}], ";",
        "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Topology", " ", "of", " ", "the", " ", "decay", " ", 
          RowBox[{"process", ":", " ", 
           RowBox[{"2", "-"}]}]}], ",", " ", 
         RowBox[{"3", "-"}], ",", " ", 
         RowBox[{
          RowBox[{"or", " ", "4"}], "-", 
          RowBox[{"body", " ", "decay"}]}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"Topology", "=", 
        RowBox[{"topology", "[", 
         RowBox[{"Length", "[", "productslist", "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
         "Phase", " ", "space", " ", "of", " ", "the", " ", "decay", " ", 
          "products", " ", "of", " ", 
          RowBox[{"LLP", ".", " ", "At"}], " ", "this", " ", "stage"}], ",", 
         " ", 
         RowBox[{
         "one", " ", "may", " ", "have", " ", "ustable", " ", "decay", " ", 
          "products"}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"decayProducts1", "=", 
        RowBox[{"decayProductsTemp", "=", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"Topology", "\[Equal]", "\"\<3-body\>\""}], ",", 
           RowBox[{"ThreeBodyDecaysEventsAtRest", "[", 
            RowBox[{
            "LLP", ",", "SpecificProcess", ",", "mLLP", ",", "Nevents"}], 
            "]"}], ",", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"Topology", "\[Equal]", "\"\<2-body\>\""}], ",", 
             RowBox[{"Block2BodyDistrAtRest", "[", 
              RowBox[{"mLLP", ",", 
               RowBox[{"productslist", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", 
               RowBox[{"productslist", "[", 
                RowBox[{"[", "2", "]"}], "]"}], ",", "Nevents"}], "]"}], ",", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"Topology", "\[Equal]", "\"\<4-body\>\""}], ",", 
               RowBox[{"FourBodyDecaysEventsAtRest", "[", 
                RowBox[{"mLLP", ",", 
                 RowBox[{"productslist", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], ",", 
                 RowBox[{"productslist", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], ",", 
                 RowBox[{"productslist", "[", 
                  RowBox[{"[", "3", "]"}], "]"}], ",", 
                 RowBox[{"productslist", "[", 
                  RowBox[{"[", "4", "]"}], "]"}], ",", "Nevents"}], "]"}]}], 
              "]"}]}], "]"}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{"DecayUnstable", ",", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{
           "The", " ", "iterative", " ", "routine", " ", "that", " ", 
            "checks", " ", "if", " ", "there", " ", "are", " ", "some", " ", 
            "unstable", " ", "products"}], ",", " ", 
           RowBox[{
            RowBox[{"if", " ", "yes"}], " ", "-", " ", 
            RowBox[{"decays", " ", "them"}]}], ",", " ", 
           RowBox[{
           "and", " ", "defines", " ", "the", " ", "updated", " ", "phase", " ",
             "space"}]}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"While", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Times", "@@", 
              RowBox[{"stabilitycheck", "[", "decayProductsTemp", "]"}]}], "==",
              "0."}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"lenprod", "=", 
              FractionBox[
               RowBox[{"Length", "[", 
                RowBox[{"decayProductsTemp", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "]"}], 
               "LengthDataProduct"]}], ";", "\[IndentingNewLine]", 
             RowBox[{"Do", "[", "\[IndentingNewLine]", 
              RowBox[{"(*", 
               RowBox[{
               "Extracting", " ", "the", " ", "phase", " ", "space", " ", 
                "of", " ", "ith", " ", "decay", " ", "product"}], "*)"}], 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{"phasespaceproduct", "=", 
                 RowBox[{"decayProductsTemp", "[", 
                  RowBox[{"[", 
                   RowBox[{"All", ",", 
                    RowBox[{"Range", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"LengthDataProduct", "*", 
                    RowBox[{"(", 
                    RowBox[{"i", "-", "1"}], ")"}]}], "+", "1"}], ",", 
                    RowBox[{"LengthDataProduct", "*", "i"}]}], "]"}]}], "]"}],
                   "]"}]}], ";", "\[IndentingNewLine]", 
                RowBox[{"(*", 
                 RowBox[{
                 "Check", " ", "if", " ", "there", " ", "are", " ", 
                  "unstable", " ", "particles", " ", "among", " ", "it"}], 
                 "*)"}], "\[IndentingNewLine]", 
                RowBox[{"stab", "=", 
                 RowBox[{"Times", "@@", 
                  RowBox[{
                  "stabilitycheck", "[", "phasespaceproduct", "]"}]}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"(*", 
                 RowBox[{
                  RowBox[{"If", " ", "yes"}], ",", " ", 
                  RowBox[{
                   RowBox[{
                   "then", " ", "split", " ", "it", " ", "into", " ", "sub"}],
                    "-", 
                   RowBox[{
                   "spaces", " ", "of", " ", "different", " ", "products"}]}],
                   ",", " ", 
                  RowBox[{"decay", " ", "unstable", " ", "particles"}], ",", 
                  " ", 
                  RowBox[{"then", " ", "join", " ", "it"}]}], "*)"}], 
                "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"stab", "==", "0."}], ",", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"phasespacesplit", "=", 
                    RowBox[{
                    "PhaseSpaceSplitter", "[", "phasespaceproduct", "]"}]}], ";",
                    "\[IndentingNewLine]", 
                   RowBox[{"Do", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"phasespacesplit", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", "indexstability1", "]"}], "]"}], "==", 
                    "0."}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"phasespacesplit", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "=", 
                    RowBox[{"PhaseSpaceStableFromUnstableBlock", "[", 
                    RowBox[{"phasespacesplit", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "]"}]}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", ",", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", "1", ",", 
                    RowBox[{"Length", "[", "phasespacesplit", "]"}]}], 
                    "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
                   RowBox[{"phasespaceproduct", "=", 
                    RowBox[{
                    RowBox[{"PadRight", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"Join", "[", "##", "]"}], "&"}], "@@", 
                    "phasespacesplit"}], ",", "Automatic", ",", 
                    RowBox[{"-", "999."}]}], "]"}], "//", 
                    "Developer`ToPackedArray"}]}], ";"}]}], 
                 "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"phasespacefin", "[", "i", "]"}], "=", 
                 "phasespaceproduct"}], ";"}], "\[IndentingNewLine]", ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", "1", ",", "lenprod", ",", "1"}], "}"}]}], 
              "]"}], ";", "\[IndentingNewLine]", 
             RowBox[{"decayProductsTemp", "=", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"Join", "[", 
                  RowBox[{"##", ",", "2"}], "]"}], "&"}], "@@", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"phasespacefin", "[", "#", "]"}], "&"}], "/@", 
                  RowBox[{"Range", "[", 
                   RowBox[{"1", ",", "lenprod"}], "]"}]}], ")"}]}], "//", 
               "Developer`ToPackedArray"}]}], ";"}]}], "\[IndentingNewLine]", 
           "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
       "\[IndentingNewLine]", "decayProductsTemp"}]}], "\[IndentingNewLine]", 
     "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.888303630227687*^9, 3.8883036389946194`*^9}, {
   3.88830374496181*^9, 3.8883038035288196`*^9}, {3.8883048689222994`*^9, 
   3.8883049271677876`*^9}, {3.8883049824736423`*^9, 3.888304982687086*^9}, {
   3.888305312881075*^9, 3.888305455019803*^9}, {3.888305544223571*^9, 
   3.8883055929370966`*^9}, {3.8883056531968594`*^9, 
   3.8883056871652985`*^9}, {3.888306006071501*^9, 3.8883060591569023`*^9}, 
   3.888306363751378*^9, {3.888306507495531*^9, 3.8883066218258505`*^9}, {
   3.888306670018731*^9, 3.888306722002021*^9}, {3.888306769480568*^9, 
   3.888306828861915*^9}, {3.8883382942296224`*^9, 3.8883383104059286`*^9}, {
   3.8896734691664944`*^9, 3.889673483623483*^9}, {3.889673726925458*^9, 
   3.889673726928449*^9}, {3.889673927167289*^9, 3.8896739271829104`*^9}, {
   3.8896743706540976`*^9, 3.8896743791304626`*^9}, {3.889674911547965*^9, 
   3.889675021642789*^9}, {3.8896788661099863`*^9, 3.8896789170590343`*^9}, {
   3.8896790459971447`*^9, 3.8896790467494183`*^9}, {3.8896811703159056`*^9, 
   3.889681374043635*^9}, {3.889686387101871*^9, 3.8896864782094765`*^9}, {
   3.890369481752099*^9, 3.890369482053258*^9}, {3.890370001570159*^9, 
   3.890370001863677*^9}, {3.8903704182823243`*^9, 3.8903704390055037`*^9}, 
   3.890370778321101*^9, {3.8903710312940907`*^9, 3.890371048973277*^9}, 
   3.8903722355673895`*^9, 3.890372302904091*^9, {3.890372501081995*^9, 
   3.890372509448707*^9}, {3.8903725500273743`*^9, 3.890372596214924*^9}, {
   3.8903765016532507`*^9, 3.8903765513301544`*^9}, {3.8903766119640636`*^9, 
   3.8903766327827616`*^9}, {3.890377026743435*^9, 3.890377031093351*^9}, 
   3.89037709836462*^9, {3.8903772479803333`*^9, 3.8903772604286723`*^9}, {
   3.8903798950182004`*^9, 3.8903798982675877`*^9}, {3.890379938914705*^9, 
   3.8903800019224033`*^9}, {3.890380039299224*^9, 3.8903800575416546`*^9}, {
   3.890380124802503*^9, 3.8903802442492666`*^9}, 3.8903804210126886`*^9, 
   3.8903805211775093`*^9, {3.8903805930045147`*^9, 3.8903805934019465`*^9}, {
   3.8903827829478245`*^9, 3.8903827871465206`*^9}, {3.8903836242708654`*^9, 
   3.890383644314272*^9}, {3.8903840567079134`*^9, 3.8903840730316896`*^9}, {
   3.8904740323264384`*^9, 3.8904740324402122`*^9}, {3.8914451208191557`*^9, 
   3.891445128871797*^9}, {3.89144515961036*^9, 3.8914452044475756`*^9}, {
   3.8914453425930996`*^9, 3.891445342950641*^9}, {3.891447540234254*^9, 
   3.891447611086487*^9}, {3.891447688868253*^9, 3.891447723202778*^9}, {
   3.8914497449214587`*^9, 3.891449796147089*^9}, {3.891449839748249*^9, 
   3.8914498724807973`*^9}, {3.8914503887836294`*^9, 3.891450390978138*^9}, {
   3.8914506047026167`*^9, 3.8914508111390457`*^9}, {3.8914508575652103`*^9, 
   3.8914508887321434`*^9}, {3.891450983682513*^9, 3.8914511116465216`*^9}, 
   3.8914512647092724`*^9, 3.8914514723533907`*^9, {3.89145154059704*^9, 
   3.891451593603885*^9}, {3.8914516518376074`*^9, 3.8914516526394415`*^9}, {
   3.891451727027312*^9, 3.891451814070984*^9}, {3.891451852288156*^9, 
   3.8914519810391903`*^9}, {3.8914536723113313`*^9, 3.891453672473798*^9}, {
   3.8914839786778154`*^9, 3.891483984920882*^9}, {3.8914840425264807`*^9, 
   3.8914840632661304`*^9}, {3.8914873498737583`*^9, 
   3.8914873516059074`*^9}, {3.891487563413627*^9, 3.8914875693418436`*^9}, {
   3.892306322904023*^9, 3.892306332806356*^9}, {3.892310602511617*^9, 
   3.8923106591473923`*^9}, {3.8923626897374268`*^9, 3.892362694663982*^9}, {
   3.892362725532401*^9, 3.8923630058833747`*^9}, {3.892788681014801*^9, 
   3.892788681655691*^9}, {3.892788921986883*^9, 3.8927889270676937`*^9}, {
   3.8928714978763037`*^9, 3.8928717251092663`*^9}, {3.8928718068804817`*^9, 
   3.892871820305153*^9}, {3.8928718988159637`*^9, 3.8928719017178745`*^9}, {
   3.893348339407822*^9, 3.893348352216549*^9}, {3.893348408547392*^9, 
   3.8933485230623198`*^9}, 3.8933486743374057`*^9, {3.8933489823765726`*^9, 
   3.893348987471447*^9}, {3.893349082200691*^9, 3.893349084130561*^9}, {
   3.893435186107499*^9, 3.8934351862281337`*^9}, 3.89430182010982*^9, {
   3.897021294872501*^9, 3.897021328101615*^9}, {3.8970213831056275`*^9, 
   3.8970213880810075`*^9}, {3.8970216393910203`*^9, 
   3.8970216524110856`*^9}, {3.8970228854855804`*^9, 3.897022947679715*^9}, {
   3.8970236851756744`*^9, 3.8970237264628983`*^9}, 3.8971482217978706`*^9, 
   3.9121450035126905`*^9, {3.912145529793799*^9, 3.912145589301611*^9}, {
   3.9145734651706567`*^9, 3.9145734946388445`*^9}, {3.915002272357435*^9, 
   3.9150024248468266`*^9}, {3.915435518997305*^9, 3.9154355195437765`*^9}, {
   3.915437187159133*^9, 3.9154371872186155`*^9}, {3.915604636124818*^9, 
   3.9156046361973505`*^9}, {3.9156047811499023`*^9, 3.91560479311464*^9}, 
   3.916155409215537*^9, 3.9161564545887594`*^9, {3.9161564911963415`*^9, 
   3.916156494784129*^9}, {3.916162843016532*^9, 3.91616285274424*^9}, {
   3.931229006174201*^9, 3.9312290411436577`*^9}, {3.9312361240295396`*^9, 
   3.931236132593701*^9}, {3.9312364358214083`*^9, 3.931236441646639*^9}},
 CellTags->"Evaluation",
 CellLabel->
  "In[1373]:=",ExpressionUUID->"118d2974-4b4b-4032-921e-9672e56e4127"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["All decay channels - decays at rest", "Subsection",
 CellChangeTimes->{{3.9311595947526293`*^9, 3.9311595968622704`*^9}, {
  3.931159673769329*^9, 
  3.931159675929246*^9}},ExpressionUUID->"aebab89b-3210-4723-aadf-\
4b3061afd73d"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"PhaseSpacePerDecayChannel", "[", 
    RowBox[{
    "LLP_", ",", "mLLP_", ",", "SpecificDecay_", ",", "isim_", ",", 
     "HadronizationOption_", ",", "DecayUnstable_"}], "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"HadronizationOption", "==", "\"\<True\>\""}], "&&", 
      RowBox[{
       RowBox[{"JetsPresence", "[", 
        RowBox[{"LLP", ",", "SpecificDecay"}], "]"}], "==", "\"\<Yes\>\""}]}],
      ",", 
     RowBox[{"RandomChoice", "[", 
      RowBox[{
       RowBox[{"PhaseSpaceDecaysRestJets", "[", 
        RowBox[{"LLP", ",", "SpecificDecay", ",", "mLLP"}], "]"}], ",", 
       "isim"}], "]"}], ",", 
     RowBox[{"PhaseSpaceDecaysRest", "[", 
      RowBox[{
      "LLP", ",", "mLLP", ",", "SpecificDecay", ",", "isim", ",", 
       "DecayUnstable"}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"detectableproducts", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"Hold", "@", 
     RowBox[{"Compile", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"pdglists", ",", "_Real", ",", "2"}], "}"}], "}"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"pdglists", "[", 
             RowBox[{"[", "i", "]"}], "]"}], ",", 
            RowBox[{
             RowBox[{"MemberQ", "[", 
              RowBox[{"DetectablePDGsGivenExperiment", ",", "#"}], "]"}], 
             "&"}]}], "]"}], "//", "Length"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "pdglists", "]"}], ",", "1"}], "}"}]}], 
        "]"}], ",", 
       RowBox[{"CompilationTarget", "->", "\"\<C\>\""}], ",", 
       RowBox[{"RuntimeOptions", "->", "\"\<Speed\>\""}], ",", 
       RowBox[{"RuntimeAttributes", "->", 
        RowBox[{"{", "Listable", "}"}]}], ",", 
       RowBox[{"Parallelization", "->", "True"}]}], "]"}]}], "/.", 
    RowBox[{"OwnValues", "@", "DetectablePDGsGivenExperiment"}]}], "//", 
   "ReleaseHold"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CompilePrint", "@", "detectableproducts"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "This", " ", "block", " ", "generates", " ", "the", " ", "phase", " ", 
    "space", " ", "per", " ", "LLP", " ", "decay", " ", "by", " ", 
    "averaging", " ", "over", " ", "various", " ", "decay", " ", "channels"}],
    "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PhaseSpacePerDecay", "[", 
   RowBox[{
   "LLP_", ",", "mLLP_", ",", "proclist_", ",", "isim_", ",", 
    "HadronizationOption_", ",", "DecayUnstable_"}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"Values", " ", "of", " ", "the", " ", 
      RowBox[{"LLP", "'"}], "s", " ", "decay", " ", "br", " ", "ratios", " ", 
      "associated", " ", "with", " ", "the", " ", "list", " ", "of", " ", 
      "processes"}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ListBrRatiosGivenComputation", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"ListBrRatios", "[", 
         RowBox[{
         "LLPdirName", ",", "mLLP", ",", "#", ",", "decayDescrSelected"}], 
         "]"}], "&"}], "/@", "proclist"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Total", "[", "ListBrRatiosGivenComputation", "]"}], "!=", 
        "0"}], ",", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
         "Number", " ", "of", " ", "decays", " ", "simulated", " ", "for", " ",
           "each", " ", "particular", " ", "channel"}], ",", " ", 
         RowBox[{
         "joined", " ", "with", " ", "the", " ", "channel", " ", 
          "identifiers"}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"isimulvalPerDecayChannelTemp", "=", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"Partition", "[", 
            RowBox[{
             RowBox[{"NeventsSplitted", "[", 
              RowBox[{"isim", ",", "ListBrRatiosGivenComputation"}], "]"}], ",",
              "1"}], "]"}], ",", 
           RowBox[{"Partition", "[", 
            RowBox[{"proclist", ",", "1"}], "]"}], ",", "2"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
          "Selecting", " ", "only", " ", "those", " ", "channels", " ", "for",
            " ", "which", " ", "the", " ", "number", " ", "of", " ", 
           "simulated", " ", "decays", " ", "is"}], " ", ">", " ", 
          RowBox[{
           SuperscriptBox["10", 
            RowBox[{"-", "2"}]], 
           SubscriptBox["N", "ev"]}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"isimulvalPerDecayChannel", "=", 
         RowBox[{"Select", "[", 
          RowBox[{"isimulvalPerDecayChannelTemp", ",", 
           RowBox[{
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ">", "0"}], "&"}]}], "]"}]}], ";",
         "\[IndentingNewLine]", 
        RowBox[{"isimlist", "=", 
         RowBox[{"isimulvalPerDecayChannel", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "1"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"proclistsel", "=", 
         RowBox[{"isimulvalPerDecayChannel", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "2"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"pss", "=", 
         RowBox[{"Developer`ToPackedArray", "@", 
          RowBox[{"PadRight", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"Join", "[", "##", "]"}], "&"}], "@@", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"PhaseSpacePerDecayChannel", "[", 
                RowBox[{"LLP", ",", "mLLP", ",", 
                 RowBox[{"proclistsel", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], ",", 
                 RowBox[{"isimlist", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], ",", "HadronizationOption", 
                 ",", "DecayUnstable"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", "1", ",", 
                 RowBox[{"Length", "[", "proclistsel", "]"}], ",", "1"}], 
                "}"}]}], "]"}]}], ",", "Automatic", ",", 
            RowBox[{"-", "999."}]}], "]"}]}]}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", "pss"}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.9312305329376607`*^9, 3.931230623485171*^9}, {
   3.9312317233643913`*^9, 3.931231723637334*^9}, {3.9312360984069915`*^9, 
   3.931236119144048*^9}, {3.931236403903542*^9, 3.931236416549486*^9}, {
   3.9527537732648907`*^9, 3.9527537755316677`*^9}, 3.9527539962024803`*^9, {
   3.952756381096285*^9, 
   3.952756396582697*^9}},ExpressionUUID->"a421c55b-a46d-4b8f-af31-\
bbc695cc45cc"],

Cell[BoxData[
 FormBox[
  InterpretationBox[
   RowBox[{
    TagBox["CompiledFunction",
     "SummaryHead"], "[", 
    DynamicModuleBox[{Typeset`open$$ = False, Typeset`embedState$$ = "Ready"}, 
     TemplateBox[{
       PaneSelectorBox[{False -> GridBox[{{
             PaneBox[
              ButtonBox[
               DynamicBox[
                FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxOpener"]], 
               ButtonFunction :> (Typeset`open$$ = True), Appearance -> None, 
               BaseStyle -> {}, Evaluator -> Automatic, Method -> 
               "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
              Dynamic[{
                Automatic, 
                 3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                  Magnification])}]], 
             GraphicsBox[{
               Thickness[0.038461538461538464`], {
                FaceForm[{
                  GrayLevel[0.93], 
                  Opacity[1.]}], 
                
                FilledCurveBox[{{{1, 4, 3}, {0, 1, 0}, {1, 3, 3}, {0, 1, 0}, {
                 1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {0, 1, 0}}}, {{{
                 25.499999999999996`, 2.5}, {25.499999999999996`, 
                 1.3953100000000003`}, {24.604699999999998`, 
                 0.49999999999999994`}, {23.5, 0.49999999999999994`}, {2.5, 
                 0.49999999999999994`}, {1.3953100000000003`, 
                 0.49999999999999994`}, {0.49999999999999994`, 
                 1.3953100000000003`}, {0.49999999999999994`, 2.5}, {
                 0.49999999999999994`, 23.5}, {0.49999999999999994`, 
                 24.604699999999998`}, {1.3953100000000003`, 
                 25.499999999999996`}, {2.5, 25.499999999999996`}, {23.5, 
                 25.499999999999996`}, {24.604699999999998`, 
                 25.499999999999996`}, {25.499999999999996`, 
                 24.604699999999998`}, {25.499999999999996`, 23.5}, {
                 25.499999999999996`, 2.5}}}]}, {
                FaceForm[{
                  RGBColor[0.5, 0.5, 0.5], 
                  Opacity[1.]}], 
                
                FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {
                 0, 1, 0}, {0, 1, 0}, {0, 1, 0}}}, {{{20.5426, 
                 19.116799999999998`}, {16.3832, 21.876199999999997`}, {
                 16.3832, 20.021499999999996`}, {6.930469999999999, 
                 20.021499999999996`}, {6.930469999999999, 
                 18.212100000000003`}, {16.3832, 18.212100000000003`}, {
                 16.3832, 16.357399999999995`}, {20.5426, 
                 19.116799999999998`}}}], 
                
                FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {
                 0, 1, 0}, {0, 1, 0}, {0, 1, 0}}}, {{{5.30508, 13.8391}, {
                 9.46445, 11.079700000000003`}, {9.46445, 
                 12.933999999999997`}, {18.917199999999998`, 
                 12.933999999999997`}, {18.917199999999998`, 14.7438}, {
                 9.46445, 14.7438}, {9.46445, 16.598}, {5.30508, 13.8391}}}], 
                
                FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {
                 0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
                 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {
                 1, 3, 3}, {1, 3, 3}, {1, 3, 3}}}, CompressedData["
1:eJxTTMoPSmVmYGBgBGJjIGYCYq4u+eR3VWoOxhkv5j+Qk3SA8fu/r5rKOVHM
Yd2vmNyjZ9Qcrt9QXbW9S8RBg59767IidQcPMYPGaHFhB+Nn61SfiGo4xBwp
T7o2V9Dh0Iolfg6/NBxEHv/x1Xgi4FB1XNNqkqQWnP+axUTQjFkbzn+oO2HB
j/3aDg/Xn5T6WiDoYLs3aJpiqI7DrHN+bO6tQg4zfUR7vF7pQOyfIQyRd9d1
WLL0U1kLoyjEPdm6DpoTXfQX7xBzKPjQejLkhDacL5J4+LL2Gm2HtNnSl4Vf
iELM69J2qPZM3tLnJerQX1oozZugDfHPUxGI/4W1HQ5p3TthoyDi4D7lG1v8
Mi2HgqL9zoEHhB1inOxe3BRG8MH62zXhfIbN1Z82CGhC/GMg4nCm3mN/7TYN
iHlCUPdGakDc/1kUEr46GhD/eYnD+d9iBf/kC0vC+TuCrSL+X5Vy2HGR4R5T
uAbEfxYykPBYp+HQqsCuesZAFhL+rJoQ/2rIQdxTpwkJ7yVycPfD+GDzVqLx
xbUd5HYt2JfqBdWfpA2Jj9mykPDpgYaXtaxDy7yzq86vg8qvlIHE5ylY/Eo7
XAt7o787TxfOB5ufqesQ9PbyxxkPZSDhZ6nrMAGU3u7LQtLLEx2HN2253UbX
ofZ76jis/Pay4oynAsT8QG0HKZMv/gW7FCDyTFpwPsz/MD44/Mw1HFjb1uR9
TVVwWKy880/7FHWIexrkIfLX1RzOMDZZVjHIOaDkh3vSDuj5AwCF11Vc
                 "]]}}, Background -> GrayLevel[0.93], Axes -> False, 
              AspectRatio -> 1, ImageSize -> 
              Dynamic[{
                Automatic, 
                 3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                  Magnification])}], Frame -> True, FrameTicks -> None, 
              FrameStyle -> Directive[
                Thickness[Tiny], 
                GrayLevel[0.7]]], 
             GridBox[{{
                RowBox[{
                  TagBox["\"Argument count: \"", "SummaryItemAnnotation"], 
                  "\[InvisibleSpace]", 
                  TagBox["1", "SummaryItem"]}]}, {
                RowBox[{
                  TagBox["\"Argument types: \"", "SummaryItemAnnotation"], 
                  "\[InvisibleSpace]", 
                  TagBox[
                   StyleBox[
                    PaneBox[
                    RowBox[{"(", "\[NoBreak]", 
                    
                    GridBox[{{"_Real", "2"}}, RowSpacings -> 1, 
                    ColumnSpacings -> 1, RowAlignments -> Baseline, 
                    ColumnAlignments -> Center], "\[NoBreak]", ")"}], 
                    ContentPadding -> False, FrameMargins -> 0, StripOnInput -> 
                    True, BaselinePosition -> Baseline, 
                    ImageSize -> {{1, 300}, Automatic}], LineBreakWithin -> 
                    False], "SummaryItem"]}]}}, 
              GridBoxAlignment -> {
               "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
              False, GridBoxItemSize -> {
               "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
              GridBoxSpacings -> {
               "Columns" -> {{2}}, "Rows" -> {{Automatic}}}, 
              BaseStyle -> {
               ShowStringCharacters -> False, NumberMarks -> False, 
                PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
           GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
           AutoDelete -> False, 
           GridBoxItemSize -> {
            "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
           BaselinePosition -> {1, 1}], True -> GridBox[{{
             PaneBox[
              ButtonBox[
               DynamicBox[
                FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxCloser"]], 
               ButtonFunction :> (Typeset`open$$ = False), Appearance -> None,
                BaseStyle -> {}, Evaluator -> Automatic, Method -> 
               "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
              Dynamic[{
                Automatic, 
                 3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                  Magnification])}]], 
             GraphicsBox[{
               Thickness[0.038461538461538464`], {
                FaceForm[{
                  GrayLevel[0.93], 
                  Opacity[1.]}], 
                
                FilledCurveBox[{{{1, 4, 3}, {0, 1, 0}, {1, 3, 3}, {0, 1, 0}, {
                 1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {0, 1, 0}}}, {{{
                 25.499999999999996`, 2.5}, {25.499999999999996`, 
                 1.3953100000000003`}, {24.604699999999998`, 
                 0.49999999999999994`}, {23.5, 0.49999999999999994`}, {2.5, 
                 0.49999999999999994`}, {1.3953100000000003`, 
                 0.49999999999999994`}, {0.49999999999999994`, 
                 1.3953100000000003`}, {0.49999999999999994`, 2.5}, {
                 0.49999999999999994`, 23.5}, {0.49999999999999994`, 
                 24.604699999999998`}, {1.3953100000000003`, 
                 25.499999999999996`}, {2.5, 25.499999999999996`}, {23.5, 
                 25.499999999999996`}, {24.604699999999998`, 
                 25.499999999999996`}, {25.499999999999996`, 
                 24.604699999999998`}, {25.499999999999996`, 23.5}, {
                 25.499999999999996`, 2.5}}}]}, {
                FaceForm[{
                  RGBColor[0.5, 0.5, 0.5], 
                  Opacity[1.]}], 
                
                FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {
                 0, 1, 0}, {0, 1, 0}, {0, 1, 0}}}, {{{20.5426, 
                 19.116799999999998`}, {16.3832, 21.876199999999997`}, {
                 16.3832, 20.021499999999996`}, {6.930469999999999, 
                 20.021499999999996`}, {6.930469999999999, 
                 18.212100000000003`}, {16.3832, 18.212100000000003`}, {
                 16.3832, 16.357399999999995`}, {20.5426, 
                 19.116799999999998`}}}], 
                
                FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {
                 0, 1, 0}, {0, 1, 0}, {0, 1, 0}}}, {{{5.30508, 13.8391}, {
                 9.46445, 11.079700000000003`}, {9.46445, 
                 12.933999999999997`}, {18.917199999999998`, 
                 12.933999999999997`}, {18.917199999999998`, 14.7438}, {
                 9.46445, 14.7438}, {9.46445, 16.598}, {5.30508, 13.8391}}}], 
                
                FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {
                 0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
                 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {
                 1, 3, 3}, {1, 3, 3}, {1, 3, 3}}}, CompressedData["
1:eJxTTMoPSmVmYGBgBGJjIGYCYq4u+eR3VWoOxhkv5j+Qk3SA8fu/r5rKOVHM
Yd2vmNyjZ9Qcrt9QXbW9S8RBg59767IidQcPMYPGaHFhB+Nn61SfiGo4xBwp
T7o2V9Dh0Iolfg6/NBxEHv/x1Xgi4FB1XNNqkqQWnP+axUTQjFkbzn+oO2HB
j/3aDg/Xn5T6WiDoYLs3aJpiqI7DrHN+bO6tQg4zfUR7vF7pQOyfIQyRd9d1
WLL0U1kLoyjEPdm6DpoTXfQX7xBzKPjQejLkhDacL5J4+LL2Gm2HtNnSl4Vf
iELM69J2qPZM3tLnJerQX1oozZugDfHPUxGI/4W1HQ5p3TthoyDi4D7lG1v8
Mi2HgqL9zoEHhB1inOxe3BRG8MH62zXhfIbN1Z82CGhC/GMg4nCm3mN/7TYN
iHlCUPdGakDc/1kUEr46GhD/eYnD+d9iBf/kC0vC+TuCrSL+X5Vy2HGR4R5T
uAbEfxYykPBYp+HQqsCuesZAFhL+rJoQ/2rIQdxTpwkJ7yVycPfD+GDzVqLx
xbUd5HYt2JfqBdWfpA2Jj9mykPDpgYaXtaxDy7yzq86vg8qvlIHE5ylY/Eo7
XAt7o787TxfOB5ufqesQ9PbyxxkPZSDhZ6nrMAGU3u7LQtLLEx2HN2253UbX
ofZ76jis/Pay4oynAsT8QG0HKZMv/gW7FCDyTFpwPsz/MD44/Mw1HFjb1uR9
TVVwWKy880/7FHWIexrkIfLX1RzOMDZZVjHIOaDkh3vSDuj5AwCF11Vc
                 "]]}}, Background -> GrayLevel[0.93], Axes -> False, 
              AspectRatio -> 1, ImageSize -> 
              Dynamic[{
                Automatic, 
                 3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                  Magnification])}], Frame -> True, FrameTicks -> None, 
              FrameStyle -> Directive[
                Thickness[Tiny], 
                GrayLevel[0.7]]], 
             GridBox[{{
                RowBox[{
                  TagBox["\"Argument count: \"", "SummaryItemAnnotation"], 
                  "\[InvisibleSpace]", 
                  TagBox["1", "SummaryItem"]}]}, {
                RowBox[{
                  TagBox["\"Argument types: \"", "SummaryItemAnnotation"], 
                  "\[InvisibleSpace]", 
                  TagBox[
                   PaneBox[
                    RowBox[{"(", "\[NoBreak]", 
                    
                    GridBox[{{"_Real", "2"}}, RowSpacings -> 1, 
                    ColumnSpacings -> 1, RowAlignments -> Baseline, 
                    ColumnAlignments -> Center], "\[NoBreak]", ")"}], 
                    ImageSize -> {{1, 500}, Automatic}, BaselinePosition -> 
                    Baseline, ContentPadding -> False, FrameMargins -> 0, 
                    StripOnInput -> True], "SummaryItem"]}]}, {
                RowBox[{
                  TagBox["\"Variables: \"", "SummaryItemAnnotation"], 
                  "\[InvisibleSpace]", 
                  TagBox[
                   RowBox[{"{", "pdglists", "}"}], "SummaryItem"]}]}, {
                RowBox[{
                  TagBox["\"Expression: \"", "SummaryItemAnnotation"], 
                  "\[InvisibleSpace]", 
                  TagBox[
                   PaneBox[
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"Select", "[", 
                    RowBox[{
                    
                    RowBox[{"pdglists", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}], ",", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "2212.`"}], ",", 
                    RowBox[{"-", "2112.`"}], ",", 
                    RowBox[{"-", "321.`"}], ",", 
                    RowBox[{"-", "211.`"}], ",", 
                    RowBox[{"-", "21.`"}], ",", 
                    RowBox[{"-", "13.`"}], ",", 
                    RowBox[{"-", "11.`"}], ",", 
                    RowBox[{"-", "5.`"}], ",", 
                    RowBox[{"-", "4.`"}], ",", 
                    RowBox[{"-", "3.`"}], ",", 
                    RowBox[{"-", "2.`"}], ",", 
                    RowBox[{"-", "1.`"}], ",", "1.`", ",", "2.`", ",", "3.`", 
                    ",", "4.`", ",", "5.`", ",", "11.`", ",", "13.`", ",", 
                    "21.`", ",", "22.`", ",", "130.`", ",", "211.`", ",", 
                    "321.`", ",", "2112.`", ",", "2212.`"}], "}"}], ",", 
                    "#1"}], "]"}], "&"}]}], "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "1", ",", 
                    RowBox[{"Length", "[", "pdglists", "]"}], ",", "1"}], 
                    "}"}]}], "]"}], ImageSize -> {{1, 500}, Automatic}, 
                    BaselinePosition -> Baseline, ContentPadding -> False, 
                    FrameMargins -> 0, StripOnInput -> True], 
                   "SummaryItem"]}]}}, 
              GridBoxAlignment -> {
               "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
              False, GridBoxItemSize -> {
               "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
              GridBoxSpacings -> {
               "Columns" -> {{2}}, "Rows" -> {{Automatic}}}, 
              BaseStyle -> {
               ShowStringCharacters -> False, NumberMarks -> False, 
                PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
           GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
           AutoDelete -> False, 
           GridBoxItemSize -> {
            "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
           BaselinePosition -> {1, 1}]}, 
        Dynamic[Typeset`open$$], ImageSize -> Automatic]},
      "SummaryPanel"],
     DynamicModuleValues:>{}], "]"}],
   CompiledFunction[{11, 14.2, 5848}, {{
      Blank[Real], 2}}, {{3, 2, 0}, {2, 1, 
    5}}, {{0, {2, 0, 4}}, {-1, {2, 0, 
      10}}, {{-2212., -2112., -321., -211., -21., -13., -11., -5., -4., -3., \
-2., -1., 1., 2., 3., 4., 5., 11., 13., 21., 22., 130., 211., 321., 2112., 
      2212.}, {3, 1, 2}}, {1, {2, 0, 0}}}, {1, 17, 3, 0, 
    7}, {{33, 0, 2}, {6, 4, 3}, {35, 2, 2, 5}, {6, 4, 9}, {3, 38}, {6, 4, 
     14}, {6, 4, 8}, {38, 0, 0, 9, 1, 4}, {33, 4, 13}, {6, 4, 5}, {35, 13, 2, 
     1}, {6, 4, 15}, {3, 11}, {37, 4, 15, 3, 0}, {7, 0, 1}, {
     42, "MemberQ", 3, 1, 2, -3, 0, 1, 1, 0, 0}, {2, 0, 5}, {12, 14, 0, 16}, {
     6, 16, 14}, {6, 15, 16}, {3, 2}, {6, 10, 16}, {36, 5, 16, 2, 1}, {4, 15, 
     13, -10}, {6, 14, 11}, {6, 4, 12}, {35, 11, 3, 6}, {6, 4, 7}, {3, 11}, {
     12, 8, 0, 5}, {6, 5, 8}, {37, 1, 8, 2, 5}, {24, 5, 10, 0}, {2, 0, 4}, {
     12, 8, 0, 5}, {6, 5, 8}, {3, -5}, {37, 4, 8, 3, 2}, {36, 12, 2, 3, 6}, {
     4, 7, 11, -10}, {33, 6, 8}, {36, 3, 8, 2, 5}, {4, 9, 2, -37}, {1}}, 
    Function[{$CellContext`pdglists}, 
     Table[
      Length[
       Select[
        Part[$CellContext`pdglists, $CellContext`i], 
        MemberQ[{-2212., -2112., -321., -211., -21., -13., -11., -5., -4., \
-3., -2., -1., 1., 2., 3., 4., 5., 11., 13., 21., 22., 130., 211., 321., 
         2112., 2212.}, #]& ]], {$CellContext`i, 1, 
       Length[$CellContext`pdglists], 1}], Listable], Evaluate, 
    LibraryFunction[
    "C:\\Users\\miksi\\AppData\\Roaming\\Wolfram\\ApplicationData\\\
CCompilerDriver\\BuildFolder\\maksym-14516\\compiledFunction45.dll", 
     "compiledFunction45", {{Real, 2, "Constant"}}, {Integer, 1}]],
   Editable->False,
   SelectWithContents->True,
   Selectable->False], TraditionalForm]], "Output",
 CellChangeTimes->{3.9312306331880894`*^9, 3.9312316605497627`*^9, 
  3.9312317308175173`*^9, 3.9527537794900684`*^9, 3.952754000239254*^9},
 CellLabel->
  "Out[1407]=",ExpressionUUID->"e0b1ba2d-6ca9-ed4b-9bf2-c4632ea4d0b2"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["Topology"], "Input",
 CellLabel->
  "In[131]:=",ExpressionUUID->"fc94f46f-70c0-4e4a-967d-2ed86eed6787"],

Cell[BoxData[
 FormBox["\<\"2-body\"\>", TraditionalForm]], "Output",
 CellChangeTimes->{3.952756414179062*^9},
 CellLabel->
  "Out[131]=",ExpressionUUID->"5fed480f-cd42-6a4d-b4b9-79205a7807e7"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["isimulvalPerDecayChannel"], "Input",
 CellChangeTimes->{3.952756329993992*^9},
 CellLabel->
  "In[130]:=",ExpressionUUID->"6919f490-796a-2942-966b-730fa70b09d0"],

Cell[BoxData[
 FormBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"3257", "\<\"e-pair\"\>"},
     {"402", "\<\"\\!\\(\\*SubscriptBox[\\(K\\), \
\\(L\\)]\\)\\!\\(\\*SubscriptBox[\\(K\\), \\(S\\)]\\)\"\>"},
     {"402", "\<\"\\!\\(\\*SuperscriptBox[\\(K\\), \
\\(+\\)]\\)\\!\\(\\*SuperscriptBox[\\(K\\), \\(-\\)]\\)\"\>"},
     {"764", "\<\"\\!\\(\\*SuperscriptBox[\\(\[Pi]\\), \
\\(+\\)]\\)\\!\\(\\*SuperscriptBox[\\(\[Pi]\\), \\(-\\)]\\)\"\>"},
     {"429", "\<\"\\!\\(\\*SuperscriptBox[\\(\[Pi]\\), \
\\(+\\)]\\)\\!\\(\\*SuperscriptBox[\\(\[Pi]\\), \
\\(-\\)]\\)\\!\\(\\*SuperscriptBox[\\(\[Pi]\\), \\(0\\)]\\)\"\>"},
     {"959", "\<\"\\!\\(\\*SuperscriptBox[\\(\[Pi]\\), \
\\(+\\)]\\)\\!\\(\\*SuperscriptBox[\\(\[Pi]\\), \
\\(-\\)]\\)\\!\\(\\*SuperscriptBox[\\(\[Pi]\\), \
\\(0\\)]\\)\\!\\(\\*SuperscriptBox[\\(\[Pi]\\), \\(0\\)]\\)\"\>"},
     {"538", "\<\"\\!\\(\\*SuperscriptBox[\\(\[Pi]\\), \
\\(+\\)]\\)\\!\\(\\*SuperscriptBox[\\(\[Pi]\\), \
\\(-\\)]\\)\\!\\(\\*SuperscriptBox[\\(\[Pi]\\), \
\\(+\\)]\\)\\!\\(\\*SuperscriptBox[\\(\[Pi]\\), \\(-\\)]\\)\"\>"},
     {"3249", "\<\"\[Mu]-pair\"\>"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}], TraditionalForm]], "Output",
 CellChangeTimes->{{3.952756325243078*^9, 3.952756330270464*^9}},
 CellLabel->
  "Out[130]=",ExpressionUUID->"3f37705c-5d68-6540-ac77-fe9e2e2c5321"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1440, 832.5},
WindowMargins->{{-4.875, Automatic}, {Automatic, -4.875}},
FrontEndVersion->"14.2 for Microsoft Windows (64-bit) (December 26, 2024)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"6a43ace9-3c4b-4cc2-ac3b-423c9d88da4c"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{
 "Evaluation"->{
  Cell[40001, 998, 240, 4, 43, "Subsubsection",ExpressionUUID->"91ce9d68-c412-428c-b974-f172f1e4b024",
   CellTags->"Evaluation"],
  Cell[40266, 1006, 17726, 430, 1159, "Input",ExpressionUUID->"85a05016-3b4d-41d3-b5c1-cc23364c7940",
   CellTags->"Evaluation"],
  Cell[57995, 1438, 16630, 323, 59, "Output",ExpressionUUID->"f51f4622-8b66-ab4b-a370-6b53a989d76b",
   CellTags->"Evaluation"],
  Cell[74628, 1763, 21305, 406, 59, "Output",ExpressionUUID->"ebdd1b3f-b9ec-c748-8555-e12f88ce039c",
   CellTags->"Evaluation"],
  Cell[95982, 2175, 260, 4, 43, "Subsubsection",ExpressionUUID->"3fee3c3d-15a9-4e05-a3de-42363dd61dcd",
   CellTags->"Evaluation"],
  Cell[96245, 2181, 8632, 204, 390, "Input",ExpressionUUID->"b2f4900b-827c-4976-b8c1-1b51fe33c28e",
   CellTags->"Evaluation"],
  Cell[105246, 2400, 417, 6, 53, "Subsection",ExpressionUUID->"7a589ffb-6558-4d19-8b47-515193e2454e",
   CellTags->"Evaluation"],
  Cell[105666, 2408, 9294, 218, 675, "Input",ExpressionUUID->"7357c4e0-cb72-437c-b92a-e599f6ea3989",
   CellTags->"Evaluation"],
  Cell[114985, 2630, 187, 3, 43, "Subsubsection",ExpressionUUID->"87e0410a-cc80-4c41-8ba8-cf9f615e7f7b",
   CellTags->"Evaluation"],
  Cell[115175, 2635, 21599, 446, 1245, "Input",ExpressionUUID->"118d2974-4b4b-4032-921e-9672e56e4127",
   CellTags->"Evaluation"]}
 }
*)
(*CellTagsIndex
CellTagsIndex->{
 {"Evaluation", 163375, 3652}
 }
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 201, 3, 67, "Chapter",ExpressionUUID->"4d0219cc-26fe-4879-87be-7d18e85e2efe"],
Cell[784, 27, 1765, 45, 104, "Input",ExpressionUUID->"db7854da-eb4c-4abf-a8a5-7a1f767f2577"],
Cell[CellGroupData[{
Cell[2574, 76, 177, 3, 66, "Section",ExpressionUUID->"46c199dd-cfd5-4cc6-a333-3b3429e6aa5f"],
Cell[CellGroupData[{
Cell[2776, 83, 158, 3, 53, "Subsection",ExpressionUUID->"59050a86-6e07-4aa5-8ae0-28145dcd83ab"],
Cell[2937, 88, 7311, 183, 465, "Input",ExpressionUUID->"ef053d28-2f11-4173-b54e-249e36a1a226"]
}, Open  ]],
Cell[CellGroupData[{
Cell[10285, 276, 158, 3, 53, "Subsection",ExpressionUUID->"8e0532c7-22a1-44cb-bd32-86a09372a460"],
Cell[10446, 281, 29337, 705, 2002, "Input",ExpressionUUID->"d4f445be-2584-4858-b647-9f9df9278a59"]
}, Open  ]],
Cell[CellGroupData[{
Cell[39820, 991, 156, 3, 53, "Subsection",ExpressionUUID->"93af4c5a-e811-41c5-b67c-21549db5632a"],
Cell[CellGroupData[{
Cell[40001, 998, 240, 4, 43, "Subsubsection",ExpressionUUID->"91ce9d68-c412-428c-b974-f172f1e4b024",
 CellTags->"Evaluation"],
Cell[CellGroupData[{
Cell[40266, 1006, 17726, 430, 1159, "Input",ExpressionUUID->"85a05016-3b4d-41d3-b5c1-cc23364c7940",
 CellTags->"Evaluation"],
Cell[57995, 1438, 16630, 323, 59, "Output",ExpressionUUID->"f51f4622-8b66-ab4b-a370-6b53a989d76b",
 CellTags->"Evaluation"],
Cell[74628, 1763, 21305, 406, 59, "Output",ExpressionUUID->"ebdd1b3f-b9ec-c748-8555-e12f88ce039c",
 CellTags->"Evaluation"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[95982, 2175, 260, 4, 43, "Subsubsection",ExpressionUUID->"3fee3c3d-15a9-4e05-a3de-42363dd61dcd",
 CellTags->"Evaluation"],
Cell[96245, 2181, 8632, 204, 390, "Input",ExpressionUUID->"b2f4900b-827c-4976-b8c1-1b51fe33c28e",
 CellTags->"Evaluation"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[104938, 2392, 283, 4, 66, "Section",ExpressionUUID->"f836d394-38e6-4a29-8425-e04f94fef133"],
Cell[CellGroupData[{
Cell[105246, 2400, 417, 6, 53, "Subsection",ExpressionUUID->"7a589ffb-6558-4d19-8b47-515193e2454e",
 CellTags->"Evaluation"],
Cell[105666, 2408, 9294, 218, 675, "Input",ExpressionUUID->"7357c4e0-cb72-437c-b92a-e599f6ea3989",
 CellTags->"Evaluation"],
Cell[CellGroupData[{
Cell[114985, 2630, 187, 3, 43, "Subsubsection",ExpressionUUID->"87e0410a-cc80-4c41-8ba8-cf9f615e7f7b",
 CellTags->"Evaluation"],
Cell[115175, 2635, 21599, 446, 1245, "Input",ExpressionUUID->"118d2974-4b4b-4032-921e-9672e56e4127",
 CellTags->"Evaluation"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[136823, 3087, 236, 4, 53, "Subsection",ExpressionUUID->"aebab89b-3210-4723-aadf-4b3061afd73d"],
Cell[CellGroupData[{
Cell[137084, 3095, 7019, 168, 495, "Input",ExpressionUUID->"a421c55b-a46d-4b8f-af31-bbc695cc45cc"],
Cell[144106, 3265, 16679, 314, 59, "Output",ExpressionUUID->"e0b1ba2d-6ca9-ed4b-9bf2-c4632ea4d0b2"]
}, Open  ]],
Cell[CellGroupData[{
Cell[160822, 3584, 117, 2, 28, "Input",ExpressionUUID->"fc94f46f-70c0-4e4a-967d-2ed86eed6787"],
Cell[160942, 3588, 194, 4, 75, "Output",ExpressionUUID->"5fed480f-cd42-6a4d-b4b9-79205a7807e7"]
}, Open  ]],
Cell[CellGroupData[{
Cell[161173, 3597, 175, 3, 28, "Input",ExpressionUUID->"6919f490-796a-2942-966b-730fa70b09d0"],
Cell[161351, 3602, 1607, 33, 151, "Output",ExpressionUUID->"3f37705c-5d68-6540-ac77-fe9e2e2c5321"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

