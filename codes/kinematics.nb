(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    121467,       2965]
NotebookOptionsPosition[    114185,       2822]
NotebookOutlinePosition[    117343,       2884]
CellTagsIndexPosition[    117268,       2879]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Lorentz boosts", "Chapter",
 CellChangeTimes->{{3.9341347716542516`*^9, 
  3.9341347745245075`*^9}},ExpressionUUID->"198bcc9e-1875-4b98-996e-\
78ab8c9d3f6c"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Position", " ", "of", " ", "the", " ", "point", " ", "in", " ", 
    "coordinate", " ", "space", " ", "in", " ", "terms", " ", "of", " ", 
    "spherical", " ", "coordinates"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"\[Phi]Val", "[", 
      RowBox[{"px_", ",", "py_"}], "]"}], "=", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"py", ">", "0"}], ",", 
       RowBox[{"ArcCos", "[", 
        FractionBox["px", 
         SqrtBox[
          RowBox[{
           SuperscriptBox["px", "2"], "+", 
           SuperscriptBox["py", "2"]}]]], "]"}], ",", 
       RowBox[{"-", 
        RowBox[{"ArcCos", "[", 
         FractionBox["px", 
          SqrtBox[
           RowBox[{
            SuperscriptBox["px", "2"], "+", 
            SuperscriptBox["py", "2"]}]]], "]"}]}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Theta]Val", "[", 
      RowBox[{"px_", ",", "py_", ",", "pz_"}], "]"}], "=", 
     RowBox[{"ArcCos", "[", 
      RowBox[{"pz", "/", 
       RowBox[{"(", 
        RowBox[{"\[Sqrt]", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["px", "2"], "+", 
           SuperscriptBox["py", "2"], "+", 
           SuperscriptBox["pz", "2"]}], ")"}]}], ")"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "Decaying", " ", "particle", " ", "momentum", " ", "and", " ", 
      "velocity", " ", "at", " ", "its", " ", "lab", " ", 
      RowBox[{"frame", ".", " ", "Since"}], " ", "the", " ", "experiment", " ",
       "geometry", " ", "is", " ", "convenient", " ", "to", " ", 
      "characterize", " ", "in", " ", "terms", " ", "of", " ", "spherical", " ",
       "coordinates"}], ",", " ", 
     RowBox[{
     "it", " ", "is", " ", "given", " ", "here", " ", "in", " ", "both", " ", 
      "spherical", " ", "and", " ", "cartesian", " ", "coordinates"}]}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"pMotherVecCart", "[", 
      RowBox[{"px_", ",", "py_", ",", "pz_"}], "]"}], "=", 
     RowBox[{"{", 
      RowBox[{"px", ",", "py", ",", "pz"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"vMotherVecCart", "[", 
      RowBox[{"Ev_", ",", "px_", ",", "py_", ",", "pz_"}], "]"}], "=", 
     RowBox[{"+", 
      FractionBox[
       RowBox[{"pMotherVecCart", "[", 
        RowBox[{"px", ",", "py", ",", "pz"}], "]"}], "Ev"]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"\[Gamma]", ",", 
     RowBox[{"\[CapitalGamma]", " ", "factors"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Gamma]Factor", "[", 
      RowBox[{"ELLP_", ",", "mLLP_"}], "]"}], "=", 
     FractionBox["ELLP", "mLLP"]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[CapitalGamma]factor", "[", 
      RowBox[{"ELLP_", ",", "mLLP_"}], "]"}], "=", 
     RowBox[{"Simplify", "[", 
      FractionBox[
       RowBox[{
        RowBox[{"\[Gamma]Factor", "[", 
         RowBox[{"ELLP", ",", "mLLP"}], "]"}], "-", "1"}], 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"v", "/.", 
           RowBox[{"Solve", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"\[Gamma]Factor", "[", 
               RowBox[{"ELLP", ",", "mLLP"}], "]"}], "\[Equal]", 
              FractionBox["1", 
               SqrtBox[
                RowBox[{"1", "-", 
                 SuperscriptBox["v", "2"]}]]]}], ",", "v"}], "]"}]}], ")"}], 
         "2"], "[", 
        RowBox[{"[", "1", "]"}], "]"}]], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"pprod", "=", 
     RowBox[{"{", 
      RowBox[{"pxd", ",", "pyd", ",", "pzd"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"vmotherlab", "=", 
     RowBox[{"vMotherVecCart", "[", 
      RowBox[{"Em", ",", "pxm", ",", "pym", ",", "pzm"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"pproductLabVecCart", "[", 
      RowBox[{
      "pxm_", ",", "pym_", ",", "pzm_", ",", "Em_", ",", "mm_", ",", "pxd_", ",",
        "pyd_", ",", "pzd_", ",", "Ed_"}], "]"}], "=", 
     RowBox[{"Simplify", "[", 
      RowBox[{"pprod", "+", 
       RowBox[{
        RowBox[{"\[Gamma]Factor", "[", 
         RowBox[{"Em", ",", "mm"}], "]"}], "*", "vmotherlab", "*", "Ed"}], "+", 
       RowBox[{
        RowBox[{"\[CapitalGamma]factor", "[", 
         RowBox[{"Em", ",", "mm"}], "]"}], "*", "vmotherlab", 
        RowBox[{"(", 
         RowBox[{"vmotherlab", ".", "pprod"}], ")"}]}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"EproductLabCart", "[", 
      RowBox[{
      "pxm_", ",", "pym_", ",", "pzm_", ",", "Em_", ",", "mm_", ",", "pxd_", ",",
        "pyd_", ",", "pzd_", ",", "Ed_"}], "]"}], "=", 
     RowBox[{"Simplify", "[", 
      RowBox[{
       RowBox[{"\[Gamma]Factor", "[", 
        RowBox[{"Em", ",", "mm"}], "]"}], 
       RowBox[{"(", 
        RowBox[{"Ed", "+", 
         RowBox[{"vmotherlab", ".", "pprod"}]}], ")"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"pproductLab1Cart", "[", 
        RowBox[{
        "pxm_", ",", "pym_", ",", "pzm_", ",", "Em_", ",", "mm_", ",", "pxd_",
          ",", "pyd_", ",", "pzd_", ",", "Ed_"}], "]"}], ",", 
       RowBox[{"pproductLab2Cart", "[", 
        RowBox[{
        "pxm_", ",", "pym_", ",", "pzm_", ",", "Em_", ",", "mm_", ",", "pxd_",
          ",", "pyd_", ",", "pzd_", ",", "Ed_"}], "]"}], ",", 
       RowBox[{"pproductLab3Cart", "[", 
        RowBox[{
        "pxm_", ",", "pym_", ",", "pzm_", ",", "Em_", ",", "mm_", ",", "pxd_",
          ",", "pyd_", ",", "pzd_", ",", "Ed_"}], "]"}]}], "}"}], "=", 
     RowBox[{
      RowBox[{
       RowBox[{"Simplify", "[", 
        RowBox[{
         RowBox[{"pproductLabVecCart", "[", 
          RowBox[{
          "pxm", ",", "pym", ",", "pzm", ",", "Em", ",", "mm", ",", "pxd", ",",
            "pyd", ",", "pzd", ",", "Ed"}], "]"}], "[", 
         RowBox[{"[", "#", "]"}], "]"}], "]"}], "&"}], "/@", 
      RowBox[{"{", 
       RowBox[{"1", ",", "2", ",", "3"}], "}"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
   "Print", "[", "\"\<Check that \!\(\*SubscriptBox[SuperscriptBox[\(E\), \(2\
\)], \(boosted\)]\) - \!\(\*SubscriptBox[SuperscriptBox[OverscriptBox[\(p\), \
\(_\)], \(2\)], \(boosted\)]\) = \!\(\*SuperscriptBox[\(m\), \(2\)]\):\>\"", 
    "]"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"testExpr", "[", 
      RowBox[{
      "pxm_", ",", "pym_", ",", "pzm_", ",", "Em_", ",", "mm_", ",", "pxd_", ",",
        "pyd_", ",", "pzd_", ",", "Ed_"}], "]"}], "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{
              SuperscriptBox[
               RowBox[{"EproductLabCart", "[", 
                RowBox[{
                "pxm", ",", "pym", ",", "pzm", ",", "Em", ",", "mm", ",", 
                 "pxd", ",", "pyd", ",", "pzd", ",", "Ed"}], "]"}], "2"], "-", 
              SuperscriptBox[
               RowBox[{"pproductLab1Cart", "[", 
                RowBox[{
                "pxm", ",", "pym", ",", "pzm", ",", "Em", ",", "mm", ",", 
                 "pxd", ",", "pyd", ",", "pzd", ",", "Ed"}], "]"}], "2"], "-", 
              SuperscriptBox[
               RowBox[{"pproductLab2Cart", "[", 
                RowBox[{
                "pxm", ",", "pym", ",", "pzm", ",", "Em", ",", "mm", ",", 
                 "pxd", ",", "pyd", ",", "pzd", ",", "Ed"}], "]"}], "2"], "-", 
              SuperscriptBox[
               RowBox[{"pproductLab3Cart", "[", 
                RowBox[{
                "pxm", ",", "pym", ",", "pzm", ",", "Em", ",", "mm", ",", 
                 "pxd", ",", "pyd", ",", "pzd", ",", "Ed"}], "]"}], "2"]}], "//",
              "Expand"}], "//", "Simplify"}], ")"}], "/.", 
          RowBox[{"{", 
           RowBox[{
            SuperscriptBox["pxm", "2"], "\[Rule]", 
            RowBox[{
             SuperscriptBox["Em", "2"], "-", 
             SuperscriptBox["pym", "2"], "-", 
             SuperscriptBox["pzm", "2"], "-", 
             SuperscriptBox["mm", "2"]}]}], "}"}]}], "//", "Expand"}], "//", 
        "Simplify"}], ")"}], "/.", 
      RowBox[{"{", 
       RowBox[{
        SuperscriptBox["Em", "2"], "\[Rule]", 
        RowBox[{
         SuperscriptBox["pxm", "2"], "+", 
         SuperscriptBox["pym", "2"], "+", 
         SuperscriptBox["pzm", "2"], "+", 
         SuperscriptBox["mm", "2"]}]}], "}"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"testExpr", "[", 
     RowBox[{"pxm", ",", "pym", ",", "pzm", ",", 
      SqrtBox[
       RowBox[{
        SuperscriptBox["pxm", "2"], "+", 
        SuperscriptBox["pym", "2"], "+", 
        SuperscriptBox["pzm", "2"], "+", 
        SuperscriptBox["mm", "2"]}]], ",", "mm", ",", 
      SqrtBox[
       RowBox[{
        SuperscriptBox["Ed", "2"], "-", 
        SuperscriptBox["pyd", "2"], "-", 
        SuperscriptBox["pzd", "2"], "-", 
        SuperscriptBox["m", "2"]}]], ",", "pyd", ",", "pzd", ",", "Ed"}], 
     "]"}], "//", "Simplify"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "The", " ", "same", " ", "but", " ", "assuming", " ", "that", " ", "the",
       " ", "mother", " ", "3"}], "-", 
     RowBox[{
     "momentum", " ", "is", " ", "given", " ", "in", " ", "terms", " ", "of", 
      " ", "spherical", " ", "coordinates"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"pMotherVecSpher", "[", 
      RowBox[{"ELLP_", ",", "mLLP_", ",", "\[Theta]LLP_", ",", "\[Phi]LLP_"}],
       "]"}], "=", 
     RowBox[{
      SqrtBox[
       RowBox[{
        SuperscriptBox["ELLP", "2"], "-", 
        SuperscriptBox["mLLP", "2"]}]], 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"Sin", "[", "\[Theta]LLP", "]"}], "*", 
         RowBox[{"Cos", "[", "\[Phi]LLP", "]"}]}], ",", 
        RowBox[{
         RowBox[{"Sin", "[", "\[Theta]LLP", "]"}], "*", 
         RowBox[{"Sin", "[", "\[Phi]LLP", "]"}]}], ",", 
        RowBox[{"Cos", "[", "\[Theta]LLP", "]"}]}], "}"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"vMotherVecSpher", "[", 
      RowBox[{"ELLP_", ",", "mLLP_", ",", "\[Theta]LLP_", ",", "\[Phi]LLP_"}],
       "]"}], "=", 
     RowBox[{"+", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"pMotherVecSpher", "[", 
         RowBox[{"ELLP", ",", "mLLP", ",", "\[Theta]LLP", ",", "\[Phi]LLP"}], 
         "]"}], "/", "ELLP"}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"pproductLabVecSpher", "[", 
      RowBox[{
      "ELLP_", ",", "mLLP_", ",", "\[Theta]LLP_", ",", "\[Phi]LLP_", ",", 
       "pxd_", ",", "pyd_", ",", "pzd_", ",", "Ed_"}], "]"}], "=", 
     RowBox[{"Simplify", "[", 
      RowBox[{"pprod", "+", 
       RowBox[{
        RowBox[{"\[Gamma]Factor", "[", 
         RowBox[{"ELLP", ",", "mLLP"}], "]"}], "*", 
        RowBox[{"vMotherVecSpher", "[", 
         RowBox[{"ELLP", ",", "mLLP", ",", "\[Theta]LLP", ",", "\[Phi]LLP"}], 
         "]"}], "*", "Ed"}], "+", 
       RowBox[{
        RowBox[{"\[CapitalGamma]factor", "[", 
         RowBox[{"ELLP", ",", "mLLP"}], "]"}], "*", 
        RowBox[{"vMotherVecSpher", "[", 
         RowBox[{"ELLP", ",", "mLLP", ",", "\[Theta]LLP", ",", "\[Phi]LLP"}], 
         "]"}], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"vMotherVecSpher", "[", 
           RowBox[{
           "ELLP", ",", "mLLP", ",", "\[Theta]LLP", ",", "\[Phi]LLP"}], "]"}],
           ".", "pprod"}], ")"}]}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"EproductLabSpher", "[", 
      RowBox[{
      "ELLP_", ",", "mLLP_", ",", "\[Theta]LLP_", ",", "\[Phi]LLP_", ",", 
       "pxd_", ",", "pyd_", ",", "pzd_", ",", "Ed_"}], "]"}], "=", 
     RowBox[{"Simplify", "[", 
      RowBox[{
       RowBox[{"\[Gamma]Factor", "[", 
        RowBox[{"ELLP", ",", "mLLP"}], "]"}], 
       RowBox[{"(", 
        RowBox[{"Ed", "+", 
         RowBox[{
          RowBox[{"vMotherVecSpher", "[", 
           RowBox[{
           "ELLP", ",", "mLLP", ",", "\[Theta]LLP", ",", "\[Phi]LLP"}], "]"}],
           ".", "pprod"}]}], ")"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"pproductLab1Spher", "[", 
        RowBox[{
        "ELLP_", ",", "mLLP_", ",", "\[Theta]LLP_", ",", "\[Phi]LLP_", ",", 
         "pxd_", ",", "pyd_", ",", "pzd_", ",", "Ed_"}], "]"}], ",", 
       RowBox[{"pproductLab2Spher", "[", 
        RowBox[{
        "ELLP_", ",", "mLLP_", ",", "\[Theta]LLP_", ",", "\[Phi]LLP_", ",", 
         "pxd_", ",", "pyd_", ",", "pzd_", ",", "Ed_"}], "]"}], ",", 
       RowBox[{"pproductLab3Spher", "[", 
        RowBox[{
        "ELLP_", ",", "mLLP_", ",", "\[Theta]LLP_", ",", "\[Phi]LLP_", ",", 
         "pxd_", ",", "pyd_", ",", "pzd_", ",", "Ed_"}], "]"}]}], "}"}], "=", 
     RowBox[{"Simplify", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"pproductLabVecSpher", "[", 
          RowBox[{
          "ELLP", ",", "mLLP", ",", "\[Theta]LLP", ",", "\[Phi]LLP", ",", 
           "pxd", ",", "pyd", ",", "pzd", ",", "Ed"}], "]"}], "[", 
         RowBox[{"[", "#", "]"}], "]"}], "&"}], "/@", 
       RowBox[{"{", 
        RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
   "Print", "[", "\"\<Check that \!\(\*SubscriptBox[SuperscriptBox[\(E\), \(2\
\)], \(boosted\)]\) - \!\(\*SubscriptBox[SuperscriptBox[OverscriptBox[\(p\), \
\(_\)], \(2\)], \(boosted\)]\) = \!\(\*SuperscriptBox[\(m\), \(2\)]\) - for \
the formulas expressed in spherical LLP coordinates:\>\"", "]"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"testExpr2", "[", 
     RowBox[{
     "ELLP_", ",", "mLLP_", ",", "\[Theta]LLP_", ",", "\[Phi]LLP_", ",", 
      "pxd_", ",", "pyd_", ",", "pzd_", ",", "Ed_"}], "]"}], "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       SuperscriptBox[
        RowBox[{"EproductLabSpher", "[", 
         RowBox[{
         "ELLP", ",", "mLLP", ",", "\[Theta]LLP", ",", "\[Phi]LLP", ",", 
          "pxd", ",", "pyd", ",", "pzd", ",", "Ed"}], "]"}], "2"], "-", 
       SuperscriptBox[
        RowBox[{"pproductLab1Spher", "[", 
         RowBox[{
         "ELLP", ",", "mLLP", ",", "\[Theta]LLP", ",", "\[Phi]LLP", ",", 
          "pxd", ",", "pyd", ",", "pzd", ",", "Ed"}], "]"}], "2"], "-", 
       SuperscriptBox[
        RowBox[{"pproductLab2Spher", "[", 
         RowBox[{
         "ELLP", ",", "mLLP", ",", "\[Theta]LLP", ",", "\[Phi]LLP", ",", 
          "pxd", ",", "pyd", ",", "pzd", ",", "Ed"}], "]"}], "2"], "-", 
       SuperscriptBox[
        RowBox[{"pproductLab3Spher", "[", 
         RowBox[{
         "ELLP", ",", "mLLP", ",", "\[Theta]LLP", ",", "\[Phi]LLP", ",", 
          "pxd", ",", "pyd", ",", "pzd", ",", "Ed"}], "]"}], "2"]}], "//", 
      "Expand"}], "//", "Simplify"}]}]}]}]], "Input",
 CellChangeTimes->{{3.9341349715996647`*^9, 3.934134987120278*^9}, 
   3.9341353321947465`*^9},
 CellLabel->"In[1]:=",ExpressionUUID->"51eb07f8-2fcc-4739-9f94-5f94c244248f"],

Cell[BoxData[
 FormBox[
  TemplateBox[{
   "Solve", "nongen", 
    "\"There may be values of the parameters for which some or all solutions \
are not valid.\"", 2, 232, 12, 23773143175991299767, "Local"},
   "MessageTemplate",
   BaseStyle->"MSG"], TraditionalForm]], "Message",
 CellChangeTimes->{3.9341349475492992`*^9, 3.934135335881407*^9, 
  3.949683574231716*^9, 3.950089732099823*^9, 3.9511198928379097`*^9, 
  3.9511204749922504`*^9, 3.95114949898921*^9, 3.952100354339903*^9},
 CellLabel->
  "During evaluation of \
In[227]:=",ExpressionUUID->"c0ab3652-c2e5-4244-890d-6a7ff06a5581"],

Cell[BoxData[
 FormBox["\<\"Check that \\!\\(\\*SubscriptBox[SuperscriptBox[\\(E\\), \
\\(2\\)], \\(boosted\\)]\\) - \
\\!\\(\\*SubscriptBox[SuperscriptBox[OverscriptBox[\\(p\\), \\(_\\)], \
\\(2\\)], \\(boosted\\)]\\) = \\!\\(\\*SuperscriptBox[\\(m\\), \\(2\\)]\\):\"\
\>", TraditionalForm]], "Print",
 CellChangeTimes->{3.934134947564771*^9, 3.9341353358999863`*^9, 
  3.949683574247429*^9, 3.950089732125826*^9, 3.9511198928675747`*^9, 
  3.951120475022938*^9, 3.9511494990089626`*^9, 3.9521003543495274`*^9},
 CellLabel->
  "During evaluation of \
In[227]:=",ExpressionUUID->"7f5b99c7-6c86-2743-89c8-343b41c4ba2e"],

Cell[BoxData[
 FormBox[
  SuperscriptBox["m", "2"], TraditionalForm]], "Output",
 CellChangeTimes->{3.9341349476488485`*^9, 3.934135335960271*^9, 
  3.949683574247429*^9, 3.9500897324602184`*^9, 3.9511198929799156`*^9, 
  3.951120475191986*^9, 3.9511494991395245`*^9, 3.952100354469675*^9},
 CellLabel->
  "Out[240]=",ExpressionUUID->"bb0a5403-2db6-154d-87f5-ee6743cd2d42"],

Cell[BoxData[
 FormBox["\<\"Check that \\!\\(\\*SubscriptBox[SuperscriptBox[\\(E\\), \
\\(2\\)], \\(boosted\\)]\\) - \
\\!\\(\\*SubscriptBox[SuperscriptBox[OverscriptBox[\\(p\\), \\(_\\)], \
\\(2\\)], \\(boosted\\)]\\) = \\!\\(\\*SuperscriptBox[\\(m\\), \\(2\\)]\\) - \
for the formulas expressed in spherical LLP coordinates:\"\>", 
  TraditionalForm]], "Print",
 CellChangeTimes->{3.934134947564771*^9, 3.9341353358999863`*^9, 
  3.949683574247429*^9, 3.950089732125826*^9, 3.9511198928675747`*^9, 
  3.951120475022938*^9, 3.9511494990089626`*^9, 3.9521003549696045`*^9},
 CellLabel->
  "During evaluation of \
In[227]:=",ExpressionUUID->"86dffb9b-5107-8942-8231-a9e5fbc3aa0f"],

Cell[BoxData[
 FormBox[
  RowBox[{
   SuperscriptBox["Ed", "2"], "-", 
   SuperscriptBox["pxd", "2"], "-", 
   SuperscriptBox["pyd", "2"], "-", 
   SuperscriptBox["pzd", "2"]}], TraditionalForm]], "Output",
 CellChangeTimes->{3.9341349476488485`*^9, 3.934135335960271*^9, 
  3.949683574247429*^9, 3.9500897324602184`*^9, 3.9511198929799156`*^9, 
  3.951120475191986*^9, 3.9511494991395245`*^9, 3.952100354999792*^9},
 CellLabel->
  "Out[247]=",ExpressionUUID->"e63a8270-dd69-fb4a-9736-0d8faf62c325"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Kinematics", "Section",
 CellChangeTimes->{{3.9496394573595657`*^9, 
  3.9496394584624825`*^9}},ExpressionUUID->"60ed4932-68a8-6c45-91f2-\
9bb2f7894f84"],

Cell[CellGroupData[{

Cell["Table with 4-momentum of boosted LLPs", "Subsection",
 CellChangeTimes->{3.885110500646716*^9, 3.9154388117685595`*^9},
 CellTags->
  "Evaluation",ExpressionUUID->"875269e7-e121-b04b-a19a-f8c8239fe841"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Table", " ", 
     SubscriptBox["p", 
      RowBox[{"product", ",", "x"}]]}], ",", " ", 
    SubscriptBox["p", 
     RowBox[{"product", ",", "y"}]], ",", " ", 
    SubscriptBox["p", 
     RowBox[{"product", ",", "z"}]], ",", " ", 
    SubscriptBox["E", "product"]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"!", "AccCode"}], ",", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
     "Indices", " ", "of", " ", "the", " ", "table", " ", "with", " ", "the", 
      " ", "corresponding", " ", "boosted", " ", "LLPs"}], "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"indexpx", "=", "1"}], ";", "\[IndentingNewLine]", 
     RowBox[{"indexpy", "=", "2"}], ";", "\[IndentingNewLine]", 
     RowBox[{"indexpz", "=", "3"}], ";", "\[IndentingNewLine]", 
     RowBox[{"indexE", "=", "4"}], ";", "\[IndentingNewLine]", 
     RowBox[{"indexm", "=", "5"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"LLPdistr", "&&", 
        RowBox[{"!", "EventCalc"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"BoostedLLPsFromDecaysTable", "=", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Hold", "@", 
             RowBox[{"Compile", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"tablemother", ",", "_Real", ",", "1"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"tabledaughter", ",", "_Real", ",", "1"}], "}"}]}], 
                "}"}], ",", 
               RowBox[{"Module", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                  "motherE", ",", "motherpx", ",", "motherpy", ",", 
                   "motherpz", ",", "daughterErest", ",", "daughterpxrest", ",",
                    "daughterpyrest", ",", "daughterpzrest", ",", 
                   "daughterElab", ",", "daughterpxlab", ",", "daughterpylab",
                    ",", "daughterpzlab", ",", "mmother"}], "}"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"mmother", "=", 
                   RowBox[{"Compile`GetElement", "[", 
                    RowBox[{"tablemother", ",", "indexm"}], "]"}]}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"motherE", "=", 
                   RowBox[{"Compile`GetElement", "[", 
                    RowBox[{"tablemother", ",", "indexE"}], "]"}]}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"motherpx", "=", 
                   RowBox[{"Compile`GetElement", "[", 
                    RowBox[{"tablemother", ",", "indexpx"}], "]"}]}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"motherpy", "=", 
                   RowBox[{"Compile`GetElement", "[", 
                    RowBox[{"tablemother", ",", "indexpy"}], "]"}]}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"motherpz", "=", 
                   RowBox[{"Compile`GetElement", "[", 
                    RowBox[{"tablemother", ",", "indexpz"}], "]"}]}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"daughterErest", "=", 
                   RowBox[{"Compile`GetElement", "[", 
                    RowBox[{"tabledaughter", ",", "indexE"}], "]"}]}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"daughterpxrest", "=", 
                   RowBox[{"Compile`GetElement", "[", 
                    RowBox[{"tabledaughter", ",", "indexpx"}], "]"}]}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"daughterpyrest", "=", 
                   RowBox[{"Compile`GetElement", "[", 
                    RowBox[{"tabledaughter", ",", "indexpy"}], "]"}]}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"daughterpzrest", "=", 
                   RowBox[{"Compile`GetElement", "[", 
                    RowBox[{"tabledaughter", ",", "indexpz"}], "]"}]}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"daughterElab", "=", 
                   RowBox[{"EproductLabCart", "[", 
                    RowBox[{
                    "motherpx", ",", "motherpy", ",", "motherpz", ",", 
                    "motherE", ",", "mmother", ",", "daughterpxrest", ",", 
                    "daughterpyrest", ",", "daughterpzrest", ",", 
                    "daughterErest"}], "]"}]}], ";", "\[IndentingNewLine]", 
                  RowBox[{"daughterpxlab", "=", 
                   RowBox[{"pproductLab1Cart", "[", 
                    RowBox[{
                    "motherpx", ",", "motherpy", ",", "motherpz", ",", 
                    "motherE", ",", "mmother", ",", "daughterpxrest", ",", 
                    "daughterpyrest", ",", "daughterpzrest", ",", 
                    "daughterErest"}], "]"}]}], ";", "\[IndentingNewLine]", 
                  RowBox[{"daughterpylab", "=", 
                   RowBox[{"pproductLab2Cart", "[", 
                    RowBox[{
                    "motherpx", ",", "motherpy", ",", "motherpz", ",", 
                    "motherE", ",", "mmother", ",", "daughterpxrest", ",", 
                    "daughterpyrest", ",", "daughterpzrest", ",", 
                    "daughterErest"}], "]"}]}], ";", "\[IndentingNewLine]", 
                  RowBox[{"daughterpzlab", "=", 
                   RowBox[{"pproductLab3Cart", "[", 
                    RowBox[{
                    "motherpx", ",", "motherpy", ",", "motherpz", ",", 
                    "motherE", ",", "mmother", ",", "daughterpxrest", ",", 
                    "daughterpyrest", ",", "daughterpzrest", ",", 
                    "daughterErest"}], "]"}]}], ";", "\[IndentingNewLine]", 
                  RowBox[{"{", 
                   RowBox[{
                   "daughterpxlab", ",", "daughterpylab", ",", 
                    "daughterpzlab", ",", "daughterElab"}], "}"}]}]}], 
                "\[IndentingNewLine]", "]"}], ",", 
               RowBox[{"CompilationTarget", "\[Rule]", "\"\<C\>\""}], ",", 
               RowBox[{"RuntimeOptions", "\[Rule]", "\"\<Speed\>\""}], ",", 
               RowBox[{"RuntimeAttributes", "\[Rule]", 
                RowBox[{"{", "Listable", "}"}]}]}], "]"}]}], "/.", 
            RowBox[{"ruleDown", "[", 
             RowBox[{"{", 
              RowBox[{
              "pproductLab1Cart", ",", "pproductLab2Cart", ",", 
               "pproductLab3Cart", ",", "EproductLabCart"}], "}"}], "]"}]}], "/.", 
           RowBox[{"ruleOwn", "[", 
            RowBox[{"{", 
             RowBox[{
             "indexpx", ",", "indexpy", ",", "indexpz", ",", "indexE", ",", 
              "indexm"}], "}"}], "]"}]}], "//", "ReleaseHold"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
          "This", " ", "code", " ", "converts", " ", "the", " ", "data", " ", 
           "in", " ", "the", " ", "form", " ", 
           RowBox[{"{", 
            RowBox[{
             SubscriptBox["p", "x"], ",", 
             SubscriptBox["p", "y"], ",", 
             SubscriptBox["p", "z"], ",", "E", ",", "m"}], "}"}], " ", "into",
            " ", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"\[Theta]", ",", "E"}], "}"}], ".", " ", "If"}], " ", 
           "the", " ", "facility", " ", "is", " ", "based", " ", "on", " ", 
           "symmetric", " ", "pp", " ", "collisions"}], ",", " ", 
          RowBox[{
          "it", " ", "also", " ", "converts", " ", "everything", " ", "to", " ",
            "the", " ", "forward", " ", "hemisphere", " ", "to", " ", 
           "increase", " ", "the", " ", "statistics"}]}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"BoostedLLPsAngleEnergyData", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Hold", "@", 
            RowBox[{"Compile", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"BoostedLLPs", ",", "_Real", ",", "1"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"mLLP", ",", "_Real"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"abs", ",", "_Integer"}], "}"}]}], "}"}], ",", 
              RowBox[{"Module", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"pzvals", ",", "Evals"}], "}"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"pzvals", "=", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"abs", "==", "1"}], ",", 
                    RowBox[{"Abs", "[", 
                    RowBox[{"Compile`GetElement", "[", 
                    RowBox[{"BoostedLLPs", ",", "indexpz"}], "]"}], "]"}], ",", 
                    RowBox[{"Compile`GetElement", "[", 
                    RowBox[{"BoostedLLPs", ",", "indexpz"}], "]"}]}], "]"}]}],
                  ";", "\[IndentingNewLine]", 
                 RowBox[{"Evals", "=", 
                  RowBox[{"Compile`GetElement", "[", 
                   RowBox[{"BoostedLLPs", ",", "indexE"}], "]"}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"ArcCos", "[", 
                    FractionBox["pzvals", 
                    SqrtBox[
                    RowBox[{
                    SuperscriptBox["Evals", "2"], "-", 
                    SuperscriptBox["mLLP", "2"]}]]], "]"}], ",", "Evals"}], 
                  "}"}]}]}], "]"}], ",", 
              RowBox[{"CompilationTarget", "\[Rule]", "\"\<C\>\""}], ",", 
              RowBox[{"RuntimeOptions", "\[Rule]", "\"\<Speed\>\""}], ",", 
              RowBox[{"RuntimeAttributes", "\[Rule]", 
               RowBox[{"{", "Listable", "}"}]}]}], "]"}]}], "/.", 
           RowBox[{"ruleOwn", "[", 
            RowBox[{"{", 
             RowBox[{"indexpz", ",", "indexE"}], "}"}], "]"}]}], "//", 
          "ReleaseHold"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"BoostedLLPsFromDecays", "[", 
          RowBox[{"motherdata_", ",", "daughterdata_"}], "]"}], ":=", 
         RowBox[{"Block", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"numllps", "=", 
             FractionBox[
              RowBox[{"Length", "[", 
               RowBox[{"daughterdata", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "]"}], "indexm"]}], "}"}], ",",
            "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"masses", "=", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"daughterdata", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"i", "-", "1"}], ")"}], "*", "indexm"}], "+", 
                  "indexm"}], "]"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", "1", ",", "numllps", ",", "1"}], "}"}]}], 
              "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Join", "[", 
                RowBox[{"##", ",", "2"}], "]"}], "&"}], "@@", 
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"masses", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "!=", 
                   RowBox[{"-", "999."}]}], ",", 
                  RowBox[{"BoostedLLPsFromDecaysTable", "[", 
                   RowBox[{"motherdata", ",", 
                    RowBox[{"daughterdata", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"i", "-", "1"}], ")"}], "*", "indexm"}], "+", 
                    RowBox[{"Range", "[", 
                    RowBox[{"indexpx", ",", "indexm"}], "]"}]}]}], "]"}], 
                    "]"}]}], "]"}], ",", 
                  RowBox[{"daughterdata", "[", 
                   RowBox[{"[", 
                    RowBox[{"All", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"i", "-", "1"}], ")"}], "*", "indexm"}], "+", 
                    RowBox[{"Range", "[", 
                    RowBox[{"indexpx", ",", "indexm"}], "]"}]}]}], "]"}], 
                   "]"}]}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"i", ",", "1", ",", "numllps", ",", "1"}], "}"}]}], 
               "]"}]}], "//", "Developer`ToPackedArray"}]}]}], 
          "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"BoostedLLPsFromDecaysTable", "=", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Hold", "@", 
             RowBox[{"Compile", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"tablemother", ",", "_Real", ",", "1"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"tabledaughter", ",", "_Real", ",", "1"}], "}"}]}], 
                "}"}], ",", 
               RowBox[{"Module", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                  "motherE", ",", "motherpx", ",", "motherpy", ",", 
                   "motherpz", ",", "daughterErest", ",", "daughterpxrest", ",",
                    "daughterpyrest", ",", "daughterpzrest", ",", 
                   "daughterElab", ",", "daughterpxlab", ",", "daughterpylab",
                    ",", "daughterpzlab", ",", "mmother", ",", "daughterm"}], 
                  "}"}], ",", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"mmother", "=", 
                   RowBox[{"Compile`GetElement", "[", 
                    RowBox[{"tablemother", ",", "indexm"}], "]"}]}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"motherE", "=", 
                   RowBox[{"Compile`GetElement", "[", 
                    RowBox[{"tablemother", ",", "indexE"}], "]"}]}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"motherpx", "=", 
                   RowBox[{"Compile`GetElement", "[", 
                    RowBox[{"tablemother", ",", "indexpx"}], "]"}]}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"motherpy", "=", 
                   RowBox[{"Compile`GetElement", "[", 
                    RowBox[{"tablemother", ",", "indexpy"}], "]"}]}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"motherpz", "=", 
                   RowBox[{"Compile`GetElement", "[", 
                    RowBox[{"tablemother", ",", "indexpz"}], "]"}]}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"daughterErest", "=", 
                   RowBox[{"Compile`GetElement", "[", 
                    RowBox[{"tabledaughter", ",", "indexE"}], "]"}]}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"daughterpxrest", "=", 
                   RowBox[{"Compile`GetElement", "[", 
                    RowBox[{"tabledaughter", ",", "indexpx"}], "]"}]}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"daughterpyrest", "=", 
                   RowBox[{"Compile`GetElement", "[", 
                    RowBox[{"tabledaughter", ",", "indexpy"}], "]"}]}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"daughterpzrest", "=", 
                   RowBox[{"Compile`GetElement", "[", 
                    RowBox[{"tabledaughter", ",", "indexpz"}], "]"}]}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"daughterm", "=", 
                   RowBox[{"Compile`GetElement", "[", 
                    RowBox[{"tabledaughter", ",", "indexm"}], "]"}]}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"daughterElab", "=", 
                   RowBox[{"EproductLabCart", "[", 
                    RowBox[{
                    "motherpx", ",", "motherpy", ",", "motherpz", ",", 
                    "motherE", ",", "mmother", ",", "daughterpxrest", ",", 
                    "daughterpyrest", ",", "daughterpzrest", ",", 
                    "daughterErest"}], "]"}]}], ";", "\[IndentingNewLine]", 
                  RowBox[{"daughterpxlab", "=", 
                   RowBox[{"pproductLab1Cart", "[", 
                    RowBox[{
                    "motherpx", ",", "motherpy", ",", "motherpz", ",", 
                    "motherE", ",", "mmother", ",", "daughterpxrest", ",", 
                    "daughterpyrest", ",", "daughterpzrest", ",", 
                    "daughterErest"}], "]"}]}], ";", "\[IndentingNewLine]", 
                  RowBox[{"daughterpylab", "=", 
                   RowBox[{"pproductLab2Cart", "[", 
                    RowBox[{
                    "motherpx", ",", "motherpy", ",", "motherpz", ",", 
                    "motherE", ",", "mmother", ",", "daughterpxrest", ",", 
                    "daughterpyrest", ",", "daughterpzrest", ",", 
                    "daughterErest"}], "]"}]}], ";", "\[IndentingNewLine]", 
                  RowBox[{"daughterpzlab", "=", 
                   RowBox[{"pproductLab3Cart", "[", 
                    RowBox[{
                    "motherpx", ",", "motherpy", ",", "motherpz", ",", 
                    "motherE", ",", "mmother", ",", "daughterpxrest", ",", 
                    "daughterpyrest", ",", "daughterpzrest", ",", 
                    "daughterErest"}], "]"}]}], ";", "\[IndentingNewLine]", 
                  RowBox[{"{", 
                   RowBox[{
                   "daughterpxlab", ",", "daughterpylab", ",", 
                    "daughterpzlab", ",", "daughterElab", ",", "daughterm"}], 
                   "}"}]}]}], "\[IndentingNewLine]", "]"}], ",", 
               RowBox[{"CompilationTarget", "\[Rule]", "\"\<C\>\""}], ",", 
               RowBox[{"RuntimeOptions", "\[Rule]", "\"\<Speed\>\""}], ",", 
               RowBox[{"RuntimeAttributes", "\[Rule]", 
                RowBox[{"{", "Listable", "}"}]}]}], "]"}]}], "/.", 
            RowBox[{"ruleDown", "[", 
             RowBox[{"{", 
              RowBox[{
              "pproductLab1Cart", ",", "pproductLab2Cart", ",", 
               "pproductLab3Cart", ",", "EproductLabCart"}], "}"}], "]"}]}], "/.", 
           RowBox[{"ruleOwn", "[", 
            RowBox[{"{", 
             RowBox[{
             "indexpx", ",", "indexpy", ",", "indexpz", ",", "indexE", ",", 
              "indexm"}], "}"}], "]"}]}], "//", "ReleaseHold"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"BoostedLLPsFromDecaysDi", "[", 
          RowBox[{"motherdata_", ",", "daughterdata_"}], "]"}], ":=", 
         RowBox[{"Block", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"numllps", "=", 
             FractionBox[
              RowBox[{"Length", "[", 
               RowBox[{"daughterdata", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "]"}], "indexm"]}], "}"}], ",",
            "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"masses", "=", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"daughterdata", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"i", "-", "1"}], ")"}], "*", "indexm"}], "+", 
                  "indexm"}], "]"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", "1", ",", "numllps", ",", "1"}], "}"}]}], 
              "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Join", "[", 
                RowBox[{"##", ",", "2"}], "]"}], "&"}], "@@", 
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"masses", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "!=", 
                   RowBox[{"-", "999."}]}], ",", 
                  RowBox[{"BoostedLLPsFromDecaysTable", "[", 
                   RowBox[{"motherdata", ",", 
                    RowBox[{"daughterdata", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"i", "-", "1"}], ")"}], "*", "indexm"}], "+", 
                    RowBox[{"Range", "[", 
                    RowBox[{"indexpx", ",", "indexm"}], "]"}]}]}], "]"}], 
                    "]"}]}], "]"}], ",", 
                  RowBox[{"daughterdata", "[", 
                   RowBox[{"[", 
                    RowBox[{"All", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"i", "-", "1"}], ")"}], "*", "indexm"}], "+", 
                    RowBox[{"Range", "[", 
                    RowBox[{"indexpx", ",", "indexm"}], "]"}]}]}], "]"}], 
                   "]"}]}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"i", ",", "1", ",", "numllps", ",", "1"}], "}"}]}], 
               "]"}]}], "//", "Developer`ToPackedArray"}]}]}], 
          "\[IndentingNewLine]", "]"}]}]}]}], "\[IndentingNewLine]", 
      "]"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.8777051070651913`*^9, 3.8777051076161757`*^9}, {
   3.877707242386143*^9, 3.877707250384223*^9}, 3.8846194736436396`*^9, {
   3.8848801603587303`*^9, 3.8848801952875338`*^9}, 3.8851087401615815`*^9, {
   3.8887384921859083`*^9, 3.8887385051492825`*^9}, {3.88873978796301*^9, 
   3.8887398168028297`*^9}, 3.8928297916029177`*^9, {3.8928309796657176`*^9, 
   3.8928310498101373`*^9}, {3.8928310930940266`*^9, 3.892831201197757*^9}, {
   3.8928312316318154`*^9, 3.8928312364319353`*^9}, {3.8928313110059085`*^9, 
   3.8928313128799424`*^9}, {3.8928315067674637`*^9, 3.8928315110936675`*^9}, 
   3.9043788086123953`*^9, {3.91326729885575*^9, 3.913267359780249*^9}, {
   3.913276757002309*^9, 3.9132767985262575`*^9}, {3.9132768376586285`*^9, 
   3.9132768434011116`*^9}, {3.913349818022299*^9, 3.9133498515704284`*^9}, {
   3.9133556548493633`*^9, 3.9133556666741962`*^9}, {3.9133670584229307`*^9, 
   3.913367133483798*^9}, {3.91543881178265*^9, 3.9154388118116393`*^9}, {
   3.934135029642062*^9, 3.934135135465953*^9}, {3.934135172303644*^9, 
   3.934135172315302*^9}, {3.949387907917719*^9, 3.949388060343439*^9}, 
   3.9493882438398952`*^9, {3.949388547044365*^9, 3.9493885493261623`*^9}, {
   3.949389419266199*^9, 3.9493894483469467`*^9}, {3.949639496360016*^9, 
   3.9496394964819794`*^9}, {3.9496399070214863`*^9, 3.949639939716543*^9}, {
   3.949648729248392*^9, 3.9496487329510803`*^9}, {3.9496565427351265`*^9, 
   3.9496565468930035`*^9}, {3.9496603136340733`*^9, 
   3.9496604211663933`*^9}, {3.949683686440836*^9, 3.949683694484783*^9}, {
   3.951469269715748*^9, 3.95146927400918*^9}, {3.9515526600409393`*^9, 
   3.9515526707075024`*^9}},
 CellTags->"Evaluation",
 CellLabel->"In[22]:=",ExpressionUUID->"5aa4d321-ccd4-704d-9042-abd2a19077ee"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["LLP decays", "Chapter",
 CellChangeTimes->{{3.949371726449896*^9, 
  3.949371756581814*^9}},ExpressionUUID->"3d06a620-6a60-3645-a7e6-\
f1f5bd7f2aec"],

Cell[CellGroupData[{

Cell["A sampler for 2-body decays at rest", "Section",
 CellChangeTimes->{{3.9496400154922314`*^9, 
  3.949640025173397*^9}},ExpressionUUID->"13ee7615-3001-6947-b7a8-\
a3224acc3e58"],

Cell[CellGroupData[{

Cell["2-body", "Subsection",
 CellChangeTimes->{{3.877691041323384*^9, 3.8776910462459574`*^9}, {
  3.8851105459942493`*^9, 3.885110547379161*^9}},
 CellTags->
  "Evaluation",ExpressionUUID->"24893949-96b9-cc49-b120-f3bc6d74defe"],

Cell[BoxData[{
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"!", "AccCode"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"tabPS2bodyLLPprodCompiled", "=", 
     RowBox[{
      RowBox[{"Hold", "@", 
       RowBox[{"Compile", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"MASSM", ",", "_Real"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"m2", ",", "_Real"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"m1", ",", "_Real"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"\[Theta]rand", ",", "_Real"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"\[Phi]rand", ",", "_Real"}], "}"}]}], "}"}], ",", 
         RowBox[{"Module", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
            "pval", ",", "px1", ",", "py1", ",", "pz1", ",", "E12body", ",", 
             "E22body"}], "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{"Energies", " ", "of", " ", "particles", " ", "1", " ", 
             RowBox[{"(", "E12body", ")"}], " ", "and", " ", "2", " ", 
             RowBox[{"(", "E22body", ")"}], " ", "at", " ", "the", " ", 
             "rest", " ", "frame", " ", "of", " ", "decaying", " ", 
             "particle"}], "*)"}], "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"E12body", "=", 
             FractionBox[
              RowBox[{
               SuperscriptBox["MASSM", "2"], "-", 
               SuperscriptBox["m2", "2"], "+", 
               SuperscriptBox["m1", "2"]}], 
              RowBox[{"2", "*", "MASSM"}]]}], ";", "\[IndentingNewLine]", 
            RowBox[{"E22body", "=", 
             FractionBox[
              RowBox[{
               SuperscriptBox["MASSM", "2"], "-", 
               SuperscriptBox["m1", "2"], "+", 
               SuperscriptBox["m2", "2"]}], 
              RowBox[{"2", "*", "MASSM"}]]}], ";", "\[IndentingNewLine]", 
            RowBox[{"pval", "=", 
             SqrtBox[
              RowBox[{
               SuperscriptBox["E22body", "2"], "-", 
               SuperscriptBox["m2", "2"]}]]}], ";", "\[IndentingNewLine]", 
            RowBox[{"px1", "=", 
             RowBox[{"pval", "*", 
              RowBox[{"Cos", "[", "\[Phi]rand", "]"}], "*", 
              RowBox[{"Sin", "[", "\[Theta]rand", "]"}]}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"py1", "=", 
             RowBox[{"pval", "*", 
              RowBox[{"Sin", "[", "\[Phi]rand", "]"}], "*", 
              RowBox[{"Sin", "[", "\[Theta]rand", "]"}]}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"pz1", "=", 
             RowBox[{"pval", "*", 
              RowBox[{"Cos", "[", "\[Theta]rand", "]"}]}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "px1"}], ",", 
              RowBox[{"-", "py1"}], ",", 
              RowBox[{"-", "pz1"}], ",", "E12body", ",", "m1", ",", "px1", ",",
               "py1", ",", "pz1", ",", "E22body", ",", "m2"}], "}"}]}]}], 
          "\[IndentingNewLine]", "]"}], ",", 
         RowBox[{"CompilationTarget", "\[Rule]", "\"\<C\>\""}], ",", 
         RowBox[{"RuntimeOptions", "\[Rule]", "\"\<Speed\>\""}], ",", 
         RowBox[{"RuntimeAttributes", "->", 
          RowBox[{"{", "Listable", "}"}]}], ",", 
         RowBox[{"Parallelization", "->", "True"}]}], "]"}]}], "//", 
      "ReleaseHold"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"<<", "CompiledFunctionTools`"}], ";", "\n", 
    RowBox[{"CompilePrint", "@", "tabPS2bodyLLPprodCompiled"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"TwoBodyDecaysEventsAtRestArbitrary", "[", 
      RowBox[{"m_", ",", "m1_", ",", "m2_", ",", "Nevents_"}], "]"}], ":=", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\[Phi]Rand", "=", 
         RowBox[{"RandomReal", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "Pi"}], ",", "Pi"}], "}"}], ",", "Nevents"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"\[Theta]Rand", "=", 
         RowBox[{"ArcCos", "[", 
          RowBox[{"RandomReal", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", "Nevents"}], "]"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"tabPS2bodyLLPprodCompiled", "[", 
         RowBox[{
         "m", ",", "m2", ",", "m1", ",", "\[Theta]Rand", ",", "\[Phi]Rand"}], 
         "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"TwoBodyDecaysEventsAtRestLLPprod", "[", 
      RowBox[{"LLP_", ",", "Process_", ",", " ", "mLLP_", ",", "Nevents_"}], 
      "]"}], ":=", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"(*", 
         RowBox[{
         "partcontent", ",", "MASSM", ",", "MASS1", ",", "\[Phi]Rand", ",", 
          "\[Theta]Rand"}], "*)"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"partcontent", "=", 
         RowBox[{"ReactionProductsList", "[", 
          RowBox[{"LLP", ",", "Process"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"MASSM", ",", "MASS1"}], "}"}], "=", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"mSM", "[", 
            RowBox[{"partcontent", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"partcontent", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "==", "LLP"}], ",", "mLLP", ",", 
             RowBox[{"mSM", "[", 
              RowBox[{"partcontent", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "]"}]}], "}"}]}], ";",
         "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"partcontent", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "==", "\"\<X\>\""}], ",", 
          RowBox[{"MASS1", "=", 
           RowBox[{"mXval", "[", 
            RowBox[{"LLP", ",", "mLLP"}], "]"}]}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
          "Array", " ", "of", " ", "random", " ", "values", " ", "of", " ", 
           "\[Phi]", " ", "and", " ", "\[Theta]", " ", "defined", " ", "via", 
           " ", 
           SubscriptBox["p", "2"]}], " ", "=", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "p"}], "\[Times]", 
             RowBox[{"Cos", "[", "\[Phi]", "]"}], "\[Times]", 
             RowBox[{"Sin", "[", "\[Theta]", "]"}]}], ",", 
            RowBox[{
             RowBox[{"-", "p"}], "\[Times]", 
             RowBox[{"Sin", "[", "\[Phi]", "]"}], "\[Times]", 
             RowBox[{"Sin", "[", "\[Theta]", "]"}]}], ",", 
            RowBox[{
             RowBox[{"-", "p"}], "\[Times]", 
             RowBox[{"Cos", "[", "\[Theta]", "]"}]}]}], ")"}]}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Distribution", " ", "in", " ", "\[Phi]", " ", "is", " ", 
           RowBox[{"isotropic", ".", " ", "Distribution"}], " ", "in", " ", 
           "cos", 
           RowBox[{"(", "\[Theta]", ")"}], " ", "is", " ", 
           RowBox[{"isotropic", ".", " ", "Hence"}]}], ",", " ", 
          RowBox[{
           RowBox[{
           "one", " ", "should", " ", "generate", " ", "random", " ", 
            "values", " ", "of", " ", "\[Phi]", " ", "in", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "Pi"}], ",", "Pi"}], ")"}], " ", "and", " ", 
            "random", " ", "values", " ", "of", " ", "cos", 
            RowBox[{"(", "\[Theta]", ")"}], " ", "from"}], " ", "-", 
           RowBox[{"1", " ", "to", " ", "1"}]}], ",", " ", 
          RowBox[{"then", " ", "takin", " ", "arccos", 
           RowBox[{"(", ")"}]}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"\[Phi]Rand", "=", 
         RowBox[{"RandomReal", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "Pi"}], ",", "Pi"}], "}"}], ",", "Nevents"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"\[Theta]Rand", "=", 
         RowBox[{"ArcCos", "[", 
          RowBox[{"RandomReal", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", "Nevents"}], "]"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"The", " ", "final", " ", "phase", " ", "space"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"TabPS2bodyTemp", "=", 
         RowBox[{"tabPS2bodyLLPprodCompiled", "[", 
          RowBox[{
          "MASSM", ",", "mLLP", ",", "MASS1", ",", "\[Theta]Rand", ",", 
           "\[Phi]Rand"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"partcontent", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "==", "LLP"}], ",", 
          RowBox[{"If", "[", 
           RowBox[{"LLPdistr", ",", 
            RowBox[{"Riffle", "[", 
             RowBox[{
              RowBox[{"TabPS2bodyTemp", "[", 
               RowBox[{"[", 
                RowBox[{"All", ",", 
                 RowBox[{"Range", "[", 
                  RowBox[{"1", ",", "5"}], "]"}]}], "]"}], "]"}], ",", 
              RowBox[{"TabPS2bodyTemp", "[", 
               RowBox[{"[", 
                RowBox[{"All", ",", 
                 RowBox[{"Range", "[", 
                  RowBox[{"6", ",", "10"}], "]"}]}], "]"}], "]"}]}], "]"}], ",", 
            RowBox[{"TabPS2bodyTemp", "[", 
             RowBox[{"[", 
              RowBox[{"All", ",", 
               RowBox[{"Range", "[", 
                RowBox[{"1", ",", "10"}], "]"}]}], "]"}], "]"}]}], "]"}], ",", 
          RowBox[{"TabPS2bodyTemp", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", 
             RowBox[{"Range", "[", 
              RowBox[{"6", ",", "10"}], "]"}]}], "]"}], "]"}]}], "]"}]}]}], 
      "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"TwoBodyDecaysEventsAtRestNonLLP", "[", 
      RowBox[{"partM_", ",", "part1_", ",", "part2_", ",", "Nevents_"}], 
      "]"}], ":=", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "partcontent", ",", "MASSM", ",", "MASS1", ",", "MASS2", ",", 
         "\[Phi]Rand", ",", "\[Theta]Rand"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"MASSM", ",", "MASS1", ",", "MASS2"}], "}"}], "=", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"mSM", "[", "partM", "]"}], ",", 
           RowBox[{"mSM", "[", "part1", "]"}], ",", 
           RowBox[{"mSM", "[", "part2", "]"}]}], "}"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
          "Array", " ", "of", " ", "random", " ", "values", " ", "of", " ", 
           "\[Phi]", " ", "and", " ", "\[Theta]", " ", "defined", " ", "via", 
           " ", 
           SubscriptBox["p", "2"]}], " ", "=", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "p"}], "\[Times]", 
             RowBox[{"Cos", "[", "\[Phi]", "]"}], "\[Times]", 
             RowBox[{"Sin", "[", "\[Theta]", "]"}]}], ",", 
            RowBox[{
             RowBox[{"-", "p"}], "\[Times]", 
             RowBox[{"Sin", "[", "\[Phi]", "]"}], "\[Times]", 
             RowBox[{"Sin", "[", "\[Theta]", "]"}]}], ",", 
            RowBox[{
             RowBox[{"-", "p"}], "\[Times]", 
             RowBox[{"Cos", "[", "\[Theta]", "]"}]}]}], ")"}]}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Distribution", " ", "in", " ", "\[Phi]", " ", "is", " ", 
           RowBox[{"isotropic", ".", " ", "Distribution"}], " ", "in", " ", 
           "cos", 
           RowBox[{"(", "\[Theta]", ")"}], " ", "is", " ", 
           RowBox[{"isotropic", ".", " ", "Hence"}]}], ",", " ", 
          RowBox[{
           RowBox[{
           "one", " ", "should", " ", "generate", " ", "random", " ", 
            "values", " ", "of", " ", "\[Phi]", " ", "in", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "Pi"}], ",", "Pi"}], ")"}], " ", "and", " ", 
            "random", " ", "values", " ", "of", " ", "cos", 
            RowBox[{"(", "\[Theta]", ")"}], " ", "from"}], " ", "-", 
           RowBox[{"1", " ", "to", " ", "1"}]}], ",", " ", 
          RowBox[{"then", " ", "takin", " ", "arccos", 
           RowBox[{"(", ")"}]}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"\[Phi]Rand", "=", 
         RowBox[{"RandomReal", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "Pi"}], ",", "Pi"}], "}"}], ",", "Nevents"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"\[Theta]Rand", "=", 
         RowBox[{"ArcCos", "[", 
          RowBox[{"RandomReal", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", "Nevents"}], "]"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"The", " ", "final", " ", "phase", " ", "space"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"TabPS2bodyTemp", "=", 
         RowBox[{"tabPS2bodyLLPprodCompiled", "[", 
          RowBox[{
          "MASSM", ",", "MASS2", ",", "MASS1", ",", "\[Theta]Rand", ",", 
           "\[Phi]Rand"}], "]"}]}]}]}], "\[IndentingNewLine]", "]"}]}]}]}], 
  "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"tabtest", "=", 
      RowBox[{"TwoBodyDecaysEventsAtRest", "[", 
       RowBox[{"\"\<HNL-mixing-e\>\"", ",", "\"\<B-2-body\>\"", ",", "1", ",", 
        RowBox[{"5", "*", 
         SuperscriptBox["10", "6"]}]}], "]"}]}], ";"}], "//", 
    RowBox[{"AbsoluteTiming", "\[IndentingNewLine]", 
     RowBox[{
     "Print", "[", "\"\<Distribution in cos(\[Theta]) (must be \
isotropic):\>\"", "]"}], "\[IndentingNewLine]", 
     RowBox[{"Histogram", "[", 
      RowBox[{
       FractionBox[
        RowBox[{"tabtest", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "3"}], "]"}], "]"}], 
        SqrtBox[
         RowBox[{
          SuperscriptBox[
           RowBox[{
            RowBox[{"tabtest", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "[", 
            RowBox[{"[", "4", "]"}], "]"}], "2"], "-", 
          SuperscriptBox[
           RowBox[{
            RowBox[{"tabtest", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "[", 
            RowBox[{"[", "5", "]"}], "]"}], "2"]}]]], ",", "100", 
       ",", "\"\<ProbabilityDensity\>\""}], "]"}]}]}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.913263457235407*^9, 3.913263496776415*^9}, {
   3.9132635330867147`*^9, 3.9132636145054865`*^9}, {3.9132636453356113`*^9, 
   3.91326376970642*^9}, {3.9132638757563562`*^9, 3.913263905020344*^9}, {
   3.9132639641295905`*^9, 3.9132641537766123`*^9}, {3.913265163298602*^9, 
   3.9132651678272133`*^9}, {3.913274504897067*^9, 3.9132745145462704`*^9}, {
   3.913274551919711*^9, 3.9132746408918867`*^9}, {3.9132746788311625`*^9, 
   3.913274721244623*^9}, 3.913277393372783*^9, {3.9132776063235703`*^9, 
   3.9132776221735954`*^9}, 3.9132807293138013`*^9, {3.9133943088751755`*^9, 
   3.9133943105181155`*^9}, 3.913394947448184*^9, {3.9134527724372797`*^9, 
   3.9134527732761564`*^9}, {3.9154388115918026`*^9, 3.915438811630966*^9}, 
   3.9154409661387963`*^9, {3.9341344523053703`*^9, 3.934134454475378*^9}, {
   3.9493845380312634`*^9, 3.949384555687853*^9}, {3.9493878310406933`*^9, 
   3.949387847010769*^9}, {3.9496401103627453`*^9, 3.9496401156573105`*^9}, {
   3.949640149581356*^9, 3.9496403042918377`*^9}, {3.9496403362468376`*^9, 
   3.94964035435878*^9}, {3.951203413706049*^9, 3.951203448612501*^9}, {
   3.9512092102281685`*^9, 3.951209213148079*^9}, {3.9512092522301617`*^9, 
   3.9512092541671333`*^9}, {3.9521004517076073`*^9, 
   3.9521004902932835`*^9}, {3.9521031849477634`*^9, 
   3.9521031870328636`*^9}, {3.952104385577669*^9, 3.9521043864469204`*^9}},
 CellTags->"Evaluation",
 CellLabel->"In[23]:=",ExpressionUUID->"0dd694c5-8553-bc40-823f-9805267e9f08"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Kinematics of 3-body decays", "Section",
 CellChangeTimes->{{3.88837805314929*^9, 3.8883780571688633`*^9}, 
   3.9493717368399067`*^9},
 CellTags->
  "Evaluation",ExpressionUUID->"5892fdf5-ae95-fd44-856b-bdbadbe7e31f"],

Cell[CellGroupData[{

Cell[TextData[{
 "Phase space in terms of energies ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["E", "1"], ",", 
    SubscriptBox["E", "3"]}], TraditionalForm]],ExpressionUUID->
  "a94d9482-40d4-6649-929a-118439f897bf"]
}], "Subsection",
 CellChangeTimes->{{3.853559048218363*^9, 3.853559101627491*^9}, {
  3.8850098900640697`*^9, 3.8850098970747585`*^9}, {3.8883780640453424`*^9, 
  3.888378095761384*^9}},
 CellTags->
  "Evaluation",ExpressionUUID->"8707483c-2746-fe4e-a454-074c1cf30e67"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Kinematics", " ", "of", " ", "3"}], "-", 
    RowBox[{"body", " ", "decays"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"pPar", "[", 
      RowBox[{"En_", ",", "mn_"}], "]"}], "=", 
     SqrtBox[
      RowBox[{
       SuperscriptBox["En", "2"], "-", 
       SuperscriptBox["mn", "2"]}]]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"E2valEnergies", "[", 
      RowBox[{"m_", ",", "E1_", ",", "E3_"}], "]"}], "=", 
     RowBox[{"m", "-", "E1", "-", "E3"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"cos", " ", "between", " ", "particles", " ", "1"}], ",", 
     RowBox[{"2", " ", "and", " ", "1"}], ",", 
     RowBox[{
      RowBox[{
      "3", " ", "at", " ", "rest", " ", "frame", " ", "of", " ", "decaying", " ",
        "particle", " ", "0"}], " ", "\[Rule]", " ", 
      RowBox[{"1", "+", "2", "+", 
       RowBox[{"3", " ", "parametrized", " ", "in", " ", "terms", " ", "of", " ", 
        SubscriptBox["E", "1"]}]}]}], ",", 
     SubscriptBox["E", "3"]}], "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"cos\[Theta]12", "[", 
      RowBox[{
      "E1_", ",", "E3_", ",", "m_", ",", "m1_", ",", "m2_", ",", "m3_"}], 
      "]"}], "=", 
     FractionBox[
      RowBox[{
       SuperscriptBox[
        RowBox[{"pPar", "[", 
         RowBox[{"E3", ",", "m3"}], "]"}], "2"], "-", 
       SuperscriptBox[
        RowBox[{"pPar", "[", 
         RowBox[{"E1", ",", "m1"}], "]"}], "2"], "-", 
       SuperscriptBox[
        RowBox[{"pPar", "[", 
         RowBox[{
          RowBox[{"E2valEnergies", "[", 
           RowBox[{"m", ",", "E1", ",", "E3"}], "]"}], ",", "m2"}], "]"}], 
        "2"]}], 
      RowBox[{"2", 
       RowBox[{"pPar", "[", 
        RowBox[{"E1", ",", "m1"}], "]"}], "*", 
       RowBox[{"pPar", "[", 
        RowBox[{
         RowBox[{"E2valEnergies", "[", 
          RowBox[{"m", ",", "E1", ",", "E3"}], "]"}], ",", "m2"}], "]"}]}]]}],
     ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"cos\[Theta]13", "[", 
      RowBox[{
      "E1_", ",", "E3_", ",", "m_", ",", "m1_", ",", "m2_", ",", "m3_"}], 
      "]"}], "=", 
     FractionBox[
      RowBox[{
       SuperscriptBox[
        RowBox[{"pPar", "[", 
         RowBox[{
          RowBox[{"E2valEnergies", "[", 
           RowBox[{"m", ",", "E1", ",", "E3"}], "]"}], ",", "m2"}], "]"}], 
        "2"], "-", 
       SuperscriptBox[
        RowBox[{"pPar", "[", 
         RowBox[{"E1", ",", "m1"}], "]"}], "2"], "-", 
       SuperscriptBox[
        RowBox[{"pPar", "[", 
         RowBox[{"E3", ",", "m3"}], "]"}], "2"]}], 
      RowBox[{"2", 
       RowBox[{"pPar", "[", 
        RowBox[{"E1", ",", "m1"}], "]"}], "*", 
       RowBox[{"pPar", "[", 
        RowBox[{"E3", ",", "m3"}], "]"}]}]]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Theta]12", "[", 
      RowBox[{
      "E1_", ",", "E3_", ",", "m_", ",", "m1_", ",", "m2_", ",", "m3_"}], 
      "]"}], "=", 
     RowBox[{"ArcCos", "[", 
      RowBox[{"cos\[Theta]12", "[", 
       RowBox[{"E1", ",", "E3", ",", "m", ",", "m1", ",", "m2", ",", "m3"}], 
       "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Theta]13", "[", 
      RowBox[{
      "E1_", ",", "E3_", ",", "m_", ",", "m1_", ",", "m2_", ",", "m3_"}], 
      "]"}], "=", 
     RowBox[{"ArcCos", "[", 
      RowBox[{"cos\[Theta]13", "[", 
       RowBox[{"E1", ",", "E3", ",", "m", ",", "m1", ",", "m2", ",", "m3"}], 
       "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"Domain", " ", "of", " ", "definition", " ", "of", " ", 
       SubscriptBox["E", "1"], " ", "and", " ", 
       SubscriptBox["E", "3"], " ", "in", " ", "decay", " ", "0"}], "\[Rule]", 
      RowBox[{"1", "+", "2", "+", 
       RowBox[{
       "3", " ", "at", " ", "rest", " ", "frame", " ", "of", " ", "0"}]}]}], ",",
      " ", 
     RowBox[{
      SubscriptBox["E", 
       RowBox[{"3", ",", 
        RowBox[{"min", "/", "max"}]}]], " ", "=", " ", 
      RowBox[{"f", 
       RowBox[{"(", 
        SubscriptBox["E", "1"], ")"}]}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"E3domain", "[", 
     RowBox[{"E1_", ",", "m_", ",", "m1_", ",", "m2_", ",", "m3_"}], "]"}], "=", 
    RowBox[{"E3", "/.", 
     RowBox[{"(*", 
      RowBox[{"Assuming", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"m", ">", "0"}], "&&", 
         RowBox[{"E1", ">", "m1", ">", "0"}]}], ","}]}], "*)"}], 
     RowBox[{"Simplify", "[", 
      RowBox[{"Solve", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"cos\[Theta]12", "[", 
          RowBox[{
          "E1", ",", "E3", ",", "m", ",", "m1", ",", "m2", ",", "m3"}], "]"}],
          "\[Equal]", "1"}], ",", "E3"}], "]"}], "]"}]}]}], 
   RowBox[{"(*", "]", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"E3domainMin", "[", 
      RowBox[{"E1_", ",", "m_", ",", "m1_", ",", "m2_", ",", "m3_"}], "]"}], "=", 
     RowBox[{
      RowBox[{"E3domain", "[", 
       RowBox[{"E1", ",", "m", ",", "m1", ",", "m2", ",", "m3"}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"E3domainMax", "[", 
      RowBox[{"E1_", ",", "m_", ",", "m1_", ",", "m2_", ",", "m3_"}], "]"}], "=", 
     RowBox[{
      RowBox[{"E3domain", "[", 
       RowBox[{"E1", ",", "m", ",", "m1", ",", "m2", ",", "m3"}], "]"}], "[", 
      RowBox[{"[", "2", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[CapitalDelta]E3", "[", 
     RowBox[{"E1_", ",", "m_", ",", "m1_", ",", "m2_", ",", "m3_"}], "]"}], "=", 
    RowBox[{
     RowBox[{
      RowBox[{"E3domainMax", "[", 
       RowBox[{"E1", ",", "m", ",", "m1", ",", "m2", ",", "m3"}], "]"}], "-", 
      RowBox[{"E3domainMin", "[", 
       RowBox[{"E1", ",", "m", ",", "m1", ",", "m2", ",", "m3"}], "]"}]}], "//",
      "Simplify"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"E1domainMin", "[", 
       RowBox[{"m_", ",", "m1_", ",", "m2_", ",", "m3_"}], "]"}], ",", 
      RowBox[{"E1domainMax", "[", 
       RowBox[{"m_", ",", "m1_", ",", "m2_", ",", "m3_"}], "]"}]}], "}"}], "=", 
    RowBox[{
     RowBox[{"E1domain", "[", 
      RowBox[{"m_", ",", "m1_", ",", "m2_", ",", "m3_"}], "]"}], "=", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"E1", "/.", 
         RowBox[{
          RowBox[{"Solve", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"\[CapitalDelta]E3", "[", 
               RowBox[{"E1", ",", "m", ",", "m1", ",", "m2", ",", "m3"}], 
               "]"}], "[", 
              RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", "0"}], ",", "E1"}], 
           "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ",", 
        RowBox[{"E1", "/.", 
         RowBox[{
          RowBox[{"Solve", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"\[CapitalDelta]E3", "[", 
               RowBox[{"E1", ",", "m", ",", "m1", ",", "m2", ",", "m3"}], 
               "]"}], "[", 
              RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", "0"}], ",", "E1"}], 
           "]"}], "[", 
          RowBox[{"[", "3", "]"}], "]"}]}]}], "}"}], "//", "Simplify"}]}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"Domain", " ", "of", " ", "definition", " ", "of", " ", 
       SubscriptBox["E", "1"], " ", "and", " ", 
       SubscriptBox["E", "3"], " ", "in", " ", "decay", " ", "0"}], "\[Rule]", 
      RowBox[{"1", "+", "2", "+", 
       RowBox[{
       "3", " ", "at", " ", "rest", " ", "frame", " ", "of", " ", "0"}]}]}], ",",
      " ", 
     RowBox[{
      RowBox[{"now", " ", 
       SubscriptBox["E", 
        RowBox[{"1", ",", 
         RowBox[{"min", "/", "max"}]}]]}], " ", "=", " ", 
      RowBox[{"f", 
       RowBox[{"(", 
        SubscriptBox["E", "3"], ")"}]}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"E1domain1", "[", 
      RowBox[{"E1_", ",", "m_", ",", "m1_", ",", "m2_", ",", "m3_"}], "]"}], "=", 
     RowBox[{"E1", "/.", 
      RowBox[{"(*", 
       RowBox[{"Assuming", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"m", ">", "0"}], "&&", 
          RowBox[{"E1", ">", "m1", ">", "0"}]}], ","}]}], "*)"}], 
      RowBox[{"Simplify", "[", 
       RowBox[{"Solve", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"cos\[Theta]12", "[", 
           RowBox[{
           "E1", ",", "E3", ",", "m", ",", "m1", ",", "m2", ",", "m3"}], 
           "]"}], "\[Equal]", "1"}], ",", "E1"}], "]"}], "]"}]}]}], 
    RowBox[{"(*", "]", "*)"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"E1domain1Min", "[", 
      RowBox[{"E1_", ",", "m_", ",", "m1_", ",", "m2_", ",", "m3_"}], "]"}], "=", 
     RowBox[{
      RowBox[{"E1domain1", "[", 
       RowBox[{"E3", ",", "m", ",", "m1", ",", "m2", ",", "m3"}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"E1domain1Max", "[", 
      RowBox[{"E1_", ",", "m_", ",", "m1_", ",", "m2_", ",", "m3_"}], "]"}], "=", 
     RowBox[{
      RowBox[{"E1domain1", "[", 
       RowBox[{"E3", ",", "m", ",", "m1", ",", "m2", ",", "m3"}], "]"}], "[", 
      RowBox[{"[", "2", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[CapitalDelta]E1", "[", 
      RowBox[{"E3_", ",", "m_", ",", "m1_", ",", "m2_", ",", "m3_"}], "]"}], "=", 
     RowBox[{
      RowBox[{
       RowBox[{"E1domain1Max", "[", 
        RowBox[{"E3", ",", "m", ",", "m1", ",", "m2", ",", "m3"}], "]"}], "-", 
       RowBox[{"E1domain1Min", "[", 
        RowBox[{"E3", ",", "m", ",", "m1", ",", "m2", ",", "m3"}], "]"}]}], "//",
       "Simplify"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"E3domain1Min", "[", 
        RowBox[{"m_", ",", "m1_", ",", "m2_", ",", "m3_"}], "]"}], ",", 
       RowBox[{"E3domain1Max", "[", 
        RowBox[{"m_", ",", "m1_", ",", "m2_", ",", "m3_"}], "]"}]}], "}"}], "=", 
     RowBox[{
      RowBox[{"E3domain1", "[", 
       RowBox[{"m_", ",", "m1_", ",", "m2_", ",", "m3_"}], "]"}], "=", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"E3", "/.", 
          RowBox[{
           RowBox[{"Solve", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"\[CapitalDelta]E1", "[", 
                RowBox[{"E3", ",", "m", ",", "m1", ",", "m2", ",", "m3"}], 
                "]"}], "[", 
               RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", "0"}], ",", "E3"}],
             "]"}], "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], ",", 
         RowBox[{"E3", "/.", 
          RowBox[{
           RowBox[{"Solve", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"\[CapitalDelta]E1", "[", 
                RowBox[{"E3", ",", "m", ",", "m1", ",", "m2", ",", "m3"}], 
                "]"}], "[", 
               RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", "0"}], ",", "E3"}],
             "]"}], "[", 
           RowBox[{"[", "3", "]"}], "]"}]}]}], "}"}], "//", "Simplify"}]}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Mandelstam", " ", "invariants", " ", "in", " ", "terms", " ", "of", " ", 
     "energies"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"M13", "[", 
     RowBox[{"E1_", ",", "E3_"}], "]"}], "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"E1", "+", "E3"}], ")"}], "2"], "-", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"pPar", "[", 
           RowBox[{"E1", ",", "m1"}], "]"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{"pPar", "[", 
           RowBox[{"E3", ",", "m3"}], "]"}], "2"], "+", 
         RowBox[{"2", "*", 
          RowBox[{"pPar", "[", 
           RowBox[{"E1", ",", "m1"}], "]"}], "*", 
          RowBox[{"pPar", "[", 
           RowBox[{"E3", ",", "m3"}], "]"}], "*", 
          RowBox[{"cos\[Theta]13", "[", 
           RowBox[{
           "E1", ",", "E3", ",", "m", ",", "m1", ",", "m2", ",", "m3"}], 
           "]"}]}]}], ")"}]}], "//", "Expand"}], "//", "Simplify"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"M12", "[", 
     RowBox[{"E1_", ",", "E3_"}], "]"}], "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"E1", "+", 
          RowBox[{"E2valEnergies", "[", 
           RowBox[{"m", ",", "E1", ",", "E3"}], "]"}]}], ")"}], "2"], "-", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"pPar", "[", 
           RowBox[{"E1", ",", "m1"}], "]"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{"pPar", "[", 
           RowBox[{
            RowBox[{"E2valEnergies", "[", 
             RowBox[{"m", ",", "E1", ",", "E3"}], "]"}], ",", "m2"}], "]"}], 
          "2"], "+", 
         RowBox[{"2", "*", 
          RowBox[{"pPar", "[", 
           RowBox[{"E1", ",", "m1"}], "]"}], "*", 
          RowBox[{"pPar", "[", 
           RowBox[{
            RowBox[{"E2valEnergies", "[", 
             RowBox[{"m", ",", "E1", ",", "E3"}], "]"}], ",", "m2"}], "]"}], "*", 
          RowBox[{"cos\[Theta]12", "[", 
           RowBox[{
           "E1", ",", "E3", ",", "m", ",", "m1", ",", "m2", ",", "m3"}], 
           "]"}]}]}], ")"}]}], "//", "Expand"}], "//", "Simplify"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Q2", "[", 
      RowBox[{"E1_", ",", "E3_", ",", "m_", ",", "m2_"}], "]"}], "=", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["m", "2"], "+", 
       SuperscriptBox["m2", "2"], "-", 
       RowBox[{"2", "*", "m", "*", 
        RowBox[{"E2valEnergies", "[", 
         RowBox[{"m", ",", "E1", ",", "E3"}], "]"}]}]}], ")"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "Domain", " ", "of", " ", "the", " ", "parameter", " ", "space", " ", 
      "E1"}], ",", 
     RowBox[{"E3", " ", "for", " ", 
      SubscriptBox["E", "1"], " ", "ranging", " ", "between", " ", 
      SubscriptBox["E", "min"]}], ",", 
     SubscriptBox["E", "max"]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"E12E23domain", "[", 
     RowBox[{
     "m_", ",", "m1_", ",", "m2_", ",", "m3_", ",", "Emin_", ",", "Emax_"}], 
     "]"}], ":=", 
    RowBox[{"NIntegrate", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"UnitStep", "[", 
        RowBox[{"E3v", "-", "Emin"}], "]"}], "*", 
       RowBox[{"UnitStep", "[", 
        RowBox[{"Emax", "-", "E3v"}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"E1v", ",", 
        RowBox[{
         RowBox[{"E1domain", "[", 
          RowBox[{"m", ",", "m1", ",", "m2", ",", "m3"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", 
        RowBox[{
         RowBox[{"E1domain", "[", 
          RowBox[{"m", ",", "m1", ",", "m2", ",", "m3"}], "]"}], "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"E3v", ",", 
        RowBox[{"Max", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"E3domain", "[", 
            RowBox[{"E1v", ",", "m", ",", "m1", ",", "m2", ",", "m3"}], "]"}],
            "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", "Emin"}], "]"}], ",", 
        RowBox[{"Min", "[", 
         RowBox[{"Emax", ",", 
          RowBox[{
           RowBox[{"E3domain", "[", 
            RowBox[{"E1v", ",", "m", ",", "m1", ",", "m2", ",", "m3"}], "]"}],
            "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "}"}], ",", 
      RowBox[{"Method", "\[Rule]", "\"\<AdaptiveMonteCarlo\>\""}]}], 
     "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.8662192582435064`*^9, 3.8662192582584667`*^9}, {
   3.866610001675725*^9, 3.866610002626925*^9}, {3.8666139006159744`*^9, 
   3.8666139334906783`*^9}, {3.8757646808677473`*^9, 3.87576470481641*^9}, {
   3.8757647448275733`*^9, 3.875764745173166*^9}, {3.876214597403404*^9, 
   3.876214626337657*^9}, {3.8762147942378926`*^9, 3.8762149382839117`*^9}, {
   3.877148153494171*^9, 3.877148164766815*^9}, {3.8834977012591114`*^9, 
   3.8834977075782557`*^9}, {3.9156131925566483`*^9, 
   3.9156131929108653`*^9}, {3.9156144517821426`*^9, 3.9156144710290174`*^9}, 
   3.9156150785712*^9, {3.9156159064194365`*^9, 3.915615930107775*^9}, {
   3.9156159746517076`*^9, 3.915615975819049*^9}, {3.91615438896396*^9, 
   3.916154555930756*^9}, {3.916154979282052*^9, 3.916154997843158*^9}, {
   3.9314520012924695`*^9, 3.9314520152095785`*^9}, {3.9315824771090956`*^9, 
   3.9315824772591605`*^9}, {3.9493749939548244`*^9, 3.949374994469452*^9}, {
   3.9493750513231163`*^9, 3.949375051999445*^9}},
 CellTags->"Evaluation",
 CellLabel->"In[24]:=",ExpressionUUID->"50e3a4ce-c57f-9943-9242-08411f82bd50"],

Cell[BoxData[
 FormBox[
  TemplateBox[{
   "Solve", "nongen", 
    "\"There may be values of the parameters for which some or all solutions \
are not valid.\"", 2, 98, 22, 23766920109013692699, "Local"},
   "MessageTemplate",
   BaseStyle->"MSG"], TraditionalForm]], "Message",
 CellChangeTimes->{
  3.933917878350725*^9, 3.933918204238886*^9, 3.9339182968109207`*^9, 
   3.9339183748965206`*^9, 3.933918520332588*^9, 3.933918608964567*^9, 
   3.933918707581867*^9, 3.9339187854816875`*^9, 3.9339188772413464`*^9, 
   3.933919095236042*^9, 3.9339192008221474`*^9, 3.933919362578329*^9, 
   3.933919406647375*^9, 3.933919526499382*^9, 3.93391960285096*^9, 
   3.9339196821491127`*^9, 3.9342794247569876`*^9, {3.9493732963840446`*^9, 
   3.94937330051717*^9}, 3.950089734050255*^9, 3.950154672677862*^9, 
   3.951119914837988*^9, 3.9511204759919624`*^9, 3.9511494997989807`*^9},
 CellTags->"Evaluation",
 CellLabel->
  "During evaluation of \
In[92]:=",ExpressionUUID->"d04be42d-d0de-d949-94b4-c8075cbebc5c"],

Cell[BoxData[
 FormBox[
  RowBox[{"{", 
   RowBox[{
    FractionBox[
     RowBox[{
      SqrtBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["E1", "2"], "-", 
          SuperscriptBox["m1", "2"]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"4", " ", 
           SuperscriptBox["E1", "2"], " ", 
           SuperscriptBox["m", "2"]}], "-", 
          RowBox[{"4", " ", "E1", " ", "m", " ", 
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["m", "2"], "+", 
             SuperscriptBox["m1", "2"], "-", 
             SuperscriptBox["m2", "2"], "-", 
             SuperscriptBox["m3", "2"]}], ")"}]}], "+", 
          SuperscriptBox["m", "4"], "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["m", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["m1", "2"], "-", 
             SuperscriptBox["m2", "2"], "-", 
             SuperscriptBox["m3", "2"]}], ")"}]}], "+", 
          SuperscriptBox["m1", "4"], "-", 
          RowBox[{"2", " ", 
           SuperscriptBox["m1", "2"], " ", 
           SuperscriptBox["m2", "2"]}], "-", 
          RowBox[{"2", " ", 
           SuperscriptBox["m1", "2"], " ", 
           SuperscriptBox["m3", "2"]}], "+", 
          SuperscriptBox["m2", "4"], "-", 
          RowBox[{"2", " ", 
           SuperscriptBox["m2", "2"], " ", 
           SuperscriptBox["m3", "2"]}], "+", 
          SuperscriptBox["m3", "4"]}], ")"}]}]], "-", 
      RowBox[{"2", " ", 
       SuperscriptBox["E1", "2"], " ", "m"}], "+", 
      RowBox[{"3", " ", "E1", " ", 
       SuperscriptBox["m", "2"]}], "+", 
      RowBox[{"E1", " ", 
       SuperscriptBox["m1", "2"]}], "-", 
      RowBox[{"E1", " ", 
       SuperscriptBox["m2", "2"]}], "+", 
      RowBox[{"E1", " ", 
       SuperscriptBox["m3", "2"]}], "-", 
      SuperscriptBox["m", "3"], "-", 
      RowBox[{"m", " ", 
       SuperscriptBox["m1", "2"]}], "+", 
      RowBox[{"m", " ", 
       SuperscriptBox["m2", "2"]}], "-", 
      RowBox[{"m", " ", 
       SuperscriptBox["m3", "2"]}]}], 
     RowBox[{
      RowBox[{"4", " ", "E1", " ", "m"}], "-", 
      RowBox[{"2", " ", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["m", "2"], "+", 
         SuperscriptBox["m1", "2"]}], ")"}]}]}]], ",", 
    RowBox[{"-", 
     FractionBox[
      RowBox[{
       SqrtBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["E1", "2"], "-", 
           SuperscriptBox["m1", "2"]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"4", " ", 
            SuperscriptBox["E1", "2"], " ", 
            SuperscriptBox["m", "2"]}], "-", 
           RowBox[{"4", " ", "E1", " ", "m", " ", 
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["m", "2"], "+", 
              SuperscriptBox["m1", "2"], "-", 
              SuperscriptBox["m2", "2"], "-", 
              SuperscriptBox["m3", "2"]}], ")"}]}], "+", 
           SuperscriptBox["m", "4"], "+", 
           RowBox[{"2", " ", 
            SuperscriptBox["m", "2"], " ", 
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["m1", "2"], "-", 
              SuperscriptBox["m2", "2"], "-", 
              SuperscriptBox["m3", "2"]}], ")"}]}], "+", 
           SuperscriptBox["m1", "4"], "-", 
           RowBox[{"2", " ", 
            SuperscriptBox["m1", "2"], " ", 
            SuperscriptBox["m2", "2"]}], "-", 
           RowBox[{"2", " ", 
            SuperscriptBox["m1", "2"], " ", 
            SuperscriptBox["m3", "2"]}], "+", 
           SuperscriptBox["m2", "4"], "-", 
           RowBox[{"2", " ", 
            SuperscriptBox["m2", "2"], " ", 
            SuperscriptBox["m3", "2"]}], "+", 
           SuperscriptBox["m3", "4"]}], ")"}]}]], "+", 
       RowBox[{"2", " ", 
        SuperscriptBox["E1", "2"], " ", "m"}], "-", 
       RowBox[{"3", " ", "E1", " ", 
        SuperscriptBox["m", "2"]}], "-", 
       RowBox[{"E1", " ", 
        SuperscriptBox["m1", "2"]}], "+", 
       RowBox[{"E1", " ", 
        SuperscriptBox["m2", "2"]}], "-", 
       RowBox[{"E1", " ", 
        SuperscriptBox["m3", "2"]}], "+", 
       SuperscriptBox["m", "3"], "+", 
       RowBox[{"m", " ", 
        SuperscriptBox["m1", "2"]}], "-", 
       RowBox[{"m", " ", 
        SuperscriptBox["m2", "2"]}], "+", 
       RowBox[{"m", " ", 
        SuperscriptBox["m3", "2"]}]}], 
      RowBox[{
       RowBox[{"4", " ", "E1", " ", "m"}], "-", 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["m", "2"], "+", 
          SuperscriptBox["m1", "2"]}], ")"}]}]}]]}]}], "}"}], 
  TraditionalForm]], "Output",
 CellChangeTimes->{
  3.9339178786464653`*^9, 3.9339182045728645`*^9, 3.933918297376322*^9, 
   3.9339183752117596`*^9, 3.933918520652382*^9, 3.9339186092720604`*^9, 
   3.9339187079002247`*^9, 3.9339187859428463`*^9, 3.9339188775983353`*^9, 
   3.9339190955363407`*^9, 3.933919201163019*^9, 3.93391936289126*^9, 
   3.933919406955141*^9, 3.933919526919897*^9, 3.933919603151228*^9, 
   3.93391968245158*^9, 3.934279424854419*^9, {3.9493732969494057`*^9, 
   3.9493733005801525`*^9}, 3.950089734521246*^9, 3.950154673177969*^9, 
   3.9511199151181507`*^9, 3.951120476242464*^9, 3.951149500099039*^9},
 CellTags->"Evaluation",
 CellLabel->"Out[98]=",ExpressionUUID->"46df1fda-de07-b94d-b3d0-2c7e2750ac9c"],

Cell[BoxData[
 FormBox[
  FractionBox[
   SqrtBox[
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["E1", "2"], "-", 
       SuperscriptBox["m1", "2"]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"4", " ", 
        SuperscriptBox["E1", "2"], " ", 
        SuperscriptBox["m", "2"]}], "-", 
       RowBox[{"4", " ", "E1", " ", "m", " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["m", "2"], "+", 
          SuperscriptBox["m1", "2"], "-", 
          SuperscriptBox["m2", "2"], "-", 
          SuperscriptBox["m3", "2"]}], ")"}]}], "+", 
       SuperscriptBox["m", "4"], "+", 
       RowBox[{"2", " ", 
        SuperscriptBox["m", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["m1", "2"], "-", 
          SuperscriptBox["m2", "2"], "-", 
          SuperscriptBox["m3", "2"]}], ")"}]}], "+", 
       SuperscriptBox["m1", "4"], "-", 
       RowBox[{"2", " ", 
        SuperscriptBox["m1", "2"], " ", 
        SuperscriptBox["m2", "2"]}], "-", 
       RowBox[{"2", " ", 
        SuperscriptBox["m1", "2"], " ", 
        SuperscriptBox["m3", "2"]}], "+", 
       SuperscriptBox["m2", "4"], "-", 
       RowBox[{"2", " ", 
        SuperscriptBox["m2", "2"], " ", 
        SuperscriptBox["m3", "2"]}], "+", 
       SuperscriptBox["m3", "4"]}], ")"}]}]], 
   RowBox[{
    RowBox[{"-", 
     RowBox[{"2", " ", "E1", " ", "m"}]}], "+", 
    SuperscriptBox["m", "2"], "+", 
    SuperscriptBox["m1", "2"]}]], TraditionalForm]], "Output",
 CellChangeTimes->{
  3.9339178786464653`*^9, 3.9339182045728645`*^9, 3.933918297376322*^9, 
   3.9339183752117596`*^9, 3.933918520652382*^9, 3.9339186092720604`*^9, 
   3.9339187079002247`*^9, 3.9339187859428463`*^9, 3.9339188775983353`*^9, 
   3.9339190955363407`*^9, 3.933919201163019*^9, 3.93391936289126*^9, 
   3.933919406955141*^9, 3.933919526919897*^9, 3.933919603151228*^9, 
   3.93391968245158*^9, 3.934279424854419*^9, {3.9493732969494057`*^9, 
   3.9493733005801525`*^9}, 3.950089734521246*^9, 3.950154673177969*^9, 
   3.9511199151181507`*^9, 3.951120476242464*^9, 3.951149500128994*^9},
 CellTags->"Evaluation",
 CellLabel->
  "Out[101]=",ExpressionUUID->"f6f59f67-088d-d747-9ea5-6a5df9663043"],

Cell[BoxData[
 FormBox[
  RowBox[{"{", 
   RowBox[{"m1", ",", 
    FractionBox[
     RowBox[{
      SuperscriptBox["m", "2"], "+", 
      SuperscriptBox["m1", "2"], "-", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"m2", "+", "m3"}], ")"}], "2"]}], 
     RowBox[{"2", " ", "m"}]]}], "}"}], TraditionalForm]], "Output",
 CellChangeTimes->{
  3.9339178786464653`*^9, 3.9339182045728645`*^9, 3.933918297376322*^9, 
   3.9339183752117596`*^9, 3.933918520652382*^9, 3.9339186092720604`*^9, 
   3.9339187079002247`*^9, 3.9339187859428463`*^9, 3.9339188775983353`*^9, 
   3.9339190955363407`*^9, 3.933919201163019*^9, 3.93391936289126*^9, 
   3.933919406955141*^9, 3.933919526919897*^9, 3.933919603151228*^9, 
   3.93391968245158*^9, 3.934279424854419*^9, {3.9493732969494057`*^9, 
   3.9493733005801525`*^9}, 3.950089734521246*^9, 3.950154673177969*^9, 
   3.9511199151181507`*^9, 3.951120476242464*^9, 3.9511495001487675`*^9},
 CellTags->"Evaluation",
 CellLabel->
  "Out[102]=",ExpressionUUID->"bcc66a18-0df1-5c49-9ec5-8dcac445adab"],

Cell[BoxData[
 FormBox[
  TemplateBox[{
   "Solve", "nongen", 
    "\"There may be values of the parameters for which some or all solutions \
are not valid.\"", 2, 103, 23, 23766920109013692699, "Local"},
   "MessageTemplate",
   BaseStyle->"MSG"], TraditionalForm]], "Message",
 CellChangeTimes->{
  3.933917878350725*^9, 3.933918204238886*^9, 3.9339182968109207`*^9, 
   3.9339183748965206`*^9, 3.933918520332588*^9, 3.933918608964567*^9, 
   3.933918707581867*^9, 3.9339187854816875`*^9, 3.9339188772413464`*^9, 
   3.933919095236042*^9, 3.9339192008221474`*^9, 3.933919362578329*^9, 
   3.933919406647375*^9, 3.933919526499382*^9, 3.93391960285096*^9, 
   3.9339196821491127`*^9, 3.9342794247569876`*^9, {3.9493732963840446`*^9, 
   3.94937330051717*^9}, 3.950089734050255*^9, 3.950154672677862*^9, 
   3.951119914837988*^9, 3.9511204759919624`*^9, 3.9511495002087364`*^9},
 CellTags->"Evaluation",
 CellLabel->
  "During evaluation of \
In[92]:=",ExpressionUUID->"6b2944ee-e207-0849-98a1-5c9f496b4bd2"],

Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{"2", " ", "E1", " ", "m"}], "+", 
   RowBox[{"2", " ", "E3", " ", "m"}], "-", 
   SuperscriptBox["m", "2"], "+", 
   SuperscriptBox["m2", "2"]}], TraditionalForm]], "Output",
 CellChangeTimes->{
  3.9339178786464653`*^9, 3.9339182045728645`*^9, 3.933918297376322*^9, 
   3.9339183752117596`*^9, 3.933918520652382*^9, 3.9339186092720604`*^9, 
   3.9339187079002247`*^9, 3.9339187859428463`*^9, 3.9339188775983353`*^9, 
   3.9339190955363407`*^9, 3.933919201163019*^9, 3.93391936289126*^9, 
   3.933919406955141*^9, 3.933919526919897*^9, 3.933919603151228*^9, 
   3.93391968245158*^9, 3.934279424854419*^9, {3.9493732969494057`*^9, 
   3.9493733005801525`*^9}, 3.950089734521246*^9, 3.950154673177969*^9, 
   3.9511199151181507`*^9, 3.951120476242464*^9, 3.9511495005989914`*^9},
 CellTags->"Evaluation",
 CellLabel->
  "Out[108]=",ExpressionUUID->"5e431676-5f6b-734b-a2c9-97d8b6510c71"],

Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{"-", 
    RowBox[{"2", " ", "E3", " ", "m"}]}], "+", 
   SuperscriptBox["m", "2"], "+", 
   SuperscriptBox["m3", "2"]}], TraditionalForm]], "Output",
 CellChangeTimes->{
  3.9339178786464653`*^9, 3.9339182045728645`*^9, 3.933918297376322*^9, 
   3.9339183752117596`*^9, 3.933918520652382*^9, 3.9339186092720604`*^9, 
   3.9339187079002247`*^9, 3.9339187859428463`*^9, 3.9339188775983353`*^9, 
   3.9339190955363407`*^9, 3.933919201163019*^9, 3.93391936289126*^9, 
   3.933919406955141*^9, 3.933919526919897*^9, 3.933919603151228*^9, 
   3.93391968245158*^9, 3.934279424854419*^9, {3.9493732969494057`*^9, 
   3.9493733005801525`*^9}, 3.950089734521246*^9, 3.950154673177969*^9, 
   3.9511199151181507`*^9, 3.951120476242464*^9, 3.9511495006219883`*^9},
 CellTags->"Evaluation",
 CellLabel->
  "Out[109]=",ExpressionUUID->"c4d35b19-f313-c945-8358-43b99868967e"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Scalar products in terms of energies 1,3", "Subsubsection",
 CellChangeTimes->{3.8883780749272103`*^9},
 CellTags->
  "Evaluation",ExpressionUUID->"e7775732-ab02-cd4d-8d8e-e3c3972c2d39"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ProductKK", "=", 
   SuperscriptBox["m", "2"]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ProductK2K2", "=", 
   SuperscriptBox["m2", "2"]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ProductK3K3", "=", 
   SuperscriptBox["m3", "2"]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ProductK1K1", "=", 
   SuperscriptBox["m1", "2"]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ProductKK2energy", "=", 
   RowBox[{"m", "*", 
    RowBox[{"E2valEnergies", "[", 
     RowBox[{"m", ",", "E1", ",", "E3"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ProductKK1energy", "=", 
   RowBox[{"m", "*", "E1"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ProductKK3energy", "=", 
   RowBox[{"m", "*", "E3"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ProductK1K3energy", "=", 
   FractionBox[
    RowBox[{
     RowBox[{"M13", "[", 
      RowBox[{"E1", ",", "E3"}], "]"}], "-", 
     SuperscriptBox["m1", "2"], "-", 
     SuperscriptBox["m3", "2"]}], "2"]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ProductK1K2energy", "=", 
   FractionBox[
    RowBox[{
     RowBox[{"M12", "[", 
      RowBox[{"E1", ",", "E3"}], "]"}], "-", 
     SuperscriptBox["m1", "2"], "-", 
     SuperscriptBox["m2", "2"]}], "2"]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ProductK2K3energy", "=", 
   FractionBox[
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["m", "2"], "+", 
      SuperscriptBox["m1", "2"], "-", 
      RowBox[{"2", "*", "m", "*", "E1"}], "-", 
      SuperscriptBox["m2", "2"], "-", 
      SuperscriptBox["m3", "2"]}], ")"}], "2"]}], ";"}]}], "Input",
 CellChangeTimes->{{3.866213385575988*^9, 3.8662134560507917`*^9}, 
   3.8662192582704344`*^9, 3.8666099365476866`*^9, 3.8666100179144545`*^9, {
   3.877148140739134*^9, 3.8771481417900867`*^9}},
 CellTags->"Evaluation",
 CellLabel->"In[44]:=",ExpressionUUID->"ea7b914c-35b0-7047-8285-ef349557e0d5"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["In terms of Mandelstam variables", "Subsection",
 CellChangeTimes->{{3.9501197978999367`*^9, 
  3.950119802647684*^9}},ExpressionUUID->"621bde46-241f-754c-af62-\
53725482a384"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"E2valMandelstam", "[", 
    RowBox[{"m12_", ",", "m1_", ",", "m2_"}], "]"}], "=", 
   FractionBox[
    RowBox[{"(", 
     RowBox[{"m12", "-", 
      SuperscriptBox["m1", "2"], "+", 
      SuperscriptBox["m2", "2"]}], ")"}], 
    RowBox[{"2", "*", 
     RowBox[{"Sqrt", "[", "m12", "]"}]}]]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"E3valMandelstam", "[", 
    RowBox[{"m12_", ",", "MIn_", ",", "m3_"}], "]"}], "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["MIn", "2"], "-", "m12", "-", 
      SuperscriptBox["m3", "2"]}], ")"}], "/", 
    RowBox[{"(", 
     RowBox[{"2", "*", 
      RowBox[{"Sqrt", "[", "m12", "]"}]}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"m23lower", "[", 
    RowBox[{"m12_", ",", "MIn_", ",", "m1_", ",", "m2_", ",", "m3_"}], "]"}], 
   ":=", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"E2valMandelstam", "[", 
         RowBox[{"m12", ",", "m1", ",", "m2"}], "]"}], "+", 
        RowBox[{"E3valMandelstam", "[", 
         RowBox[{"m12", ",", "MIn", ",", "m3"}], "]"}]}], ")"}], "2"], " ", "-",
      " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Sqrt", "[", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"E2valMandelstam", "[", 
            RowBox[{"m12", ",", "m1", ",", "m2"}], "]"}], "2"], "-", 
          SuperscriptBox["m2", "2"]}], "]"}], "+", 
        RowBox[{"Sqrt", "[", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"E3valMandelstam", "[", 
            RowBox[{"m12", ",", "MIn", ",", "m3"}], "]"}], "2"], "-", 
          SuperscriptBox["m3", "2"]}], "]"}]}], ")"}], "2"]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"m23upper", "[", 
    RowBox[{"m12_", ",", "MIn_", ",", "m1_", ",", "m2_", ",", "m3_"}], "]"}], 
   ":=", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"E2valMandelstam", "[", 
         RowBox[{"m12", ",", "m1", ",", "m2"}], "]"}], "+", 
        RowBox[{"E3valMandelstam", "[", 
         RowBox[{"m12", ",", "MIn", ",", "m3"}], "]"}]}], ")"}], "2"], " ", "-",
      " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Sqrt", "[", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"E2valMandelstam", "[", 
            RowBox[{"m12", ",", "m1", ",", "m2"}], "]"}], "2"], "-", 
          SuperscriptBox["m2", "2"]}], "]"}], "-", 
        RowBox[{"Sqrt", "[", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"E3valMandelstam", "[", 
            RowBox[{"m12", ",", "MIn", ",", "m3"}], "]"}], "2"], "-", 
          SuperscriptBox["m3", "2"]}], "]"}]}], ")"}], "2"]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"m12lower", "[", 
    RowBox[{"m1_", ",", "m2_"}], "]"}], "=", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"m1", "+", "m2"}], ")"}], "2"]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"m12upper", "[", 
    RowBox[{"MIn_", ",", "m3_"}], "]"}], "=", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"MIn", "-", "m3"}], ")"}], "2"]}], ";"}]}], "Input",
 CellLabel->"In[54]:=",ExpressionUUID->"8662b543-4ec9-e14a-88a5-66f779fd8093"],

Cell[CellGroupData[{

Cell["Scalar products in terms of Mandelstam variables", "Subsubsection",
 CellChangeTimes->{{3.901259637348508*^9, 3.901259639971365*^9}, {
  3.906087867493623*^9, 3.906087871968361*^9}},
 CellTags->
  "Evaluation",ExpressionUUID->"905634ee-742e-bc4d-a231-50c4cb28823e"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"ProductKK1mandelstam", "=", 
   FractionBox[
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["m", "2"], "+", 
      SuperscriptBox["m1", "2"], "-", "m23"}], ")"}], "2"]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ProductKK3mandelstam", "=", 
   FractionBox[
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["m", "2"], "+", 
      SuperscriptBox["m3", "2"], "-", "m12"}], ")"}], "2"]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ProductKK2mandelstam", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["m", "2"], "-", "ProductKK1mandelstam", "-", 
      "ProductKK3mandelstam"}], ")"}], "//", "Simplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ProductK1K2mandelstam", "=", 
   FractionBox[
    RowBox[{"(", 
     RowBox[{"m12", "-", 
      SuperscriptBox["m1", "2"], "-", 
      SuperscriptBox["m2", "2"]}], ")"}], "2"]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ProductK2K3mandelstam", "=", 
   FractionBox[
    RowBox[{"(", 
     RowBox[{"m23", "-", 
      SuperscriptBox["m2", "2"], "-", 
      SuperscriptBox["m3", "2"]}], ")"}], "2"]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ProductK1K3mandelstam", "=", 
   RowBox[{
    FractionBox[
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["m", "2"], "-", 
       RowBox[{"2", "ProductKK2mandelstam"}], "+", 
       SuperscriptBox["m2", "2"], "-", 
       SuperscriptBox["m1", "2"], "-", 
       SuperscriptBox["m3", "2"]}], ")"}], "2"], "//", "Simplify"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ScalarProduct3body", "[", 
    RowBox[{"1", ",", "2"}], "]"}], "=", "ProductK1K2mandelstam"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ScalarProduct3body", "[", 
    RowBox[{"2", ",", "3"}], "]"}], "=", "ProductK2K3mandelstam"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ScalarProduct3body", "[", 
    RowBox[{"1", ",", "3"}], "]"}], "=", "ProductK1K3mandelstam"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ScalarProduct3body", "[", 
    RowBox[{"1", ",", "1"}], "]"}], "=", 
   SuperscriptBox["m1", "2"]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ScalarProduct3body", "[", 
    RowBox[{"2", ",", "2"}], "]"}], "=", 
   SuperscriptBox["m2", "2"]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ScalarProduct3body", "[", 
    RowBox[{"3", ",", "3"}], "]"}], "=", 
   SuperscriptBox["m3", "2"]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
  "ProductKK", "-", "ProductK1K1", "-", "ProductK2K2", "-", "ProductK3K3", "-", 
   RowBox[{"2", "*", 
    RowBox[{"(", 
     RowBox[{
     "ProductK1K2mandelstam", "+", "ProductK2K3mandelstam", "+", 
      "ProductK1K3mandelstam"}], ")"}]}]}], "//", "Simplify"}]}], "Input",
 CellChangeTimes->{{3.866213352248226*^9, 3.866213379888481*^9}, {
   3.8662135374875436`*^9, 3.8662135727793503`*^9}, {3.8662136178225775`*^9, 
   3.866213642481532*^9}, {3.8662136837232947`*^9, 3.8662138305956106`*^9}, {
   3.866213884907527*^9, 3.8662139114273834`*^9}, {3.866213988475068*^9, 
   3.8662139909787397`*^9}, {3.866609412856109*^9, 3.866609418292795*^9}, {
   3.866609810712554*^9, 3.8666098109191327`*^9}, {3.8666144472253723`*^9, 
   3.8666144539551277`*^9}, {3.8666146012314844`*^9, 3.866614608054815*^9}, {
   3.86661484121432*^9, 3.8666148426241455`*^9}, {3.86661501713356*^9, 
   3.8666150172737417`*^9}, {3.9024174461637278`*^9, 3.9024174464222617`*^9}, 
   3.906087889116532*^9},
 CellTags->"Evaluation",
 CellLabel->"In[60]:=",ExpressionUUID->"714d346e-4dde-a847-92fa-5556cfc06af9"],

Cell[BoxData[
 FormBox["0", TraditionalForm]], "Output",
 CellChangeTimes->{3.9339178792187977`*^9, 3.9339182050648823`*^9, 
  3.933918297908678*^9, 3.9339183757345695`*^9, 3.9339185211634903`*^9, 
  3.9339186097765865`*^9, 3.9339187084260635`*^9, 3.933918786670492*^9, 
  3.933918878071535*^9, 3.9339190960613575`*^9, 3.933919201821911*^9, 
  3.9339193634722424`*^9, 3.933919407468151*^9, 3.933919527465681*^9, 
  3.933919603703642*^9, 3.933919682962641*^9, 3.9342794251073985`*^9, 
  3.9493733008861465`*^9, 3.9500897353699627`*^9, 3.950154674082775*^9, 
  3.9511199203729153`*^9, 3.951120486292185*^9, 3.951149500639921*^9},
 CellTags->"Evaluation",
 CellLabel->
  "Out[140]=",ExpressionUUID->"a01a7681-c6fa-4b48-8190-382a84458306"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "4-momenta of decay products at rest frame as a function of energies ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["E", "1"], ",", 
    SubscriptBox["E", "3"]}], TraditionalForm]],ExpressionUUID->
  "fdacfb1b-f27f-744f-9037-55c4e7ec880f"]
}], "Subsubsection",
 CellChangeTimes->{3.88837808739474*^9},
 CellTags->
  "Evaluation",ExpressionUUID->"f098ccbf-817e-0c45-9814-077d9780e5f5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Rotation", " ", "matrices", " ", "with", " ", "around", " ", "z", " ", 
    "axis", " ", 
    RowBox[{"(", 
     RowBox[{"\[Phi]", " ", "angle"}], ")"}], " ", "and", " ", "x", " ", 
    "axis", " ", 
    RowBox[{"(", 
     RowBox[{"\[Theta]", " ", "angle"}], ")"}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"\[Phi]RotMatrix", "[", "\[Phi]_", "]"}], "=", 
     RowBox[{"(*", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Cos", "[", "\[Phi]", "]"}], ",", 
          RowBox[{"Sin", "[", "\[Phi]", "]"}], ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"Sin", "[", "\[Phi]", "]"}]}], ",", 
          RowBox[{"Cos", "[", "\[Phi]", "]"}], ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "}"}], "*)"}], 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Sin", "[", "\[Phi]", "]"}], ",", 
         RowBox[{"Cos", "[", "\[Phi]", "]"}], ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", 
          RowBox[{"Cos", "[", "\[Phi]", "]"}]}], ",", 
         RowBox[{"Sin", "[", "\[Phi]", "]"}], ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Theta]RotMatrix", "[", "\[Theta]_", "]"}], "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{"Cos", "[", "\[Theta]", "]"}], ",", 
         RowBox[{"Sin", "[", "\[Theta]", "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{"-", 
          RowBox[{"Sin", "[", "\[Theta]", "]"}]}], ",", 
         RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"pvecUnrotated", "[", 
      RowBox[{"px_", ",", "py_", ",", "pz_"}], "]"}], "=", 
     RowBox[{"{", 
      RowBox[{"px", ",", "py", ",", "pz"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"pvecRotated", "[", 
      RowBox[{
      "px_", ",", "py_", ",", "pz_", ",", "\[Theta]V_", ",", "\[Phi]V_"}], 
      "]"}], "=", 
     RowBox[{
      RowBox[{"\[Phi]RotMatrix", "[", "\[Phi]V", "]"}], ".", 
      RowBox[{"\[Theta]RotMatrix", "[", "\[Theta]V", "]"}], ".", 
      RowBox[{"pvecUnrotated", "[", 
       RowBox[{"px", ",", "py", ",", "pz"}], "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Momenta", " ", "at", " ", "frame", " ", "where", " ", 
     SubscriptBox["p", "1"], " ", "is", " ", "aligned", " ", "along", " ", 
     "z", " ", "axis"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"p1unrotated", "=", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", 
       RowBox[{"pPar", "[", 
        RowBox[{"E1", ",", "m1"}], "]"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"p2unrotated", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"pPar", "[", 
         RowBox[{
          RowBox[{"E2valEnergies", "[", 
           RowBox[{"m", ",", "E1", ",", "E3"}], "]"}], ",", "m2"}], "]"}], "*", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Theta]12", "[", 
          RowBox[{
          "E1", ",", "E3", ",", "m", ",", "m1", ",", "m2", ",", "m3"}], "]"}],
          "]"}], "*", 
        RowBox[{"Sin", "[", "\[Kappa]", "]"}]}], ",", 
       RowBox[{
        RowBox[{"pPar", "[", 
         RowBox[{
          RowBox[{"E2valEnergies", "[", 
           RowBox[{"m", ",", "E1", ",", "E3"}], "]"}], ",", "m2"}], "]"}], "*", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Theta]12", "[", 
          RowBox[{
          "E1", ",", "E3", ",", "m", ",", "m1", ",", "m2", ",", "m3"}], "]"}],
          "]"}], "*", 
        RowBox[{"Cos", "[", "\[Kappa]", "]"}]}], ",", 
       RowBox[{
        RowBox[{"pPar", "[", 
         RowBox[{
          RowBox[{"E2valEnergies", "[", 
           RowBox[{"m", ",", "E1", ",", "E3"}], "]"}], ",", "m2"}], "]"}], "*", 
        RowBox[{"Cos", "[", 
         RowBox[{"\[Theta]12", "[", 
          RowBox[{
          "E1", ",", "E3", ",", "m", ",", "m1", ",", "m2", ",", "m3"}], "]"}],
          "]"}]}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"p3unrotated", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         RowBox[{"pPar", "[", 
          RowBox[{"E3", ",", "m3"}], "]"}]}], "*", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Theta]13", "[", 
          RowBox[{
          "E1", ",", "E3", ",", "m", ",", "m1", ",", "m2", ",", "m3"}], "]"}],
          "]"}], "*", 
        RowBox[{"Sin", "[", "\[Kappa]", "]"}]}], ",", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"pPar", "[", 
          RowBox[{"E3", ",", "m3"}], "]"}]}], "*", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Theta]13", "[", 
          RowBox[{
          "E1", ",", "E3", ",", "m", ",", "m1", ",", "m2", ",", "m3"}], "]"}],
          "]"}], "*", 
        RowBox[{"Cos", "[", "\[Kappa]", "]"}]}], ",", 
       RowBox[{
        RowBox[{"pPar", "[", 
         RowBox[{"E3", ",", "m3"}], "]"}], "*", 
        RowBox[{"Cos", "[", 
         RowBox[{"\[Theta]13", "[", 
          RowBox[{
          "E1", ",", "E3", ",", "m", ",", "m1", ",", "m2", ",", "m3"}], "]"}],
          "]"}]}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"\[Theta]rand", "=", 
      RowBox[{"RandomReal", "[", 
       RowBox[{"{", 
        RowBox[{"0", ",", "Pi"}], "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Phi]rand", "=", 
      RowBox[{"RandomReal", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "Pi"}], ",", "Pi"}], "}"}], "]"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"p1rotated", "[", 
      RowBox[{"E1_", ",", "m1_", ",", "\[Theta]V_", ",", "\[Phi]V_"}], "]"}], 
     "=", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"\[Phi]RotMatrix", "[", "\[Phi]V", "]"}], ".", 
       RowBox[{"\[Theta]RotMatrix", "[", "\[Theta]V", "]"}], ".", 
       "p1Unrotated"}], "*)"}], 
     RowBox[{"pvecRotated", "[", 
      RowBox[{
       RowBox[{"p1unrotated", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", 
       RowBox[{"p1unrotated", "[", 
        RowBox[{"[", "2", "]"}], "]"}], ",", 
       RowBox[{"p1unrotated", "[", 
        RowBox[{"[", "3", "]"}], "]"}], ",", "\[Theta]V", ",", "\[Phi]V"}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"p1rotatedX", "[", 
      RowBox[{"E1_", ",", "m1_", ",", "\[Theta]V_", ",", "\[Phi]V_"}], "]"}], 
     "=", 
     RowBox[{
      RowBox[{"p1rotated", "[", 
       RowBox[{"E1", ",", "m1", ",", "\[Theta]V", ",", "\[Phi]V"}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"p1rotatedY", "[", 
      RowBox[{"E1_", ",", "m1_", ",", "\[Theta]V_", ",", "\[Phi]V_"}], "]"}], 
     "=", 
     RowBox[{
      RowBox[{"p1rotated", "[", 
       RowBox[{"E1", ",", "m1", ",", "\[Theta]V", ",", "\[Phi]V"}], "]"}], "[", 
      RowBox[{"[", "2", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"p1rotatedZ", "[", 
      RowBox[{"E1_", ",", "m1_", ",", "\[Theta]V_", ",", "\[Phi]V_"}], "]"}], 
     "=", 
     RowBox[{
      RowBox[{"p1rotated", "[", 
       RowBox[{"E1", ",", "m1", ",", "\[Theta]V", ",", "\[Phi]V"}], "]"}], "[", 
      RowBox[{"[", "3", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"p2rotated", "[", 
      RowBox[{
      "E1_", ",", "E3_", ",", "m_", ",", "m1_", ",", "m2_", ",", "m3_", ",", 
       "\[Theta]V_", ",", "\[Phi]V_", ",", "\[Kappa]_"}], "]"}], "=", 
     RowBox[{
      RowBox[{"pvecRotated", "[", 
       RowBox[{
        RowBox[{"p2unrotated", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", 
        RowBox[{"p2unrotated", "[", 
         RowBox[{"[", "2", "]"}], "]"}], ",", 
        RowBox[{"p2unrotated", "[", 
         RowBox[{"[", "3", "]"}], "]"}], ",", "\[Theta]V", ",", "\[Phi]V"}], 
       "]"}], "//", "Simplify"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"p2rotatedX", "[", 
      RowBox[{
      "E1_", ",", "E3_", ",", "m_", ",", "m1_", ",", "m2_", ",", "m3_", ",", 
       "\[Theta]V_", ",", "\[Phi]V_", ",", "\[Kappa]_"}], "]"}], "=", 
     RowBox[{
      RowBox[{"p2rotated", "[", 
       RowBox[{
       "E1", ",", "E3", ",", "m", ",", "m1", ",", "m2", ",", "m3", ",", 
        "\[Theta]V", ",", "\[Phi]V", ",", "\[Kappa]"}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"p2rotatedY", "[", 
      RowBox[{
      "E1_", ",", "E3_", ",", "m_", ",", "m1_", ",", "m2_", ",", "m3_", ",", 
       "\[Theta]V_", ",", "\[Phi]V_", ",", "\[Kappa]_"}], "]"}], "=", 
     RowBox[{
      RowBox[{"p2rotated", "[", 
       RowBox[{
       "E1", ",", "E3", ",", "m", ",", "m1", ",", "m2", ",", "m3", ",", 
        "\[Theta]V", ",", "\[Phi]V", ",", "\[Kappa]"}], "]"}], "[", 
      RowBox[{"[", "2", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"p2rotatedZ", "[", 
      RowBox[{
      "E1_", ",", "E3_", ",", "m_", ",", "m1_", ",", "m2_", ",", "m3_", ",", 
       "\[Theta]V_", ",", "\[Phi]V_", ",", "\[Kappa]_"}], "]"}], "=", 
     RowBox[{
      RowBox[{"p2rotated", "[", 
       RowBox[{
       "E1", ",", "E3", ",", "m", ",", "m1", ",", "m2", ",", "m3", ",", 
        "\[Theta]V", ",", "\[Phi]V", ",", "\[Kappa]"}], "]"}], "[", 
      RowBox[{"[", "3", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"p3rotated", "[", 
      RowBox[{
      "E1_", ",", "E3_", ",", "m_", ",", "m1_", ",", "m2_", ",", "m3_", ",", 
       "\[Theta]V_", ",", "\[Phi]V_", ",", "\[Kappa]_"}], "]"}], "=", 
     RowBox[{
      RowBox[{"pvecRotated", "[", 
       RowBox[{
        RowBox[{"p3unrotated", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", 
        RowBox[{"p3unrotated", "[", 
         RowBox[{"[", "2", "]"}], "]"}], ",", 
        RowBox[{"p3unrotated", "[", 
         RowBox[{"[", "3", "]"}], "]"}], ",", "\[Theta]V", ",", "\[Phi]V"}], 
       "]"}], "//", "Simplify"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"p3rotatedX", "[", 
      RowBox[{
      "E1_", ",", "E3_", ",", "m_", ",", "m1_", ",", "m2_", ",", "m3_", ",", 
       "\[Theta]V_", ",", "\[Phi]V_", ",", "\[Kappa]_"}], "]"}], "=", 
     RowBox[{
      RowBox[{"p3rotated", "[", 
       RowBox[{
       "E1", ",", "E3", ",", "m", ",", "m1", ",", "m2", ",", "m3", ",", 
        "\[Theta]V", ",", "\[Phi]V", ",", "\[Kappa]"}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"p3rotatedY", "[", 
      RowBox[{
      "E1_", ",", "E3_", ",", "m_", ",", "m1_", ",", "m2_", ",", "m3_", ",", 
       "\[Theta]V_", ",", "\[Phi]V_", ",", "\[Kappa]_"}], "]"}], "=", 
     RowBox[{
      RowBox[{"p3rotated", "[", 
       RowBox[{
       "E1", ",", "E3", ",", "m", ",", "m1", ",", "m2", ",", "m3", ",", 
        "\[Theta]V", ",", "\[Phi]V", ",", "\[Kappa]"}], "]"}], "[", 
      RowBox[{"[", "2", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"p3rotatedZ", "[", 
      RowBox[{
      "E1_", ",", "E3_", ",", "m_", ",", "m1_", ",", "m2_", ",", "m3_", ",", 
       "\[Theta]V_", ",", "\[Phi]V_", ",", "\[Kappa]_"}], "]"}], "=", 
     RowBox[{
      RowBox[{"p3rotated", "[", 
       RowBox[{
       "E1", ",", "E3", ",", "m", ",", "m1", ",", "m2", ",", "m3", ",", 
        "\[Theta]V", ",", "\[Phi]V", ",", "\[Kappa]"}], "]"}], "[", 
      RowBox[{"[", "3", "]"}], "]"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.875774080283636*^9, 3.8757740812840986`*^9}, {
  3.938250720989317*^9, 3.938250742376274*^9}},
 CellTags->"Evaluation",
 CellLabel->"In[73]:=",ExpressionUUID->"706787b6-303a-be4d-be90-81bac26582a0"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1430.25, 822.75},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"14.2 for Microsoft Windows (64-bit) (December 26, 2024)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"fc010998-63d0-4d56-8e58-7c353291c23f"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{
 "Evaluation"->{
  Cell[19090, 489, 208, 3, 53, "Subsection",ExpressionUUID->"875269e7-e121-b04b-a19a-f8c8239fe841",
   CellTags->"Evaluation"],
  Cell[19301, 494, 23783, 486, 1450, "Input",ExpressionUUID->"5aa4d321-ccd4-704d-9042-abd2a19077ee",
   CellTags->"Evaluation"],
  Cell[43532, 1001, 230, 4, 53, "Subsection",ExpressionUUID->"24893949-96b9-cc49-b120-f3bc6d74defe",
   CellTags->"Evaluation"],
  Cell[43765, 1007, 16641, 383, 982, "Input",ExpressionUUID->"0dd694c5-8553-bc40-823f-9805267e9f08",
   CellTags->"Evaluation"],
  Cell[60455, 1396, 224, 4, 66, "Section",ExpressionUUID->"5892fdf5-ae95-fd44-856b-bdbadbe7e31f",
   CellTags->"Evaluation"],
  Cell[60704, 1404, 503, 13, 53, "Subsection",ExpressionUUID->"8707483c-2746-fe4e-a454-074c1cf30e67",
   CellTags->"Evaluation"],
  Cell[61232, 1421, 17096, 448, 682, "Input",ExpressionUUID->"50e3a4ce-c57f-9943-9242-08411f82bd50",
   CellTags->"Evaluation"],
  Cell[78331, 1871, 1006, 20, 26, "Message",ExpressionUUID->"d04be42d-d0de-d949-94b4-c8075cbebc5c",
   CellTags->"Evaluation"],
  Cell[79340, 1893, 5411, 144, 111, "Output",ExpressionUUID->"46df1fda-de07-b94d-b3d0-2c7e2750ac9c",
   CellTags->"Evaluation"],
  Cell[84754, 2039, 2227, 57, 54, "Output",ExpressionUUID->"f6f59f67-088d-d747-9ea5-6a5df9663043",
   CellTags->"Evaluation"],
  Cell[86984, 2098, 1044, 23, 48, "Output",ExpressionUUID->"bcc66a18-0df1-5c49-9ec5-8dcac445adab",
   CellTags->"Evaluation"],
  Cell[88031, 2123, 1007, 20, 26, "Message",ExpressionUUID->"6b2944ee-e207-0849-98a1-5c9f496b4bd2",
   CellTags->"Evaluation"],
  Cell[89041, 2145, 931, 18, 31, "Output",ExpressionUUID->"5e431676-5f6b-734b-a2c9-97d8b6510c71",
   CellTags->"Evaluation"],
  Cell[89975, 2165, 906, 18, 31, "Output",ExpressionUUID->"c4d35b19-f313-c945-8358-43b99868967e",
   CellTags->"Evaluation"],
  Cell[90918, 2188, 192, 3, 43, "Subsubsection",ExpressionUUID->"e7775732-ab02-cd4d-8d8e-e3c3972c2d39",
   CellTags->"Evaluation"],
  Cell[91113, 2193, 1975, 54, 265, "Input",ExpressionUUID->"ea7b914c-35b0-7047-8285-ef349557e0d5",
   CellTags->"Evaluation"],
  Cell[96736, 2362, 271, 4, 43, "Subsubsection",ExpressionUUID->"905634ee-742e-bc4d-a231-50c4cb28823e",
   CellTags->"Evaluation"],
  Cell[97032, 2370, 3654, 94, 378, "Input",ExpressionUUID->"714d346e-4dde-a847-92fa-5556cfc06af9",
   CellTags->"Evaluation"],
  Cell[100689, 2466, 735, 12, 31, "Output",ExpressionUUID->"a01a7681-c6fa-4b48-8190-382a84458306",
   CellTags->"Evaluation"],
  Cell[101473, 2484, 412, 11, 43, "Subsubsection",ExpressionUUID->"f098ccbf-817e-0c45-9814-077d9780e5f5",
   CellTags->"Evaluation"],
  Cell[101888, 2497, 12245, 319, 465, "Input",ExpressionUUID->"706787b6-303a-be4d-be90-81bac26582a0",
   CellTags->"Evaluation"]}
 }
*)
(*CellTagsIndex
CellTagsIndex->{
 {"Evaluation", 114544, 2833}
 }
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 163, 3, 67, "Chapter",ExpressionUUID->"198bcc9e-1875-4b98-996e-78ab8c9d3f6c"],
Cell[CellGroupData[{
Cell[768, 29, 15326, 384, 791, "Input",ExpressionUUID->"51eb07f8-2fcc-4739-9f94-5f94c244248f"],
Cell[16097, 415, 591, 13, 26, "Message",ExpressionUUID->"c0ab3652-c2e5-4244-890d-6a7ff06a5581"],
Cell[16691, 430, 618, 11, 22, "Print",ExpressionUUID->"7f5b99c7-6c86-2743-89c8-343b41c4ba2e"],
Cell[17312, 443, 373, 7, 31, "Output",ExpressionUUID->"bb0a5403-2db6-154d-87f5-ee6743cd2d42"],
Cell[17688, 452, 679, 12, 22, "Print",ExpressionUUID->"86dffb9b-5107-8942-8231-a9e5fbc3aa0f"],
Cell[18370, 466, 499, 11, 31, "Output",ExpressionUUID->"e63a8270-dd69-fb4a-9736-0d8faf62c325"]
}, Open  ]],
Cell[CellGroupData[{
Cell[18906, 482, 159, 3, 66, "Section",ExpressionUUID->"60ed4932-68a8-6c45-91f2-9bb2f7894f84"],
Cell[CellGroupData[{
Cell[19090, 489, 208, 3, 53, "Subsection",ExpressionUUID->"875269e7-e121-b04b-a19a-f8c8239fe841",
 CellTags->"Evaluation"],
Cell[19301, 494, 23783, 486, 1450, "Input",ExpressionUUID->"5aa4d321-ccd4-704d-9042-abd2a19077ee",
 CellTags->"Evaluation"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[43145, 987, 155, 3, 67, "Chapter",ExpressionUUID->"3d06a620-6a60-3645-a7e6-f1f5bd7f2aec"],
Cell[CellGroupData[{
Cell[43325, 994, 182, 3, 66, "Section",ExpressionUUID->"13ee7615-3001-6947-b7a8-a3224acc3e58"],
Cell[CellGroupData[{
Cell[43532, 1001, 230, 4, 53, "Subsection",ExpressionUUID->"24893949-96b9-cc49-b120-f3bc6d74defe",
 CellTags->"Evaluation"],
Cell[43765, 1007, 16641, 383, 982, "Input",ExpressionUUID->"0dd694c5-8553-bc40-823f-9805267e9f08",
 CellTags->"Evaluation"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[60455, 1396, 224, 4, 66, "Section",ExpressionUUID->"5892fdf5-ae95-fd44-856b-bdbadbe7e31f",
 CellTags->"Evaluation"],
Cell[CellGroupData[{
Cell[60704, 1404, 503, 13, 53, "Subsection",ExpressionUUID->"8707483c-2746-fe4e-a454-074c1cf30e67",
 CellTags->"Evaluation"],
Cell[CellGroupData[{
Cell[61232, 1421, 17096, 448, 682, "Input",ExpressionUUID->"50e3a4ce-c57f-9943-9242-08411f82bd50",
 CellTags->"Evaluation"],
Cell[78331, 1871, 1006, 20, 26, "Message",ExpressionUUID->"d04be42d-d0de-d949-94b4-c8075cbebc5c",
 CellTags->"Evaluation"],
Cell[79340, 1893, 5411, 144, 111, "Output",ExpressionUUID->"46df1fda-de07-b94d-b3d0-2c7e2750ac9c",
 CellTags->"Evaluation"],
Cell[84754, 2039, 2227, 57, 54, "Output",ExpressionUUID->"f6f59f67-088d-d747-9ea5-6a5df9663043",
 CellTags->"Evaluation"],
Cell[86984, 2098, 1044, 23, 48, "Output",ExpressionUUID->"bcc66a18-0df1-5c49-9ec5-8dcac445adab",
 CellTags->"Evaluation"],
Cell[88031, 2123, 1007, 20, 26, "Message",ExpressionUUID->"6b2944ee-e207-0849-98a1-5c9f496b4bd2",
 CellTags->"Evaluation"],
Cell[89041, 2145, 931, 18, 31, "Output",ExpressionUUID->"5e431676-5f6b-734b-a2c9-97d8b6510c71",
 CellTags->"Evaluation"],
Cell[89975, 2165, 906, 18, 31, "Output",ExpressionUUID->"c4d35b19-f313-c945-8358-43b99868967e",
 CellTags->"Evaluation"]
}, Open  ]],
Cell[CellGroupData[{
Cell[90918, 2188, 192, 3, 43, "Subsubsection",ExpressionUUID->"e7775732-ab02-cd4d-8d8e-e3c3972c2d39",
 CellTags->"Evaluation"],
Cell[91113, 2193, 1975, 54, 265, "Input",ExpressionUUID->"ea7b914c-35b0-7047-8285-ef349557e0d5",
 CellTags->"Evaluation"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[93137, 2253, 182, 3, 53, "Subsection",ExpressionUUID->"621bde46-241f-754c-af62-53725482a384"],
Cell[93322, 2258, 3389, 100, 194, "Input",ExpressionUUID->"8662b543-4ec9-e14a-88a5-66f779fd8093"],
Cell[CellGroupData[{
Cell[96736, 2362, 271, 4, 43, "Subsubsection",ExpressionUUID->"905634ee-742e-bc4d-a231-50c4cb28823e",
 CellTags->"Evaluation"],
Cell[CellGroupData[{
Cell[97032, 2370, 3654, 94, 378, "Input",ExpressionUUID->"714d346e-4dde-a847-92fa-5556cfc06af9",
 CellTags->"Evaluation"],
Cell[100689, 2466, 735, 12, 31, "Output",ExpressionUUID->"a01a7681-c6fa-4b48-8190-382a84458306",
 CellTags->"Evaluation"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[101473, 2484, 412, 11, 43, "Subsubsection",ExpressionUUID->"f098ccbf-817e-0c45-9814-077d9780e5f5",
 CellTags->"Evaluation"],
Cell[101888, 2497, 12245, 319, 465, "Input",ExpressionUUID->"706787b6-303a-be4d-be90-81bac26582a0",
 CellTags->"Evaluation"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

