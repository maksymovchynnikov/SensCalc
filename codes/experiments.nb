(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    948723,      24950]
NotebookOptionsPosition[    927369,      24563]
NotebookOutlinePosition[    927776,      24579]
CellTagsIndexPosition[    927733,      24576]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Definitions", "Chapter",
 CellChangeTimes->{{3.9152561597311115`*^9, 
  3.9152561617465134`*^9}},ExpressionUUID->"d9d3b17d-90ec-48bc-b972-\
320393e3a836"],

Cell[CellGroupData[{

Cell["\<\
SM particles production cross-sections  at various facilities\
\>", "Section",
 CellChangeTimes->{{3.905016415217827*^9, 3.9050164441652765`*^9}, {
  3.9145610733681173`*^9, 
  3.9145610986100464`*^9}},ExpressionUUID->"7c91f1fb-76f0-45b4-b381-\
f8e96e41b025"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"theta", "[", "\[Eta]_", "]"}], "=", 
   RowBox[{"2", "*", 
    RowBox[{"ArcTan", "[", 
     RowBox[{"Exp", "[", 
      RowBox[{"-", "\[Eta]"}], "]"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"\[Sigma]ppInpbFacility", ":=", 
  RowBox[{"Association", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\"\<FermilabBD\>\"", "\[Rule]", " ", 
      RowBox[{"40.", "*", 
       SuperscriptBox["10", "9"]}]}], ",", " ", 
     RowBox[{"\"\<SPS\>\"", "\[Rule]", 
      RowBox[{"40.", "*", 
       SuperscriptBox["10", "9"]}]}], ",", 
     RowBox[{"\"\<LHC\>\"", "\[Rule]", " ", 
      RowBox[{"72.", "*", 
       SuperscriptBox["10", "9"]}]}], ",", 
     RowBox[{"\"\<FCC-hh\>\"", "\[Rule]", 
      RowBox[{"104.", "*", 
       SuperscriptBox["10", "9"]}]}], ",", 
     RowBox[{"\"\<Serpukhov\>\"", "->", 
      RowBox[{"40.", "*", 
       SuperscriptBox["10", "9"]}]}], ",", 
     RowBox[{"\"\<ESS\>\"", "->", 
      RowBox[{"45.", "*", 
       SuperscriptBox["10", "9"]}]}]}], "}"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"LLHChighLumi", "=", 
   RowBox[{"3000", "*", 
    SuperscriptBox["10", "3"]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"LFCChh", "=", 
    RowBox[{"20000", "*", 
     SuperscriptBox["10", "3"]}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Cross", "-", 
     RowBox[{"sections", " ", "in", " ", "pb", " ", "of", " ", "b", 
      OverscriptBox["b", "_"], " ", 
      RowBox[{"production", ".", " ", "For"}], " ", 
      RowBox[{"Fermilab", "/", "FCC"}]}], "-", 
     RowBox[{"hh", " ", "taken", " ", "from", " ", "pythia"}]}], ",", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"for", " ", "SPS", " ", "taken", " ", "from", " ", 
       RowBox[{"http", ":"}]}], "//", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"cds", ".", "cern", ".", "ch"}], "/", "record"}], "/", 
          "2115534"}], "/", "files"}], "/", "SHiP"}], "-", "NOTE", "-", 
       "2015", "-", 
       RowBox[{"009.", 
        RowBox[{"pdf", "?", "version"}]}]}]}], "=", "1"}], ",", " ", 
    RowBox[{
    "for", " ", "LHC", " ", "taken", " ", "from", " ", "FONLL", " ", "at", 
     " ", "the", " ", "upper", " ", "bound", " ", "of", " ", 
     "uncertainty"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Sigma]ppTobbInpbFacility", ":=", 
   RowBox[{"Association", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\"\<FermilabBD\>\"", "\[Rule]", "3.8"}], ",", 
      RowBox[{"\"\<SPS\>\"", "\[Rule]", 
       RowBox[{"1.7", "*", 
        SuperscriptBox["10", "3"]}]}], ",", 
      RowBox[{"\"\<LHC\>\"", "\[Rule]", 
       RowBox[{"6.2", "*", 
        SuperscriptBox["10", "8"]}]}], ",", 
      RowBox[{"\"\<FCC-hh\>\"", "\[Rule]", 
       RowBox[{"3.4", "*", 
        SuperscriptBox["10", "9"]}]}], ",", 
      RowBox[{"\"\<Serpukhov\>\"", "->", "0."}], ",", 
      RowBox[{"\"\<ESS\>\"", "->", "0."}]}], "}"}], "]"}]}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Cross", "-", 
     RowBox[{"sections", " ", "in", " ", "pb", " ", "of", " ", "c", 
      OverscriptBox["c", "_"], " ", 
      RowBox[{"production", ".", " ", "For"}], " ", 
      RowBox[{"Fermilab", "/", "FCC"}]}], "-", 
     RowBox[{"hh", " ", "taken", " ", "from", " ", "pythia"}]}], ",", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"for", " ", "SPS", " ", "taken", " ", "from", " ", 
       RowBox[{"http", ":"}]}], "//", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"cds", ".", "cern", ".", "ch"}], "/", "record"}], "/", 
          "2115534"}], "/", "files"}], "/", "SHiP"}], "-", "NOTE", "-", 
       "2015", "-", 
       RowBox[{"009.", 
        RowBox[{"pdf", "?", "version"}]}]}]}], "=", "1"}], ",", " ", 
    RowBox[{
    "for", " ", "LHC", " ", "taken", " ", "from", " ", "FONLL", " ", "at", 
     " ", "the", " ", "upper", " ", "bound", " ", "of", " ", 
     "uncertainty"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Sigma]ppToccInpbFacility", ":=", 
   RowBox[{"Association", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\"\<FermilabBD\>\"", "\[Rule]", 
       RowBox[{"0.5", "*", 
        SuperscriptBox["10", "6"]}]}], ",", 
      RowBox[{"\"\<SPS\>\"", "\[Rule]", 
       RowBox[{"1.8", "*", 
        SuperscriptBox["10", "7"]}]}], ",", 
      RowBox[{"\"\<LHC\>\"", "\[Rule]", 
       RowBox[{"1.8", "*", 
        SuperscriptBox["10", "10"]}]}], ",", 
      RowBox[{"\"\<FCC-hh\>\"", "\[Rule]", 
       RowBox[{"4", "*", 
        SuperscriptBox["10", "10"]}]}], ",", 
      RowBox[{"\"\<Serpukhov\>\"", "->", "0."}], ",", 
      RowBox[{"\"\<ESS\>\"", "->", "0."}]}], "}"}], "]"}]}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Data", " ", "for", " ", "Higgs", " ", 
     RowBox[{"production", ".", " ", "For"}], " ", "LHC"}], ",", " ", 
    RowBox[{
     RowBox[{"used", " ", 
      RowBox[{"https", ":"}]}], "//", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"twiki", ".", "cern", ".", "ch"}], "/", "twiki"}], "/", 
           "bin"}], "/", "view"}], "/", "LHCPhysics"}], "/", 
        RowBox[{"HiggsEuropeanStrategy", ".", " ", "For"}]}], " ", "FCC"}], 
      "-", "hh"}]}], ",", " ", 
    RowBox[{"pythia8", " ", "is", " ", "used"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Sigma]ppTohInpbFacility", ":=", 
   RowBox[{"Association", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\"\<FermilabBD\>\"", "\[Rule]", " ", "0."}], ",", 
      RowBox[{"\"\<SPS\>\"", "\[Rule]", "0."}], ",", 
      RowBox[{"\"\<LHC\>\"", "\[Rule]", "55"}], ",", 
      RowBox[{"\"\<FCC-hh\>\"", "\[Rule]", "552."}], ",", 
      RowBox[{"\"\<Serpukhov\>\"", "->", "0."}], ",", 
      RowBox[{"\"\<ESS\>\"", "->", "0."}]}], "}"}], "]"}]}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Data", " ", "for", " ", "the", " ", "production", " ", "of", " ", "light",
     " ", 
    RowBox[{"mesons", ".", " ", "P"}], " ", "means", " ", "the", " ", 
    "fraction", " ", "per", " ", "collision"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"For", " ", "SPS"}], ",", " ", 
    RowBox[{
     RowBox[{
     "the", " ", "multiplicities", " ", "are", " ", "taken", " ", "from", " ", 
      RowBox[{"https", ":"}]}], "//", 
     RowBox[{"lib", "-", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"extopc", ".", "kek", ".", "jp"}], "/", "preprints"}], 
           "/", "PDF"}], "/", "1991"}], "/", "9103"}], "/", "9103008."}], 
       "pdf"}]}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"For", " ", "Fermilab"}], ",", " ", 
    RowBox[{
     RowBox[{
     "obtained", " ", "using", " ", "the", " ", "approach", " ", "from", " ", 
      RowBox[{"https", ":"}]}], "//", 
     RowBox[{
      RowBox[{
       RowBox[{"arxiv", ".", "org"}], "/", "pdf"}], "/", 
      RowBox[{"2201.05170", ".", "pdf"}]}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"For", " ", "Serpukhov", " ", 
     RowBox[{"(", "NuCal", ")"}]}], ",", " ", 
    RowBox[{
    "the", " ", "pythia8", " ", "simulation", " ", "is", " ", "used"}]}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"For", " ", 
     RowBox[{"LHC", "/", "FCC"}]}], "-", 
    RowBox[{"hh", " ", "used", " ", "EPOS"}], "-", "LHC"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"PppTo\[Pi]0Facility", ":=", 
  RowBox[{"Association", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\"\<FermilabBD\>\"", "\[Rule]", "2.9"}], ",", 
     RowBox[{"\"\<SPS\>\"", "\[Rule]", "6.2"}], ",", 
     RowBox[{"\"\<LHC\>\"", "\[Rule]", "42.8"}], ",", 
     RowBox[{"\"\<FCC-hh\>\"", "\[Rule]", "73.8"}], ",", 
     RowBox[{"\"\<Serpukhov\>\"", "->", "2.37"}], ",", 
     RowBox[{"\"\<ESS\>\"", "->", "0.59"}]}], "}"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"PppTo\[Eta]Facility", ":=", 
  RowBox[{"Association", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\"\<FermilabBD\>\"", "\[Rule]", "0.32"}], ",", 
     RowBox[{"\"\<SPS\>\"", "\[Rule]", "0.8"}], ",", 
     RowBox[{"\"\<LHC\>\"", "\[Rule]", "4.7"}], ",", 
     RowBox[{"\"\<FCC-hh\>\"", "\[Rule]", "8.3"}], ",", 
     RowBox[{"\"\<Serpukhov\>\"", "->", "0.211"}], ",", 
     RowBox[{"\"\<ESS\>\"", "->", "0."}]}], "}"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"PppTo\[Eta]prFacility", ":=", 
  RowBox[{"Association", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\"\<FermilabBD\>\"", "\[Rule]", "0.033"}], ",", 
     RowBox[{"\"\<SPS\>\"", "\[Rule]", "0.079"}], ",", 
     RowBox[{"\"\<LHC\>\"", "\[Rule]", "0.5"}], ",", 
     RowBox[{"\"\<FCC-hh\>\"", "\[Rule]", "1.1"}], ",", 
     RowBox[{"\"\<Serpukhov\>\"", "->", "0.027"}], ",", 
     RowBox[{"\"\<ESS\>\"", "->", "0."}]}], "}"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"PppTo\[Rho]0Facility", ":=", 
  RowBox[{"Association", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\"\<FermilabBD\>\"", "\[Rule]", "0.36"}], ",", 
     RowBox[{"\"\<SPS\>\"", "\[Rule]", "0.548"}], ",", 
     RowBox[{"\"\<LHC\>\"", "\[Rule]", "5.16"}], ",", 
     RowBox[{"\"\<FCC-hh\>\"", "\[Rule]", "8.26"}], ",", 
     RowBox[{"\"\<Serpukhov\>\"", "->", "0.294"}], ",", 
     RowBox[{"\"\<ESS\>\"", "->", "0."}]}], "}"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PppTo\[Omega]Facility", ":=", 
   RowBox[{"Association", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\"\<FermilabBD\>\"", "\[Rule]", "0.36"}], ",", 
      RowBox[{"\"\<SPS\>\"", "\[Rule]", "0.548"}], ",", 
      RowBox[{"\"\<LHC\>\"", "\[Rule]", "4.83"}], ",", 
      RowBox[{"\"\<FCC-hh\>\"", "\[Rule]", "7.75"}], ",", 
      RowBox[{"\"\<Serpukhov\>\"", "->", "0.2983"}], ",", 
      RowBox[{"\"\<ESS\>\"", "->", "0."}]}], "}"}], "]"}]}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Production", " ", "probability", " ", "of", " ", "charged", " ", "\[Pi]",
      " ", "and", " ", 
     RowBox[{"\[Mu]", ".", " ", "Currently"}]}], ",", " ", 
    RowBox[{"used", " ", "only", " ", "for", " ", "ESS"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"PppTo\[Pi]chargedFacility", ":=", 
  RowBox[{"Association", "[", 
   RowBox[{"{", 
    RowBox[{"\"\<ESS\>\"", "->", "0.3"}], "}"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PppTo\[Mu]Facility", ":=", 
   RowBox[{"Association", "[", 
    RowBox[{"{", 
     RowBox[{"\"\<ESS\>\"", "->", "0.3"}], "}"}], "]"}]}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"For", " ", 
     RowBox[{"J", "/", "\[Psi]"}], " ", "and", " ", "\[CapitalUpsilon]"}], 
    ",", " ", 
    RowBox[{
     RowBox[{"the", " ", "FCC"}], "-", 
     RowBox[{
     "hh", " ", "data", " ", "is", " ", "to", " ", "be", " ", "updated"}]}]}],
    "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"PppToJpsiFacility", ":=", 
  RowBox[{"Association", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\"\<FermilabBD\>\"", "\[Rule]", 
      RowBox[{"5.24", "*", 
       SuperscriptBox["10", 
        RowBox[{"-", "7"}]]}]}], ",", 
     RowBox[{"\"\<SPS\>\"", "\[Rule]", 
      RowBox[{"3.5", "*", 
       SuperscriptBox["10", 
        RowBox[{"-", "6"}]]}]}], ",", 
     RowBox[{"\"\<LHC\>\"", "\[Rule]", "0.001"}], ",", 
     RowBox[{"\"\<FCC-hh\>\"", "\[Rule]", "0."}], ",", 
     RowBox[{"\"\<Serpukhov\>\"", "->", "0."}], ",", 
     RowBox[{"\"\<ESS\>\"", "->", "0."}]}], "}"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PppToUpsilonFacility", ":=", 
   RowBox[{"Association", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\"\<FermilabBD\>\"", "\[Rule]", "0."}], ",", 
      RowBox[{"\"\<SPS\>\"", "\[Rule]", "0."}], ",", 
      RowBox[{"\"\<LHC\>\"", "\[Rule]", 
       RowBox[{"1.35", "*", 
        SuperscriptBox["10", 
         RowBox[{"-", "5"}]]}]}], ",", 
      RowBox[{"\"\<FCC-hh\>\"", "\[Rule]", "0."}], ",", 
      RowBox[{"\"\<Serpukhov\>\"", "->", "0."}], ",", 
      RowBox[{"\"\<ESS\>\"", "->", "0."}]}], "}"}], "]"}]}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"\[Phi]", " ", "multiplicity"}], " ", "-", " ", 
    RowBox[{"per", " ", "p"}], "-", 
    RowBox[{"p", " ", "collision", " ", 
     RowBox[{"(", "currently", ")"}]}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PppToPhiFacility", ":=", 
   RowBox[{"Association", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\"\<FermilabBD\>\"", "\[Rule]", "0.0106"}], ",", 
      RowBox[{"\"\<SPS\>\"", "\[Rule]", "0.02"}], ",", 
      RowBox[{"\"\<LHC\>\"", "\[Rule]", "0.53"}], ",", 
      RowBox[{"\"\<FCC-hh\>\"", "\[Rule]", "1.13"}], ",", 
      RowBox[{"\"\<Serpukhov\>\"", "->", 
       RowBox[{"8.4", "*", 
        SuperscriptBox["10", 
         RowBox[{"-", "3"}]]}]}], ",", 
      RowBox[{"\"\<ESS\>\"", "->", "0."}]}], "}"}], "]"}]}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Data", " ", "for", " ", "W", " ", "production"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"For", " ", "LHC"}], ",", " ", 
    RowBox[{
     RowBox[{"https", ":"}], "//", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"arxiv", ".", "org"}], "/", "abs"}], "/", "1603.09222"}], 
       " ", "is", " ", 
       RowBox[{"used", ".", " ", "For"}], " ", "FCC"}], "-", "hh"}]}], ",", 
    " ", 
    RowBox[{"pythia8", " ", "is", " ", "used"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Sigma]ppToWInpbFacility", ":=", 
   RowBox[{"Association", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\"\<FermilabBD\>\"", "\[Rule]", " ", "0."}], ",", 
      RowBox[{"\"\<SPS\>\"", "\[Rule]", "0."}], ",", 
      RowBox[{"\"\<LHC\>\"", "\[Rule]", 
       RowBox[{
        SuperscriptBox["10", "3"], "*", 
        RowBox[{"20.62", "/", "0.107"}]}]}], ",", 
      RowBox[{"\"\<FCC-hh\>\"", "\[Rule]", 
       RowBox[{"1.1", "*", 
        SuperscriptBox["10", "6"]}]}], ",", 
      RowBox[{"\"\<Serpukhov\>\"", "->", "0."}], ",", 
      RowBox[{"\"\<ESS\>\"", "->", "0."}]}], "}"}], "]"}]}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Maximal", " ", "energy", " ", "of", " ", "LLP", " ", "available", " ", 
    "at", " ", "the", " ", "given", " ", "experiment"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"EmaxFacility", ":=", 
  RowBox[{"Association", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\"\<SPS\>\"", "\[Rule]", "400."}], ",", 
     RowBox[{"\"\<FermilabBD\>\"", "\[Rule]", "120."}], ",", 
     RowBox[{"\"\<LHC\>\"", "\[Rule]", "7000."}], ",", 
     RowBox[{"\"\<FCC-hh\>\"", "\[Rule]", " ", "50000."}], ",", 
     RowBox[{"\"\<Serpukhov\>\"", "->", "70."}], ",", 
     RowBox[{"\"\<ESS\>\"", "->", "2.4"}]}], "}"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.905016515864115*^9, 3.90501651635985*^9}, {
   3.910328840726426*^9, 3.910328866931158*^9}, {3.9103289009336395`*^9, 
   3.9103290203927436`*^9}, {3.9104109391591578`*^9, 
   3.9104109640259104`*^9}, {3.9104110613095427`*^9, 
   3.9104110650492315`*^9}, {3.9104112397791376`*^9, 
   3.9104112443368387`*^9}, {3.910411442217352*^9, 3.9104114452565107`*^9}, {
   3.914561108772239*^9, 3.9145611748789363`*^9}, {3.914746876401867*^9, 
   3.9147468784926414`*^9}, {3.9147469489808435`*^9, 
   3.9147469668970556`*^9}, {3.9147470057240667`*^9, 3.914747111641765*^9}, {
   3.9147472078639994`*^9, 3.9147472371377826`*^9}, 3.9154372078289366`*^9, {
   3.9163274837581053`*^9, 3.916327484948937*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"ee7bfe9c-2c6e-4b8d-b202-a56eee06adcd"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Generic definitions used to calculate acceptances", "Section",
 CellChangeTimes->{{3.9050164970376935`*^9, 
  3.9050165068337436`*^9}},ExpressionUUID->"20cfe154-510f-4050-a059-\
2ca75cd81d28"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Boxcylpar", "[", "experiment_", "]"}], ":=", 
    RowBox[{
     RowBox[{
      RowBox[{"GeometryExperiment", "[", "experiment", "]"}], "\[Equal]", 
      "\"\<Box\>\""}], "||", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"GeometryExperiment", "[", "experiment", "]"}], "\[Equal]", 
        "\"\<Cylinder\>\""}], "&&", 
       RowBox[{
        RowBox[{
        "DetectorPlaneOrientationExperiment", "[", "experiment", "]"}], 
        "\[Equal]", "\"\<Parallel\>\""}]}], ")"}]}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Condition", " ", "to", " ", "define", " ", "whether", " ", "the", " ", 
    "LLP", " ", "is", " ", "inside", " ", "the", " ", "decay", " ", 
    "volume"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"IfLLPinsideDecVolSimple", "[", "experiment_", "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"Evaluate", "[", 
         RowBox[{"Boxcylpar", "[", "experiment", "]"}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"XminDecVol", "[", "zLLP_", "]"}], "=", 
          RowBox[{
           RowBox[{"xToDecayVolumeCenterExperiment", "[", 
            RowBox[{"zLLP", ",", "experiment"}], "]"}], "-", 
           RowBox[{
            RowBox[{"dxDecayVolumeExperiment", "[", 
             RowBox[{"zLLP", ",", "experiment"}], "]"}], "/", "2."}]}]}], ";",
          "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"XmaxDecVol", "[", "zLLP_", "]"}], "=", 
          RowBox[{
           RowBox[{"xToDecayVolumeCenterExperiment", "[", 
            RowBox[{"zLLP", ",", "experiment"}], "]"}], "+", 
           RowBox[{
            RowBox[{"dxDecayVolumeExperiment", "[", 
             RowBox[{"zLLP", ",", "experiment"}], "]"}], "/", "2."}]}]}], ";",
          "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"YminDecVol", "[", "zLLP_", "]"}], "=", 
          RowBox[{
           RowBox[{"yToDecayVolumeCenterExperiment", "[", 
            RowBox[{"zLLP", ",", "experiment"}], "]"}], "-", 
           RowBox[{
            RowBox[{"dyDecayVolumeExperiment", "[", 
             RowBox[{"zLLP", ",", "experiment"}], "]"}], "/", "2."}]}]}], ";",
          "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"YmaxDecVol", "[", "zLLP_", "]"}], "=", 
          RowBox[{
           RowBox[{"yToDecayVolumeCenterExperiment", "[", 
            RowBox[{"zLLP", ",", "experiment"}], "]"}], "+", 
           RowBox[{
            RowBox[{"dyDecayVolumeExperiment", "[", 
             RowBox[{"zLLP", ",", "experiment"}], "]"}], "/", "2."}]}]}], ";",
          "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{
           "If", " ", "the", " ", "experiment", " ", "has", " ", "box", " ", 
            "geometry"}], ",", " ", 
           RowBox[{
           "or", " ", "if", " ", "it", " ", "has", " ", "the", " ", 
            "cylinder", " ", "geometry", " ", "and", " ", "the", " ", 
            "detector", " ", "plane", " ", "is", " ", "oriented", " ", 
            "parallel", " ", "to", " ", "the", " ", "beamline"}], ",", " ", 
           RowBox[{
           "then", " ", "at", " ", "the", " ", "given", " ", "z", " ", "the", 
            " ", "LLP", " ", "must", " ", "be", " ", "within", " ", "a", " ", 
            "rectangle"}]}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"(*", "Otherwise", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"cnd", "=", 
          RowBox[{
           RowBox[{"Boole", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"XminDecVol", "[", "zLLP", "]"}], "<", "xLLP", "<", 
              RowBox[{"XmaxDecVol", "[", "zLLP", "]"}]}], "&&", 
             RowBox[{
              RowBox[{"YminDecVol", "[", "zLLP", "]"}], "<", "yLLP", "<", 
              RowBox[{"YmaxDecVol", "[", "zLLP", "]"}]}]}], "]"}], "//", 
           "Simplify"}]}]}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"cnd", "=", 
          RowBox[{"Boole", "[", 
           RowBox[{
            SuperscriptBox[
             RowBox[{"RinnerDecayVolumeExperiment", "[", 
              RowBox[{"experiment", ",", "zLLP"}], "]"}], "2"], "<", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"xToDecayVolumeCenterExperiment", "[", 
                 RowBox[{"zLLP", ",", "experiment"}], "]"}], "-", "xLLP"}], 
               ")"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"yToDecayVolumeCenterExperiment", "[", 
                 RowBox[{"zLLP", ",", "experiment"}], "]"}], "-", "yLLP"}], 
               ")"}], "2"]}], "<", 
            SuperscriptBox[
             RowBox[{"RouterDecayVolumeExperiment", "[", 
              RowBox[{"experiment", ",", "zLLP"}], "]"}], "2"]}], "]"}]}], 
         ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      "cnd"}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Condition", " ", "to", " ", "define", " ", "whether", " ", "the", " ", 
    "LLP", " ", "points", " ", "to", " ", "the", " ", "detector"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"x1LLPproj", " ", "is", " ", "the", " ", "x", " ", "coordinate"}],
     ",", " ", 
    RowBox[{
    "while", " ", "x2LLPproj", " ", "may", " ", "be", " ", "either", " ", "y",
      " ", 
     RowBox[{"(", 
      RowBox[{
      "if", " ", "the", " ", "detector", " ", "plane", " ", "is", " ", "xy"}],
       ")"}], " ", "or", " ", "z", " ", 
     RowBox[{"(", 
      RowBox[{"if", " ", "the", " ", "plane", " ", "is", " ", "xz"}], 
      ")"}]}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Boxdec", "[", "experiment_", "]"}], ":=", 
  RowBox[{
   RowBox[{"GeometryExperiment", "[", "experiment", "]"}], "\[Equal]", 
   "\"\<Box\>\""}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"IfParticlePointsToDetSimple", "[", "experiment_", "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{
       "If", " ", "decay", " ", "volume", " ", "is", " ", "detector"}], ",", 
       " ", 
       RowBox[{
       "then", " ", "all", " ", "particle", " ", "inside", " ", "decay", " ", 
        "volume", " ", "\"\<point\>\"", " ", "to", " ", "detector"}]}], 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"DecayVolumeAsDetectorExperiment", "[", "experiment", "]"}], 
         "\[Equal]", "\"\<True\>\""}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"cond1", ",", "cond2"}], "}"}], "=", 
         RowBox[{"{", 
          RowBox[{"1.", ",", "0."}], "}"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"x2toDetCenter", "=", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
             "DetectorPlaneOrientationExperiment", "[", "experiment", "]"}], 
             "==", "\"\<Transverse\>\""}], ",", " ", 
            RowBox[{"yToDetectorCenterExperiment", "[", "experiment", "]"}], 
            ",", 
            RowBox[{"zToDetectorCenterExperiment", "[", "experiment", "]"}]}],
            "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{"Considering", " ", "the", " ", "box", " ", "detector"}], 
          "*)"}], "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"Evaluate", "[", 
            RowBox[{"Boxdec", "[", "experiment", "]"}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"x1minDet", "[", "xLongProj_", "]"}], "=", 
             RowBox[{
              RowBox[{"xToDetectorCenterExperiment", "[", "experiment", "]"}],
               "-", 
              RowBox[{
               RowBox[{"dxDetectorExperiment", "[", 
                RowBox[{"experiment", ",", "xLongProj"}], "]"}], "/", 
               "2"}]}]}], ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"x1maxDet", "[", "xLongProj_", "]"}], "=", 
             RowBox[{
              RowBox[{"xToDetectorCenterExperiment", "[", "experiment", "]"}],
               "+", 
              RowBox[{
               RowBox[{"dxDetectorExperiment", "[", 
                RowBox[{"experiment", ",", "xLongProj"}], "]"}], "/", 
               "2"}]}]}], ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"x2minDet", "[", "xLongProj_", "]"}], "=", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                "DetectorPlaneOrientationExperiment", "[", "experiment", 
                 "]"}], "\[Equal]", "\"\<Transverse\>\""}], ",", 
               RowBox[{
                RowBox[{
                "yToDetectorCenterExperiment", "[", "experiment", "]"}], "-", 
                RowBox[{
                 RowBox[{"dyDetectorExperiment", "[", 
                  RowBox[{"experiment", ",", "xLongProj"}], "]"}], "/", 
                 "2"}]}], ",", 
               RowBox[{
                RowBox[{
                "zToDetectorCenterExperiment", "[", "experiment", "]"}], "-", 
                RowBox[{
                 RowBox[{"dzDetectorExperiment", "[", "experiment", "]"}], 
                 "/", "2"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"x2maxDet", "[", "xLongProj_", "]"}], "=", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                "DetectorPlaneOrientationExperiment", "[", "experiment", 
                 "]"}], "\[Equal]", "\"\<Transverse\>\""}], ",", 
               RowBox[{
                RowBox[{
                "yToDetectorCenterExperiment", "[", "experiment", "]"}], "+", 
                RowBox[{
                 RowBox[{"dyDetectorExperiment", "[", 
                  RowBox[{"experiment", ",", "xLongProj"}], "]"}], "/", 
                 "2"}]}], ",", 
               RowBox[{
                RowBox[{
                "zToDetectorCenterExperiment", "[", "experiment", "]"}], "+", 
                RowBox[{
                 RowBox[{"dzDetectorExperiment", "[", "experiment", "]"}], 
                 "/", "2"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"cond1", "=", 
             RowBox[{"Boole", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"x1minDet", "[", "xLongProj", "]"}], "<", "x1LLPproj",
                 "<", 
                RowBox[{"x1maxDet", "[", "xLongProj", "]"}]}], "&&", 
               RowBox[{
                RowBox[{"x2minDet", "[", "xLongProj", "]"}], "<", "x2LLPproj",
                 "<", 
                RowBox[{"x2maxDet", "[", "xLongProj", "]"}]}]}], "]"}]}], ";",
             "\[IndentingNewLine]", 
            RowBox[{"cond2", "=", 
             RowBox[{"Boole", "[", 
              RowBox[{"!", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"x1minDet", "[", "xLongProj", "]"}], "<", 
                  "x1LLPproj", "<", 
                  RowBox[{"x1maxDet", "[", "xLongProj", "]"}]}], "&&", 
                 RowBox[{
                  RowBox[{"x2minDet", "[", "xLongProj", "]"}], "<", 
                  "x2LLPproj", "<", 
                  RowBox[{"x2maxDet", "[", "xLongProj", "]"}]}]}], ")"}]}], 
              "]"}]}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
            "If", " ", "LLP", " ", "points", " ", "to", " ", "detector"}], 
            "*)"}], "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"cond1", "=", 
             RowBox[{"Boole", "[", 
              RowBox[{
               SuperscriptBox[
                RowBox[{"RinnerDetectorExperiment", "[", 
                 RowBox[{"experiment", ",", "xLongProj"}], "]"}], "2"], "<", 
               RowBox[{
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                   "xToDetectorCenterExperiment", "[", "experiment", "]"}], 
                   "-", "x1LLPproj"}], ")"}], "2"], "+", 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{"x2toDetCenter", "-", "x2LLPproj"}], ")"}], "2"]}], 
               "<", 
               SuperscriptBox[
                RowBox[{"RouterDetectorExperiment", "[", 
                 RowBox[{"experiment", ",", "xLongProj"}], "]"}], "2"]}], 
              "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{
             "If", " ", "LLP", " ", "does", " ", "not", " ", "point", " ", 
              "to", " ", "detector"}], "*)"}], "\[IndentingNewLine]", 
            RowBox[{"cond2", "=", 
             RowBox[{"Boole", "[", 
              RowBox[{"!", 
               RowBox[{"(", 
                RowBox[{
                 SuperscriptBox[
                  RowBox[{"RinnerDetectorExperiment", "[", 
                   RowBox[{"experiment", ",", "xLongProj"}], "]"}], "2"], "<", 
                 RowBox[{
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    "xToDetectorCenterExperiment", "[", "experiment", "]"}], 
                    "-", "x1LLPproj"}], ")"}], "2"], "+", 
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{"x2toDetCenter", "-", "x2LLPproj"}], ")"}], 
                   "2"]}], "<", 
                 SuperscriptBox[
                  RowBox[{"RouterDetectorExperiment", "[", 
                   RowBox[{"experiment", ",", "xLongProj"}], "]"}], "2"]}], 
                ")"}]}], "]"}]}]}]}], "]"}], ";"}]}], "\[IndentingNewLine]", 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"cond1", ",", "cond2"}], "}"}], "//", "Simplify"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "The", " ", "total", " ", "volume", " ", "of", " ", "the", " ", "decay", 
    " ", "volume", " ", "based", " ", "on", " ", "the", " ", "implemented", 
    " ", "conditions", " ", "for", " ", "the", " ", "LLP", " ", "to", " ", 
    "decay", " ", "inside", " ", "the", " ", "decay", " ", "volume"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"VolumeFromIf", "[", "exp_", "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"DX", "[", "z_", "]"}], "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"GeometryExperiment", "[", "exp", "]"}], "==", 
         "\"\<Box\>\""}], ",", 
        RowBox[{"dxDecayVolumeExperiment", "[", 
         RowBox[{"z", ",", "exp"}], "]"}], ",", 
        RowBox[{"2", 
         RowBox[{"RouterDecayVolumeExperiment", "[", 
          RowBox[{"exp", ",", "z"}], "]"}]}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"DY", "[", "z_", "]"}], "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"GeometryExperiment", "[", "exp", "]"}], "==", 
         "\"\<Box\>\""}], ",", 
        RowBox[{"dyDecayVolumeExperiment", "[", 
         RowBox[{"z", ",", "exp"}], "]"}], ",", 
        RowBox[{"2", 
         RowBox[{"RouterDecayVolumeExperiment", "[", 
          RowBox[{"exp", ",", "z"}], "]"}]}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Xminv", "[", "z_", "]"}], "=", 
      RowBox[{
       RowBox[{"xToDecayVolumeCenterExperiment", "[", 
        RowBox[{"z", ",", "exp"}], "]"}], "-", 
       FractionBox[
        RowBox[{"DX", "[", "z", "]"}], "2"]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Xmaxv", "[", "z_", "]"}], "=", 
      RowBox[{
       RowBox[{"xToDecayVolumeCenterExperiment", "[", 
        RowBox[{"z", ",", "exp"}], "]"}], "+", 
       FractionBox[
        RowBox[{"DX", "[", "z", "]"}], "2"]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Yminv", "[", "z_", "]"}], "=", 
      RowBox[{
       RowBox[{"yToDecayVolumeCenterExperiment", "[", 
        RowBox[{"z", ",", "exp"}], "]"}], "-", 
       FractionBox[
        RowBox[{"DY", "[", "z", "]"}], "2"]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Ymaxv", "[", "z_", "]"}], "=", 
      RowBox[{
       RowBox[{"yToDecayVolumeCenterExperiment", "[", 
        RowBox[{"z", ",", "exp"}], "]"}], "+", 
       FractionBox[
        RowBox[{"DY", "[", "z", "]"}], "2"]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"NIntegrate", "[", 
      RowBox[{
       RowBox[{"IfLLPinsideDecVol", "[", 
        RowBox[{"zLLP", ",", "xLLP", ",", "yLLP", ",", "exp"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"zLLP", ",", 
         RowBox[{"zToDecayVolumeExperiment", "[", "exp", "]"}], ",", 
         RowBox[{
          RowBox[{"zToDecayVolumeExperiment", "[", "exp", "]"}], "+", 
          RowBox[{"dzDecayVolumeExperiment", "[", "exp", "]"}]}]}], "}"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"xLLP", ",", 
         RowBox[{"Xminv", "[", "zLLP", "]"}], ",", 
         RowBox[{"Xmaxv", "[", "zLLP", "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"yLLP", ",", 
         RowBox[{"Yminv", "[", "zLLP", "]"}], ",", 
         RowBox[{"Ymaxv", "[", "zLLP", "]"}]}], "}"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.905016805794218*^9, 3.905016822420846*^9}, 
   3.9050171525264506`*^9, {3.905101965582786*^9, 3.9051019953137274`*^9}, {
   3.9101980461963463`*^9, 3.910198048576031*^9}, {3.9101981091743865`*^9, 
   3.9101984342575946`*^9}, 3.910198474615286*^9, {3.9101986684344697`*^9, 
   3.9101987848561797`*^9}, {3.9102457279972296`*^9, 3.910245747208251*^9}, {
   3.9102457825208797`*^9, 3.9102458306886187`*^9}, {3.910245909598368*^9, 
   3.9102459362284284`*^9}, {3.91024613434826*^9, 3.910246145372591*^9}, {
   3.9147486391844254`*^9, 3.914748642513946*^9}, {3.9154370068371925`*^9, 
   3.9154370068417163`*^9}, {3.9154372078369846`*^9, 3.9154372081106806`*^9}},
 CellLabel->"In[20]:=",ExpressionUUID->"0ef6192c-b9ad-46f4-b651-eac4a4953f6f"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Implementation of the experiments: geometry and cross-sections\
\>", "Section",
 CellChangeTimes->{{3.893235933860486*^9, 3.893235936872877*^9}, {
   3.8933436723508244`*^9, 3.893343682407154*^9}, 3.8934861141232157`*^9, {
   3.905017175711813*^9, 
   3.9050171790972133`*^9}},ExpressionUUID->"18f6958a-0a02-4d67-9b4a-\
ddf4f3df3e04"],

Cell[CellGroupData[{

Cell["SHiP configurations", "Subsection",
 CellChangeTimes->{{3.893236048620985*^9, 3.89323605453568*^9}, {
  3.893238131371147*^9, 3.8932381326127186`*^9}, {3.8933415623217955`*^9, 
  3.893341563580163*^9}},ExpressionUUID->"1f41dc1a-706a-4799-b529-\
a81390f9cf51"],

Cell[CellGroupData[{

Cell["Preliminary definitions", "Subsubsection",
 CellChangeTimes->{{3.8933099214711046`*^9, 
  3.893309924807064*^9}},ExpressionUUID->"925b911f-43f8-4aca-849e-\
bdd65f3a4225"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"ENC3", " ", "4", "*", "8", " ", 
    RowBox[{
     SuperscriptBox["m", "2"], ".", " ", "Values"}], " ", "taken", " ", 
    "from", " ", "FairSHiP"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"Parameters", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"here", " ", "in", " ", "below"}], ",", " ", 
        RowBox[{"in", " ", "m"}]}], ")"}]}], ":", " ", 
     RowBox[{
      RowBox[{"upstream", "/", "downstream"}], " ", "\[CapitalDelta]x", " ", 
      "for", " ", "decay", " ", "volume"}]}], ",", " ", 
    RowBox[{
     RowBox[{"upstream", "/", "downstream"}], " ", "\[CapitalDelta]y", " ", 
     "for", " ", "decay", " ", "volume"}], ",", " ", 
    RowBox[{
     SubscriptBox["z", "min"], " ", "for", " ", "decay", " ", "volume"}], ",",
     " ", 
    RowBox[{"\[CapitalDelta]z", " ", "for", " ", "decay", " ", "volume"}], 
    ",", " ", "\[CapitalDelta]x", ",", "\[CapitalDelta]y", ",", 
    RowBox[{"\[CapitalDelta]z", " ", "for", " ", "the", " ", "detector"}], 
    ",", " ", 
    RowBox[{
     SubscriptBox["z", 
      RowBox[{"min", "/", "max"}]], " ", "for", " ", "magnet"}], ",", " ", 
    RowBox[{
    "and", " ", "integrated", " ", "magnetic", " ", "field", " ", "in", " ", 
     "Tl", "*", "m", " ", "of", " ", "magnet"}], ",", " ", 
    RowBox[{"ECAL", " ", "position"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "The", " ", "dimensions", " ", "of", " ", "the", " ", "detector", " ", 
    "is", " ", "assumed", " ", "to", " ", "be", " ", "the", " ", "same", " ", 
    "as", " ", "the", " ", "downstream", " ", "dimensions", " ", "of", " ", 
    "the", " ", "decay", " ", "volume"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "\[CapitalDelta]xUpstrSHiPECN3LoI", ",", 
       "\[CapitalDelta]xDownstrSHiPECN3LoI", ",", 
       "\[CapitalDelta]yUpstrSHiPECN3LoI", ",", 
       "\[CapitalDelta]yDownstrSHiPECN3LoI", ",", "zminSHiPECN3LoI", ",", 
       "zfidSHiPECN3LoI", ",", "\[CapitalDelta]xdetSHiPECN3LoI", ",", 
       "\[CapitalDelta]ydetSHiPECN3LoI", ",", 
       "\[CapitalDelta]zdetSHiPECN3LoI", ",", "zMinMagnetSHiPECN3LoI", ",", 
       "zMaxMagnetSHiPECN3LoI", ",", "BintSHiPECN3LoI", ",", 
       "ECALpositionSHiPECN3LoI"}], "}"}], "=", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1.2", ",", 
        RowBox[{"1.95", "*", "2"}], ",", 
        RowBox[{"1.75", "*", "2"}], ",", 
        RowBox[{"4.35", "*", "2"}], ",", "38", ",", "50", ",", 
        RowBox[{"1.95", "*", "2"}], ",", 
        RowBox[{"4.35", "*", "2"}], ",", "15", ",", 
        RowBox[{"38", "+", "50", "+", "5"}], ",", 
        RowBox[{"38", "+", "50", "+", "10"}], ",", "0.5", ",", 
        RowBox[{"38", "+", "50", "+", "10", "+", "2"}]}], "}"}], "//", 
      "N"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Alt", "/", 
      RowBox[{"alt2", ":", " ", 
       RowBox[{
       "the", " ", "decay", " ", "volume", " ", "and", " ", "detector", " ", 
        "dimensions", " ", "is", " ", "proportioally", " ", "smaller"}], ":", 
       " ", 
       RowBox[{"4", "*", "8"}]}]}], " ", "\[Rule]", " ", 
     RowBox[{"4", "*", "6"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "\[CapitalDelta]xUpstrSHiPECN3", ",", "\[CapitalDelta]xDownstrSHiPECN3",
        ",", "\[CapitalDelta]yUpstrSHiPECN3", ",", 
       "\[CapitalDelta]yDownstrSHiPECN3", ",", "zminSHiPECN3", ",", 
       "zfidSHiPECN3", ",", "\[CapitalDelta]xdetSHiPECN3", ",", 
       "\[CapitalDelta]ydetSHiPECN3", ",", "\[CapitalDelta]zdetSHiPECN3", ",",
        "zMinMagnetSHiPECN3", ",", "zMaxMagnetSHiPECN3", ",", "BintSHiPECN3", 
       ",", "ECALpositionSHiPECN3"}], "}"}], "=", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1.2", ",", 
        RowBox[{"1.95", "*", "2"}], ",", 
        RowBox[{"1.75", "*", "2"}], ",", 
        RowBox[{"3", "*", "2"}], ",", "32", ",", "50", ",", 
        RowBox[{"1.95", "*", "2"}], ",", 
        RowBox[{"3", "*", "2"}], ",", "15", ",", 
        RowBox[{"31", "+", "50", "+", "5"}], ",", 
        RowBox[{"31", "+", "50", "+", "10"}], ",", "0.5", ",", 
        RowBox[{"31", "+", "50", "+", "10", "+", "2"}]}], "}"}], "//", 
      "N"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "\[CapitalDelta]xUpstrSHiPECN3alt", ",", 
       "\[CapitalDelta]xDownstrSHiPECN3alt", ",", 
       "\[CapitalDelta]yUpstrSHiPECN3alt", ",", 
       "\[CapitalDelta]yDownstrSHiPECN3alt", ",", "zminSHiPECN3alt", ",", 
       "zfidSHiPECN3alt", ",", "\[CapitalDelta]xdetSHiPECN3alt", ",", 
       "\[CapitalDelta]ydetSHiPECN3alt", ",", 
       "\[CapitalDelta]zdetSHiPECN3alt", ",", "zMinMagnetSHiPECN3alt", ",", 
       "zMaxMagnetSHiPECN3alt", ",", "BintSHiPECN3alt", ",", 
       "ECALpositionSHiPECN3alt"}], "}"}], "=", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1.2", ",", 
        RowBox[{"1.95", "*", "2"}], ",", 
        RowBox[{"1.75", "*", "2"}], ",", 
        RowBox[{"3", "*", "2"}], ",", "38", ",", "50", ",", 
        RowBox[{"1.95", "*", "2"}], ",", 
        RowBox[{"3", "*", "2"}], ",", "15", ",", 
        RowBox[{"38", "+", "50", "+", "5"}], ",", 
        RowBox[{"38", "+", "50", "+", "10"}], ",", "0.5", ",", 
        RowBox[{"38", "+", "50", "+", "10", "+", "2"}]}], "}"}], "//", 
      "N"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Old", " ", "ECN4", " ", "setup"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "\[CapitalDelta]xUpstrSHiPECN4", ",", "\[CapitalDelta]xDownstrSHiPECN4",
        ",", "\[CapitalDelta]yUpstrSHiPECN4", ",", 
       "\[CapitalDelta]yDownstrSHiPECN4", ",", "zminSHiPECN4", ",", 
       "zfidSHiPECN4", ",", "\[CapitalDelta]xdetSHiPECN4", ",", 
       "\[CapitalDelta]ydetSHiPECN4", ",", "\[CapitalDelta]zdetSHiPECN4", ",",
        "zMinMagnetSHiPECN4", ",", "zMaxMagnetSHiPECN4", ",", "BintSHiPECN4", 
       ",", "ECALpositionSHiPECN4"}], "}"}], "=", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "1.5", ",", "5", ",", "4.3", ",", "11", ",", "50", ",", "50", ",", "5",
         ",", "11", ",", "15", ",", 
        RowBox[{"50", "+", "50", "+", "5"}], ",", 
        RowBox[{"50", "+", "50", "+", "10"}], ",", "0.5", ",", 
        RowBox[{"50", "+", "50", "+", "10", "+", "2"}]}], "}"}], "//", 
      "N"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[CapitalDelta]ySHiPconfiguration", "[", 
      RowBox[{
      "z_", ",", "\[CapitalDelta]yupstr_", ",", "\[CapitalDelta]ydownstr_", 
       ",", "zmin_", ",", "zfid_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"\[CapitalDelta]yupstr", "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"z", "-", 
           RowBox[{"(", 
            RowBox[{"zmin", "+", "zfid"}], ")"}]}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{"zmin", "-", 
           RowBox[{"(", 
            RowBox[{"zmin", "+", "zfid"}], ")"}]}], ")"}]}], ")"}]}], "+", 
      RowBox[{"\[CapitalDelta]ydownstr", "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"z", "-", "zmin"}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"zmin", "+", "zfid"}], ")"}], "-", "zmin"}], ")"}]}], 
        ")"}]}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[CapitalDelta]xSHiPconfiguration", "[", 
      RowBox[{
      "z_", ",", "\[CapitalDelta]xupstr_", ",", "\[CapitalDelta]xdownstr_", 
       ",", "zmin_", ",", "zfid_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"\[CapitalDelta]xupstr", "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"z", "-", 
           RowBox[{"(", 
            RowBox[{"zmin", "+", "zfid"}], ")"}]}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{"zmin", "-", 
           RowBox[{"(", 
            RowBox[{"zmin", "+", "zfid"}], ")"}]}], ")"}]}], ")"}]}], "+", 
      RowBox[{"\[CapitalDelta]xdownstr", "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"z", "-", "zmin"}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"zmin", "+", "zfid"}], ")"}], "-", "zmin"}], ")"}]}], 
        ")"}]}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\[CapitalDelta]xSHiPECN3LoI", "[", "z_", "]"}], ",", 
       RowBox[{"\[CapitalDelta]ySHiPECN3LoI", "[", "z_", "]"}]}], "}"}], "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\[CapitalDelta]xSHiPconfiguration", "[", 
        RowBox[{
        "z", ",", "\[CapitalDelta]xUpstrSHiPECN3LoI", ",", 
         "\[CapitalDelta]xDownstrSHiPECN3LoI", ",", "zminSHiPECN3LoI", ",", 
         "zfidSHiPECN3LoI"}], "]"}], ",", 
       RowBox[{"\[CapitalDelta]ySHiPconfiguration", "[", 
        RowBox[{
        "z", ",", "\[CapitalDelta]yUpstrSHiPECN3LoI", ",", 
         "\[CapitalDelta]yDownstrSHiPECN3LoI", ",", "zminSHiPECN3LoI", ",", 
         "zfidSHiPECN3LoI"}], "]"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\[CapitalDelta]xSHiPECN4", "[", "z_", "]"}], ",", 
       RowBox[{"\[CapitalDelta]ySHiPECN4", "[", "z_", "]"}]}], "}"}], "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\[CapitalDelta]xSHiPconfiguration", "[", 
        RowBox[{
        "z", ",", "\[CapitalDelta]xUpstrSHiPECN4", ",", 
         "\[CapitalDelta]xDownstrSHiPECN4", ",", "zminSHiPECN4", ",", 
         "zfidSHiPECN4"}], "]"}], ",", 
       RowBox[{"\[CapitalDelta]ySHiPconfiguration", "[", 
        RowBox[{
        "z", ",", "\[CapitalDelta]yUpstrSHiPECN4", ",", 
         "\[CapitalDelta]yDownstrSHiPECN4", ",", "zminSHiPECN4", ",", 
         "zfidSHiPECN4"}], "]"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\[CapitalDelta]xSHiPECN3", "[", "z_", "]"}], ",", 
       RowBox[{"\[CapitalDelta]ySHiPECN3", "[", "z_", "]"}]}], "}"}], "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\[CapitalDelta]xSHiPconfiguration", "[", 
        RowBox[{
        "z", ",", "\[CapitalDelta]xUpstrSHiPECN3", ",", 
         "\[CapitalDelta]xDownstrSHiPECN3", ",", "zminSHiPECN3", ",", 
         "zfidSHiPECN3"}], "]"}], ",", 
       RowBox[{"\[CapitalDelta]ySHiPconfiguration", "[", 
        RowBox[{
        "z", ",", "\[CapitalDelta]yUpstrSHiPECN3", ",", 
         "\[CapitalDelta]yDownstrSHiPECN3", ",", "zminSHiPECN3", ",", 
         "zfidSHiPECN3"}], "]"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\[CapitalDelta]xSHiPECN3alt", "[", "z_", "]"}], ",", 
       RowBox[{"\[CapitalDelta]ySHiPECN3alt", "[", "z_", "]"}]}], "}"}], "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\[CapitalDelta]xSHiPconfiguration", "[", 
        RowBox[{
        "z", ",", "\[CapitalDelta]xUpstrSHiPECN3alt", ",", 
         "\[CapitalDelta]xDownstrSHiPECN3alt", ",", "zminSHiPECN3alt", ",", 
         "zfidSHiPECN3alt"}], "]"}], ",", 
       RowBox[{"\[CapitalDelta]ySHiPconfiguration", "[", 
        RowBox[{
        "z", ",", "\[CapitalDelta]yUpstrSHiPECN3alt", ",", 
         "\[CapitalDelta]yDownstrSHiPECN3alt", ",", "zminSHiPECN3alt", ",", 
         "zfidSHiPECN3alt"}], "]"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Upstream", "/", "downstream"}], " ", "dimensions", " ", "of", 
     " ", "the", " ", "decay", " ", "volume"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"dxDecayVolumeUpstream", "[", "\"\<SHiP-ECN3-LoI\>\"", "]"}], 
       ",", 
       RowBox[{"dxDecayVolumeUpstream", "[", "\"\<SHiP-ECN3\>\"", "]"}], ",", 
       RowBox[{"dxDecayVolumeUpstream", "[", "\"\<SHiP-ECN3-alt\>\"", "]"}], 
       ",", 
       RowBox[{"dxDecayVolumeUpstream", "[", "\"\<SHiP-ECN4\>\"", "]"}]}], 
      "}"}], "=", 
     RowBox[{"{", 
      RowBox[{"1.", ",", "1.", ",", "1.", ",", 
       RowBox[{"1.", "*", 
        FractionBox["5", "4"]}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"dxDecayVolumeDownstream", "[", "\"\<SHiP-ECN3-LoI\>\"", "]"}],
        ",", 
       RowBox[{"dxDecayVolumeDownstream", "[", "\"\<SHiP-ECN3\>\"", "]"}], 
       ",", 
       RowBox[{"dxDecayVolumeDownstream", "[", "\"\<SHiP-ECN3-alt\>\"", "]"}],
        ",", 
       RowBox[{"dxDecayVolumeDownstream", "[", "\"\<SHiP-ECN4\>\"", "]"}]}], 
      "}"}], "=", 
     RowBox[{"{", 
      RowBox[{"4", ",", "4", ",", "4", ",", "5"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"dyDecayVolumeUpstream", "[", "\"\<SHiP-ECN3-LoI\>\"", "]"}], 
       ",", 
       RowBox[{"dyDecayVolumeUpstream", "[", "\"\<SHiP-ECN3\>\"", "]"}], ",", 
       RowBox[{"dyDecayVolumeUpstream", "[", "\"\<SHiP-ECN3-alt\>\"", "]"}], 
       ",", 
       RowBox[{"dyDecayVolumeUpstream", "[", "\"\<SHiP-ECN4\>\"", "]"}]}], 
      "}"}], "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"2.7", "*", 
        FractionBox["8", "6."]}], ",", "2.7", ",", "2.7", ",", "4.3"}], 
      "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"dyDecayVolumeDownstream", "[", "\"\<SHiP-ECN3-LoI\>\"", "]"}],
        ",", 
       RowBox[{"dyDecayVolumeDownstream", "[", "\"\<SHiP-ECN3\>\"", "]"}], 
       ",", 
       RowBox[{"dyDecayVolumeDownstream", "[", "\"\<SHiP-ECN3-alt\>\"", "]"}],
        ",", 
       RowBox[{"dyDecayVolumeDownstream", "[", "\"\<SHiP-ECN4\>\"", "]"}]}], 
      "}"}], "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"6.2", "*", 
        FractionBox["8", "6"]}], ",", "6.2", ",", "6.2", ",", "11"}], "}"}]}],
     ";"}]}]}]], "Input",
 CellChangeTimes->{{3.8932359456393695`*^9, 3.89323604157423*^9}, {
   3.893236072710825*^9, 3.893236454145527*^9}, {3.8932371215866385`*^9, 
   3.893237131795225*^9}, {3.8932378807378435`*^9, 3.893237942803878*^9}, {
   3.8932380410086703`*^9, 3.8932381974726543`*^9}, {3.893238309242324*^9, 
   3.8932384768140793`*^9}, {3.8933087431245785`*^9, 
   3.8933088414966154`*^9}, {3.893309912325895*^9, 3.893309916287357*^9}, 
   3.893313407428096*^9, {3.893313585187824*^9, 3.893313595386779*^9}, {
   3.895035472098173*^9, 3.8950354762754917`*^9}, {3.895035548129689*^9, 
   3.8950355676244645`*^9}, {3.895035603588956*^9, 3.8950356155807204`*^9}, {
   3.8950356485254116`*^9, 3.895035702976638*^9}, {3.8950365211707687`*^9, 
   3.8950365327351055`*^9}, {3.8950365656647744`*^9, 3.895036580931534*^9}, {
   3.8950366199868965`*^9, 3.8950366294724655`*^9}, {3.89745532526377*^9, 
   3.897455325327532*^9}, {3.8974553631350513`*^9, 3.897455531910977*^9}},
 CellLabel->"In[25]:=",ExpressionUUID->"dd2fdd33-95dc-4862-94d5-57343f332b43"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Geometry", "Subsubsection",
 CellChangeTimes->{{3.893309930055128*^9, 
  3.893309930938115*^9}},ExpressionUUID->"6f0164a1-0935-49d5-ab8e-\
5bcff377cc74"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"explistship", "=", 
    RowBox[{"{", 
     RowBox[{
     "\"\<SHiP-ECN3-LoI\>\"", ",", "\"\<SHiP-ECN3\>\"", ",", 
      "\"\<SHiP-ECN4\>\""}], "}"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Distance", " ", "to", " ", "the", " ", "fiducial", " ", "volume", " ", 
    "along", " ", "the", " ", "beamline", " ", 
    RowBox[{"axis", ".", " ", 
     RowBox[{"MapThread", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"list1", "[", "#", "]"}], "=", "#2"}], ")"}], "&"}], ",", 
       RowBox[{"{", 
        RowBox[{"listexp", ",", "listvals"}], "}"}]}], "]"}]}], " ", 
    "equates", " ", "the", " ", "elements", " ", "list1", " ", "with", " ", 
    "keys", " ", "from", " ", "listexp", " ", "to", " ", "the", " ", 
    "corresponding", " ", "elements", " ", "of", " ", "the", " ", "list", " ", 
    RowBox[{"listvals", "."}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"zToDecayVolumeExperiment", "[", "#1", "]"}], "=", "#2"}], 
       ")"}], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistship", ",", 
       RowBox[{"{", 
        RowBox[{"38", ",", "32", ",", "50"}], "}"}]}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Detector", " ", "has", " ", "the", " ", "axis", " ", "along", " ", 
    "which", " ", "its", " ", "components", " ", "are", " ", 
    RowBox[{"placed", ".", " ", "The"}], " ", "option", " ", "below", " ", 
    "defines", " ", "the", " ", "orientation", " ", "of", " ", "the", " ", 
    "final", " ", "plane", " ", "transverse", " ", "to", " ", "this", " ", 
    "axis", " ", "relative", " ", "to", " ", "the", " ", "beamline"}], "*)"}],
   "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Transverse", " ", "if", " ", "the", " ", "plane", " ", "is", " ", 
     "tranverse", " ", 
     RowBox[{"(", 
      RowBox[{"SHiP", ",", " ", 
       RowBox[{"FACET", " ", "etc"}]}], ")"}]}], ",", " ", 
    RowBox[{
    "and", " ", "Parallel", " ", "if", " ", "it", " ", "is", " ", "parallel", 
     " ", 
     RowBox[{"(", 
      RowBox[{"MATHUSLA", ",", " ", "ANUBIS"}]}]}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"DetectorPlaneOrientationExperiment", "[", "#1", "]"}], "=", 
        "#2"}], ")"}], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistship", ",", 
       RowBox[{"Table", "[", 
        RowBox[{"\"\<Transverse\>\"", ",", 
         RowBox[{"Length", "[", "explistship", "]"}]}], "]"}]}], "}"}]}], 
    "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Facility", " ", "hosting", " ", "the", " ", 
     RowBox[{"experiment", ":", " ", "SPS"}]}], ",", " ", "Fermilab", ",", 
    " ", "LHC", ",", " ", 
    RowBox[{"FCC", "-", "hh"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"FacilityExperiment", "[", "#1", "]"}], "=", "#2"}], ")"}], 
      "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistship", ",", 
       RowBox[{"Table", "[", 
        RowBox[{"\"\<SPS\>\"", ",", 
         RowBox[{"Length", "[", "explistship", "]"}]}], "]"}]}], "}"}]}], 
    "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Geometry", " ", "of", " ", "the", " ", 
     RowBox[{"experiment", ":", " ", "box"}]}], ",", " ", "cylinder", ",", 
    " ", 
    RowBox[{"annular", " ", "cylinder"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"GeometryExperiment", "[", "#1", "]"}], "=", "#2"}], ")"}], 
      "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistship", ",", 
       RowBox[{"Table", "[", 
        RowBox[{"\"\<Box\>\"", ",", 
         RowBox[{"Length", "[", "explistship", "]"}]}], "]"}]}], "}"}]}], 
    "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Decay", " ", "volume", " ", "length", " ", "along", " ", "the", " ", 
    "beamline", " ", "axis"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"dzDecayVolumeExperiment", "[", "#1", "]"}], "=", "#2"}], 
       ")"}], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistship", ",", 
       RowBox[{"Table", "[", 
        RowBox[{"50", ",", 
         RowBox[{"Length", "[", "explistship", "]"}]}], "]"}]}], "}"}]}], 
    "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Transverse", " ", "dimensions", " ", "of", " ", "the", " ", "decay", " ",
      "volume", " ", "assuming", " ", "box", " ", "geometry"}], ",", " ", 
    RowBox[{
    "or", " ", "cylindrical", " ", "geometry", " ", "if", " ", "the", " ", 
     "detector", " ", "plane", " ", "is", " ", "parallel", " ", "to", " ", 
     "the", " ", "beamline", " ", 
     RowBox[{
      RowBox[{"(", "ANUBIS", ")"}], ".", " ", "Otherwise"}], " ", "set", " ", 
     "to", " ", "zero"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"dxDecayVolumeExperiment", "[", 
      RowBox[{"z_", ",", "exp"}], "]"}], "=", 
     RowBox[{"\[CapitalDelta]xSHiPconfiguration", "[", 
      RowBox[{"z", ",", 
       RowBox[{"dxDecayVolumeUpstream", "[", "exp", "]"}], ",", 
       RowBox[{"dxDecayVolumeDownstream", "[", "exp", "]"}], ",", 
       RowBox[{"zToDecayVolumeExperiment", "[", "exp", "]"}], ",", 
       RowBox[{"dzDecayVolumeExperiment", "[", "exp", "]"}]}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"exp", ",", "explistship"}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"dyDecayVolumeExperiment", "[", 
       RowBox[{"z_", ",", "exp"}], "]"}], "=", 
      RowBox[{"\[CapitalDelta]ySHiPconfiguration", "[", 
       RowBox[{"z", ",", 
        RowBox[{"dyDecayVolumeUpstream", "[", "exp", "]"}], ",", 
        RowBox[{"dyDecayVolumeDownstream", "[", "exp", "]"}], ",", 
        RowBox[{"zToDecayVolumeExperiment", "[", "exp", "]"}], ",", 
        RowBox[{"dzDecayVolumeExperiment", "[", "exp", "]"}]}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistship"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Distance", " ", "from", " ", "the", " ", "beamline", " ", "to", " ", 
     "the", " ", "decay", " ", "volume", " ", "center", " ", "and", " ", 
     "detector", " ", "along", " ", "the", " ", "x"}], ",", 
    RowBox[{"y", " ", "axes"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MapThread", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"xToDecayVolumeCenterExperiment", "[", 
        RowBox[{"z_", ",", "#1"}], "]"}], "=", "#2"}], ")"}], "&"}], ",", 
    RowBox[{"{", 
     RowBox[{"explistship", ",", 
      RowBox[{"Table", "[", 
       RowBox[{"0", ",", 
        RowBox[{"Length", "[", "explistship", "]"}]}], "]"}]}], "}"}]}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"yToDecayVolumeCenterExperiment", "[", 
         RowBox[{"z_", ",", "#1"}], "]"}], "=", "#2"}], ")"}], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistship", ",", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", 
         RowBox[{"Length", "[", "explistship", "]"}]}], "]"}]}], "}"}]}], 
    "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Inner", " ", "and", " ", "outer", " ", "radii", " ", "of", " ", "the", 
    " ", "decay", " ", 
    RowBox[{"volume", ".", " ", "Applicable"}], " ", "if", " ", "the", " ", 
    "decay", " ", "volume", " ", "has", " ", "cylindrical", " ", "geometry"}],
    "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"RinnerDecayVolumeExperiment", "[", 
      RowBox[{"exp", ",", "z_"}], "]"}], "=", "0"}], ",", 
    RowBox[{"{", 
     RowBox[{"exp", ",", "explistship"}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"RouterDecayVolumeExperiment", "[", 
       RowBox[{"exp", ",", "z_"}], "]"}], "=", "0"}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistship"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"z", "-", 
    RowBox[{
    "coordinate", " ", "of", " ", "the", " ", "center", " ", "of", " ", "the",
      " ", "decay", " ", "volume"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"zToDecayVolumeCenterExperiment", "[", "exp", "]"}], "=", 
      RowBox[{
       RowBox[{"zToDecayVolumeExperiment", "[", "exp", "]"}], "+", 
       FractionBox[
        RowBox[{"dzDecayVolumeExperiment", "[", "exp", "]"}], "2"]}]}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistship"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Maximal", " ", 
    RowBox[{"long", ".", " ", "displacement"}], " ", "of", " ", "the", " ", 
    "decay", " ", "volume"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"zMaxDecayVolumeExperiment", "[", "exp", "]"}], "=", 
     RowBox[{
      RowBox[{"zToDecayVolumeExperiment", "[", "exp", "]"}], "+", 
      RowBox[{"dzDecayVolumeExperiment", "[", "exp", "]"}]}]}], ",", 
    RowBox[{"{", 
     RowBox[{"exp", ",", "explistship"}], "}"}]}], "]"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Whether", " ", "the", " ", "decay", " ", "volume", " ", "serves", " ", 
    "as", " ", "detector", " ", 
    RowBox[{"(", 
     RowBox[{"True", " ", "or", " ", "False"}], ")"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"DecayVolumeAsDetectorExperiment", "[", "exp", "]"}], "=", 
     "\"\<False\>\""}], ",", 
    RowBox[{"{", 
     RowBox[{"exp", ",", "explistship"}], "}"}]}], "]"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Transverse", " ", "dimensions", " ", "of", " ", "the", " ", "detector", 
    " ", "assuming", " ", "box", " ", "geometry"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MapThread", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"dxDetectorExperiment", "[", 
        RowBox[{"#1", ",", "z_"}], "]"}], "=", "#2"}], ")"}], "&"}], ",", 
    RowBox[{"{", 
     RowBox[{"explistship", ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"1.95", "*", "2"}], ",", "4", ",", "5"}], "}"}]}], "}"}]}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"dyDetectorExperiment", "[", 
         RowBox[{"#1", ",", "z_"}], "]"}], "=", "#2"}], ")"}], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistship", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"4.35", "*", "2"}], ",", "6.2", ",", "11"}], "}"}]}], 
      "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Length", " ", "of", " ", "the", " ", "detector", " ", "in", " ", "z", " ",
     "plane"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"dzDetectorExperiment", "[", "#1", "]"}], "=", "#2"}], ")"}], 
      "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistship", ",", 
       RowBox[{"Table", "[", 
        RowBox[{"15", ",", 
         RowBox[{"Length", "[", "explistship", "]"}]}], "]"}]}], "}"}]}], 
    "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Coordinates", " ", "of", " ", "the", " ", "center", " ", "of", " ", "the",
     " ", "detector"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"xToDetectorCenterExperiment", "[", "exp", "]"}], "=", "0"}], 
    ",", 
    RowBox[{"{", 
     RowBox[{"exp", ",", "explistship"}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"yToDetectorCenterExperiment", "[", "exp", "]"}], "=", "0"}], 
    ",", 
    RowBox[{"{", 
     RowBox[{"exp", ",", "explistship"}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"zToDetectorCenterExperiment", "[", "exp", "]"}], "=", 
      RowBox[{
       RowBox[{"zMaxDecayVolumeExperiment", "[", "exp", "]"}], "+", 
       FractionBox[
        RowBox[{"dzDetectorExperiment", "[", "exp", "]"}], "2"]}]}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistship"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Inner", " ", "and", " ", "outer", " ", "radii", " ", "of", " ", "the", 
    " ", "detector"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"RinnerDetectorExperiment", "[", 
      RowBox[{"exp", ",", "z_"}], "]"}], "=", "0"}], ",", 
    RowBox[{"{", 
     RowBox[{"exp", ",", "explistship"}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"RouterDetectorExperiment", "[", 
       RowBox[{"exp", ",", "z_"}], "]"}], "=", "0"}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistship"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Length", " ", "of", " ", "the", " ", "detector", " ", "along", " ", "the",
     " ", "detector", " ", "axis"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"dxLongDetectorExperiment", "[", "exp", "]"}], "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"DetectorPlaneOrientationExperiment", "[", "exp", "]"}], 
         "\[Equal]", "\"\<Transverse\>\""}], ",", 
        RowBox[{"dzDetectorExperiment", "[", "exp", "]"}], ",", 
        RowBox[{"dyDetectorExperiment", "[", "exp", "]"}]}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistship"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "The", " ", "maximal", " ", "coordinate", " ", "of", " ", "the", " ", 
    "end", " ", "of", " ", "the", " ", "detector", " ", "plane", " ", 
    RowBox[{"(", 
     RowBox[{"along", " ", "the", " ", "detector", " ", "axis"}], ")"}], " ", 
    "used", " ", "to", " ", "calculate", " ", "the", " ", "decay", " ", 
    RowBox[{"acceptance", ".", " ", "May"}], " ", "be", " ", "either", " ", 
    "the", " ", "z", " ", "coordinate", " ", "or", " ", "the", " ", "y", " ", 
    "coordinate", " ", 
    RowBox[{"(", 
     RowBox[{
     "if", " ", "the", " ", "final", " ", "detector", " ", "plane", " ", "is",
       " ", "oriented", " ", "parallel", " ", "to", " ", "the", " ", 
      "beamline"}], ")"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"xLongMaxDetectorExperiment", "[", "exp", "]"}], "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"DetectorPlaneOrientationExperiment", "[", "exp", "]"}], 
         "\[Equal]", "\"\<Transverse\>\""}], ",", 
        RowBox[{
         RowBox[{"zMaxDecayVolumeExperiment", "[", "exp", "]"}], "+", 
         RowBox[{"dxLongDetectorExperiment", "[", "exp", "]"}]}], ",", 
        RowBox[{
         RowBox[{"yToDetectorCenterExperiment", "[", "exp", "]"}], "+", 
         RowBox[{
          RowBox[{"dyDetectorExperiment", "[", "exp", "]"}], "/", "2"}]}]}], 
       "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistship"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Whether", " ", "the", " ", "experiment", " ", "has", " ", "dipole", " ", 
    "magnet", " ", "in", " ", "the", " ", "detector", " ", 
    RowBox[{"(", 
     RowBox[{"True", ",", " ", "False"}], ")"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"DipoleMagnetOptionExperiment", "[", "exp", "]"}], "=", 
      "\"\<False\>\""}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistship"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Longitudinal", " ", "positions", " ", "of", " ", "the", " ", "dipole", 
    " ", "magnet", " ", "of", " ", "the", " ", "detector"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"zMagnetMinExperiment", "[", "exp", "]"}], "=", 
     RowBox[{
      RowBox[{"zMaxDecayVolumeExperiment", "[", "exp", "]"}], "+", "5"}]}], 
    ",", 
    RowBox[{"{", 
     RowBox[{"exp", ",", "explistship"}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"zMagnetMaxExperiment", "[", "exp", "]"}], "=", 
      RowBox[{
       RowBox[{"zMagnetMinExperiment", "[", "exp", "]"}], "+", "5"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistship"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Mean", " ", "magnetic", " ", "field", " ", "of", " ", "the", " ", 
    "dipole", " ", "magnet"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"MagneticFieldExperiment", "[", "exp", "]"}], "=", 
      RowBox[{"0.5", "/", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"zMagnetMaxExperiment", "[", "exp", "]"}], "-", 
         RowBox[{"zMagnetMinExperiment", "[", "exp", "]"}]}], ")"}]}]}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistship"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"ECAL", " ", "option", " ", 
    RowBox[{"(", 
     RowBox[{"True", ",", "False"}], ")"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"ECALoptionExperiment", "[", "exp", "]"}], "=", 
      "\"\<True\>\""}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistship"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Position", " ", "of", " ", "the", " ", "beginning", " ", "of", " ", "the",
     " ", "ECAL"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"zECALminExperiment", "[", "exp", "]"}], "=", 
      RowBox[{
       RowBox[{"zMagnetMaxExperiment", "[", "exp", "]"}], "+", "2"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistship"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "The", " ", "final", " ", "detector", " ", "plane", " ", "needed", " ", 
     "to", " ", "reconstruct", " ", 
     RowBox[{"muons", ".", " ", "Depeding"}], " ", "on", " ", "the", " ", 
     "experiment"}], ",", " ", 
    RowBox[{
    "it", " ", "is", " ", "approximated", " ", "by", " ", "be", " ", "end", 
     " ", "of", " ", "the", " ", "trackers", " ", "or", " ", "the", " ", 
     "muon", " ", "system"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"xLongMuonPlaneExperiment", "[", "#1", "]"}], "=", "#2"}], 
       ")"}], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistship", ",", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"xLongMaxDetectorExperiment", "[", "exp", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"exp", ",", "explistship"}], "}"}]}], "]"}]}], "}"}]}], 
    "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "The", " ", "final", " ", "detector", " ", "plane", " ", "needed", " ", 
     "to", " ", "reconstruct", " ", "other", " ", 
     RowBox[{"particles", ".", " ", "Depeding"}], " ", "on", " ", "the", " ", 
     "experiment"}], ",", " ", 
    RowBox[{
    "it", " ", "is", " ", "approximated", " ", "by", " ", "the", " ", "end", 
     " ", "of", " ", "the", " ", "trackers", " ", "or", " ", "the", " ", 
     "calorimeter", " ", "system"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"xLongNonMuonPlaneExperiment", "[", "#1", "]"}], "=", "#2"}], 
       ")"}], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistship", ",", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"xLongMaxDetectorExperiment", "[", "exp", "]"}], "-", "3"}],
          ",", 
         RowBox[{"{", 
          RowBox[{"exp", ",", "explistship"}], "}"}]}], "]"}]}], "}"}]}], 
    "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"List", " ", "of", " ", "detectable", " ", 
     RowBox[{"particles", ".", " ", "If"}], " ", "ECAL", " ", "is", " ", 
     "absent"}], ",", " ", 
    RowBox[{
    "it", " ", "is", " ", "assumed", " ", "by", " ", "default", " ", "that", 
     " ", "photons", " ", "and", " ", 
     SubscriptBox[
      SuperscriptBox["K", "0"], "L"], " ", "cannot", " ", "be", " ", 
     "detected"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MapThread", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"DetectablePDGsExperiment", "[", "#1", "]"}], "=", "#2"}], 
      ")"}], "&"}], ",", 
    RowBox[{"{", 
     RowBox[{"explistship", ",", 
      RowBox[{"Table", "[", 
       RowBox[{"detectablepdgs", ",", 
        RowBox[{"Length", "[", "explistship", "]"}]}], "]"}]}], "}"}]}], 
   "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.893310034081561*^9, 3.8933101646485996`*^9}, {
   3.893310208400164*^9, 3.893310230858571*^9}, {3.8933105062632427`*^9, 
   3.8933105762201977`*^9}, {3.893312331571556*^9, 3.8933125315110364`*^9}, {
   3.893312692176652*^9, 3.8933128772618027`*^9}, {3.8933129751095285`*^9, 
   3.8933133151306953`*^9}, {3.89331341570725*^9, 3.893313450091062*^9}, {
   3.8933135009065685`*^9, 3.893313512749082*^9}, {3.893313558876362*^9, 
   3.8933136094806714`*^9}, {3.893313647126486*^9, 3.8933138217259846`*^9}, {
   3.893313863144909*^9, 3.893314011269126*^9}, {3.8933140597263002`*^9, 
   3.8933141774755363`*^9}, {3.8933142238059406`*^9, 
   3.8933142578749685`*^9}, {3.893314292985757*^9, 3.8933143524709935`*^9}, {
   3.8933144016754284`*^9, 3.893314456197155*^9}, 3.893314850841775*^9, {
   3.893314919059759*^9, 3.8933151745379295`*^9}, {3.893315214172353*^9, 
   3.8933152957527175`*^9}, {3.8933153924139643`*^9, 
   3.8933155487485714`*^9}, {3.893315688135808*^9, 3.893315789816989*^9}, {
   3.893315962728283*^9, 3.8933160087888374`*^9}, {3.893316054636368*^9, 
   3.8933161832234344`*^9}, {3.893316247128169*^9, 3.893316258684697*^9}, {
   3.8933163215008135`*^9, 3.893316343477462*^9}, {3.8933163763128943`*^9, 
   3.8933164045388603`*^9}, {3.893316436122822*^9, 3.8933165134861603`*^9}, {
   3.893316556469404*^9, 3.893316565151972*^9}, {3.893318192043085*^9, 
   3.893318236597784*^9}, {3.8933200342745237`*^9, 3.893320733233306*^9}, {
   3.893320764351189*^9, 3.893320831932399*^9}, {3.8933219968404055`*^9, 
   3.8933219981644573`*^9}, {3.893404930016821*^9, 3.893404931066369*^9}, {
   3.8934051385164094`*^9, 3.89340514045177*^9}, {3.893439832929205*^9, 
   3.8934398344658537`*^9}, {3.8934404770096607`*^9, 3.893440478052471*^9}, {
   3.893486206236278*^9, 3.8934862933168383`*^9}, {3.893518136918446*^9, 
   3.893518163923581*^9}, 3.893519312767215*^9, {3.8935201266981635`*^9, 
   3.8935201692888784`*^9}, 3.893520658164437*^9, {3.8936988421302366`*^9, 
   3.893698844490506*^9}, {3.893699697739356*^9, 3.8936996989312525`*^9}, {
   3.8950356485344768`*^9, 3.895035702838975*^9}, {3.8950678178114977`*^9, 
   3.895067818162818*^9}, {3.8971452923705673`*^9, 3.8971453200481453`*^9}, {
   3.897145474646508*^9, 3.8971454871341543`*^9}, {3.897151232642953*^9, 
   3.897151271727301*^9}, {3.9050568547215605`*^9, 3.90505685489765*^9}, {
   3.910192430233864*^9, 3.910192441495345*^9}, 3.9102405947741165`*^9, {
   3.9102469736096773`*^9, 3.910246973618193*^9}, {3.9102536735594697`*^9, 
   3.910253673710657*^9}, {3.910253743879655*^9, 3.9102538263223877`*^9}, 
   3.910253921685918*^9, {3.910258541869357*^9, 3.9102585599206495`*^9}, {
   3.912056378729228*^9, 3.91205643320921*^9}, {3.9120564770824275`*^9, 
   3.912056503953182*^9}, 3.9120573176892176`*^9},
 CellLabel->"In[39]:=",ExpressionUUID->"52aa4bbc-aec3-4f12-abbb-6316f8d0867b"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Cross-sections", "Subsubsection",
 CellChangeTimes->{{3.8933256308713317`*^9, 
  3.8933256323468237`*^9}},ExpressionUUID->"3198d0fe-50cc-4859-964b-\
bd937d0a1541"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"MapThread", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"NPOTexperiment", "[", "#1", "]"}], "=", "#2"}], ")"}], "&"}], 
    ",", 
    RowBox[{"{", 
     RowBox[{"explistship", ",", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"6", "*", 
         SuperscriptBox["10", "20."]}], ",", 
        RowBox[{"Length", "[", "explistship", "]"}]}], "]"}]}], "}"}]}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"AtargetExperiment", "[", "#1", "]"}], "=", "#2"}], ")"}], 
      "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistship", ",", 
       RowBox[{"Table", "[", 
        RowBox[{"96.", ",", 
         RowBox[{"Length", "[", "explistship", "]"}]}], "]"}]}], "}"}]}], 
    "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Cascade", " ", "enhancement", " ", "of", " ", "the", " ", "production", 
    " ", "relative", " ", "to", " ", "the", " ", "production", " ", "in", " ",
     "pure", " ", "pp", " ", 
    RowBox[{"collisions", ".", " ", "Relevant"}], " ", "for", " ", "fixed", 
    " ", "target", " ", "experiments"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "For", " ", "all", " ", "experiments", " ", "located", " ", "at", " ", 
     "SPS"}], ",", " ", 
    RowBox[{
     RowBox[{
      RowBox[{
      "the", " ", "cascade", " ", "factors", " ", "is", " ", "taken", " ", 
       "from", " ", 
       RowBox[{"http", ":"}]}], "//", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"cds", ".", "cern", ".", "ch"}], "/", "record"}], "/", 
          "2115534"}], "/", "files"}], "/", "SHiP"}], "-", "NOTE", "-", 
       "2015", "-", 
       RowBox[{"009.", 
        RowBox[{"pdf", "?", "version"}]}]}]}], "=", "1"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"CascadeFactorbb", "[", "#1", "]"}], "=", "#2"}], ")"}], 
      "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistship", ",", 
       RowBox[{"Table", "[", 
        RowBox[{"1.7", ",", 
         RowBox[{"Length", "[", "explistship", "]"}]}], "]"}]}], "}"}]}], 
    "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Fraction", " ", "of", " ", "produced", " ", "bb", " ", "per", " ", "PoT", 
    " ", "at", " ", "the", " ", "given", " ", "experiment"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"PppTobbExperiment", "[", "exp", "]"}], "=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"\[Sigma]ppTobbInpbFacility", "[", 
        RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}], "/", 
       RowBox[{"\[Sigma]ppInpbFacility", "[", 
        RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}]}], ")"}], 
     SuperscriptBox[
      RowBox[{"AtargetExperiment", "[", "exp", "]"}], "0.29"], "*", 
     RowBox[{"CascadeFactorbb", "[", "exp", "]"}]}]}], ",", 
   RowBox[{"{", 
    RowBox[{"exp", ",", "explistship"}], "}"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"CascadeFactorcc", "[", "#1", "]"}], "=", "#2"}], ")"}], 
      "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistship", ",", 
       RowBox[{"Table", "[", 
        RowBox[{"2.3", ",", 
         RowBox[{"Length", "[", "explistship", "]"}]}], "]"}]}], "}"}]}], 
    "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Fraction", " ", "of", " ", "produced", " ", "cc", " ", "per", " ", "PoT", 
    " ", "at", " ", "the", " ", "given", " ", "experiment"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"PppToccExperiment", "[", "exp", "]"}], "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"\[Sigma]ppToccInpbFacility", "[", 
         RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}], "/", 
        RowBox[{"\[Sigma]ppInpbFacility", "[", 
         RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}]}], ")"}], 
      SuperscriptBox[
       RowBox[{"AtargetExperiment", "[", "exp", "]"}], "0.29"], "*", 
      RowBox[{"CascadeFactorcc", "[", "exp", "]"}]}]}], ",", 
    RowBox[{"{", 
     RowBox[{"exp", ",", "explistship"}], "}"}]}], "]"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Fraction", " ", "of", " ", "produced", " ", "h", " ", "per", " ", "PoT", 
    " ", "at", " ", "the", " ", "given", " ", "experiment"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"PppTohExperiment", "[", "exp", "]"}], "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"\[Sigma]ppTohInpbFacility", "[", 
          RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}], "/", 
         RowBox[{"\[Sigma]ppInpbFacility", "[", 
          RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}]}], ")"}], 
       SuperscriptBox[
        RowBox[{"AtargetExperiment", "[", "exp", "]"}], "0.29"]}]}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistship"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Fraction", " ", "of", " ", "produced", " ", "W", " ", "per", " ", "PoT", 
    " ", "at", " ", "the", " ", "given", " ", "experiment"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"PppToWExperiment", "[", "exp", "]"}], "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"\[Sigma]ppToWInpbFacility", "[", 
          RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}], "/", 
         RowBox[{"\[Sigma]ppInpbFacility", "[", 
          RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}]}], ")"}], 
       SuperscriptBox[
        RowBox[{"AtargetExperiment", "[", "exp", "]"}], "0.29"]}]}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistship"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Fraction", " ", "of", " ", "produced", " ", 
    SuperscriptBox["\[Pi]", "0"], " ", "per", " ", "PoT", " ", "at", " ", 
    "the", " ", "given", " ", "experiment"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"PppTo\[Pi]0exp", "[", "exp", "]"}], "=", 
      RowBox[{"PppTo\[Pi]0Facility", "[", 
       RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistship"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Fraction", " ", "of", " ", "produced", " ", "\[Eta]", " ", "per", " ", 
    "PoT", " ", "at", " ", "the", " ", "given", " ", "experiment"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"PppTo\[Eta]exp", "[", "exp", "]"}], "=", 
      RowBox[{"PppTo\[Eta]Facility", "[", 
       RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistship"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Fraction", " ", "of", " ", "produced", " ", 
    RowBox[{"\[Eta]", "'"}], " ", "per", " ", "PoT", " ", "at", " ", "the", 
    " ", "given", " ", "experiment"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"PppTo\[Eta]prexp", "[", "exp", "]"}], "=", 
      RowBox[{"PppTo\[Eta]prFacility", "[", 
       RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistship"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Fraction", " ", "of", " ", "produced", " ", 
    SuperscriptBox["\[Rho]", "0"], " ", "per", " ", "PoT", " ", "at", " ", 
    "the", " ", "given", " ", "experiment"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"PppTo\[Rho]0exp", "[", "exp", "]"}], "=", 
      RowBox[{"PppTo\[Rho]0Facility", "[", 
       RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistship"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Fraction", " ", "of", " ", "produced", " ", "\[Omega]", " ", "per", " ", 
    "PoT", " ", "at", " ", "the", " ", "given", " ", "experiment"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"PppTo\[Omega]exp", "[", "exp", "]"}], "=", 
      RowBox[{"PppTo\[Omega]Facility", "[", 
       RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistship"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Fraction", " ", "of", " ", "produced", " ", 
    RowBox[{"J", "/", "\[Psi]"}], 
    RowBox[{"(", 
     RowBox[{"1", "s"}], ")"}], " ", "per", " ", "PoT", " ", "at", " ", "the",
     " ", "given", " ", "experiment"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"PppToJpsiexp", "[", "exp", "]"}], "=", 
      RowBox[{
       RowBox[{"PppToJpsiFacility", "[", 
        RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}], 
       SuperscriptBox[
        RowBox[{"AtargetExperiment", "[", "exp", "]"}], "0.29"]}]}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistship"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Fraction", " ", "of", " ", "produced", " ", "\[CapitalUpsilon]", 
    RowBox[{"(", 
     RowBox[{"1", "s"}], ")"}], " ", "per", " ", "PoT", " ", "at", " ", "the",
     " ", "given", " ", "experiment"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"PppToUpsilonexp", "[", "exp", "]"}], "=", 
      RowBox[{
       RowBox[{"PppToUpsilonFacility", "[", 
        RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}], 
       SuperscriptBox[
        RowBox[{"AtargetExperiment", "[", "exp", "]"}], "0.29"]}]}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistship"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Fraction", " ", "of", " ", "produced", " ", "\[Phi]", " ", "at", " ", 
    "the", " ", "given", " ", "experiment"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"PppToPhiexp", "[", "exp", "]"}], "=", 
      RowBox[{"PppToPhiFacility", "[", 
       RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistship"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Overall", " ", "table", " ", "with", " ", "cross"}], "-", 
    RowBox[{"sections", " ", "used", " ", "for", " ", "exporting"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"TableNumbersParticlesExperiment", "[", "exp", "]"}], "=", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "\"\<Facility\>\"", ",", "\"\<Npot\>\"", ",", "\"\<Atarget\>\"", ",", 
         "\"\<PPi0\>\"", ",", "\"\<PEta\>\"", ",", "\"\<PEtapr\>\"", ",", 
         "\"\<PRho0\>\"", ",", "\"\<POmega\>\"", ",", "\"\<Pc\>\"", ",", 
         "\"\<Pb\>\"", ",", "\"\<PW\>\"", ",", "\"\<Ph\>\"", ",", 
         "\"\<PJpsi\>\"", ",", "\"\<PUpsilon\>\"", ",", "\"\<PPhi\>\""}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"FacilityExperiment", "[", "exp", "]"}], ",", 
         RowBox[{"NPOTexperiment", "[", "exp", "]"}], ",", 
         RowBox[{"AtargetExperiment", "[", "exp", "]"}], ",", 
         RowBox[{"PppTo\[Pi]0exp", "[", "exp", "]"}], ",", 
         RowBox[{"PppTo\[Eta]exp", "[", "exp", "]"}], ",", 
         RowBox[{"PppTo\[Eta]prexp", "[", "exp", "]"}], ",", 
         RowBox[{"PppTo\[Rho]0exp", "[", "exp", "]"}], ",", 
         RowBox[{"PppTo\[Omega]exp", "[", "exp", "]"}], ",", 
         RowBox[{"2", 
          RowBox[{"PppToccExperiment", "[", "exp", "]"}]}], ",", 
         RowBox[{"2", 
          RowBox[{"PppTobbExperiment", "[", "exp", "]"}]}], ",", 
         RowBox[{"PppToWExperiment", "[", "exp", "]"}], ",", 
         RowBox[{"PppTohExperiment", "[", "exp", "]"}], ",", 
         RowBox[{"PppToJpsiexp", "[", "exp", "]"}], ",", 
         RowBox[{"PppToUpsilonexp", "[", "exp", "]"}], ",", 
         RowBox[{"PppToPhiexp", "[", "exp", "]"}]}], "}"}]}], "}"}], "//", 
     "N"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"exp", ",", "explistship"}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.893341633704665*^9, 3.8933416697417917`*^9}, {
  3.8933417035868735`*^9, 3.893341720086713*^9}, {3.8933417509786096`*^9, 
  3.893341804146756*^9}, {3.8933418838767853`*^9, 3.893341935182356*^9}, {
  3.893342038231271*^9, 3.893342087669424*^9}, {3.893342158987651*^9, 
  3.893342161615389*^9}, {3.893342237215578*^9, 3.8933422859858365`*^9}, {
  3.8933423496284*^9, 3.8933424178954296`*^9}, {3.8933428077993746`*^9, 
  3.8933428352085238`*^9}, {3.893343666926454*^9, 3.8933436670514936`*^9}, {
  3.8941780994483614`*^9, 3.8941781571971846`*^9}, {3.8961578774953747`*^9, 
  3.8961578777492304`*^9}, {3.8972354262251873`*^9, 3.897235520453702*^9}, {
  3.8972356014282455`*^9, 3.8972356026751175`*^9}, {3.8972860492521353`*^9, 
  3.897286090488939*^9}, {3.8991962506893334`*^9, 3.899196297808053*^9}, {
  3.8991970153220625`*^9, 3.899197020054968*^9}, {3.8991971403583803`*^9, 
  3.8991971512234135`*^9}},
 CellLabel->"In[73]:=",ExpressionUUID->"be056b80-f7c5-40d4-a682-7aed56187183"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Conditions for the LLP to decay inside the decay volume and for the products \
to point to the end of the detector\
\>", "Subsubsection",
 CellChangeTimes->{{3.905011297554874*^9, 3.9050113192993593`*^9}, 
   3.9154372081199*^9},ExpressionUUID->"acd32065-39aa-4349-af5f-67b099764ac5"],

Cell[BoxData[
 RowBox[{"Do", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"IfLLPinsideDecVol", "[", 
      RowBox[{"zLLP_", ",", "xLLP_", ",", "yLLP_", ",", "exp"}], "]"}], "=", 
     RowBox[{"IfLLPinsideDecVolSimple", "[", "exp", "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"IfLLPtoDet", "[", 
        RowBox[{
        "x1LLPproj_", ",", "x2LLPproj_", ",", "xLongProj_", ",", "exp"}], 
        "]"}], ",", 
       RowBox[{"IfLLPnotToDet", "[", 
        RowBox[{
        "x1LLPproj_", ",", "x2LLPproj_", ",", "xLongProj_", ",", "exp"}], 
        "]"}]}], "}"}], "=", 
     RowBox[{"IfParticlePointsToDetSimple", "[", "exp", "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"IfLLPdecVolToDet", "[", 
      RowBox[{
      "zLLP_", ",", "xLLP_", ",", "yLLP_", ",", "x1LLPproj_", ",", 
       "x2LLPproj_", ",", "xLongProj_", ",", "exp"}], "]"}], "=", 
     RowBox[{
      RowBox[{"IfLLPinsideDecVol", "[", 
       RowBox[{"zLLP", ",", "xLLP", ",", "yLLP", ",", "exp"}], "]"}], "*", 
      RowBox[{"IfLLPtoDet", "[", 
       RowBox[{"x1LLPproj", ",", "x2LLPproj", ",", "xLongProj", ",", "exp"}], 
       "]"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"IfLLPdecVolNotToDet", "[", 
      RowBox[{
      "zLLP_", ",", "xLLP_", ",", "yLLP_", ",", "x1LLPproj_", ",", 
       "x2LLPproj_", ",", "xLongProj_", ",", "exp"}], "]"}], "=", 
     RowBox[{
      RowBox[{"IfLLPinsideDecVol", "[", 
       RowBox[{"zLLP", ",", "xLLP", ",", "yLLP", ",", "exp"}], "]"}], "*", 
      RowBox[{"IfLLPnotToDet", "[", 
       RowBox[{"x1LLPproj", ",", "x2LLPproj", ",", "xLongProj", ",", "exp"}], 
       "]"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"DecayAcceptanceGeometry", "[", 
      RowBox[{"coord1_", ",", "coord2_", ",", "xLongProj_", ",", "exp"}], 
      "]"}], "=", 
     RowBox[{"IfLLPtoDet", "[", 
      RowBox[{"coord1", ",", "coord2", ",", "xLongProj", ",", "exp"}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", ",", 
   RowBox[{"{", 
    RowBox[{"exp", ",", "explistship"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{
  3.9050114960281878`*^9, {3.905012136136806*^9, 3.905012166938695*^9}, 
   3.9050122570740633`*^9, {3.905013014434914*^9, 3.9050130549820566`*^9}, {
   3.9050131005089927`*^9, 3.9050131559288497`*^9}, {3.9050141043770494`*^9, 
   3.905014110450941*^9}, {3.9050141633649054`*^9, 3.905014184165939*^9}, {
   3.905014421528225*^9, 3.905014437450856*^9}, 3.9050171518566656`*^9, {
   3.9050593130352316`*^9, 3.905059333882703*^9}, {3.910258575219149*^9, 
   3.9102586413238597`*^9}, 3.9102588190009413`*^9, 3.9102599362810106`*^9, {
   3.915437006845696*^9, 3.915437091492157*^9}, {3.9154372081248837`*^9, 
   3.9154372081986127`*^9}},
 CellLabel->"In[90]:=",ExpressionUUID->"fc1f5d22-5d88-4cc4-b98f-ee20e05280ab"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["SHADOWS configurations", "Subsection",
 CellChangeTimes->{{3.893316213538088*^9, 3.8933162151948366`*^9}, {
  3.8971457967333164`*^9, 
  3.89714579856444*^9}},ExpressionUUID->"8ab71b71-8a97-4513-810e-\
36a175aafeb7"],

Cell[CellGroupData[{

Cell["Geometry", "Subsubsection",
 CellChangeTimes->{{3.8933424486741037`*^9, 
  3.893342449626558*^9}},ExpressionUUID->"d5d22e24-f7ea-4967-83b7-\
c4770ca4a591"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"explistshad", "=", 
    RowBox[{"{", 
     RowBox[{
     "\"\<SHADOWS-LoI\>\"", ",", "\"\<SHADOWS-LoI-up-to-magnet\>\"", ",", 
      "\"\<SHADOWS-Gaia\>\"", ",", "\"\<SHADOWS-latest\>\""}], "}"}]}], ";"}],
   "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Distance", " ", "to", " ", "the", " ", "fiducial", " ", "volume", " ", 
    "along", " ", "the", " ", "beamline", " ", 
    RowBox[{"axis", ".", " ", 
     RowBox[{"MapThread", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"list1", "[", "#", "]"}], "=", "#2"}], ")"}], "&"}], ",", 
       RowBox[{"{", 
        RowBox[{"listexp", ",", "listvals"}], "}"}]}], "]"}]}], " ", 
    "equates", " ", "the", " ", "elements", " ", "list1", " ", "with", " ", 
    "keys", " ", "from", " ", "listexp", " ", "to", " ", "the", " ", 
    "corresponding", " ", "elements", " ", "of", " ", "the", " ", "list", " ",
     "listvals"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"zToDecayVolumeExperiment", "[", "#1", "]"}], "=", "#2"}], 
       ")"}], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistshad", ",", 
       RowBox[{"{", 
        RowBox[{"14", ",", "14", ",", "10", ",", "14.25"}], "}"}]}], "}"}]}], 
    "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Detector", " ", "has", " ", "the", " ", "axis", " ", "along", " ", 
    "which", " ", "its", " ", "components", " ", "are", " ", 
    RowBox[{"placed", ".", " ", "The"}], " ", "option", " ", "below", " ", 
    "defines", " ", "the", " ", "orientation", " ", "of", " ", "the", " ", 
    "final", " ", "plane", " ", "transverse", " ", "to", " ", "this", " ", 
    "axis", " ", "relative", " ", "to", " ", "the", " ", "beamline"}], "*)"}],
   "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Transverse", " ", "if", " ", "the", " ", "plane", " ", "is", " ", 
     "tranverse", " ", 
     RowBox[{"(", 
      RowBox[{"SHiP", ",", " ", 
       RowBox[{"FACET", " ", "etc"}]}], ")"}]}], ",", " ", 
    RowBox[{
    "and", " ", "Parallel", " ", "if", " ", "it", " ", "is", " ", "parallel", 
     " ", 
     RowBox[{"(", 
      RowBox[{"MATHUSLA", ",", " ", "ANUBIS"}]}]}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"DetectorPlaneOrientationExperiment", "[", "#1", "]"}], "=", 
        "#2"}], ")"}], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistshad", ",", 
       RowBox[{"Table", "[", 
        RowBox[{"\"\<Transverse\>\"", ",", 
         RowBox[{"Length", "[", "explistshad", "]"}]}], "]"}]}], "}"}]}], 
    "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Facility", " ", "hosting", " ", "the", " ", 
     RowBox[{"experiment", ":", " ", "SPS"}]}], ",", " ", "Fermilab", ",", 
    " ", "LHC", ",", " ", 
    RowBox[{"FCC", "-", "hh"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"FacilityExperiment", "[", "#1", "]"}], "=", "#2"}], ")"}], 
      "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistshad", ",", 
       RowBox[{"Table", "[", 
        RowBox[{"\"\<SPS\>\"", ",", 
         RowBox[{"Length", "[", "explistshad", "]"}]}], "]"}]}], "}"}]}], 
    "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Geometry", " ", "of", " ", "the", " ", 
     RowBox[{"experiment", ":", " ", "box"}]}], ",", " ", "cylinder", ",", 
    " ", 
    RowBox[{"annular", " ", "cylinder"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"GeometryExperiment", "[", "#1", "]"}], "=", "#2"}], ")"}], 
      "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistshad", ",", 
       RowBox[{"Table", "[", 
        RowBox[{"\"\<Box\>\"", ",", 
         RowBox[{"Length", "[", "explistshad", "]"}]}], "]"}]}], "}"}]}], 
    "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Transverse", " ", "dimensions", " ", "of", " ", "the", " ", "decay", " ",
      "volume", " ", "assuming", " ", "box", " ", "geometry"}], ",", " ", 
    RowBox[{
    "or", " ", "cylindrical", " ", "geometry", " ", "if", " ", "the", " ", 
     "detector", " ", "plane", " ", "is", " ", "parallel", " ", "to", " ", 
     "the", " ", "beamline", " ", 
     RowBox[{
      RowBox[{"(", "ANUBIS", ")"}], ".", " ", "Otherwise"}], " ", "set", " ", 
     "to", " ", "zero"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MapThread", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"dxDecayVolumeExperiment", "[", 
        RowBox[{"z_", ",", "#1"}], "]"}], "=", "#2"}], ")"}], "&"}], ",", 
    RowBox[{"{", 
     RowBox[{"explistshad", ",", 
      RowBox[{"{", 
       RowBox[{"2.5", ",", "2.5", ",", "3.5", ",", 
        RowBox[{"(*", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"z", "<", 
            RowBox[{"14.5", "+", "12"}]}], ",", "3.35", ",", "2.5"}], "]"}], 
         "*)"}], "2.5"}], "}"}]}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"dyDecayVolumeExperiment", "[", 
         RowBox[{"z_", ",", "#1"}], "]"}], "=", "#2"}], ")"}], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistshad", ",", 
       RowBox[{"{", 
        RowBox[{"2.5", ",", "2.5", ",", "2.5", ",", "2.5"}], "}"}]}], "}"}]}],
     "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Decay", " ", "volume", " ", "length", " ", "along", " ", "the", " ", 
    "beamline", " ", "axis"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"dzDecayVolumeExperiment", "[", "#1", "]"}], "=", "#2"}], 
       ")"}], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistshad", ",", 
       RowBox[{"{", 
        RowBox[{"20.", ",", "20.", ",", "20.", ",", "19."}], "}"}]}], "}"}]}],
     "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Distance", " ", "from", " ", "the", " ", "beamline", " ", "to", " ", 
     "the", " ", "decay", " ", "volume", " ", "center", " ", "and", " ", 
     "detector", " ", "along", " ", "the", " ", "x"}], ",", 
    RowBox[{"y", " ", "axes"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"listxtodeccentershad", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "1"}], "-", 
      FractionBox[
       RowBox[{"dxDecayVolumeExperiment", "[", 
        RowBox[{"z", ",", "\"\<SHADOWS-LoI\>\""}], "]"}], "2"]}], ",", 
     RowBox[{
      RowBox[{"-", "1"}], "-", 
      FractionBox[
       RowBox[{"dxDecayVolumeExperiment", "[", 
        RowBox[{"z", ",", "\"\<SHADOWS-LoI-up-to-magnet\>\""}], "]"}], "2"]}],
      ",", 
     RowBox[{
      RowBox[{"-", "0.5"}], "-", 
      FractionBox[
       RowBox[{"dxDecayVolumeExperiment", "[", 
        RowBox[{"z", ",", "\"\<SHADOWS-Gaia\>\""}], "]"}], "2"]}], ",", 
     RowBox[{"(*", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"z", "<", 
         RowBox[{"14.5", "+", "12"}]}], ",", 
        RowBox[{"Evaluate", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "1.4"}], "-", 
           FractionBox["3.35", "2"]}], "//", "Simplify"}], "]"}], ",", 
        RowBox[{"Evaluate", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "1.4"}], "-", 
           RowBox[{"(", 
            RowBox[{"3.35", "-", "2.5"}], ")"}], "-", 
           FractionBox["2.5", "2"]}], "//", "Simplify"}], "]"}]}], "]"}], 
      "*)"}], 
     RowBox[{
      RowBox[{"-", "1.55"}], "-", 
      FractionBox[
       RowBox[{"dxDecayVolumeExperiment", "[", 
        RowBox[{"z", ",", "\"\<SHADOWS-latest\>\""}], "]"}], "2"]}]}], 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MapThread", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"xToDecayVolumeCenterExperiment", "[", 
        RowBox[{"z_", ",", "#1"}], "]"}], "=", "#2"}], ")"}], "&"}], ",", 
    RowBox[{"{", 
     RowBox[{"explistshad", ",", "listxtodeccentershad"}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"yToDecayVolumeCenterExperiment", "[", 
         RowBox[{"z_", ",", "#1"}], "]"}], "=", "#2"}], ")"}], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistshad", ",", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", 
         RowBox[{"Length", "[", "explistshad", "]"}]}], "]"}]}], "}"}]}], 
    "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Inner", " ", "and", " ", "outer", " ", "radii", " ", "of", " ", "the", 
    " ", "decay", " ", 
    RowBox[{"volume", ".", " ", "Applicable"}], " ", "if", " ", "the", " ", 
    "decay", " ", "volume", " ", "has", " ", "cylindrical", " ", "geometry"}],
    "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"RinnerDecayVolumeExperiment", "[", 
      RowBox[{"exp", ",", "z_"}], "]"}], "=", "0"}], ",", 
    RowBox[{"{", 
     RowBox[{"exp", ",", "explistshad"}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"RouterDecayVolumeExperiment", "[", 
       RowBox[{"exp", ",", "z_"}], "]"}], "=", "0"}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistshad"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"z", "-", 
    RowBox[{
    "coordinate", " ", "of", " ", "the", " ", "center", " ", "of", " ", "the",
      " ", "decay", " ", "volume"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"zToDecayVolumeCenterExperiment", "[", "exp", "]"}], "=", 
      RowBox[{
       RowBox[{"zToDecayVolumeExperiment", "[", "exp", "]"}], "+", 
       FractionBox[
        RowBox[{"dzDecayVolumeExperiment", "[", "exp", "]"}], "2"]}]}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistshad"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Maximal", " ", 
    RowBox[{"long", ".", " ", "displacement"}], " ", "of", " ", "the", " ", 
    "decay", " ", "volume"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"zMaxDecayVolumeExperiment", "[", "exp", "]"}], "=", 
     RowBox[{
      RowBox[{"zToDecayVolumeExperiment", "[", "exp", "]"}], "+", 
      RowBox[{"dzDecayVolumeExperiment", "[", "exp", "]"}]}]}], ",", 
    RowBox[{"{", 
     RowBox[{"exp", ",", "explistshad"}], "}"}]}], "]"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Whether", " ", "the", " ", "decay", " ", "volume", " ", "serves", " ", 
    "as", " ", "detector", " ", 
    RowBox[{"(", 
     RowBox[{"True", " ", "or", " ", "False"}], ")"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"DecayVolumeAsDetectorExperiment", "[", "exp", "]"}], "=", 
     "\"\<False\>\""}], ",", 
    RowBox[{"{", 
     RowBox[{"exp", ",", "explistshad"}], "}"}]}], "]"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Transverse", " ", "dimensions", " ", "of", " ", "the", " ", "detector", 
    " ", "assuming", " ", "box", " ", "geometry"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MapThread", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"dxDetectorExperiment", "[", 
        RowBox[{"#1", ",", "z_"}], "]"}], "=", "#2"}], ")"}], "&"}], ",", 
    RowBox[{"{", 
     RowBox[{"explistshad", ",", 
      RowBox[{"Table", "[", 
       RowBox[{"2.5", ",", 
        RowBox[{"Length", "[", "explistshad", "]"}]}], "]"}]}], "}"}]}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"dyDetectorExperiment", "[", 
         RowBox[{"#1", ",", "z_"}], "]"}], "=", "#2"}], ")"}], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistshad", ",", 
       RowBox[{"Table", "[", 
        RowBox[{"2.5", ",", 
         RowBox[{"Length", "[", "explistshad", "]"}]}], "]"}]}], "}"}]}], 
    "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Length", " ", "of", " ", "the", " ", "detector", " ", "in", " ", "z", " ",
     "plane"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"dzDetectorExperiment", "[", "#1", "]"}], "=", "#2"}], ")"}], 
      "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistshad", ",", 
       RowBox[{"{", 
        RowBox[{"12", ",", "2.5", ",", "2.5", ",", "10.7"}], "}"}]}], "}"}]}],
     "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Coordinates", " ", "of", " ", "the", " ", "center", " ", "of", " ", "the",
     " ", "detector"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MapThread", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"xToDetectorCenterExperiment", "[", "#1", "]"}], "=", "#2"}], 
      ")"}], "&"}], ",", 
    RowBox[{"{", 
     RowBox[{"explistshad", ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "1"}], "-", 
         FractionBox[
          RowBox[{"dxDetectorExperiment", "[", 
           RowBox[{"\"\<SHADOWS-LoI\>\"", ",", "z"}], "]"}], "2"]}], ",", 
        RowBox[{
         RowBox[{"-", "1"}], "-", 
         FractionBox[
          RowBox[{"dxDetectorExperiment", "[", 
           RowBox[{"\"\<SHADOWS-LoI-up-to-magnet\>\"", ",", "z"}], "]"}], 
          "2"]}], ",", 
        RowBox[{
         RowBox[{"-", "1"}], "-", 
         FractionBox[
          RowBox[{"dxDetectorExperiment", "[", 
           RowBox[{"\"\<SHADOWS-Gaia\>\"", ",", "z"}], "]"}], "2"]}], ",", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"-", "1.4"}], "-", 
          RowBox[{"(", 
           RowBox[{"3.35", "-", "2.5"}], ")"}], "-", 
          FractionBox[
           RowBox[{
           "dxDetectorExperiment", "[", "\"\<SHADOWS-latest\>\"", "]"}], 
           "2"]}], "*)"}], 
        RowBox[{
         RowBox[{"-", "1.55"}], "-", 
         FractionBox[
          RowBox[{"dxDetectorExperiment", "[", 
           RowBox[{"\"\<SHADOWS-latest\>\"", ",", "z"}], "]"}], "2"]}]}], 
       "}"}]}], "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"yToDetectorCenterExperiment", "[", "exp", "]"}], "=", "0"}], 
    ",", 
    RowBox[{"{", 
     RowBox[{"exp", ",", "explistshad"}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"zToDetectorCenterExperiment", "[", "exp", "]"}], "=", 
      RowBox[{
       RowBox[{"zMaxDecayVolumeExperiment", "[", "exp", "]"}], "+", 
       FractionBox[
        RowBox[{"dzDetectorExperiment", "[", "exp", "]"}], "2"]}]}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistshad"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Inner", " ", "and", " ", "outer", " ", "radii", " ", "of", " ", "the", 
    " ", "detector"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"RinnerDetectorExperiment", "[", 
      RowBox[{"exp", ",", "z_"}], "]"}], "=", "0"}], ",", 
    RowBox[{"{", 
     RowBox[{"exp", ",", "explistshad"}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"RouterDetectorExperiment", "[", 
       RowBox[{"exp", ",", "z_"}], "]"}], "=", "0"}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistshad"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Length", " ", "of", " ", "the", " ", "detector", " ", "along", " ", "the",
     " ", "detector", " ", "axis"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"dxLongDetectorExperiment", "[", "exp", "]"}], "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"DetectorPlaneOrientationExperiment", "[", "exp", "]"}], 
         "\[Equal]", "\"\<Transverse\>\""}], ",", 
        RowBox[{"dzDetectorExperiment", "[", "exp", "]"}], ",", 
        RowBox[{"dyDetectorExperiment", "[", 
         RowBox[{"exp", ",", "z"}], "]"}]}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistshad"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "The", " ", "maximal", " ", "coordinate", " ", "of", " ", "the", " ", 
    "end", " ", "of", " ", "the", " ", "detector", " ", "plane", " ", 
    RowBox[{"(", 
     RowBox[{"along", " ", "the", " ", "detector", " ", "axis"}], ")"}], " ", 
    "used", " ", "to", " ", "calculate", " ", "the", " ", "decay", " ", 
    RowBox[{"acceptance", ".", " ", "May"}], " ", "be", " ", "either", " ", 
    "the", " ", "z", " ", "coordinate", " ", "or", " ", "the", " ", "y", " ", 
    "coordinate", " ", 
    RowBox[{"(", 
     RowBox[{
     "if", " ", "the", " ", "final", " ", "detector", " ", "plane", " ", "is",
       " ", "oriented", " ", "parallel", " ", "to", " ", "the", " ", 
      "beamline"}], ")"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"xLongMaxDetectorExperiment", "[", "exp", "]"}], "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"DetectorPlaneOrientationExperiment", "[", "exp", "]"}], 
         "\[Equal]", "\"\<Transverse\>\""}], ",", 
        RowBox[{
         RowBox[{"zMaxDecayVolumeExperiment", "[", "exp", "]"}], "+", 
         RowBox[{"dxLongDetectorExperiment", "[", "exp", "]"}]}], ",", 
        RowBox[{
         RowBox[{"yToDetectorCenterExperiment", "[", "exp", "]"}], "+", 
         RowBox[{
          RowBox[{"dyDetectorExperiment", "[", 
           RowBox[{"exp", ",", "z"}], "]"}], "/", "2"}]}]}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistshad"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Position", " ", "of", " ", "the", " ", "final", " ", "plane", " ", "for", 
    " ", "the", " ", "decay", " ", "products", " ", "along", " ", "the", " ", 
    "detector", " ", "axis"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"xLongDecayProductFinalPlaneExperiment", "[", "exp", "]"}], "=", 
     RowBox[{"xLongMaxDetectorExperiment", "[", "exp", "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"exp", ",", "explistshad"}], "}"}]}], "]"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Whether", " ", "the", " ", "experiment", " ", "has", " ", "dipole", " ", 
    "magnet", " ", "in", " ", "the", " ", "detector", " ", 
    RowBox[{"(", 
     RowBox[{"True", ",", " ", "False"}], ")"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"DipoleMagnetOptionExperiment", "[", "#1", "]"}], "=", "#2"}],
        ")"}], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistshad", ",", 
       RowBox[{"{", 
        RowBox[{
        "\"\<False\>\"", ",", "\"\<False\>\"", ",", "\"\<False\>\"", ",", 
         "\"\<True\>\""}], "}"}]}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Longitudinal", " ", "positions", " ", "of", " ", "the", " ", "dipole", 
    " ", "magnet", " ", "of", " ", "the", " ", "detector"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MapThread", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"zMagnetMinExperiment", "[", "#1", "]"}], "=", "#2"}], ")"}], 
     "&"}], ",", 
    RowBox[{"{", 
     RowBox[{"explistshad", ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{
         "zMaxDecayVolumeExperiment", "[", "\"\<SHADOWS-LoI\>\"", "]"}], "+", 
         "2.5"}], ",", "0", ",", "0", ",", 
        RowBox[{
         RowBox[{
         "zMaxDecayVolumeExperiment", "[", "\"\<SHADOWS-latest\>\"", "]"}], 
         "+", "1.8"}]}], "}"}]}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"zMagnetMaxExperiment", "[", "#1", "]"}], "=", "#2"}], ")"}], 
      "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistshad", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"zMagnetMinExperiment", "[", "\"\<SHADOWS-LoI\>\"", "]"}], 
          "+", "6"}], ",", "0", ",", "0", ",", 
         RowBox[{
          RowBox[{
          "zMagnetMinExperiment", "[", "\"\<SHADOWS-latest\>\"", "]"}], "+", 
          "3.3"}]}], "}"}]}], "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Mean", " ", "magnetic", " ", "field", " ", "of", " ", "the", " ", 
    "dipole", " ", "magnet"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"magnshad", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"1", "/", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"zMagnetMaxExperiment", "[", "\"\<SHADOWS-LoI\>\"", "]"}], 
        "-", 
        RowBox[{"zMagnetMinExperiment", "[", "\"\<SHADOWS-LoI\>\"", "]"}]}], 
       ")"}]}], ",", "0", ",", "0", ",", 
     RowBox[{"1", "/", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"zMagnetMaxExperiment", "[", "\"\<SHADOWS-latest\>\"", "]"}], 
        "-", 
        RowBox[{
        "zMagnetMinExperiment", "[", "\"\<SHADOWS-latest\>\"", "]"}]}], 
       ")"}]}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"MagneticFieldExperiment", "[", "#1", "]"}], "=", "#2"}], 
       ")"}], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistshad", ",", "magnshad"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"ECAL", " ", "option", " ", 
    RowBox[{"(", 
     RowBox[{"True", ",", "False"}], ")"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"ECALoptionExperiment", "[", "exp", "]"}], "=", 
      "\"\<True\>\""}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistshad"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Position", " ", "of", " ", "the", " ", "beginning", " ", "of", " ", "the",
     " ", "ECAL"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"zECALminExperiment", "[", "#1", "]"}], "=", "#2"}], ")"}], 
      "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistshad", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"zMagnetMaxExperiment", "[", "\"\<SHADOWS-LoI\>\"", "]"}], 
          "+", "2"}], ",", "0", ",", "0", ",", 
         RowBox[{
          RowBox[{
          "zMagnetMaxExperiment", "[", "\"\<SHADOWS-latest\>\"", "]"}], "+", 
          "3"}]}], "}"}]}], "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "The", " ", "final", " ", "detector", " ", "plane", " ", "needed", " ", 
     "to", " ", "reconstruct", " ", 
     RowBox[{"muons", ".", " ", "Depeding"}], " ", "on", " ", "the", " ", 
     "experiment"}], ",", " ", 
    RowBox[{
    "it", " ", "is", " ", "approximated", " ", "by", " ", "be", " ", "end", 
     " ", "of", " ", "the", " ", "trackers", " ", "or", " ", "the", " ", 
     "muon", " ", "system"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"xLongMuonPlaneExperiment", "[", "#1", "]"}], "=", "#2"}], 
       ")"}], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistshad", ",", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"xLongMaxDetectorExperiment", "[", "exp", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"exp", ",", "explistshad"}], "}"}]}], "]"}]}], "}"}]}], 
    "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "The", " ", "final", " ", "detector", " ", "plane", " ", "needed", " ", 
     "to", " ", "reconstruct", " ", "other", " ", 
     RowBox[{"particles", ".", " ", "Depeding"}], " ", "on", " ", "the", " ", 
     "experiment"}], ",", " ", 
    RowBox[{
    "it", " ", "is", " ", "approximated", " ", "by", " ", "the", " ", "end", 
     " ", "of", " ", "the", " ", "trackers", " ", "or", " ", "the", " ", 
     "calorimeter", " ", "system"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"xLongNonMuonPlaneExperiment", "[", "#1", "]"}], "=", "#2"}], 
       ")"}], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistshad", ",", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"xLongMaxDetectorExperiment", "[", "exp", "]"}], "-", "2"}],
          ",", 
         RowBox[{"{", 
          RowBox[{"exp", ",", "explistshad"}], "}"}]}], "]"}]}], "}"}]}], 
    "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"List", " ", "of", " ", "detectable", " ", 
     RowBox[{"particles", ".", " ", "If"}], " ", "ECAL", " ", "is", " ", 
     "absent"}], ",", " ", 
    RowBox[{
    "it", " ", "is", " ", "assumed", " ", "by", " ", "default", " ", "that", 
     " ", "photons", " ", "and", " ", 
     SubscriptBox[
      SuperscriptBox["K", "0"], "L"], " ", "cannot", " ", "be", " ", 
     "detected"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MapThread", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"DetectablePDGsExperiment", "[", "#1", "]"}], "=", "#2"}], 
      ")"}], "&"}], ",", 
    RowBox[{"{", 
     RowBox[{"explistshad", ",", 
      RowBox[{"Table", "[", 
       RowBox[{"detectablepdgs", ",", 
        RowBox[{"Length", "[", "explistshad", "]"}]}], "]"}]}], "}"}]}], 
   "]"}], ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.893317264035013*^9, 3.8933174203434467`*^9}, {
   3.8933182438677955`*^9, 3.8933182440199656`*^9}, 3.893321326065869*^9, {
   3.8933219852090416`*^9, 3.8933219866166525`*^9}, {3.8934862861505427`*^9, 
   3.8934862890539274`*^9}, {3.893518136933406*^9, 3.893518136941385*^9}, 
   3.8935193127751937`*^9, {3.893520125970277*^9, 3.8935201692938695`*^9}, 
   3.8935206581694236`*^9, 3.894438591819088*^9, {3.897145306686167*^9, 
   3.8971453193387403`*^9}, {3.897145473894456*^9, 3.8971454869083695`*^9}, {
   3.897145802098297*^9, 3.8971458212692275`*^9}, {3.8971458746578712`*^9, 
   3.8971459368963113`*^9}, {3.897146021228483*^9, 3.897146073367137*^9}, {
   3.897146513685112*^9, 3.89714654005366*^9}, {3.8971465787896023`*^9, 
   3.897146635948597*^9}, {3.897146720521307*^9, 3.8971467536766586`*^9}, {
   3.897146797766142*^9, 3.897146801454052*^9}, {3.8971478635244675`*^9, 
   3.8971479155095563`*^9}, {3.8971481781899447`*^9, 3.897148178327561*^9}, {
   3.897383214363018*^9, 3.897383215846017*^9}, {3.898930613639223*^9, 
   3.8989306215126605`*^9}, {3.902812228361971*^9, 3.90281228595677*^9}, {
   3.9028124431425505`*^9, 3.902812443189808*^9}, {3.902813315862112*^9, 
   3.902813317844154*^9}, 3.902813686072316*^9, {3.9050600778316717`*^9, 
   3.9050600781763268`*^9}, 3.910240594784803*^9, {3.9102469736282206`*^9, 
   3.9102469736293592`*^9}, {3.9102539516403255`*^9, 3.910253961494852*^9}, {
   3.91025402109762*^9, 3.9102540211823664`*^9}, {3.9102588265894723`*^9, 
   3.9102588362244916`*^9}, {3.910433139922564*^9, 3.910433157151126*^9}, {
   3.9120565113833294`*^9, 3.9120565195329046`*^9}, 3.9120573104102488`*^9},
 CellLabel->"In[91]:=",ExpressionUUID->"f3a1bcbf-3155-424a-80d6-c37ba43a40f9"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Cross-sections", "Subsubsection",
 CellChangeTimes->{{3.8933256308713317`*^9, 
  3.8933256323468237`*^9}},ExpressionUUID->"4149eca7-cb30-4ee1-acd3-\
7670665d2e51"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"MapThread", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"NPOTexperiment", "[", "#1", "]"}], "=", "#2"}], ")"}], "&"}], 
    ",", 
    RowBox[{"{", 
     RowBox[{"explistshad", ",", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"5", "*", 
         SuperscriptBox["10", "19."]}], ",", 
        RowBox[{"Length", "[", "explistshad", "]"}]}], "]"}]}], "}"}]}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"AtargetExperiment", "[", "#1", "]"}], "=", "#2"}], ")"}], 
      "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistshad", ",", 
       RowBox[{"Table", "[", 
        RowBox[{"56.", ",", 
         RowBox[{"Length", "[", "explistshad", "]"}]}], "]"}]}], "}"}]}], 
    "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Cascade", " ", "enhancement", " ", "of", " ", "the", " ", "production", 
    " ", "relative", " ", "to", " ", "the", " ", "production", " ", "in", " ",
     "pure", " ", "pp", " ", 
    RowBox[{"collisions", ".", " ", "Relevant"}], " ", "for", " ", "fixed", 
    " ", "target", " ", "experiments"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "For", " ", "all", " ", "experiments", " ", "located", " ", "at", " ", 
     "SPS"}], ",", " ", 
    RowBox[{
     RowBox[{
      RowBox[{
      "the", " ", "cascade", " ", "factors", " ", "is", " ", "taken", " ", 
       "from", " ", 
       RowBox[{"http", ":"}]}], "//", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"cds", ".", "cern", ".", "ch"}], "/", "record"}], "/", 
          "2115534"}], "/", "files"}], "/", "SHiP"}], "-", "NOTE", "-", 
       "2015", "-", 
       RowBox[{"009.", 
        RowBox[{"pdf", "?", "version"}]}]}]}], "=", "1"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"CascadeFactorbb", "[", "#1", "]"}], "=", "#2"}], ")"}], 
      "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistshad", ",", 
       RowBox[{"Table", "[", 
        RowBox[{"1.7", ",", 
         RowBox[{"Length", "[", "explistshad", "]"}]}], "]"}]}], "}"}]}], 
    "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Fraction", " ", "of", " ", "produced", " ", "bb", " ", "per", " ", "PoT", 
    " ", "at", " ", "the", " ", "given", " ", "experiment"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"PppTobbExperiment", "[", "exp", "]"}], "=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"\[Sigma]ppTobbInpbFacility", "[", 
        RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}], "/", 
       RowBox[{"\[Sigma]ppInpbFacility", "[", 
        RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}]}], ")"}], 
     SuperscriptBox[
      RowBox[{"AtargetExperiment", "[", "exp", "]"}], "0.29"], "*", 
     RowBox[{"CascadeFactorbb", "[", "exp", "]"}]}]}], ",", 
   RowBox[{"{", 
    RowBox[{"exp", ",", "explistshad"}], "}"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"CascadeFactorcc", "[", "#1", "]"}], "=", "#2"}], ")"}], 
      "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistshad", ",", 
       RowBox[{"Table", "[", 
        RowBox[{"2.3", ",", 
         RowBox[{"Length", "[", "explistshad", "]"}]}], "]"}]}], "}"}]}], 
    "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Fraction", " ", "of", " ", "produced", " ", "cc", " ", "per", " ", "PoT", 
    " ", "at", " ", "the", " ", "given", " ", "experiment"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"PppToccExperiment", "[", "exp", "]"}], "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"\[Sigma]ppToccInpbFacility", "[", 
         RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}], "/", 
        RowBox[{"\[Sigma]ppInpbFacility", "[", 
         RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}]}], ")"}], 
      SuperscriptBox[
       RowBox[{"AtargetExperiment", "[", "exp", "]"}], "0.29"], "*", 
      RowBox[{"CascadeFactorcc", "[", "exp", "]"}]}]}], ",", 
    RowBox[{"{", 
     RowBox[{"exp", ",", "explistshad"}], "}"}]}], "]"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Fraction", " ", "of", " ", "produced", " ", "h", " ", "per", " ", "PoT", 
    " ", "at", " ", "the", " ", "given", " ", "experiment"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"PppTohExperiment", "[", "exp", "]"}], "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"\[Sigma]ppTohInpbFacility", "[", 
          RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}], "/", 
         RowBox[{"\[Sigma]ppInpbFacility", "[", 
          RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}]}], ")"}], 
       SuperscriptBox[
        RowBox[{"AtargetExperiment", "[", "exp", "]"}], "0.29"]}]}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistshad"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Fraction", " ", "of", " ", "produced", " ", "W", " ", "per", " ", "PoT", 
    " ", "at", " ", "the", " ", "given", " ", "experiment"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"PppToWExperiment", "[", "exp", "]"}], "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"\[Sigma]ppToWInpbFacility", "[", 
          RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}], "/", 
         RowBox[{"\[Sigma]ppInpbFacility", "[", 
          RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}]}], ")"}], 
       SuperscriptBox[
        RowBox[{"AtargetExperiment", "[", "exp", "]"}], "0.29"]}]}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistshad"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Fraction", " ", "of", " ", "produced", " ", 
    SuperscriptBox["\[Pi]", "0"], " ", "per", " ", "PoT", " ", "at", " ", 
    "the", " ", "given", " ", "experiment"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"PppTo\[Pi]0exp", "[", "exp", "]"}], "=", 
      RowBox[{"PppTo\[Pi]0Facility", "[", 
       RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistshad"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Fraction", " ", "of", " ", "produced", " ", "\[Eta]", " ", "per", " ", 
    "PoT", " ", "at", " ", "the", " ", "given", " ", "experiment"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"PppTo\[Eta]exp", "[", "exp", "]"}], "=", 
      RowBox[{"PppTo\[Eta]Facility", "[", 
       RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistshad"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Fraction", " ", "of", " ", "produced", " ", 
    RowBox[{"\[Eta]", "'"}], " ", "per", " ", "PoT", " ", "at", " ", "the", 
    " ", "given", " ", "experiment"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"PppTo\[Eta]prexp", "[", "exp", "]"}], "=", 
      RowBox[{"PppTo\[Eta]prFacility", "[", 
       RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistshad"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Fraction", " ", "of", " ", "produced", " ", 
    SuperscriptBox["\[Rho]", "0"], " ", "per", " ", "PoT", " ", "at", " ", 
    "the", " ", "given", " ", "experiment"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"PppTo\[Rho]0exp", "[", "exp", "]"}], "=", 
      RowBox[{"PppTo\[Rho]0Facility", "[", 
       RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistshad"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Fraction", " ", "of", " ", "produced", " ", "\[Omega]", " ", "per", " ", 
    "PoT", " ", "at", " ", "the", " ", "given", " ", "experiment"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"PppTo\[Omega]exp", "[", "exp", "]"}], "=", 
      RowBox[{"PppTo\[Omega]Facility", "[", 
       RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistshad"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Fraction", " ", "of", " ", "produced", " ", 
    RowBox[{"J", "/", "\[Psi]"}], 
    RowBox[{"(", 
     RowBox[{"1", "s"}], ")"}], " ", "per", " ", "PoT", " ", "at", " ", "the",
     " ", "given", " ", "experiment"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"PppToJpsiexp", "[", "exp", "]"}], "=", 
      RowBox[{
       RowBox[{"PppToJpsiFacility", "[", 
        RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}], 
       SuperscriptBox[
        RowBox[{"AtargetExperiment", "[", "exp", "]"}], "0.29"]}]}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistshad"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Fraction", " ", "of", " ", "produced", " ", "\[CapitalUpsilon]", 
    RowBox[{"(", 
     RowBox[{"1", "s"}], ")"}], " ", "per", " ", "PoT", " ", "at", " ", "the",
     " ", "given", " ", "experiment"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"PppToUpsilonexp", "[", "exp", "]"}], "=", 
      RowBox[{
       RowBox[{"PppToUpsilonFacility", "[", 
        RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}], 
       SuperscriptBox[
        RowBox[{"AtargetExperiment", "[", "exp", "]"}], "0.29"]}]}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistshad"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Fraction", " ", "of", " ", "produced", " ", "\[Phi]", " ", "at", " ", 
    "the", " ", "given", " ", "experiment"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"PppToPhiexp", "[", "exp", "]"}], "=", 
      RowBox[{"PppToPhiFacility", "[", 
       RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistshad"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Overall", " ", "table", " ", "with", " ", "cross"}], "-", 
    RowBox[{"sections", " ", "used", " ", "for", " ", "exporting"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"TableNumbersParticlesExperiment", "[", "exp", "]"}], "=", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "\"\<Facility\>\"", ",", "\"\<Npot\>\"", ",", "\"\<Atarget\>\"", ",", 
         "\"\<PPi0\>\"", ",", "\"\<PEta\>\"", ",", "\"\<PEtapr\>\"", ",", 
         "\"\<PRho0\>\"", ",", "\"\<POmega\>\"", ",", "\"\<Pc\>\"", ",", 
         "\"\<Pb\>\"", ",", "\"\<PW\>\"", ",", "\"\<Ph\>\"", ",", 
         "\"\<PJpsi\>\"", ",", "\"\<PUpsilon\>\"", ",", "\"\<PPhi\>\""}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"FacilityExperiment", "[", "exp", "]"}], ",", 
         RowBox[{"NPOTexperiment", "[", "exp", "]"}], ",", 
         RowBox[{"AtargetExperiment", "[", "exp", "]"}], ",", 
         RowBox[{"PppTo\[Pi]0exp", "[", "exp", "]"}], ",", 
         RowBox[{"PppTo\[Eta]exp", "[", "exp", "]"}], ",", 
         RowBox[{"PppTo\[Eta]prexp", "[", "exp", "]"}], ",", 
         RowBox[{"PppTo\[Rho]0exp", "[", "exp", "]"}], ",", 
         RowBox[{"PppTo\[Omega]exp", "[", "exp", "]"}], ",", 
         RowBox[{"2", 
          RowBox[{"PppToccExperiment", "[", "exp", "]"}]}], ",", 
         RowBox[{"2", 
          RowBox[{"PppTobbExperiment", "[", "exp", "]"}]}], ",", 
         RowBox[{"PppToWExperiment", "[", "exp", "]"}], ",", 
         RowBox[{"PppTohExperiment", "[", "exp", "]"}], ",", 
         RowBox[{"PppToJpsiexp", "[", "exp", "]"}], ",", 
         RowBox[{"PppToUpsilonexp", "[", "exp", "]"}], ",", 
         RowBox[{"PppToPhiexp", "[", "exp", "]"}]}], "}"}]}], "}"}], "//", 
     "N"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"exp", ",", "explistshad"}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.89334245813497*^9, 3.893342462639369*^9}, 
   3.8933425046239576`*^9, {3.8933426281147175`*^9, 3.8933426292773294`*^9}, {
   3.8933428078022146`*^9, 3.893342835211072*^9}, {3.8941781681427155`*^9, 
   3.894178170052752*^9}, {3.8941786445746937`*^9, 3.8941786470248833`*^9}, {
   3.8972355491374345`*^9, 3.8972355653275547`*^9}, {3.8972356089383044`*^9, 
   3.8972356099713836`*^9}, {3.8972860984594684`*^9, 
   3.8972861339088907`*^9}, {3.8991963094239025`*^9, 3.8991963099576454`*^9}, 
   3.8991970307015667`*^9, {3.8991971404667006`*^9, 3.899197140660447*^9}},
 CellLabel->
  "In[128]:=",ExpressionUUID->"e132ac1a-9c1c-437d-8eb4-7fe4b555c52f"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Conditions for the LLP to decay inside the decay volume and for the products \
to point to the end of the detector\
\>", "Subsubsection",
 CellChangeTimes->{{3.905011297554874*^9, 3.9050113192993593`*^9}, 
   3.9154372082054987`*^9},ExpressionUUID->"225b5f49-1ad4-4356-8b01-\
807e9cd557e0"],

Cell[BoxData[
 RowBox[{"Do", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"IfLLPinsideDecVol", "[", 
      RowBox[{"zLLP_", ",", "xLLP_", ",", "yLLP_", ",", "exp"}], "]"}], "=", 
     RowBox[{"IfLLPinsideDecVolSimple", "[", "exp", "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"IfLLPtoDet", "[", 
        RowBox[{
        "x1LLPproj_", ",", "x2LLPproj_", ",", "xLongProj_", ",", "exp"}], 
        "]"}], ",", 
       RowBox[{"IfLLPnotToDet", "[", 
        RowBox[{
        "x1LLPproj_", ",", "x2LLPproj_", ",", "xLongProj_", ",", "exp"}], 
        "]"}]}], "}"}], "=", 
     RowBox[{"IfParticlePointsToDetSimple", "[", "exp", "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"IfLLPdecVolToDet", "[", 
      RowBox[{
      "zLLP_", ",", "xLLP_", ",", "yLLP_", ",", "x1LLPproj_", ",", 
       "x2LLPproj_", ",", "xLongProj_", ",", "exp"}], "]"}], "=", 
     RowBox[{
      RowBox[{"IfLLPinsideDecVol", "[", 
       RowBox[{"zLLP", ",", "xLLP", ",", "yLLP", ",", "exp"}], "]"}], "*", 
      RowBox[{"IfLLPtoDet", "[", 
       RowBox[{"x1LLPproj", ",", "x2LLPproj", ",", "xLongProj", ",", "exp"}], 
       "]"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"IfLLPdecVolNotToDet", "[", 
      RowBox[{
      "zLLP_", ",", "xLLP_", ",", "yLLP_", ",", "x1LLPproj_", ",", 
       "x2LLPproj_", ",", "xLongProj_", ",", "exp"}], "]"}], "=", 
     RowBox[{
      RowBox[{"IfLLPinsideDecVol", "[", 
       RowBox[{"zLLP", ",", "xLLP", ",", "yLLP", ",", "exp"}], "]"}], "*", 
      RowBox[{"IfLLPnotToDet", "[", 
       RowBox[{"x1LLPproj", ",", "x2LLPproj", ",", "xLongProj", ",", "exp"}], 
       "]"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"DecayAcceptanceGeometry", "[", 
      RowBox[{"coord1_", ",", "coord2_", ",", "xLongProj_", ",", "exp"}], 
      "]"}], "=", 
     RowBox[{"IfLLPtoDet", "[", 
      RowBox[{"coord1", ",", "coord2", ",", "xLongProj", ",", "exp"}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", ",", 
   RowBox[{"{", 
    RowBox[{"exp", ",", "explistshad"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.9050140592081804`*^9, 3.9050140598538327`*^9}, {
   3.9050141043830338`*^9, 3.90501411045494*^9}, {3.90501416337489*^9, 
   3.905014201933969*^9}, {3.905014445797393*^9, 3.9050144622061605`*^9}, 
   3.9050171518616524`*^9, {3.905059357688766*^9, 3.9050593578592477`*^9}, {
   3.9102585745042086`*^9, 3.910258640909275*^9}, 3.9102588184755774`*^9, 
   3.9102599356656327`*^9, {3.915437006863999*^9, 3.9154370914967194`*^9}, {
   3.9154372082267694`*^9, 3.9154372082991743`*^9}},
 CellLabel->
  "In[145]:=",ExpressionUUID->"4e1ebb16-5c7f-4fdf-9b63-b9b7af8a10bf"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["MATHUSLA/MATHUSLA-FCC", "Subsection",
 CellChangeTimes->{{3.8933162253125916`*^9, 
  3.8933162298867297`*^9}},ExpressionUUID->"8d8c3c02-4ec6-4830-975c-\
563fed99b618"],

Cell[CellGroupData[{

Cell["Geometry", "Subsubsection",
 CellChangeTimes->{{3.893342623432827*^9, 
  3.893342624458*^9}},ExpressionUUID->"fcf98f3f-618e-468c-8940-0f99f1aac577"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"explistmat", "=", 
    RowBox[{"{", 
     RowBox[{"\"\<MATHUSLA\>\"", ",", "\"\<MATHUSLA-FCC\>\""}], "}"}]}], 
   ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Distance", " ", "to", " ", "the", " ", "fiducial", " ", "volume", " ", 
    "along", " ", "the", " ", "beamline", " ", 
    RowBox[{"axis", ".", " ", 
     RowBox[{"MapThread", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"list1", "[", "#", "]"}], "=", "#2"}], ")"}], "&"}], ",", 
       RowBox[{"{", 
        RowBox[{"listexp", ",", "listvals"}], "}"}]}], "]"}]}], " ", 
    "equates", " ", "the", " ", "elements", " ", "list1", " ", "with", " ", 
    "keys", " ", "from", " ", "listexp", " ", "to", " ", "the", " ", 
    "corresponding", " ", "elements", " ", "of", " ", "the", " ", "list", " ",
     "listvals"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"zToDecayVolumeExperiment", "[", "#1", "]"}], "=", "#2"}], 
       ")"}], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistmat", ",", 
       RowBox[{"{", 
        RowBox[{"68", ",", "68"}], "}"}]}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Detector", " ", "has", " ", "the", " ", "axis", " ", "along", " ", 
    "which", " ", "its", " ", "components", " ", "are", " ", 
    RowBox[{"placed", ".", " ", "The"}], " ", "option", " ", "below", " ", 
    "defines", " ", "the", " ", "orientation", " ", "of", " ", "the", " ", 
    "final", " ", "plane", " ", "transverse", " ", "to", " ", "this", " ", 
    "axis", " ", "relative", " ", "to", " ", "the", " ", "beamline"}], "*)"}],
   "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Transverse", " ", "if", " ", "the", " ", "plane", " ", "is", " ", 
     "tranverse", " ", 
     RowBox[{"(", 
      RowBox[{"SHiP", ",", " ", 
       RowBox[{"FACET", " ", "etc"}]}], ")"}]}], ",", " ", 
    RowBox[{
    "and", " ", "Parallel", " ", "if", " ", "it", " ", "is", " ", "parallel", 
     " ", 
     RowBox[{"(", 
      RowBox[{"MATHUSLA", ",", " ", "ANUBIS"}]}]}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"DetectorPlaneOrientationExperiment", "[", "#1", "]"}], "=", 
        "#2"}], ")"}], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistmat", ",", 
       RowBox[{"Table", "[", 
        RowBox[{"\"\<Parallel\>\"", ",", 
         RowBox[{"Length", "[", "explistmat", "]"}]}], "]"}]}], "}"}]}], 
    "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Facility", " ", "hosting", " ", "the", " ", 
     RowBox[{"experiment", ":", " ", "SPS"}]}], ",", " ", "Fermilab", ",", 
    " ", "LHC", ",", " ", 
    RowBox[{"FCC", "-", "hh"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"FacilityExperiment", "[", "#1", "]"}], "=", "#2"}], ")"}], 
      "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistmat", ",", 
       RowBox[{"{", 
        RowBox[{"\"\<LHC\>\"", ",", "\"\<FCC-hh\>\""}], "}"}]}], "}"}]}], 
    "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Geometry", " ", "of", " ", "the", " ", 
     RowBox[{"experiment", ":", " ", "box"}]}], ",", " ", "cylinder", ",", 
    " ", 
    RowBox[{"annular", " ", "cylinder"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"GeometryExperiment", "[", "#1", "]"}], "=", "#2"}], ")"}], 
      "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistmat", ",", 
       RowBox[{"Table", "[", 
        RowBox[{"\"\<Box\>\"", ",", 
         RowBox[{"Length", "[", "explistmat", "]"}]}], "]"}]}], "}"}]}], 
    "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Transverse", " ", "dimensions", " ", "of", " ", "the", " ", "decay", " ",
      "volume", " ", "assuming", " ", "box", " ", "geometry"}], ",", " ", 
    RowBox[{
    "or", " ", "cylindrical", " ", "geometry", " ", "if", " ", "the", " ", 
     "detector", " ", "plane", " ", "is", " ", "parallel", " ", "to", " ", 
     "the", " ", "beamline", " ", 
     RowBox[{
      RowBox[{"(", "ANUBIS", ")"}], ".", " ", "Otherwise"}], " ", "set", " ", 
     "to", " ", "zero"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MapThread", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"dxDecayVolumeExperiment", "[", 
        RowBox[{"z_", ",", "#1"}], "]"}], "=", "#2"}], ")"}], "&"}], ",", 
    RowBox[{"{", 
     RowBox[{"explistmat", ",", 
      RowBox[{"{", 
       RowBox[{"100", ",", "100"}], "}"}]}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"dyDecayVolumeExperiment", "[", 
         RowBox[{"z_", ",", "#1"}], "]"}], "=", "#2"}], ")"}], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistmat", ",", 
       RowBox[{"{", 
        RowBox[{"25", ",", "25"}], "}"}]}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Decay", " ", "volume", " ", "length", " ", "along", " ", "the", " ", 
    "beamline", " ", "axis"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"dzDecayVolumeExperiment", "[", "#1", "]"}], "=", "#2"}], 
       ")"}], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistmat", ",", 
       RowBox[{"{", 
        RowBox[{"100", ",", "100"}], "}"}]}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Distance", " ", "from", " ", "the", " ", "beamline", " ", "to", " ", 
     "the", " ", "decay", " ", "volume", " ", "center", " ", "and", " ", 
     "detector", " ", "along", " ", "the", " ", "x"}], ",", 
    RowBox[{"y", " ", "axes"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MapThread", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"xToDecayVolumeCenterExperiment", "[", 
        RowBox[{"z_", ",", "#1"}], "]"}], "=", "#2"}], ")"}], "&"}], ",", 
    RowBox[{"{", 
     RowBox[{"explistmat", ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0"}], "}"}]}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"yToDecayVolumeCenterExperiment", "[", 
         RowBox[{"z_", ",", "#1"}], "]"}], "=", "#2"}], ")"}], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistmat", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"60", "+", 
          FractionBox[
           RowBox[{"dyDecayVolumeExperiment", "[", 
            RowBox[{"z", ",", "\"\<MATHUSLA\>\""}], "]"}], "2"]}], ",", 
         RowBox[{"60", "+", 
          FractionBox[
           RowBox[{"dyDecayVolumeExperiment", "[", 
            RowBox[{"z", ",", "\"\<MATHUSLA-FCC\>\""}], "]"}], "2"]}]}], 
        "}"}]}], "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Inner", " ", "and", " ", "outer", " ", "radii", " ", "of", " ", "the", 
    " ", "decay", " ", 
    RowBox[{"volume", ".", " ", "Applicable"}], " ", "if", " ", "the", " ", 
    "decay", " ", "volume", " ", "has", " ", "cylindrical", " ", "geometry"}],
    "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"RinnerDecayVolumeExperiment", "[", 
      RowBox[{"exp", ",", "z_"}], "]"}], "=", "0"}], ",", 
    RowBox[{"{", 
     RowBox[{"exp", ",", "explistmat"}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"RouterDecayVolumeExperiment", "[", 
       RowBox[{"exp", ",", "z_"}], "]"}], "=", "0"}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistmat"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"z", "-", 
    RowBox[{
    "coordinate", " ", "of", " ", "the", " ", "center", " ", "of", " ", "the",
      " ", "decay", " ", "volume"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"zToDecayVolumeCenterExperiment", "[", "exp", "]"}], "=", 
      RowBox[{
       RowBox[{"zToDecayVolumeExperiment", "[", "exp", "]"}], "+", 
       FractionBox[
        RowBox[{"dzDecayVolumeExperiment", "[", "exp", "]"}], "2"]}]}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistmat"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Maximal", " ", 
    RowBox[{"long", ".", " ", "displacement"}], " ", "of", " ", "the", " ", 
    "decay", " ", "volume"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"zMaxDecayVolumeExperiment", "[", "exp", "]"}], "=", 
     RowBox[{
      RowBox[{"zToDecayVolumeExperiment", "[", "exp", "]"}], "+", 
      RowBox[{"dzDecayVolumeExperiment", "[", "exp", "]"}]}]}], ",", 
    RowBox[{"{", 
     RowBox[{"exp", ",", "explistmat"}], "}"}]}], "]"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Whether", " ", "the", " ", "decay", " ", "volume", " ", "serves", " ", 
    "as", " ", "detector", " ", 
    RowBox[{"(", 
     RowBox[{"True", " ", "or", " ", "False"}], ")"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"DecayVolumeAsDetectorExperiment", "[", "exp", "]"}], "=", 
     "\"\<False\>\""}], ",", 
    RowBox[{"{", 
     RowBox[{"exp", ",", "explistmat"}], "}"}]}], "]"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Transverse", " ", "dimensions", " ", "of", " ", "the", " ", "detector", 
    " ", "assuming", " ", "box", " ", "geometry"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MapThread", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"dxDetectorExperiment", "[", 
        RowBox[{"#1", ",", "z_"}], "]"}], "=", "#2"}], ")"}], "&"}], ",", 
    RowBox[{"{", 
     RowBox[{"explistmat", ",", 
      RowBox[{"{", 
       RowBox[{"100", ",", "100"}], "}"}]}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"dyDetectorExperiment", "[", 
         RowBox[{"#1", ",", "z_"}], "]"}], "=", "#2"}], ")"}], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistmat", ",", 
       RowBox[{"{", 
        RowBox[{"4", ",", "4"}], "}"}]}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Length", " ", "of", " ", "the", " ", "detector", " ", "in", " ", "z", " ",
     "plane"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"dzDetectorExperiment", "[", "#1", "]"}], "=", "#2"}], ")"}], 
      "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistmat", ",", 
       RowBox[{"{", 
        RowBox[{"100", ",", "100"}], "}"}]}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Coordinates", " ", "of", " ", "the", " ", "center", " ", "of", " ", "the",
     " ", "detector"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"xToDetectorCenterExperiment", "[", "exp", "]"}], "=", "0"}], 
    ",", 
    RowBox[{"{", 
     RowBox[{"exp", ",", "explistmat"}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"yToDetectorCenterExperiment", "[", "exp", "]"}], "=", 
     RowBox[{
      RowBox[{"yToDecayVolumeCenterExperiment", "[", 
       RowBox[{"z", ",", "exp"}], "]"}], "+", 
      FractionBox[
       RowBox[{"dyDecayVolumeExperiment", "[", 
        RowBox[{"z", ",", "exp"}], "]"}], "2"], "+", 
      FractionBox[
       RowBox[{"dyDetectorExperiment", "[", 
        RowBox[{"exp", ",", "z"}], "]"}], "2"]}]}], ",", 
    RowBox[{"{", 
     RowBox[{"exp", ",", "explistmat"}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"zToDetectorCenterExperiment", "[", "exp", "]"}], "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"DetectorPlaneOrientationExperiment", "[", "exp", "]"}], 
         "\[Equal]", "\"\<Transverse\>\""}], ",", 
        RowBox[{
         RowBox[{"zMaxDecayVolumeExperiment", "[", "exp", "]"}], "+", 
         FractionBox[
          RowBox[{"dzDetectorExperiment", "[", "exp", "]"}], "2"]}], ",", 
        RowBox[{
         RowBox[{"zMaxDecayVolumeExperiment", "[", "exp", "]"}], "-", 
         FractionBox[
          RowBox[{"dzDetectorExperiment", "[", "exp", "]"}], "2"]}]}], 
       "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistmat"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Inner", " ", "and", " ", "outer", " ", "radii", " ", "of", " ", "the", 
    " ", "detector"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"RinnerDetectorExperiment", "[", 
      RowBox[{"exp", ",", "z_"}], "]"}], "=", "0"}], ",", 
    RowBox[{"{", 
     RowBox[{"exp", ",", "explistmat"}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"RouterDetectorExperiment", "[", 
       RowBox[{"exp", ",", "z_"}], "]"}], "=", "0"}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistmat"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Length", " ", "of", " ", "the", " ", "detector", " ", "along", " ", "the",
     " ", "detector", " ", "axis"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"dxLongDetectorExperiment", "[", "exp", "]"}], "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"DetectorPlaneOrientationExperiment", "[", "exp", "]"}], 
         "\[Equal]", "\"\<Transverse\>\""}], ",", 
        RowBox[{"dzDetectorExperiment", "[", "exp", "]"}], ",", 
        RowBox[{"dyDetectorExperiment", "[", 
         RowBox[{"exp", ",", "z"}], "]"}]}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistmat"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "The", " ", "maximal", " ", "coordinate", " ", "of", " ", "the", " ", 
    "end", " ", "of", " ", "the", " ", "detector", " ", "plane", " ", 
    RowBox[{"(", 
     RowBox[{"along", " ", "the", " ", "detector", " ", "axis"}], ")"}], " ", 
    "used", " ", "to", " ", "calculate", " ", "the", " ", "decay", " ", 
    RowBox[{"acceptance", ".", " ", "May"}], " ", "be", " ", "either", " ", 
    "the", " ", "z", " ", "coordinate", " ", "or", " ", "the", " ", "y", " ", 
    "coordinate", " ", 
    RowBox[{"(", 
     RowBox[{
     "if", " ", "the", " ", "final", " ", "detector", " ", "plane", " ", "is",
       " ", "oriented", " ", "parallel", " ", "to", " ", "the", " ", 
      "beamline"}], ")"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"xLongMaxDetectorExperiment", "[", "exp", "]"}], "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"DetectorPlaneOrientationExperiment", "[", "exp", "]"}], 
         "\[Equal]", "\"\<Transverse\>\""}], ",", 
        RowBox[{
         RowBox[{"zMaxDecayVolumeExperiment", "[", "exp", "]"}], "+", 
         RowBox[{"dxLongDetectorExperiment", "[", "exp", "]"}]}], ",", 
        RowBox[{
         RowBox[{"yToDetectorCenterExperiment", "[", "exp", "]"}], "+", 
         RowBox[{
          RowBox[{"dyDetectorExperiment", "[", 
           RowBox[{"exp", ",", "z"}], "]"}], "/", "2"}]}]}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistmat"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Position", " ", "of", " ", "the", " ", "final", " ", "plane", " ", "for", 
    " ", "the", " ", "decay", " ", "products", " ", "along", " ", "the", " ", 
    "detector", " ", "axis"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"xLongDecayProductFinalPlaneExperiment", "[", "exp", "]"}], "=", 
     RowBox[{"xLongMaxDetectorExperiment", "[", "exp", "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"exp", ",", "explistmat"}], "}"}]}], "]"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Whether", " ", "the", " ", "experiment", " ", "has", " ", "dipole", " ", 
    "magnet", " ", "in", " ", "the", " ", "detector", " ", 
    RowBox[{"(", 
     RowBox[{"True", ",", " ", "False"}], ")"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"DipoleMagnetOptionExperiment", "[", "#1", "]"}], "=", "#2"}],
        ")"}], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistmat", ",", 
       RowBox[{"{", 
        RowBox[{"\"\<False\>\"", ",", "\"\<False\>\""}], "}"}]}], "}"}]}], 
    "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Longitudinal", " ", "positions", " ", "of", " ", "the", " ", "dipole", 
    " ", "magnet", " ", "of", " ", "the", " ", "detector"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MapThread", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"zMagnetMinExperiment", "[", "#1", "]"}], "=", "#2"}], ")"}], 
     "&"}], ",", 
    RowBox[{"{", 
     RowBox[{"explistmat", ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0"}], "}"}]}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"zMagnetMaxExperiment", "[", "#1", "]"}], "=", "#2"}], ")"}], 
      "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistmat", ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}]}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Mean", " ", "magnetic", " ", "field", " ", "of", " ", "the", " ", 
    "dipole", " ", "magnet"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"MagneticFieldExperiment", "[", "#1", "]"}], "=", "#2"}], 
       ")"}], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistmat", ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}]}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"ECAL", " ", "option", " ", 
    RowBox[{"(", 
     RowBox[{"True", ",", "False"}], ")"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"ECALoptionExperiment", "[", "exp", "]"}], "=", 
      "\"\<False\>\""}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistmat"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Position", " ", "of", " ", "the", " ", "beginning", " ", "of", " ", "the",
     " ", "ECAL"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"zECALminExperiment", "[", "#1", "]"}], "=", "#2"}], ")"}], 
      "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistmat", ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}]}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "The", " ", "final", " ", "detector", " ", "plane", " ", "needed", " ", 
     "to", " ", "reconstruct", " ", 
     RowBox[{"muons", ".", " ", "Depeding"}], " ", "on", " ", "the", " ", 
     "experiment"}], ",", " ", 
    RowBox[{
    "it", " ", "is", " ", "approximated", " ", "by", " ", "be", " ", "end", 
     " ", "of", " ", "the", " ", "trackers", " ", "or", " ", "the", " ", 
     "muon", " ", "system"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"xLongMuonPlaneExperiment", "[", "#1", "]"}], "=", "#2"}], 
       ")"}], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistmat", ",", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"xLongMaxDetectorExperiment", "[", "exp", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"exp", ",", "explistmat"}], "}"}]}], "]"}]}], "}"}]}], 
    "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "The", " ", "final", " ", "detector", " ", "plane", " ", "needed", " ", 
     "to", " ", "reconstruct", " ", "other", " ", 
     RowBox[{"particles", ".", " ", "Depeding"}], " ", "on", " ", "the", " ", 
     "experiment"}], ",", " ", 
    RowBox[{
    "it", " ", "is", " ", "approximated", " ", "by", " ", "the", " ", "end", 
     " ", "of", " ", "the", " ", "trackers", " ", "or", " ", "the", " ", 
     "calorimeter", " ", "system"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"xLongNonMuonPlaneExperiment", "[", "#1", "]"}], "=", "#2"}], 
       ")"}], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistmat", ",", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"xLongMaxDetectorExperiment", "[", "exp", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"exp", ",", "explistmat"}], "}"}]}], "]"}]}], "}"}]}], 
    "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"List", " ", "of", " ", "detectable", " ", 
     RowBox[{"particles", ".", " ", "If"}], " ", "ECAL", " ", "is", " ", 
     "absent"}], ",", " ", 
    RowBox[{
    "it", " ", "is", " ", "assumed", " ", "by", " ", "default", " ", "that", 
     " ", "photons", " ", "and", " ", 
     SubscriptBox[
      SuperscriptBox["K", "0"], "L"], " ", "cannot", " ", "be", " ", 
     "detected"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MapThread", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"DetectablePDGsExperiment", "[", "#1", "]"}], "=", "#2"}], 
      ")"}], "&"}], ",", 
    RowBox[{"{", 
     RowBox[{"explistmat", ",", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Select", "[", 
         RowBox[{"detectablepdgs", ",", 
          RowBox[{
           RowBox[{
            RowBox[{"MemberQ", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"22.", ",", "130.", ",", "2112.", ",", 
                RowBox[{"-", "2112."}]}], "}"}], ",", "#"}], "]"}], "==", 
            "False"}], "&"}]}], "]"}], ",", 
        RowBox[{"Length", "[", "explistmat", "]"}]}], "]"}]}], "}"}]}], "]"}],
   ";"}]}], "Input",
 CellChangeTimes->{{3.893318248284557*^9, 3.8933182517363014`*^9}, 
   3.8933217541913424`*^9, {3.8933219767473497`*^9, 3.8933219782471905`*^9}, {
   3.893322032365988*^9, 3.8933220332495446`*^9}, {3.8933520965763197`*^9, 
   3.893352140087596*^9}, {3.8934862861558*^9, 3.893486289058525*^9}, {
   3.893518136948369*^9, 3.8935181369563475`*^9}, 3.893519312791155*^9, {
   3.893520125977253*^9, 3.893520169297861*^9}, 3.8935206581734076`*^9, 
   3.8944385904099627`*^9, {3.8971453067114077`*^9, 3.897145319348712*^9}, {
   3.897145473900445*^9, 3.897145486916608*^9}, {3.897147794890201*^9, 
   3.897147806651047*^9}, {3.9041197584004245`*^9, 3.9041197752062683`*^9}, 
   3.905060087571677*^9, 3.910240594789877*^9, {3.91024697363939*^9, 
   3.9102469736469297`*^9}, {3.9102540390982904`*^9, 3.910254051547308*^9}, {
   3.910258857302536*^9, 3.910258862590538*^9}, {3.9104325639099593`*^9, 
   3.9104325768887625`*^9}, {3.9120565289704795`*^9, 3.9120565978574944`*^9}, 
   3.9120573018381577`*^9, {3.912498437205225*^9, 3.912498441178001*^9}},
 CellLabel->
  "In[146]:=",ExpressionUUID->"cabce260-ce06-45a5-960b-4af96240b582"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Cross-sections", "Subsubsection",
 CellChangeTimes->{{3.8933256308713317`*^9, 
  3.8933256323468237`*^9}},ExpressionUUID->"abc2e27a-bdef-4622-904c-\
81f2dfe64121"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"MapThread", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"NPOTexperiment", "[", "#1", "]"}], "=", "#2"}], ")"}], "&"}], 
    ",", 
    RowBox[{"{", 
     RowBox[{"explistmat", ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"LLHChighLumi", "*", 
         RowBox[{"\[Sigma]ppInpbFacility", "[", "\"\<LHC\>\"", "]"}]}], ",", 
        RowBox[{"LFCChh", "*", 
         RowBox[{"\[Sigma]ppInpbFacility", "[", "\"\<FCC-hh\>\"", "]"}]}]}], 
       "}"}]}], "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"AtargetExperiment", "[", "#1", "]"}], "=", "#2"}], ")"}], 
      "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistmat", ",", 
       RowBox[{"Table", "[", 
        RowBox[{"1.", ",", 
         RowBox[{"Length", "[", "explistmat", "]"}]}], "]"}]}], "}"}]}], 
    "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Cascade", " ", "enhancement", " ", "of", " ", "the", " ", "production", 
    " ", "relative", " ", "to", " ", "the", " ", "production", " ", "in", " ",
     "pure", " ", "pp", " ", 
    RowBox[{"collisions", ".", " ", "Relevant"}], " ", "for", " ", "fixed", 
    " ", "target", " ", "experiments"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "For", " ", "all", " ", "experiments", " ", "located", " ", "at", " ", 
     "SPS"}], ",", " ", 
    RowBox[{
     RowBox[{
      RowBox[{
      "the", " ", "cascade", " ", "factors", " ", "is", " ", "taken", " ", 
       "from", " ", 
       RowBox[{"http", ":"}]}], "//", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"cds", ".", "cern", ".", "ch"}], "/", "record"}], "/", 
          "2115534"}], "/", "files"}], "/", "SHiP"}], "-", "NOTE", "-", 
       "2015", "-", 
       RowBox[{"009.", 
        RowBox[{"pdf", "?", "version"}]}]}]}], "=", "1"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"CascadeFactorbb", "[", "#1", "]"}], "=", "#2"}], ")"}], 
      "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistmat", ",", 
       RowBox[{"Table", "[", 
        RowBox[{"1.", ",", 
         RowBox[{"Length", "[", "explistmat", "]"}]}], "]"}]}], "}"}]}], 
    "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Fraction", " ", "of", " ", "produced", " ", "bb", " ", "per", " ", "PoT", 
    " ", "at", " ", "the", " ", "given", " ", "experiment"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"PppTobbExperiment", "[", "exp", "]"}], "=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"\[Sigma]ppTobbInpbFacility", "[", 
        RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}], "/", 
       RowBox[{"\[Sigma]ppInpbFacility", "[", 
        RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}]}], ")"}], 
     SuperscriptBox[
      RowBox[{"AtargetExperiment", "[", "exp", "]"}], "0.29"], "*", 
     RowBox[{"CascadeFactorbb", "[", "exp", "]"}]}]}], ",", 
   RowBox[{"{", 
    RowBox[{"exp", ",", "explistmat"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"CascadeFactorcc", "[", "#1", "]"}], "=", "#2"}], ")"}], 
      "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistmat", ",", 
       RowBox[{"Table", "[", 
        RowBox[{"1.", ",", 
         RowBox[{"Length", "[", "explistmat", "]"}]}], "]"}]}], "}"}]}], 
    "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Fraction", " ", "of", " ", "produced", " ", "cc", " ", "per", " ", "PoT", 
    " ", "at", " ", "the", " ", "given", " ", "experiment"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"PppToccExperiment", "[", "exp", "]"}], "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"\[Sigma]ppToccInpbFacility", "[", 
         RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}], "/", 
        RowBox[{"\[Sigma]ppInpbFacility", "[", 
         RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}]}], ")"}], 
      SuperscriptBox[
       RowBox[{"AtargetExperiment", "[", "exp", "]"}], "0.29"], "*", 
      RowBox[{"CascadeFactorcc", "[", "exp", "]"}]}]}], ",", 
    RowBox[{"{", 
     RowBox[{"exp", ",", "explistmat"}], "}"}]}], "]"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Fraction", " ", "of", " ", "produced", " ", "h", " ", "per", " ", "PoT", 
    " ", "at", " ", "the", " ", "given", " ", "experiment"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"PppTohExperiment", "[", "exp", "]"}], "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"\[Sigma]ppTohInpbFacility", "[", 
          RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}], "/", 
         RowBox[{"\[Sigma]ppInpbFacility", "[", 
          RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}]}], ")"}], 
       SuperscriptBox[
        RowBox[{"AtargetExperiment", "[", "exp", "]"}], "0.29"]}]}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistmat"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Fraction", " ", "of", " ", "produced", " ", "W", " ", "per", " ", "PoT", 
    " ", "at", " ", "the", " ", "given", " ", "experiment"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"PppToWExperiment", "[", "exp", "]"}], "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"\[Sigma]ppToWInpbFacility", "[", 
          RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}], "/", 
         RowBox[{"\[Sigma]ppInpbFacility", "[", 
          RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}]}], ")"}], 
       SuperscriptBox[
        RowBox[{"AtargetExperiment", "[", "exp", "]"}], "0.29"]}]}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistmat"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Fraction", " ", "of", " ", "produced", " ", 
    SuperscriptBox["\[Pi]", "0"], " ", "per", " ", "PoT", " ", "at", " ", 
    "the", " ", "given", " ", "experiment"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"PppTo\[Pi]0exp", "[", "exp", "]"}], "=", 
      RowBox[{"PppTo\[Pi]0Facility", "[", 
       RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistmat"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Fraction", " ", "of", " ", "produced", " ", "\[Eta]", " ", "per", " ", 
    "PoT", " ", "at", " ", "the", " ", "given", " ", "experiment"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"PppTo\[Eta]exp", "[", "exp", "]"}], "=", 
      RowBox[{"PppTo\[Eta]Facility", "[", 
       RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistmat"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Fraction", " ", "of", " ", "produced", " ", 
    RowBox[{"\[Eta]", "'"}], " ", "per", " ", "PoT", " ", "at", " ", "the", 
    " ", "given", " ", "experiment"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"PppTo\[Eta]prexp", "[", "exp", "]"}], "=", 
      RowBox[{"PppTo\[Eta]prFacility", "[", 
       RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistmat"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Fraction", " ", "of", " ", "produced", " ", 
    SuperscriptBox["\[Rho]", "0"], " ", "per", " ", "PoT", " ", "at", " ", 
    "the", " ", "given", " ", "experiment"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"PppTo\[Rho]0exp", "[", "exp", "]"}], "=", 
      RowBox[{"PppTo\[Rho]0Facility", "[", 
       RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistmat"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Fraction", " ", "of", " ", "produced", " ", "\[Omega]", " ", "per", " ", 
    "PoT", " ", "at", " ", "the", " ", "given", " ", "experiment"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"PppTo\[Omega]exp", "[", "exp", "]"}], "=", 
     RowBox[{"PppTo\[Omega]Facility", "[", 
      RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"exp", ",", "explistmat"}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"PppToJpsiexp", "[", "exp", "]"}], "=", 
      RowBox[{
       RowBox[{"PppToJpsiFacility", "[", 
        RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}], 
       SuperscriptBox[
        RowBox[{"AtargetExperiment", "[", "exp", "]"}], "0.29"]}]}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistmat"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Fraction", " ", "of", " ", "produced", " ", "\[CapitalUpsilon]", 
    RowBox[{"(", 
     RowBox[{"1", "s"}], ")"}], " ", "per", " ", "PoT", " ", "at", " ", "the",
     " ", "given", " ", "experiment"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"PppToUpsilonexp", "[", "exp", "]"}], "=", 
      RowBox[{
       RowBox[{"PppToUpsilonFacility", "[", 
        RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}], 
       SuperscriptBox[
        RowBox[{"AtargetExperiment", "[", "exp", "]"}], "0.29"]}]}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistmat"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Fraction", " ", "of", " ", "produced", " ", "\[Phi]", " ", "at", " ", 
    "the", " ", "given", " ", "experiment"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"PppToPhiexp", "[", "exp", "]"}], "=", 
      RowBox[{"PppToPhiFacility", "[", 
       RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistmat"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Overall", " ", "table", " ", "with", " ", "cross"}], "-", 
    RowBox[{"sections", " ", "used", " ", "for", " ", "exporting"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"TableNumbersParticlesExperiment", "[", "exp", "]"}], "=", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "\"\<Facility\>\"", ",", "\"\<Npot\>\"", ",", "\"\<Atarget\>\"", ",", 
         "\"\<PPi0\>\"", ",", "\"\<PEta\>\"", ",", "\"\<PEtapr\>\"", ",", 
         "\"\<PRho0\>\"", ",", "\"\<POmega\>\"", ",", "\"\<Pc\>\"", ",", 
         "\"\<Pb\>\"", ",", "\"\<PW\>\"", ",", "\"\<Ph\>\"", ",", 
         "\"\<PJpsi\>\"", ",", "\"\<PUpsilon\>\"", ",", "\"\<PPhi\>\""}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"FacilityExperiment", "[", "exp", "]"}], ",", 
         RowBox[{"NPOTexperiment", "[", "exp", "]"}], ",", 
         RowBox[{"AtargetExperiment", "[", "exp", "]"}], ",", 
         RowBox[{"PppTo\[Pi]0exp", "[", "exp", "]"}], ",", 
         RowBox[{"PppTo\[Eta]exp", "[", "exp", "]"}], ",", 
         RowBox[{"PppTo\[Eta]prexp", "[", "exp", "]"}], ",", 
         RowBox[{"PppTo\[Rho]0exp", "[", "exp", "]"}], ",", 
         RowBox[{"PppTo\[Omega]exp", "[", "exp", "]"}], ",", 
         RowBox[{"2", 
          RowBox[{"PppToccExperiment", "[", "exp", "]"}]}], ",", 
         RowBox[{"2", 
          RowBox[{"PppTobbExperiment", "[", "exp", "]"}]}], ",", 
         RowBox[{"PppToWExperiment", "[", "exp", "]"}], ",", 
         RowBox[{"PppTohExperiment", "[", "exp", "]"}], ",", 
         RowBox[{"PppToJpsiexp", "[", "exp", "]"}], ",", 
         RowBox[{"PppToUpsilonexp", "[", "exp", "]"}], ",", 
         RowBox[{"PppToPhiexp", "[", "exp", "]"}]}], "}"}]}], "}"}], "//", 
     "N"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"exp", ",", "explistmat"}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.8933426511677184`*^9, 3.8933426512855577`*^9}, {
   3.8933428078042116`*^9, 3.8933428352141027`*^9}, {3.8941781752698765`*^9, 
   3.8941781786550207`*^9}, {3.8941786531087112`*^9, 3.894178656193927*^9}, {
   3.8972356184918485`*^9, 3.897235638734701*^9}, {3.8972861115990906`*^9, 
   3.897286137801549*^9}, 3.899196318737406*^9, 3.899197037134268*^9, {
   3.8991971406664305`*^9, 3.899197140862062*^9}, {3.9041440628623123`*^9, 
   3.904144082739808*^9}},
 CellLabel->
  "In[181]:=",ExpressionUUID->"141a19f4-db44-41b0-bde8-c1e4b3144289"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Conditions for the LLP to decay inside the decay volume and for the products \
to point to the end of the detector\
\>", "Subsubsection",
 CellChangeTimes->{{3.905011297554874*^9, 3.9050113192993593`*^9}, 
   3.91543720830558*^9},ExpressionUUID->"a4033911-ea60-4b19-bd5e-\
ebd01eb737c4"],

Cell[BoxData[
 RowBox[{"Do", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"IfLLPinsideDecVol", "[", 
      RowBox[{"zLLP_", ",", "xLLP_", ",", "yLLP_", ",", "exp"}], "]"}], "=", 
     RowBox[{"IfLLPinsideDecVolSimple", "[", "exp", "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"IfLLPtoDet", "[", 
        RowBox[{
        "x1LLPproj_", ",", "x2LLPproj_", ",", "xLongProj_", ",", "exp"}], 
        "]"}], ",", 
       RowBox[{"IfLLPnotToDet", "[", 
        RowBox[{
        "x1LLPproj_", ",", "x2LLPproj_", ",", "xLongProj_", ",", "exp"}], 
        "]"}]}], "}"}], "=", 
     RowBox[{"IfParticlePointsToDetSimple", "[", "exp", "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"IfLLPdecVolToDet", "[", 
      RowBox[{
      "zLLP_", ",", "xLLP_", ",", "yLLP_", ",", "x1LLPproj_", ",", 
       "x2LLPproj_", ",", "xLongProj_", ",", "exp"}], "]"}], "=", 
     RowBox[{
      RowBox[{"IfLLPinsideDecVol", "[", 
       RowBox[{"zLLP", ",", "xLLP", ",", "yLLP", ",", "exp"}], "]"}], "*", 
      RowBox[{"IfLLPtoDet", "[", 
       RowBox[{"x1LLPproj", ",", "x2LLPproj", ",", "xLongProj", ",", "exp"}], 
       "]"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"IfLLPdecVolNotToDet", "[", 
      RowBox[{
      "zLLP_", ",", "xLLP_", ",", "yLLP_", ",", "x1LLPproj_", ",", 
       "x2LLPproj_", ",", "xLongProj_", ",", "exp"}], "]"}], "=", 
     RowBox[{
      RowBox[{"IfLLPinsideDecVol", "[", 
       RowBox[{"zLLP", ",", "xLLP", ",", "yLLP", ",", "exp"}], "]"}], "*", 
      RowBox[{"IfLLPnotToDet", "[", 
       RowBox[{"x1LLPproj", ",", "x2LLPproj", ",", "xLongProj", ",", "exp"}], 
       "]"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"DecayAcceptanceGeometry", "[", 
      RowBox[{"coord1_", ",", "coord2_", ",", "xLongProj_", ",", "exp"}], 
      "]"}], "=", 
     RowBox[{"IfLLPtoDet", "[", 
      RowBox[{"coord1", ",", "coord2", ",", "xLongProj", ",", "exp"}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", ",", 
   RowBox[{"{", 
    RowBox[{"exp", ",", "explistmat"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.9050142321602736`*^9, 3.9050142339625454`*^9}, {
   3.905014454342767*^9, 3.9050144583777704`*^9}, 3.905017151866778*^9, {
   3.905059366567094*^9, 3.905059366759766*^9}, {3.910258574509381*^9, 
   3.9102586409206505`*^9}, 3.91025881848166*^9, 3.9102599356736903`*^9, {
   3.9154370068887568`*^9, 3.915437091500815*^9}, {3.9154372083260574`*^9, 
   3.915437208402462*^9}},
 CellLabel->
  "In[198]:=",ExpressionUUID->"23b82922-d039-4875-83be-7bd67f514620"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["FACET/FACET-FCC", "Subsection",
 CellChangeTimes->{{3.8933162343969693`*^9, 
  3.8933162381189685`*^9}},ExpressionUUID->"5db7b151-2d9f-4951-8715-\
ad54f9065ca4"],

Cell[CellGroupData[{

Cell["Geometry", "Subsubsection",
 CellChangeTimes->{{3.893342623432827*^9, 
  3.893342624458*^9}},ExpressionUUID->"f89f1cc6-f787-4bd9-8f96-d5ebc9f089a0"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"explistfac", "=", 
    RowBox[{"{", 
     RowBox[{"\"\<FACET\>\"", ",", "\"\<FACET-FCC\>\""}], "}"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Distance", " ", "to", " ", "the", " ", "fiducial", " ", "volume", " ", 
    "along", " ", "the", " ", "beamline", " ", 
    RowBox[{"axis", ".", " ", 
     RowBox[{"MapThread", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"list1", "[", "#", "]"}], "=", "#2"}], ")"}], "&"}], ",", 
       RowBox[{"{", 
        RowBox[{"listexp", ",", "listvals"}], "}"}]}], "]"}]}], " ", 
    "equates", " ", "the", " ", "elements", " ", "list1", " ", "with", " ", 
    "keys", " ", "from", " ", "listexp", " ", "to", " ", "the", " ", 
    "corresponding", " ", "elements", " ", "of", " ", "the", " ", "list", " ",
     "listvals"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"zToDecayVolumeExperiment", "[", "#1", "]"}], "=", "#2"}], 
       ")"}], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistfac", ",", 
       RowBox[{"{", 
        RowBox[{"101", ",", "101"}], "}"}]}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Detector", " ", "has", " ", "the", " ", "axis", " ", "along", " ", 
    "which", " ", "its", " ", "components", " ", "are", " ", 
    RowBox[{"placed", ".", " ", "The"}], " ", "option", " ", "below", " ", 
    "defines", " ", "the", " ", "orientation", " ", "of", " ", "the", " ", 
    "final", " ", "plane", " ", "transverse", " ", "to", " ", "this", " ", 
    "axis", " ", "relative", " ", "to", " ", "the", " ", "beamline"}], "*)"}],
   "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Transverse", " ", "if", " ", "the", " ", "plane", " ", "is", " ", 
     "tranverse", " ", 
     RowBox[{"(", 
      RowBox[{"SHiP", ",", " ", 
       RowBox[{"FACET", " ", "etc"}]}], ")"}]}], ",", " ", 
    RowBox[{
    "and", " ", "Parallel", " ", "if", " ", "it", " ", "is", " ", "parallel", 
     " ", 
     RowBox[{"(", 
      RowBox[{"MATHUSLA", ",", " ", "ANUBIS"}]}]}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"DetectorPlaneOrientationExperiment", "[", "#1", "]"}], "=", 
        "#2"}], ")"}], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistfac", ",", 
       RowBox[{"Table", "[", 
        RowBox[{"\"\<Transverse\>\"", ",", 
         RowBox[{"Length", "[", "explistfac", "]"}]}], "]"}]}], "}"}]}], 
    "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Facility", " ", "hosting", " ", "the", " ", 
     RowBox[{"experiment", ":", " ", "SPS"}]}], ",", " ", "Fermilab", ",", 
    " ", "LHC", ",", " ", 
    RowBox[{"FCC", "-", "hh"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"FacilityExperiment", "[", "#1", "]"}], "=", "#2"}], ")"}], 
      "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistfac", ",", 
       RowBox[{"{", 
        RowBox[{"\"\<LHC\>\"", ",", "\"\<FCC-hh\>\""}], "}"}]}], "}"}]}], 
    "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Geometry", " ", "of", " ", "the", " ", 
     RowBox[{"experiment", ":", " ", "box"}]}], ",", " ", "cylinder", ",", 
    " ", 
    RowBox[{"annular", " ", "cylinder"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"GeometryExperiment", "[", "#1", "]"}], "=", "#2"}], ")"}], 
      "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistfac", ",", 
       RowBox[{"Table", "[", 
        RowBox[{"\"\<Annular cylinder\>\"", ",", 
         RowBox[{"Length", "[", "explistfac", "]"}]}], "]"}]}], "}"}]}], 
    "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Transverse", " ", "dimensions", " ", "of", " ", "the", " ", "decay", " ",
      "volume", " ", "assuming", " ", "box", " ", "geometry"}], ",", " ", 
    RowBox[{
    "or", " ", "cylindrical", " ", "geometry", " ", "if", " ", "the", " ", 
     "detector", " ", "plane", " ", "is", " ", "parallel", " ", "to", " ", 
     "the", " ", "beamline", " ", 
     RowBox[{
      RowBox[{"(", "ANUBIS", ")"}], ".", " ", "Otherwise"}], " ", "set", " ", 
     "to", " ", "zero"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MapThread", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"dxDecayVolumeExperiment", "[", 
        RowBox[{"z_", ",", "#1"}], "]"}], "=", "#2"}], ")"}], "&"}], ",", 
    RowBox[{"{", 
     RowBox[{"explistfac", ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0"}], "}"}]}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"dyDecayVolumeExperiment", "[", 
         RowBox[{"z_", ",", "#1"}], "]"}], "=", "#2"}], ")"}], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistfac", ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}]}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Decay", " ", "volume", " ", "length", " ", "along", " ", "the", " ", 
    "beamline", " ", "axis"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"dzDecayVolumeExperiment", "[", "#1", "]"}], "=", "#2"}], 
       ")"}], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistfac", ",", 
       RowBox[{"{", 
        RowBox[{"18", ",", "18"}], "}"}]}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Distance", " ", "from", " ", "the", " ", "beamline", " ", "to", " ", 
     "the", " ", "decay", " ", "volume", " ", "center", " ", "and", " ", 
     "detector", " ", "along", " ", "the", " ", "x"}], ",", 
    RowBox[{"y", " ", "axes"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MapThread", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"xToDecayVolumeCenterExperiment", "[", 
        RowBox[{"z_", ",", "#1"}], "]"}], "=", "#2"}], ")"}], "&"}], ",", 
    RowBox[{"{", 
     RowBox[{"explistfac", ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0"}], "}"}]}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"yToDecayVolumeCenterExperiment", "[", 
         RowBox[{"z_", ",", "#1"}], "]"}], "=", "#2"}], ")"}], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistfac", ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}]}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Inner", " ", "and", " ", "outer", " ", "radii", " ", "of", " ", "the", 
    " ", "decay", " ", 
    RowBox[{"volume", ".", " ", "Applicable"}], " ", "if", " ", "the", " ", 
    "decay", " ", "volume", " ", "has", " ", "cylindrical", " ", "geometry"}],
    "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MapThread", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"RinnerDecayVolumeExperiment", "[", 
        RowBox[{"#1", ",", "z_"}], "]"}], "=", "#2"}], ")"}], "&"}], ",", 
    RowBox[{"{", 
     RowBox[{"explistfac", ",", 
      RowBox[{"{", 
       RowBox[{"0.18", ",", "0.2"}], "}"}]}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"RouterDecayVolumeExperiment", "[", 
         RowBox[{"#1", ",", "z_"}], "]"}], "=", "#2"}], ")"}], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistfac", ",", 
       RowBox[{"{", 
        RowBox[{"0.5", ",", "1."}], "}"}]}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"z", "-", 
    RowBox[{
    "coordinate", " ", "of", " ", "the", " ", "center", " ", "of", " ", "the",
      " ", "decay", " ", "volume"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"zToDecayVolumeCenterExperiment", "[", "exp", "]"}], "=", 
      RowBox[{
       RowBox[{"zToDecayVolumeExperiment", "[", "exp", "]"}], "+", 
       FractionBox[
        RowBox[{"dzDecayVolumeExperiment", "[", "exp", "]"}], "2"]}]}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistfac"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Maximal", " ", 
    RowBox[{"long", ".", " ", "displacement"}], " ", "of", " ", "the", " ", 
    "decay", " ", "volume"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"zMaxDecayVolumeExperiment", "[", "exp", "]"}], "=", 
     RowBox[{
      RowBox[{"zToDecayVolumeExperiment", "[", "exp", "]"}], "+", 
      RowBox[{"dzDecayVolumeExperiment", "[", "exp", "]"}]}]}], ",", 
    RowBox[{"{", 
     RowBox[{"exp", ",", "explistfac"}], "}"}]}], "]"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Whether", " ", "the", " ", "decay", " ", "volume", " ", "serves", " ", 
    "as", " ", "detector", " ", 
    RowBox[{"(", 
     RowBox[{"True", " ", "or", " ", "False"}], ")"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"DecayVolumeAsDetectorExperiment", "[", "exp", "]"}], "=", 
     "\"\<False\>\""}], ",", 
    RowBox[{"{", 
     RowBox[{"exp", ",", "explistfac"}], "}"}]}], "]"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Transverse", " ", "dimensions", " ", "of", " ", "the", " ", "detector", 
    " ", "assuming", " ", "box", " ", "geometry"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MapThread", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"dxDetectorExperiment", "[", 
        RowBox[{"#1", ",", "z_"}], "]"}], "=", "#2"}], ")"}], "&"}], ",", 
    RowBox[{"{", 
     RowBox[{"explistfac", ",", 
      RowBox[{"{", 
       RowBox[{"0.5", ",", "1"}], "}"}]}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"dyDetectorExperiment", "[", 
         RowBox[{"#1", ",", "z_"}], "]"}], "=", "#2"}], ")"}], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistfac", ",", 
       RowBox[{"{", 
        RowBox[{"0.5", ",", "1"}], "}"}]}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Length", " ", "of", " ", "the", " ", "detector", " ", "in", " ", "z", " ",
     "plane"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"dzDetectorExperiment", "[", "#1", "]"}], "=", "#2"}], ")"}], 
      "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistfac", ",", 
       RowBox[{"{", 
        RowBox[{"9", ",", "9"}], "}"}]}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Coordinates", " ", "of", " ", "the", " ", "center", " ", "of", " ", "the",
     " ", "detector"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"xToDetectorCenterExperiment", "[", "exp", "]"}], "=", "0"}], 
    ",", 
    RowBox[{"{", 
     RowBox[{"exp", ",", "explistfac"}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"yToDetectorCenterExperiment", "[", "exp", "]"}], "=", "0"}], 
    ",", 
    RowBox[{"{", 
     RowBox[{"exp", ",", "explistfac"}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"zToDetectorCenterExperiment", "[", "exp", "]"}], "=", 
      RowBox[{
       RowBox[{"zMaxDecayVolumeExperiment", "[", "exp", "]"}], "+", 
       FractionBox[
        RowBox[{"dzDetectorExperiment", "[", "exp", "]"}], "2"]}]}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistfac"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Inner", " ", "and", " ", "outer", " ", "radii", " ", "of", " ", "the", 
    " ", "detector"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MapThread", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"RinnerDetectorExperiment", "[", 
        RowBox[{"#1", ",", "z_"}], "]"}], "=", "#2"}], ")"}], "&"}], ",", 
    RowBox[{"{", 
     RowBox[{"explistfac", ",", 
      RowBox[{"{", 
       RowBox[{"0.18", ",", "0.2"}], "}"}]}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"RouterDetectorExperiment", "[", 
         RowBox[{"#1", ",", "z_"}], "]"}], "=", "#2"}], ")"}], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistfac", ",", 
       RowBox[{"{", 
        RowBox[{"0.5", ",", "1."}], "}"}]}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Length", " ", "of", " ", "the", " ", "detector", " ", "along", " ", "the",
     " ", "detector", " ", "axis"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"dxLongDetectorExperiment", "[", "exp", "]"}], "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"DetectorPlaneOrientationExperiment", "[", "exp", "]"}], 
         "\[Equal]", "\"\<Transverse\>\""}], ",", 
        RowBox[{"dzDetectorExperiment", "[", "exp", "]"}], ",", 
        RowBox[{"dyDetectorExperiment", "[", "exp", "]"}]}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistfac"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "The", " ", "maximal", " ", "coordinate", " ", "of", " ", "the", " ", 
    "end", " ", "of", " ", "the", " ", "detector", " ", "plane", " ", 
    RowBox[{"(", 
     RowBox[{"along", " ", "the", " ", "detector", " ", "axis"}], ")"}], " ", 
    "used", " ", "to", " ", "calculate", " ", "the", " ", "decay", " ", 
    RowBox[{"acceptance", ".", " ", "May"}], " ", "be", " ", "either", " ", 
    "the", " ", "z", " ", "coordinate", " ", "or", " ", "the", " ", "y", " ", 
    "coordinate", " ", 
    RowBox[{"(", 
     RowBox[{
     "if", " ", "the", " ", "final", " ", "detector", " ", "plane", " ", "is",
       " ", "oriented", " ", "parallel", " ", "to", " ", "the", " ", 
      "beamline"}], ")"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"xLongMaxDetectorExperiment", "[", "exp", "]"}], "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"DetectorPlaneOrientationExperiment", "[", "exp", "]"}], 
         "\[Equal]", "\"\<Transverse\>\""}], ",", 
        RowBox[{
         RowBox[{"zMaxDecayVolumeExperiment", "[", "exp", "]"}], "+", 
         RowBox[{"dxLongDetectorExperiment", "[", "exp", "]"}]}], ",", 
        RowBox[{
         RowBox[{"yToDetectorCenterExperiment", "[", "exp", "]"}], "+", 
         RowBox[{
          RowBox[{"dyDetectorExperiment", "[", "exp", "]"}], "/", "2"}]}]}], 
       "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistfac"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Position", " ", "of", " ", "the", " ", "final", " ", "plane", " ", "for", 
    " ", "the", " ", "decay", " ", "products", " ", "along", " ", "the", " ", 
    "detector", " ", "axis"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"xLongDecayProductFinalPlaneExperiment", "[", "exp", "]"}], "=", 
     RowBox[{"xLongMaxDetectorExperiment", "[", "exp", "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"exp", ",", "explistfac"}], "}"}]}], "]"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Whether", " ", "the", " ", "experiment", " ", "has", " ", "dipole", " ", 
    "magnet", " ", "in", " ", "the", " ", "detector", " ", 
    RowBox[{"(", 
     RowBox[{"True", ",", " ", "False"}], ")"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"DipoleMagnetOptionExperiment", "[", "#1", "]"}], "=", "#2"}],
        ")"}], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistfac", ",", 
       RowBox[{"{", 
        RowBox[{"\"\<False\>\"", ",", "\"\<False\>\""}], "}"}]}], "}"}]}], 
    "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Longitudinal", " ", "positions", " ", "of", " ", "the", " ", "dipole", 
    " ", "magnet", " ", "of", " ", "the", " ", "detector"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MapThread", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"zMagnetMinExperiment", "[", "#1", "]"}], "=", "#2"}], ")"}], 
     "&"}], ",", 
    RowBox[{"{", 
     RowBox[{"explistfac", ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0"}], "}"}]}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"zMagnetMaxExperiment", "[", "#1", "]"}], "=", "#2"}], ")"}], 
      "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistfac", ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}]}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Mean", " ", "magnetic", " ", "field", " ", "of", " ", "the", " ", 
    "dipole", " ", "magnet"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"MagneticFieldExperiment", "[", "#1", "]"}], "=", "#2"}], 
       ")"}], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistfac", ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}]}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"ECAL", " ", "option", " ", 
    RowBox[{"(", 
     RowBox[{"True", ",", "False"}], ")"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"ECALoptionExperiment", "[", "exp", "]"}], "=", 
      "\"\<True\>\""}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistfac"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Position", " ", "of", " ", "the", " ", "beginning", " ", "of", " ", "the",
     " ", "ECAL"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"zECALminExperiment", "[", "#1", "]"}], "=", "#2"}], ")"}], 
      "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistfac", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"zMaxDecayVolumeExperiment", "[", "\"\<FACET\>\"", "]"}], 
          "+", "3"}], ",", 
         RowBox[{
          RowBox[{
          "zMaxDecayVolumeExperiment", "[", "\"\<FACET-FCC\>\"", "]"}], "+", 
          "3"}]}], "}"}]}], "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "The", " ", "final", " ", "detector", " ", "plane", " ", "needed", " ", 
     "to", " ", "reconstruct", " ", 
     RowBox[{"muons", ".", " ", "Depeding"}], " ", "on", " ", "the", " ", 
     "experiment"}], ",", " ", 
    RowBox[{
    "it", " ", "is", " ", "approximated", " ", "by", " ", "be", " ", "end", 
     " ", "of", " ", "the", " ", "trackers", " ", "or", " ", "the", " ", 
     "muon", " ", "system"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"xLongMuonPlaneExperiment", "[", "#1", "]"}], "=", "#2"}], 
       ")"}], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistfac", ",", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"xLongMaxDetectorExperiment", "[", "exp", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"exp", ",", "explistfac"}], "}"}]}], "]"}]}], "}"}]}], 
    "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "The", " ", "final", " ", "detector", " ", "plane", " ", "needed", " ", 
     "to", " ", "reconstruct", " ", "other", " ", 
     RowBox[{"particles", ".", " ", "Depeding"}], " ", "on", " ", "the", " ", 
     "experiment"}], ",", " ", 
    RowBox[{
    "it", " ", "is", " ", "approximated", " ", "by", " ", "the", " ", "end", 
     " ", "of", " ", "the", " ", "trackers", " ", "or", " ", "the", " ", 
     "calorimeter", " ", "system"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"xLongNonMuonPlaneExperiment", "[", "#1", "]"}], "=", "#2"}], 
       ")"}], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistfac", ",", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"xLongMaxDetectorExperiment", "[", "exp", "]"}], "-", "3"}],
          ",", 
         RowBox[{"{", 
          RowBox[{"exp", ",", "explistfac"}], "}"}]}], "]"}]}], "}"}]}], 
    "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"List", " ", "of", " ", "detectable", " ", 
     RowBox[{"particles", ".", " ", "If"}], " ", "ECAL", " ", "is", " ", 
     "absent"}], ",", " ", 
    RowBox[{
    "it", " ", "is", " ", "assumed", " ", "by", " ", "default", " ", "that", 
     " ", "photons", " ", "and", " ", 
     SubscriptBox[
      SuperscriptBox["K", "0"], "L"], " ", "cannot", " ", "be", " ", 
     "detected"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MapThread", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"DetectablePDGsExperiment", "[", "#1", "]"}], "=", "#2"}], 
      ")"}], "&"}], ",", 
    RowBox[{"{", 
     RowBox[{"explistfac", ",", 
      RowBox[{"Table", "[", 
       RowBox[{"detectablepdgs", ",", 
        RowBox[{"Length", "[", "explistfac", "]"}]}], "]"}]}], "}"}]}], "]"}],
   ";"}]}], "Input",
 CellChangeTimes->{{3.893318068124275*^9, 3.8933180796892796`*^9}, 
   3.8933188011575403`*^9, {3.893318843172867*^9, 3.89331887825416*^9}, {
   3.893319167292712*^9, 3.8933191885036945`*^9}, 3.893322113862881*^9, {
   3.8934862861621876`*^9, 3.8934862890661306`*^9}, {3.8935181369638343`*^9, 
   3.893518136969819*^9}, 3.893519312796653*^9, {3.8935201259852066`*^9, 
   3.8935201693018475`*^9}, 3.8935206581774025`*^9, 3.8944385904358416`*^9, {
   3.8971453067330513`*^9, 3.8971453193552055`*^9}, {3.8971454739113865`*^9, 
   3.8971454869215946`*^9}, {3.905060093662445*^9, 3.905060093907116*^9}, 
   3.9102405948008127`*^9, {3.910246973649716*^9, 3.9102469736552577`*^9}, {
   3.9102540611483736`*^9, 3.910254072662183*^9}, {3.9102541587746887`*^9, 
   3.910254166059775*^9}, {3.910258871095523*^9, 3.9102588854745655`*^9}, {
   3.912056605324023*^9, 3.912056620389015*^9}, 3.912057297918071*^9},
 CellLabel->
  "In[199]:=",ExpressionUUID->"decc17ca-cd1f-4b47-bc0b-0f716fe4bdb8"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Cross-sections", "Subsubsection",
 CellChangeTimes->{{3.8933256308713317`*^9, 
  3.8933256323468237`*^9}},ExpressionUUID->"a37bb646-ea59-4fd5-b13e-\
320dab3f9173"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"MapThread", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"NPOTexperiment", "[", "#1", "]"}], "=", "#2"}], ")"}], "&"}], 
    ",", 
    RowBox[{"{", 
     RowBox[{"explistfac", ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"LLHChighLumi", "*", 
         RowBox[{"\[Sigma]ppInpbFacility", "[", "\"\<LHC\>\"", "]"}]}], ",", 
        RowBox[{"LFCChh", "*", 
         RowBox[{"\[Sigma]ppInpbFacility", "[", "\"\<FCC-hh\>\"", "]"}]}]}], 
       "}"}]}], "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"AtargetExperiment", "[", "#1", "]"}], "=", "#2"}], ")"}], 
      "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistfac", ",", 
       RowBox[{"Table", "[", 
        RowBox[{"1.", ",", 
         RowBox[{"Length", "[", "explistfac", "]"}]}], "]"}]}], "}"}]}], 
    "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Cascade", " ", "enhancement", " ", "of", " ", "the", " ", "production", 
    " ", "relative", " ", "to", " ", "the", " ", "production", " ", "in", " ",
     "pure", " ", "pp", " ", 
    RowBox[{"collisions", ".", " ", "Relevant"}], " ", "for", " ", "fixed", 
    " ", "target", " ", "experiments"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "For", " ", "all", " ", "experiments", " ", "located", " ", "at", " ", 
     "SPS"}], ",", " ", 
    RowBox[{
     RowBox[{
      RowBox[{
      "the", " ", "cascade", " ", "factors", " ", "is", " ", "taken", " ", 
       "from", " ", 
       RowBox[{"http", ":"}]}], "//", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"cds", ".", "cern", ".", "ch"}], "/", "record"}], "/", 
          "2115534"}], "/", "files"}], "/", "SHiP"}], "-", "NOTE", "-", 
       "2015", "-", 
       RowBox[{"009.", 
        RowBox[{"pdf", "?", "version"}]}]}]}], "=", "1"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"CascadeFactorbb", "[", "#1", "]"}], "=", "#2"}], ")"}], 
      "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistfac", ",", 
       RowBox[{"Table", "[", 
        RowBox[{"1.", ",", 
         RowBox[{"Length", "[", "explistfac", "]"}]}], "]"}]}], "}"}]}], 
    "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Fraction", " ", "of", " ", "produced", " ", "bb", " ", "per", " ", "PoT", 
    " ", "at", " ", "the", " ", "given", " ", "experiment"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"PppTobbExperiment", "[", "exp", "]"}], "=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"\[Sigma]ppTobbInpbFacility", "[", 
        RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}], "/", 
       RowBox[{"\[Sigma]ppInpbFacility", "[", 
        RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}]}], ")"}], 
     SuperscriptBox[
      RowBox[{"AtargetExperiment", "[", "exp", "]"}], "0.29"], "*", 
     RowBox[{"CascadeFactorbb", "[", "exp", "]"}]}]}], ",", 
   RowBox[{"{", 
    RowBox[{"exp", ",", "explistfac"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"CascadeFactorcc", "[", "#1", "]"}], "=", "#2"}], ")"}], 
      "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistfac", ",", 
       RowBox[{"Table", "[", 
        RowBox[{"1.", ",", 
         RowBox[{"Length", "[", "explistfac", "]"}]}], "]"}]}], "}"}]}], 
    "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Fraction", " ", "of", " ", "produced", " ", "cc", " ", "per", " ", "PoT", 
    " ", "at", " ", "the", " ", "given", " ", "experiment"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"PppToccExperiment", "[", "exp", "]"}], "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"\[Sigma]ppToccInpbFacility", "[", 
         RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}], "/", 
        RowBox[{"\[Sigma]ppInpbFacility", "[", 
         RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}]}], ")"}], 
      SuperscriptBox[
       RowBox[{"AtargetExperiment", "[", "exp", "]"}], "0.29"], "*", 
      RowBox[{"CascadeFactorcc", "[", "exp", "]"}]}]}], ",", 
    RowBox[{"{", 
     RowBox[{"exp", ",", "explistfac"}], "}"}]}], "]"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Fraction", " ", "of", " ", "produced", " ", "h", " ", "per", " ", "PoT", 
    " ", "at", " ", "the", " ", "given", " ", "experiment"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"PppTohExperiment", "[", "exp", "]"}], "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"\[Sigma]ppTohInpbFacility", "[", 
          RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}], "/", 
         RowBox[{"\[Sigma]ppInpbFacility", "[", 
          RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}]}], ")"}], 
       SuperscriptBox[
        RowBox[{"AtargetExperiment", "[", "exp", "]"}], "0.29"]}]}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistfac"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Fraction", " ", "of", " ", "produced", " ", "W", " ", "per", " ", "PoT", 
    " ", "at", " ", "the", " ", "given", " ", "experiment"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"PppToWExperiment", "[", "exp", "]"}], "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"\[Sigma]ppToWInpbFacility", "[", 
          RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}], "/", 
         RowBox[{"\[Sigma]ppInpbFacility", "[", 
          RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}]}], ")"}], 
       SuperscriptBox[
        RowBox[{"AtargetExperiment", "[", "exp", "]"}], "0.29"]}]}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistfac"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Fraction", " ", "of", " ", "produced", " ", 
    SuperscriptBox["\[Pi]", "0"], " ", "per", " ", "PoT", " ", "at", " ", 
    "the", " ", "given", " ", "experiment"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"PppTo\[Pi]0exp", "[", "exp", "]"}], "=", 
      RowBox[{"PppTo\[Pi]0Facility", "[", 
       RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistfac"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Fraction", " ", "of", " ", "produced", " ", "\[Eta]", " ", "per", " ", 
    "PoT", " ", "at", " ", "the", " ", "given", " ", "experiment"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"PppTo\[Eta]exp", "[", "exp", "]"}], "=", 
      RowBox[{"PppTo\[Eta]Facility", "[", 
       RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistfac"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Fraction", " ", "of", " ", "produced", " ", 
    RowBox[{"\[Eta]", "'"}], " ", "per", " ", "PoT", " ", "at", " ", "the", 
    " ", "given", " ", "experiment"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"PppTo\[Eta]prexp", "[", "exp", "]"}], "=", 
      RowBox[{"PppTo\[Eta]prFacility", "[", 
       RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistfac"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Fraction", " ", "of", " ", "produced", " ", 
    SuperscriptBox["\[Rho]", "0"], " ", "per", " ", "PoT", " ", "at", " ", 
    "the", " ", "given", " ", "experiment"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"PppTo\[Rho]0exp", "[", "exp", "]"}], "=", 
      RowBox[{"PppTo\[Rho]0Facility", "[", 
       RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistfac"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Fraction", " ", "of", " ", "produced", " ", "\[Omega]", " ", "per", " ", 
    "PoT", " ", "at", " ", "the", " ", "given", " ", "experiment"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"PppTo\[Omega]exp", "[", "exp", "]"}], "=", 
     RowBox[{"PppTo\[Omega]Facility", "[", 
      RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"exp", ",", "explistfac"}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"PppToJpsiexp", "[", "exp", "]"}], "=", 
      RowBox[{
       RowBox[{"PppToJpsiFacility", "[", 
        RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}], 
       SuperscriptBox[
        RowBox[{"AtargetExperiment", "[", "exp", "]"}], "0.29"]}]}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistfac"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Fraction", " ", "of", " ", "produced", " ", "\[CapitalUpsilon]", 
    RowBox[{"(", 
     RowBox[{"1", "s"}], ")"}], " ", "per", " ", "PoT", " ", "at", " ", "the",
     " ", "given", " ", "experiment"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"PppToUpsilonexp", "[", "exp", "]"}], "=", 
      RowBox[{
       RowBox[{"PppToUpsilonFacility", "[", 
        RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}], 
       SuperscriptBox[
        RowBox[{"AtargetExperiment", "[", "exp", "]"}], "0.29"]}]}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistfac"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Fraction", " ", "of", " ", "produced", " ", "\[Phi]", " ", "at", " ", 
    "the", " ", "given", " ", "experiment"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"PppToPhiexp", "[", "exp", "]"}], "=", 
      RowBox[{"PppToPhiFacility", "[", 
       RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistfac"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Overall", " ", "table", " ", "with", " ", "cross"}], "-", 
    RowBox[{"sections", " ", "used", " ", "for", " ", "exporting"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"TableNumbersParticlesExperiment", "[", "exp", "]"}], "=", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "\"\<Facility\>\"", ",", "\"\<Npot\>\"", ",", "\"\<Atarget\>\"", ",", 
         "\"\<PPi0\>\"", ",", "\"\<PEta\>\"", ",", "\"\<PEtapr\>\"", ",", 
         "\"\<PRho0\>\"", ",", "\"\<POmega\>\"", ",", "\"\<Pc\>\"", ",", 
         "\"\<Pb\>\"", ",", "\"\<PW\>\"", ",", "\"\<Ph\>\"", ",", 
         "\"\<PJpsi\>\"", ",", "\"\<PUpsilon\>\"", ",", "\"\<PPhi\>\""}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"FacilityExperiment", "[", "exp", "]"}], ",", 
         RowBox[{"NPOTexperiment", "[", "exp", "]"}], ",", 
         RowBox[{"AtargetExperiment", "[", "exp", "]"}], ",", 
         RowBox[{"PppTo\[Pi]0exp", "[", "exp", "]"}], ",", 
         RowBox[{"PppTo\[Eta]exp", "[", "exp", "]"}], ",", 
         RowBox[{"PppTo\[Eta]prexp", "[", "exp", "]"}], ",", 
         RowBox[{"PppTo\[Rho]0exp", "[", "exp", "]"}], ",", 
         RowBox[{"PppTo\[Omega]exp", "[", "exp", "]"}], ",", 
         RowBox[{"2", 
          RowBox[{"PppToccExperiment", "[", "exp", "]"}]}], ",", 
         RowBox[{"2", 
          RowBox[{"PppTobbExperiment", "[", "exp", "]"}]}], ",", 
         RowBox[{"PppToWExperiment", "[", "exp", "]"}], ",", 
         RowBox[{"PppTohExperiment", "[", "exp", "]"}], ",", 
         RowBox[{"PppToJpsiexp", "[", "exp", "]"}], ",", 
         RowBox[{"PppToUpsilonexp", "[", "exp", "]"}], ",", 
         RowBox[{"PppToPhiexp", "[", "exp", "]"}]}], "}"}]}], "}"}], "//", 
     "N"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"exp", ",", "explistfac"}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.8933428078108*^9, 3.8933428352170973`*^9}, {
   3.8941781839578485`*^9, 3.894178186538019*^9}, {3.894178660014554*^9, 
   3.8941786626762495`*^9}, {3.897235646826583*^9, 3.8972356637963676`*^9}, {
   3.8972861452148695`*^9, 3.8972861500338*^9}, 3.8991963329225388`*^9, {
   3.899197043301787*^9, 3.899197043551299*^9}, {3.899197140869049*^9, 
   3.899197141065728*^9}, {3.904144112299711*^9, 3.9041441245899715`*^9}},
 CellLabel->
  "In[234]:=",ExpressionUUID->"b61c25dd-a17f-4945-ae29-a970170e5569"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Conditions for the LLP to decay inside the decay volume and for the products \
to point to the end of the detector\
\>", "Subsubsection",
 CellChangeTimes->{{3.905011297554874*^9, 3.9050113192993593`*^9}, 
   3.9154372084107585`*^9},ExpressionUUID->"b6f59320-6356-4501-b85a-\
98f5b68ac8c3"],

Cell[BoxData[
 RowBox[{"Do", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"IfLLPinsideDecVol", "[", 
      RowBox[{"zLLP_", ",", "xLLP_", ",", "yLLP_", ",", "exp"}], "]"}], "=", 
     RowBox[{"IfLLPinsideDecVolSimple", "[", "exp", "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"IfLLPtoDet", "[", 
        RowBox[{
        "x1LLPproj_", ",", "x2LLPproj_", ",", "xLongProj_", ",", "exp"}], 
        "]"}], ",", 
       RowBox[{"IfLLPnotToDet", "[", 
        RowBox[{
        "x1LLPproj_", ",", "x2LLPproj_", ",", "xLongProj_", ",", "exp"}], 
        "]"}]}], "}"}], "=", 
     RowBox[{"IfParticlePointsToDetSimple", "[", "exp", "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"IfLLPdecVolToDet", "[", 
      RowBox[{
      "zLLP_", ",", "xLLP_", ",", "yLLP_", ",", "x1LLPproj_", ",", 
       "x2LLPproj_", ",", "xLongProj_", ",", "exp"}], "]"}], "=", 
     RowBox[{
      RowBox[{"IfLLPinsideDecVol", "[", 
       RowBox[{"zLLP", ",", "xLLP", ",", "yLLP", ",", "exp"}], "]"}], "*", 
      RowBox[{"IfLLPtoDet", "[", 
       RowBox[{"x1LLPproj", ",", "x2LLPproj", ",", "xLongProj", ",", "exp"}], 
       "]"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"IfLLPdecVolNotToDet", "[", 
      RowBox[{
      "zLLP_", ",", "xLLP_", ",", "yLLP_", ",", "x1LLPproj_", ",", 
       "x2LLPproj_", ",", "xLongProj_", ",", "exp"}], "]"}], "=", 
     RowBox[{
      RowBox[{"IfLLPinsideDecVol", "[", 
       RowBox[{"zLLP", ",", "xLLP", ",", "yLLP", ",", "exp"}], "]"}], "*", 
      RowBox[{"IfLLPnotToDet", "[", 
       RowBox[{"x1LLPproj", ",", "x2LLPproj", ",", "xLongProj", ",", "exp"}], 
       "]"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"DecayAcceptanceGeometry", "[", 
      RowBox[{"coord1_", ",", "coord2_", ",", "xLongProj_", ",", "exp"}], 
      "]"}], "=", 
     RowBox[{"IfLLPtoDet", "[", 
      RowBox[{"coord1", ",", "coord2", ",", "xLongProj", ",", "exp"}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", ",", 
   RowBox[{"{", 
    RowBox[{"exp", ",", "explistfac"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.9050144994092674`*^9, 3.905014500064849*^9}, 
   3.9050171518748283`*^9, {3.9050593732267094`*^9, 3.905059373439853*^9}, {
   3.910258574509381*^9, 3.9102586409246397`*^9}, 3.9102588184877524`*^9, {
   3.910258894689402*^9, 3.910258895720602*^9}, 3.9102599356776266`*^9, {
   3.915437006913097*^9, 3.915437091504676*^9}, {3.9154372084305983`*^9, 
   3.9154372085054255`*^9}},
 CellLabel->
  "In[251]:=",ExpressionUUID->"a4fad628-b458-40ae-815b-ce1aa95e6d29"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["FASER/FASER2/FASER2-FPF", "Subsection",
 CellChangeTimes->{{3.893316241994761*^9, 3.893316243925145*^9}, {
  3.903967773998727*^9, 
  3.9039677766441917`*^9}},ExpressionUUID->"d1e70b39-7ff7-4667-9ce0-\
5331cbd2de8e"],

Cell[CellGroupData[{

Cell["Geometry", "Subsubsection",
 CellChangeTimes->{{3.893342623432827*^9, 
  3.893342624458*^9}},ExpressionUUID->"4ece8972-6468-4588-b44b-cfe998a9a3da"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"explistfas", "=", 
    RowBox[{"{", 
     RowBox[{
     "\"\<FASER\>\"", ",", "\"\<FASER2\>\"", ",", "\"\<FASER2-FPF\>\""}], 
     "}"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Distance", " ", "to", " ", "the", " ", "fiducial", " ", "volume", " ", 
    "along", " ", "the", " ", "beamline", " ", 
    RowBox[{"axis", ".", " ", 
     RowBox[{"MapThread", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"list1", "[", "#", "]"}], "=", "#2"}], ")"}], "&"}], ",", 
       RowBox[{"{", 
        RowBox[{"listexp", ",", "listvals"}], "}"}]}], "]"}]}], " ", 
    "equates", " ", "the", " ", "elements", " ", "list1", " ", "with", " ", 
    "keys", " ", "from", " ", "listexp", " ", "to", " ", "the", " ", 
    "corresponding", " ", "elements", " ", "of", " ", "the", " ", "list", " ",
     "listvals"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"zToDecayVolumeExperiment", "[", "#1", "]"}], "=", "#2"}], 
       ")"}], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistfas", ",", 
       RowBox[{"{", 
        RowBox[{"480", ",", "480", ",", "620"}], "}"}]}], "}"}]}], "]"}], 
   ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Detector", " ", "has", " ", "the", " ", "axis", " ", "along", " ", 
    "which", " ", "its", " ", "components", " ", "are", " ", 
    RowBox[{"placed", ".", " ", "The"}], " ", "option", " ", "below", " ", 
    "defines", " ", "the", " ", "orientation", " ", "of", " ", "the", " ", 
    "final", " ", "plane", " ", "transverse", " ", "to", " ", "this", " ", 
    "axis", " ", "relative", " ", "to", " ", "the", " ", "beamline"}], "*)"}],
   "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Transverse", " ", "if", " ", "the", " ", "plane", " ", "is", " ", 
     "tranverse", " ", 
     RowBox[{"(", 
      RowBox[{"SHiP", ",", " ", 
       RowBox[{"FASER", " ", "etc"}]}], ")"}]}], ",", " ", 
    RowBox[{
    "and", " ", "Parallel", " ", "if", " ", "it", " ", "is", " ", "parallel", 
     " ", 
     RowBox[{"(", 
      RowBox[{"MATHUSLA", ",", " ", "ANUBIS"}]}]}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"DetectorPlaneOrientationExperiment", "[", "#1", "]"}], "=", 
        "#2"}], ")"}], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistfas", ",", 
       RowBox[{"Table", "[", 
        RowBox[{"\"\<Transverse\>\"", ",", 
         RowBox[{"Length", "[", "explistfas", "]"}]}], "]"}]}], "}"}]}], 
    "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Facility", " ", "hosting", " ", "the", " ", 
     RowBox[{"experiment", ":", " ", "SPS"}]}], ",", " ", "Fermilab", ",", 
    " ", "LHC", ",", " ", 
    RowBox[{"FCC", "-", "hh"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"FacilityExperiment", "[", "#1", "]"}], "=", "#2"}], ")"}], 
      "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistfas", ",", 
       RowBox[{"{", 
        RowBox[{"\"\<LHC\>\"", ",", "\"\<LHC\>\"", ",", "\"\<LHC\>\""}], 
        "}"}]}], "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Geometry", " ", "of", " ", "the", " ", 
     RowBox[{"experiment", ":", " ", "box"}]}], ",", " ", "cylinder", ",", 
    " ", 
    RowBox[{"annular", " ", "cylinder"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"GeometryExperiment", "[", "#1", "]"}], "=", "#2"}], ")"}], 
      "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistfas", ",", 
       RowBox[{"Table", "[", 
        RowBox[{"\"\<Cylinder\>\"", ",", 
         RowBox[{"Length", "[", "explistfas", "]"}]}], "]"}]}], "}"}]}], 
    "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Transverse", " ", "dimensions", " ", "of", " ", "the", " ", "decay", " ",
      "volume", " ", "assuming", " ", "box", " ", "geometry"}], ",", " ", 
    RowBox[{
    "or", " ", "cylindrical", " ", "geometry", " ", "if", " ", "the", " ", 
     "detector", " ", "plane", " ", "is", " ", "parallel", " ", "to", " ", 
     "the", " ", "beamline", " ", 
     RowBox[{
      RowBox[{"(", "ANUBIS", ")"}], ".", " ", "Otherwise"}], " ", "set", " ", 
     "to", " ", "zero"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MapThread", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"dxDecayVolumeExperiment", "[", 
        RowBox[{"z_", ",", "#1"}], "]"}], "=", "#2"}], ")"}], "&"}], ",", 
    RowBox[{"{", 
     RowBox[{"explistfas", ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"dyDecayVolumeExperiment", "[", 
         RowBox[{"z_", ",", "#1"}], "]"}], "=", "#2"}], ")"}], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistfas", ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Decay", " ", "volume", " ", "length", " ", "along", " ", "the", " ", 
    "beamline", " ", "axis"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"dzDecayVolumeExperiment", "[", "#1", "]"}], "=", "#2"}], 
       ")"}], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistfas", ",", 
       RowBox[{"{", 
        RowBox[{"1.5", ",", "5", ",", "5"}], "}"}]}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Distance", " ", "from", " ", "the", " ", "beamline", " ", "to", " ", 
     "the", " ", "decay", " ", "volume", " ", "center", " ", "and", " ", 
     "detector", " ", "along", " ", "the", " ", "x"}], ",", 
    RowBox[{"y", " ", "axes"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MapThread", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"xToDecayVolumeCenterExperiment", "[", 
        RowBox[{"z_", ",", "#1"}], "]"}], "=", "#2"}], ")"}], "&"}], ",", 
    RowBox[{"{", 
     RowBox[{"explistfas", ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"yToDecayVolumeCenterExperiment", "[", 
         RowBox[{"z_", ",", "#1"}], "]"}], "=", "#2"}], ")"}], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistfas", ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Inner", " ", "and", " ", "outer", " ", "radii", " ", "of", " ", "the", 
    " ", "decay", " ", 
    RowBox[{"volume", ".", " ", "Applicable"}], " ", "if", " ", "the", " ", 
    "decay", " ", "volume", " ", "has", " ", "cylindrical", " ", "geometry"}],
    "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MapThread", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"RinnerDecayVolumeExperiment", "[", 
        RowBox[{"#1", ",", "z_"}], "]"}], "=", "#2"}], ")"}], "&"}], ",", 
    RowBox[{"{", 
     RowBox[{"explistfas", ",", 
      RowBox[{"{", 
       RowBox[{"0.", ",", "0.", ",", "0."}], "}"}]}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"RouterDecayVolumeExperiment", "[", 
         RowBox[{"#1", ",", "z_"}], "]"}], "=", "#2"}], ")"}], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistfas", ",", 
       RowBox[{"{", 
        RowBox[{"0.1", ",", "1.", ",", "1."}], "}"}]}], "}"}]}], "]"}], ";"}],
   "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"z", "-", 
    RowBox[{
    "coordinate", " ", "of", " ", "the", " ", "center", " ", "of", " ", "the",
      " ", "decay", " ", "volume"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"zToDecayVolumeCenterExperiment", "[", "exp", "]"}], "=", 
      RowBox[{
       RowBox[{"zToDecayVolumeExperiment", "[", "exp", "]"}], "+", 
       FractionBox[
        RowBox[{"dzDecayVolumeExperiment", "[", "exp", "]"}], "2"]}]}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistfas"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Maximal", " ", 
    RowBox[{"long", ".", " ", "displacement"}], " ", "of", " ", "the", " ", 
    "decay", " ", "volume"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"zMaxDecayVolumeExperiment", "[", "exp", "]"}], "=", 
     RowBox[{
      RowBox[{"zToDecayVolumeExperiment", "[", "exp", "]"}], "+", 
      RowBox[{"dzDecayVolumeExperiment", "[", "exp", "]"}]}]}], ",", 
    RowBox[{"{", 
     RowBox[{"exp", ",", "explistfas"}], "}"}]}], "]"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Whether", " ", "the", " ", "decay", " ", "volume", " ", "serves", " ", 
    "as", " ", "detector", " ", 
    RowBox[{"(", 
     RowBox[{"True", " ", "or", " ", "False"}], ")"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"DecayVolumeAsDetectorExperiment", "[", "exp", "]"}], "=", 
     "\"\<False\>\""}], ",", 
    RowBox[{"{", 
     RowBox[{"exp", ",", "explistfas"}], "}"}]}], "]"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Transverse", " ", "dimensions", " ", "of", " ", "the", " ", "detector", 
    " ", "assuming", " ", "box", " ", "geometry"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MapThread", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"dxDetectorExperiment", "[", 
        RowBox[{"#1", ",", "z_"}], "]"}], "=", "#2"}], ")"}], "&"}], ",", 
    RowBox[{"{", 
     RowBox[{"explistfas", ",", 
      RowBox[{"{", 
       RowBox[{"0.1", ",", "1.", ",", "1."}], "}"}]}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"dyDetectorExperiment", "[", 
         RowBox[{"#1", ",", "z_"}], "]"}], "=", "#2"}], ")"}], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistfas", ",", 
       RowBox[{"{", 
        RowBox[{"0.1", ",", "1.", ",", "1."}], "}"}]}], "}"}]}], "]"}], ";"}],
   "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Length", " ", "of", " ", "the", " ", "detector", " ", "in", " ", "z", " ",
     "plane"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"dzDetectorExperiment", "[", "#1", "]"}], "=", "#2"}], ")"}], 
      "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistfas", ",", 
       RowBox[{"{", 
        RowBox[{"3", ",", "3", ",", "3"}], "}"}]}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Coordinates", " ", "of", " ", "the", " ", "center", " ", "of", " ", "the",
     " ", "detector"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"xToDetectorCenterExperiment", "[", "exp", "]"}], "=", "0"}], 
    ",", 
    RowBox[{"{", 
     RowBox[{"exp", ",", "explistfas"}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"yToDetectorCenterExperiment", "[", "exp", "]"}], "=", "0"}], 
    ",", 
    RowBox[{"{", 
     RowBox[{"exp", ",", "explistfas"}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"zToDetectorCenterExperiment", "[", "exp", "]"}], "=", 
      RowBox[{
       RowBox[{"zMaxDecayVolumeExperiment", "[", "exp", "]"}], "+", 
       FractionBox[
        RowBox[{"dzDetectorExperiment", "[", "exp", "]"}], "2"]}]}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistfas"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Inner", " ", "and", " ", "outer", " ", "radii", " ", "of", " ", "the", 
    " ", "detector"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MapThread", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"RinnerDetectorExperiment", "[", 
        RowBox[{"#1", ",", "z_"}], "]"}], "=", "#2"}], ")"}], "&"}], ",", 
    RowBox[{"{", 
     RowBox[{"explistfas", ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0.", ",", "0."}], "}"}]}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"RouterDetectorExperiment", "[", 
         RowBox[{"#1", ",", "z_"}], "]"}], "=", "#2"}], ")"}], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistfas", ",", 
       RowBox[{"{", 
        RowBox[{"0.1", ",", "1.", ",", "1."}], "}"}]}], "}"}]}], "]"}], ";"}],
   "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Length", " ", "of", " ", "the", " ", "detector", " ", "along", " ", "the",
     " ", "detector", " ", "axis"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"dxLongDetectorExperiment", "[", "exp", "]"}], "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"DetectorPlaneOrientationExperiment", "[", "exp", "]"}], 
         "\[Equal]", "\"\<Transverse\>\""}], ",", 
        RowBox[{"dzDetectorExperiment", "[", "exp", "]"}], ",", 
        RowBox[{"dyDetectorExperiment", "[", "exp", "]"}]}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistfas"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "The", " ", "maximal", " ", "coordinate", " ", "of", " ", "the", " ", 
    "end", " ", "of", " ", "the", " ", "detector", " ", "plane", " ", 
    RowBox[{"(", 
     RowBox[{"along", " ", "the", " ", "detector", " ", "axis"}], ")"}], " ", 
    "used", " ", "to", " ", "calculate", " ", "the", " ", "decay", " ", 
    RowBox[{"acceptance", ".", " ", "May"}], " ", "be", " ", "either", " ", 
    "the", " ", "z", " ", "coordinate", " ", "or", " ", "the", " ", "y", " ", 
    "coordinate", " ", 
    RowBox[{"(", 
     RowBox[{
     "if", " ", "the", " ", "final", " ", "detector", " ", "plane", " ", "is",
       " ", "oriented", " ", "parallel", " ", "to", " ", "the", " ", 
      "beamline"}], ")"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"xLongMaxDetectorExperiment", "[", "exp", "]"}], "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"DetectorPlaneOrientationExperiment", "[", "exp", "]"}], 
         "\[Equal]", "\"\<Transverse\>\""}], ",", 
        RowBox[{
         RowBox[{"zMaxDecayVolumeExperiment", "[", "exp", "]"}], "+", 
         RowBox[{"dxLongDetectorExperiment", "[", "exp", "]"}]}], ",", 
        RowBox[{
         RowBox[{"yToDetectorCenterExperiment", "[", "exp", "]"}], "+", 
         RowBox[{
          RowBox[{"dyDetectorExperiment", "[", "exp", "]"}], "/", "2"}]}]}], 
       "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistfas"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Position", " ", "of", " ", "the", " ", "final", " ", "plane", " ", "for", 
    " ", "the", " ", "decay", " ", "products", " ", "along", " ", "the", " ", 
    "detector", " ", "axis"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"xLongDecayProductFinalPlaneExperiment", "[", "exp", "]"}], "=", 
     RowBox[{"xLongMaxDetectorExperiment", "[", "exp", "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"exp", ",", "explistfas"}], "}"}]}], "]"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Whether", " ", "the", " ", "experiment", " ", "has", " ", "dipole", " ", 
    "magnet", " ", "in", " ", "the", " ", "detector", " ", 
    RowBox[{"(", 
     RowBox[{"True", ",", " ", "False"}], ")"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"DipoleMagnetOptionExperiment", "[", "#1", "]"}], "=", "#2"}],
        ")"}], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistfas", ",", 
       RowBox[{"{", 
        RowBox[{"\"\<False\>\"", ",", "\"\<False\>\"", ",", "\"\<False\>\""}],
         "}"}]}], "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Longitudinal", " ", "positions", " ", "of", " ", "the", " ", "dipole", 
    " ", "magnet", " ", "of", " ", "the", " ", "detector"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MapThread", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"zMagnetMinExperiment", "[", "#1", "]"}], "=", "#2"}], ")"}], 
     "&"}], ",", 
    RowBox[{"{", 
     RowBox[{"explistfas", ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"zMagnetMaxExperiment", "[", "#1", "]"}], "=", "#2"}], ")"}], 
      "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistfas", ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Mean", " ", "magnetic", " ", "field", " ", "of", " ", "the", " ", 
    "dipole", " ", "magnet"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"MagneticFieldExperiment", "[", "#1", "]"}], "=", "#2"}], 
       ")"}], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistfas", ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"ECAL", " ", "option", " ", 
    RowBox[{"(", 
     RowBox[{"True", ",", "False"}], ")"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"ECALoptionExperiment", "[", "exp", "]"}], "=", 
      "\"\<True\>\""}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistfas"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Position", " ", "of", " ", "the", " ", "beginning", " ", "of", " ", "the",
     " ", "ECAL"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"zECALminExperiment", "[", "#1", "]"}], "=", "#2"}], ")"}], 
      "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistfas", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"zMaxDecayVolumeExperiment", "[", "\"\<FASER\>\"", "]"}], 
          "+", "1"}], ",", 
         RowBox[{
          RowBox[{"zMaxDecayVolumeExperiment", "[", "\"\<FASER2\>\"", "]"}], 
          "+", "1"}], ",", 
         RowBox[{
          RowBox[{
          "zMaxDecayVolumeExperiment", "[", "\"\<FASER2-FPF\>\"", "]"}], "+", 
          "1"}]}], "}"}]}], "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "The", " ", "final", " ", "detector", " ", "plane", " ", "needed", " ", 
     "to", " ", "reconstruct", " ", 
     RowBox[{"muons", ".", " ", "Depeding"}], " ", "on", " ", "the", " ", 
     "experiment"}], ",", " ", 
    RowBox[{
    "it", " ", "is", " ", "approximated", " ", "by", " ", "be", " ", "end", 
     " ", "of", " ", "the", " ", "trackers", " ", "or", " ", "the", " ", 
     "muon", " ", "system"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"xLongMuonPlaneExperiment", "[", "#1", "]"}], "=", "#2"}], 
       ")"}], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistfas", ",", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"xLongMaxDetectorExperiment", "[", "exp", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"exp", ",", "explistfas"}], "}"}]}], "]"}]}], "}"}]}], 
    "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "The", " ", "final", " ", "detector", " ", "plane", " ", "needed", " ", 
     "to", " ", "reconstruct", " ", "other", " ", 
     RowBox[{"particles", ".", " ", "Depeding"}], " ", "on", " ", "the", " ", 
     "experiment"}], ",", " ", 
    RowBox[{
    "it", " ", "is", " ", "approximated", " ", "by", " ", "the", " ", "end", 
     " ", "of", " ", "the", " ", "trackers", " ", "or", " ", "the", " ", 
     "calorimeter", " ", "system"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"xLongNonMuonPlaneExperiment", "[", "#1", "]"}], "=", "#2"}], 
       ")"}], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistfas", ",", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"xLongMaxDetectorExperiment", "[", "exp", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"exp", ",", "explistfas"}], "}"}]}], "]"}]}], "}"}]}], 
    "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"List", " ", "of", " ", "detectable", " ", 
     RowBox[{"particles", ".", " ", "If"}], " ", "ECAL", " ", "is", " ", 
     "absent"}], ",", " ", 
    RowBox[{
    "it", " ", "is", " ", "assumed", " ", "by", " ", "default", " ", "that", 
     " ", "photons", " ", "and", " ", 
     SubscriptBox[
      SuperscriptBox["K", "0"], "L"], " ", "cannot", " ", "be", " ", 
     "detected"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MapThread", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"DetectablePDGsExperiment", "[", "#1", "]"}], "=", "#2"}], 
      ")"}], "&"}], ",", 
    RowBox[{"{", 
     RowBox[{"explistfas", ",", 
      RowBox[{"Table", "[", 
       RowBox[{"detectablepdgs", ",", 
        RowBox[{"Length", "[", "explistfas", "]"}]}], "]"}]}], "}"}]}], "]"}],
   ";"}]}], "Input",
 CellChangeTimes->{
  3.8933227514915576`*^9, {3.8934862861671705`*^9, 3.8934862890706244`*^9}, {
   3.893518136977829*^9, 3.893518136985808*^9}, 3.893519312803669*^9, {
   3.8935201259972086`*^9, 3.8935201693058376`*^9}, 3.893520658180394*^9, 
   3.894438590458749*^9, {3.8971453067542086`*^9, 3.897145319361229*^9}, {
   3.897145473916631*^9, 3.8971454869274044`*^9}, {3.9039677800427427`*^9, 
   3.9039677860126348`*^9}, {3.903967899409309*^9, 3.9039679648987923`*^9}, 
   3.9050600992847786`*^9, 3.9102405948187027`*^9, {3.910246973658266*^9, 
   3.910246973662771*^9}, {3.910254175974645*^9, 3.9102541868594475`*^9}, {
   3.9102542821501503`*^9, 3.910254282254585*^9}, {3.910258899620225*^9, 
   3.9102589042842274`*^9}, {3.912056629863624*^9, 3.9120566340099983`*^9}, 
   3.9120572924002333`*^9},
 CellLabel->
  "In[252]:=",ExpressionUUID->"a5131042-69e6-4716-bf2c-b780ae8b8876"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Cross-sections", "Subsubsection",
 CellChangeTimes->{{3.8933256308713317`*^9, 
  3.8933256323468237`*^9}},ExpressionUUID->"1d1b80a6-b212-4fff-b239-\
7bab1d73e10a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"MapThread", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"NPOTexperiment", "[", "#1", "]"}], "=", "#2"}], ")"}], "&"}], 
    ",", 
    RowBox[{"{", 
     RowBox[{"explistfas", ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         FractionBox["LLHChighLumi", "20"], "*", 
         RowBox[{"\[Sigma]ppInpbFacility", "[", "\"\<LHC\>\"", "]"}]}], ",", 
        RowBox[{"LLHChighLumi", "*", 
         RowBox[{"\[Sigma]ppInpbFacility", "[", "\"\<LHC\>\"", "]"}]}], ",", 
        RowBox[{"LLHChighLumi", "*", 
         RowBox[{"\[Sigma]ppInpbFacility", "[", "\"\<LHC\>\"", "]"}]}]}], 
       "}"}]}], "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"AtargetExperiment", "[", "#1", "]"}], "=", "#2"}], ")"}], 
      "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistfas", ",", 
       RowBox[{"Table", "[", 
        RowBox[{"1.", ",", 
         RowBox[{"Length", "[", "explistfas", "]"}]}], "]"}]}], "}"}]}], 
    "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Cascade", " ", "enhancement", " ", "of", " ", "the", " ", "production", 
    " ", "relative", " ", "to", " ", "the", " ", "production", " ", "in", " ",
     "pure", " ", "pp", " ", 
    RowBox[{"collisions", ".", " ", "Relevant"}], " ", "for", " ", "fixed", 
    " ", "target", " ", "experiments"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "For", " ", "all", " ", "experiments", " ", "located", " ", "at", " ", 
     "SPS"}], ",", " ", 
    RowBox[{
     RowBox[{
      RowBox[{
      "the", " ", "cascade", " ", "fastors", " ", "is", " ", "taken", " ", 
       "from", " ", 
       RowBox[{"http", ":"}]}], "//", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"cds", ".", "cern", ".", "ch"}], "/", "record"}], "/", 
          "2115534"}], "/", "files"}], "/", "SHiP"}], "-", "NOTE", "-", 
       "2015", "-", 
       RowBox[{"009.", 
        RowBox[{"pdf", "?", "version"}]}]}]}], "=", "1"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"CascadeFactorbb", "[", "#1", "]"}], "=", "#2"}], ")"}], 
      "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistfas", ",", 
       RowBox[{"Table", "[", 
        RowBox[{"1.", ",", 
         RowBox[{"Length", "[", "explistfas", "]"}]}], "]"}]}], "}"}]}], 
    "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Fraction", " ", "of", " ", "produced", " ", "bb", " ", "per", " ", "PoT", 
    " ", "at", " ", "the", " ", "given", " ", "experiment"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"PppTobbExperiment", "[", "exp", "]"}], "=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"\[Sigma]ppTobbInpbFacility", "[", 
        RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}], "/", 
       RowBox[{"\[Sigma]ppInpbFacility", "[", 
        RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}]}], ")"}], 
     SuperscriptBox[
      RowBox[{"AtargetExperiment", "[", "exp", "]"}], "0.29"], "*", 
     RowBox[{"CascadeFactorbb", "[", "exp", "]"}]}]}], ",", 
   RowBox[{"{", 
    RowBox[{"exp", ",", "explistfas"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"CascadeFactorcc", "[", "#1", "]"}], "=", "#2"}], ")"}], 
      "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistfas", ",", 
       RowBox[{"Table", "[", 
        RowBox[{"1.", ",", 
         RowBox[{"Length", "[", "explistfas", "]"}]}], "]"}]}], "}"}]}], 
    "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Fraction", " ", "of", " ", "produced", " ", "cc", " ", "per", " ", "PoT", 
    " ", "at", " ", "the", " ", "given", " ", "experiment"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"PppToccExperiment", "[", "exp", "]"}], "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"\[Sigma]ppToccInpbFacility", "[", 
         RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}], "/", 
        RowBox[{"\[Sigma]ppInpbFacility", "[", 
         RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}]}], ")"}], 
      SuperscriptBox[
       RowBox[{"AtargetExperiment", "[", "exp", "]"}], "0.29"], "*", 
      RowBox[{"CascadeFactorcc", "[", "exp", "]"}]}]}], ",", 
    RowBox[{"{", 
     RowBox[{"exp", ",", "explistfas"}], "}"}]}], "]"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Fraction", " ", "of", " ", "produced", " ", "h", " ", "per", " ", "PoT", 
    " ", "at", " ", "the", " ", "given", " ", "experiment"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"PppTohExperiment", "[", "exp", "]"}], "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"\[Sigma]ppTohInpbFacility", "[", 
          RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}], "/", 
         RowBox[{"\[Sigma]ppInpbFacility", "[", 
          RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}]}], ")"}], 
       SuperscriptBox[
        RowBox[{"AtargetExperiment", "[", "exp", "]"}], "0.29"]}]}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistfas"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Fraction", " ", "of", " ", "produced", " ", "W", " ", "per", " ", "PoT", 
    " ", "at", " ", "the", " ", "given", " ", "experiment"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"PppToWExperiment", "[", "exp", "]"}], "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"\[Sigma]ppToWInpbFacility", "[", 
          RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}], "/", 
         RowBox[{"\[Sigma]ppInpbFacility", "[", 
          RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}]}], ")"}], 
       SuperscriptBox[
        RowBox[{"AtargetExperiment", "[", "exp", "]"}], "0.29"]}]}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistfas"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Fraction", " ", "of", " ", "produced", " ", 
    SuperscriptBox["\[Pi]", "0"], " ", "per", " ", "PoT", " ", "at", " ", 
    "the", " ", "given", " ", "experiment"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"PppTo\[Pi]0exp", "[", "exp", "]"}], "=", 
      RowBox[{"PppTo\[Pi]0Facility", "[", 
       RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistfas"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Fraction", " ", "of", " ", "produced", " ", "\[Eta]", " ", "per", " ", 
    "PoT", " ", "at", " ", "the", " ", "given", " ", "experiment"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"PppTo\[Eta]exp", "[", "exp", "]"}], "=", 
      RowBox[{"PppTo\[Eta]Facility", "[", 
       RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistfas"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Fraction", " ", "of", " ", "produced", " ", 
    RowBox[{"\[Eta]", "'"}], " ", "per", " ", "PoT", " ", "at", " ", "the", 
    " ", "given", " ", "experiment"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"PppTo\[Eta]prexp", "[", "exp", "]"}], "=", 
      RowBox[{"PppTo\[Eta]prFacility", "[", 
       RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistfas"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Fraction", " ", "of", " ", "produced", " ", 
    SuperscriptBox["\[Rho]", "0"], " ", "per", " ", "PoT", " ", "at", " ", 
    "the", " ", "given", " ", "experiment"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"PppTo\[Rho]0exp", "[", "exp", "]"}], "=", 
      RowBox[{"PppTo\[Rho]0Facility", "[", 
       RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistfas"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Fraction", " ", "of", " ", "produced", " ", "\[Omega]", " ", "per", " ", 
    "PoT", " ", "at", " ", "the", " ", "given", " ", "experiment"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"PppTo\[Omega]exp", "[", "exp", "]"}], "=", 
     RowBox[{"PppTo\[Omega]Facility", "[", 
      RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"exp", ",", "explistfas"}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"PppToJpsiexp", "[", "exp", "]"}], "=", 
      RowBox[{
       RowBox[{"PppToJpsiFacility", "[", 
        RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}], 
       SuperscriptBox[
        RowBox[{"AtargetExperiment", "[", "exp", "]"}], "0.29"]}]}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistfas"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Fraction", " ", "of", " ", "produced", " ", "\[CapitalUpsilon]", 
    RowBox[{"(", 
     RowBox[{"1", "s"}], ")"}], " ", "per", " ", "PoT", " ", "at", " ", "the",
     " ", "given", " ", "experiment"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"PppToUpsilonexp", "[", "exp", "]"}], "=", 
      RowBox[{
       RowBox[{"PppToUpsilonFacility", "[", 
        RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}], 
       SuperscriptBox[
        RowBox[{"AtargetExperiment", "[", "exp", "]"}], "0.29"]}]}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistfas"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Fraction", " ", "of", " ", "produced", " ", "\[Phi]", " ", "at", " ", 
    "the", " ", "given", " ", "experiment"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"PppToPhiexp", "[", "exp", "]"}], "=", 
      RowBox[{"PppToPhiFacility", "[", 
       RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistfas"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Overall", " ", "table", " ", "with", " ", "cross"}], "-", 
    RowBox[{"sections", " ", "used", " ", "for", " ", "exporting"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"TableNumbersParticlesExperiment", "[", "exp", "]"}], "=", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "\"\<Facility\>\"", ",", "\"\<Npot\>\"", ",", "\"\<Atarget\>\"", ",", 
         "\"\<PPi0\>\"", ",", "\"\<PEta\>\"", ",", "\"\<PEtapr\>\"", ",", 
         "\"\<PRho0\>\"", ",", "\"\<POmega\>\"", ",", "\"\<Pc\>\"", ",", 
         "\"\<Pb\>\"", ",", "\"\<PW\>\"", ",", "\"\<Ph\>\"", ",", 
         "\"\<PJpsi\>\"", ",", "\"\<PUpsilon\>\"", ",", "\"\<PPhi\>\""}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"FacilityExperiment", "[", "exp", "]"}], ",", 
         RowBox[{"NPOTexperiment", "[", "exp", "]"}], ",", 
         RowBox[{"AtargetExperiment", "[", "exp", "]"}], ",", 
         RowBox[{"PppTo\[Pi]0exp", "[", "exp", "]"}], ",", 
         RowBox[{"PppTo\[Eta]exp", "[", "exp", "]"}], ",", 
         RowBox[{"PppTo\[Eta]prexp", "[", "exp", "]"}], ",", 
         RowBox[{"PppTo\[Rho]0exp", "[", "exp", "]"}], ",", 
         RowBox[{"PppTo\[Omega]exp", "[", "exp", "]"}], ",", 
         RowBox[{"2", 
          RowBox[{"PppToccExperiment", "[", "exp", "]"}]}], ",", 
         RowBox[{"2", 
          RowBox[{"PppTobbExperiment", "[", "exp", "]"}]}], ",", 
         RowBox[{"PppToWExperiment", "[", "exp", "]"}], ",", 
         RowBox[{"PppTohExperiment", "[", "exp", "]"}], ",", 
         RowBox[{"PppToJpsiexp", "[", "exp", "]"}], ",", 
         RowBox[{"PppToUpsilonexp", "[", "exp", "]"}], ",", 
         RowBox[{"PppToPhiexp", "[", "exp", "]"}]}], "}"}]}], "}"}], "//", 
     "N"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"exp", ",", "explistfas"}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.8933427867742977`*^9, 3.893342787584256*^9}, {
  3.8933428564379854`*^9, 3.893342856906787*^9}, {3.894178190964991*^9, 
  3.894178195020878*^9}, {3.89417867672976*^9, 3.894178679983819*^9}, {
  3.897235670917677*^9, 3.8972356883291435`*^9}, {3.8972861577158775`*^9, 
  3.897286163063202*^9}, {3.89919634103925*^9, 3.89919634136086*^9}, {
  3.899197050735374*^9, 3.8991970510611663`*^9}, {3.899197141071712*^9, 
  3.8991971412644176`*^9}, {3.9070413879510098`*^9, 3.907041402062005*^9}, {
  3.9076954738793545`*^9, 3.9076954739076667`*^9}},
 CellLabel->
  "In[287]:=",ExpressionUUID->"fddc0f0c-7456-440a-88f4-990f0a40ff40"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Conditions for the LLP to decay inside the decay volume and for the products \
to point to the end of the detector\
\>", "Subsubsection",
 CellChangeTimes->{{3.905011297554874*^9, 3.9050113192993593`*^9}, 
   3.915437208512065*^9},ExpressionUUID->"2b078a68-361f-43b1-becf-\
80bfa3e3fa7c"],

Cell[BoxData[
 RowBox[{"Do", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"IfLLPinsideDecVol", "[", 
      RowBox[{"zLLP_", ",", "xLLP_", ",", "yLLP_", ",", "exp"}], "]"}], "=", 
     RowBox[{"IfLLPinsideDecVolSimple", "[", "exp", "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"IfLLPtoDet", "[", 
        RowBox[{
        "x1LLPproj_", ",", "x2LLPproj_", ",", "xLongProj_", ",", "exp"}], 
        "]"}], ",", 
       RowBox[{"IfLLPnotToDet", "[", 
        RowBox[{
        "x1LLPproj_", ",", "x2LLPproj_", ",", "xLongProj_", ",", "exp"}], 
        "]"}]}], "}"}], "=", 
     RowBox[{"IfParticlePointsToDetSimple", "[", "exp", "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"IfLLPdecVolToDet", "[", 
      RowBox[{
      "zLLP_", ",", "xLLP_", ",", "yLLP_", ",", "x1LLPproj_", ",", 
       "x2LLPproj_", ",", "xLongProj_", ",", "exp"}], "]"}], "=", 
     RowBox[{
      RowBox[{"IfLLPinsideDecVol", "[", 
       RowBox[{"zLLP", ",", "xLLP", ",", "yLLP", ",", "exp"}], "]"}], "*", 
      RowBox[{"IfLLPtoDet", "[", 
       RowBox[{"x1LLPproj", ",", "x2LLPproj", ",", "xLongProj", ",", "exp"}], 
       "]"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"IfLLPdecVolNotToDet", "[", 
      RowBox[{
      "zLLP_", ",", "xLLP_", ",", "yLLP_", ",", "x1LLPproj_", ",", 
       "x2LLPproj_", ",", "xLongProj_", ",", "exp"}], "]"}], "=", 
     RowBox[{
      RowBox[{"IfLLPinsideDecVol", "[", 
       RowBox[{"zLLP", ",", "xLLP", ",", "yLLP", ",", "exp"}], "]"}], "*", 
      RowBox[{"IfLLPnotToDet", "[", 
       RowBox[{"x1LLPproj", ",", "x2LLPproj", ",", "xLongProj", ",", "exp"}], 
       "]"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"DecayAcceptanceGeometry", "[", 
      RowBox[{"coord1_", ",", "coord2_", ",", "xLongProj_", ",", "exp"}], 
      "]"}], "=", 
     RowBox[{"IfLLPtoDet", "[", 
      RowBox[{"coord1", ",", "coord2", ",", "xLongProj", ",", "exp"}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", ",", 
   RowBox[{"{", 
    RowBox[{"exp", ",", "explistfas"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.905014529054861*^9, 3.9050145291014605`*^9}, 
   3.9050171518788567`*^9, {3.905059383662793*^9, 3.905059383828601*^9}, {
   3.910258574522359*^9, 3.910258640928173*^9}, 3.910258818493661*^9, 
   3.910259935682703*^9, {3.915437006936726*^9, 3.9154370915076675`*^9}, {
   3.9154372085346975`*^9, 3.9154372086075764`*^9}},
 CellLabel->
  "In[304]:=",ExpressionUUID->"82d15f9c-fc0b-4641-95bb-894c0fdf779b"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["ANUBIS-shaft", "Subsection",
 CellChangeTimes->{{3.8933162189589405`*^9, 3.893316220446392*^9}, {
  3.89746338798587*^9, 
  3.8974633919433613`*^9}},ExpressionUUID->"03c807ab-aa72-4ed4-a63d-\
ad3a58af6502"],

Cell[CellGroupData[{

Cell["Definitions", "Subsubsection",
 CellChangeTimes->{{3.8933188979030943`*^9, 
  3.8933188992327194`*^9}},ExpressionUUID->"f93b48e2-202e-4645-be81-\
b14292c6023f"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Transverse", " ", "cross"}], "-", 
    RowBox[{"section", " ", "of", " ", "ANUBIS", " ", "modules"}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"RANUBIS", "=", "9"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"zToDecVolANUBIS", "=", "5"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"zFidANUBIS", "=", "18"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[CapitalDelta]xCrossANUBIStemp", "[", 
      RowBox[{"z_", ",", "R_", ",", "zToDecVol_", ",", "zFid_"}], "]"}], "=", 
     RowBox[{"2", 
      RowBox[{"\[Sqrt]", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["R", "2"], "-", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"z", "-", "zToDecVol", "-", 
            RowBox[{"zFid", "/", "2"}]}], ")"}], "2"]}], ")"}]}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[CapitalDelta]xCrossANUBIS", "[", "z_", "]"}], "=", 
     RowBox[{"\[CapitalDelta]xCrossANUBIStemp", "[", 
      RowBox[{
      "z", ",", "RANUBIS", ",", "zToDecVolANUBIS", ",", "zFidANUBIS"}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[CapitalDelta]yCrossANUBIS", "=", "18"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Plot", "[", 
    RowBox[{
     RowBox[{"\[CapitalDelta]xCrossANUBIS", "[", "z", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"z", ",", "5", ",", "23"}], "}"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.89331890705409*^9, 3.893318909068802*^9}},
 CellLabel->
  "In[305]:=",ExpressionUUID->"2c7da6e7-d8ac-4110-b95d-9dbc4eea7c83"],

Cell[BoxData[
 FormBox[
  GraphicsBox[{{{}, {}, 
     TagBox[
      {RGBColor[0.368417, 0.506779, 0.709798], AbsoluteThickness[1.6], 
       Opacity[1.], LineBox[CompressedData["
1:eJw92Hc8lu37B3CUyh7dNlkJ98Al7pTkY6akNOyRx6g0qIxKkjKSLSUpnopU
tKk8mnytjFBCkuzsUEJGv9M/v7/u1/t1vu7rnNdxHOel6O67w4uLg4PDnZOD
Y+F3aCpbkoODhhUeclr3hQMMPc41md/mpsHP12tIhtlt2CK2LGArHw325Z0W
/RFDhtZZepkTwjRw3elbWx44Zliu7V1/TZyGZUU7Dqep/zLcUHTlr4ksDdyz
v4t/nv9tmL+tkjWoSIMR10vVRw+nDG8eZESvZdGwdzBkjeTpWUPJGaeCdm0a
Vh+M3HlQb94w4Xxs7zk9GgpZlvLZn/8aBmcPGzea0ECpnUhOOMwJu/aHM0cd
aQjhMPUWUFiM9z7t6tJuNIiuwpmqV4thOidsX+RFw9sNNlLdttzQlj6aL3SE
htDt00npwUvAv0vn0L1zNGTWW+5Qz1iG4vKCtp58GhiK8yEynvxYa9vPH1dI
g9UVzuTbH/nxqFtKX+ctDVenjw8cNxJAOufJy2eraJBj1n5gSwriuL6BtXwn
De514S4DeULQeFhUZC8khr1+9Tmv7URwy2D8x1+aGGI0srUFI0QgW6204ra0
GObumAR3PhYBT39Y0ISKGELW0rNVeUXRrWS++sJ6MYxxtFqffiqKKymVWVXe
YijlrP1WOb0cHGvS4oZ8xdCr5bCJfyUN+5q8AwUCxXBt0s9lxIoGPUkei21n
xbA8RTA5/ToNzVc2Dn5IE8P38sbCTiMxiKeXUC1VYlCyXtqYESCOi5mvX/ex
xBGbR4W+yJXErEn8bR4dcay+GtewvkYSnt0uifR14rhnniUTMyIJHZW5fw6a
i8P+VE1OkpYUPmbrc4+6ikPfsarC6YkURHMKLCcTxOHtIFcYfF8aiY+eNHOP
i2PlUu2asQhZDI/4vXs9KY4rO49/974ui80s3cJjc+LI4rovVFooC+6c51f7
l0lA+MxoqcoPWQRlvnStkZeAjET6iiu2cvBIKeu+aCUB5YIXTREKK8AObhlV
visB13UceRo35fF1IxePsZskWLnNYfWrFdG82dSgzUsS3VdEiuU2KKLBKvJI
0AFJ3Pq8hc/dQhHVO3lbngRKYtlu3ckPzop4uVs0VzlOEuOJ657ZRSgi7ZiS
FXehJO6ccrKZalCE/W3jpIrlUmCs+3R5wEcJH5aESW0rlyLnZpnUhwRliBhX
1FdukUE60219wgsVZP/xj7QokAWn7K2CsFOqiNDs7dQxXoGlqx7MldDVwR8b
JT9eIg+HK08fDf5Lxy/tTfeaUxTQfStTK6GJgWWuj675OipCAPOPOJeyUL7R
MmapiBLYry1rE7g14FA637+0RAlP/vZ3NfRqQOTMxWuGkco4FODW4lWsCf8Z
F6vj+ivBfLNj4PN6Lczm8ezo+7sSOkWJ6QaXtGDH8b7s7VsVrL20TfBShxZc
+MrWpvmvgtT3a2Nj8hTO77rOkbtGFVt4QvbtdqRwJzZ/Y9g6VXinn/im6kSh
oqQi3slAFQlOwo0/iJfojsnym6giKXWXcYgLhXAx47WHtqrifrWU1CU3CiGN
XUc0vVRhkBr4PmcPBX971a68C6ooe3C1OvAoBTfnB6Uvh1Xxxlov5mIUheNy
ogP1o6rQnuw5bXmeQmJbgOD3n6qI4T7UyRlN4a2bgZ3IH1U4h20dOxhDQcGr
us9riRoi91rprY+n8O3QAJ+QvBp2U4FBb5IpuJ5eteMfazW4Lmkzc8igEIjo
wMCdauhoHhOfJ47nHEmLsVXDWdcpu5v/Ungd9rTrqbMainfL0vuvU1gRZRrA
662GzLf+woczKXxNdE/NO6MGzo7Gcfc7FJxvZrRx56lhY2JW4NfHFP5XWpzF
/0wNNcYVzw89oUDv792//D818DU3+84RT2tqTiq8UUNu+S9TmXwKKa/eCK2v
UoO+35lw62cU6prbcbRLDfdbBDxvFFIwFVLObFuujv8CZGZaiynkam/07hFX
h3CzqLbz/yiI2h7QHJJSx7IbpzpaiDuu5b2YllfHw9stdxtLyPrTTRtoTHWs
ch/qKC+jUGDmxW1pqg7TcpHpxEoKzODbe5/7q+OcTJXA63qyHj4lVPQxdbzS
alys8oHCqFvHjHOQOp7fFzgXQ5xvJpPIFaqOsZ2KLLuPFPSFEgqsYtSxbe9T
jv4GCptvBvJ031CHSYlR9e8mCt4VZrnCteqovR+i9uIrhcpC94CuenVYWGYk
L28j/d8/bfisQR2CRR+jDxCPJv330alFHXqDaXLS38h5cGLNZveoY1Bt56cj
7RSiRmhWBrPqSNhGS+bropBN6x7xVqcj/ayBX993ChyJ1iknmHRkr264qddH
wYnvlcF5TTp8qoUso4iFuVJi7+jSId+RxL2qn0LQj43070akXThc2WmAwtbK
XC9PRzqsk/h47g2R828mKeDvQsfIqpVlP4kXFYXnh7nR8S1vy+y6YbKez10W
Ze6hw6G892M5sdItoRsdR+kIfzCo9WWEwu/Tfq2uMXRkKR273TdKwXrmW5hP
PB31cnumVMfIfgZuYYQk0ZH48X/Fe4jdDqkEpV+mwyKg43+dxJWOTRKtmSRO
SBocbxinkKGrv9PhJR3DAbwPMn5RMB/kqtw5TMfmHPrh95MUruruC9AcpYPX
IrN3mnj0dI0C3086qlt39K2cIu201GPFU3QYz3rEnSAeNWCpUIsZEE667So3
TeFKol2ooAwDXafdFbb9oTDS8pIxIMeAWv8bSz9iUxWlplIFBnSCwrkuL7T/
N8Q6tYqBnz1Wol+JjbvOfBmkGKh9yHjhMUNhSPce+50FA6kKpjpOsxSMQkU6
sywZiNQ0lzhOnFIZGBe6lYGdWY0RF4mx26h7zS4GPOxyuauJL0U1JmXvZqBF
0jVRd47CwAd9g7PuDJypFKjbSgy5G30uXgy0052v7l1of3zAUOwAA9l+rQ2X
iTd84RgOC2TAOzX94zhxssqe1N0nGBg/HHB42TyFPt8qE/1gBp7z/EmVI05e
nJI2foaB5FahOPOFdhbD4p84BuZfpnImExscT/y5PpGBgmjO2SziC8UTGZLJ
DFC/lM4+I15v93aiNpUBx/aLVDNxUqhN5oYsBuyl7OXE/1Jgs06O8t1moOrP
XY2VxC2frxt8vkvG42RSRxErrR5q8ntIxh9rXWJJXPZNRMXoCZmvYZm4PfGB
2DVHBZ8ykKN3btqDOL/nLP/dQgaWHBjxDSK2v3DHIfAVA37mKYsiiOc2vM82
ectA5r1Y1QRi81Qpo7ZSBnYs3qdwk3jA1DA+t4IBTrutEznECWOeX45XMfDp
d4RjHnHz5kcBy+sZ+B45+KmYOHjyU3H7RwZsLksPvSNWzJoRetDIgLlu+oW6
hfFaK7qc/EzG2+r3rpF4/5x5jkUrA084/k1sJRbMOTgp9o3sr4B8Xwdxnu0F
064OBv56/artXRj/ooKkR90MfPCStxgknn34te3UdwYE3K5b/yC+7ryIaTnA
wKt/j/WPE5vxqJ+QHGagYe8t0d8L83m6taznBwOqP9Wrp4jj3f2X540zsN+f
W3yGWFsozS10goHV4nqjs8RNL97ct5piYOZPkeP8wvz29fyRnmFghUGmzV9i
BTE+i745BppHvrQvuKRI69JTDiYspA/OLtjbx7bz7CImfIp23lmwoEywpvUS
JjTbLnQvPO9J+Y1gOR4mtrqrP54jtvUvfzfAx4T/GgnBhf5nFIbFCwSZUDN0
nplemF+NqGeECBPNO6aOTxKbBuk93kFj4r3JYOQv4r5VrvPyEkys+6KjMkYc
9zHMcliKCY2Whp3DC/MLvZtaKMtE2nSlaD9xI7O255w8EzsHxN27iYM+/9K2
UWJCyKbA6BuxfKR0qJIKE54tDx5/Jt73zUv6FZ2J1PgrxjXE/LExe6NZTPA1
xnqUET/We5xvp8XEeu+PtDfEf5Jmt47rMnFrs73aQ+KMDUrX3uiR+R2+FJ1N
bDK4sT9Wn6xHkvKpdOJY0+QwVSMm2FJay6OJtcYK6n6ZMCEucf/ZaeJP6W1y
xeakP4PjA/7EKybVC5y3MDHaMMHlSvzw7tuhJDsmPNYETtKJt3zTlbjmyES2
kvGgzML+03KNsl1I/1ZJTvzEK0MvpRR6MMHDlf94kLyPqbb70eXLRFN95+qF
91c39tv+4aNMSP28zpdE/KFo16XJACYMfBt3nyLmZxkO8AUzYffw+qldxKGL
aBd1ophQsA+NnyXxRG7t+dcbYpiovVO+qYe40Ge+zyKeieprx87UEP/63Gfg
cpGJYX2ePdeI9z169T3iOhPOJ54v0iHe7rJXv6mAicQ6/YTNJN6NXGj16njB
RP3gXyEGcWzF9sTB18QvlgjwEZetXt/zt4SJvMP1J9+R+LqOVyRBrZ6JFB9y
qIiVnhd2nuhnYoe1TwONxOM3Q5oC4UNMhHPNSAyT+O6sdGtN/A8mzCWvNJUQ
p8QlxN6cIOM9P1N5lJjX05NdxcmCRtHEmQqSH34KC0bLSrOQcvcky4nkk2ix
4IJxWRbMo3S9NYiVpAd6K+RZcBj8RHES71AuMwlQYcHjxkvvW78pPNINmavR
YkHp4lu/vgkKPo4jh09vZGF26OSwPclfS3Y7/2uzmYWNh35OrCTO8KisYVix
kPxXPGb0J4Wag9n05h0s+EbtcIokZp527dZyZUElhJ58j+TDgcz3dp3+LJz3
fOHcRfLr2TvrIwuOsXCBd6nGHWLp+zn58UGkjvZ7EXOQeNOzSBH9UBZCw7YM
/fxB8nvFhqrkGBYYWxKM5ki+3jP8YIPZTRbMMo7p/SH5vpOdoHKnlgVa9LRO
OqkfjpZsoV58YIEzjNveiphrB6/B+08s1N2IGZ8l9YfyoYhdv76wsD6qP86R
2DPzZBhJIuh9LO8i1Evhu9C+jmYODRKX+m13k/plqA/pPNoaeDgxEppK6qPg
wPk7sroaUN/rHL6GmH/xy3xNPQ1y/zCb/9RKgSW/ptpmgwbWlXrZiBD72LBm
bmzWQFxdX8KZFgpjRVIO6zzI/23nWRak/vqdNk47cFED7unfqw7VkXgQfbjY
97IG3HjaM+dqKTwNGvH1T9OA1z8qv2OJ/R0HKk9dJ+NR9OXJeU/2X6ozNPGe
BnRYvf1fq0m9kFo/9LREA2Z3jp5nviPrn/KohGNCg9yXvk15FlFou+Djn2Kj
ifSSVFk8IvXR9h6VvfaamHUfXFLwkORLYeemNU6aOLbuYJAm8cb4Tes+u2nC
7FzNrOwDcl7Or+SQPaiJ+11th8ZzKYSFtsTcOKsJ6/Krk5G3Kaj5mGfee6iJ
yDQDR1tSv/+3Usi7Y7EWDGNevYoh94ObFke19i3Rwk8V6+gmcn+IPfhpcmSp
FgS2XCpXInbNvxo5y6uF4b6x5OfnKCw2VcuSENHCyWi+oy3hpD7zMPpmJacF
78/GOtynyX7d8LMp1NXCp2CX7SPkviIm32yUvEcLPtfkCnkdKJRPFV4pLdJC
SA/PUJASBQ/ZHHWmDIVjDtoFX7u1ILI72kMjmLyHk3/bQlK1IHYmXPZxI8kL
YrabmzdqgVHse7pWTxutvt32glWauNzp/4/PRW3ICuyKi5nTwPCWyJNGI9qw
19ob/FVOAzaNUYaPtq1Gyifj/SLCLCw3vHX235zV+JqxLIiL5LGusie+dAEd
vDHj3PriFqmLU6sv9h/SwY1fxsr8lDrub+JYq16hg8CZt7apOaqolVI5t5iu
i68O/lHrK1Ww8Z3HLrcIXcxHRtJKSpXBnDh+sSxSFwo2mooGr5QhqhjfwIzS
hc13Zu+jfGW0HS/YNR2tC7dd8aeiMpXhryZgcyFRF5SfitxkqDKun3tmU3JV
FxdKJt9WrVPGlBmPndoTXRwRrKuRyVHC3eIHDqNtuui6qTRtG6AI3rwDywLa
dXGscbzIdb8iDmaqPZ/u0MWt7UIhLrsVoRV+k7aoRxdqOrPRhpsUyX0mpVZs
UBebvm1eclFWEWUVp8z0J3Wxne6p5lOkgK73W6hIITZOvr98zWaRAkzf8LTz
irBRN7XoEn1EHtkPy+ITREn7XNDRC5/ksT8RQ6libKSXTzdKZ8ljfLvO7VwZ
NnplPtOWQR4cn2Tk6lXZsP1U8FjebwXkvgwskwUbVfduaHqUyGJWO+u/SCPy
/ITmzp05smiNdtk/ZsxGdYaatVqiLNLW1VWVmbHBXZ8pf9JJFuJpT+OPWLIh
fuh57ptRGQg7hNLKbdmo6HbqOiYmA64mMYWjh9jQksng/mwqhQ6N2rpWHzaG
AtwLIldJ4W1k1JmNh9mQcSyM510mhRD2TKesHxvTDun6FyolMXOp/Vb5cTYG
v5jUJlhJ4teuXIZcOBu/Hu+XuL1ZAt8/YE1FGhsbnXuE2TJiuKlmKe5yjY3c
2PDO0jEaXENsJsbS2XhM/7F7ppyGBvX9eTI32IjYvffJVj8aikOTNX1vs5FY
LVm5q3Q5MjR6VcXz2cgsDu3x3SUKx/DRJblP2TgWss9MdqUoxFr+9Bg+Z+O/
xtzrBj9FEBshlOVdyEaonbZ0TYIIglr1FF69Jf1b+N5KLBKGbXSMpGcNG68n
SkXEFgtCtP3S5NR7NsAdVewWK4Aa3euNcXVsnA/ac/2uqABMO/IvPv/IxpI4
ucF3kvzQ1msT5mth4/c+i/6mpbwYiev78e8XNvibxK1zgnlwt2v8vc5XNtZW
nDFxHFkGhYSlca7tbLjxCpw4XL4Ugr1aPE962TA9m7b0vAU3KvX1+8z72Hhn
seq5z7XFiEgyK//SzwZzUXGX18AizK53jOAeZoNn5Sr5hiNcKLjg6Zk2wkZt
4X7NlLuc8OvzMdEcZePpHs5tfU0cGEgO43T4yUZy3pFNPCvnDbP749qHf7FR
YL2/7of2rOE/hqlvzv4m+7uY2n5Z9o+h7KWbGRJTbKRGDrivbZo0bB64d+re
NBsaCot4GndOGCbjubPRDFnP/j5rjRPjhltTivQbZ4k7170UY44Y8g5VSR+Y
Z+OHFZVaattjWGrUOP33L/v/vwf/H8hY2Wc=
        "]]},
      Annotation[#, "Charting`Private`Tag$268364#1"]& ]}, {}},
   AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
   Axes->{True, True},
   AxesLabel->{None, None},
   AxesOrigin->{5.000000000000011, 0},
   DisplayFunction->Identity,
   Frame->{{False, False}, {False, False}},
   FrameLabel->{{None, None}, {None, None}},
   FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
   GridLines->{None, None},
   GridLinesStyle->Directive[
     GrayLevel[0.5, 0.4]],
   ImagePadding->All,
   Method->{
    "DefaultBoundaryStyle" -> Automatic, 
     "DefaultGraphicsInteraction" -> {
      "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
       "Effects" -> {
        "Highlight" -> {"ratio" -> 2}, "HighlightPoint" -> {"ratio" -> 2}, 
         "Droplines" -> {
          "freeformCursorMode" -> True, 
           "placement" -> {"x" -> "All", "y" -> "None"}}}}, 
     "DefaultMeshStyle" -> AbsolutePointSize[6], "ScalingFunctions" -> None, 
     "CoordinatesToolOptions" -> {"DisplayFunction" -> ({
         (Identity[#]& )[
          Part[#, 1]], 
         (Identity[#]& )[
          Part[#, 2]]}& ), "CopiedValueFunction" -> ({
         (Identity[#]& )[
          Part[#, 1]], 
         (Identity[#]& )[
          Part[#, 2]]}& )}},
   PlotRange->{{5, 23}, {0., 17.999999786751033`}},
   PlotRangeClipping->True,
   PlotRangePadding->{{
      Scaled[0.02], 
      Scaled[0.02]}, {
      Scaled[0.05], 
      Scaled[0.05]}},
   Ticks->{Automatic, Automatic}], TraditionalForm]], "Output",
 CellChangeTimes->{3.914993917664136*^9, 3.9149945964010735`*^9, 
  3.915002251353435*^9, 3.9150024623935604`*^9, 3.9150127845131702`*^9, 
  3.9151229485813417`*^9, 3.9151236649736967`*^9, 3.9151828695565953`*^9, 
  3.915183183064026*^9, 3.915184802776108*^9, 3.9151881150213256`*^9, 
  3.9151881624539967`*^9, 3.9151890245994864`*^9, 3.9152066336413918`*^9},
 CellLabel->
  "Out[4594]=",ExpressionUUID->"c6cc0e05-de15-4799-bed5-ee9ddcc172ec"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Geometry", "Subsubsection",
 CellChangeTimes->{{3.8933197199024706`*^9, 
  3.8933197207812386`*^9}},ExpressionUUID->"23f24e26-4009-4fc4-ad78-\
6ad0e3941fcc"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"explistanub", "=", 
    RowBox[{"{", 
     RowBox[{
     "\"\<ANUBIS-shaft-volume-1\>\"", ",", "\"\<ANUBIS-shaft-volume-2\>\"", 
      ",", "\"\<ANUBIS-shaft-volume-3\>\""}], "}"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Distance", " ", "to", " ", "the", " ", "fiducial", " ", "volume", " ", 
    "along", " ", "the", " ", "beamline", " ", 
    RowBox[{"axis", ".", " ", 
     RowBox[{"MapThread", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"list1", "[", "#", "]"}], "=", "#2"}], ")"}], "&"}], ",", 
       RowBox[{"{", 
        RowBox[{"listexp", ",", "listvals"}], "}"}]}], "]"}]}], " ", 
    "equates", " ", "the", " ", "elements", " ", "list1", " ", "with", " ", 
    "keys", " ", "from", " ", "listexp", " ", "to", " ", "the", " ", 
    "corresponding", " ", "elements", " ", "of", " ", "the", " ", "list", " ",
     "listvals"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"zToDecayVolumeExperiment", "[", "#1", "]"}], "=", "#2"}], 
       ")"}], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistanub", ",", 
       RowBox[{"{", 
        RowBox[{"4.5", ",", "4.5", ",", "4.5"}], "}"}]}], "}"}]}], "]"}], 
   ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Detector", " ", "has", " ", "the", " ", "axis", " ", "along", " ", 
    "which", " ", "its", " ", "components", " ", "are", " ", 
    RowBox[{"placed", ".", " ", "The"}], " ", "option", " ", "below", " ", 
    "defines", " ", "the", " ", "orientation", " ", "of", " ", "the", " ", 
    "final", " ", "plane", " ", "transverse", " ", "to", " ", "this", " ", 
    "axis", " ", "relative", " ", "to", " ", "the", " ", "beamline"}], "*)"}],
   "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Transverse", " ", "if", " ", "the", " ", "plane", " ", "is", " ", 
     "tranverse", " ", 
     RowBox[{"(", 
      RowBox[{"SHiP", ",", " ", 
       RowBox[{"FACET", " ", "etc"}]}], ")"}]}], ",", " ", 
    RowBox[{
    "and", " ", "Parallel", " ", "if", " ", "it", " ", "is", " ", "parallel", 
     " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"ANUBIS", "-", "shaft", "-", "volume", "-", "1"}], ",", " ", 
       "ANUBIS"}]}]}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"DetectorPlaneOrientationExperiment", "[", "#1", "]"}], "=", 
        "#2"}], ")"}], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistanub", ",", 
       RowBox[{"Table", "[", 
        RowBox[{"\"\<Parallel\>\"", ",", 
         RowBox[{"Length", "[", "explistanub", "]"}]}], "]"}]}], "}"}]}], 
    "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Facility", " ", "hosting", " ", "the", " ", 
     RowBox[{"experiment", ":", " ", "SPS"}]}], ",", " ", "Fermilab", ",", 
    " ", "LHC", ",", " ", 
    RowBox[{"FCC", "-", "hh"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"FacilityExperiment", "[", "#1", "]"}], "=", "#2"}], ")"}], 
      "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistanub", ",", 
       RowBox[{"Table", "[", 
        RowBox[{"\"\<LHC\>\"", ",", 
         RowBox[{"Length", "[", "explistanub", "]"}]}], "]"}]}], "}"}]}], 
    "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Geometry", " ", "of", " ", "the", " ", 
     RowBox[{"experiment", ":", " ", "box"}]}], ",", " ", "cylinder", ",", 
    " ", 
    RowBox[{"annular", " ", "cylinder"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"GeometryExperiment", "[", "#1", "]"}], "=", "#2"}], ")"}], 
      "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistanub", ",", 
       RowBox[{"Table", "[", 
        RowBox[{"\"\<Cylinder\>\"", ",", 
         RowBox[{"Length", "[", "explistanub", "]"}]}], "]"}]}], "}"}]}], 
    "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Transverse", " ", "dimensions", " ", "of", " ", "the", " ", "decay", " ",
      "volume", " ", "assuming", " ", "box", " ", "geometry"}], ",", " ", 
    RowBox[{
    "or", " ", "cylindrical", " ", "geometry", " ", "if", " ", "the", " ", 
     "detector", " ", "plane", " ", "is", " ", "parallel", " ", "to", " ", 
     "the", " ", "beamline", " ", 
     RowBox[{
      RowBox[{"(", "ANUBIS", ")"}], ".", " ", "Otherwise"}], " ", "set", " ", 
     "to", " ", "zero"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MapThread", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"dxDecayVolumeExperiment", "[", 
        RowBox[{"z_", ",", "#1"}], "]"}], "=", "#2"}], ")"}], "&"}], ",", 
    RowBox[{"{", 
     RowBox[{"explistanub", ",", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"\[CapitalDelta]xCrossANUBIS", "[", "z", "]"}], ",", 
        RowBox[{"Length", "[", "explistanub", "]"}]}], "]"}]}], "}"}]}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"dyDecayVolumeExperiment", "[", 
         RowBox[{"z_", ",", "#1"}], "]"}], "=", "#2"}], ")"}], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistanub", ",", 
       RowBox[{"{", 
        RowBox[{"19.5", ",", "18.7", ",", "18.6"}], "}"}]}], "}"}]}], "]"}], 
   ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Decay", " ", "volume", " ", "length", " ", "along", " ", "the", " ", 
    "beamline", " ", "axis"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"dzDecayVolumeExperiment", "[", "#1", "]"}], "=", "#2"}], 
       ")"}], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistanub", ",", 
       RowBox[{"Table", "[", 
        RowBox[{"18", ",", 
         RowBox[{"Length", "[", "explistanub", "]"}]}], "]"}]}], "}"}]}], 
    "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Distance", " ", "from", " ", "the", " ", "beamline", " ", "to", " ", 
     "the", " ", "decay", " ", "volume", " ", "center", " ", "and", " ", 
     "detector", " ", "along", " ", "the", " ", "x"}], ",", 
    RowBox[{"y", " ", "axes"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MapThread", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"xToDecayVolumeCenterExperiment", "[", 
        RowBox[{"z_", ",", "#1"}], "]"}], "=", "#2"}], ")"}], "&"}], ",", 
    RowBox[{"{", 
     RowBox[{"explistanub", ",", 
      RowBox[{"Table", "[", 
       RowBox[{"0", ",", 
        RowBox[{"Length", "[", "explistanub", "]"}]}], "]"}]}], "}"}]}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"yToDecayVolumeCenterExperiment", "[", 
         RowBox[{"z_", ",", "#1"}], "]"}], "=", "#2"}], ")"}], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistanub", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"23", "+", 
          FractionBox["19.5", "2."]}], ",", 
         RowBox[{"42.6", "+", 
          FractionBox["18.7", "2."]}], ",", 
         RowBox[{"61.4", "+", 
          FractionBox["18.6", "2."]}]}], "}"}]}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Inner", " ", "and", " ", "outer", " ", "radii", " ", "of", " ", "the", 
    " ", "decay", " ", 
    RowBox[{"volume", ".", " ", "Applicable"}], " ", "if", " ", "the", " ", 
    "decay", " ", "volume", " ", "has", " ", "cylindrical", " ", "geometry"}],
    "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"RinnerDecayVolumeExperiment", "[", 
      RowBox[{"exp", ",", "z_"}], "]"}], "=", "0"}], ",", 
    RowBox[{"{", 
     RowBox[{"exp", ",", "explistanub"}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"RouterDecayVolumeExperiment", "[", 
       RowBox[{"exp", ",", "z_"}], "]"}], "=", "9"}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistanub"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"z", "-", 
    RowBox[{
    "coordinate", " ", "of", " ", "the", " ", "center", " ", "of", " ", "the",
      " ", "decay", " ", "volume"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"zToDecayVolumeCenterExperiment", "[", "exp", "]"}], "=", 
      RowBox[{
       RowBox[{"zToDecayVolumeExperiment", "[", "exp", "]"}], "+", 
       FractionBox[
        RowBox[{"dzDecayVolumeExperiment", "[", "exp", "]"}], "2"]}]}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistanub"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Maximal", " ", 
    RowBox[{"long", ".", " ", "displacement"}], " ", "of", " ", "the", " ", 
    "decay", " ", "volume"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"zMaxDecayVolumeExperiment", "[", "exp", "]"}], "=", 
     RowBox[{
      RowBox[{"zToDecayVolumeExperiment", "[", "exp", "]"}], "+", 
      RowBox[{"dzDecayVolumeExperiment", "[", "exp", "]"}]}]}], ",", 
    RowBox[{"{", 
     RowBox[{"exp", ",", "explistanub"}], "}"}]}], "]"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Whether", " ", "the", " ", "decay", " ", "volume", " ", "serves", " ", 
    "as", " ", "detector", " ", 
    RowBox[{"(", 
     RowBox[{"True", " ", "or", " ", "False"}], ")"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"DecayVolumeAsDetectorExperiment", "[", "exp", "]"}], "=", 
     "\"\<False\>\""}], ",", 
    RowBox[{"{", 
     RowBox[{"exp", ",", "explistanub"}], "}"}]}], "]"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Transverse", " ", "dimensions", " ", "of", " ", "the", " ", "detector", 
    " ", "assuming", " ", "box", " ", "geometry"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MapThread", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"dxDetectorExperiment", "[", 
        RowBox[{"#1", ",", "z_"}], "]"}], "=", "#2"}], ")"}], "&"}], ",", 
    RowBox[{"{", 
     RowBox[{"explistanub", ",", 
      RowBox[{"Table", "[", 
       RowBox[{"0", ",", 
        RowBox[{"Length", "[", "explistanub", "]"}]}], "]"}]}], "}"}]}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"dyDetectorExperiment", "[", 
         RowBox[{"#1", ",", "z_"}], "]"}], "=", "#2"}], ")"}], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistanub", ",", 
       RowBox[{"Table", "[", 
        RowBox[{"0.1", ",", 
         RowBox[{"Length", "[", "explistanub", "]"}]}], "]"}]}], "}"}]}], 
    "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Length", " ", "of", " ", "the", " ", "detector", " ", "in", " ", "z", " ",
     "plane"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"dzDetectorExperiment", "[", "#1", "]"}], "=", "#2"}], ")"}], 
      "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistanub", ",", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", 
         RowBox[{"Length", "[", "explistanub", "]"}]}], "]"}]}], "}"}]}], 
    "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Coordinates", " ", "of", " ", "the", " ", "center", " ", "of", " ", "the",
     " ", "detector"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"xToDetectorCenterExperiment", "[", "exp", "]"}], "=", "0"}], 
    ",", 
    RowBox[{"{", 
     RowBox[{"exp", ",", "explistanub"}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"yToDetectorCenterExperiment", "[", "exp", "]"}], "=", 
     RowBox[{
      RowBox[{"yToDecayVolumeCenterExperiment", "[", 
       RowBox[{"z", ",", "exp"}], "]"}], "+", 
      FractionBox[
       RowBox[{"dyDecayVolumeExperiment", "[", 
        RowBox[{"z", ",", "exp"}], "]"}], "2"], "+", 
      FractionBox[
       RowBox[{"dyDetectorExperiment", "[", 
        RowBox[{"exp", ",", "z"}], "]"}], "2"]}]}], ",", 
    RowBox[{"{", 
     RowBox[{"exp", ",", "explistanub"}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"zToDetectorCenterExperiment", "[", "exp", "]"}], "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"DetectorPlaneOrientationExperiment", "[", "exp", "]"}], 
         "\[Equal]", "\"\<Transverse\>\""}], ",", 
        RowBox[{
         RowBox[{"zMaxDecayVolumeExperiment", "[", "exp", "]"}], "+", 
         FractionBox[
          RowBox[{"dzDetectorExperiment", "[", "exp", "]"}], "2"]}], ",", 
        RowBox[{
         RowBox[{"zMaxDecayVolumeExperiment", "[", "exp", "]"}], "-", 
         FractionBox[
          RowBox[{"dzDecayVolumeExperiment", "[", "exp", "]"}], "2"]}]}], 
       "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistanub"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Inner", " ", "and", " ", "outer", " ", "radii", " ", "of", " ", "the", 
    " ", "detector"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"RinnerDetectorExperiment", "[", 
      RowBox[{"exp", ",", "z_"}], "]"}], "=", "0"}], ",", 
    RowBox[{"{", 
     RowBox[{"exp", ",", "explistanub"}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"RouterDetectorExperiment", "[", 
       RowBox[{"exp", ",", "z_"}], "]"}], "=", "9"}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistanub"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Length", " ", "of", " ", "the", " ", "detector", " ", "along", " ", "the",
     " ", "detector", " ", "axis"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"dxLongDetectorExperiment", "[", "exp", "]"}], "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"DetectorPlaneOrientationExperiment", "[", "exp", "]"}], 
         "\[Equal]", "\"\<Transverse\>\""}], ",", 
        RowBox[{"dzDetectorExperiment", "[", "exp", "]"}], ",", 
        RowBox[{"dyDetectorExperiment", "[", 
         RowBox[{"exp", ",", "z"}], "]"}]}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistanub"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "The", " ", "maximal", " ", "coordinate", " ", "of", " ", "the", " ", 
    "end", " ", "of", " ", "the", " ", "detector", " ", "plane", " ", 
    RowBox[{"(", 
     RowBox[{"along", " ", "the", " ", "detector", " ", "axis"}], ")"}], " ", 
    "used", " ", "to", " ", "calculate", " ", "the", " ", "decay", " ", 
    RowBox[{"acceptance", ".", " ", "May"}], " ", "be", " ", "either", " ", 
    "the", " ", "z", " ", "coordinate", " ", "or", " ", "the", " ", "y", " ", 
    "coordinate", " ", 
    RowBox[{"(", 
     RowBox[{
     "if", " ", "the", " ", "final", " ", "detector", " ", "plane", " ", "is",
       " ", "oriented", " ", "parallel", " ", "to", " ", "the", " ", 
      "beamline"}], ")"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"xLongMaxDetectorExperiment", "[", "exp", "]"}], "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"DetectorPlaneOrientationExperiment", "[", "exp", "]"}], 
         "\[Equal]", "\"\<Transverse\>\""}], ",", 
        RowBox[{
         RowBox[{"zMaxDecayVolumeExperiment", "[", "exp", "]"}], "+", 
         RowBox[{"dxLongDetectorExperiment", "[", "exp", "]"}]}], ",", 
        RowBox[{
         RowBox[{"yToDetectorCenterExperiment", "[", "exp", "]"}], "+", 
         RowBox[{
          RowBox[{"dyDetectorExperiment", "[", 
           RowBox[{"exp", ",", "z"}], "]"}], "/", "2"}]}]}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistanub"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Position", " ", "of", " ", "the", " ", "final", " ", "plane", " ", "for", 
    " ", "the", " ", "decay", " ", "products", " ", "along", " ", "the", " ", 
    "detector", " ", "axis"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"xLongDecayProductFinalPlaneExperiment", "[", "exp", "]"}], "=", 
     RowBox[{"xLongMaxDetectorExperiment", "[", "exp", "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"exp", ",", "explistanub"}], "}"}]}], "]"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Whether", " ", "the", " ", "experiment", " ", "has", " ", "dipole", " ", 
    "magnet", " ", "in", " ", "the", " ", "detector", " ", 
    RowBox[{"(", 
     RowBox[{"True", ",", " ", "False"}], ")"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"DipoleMagnetOptionExperiment", "[", "#1", "]"}], "=", "#2"}],
        ")"}], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistanub", ",", 
       RowBox[{"Table", "[", 
        RowBox[{"\"\<False\>\"", ",", 
         RowBox[{"Length", "[", "explistanub", "]"}]}], "]"}]}], "}"}]}], 
    "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Longitudinal", " ", "positions", " ", "of", " ", "the", " ", "dipole", 
    " ", "magnet", " ", "of", " ", "the", " ", "detector"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MapThread", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"zMagnetMinExperiment", "[", "#1", "]"}], "=", "#2"}], ")"}], 
     "&"}], ",", 
    RowBox[{"{", 
     RowBox[{"explistanub", ",", 
      RowBox[{"Table", "[", 
       RowBox[{"0", ",", 
        RowBox[{"Length", "[", "explistanub", "]"}]}], "]"}]}], "}"}]}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"zMagnetMaxExperiment", "[", "#1", "]"}], "=", "#2"}], ")"}], 
      "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistanub", ",", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", 
         RowBox[{"Length", "[", "explistanub", "]"}]}], "]"}]}], "}"}]}], 
    "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Mean", " ", "magnetic", " ", "field", " ", "of", " ", "the", " ", 
    "dipole", " ", "magnet"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"MagneticFieldExperiment", "[", "#1", "]"}], "=", "#2"}], 
       ")"}], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistanub", ",", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", 
         RowBox[{"Length", "[", "explistanub", "]"}]}], "]"}]}], "}"}]}], 
    "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"ECAL", " ", "option", " ", 
    RowBox[{"(", 
     RowBox[{"True", ",", "False"}], ")"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"ECALoptionExperiment", "[", "exp", "]"}], "=", 
      "\"\<False\>\""}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistanub"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Position", " ", "of", " ", "the", " ", "beginning", " ", "of", " ", "the",
     " ", "ECAL"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"zECALminExperiment", "[", "#1", "]"}], "=", "#2"}], ")"}], 
      "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistanub", ",", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", 
         RowBox[{"Length", "[", "explistanub", "]"}]}], "]"}]}], "}"}]}], 
    "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "The", " ", "final", " ", "detector", " ", "plane", " ", "needed", " ", 
     "to", " ", "reconstruct", " ", 
     RowBox[{"muons", ".", " ", "Depeding"}], " ", "on", " ", "the", " ", 
     "experiment"}], ",", " ", 
    RowBox[{
    "it", " ", "is", " ", "approximated", " ", "by", " ", "be", " ", "end", 
     " ", "of", " ", "the", " ", "trackers", " ", "or", " ", "the", " ", 
     "muon", " ", "system"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"xLongMuonPlaneExperiment", "[", "#1", "]"}], "=", "#2"}], 
       ")"}], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistanub", ",", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"xLongMaxDetectorExperiment", "[", "exp", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"exp", ",", "explistanub"}], "}"}]}], "]"}]}], "}"}]}], 
    "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "The", " ", "final", " ", "detector", " ", "plane", " ", "needed", " ", 
     "to", " ", "reconstruct", " ", "other", " ", 
     RowBox[{"particles", ".", " ", "Depeding"}], " ", "on", " ", "the", " ", 
     "experiment"}], ",", " ", 
    RowBox[{
    "it", " ", "is", " ", "approximated", " ", "by", " ", "the", " ", "end", 
     " ", "of", " ", "the", " ", "trackers", " ", "or", " ", "the", " ", 
     "calorimeter", " ", "system"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"xLongNonMuonPlaneExperiment", "[", "#1", "]"}], "=", "#2"}], 
       ")"}], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistanub", ",", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"xLongMaxDetectorExperiment", "[", "exp", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"exp", ",", "explistanub"}], "}"}]}], "]"}]}], "}"}]}], 
    "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"List", " ", "of", " ", "detectable", " ", 
     RowBox[{"particles", ".", " ", "If"}], " ", "ECAL", " ", "is", " ", 
     "absent"}], ",", " ", 
    RowBox[{
    "it", " ", "is", " ", "assumed", " ", "by", " ", "default", " ", "that", 
     " ", "photons", " ", "and", " ", 
     SubscriptBox[
      SuperscriptBox["K", "0"], "L"], " ", "cannot", " ", "be", " ", 
     "detected"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MapThread", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"DetectablePDGsExperiment", "[", "#1", "]"}], "=", "#2"}], 
      ")"}], "&"}], ",", 
    RowBox[{"{", 
     RowBox[{"explistanub", ",", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Select", "[", 
         RowBox[{"detectablepdgs", ",", 
          RowBox[{
           RowBox[{
            RowBox[{"MemberQ", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"22.", ",", "130.", ",", "2112.", ",", 
                RowBox[{"-", "2112."}]}], "}"}], ",", "#"}], "]"}], "==", 
            "False"}], "&"}]}], "]"}], ",", 
        RowBox[{"Length", "[", "explistanub", "]"}]}], "]"}]}], "}"}]}], 
   "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.8933225363653946`*^9, 3.8933226135129232`*^9}, {
   3.893353121420885*^9, 3.893353151154543*^9}, {3.893486286173151*^9, 
   3.89348628907574*^9}, {3.893517904515644*^9, 3.893517919570837*^9}, {
   3.8935181369897656`*^9, 3.8935181369997377`*^9}, 3.893519312809658*^9, {
   3.893520126002225*^9, 3.893520169310339*^9}, 3.893520658185383*^9, 
   3.894438590486893*^9, {3.896518665648129*^9, 3.896518677847829*^9}, {
   3.8968412439715834`*^9, 3.8968412455941396`*^9}, {3.8968413782825565`*^9, 
   3.8968414068934193`*^9}, {3.896841446334216*^9, 3.8968414637767715`*^9}, {
   3.896841495076793*^9, 3.8968415784323225`*^9}, {3.8971453067807894`*^9, 
   3.897145319368409*^9}, {3.897145473924287*^9, 3.897145486933923*^9}, 
   3.89714780599074*^9, {3.9050601080852365`*^9, 3.9050601083138404`*^9}, 
   3.9102405948197384`*^9, {3.9102469736712847`*^9, 3.910246973679265*^9}, {
   3.9102542885707836`*^9, 3.9102543015785*^9}, {3.910258922454588*^9, 
   3.910258937516162*^9}, {3.9104317442877283`*^9, 3.9104317444292774`*^9}, {
   3.9104317767528086`*^9, 3.9104317859979453`*^9}, {3.9104318225804367`*^9, 
   3.9104318226629725`*^9}, {3.912056640813175*^9, 3.912056664148947*^9}, 
   3.9120572863733444`*^9, {3.9124984875205655`*^9, 3.912498490832114*^9}},
 CellLabel->
  "In[312]:=",ExpressionUUID->"2101d0ff-d2aa-4411-a167-7cad968527cd"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Cross-sections", "Subsubsection",
 CellChangeTimes->{{3.8933256308713317`*^9, 
  3.8933256323468237`*^9}},ExpressionUUID->"f32359e5-f057-4c91-8c74-\
4fd4a6b88892"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"MapThread", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"NPOTexperiment", "[", "#1", "]"}], "=", "#2"}], ")"}], "&"}], 
    ",", 
    RowBox[{"{", 
     RowBox[{"explistanub", ",", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"LLHChighLumi", "*", 
         RowBox[{"\[Sigma]ppInpbFacility", "[", "\"\<LHC\>\"", "]"}]}], ",", 
        RowBox[{"Length", "[", "explistanub", "]"}]}], "]"}]}], "}"}]}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"AtargetExperiment", "[", "#1", "]"}], "=", "#2"}], ")"}], 
      "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistanub", ",", 
       RowBox[{"Table", "[", 
        RowBox[{"1.", ",", 
         RowBox[{"Length", "[", "explistanub", "]"}]}], "]"}]}], "}"}]}], 
    "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Cascade", " ", "enhancement", " ", "of", " ", "the", " ", "production", 
    " ", "relative", " ", "to", " ", "the", " ", "production", " ", "in", " ",
     "pure", " ", "pp", " ", 
    RowBox[{"collisions", ".", " ", "Relevant"}], " ", "for", " ", "fixed", 
    " ", "target", " ", "experiments"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "For", " ", "all", " ", "experiments", " ", "located", " ", "at", " ", 
     "SPS"}], ",", " ", 
    RowBox[{
     RowBox[{
      RowBox[{
      "the", " ", "cascade", " ", "anubtors", " ", "is", " ", "taken", " ", 
       "from", " ", 
       RowBox[{"http", ":"}]}], "//", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"cds", ".", "cern", ".", "ch"}], "/", "record"}], "/", 
          "2115534"}], "/", "files"}], "/", "SHiP"}], "-", "NOTE", "-", 
       "2015", "-", 
       RowBox[{"009.", 
        RowBox[{"pdf", "?", "version"}]}]}]}], "=", "1"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"CascadeFactorbb", "[", "#1", "]"}], "=", "#2"}], ")"}], 
      "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistanub", ",", 
       RowBox[{"Table", "[", 
        RowBox[{"1.", ",", 
         RowBox[{"Length", "[", "explistanub", "]"}]}], "]"}]}], "}"}]}], 
    "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Fraction", " ", "of", " ", "produced", " ", "bb", " ", "per", " ", "PoT", 
    " ", "at", " ", "the", " ", "given", " ", "experiment"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"PppTobbExperiment", "[", "exp", "]"}], "=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"\[Sigma]ppTobbInpbFacility", "[", 
        RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}], "/", 
       RowBox[{"\[Sigma]ppInpbFacility", "[", 
        RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}]}], ")"}], 
     SuperscriptBox[
      RowBox[{"AtargetExperiment", "[", "exp", "]"}], "0.29"], "*", 
     RowBox[{"CascadeFactorbb", "[", "exp", "]"}]}]}], ",", 
   RowBox[{"{", 
    RowBox[{"exp", ",", "explistanub"}], "}"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"CascadeFactorcc", "[", "#1", "]"}], "=", "#2"}], ")"}], 
      "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistanub", ",", 
       RowBox[{"Table", "[", 
        RowBox[{"1.", ",", 
         RowBox[{"Length", "[", "explistanub", "]"}]}], "]"}]}], "}"}]}], 
    "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Fraction", " ", "of", " ", "produced", " ", "cc", " ", "per", " ", "PoT", 
    " ", "at", " ", "the", " ", "given", " ", "experiment"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"PppToccExperiment", "[", "exp", "]"}], "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"\[Sigma]ppToccInpbFacility", "[", 
         RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}], "/", 
        RowBox[{"\[Sigma]ppInpbFacility", "[", 
         RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}]}], ")"}], 
      SuperscriptBox[
       RowBox[{"AtargetExperiment", "[", "exp", "]"}], "0.29"], "*", 
      RowBox[{"CascadeFactorcc", "[", "exp", "]"}]}]}], ",", 
    RowBox[{"{", 
     RowBox[{"exp", ",", "explistanub"}], "}"}]}], "]"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Fraction", " ", "of", " ", "produced", " ", "h", " ", "per", " ", "PoT", 
    " ", "at", " ", "the", " ", "given", " ", "experiment"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"PppTohExperiment", "[", "exp", "]"}], "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"\[Sigma]ppTohInpbFacility", "[", 
          RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}], "/", 
         RowBox[{"\[Sigma]ppInpbFacility", "[", 
          RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}]}], ")"}], 
       SuperscriptBox[
        RowBox[{"AtargetExperiment", "[", "exp", "]"}], "0.29"]}]}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistanub"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Fraction", " ", "of", " ", "produced", " ", "W", " ", "per", " ", "PoT", 
    " ", "at", " ", "the", " ", "given", " ", "experiment"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"PppToWExperiment", "[", "exp", "]"}], "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"\[Sigma]ppToWInpbFacility", "[", 
          RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}], "/", 
         RowBox[{"\[Sigma]ppInpbFacility", "[", 
          RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}]}], ")"}], 
       SuperscriptBox[
        RowBox[{"AtargetExperiment", "[", "exp", "]"}], "0.29"]}]}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistanub"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Fraction", " ", "of", " ", "produced", " ", 
    SuperscriptBox["\[Pi]", "0"], " ", "per", " ", "PoT", " ", "at", " ", 
    "the", " ", "given", " ", "experiment"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"PppTo\[Pi]0exp", "[", "exp", "]"}], "=", 
      RowBox[{"PppTo\[Pi]0Facility", "[", 
       RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistanub"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Fraction", " ", "of", " ", "produced", " ", "\[Eta]", " ", "per", " ", 
    "PoT", " ", "at", " ", "the", " ", "given", " ", "experiment"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"PppTo\[Eta]exp", "[", "exp", "]"}], "=", 
      RowBox[{"PppTo\[Eta]Facility", "[", 
       RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistanub"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Fraction", " ", "of", " ", "produced", " ", 
    RowBox[{"\[Eta]", "'"}], " ", "per", " ", "PoT", " ", "at", " ", "the", 
    " ", "given", " ", "experiment"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"PppTo\[Eta]prexp", "[", "exp", "]"}], "=", 
      RowBox[{"PppTo\[Eta]prFacility", "[", 
       RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistanub"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Fraction", " ", "of", " ", "produced", " ", 
    SuperscriptBox["\[Rho]", "0"], " ", "per", " ", "PoT", " ", "at", " ", 
    "the", " ", "given", " ", "experiment"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"PppTo\[Rho]0exp", "[", "exp", "]"}], "=", 
      RowBox[{"PppTo\[Rho]0Facility", "[", 
       RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistanub"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Fraction", " ", "of", " ", "produced", " ", "\[Omega]", " ", "per", " ", 
    "PoT", " ", "at", " ", "the", " ", "given", " ", "experiment"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"PppTo\[Omega]exp", "[", "exp", "]"}], "=", 
     RowBox[{"PppTo\[Omega]Facility", "[", 
      RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"exp", ",", "explistanub"}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"PppToJpsiexp", "[", "exp", "]"}], "=", 
      RowBox[{
       RowBox[{"PppToJpsiFacility", "[", 
        RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}], 
       SuperscriptBox[
        RowBox[{"AtargetExperiment", "[", "exp", "]"}], "0.29"]}]}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistanub"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Fraction", " ", "of", " ", "produced", " ", "\[CapitalUpsilon]", 
    RowBox[{"(", 
     RowBox[{"1", "s"}], ")"}], " ", "per", " ", "PoT", " ", "at", " ", "the",
     " ", "given", " ", "experiment"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"PppToUpsilonexp", "[", "exp", "]"}], "=", 
      RowBox[{
       RowBox[{"PppToUpsilonFacility", "[", 
        RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}], 
       SuperscriptBox[
        RowBox[{"AtargetExperiment", "[", "exp", "]"}], "0.29"]}]}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistanub"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Fraction", " ", "of", " ", "produced", " ", "\[Phi]", " ", "at", " ", 
    "the", " ", "given", " ", "experiment"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"PppToPhiexp", "[", "exp", "]"}], "=", 
      RowBox[{"PppToPhiFacility", "[", 
       RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistanub"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Overall", " ", "table", " ", "with", " ", "cross"}], "-", 
    RowBox[{"sections", " ", "used", " ", "for", " ", "exporting"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"TableNumbersParticlesExperiment", "[", "exp", "]"}], "=", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "\"\<Facility\>\"", ",", "\"\<Npot\>\"", ",", "\"\<Atarget\>\"", ",", 
         "\"\<PPi0\>\"", ",", "\"\<PEta\>\"", ",", "\"\<PEtapr\>\"", ",", 
         "\"\<PRho0\>\"", ",", "\"\<POmega\>\"", ",", "\"\<Pc\>\"", ",", 
         "\"\<Pb\>\"", ",", "\"\<PW\>\"", ",", "\"\<Ph\>\"", ",", 
         "\"\<PJpsi\>\"", ",", "\"\<PUpsilon\>\"", ",", "\"\<PPhi\>\""}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"FacilityExperiment", "[", "exp", "]"}], ",", 
         RowBox[{"NPOTexperiment", "[", "exp", "]"}], ",", 
         RowBox[{"AtargetExperiment", "[", "exp", "]"}], ",", 
         RowBox[{"PppTo\[Pi]0exp", "[", "exp", "]"}], ",", 
         RowBox[{"PppTo\[Eta]exp", "[", "exp", "]"}], ",", 
         RowBox[{"PppTo\[Eta]prexp", "[", "exp", "]"}], ",", 
         RowBox[{"PppTo\[Rho]0exp", "[", "exp", "]"}], ",", 
         RowBox[{"PppTo\[Omega]exp", "[", "exp", "]"}], ",", 
         RowBox[{"2", 
          RowBox[{"PppToccExperiment", "[", "exp", "]"}]}], ",", 
         RowBox[{"2", 
          RowBox[{"PppTobbExperiment", "[", "exp", "]"}]}], ",", 
         RowBox[{"PppToWExperiment", "[", "exp", "]"}], ",", 
         RowBox[{"PppTohExperiment", "[", "exp", "]"}], ",", 
         RowBox[{"PppToJpsiexp", "[", "exp", "]"}], ",", 
         RowBox[{"PppToUpsilonexp", "[", "exp", "]"}], ",", 
         RowBox[{"PppToPhiexp", "[", "exp", "]"}]}], "}"}]}], "}"}], "//", 
     "N"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"exp", ",", "explistanub"}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.8941782014898515`*^9, 3.894178203806712*^9}, {
   3.894178687745212*^9, 3.894178689678146*^9}, {3.8972356943399086`*^9, 
   3.8972357094546494`*^9}, {3.8972861693551064`*^9, 3.897286174814681*^9}, 
   3.8991963490137434`*^9, 3.8991970589070234`*^9, {3.8991971412734256`*^9, 
   3.8991971414779043`*^9}},
 CellLabel->
  "In[347]:=",ExpressionUUID->"24079cd3-e09f-4c91-83dd-2edfd503a295"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Conditions for the LLP to decay inside the decay volume and for the products \
to point to the end of the detector\
\>", "Subsubsection",
 CellChangeTimes->{{3.905011297554874*^9, 3.9050113192993593`*^9}, 
   3.9154372086142874`*^9},ExpressionUUID->"b3931b43-f41f-4224-a220-\
2e6b485c059f"],

Cell[BoxData[
 RowBox[{"Do", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"IfLLPinsideDecVol", "[", 
      RowBox[{"zLLP_", ",", "xLLP_", ",", "yLLP_", ",", "exp"}], "]"}], "=", 
     RowBox[{"IfLLPinsideDecVolSimple", "[", "exp", "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"IfLLPtoDet", "[", 
        RowBox[{
        "x1LLPproj_", ",", "x2LLPproj_", ",", "xLongProj_", ",", "exp"}], 
        "]"}], ",", 
       RowBox[{"IfLLPnotToDet", "[", 
        RowBox[{
        "x1LLPproj_", ",", "x2LLPproj_", ",", "xLongProj_", ",", "exp"}], 
        "]"}]}], "}"}], "=", 
     RowBox[{"IfParticlePointsToDetSimple", "[", "exp", "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"IfLLPdecVolToDet", "[", 
      RowBox[{
      "zLLP_", ",", "xLLP_", ",", "yLLP_", ",", "x1LLPproj_", ",", 
       "x2LLPproj_", ",", "xLongProj_", ",", "exp"}], "]"}], "=", 
     RowBox[{
      RowBox[{"IfLLPinsideDecVol", "[", 
       RowBox[{"zLLP", ",", "xLLP", ",", "yLLP", ",", "exp"}], "]"}], "*", 
      RowBox[{"IfLLPtoDet", "[", 
       RowBox[{"x1LLPproj", ",", "x2LLPproj", ",", "xLongProj", ",", "exp"}], 
       "]"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"IfLLPdecVolNotToDet", "[", 
      RowBox[{
      "zLLP_", ",", "xLLP_", ",", "yLLP_", ",", "x1LLPproj_", ",", 
       "x2LLPproj_", ",", "xLongProj_", ",", "exp"}], "]"}], "=", 
     RowBox[{
      RowBox[{"IfLLPinsideDecVol", "[", 
       RowBox[{"zLLP", ",", "xLLP", ",", "yLLP", ",", "exp"}], "]"}], "*", 
      RowBox[{"IfLLPnotToDet", "[", 
       RowBox[{"x1LLPproj", ",", "x2LLPproj", ",", "xLongProj", ",", "exp"}], 
       "]"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"DecayAcceptanceGeometry", "[", 
      RowBox[{"coord1_", ",", "coord2_", ",", "xLongProj_", ",", "exp"}], 
      "]"}], "=", 
     RowBox[{"IfLLPtoDet", "[", 
      RowBox[{"coord1", ",", "coord2", ",", "xLongProj", ",", "exp"}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", ",", 
   RowBox[{"{", 
    RowBox[{"exp", ",", "explistanub"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.9050145578191566`*^9, 3.9050145585609236`*^9}, 
   3.9050171518838434`*^9, {3.9050593918205132`*^9, 3.9050593920062027`*^9}, {
   3.910258574529563*^9, 3.9102586409354057`*^9}, 3.9102588184981537`*^9, 
   3.910259935688154*^9, {3.915437006963789*^9, 3.9154370915128546`*^9}, {
   3.915437208635974*^9, 3.9154372087109804`*^9}},
 CellLabel->
  "In[364]:=",ExpressionUUID->"d58ac2db-c71a-4ff7-8ca2-5ab7d9cc241c"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["HIKE/NA62 ", "Subsection",
 CellChangeTimes->{{3.893322632613366*^9, 3.893322632902053*^9}, {
   3.893323433966797*^9, 3.8933234359499726`*^9}, {3.893323859392882*^9, 
   3.8933238622023697`*^9}, 3.9028122208007755`*^9, {3.9104237804017363`*^9, 
   3.9104237906506467`*^9}},ExpressionUUID->"e91bc72f-65b4-4d01-b674-\
6e73645d1443"],

Cell[CellGroupData[{

Cell["Geometry (mostly taken from ALPINIST)", "Subsubsection",
 CellChangeTimes->{{3.893342623432827*^9, 3.893342624458*^9}, {
  3.9104237913243184`*^9, 
  3.9104237920647345`*^9}},ExpressionUUID->"fc70ba2e-bd2c-40fc-972b-\
2cabae35b823"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"HIKE", "-", 
    RowBox[{"dump", ":", " ", 
     RowBox[{"the", " ", "same", " ", "design", " ", "as", " ", "NA62"}]}]}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"explisthike", "=", 
     RowBox[{"{", 
      RowBox[{"\"\<HIKE-dump\>\"", ",", "\"\<NA62-dump\>\""}], "}"}]}], ";"}],
    "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Distance", " ", "to", " ", "the", " ", "fiducial", " ", "volume", " ", 
     "along", " ", "the", " ", "beamline", " ", 
     RowBox[{"axis", ".", " ", 
      RowBox[{"MapThread", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"list1", "[", "#", "]"}], "=", "#2"}], ")"}], "&"}], ",", 
        RowBox[{"{", 
         RowBox[{"listexp", ",", "listvals"}], "}"}]}], "]"}]}], " ", 
     "equates", " ", "the", " ", "elements", " ", "list1", " ", "with", " ", 
     "keys", " ", "from", " ", "listexp", " ", "to", " ", "the", " ", 
     "corresponding", " ", "elements", " ", "of", " ", "the", " ", "list", 
     " ", "listvals"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MapThread", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"zToDecayVolumeExperiment", "[", "#1", "]"}], "=", "#2"}], 
        ")"}], "&"}], ",", 
      RowBox[{"{", 
       RowBox[{"explisthike", ",", 
        RowBox[{"{", 
         RowBox[{"80.575", ",", "80.575"}], "}"}]}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Detector", " ", "has", " ", "the", " ", "axis", " ", "along", " ", 
     "which", " ", "its", " ", "components", " ", "are", " ", 
     RowBox[{"placed", ".", " ", "The"}], " ", "option", " ", "below", " ", 
     "defines", " ", "the", " ", "orientation", " ", "of", " ", "the", " ", 
     "final", " ", "plane", " ", "transverse", " ", "to", " ", "this", " ", 
     "axis", " ", "relative", " ", "to", " ", "the", " ", "beamline"}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "Transverse", " ", "if", " ", "the", " ", "plane", " ", "is", " ", 
      "tranverse", " ", 
      RowBox[{"(", 
       RowBox[{"SHiP", ",", " ", 
        RowBox[{"HIKE", " ", "etc"}]}], ")"}]}], ",", " ", 
     RowBox[{
     "and", " ", "Parallel", " ", "if", " ", "it", " ", "is", " ", "parallel",
       " ", 
      RowBox[{"(", 
       RowBox[{"MATHUSLA", ",", " ", "ANUBIS"}]}]}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MapThread", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"DetectorPlaneOrientationExperiment", "[", "#1", "]"}], "=", 
         "#2"}], ")"}], "&"}], ",", 
      RowBox[{"{", 
       RowBox[{"explisthike", ",", 
        RowBox[{"Table", "[", 
         RowBox[{"\"\<Transverse\>\"", ",", 
          RowBox[{"Length", "[", "explisthike", "]"}]}], "]"}]}], "}"}]}], 
     "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Facility", " ", "hosting", " ", "the", " ", 
      RowBox[{"experiment", ":", " ", "SPS"}]}], ",", " ", "Fermilab", ",", 
     " ", "LHC", ",", " ", 
     RowBox[{"FCC", "-", "hh"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MapThread", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"FacilityExperiment", "[", "#1", "]"}], "=", "#2"}], ")"}], 
       "&"}], ",", 
      RowBox[{"{", 
       RowBox[{"explisthike", ",", 
        RowBox[{"Table", "[", 
         RowBox[{"\"\<SPS\>\"", ",", 
          RowBox[{"Length", "[", "explisthike", "]"}]}], "]"}]}], "}"}]}], 
     "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Geometry", " ", "of", " ", "the", " ", 
      RowBox[{"experiment", ":", " ", "box"}]}], ",", " ", "cylinder", ",", 
     " ", 
     RowBox[{"annular", " ", "cylinder"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MapThread", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"GeometryExperiment", "[", "#1", "]"}], "=", "#2"}], ")"}], 
       "&"}], ",", 
      RowBox[{"{", 
       RowBox[{"explisthike", ",", 
        RowBox[{"Table", "[", 
         RowBox[{"\"\<Annular cylinder\>\"", ",", 
          RowBox[{"Length", "[", "explisthike", "]"}]}], "]"}]}], "}"}]}], 
     "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "Transverse", " ", "dimensions", " ", "of", " ", "the", " ", "decay", 
      " ", "volume", " ", "assuming", " ", "box", " ", "geometry"}], ",", " ", 
     RowBox[{
     "or", " ", "cylindrical", " ", "geometry", " ", "if", " ", "the", " ", 
      "detector", " ", "plane", " ", "is", " ", "parallel", " ", "to", " ", 
      "the", " ", "beamline", " ", 
      RowBox[{
       RowBox[{"(", "ANUBIS", ")"}], ".", " ", "Otherwise"}], " ", "set", " ",
       "to", " ", "zero"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MapThread", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"dxDecayVolumeExperiment", "[", 
          RowBox[{"z_", ",", "#1"}], "]"}], "=", "#2"}], ")"}], "&"}], ",", 
      RowBox[{"{", 
       RowBox[{"explisthike", ",", 
        RowBox[{"Table", "[", 
         RowBox[{"0", ",", 
          RowBox[{"Length", "[", "explisthike", "]"}]}], "]"}]}], "}"}]}], 
     "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MapThread", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"dyDecayVolumeExperiment", "[", 
          RowBox[{"z_", ",", "#1"}], "]"}], "=", "#2"}], ")"}], "&"}], ",", 
      RowBox[{"{", 
       RowBox[{"explisthike", ",", 
        RowBox[{"Table", "[", 
         RowBox[{"0", ",", 
          RowBox[{"Length", "[", "explisthike", "]"}]}], "]"}]}], "}"}]}], 
     "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Decay", " ", "volume", " ", "length", " ", "along", " ", "the", " ", 
     "beamline", " ", "axis"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MapThread", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"dzDecayVolumeExperiment", "[", "#1", "]"}], "=", "#2"}], 
        ")"}], "&"}], ",", 
      RowBox[{"{", 
       RowBox[{"explisthike", ",", 
        RowBox[{"{", 
         RowBox[{"81.", ",", "81."}], "}"}]}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "Distance", " ", "from", " ", "the", " ", "beamline", " ", "to", " ", 
      "the", " ", "decay", " ", "volume", " ", "center", " ", "and", " ", 
      "detector", " ", "along", " ", "the", " ", "x"}], ",", 
     RowBox[{"y", " ", "axes"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MapThread", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"xToDecayVolumeCenterExperiment", "[", 
          RowBox[{"z_", ",", "#1"}], "]"}], "=", "#2"}], ")"}], "&"}], ",", 
      RowBox[{"{", 
       RowBox[{"explisthike", ",", 
        RowBox[{"Table", "[", 
         RowBox[{"0", ",", 
          RowBox[{"Length", "[", "explisthike", "]"}]}], "]"}]}], "}"}]}], 
     "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MapThread", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"yToDecayVolumeCenterExperiment", "[", 
          RowBox[{"z_", ",", "#1"}], "]"}], "=", "#2"}], ")"}], "&"}], ",", 
      RowBox[{"{", 
       RowBox[{"explisthike", ",", 
        RowBox[{"Table", "[", 
         RowBox[{"0", ",", 
          RowBox[{"Length", "[", "explisthike", "]"}]}], "]"}]}], "}"}]}], 
     "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Inner", " ", "and", " ", "outer", " ", "radii", " ", "of", " ", "the", 
     " ", "decay", " ", 
     RowBox[{"volume", ".", " ", "Applicable"}], " ", "if", " ", "the", " ", 
     "decay", " ", "volume", " ", "has", " ", "cylindrical", " ", 
     "geometry"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MapThread", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"RinnerDecayVolumeExperiment", "[", 
          RowBox[{"#1", ",", "z_"}], "]"}], "=", "#2"}], ")"}], "&"}], ",", 
      RowBox[{"{", 
       RowBox[{"explisthike", ",", 
        RowBox[{"Table", "[", 
         RowBox[{"0.08", ",", 
          RowBox[{"Length", "[", "explisthike", "]"}]}], "]"}]}], "}"}]}], 
     "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MapThread", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"RouterDecayVolumeExperiment", "[", 
          RowBox[{"#1", ",", "z_"}], "]"}], "=", "#2"}], ")"}], "&"}], ",", 
      RowBox[{"{", 
       RowBox[{"explisthike", ",", 
        RowBox[{"{", 
         RowBox[{"1", ",", "1"}], "}"}]}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"z", "-", 
     RowBox[{
     "coordinate", " ", "of", " ", "the", " ", "center", " ", "of", " ", 
      "the", " ", "decay", " ", "volume"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"zToDecayVolumeCenterExperiment", "[", "exp", "]"}], "=", 
       RowBox[{
        RowBox[{"zToDecayVolumeExperiment", "[", "exp", "]"}], "+", 
        FractionBox[
         RowBox[{"dzDecayVolumeExperiment", "[", "exp", "]"}], "2"]}]}], ",", 
      RowBox[{"{", 
       RowBox[{"exp", ",", "explisthike"}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Maximal", " ", 
     RowBox[{"long", ".", " ", "displacement"}], " ", "of", " ", "the", " ", 
     "decay", " ", "volume"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"zMaxDecayVolumeExperiment", "[", "exp", "]"}], "=", 
      RowBox[{
       RowBox[{"zToDecayVolumeExperiment", "[", "exp", "]"}], "+", 
       RowBox[{"dzDecayVolumeExperiment", "[", "exp", "]"}]}]}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explisthike"}], "}"}]}], "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Whether", " ", "the", " ", "decay", " ", "volume", " ", "serves", " ", 
     "as", " ", "detector", " ", 
     RowBox[{"(", 
      RowBox[{"True", " ", "or", " ", "False"}], ")"}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"DecayVolumeAsDetectorExperiment", "[", "exp", "]"}], "=", 
      "\"\<False\>\""}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explisthike"}], "}"}]}], "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Transverse", " ", "dimensions", " ", "of", " ", "the", " ", "detector", 
     " ", "assuming", " ", "box", " ", "geometry"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MapThread", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"dxDetectorExperiment", "[", 
          RowBox[{"#1", ",", "z_"}], "]"}], "=", "#2"}], ")"}], "&"}], ",", 
      RowBox[{"{", 
       RowBox[{"explisthike", ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0"}], "}"}]}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MapThread", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"dyDetectorExperiment", "[", 
          RowBox[{"#1", ",", "z_"}], "]"}], "=", "#2"}], ")"}], "&"}], ",", 
      RowBox[{"{", 
       RowBox[{"explisthike", ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0"}], "}"}]}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Length", " ", "of", " ", "the", " ", "detector", " ", "in", " ", "z", 
     " ", "plane"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MapThread", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"dzDetectorExperiment", "[", "#1", "]"}], "=", "#2"}], ")"}],
        "&"}], ",", 
      RowBox[{"{", 
       RowBox[{"explisthike", ",", 
        RowBox[{"{", 
         RowBox[{"63.85", ",", "63.85"}], "}"}]}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Coordinates", " ", "of", " ", "the", " ", "center", " ", "of", " ", 
     "the", " ", "detector"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"xToDetectorCenterExperiment", "[", "exp", "]"}], "=", "0"}], 
      ",", 
      RowBox[{"{", 
       RowBox[{"exp", ",", "explisthike"}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"yToDetectorCenterExperiment", "[", "exp", "]"}], "=", "0"}], 
      ",", 
      RowBox[{"{", 
       RowBox[{"exp", ",", "explisthike"}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"zToDetectorCenterExperiment", "[", "exp", "]"}], "=", 
       RowBox[{
        RowBox[{"zMaxDecayVolumeExperiment", "[", "exp", "]"}], "+", 
        FractionBox[
         RowBox[{"dzDetectorExperiment", "[", "exp", "]"}], "2"]}]}], ",", 
      RowBox[{"{", 
       RowBox[{"exp", ",", "explisthike"}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Inner", " ", "and", " ", "outer", " ", "radii", " ", "of", " ", "the", 
     " ", "detector"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MapThread", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"RinnerDetectorExperiment", "[", 
          RowBox[{"#1", ",", "z_"}], "]"}], "=", "#2"}], ")"}], "&"}], ",", 
      RowBox[{"{", 
       RowBox[{"explisthike", ",", 
        RowBox[{"Table", "[", 
         RowBox[{"0.08", ",", 
          RowBox[{"Length", "[", "explisthike", "]"}]}], "]"}]}], "}"}]}], 
     "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MapThread", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"RouterDetectorExperiment", "[", 
          RowBox[{"#1", ",", "z_"}], "]"}], "=", "#2"}], ")"}], "&"}], ",", 
      RowBox[{"{", 
       RowBox[{"explisthike", ",", 
        RowBox[{"{", 
         RowBox[{"1.15", ",", "1.15"}], "}"}]}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Length", " ", "of", " ", "the", " ", "detector", " ", "along", " ", 
     "the", " ", "detector", " ", "axis"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"dxLongDetectorExperiment", "[", "exp", "]"}], "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"DetectorPlaneOrientationExperiment", "[", "exp", "]"}], 
          "\[Equal]", "\"\<Transverse\>\""}], ",", 
         RowBox[{"dzDetectorExperiment", "[", "exp", "]"}], ",", 
         RowBox[{"dyDetectorExperiment", "[", "exp", "]"}]}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"exp", ",", "explisthike"}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "The", " ", "maximal", " ", "coordinate", " ", "of", " ", "the", " ", 
     "end", " ", "of", " ", "the", " ", "detector", " ", "plane", " ", 
     RowBox[{"(", 
      RowBox[{"along", " ", "the", " ", "detector", " ", "axis"}], ")"}], " ",
      "used", " ", "to", " ", "calculate", " ", "the", " ", "decay", " ", 
     RowBox[{"acceptance", ".", " ", "May"}], " ", "be", " ", "either", " ", 
     "the", " ", "z", " ", "coordinate", " ", "or", " ", "the", " ", "y", " ",
      "coordinate", " ", 
     RowBox[{"(", 
      RowBox[{
      "if", " ", "the", " ", "final", " ", "detector", " ", "plane", " ", 
       "is", " ", "oriented", " ", "parallel", " ", "to", " ", "the", " ", 
       "beamline"}], ")"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"xLongMaxDetectorExperiment", "[", "exp", "]"}], "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"DetectorPlaneOrientationExperiment", "[", "exp", "]"}], 
          "\[Equal]", "\"\<Transverse\>\""}], ",", 
         RowBox[{
          RowBox[{"zMaxDecayVolumeExperiment", "[", "exp", "]"}], "+", 
          RowBox[{"dxLongDetectorExperiment", "[", "exp", "]"}]}], ",", 
         RowBox[{
          RowBox[{"yToDetectorCenterExperiment", "[", "exp", "]"}], "+", 
          RowBox[{
           RowBox[{"dyDetectorExperiment", "[", "exp", "]"}], "/", "2"}]}]}], 
        "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"exp", ",", "explisthike"}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Position", " ", "of", " ", "the", " ", "final", " ", "plane", " ", "for",
      " ", "the", " ", "decay", " ", "products", " ", "along", " ", "the", 
     " ", "detector", " ", "axis"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"xLongDecayProductFinalPlaneExperiment", "[", "exp", "]"}], "=", 
      RowBox[{"xLongMaxDetectorExperiment", "[", "exp", "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explisthike"}], "}"}]}], "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Whether", " ", "the", " ", "experiment", " ", "has", " ", "dipole", " ", 
     "magnet", " ", "in", " ", "the", " ", "detector", " ", 
     RowBox[{"(", 
      RowBox[{"True", ",", " ", "False"}], ")"}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MapThread", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"DipoleMagnetOptionExperiment", "[", "#1", "]"}], "=", 
         "#2"}], ")"}], "&"}], ",", 
      RowBox[{"{", 
       RowBox[{"explisthike", ",", 
        RowBox[{"Table", "[", 
         RowBox[{"\"\<False\>\"", ",", 
          RowBox[{"Length", "[", "explisthike", "]"}]}], "]"}]}], "}"}]}], 
     "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Longitudinal", " ", "positions", " ", "of", " ", "the", " ", "dipole", 
     " ", "magnet", " ", "of", " ", "the", " ", "detector"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MapThread", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"zMagnetMinExperiment", "[", "#1", "]"}], "=", "#2"}], ")"}],
        "&"}], ",", 
      RowBox[{"{", 
       RowBox[{"explisthike", ",", 
        RowBox[{"Table", "[", 
         RowBox[{"0", ",", 
          RowBox[{"Length", "[", "explisthike", "]"}]}], "]"}]}], "}"}]}], 
     "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MapThread", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"zMagnetMaxExperiment", "[", "#1", "]"}], "=", "#2"}], ")"}],
        "&"}], ",", 
      RowBox[{"{", 
       RowBox[{"explisthike", ",", 
        RowBox[{"Table", "[", 
         RowBox[{"0", ",", 
          RowBox[{"Length", "[", "explisthike", "]"}]}], "]"}]}], "}"}]}], 
     "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Mean", " ", "magnetic", " ", "field", " ", "of", " ", "the", " ", 
     "dipole", " ", "magnet"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MapThread", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"MagneticFieldExperiment", "[", "#1", "]"}], "=", "#2"}], 
        ")"}], "&"}], ",", 
      RowBox[{"{", 
       RowBox[{"explisthike", ",", 
        RowBox[{"Table", "[", 
         RowBox[{"0", ",", 
          RowBox[{"Length", "[", "explisthike", "]"}]}], "]"}]}], "}"}]}], 
     "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"ECAL", " ", "option", " ", 
     RowBox[{"(", 
      RowBox[{"True", ",", "False"}], ")"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"ECALoptionExperiment", "[", "exp", "]"}], "=", 
       "\"\<True\>\""}], ",", 
      RowBox[{"{", 
       RowBox[{"exp", ",", "explisthike"}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Position", " ", "of", " ", "the", " ", "beginning", " ", "of", " ", 
     "the", " ", "ECAL"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MapThread", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"zECALminExperiment", "[", "#1", "]"}], "=", "#2"}], ")"}], 
       "&"}], ",", 
      RowBox[{"{", 
       RowBox[{"explisthike", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"241.495", "-", "23.07"}], ",", 
          RowBox[{"241.495", "-", "23.07"}]}], "}"}]}], "}"}]}], "]"}], ";"}],
    "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "The", " ", "final", " ", "detector", " ", "plane", " ", "needed", " ", 
      "to", " ", "reconstruct", " ", 
      RowBox[{"muons", ".", " ", "Depeding"}], " ", "on", " ", "the", " ", 
      "experiment"}], ",", " ", 
     RowBox[{
     "it", " ", "is", " ", "approximated", " ", "by", " ", "be", " ", "end", 
      " ", "of", " ", "the", " ", "trackers", " ", "or", " ", "the", " ", 
      "muon", " ", "system"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MapThread", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"xLongMuonPlaneExperiment", "[", "#1", "]"}], "=", "#2"}], 
        ")"}], "&"}], ",", 
      RowBox[{"{", 
       RowBox[{"explisthike", ",", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"xLongMaxDetectorExperiment", "[", "exp", "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"exp", ",", "explisthike"}], "}"}]}], "]"}]}], "}"}]}], 
     "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "The", " ", "final", " ", "detector", " ", "plane", " ", "needed", " ", 
      "to", " ", "reconstruct", " ", "other", " ", 
      RowBox[{"particles", ".", " ", "Depeding"}], " ", "on", " ", "the", " ",
       "experiment"}], ",", " ", 
     RowBox[{
     "it", " ", "is", " ", "approximated", " ", "by", " ", "the", " ", "end", 
      " ", "of", " ", "the", " ", "trackers", " ", "or", " ", "the", " ", 
      "calorimeter", " ", "system"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MapThread", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"xLongNonMuonPlaneExperiment", "[", "#1", "]"}], "=", "#2"}],
         ")"}], "&"}], ",", 
      RowBox[{"{", 
       RowBox[{"explisthike", ",", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"xLongMaxDetectorExperiment", "[", "exp", "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"exp", ",", "explisthike"}], "}"}]}], "]"}]}], "}"}]}], 
     "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"List", " ", "of", " ", "detectable", " ", 
      RowBox[{"particles", ".", " ", "If"}], " ", "ECAL", " ", "is", " ", 
      "absent"}], ",", " ", 
     RowBox[{
     "it", " ", "is", " ", "assumed", " ", "by", " ", "default", " ", "that", 
      " ", "photons", " ", "and", " ", 
      SubscriptBox[
       SuperscriptBox["K", "0"], "L"], " ", "cannot", " ", "be", " ", 
      "detected"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MapThread", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"DetectablePDGsExperiment", "[", "#1", "]"}], "=", "#2"}], 
        ")"}], "&"}], ",", 
      RowBox[{"{", 
       RowBox[{"explisthike", ",", 
        RowBox[{"Table", "[", 
         RowBox[{"detectablepdgs", ",", 
          RowBox[{"Length", "[", "explisthike", "]"}]}], "]"}]}], "}"}]}], 
     "]"}], ";"}]}]}]], "Input",
 CellChangeTimes->{
  3.8933238576202545`*^9, {3.8934862861791763`*^9, 3.8934862890797586`*^9}, {
   3.893518137006751*^9, 3.893518137013754*^9}, 3.893519312816601*^9, {
   3.893520126006219*^9, 3.893520169315365*^9}, 3.8935206581913896`*^9, 
   3.8944385905107555`*^9, {3.897145306802526*^9, 3.897145319374401*^9}, {
   3.8971454739303074`*^9, 3.897145486939665*^9}, {3.8974915152136407`*^9, 
   3.897491538654114*^9}, {3.897493617888881*^9, 3.8974936483101587`*^9}, {
   3.9025526889169674`*^9, 3.9025527112810163`*^9}, {3.902552873850831*^9, 
   3.9025529826411743`*^9}, {3.9025531396064706`*^9, 3.902553142383655*^9}, {
   3.9025532210809126`*^9, 3.902553224811249*^9}, {3.90506011688433*^9, 
   3.905060126774513*^9}, 3.910240594844119*^9, {3.910246973692377*^9, 
   3.9102469737031236`*^9}, {3.9102543086182175`*^9, 3.910254320178464*^9}, {
   3.910254581131772*^9, 3.910254587078209*^9}, {3.910258956519701*^9, 
   3.910258960262476*^9}, {3.910423635828747*^9, 3.9104236389927874`*^9}, {
   3.910423669212734*^9, 3.9104236725117846`*^9}, {3.910423719798468*^9, 
   3.910423728883127*^9}, {3.9104237764432*^9, 3.9104238020904026`*^9}, 
   3.9104238326995707`*^9, {3.910424101153369*^9, 3.9104241013014812`*^9}, {
   3.912056684433223*^9, 3.912056715473169*^9}, 3.912057281028432*^9},
 CellLabel->
  "In[365]:=",ExpressionUUID->"5c05308b-f131-4153-91dc-c3c157e191e0"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Cross-sections", "Subsubsection",
 CellChangeTimes->{{3.8933256308713317`*^9, 
  3.8933256323468237`*^9}},ExpressionUUID->"90d9d384-18d1-448e-b197-\
bcf497d3e652"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"MapThread", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"NPOTexperiment", "[", "#1", "]"}], "=", "#2"}], ")"}], "&"}], 
    ",", 
    RowBox[{"{", 
     RowBox[{"explisthike", ",", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"5.", "*", 
         SuperscriptBox["10", "19"]}], ",", 
        RowBox[{"Length", "[", "explisthike", "]"}]}], "]"}]}], "}"}]}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"AtargetExperiment", "[", "#1", "]"}], "=", "#2"}], ")"}], 
      "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explisthike", ",", 
       RowBox[{"Table", "[", 
        RowBox[{"64.", ",", 
         RowBox[{"Length", "[", "explisthike", "]"}]}], "]"}]}], "}"}]}], 
    "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Cascade", " ", "enhancement", " ", "of", " ", "the", " ", "production", 
    " ", "relative", " ", "to", " ", "the", " ", "production", " ", "in", " ",
     "pure", " ", "pp", " ", 
    RowBox[{"collisions", ".", " ", "Relevant"}], " ", "for", " ", "fixed", 
    " ", "target", " ", "experiments"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "For", " ", "all", " ", "experiments", " ", "located", " ", "at", " ", 
     "SPS"}], ",", " ", 
    RowBox[{
     RowBox[{
      RowBox[{
      "the", " ", "cascade", " ", "hiketors", " ", "is", " ", "taken", " ", 
       "from", " ", 
       RowBox[{"http", ":"}]}], "//", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"cds", ".", "cern", ".", "ch"}], "/", "record"}], "/", 
          "2115534"}], "/", "files"}], "/", "SHiP"}], "-", "NOTE", "-", 
       "2015", "-", 
       RowBox[{"009.", 
        RowBox[{"pdf", "?", "version"}]}]}]}], "=", "1"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"CascadeFactorbb", "[", "#1", "]"}], "=", "#2"}], ")"}], 
      "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explisthike", ",", 
       RowBox[{"Table", "[", 
        RowBox[{"1.7", ",", 
         RowBox[{"Length", "[", "explisthike", "]"}]}], "]"}]}], "}"}]}], 
    "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Fraction", " ", "of", " ", "produced", " ", "bb", " ", "per", " ", "PoT", 
    " ", "at", " ", "the", " ", "given", " ", "experiment"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"PppTobbExperiment", "[", "exp", "]"}], "=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"\[Sigma]ppTobbInpbFacility", "[", 
        RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}], "/", 
       RowBox[{"\[Sigma]ppInpbFacility", "[", 
        RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}]}], ")"}], 
     SuperscriptBox[
      RowBox[{"AtargetExperiment", "[", "exp", "]"}], "0.29"], "*", 
     RowBox[{"CascadeFactorbb", "[", "exp", "]"}]}]}], ",", 
   RowBox[{"{", 
    RowBox[{"exp", ",", "explisthike"}], "}"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"CascadeFactorcc", "[", "#1", "]"}], "=", "#2"}], ")"}], 
      "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explisthike", ",", 
       RowBox[{"Table", "[", 
        RowBox[{"2.3", ",", 
         RowBox[{"Length", "[", "explisthike", "]"}]}], "]"}]}], "}"}]}], 
    "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Fraction", " ", "of", " ", "produced", " ", "cc", " ", "per", " ", "PoT", 
    " ", "at", " ", "the", " ", "given", " ", "experiment"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"PppToccExperiment", "[", "exp", "]"}], "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"\[Sigma]ppToccInpbFacility", "[", 
         RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}], "/", 
        RowBox[{"\[Sigma]ppInpbFacility", "[", 
         RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}]}], ")"}], 
      SuperscriptBox[
       RowBox[{"AtargetExperiment", "[", "exp", "]"}], "0.29"], "*", 
      RowBox[{"CascadeFactorcc", "[", "exp", "]"}]}]}], ",", 
    RowBox[{"{", 
     RowBox[{"exp", ",", "explisthike"}], "}"}]}], "]"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Fraction", " ", "of", " ", "produced", " ", "h", " ", "per", " ", "PoT", 
    " ", "at", " ", "the", " ", "given", " ", "experiment"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"PppTohExperiment", "[", "exp", "]"}], "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"\[Sigma]ppTohInpbFacility", "[", 
          RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}], "/", 
         RowBox[{"\[Sigma]ppInpbFacility", "[", 
          RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}]}], ")"}], 
       SuperscriptBox[
        RowBox[{"AtargetExperiment", "[", "exp", "]"}], "0.29"]}]}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explisthike"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Fraction", " ", "of", " ", "produced", " ", "W", " ", "per", " ", "PoT", 
    " ", "at", " ", "the", " ", "given", " ", "experiment"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"PppToWExperiment", "[", "exp", "]"}], "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"\[Sigma]ppToWInpbFacility", "[", 
          RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}], "/", 
         RowBox[{"\[Sigma]ppInpbFacility", "[", 
          RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}]}], ")"}], 
       SuperscriptBox[
        RowBox[{"AtargetExperiment", "[", "exp", "]"}], "0.29"]}]}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explisthike"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Fraction", " ", "of", " ", "produced", " ", 
    SuperscriptBox["\[Pi]", "0"], " ", "per", " ", "PoT", " ", "at", " ", 
    "the", " ", "given", " ", "experiment"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"PppTo\[Pi]0exp", "[", "exp", "]"}], "=", 
      RowBox[{"PppTo\[Pi]0Facility", "[", 
       RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explisthike"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Fraction", " ", "of", " ", "produced", " ", "\[Eta]", " ", "per", " ", 
    "PoT", " ", "at", " ", "the", " ", "given", " ", "experiment"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"PppTo\[Eta]exp", "[", "exp", "]"}], "=", 
      RowBox[{"PppTo\[Eta]Facility", "[", 
       RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explisthike"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Fraction", " ", "of", " ", "produced", " ", 
    RowBox[{"\[Eta]", "'"}], " ", "per", " ", "PoT", " ", "at", " ", "the", 
    " ", "given", " ", "experiment"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"PppTo\[Eta]prexp", "[", "exp", "]"}], "=", 
      RowBox[{"PppTo\[Eta]prFacility", "[", 
       RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explisthike"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Fraction", " ", "of", " ", "produced", " ", 
    SuperscriptBox["\[Rho]", "0"], " ", "per", " ", "PoT", " ", "at", " ", 
    "the", " ", "given", " ", "experiment"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"PppTo\[Rho]0exp", "[", "exp", "]"}], "=", 
      RowBox[{"PppTo\[Rho]0Facility", "[", 
       RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explisthike"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Fraction", " ", "of", " ", "produced", " ", "\[Omega]", " ", "per", " ", 
    "PoT", " ", "at", " ", "the", " ", "given", " ", "experiment"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"PppTo\[Omega]exp", "[", "exp", "]"}], "=", 
     RowBox[{"PppTo\[Omega]Facility", "[", 
      RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"exp", ",", "explisthike"}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"PppToJpsiexp", "[", "exp", "]"}], "=", 
      RowBox[{
       RowBox[{"PppToJpsiFacility", "[", 
        RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}], 
       SuperscriptBox[
        RowBox[{"AtargetExperiment", "[", "exp", "]"}], "0.29"]}]}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explisthike"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Fraction", " ", "of", " ", "produced", " ", "\[CapitalUpsilon]", 
    RowBox[{"(", 
     RowBox[{"1", "s"}], ")"}], " ", "per", " ", "PoT", " ", "at", " ", "the",
     " ", "given", " ", "experiment"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"PppToUpsilonexp", "[", "exp", "]"}], "=", 
      RowBox[{
       RowBox[{"PppToUpsilonFacility", "[", 
        RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}], 
       SuperscriptBox[
        RowBox[{"AtargetExperiment", "[", "exp", "]"}], "0.29"]}]}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explisthike"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Fraction", " ", "of", " ", "produced", " ", "\[Phi]", " ", "at", " ", 
    "the", " ", "given", " ", "experiment"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"PppToPhiexp", "[", "exp", "]"}], "=", 
      RowBox[{"PppToPhiFacility", "[", 
       RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explisthike"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Overall", " ", "table", " ", "with", " ", "cross"}], "-", 
    RowBox[{"sections", " ", "used", " ", "for", " ", "exporting"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"TableNumbersParticlesExperiment", "[", "exp", "]"}], "=", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "\"\<Facility\>\"", ",", "\"\<Npot\>\"", ",", "\"\<Atarget\>\"", ",", 
         "\"\<PPi0\>\"", ",", "\"\<PEta\>\"", ",", "\"\<PEtapr\>\"", ",", 
         "\"\<PRho0\>\"", ",", "\"\<POmega\>\"", ",", "\"\<Pc\>\"", ",", 
         "\"\<Pb\>\"", ",", "\"\<PW\>\"", ",", "\"\<Ph\>\"", ",", 
         "\"\<PJpsi\>\"", ",", "\"\<PUpsilon\>\"", ",", "\"\<PPhi\>\""}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"FacilityExperiment", "[", "exp", "]"}], ",", 
         RowBox[{"NPOTexperiment", "[", "exp", "]"}], ",", 
         RowBox[{"AtargetExperiment", "[", "exp", "]"}], ",", 
         RowBox[{"PppTo\[Pi]0exp", "[", "exp", "]"}], ",", 
         RowBox[{"PppTo\[Eta]exp", "[", "exp", "]"}], ",", 
         RowBox[{"PppTo\[Eta]prexp", "[", "exp", "]"}], ",", 
         RowBox[{"PppTo\[Rho]0exp", "[", "exp", "]"}], ",", 
         RowBox[{"PppTo\[Omega]exp", "[", "exp", "]"}], ",", 
         RowBox[{"2", 
          RowBox[{"PppToccExperiment", "[", "exp", "]"}]}], ",", 
         RowBox[{"2", 
          RowBox[{"PppTobbExperiment", "[", "exp", "]"}]}], ",", 
         RowBox[{"PppToWExperiment", "[", "exp", "]"}], ",", 
         RowBox[{"PppTohExperiment", "[", "exp", "]"}], ",", 
         RowBox[{"PppToJpsiexp", "[", "exp", "]"}], ",", 
         RowBox[{"PppToUpsilonexp", "[", "exp", "]"}], ",", 
         RowBox[{"PppToPhiexp", "[", "exp", "]"}]}], "}"}]}], "}"}], "//", 
     "N"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"exp", ",", "explisthike"}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.894178209172798*^9, 3.894178211713565*^9}, {
   3.894178695923007*^9, 3.8941786985033507`*^9}, {3.8972357152237234`*^9, 
   3.8972357293950524`*^9}, {3.8972861801880093`*^9, 3.897286186967156*^9}, 
   3.89919635773567*^9, 3.899197064828128*^9, {3.8991971414838886`*^9, 
   3.8991971416884794`*^9}, {3.91042410706318*^9, 3.9104241140468245`*^9}},
 CellLabel->
  "In[400]:=",ExpressionUUID->"941f964a-2e08-45e4-98b0-bf1004d95266"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Conditions for the LLP to decay inside the decay volume and for the products \
to point to the end of the detector\
\>", "Subsubsection",
 CellChangeTimes->{{3.905011297554874*^9, 3.9050113192993593`*^9}, 
   3.915437208718361*^9},ExpressionUUID->"2db17720-67df-4b6b-b5e7-\
00b6ff9d69f7"],

Cell[BoxData[
 RowBox[{"Do", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"IfLLPinsideDecVol", "[", 
      RowBox[{"zLLP_", ",", "xLLP_", ",", "yLLP_", ",", "exp"}], "]"}], "=", 
     RowBox[{"IfLLPinsideDecVolSimple", "[", "exp", "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"IfLLPtoDet", "[", 
        RowBox[{
        "x1LLPproj_", ",", "x2LLPproj_", ",", "xLongProj_", ",", "exp"}], 
        "]"}], ",", 
       RowBox[{"IfLLPnotToDet", "[", 
        RowBox[{
        "x1LLPproj_", ",", "x2LLPproj_", ",", "xLongProj_", ",", "exp"}], 
        "]"}]}], "}"}], "=", 
     RowBox[{"IfParticlePointsToDetSimple", "[", "exp", "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"IfLLPdecVolToDet", "[", 
      RowBox[{
      "zLLP_", ",", "xLLP_", ",", "yLLP_", ",", "x1LLPproj_", ",", 
       "x2LLPproj_", ",", "xLongProj_", ",", "exp"}], "]"}], "=", 
     RowBox[{
      RowBox[{"IfLLPinsideDecVol", "[", 
       RowBox[{"zLLP", ",", "xLLP", ",", "yLLP", ",", "exp"}], "]"}], "*", 
      RowBox[{"IfLLPtoDet", "[", 
       RowBox[{"x1LLPproj", ",", "x2LLPproj", ",", "xLongProj", ",", "exp"}], 
       "]"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"IfLLPdecVolNotToDet", "[", 
      RowBox[{
      "zLLP_", ",", "xLLP_", ",", "yLLP_", ",", "x1LLPproj_", ",", 
       "x2LLPproj_", ",", "xLongProj_", ",", "exp"}], "]"}], "=", 
     RowBox[{
      RowBox[{"IfLLPinsideDecVol", "[", 
       RowBox[{"zLLP", ",", "xLLP", ",", "yLLP", ",", "exp"}], "]"}], "*", 
      RowBox[{"IfLLPnotToDet", "[", 
       RowBox[{"x1LLPproj", ",", "x2LLPproj", ",", "xLongProj", ",", "exp"}], 
       "]"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"DecayAcceptanceGeometry", "[", 
      RowBox[{"coord1_", ",", "coord2_", ",", "xLongProj_", ",", "exp"}], 
      "]"}], "=", 
     RowBox[{"IfLLPtoDet", "[", 
      RowBox[{"coord1", ",", "coord2", ",", "xLongProj", ",", "exp"}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", ",", 
   RowBox[{"{", 
    RowBox[{"exp", ",", "explisthike"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.9050147504288754`*^9, 3.9050147562368393`*^9}, 
   3.9050171518887124`*^9, {3.9050594004120784`*^9, 3.905059402071151*^9}, {
   3.9102585745350485`*^9, 3.9102586409395266`*^9}, 3.910258818504257*^9, 
   3.9102599356926794`*^9, {3.915437006988923*^9, 3.915437091515847*^9}, {
   3.9154372087376127`*^9, 3.915437208810703*^9}},
 CellLabel->
  "In[417]:=",ExpressionUUID->"e848a368-ae09-4896-b2b6-74e880e77ca5"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["CODEX-b", "Subsection",
 CellChangeTimes->{{3.893323096546553*^9, 3.893323097499832*^9}, {
  3.9050594097597904`*^9, 
  3.9050594116766253`*^9}},ExpressionUUID->"56870774-cd58-4af7-9e62-\
0d87871dea89"],

Cell[CellGroupData[{

Cell["Geometry", "Subsubsection",
 CellChangeTimes->{{3.893342623432827*^9, 
  3.893342624458*^9}},ExpressionUUID->"52baf8ed-31d4-431d-a4f0-08066f853f69"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"explistcodexb", "=", 
    RowBox[{"{", "\"\<CODEX-b\>\"", "}"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Distance", " ", "to", " ", "the", " ", "fiducial", " ", "volume", " ", 
    "along", " ", "the", " ", "beamline", " ", 
    RowBox[{"axis", ".", " ", 
     RowBox[{"MapThread", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"list1", "[", "#", "]"}], "=", "#2"}], ")"}], "&"}], ",", 
       RowBox[{"{", 
        RowBox[{"listexp", ",", "listvals"}], "}"}]}], "]"}]}], " ", 
    "equates", " ", "the", " ", "elements", " ", "list1", " ", "with", " ", 
    "keys", " ", "from", " ", "listexp", " ", "to", " ", "the", " ", 
    "corresponding", " ", "elements", " ", "of", " ", "the", " ", "list", " ",
     "listvals"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"zToDecayVolumeExperiment", "[", "#1", "]"}], "=", "#2"}], 
       ")"}], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistcodexb", ",", 
       RowBox[{"{", "5", "}"}]}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Detector", " ", "has", " ", "the", " ", "axis", " ", "along", " ", 
    "which", " ", "its", " ", "components", " ", "are", " ", 
    RowBox[{"placed", ".", " ", "The"}], " ", "option", " ", "below", " ", 
    "defines", " ", "the", " ", "orientation", " ", "of", " ", "the", " ", 
    "final", " ", "plane", " ", "transverse", " ", "to", " ", "this", " ", 
    "axis", " ", "relative", " ", "to", " ", "the", " ", "beamline"}], "*)"}],
   "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Transverse", " ", "if", " ", "the", " ", "plane", " ", "is", " ", 
     "tranverse", " ", 
     RowBox[{"(", 
      RowBox[{"SHiP", ",", " ", 
       RowBox[{"FACET", " ", "etc"}]}], ")"}]}], ",", " ", 
    RowBox[{
    "and", " ", "Parallel", " ", "if", " ", "it", " ", "is", " ", "parallel", 
     " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Codex", "-", "b"}], ",", " ", "ANUBIS"}]}]}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"DetectorPlaneOrientationExperiment", "[", "#1", "]"}], "=", 
        "#2"}], ")"}], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistcodexb", ",", 
       RowBox[{"Table", "[", 
        RowBox[{"\"\<Transverse\>\"", ",", 
         RowBox[{"Length", "[", "explistcodexb", "]"}]}], "]"}]}], "}"}]}], 
    "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Facility", " ", "hosting", " ", "the", " ", 
     RowBox[{"experiment", ":", " ", "SPS"}]}], ",", " ", "Fermilab", ",", 
    " ", "LHC", ",", " ", 
    RowBox[{"FCC", "-", "hh"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"FacilityExperiment", "[", "#1", "]"}], "=", "#2"}], ")"}], 
      "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistcodexb", ",", 
       RowBox[{"{", "\"\<LHC\>\"", "}"}]}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Geometry", " ", "of", " ", "the", " ", 
     RowBox[{"experiment", ":", " ", "box"}]}], ",", " ", "cylinder", ",", 
    " ", 
    RowBox[{"annular", " ", "cylinder"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"GeometryExperiment", "[", "#1", "]"}], "=", "#2"}], ")"}], 
      "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistcodexb", ",", 
       RowBox[{"Table", "[", 
        RowBox[{"\"\<Box\>\"", ",", 
         RowBox[{"Length", "[", "explistcodexb", "]"}]}], "]"}]}], "}"}]}], 
    "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Transverse", " ", "dimensions", " ", "of", " ", "the", " ", "decay", " ",
      "volume", " ", "assuming", " ", "box", " ", "geometry"}], ",", " ", 
    RowBox[{
    "or", " ", "cylindrical", " ", "geometry", " ", "if", " ", "the", " ", 
     "detector", " ", "plane", " ", "is", " ", "parallel", " ", "to", " ", 
     "the", " ", "beamline", " ", 
     RowBox[{
      RowBox[{"(", "ANUBIS", ")"}], ".", " ", "Otherwise"}], " ", "set", " ", 
     "to", " ", "zero"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MapThread", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"dxDecayVolumeExperiment", "[", 
        RowBox[{"z_", ",", "#1"}], "]"}], "=", "#2"}], ")"}], "&"}], ",", 
    RowBox[{"{", 
     RowBox[{"explistcodexb", ",", 
      RowBox[{"{", "10.", "}"}]}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"dyDecayVolumeExperiment", "[", 
         RowBox[{"z_", ",", "#1"}], "]"}], "=", "#2"}], ")"}], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistcodexb", ",", 
       RowBox[{"{", "10.", "}"}]}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Decay", " ", "volume", " ", "length", " ", "along", " ", "the", " ", 
    "beamline", " ", "axis"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"dzDecayVolumeExperiment", "[", "#1", "]"}], "=", "#2"}], 
       ")"}], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistcodexb", ",", 
       RowBox[{"{", "10.", "}"}]}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Distance", " ", "from", " ", "the", " ", "beamline", " ", "to", " ", 
     "the", " ", "decay", " ", "volume", " ", "center", " ", "and", " ", 
     "detector", " ", "along", " ", "the", " ", "x"}], ",", 
    RowBox[{"y", " ", "axes"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MapThread", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"xToDecayVolumeCenterExperiment", "[", 
        RowBox[{"z_", ",", "#1"}], "]"}], "=", "#2"}], ")"}], "&"}], ",", 
    RowBox[{"{", 
     RowBox[{"explistcodexb", ",", 
      RowBox[{"{", "31.", "}"}]}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"yToDecayVolumeCenterExperiment", "[", 
         RowBox[{"z_", ",", "#1"}], "]"}], "=", "#2"}], ")"}], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistcodexb", ",", 
       RowBox[{"{", 
        RowBox[{"-", "2."}], "}"}]}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Inner", " ", "and", " ", "outer", " ", "radii", " ", "of", " ", "the", 
    " ", "decay", " ", 
    RowBox[{"volume", ".", " ", "Applicable"}], " ", "if", " ", "the", " ", 
    "decay", " ", "volume", " ", "has", " ", "cylindrical", " ", "geometry"}],
    "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"RinnerDecayVolumeExperiment", "[", 
      RowBox[{"exp", ",", "z_"}], "]"}], "=", "0"}], ",", 
    RowBox[{"{", 
     RowBox[{"exp", ",", "explistcodexb"}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"RouterDecayVolumeExperiment", "[", 
       RowBox[{"exp", ",", "z_"}], "]"}], "=", "0"}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistcodexb"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"z", "-", 
    RowBox[{
    "coordinate", " ", "of", " ", "the", " ", "center", " ", "of", " ", "the",
      " ", "decay", " ", "volume"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"zToDecayVolumeCenterExperiment", "[", "exp", "]"}], "=", 
      RowBox[{
       RowBox[{"zToDecayVolumeExperiment", "[", "exp", "]"}], "+", 
       FractionBox[
        RowBox[{"dzDecayVolumeExperiment", "[", "exp", "]"}], "2"]}]}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistcodexb"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Maximal", " ", 
    RowBox[{"long", ".", " ", "displacement"}], " ", "of", " ", "the", " ", 
    "decay", " ", "volume"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"zMaxDecayVolumeExperiment", "[", "exp", "]"}], "=", 
     RowBox[{
      RowBox[{"zToDecayVolumeExperiment", "[", "exp", "]"}], "+", 
      RowBox[{"dzDecayVolumeExperiment", "[", "exp", "]"}]}]}], ",", 
    RowBox[{"{", 
     RowBox[{"exp", ",", "explistcodexb"}], "}"}]}], "]"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Whether", " ", "the", " ", "decay", " ", "volume", " ", "serves", " ", 
    "as", " ", "detector", " ", 
    RowBox[{"(", 
     RowBox[{"True", " ", "or", " ", "False"}], ")"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"DecayVolumeAsDetectorExperiment", "[", "exp", "]"}], "=", 
     "\"\<True\>\""}], ",", 
    RowBox[{"{", 
     RowBox[{"exp", ",", "explistcodexb"}], "}"}]}], "]"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Transverse", " ", "dimensions", " ", "of", " ", "the", " ", "detector", 
    " ", "assuming", " ", "box", " ", "geometry"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MapThread", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"dxDetectorExperiment", "[", 
        RowBox[{"#1", ",", "z_"}], "]"}], "=", "#2"}], ")"}], "&"}], ",", 
    RowBox[{"{", 
     RowBox[{"explistcodexb", ",", 
      RowBox[{"Table", "[", 
       RowBox[{"0", ",", 
        RowBox[{"Length", "[", "explistcodexb", "]"}]}], "]"}]}], "}"}]}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"dyDetectorExperiment", "[", 
         RowBox[{"#1", ",", "z_"}], "]"}], "=", "#2"}], ")"}], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistcodexb", ",", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", 
         RowBox[{"Length", "[", "explistcodexb", "]"}]}], "]"}]}], "}"}]}], 
    "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Length", " ", "of", " ", "the", " ", "detector", " ", "in", " ", "z", " ",
     "plane"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"dzDetectorExperiment", "[", "#1", "]"}], "=", "#2"}], ")"}], 
      "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistcodexb", ",", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", 
         RowBox[{"Length", "[", "explistcodexb", "]"}]}], "]"}]}], "}"}]}], 
    "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Coordinates", " ", "of", " ", "the", " ", "center", " ", "of", " ", "the",
     " ", "detector"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"xToDetectorCenterExperiment", "[", "exp", "]"}], "=", "0"}], 
    ",", 
    RowBox[{"{", 
     RowBox[{"exp", ",", "explistcodexb"}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"yToDetectorCenterExperiment", "[", "exp", "]"}], "=", "0"}], 
    ",", 
    RowBox[{"{", 
     RowBox[{"exp", ",", "explistcodexb"}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"zToDetectorCenterExperiment", "[", "exp", "]"}], "=", "0"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistcodexb"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Inner", " ", "and", " ", "outer", " ", "radii", " ", "of", " ", "the", 
    " ", "detector"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"RinnerDetectorExperiment", "[", 
      RowBox[{"exp", ",", "z_"}], "]"}], "=", "0"}], ",", 
    RowBox[{"{", 
     RowBox[{"exp", ",", "explistcodexb"}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"RouterDetectorExperiment", "[", 
       RowBox[{"exp", ",", "z_"}], "]"}], "=", "0"}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistcodexb"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Length", " ", "of", " ", "the", " ", "detector", " ", "along", " ", "the",
     " ", "detector", " ", "axis"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"dxLongDetectorExperiment", "[", "exp", "]"}], "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"DetectorPlaneOrientationExperiment", "[", "exp", "]"}], 
         "\[Equal]", "\"\<Transverse\>\""}], ",", 
        RowBox[{"dzDetectorExperiment", "[", "exp", "]"}], ",", 
        RowBox[{"dyDetectorExperiment", "[", "exp", "]"}]}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistcodexb"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "The", " ", "maximal", " ", "coordinate", " ", "of", " ", "the", " ", 
    "end", " ", "of", " ", "the", " ", "detector", " ", "plane", " ", 
    RowBox[{"(", 
     RowBox[{"along", " ", "the", " ", "detector", " ", "axis"}], ")"}], " ", 
    "used", " ", "to", " ", "calculate", " ", "the", " ", "decay", " ", 
    RowBox[{"acceptance", ".", " ", "May"}], " ", "be", " ", "either", " ", 
    "the", " ", "z", " ", "coordinate", " ", "or", " ", "the", " ", "y", " ", 
    "coordinate", " ", 
    RowBox[{"(", 
     RowBox[{
     "if", " ", "the", " ", "final", " ", "detector", " ", "plane", " ", "is",
       " ", "oriented", " ", "parallel", " ", "to", " ", "the", " ", 
      "beamline"}], ")"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"xLongMaxDetectorExperiment", "[", "exp", "]"}], "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"DetectorPlaneOrientationExperiment", "[", "exp", "]"}], 
         "\[Equal]", "\"\<Transverse\>\""}], ",", 
        RowBox[{
         RowBox[{"zMaxDecayVolumeExperiment", "[", "exp", "]"}], "+", 
         RowBox[{"dxLongDetectorExperiment", "[", "exp", "]"}]}], ",", 
        RowBox[{
         RowBox[{"yToDetectorCenterExperiment", "[", "exp", "]"}], "+", 
         RowBox[{
          RowBox[{"dyDetectorExperiment", "[", "exp", "]"}], "/", "2"}]}]}], 
       "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistcodexb"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Position", " ", "of", " ", "the", " ", "final", " ", "plane", " ", "for", 
    " ", "the", " ", "decay", " ", "products", " ", "along", " ", "the", " ", 
    "detector", " ", "axis"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"xLongDecayProductFinalPlaneExperiment", "[", "exp", "]"}], "=", 
     RowBox[{"zMaxDecayVolumeExperiment", "[", "exp", "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"exp", ",", "explistcodexb"}], "}"}]}], "]"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Whether", " ", "the", " ", "experiment", " ", "has", " ", "dipole", " ", 
    "magnet", " ", "in", " ", "the", " ", "detector", " ", 
    RowBox[{"(", 
     RowBox[{"True", ",", " ", "False"}], ")"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"DipoleMagnetOptionExperiment", "[", "#1", "]"}], "=", "#2"}],
        ")"}], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistcodexb", ",", 
       RowBox[{"Table", "[", 
        RowBox[{"\"\<False\>\"", ",", 
         RowBox[{"Length", "[", "explistcodexb", "]"}]}], "]"}]}], "}"}]}], 
    "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Longitudinal", " ", "positions", " ", "of", " ", "the", " ", "dipole", 
    " ", "magnet", " ", "of", " ", "the", " ", "detector"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MapThread", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"zMagnetMinExperiment", "[", "#1", "]"}], "=", "#2"}], ")"}], 
     "&"}], ",", 
    RowBox[{"{", 
     RowBox[{"explistcodexb", ",", 
      RowBox[{"Table", "[", 
       RowBox[{"0", ",", 
        RowBox[{"Length", "[", "explistcodexb", "]"}]}], "]"}]}], "}"}]}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"zMagnetMaxExperiment", "[", "#1", "]"}], "=", "#2"}], ")"}], 
      "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistcodexb", ",", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", 
         RowBox[{"Length", "[", "explistcodexb", "]"}]}], "]"}]}], "}"}]}], 
    "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Mean", " ", "magnetic", " ", "field", " ", "of", " ", "the", " ", 
    "dipole", " ", "magnet"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"MagneticFieldExperiment", "[", "#1", "]"}], "=", "#2"}], 
       ")"}], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistcodexb", ",", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", 
         RowBox[{"Length", "[", "explistcodexb", "]"}]}], "]"}]}], "}"}]}], 
    "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"ECAL", " ", "option", " ", 
    RowBox[{"(", 
     RowBox[{"True", ",", "False"}], ")"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"ECALoptionExperiment", "[", "exp", "]"}], "=", 
      "\"\<True\>\""}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistcodexb"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Position", " ", "of", " ", "the", " ", "beginning", " ", "of", " ", "the",
     " ", "ECAL"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"zECALminExperiment", "[", "#1", "]"}], "=", "#2"}], ")"}], 
      "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistcodexb", ",", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", 
         RowBox[{"Length", "[", "explistcodexb", "]"}]}], "]"}]}], "}"}]}], 
    "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "The", " ", "final", " ", "detector", " ", "plane", " ", "needed", " ", 
     "to", " ", "reconstruct", " ", 
     RowBox[{"muons", ".", " ", "Depeding"}], " ", "on", " ", "the", " ", 
     "experiment"}], ",", " ", 
    RowBox[{
    "it", " ", "is", " ", "approximated", " ", "by", " ", "be", " ", "end", 
     " ", "of", " ", "the", " ", "trackers", " ", "or", " ", "the", " ", 
     "muon", " ", "system"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"xLongMuonPlaneExperiment", "[", "#1", "]"}], "=", "#2"}], 
       ")"}], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistcodexb", ",", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", 
         RowBox[{"{", 
          RowBox[{"exp", ",", "explistcodexb"}], "}"}]}], "]"}]}], "}"}]}], 
    "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "The", " ", "final", " ", "detector", " ", "plane", " ", "needed", " ", 
     "to", " ", "reconstruct", " ", "other", " ", 
     RowBox[{"particles", ".", " ", "Depeding"}], " ", "on", " ", "the", " ", 
     "experiment"}], ",", " ", 
    RowBox[{
    "it", " ", "is", " ", "approximated", " ", "by", " ", "the", " ", "end", 
     " ", "of", " ", "the", " ", "trackers", " ", "or", " ", "the", " ", 
     "calorimeter", " ", "system"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"xLongNonMuonPlaneExperiment", "[", "#1", "]"}], "=", "#2"}], 
       ")"}], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistcodexb", ",", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", 
         RowBox[{"{", 
          RowBox[{"exp", ",", "explistcodexb"}], "}"}]}], "]"}]}], "}"}]}], 
    "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"List", " ", "of", " ", "detectable", " ", 
     RowBox[{"particles", ".", " ", "If"}], " ", "ECAL", " ", "is", " ", 
     "absent"}], ",", " ", 
    RowBox[{
    "it", " ", "is", " ", "assumed", " ", "by", " ", "default", " ", "that", 
     " ", "photons", " ", "and", " ", 
     SubscriptBox[
      SuperscriptBox["K", "0"], "L"], " ", "cannot", " ", "be", " ", 
     "detected"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MapThread", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"DetectablePDGsExperiment", "[", "#1", "]"}], "=", "#2"}], 
      ")"}], "&"}], ",", 
    RowBox[{"{", 
     RowBox[{"explistcodexb", ",", 
      RowBox[{"Table", "[", 
       RowBox[{"detectablepdgs", ",", 
        RowBox[{"Length", "[", "explistcodexb", "]"}]}], "]"}]}], "}"}]}], 
   "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.893323402478264*^9, 3.893323405571246*^9}, {
   3.8934862861846657`*^9, 3.893486289084297*^9}, {3.8935181370207148`*^9, 
   3.8935181370267005`*^9}, 3.8935193128226194`*^9, {3.8935201260107956`*^9, 
   3.8935201693193474`*^9}, 3.8935206581953855`*^9, {3.893954361080284*^9, 
   3.8939544024592166`*^9}, 3.8944385905365133`*^9, {3.8971453068262944`*^9, 
   3.897145319380933*^9}, {3.897145473937402*^9, 3.8971454869452286`*^9}, {
   3.9050147923371787`*^9, 3.9050147936850233`*^9}, {3.9050601496698384`*^9, 
   3.9050601498206997`*^9}, 3.910240594850881*^9, {3.9102469737126384`*^9, 
   3.9102469737126384`*^9}, {3.910254848899257*^9, 3.910254878076156*^9}, {
   3.9102589703026953`*^9, 3.910258975004573*^9}, {3.9120567222505813`*^9, 
   3.9120567379880295`*^9}, {3.9120572748332434`*^9, 3.9120572750310698`*^9}},
 CellLabel->
  "In[418]:=",ExpressionUUID->"fbfb8366-c3a8-4be1-a6ee-63373121fb25"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Cross-sections", "Subsubsection",
 CellChangeTimes->{{3.8933256308713317`*^9, 
  3.8933256323468237`*^9}},ExpressionUUID->"19e89f76-33ef-4e42-8a28-\
5187b7399835"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "0.1", " ", "stays", " ", "for", " ", "10", " ", "times", " ", "lower", 
    " ", "luminosity", " ", "of", " ", "LHCb", " ", "in", " ", "high", " ", 
    "lumi", " ", "phase", " ", "compared", " ", "to", " ", 
    RowBox[{"ATLAS", "/", "CMS"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"MapThread", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"NPOTexperiment", "[", "#1", "]"}], "=", "#2"}], ")"}], 
       "&"}], ",", 
      RowBox[{"{", 
       RowBox[{"explistcodexb", ",", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"0.1", "*", "LLHChighLumi", "*", 
           RowBox[{"\[Sigma]ppInpbFacility", "[", "\"\<LHC\>\"", "]"}]}], ",", 
          RowBox[{"Length", "[", "explistcodexb", "]"}]}], "]"}]}], "}"}]}], 
     "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MapThread", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"AtargetExperiment", "[", "#1", "]"}], "=", "#2"}], ")"}], 
       "&"}], ",", 
      RowBox[{"{", 
       RowBox[{"explistcodexb", ",", 
        RowBox[{"Table", "[", 
         RowBox[{"1.", ",", 
          RowBox[{"Length", "[", "explistcodexb", "]"}]}], "]"}]}], "}"}]}], 
     "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Cascade", " ", "enhancement", " ", "of", " ", "the", " ", "production", 
     " ", "relative", " ", "to", " ", "the", " ", "production", " ", "in", 
     " ", "pure", " ", "pp", " ", 
     RowBox[{"collisions", ".", " ", "Relevant"}], " ", "for", " ", "fixed", 
     " ", "target", " ", "experiments"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "For", " ", "all", " ", "experiments", " ", "located", " ", "at", " ", 
      "SPS"}], ",", " ", 
     RowBox[{
      RowBox[{
       RowBox[{
       "the", " ", "cascade", " ", "codexbtors", " ", "is", " ", "taken", " ",
         "from", " ", 
        RowBox[{"http", ":"}]}], "//", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"cds", ".", "cern", ".", "ch"}], "/", "record"}], "/", 
           "2115534"}], "/", "files"}], "/", "SHiP"}], "-", "NOTE", "-", 
        "2015", "-", 
        RowBox[{"009.", 
         RowBox[{"pdf", "?", "version"}]}]}]}], "=", "1"}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MapThread", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"CascadeFactorbb", "[", "#1", "]"}], "=", "#2"}], ")"}], 
       "&"}], ",", 
      RowBox[{"{", 
       RowBox[{"explistcodexb", ",", 
        RowBox[{"Table", "[", 
         RowBox[{"1.", ",", 
          RowBox[{"Length", "[", "explistcodexb", "]"}]}], "]"}]}], "}"}]}], 
     "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Fraction", " ", "of", " ", "produced", " ", "bb", " ", "per", " ", "PoT",
      " ", "at", " ", "the", " ", "given", " ", "experiment"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"PppTobbExperiment", "[", "exp", "]"}], "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"\[Sigma]ppTobbInpbFacility", "[", 
          RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}], "/", 
         RowBox[{"\[Sigma]ppInpbFacility", "[", 
          RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}]}], ")"}], 
       SuperscriptBox[
        RowBox[{"AtargetExperiment", "[", "exp", "]"}], "0.29"], "*", 
       RowBox[{"CascadeFactorbb", "[", "exp", "]"}]}]}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistcodexb"}], "}"}]}], "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MapThread", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"CascadeFactorcc", "[", "#1", "]"}], "=", "#2"}], ")"}], 
       "&"}], ",", 
      RowBox[{"{", 
       RowBox[{"explistcodexb", ",", 
        RowBox[{"Table", "[", 
         RowBox[{"1.", ",", 
          RowBox[{"Length", "[", "explistcodexb", "]"}]}], "]"}]}], "}"}]}], 
     "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Fraction", " ", "of", " ", "produced", " ", "cc", " ", "per", " ", "PoT",
      " ", "at", " ", "the", " ", "given", " ", "experiment"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"PppToccExperiment", "[", "exp", "]"}], "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"\[Sigma]ppToccInpbFacility", "[", 
          RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}], "/", 
         RowBox[{"\[Sigma]ppInpbFacility", "[", 
          RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}]}], ")"}], 
       SuperscriptBox[
        RowBox[{"AtargetExperiment", "[", "exp", "]"}], "0.29"], "*", 
       RowBox[{"CascadeFactorcc", "[", "exp", "]"}]}]}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistcodexb"}], "}"}]}], "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Fraction", " ", "of", " ", "produced", " ", "h", " ", "per", " ", "PoT", 
     " ", "at", " ", "the", " ", "given", " ", "experiment"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"PppTohExperiment", "[", "exp", "]"}], "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\[Sigma]ppTohInpbFacility", "[", 
           RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}], "/", 
          RowBox[{"\[Sigma]ppInpbFacility", "[", 
           RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}]}], ")"}], 
        SuperscriptBox[
         RowBox[{"AtargetExperiment", "[", "exp", "]"}], "0.29"]}]}], ",", 
      RowBox[{"{", 
       RowBox[{"exp", ",", "explistcodexb"}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Fraction", " ", "of", " ", "produced", " ", "W", " ", "per", " ", "PoT", 
     " ", "at", " ", "the", " ", "given", " ", "experiment"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"PppToWExperiment", "[", "exp", "]"}], "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\[Sigma]ppToWInpbFacility", "[", 
           RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}], "/", 
          RowBox[{"\[Sigma]ppInpbFacility", "[", 
           RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}]}], ")"}], 
        SuperscriptBox[
         RowBox[{"AtargetExperiment", "[", "exp", "]"}], "0.29"]}]}], ",", 
      RowBox[{"{", 
       RowBox[{"exp", ",", "explistcodexb"}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Fraction", " ", "of", " ", "produced", " ", 
     SuperscriptBox["\[Pi]", "0"], " ", "per", " ", "PoT", " ", "at", " ", 
     "the", " ", "given", " ", "experiment"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"PppTo\[Pi]0exp", "[", "exp", "]"}], "=", 
       RowBox[{"PppTo\[Pi]0Facility", "[", 
        RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"exp", ",", "explistcodexb"}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Fraction", " ", "of", " ", "produced", " ", "\[Eta]", " ", "per", " ", 
     "PoT", " ", "at", " ", "the", " ", "given", " ", "experiment"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"PppTo\[Eta]exp", "[", "exp", "]"}], "=", 
       RowBox[{"PppTo\[Eta]Facility", "[", 
        RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"exp", ",", "explistcodexb"}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Fraction", " ", "of", " ", "produced", " ", 
     RowBox[{"\[Eta]", "'"}], " ", "per", " ", "PoT", " ", "at", " ", "the", 
     " ", "given", " ", "experiment"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"PppTo\[Eta]prexp", "[", "exp", "]"}], "=", 
       RowBox[{"PppTo\[Eta]prFacility", "[", 
        RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"exp", ",", "explistcodexb"}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Fraction", " ", "of", " ", "produced", " ", 
     SuperscriptBox["\[Rho]", "0"], " ", "per", " ", "PoT", " ", "at", " ", 
     "the", " ", "given", " ", "experiment"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"PppTo\[Rho]0exp", "[", "exp", "]"}], "=", 
       RowBox[{"PppTo\[Rho]0Facility", "[", 
        RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"exp", ",", "explistcodexb"}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Fraction", " ", "of", " ", "produced", " ", "\[Omega]", " ", "per", " ", 
     "PoT", " ", "at", " ", "the", " ", "given", " ", "experiment"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"PppTo\[Omega]exp", "[", "exp", "]"}], "=", 
       RowBox[{"PppTo\[Omega]Facility", "[", 
        RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"exp", ",", "explistcodexb"}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"PppToJpsiexp", "[", "exp", "]"}], "=", 
       RowBox[{
        RowBox[{"PppToJpsiFacility", "[", 
         RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}], 
        SuperscriptBox[
         RowBox[{"AtargetExperiment", "[", "exp", "]"}], "0.29"]}]}], ",", 
      RowBox[{"{", 
       RowBox[{"exp", ",", "explistcodexb"}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Fraction", " ", "of", " ", "produced", " ", "\[CapitalUpsilon]", 
     RowBox[{"(", 
      RowBox[{"1", "s"}], ")"}], " ", "per", " ", "PoT", " ", "at", " ", 
     "the", " ", "given", " ", "experiment"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"PppToUpsilonexp", "[", "exp", "]"}], "=", 
       RowBox[{
        RowBox[{"PppToUpsilonFacility", "[", 
         RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}], 
        SuperscriptBox[
         RowBox[{"AtargetExperiment", "[", "exp", "]"}], "0.29"]}]}], ",", 
      RowBox[{"{", 
       RowBox[{"exp", ",", "explistcodexb"}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Fraction", " ", "of", " ", "produced", " ", "\[Phi]", " ", "at", " ", 
     "the", " ", "given", " ", "experiment"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"PppToPhiexp", "[", "exp", "]"}], "=", 
       RowBox[{"PppToPhiFacility", "[", 
        RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"exp", ",", "explistcodexb"}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Overall", " ", "table", " ", "with", " ", "cross"}], "-", 
     RowBox[{"sections", " ", "used", " ", "for", " ", "exporting"}]}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"TableNumbersParticlesExperiment", "[", "exp", "]"}], "=", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "\"\<Facility\>\"", ",", "\"\<Npot\>\"", ",", "\"\<Atarget\>\"", 
           ",", "\"\<PPi0\>\"", ",", "\"\<PEta\>\"", ",", "\"\<PEtapr\>\"", 
           ",", "\"\<PRho0\>\"", ",", "\"\<POmega\>\"", ",", "\"\<Pc\>\"", 
           ",", "\"\<Pb\>\"", ",", "\"\<PW\>\"", ",", "\"\<Ph\>\"", ",", 
           "\"\<PJpsi\>\"", ",", "\"\<PUpsilon\>\"", ",", "\"\<PPhi\>\""}], 
          "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"FacilityExperiment", "[", "exp", "]"}], ",", 
           RowBox[{"NPOTexperiment", "[", "exp", "]"}], ",", 
           RowBox[{"AtargetExperiment", "[", "exp", "]"}], ",", 
           RowBox[{"PppTo\[Pi]0exp", "[", "exp", "]"}], ",", 
           RowBox[{"PppTo\[Eta]exp", "[", "exp", "]"}], ",", 
           RowBox[{"PppTo\[Eta]prexp", "[", "exp", "]"}], ",", 
           RowBox[{"PppTo\[Rho]0exp", "[", "exp", "]"}], ",", 
           RowBox[{"PppTo\[Omega]exp", "[", "exp", "]"}], ",", 
           RowBox[{"2", 
            RowBox[{"PppToccExperiment", "[", "exp", "]"}]}], ",", 
           RowBox[{"2", 
            RowBox[{"PppTobbExperiment", "[", "exp", "]"}]}], ",", 
           RowBox[{"PppToWExperiment", "[", "exp", "]"}], ",", 
           RowBox[{"PppTohExperiment", "[", "exp", "]"}], ",", 
           RowBox[{"PppToJpsiexp", "[", "exp", "]"}], ",", 
           RowBox[{"PppToUpsilonexp", "[", "exp", "]"}], ",", 
           RowBox[{"PppToPhiexp", "[", "exp", "]"}]}], "}"}]}], "}"}], "//", 
       "N"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistcodexb"}], "}"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.8933410291018767`*^9, 3.8933410687616005`*^9}, {
   3.8933411427157507`*^9, 3.893341173252475*^9}, {3.8933412089844475`*^9, 
   3.8933412542386293`*^9}, {3.893341308669573*^9, 3.8933413318797393`*^9}, {
   3.8933413865431566`*^9, 3.893341440531106*^9}, {3.8933421064945536`*^9, 
   3.893342233426933*^9}, {3.8933423704054637`*^9, 3.8933423813291965`*^9}, {
   3.893342479608466*^9, 3.893342522888693*^9}, {3.893342557740919*^9, 
   3.89334260198568*^9}, {3.8933427427053576`*^9, 3.893342774584057*^9}, {
   3.893342865578314*^9, 3.8933428797362194`*^9}, {3.893342920162734*^9, 
   3.8933430049119186`*^9}, 3.8933430643769608`*^9, {3.894178217218158*^9, 
   3.8941782199769444`*^9}, {3.894178703868905*^9, 3.8941787063523755`*^9}, {
   3.8972357355352354`*^9, 3.8972357505346966`*^9}, {3.8972861920393047`*^9, 
   3.897286198798593*^9}, 3.8991963649235125`*^9, 3.899197070336206*^9, {
   3.8991971416944237`*^9, 3.89919714192108*^9}},
 CellLabel->
  "In[453]:=",ExpressionUUID->"0ad70661-725f-48d0-b8d2-342f65d9fbd4"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Conditions for the LLP to decay inside the decay volume and for the products \
to point to the end of the detector\
\>", "Subsubsection",
 CellChangeTimes->{{3.905011297554874*^9, 3.9050113192993593`*^9}, 
   3.9154372088176904`*^9},ExpressionUUID->"c3880812-e9f5-4729-b69d-\
b0d0a0716306"],

Cell[BoxData[
 RowBox[{"Do", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"IfLLPinsideDecVol", "[", 
      RowBox[{"zLLP_", ",", "xLLP_", ",", "yLLP_", ",", "exp"}], "]"}], "=", 
     RowBox[{"IfLLPinsideDecVolSimple", "[", "exp", "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"IfLLPtoDet", "[", 
        RowBox[{
        "x1LLPproj_", ",", "x2LLPproj_", ",", "xLongProj_", ",", "exp"}], 
        "]"}], ",", 
       RowBox[{"IfLLPnotToDet", "[", 
        RowBox[{
        "x1LLPproj_", ",", "x2LLPproj_", ",", "xLongProj_", ",", "exp"}], 
        "]"}]}], "}"}], "=", 
     RowBox[{"IfParticlePointsToDetSimple", "[", "exp", "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"IfLLPdecVolToDet", "[", 
      RowBox[{
      "zLLP_", ",", "xLLP_", ",", "yLLP_", ",", "x1LLPproj_", ",", 
       "x2LLPproj_", ",", "xLongProj_", ",", "exp"}], "]"}], "=", 
     RowBox[{
      RowBox[{"IfLLPinsideDecVol", "[", 
       RowBox[{"zLLP", ",", "xLLP", ",", "yLLP", ",", "exp"}], "]"}], "*", 
      RowBox[{"IfLLPtoDet", "[", 
       RowBox[{"x1LLPproj", ",", "x2LLPproj", ",", "xLongProj", ",", "exp"}], 
       "]"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"IfLLPdecVolNotToDet", "[", 
      RowBox[{
      "zLLP_", ",", "xLLP_", ",", "yLLP_", ",", "x1LLPproj_", ",", 
       "x2LLPproj_", ",", "xLongProj_", ",", "exp"}], "]"}], "=", 
     RowBox[{
      RowBox[{"IfLLPinsideDecVol", "[", 
       RowBox[{"zLLP", ",", "xLLP", ",", "yLLP", ",", "exp"}], "]"}], "*", 
      RowBox[{"IfLLPnotToDet", "[", 
       RowBox[{"x1LLPproj", ",", "x2LLPproj", ",", "xLongProj", ",", "exp"}], 
       "]"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"DecayAcceptanceGeometry", "[", 
      RowBox[{"coord1_", ",", "coord2_", ",", "xLongProj_", ",", "exp"}], 
      "]"}], "=", 
     RowBox[{"IfLLPtoDet", "[", 
      RowBox[{"coord1", ",", "coord2", ",", "xLongProj", ",", "exp"}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", ",", 
   RowBox[{"{", 
    RowBox[{"exp", ",", "explistcodexb"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.9050147846143217`*^9, 3.905014785994602*^9}, 
   3.905017151891704*^9, {3.9050594243482895`*^9, 3.9050594248019333`*^9}, {
   3.9102585745395722`*^9, 3.9102586409435177`*^9}, 3.9102588185083313`*^9, 
   3.91025993569681*^9, {3.9154370070114155`*^9, 3.9154370915188384`*^9}, {
   3.915437208839109*^9, 3.9154372089121447`*^9}},
 CellLabel->
  "In[470]:=",ExpressionUUID->"b6a6e877-7cc2-4ceb-b64d-5aa9913bdef3"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
FOREHUNT@FCC-hh (2306.11803 but with added detector and a hole accounting for \
beamline)\
\>", "Subsection",
 CellChangeTimes->{{3.893316241994761*^9, 3.893316243925145*^9}, {
  3.903967773998727*^9, 3.9039677766441917`*^9}, {3.90396814014128*^9, 
  3.9039681482081337`*^9}, {3.90396827754755*^9, 3.9039682784156866`*^9}, {
  3.903968619320803*^9, 
  3.903968646031247*^9}},ExpressionUUID->"e5a162fe-e852-4fc7-a4e9-\
6da078c9b465"],

Cell[CellGroupData[{

Cell["Geometry", "Subsubsection",
 CellChangeTimes->{{3.893342623432827*^9, 
  3.893342624458*^9}},ExpressionUUID->"0afe546c-ec47-4d12-8908-e06e4be5cb7f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"explistforehunt", "=", 
    RowBox[{"{", 
     RowBox[{
     "\"\<FOREHUNT-A\>\"", ",", "\"\<FOREHUNT-D\>\"", ",", 
      "\"\<FOREHUNT-F\>\""}], "}"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Distance", " ", "to", " ", "the", " ", "fiducial", " ", "volume", " ", 
    "along", " ", "the", " ", "beamline", " ", 
    RowBox[{"axis", ".", " ", 
     RowBox[{"MapThread", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"list1", "[", "#", "]"}], "=", "#2"}], ")"}], "&"}], ",", 
       RowBox[{"{", 
        RowBox[{"listexp", ",", "listvals"}], "}"}]}], "]"}]}], " ", 
    "equates", " ", "the", " ", "elements", " ", "list1", " ", "with", " ", 
    "keys", " ", "from", " ", "listexp", " ", "to", " ", "the", " ", 
    "corresponding", " ", "elements", " ", "of", " ", "the", " ", "list", " ",
     "listvals"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"zToDecayVolumeExperiment", "[", "#1", "]"}], "=", "#2"}], 
       ")"}], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistforehunt", ",", 
       RowBox[{"{", 
        RowBox[{"50", ",", "75", ",", "100."}], "}"}]}], "}"}]}], "]"}], 
   ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Detector", " ", "has", " ", "the", " ", "axis", " ", "along", " ", 
    "which", " ", "its", " ", "components", " ", "are", " ", 
    RowBox[{"placed", ".", " ", "The"}], " ", "option", " ", "below", " ", 
    "defines", " ", "the", " ", "orientation", " ", "of", " ", "the", " ", 
    "final", " ", "plane", " ", "transverse", " ", "to", " ", "this", " ", 
    "axis", " ", "relative", " ", "to", " ", "the", " ", "beamline"}], "*)"}],
   "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Transverse", " ", "if", " ", "the", " ", "plane", " ", "is", " ", 
     "tranverse", " ", 
     RowBox[{"(", 
      RowBox[{"SHiP", ",", " ", 
       RowBox[{"FASER", " ", "etc"}]}], ")"}]}], ",", " ", 
    RowBox[{
    "and", " ", "Parallel", " ", "if", " ", "it", " ", "is", " ", "parallel", 
     " ", 
     RowBox[{"(", 
      RowBox[{"MATHUSLA", ",", " ", "ANUBIS"}]}]}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"DetectorPlaneOrientationExperiment", "[", "#1", "]"}], "=", 
        "#2"}], ")"}], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistforehunt", ",", 
       RowBox[{"Table", "[", 
        RowBox[{"\"\<Transverse\>\"", ",", 
         RowBox[{"Length", "[", "explistforehunt", "]"}]}], "]"}]}], "}"}]}], 
    "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Facility", " ", "hosting", " ", "the", " ", 
     RowBox[{"experiment", ":", " ", "SPS"}]}], ",", " ", "Fermilab", ",", 
    " ", "LHC", ",", " ", 
    RowBox[{"FCC", "-", "hh"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"FacilityExperiment", "[", "#1", "]"}], "=", "#2"}], ")"}], 
      "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistforehunt", ",", 
       RowBox[{"Table", "[", 
        RowBox[{"\"\<FCC-hh\>\"", ",", 
         RowBox[{"Length", "[", "explistforehunt", "]"}]}], "]"}]}], "}"}]}], 
    "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Geometry", " ", "of", " ", "the", " ", 
     RowBox[{"experiment", ":", " ", "box"}]}], ",", " ", "cylinder", ",", 
    " ", 
    RowBox[{"annular", " ", "cylinder"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"GeometryExperiment", "[", "#1", "]"}], "=", "#2"}], ")"}], 
      "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistforehunt", ",", 
       RowBox[{"Table", "[", 
        RowBox[{"\"\<Annular cylinder\>\"", ",", 
         RowBox[{"Length", "[", "explistforehunt", "]"}]}], "]"}]}], "}"}]}], 
    "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Transverse", " ", "dimensions", " ", "of", " ", "the", " ", "decay", " ",
      "volume", " ", "assuming", " ", "box", " ", "geometry"}], ",", " ", 
    RowBox[{
    "or", " ", "cylindrical", " ", "geometry", " ", "if", " ", "the", " ", 
     "detector", " ", "plane", " ", "is", " ", "parallel", " ", "to", " ", 
     "the", " ", "beamline", " ", 
     RowBox[{
      RowBox[{"(", "ANUBIS", ")"}], ".", " ", "Otherwise"}], " ", "set", " ", 
     "to", " ", "zero"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MapThread", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"dxDecayVolumeExperiment", "[", 
        RowBox[{"z_", ",", "#1"}], "]"}], "=", "#2"}], ")"}], "&"}], ",", 
    RowBox[{"{", 
     RowBox[{"explistforehunt", ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"dyDecayVolumeExperiment", "[", 
         RowBox[{"z_", ",", "#1"}], "]"}], "=", "#2"}], ")"}], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistforehunt", ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Decay", " ", "volume", " ", "length", " ", "along", " ", "the", " ", 
    "beamline", " ", "axis"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"dzDecayVolumeExperiment", "[", "#1", "]"}], "=", "#2"}], 
       ")"}], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistforehunt", ",", 
       RowBox[{"{", 
        RowBox[{"10", ",", "20", ",", "50."}], "}"}]}], "}"}]}], "]"}], ";"}],
   "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Distance", " ", "from", " ", "the", " ", "beamline", " ", "to", " ", 
     "the", " ", "decay", " ", "volume", " ", "center", " ", "and", " ", 
     "detector", " ", "along", " ", "the", " ", "x"}], ",", 
    RowBox[{"y", " ", "axes"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MapThread", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"xToDecayVolumeCenterExperiment", "[", 
        RowBox[{"z_", ",", "#1"}], "]"}], "=", "#2"}], ")"}], "&"}], ",", 
    RowBox[{"{", 
     RowBox[{"explistforehunt", ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"yToDecayVolumeCenterExperiment", "[", 
         RowBox[{"z_", ",", "#1"}], "]"}], "=", "#2"}], ")"}], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistforehunt", ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Inner", " ", "and", " ", "outer", " ", "radii", " ", "of", " ", "the", 
    " ", "decay", " ", 
    RowBox[{"volume", ".", " ", "Applicable"}], " ", "if", " ", "the", " ", 
    "decay", " ", "volume", " ", "has", " ", "cylindrical", " ", "geometry"}],
    "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MapThread", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"RinnerDecayVolumeExperiment", "[", 
        RowBox[{"#1", ",", "z_"}], "]"}], "=", "#2"}], ")"}], "&"}], ",", 
    RowBox[{"{", 
     RowBox[{"explistforehunt", ",", 
      RowBox[{"{", 
       RowBox[{"0.2", ",", "0.2", ",", "0.2"}], "}"}]}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"RouterDecayVolumeExperiment", "[", 
         RowBox[{"#1", ",", "z_"}], "]"}], "=", "#2"}], ")"}], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistforehunt", ",", 
       RowBox[{"{", 
        RowBox[{"1.", ",", "2.", ",", "5."}], "}"}]}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"z", "-", 
    RowBox[{
    "coordinate", " ", "of", " ", "the", " ", "center", " ", "of", " ", "the",
      " ", "decay", " ", "volume"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"zToDecayVolumeCenterExperiment", "[", "exp", "]"}], "=", 
      RowBox[{
       RowBox[{"zToDecayVolumeExperiment", "[", "exp", "]"}], "+", 
       FractionBox[
        RowBox[{"dzDecayVolumeExperiment", "[", "exp", "]"}], "2"]}]}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistforehunt"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Maximal", " ", 
    RowBox[{"long", ".", " ", "displacement"}], " ", "of", " ", "the", " ", 
    "decay", " ", "volume"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"zMaxDecayVolumeExperiment", "[", "exp", "]"}], "=", 
     RowBox[{
      RowBox[{"zToDecayVolumeExperiment", "[", "exp", "]"}], "+", 
      RowBox[{"dzDecayVolumeExperiment", "[", "exp", "]"}]}]}], ",", 
    RowBox[{"{", 
     RowBox[{"exp", ",", "explistforehunt"}], "}"}]}], "]"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Whether", " ", "the", " ", "decay", " ", "volume", " ", "serves", " ", 
    "as", " ", "detector", " ", 
    RowBox[{"(", 
     RowBox[{"True", " ", "or", " ", "False"}], ")"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"DecayVolumeAsDetectorExperiment", "[", "exp", "]"}], "=", 
     "\"\<False\>\""}], ",", 
    RowBox[{"{", 
     RowBox[{"exp", ",", "explistforehunt"}], "}"}]}], "]"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Transverse", " ", "dimensions", " ", "of", " ", "the", " ", "detector", 
    " ", "assuming", " ", "box", " ", "geometry"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MapThread", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"dxDetectorExperiment", "[", 
        RowBox[{"#1", ",", "z_"}], "]"}], "=", "#2"}], ")"}], "&"}], ",", 
    RowBox[{"{", 
     RowBox[{"explistforehunt", ",", 
      RowBox[{"{", 
       RowBox[{"0.1", ",", "1.", ",", "1."}], "}"}]}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"dyDetectorExperiment", "[", 
         RowBox[{"#1", ",", "z_"}], "]"}], "=", "#2"}], ")"}], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistforehunt", ",", 
       RowBox[{"{", 
        RowBox[{"0.1", ",", "1.", ",", "1."}], "}"}]}], "}"}]}], "]"}], ";"}],
   "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Length", " ", "of", " ", "the", " ", "detector", " ", "in", " ", "z", " ",
     "plane"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"dzDetectorExperiment", "[", "#1", "]"}], "=", "#2"}], ")"}], 
      "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistforehunt", ",", 
       RowBox[{"{", 
        RowBox[{"9", ",", "9", ",", "9."}], "}"}]}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Coordinates", " ", "of", " ", "the", " ", "center", " ", "of", " ", "the",
     " ", "detector"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"xToDetectorCenterExperiment", "[", "exp", "]"}], "=", "0"}], 
    ",", 
    RowBox[{"{", 
     RowBox[{"exp", ",", "explistforehunt"}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"yToDetectorCenterExperiment", "[", "exp", "]"}], "=", "0"}], 
    ",", 
    RowBox[{"{", 
     RowBox[{"exp", ",", "explistforehunt"}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"zToDetectorCenterExperiment", "[", "exp", "]"}], "=", 
      RowBox[{
       RowBox[{"zMaxDecayVolumeExperiment", "[", "exp", "]"}], "+", 
       FractionBox[
        RowBox[{"dzDetectorExperiment", "[", "exp", "]"}], "2"]}]}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistforehunt"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Inner", " ", "and", " ", "outer", " ", "radii", " ", "of", " ", "the", 
    " ", "detector"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MapThread", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"RinnerDetectorExperiment", "[", 
        RowBox[{"#1", ",", "z_"}], "]"}], "=", "#2"}], ")"}], "&"}], ",", 
    RowBox[{"{", 
     RowBox[{"explistforehunt", ",", 
      RowBox[{"{", 
       RowBox[{"0.2", ",", "0.2", ",", "0.2"}], "}"}]}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"RouterDetectorExperiment", "[", 
         RowBox[{"#1", ",", "z_"}], "]"}], "=", "#2"}], ")"}], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistforehunt", ",", 
       RowBox[{"{", 
        RowBox[{"1.", ",", "2.", ",", "5."}], "}"}]}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Length", " ", "of", " ", "the", " ", "detector", " ", "along", " ", "the",
     " ", "detector", " ", "axis"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"dxLongDetectorExperiment", "[", "exp", "]"}], "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"DetectorPlaneOrientationExperiment", "[", "exp", "]"}], 
         "\[Equal]", "\"\<Transverse\>\""}], ",", 
        RowBox[{"dzDetectorExperiment", "[", "exp", "]"}], ",", 
        RowBox[{"dyDetectorExperiment", "[", "exp", "]"}]}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistforehunt"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "The", " ", "maximal", " ", "coordinate", " ", "of", " ", "the", " ", 
    "end", " ", "of", " ", "the", " ", "detector", " ", "plane", " ", 
    RowBox[{"(", 
     RowBox[{"along", " ", "the", " ", "detector", " ", "axis"}], ")"}], " ", 
    "used", " ", "to", " ", "calculate", " ", "the", " ", "decay", " ", 
    RowBox[{"acceptance", ".", " ", "May"}], " ", "be", " ", "either", " ", 
    "the", " ", "z", " ", "coordinate", " ", "or", " ", "the", " ", "y", " ", 
    "coordinate", " ", 
    RowBox[{"(", 
     RowBox[{
     "if", " ", "the", " ", "final", " ", "detector", " ", "plane", " ", "is",
       " ", "oriented", " ", "parallel", " ", "to", " ", "the", " ", 
      "beamline"}], ")"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"xLongMaxDetectorExperiment", "[", "exp", "]"}], "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"DetectorPlaneOrientationExperiment", "[", "exp", "]"}], 
         "\[Equal]", "\"\<Transverse\>\""}], ",", 
        RowBox[{
         RowBox[{"zMaxDecayVolumeExperiment", "[", "exp", "]"}], "+", 
         RowBox[{"dxLongDetectorExperiment", "[", "exp", "]"}]}], ",", 
        RowBox[{
         RowBox[{"yToDetectorCenterExperiment", "[", "exp", "]"}], "+", 
         RowBox[{
          RowBox[{"dyDetectorExperiment", "[", "exp", "]"}], "/", "2"}]}]}], 
       "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistforehunt"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Position", " ", "of", " ", "the", " ", "final", " ", "plane", " ", "for", 
    " ", "the", " ", "decay", " ", "products", " ", "along", " ", "the", " ", 
    "detector", " ", "axis"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"xLongDecayProductFinalPlaneExperiment", "[", "exp", "]"}], "=", 
     RowBox[{"xLongMaxDetectorExperiment", "[", "exp", "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"exp", ",", "explistforehunt"}], "}"}]}], "]"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Whether", " ", "the", " ", "experiment", " ", "has", " ", "dipole", " ", 
    "magnet", " ", "in", " ", "the", " ", "detector", " ", 
    RowBox[{"(", 
     RowBox[{"True", ",", " ", "False"}], ")"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"DipoleMagnetOptionExperiment", "[", "#1", "]"}], "=", "#2"}],
        ")"}], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistforehunt", ",", 
       RowBox[{"{", 
        RowBox[{"\"\<False\>\"", ",", "\"\<False\>\"", ",", "\"\<False\>\""}],
         "}"}]}], "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Longitudinal", " ", "positions", " ", "of", " ", "the", " ", "dipole", 
    " ", "magnet", " ", "of", " ", "the", " ", "detector"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MapThread", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"zMagnetMinExperiment", "[", "#1", "]"}], "=", "#2"}], ")"}], 
     "&"}], ",", 
    RowBox[{"{", 
     RowBox[{"explistforehunt", ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"zMagnetMaxExperiment", "[", "#1", "]"}], "=", "#2"}], ")"}], 
      "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistforehunt", ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Mean", " ", "magnetic", " ", "field", " ", "of", " ", "the", " ", 
    "dipole", " ", "magnet"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"MagneticFieldExperiment", "[", "#1", "]"}], "=", "#2"}], 
       ")"}], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistforehunt", ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"ECAL", " ", "option", " ", 
    RowBox[{"(", 
     RowBox[{"True", ",", "False"}], ")"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"ECALoptionExperiment", "[", "exp", "]"}], "=", 
      "\"\<True\>\""}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistforehunt"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Position", " ", "of", " ", "the", " ", "beginning", " ", "of", " ", "the",
     " ", "ECAL"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"zECALminExperiment", "[", "#1", "]"}], "=", "#2"}], ")"}], 
      "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistforehunt", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{
          "zMaxDecayVolumeExperiment", "[", "\"\<FOREHUNT-A\>\"", "]"}], "+", 
          "3"}], ",", 
         RowBox[{
          RowBox[{
          "zMaxDecayVolumeExperiment", "[", "\"\<FOREHUNT-D\>\"", "]"}], "+", 
          "3"}], ",", 
         RowBox[{
          RowBox[{
          "zMaxDecayVolumeExperiment", "[", "\"\<FOREHUNT-F\>\"", "]"}], "+", 
          "3"}]}], "}"}]}], "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "The", " ", "final", " ", "detector", " ", "plane", " ", "needed", " ", 
     "to", " ", "reconstruct", " ", 
     RowBox[{"muons", ".", " ", "Depeding"}], " ", "on", " ", "the", " ", 
     "experiment"}], ",", " ", 
    RowBox[{
    "it", " ", "is", " ", "approximated", " ", "by", " ", "be", " ", "end", 
     " ", "of", " ", "the", " ", "trackers", " ", "or", " ", "the", " ", 
     "muon", " ", "system"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"xLongMuonPlaneExperiment", "[", "#1", "]"}], "=", "#2"}], 
       ")"}], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistforehunt", ",", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"xLongMaxDetectorExperiment", "[", "exp", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"exp", ",", "explistforehunt"}], "}"}]}], "]"}]}], "}"}]}], 
    "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "The", " ", "final", " ", "detector", " ", "plane", " ", "needed", " ", 
     "to", " ", "reconstruct", " ", "other", " ", 
     RowBox[{"particles", ".", " ", "Depeding"}], " ", "on", " ", "the", " ", 
     "experiment"}], ",", " ", 
    RowBox[{
    "it", " ", "is", " ", "approximated", " ", "by", " ", "the", " ", "end", 
     " ", "of", " ", "the", " ", "trackers", " ", "or", " ", "the", " ", 
     "calorimeter", " ", "system"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"xLongNonMuonPlaneExperiment", "[", "#1", "]"}], "=", "#2"}], 
       ")"}], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistforehunt", ",", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"zECALminExperiment", "[", "exp", "]"}], "+", "2"}], ",", 
         RowBox[{"{", 
          RowBox[{"exp", ",", "explistforehunt"}], "}"}]}], "]"}]}], "}"}]}], 
    "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"List", " ", "of", " ", "detectable", " ", 
     RowBox[{"particles", ".", " ", "If"}], " ", "ECAL", " ", "is", " ", 
     "absent"}], ",", " ", 
    RowBox[{
    "it", " ", "is", " ", "assumed", " ", "by", " ", "default", " ", "that", 
     " ", "photons", " ", "and", " ", 
     SubscriptBox[
      SuperscriptBox["K", "0"], "L"], " ", "cannot", " ", "be", " ", 
     "detected"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MapThread", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"DetectablePDGsExperiment", "[", "#1", "]"}], "=", "#2"}], 
      ")"}], "&"}], ",", 
    RowBox[{"{", 
     RowBox[{"explistforehunt", ",", 
      RowBox[{"Table", "[", 
       RowBox[{"detectablepdgs", ",", 
        RowBox[{"Length", "[", "explistforehunt", "]"}]}], "]"}]}], "}"}]}], 
   "]"}], ";"}]}], "Input",
 CellChangeTimes->{
  3.8933227514915576`*^9, {3.8934862861671705`*^9, 3.8934862890706244`*^9}, {
   3.893518136977829*^9, 3.893518136985808*^9}, 3.893519312803669*^9, {
   3.8935201259972086`*^9, 3.8935201693058376`*^9}, 3.893520658180394*^9, 
   3.894438590458749*^9, {3.8971453067542086`*^9, 3.897145319361229*^9}, {
   3.897145473916631*^9, 3.8971454869274044`*^9}, {3.9039677800427427`*^9, 
   3.9039677860126348`*^9}, {3.903967899409309*^9, 3.9039679648987923`*^9}, {
   3.903968151253366*^9, 3.9039681658659067`*^9}, {3.903968210451078*^9, 
   3.9039682893562775`*^9}, {3.903968351405848*^9, 3.903968382926297*^9}, {
   3.903968466355733*^9, 3.903968468809578*^9}, {3.903968515958439*^9, 
   3.903968533154929*^9}, {3.9039685763166847`*^9, 3.9039686127199583`*^9}, {
   3.9050601446041193`*^9, 3.9050601447702847`*^9}, 3.9102405948599553`*^9, {
   3.910246973719236*^9, 3.91024697372836*^9}, {3.910254934648507*^9, 
   3.9102549846685*^9}, {3.9102589844135933`*^9, 3.9102589881095257`*^9}, {
   3.9120567439699483`*^9, 3.9120567576003385`*^9}, {3.9120572701592507`*^9, 
   3.9120572704603386`*^9}},
 CellLabel->
  "In[471]:=",ExpressionUUID->"251d1973-d893-4f0d-89db-b6f082ac5b38"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Cross-sections", "Subsubsection",
 CellChangeTimes->{{3.8933256308713317`*^9, 
  3.8933256323468237`*^9}},ExpressionUUID->"8d8f307b-ebc0-4e6e-8dce-\
1993ef415004"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"MapThread", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"NPOTexperiment", "[", "#1", "]"}], "=", "#2"}], ")"}], "&"}], 
    ",", 
    RowBox[{"{", 
     RowBox[{"explistforehunt", ",", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"LFCChh", "*", 
         RowBox[{"\[Sigma]ppInpbFacility", "[", "\"\<FCC-hh\>\"", "]"}]}], 
        ",", 
        RowBox[{"Length", "[", "explistforehunt", "]"}]}], "]"}]}], "}"}]}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"AtargetExperiment", "[", "#1", "]"}], "=", "#2"}], ")"}], 
      "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistforehunt", ",", 
       RowBox[{"Table", "[", 
        RowBox[{"1.", ",", 
         RowBox[{"Length", "[", "explistforehunt", "]"}]}], "]"}]}], "}"}]}], 
    "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Cascade", " ", "enhancement", " ", "of", " ", "the", " ", "production", 
    " ", "relative", " ", "to", " ", "the", " ", "production", " ", "in", " ",
     "pure", " ", "pp", " ", 
    RowBox[{"collisions", ".", " ", "Relevant"}], " ", "for", " ", "fixed", 
    " ", "target", " ", "experiments"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "For", " ", "all", " ", "experiments", " ", "located", " ", "at", " ", 
     "SPS"}], ",", " ", 
    RowBox[{
     RowBox[{
      RowBox[{
      "the", " ", "cascade", " ", "fastors", " ", "is", " ", "taken", " ", 
       "from", " ", 
       RowBox[{"http", ":"}]}], "//", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"cds", ".", "cern", ".", "ch"}], "/", "record"}], "/", 
          "2115534"}], "/", "files"}], "/", "SHiP"}], "-", "NOTE", "-", 
       "2015", "-", 
       RowBox[{"009.", 
        RowBox[{"pdf", "?", "version"}]}]}]}], "=", "1"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"CascadeFactorbb", "[", "#1", "]"}], "=", "#2"}], ")"}], 
      "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistforehunt", ",", 
       RowBox[{"Table", "[", 
        RowBox[{"1.", ",", 
         RowBox[{"Length", "[", "explistforehunt", "]"}]}], "]"}]}], "}"}]}], 
    "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Fraction", " ", "of", " ", "produced", " ", "bb", " ", "per", " ", "PoT", 
    " ", "at", " ", "the", " ", "given", " ", "experiment"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"PppTobbExperiment", "[", "exp", "]"}], "=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"\[Sigma]ppTobbInpbFacility", "[", 
        RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}], "/", 
       RowBox[{"\[Sigma]ppInpbFacility", "[", 
        RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}]}], ")"}], 
     SuperscriptBox[
      RowBox[{"AtargetExperiment", "[", "exp", "]"}], "0.29"], "*", 
     RowBox[{"CascadeFactorbb", "[", "exp", "]"}]}]}], ",", 
   RowBox[{"{", 
    RowBox[{"exp", ",", "explistforehunt"}], "}"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"CascadeFactorcc", "[", "#1", "]"}], "=", "#2"}], ")"}], 
      "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistforehunt", ",", 
       RowBox[{"Table", "[", 
        RowBox[{"1.", ",", 
         RowBox[{"Length", "[", "explistforehunt", "]"}]}], "]"}]}], "}"}]}], 
    "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Fraction", " ", "of", " ", "produced", " ", "cc", " ", "per", " ", "PoT", 
    " ", "at", " ", "the", " ", "given", " ", "experiment"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"PppToccExperiment", "[", "exp", "]"}], "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"\[Sigma]ppToccInpbFacility", "[", 
         RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}], "/", 
        RowBox[{"\[Sigma]ppInpbFacility", "[", 
         RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}]}], ")"}], 
      SuperscriptBox[
       RowBox[{"AtargetExperiment", "[", "exp", "]"}], "0.29"], "*", 
      RowBox[{"CascadeFactorcc", "[", "exp", "]"}]}]}], ",", 
    RowBox[{"{", 
     RowBox[{"exp", ",", "explistforehunt"}], "}"}]}], "]"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Fraction", " ", "of", " ", "produced", " ", "h", " ", "per", " ", "PoT", 
    " ", "at", " ", "the", " ", "given", " ", "experiment"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"PppTohExperiment", "[", "exp", "]"}], "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"\[Sigma]ppTohInpbFacility", "[", 
          RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}], "/", 
         RowBox[{"\[Sigma]ppInpbFacility", "[", 
          RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}]}], ")"}], 
       SuperscriptBox[
        RowBox[{"AtargetExperiment", "[", "exp", "]"}], "0.29"]}]}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistforehunt"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Fraction", " ", "of", " ", "produced", " ", "W", " ", "per", " ", "PoT", 
    " ", "at", " ", "the", " ", "given", " ", "experiment"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"PppToWExperiment", "[", "exp", "]"}], "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"\[Sigma]ppToWInpbFacility", "[", 
          RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}], "/", 
         RowBox[{"\[Sigma]ppInpbFacility", "[", 
          RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}]}], ")"}], 
       SuperscriptBox[
        RowBox[{"AtargetExperiment", "[", "exp", "]"}], "0.29"]}]}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistforehunt"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Fraction", " ", "of", " ", "produced", " ", 
    SuperscriptBox["\[Pi]", "0"], " ", "per", " ", "PoT", " ", "at", " ", 
    "the", " ", "given", " ", "experiment"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"PppTo\[Pi]0exp", "[", "exp", "]"}], "=", 
      RowBox[{"PppTo\[Pi]0Facility", "[", 
       RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistforehunt"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Fraction", " ", "of", " ", "produced", " ", "\[Eta]", " ", "per", " ", 
    "PoT", " ", "at", " ", "the", " ", "given", " ", "experiment"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"PppTo\[Eta]exp", "[", "exp", "]"}], "=", 
      RowBox[{"PppTo\[Eta]Facility", "[", 
       RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistforehunt"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Fraction", " ", "of", " ", "produced", " ", 
    RowBox[{"\[Eta]", "'"}], " ", "per", " ", "PoT", " ", "at", " ", "the", 
    " ", "given", " ", "experiment"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"PppTo\[Eta]prexp", "[", "exp", "]"}], "=", 
      RowBox[{"PppTo\[Eta]prFacility", "[", 
       RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistforehunt"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Fraction", " ", "of", " ", "produced", " ", 
    SuperscriptBox["\[Rho]", "0"], " ", "per", " ", "PoT", " ", "at", " ", 
    "the", " ", "given", " ", "experiment"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"PppTo\[Rho]0exp", "[", "exp", "]"}], "=", 
      RowBox[{"PppTo\[Rho]0Facility", "[", 
       RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistforehunt"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Fraction", " ", "of", " ", "produced", " ", "\[Omega]", " ", "per", " ", 
    "PoT", " ", "at", " ", "the", " ", "given", " ", "experiment"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"PppTo\[Omega]exp", "[", "exp", "]"}], "=", 
     RowBox[{"PppTo\[Omega]Facility", "[", 
      RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"exp", ",", "explistforehunt"}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"PppToJpsiexp", "[", "exp", "]"}], "=", 
      RowBox[{
       RowBox[{"PppToJpsiFacility", "[", 
        RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}], 
       SuperscriptBox[
        RowBox[{"AtargetExperiment", "[", "exp", "]"}], "0.29"]}]}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistforehunt"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Fraction", " ", "of", " ", "produced", " ", "\[CapitalUpsilon]", 
    RowBox[{"(", 
     RowBox[{"1", "s"}], ")"}], " ", "per", " ", "PoT", " ", "at", " ", "the",
     " ", "given", " ", "experiment"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"PppToUpsilonexp", "[", "exp", "]"}], "=", 
      RowBox[{
       RowBox[{"PppToUpsilonFacility", "[", 
        RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}], 
       SuperscriptBox[
        RowBox[{"AtargetExperiment", "[", "exp", "]"}], "0.29"]}]}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistforehunt"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Fraction", " ", "of", " ", "produced", " ", "\[Phi]", " ", "at", " ", 
    "the", " ", "given", " ", "experiment"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"PppToPhiexp", "[", "exp", "]"}], "=", 
      RowBox[{"PppToPhiFacility", "[", 
       RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistforehunt"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Overall", " ", "table", " ", "with", " ", "cross"}], "-", 
    RowBox[{"sections", " ", "used", " ", "for", " ", "exporting"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"TableNumbersParticlesExperiment", "[", "exp", "]"}], "=", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "\"\<Facility\>\"", ",", "\"\<Npot\>\"", ",", "\"\<Atarget\>\"", ",", 
         "\"\<PPi0\>\"", ",", "\"\<PEta\>\"", ",", "\"\<PEtapr\>\"", ",", 
         "\"\<PRho0\>\"", ",", "\"\<POmega\>\"", ",", "\"\<Pc\>\"", ",", 
         "\"\<Pb\>\"", ",", "\"\<PW\>\"", ",", "\"\<Ph\>\"", ",", 
         "\"\<PJpsi\>\"", ",", "\"\<PUpsilon\>\"", ",", "\"\<PPhi\>\""}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"FacilityExperiment", "[", "exp", "]"}], ",", 
         RowBox[{"NPOTexperiment", "[", "exp", "]"}], ",", 
         RowBox[{"AtargetExperiment", "[", "exp", "]"}], ",", 
         RowBox[{"PppTo\[Pi]0exp", "[", "exp", "]"}], ",", 
         RowBox[{"PppTo\[Eta]exp", "[", "exp", "]"}], ",", 
         RowBox[{"PppTo\[Eta]prexp", "[", "exp", "]"}], ",", 
         RowBox[{"PppTo\[Rho]0exp", "[", "exp", "]"}], ",", 
         RowBox[{"PppTo\[Omega]exp", "[", "exp", "]"}], ",", 
         RowBox[{"2", 
          RowBox[{"PppToccExperiment", "[", "exp", "]"}]}], ",", 
         RowBox[{"2", 
          RowBox[{"PppTobbExperiment", "[", "exp", "]"}]}], ",", 
         RowBox[{"PppToWExperiment", "[", "exp", "]"}], ",", 
         RowBox[{"PppTohExperiment", "[", "exp", "]"}], ",", 
         RowBox[{"PppToJpsiexp", "[", "exp", "]"}], ",", 
         RowBox[{"PppToUpsilonexp", "[", "exp", "]"}], ",", 
         RowBox[{"PppToPhiexp", "[", "exp", "]"}]}], "}"}]}], "}"}], "//", 
     "N"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"exp", ",", "explistforehunt"}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.8933427867742977`*^9, 3.893342787584256*^9}, {
  3.8933428564379854`*^9, 3.893342856906787*^9}, {3.894178190964991*^9, 
  3.894178195020878*^9}, {3.89417867672976*^9, 3.894178679983819*^9}, {
  3.897235670917677*^9, 3.8972356883291435`*^9}, {3.8972861577158775`*^9, 
  3.897286163063202*^9}, {3.89919634103925*^9, 3.89919634136086*^9}, {
  3.899197050735374*^9, 3.8991970510611663`*^9}, {3.899197141071712*^9, 
  3.8991971412644176`*^9}, {3.903968288855678*^9, 3.9039682889308987`*^9}, {
  3.903968656261997*^9, 3.9039686634970975`*^9}},
 CellLabel->
  "In[506]:=",ExpressionUUID->"958cb9d4-5c58-416a-aab7-b920e8c6baa0"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Conditions for the LLP to decay inside the decay volume and for the products \
to point to the end of the detector\
\>", "Subsubsection",
 CellChangeTimes->{{3.905011297554874*^9, 3.9050113192993593`*^9}, 
   3.915437208918437*^9},ExpressionUUID->"c32a953b-71e1-4221-a5c5-\
945e22cece84"],

Cell[BoxData[
 RowBox[{"Do", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"IfLLPinsideDecVol", "[", 
      RowBox[{"zLLP_", ",", "xLLP_", ",", "yLLP_", ",", "exp"}], "]"}], "=", 
     RowBox[{"IfLLPinsideDecVolSimple", "[", "exp", "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"IfLLPtoDet", "[", 
        RowBox[{
        "x1LLPproj_", ",", "x2LLPproj_", ",", "xLongProj_", ",", "exp"}], 
        "]"}], ",", 
       RowBox[{"IfLLPnotToDet", "[", 
        RowBox[{
        "x1LLPproj_", ",", "x2LLPproj_", ",", "xLongProj_", ",", "exp"}], 
        "]"}]}], "}"}], "=", 
     RowBox[{"IfParticlePointsToDetSimple", "[", "exp", "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"IfLLPdecVolToDet", "[", 
      RowBox[{
      "zLLP_", ",", "xLLP_", ",", "yLLP_", ",", "x1LLPproj_", ",", 
       "x2LLPproj_", ",", "xLongProj_", ",", "exp"}], "]"}], "=", 
     RowBox[{
      RowBox[{"IfLLPinsideDecVol", "[", 
       RowBox[{"zLLP", ",", "xLLP", ",", "yLLP", ",", "exp"}], "]"}], "*", 
      RowBox[{"IfLLPtoDet", "[", 
       RowBox[{"x1LLPproj", ",", "x2LLPproj", ",", "xLongProj", ",", "exp"}], 
       "]"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"IfLLPdecVolNotToDet", "[", 
      RowBox[{
      "zLLP_", ",", "xLLP_", ",", "yLLP_", ",", "x1LLPproj_", ",", 
       "x2LLPproj_", ",", "xLongProj_", ",", "exp"}], "]"}], "=", 
     RowBox[{
      RowBox[{"IfLLPinsideDecVol", "[", 
       RowBox[{"zLLP", ",", "xLLP", ",", "yLLP", ",", "exp"}], "]"}], "*", 
      RowBox[{"IfLLPnotToDet", "[", 
       RowBox[{"x1LLPproj", ",", "x2LLPproj", ",", "xLongProj", ",", "exp"}], 
       "]"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"DecayAcceptanceGeometry", "[", 
      RowBox[{"coord1_", ",", "coord2_", ",", "xLongProj_", ",", "exp"}], 
      "]"}], "=", 
     RowBox[{"IfLLPtoDet", "[", 
      RowBox[{"coord1", ",", "coord2", ",", "xLongProj", ",", "exp"}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", ",", 
   RowBox[{"{", 
    RowBox[{"exp", ",", "explistforehunt"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.9050147846143217`*^9, 3.905014785994602*^9}, {
   3.9050148279824257`*^9, 3.9050148285220714`*^9}, 3.9050171518947716`*^9, {
   3.905059445023511*^9, 3.9050594452492447`*^9}, {3.910258574544112*^9, 
   3.910258640948514*^9}, 3.9102588185083313`*^9, 3.9102599357062497`*^9, {
   3.915437007035742*^9, 3.9154370915230637`*^9}, {3.915437208941408*^9, 
   3.9154372090203123`*^9}},
 CellLabel->
  "In[523]:=",ExpressionUUID->"bfdd3c87-57bf-4537-b530-45fdabd3cbed"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["CHARM/BEBC", "Subsection",
 CellChangeTimes->{{3.8933238849730096`*^9, 
  3.893323887421994*^9}},ExpressionUUID->"0bf4273c-be61-45b5-8a11-\
9a4b5d5d9d57"],

Cell[CellGroupData[{

Cell["Geometry", "Subsubsection",
 CellChangeTimes->{{3.893342623432827*^9, 
  3.893342624458*^9}},ExpressionUUID->"831a3c30-5693-4c5c-88f6-6c7605512b85"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"CHARM", "-", "approx", " ", "-", " ", 
    RowBox[{
    "just", " ", "a", " ", "box", " ", "with", " ", "dimensions", " ", "3", 
     "*", "3", "*", "35", " ", 
     RowBox[{
      SuperscriptBox["m", "3"], ".", " ", "CHARM"}]}], " ", "-", " ", 
    RowBox[{"the", " ", "accurate", " ", "implementation"}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"explistcharm", "=", 
     RowBox[{"{", 
      RowBox[{
      "\"\<CHARM-lepton\>\"", ",", "\"\<CHARM-photon\>\"", ",", 
       "\"\<BEBC\>\""}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Distance", " ", "to", " ", "the", " ", "fiducial", " ", "volume", " ", 
     "along", " ", "the", " ", "beamline", " ", 
     RowBox[{"axis", ".", " ", 
      RowBox[{"MapThread", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"list1", "[", "#", "]"}], "=", "#2"}], ")"}], "&"}], ",", 
        RowBox[{"{", 
         RowBox[{"listexp", ",", "listvals"}], "}"}]}], "]"}]}], " ", 
     "equates", " ", "the", " ", "elements", " ", "list1", " ", "with", " ", 
     "keys", " ", "from", " ", "listexp", " ", "to", " ", "the", " ", 
     "corresponding", " ", "elements", " ", "of", " ", "the", " ", "list", 
     " ", "listvals"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MapThread", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"zToDecayVolumeExperiment", "[", "#1", "]"}], "=", "#2"}], 
        ")"}], "&"}], ",", 
      RowBox[{"{", 
       RowBox[{"explistcharm", ",", 
        RowBox[{"{", 
         RowBox[{"480", ",", "480", ",", "404"}], "}"}]}], "}"}]}], "]"}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Detector", " ", "has", " ", "the", " ", "axis", " ", "along", " ", 
     "which", " ", "its", " ", "components", " ", "are", " ", 
     RowBox[{"placed", ".", " ", "The"}], " ", "option", " ", "below", " ", 
     "defines", " ", "the", " ", "orientation", " ", "of", " ", "the", " ", 
     "final", " ", "plane", " ", "transverse", " ", "to", " ", "this", " ", 
     "axis", " ", "relative", " ", "to", " ", "the", " ", "beamline"}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "Transverse", " ", "if", " ", "the", " ", "plane", " ", "is", " ", 
      "tranverse", " ", 
      RowBox[{"(", 
       RowBox[{"SHiP", ",", " ", 
        RowBox[{"FACET", " ", "etc"}]}], ")"}]}], ",", " ", 
     RowBox[{
     "and", " ", "Parallel", " ", "if", " ", "it", " ", "is", " ", "parallel",
       " ", 
      RowBox[{"(", 
       RowBox[{"MATHUSLA", ",", " ", "ANUBIS"}]}]}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MapThread", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"DetectorPlaneOrientationExperiment", "[", "#1", "]"}], "=", 
         "#2"}], ")"}], "&"}], ",", 
      RowBox[{"{", 
       RowBox[{"explistcharm", ",", 
        RowBox[{"Table", "[", 
         RowBox[{"\"\<Transverse\>\"", ",", 
          RowBox[{"Length", "[", "explistcharm", "]"}]}], "]"}]}], "}"}]}], 
     "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Facility", " ", "hosting", " ", "the", " ", 
      RowBox[{"experiment", ":", " ", "SPS"}]}], ",", " ", "Fermilab", ",", 
     " ", "LHC", ",", " ", 
     RowBox[{"FCC", "-", "hh"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MapThread", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"FacilityExperiment", "[", "#1", "]"}], "=", "#2"}], ")"}], 
       "&"}], ",", 
      RowBox[{"{", 
       RowBox[{"explistcharm", ",", 
        RowBox[{"Table", "[", 
         RowBox[{"\"\<SPS\>\"", ",", 
          RowBox[{"Length", "[", "explistcharm", "]"}]}], "]"}]}], "}"}]}], 
     "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Geometry", " ", "of", " ", "the", " ", 
      RowBox[{"experiment", ":", " ", "box"}]}], ",", " ", "cylinder", ",", 
     " ", 
     RowBox[{"annular", " ", "cylinder"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MapThread", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"GeometryExperiment", "[", "#1", "]"}], "=", "#2"}], ")"}], 
       "&"}], ",", 
      RowBox[{"{", 
       RowBox[{"explistcharm", ",", 
        RowBox[{"Table", "[", 
         RowBox[{"\"\<Box\>\"", ",", 
          RowBox[{"Length", "[", "explistcharm", "]"}]}], "]"}]}], "}"}]}], 
     "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "Transverse", " ", "dimensions", " ", "of", " ", "the", " ", "decay", 
      " ", "volume", " ", "assuming", " ", "box", " ", "geometry"}], ",", " ", 
     RowBox[{
     "or", " ", "cylindrical", " ", "geometry", " ", "if", " ", "the", " ", 
      "detector", " ", "plane", " ", "is", " ", "parallel", " ", "to", " ", 
      "the", " ", "beamline", " ", 
      RowBox[{
       RowBox[{"(", "ANUBIS", ")"}], ".", " ", "Otherwise"}], " ", "set", " ",
       "to", " ", "zero"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MapThread", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"dxDecayVolumeExperiment", "[", 
          RowBox[{"z_", ",", "#1"}], "]"}], "=", "#2"}], ")"}], "&"}], ",", 
      RowBox[{"{", 
       RowBox[{"explistcharm", ",", 
        RowBox[{"{", 
         RowBox[{"3.", ",", "3.", ",", "3.6"}], "}"}]}], "}"}]}], "]"}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MapThread", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"dyDecayVolumeExperiment", "[", 
          RowBox[{"z_", ",", "#1"}], "]"}], "=", "#2"}], ")"}], "&"}], ",", 
      RowBox[{"{", 
       RowBox[{"explistcharm", ",", 
        RowBox[{"{", 
         RowBox[{"3", ",", "3.", ",", "2.5"}], "}"}]}], "}"}]}], "]"}], ";"}],
    "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Decay", " ", "volume", " ", "length", " ", "along", " ", "the", " ", 
     "beamline", " ", "axis"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MapThread", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"dzDecayVolumeExperiment", "[", "#1", "]"}], "=", "#2"}], 
        ")"}], "&"}], ",", 
      RowBox[{"{", 
       RowBox[{"explistcharm", ",", 
        RowBox[{"{", 
         RowBox[{"35", ",", "35", ",", "1.85"}], "}"}]}], "}"}]}], "]"}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "Distance", " ", "from", " ", "the", " ", "beamline", " ", "to", " ", 
      "the", " ", "decay", " ", "volume", " ", "center", " ", "and", " ", 
      "detector", " ", "along", " ", "the", " ", "x"}], ",", 
     RowBox[{"y", " ", "axes"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MapThread", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"xToDecayVolumeCenterExperiment", "[", 
          RowBox[{"z_", ",", "#1"}], "]"}], "=", "#2"}], ")"}], "&"}], ",", 
      RowBox[{"{", 
       RowBox[{"explistcharm", ",", 
        RowBox[{"{", 
         RowBox[{"5.", ",", "5.", ",", "0"}], "}"}]}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MapThread", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"yToDecayVolumeCenterExperiment", "[", 
          RowBox[{"z_", ",", "#1"}], "]"}], "=", "#2"}], ")"}], "&"}], ",", 
      RowBox[{"{", 
       RowBox[{"explistcharm", ",", 
        RowBox[{"Table", "[", 
         RowBox[{"0", ",", 
          RowBox[{"Length", "[", "explistcharm", "]"}]}], "]"}]}], "}"}]}], 
     "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Inner", " ", "and", " ", "outer", " ", "radii", " ", "of", " ", "the", 
     " ", "decay", " ", 
     RowBox[{"volume", ".", " ", "Applicable"}], " ", "if", " ", "the", " ", 
     "decay", " ", "volume", " ", "has", " ", "cylindrical", " ", 
     "geometry"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"RinnerDecayVolumeExperiment", "[", 
        RowBox[{"exp", ",", "z_"}], "]"}], "=", "0"}], ",", 
      RowBox[{"{", 
       RowBox[{"exp", ",", "explistcharm"}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"RouterDecayVolumeExperiment", "[", 
        RowBox[{"exp", ",", "z_"}], "]"}], "=", "0"}], ",", 
      RowBox[{"{", 
       RowBox[{"exp", ",", "explistcharm"}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"z", "-", 
     RowBox[{
     "coordinate", " ", "of", " ", "the", " ", "center", " ", "of", " ", 
      "the", " ", "decay", " ", "volume"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"zToDecayVolumeCenterExperiment", "[", "exp", "]"}], "=", 
       RowBox[{
        RowBox[{"zToDecayVolumeExperiment", "[", "exp", "]"}], "+", 
        FractionBox[
         RowBox[{"dzDecayVolumeExperiment", "[", "exp", "]"}], "2"]}]}], ",", 
      RowBox[{"{", 
       RowBox[{"exp", ",", "explistcharm"}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Maximal", " ", 
     RowBox[{"long", ".", " ", "displacement"}], " ", "of", " ", "the", " ", 
     "decay", " ", "volume"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"zMaxDecayVolumeExperiment", "[", "exp", "]"}], "=", 
      RowBox[{
       RowBox[{"zToDecayVolumeExperiment", "[", "exp", "]"}], "+", 
       RowBox[{"dzDecayVolumeExperiment", "[", "exp", "]"}]}]}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistcharm"}], "}"}]}], "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Whether", " ", "the", " ", "decay", " ", "volume", " ", "serves", " ", 
     "as", " ", "detector", " ", 
     RowBox[{"(", 
      RowBox[{"True", " ", "or", " ", "False"}], ")"}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MapThread", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"DecayVolumeAsDetectorExperiment", "[", "#1", "]"}], "=", 
         "#2"}], ")"}], "&"}], ",", 
      RowBox[{"{", 
       RowBox[{"explistcharm", ",", 
        RowBox[{"{", 
         RowBox[{"\"\<False\>\"", ",", "\"\<False\>\"", ",", "\"\<True\>\""}],
          "}"}]}], "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Transverse", " ", "dimensions", " ", "of", " ", "the", " ", "detector", 
     " ", "assuming", " ", "box", " ", "geometry"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MapThread", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"dxDetectorExperiment", "[", 
          RowBox[{"#1", ",", "z_"}], "]"}], "=", "#2"}], ")"}], "&"}], ",", 
      RowBox[{"{", 
       RowBox[{"explistcharm", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"z", "<", 
             RowBox[{
              RowBox[{
              "zMaxDecayVolumeExperiment", "[", "\"\<CHARM-lepton\>\"", "]"}],
               "+", "5"}]}], ",", "4", ",", "3"}], "]"}], ",", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"z", "<", 
             RowBox[{
              RowBox[{
              "zMaxDecayVolumeExperiment", "[", "\"\<CHARM-photon\>\"", "]"}],
               "+", "5"}]}], ",", "4", ",", "3"}], "]"}], ",", "0"}], "}"}]}],
        "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MapThread", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"dyDetectorExperiment", "[", 
          RowBox[{"#1", ",", "z_"}], "]"}], "=", "#2"}], ")"}], "&"}], ",", 
      RowBox[{"{", 
       RowBox[{"explistcharm", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"z", "<", 
             RowBox[{
              RowBox[{
              "zMaxDecayVolumeExperiment", "[", "\"\<CHARM-lepton\>\"", "]"}],
               "+", "5"}]}], ",", "4", ",", "3"}], "]"}], ",", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"z", "<", 
             RowBox[{
              RowBox[{
              "zMaxDecayVolumeExperiment", "[", "\"\<CHARM-photon\>\"", "]"}],
               "+", "5"}]}], ",", "4", ",", "3"}], "]"}], ",", "0"}], "}"}]}],
        "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Length", " ", "of", " ", "the", " ", "detector", " ", "in", " ", "z", 
     " ", "plane"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MapThread", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"dzDetectorExperiment", "[", "#1", "]"}], "=", "#2"}], ")"}],
        "&"}], ",", 
      RowBox[{"{", 
       RowBox[{"explistcharm", ",", 
        RowBox[{"{", 
         RowBox[{"6.4", ",", "6.4", ",", "0"}], "}"}]}], "}"}]}], "]"}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Coordinates", " ", "of", " ", "the", " ", "center", " ", "of", " ", 
     "the", " ", "detector"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MapThread", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"xToDetectorCenterExperiment", "[", "#1", "]"}], "=", "#2"}],
         ")"}], "&"}], ",", 
      RowBox[{"{", 
       RowBox[{"explistcharm", ",", 
        RowBox[{"{", 
         RowBox[{"5.", ",", "5.", ",", "0"}], "}"}]}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"yToDetectorCenterExperiment", "[", "exp", "]"}], "=", "0"}], 
      ",", 
      RowBox[{"{", 
       RowBox[{"exp", ",", "explistcharm"}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"zToDetectorCenterExperiment", "[", "exp", "]"}], "=", 
       RowBox[{
        RowBox[{"zMaxDecayVolumeExperiment", "[", "exp", "]"}], "+", 
        FractionBox[
         RowBox[{"dzDetectorExperiment", "[", "exp", "]"}], "2"]}]}], ",", 
      RowBox[{"{", 
       RowBox[{"exp", ",", "explistcharm"}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Inner", " ", "and", " ", "outer", " ", "radii", " ", "of", " ", "the", 
     " ", "detector"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"RinnerDetectorExperiment", "[", 
        RowBox[{"exp", ",", "z_"}], "]"}], "=", "0"}], ",", 
      RowBox[{"{", 
       RowBox[{"exp", ",", "explistcharm"}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"RouterDetectorExperiment", "[", 
        RowBox[{"exp", ",", "z_"}], "]"}], "=", "0"}], ",", 
      RowBox[{"{", 
       RowBox[{"exp", ",", "explistcharm"}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "Length", " ", "of", " ", "the", " ", "detector", " ", "along", " ", 
      "the", " ", "detector", " ", 
      RowBox[{"axis", ".", " ", "For"}], " ", "the", " ", "detector", " ", 
      "oriented", " ", "parallel", " ", "to", " ", "the", " ", "beamline"}], 
     ",", " ", 
     RowBox[{
      RowBox[{"there", " ", "is", " ", "a", " ", "formal", " ", "z"}], "-", 
      "dependence"}], ",", " ", 
     RowBox[{
     "but", " ", "in", " ", "practice", " ", "there", " ", "are", " ", "no", 
      " ", "experiments", " ", "with", " ", "such", " ", "dependence"}], ",", 
     " ", 
     RowBox[{"so", " ", "it", " ", "is", " ", "suppressed"}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"dxLongDetectorExperiment", "[", "exp", "]"}], "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"DetectorPlaneOrientationExperiment", "[", "exp", "]"}], 
          "\[Equal]", "\"\<Transverse\>\""}], ",", 
         RowBox[{"dzDetectorExperiment", "[", "exp", "]"}], ",", 
         RowBox[{"dyDetectorExperiment", "[", 
          RowBox[{"exp", ",", "z"}], "]"}]}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"exp", ",", "explistcharm"}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "The", " ", "maximal", " ", "coordinate", " ", "of", " ", "the", " ", 
     "end", " ", "of", " ", "the", " ", "detector", " ", "plane", " ", 
     RowBox[{"(", 
      RowBox[{"along", " ", "the", " ", "detector", " ", "axis"}], ")"}], " ",
      "used", " ", "to", " ", "calculate", " ", "the", " ", "decay", " ", 
     RowBox[{"acceptance", ".", " ", "May"}], " ", "be", " ", "either", " ", 
     "the", " ", "z", " ", "coordinate", " ", "or", " ", "the", " ", "y", " ",
      "coordinate", " ", 
     RowBox[{"(", 
      RowBox[{
      "if", " ", "the", " ", "final", " ", "detector", " ", "plane", " ", 
       "is", " ", "oriented", " ", "parallel", " ", "to", " ", "the", " ", 
       "beamline"}], ")"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"xLongMaxDetectorExperiment", "[", "exp", "]"}], "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"DetectorPlaneOrientationExperiment", "[", "exp", "]"}], 
          "\[Equal]", "\"\<Transverse\>\""}], ",", 
         RowBox[{
          RowBox[{"zMaxDecayVolumeExperiment", "[", "exp", "]"}], "+", 
          RowBox[{"dxLongDetectorExperiment", "[", "exp", "]"}]}], ",", 
         RowBox[{
          RowBox[{"yToDetectorCenterExperiment", "[", "exp", "]"}], "+", 
          RowBox[{
           RowBox[{"dyDetectorExperiment", "[", 
            RowBox[{"exp", ",", "z"}], "]"}], "/", "2"}]}]}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"exp", ",", "explistcharm"}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Whether", " ", "the", " ", "experiment", " ", "has", " ", "dipole", " ", 
     "magnet", " ", "in", " ", "the", " ", "detector", " ", 
     RowBox[{"(", 
      RowBox[{"True", ",", " ", "False"}], ")"}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MapThread", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"DipoleMagnetOptionExperiment", "[", "#1", "]"}], "=", 
         "#2"}], ")"}], "&"}], ",", 
      RowBox[{"{", 
       RowBox[{"explistcharm", ",", 
        RowBox[{"{", 
         RowBox[{
         "\"\<False\>\"", ",", "\"\<False\>\"", ",", "\"\<False\>\""}], 
         "}"}]}], "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Longitudinal", " ", "positions", " ", "of", " ", "the", " ", "dipole", 
     " ", "magnet", " ", "of", " ", "the", " ", "detector"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MapThread", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"zMagnetMinExperiment", "[", "#1", "]"}], "=", "#2"}], ")"}],
        "&"}], ",", 
      RowBox[{"{", 
       RowBox[{"explistcharm", ",", 
        RowBox[{"Table", "[", 
         RowBox[{"0", ",", 
          RowBox[{"Length", "[", "explistcharm", "]"}]}], "]"}]}], "}"}]}], 
     "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MapThread", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"zMagnetMaxExperiment", "[", "#1", "]"}], "=", "#2"}], ")"}],
        "&"}], ",", 
      RowBox[{"{", 
       RowBox[{"explistcharm", ",", 
        RowBox[{"Table", "[", 
         RowBox[{"0", ",", 
          RowBox[{"Length", "[", "explistcharm", "]"}]}], "]"}]}], "}"}]}], 
     "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Mean", " ", "magnetic", " ", "field", " ", "of", " ", "the", " ", 
     "dipole", " ", "magnet"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MapThread", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"MagneticFieldExperiment", "[", "#1", "]"}], "=", "#2"}], 
        ")"}], "&"}], ",", 
      RowBox[{"{", 
       RowBox[{"explistcharm", ",", 
        RowBox[{"Table", "[", 
         RowBox[{"0", ",", 
          RowBox[{"Length", "[", "explistcharm", "]"}]}], "]"}]}], "}"}]}], 
     "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"ECAL", " ", "option", " ", 
     RowBox[{"(", 
      RowBox[{"True", ",", "False"}], ")"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MapThread", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"ECALoptionExperiment", "[", "#1", "]"}], "=", "#2"}], ")"}],
        "&"}], ",", 
      RowBox[{"{", 
       RowBox[{"explistcharm", ",", 
        RowBox[{"{", 
         RowBox[{"\"\<True\>\"", ",", "\"\<True\>\"", ",", "\"\<True\>\""}], 
         "}"}]}], "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Position", " ", "of", " ", "the", " ", "beginning", " ", "of", " ", 
     "the", " ", "ECAL"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MapThread", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"zECALminExperiment", "[", "#1", "]"}], "=", "#2"}], ")"}], 
       "&"}], ",", 
      RowBox[{"{", 
       RowBox[{"explistcharm", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{
           "zMaxDecayVolumeExperiment", "[", "\"\<CHARM-lepton\>\"", "]"}], 
           "+", "5."}], ",", 
          RowBox[{
           RowBox[{
           "zMaxDecayVolumeExperiment", "[", "\"\<CHARM-lepton\>\"", "]"}], 
           "+", "5."}], ",", "0."}], "}"}]}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "The", " ", "final", " ", "detector", " ", "plane", " ", "needed", " ", 
      "to", " ", "reconstruct", " ", 
      RowBox[{"muons", ".", " ", "Depeding"}], " ", "on", " ", "the", " ", 
      "experiment"}], ",", " ", 
     RowBox[{
     "it", " ", "is", " ", "approximated", " ", "by", " ", "be", " ", "end", 
      " ", "of", " ", "the", " ", "trackers", " ", "or", " ", "the", " ", 
      "muon", " ", "system"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MapThread", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"xLongMuonPlaneExperiment", "[", "#1", "]"}], "=", "#2"}], 
        ")"}], "&"}], ",", 
      RowBox[{"{", 
       RowBox[{"explistcharm", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
          "xLongMaxDetectorExperiment", "[", "\"\<CHARM-lepton\>\"", "]"}], 
          ",", 
          RowBox[{
          "xLongMaxDetectorExperiment", "[", "\"\<CHARM-lepton\>\"", "]"}], 
          ",", "0."}], "}"}]}], "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "The", " ", "final", " ", "detector", " ", "plane", " ", "needed", " ", 
      "to", " ", "reconstruct", " ", "other", " ", 
      RowBox[{"particles", ".", " ", "Depeding"}], " ", "on", " ", "the", " ",
       "experiment"}], ",", " ", 
     RowBox[{
     "it", " ", "is", " ", "approximated", " ", "by", " ", "the", " ", "end", 
      " ", "of", " ", "the", " ", "trackers", " ", "or", " ", "the", " ", 
      "calorimeter", " ", "system"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MapThread", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"xLongNonMuonPlaneExperiment", "[", "#1", "]"}], "=", "#2"}],
         ")"}], "&"}], ",", 
      RowBox[{"{", 
       RowBox[{"explistcharm", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
          "xLongMaxDetectorExperiment", "[", "\"\<CHARM-lepton\>\"", "]"}], 
          ",", 
          RowBox[{
          "xLongMaxDetectorExperiment", "[", "\"\<CHARM-lepton\>\"", "]"}], 
          ",", "0."}], "}"}]}], "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"List", " ", "of", " ", "detectable", " ", 
      RowBox[{"particles", ".", " ", "If"}], " ", "ECAL", " ", "is", " ", 
      "absent"}], ",", " ", 
     RowBox[{
     "it", " ", "is", " ", "assumed", " ", "by", " ", "default", " ", "that", 
      " ", "photons", " ", "and", " ", 
      SubscriptBox[
       SuperscriptBox["K", "0"], "L"], " ", "cannot", " ", "be", " ", 
      "detected"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MapThread", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"DetectablePDGsExperiment", "[", "#1", "]"}], "=", "#2"}], 
        ")"}], "&"}], ",", 
      RowBox[{"{", 
       RowBox[{"explistcharm", ",", 
        RowBox[{"Table", "[", 
         RowBox[{"detectablepdgs", ",", 
          RowBox[{"Length", "[", "explistcharm", "]"}]}], "]"}]}], "}"}]}], 
     "]"}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.8933427163770285`*^9, 3.8933427165017796`*^9}, {
   3.8934862861896596`*^9, 3.893486289088214*^9}, {3.8935181370326858`*^9, 
   3.8935181370396633`*^9}, 3.8935193128285995`*^9, {3.893520126015787*^9, 
   3.8935201693233404`*^9}, 3.8935206582013364`*^9, 3.8944385905609975`*^9, {
   3.8971453068488083`*^9, 3.8971453193869333`*^9}, {3.897145473943385*^9, 
   3.89714548695183*^9}, {3.9037182256053963`*^9, 3.903718237169443*^9}, {
   3.904793505323389*^9, 3.9047935074114285`*^9}, {3.905060156349679*^9, 
   3.9050601564937086`*^9}, {3.905844774239874*^9, 3.905844830566165*^9}, {
   3.905844935224097*^9, 3.905844946000619*^9}, {3.9058449838536916`*^9, 
   3.9058450056774025`*^9}, {3.910087213069948*^9, 3.910087256423954*^9}, {
   3.9100873630059533`*^9, 3.910087373118677*^9}, {3.9100874149438844`*^9, 
   3.9100875447348804`*^9}, {3.9101149467047443`*^9, 3.910114949511526*^9}, {
   3.9101155153491173`*^9, 3.9101155339125924`*^9}, {3.9101755654042964`*^9, 
   3.9101756133052735`*^9}, {3.9101756878417835`*^9, 
   3.9101756927283564`*^9}, {3.9101757512590055`*^9, 
   3.9101758002703714`*^9}, {3.910197551105809*^9, 3.9101975533184953`*^9}, {
   3.910238949133443*^9, 3.910238967831975*^9}, {3.9102391963599896`*^9, 
   3.9102392056198654`*^9}, {3.9102392556537323`*^9, 3.9102392713517385`*^9}, 
   3.910239305966564*^9, {3.9102393956968513`*^9, 3.9102393977677116`*^9}, {
   3.910239461012639*^9, 3.9102394639926662`*^9}, {3.91023965343082*^9, 
   3.910239676720764*^9}, {3.9102401545359735`*^9, 3.910240157880411*^9}, {
   3.910240210773418*^9, 3.910240247062948*^9}, {3.910240380609844*^9, 
   3.9102404605309296`*^9}, {3.9102405948791466`*^9, 
   3.9102407113047547`*^9}, {3.91024078226086*^9, 3.910240819911004*^9}, {
   3.9102409780987215`*^9, 3.910241061491067*^9}, {3.9102469737393837`*^9, 
   3.91024697375095*^9}, {3.910249438741277*^9, 3.9102494574491634`*^9}, {
   3.910253704854047*^9, 3.910253735496501*^9}, {3.9102553536951857`*^9, 
   3.910255369303791*^9}, {3.9120567627627516`*^9, 3.9120567639391356`*^9}, {
   3.912057020024164*^9, 3.912057022325097*^9}, {3.9120571715429688`*^9, 
   3.912057178729032*^9}, {3.912057265008877*^9, 3.912057265270726*^9}},
 CellLabel->
  "In[524]:=",ExpressionUUID->"e3ff9ce8-5382-4cce-82e5-24e9c94b91bd"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Cross-sections", "Subsubsection",
 CellChangeTimes->{{3.8933256308713317`*^9, 
  3.8933256323468237`*^9}},ExpressionUUID->"26c5373f-244a-4f26-9d83-\
f8f86200fc98"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "0.1", " ", "stays", " ", "for", " ", "10", " ", "times", " ", "lower", 
    " ", "luminosity", " ", "of", " ", "LHCb", " ", "in", " ", "high", " ", 
    "lumi", " ", "phase", " ", "compared", " ", "to", " ", 
    RowBox[{"ATLAS", "/", "CMS"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"MapThread", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"NPOTexperiment", "[", "#1", "]"}], "=", "#2"}], ")"}], 
       "&"}], ",", 
      RowBox[{"{", 
       RowBox[{"explistcharm", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"2.4", "*", 
           SuperscriptBox["10", "18"]}], ",", 
          RowBox[{"2.4", "*", 
           SuperscriptBox["10", "18"]}], ",", 
          RowBox[{"2.72", "*", 
           SuperscriptBox["10", "18"]}]}], "}"}]}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MapThread", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"AtargetExperiment", "[", "#1", "]"}], "=", "#2"}], ")"}], 
       "&"}], ",", 
      RowBox[{"{", 
       RowBox[{"explistcharm", ",", 
        RowBox[{"{", 
         RowBox[{"64", ",", "64", ",", "64"}], "}"}]}], "}"}]}], "]"}], ";"}],
    "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Cascade", " ", "enhancement", " ", "of", " ", "the", " ", "production", 
     " ", "relative", " ", "to", " ", "the", " ", "production", " ", "in", 
     " ", "pure", " ", "pp", " ", 
     RowBox[{"collisions", ".", " ", "Relevant"}], " ", "for", " ", "fixed", 
     " ", "target", " ", "experiments"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "For", " ", "all", " ", "experiments", " ", "located", " ", "at", " ", 
      "SPS"}], ",", " ", 
     RowBox[{
      RowBox[{
       RowBox[{
       "the", " ", "cascade", " ", "charmtors", " ", "is", " ", "taken", " ", 
        "from", " ", 
        RowBox[{"http", ":"}]}], "//", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"cds", ".", "cern", ".", "ch"}], "/", "record"}], "/", 
           "2115534"}], "/", "files"}], "/", "SHiP"}], "-", "NOTE", "-", 
        "2015", "-", 
        RowBox[{"009.", 
         RowBox[{"pdf", "?", "version"}]}]}]}], "=", "1"}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MapThread", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"CascadeFactorbb", "[", "#1", "]"}], "=", "#2"}], ")"}], 
       "&"}], ",", 
      RowBox[{"{", 
       RowBox[{"explistcharm", ",", 
        RowBox[{"Table", "[", 
         RowBox[{"1.", ",", 
          RowBox[{"Length", "[", "explistcharm", "]"}]}], "]"}]}], "}"}]}], 
     "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Fraction", " ", "of", " ", "produced", " ", "bb", " ", "per", " ", "PoT",
      " ", "at", " ", "the", " ", "given", " ", "experiment"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"PppTobbExperiment", "[", "exp", "]"}], "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"\[Sigma]ppTobbInpbFacility", "[", 
          RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}], "/", 
         RowBox[{"\[Sigma]ppInpbFacility", "[", 
          RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}]}], ")"}], 
       SuperscriptBox[
        RowBox[{"AtargetExperiment", "[", "exp", "]"}], "0.29"], "*", 
       RowBox[{"CascadeFactorbb", "[", "exp", "]"}]}]}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistcharm"}], "}"}]}], "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MapThread", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"CascadeFactorcc", "[", "#1", "]"}], "=", "#2"}], ")"}], 
       "&"}], ",", 
      RowBox[{"{", 
       RowBox[{"explistcharm", ",", 
        RowBox[{"Table", "[", 
         RowBox[{"1.", ",", 
          RowBox[{"Length", "[", "explistcharm", "]"}]}], "]"}]}], "}"}]}], 
     "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Fraction", " ", "of", " ", "produced", " ", "cc", " ", "per", " ", "PoT",
      " ", "at", " ", "the", " ", "given", " ", "experiment"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"PppToccExperiment", "[", "exp", "]"}], "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"\[Sigma]ppToccInpbFacility", "[", 
          RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}], "/", 
         RowBox[{"\[Sigma]ppInpbFacility", "[", 
          RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}]}], ")"}], 
       SuperscriptBox[
        RowBox[{"AtargetExperiment", "[", "exp", "]"}], "0.29"], "*", 
       RowBox[{"CascadeFactorcc", "[", "exp", "]"}]}]}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistcharm"}], "}"}]}], "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Fraction", " ", "of", " ", "produced", " ", "h", " ", "per", " ", "PoT", 
     " ", "at", " ", "the", " ", "given", " ", "experiment"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"PppTohExperiment", "[", "exp", "]"}], "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\[Sigma]ppTohInpbFacility", "[", 
           RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}], "/", 
          RowBox[{"\[Sigma]ppInpbFacility", "[", 
           RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}]}], ")"}], 
        SuperscriptBox[
         RowBox[{"AtargetExperiment", "[", "exp", "]"}], "0.29"]}]}], ",", 
      RowBox[{"{", 
       RowBox[{"exp", ",", "explistcharm"}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Fraction", " ", "of", " ", "produced", " ", "W", " ", "per", " ", "PoT", 
     " ", "at", " ", "the", " ", "given", " ", "experiment"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"PppToWExperiment", "[", "exp", "]"}], "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\[Sigma]ppToWInpbFacility", "[", 
           RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}], "/", 
          RowBox[{"\[Sigma]ppInpbFacility", "[", 
           RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}]}], ")"}], 
        SuperscriptBox[
         RowBox[{"AtargetExperiment", "[", "exp", "]"}], "0.29"]}]}], ",", 
      RowBox[{"{", 
       RowBox[{"exp", ",", "explistcharm"}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Fraction", " ", "of", " ", "produced", " ", 
     SuperscriptBox["\[Pi]", "0"], " ", "per", " ", "PoT", " ", "at", " ", 
     "the", " ", "given", " ", "experiment"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"PppTo\[Pi]0exp", "[", "exp", "]"}], "=", 
       RowBox[{"PppTo\[Pi]0Facility", "[", 
        RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"exp", ",", "explistcharm"}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Fraction", " ", "of", " ", "produced", " ", "\[Eta]", " ", "per", " ", 
     "PoT", " ", "at", " ", "the", " ", "given", " ", "experiment"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"PppTo\[Eta]exp", "[", "exp", "]"}], "=", 
       RowBox[{"PppTo\[Eta]Facility", "[", 
        RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"exp", ",", "explistcharm"}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Fraction", " ", "of", " ", "produced", " ", 
     RowBox[{"\[Eta]", "'"}], " ", "per", " ", "PoT", " ", "at", " ", "the", 
     " ", "given", " ", "experiment"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"PppTo\[Eta]prexp", "[", "exp", "]"}], "=", 
       RowBox[{"PppTo\[Eta]prFacility", "[", 
        RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"exp", ",", "explistcharm"}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Fraction", " ", "of", " ", "produced", " ", 
     SuperscriptBox["\[Rho]", "0"], " ", "per", " ", "PoT", " ", "at", " ", 
     "the", " ", "given", " ", "experiment"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"PppTo\[Rho]0exp", "[", "exp", "]"}], "=", 
       RowBox[{"PppTo\[Rho]0Facility", "[", 
        RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"exp", ",", "explistcharm"}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Fraction", " ", "of", " ", "produced", " ", "\[Omega]", " ", "per", " ", 
     "PoT", " ", "at", " ", "the", " ", "given", " ", "experiment"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"PppTo\[Omega]exp", "[", "exp", "]"}], "=", 
       RowBox[{"PppTo\[Omega]Facility", "[", 
        RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"exp", ",", "explistcharm"}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"PppToJpsiexp", "[", "exp", "]"}], "=", 
       RowBox[{
        RowBox[{"PppToJpsiFacility", "[", 
         RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}], 
        SuperscriptBox[
         RowBox[{"AtargetExperiment", "[", "exp", "]"}], "0.29"]}]}], ",", 
      RowBox[{"{", 
       RowBox[{"exp", ",", "explistcharm"}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Fraction", " ", "of", " ", "produced", " ", "\[CapitalUpsilon]", 
     RowBox[{"(", 
      RowBox[{"1", "s"}], ")"}], " ", "per", " ", "PoT", " ", "at", " ", 
     "the", " ", "given", " ", "experiment"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"PppToUpsilonexp", "[", "exp", "]"}], "=", 
       RowBox[{
        RowBox[{"PppToUpsilonFacility", "[", 
         RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}], 
        SuperscriptBox[
         RowBox[{"AtargetExperiment", "[", "exp", "]"}], "0.29"]}]}], ",", 
      RowBox[{"{", 
       RowBox[{"exp", ",", "explistcharm"}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Fraction", " ", "of", " ", "produced", " ", "\[Phi]", " ", "at", " ", 
     "the", " ", "given", " ", "experiment"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"PppToPhiexp", "[", "exp", "]"}], "=", 
       RowBox[{"PppToPhiFacility", "[", 
        RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"exp", ",", "explistcharm"}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Overall", " ", "table", " ", "with", " ", "cross"}], "-", 
     RowBox[{"sections", " ", "used", " ", "for", " ", "exporting"}]}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"TableNumbersParticlesExperiment", "[", "exp", "]"}], "=", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "\"\<Facility\>\"", ",", "\"\<Npot\>\"", ",", "\"\<Atarget\>\"", 
           ",", "\"\<PPi0\>\"", ",", "\"\<PEta\>\"", ",", "\"\<PEtapr\>\"", 
           ",", "\"\<PRho0\>\"", ",", "\"\<POmega\>\"", ",", "\"\<Pc\>\"", 
           ",", "\"\<Pb\>\"", ",", "\"\<PW\>\"", ",", "\"\<Ph\>\"", ",", 
           "\"\<PJpsi\>\"", ",", "\"\<PUpsilon\>\"", ",", "\"\<PPhi\>\""}], 
          "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"FacilityExperiment", "[", "exp", "]"}], ",", 
           RowBox[{"NPOTexperiment", "[", "exp", "]"}], ",", 
           RowBox[{"AtargetExperiment", "[", "exp", "]"}], ",", 
           RowBox[{"PppTo\[Pi]0exp", "[", "exp", "]"}], ",", 
           RowBox[{"PppTo\[Eta]exp", "[", "exp", "]"}], ",", 
           RowBox[{"PppTo\[Eta]prexp", "[", "exp", "]"}], ",", 
           RowBox[{"PppTo\[Rho]0exp", "[", "exp", "]"}], ",", 
           RowBox[{"PppTo\[Omega]exp", "[", "exp", "]"}], ",", 
           RowBox[{"2", 
            RowBox[{"PppToccExperiment", "[", "exp", "]"}]}], ",", 
           RowBox[{"2", 
            RowBox[{"PppTobbExperiment", "[", "exp", "]"}]}], ",", 
           RowBox[{"PppToWExperiment", "[", "exp", "]"}], ",", 
           RowBox[{"PppTohExperiment", "[", "exp", "]"}], ",", 
           RowBox[{"PppToJpsiexp", "[", "exp", "]"}], ",", 
           RowBox[{"PppToUpsilonexp", "[", "exp", "]"}], ",", 
           RowBox[{"PppToPhiexp", "[", "exp", "]"}]}], "}"}]}], "}"}], "//", 
       "N"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistcharm"}], "}"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.894178224580597*^9, 3.894178228878416*^9}, {
   3.894178710558771*^9, 3.8941787129854965`*^9}, {3.897235759635209*^9, 
   3.897235773261158*^9}, {3.897286203175988*^9, 3.897286207686475*^9}, 
   3.899196372180955*^9, 3.899197078789237*^9, {3.899197141927063*^9, 
   3.899197142150679*^9}, {3.9049623723089385`*^9, 3.9049623763905563`*^9}, {
   3.905276872892951*^9, 3.9052768737431355`*^9}, {3.90527694205462*^9, 
   3.905276942281592*^9}, {3.905493112602626*^9, 3.905493114399027*^9}, {
   3.90584501119835*^9, 3.905845012761836*^9}, {3.9100875497439566`*^9, 
   3.9100875520949993`*^9}, {3.9102411035996113`*^9, 3.910241106011484*^9}},
 CellLabel->
  "In[558]:=",ExpressionUUID->"de67c2f2-18ed-4af2-a5b1-b32b447e39d7"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Conditions for the LLP to decay inside the decay volume and for the products \
to point to the end of the detector\
\>", "Subsubsection",
 CellChangeTimes->{{3.905011297554874*^9, 3.9050113192993593`*^9}, 
   3.915437209026806*^9},ExpressionUUID->"3566005e-ff5d-496f-9f02-\
93df8acffc80"],

Cell[BoxData[
 RowBox[{"Do", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"IfLLPinsideDecVol", "[", 
      RowBox[{"zLLP_", ",", "xLLP_", ",", "yLLP_", ",", "exp"}], "]"}], "=", 
     RowBox[{"IfLLPinsideDecVolSimple", "[", "exp", "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"IfLLPtoDet", "[", 
        RowBox[{
        "x1LLPproj_", ",", "x2LLPproj_", ",", "xLongProj_", ",", "exp"}], 
        "]"}], ",", 
       RowBox[{"IfLLPnotToDet", "[", 
        RowBox[{
        "x1LLPproj_", ",", "x2LLPproj_", ",", "xLongProj_", ",", "exp"}], 
        "]"}]}], "}"}], "=", 
     RowBox[{"IfParticlePointsToDetSimple", "[", "exp", "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"IfLLPdecVolToDet", "[", 
      RowBox[{
      "zLLP_", ",", "xLLP_", ",", "yLLP_", ",", "x1LLPproj_", ",", 
       "x2LLPproj_", ",", "xLongProj_", ",", "exp"}], "]"}], "=", 
     RowBox[{
      RowBox[{"IfLLPinsideDecVol", "[", 
       RowBox[{"zLLP", ",", "xLLP", ",", "yLLP", ",", "exp"}], "]"}], "*", 
      RowBox[{"IfLLPtoDet", "[", 
       RowBox[{"x1LLPproj", ",", "x2LLPproj", ",", "xLongProj", ",", "exp"}], 
       "]"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"IfLLPdecVolNotToDet", "[", 
      RowBox[{
      "zLLP_", ",", "xLLP_", ",", "yLLP_", ",", "x1LLPproj_", ",", 
       "x2LLPproj_", ",", "xLongProj_", ",", "exp"}], "]"}], "=", 
     RowBox[{
      RowBox[{"IfLLPinsideDecVol", "[", 
       RowBox[{"zLLP", ",", "xLLP", ",", "yLLP", ",", "exp"}], "]"}], "*", 
      RowBox[{"IfLLPnotToDet", "[", 
       RowBox[{"x1LLPproj", ",", "x2LLPproj", ",", "xLongProj", ",", "exp"}], 
       "]"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"DecayAcceptanceGeometry", "[", 
      RowBox[{"coord1_", ",", "coord2_", ",", "xLongProj_", ",", "exp"}], 
      "]"}], "=", 
     RowBox[{"IfLLPtoDet", "[", 
      RowBox[{"coord1", ",", "coord2", ",", "xLongProj", ",", "exp"}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", ",", 
   RowBox[{"{", 
    RowBox[{"exp", ",", "explistcharm"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.905014855491304*^9, 3.9050148560846004`*^9}, 
   3.90501715189884*^9, {3.905059452175317*^9, 3.9050594523791046`*^9}, {
   3.9102458525018044`*^9, 3.9102459040195937`*^9}, {3.9154370070600004`*^9, 
   3.9154370915266595`*^9}, {3.9154372090463886`*^9, 3.9154372091208496`*^9}},
 CellLabel->
  "In[575]:=",ExpressionUUID->"ea75023f-e6af-48e1-823d-903a117ed48c"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["NuCal", "Subsection",
 CellChangeTimes->{{3.8933238849730096`*^9, 3.893323887421994*^9}, {
  3.9104115578400574`*^9, 
  3.9104115583729467`*^9}},ExpressionUUID->"cb11b78f-aa65-4dc6-917d-\
a007b5b84062"],

Cell[CellGroupData[{

Cell["Geometry", "Subsubsection",
 CellChangeTimes->{{3.893342623432827*^9, 
  3.893342624458*^9}},ExpressionUUID->"66e0ec27-e432-4aec-9346-1d21923ba8c8"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"explistnucal", "=", 
    RowBox[{"{", "\"\<NuCal\>\"", "}"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Distance", " ", "to", " ", "the", " ", "fiducial", " ", "volume", " ", 
    "along", " ", "the", " ", "beamline", " ", 
    RowBox[{"axis", ".", " ", 
     RowBox[{"MapThread", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"list1", "[", "#", "]"}], "=", "#2"}], ")"}], "&"}], ",", 
       RowBox[{"{", 
        RowBox[{"listexp", ",", "listvals"}], "}"}]}], "]"}]}], " ", 
    "equates", " ", "the", " ", "elements", " ", "list1", " ", "with", " ", 
    "keys", " ", "from", " ", "listexp", " ", "to", " ", "the", " ", 
    "corresponding", " ", "elements", " ", "of", " ", "the", " ", "list", " ",
     "listvals"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"zToDecayVolumeExperiment", "[", "#1", "]"}], "=", "#2"}], 
       ")"}], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistnucal", ",", 
       RowBox[{"{", "63", "}"}]}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Detector", " ", "has", " ", "the", " ", "axis", " ", "along", " ", 
    "which", " ", "its", " ", "components", " ", "are", " ", 
    RowBox[{"placed", ".", " ", "The"}], " ", "option", " ", "below", " ", 
    "defines", " ", "the", " ", "orientation", " ", "of", " ", "the", " ", 
    "final", " ", "plane", " ", "transverse", " ", "to", " ", "this", " ", 
    "axis", " ", "relative", " ", "to", " ", "the", " ", "beamline"}], "*)"}],
   "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Transverse", " ", "if", " ", "the", " ", "plane", " ", "is", " ", 
     "tranverse", " ", 
     RowBox[{"(", 
      RowBox[{"SHiP", ",", " ", 
       RowBox[{"FACET", " ", "etc"}]}], ")"}]}], ",", " ", 
    RowBox[{
    "and", " ", "Parallel", " ", "if", " ", "it", " ", "is", " ", "parallel", 
     " ", 
     RowBox[{"(", 
      RowBox[{"MATHUSLA", ",", " ", "ANUBIS"}]}]}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"DetectorPlaneOrientationExperiment", "[", "#1", "]"}], "=", 
        "#2"}], ")"}], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistnucal", ",", 
       RowBox[{"Table", "[", 
        RowBox[{"\"\<Transverse\>\"", ",", 
         RowBox[{"Length", "[", "explistnucal", "]"}]}], "]"}]}], "}"}]}], 
    "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Facility", " ", "hosting", " ", "the", " ", 
     RowBox[{"experiment", ":", " ", "SPS"}]}], ",", " ", "Fermilab", ",", 
    " ", "LHC", ",", " ", 
    RowBox[{"FCC", "-", "hh"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"FacilityExperiment", "[", "#1", "]"}], "=", "#2"}], ")"}], 
      "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistnucal", ",", 
       RowBox[{"Table", "[", 
        RowBox[{"\"\<Serpukhov\>\"", ",", 
         RowBox[{"Length", "[", "explistnucal", "]"}]}], "]"}]}], "}"}]}], 
    "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Geometry", " ", "of", " ", "the", " ", 
     RowBox[{"experiment", ":", " ", "box"}]}], ",", " ", "cylinder", ",", 
    " ", 
    RowBox[{"annular", " ", "cylinder"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"GeometryExperiment", "[", "#1", "]"}], "=", "#2"}], ")"}], 
      "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistnucal", ",", 
       RowBox[{"Table", "[", 
        RowBox[{"\"\<Box\>\"", ",", 
         RowBox[{"Length", "[", "explistnucal", "]"}]}], "]"}]}], "}"}]}], 
    "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Transverse", " ", "dimensions", " ", "of", " ", "the", " ", "decay", " ",
      "volume", " ", "assuming", " ", "box", " ", "geometry"}], ",", " ", 
    RowBox[{
    "or", " ", "cylindrical", " ", "geometry", " ", "if", " ", "the", " ", 
     "detector", " ", "plane", " ", "is", " ", "parallel", " ", "to", " ", 
     "the", " ", "beamline", " ", 
     RowBox[{
      RowBox[{"(", "ANUBIS", ")"}], ".", " ", "Otherwise"}], " ", "set", " ", 
     "to", " ", "zero"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MapThread", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"dxDecayVolumeExperiment", "[", 
        RowBox[{"z_", ",", "#1"}], "]"}], "=", "#2"}], ")"}], "&"}], ",", 
    RowBox[{"{", 
     RowBox[{"explistnucal", ",", 
      RowBox[{"{", "2.6", "}"}]}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"dyDecayVolumeExperiment", "[", 
         RowBox[{"z_", ",", "#1"}], "]"}], "=", "#2"}], ")"}], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistnucal", ",", 
       RowBox[{"{", "2.6", "}"}]}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Decay", " ", "volume", " ", "length", " ", "along", " ", "the", " ", 
    "beamline", " ", "axis"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"dzDecayVolumeExperiment", "[", "#1", "]"}], "=", "#2"}], 
       ")"}], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistnucal", ",", 
       RowBox[{"{", "23", "}"}]}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Distance", " ", "from", " ", "the", " ", "beamline", " ", "to", " ", 
     "the", " ", "decay", " ", "volume", " ", "center", " ", "and", " ", 
     "detector", " ", "along", " ", "the", " ", "x"}], ",", 
    RowBox[{"y", " ", "axes"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MapThread", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"xToDecayVolumeCenterExperiment", "[", 
        RowBox[{"z_", ",", "#1"}], "]"}], "=", "#2"}], ")"}], "&"}], ",", 
    RowBox[{"{", 
     RowBox[{"explistnucal", ",", 
      RowBox[{"{", "0.", "}"}]}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"yToDecayVolumeCenterExperiment", "[", 
         RowBox[{"z_", ",", "#1"}], "]"}], "=", "#2"}], ")"}], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistnucal", ",", 
       RowBox[{"Table", "[", 
        RowBox[{"0.", ",", 
         RowBox[{"Length", "[", "explistnucal", "]"}]}], "]"}]}], "}"}]}], 
    "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Inner", " ", "and", " ", "outer", " ", "radii", " ", "of", " ", "the", 
    " ", "decay", " ", 
    RowBox[{"volume", ".", " ", "Applicable"}], " ", "if", " ", "the", " ", 
    "decay", " ", "volume", " ", "has", " ", "cylindrical", " ", "geometry"}],
    "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"RinnerDecayVolumeExperiment", "[", 
      RowBox[{"exp", ",", "z_"}], "]"}], "=", "0"}], ",", 
    RowBox[{"{", 
     RowBox[{"exp", ",", "explistnucal"}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"RouterDecayVolumeExperiment", "[", 
       RowBox[{"exp", ",", "z_"}], "]"}], "=", "0"}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistnucal"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"z", "-", 
    RowBox[{
    "coordinate", " ", "of", " ", "the", " ", "center", " ", "of", " ", "the",
      " ", "decay", " ", "volume"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"zToDecayVolumeCenterExperiment", "[", "exp", "]"}], "=", 
      RowBox[{
       RowBox[{"zToDecayVolumeExperiment", "[", "exp", "]"}], "+", 
       FractionBox[
        RowBox[{"dzDecayVolumeExperiment", "[", "exp", "]"}], "2"]}]}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistnucal"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Maximal", " ", 
    RowBox[{"long", ".", " ", "displacement"}], " ", "of", " ", "the", " ", 
    "decay", " ", "volume"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"zMaxDecayVolumeExperiment", "[", "exp", "]"}], "=", 
     RowBox[{
      RowBox[{"zToDecayVolumeExperiment", "[", "exp", "]"}], "+", 
      RowBox[{"dzDecayVolumeExperiment", "[", "exp", "]"}]}]}], ",", 
    RowBox[{"{", 
     RowBox[{"exp", ",", "explistnucal"}], "}"}]}], "]"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Whether", " ", "the", " ", "decay", " ", "volume", " ", "serves", " ", 
    "as", " ", "detector", " ", 
    RowBox[{"(", 
     RowBox[{"True", " ", "or", " ", "False"}], ")"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"DecayVolumeAsDetectorExperiment", "[", "#1", "]"}], "=", 
        "#2"}], ")"}], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistnucal", ",", 
       RowBox[{"{", "\"\<False\>\"", "}"}]}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Transverse", " ", "dimensions", " ", "of", " ", "the", " ", "detector", 
    " ", "assuming", " ", "box", " ", "geometry"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MapThread", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"dxDetectorExperiment", "[", 
        RowBox[{"#1", ",", "z_"}], "]"}], "=", "#2"}], ")"}], "&"}], ",", 
    RowBox[{"{", 
     RowBox[{"explistnucal", ",", 
      RowBox[{"{", "2.6", "}"}]}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"dyDetectorExperiment", "[", 
         RowBox[{"#1", ",", "z_"}], "]"}], "=", "#2"}], ")"}], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistnucal", ",", 
       RowBox[{"{", "2.6", "}"}]}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Length", " ", "of", " ", "the", " ", "detector", " ", "in", " ", "z", " ",
     "plane"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"dzDetectorExperiment", "[", "#1", "]"}], "=", "#2"}], ")"}], 
      "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistnucal", ",", 
       RowBox[{"{", "1", "}"}]}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Coordinates", " ", "of", " ", "the", " ", "center", " ", "of", " ", "the",
     " ", "detector"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MapThread", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"xToDetectorCenterExperiment", "[", "#1", "]"}], "=", "#2"}], 
      ")"}], "&"}], ",", 
    RowBox[{"{", 
     RowBox[{"explistnucal", ",", 
      RowBox[{"{", "0.", "}"}]}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"yToDetectorCenterExperiment", "[", "exp", "]"}], "=", "0"}], 
    ",", 
    RowBox[{"{", 
     RowBox[{"exp", ",", "explistnucal"}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"zToDetectorCenterExperiment", "[", "exp", "]"}], "=", 
      RowBox[{
       RowBox[{"zMaxDecayVolumeExperiment", "[", "exp", "]"}], "+", 
       FractionBox[
        RowBox[{"dzDetectorExperiment", "[", "exp", "]"}], "2"]}]}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistnucal"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Inner", " ", "and", " ", "outer", " ", "radii", " ", "of", " ", "the", 
    " ", "detector"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"RinnerDetectorExperiment", "[", 
      RowBox[{"exp", ",", "z_"}], "]"}], "=", "0"}], ",", 
    RowBox[{"{", 
     RowBox[{"exp", ",", "explistnucal"}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"RouterDetectorExperiment", "[", 
       RowBox[{"exp", ",", "z_"}], "]"}], "=", "0"}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistnucal"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Length", " ", "of", " ", "the", " ", "detector", " ", "along", " ", 
     "the", " ", "detector", " ", 
     RowBox[{"axis", ".", " ", "For"}], " ", "the", " ", "detector", " ", 
     "oriented", " ", "parallel", " ", "to", " ", "the", " ", "beamline"}], 
    ",", " ", 
    RowBox[{
     RowBox[{"there", " ", "is", " ", "a", " ", "formal", " ", "z"}], "-", 
     "dependence"}], ",", " ", 
    RowBox[{
    "but", " ", "in", " ", "practice", " ", "there", " ", "are", " ", "no", 
     " ", "experiments", " ", "with", " ", "such", " ", "dependence"}], ",", 
    " ", 
    RowBox[{"so", " ", "it", " ", "is", " ", "suppressed"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"dxLongDetectorExperiment", "[", "exp", "]"}], "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"DetectorPlaneOrientationExperiment", "[", "exp", "]"}], 
         "\[Equal]", "\"\<Transverse\>\""}], ",", 
        RowBox[{"dzDetectorExperiment", "[", "exp", "]"}], ",", 
        RowBox[{"dyDetectorExperiment", "[", 
         RowBox[{"exp", ",", "z"}], "]"}]}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistnucal"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "The", " ", "maximal", " ", "coordinate", " ", "of", " ", "the", " ", 
    "end", " ", "of", " ", "the", " ", "detector", " ", "plane", " ", 
    RowBox[{"(", 
     RowBox[{"along", " ", "the", " ", "detector", " ", "axis"}], ")"}], " ", 
    "used", " ", "to", " ", "calculate", " ", "the", " ", "decay", " ", 
    RowBox[{"acceptance", ".", " ", "May"}], " ", "be", " ", "either", " ", 
    "the", " ", "z", " ", "coordinate", " ", "or", " ", "the", " ", "y", " ", 
    "coordinate", " ", 
    RowBox[{"(", 
     RowBox[{
     "if", " ", "the", " ", "final", " ", "detector", " ", "plane", " ", "is",
       " ", "oriented", " ", "parallel", " ", "to", " ", "the", " ", 
      "beamline"}], ")"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"xLongMaxDetectorExperiment", "[", "exp", "]"}], "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"DetectorPlaneOrientationExperiment", "[", "exp", "]"}], 
         "\[Equal]", "\"\<Transverse\>\""}], ",", 
        RowBox[{
         RowBox[{"zMaxDecayVolumeExperiment", "[", "exp", "]"}], "+", 
         RowBox[{"dxLongDetectorExperiment", "[", "exp", "]"}]}], ",", 
        RowBox[{
         RowBox[{"yToDetectorCenterExperiment", "[", "exp", "]"}], "+", 
         RowBox[{
          RowBox[{"dyDetectorExperiment", "[", 
           RowBox[{"exp", ",", "z"}], "]"}], "/", "2"}]}]}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistnucal"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Whether", " ", "the", " ", "experiment", " ", "has", " ", "dipole", " ", 
    "magnet", " ", "in", " ", "the", " ", "detector", " ", 
    RowBox[{"(", 
     RowBox[{"True", ",", " ", "False"}], ")"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"DipoleMagnetOptionExperiment", "[", "#1", "]"}], "=", "#2"}],
        ")"}], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistnucal", ",", 
       RowBox[{"{", "\"\<False\>\"", "}"}]}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Longitudinal", " ", "positions", " ", "of", " ", "the", " ", "dipole", 
    " ", "magnet", " ", "of", " ", "the", " ", "detector"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MapThread", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"zMagnetMinExperiment", "[", "#1", "]"}], "=", "#2"}], ")"}], 
     "&"}], ",", 
    RowBox[{"{", 
     RowBox[{"explistnucal", ",", 
      RowBox[{"Table", "[", 
       RowBox[{"0", ",", 
        RowBox[{"Length", "[", "explistnucal", "]"}]}], "]"}]}], "}"}]}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"zMagnetMaxExperiment", "[", "#1", "]"}], "=", "#2"}], ")"}], 
      "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistnucal", ",", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", 
         RowBox[{"Length", "[", "explistnucal", "]"}]}], "]"}]}], "}"}]}], 
    "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Mean", " ", "magnetic", " ", "field", " ", "of", " ", "the", " ", 
    "dipole", " ", "magnet"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"MagneticFieldExperiment", "[", "#1", "]"}], "=", "#2"}], 
       ")"}], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistnucal", ",", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", 
         RowBox[{"Length", "[", "explistnucal", "]"}]}], "]"}]}], "}"}]}], 
    "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"ECAL", " ", "option", " ", 
    RowBox[{"(", 
     RowBox[{"True", ",", "False"}], ")"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"ECALoptionExperiment", "[", "#1", "]"}], "=", "#2"}], ")"}], 
      "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistnucal", ",", 
       RowBox[{"{", "\"\<True\>\"", "}"}]}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Position", " ", "of", " ", "the", " ", "beginning", " ", "of", " ", "the",
     " ", "ECAL"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"zECALminExperiment", "[", "#1", "]"}], "=", "#2"}], ")"}], 
      "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistnucal", ",", 
       RowBox[{"{", 
        RowBox[{"zMaxDecayVolumeExperiment", "[", "\"\<NuCal\>\"", "]"}], 
        "}"}]}], "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "The", " ", "final", " ", "detector", " ", "plane", " ", "needed", " ", 
     "to", " ", "reconstruct", " ", 
     RowBox[{"muons", ".", " ", "Depeding"}], " ", "on", " ", "the", " ", 
     "experiment"}], ",", " ", 
    RowBox[{
    "it", " ", "is", " ", "approximated", " ", "by", " ", "be", " ", "end", 
     " ", "of", " ", "the", " ", "trackers", " ", "or", " ", "the", " ", 
     "muon", " ", "system"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"xLongMuonPlaneExperiment", "[", "#1", "]"}], "=", "#2"}], 
       ")"}], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistnucal", ",", 
       RowBox[{"{", 
        RowBox[{"xLongMaxDetectorExperiment", "[", "\"\<NuCal\>\"", "]"}], 
        "}"}]}], "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "The", " ", "final", " ", "detector", " ", "plane", " ", "needed", " ", 
     "to", " ", "reconstruct", " ", "other", " ", 
     RowBox[{"particles", ".", " ", "Depeding"}], " ", "on", " ", "the", " ", 
     "experiment"}], ",", " ", 
    RowBox[{
    "it", " ", "is", " ", "approximated", " ", "by", " ", "the", " ", "end", 
     " ", "of", " ", "the", " ", "trackers", " ", "or", " ", "the", " ", 
     "calorimeter", " ", "system"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"xLongNonMuonPlaneExperiment", "[", "#1", "]"}], "=", "#2"}], 
       ")"}], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistnucal", ",", 
       RowBox[{"{", 
        RowBox[{"xLongMaxDetectorExperiment", "[", "\"\<NuCal\>\"", "]"}], 
        "}"}]}], "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"List", " ", "of", " ", "detectable", " ", 
     RowBox[{"particles", ".", " ", "If"}], " ", "ECAL", " ", "is", " ", 
     "absent"}], ",", " ", 
    RowBox[{
    "it", " ", "is", " ", "assumed", " ", "by", " ", "default", " ", "that", 
     " ", "photons", " ", "and", " ", 
     SubscriptBox[
      SuperscriptBox["K", "0"], "L"], " ", "cannot", " ", "be", " ", 
     "detected"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MapThread", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"DetectablePDGsExperiment", "[", "#1", "]"}], "=", "#2"}], 
      ")"}], "&"}], ",", 
    RowBox[{"{", 
     RowBox[{"explistnucal", ",", 
      RowBox[{"Table", "[", 
       RowBox[{"detectablepdgs", ",", 
        RowBox[{"Length", "[", "explistnucal", "]"}]}], "]"}]}], "}"}]}], 
   "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.8933427163770285`*^9, 3.8933427165017796`*^9}, {
   3.8934862861896596`*^9, 3.893486289088214*^9}, {3.8935181370326858`*^9, 
   3.8935181370396633`*^9}, 3.8935193128285995`*^9, {3.893520126015787*^9, 
   3.8935201693233404`*^9}, 3.8935206582013364`*^9, 3.8944385905609975`*^9, {
   3.8971453068488083`*^9, 3.8971453193869333`*^9}, {3.897145473943385*^9, 
   3.89714548695183*^9}, {3.9037182256053963`*^9, 3.903718237169443*^9}, {
   3.904793505323389*^9, 3.9047935074114285`*^9}, {3.905060156349679*^9, 
   3.9050601564937086`*^9}, {3.905844774239874*^9, 3.905844830566165*^9}, {
   3.905844935224097*^9, 3.905844946000619*^9}, {3.9058449838536916`*^9, 
   3.9058450056774025`*^9}, {3.910087213069948*^9, 3.910087256423954*^9}, {
   3.9100873630059533`*^9, 3.910087373118677*^9}, {3.9100874149438844`*^9, 
   3.9100875447348804`*^9}, {3.9101149467047443`*^9, 3.910114949511526*^9}, {
   3.9101155153491173`*^9, 3.9101155339125924`*^9}, {3.9101755654042964`*^9, 
   3.9101756133052735`*^9}, {3.9101756878417835`*^9, 
   3.9101756927283564`*^9}, {3.9101757512590055`*^9, 
   3.9101758002703714`*^9}, {3.910197551105809*^9, 3.9101975533184953`*^9}, {
   3.910238949133443*^9, 3.910238967831975*^9}, {3.9102391963599896`*^9, 
   3.9102392056198654`*^9}, {3.9102392556537323`*^9, 3.9102392713517385`*^9}, 
   3.910239305966564*^9, {3.9102393956968513`*^9, 3.9102393977677116`*^9}, {
   3.910239461012639*^9, 3.9102394639926662`*^9}, {3.91023965343082*^9, 
   3.910239676720764*^9}, {3.9102401545359735`*^9, 3.910240157880411*^9}, {
   3.910240210773418*^9, 3.910240247062948*^9}, {3.910240380609844*^9, 
   3.9102404605309296`*^9}, {3.9102405948791466`*^9, 
   3.9102407113047547`*^9}, {3.91024078226086*^9, 3.910240819911004*^9}, {
   3.9102409780987215`*^9, 3.910241061491067*^9}, {3.9102469737393837`*^9, 
   3.91024697375095*^9}, {3.910249438741277*^9, 3.9102494574491634`*^9}, {
   3.910253704854047*^9, 3.910253735496501*^9}, {3.9102553536951857`*^9, 
   3.910255369303791*^9}, {3.9104115293143897`*^9, 3.9104116765629034`*^9}, 
   3.910411759295107*^9, {3.912057197142727*^9, 3.9120572545689087`*^9}},
 CellLabel->
  "In[576]:=",ExpressionUUID->"360e08a6-002f-4473-a375-717de95c2cde"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Cross-sections", "Subsubsection",
 CellChangeTimes->{{3.8933256308713317`*^9, 
  3.8933256323468237`*^9}},ExpressionUUID->"f2926030-9a3a-4574-86ca-\
3feb85d4f8d8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "0.1", " ", "stays", " ", "for", " ", "10", " ", "times", " ", "lower", 
    " ", "luminosity", " ", "of", " ", "LHCb", " ", "in", " ", "high", " ", 
    "lumi", " ", "phase", " ", "compared", " ", "to", " ", 
    RowBox[{"ATLAS", "/", "CMS"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"MapThread", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"NPOTexperiment", "[", "#1", "]"}], "=", "#2"}], ")"}], 
       "&"}], ",", 
      RowBox[{"{", 
       RowBox[{"explistnucal", ",", 
        RowBox[{"{", 
         RowBox[{"1.7", "*", 
          SuperscriptBox["10", "18"]}], "}"}]}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MapThread", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"AtargetExperiment", "[", "#1", "]"}], "=", "#2"}], ")"}], 
       "&"}], ",", 
      RowBox[{"{", 
       RowBox[{"explistnucal", ",", 
        RowBox[{"{", "56", "}"}]}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Cascade", " ", "enhancement", " ", "of", " ", "the", " ", "production", 
     " ", "relative", " ", "to", " ", "the", " ", "production", " ", "in", 
     " ", "pure", " ", "pp", " ", 
     RowBox[{"collisions", ".", " ", "Relevant"}], " ", "for", " ", "fixed", 
     " ", "target", " ", "experiments"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "For", " ", "all", " ", "experiments", " ", "located", " ", "at", " ", 
      "SPS"}], ",", " ", 
     RowBox[{
      RowBox[{
       RowBox[{
       "the", " ", "cascade", " ", "nucaltors", " ", "is", " ", "taken", " ", 
        "from", " ", 
        RowBox[{"http", ":"}]}], "//", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"cds", ".", "cern", ".", "ch"}], "/", "record"}], "/", 
           "2115534"}], "/", "files"}], "/", "SHiP"}], "-", "NOTE", "-", 
        "2015", "-", 
        RowBox[{"009.", 
         RowBox[{"pdf", "?", "version"}]}]}]}], "=", "1"}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MapThread", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"CascadeFactorbb", "[", "#1", "]"}], "=", "#2"}], ")"}], 
       "&"}], ",", 
      RowBox[{"{", 
       RowBox[{"explistnucal", ",", 
        RowBox[{"Table", "[", 
         RowBox[{"1.", ",", 
          RowBox[{"Length", "[", "explistnucal", "]"}]}], "]"}]}], "}"}]}], 
     "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Fraction", " ", "of", " ", "produced", " ", "bb", " ", "per", " ", "PoT",
      " ", "at", " ", "the", " ", "given", " ", "experiment"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"PppTobbExperiment", "[", "exp", "]"}], "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"\[Sigma]ppTobbInpbFacility", "[", 
          RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}], "/", 
         RowBox[{"\[Sigma]ppInpbFacility", "[", 
          RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}]}], ")"}], 
       SuperscriptBox[
        RowBox[{"AtargetExperiment", "[", "exp", "]"}], "0.29"], "*", 
       RowBox[{"CascadeFactorbb", "[", "exp", "]"}]}]}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistnucal"}], "}"}]}], "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MapThread", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"CascadeFactorcc", "[", "#1", "]"}], "=", "#2"}], ")"}], 
       "&"}], ",", 
      RowBox[{"{", 
       RowBox[{"explistnucal", ",", 
        RowBox[{"Table", "[", 
         RowBox[{"1.", ",", 
          RowBox[{"Length", "[", "explistnucal", "]"}]}], "]"}]}], "}"}]}], 
     "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Fraction", " ", "of", " ", "produced", " ", "cc", " ", "per", " ", "PoT",
      " ", "at", " ", "the", " ", "given", " ", "experiment"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"PppToccExperiment", "[", "exp", "]"}], "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"\[Sigma]ppToccInpbFacility", "[", 
          RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}], "/", 
         RowBox[{"\[Sigma]ppInpbFacility", "[", 
          RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}]}], ")"}], 
       SuperscriptBox[
        RowBox[{"AtargetExperiment", "[", "exp", "]"}], "0.29"], "*", 
       RowBox[{"CascadeFactorcc", "[", "exp", "]"}]}]}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistnucal"}], "}"}]}], "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Fraction", " ", "of", " ", "produced", " ", "h", " ", "per", " ", "PoT", 
     " ", "at", " ", "the", " ", "given", " ", "experiment"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"PppTohExperiment", "[", "exp", "]"}], "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\[Sigma]ppTohInpbFacility", "[", 
           RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}], "/", 
          RowBox[{"\[Sigma]ppInpbFacility", "[", 
           RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}]}], ")"}], 
        SuperscriptBox[
         RowBox[{"AtargetExperiment", "[", "exp", "]"}], "0.29"]}]}], ",", 
      RowBox[{"{", 
       RowBox[{"exp", ",", "explistnucal"}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Fraction", " ", "of", " ", "produced", " ", "W", " ", "per", " ", "PoT", 
     " ", "at", " ", "the", " ", "given", " ", "experiment"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"PppToWExperiment", "[", "exp", "]"}], "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\[Sigma]ppToWInpbFacility", "[", 
           RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}], "/", 
          RowBox[{"\[Sigma]ppInpbFacility", "[", 
           RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}]}], ")"}], 
        SuperscriptBox[
         RowBox[{"AtargetExperiment", "[", "exp", "]"}], "0.29"]}]}], ",", 
      RowBox[{"{", 
       RowBox[{"exp", ",", "explistnucal"}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Fraction", " ", "of", " ", "produced", " ", 
     SuperscriptBox["\[Pi]", "0"], " ", "per", " ", "PoT", " ", "at", " ", 
     "the", " ", "given", " ", "experiment"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"PppTo\[Pi]0exp", "[", "exp", "]"}], "=", 
       RowBox[{"PppTo\[Pi]0Facility", "[", 
        RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"exp", ",", "explistnucal"}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Fraction", " ", "of", " ", "produced", " ", "\[Eta]", " ", "per", " ", 
     "PoT", " ", "at", " ", "the", " ", "given", " ", "experiment"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"PppTo\[Eta]exp", "[", "exp", "]"}], "=", 
       RowBox[{"PppTo\[Eta]Facility", "[", 
        RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"exp", ",", "explistnucal"}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Fraction", " ", "of", " ", "produced", " ", 
     RowBox[{"\[Eta]", "'"}], " ", "per", " ", "PoT", " ", "at", " ", "the", 
     " ", "given", " ", "experiment"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"PppTo\[Eta]prexp", "[", "exp", "]"}], "=", 
       RowBox[{"PppTo\[Eta]prFacility", "[", 
        RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"exp", ",", "explistnucal"}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Fraction", " ", "of", " ", "produced", " ", 
     SuperscriptBox["\[Rho]", "0"], " ", "per", " ", "PoT", " ", "at", " ", 
     "the", " ", "given", " ", "experiment"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"PppTo\[Rho]0exp", "[", "exp", "]"}], "=", 
       RowBox[{"PppTo\[Rho]0Facility", "[", 
        RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"exp", ",", "explistnucal"}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Fraction", " ", "of", " ", "produced", " ", "\[Omega]", " ", "per", " ", 
     "PoT", " ", "at", " ", "the", " ", "given", " ", "experiment"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"PppTo\[Omega]exp", "[", "exp", "]"}], "=", 
       RowBox[{"PppTo\[Omega]Facility", "[", 
        RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"exp", ",", "explistnucal"}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"PppToJpsiexp", "[", "exp", "]"}], "=", 
       RowBox[{
        RowBox[{"PppToJpsiFacility", "[", 
         RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}], 
        SuperscriptBox[
         RowBox[{"AtargetExperiment", "[", "exp", "]"}], "0.29"]}]}], ",", 
      RowBox[{"{", 
       RowBox[{"exp", ",", "explistnucal"}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Fraction", " ", "of", " ", "produced", " ", "\[CapitalUpsilon]", 
     RowBox[{"(", 
      RowBox[{"1", "s"}], ")"}], " ", "per", " ", "PoT", " ", "at", " ", 
     "the", " ", "given", " ", "experiment"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"PppToUpsilonexp", "[", "exp", "]"}], "=", 
       RowBox[{
        RowBox[{"PppToUpsilonFacility", "[", 
         RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}], 
        SuperscriptBox[
         RowBox[{"AtargetExperiment", "[", "exp", "]"}], "0.29"]}]}], ",", 
      RowBox[{"{", 
       RowBox[{"exp", ",", "explistnucal"}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Fraction", " ", "of", " ", "produced", " ", "\[Phi]", " ", "at", " ", 
     "the", " ", "given", " ", "experiment"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"PppToPhiexp", "[", "exp", "]"}], "=", 
       RowBox[{"PppToPhiFacility", "[", 
        RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"exp", ",", "explistnucal"}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Overall", " ", "table", " ", "with", " ", "cross"}], "-", 
     RowBox[{"sections", " ", "used", " ", "for", " ", "exporting"}]}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"TableNumbersParticlesExperiment", "[", "exp", "]"}], "=", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "\"\<Facility\>\"", ",", "\"\<Npot\>\"", ",", "\"\<Atarget\>\"", 
           ",", "\"\<PPi0\>\"", ",", "\"\<PEta\>\"", ",", "\"\<PEtapr\>\"", 
           ",", "\"\<PRho0\>\"", ",", "\"\<POmega\>\"", ",", "\"\<Pc\>\"", 
           ",", "\"\<Pb\>\"", ",", "\"\<PW\>\"", ",", "\"\<Ph\>\"", ",", 
           "\"\<PJpsi\>\"", ",", "\"\<PUpsilon\>\"", ",", "\"\<PPhi\>\""}], 
          "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"FacilityExperiment", "[", "exp", "]"}], ",", 
           RowBox[{"NPOTexperiment", "[", "exp", "]"}], ",", 
           RowBox[{"AtargetExperiment", "[", "exp", "]"}], ",", 
           RowBox[{"PppTo\[Pi]0exp", "[", "exp", "]"}], ",", 
           RowBox[{"PppTo\[Eta]exp", "[", "exp", "]"}], ",", 
           RowBox[{"PppTo\[Eta]prexp", "[", "exp", "]"}], ",", 
           RowBox[{"PppTo\[Rho]0exp", "[", "exp", "]"}], ",", 
           RowBox[{"PppTo\[Omega]exp", "[", "exp", "]"}], ",", 
           RowBox[{"2", 
            RowBox[{"PppToccExperiment", "[", "exp", "]"}]}], ",", 
           RowBox[{"2", 
            RowBox[{"PppTobbExperiment", "[", "exp", "]"}]}], ",", 
           RowBox[{"PppToWExperiment", "[", "exp", "]"}], ",", 
           RowBox[{"PppTohExperiment", "[", "exp", "]"}], ",", 
           RowBox[{"PppToJpsiexp", "[", "exp", "]"}], ",", 
           RowBox[{"PppToUpsilonexp", "[", "exp", "]"}], ",", 
           RowBox[{"PppToPhiexp", "[", "exp", "]"}]}], "}"}]}], "}"}], "//", 
       "N"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistnucal"}], "}"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.894178224580597*^9, 3.894178228878416*^9}, {
   3.894178710558771*^9, 3.8941787129854965`*^9}, {3.897235759635209*^9, 
   3.897235773261158*^9}, {3.897286203175988*^9, 3.897286207686475*^9}, 
   3.899196372180955*^9, 3.899197078789237*^9, {3.899197141927063*^9, 
   3.899197142150679*^9}, {3.9049623723089385`*^9, 3.9049623763905563`*^9}, {
   3.905276872892951*^9, 3.9052768737431355`*^9}, {3.90527694205462*^9, 
   3.905276942281592*^9}, {3.905493112602626*^9, 3.905493114399027*^9}, {
   3.90584501119835*^9, 3.905845012761836*^9}, {3.9100875497439566`*^9, 
   3.9100875520949993`*^9}, {3.9102411035996113`*^9, 3.910241106011484*^9}, {
   3.910411529812845*^9, 3.9104115298941307`*^9}, {3.9104116852726603`*^9, 
   3.910411692673166*^9}},
 CellLabel->
  "In[610]:=",ExpressionUUID->"de95196c-b3fe-4c90-8a5c-0e9534f27134"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Conditions for the LLP to decay inside the decay volume and for the products \
to point to the end of the detector\
\>", "Subsubsection",
 CellChangeTimes->{{3.905011297554874*^9, 3.9050113192993593`*^9}, 
   3.9154372091281853`*^9},ExpressionUUID->"cfd676e6-2e50-4d1c-80f6-\
80e3fc34cafd"],

Cell[BoxData[
 RowBox[{"Do", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"IfLLPinsideDecVol", "[", 
      RowBox[{"zLLP_", ",", "xLLP_", ",", "yLLP_", ",", "exp"}], "]"}], "=", 
     RowBox[{"IfLLPinsideDecVolSimple", "[", "exp", "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"IfLLPtoDet", "[", 
        RowBox[{
        "x1LLPproj_", ",", "x2LLPproj_", ",", "xLongProj_", ",", "exp"}], 
        "]"}], ",", 
       RowBox[{"IfLLPnotToDet", "[", 
        RowBox[{
        "x1LLPproj_", ",", "x2LLPproj_", ",", "xLongProj_", ",", "exp"}], 
        "]"}]}], "}"}], "=", 
     RowBox[{"IfParticlePointsToDetSimple", "[", "exp", "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"IfLLPdecVolToDet", "[", 
      RowBox[{
      "zLLP_", ",", "xLLP_", ",", "yLLP_", ",", "x1LLPproj_", ",", 
       "x2LLPproj_", ",", "xLongProj_", ",", "exp"}], "]"}], "=", 
     RowBox[{
      RowBox[{"IfLLPinsideDecVol", "[", 
       RowBox[{"zLLP", ",", "xLLP", ",", "yLLP", ",", "exp"}], "]"}], "*", 
      RowBox[{"IfLLPtoDet", "[", 
       RowBox[{"x1LLPproj", ",", "x2LLPproj", ",", "xLongProj", ",", "exp"}], 
       "]"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"IfLLPdecVolNotToDet", "[", 
      RowBox[{
      "zLLP_", ",", "xLLP_", ",", "yLLP_", ",", "x1LLPproj_", ",", 
       "x2LLPproj_", ",", "xLongProj_", ",", "exp"}], "]"}], "=", 
     RowBox[{
      RowBox[{"IfLLPinsideDecVol", "[", 
       RowBox[{"zLLP", ",", "xLLP", ",", "yLLP", ",", "exp"}], "]"}], "*", 
      RowBox[{"IfLLPnotToDet", "[", 
       RowBox[{"x1LLPproj", ",", "x2LLPproj", ",", "xLongProj", ",", "exp"}], 
       "]"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"DecayAcceptanceGeometry", "[", 
      RowBox[{"coord1_", ",", "coord2_", ",", "xLongProj_", ",", "exp"}], 
      "]"}], "=", 
     RowBox[{"IfLLPtoDet", "[", 
      RowBox[{"coord1", ",", "coord2", ",", "xLongProj", ",", "exp"}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", ",", 
   RowBox[{"{", 
    RowBox[{"exp", ",", "explistnucal"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.905014855491304*^9, 3.9050148560846004`*^9}, 
   3.90501715189884*^9, {3.905059452175317*^9, 3.9050594523791046`*^9}, {
   3.9102458525018044`*^9, 3.9102459040195937`*^9}, 3.910411529897668*^9, {
   3.915437007085026*^9, 3.9154370915307307`*^9}, {3.9154372091482434`*^9, 
   3.9154372092207823`*^9}},
 CellLabel->
  "In[627]:=",ExpressionUUID->"5c934d1b-6bd0-44e0-bd74-d3bfa2402466"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["DUNE/PRISM", "Subsection",
 CellChangeTimes->{{3.8933243776489325`*^9, 3.8933243780464325`*^9}, {
  3.8935202654475904`*^9, 
  3.8935202663524094`*^9}},ExpressionUUID->"4d856511-d201-41c8-a939-\
ed9023d9bcd9"],

Cell[CellGroupData[{

Cell["Geometry", "Subsubsection",
 CellChangeTimes->{{3.893342623432827*^9, 
  3.893342624458*^9}},ExpressionUUID->"971da7d8-df11-4ef8-a329-c61b93da52b8"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"explistdune", "=", 
    RowBox[{"{", 
     RowBox[{"\"\<DUNE-ND-LAr\>\"", ",", "\"\<DUNE-PRISM\>\""}], "}"}]}], 
   ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Distance", " ", "to", " ", "the", " ", "fiducial", " ", "volume", " ", 
    "along", " ", "the", " ", "beamline", " ", 
    RowBox[{"axis", ".", " ", 
     RowBox[{"MapThread", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"list1", "[", "#", "]"}], "=", "#2"}], ")"}], "&"}], ",", 
       RowBox[{"{", 
        RowBox[{"listexp", ",", "listvals"}], "}"}]}], "]"}]}], " ", 
    "equates", " ", "the", " ", "elements", " ", "list1", " ", "with", " ", 
    "keys", " ", "from", " ", "listexp", " ", "to", " ", "the", " ", 
    "corresponding", " ", "elements", " ", "of", " ", "the", " ", "list", " ",
     "listvals"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"zToDecayVolumeExperiment", "[", "#1", "]"}], "=", "#2"}], 
       ")"}], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistdune", ",", 
       RowBox[{"Table", "[", 
        RowBox[{"480.", ",", 
         RowBox[{"Length", "[", "explistdune", "]"}]}], "]"}]}], "}"}]}], 
    "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Detector", " ", "has", " ", "the", " ", "axis", " ", "along", " ", 
    "which", " ", "its", " ", "components", " ", "are", " ", 
    RowBox[{"placed", ".", " ", "The"}], " ", "option", " ", "below", " ", 
    "defines", " ", "the", " ", "orientation", " ", "of", " ", "the", " ", 
    "final", " ", "plane", " ", "transverse", " ", "to", " ", "this", " ", 
    "axis", " ", "relative", " ", "to", " ", "the", " ", "beamline"}], "*)"}],
   "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Transverse", " ", "if", " ", "the", " ", "plane", " ", "is", " ", 
     "tranverse", " ", 
     RowBox[{"(", 
      RowBox[{"SHiP", ",", " ", 
       RowBox[{"FACET", " ", "etc"}]}], ")"}]}], ",", " ", 
    RowBox[{
    "and", " ", "Parallel", " ", "if", " ", "it", " ", "is", " ", "parallel", 
     " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Codex", "-", "b"}], ",", " ", "ANUBIS"}]}]}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"DetectorPlaneOrientationExperiment", "[", "#1", "]"}], "=", 
        "#2"}], ")"}], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistdune", ",", 
       RowBox[{"Table", "[", 
        RowBox[{"\"\<Transverse\>\"", ",", 
         RowBox[{"Length", "[", "explistdune", "]"}]}], "]"}]}], "}"}]}], 
    "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Facility", " ", "hosting", " ", "the", " ", 
     RowBox[{"experiment", ":", " ", "SPS"}]}], ",", " ", "Fermilab", ",", 
    " ", "LHC", ",", " ", 
    RowBox[{"FCC", "-", "hh"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"FacilityExperiment", "[", "#1", "]"}], "=", "#2"}], ")"}], 
      "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistdune", ",", 
       RowBox[{"Table", "[", 
        RowBox[{"\"\<FermilabBD\>\"", ",", 
         RowBox[{"Length", "[", "explistdune", "]"}]}], "]"}]}], "}"}]}], 
    "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Geometry", " ", "of", " ", "the", " ", 
     RowBox[{"experiment", ":", " ", "box"}]}], ",", " ", "cylinder", ",", 
    " ", 
    RowBox[{"annular", " ", "cylinder"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"GeometryExperiment", "[", "#1", "]"}], "=", "#2"}], ")"}], 
      "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistdune", ",", 
       RowBox[{"Table", "[", 
        RowBox[{"\"\<Box\>\"", ",", 
         RowBox[{"Length", "[", "explistdune", "]"}]}], "]"}]}], "}"}]}], 
    "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Transverse", " ", "dimensions", " ", "of", " ", "the", " ", "decay", " ",
      "volume", " ", "assuming", " ", "box", " ", "geometry"}], ",", " ", 
    RowBox[{
    "or", " ", "cylindrical", " ", "geometry", " ", "if", " ", "the", " ", 
     "detector", " ", "plane", " ", "is", " ", "parallel", " ", "to", " ", 
     "the", " ", "beamline", " ", 
     RowBox[{
      RowBox[{"(", "ANUBIS", ")"}], ".", " ", "Otherwise"}], " ", "set", " ", 
     "to", " ", "zero"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MapThread", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"dxDecayVolumeExperiment", "[", 
        RowBox[{"z_", ",", "#1"}], "]"}], "=", "#2"}], ")"}], "&"}], ",", 
    RowBox[{"{", 
     RowBox[{"explistdune", ",", 
      RowBox[{"{", 
       RowBox[{"6.", ",", "6."}], "}"}]}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"dyDecayVolumeExperiment", "[", 
         RowBox[{"z_", ",", "#1"}], "]"}], "=", "#2"}], ")"}], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistdune", ",", 
       RowBox[{"{", 
        RowBox[{"3.", ",", "3."}], "}"}]}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Decay", " ", "volume", " ", "length", " ", "along", " ", "the", " ", 
    "beamline", " ", "axis"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"dzDecayVolumeExperiment", "[", "#1", "]"}], "=", "#2"}], 
       ")"}], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistdune", ",", 
       RowBox[{"{", 
        RowBox[{"2.", ",", "2."}], "}"}]}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Distance", " ", "from", " ", "the", " ", "beamline", " ", "to", " ", 
     "the", " ", "decay", " ", "volume", " ", "center", " ", "and", " ", 
     "detector", " ", "along", " ", "the", " ", "x"}], ",", 
    RowBox[{"y", " ", "axes"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MapThread", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"xToDecayVolumeCenterExperiment", "[", 
        RowBox[{"z_", ",", "#1"}], "]"}], "=", "#2"}], ")"}], "&"}], ",", 
    RowBox[{"{", 
     RowBox[{"explistdune", ",", 
      RowBox[{"{", 
       RowBox[{"0.", ",", "0."}], "}"}]}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"yToDecayVolumeCenterExperiment", "[", 
         RowBox[{"z_", ",", "#1"}], "]"}], "=", "#2"}], ")"}], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistdune", ",", 
       RowBox[{"{", 
        RowBox[{"0.", ",", "6."}], "}"}]}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Inner", " ", "and", " ", "outer", " ", "radii", " ", "of", " ", "the", 
    " ", "decay", " ", 
    RowBox[{"volume", ".", " ", "Applicable"}], " ", "if", " ", "the", " ", 
    "decay", " ", "volume", " ", "has", " ", "cylindrical", " ", "geometry"}],
    "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"RinnerDecayVolumeExperiment", "[", 
      RowBox[{"exp", ",", "z_"}], "]"}], "=", "0"}], ",", 
    RowBox[{"{", 
     RowBox[{"exp", ",", "explistdune"}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"RouterDecayVolumeExperiment", "[", 
       RowBox[{"exp", ",", "z_"}], "]"}], "=", "0"}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistdune"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"z", "-", 
    RowBox[{
    "coordinate", " ", "of", " ", "the", " ", "center", " ", "of", " ", "the",
      " ", "decay", " ", "volume"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"zToDecayVolumeCenterExperiment", "[", "exp", "]"}], "=", 
      RowBox[{
       RowBox[{"zToDecayVolumeExperiment", "[", "exp", "]"}], "+", 
       FractionBox[
        RowBox[{"dzDecayVolumeExperiment", "[", "exp", "]"}], "2"]}]}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistdune"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Maximal", " ", 
    RowBox[{"long", ".", " ", "displacement"}], " ", "of", " ", "the", " ", 
    "decay", " ", "volume"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"zMaxDecayVolumeExperiment", "[", "exp", "]"}], "=", 
     RowBox[{
      RowBox[{"zToDecayVolumeExperiment", "[", "exp", "]"}], "+", 
      RowBox[{"dzDecayVolumeExperiment", "[", "exp", "]"}]}]}], ",", 
    RowBox[{"{", 
     RowBox[{"exp", ",", "explistdune"}], "}"}]}], "]"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Whether", " ", "the", " ", "decay", " ", "volume", " ", "serves", " ", 
    "as", " ", "detector", " ", 
    RowBox[{"(", 
     RowBox[{"True", " ", "or", " ", "False"}], ")"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"DecayVolumeAsDetectorExperiment", "[", "exp", "]"}], "=", 
     "\"\<True\>\""}], ",", 
    RowBox[{"{", 
     RowBox[{"exp", ",", "explistdune"}], "}"}]}], "]"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Transverse", " ", "dimensions", " ", "of", " ", "the", " ", "detector", 
    " ", "assuming", " ", "box", " ", "geometry"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MapThread", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"dxDetectorExperiment", "[", 
        RowBox[{"#1", ",", "z_"}], "]"}], "=", "#2"}], ")"}], "&"}], ",", 
    RowBox[{"{", 
     RowBox[{"explistdune", ",", 
      RowBox[{"Table", "[", 
       RowBox[{"0", ",", 
        RowBox[{"Length", "[", "explistdune", "]"}]}], "]"}]}], "}"}]}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"dyDetectorExperiment", "[", 
         RowBox[{"#1", ",", "z_"}], "]"}], "=", "#2"}], ")"}], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistdune", ",", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", 
         RowBox[{"Length", "[", "explistdune", "]"}]}], "]"}]}], "}"}]}], 
    "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Length", " ", "of", " ", "the", " ", "detector", " ", "in", " ", "z", " ",
     "plane"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"dzDetectorExperiment", "[", "#1", "]"}], "=", "#2"}], ")"}], 
      "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistdune", ",", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", 
         RowBox[{"Length", "[", "explistdune", "]"}]}], "]"}]}], "}"}]}], 
    "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Coordinates", " ", "of", " ", "the", " ", "center", " ", "of", " ", "the",
     " ", "detector"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"xToDetectorCenterExperiment", "[", "exp", "]"}], "=", "0"}], 
    ",", 
    RowBox[{"{", 
     RowBox[{"exp", ",", "explistdune"}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"yToDetectorCenterExperiment", "[", "exp", "]"}], "=", 
     RowBox[{
      RowBox[{"yToDecayVolumeCenterExperiment", "[", 
       RowBox[{"z", ",", "exp"}], "]"}], "+", 
      FractionBox[
       RowBox[{"dyDecayVolumeExperiment", "[", 
        RowBox[{"z", ",", "exp"}], "]"}], "2"], "+", 
      FractionBox[
       RowBox[{"dyDetectorExperiment", "[", "exp", "]"}], "2"]}]}], ",", 
    RowBox[{"{", 
     RowBox[{"exp", ",", "explistdune"}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"zToDetectorCenterExperiment", "[", "exp", "]"}], "=", 
      RowBox[{
       RowBox[{"zMaxDecayVolumeExperiment", "[", "exp", "]"}], "+", 
       FractionBox[
        RowBox[{"dzDetectorExperiment", "[", "exp", "]"}], "2"]}]}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistdune"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Inner", " ", "and", " ", "outer", " ", "radii", " ", "of", " ", "the", 
    " ", "detector"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"RinnerDetectorExperiment", "[", 
      RowBox[{"exp", ",", "z_"}], "]"}], "=", "0"}], ",", 
    RowBox[{"{", 
     RowBox[{"exp", ",", "explistdune"}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"RouterDetectorExperiment", "[", 
       RowBox[{"exp", ",", "z_"}], "]"}], "=", "0"}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistdune"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Length", " ", "of", " ", "the", " ", "detector", " ", "along", " ", "the",
     " ", "detector", " ", "axis"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"dxLongDetectorExperiment", "[", "exp", "]"}], "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"DetectorPlaneOrientationExperiment", "[", "exp", "]"}], 
         "\[Equal]", "\"\<Transverse\>\""}], ",", 
        RowBox[{"dzDetectorExperiment", "[", "exp", "]"}], ",", 
        RowBox[{"dyDetectorExperiment", "[", "exp", "]"}]}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistdune"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "The", " ", "maximal", " ", "coordinate", " ", "of", " ", "the", " ", 
    "end", " ", "of", " ", "the", " ", "detector", " ", "plane", " ", 
    RowBox[{"(", 
     RowBox[{"along", " ", "the", " ", "detector", " ", "axis"}], ")"}], " ", 
    "used", " ", "to", " ", "calculate", " ", "the", " ", "decay", " ", 
    RowBox[{"acceptance", ".", " ", "May"}], " ", "be", " ", "either", " ", 
    "the", " ", "z", " ", "coordinate", " ", "or", " ", "the", " ", "y", " ", 
    "coordinate", " ", 
    RowBox[{"(", 
     RowBox[{
     "if", " ", "the", " ", "final", " ", "detector", " ", "plane", " ", "is",
       " ", "oriented", " ", "parallel", " ", "to", " ", "the", " ", 
      "beamline"}], ")"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"xLongMaxDetectorExperiment", "[", "exp", "]"}], "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"DetectorPlaneOrientationExperiment", "[", "exp", "]"}], 
         "\[Equal]", "\"\<Transverse\>\""}], ",", 
        RowBox[{
         RowBox[{"zMaxDecayVolumeExperiment", "[", "exp", "]"}], "+", 
         RowBox[{"dxLongDetectorExperiment", "[", "exp", "]"}]}], ",", 
        RowBox[{
         RowBox[{"yToDetectorCenterExperiment", "[", "exp", "]"}], "+", 
         RowBox[{
          RowBox[{"dyDetectorExperiment", "[", "exp", "]"}], "/", "2"}]}]}], 
       "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistdune"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Position", " ", "of", " ", "the", " ", "final", " ", "plane", " ", "for", 
    " ", "the", " ", "decay", " ", "products", " ", "along", " ", "the", " ", 
    "detector", " ", "axis"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"xLongDecayProductFinalPlaneExperiment", "[", "exp", "]"}], "=", 
     RowBox[{"xLongMaxDetectorExperiment", "[", "exp", "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"exp", ",", "explistdune"}], "}"}]}], "]"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Whether", " ", "the", " ", "experiment", " ", "has", " ", "dipole", " ", 
    "magnet", " ", "in", " ", "the", " ", "detector", " ", 
    RowBox[{"(", 
     RowBox[{"True", ",", " ", "False"}], ")"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"DipoleMagnetOptionExperiment", "[", "#1", "]"}], "=", "#2"}],
        ")"}], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistdune", ",", 
       RowBox[{"Table", "[", 
        RowBox[{"\"\<False\>\"", ",", 
         RowBox[{"Length", "[", "explistdune", "]"}]}], "]"}]}], "}"}]}], 
    "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Longitudinal", " ", "positions", " ", "of", " ", "the", " ", "dipole", 
    " ", "magnet", " ", "of", " ", "the", " ", "detector"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MapThread", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"zMagnetMinExperiment", "[", "#1", "]"}], "=", "#2"}], ")"}], 
     "&"}], ",", 
    RowBox[{"{", 
     RowBox[{"explistdune", ",", 
      RowBox[{"Table", "[", 
       RowBox[{"0", ",", 
        RowBox[{"Length", "[", "explistdune", "]"}]}], "]"}]}], "}"}]}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"zMagnetMaxExperiment", "[", "#1", "]"}], "=", "#2"}], ")"}], 
      "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistdune", ",", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", 
         RowBox[{"Length", "[", "explistdune", "]"}]}], "]"}]}], "}"}]}], 
    "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Mean", " ", "magnetic", " ", "field", " ", "of", " ", "the", " ", 
    "dipole", " ", "magnet"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"MagneticFieldExperiment", "[", "#1", "]"}], "=", "#2"}], 
       ")"}], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistdune", ",", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", 
         RowBox[{"Length", "[", "explistdune", "]"}]}], "]"}]}], "}"}]}], 
    "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"ECAL", " ", "option", " ", 
    RowBox[{"(", 
     RowBox[{"True", ",", "False"}], ")"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"ECALoptionExperiment", "[", "exp", "]"}], "=", 
      "\"\<True\>\""}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistdune"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Position", " ", "of", " ", "the", " ", "beginning", " ", "of", " ", "the",
     " ", "ECAL"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"zECALminExperiment", "[", "#1", "]"}], "=", "#2"}], ")"}], 
      "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistdune", ",", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", 
         RowBox[{"Length", "[", "explistdune", "]"}]}], "]"}]}], "}"}]}], 
    "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "The", " ", "final", " ", "detector", " ", "plane", " ", "needed", " ", 
     "to", " ", "reconstruct", " ", 
     RowBox[{"muons", ".", " ", "Depeding"}], " ", "on", " ", "the", " ", 
     "experiment"}], ",", " ", 
    RowBox[{
    "it", " ", "is", " ", "approximated", " ", "by", " ", "be", " ", "end", 
     " ", "of", " ", "the", " ", "trackers", " ", "or", " ", "the", " ", 
     "muon", " ", "system"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"xLongMuonPlaneExperiment", "[", "#1", "]"}], "=", "#2"}], 
       ")"}], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistdune", ",", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", 
         RowBox[{"Length", "[", "explistdune", "]"}]}], "]"}]}], "}"}]}], 
    "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "The", " ", "final", " ", "detector", " ", "plane", " ", "needed", " ", 
     "to", " ", "reconstruct", " ", "other", " ", 
     RowBox[{"particles", ".", " ", "Depeding"}], " ", "on", " ", "the", " ", 
     "experiment"}], ",", " ", 
    RowBox[{
    "it", " ", "is", " ", "approximated", " ", "by", " ", "the", " ", "end", 
     " ", "of", " ", "the", " ", "trackers", " ", "or", " ", "the", " ", 
     "calorimeter", " ", "system"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"xLongNonMuonPlaneExperiment", "[", "#1", "]"}], "=", "#2"}], 
       ")"}], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistdune", ",", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", 
         RowBox[{"Length", "[", "explistdune", "]"}]}], "]"}]}], "}"}]}], 
    "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"List", " ", "of", " ", "detectable", " ", 
     RowBox[{"particles", ".", " ", "If"}], " ", "ECAL", " ", "is", " ", 
     "absent"}], ",", " ", 
    RowBox[{
    "it", " ", "is", " ", "assumed", " ", "by", " ", "default", " ", "that", 
     " ", "photons", " ", "and", " ", 
     SubscriptBox[
      SuperscriptBox["K", "0"], "L"], " ", "cannot", " ", "be", " ", 
     "detected"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MapThread", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"DetectablePDGsExperiment", "[", "#1", "]"}], "=", "#2"}], 
      ")"}], "&"}], ",", 
    RowBox[{"{", 
     RowBox[{"explistdune", ",", 
      RowBox[{"Table", "[", 
       RowBox[{"detectablepdgs", ",", 
        RowBox[{"Length", "[", "explistdune", "]"}]}], "]"}]}], "}"}]}], 
   "]"}], ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{
  3.8933426758228636`*^9, {3.8934862861966667`*^9, 3.8934862890932045`*^9}, {
   3.893518137045618*^9, 3.8935181370535965`*^9}, 3.8935193128355474`*^9, {
   3.8935201260197687`*^9, 3.893520169327326*^9}, {3.8935202735182533`*^9, 
   3.893520342563176*^9}, {3.8935206582219005`*^9, 3.8935206582258916`*^9}, 
   3.893520806503993*^9, 3.8944385905899844`*^9, {3.897145306871933*^9, 
   3.89714531939192*^9}, {3.897145473952276*^9, 3.897145486957677*^9}, 
   3.8971478060023117`*^9, {3.905060161008649*^9, 3.905060161156616*^9}, 
   3.9102405948806877`*^9, {3.9102469737595654`*^9, 3.9102469737686176`*^9}, {
   3.910255379008382*^9, 3.9102554115752735`*^9}, {3.9102590123591084`*^9, 
   3.910259014892061*^9}, {3.9120573465201187`*^9, 3.9120573530301027`*^9}},
 CellLabel->
  "In[628]:=",ExpressionUUID->"9e4c2f6e-1fe6-49a0-863f-bd0c7c4958b1"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Cross-sections", "Subsubsection",
 CellChangeTimes->{{3.8933256308713317`*^9, 
  3.8933256323468237`*^9}},ExpressionUUID->"339e742a-403e-4af6-a1c8-\
8a447ca3e0ba"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"MapThread", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"NPOTexperiment", "[", "#1", "]"}], "=", "#2"}], ")"}], "&"}], 
    ",", 
    RowBox[{"{", 
     RowBox[{"explistdune", ",", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"1.1", "*", 
         SuperscriptBox["10", "22"]}], ",", 
        RowBox[{"Length", "[", "explistdune", "]"}]}], "]"}]}], "}"}]}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"AtargetExperiment", "[", "#1", "]"}], "=", "#2"}], ")"}], 
      "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistdune", ",", 
       RowBox[{"Table", "[", 
        RowBox[{"12.", ",", 
         RowBox[{"Length", "[", "explistdune", "]"}]}], "]"}]}], "}"}]}], 
    "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Cascade", " ", "enhancement", " ", "of", " ", "the", " ", "production", 
    " ", "relative", " ", "to", " ", "the", " ", "production", " ", "in", " ",
     "pure", " ", "pp", " ", 
    RowBox[{"collisions", ".", " ", "Relevant"}], " ", "for", " ", "fixed", 
    " ", "target", " ", "experiments"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "For", " ", "all", " ", "experiments", " ", "located", " ", "at", " ", 
     "SPS"}], ",", " ", 
    RowBox[{
     RowBox[{
      RowBox[{
      "the", " ", "cascade", " ", "dunetors", " ", "is", " ", "taken", " ", 
       "from", " ", 
       RowBox[{"http", ":"}]}], "//", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"cds", ".", "cern", ".", "ch"}], "/", "record"}], "/", 
          "2115534"}], "/", "files"}], "/", "SHiP"}], "-", "NOTE", "-", 
       "2015", "-", 
       RowBox[{"009.", 
        RowBox[{"pdf", "?", "version"}]}]}]}], "=", "1"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"CascadeFactorbb", "[", "#1", "]"}], "=", "#2"}], ")"}], 
      "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistdune", ",", 
       RowBox[{"Table", "[", 
        RowBox[{"1.", ",", 
         RowBox[{"Length", "[", "explistdune", "]"}]}], "]"}]}], "}"}]}], 
    "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Fraction", " ", "of", " ", "produced", " ", "bb", " ", "per", " ", "PoT", 
    " ", "at", " ", "the", " ", "given", " ", "experiment"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"PppTobbExperiment", "[", "exp", "]"}], "=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"\[Sigma]ppTobbInpbFacility", "[", 
        RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}], "/", 
       RowBox[{"\[Sigma]ppInpbFacility", "[", 
        RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}]}], ")"}], 
     SuperscriptBox[
      RowBox[{"AtargetExperiment", "[", "exp", "]"}], "0.29"], "*", 
     RowBox[{"CascadeFactorbb", "[", "exp", "]"}]}]}], ",", 
   RowBox[{"{", 
    RowBox[{"exp", ",", "explistdune"}], "}"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"CascadeFactorcc", "[", "#1", "]"}], "=", "#2"}], ")"}], 
      "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistdune", ",", 
       RowBox[{"Table", "[", 
        RowBox[{"1.", ",", 
         RowBox[{"Length", "[", "explistdune", "]"}]}], "]"}]}], "}"}]}], 
    "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Fraction", " ", "of", " ", "produced", " ", "cc", " ", "per", " ", "PoT", 
    " ", "at", " ", "the", " ", "given", " ", "experiment"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"PppToccExperiment", "[", "exp", "]"}], "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"\[Sigma]ppToccInpbFacility", "[", 
         RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}], "/", 
        RowBox[{"\[Sigma]ppInpbFacility", "[", 
         RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}]}], ")"}], 
      SuperscriptBox[
       RowBox[{"AtargetExperiment", "[", "exp", "]"}], "0.29"], "*", 
      RowBox[{"CascadeFactorcc", "[", "exp", "]"}]}]}], ",", 
    RowBox[{"{", 
     RowBox[{"exp", ",", "explistdune"}], "}"}]}], "]"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Fraction", " ", "of", " ", "produced", " ", "h", " ", "per", " ", "PoT", 
    " ", "at", " ", "the", " ", "given", " ", "experiment"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"PppTohExperiment", "[", "exp", "]"}], "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"\[Sigma]ppTohInpbFacility", "[", 
          RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}], "/", 
         RowBox[{"\[Sigma]ppInpbFacility", "[", 
          RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}]}], ")"}], 
       SuperscriptBox[
        RowBox[{"AtargetExperiment", "[", "exp", "]"}], "0.29"]}]}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistdune"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Fraction", " ", "of", " ", "produced", " ", "W", " ", "per", " ", "PoT", 
    " ", "at", " ", "the", " ", "given", " ", "experiment"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"PppToWExperiment", "[", "exp", "]"}], "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"\[Sigma]ppToWInpbFacility", "[", 
          RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}], "/", 
         RowBox[{"\[Sigma]ppInpbFacility", "[", 
          RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}]}], ")"}], 
       SuperscriptBox[
        RowBox[{"AtargetExperiment", "[", "exp", "]"}], "0.29"]}]}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistdune"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Fraction", " ", "of", " ", "produced", " ", 
    SuperscriptBox["\[Pi]", "0"], " ", "per", " ", "PoT", " ", "at", " ", 
    "the", " ", "given", " ", "experiment"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"PppTo\[Pi]0exp", "[", "exp", "]"}], "=", 
      RowBox[{"PppTo\[Pi]0Facility", "[", 
       RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistdune"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Fraction", " ", "of", " ", "produced", " ", "\[Eta]", " ", "per", " ", 
    "PoT", " ", "at", " ", "the", " ", "given", " ", "experiment"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"PppTo\[Eta]exp", "[", "exp", "]"}], "=", 
      RowBox[{"PppTo\[Eta]Facility", "[", 
       RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistdune"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Fraction", " ", "of", " ", "produced", " ", 
    RowBox[{"\[Eta]", "'"}], " ", "per", " ", "PoT", " ", "at", " ", "the", 
    " ", "given", " ", "experiment"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"PppTo\[Eta]prexp", "[", "exp", "]"}], "=", 
      RowBox[{"PppTo\[Eta]prFacility", "[", 
       RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistdune"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Fraction", " ", "of", " ", "produced", " ", 
    SuperscriptBox["\[Rho]", "0"], " ", "per", " ", "PoT", " ", "at", " ", 
    "the", " ", "given", " ", "experiment"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"PppTo\[Rho]0exp", "[", "exp", "]"}], "=", 
      RowBox[{"PppTo\[Rho]0Facility", "[", 
       RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistdune"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Fraction", " ", "of", " ", "produced", " ", "\[Omega]", " ", "per", " ", 
    "PoT", " ", "at", " ", "the", " ", "given", " ", "experiment"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"PppTo\[Omega]exp", "[", "exp", "]"}], "=", 
     RowBox[{"PppTo\[Omega]Facility", "[", 
      RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"exp", ",", "explistdune"}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"PppToJpsiexp", "[", "exp", "]"}], "=", 
      RowBox[{
       RowBox[{"PppToJpsiFacility", "[", 
        RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}], 
       SuperscriptBox[
        RowBox[{"AtargetExperiment", "[", "exp", "]"}], "0.29"]}]}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistdune"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Fraction", " ", "of", " ", "produced", " ", "\[CapitalUpsilon]", 
    RowBox[{"(", 
     RowBox[{"1", "s"}], ")"}], " ", "per", " ", "PoT", " ", "at", " ", "the",
     " ", "given", " ", "experiment"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"PppToUpsilonexp", "[", "exp", "]"}], "=", 
      RowBox[{
       RowBox[{"PppToUpsilonFacility", "[", 
        RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}], 
       SuperscriptBox[
        RowBox[{"AtargetExperiment", "[", "exp", "]"}], "0.29"]}]}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistdune"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Fraction", " ", "of", " ", "produced", " ", "\[Phi]", " ", "at", " ", 
    "the", " ", "given", " ", "experiment"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"PppToPhiexp", "[", "exp", "]"}], "=", 
      RowBox[{"PppToPhiFacility", "[", 
       RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistdune"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Overall", " ", "table", " ", "with", " ", "cross"}], "-", 
    RowBox[{"sections", " ", "used", " ", "for", " ", "exporting"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"TableNumbersParticlesExperiment", "[", "exp", "]"}], "=", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "\"\<Facility\>\"", ",", "\"\<Npot\>\"", ",", "\"\<Atarget\>\"", ",", 
         "\"\<PPi0\>\"", ",", "\"\<PEta\>\"", ",", "\"\<PEtapr\>\"", ",", 
         "\"\<PRho0\>\"", ",", "\"\<POmega\>\"", ",", "\"\<Pc\>\"", ",", 
         "\"\<Pb\>\"", ",", "\"\<PW\>\"", ",", "\"\<Ph\>\"", ",", 
         "\"\<PJpsi\>\"", ",", "\"\<PUpsilon\>\"", ",", "\"\<PPhi\>\""}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"FacilityExperiment", "[", "exp", "]"}], ",", 
         RowBox[{"NPOTexperiment", "[", "exp", "]"}], ",", 
         RowBox[{"AtargetExperiment", "[", "exp", "]"}], ",", 
         RowBox[{"PppTo\[Pi]0exp", "[", "exp", "]"}], ",", 
         RowBox[{"PppTo\[Eta]exp", "[", "exp", "]"}], ",", 
         RowBox[{"PppTo\[Eta]prexp", "[", "exp", "]"}], ",", 
         RowBox[{"PppTo\[Rho]0exp", "[", "exp", "]"}], ",", 
         RowBox[{"PppTo\[Omega]exp", "[", "exp", "]"}], ",", 
         RowBox[{"2", 
          RowBox[{"PppToccExperiment", "[", "exp", "]"}]}], ",", 
         RowBox[{"2", 
          RowBox[{"PppTobbExperiment", "[", "exp", "]"}]}], ",", 
         RowBox[{"PppToWExperiment", "[", "exp", "]"}], ",", 
         RowBox[{"PppTohExperiment", "[", "exp", "]"}], ",", 
         RowBox[{"PppToJpsiexp", "[", "exp", "]"}], ",", 
         RowBox[{"PppToUpsilonexp", "[", "exp", "]"}], ",", 
         RowBox[{"PppToPhiexp", "[", "exp", "]"}]}], "}"}]}], "}"}], "//", 
     "N"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"exp", ",", "explistdune"}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.8935204074840746`*^9, 3.8935204214929004`*^9}, {
   3.8941782352982635`*^9, 3.8941782382265043`*^9}, {3.8941787167979345`*^9, 
   3.894178718834484*^9}, {3.897235779926516*^9, 3.8972357953418236`*^9}, {
   3.897286212468108*^9, 3.897286216789379*^9}, 3.8991963808458586`*^9, 
   3.899197086370612*^9, {3.899197142157174*^9, 3.899197142355194*^9}},
 CellLabel->
  "In[663]:=",ExpressionUUID->"0620c79b-a426-465d-b3a5-1ef28cb70075"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Conditions for the LLP to decay inside the decay volume and for the products \
to point to the end of the detector\
\>", "Subsubsection",
 CellChangeTimes->{{3.905011297554874*^9, 3.9050113192993593`*^9}, 
   3.915437209228598*^9},ExpressionUUID->"94aa29fc-8c83-4d4b-bad6-\
3ca8379554db"],

Cell[BoxData[
 RowBox[{"Do", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"IfLLPinsideDecVol", "[", 
      RowBox[{"zLLP_", ",", "xLLP_", ",", "yLLP_", ",", "exp"}], "]"}], "=", 
     RowBox[{"IfLLPinsideDecVolSimple", "[", "exp", "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"IfLLPtoDet", "[", 
        RowBox[{
        "x1LLPproj_", ",", "x2LLPproj_", ",", "xLongProj_", ",", "exp"}], 
        "]"}], ",", 
       RowBox[{"IfLLPnotToDet", "[", 
        RowBox[{
        "x1LLPproj_", ",", "x2LLPproj_", ",", "xLongProj_", ",", "exp"}], 
        "]"}]}], "}"}], "=", 
     RowBox[{"IfParticlePointsToDetSimple", "[", "exp", "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"IfLLPdecVolToDet", "[", 
      RowBox[{
      "zLLP_", ",", "xLLP_", ",", "yLLP_", ",", "x1LLPproj_", ",", 
       "x2LLPproj_", ",", "xLongProj_", ",", "exp"}], "]"}], "=", 
     RowBox[{
      RowBox[{"IfLLPinsideDecVol", "[", 
       RowBox[{"zLLP", ",", "xLLP", ",", "yLLP", ",", "exp"}], "]"}], "*", 
      RowBox[{"IfLLPtoDet", "[", 
       RowBox[{"x1LLPproj", ",", "x2LLPproj", ",", "xLongProj", ",", "exp"}], 
       "]"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"IfLLPdecVolNotToDet", "[", 
      RowBox[{
      "zLLP_", ",", "xLLP_", ",", "yLLP_", ",", "x1LLPproj_", ",", 
       "x2LLPproj_", ",", "xLongProj_", ",", "exp"}], "]"}], "=", 
     RowBox[{
      RowBox[{"IfLLPinsideDecVol", "[", 
       RowBox[{"zLLP", ",", "xLLP", ",", "yLLP", ",", "exp"}], "]"}], "*", 
      RowBox[{"IfLLPnotToDet", "[", 
       RowBox[{"x1LLPproj", ",", "x2LLPproj", ",", "xLongProj", ",", "exp"}], 
       "]"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"DecayAcceptanceGeometry", "[", 
      RowBox[{"coord1_", ",", "coord2_", ",", "xLongProj_", ",", "exp"}], 
      "]"}], "=", 
     RowBox[{"IfLLPtoDet", "[", 
      RowBox[{"coord1", ",", "coord2", ",", "xLongProj", ",", "exp"}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", ",", 
   RowBox[{"{", 
    RowBox[{"exp", ",", "explistdune"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.9050148879774866`*^9, 3.9050148897566824`*^9}, 
   3.905017151903824*^9, {3.905059457653214*^9, 3.905059458454544*^9}, {
   3.9102585745486116`*^9, 3.910258640952654*^9}, 3.9102588185234237`*^9, 
   3.910259935711745*^9, {3.9154370071079936`*^9, 3.9154370915337934`*^9}, {
   3.915437209248989*^9, 3.9154372093208814`*^9}},
 CellLabel->
  "In[680]:=",ExpressionUUID->"a9fa46e5-3281-45eb-950c-935e9cf5bf22"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["DarkQuest", "Subsection",
 CellChangeTimes->{{3.8933243823617153`*^9, 
  3.8933243846957817`*^9}},ExpressionUUID->"a9f4ed1f-259f-4551-9380-\
c6b533467630"],

Cell[CellGroupData[{

Cell["Geometry", "Subsubsection",
 CellChangeTimes->{{3.893342623432827*^9, 
  3.893342624458*^9}},ExpressionUUID->"fe8b55ce-2156-45fd-be3f-7a62452c558f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"explistdarkquest", "=", 
    RowBox[{"{", 
     RowBox[{"\"\<DarkQuest-phase-2\>\"", ",", "\"\<DarkQuest-phase-1\>\""}], 
     "}"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Distance", " ", "to", " ", "the", " ", "fiducial", " ", "volume", " ", 
    "along", " ", "the", " ", "beamline", " ", 
    RowBox[{"axis", ".", " ", 
     RowBox[{"MapThread", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"list1", "[", "#", "]"}], "=", "#2"}], ")"}], "&"}], ",", 
       RowBox[{"{", 
        RowBox[{"listexp", ",", "listvals"}], "}"}]}], "]"}]}], " ", 
    "equates", " ", "the", " ", "elements", " ", "list1", " ", "with", " ", 
    "keys", " ", "from", " ", "listexp", " ", "to", " ", "the", " ", 
    "corresponding", " ", "elements", " ", "of", " ", "the", " ", "list", " ",
     "listvals"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"zToDecayVolumeExperiment", "[", "#1", "]"}], "=", "#2"}], 
       ")"}], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistdarkquest", ",", 
       RowBox[{"{", 
        RowBox[{"7.", ",", "5."}], "}"}]}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Detector", " ", "has", " ", "the", " ", "axis", " ", "along", " ", 
    "which", " ", "its", " ", "components", " ", "are", " ", 
    RowBox[{"placed", ".", " ", "The"}], " ", "option", " ", "below", " ", 
    "defines", " ", "the", " ", "orientation", " ", "of", " ", "the", " ", 
    "final", " ", "plane", " ", "transverse", " ", "to", " ", "this", " ", 
    "axis", " ", "relative", " ", "to", " ", "the", " ", "beamline"}], "*)"}],
   "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Transverse", " ", "if", " ", "the", " ", "plane", " ", "is", " ", 
     "tranverse", " ", 
     RowBox[{"(", 
      RowBox[{"SHiP", ",", " ", 
       RowBox[{"FACET", " ", "etc"}]}], ")"}]}], ",", " ", 
    RowBox[{
    "and", " ", "Parallel", " ", "if", " ", "it", " ", "is", " ", "parallel", 
     " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Codex", "-", "b"}], ",", " ", "ANUBIS"}]}]}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"DetectorPlaneOrientationExperiment", "[", "#1", "]"}], "=", 
        "#2"}], ")"}], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistdarkquest", ",", 
       RowBox[{"Table", "[", 
        RowBox[{"\"\<Transverse\>\"", ",", 
         RowBox[{"Length", "[", "explistdarkquest", "]"}]}], "]"}]}], "}"}]}],
     "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Facility", " ", "hosting", " ", "the", " ", 
     RowBox[{"experiment", ":", " ", "SPS"}]}], ",", " ", "Fermilab", ",", 
    " ", "LHC", ",", " ", 
    RowBox[{"FCC", "-", "hh"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"FacilityExperiment", "[", "#1", "]"}], "=", "#2"}], ")"}], 
      "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistdarkquest", ",", 
       RowBox[{"Table", "[", 
        RowBox[{"\"\<FermilabBD\>\"", ",", 
         RowBox[{"Length", "[", "explistdarkquest", "]"}]}], "]"}]}], "}"}]}],
     "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Geometry", " ", "of", " ", "the", " ", 
     RowBox[{"experiment", ":", " ", "box"}]}], ",", " ", "cylinder", ",", 
    " ", 
    RowBox[{"annular", " ", "cylinder"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"GeometryExperiment", "[", "#1", "]"}], "=", "#2"}], ")"}], 
      "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistdarkquest", ",", 
       RowBox[{"Table", "[", 
        RowBox[{"\"\<Box\>\"", ",", 
         RowBox[{"Length", "[", "explistdarkquest", "]"}]}], "]"}]}], "}"}]}],
     "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Transverse", " ", "dimensions", " ", "of", " ", "the", " ", "decay", " ",
      "volume", " ", "assuming", " ", "box", " ", "geometry"}], ",", " ", 
    RowBox[{
    "or", " ", "cylindrical", " ", "geometry", " ", "if", " ", "the", " ", 
     "detector", " ", "plane", " ", "is", " ", "parallel", " ", "to", " ", 
     "the", " ", "beamline", " ", 
     RowBox[{
      RowBox[{"(", "ANUBIS", ")"}], ".", " ", "Otherwise"}], " ", "set", " ", 
     "to", " ", "zero"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MapThread", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"dxDecayVolumeExperiment", "[", 
        RowBox[{"z_", ",", "#1"}], "]"}], "=", "#2"}], ")"}], "&"}], ",", 
    RowBox[{"{", 
     RowBox[{"explistdarkquest", ",", 
      RowBox[{"{", 
       RowBox[{"2.", ",", "2."}], "}"}]}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"dyDecayVolumeExperiment", "[", 
         RowBox[{"z_", ",", "#1"}], "]"}], "=", "#2"}], ")"}], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistdarkquest", ",", 
       RowBox[{"{", 
        RowBox[{"2.", ",", "2."}], "}"}]}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Decay", " ", "volume", " ", "length", " ", "along", " ", "the", " ", 
    "beamline", " ", "axis"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"dzDecayVolumeExperiment", "[", "#1", "]"}], "=", "#2"}], 
       ")"}], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistdarkquest", ",", 
       RowBox[{"{", 
        RowBox[{"5.", ",", "1"}], "}"}]}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Distance", " ", "from", " ", "the", " ", "beamline", " ", "to", " ", 
     "the", " ", "decay", " ", "volume", " ", "center", " ", "and", " ", 
     "detector", " ", "along", " ", "the", " ", "x"}], ",", 
    RowBox[{"y", " ", "axes"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MapThread", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"xToDecayVolumeCenterExperiment", "[", 
        RowBox[{"z_", ",", "#1"}], "]"}], "=", "#2"}], ")"}], "&"}], ",", 
    RowBox[{"{", 
     RowBox[{"explistdarkquest", ",", 
      RowBox[{"Table", "[", 
       RowBox[{"0.", ",", 
        RowBox[{"Length", "[", "explistdarkquest", "]"}]}], "]"}]}], "}"}]}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"yToDecayVolumeCenterExperiment", "[", 
         RowBox[{"z_", ",", "#1"}], "]"}], "=", "#2"}], ")"}], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistdarkquest", ",", 
       RowBox[{"Table", "[", 
        RowBox[{"0.", ",", 
         RowBox[{"Length", "[", "explistdarkquest", "]"}]}], "]"}]}], "}"}]}],
     "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Inner", " ", "and", " ", "outer", " ", "radii", " ", "of", " ", "the", 
    " ", "decay", " ", 
    RowBox[{"volume", ".", " ", "Applicable"}], " ", "if", " ", "the", " ", 
    "decay", " ", "volume", " ", "has", " ", "cylindrical", " ", "geometry"}],
    "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"RinnerDecayVolumeExperiment", "[", 
      RowBox[{"exp", ",", "z_"}], "]"}], "=", "0"}], ",", 
    RowBox[{"{", 
     RowBox[{"exp", ",", "explistdarkquest"}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"RouterDecayVolumeExperiment", "[", 
       RowBox[{"exp", ",", "z_"}], "]"}], "=", "0"}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistdarkquest"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"z", "-", 
    RowBox[{
    "coordinate", " ", "of", " ", "the", " ", "center", " ", "of", " ", "the",
      " ", "decay", " ", "volume"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"zToDecayVolumeCenterExperiment", "[", "exp", "]"}], "=", 
      RowBox[{
       RowBox[{"zToDecayVolumeExperiment", "[", "exp", "]"}], "+", 
       FractionBox[
        RowBox[{"dzDecayVolumeExperiment", "[", "exp", "]"}], "2"]}]}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistdarkquest"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Maximal", " ", 
    RowBox[{"long", ".", " ", "displacement"}], " ", "of", " ", "the", " ", 
    "decay", " ", "volume"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"zMaxDecayVolumeExperiment", "[", "exp", "]"}], "=", 
     RowBox[{
      RowBox[{"zToDecayVolumeExperiment", "[", "exp", "]"}], "+", 
      RowBox[{"dzDecayVolumeExperiment", "[", "exp", "]"}]}]}], ",", 
    RowBox[{"{", 
     RowBox[{"exp", ",", "explistdarkquest"}], "}"}]}], "]"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Whether", " ", "the", " ", "decay", " ", "volume", " ", "serves", " ", 
    "as", " ", "detector", " ", 
    RowBox[{"(", 
     RowBox[{"True", " ", "or", " ", "False"}], ")"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"DecayVolumeAsDetectorExperiment", "[", "exp", "]"}], "=", 
     "\"\<False\>\""}], ",", 
    RowBox[{"{", 
     RowBox[{"exp", ",", "explistdarkquest"}], "}"}]}], "]"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Transverse", " ", "dimensions", " ", "of", " ", "the", " ", "detector", 
    " ", "assuming", " ", "box", " ", "geometry"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MapThread", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"dxDetectorExperiment", "[", 
        RowBox[{"#1", ",", "z_"}], "]"}], "=", "#2"}], ")"}], "&"}], ",", 
    RowBox[{"{", 
     RowBox[{"explistdarkquest", ",", 
      RowBox[{"{", 
       RowBox[{"2.", ",", "2."}], "}"}]}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"dyDetectorExperiment", "[", 
         RowBox[{"#1", ",", "z_"}], "]"}], "=", "#2"}], ")"}], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistdarkquest", ",", 
       RowBox[{"{", 
        RowBox[{"2.", ",", "2."}], "}"}]}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Length", " ", "of", " ", "the", " ", "detector", " ", "in", " ", "z", " ",
     "plane"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"dzDetectorExperiment", "[", "#1", "]"}], "=", "#2"}], ")"}], 
      "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistdarkquest", ",", 
       RowBox[{"{", 
        RowBox[{"8.", ",", "18."}], "}"}]}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Coordinates", " ", "of", " ", "the", " ", "center", " ", "of", " ", "the",
     " ", "detector"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"xToDetectorCenterExperiment", "[", "exp", "]"}], "=", "0"}], 
    ",", 
    RowBox[{"{", 
     RowBox[{"exp", ",", "explistdarkquest"}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"yToDetectorCenterExperiment", "[", "exp", "]"}], "=", "0"}], 
    ",", 
    RowBox[{"{", 
     RowBox[{"exp", ",", "explistdarkquest"}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"zToDetectorCenterExperiment", "[", "exp", "]"}], "=", 
      RowBox[{
       RowBox[{"zMaxDecayVolumeExperiment", "[", "exp", "]"}], "+", 
       FractionBox[
        RowBox[{"dzDetectorExperiment", "[", "exp", "]"}], "2"]}]}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistdarkquest"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Inner", " ", "and", " ", "outer", " ", "radii", " ", "of", " ", "the", 
    " ", "detector"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"RinnerDetectorExperiment", "[", 
      RowBox[{"exp", ",", "z_"}], "]"}], "=", "0"}], ",", 
    RowBox[{"{", 
     RowBox[{"exp", ",", "explistdarkquest"}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"RouterDetectorExperiment", "[", 
       RowBox[{"exp", ",", "z_"}], "]"}], "=", "0"}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistdarkquest"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Length", " ", "of", " ", "the", " ", "detector", " ", "along", " ", "the",
     " ", "detector", " ", "axis"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"dxLongDetectorExperiment", "[", "exp", "]"}], "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"DetectorPlaneOrientationExperiment", "[", "exp", "]"}], 
         "\[Equal]", "\"\<Transverse\>\""}], ",", 
        RowBox[{"dzDetectorExperiment", "[", "exp", "]"}], ",", 
        RowBox[{"dyDetectorExperiment", "[", "exp", "]"}]}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistdarkquest"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "The", " ", "maximal", " ", "coordinate", " ", "of", " ", "the", " ", 
    "end", " ", "of", " ", "the", " ", "detector", " ", "plane", " ", 
    RowBox[{"(", 
     RowBox[{"along", " ", "the", " ", "detector", " ", "axis"}], ")"}], " ", 
    "used", " ", "to", " ", "calculate", " ", "the", " ", "decay", " ", 
    RowBox[{"acceptance", ".", " ", "May"}], " ", "be", " ", "either", " ", 
    "the", " ", "z", " ", "coordinate", " ", "or", " ", "the", " ", "y", " ", 
    "coordinate", " ", 
    RowBox[{"(", 
     RowBox[{
     "if", " ", "the", " ", "final", " ", "detector", " ", "plane", " ", "is",
       " ", "oriented", " ", "parallel", " ", "to", " ", "the", " ", 
      "beamline"}], ")"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"xLongMaxDetectorExperiment", "[", "exp", "]"}], "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"DetectorPlaneOrientationExperiment", "[", "exp", "]"}], 
         "\[Equal]", "\"\<Transverse\>\""}], ",", 
        RowBox[{
         RowBox[{"zMaxDecayVolumeExperiment", "[", "exp", "]"}], "+", 
         RowBox[{"dxLongDetectorExperiment", "[", "exp", "]"}]}], ",", 
        RowBox[{
         RowBox[{"yToDetectorCenterExperiment", "[", "exp", "]"}], "+", 
         RowBox[{
          RowBox[{"dyDetectorExperiment", "[", "exp", "]"}], "/", "2"}]}]}], 
       "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistdarkquest"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Position", " ", "of", " ", "the", " ", "final", " ", "plane", " ", "for", 
    " ", "the", " ", "decay", " ", "products", " ", "along", " ", "the", " ", 
    "detector", " ", "axis"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"xLongDecayProductFinalPlaneExperiment", "[", "exp", "]"}], "=", 
     RowBox[{"xLongMaxDetectorExperiment", "[", "exp", "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"exp", ",", "explistdarkquest"}], "}"}]}], "]"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Whether", " ", "the", " ", "experiment", " ", "has", " ", "dipole", " ", 
    "magnet", " ", "in", " ", "the", " ", "detector", " ", 
    RowBox[{"(", 
     RowBox[{"True", ",", " ", "False"}], ")"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"DipoleMagnetOptionExperiment", "[", "#1", "]"}], "=", "#2"}],
        ")"}], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistdarkquest", ",", 
       RowBox[{"{", 
        RowBox[{"\"\<True\>\"", ",", "\"\<True\>\""}], "}"}]}], "}"}]}], 
    "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Longitudinal", " ", "positions", " ", "of", " ", "the", " ", "dipole", 
    " ", "magnet", " ", "of", " ", "the", " ", "detector"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MapThread", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"zMagnetMinExperiment", "[", "#1", "]"}], "=", "#2"}], ")"}], 
     "&"}], ",", 
    RowBox[{"{", 
     RowBox[{"explistdarkquest", ",", 
      RowBox[{"{", 
       RowBox[{"9.", ",", "9."}], "}"}]}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"zMagnetMaxExperiment", "[", "#1", "]"}], "=", "#2"}], ")"}], 
      "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistdarkquest", ",", 
       RowBox[{"{", 
        RowBox[{"12.", ",", "12."}], "}"}]}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Mean", " ", "magnetic", " ", "field", " ", "of", " ", "the", " ", 
    "dipole", " ", "magnet"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"MagneticFieldExperiment", "[", "#1", "]"}], "=", "#2"}], 
       ")"}], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistdarkquest", ",", 
       RowBox[{"{", 
        RowBox[{"0.4", ",", "0.4"}], "}"}]}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"ECAL", " ", "option", " ", 
    RowBox[{"(", 
     RowBox[{"True", ",", "False"}], ")"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"ECALoptionExperiment", "[", "exp", "]"}], "=", 
      "\"\<True\>\""}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistdarkquest"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Position", " ", "of", " ", "the", " ", "beginning", " ", "of", " ", "the",
     " ", "ECAL"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"zECALminExperiment", "[", "#1", "]"}], "=", "#2"}], ")"}], 
      "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistdarkquest", ",", 
       RowBox[{"{", 
        RowBox[{"18.5", ",", "18.5"}], "}"}]}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "The", " ", "final", " ", "detector", " ", "plane", " ", "needed", " ", 
     "to", " ", "reconstruct", " ", 
     RowBox[{"muons", ".", " ", "Depeding"}], " ", "on", " ", "the", " ", 
     "experiment"}], ",", " ", 
    RowBox[{
    "it", " ", "is", " ", "approximated", " ", "by", " ", "be", " ", "end", 
     " ", "of", " ", "the", " ", "trackers", " ", "or", " ", "the", " ", 
     "muon", " ", "system"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"xLongMuonPlaneExperiment", "[", "exp", "]"}], "=", 
      RowBox[{"xLongMaxDetectorExperiment", "[", "exp", "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistdarkquest"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "The", " ", "final", " ", "detector", " ", "plane", " ", "needed", " ", 
     "to", " ", "reconstruct", " ", "other", " ", 
     RowBox[{"particles", ".", " ", "Depeding"}], " ", "on", " ", "the", " ", 
     "experiment"}], ",", " ", 
    RowBox[{
    "it", " ", "is", " ", "approximated", " ", "by", " ", "the", " ", "end", 
     " ", "of", " ", "the", " ", "trackers", " ", "or", " ", "the", " ", 
     "calorimeter", " ", "system"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"xLongNonMuonPlaneExperiment", "[", "exp", "]"}], "=", 
      RowBox[{
       RowBox[{"zECALminExperiment", "[", "exp", "]"}], "+", "1"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistdarkquest"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"List", " ", "of", " ", "detectable", " ", 
     RowBox[{"particles", ".", " ", "If"}], " ", "ECAL", " ", "is", " ", 
     "absent"}], ",", " ", 
    RowBox[{
    "it", " ", "is", " ", "assumed", " ", "by", " ", "default", " ", "that", 
     " ", "photons", " ", "and", " ", 
     SubscriptBox[
      SuperscriptBox["K", "0"], "L"], " ", "cannot", " ", "be", " ", 
     "detected"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MapThread", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"DetectablePDGsExperiment", "[", "#1", "]"}], "=", "#2"}], 
      ")"}], "&"}], ",", 
    RowBox[{"{", 
     RowBox[{"explistdarkquest", ",", 
      RowBox[{"Table", "[", 
       RowBox[{"detectablepdgs", ",", 
        RowBox[{"Length", "[", "explistdarkquest", "]"}]}], "]"}]}], "}"}]}], 
   "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.8934862862016535`*^9, 3.893486289097942*^9}, {
   3.893518137059581*^9, 3.89351813706666*^9}, 3.8935193128415318`*^9, {
   3.8935201260247593`*^9, 3.89352016933228*^9}, {3.8935206582298803`*^9, 
   3.8935206582348347`*^9}, 3.8935208065069847`*^9, {3.893954261447019*^9, 
   3.8939542625428047`*^9}, 3.8939543153908477`*^9, {3.893988641313972*^9, 
   3.8939886463305106`*^9}, {3.89398878084554*^9, 3.8939888059815164`*^9}, {
   3.8939888734234176`*^9, 3.8939888756084447`*^9}, {3.8939889576548753`*^9, 
   3.8939890185194693`*^9}, {3.893989053881732*^9, 3.893989084928361*^9}, {
   3.893989116622634*^9, 3.8939891555964212`*^9}, 3.8944385906184597`*^9, {
   3.896777444607157*^9, 3.896777445141839*^9}, {3.897145306894249*^9, 
   3.8971453193979206`*^9}, {3.8971454739583225`*^9, 
   3.8971454869626627`*^9}, {3.901526792990489*^9, 3.9015268002922482`*^9}, {
   3.9050601704165545`*^9, 3.905060170535262*^9}, 3.910240594890833*^9, {
   3.9102469737782307`*^9, 3.9102469737792425`*^9}, {3.9102554978705907`*^9, 
   3.9102554981885843`*^9}, {3.910255894526585*^9, 3.9102559798755646`*^9}, {
   3.910259025449719*^9, 3.910259030337371*^9}, {3.9120573594336987`*^9, 
   3.9120573689383154`*^9}},
 CellLabel->
  "In[681]:=",ExpressionUUID->"44291257-037a-4f98-8147-aa030da8ff2c"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Cross-sections", "Subsubsection",
 CellChangeTimes->{{3.8933256308713317`*^9, 
  3.8933256323468237`*^9}},ExpressionUUID->"feb7364a-d1da-4b05-976d-\
a48497cffd75"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"MapThread", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"NPOTexperiment", "[", "#1", "]"}], "=", "#2"}], ")"}], "&"}], 
    ",", 
    RowBox[{"{", 
     RowBox[{"explistdarkquest", ",", 
      RowBox[{"{", 
       RowBox[{
        SuperscriptBox["10", "20"], ",", 
        SuperscriptBox["10", "18"]}], "}"}]}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"AtargetExperiment", "[", "#1", "]"}], "=", "#2"}], ")"}], 
      "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistdarkquest", ",", 
       RowBox[{"{", 
        RowBox[{"56", ",", "56"}], "}"}]}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Cascade", " ", "enhancement", " ", "of", " ", "the", " ", "production", 
    " ", "relative", " ", "to", " ", "the", " ", "production", " ", "in", " ",
     "pure", " ", "pp", " ", 
    RowBox[{"collisions", ".", " ", "Relevant"}], " ", "for", " ", "fixed", 
    " ", "target", " ", "experiments"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "For", " ", "all", " ", "experiments", " ", "located", " ", "at", " ", 
     "SPS"}], ",", " ", 
    RowBox[{
     RowBox[{
      RowBox[{
      "the", " ", "cascade", " ", "darkquesttors", " ", "is", " ", "taken", 
       " ", "from", " ", 
       RowBox[{"http", ":"}]}], "//", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"cds", ".", "cern", ".", "ch"}], "/", "record"}], "/", 
          "2115534"}], "/", "files"}], "/", "SHiP"}], "-", "NOTE", "-", 
       "2015", "-", 
       RowBox[{"009.", 
        RowBox[{"pdf", "?", "version"}]}]}]}], "=", "1"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"CascadeFactorbb", "[", "#1", "]"}], "=", "#2"}], ")"}], 
      "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistdarkquest", ",", 
       RowBox[{"Table", "[", 
        RowBox[{"1.", ",", 
         RowBox[{"Length", "[", "explistdarkquest", "]"}]}], "]"}]}], "}"}]}],
     "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Fraction", " ", "of", " ", "produced", " ", "bb", " ", "per", " ", "PoT", 
    " ", "at", " ", "the", " ", "given", " ", "experiment"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"PppTobbExperiment", "[", "exp", "]"}], "=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"\[Sigma]ppTobbInpbFacility", "[", 
        RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}], "/", 
       RowBox[{"\[Sigma]ppInpbFacility", "[", 
        RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}]}], ")"}], 
     SuperscriptBox[
      RowBox[{"AtargetExperiment", "[", "exp", "]"}], "0.29"], "*", 
     RowBox[{"CascadeFactorbb", "[", "exp", "]"}]}]}], ",", 
   RowBox[{"{", 
    RowBox[{"exp", ",", "explistdarkquest"}], "}"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"CascadeFactorcc", "[", "#1", "]"}], "=", "#2"}], ")"}], 
      "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistdarkquest", ",", 
       RowBox[{"Table", "[", 
        RowBox[{"1.", ",", 
         RowBox[{"Length", "[", "explistdarkquest", "]"}]}], "]"}]}], "}"}]}],
     "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Fraction", " ", "of", " ", "produced", " ", "cc", " ", "per", " ", "PoT", 
    " ", "at", " ", "the", " ", "given", " ", "experiment"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"PppToccExperiment", "[", "exp", "]"}], "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"\[Sigma]ppToccInpbFacility", "[", 
         RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}], "/", 
        RowBox[{"\[Sigma]ppInpbFacility", "[", 
         RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}]}], ")"}], 
      SuperscriptBox[
       RowBox[{"AtargetExperiment", "[", "exp", "]"}], "0.29"], "*", 
      RowBox[{"CascadeFactorcc", "[", "exp", "]"}]}]}], ",", 
    RowBox[{"{", 
     RowBox[{"exp", ",", "explistdarkquest"}], "}"}]}], "]"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Fraction", " ", "of", " ", "produced", " ", "h", " ", "per", " ", "PoT", 
    " ", "at", " ", "the", " ", "given", " ", "experiment"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"PppTohExperiment", "[", "exp", "]"}], "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"\[Sigma]ppTohInpbFacility", "[", 
          RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}], "/", 
         RowBox[{"\[Sigma]ppInpbFacility", "[", 
          RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}]}], ")"}], 
       SuperscriptBox[
        RowBox[{"AtargetExperiment", "[", "exp", "]"}], "0.29"]}]}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistdarkquest"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Fraction", " ", "of", " ", "produced", " ", "W", " ", "per", " ", "PoT", 
    " ", "at", " ", "the", " ", "given", " ", "experiment"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"PppToWExperiment", "[", "exp", "]"}], "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"\[Sigma]ppToWInpbFacility", "[", 
          RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}], "/", 
         RowBox[{"\[Sigma]ppInpbFacility", "[", 
          RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}]}], ")"}], 
       SuperscriptBox[
        RowBox[{"AtargetExperiment", "[", "exp", "]"}], "0.29"]}]}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistdarkquest"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Fraction", " ", "of", " ", "produced", " ", 
    SuperscriptBox["\[Pi]", "0"], " ", "per", " ", "PoT", " ", "at", " ", 
    "the", " ", "given", " ", "experiment"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"PppTo\[Pi]0exp", "[", "exp", "]"}], "=", 
      RowBox[{"PppTo\[Pi]0Facility", "[", 
       RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistdarkquest"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Fraction", " ", "of", " ", "produced", " ", "\[Eta]", " ", "per", " ", 
    "PoT", " ", "at", " ", "the", " ", "given", " ", "experiment"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"PppTo\[Eta]exp", "[", "exp", "]"}], "=", 
      RowBox[{"PppTo\[Eta]Facility", "[", 
       RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistdarkquest"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Fraction", " ", "of", " ", "produced", " ", 
    RowBox[{"\[Eta]", "'"}], " ", "per", " ", "PoT", " ", "at", " ", "the", 
    " ", "given", " ", "experiment"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"PppTo\[Eta]prexp", "[", "exp", "]"}], "=", 
      RowBox[{"PppTo\[Eta]prFacility", "[", 
       RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistdarkquest"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Fraction", " ", "of", " ", "produced", " ", 
    SuperscriptBox["\[Rho]", "0"], " ", "per", " ", "PoT", " ", "at", " ", 
    "the", " ", "given", " ", "experiment"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"PppTo\[Rho]0exp", "[", "exp", "]"}], "=", 
      RowBox[{"PppTo\[Rho]0Facility", "[", 
       RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistdarkquest"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Fraction", " ", "of", " ", "produced", " ", "\[Omega]", " ", "per", " ", 
    "PoT", " ", "at", " ", "the", " ", "given", " ", "experiment"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"PppTo\[Omega]exp", "[", "exp", "]"}], "=", 
     RowBox[{"PppTo\[Omega]Facility", "[", 
      RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"exp", ",", "explistdarkquest"}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"PppToJpsiexp", "[", "exp", "]"}], "=", 
      RowBox[{
       RowBox[{"PppToJpsiFacility", "[", 
        RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}], 
       SuperscriptBox[
        RowBox[{"AtargetExperiment", "[", "exp", "]"}], "0.29"]}]}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistdarkquest"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Fraction", " ", "of", " ", "produced", " ", "\[CapitalUpsilon]", 
    RowBox[{"(", 
     RowBox[{"1", "s"}], ")"}], " ", "per", " ", "PoT", " ", "at", " ", "the",
     " ", "given", " ", "experiment"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"PppToUpsilonexp", "[", "exp", "]"}], "=", 
      RowBox[{
       RowBox[{"PppToUpsilonFacility", "[", 
        RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}], 
       SuperscriptBox[
        RowBox[{"AtargetExperiment", "[", "exp", "]"}], "0.29"]}]}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistdarkquest"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Fraction", " ", "of", " ", "produced", " ", "\[Phi]", " ", "at", " ", 
    "the", " ", "given", " ", "experiment"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"PppToPhiexp", "[", "exp", "]"}], "=", 
      RowBox[{"PppToPhiFacility", "[", 
       RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistdarkquest"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Overall", " ", "table", " ", "with", " ", "cross"}], "-", 
    RowBox[{"sections", " ", "used", " ", "for", " ", "exporting"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"TableNumbersParticlesExperiment", "[", "exp", "]"}], "=", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "\"\<Facility\>\"", ",", "\"\<Npot\>\"", ",", "\"\<Atarget\>\"", ",", 
         "\"\<PPi0\>\"", ",", "\"\<PEta\>\"", ",", "\"\<PEtapr\>\"", ",", 
         "\"\<PRho0\>\"", ",", "\"\<POmega\>\"", ",", "\"\<Pc\>\"", ",", 
         "\"\<Pb\>\"", ",", "\"\<PW\>\"", ",", "\"\<Ph\>\"", ",", 
         "\"\<PJpsi\>\"", ",", "\"\<PUpsilon\>\"", ",", "\"\<PPhi\>\""}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"FacilityExperiment", "[", "exp", "]"}], ",", 
         RowBox[{"NPOTexperiment", "[", "exp", "]"}], ",", 
         RowBox[{"AtargetExperiment", "[", "exp", "]"}], ",", 
         RowBox[{"PppTo\[Pi]0exp", "[", "exp", "]"}], ",", 
         RowBox[{"PppTo\[Eta]exp", "[", "exp", "]"}], ",", 
         RowBox[{"PppTo\[Eta]prexp", "[", "exp", "]"}], ",", 
         RowBox[{"PppTo\[Rho]0exp", "[", "exp", "]"}], ",", 
         RowBox[{"PppTo\[Omega]exp", "[", "exp", "]"}], ",", 
         RowBox[{"2", 
          RowBox[{"PppToccExperiment", "[", "exp", "]"}]}], ",", 
         RowBox[{"2", 
          RowBox[{"PppTobbExperiment", "[", "exp", "]"}]}], ",", 
         RowBox[{"PppToWExperiment", "[", "exp", "]"}], ",", 
         RowBox[{"PppTohExperiment", "[", "exp", "]"}], ",", 
         RowBox[{"PppToJpsiexp", "[", "exp", "]"}], ",", 
         RowBox[{"PppToUpsilonexp", "[", "exp", "]"}], ",", 
         RowBox[{"PppToPhiexp", "[", "exp", "]"}]}], "}"}]}], "}"}], "//", 
     "N"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"exp", ",", "explistdarkquest"}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.894125311556944*^9, 3.89412531594821*^9}, {
   3.8941782427051525`*^9, 3.894178246346468*^9}, {3.8941787220042343`*^9, 
   3.894178724778617*^9}, {3.8972358046331434`*^9, 3.89723582050965*^9}, {
   3.8972862210036745`*^9, 3.897286227618767*^9}, 3.899196399219614*^9, {
   3.899197092164558*^9, 3.899197093230585*^9}, {3.89919714236172*^9, 
   3.8991971425557594`*^9}},
 CellLabel->
  "In[716]:=",ExpressionUUID->"dbda6fb6-acb1-42b8-ab24-7ce9b6c210d9"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Conditions for the LLP to decay inside the decay volume and for the products \
to point to the end of the detector\
\>", "Subsubsection",
 CellChangeTimes->{{3.905011297554874*^9, 3.9050113192993593`*^9}, 
   3.9154372093290033`*^9},ExpressionUUID->"e816a7af-276a-4dd9-971f-\
9de6fa8be3b8"],

Cell[BoxData[
 RowBox[{"Do", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"IfLLPinsideDecVol", "[", 
      RowBox[{"zLLP_", ",", "xLLP_", ",", "yLLP_", ",", "exp"}], "]"}], "=", 
     RowBox[{"IfLLPinsideDecVolSimple", "[", "exp", "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"IfLLPtoDet", "[", 
        RowBox[{
        "x1LLPproj_", ",", "x2LLPproj_", ",", "xLongProj_", ",", "exp"}], 
        "]"}], ",", 
       RowBox[{"IfLLPnotToDet", "[", 
        RowBox[{
        "x1LLPproj_", ",", "x2LLPproj_", ",", "xLongProj_", ",", "exp"}], 
        "]"}]}], "}"}], "=", 
     RowBox[{"IfParticlePointsToDetSimple", "[", "exp", "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"IfLLPdecVolToDet", "[", 
      RowBox[{
      "zLLP_", ",", "xLLP_", ",", "yLLP_", ",", "x1LLPproj_", ",", 
       "x2LLPproj_", ",", "xLongProj_", ",", "exp"}], "]"}], "=", 
     RowBox[{
      RowBox[{"IfLLPinsideDecVol", "[", 
       RowBox[{"zLLP", ",", "xLLP", ",", "yLLP", ",", "exp"}], "]"}], "*", 
      RowBox[{"IfLLPtoDet", "[", 
       RowBox[{"x1LLPproj", ",", "x2LLPproj", ",", "xLongProj", ",", "exp"}], 
       "]"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"IfLLPdecVolNotToDet", "[", 
      RowBox[{
      "zLLP_", ",", "xLLP_", ",", "yLLP_", ",", "x1LLPproj_", ",", 
       "x2LLPproj_", ",", "xLongProj_", ",", "exp"}], "]"}], "=", 
     RowBox[{
      RowBox[{"IfLLPinsideDecVol", "[", 
       RowBox[{"zLLP", ",", "xLLP", ",", "yLLP", ",", "exp"}], "]"}], "*", 
      RowBox[{"IfLLPnotToDet", "[", 
       RowBox[{"x1LLPproj", ",", "x2LLPproj", ",", "xLongProj", ",", "exp"}], 
       "]"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"DecayAcceptanceGeometry", "[", 
      RowBox[{"coord1_", ",", "coord2_", ",", "xLongProj_", ",", "exp"}], 
      "]"}], "=", 
     RowBox[{"IfLLPtoDet", "[", 
      RowBox[{"coord1", ",", "coord2", ",", "xLongProj", ",", "exp"}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", ",", 
   RowBox[{"{", 
    RowBox[{"exp", ",", "explistdarkquest"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.9050149436815815`*^9, 3.905014944318714*^9}, 
   3.9050171519079247`*^9, {3.9050594652983236`*^9, 3.9050594678792458`*^9}, {
   3.910258574554285*^9, 3.910258640956643*^9}, 3.9102588185284185`*^9, 
   3.91025993571624*^9, {3.915437007132573*^9, 3.9154370915377355`*^9}, {
   3.915437209348261*^9, 3.9154372094217663`*^9}},
 CellLabel->
  "In[733]:=",ExpressionUUID->"ed68ff8d-db9d-41a8-8ecd-da27b402cc2e"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["SND@LHC/FASER\[Nu]", "Subsection",
 CellChangeTimes->{{3.893324399890606*^9, 3.8933244005702376`*^9}, {
  3.8935219267411356`*^9, 
  3.893521931184104*^9}},ExpressionUUID->"3d40b5f9-720e-4a7d-8279-\
f492c6f212fa"],

Cell[CellGroupData[{

Cell["Geometry", "Subsubsection",
 CellChangeTimes->{{3.893342623432827*^9, 
  3.893342624458*^9}},ExpressionUUID->"ba977a3a-070a-4ae1-b71a-d70b0feb146d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"explistsnd", "=", 
    RowBox[{"{", 
     RowBox[{"\"\<SNDatLHC\>\"", ",", "\"\<FASER\[Nu]\>\""}], "}"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Distance", " ", "to", " ", "the", " ", "fiducial", " ", "volume", " ", 
    "along", " ", "the", " ", "beamline", " ", 
    RowBox[{"axis", ".", " ", 
     RowBox[{"MapThread", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"list1", "[", "#", "]"}], "=", "#2"}], ")"}], "&"}], ",", 
       RowBox[{"{", 
        RowBox[{"listexp", ",", "listvals"}], "}"}]}], "]"}]}], " ", 
    "equates", " ", "the", " ", "elements", " ", "list1", " ", "with", " ", 
    "keys", " ", "from", " ", "listexp", " ", "to", " ", "the", " ", 
    "corresponding", " ", "elements", " ", "of", " ", "the", " ", "list", " ",
     "listvals"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"zToDecayVolumeExperiment", "[", "#1", "]"}], "=", "#2"}], 
       ")"}], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistsnd", ",", 
       RowBox[{"Table", "[", 
        RowBox[{"480.", ",", 
         RowBox[{"Length", "[", "explistsnd", "]"}]}], "]"}]}], "}"}]}], 
    "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Detector", " ", "has", " ", "the", " ", "axis", " ", "along", " ", 
    "which", " ", "its", " ", "components", " ", "are", " ", 
    RowBox[{"placed", ".", " ", "The"}], " ", "option", " ", "below", " ", 
    "defines", " ", "the", " ", "orientation", " ", "of", " ", "the", " ", 
    "final", " ", "plane", " ", "transverse", " ", "to", " ", "this", " ", 
    "axis", " ", "relative", " ", "to", " ", "the", " ", "beamline"}], "*)"}],
   "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Transverse", " ", "if", " ", "the", " ", "plane", " ", "is", " ", 
     "tranverse", " ", 
     RowBox[{"(", 
      RowBox[{"SHiP", ",", " ", 
       RowBox[{"FACET", " ", "etc"}]}], ")"}]}], ",", " ", 
    RowBox[{
    "and", " ", "Parallel", " ", "if", " ", "it", " ", "is", " ", "parallel", 
     " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Codex", "-", "b"}], ",", " ", "ANUBIS"}]}]}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"DetectorPlaneOrientationExperiment", "[", "#1", "]"}], "=", 
        "#2"}], ")"}], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistsnd", ",", 
       RowBox[{"Table", "[", 
        RowBox[{"\"\<Transverse\>\"", ",", 
         RowBox[{"Length", "[", "explistsnd", "]"}]}], "]"}]}], "}"}]}], 
    "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Facility", " ", "hosting", " ", "the", " ", 
     RowBox[{"experiment", ":", " ", "SPS"}]}], ",", " ", "Fermilab", ",", 
    " ", "LHC", ",", " ", 
    RowBox[{"FCC", "-", "hh"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"FacilityExperiment", "[", "#1", "]"}], "=", "#2"}], ")"}], 
      "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistsnd", ",", 
       RowBox[{"Table", "[", 
        RowBox[{"\"\<LHC\>\"", ",", 
         RowBox[{"Length", "[", "explistsnd", "]"}]}], "]"}]}], "}"}]}], 
    "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Geometry", " ", "of", " ", "the", " ", 
     RowBox[{"experiment", ":", " ", "box"}]}], ",", " ", "cylinder", ",", 
    " ", 
    RowBox[{"annular", " ", "cylinder"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"GeometryExperiment", "[", "#1", "]"}], "=", "#2"}], ")"}], 
      "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistsnd", ",", 
       RowBox[{"Table", "[", 
        RowBox[{"\"\<Box\>\"", ",", 
         RowBox[{"Length", "[", "explistsnd", "]"}]}], "]"}]}], "}"}]}], 
    "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Transverse", " ", "dimensions", " ", "of", " ", "the", " ", "decay", " ",
      "volume", " ", "assuming", " ", "box", " ", "geometry"}], ",", " ", 
    RowBox[{
    "or", " ", "cylindrical", " ", "geometry", " ", "if", " ", "the", " ", 
     "detector", " ", "plane", " ", "is", " ", "parallel", " ", "to", " ", 
     "the", " ", "beamline", " ", 
     RowBox[{
      RowBox[{"(", "ANUBIS", ")"}], ".", " ", "Otherwise"}], " ", "set", " ", 
     "to", " ", "zero"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MapThread", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"dxDecayVolumeExperiment", "[", 
        RowBox[{"z_", ",", "#1"}], "]"}], "=", "#2"}], ")"}], "&"}], ",", 
    RowBox[{"{", 
     RowBox[{"explistsnd", ",", 
      RowBox[{"{", 
       RowBox[{"0.31", ",", "0.25"}], "}"}]}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"dyDecayVolumeExperiment", "[", 
         RowBox[{"z_", ",", "#1"}], "]"}], "=", "#2"}], ")"}], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistsnd", ",", 
       RowBox[{"{", 
        RowBox[{"0.31", ",", "0.3"}], "}"}]}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Decay", " ", "volume", " ", "length", " ", "along", " ", "the", " ", 
    "beamline", " ", "axis"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"dzDecayVolumeExperiment", "[", "#1", "]"}], "=", "#2"}], 
       ")"}], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistsnd", ",", 
       RowBox[{"{", 
        RowBox[{"0.4", ",", "0.77"}], "}"}]}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Distance", " ", "from", " ", "the", " ", "beamline", " ", "to", " ", 
     "the", " ", "decay", " ", "volume", " ", "center", " ", "and", " ", 
     "detector", " ", "along", " ", "the", " ", "x"}], ",", 
    RowBox[{"y", " ", "axes"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MapThread", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"xToDecayVolumeCenterExperiment", "[", 
        RowBox[{"z_", ",", "#1"}], "]"}], "=", "#2"}], ")"}], "&"}], ",", 
    RowBox[{"{", 
     RowBox[{"explistsnd", ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"0.08", "+", 
         FractionBox["0.31", "2"]}], ",", "0."}], "}"}]}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"yToDecayVolumeCenterExperiment", "[", 
         RowBox[{"z_", ",", "#1"}], "]"}], "=", "#2"}], ")"}], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistsnd", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"0.155", "+", 
          FractionBox["0.31", "2"]}], ",", "0."}], "}"}]}], "}"}]}], "]"}], 
   ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Inner", " ", "and", " ", "outer", " ", "radii", " ", "of", " ", "the", 
    " ", "decay", " ", 
    RowBox[{"volume", ".", " ", "Applicable"}], " ", "if", " ", "the", " ", 
    "decay", " ", "volume", " ", "has", " ", "cylindrical", " ", "geometry"}],
    "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"RinnerDecayVolumeExperiment", "[", 
      RowBox[{"exp", ",", "z_"}], "]"}], "=", "0"}], ",", 
    RowBox[{"{", 
     RowBox[{"exp", ",", "explistsnd"}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"RouterDecayVolumeExperiment", "[", 
       RowBox[{"exp", ",", "z_"}], "]"}], "=", "0"}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistsnd"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"z", "-", 
    RowBox[{
    "coordinate", " ", "of", " ", "the", " ", "center", " ", "of", " ", "the",
      " ", "decay", " ", "volume"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"zToDecayVolumeCenterExperiment", "[", "exp", "]"}], "=", 
      RowBox[{
       RowBox[{"zToDecayVolumeExperiment", "[", "exp", "]"}], "+", 
       FractionBox[
        RowBox[{"dzDecayVolumeExperiment", "[", "exp", "]"}], "2"]}]}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistsnd"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Maximal", " ", 
    RowBox[{"long", ".", " ", "displacement"}], " ", "of", " ", "the", " ", 
    "decay", " ", "volume"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"zMaxDecayVolumeExperiment", "[", "exp", "]"}], "=", 
     RowBox[{
      RowBox[{"zToDecayVolumeExperiment", "[", "exp", "]"}], "+", 
      RowBox[{"dzDecayVolumeExperiment", "[", "exp", "]"}]}]}], ",", 
    RowBox[{"{", 
     RowBox[{"exp", ",", "explistsnd"}], "}"}]}], "]"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Whether", " ", "the", " ", "decay", " ", "volume", " ", "serves", " ", 
    "as", " ", "detector", " ", 
    RowBox[{"(", 
     RowBox[{"True", " ", "or", " ", "False"}], ")"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"DecayVolumeAsDetectorExperiment", "[", "exp", "]"}], "=", 
     "\"\<True\>\""}], ",", 
    RowBox[{"{", 
     RowBox[{"exp", ",", "explistsnd"}], "}"}]}], "]"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Transverse", " ", "dimensions", " ", "of", " ", "the", " ", "detector", 
    " ", "assuming", " ", "box", " ", "geometry"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MapThread", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"dxDetectorExperiment", "[", 
        RowBox[{"#1", ",", "z_"}], "]"}], "=", "#2"}], ")"}], "&"}], ",", 
    RowBox[{"{", 
     RowBox[{"explistsnd", ",", 
      RowBox[{"Table", "[", 
       RowBox[{"0", ",", 
        RowBox[{"Length", "[", "explistsnd", "]"}]}], "]"}]}], "}"}]}], "]"}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"dyDetectorExperiment", "[", 
         RowBox[{"#1", ",", "z_"}], "]"}], "=", "#2"}], ")"}], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistsnd", ",", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", 
         RowBox[{"Length", "[", "explistsnd", "]"}]}], "]"}]}], "}"}]}], 
    "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Length", " ", "of", " ", "the", " ", "detector", " ", "in", " ", "z", " ",
     "plane"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"dzDetectorExperiment", "[", "#1", "]"}], "=", "#2"}], ")"}], 
      "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistsnd", ",", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", 
         RowBox[{"Length", "[", "explistsnd", "]"}]}], "]"}]}], "}"}]}], 
    "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Coordinates", " ", "of", " ", "the", " ", "center", " ", "of", " ", "the",
     " ", "detector"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"xToDetectorCenterExperiment", "[", "exp", "]"}], "=", "0"}], 
    ",", 
    RowBox[{"{", 
     RowBox[{"exp", ",", "explistsnd"}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"yToDetectorCenterExperiment", "[", "exp", "]"}], "=", 
     RowBox[{
      RowBox[{"yToDecayVolumeCenterExperiment", "[", 
       RowBox[{"z", ",", "exp"}], "]"}], "+", 
      FractionBox[
       RowBox[{"dyDecayVolumeExperiment", "[", 
        RowBox[{"z", ",", "exp"}], "]"}], "2"], "+", 
      FractionBox[
       RowBox[{"dyDetectorExperiment", "[", "exp", "]"}], "2"]}]}], ",", 
    RowBox[{"{", 
     RowBox[{"exp", ",", "explistsnd"}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"zToDetectorCenterExperiment", "[", "exp", "]"}], "=", 
      RowBox[{
       RowBox[{"zMaxDecayVolumeExperiment", "[", "exp", "]"}], "+", 
       FractionBox[
        RowBox[{"dzDetectorExperiment", "[", "exp", "]"}], "2"]}]}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistsnd"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Inner", " ", "and", " ", "outer", " ", "radii", " ", "of", " ", "the", 
    " ", "detector"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"RinnerDetectorExperiment", "[", 
      RowBox[{"exp", ",", "z_"}], "]"}], "=", "0"}], ",", 
    RowBox[{"{", 
     RowBox[{"exp", ",", "explistsnd"}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"RouterDetectorExperiment", "[", 
       RowBox[{"exp", ",", "z_"}], "]"}], "=", "0"}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistsnd"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Length", " ", "of", " ", "the", " ", "detector", " ", "along", " ", "the",
     " ", "detector", " ", "axis"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"dxLongDetectorExperiment", "[", "exp", "]"}], "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"DetectorPlaneOrientationExperiment", "[", "exp", "]"}], 
         "\[Equal]", "\"\<Transverse\>\""}], ",", 
        RowBox[{"dzDetectorExperiment", "[", "exp", "]"}], ",", 
        RowBox[{"dyDetectorExperiment", "[", "exp", "]"}]}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistsnd"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "The", " ", "maximal", " ", "coordinate", " ", "of", " ", "the", " ", 
    "end", " ", "of", " ", "the", " ", "detector", " ", "plane", " ", 
    RowBox[{"(", 
     RowBox[{"along", " ", "the", " ", "detector", " ", "axis"}], ")"}], " ", 
    "used", " ", "to", " ", "calculate", " ", "the", " ", "decay", " ", 
    RowBox[{"acceptance", ".", " ", "May"}], " ", "be", " ", "either", " ", 
    "the", " ", "z", " ", "coordinate", " ", "or", " ", "the", " ", "y", " ", 
    "coordinate", " ", 
    RowBox[{"(", 
     RowBox[{
     "if", " ", "the", " ", "final", " ", "detector", " ", "plane", " ", "is",
       " ", "oriented", " ", "parallel", " ", "to", " ", "the", " ", 
      "beamline"}], ")"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"xLongMaxDetectorExperiment", "[", "exp", "]"}], "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"DetectorPlaneOrientationExperiment", "[", "exp", "]"}], 
         "\[Equal]", "\"\<Transverse\>\""}], ",", 
        RowBox[{
         RowBox[{"zMaxDecayVolumeExperiment", "[", "exp", "]"}], "+", 
         RowBox[{"dxLongDetectorExperiment", "[", "exp", "]"}]}], ",", 
        RowBox[{
         RowBox[{"yToDetectorCenterExperiment", "[", "exp", "]"}], "+", 
         RowBox[{
          RowBox[{"dyDetectorExperiment", "[", "exp", "]"}], "/", "2"}]}]}], 
       "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistsnd"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Position", " ", "of", " ", "the", " ", "final", " ", "plane", " ", "for", 
    " ", "the", " ", "decay", " ", "products", " ", "along", " ", "the", " ", 
    "detector", " ", "axis"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"xLongDecayProductFinalPlaneExperiment", "[", "exp", "]"}], "=", 
     RowBox[{"xLongMaxDetectorExperiment", "[", "exp", "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"exp", ",", "explistsnd"}], "}"}]}], "]"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Whether", " ", "the", " ", "experiment", " ", "has", " ", "dipole", " ", 
    "magnet", " ", "in", " ", "the", " ", "detector", " ", 
    RowBox[{"(", 
     RowBox[{"True", ",", " ", "False"}], ")"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"DipoleMagnetOptionExperiment", "[", "#1", "]"}], "=", "#2"}],
        ")"}], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistsnd", ",", 
       RowBox[{"Table", "[", 
        RowBox[{"\"\<False\>\"", ",", 
         RowBox[{"Length", "[", "explistsnd", "]"}]}], "]"}]}], "}"}]}], 
    "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Longitudinal", " ", "positions", " ", "of", " ", "the", " ", "dipole", 
    " ", "magnet", " ", "of", " ", "the", " ", "detector"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MapThread", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"zMagnetMinExperiment", "[", "#1", "]"}], "=", "#2"}], ")"}], 
     "&"}], ",", 
    RowBox[{"{", 
     RowBox[{"explistsnd", ",", 
      RowBox[{"Table", "[", 
       RowBox[{"0", ",", 
        RowBox[{"Length", "[", "explistsnd", "]"}]}], "]"}]}], "}"}]}], "]"}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"zMagnetMaxExperiment", "[", "#1", "]"}], "=", "#2"}], ")"}], 
      "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistsnd", ",", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", 
         RowBox[{"Length", "[", "explistsnd", "]"}]}], "]"}]}], "}"}]}], 
    "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Mean", " ", "magnetic", " ", "field", " ", "of", " ", "the", " ", 
    "dipole", " ", "magnet"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"MagneticFieldExperiment", "[", "#1", "]"}], "=", "#2"}], 
       ")"}], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistsnd", ",", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", 
         RowBox[{"Length", "[", "explistsnd", "]"}]}], "]"}]}], "}"}]}], 
    "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"ECAL", " ", "option", " ", 
    RowBox[{"(", 
     RowBox[{"True", ",", "False"}], ")"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"ECALoptionExperiment", "[", "exp", "]"}], "=", 
      "\"\<True\>\""}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistsnd"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Position", " ", "of", " ", "the", " ", "beginning", " ", "of", " ", "the",
     " ", "ECAL"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"zECALminExperiment", "[", "#1", "]"}], "=", "#2"}], ")"}], 
      "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistsnd", ",", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", 
         RowBox[{"Length", "[", "explistsnd", "]"}]}], "]"}]}], "}"}]}], 
    "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "The", " ", "final", " ", "detector", " ", "plane", " ", "needed", " ", 
     "to", " ", "reconstruct", " ", 
     RowBox[{"muons", ".", " ", "Depeding"}], " ", "on", " ", "the", " ", 
     "experiment"}], ",", " ", 
    RowBox[{
    "it", " ", "is", " ", "approximated", " ", "by", " ", "be", " ", "end", 
     " ", "of", " ", "the", " ", "trackers", " ", "or", " ", "the", " ", 
     "muon", " ", "system"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"xLongMuonPlaneExperiment", "[", "exp", "]"}], "=", "0"}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistsnd"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "The", " ", "final", " ", "detector", " ", "plane", " ", "needed", " ", 
     "to", " ", "reconstruct", " ", "other", " ", 
     RowBox[{"particles", ".", " ", "Depeding"}], " ", "on", " ", "the", " ", 
     "experiment"}], ",", " ", 
    RowBox[{
    "it", " ", "is", " ", "approximated", " ", "by", " ", "the", " ", "end", 
     " ", "of", " ", "the", " ", "trackers", " ", "or", " ", "the", " ", 
     "calorimeter", " ", "system"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"xLongNonMuonPlaneExperiment", "[", "exp", "]"}], "=", "0"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistsnd"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"List", " ", "of", " ", "detectable", " ", 
     RowBox[{"particles", ".", " ", "If"}], " ", "ECAL", " ", "is", " ", 
     "absent"}], ",", " ", 
    RowBox[{
    "it", " ", "is", " ", "assumed", " ", "by", " ", "default", " ", "that", 
     " ", "photons", " ", "and", " ", 
     SubscriptBox[
      SuperscriptBox["K", "0"], "L"], " ", "cannot", " ", "be", " ", 
     "detected"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MapThread", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"DetectablePDGsExperiment", "[", "#1", "]"}], "=", "#2"}], 
      ")"}], "&"}], ",", 
    RowBox[{"{", 
     RowBox[{"explistsnd", ",", 
      RowBox[{"Table", "[", 
       RowBox[{"detectablepdgs", ",", 
        RowBox[{"Length", "[", "explistsnd", "]"}]}], "]"}]}], "}"}]}], "]"}],
   ";"}]}], "Input",
 CellChangeTimes->{{3.8934862862111635`*^9, 3.893486289101931*^9}, {
   3.8934999953831625`*^9, 3.893500001065502*^9}, {3.8935001679579945`*^9, 
   3.8935001709587584`*^9}, {3.8935003606663184`*^9, 3.893500363223881*^9}, {
   3.893518137072644*^9, 3.8935181370796366`*^9}, 3.8935193128475156`*^9, {
   3.893520126029746*^9, 3.8935201693363*^9}, 3.893520658238859*^9, {
   3.8935219485485992`*^9, 3.8935220114931326`*^9}, 3.894438590646804*^9, {
   3.8971453069184313`*^9, 3.897145319404414*^9}, {3.897145473964569*^9, 
   3.89714548696819*^9}, 3.897147806010866*^9, {3.9050601850572777`*^9, 
   3.90506018524771*^9}, 3.9102405948999133`*^9, {3.9102469737882614`*^9, 
   3.9102469737927685`*^9}, {3.9102561213984113`*^9, 3.910256142235017*^9}, {
   3.910259044355898*^9, 3.9102590481384206`*^9}, {3.912057375895506*^9, 
   3.9120573833491364`*^9}},
 CellLabel->
  "In[734]:=",ExpressionUUID->"87632c9d-e9c6-44c2-b8cd-340248aca50b"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Cross-sections", "Subsubsection",
 CellChangeTimes->{{3.8933256308713317`*^9, 
  3.8933256323468237`*^9}},ExpressionUUID->"d9987b68-7dc2-40fe-a662-\
1b24aef008ca"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "0.1", " ", "stays", " ", "for", " ", "10", " ", "times", " ", "lower", 
    " ", "luminosity", " ", "of", " ", "running", " ", "time", " ", "of", " ", 
    RowBox[{"SND", "@", "LHC"}], " ", "compared", " ", "to", " ", "high", " ",
     "lumi"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"MapThread", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"NPOTexperiment", "[", "#1", "]"}], "=", "#2"}], ")"}], 
       "&"}], ",", 
      RowBox[{"{", 
       RowBox[{"explistsnd", ",", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           FractionBox["1", "20"], "*", "LLHChighLumi", "*", 
           RowBox[{"\[Sigma]ppInpbFacility", "[", "\"\<LHC\>\"", "]"}]}], ",", 
          RowBox[{"Length", "[", "explistsnd", "]"}]}], "]"}]}], "}"}]}], 
     "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MapThread", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"AtargetExperiment", "[", "#1", "]"}], "=", "#2"}], ")"}], 
       "&"}], ",", 
      RowBox[{"{", 
       RowBox[{"explistsnd", ",", 
        RowBox[{"Table", "[", 
         RowBox[{"1.", ",", 
          RowBox[{"Length", "[", "explistsnd", "]"}]}], "]"}]}], "}"}]}], 
     "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Cascade", " ", "enhancement", " ", "of", " ", "the", " ", "production", 
     " ", "relative", " ", "to", " ", "the", " ", "production", " ", "in", 
     " ", "pure", " ", "pp", " ", 
     RowBox[{"collisions", ".", " ", "Relevant"}], " ", "for", " ", "fixed", 
     " ", "target", " ", "experiments"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "For", " ", "all", " ", "experiments", " ", "located", " ", "at", " ", 
      "SPS"}], ",", " ", 
     RowBox[{
      RowBox[{
       RowBox[{
       "the", " ", "cascade", " ", "sndtors", " ", "is", " ", "taken", " ", 
        "from", " ", 
        RowBox[{"http", ":"}]}], "//", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"cds", ".", "cern", ".", "ch"}], "/", "record"}], "/", 
           "2115534"}], "/", "files"}], "/", "SHiP"}], "-", "NOTE", "-", 
        "2015", "-", 
        RowBox[{"009.", 
         RowBox[{"pdf", "?", "version"}]}]}]}], "=", "1"}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MapThread", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"CascadeFactorbb", "[", "#1", "]"}], "=", "#2"}], ")"}], 
       "&"}], ",", 
      RowBox[{"{", 
       RowBox[{"explistsnd", ",", 
        RowBox[{"Table", "[", 
         RowBox[{"1.", ",", 
          RowBox[{"Length", "[", "explistsnd", "]"}]}], "]"}]}], "}"}]}], 
     "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Fraction", " ", "of", " ", "produced", " ", "bb", " ", "per", " ", "PoT",
      " ", "at", " ", "the", " ", "given", " ", "experiment"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"PppTobbExperiment", "[", "exp", "]"}], "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"\[Sigma]ppTobbInpbFacility", "[", 
          RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}], "/", 
         RowBox[{"\[Sigma]ppInpbFacility", "[", 
          RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}]}], ")"}], 
       SuperscriptBox[
        RowBox[{"AtargetExperiment", "[", "exp", "]"}], "0.29"], "*", 
       RowBox[{"CascadeFactorbb", "[", "exp", "]"}]}]}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistsnd"}], "}"}]}], "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MapThread", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"CascadeFactorcc", "[", "#1", "]"}], "=", "#2"}], ")"}], 
       "&"}], ",", 
      RowBox[{"{", 
       RowBox[{"explistsnd", ",", 
        RowBox[{"Table", "[", 
         RowBox[{"1.", ",", 
          RowBox[{"Length", "[", "explistsnd", "]"}]}], "]"}]}], "}"}]}], 
     "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Fraction", " ", "of", " ", "produced", " ", "cc", " ", "per", " ", "PoT",
      " ", "at", " ", "the", " ", "given", " ", "experiment"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"PppToccExperiment", "[", "exp", "]"}], "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"\[Sigma]ppToccInpbFacility", "[", 
          RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}], "/", 
         RowBox[{"\[Sigma]ppInpbFacility", "[", 
          RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}]}], ")"}], 
       SuperscriptBox[
        RowBox[{"AtargetExperiment", "[", "exp", "]"}], "0.29"], "*", 
       RowBox[{"CascadeFactorcc", "[", "exp", "]"}]}]}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistsnd"}], "}"}]}], "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Fraction", " ", "of", " ", "produced", " ", "h", " ", "per", " ", "PoT", 
     " ", "at", " ", "the", " ", "given", " ", "experiment"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"PppTohExperiment", "[", "exp", "]"}], "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\[Sigma]ppTohInpbFacility", "[", 
           RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}], "/", 
          RowBox[{"\[Sigma]ppInpbFacility", "[", 
           RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}]}], ")"}], 
        SuperscriptBox[
         RowBox[{"AtargetExperiment", "[", "exp", "]"}], "0.29"]}]}], ",", 
      RowBox[{"{", 
       RowBox[{"exp", ",", "explistsnd"}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Fraction", " ", "of", " ", "produced", " ", "W", " ", "per", " ", "PoT", 
     " ", "at", " ", "the", " ", "given", " ", "experiment"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"PppToWExperiment", "[", "exp", "]"}], "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\[Sigma]ppToWInpbFacility", "[", 
           RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}], "/", 
          RowBox[{"\[Sigma]ppInpbFacility", "[", 
           RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}]}], ")"}], 
        SuperscriptBox[
         RowBox[{"AtargetExperiment", "[", "exp", "]"}], "0.29"]}]}], ",", 
      RowBox[{"{", 
       RowBox[{"exp", ",", "explistsnd"}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Fraction", " ", "of", " ", "produced", " ", 
     SuperscriptBox["\[Pi]", "0"], " ", "per", " ", "PoT", " ", "at", " ", 
     "the", " ", "given", " ", "experiment"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"PppTo\[Pi]0exp", "[", "exp", "]"}], "=", 
       RowBox[{"PppTo\[Pi]0Facility", "[", 
        RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"exp", ",", "explistsnd"}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Fraction", " ", "of", " ", "produced", " ", "\[Eta]", " ", "per", " ", 
     "PoT", " ", "at", " ", "the", " ", "given", " ", "experiment"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"PppTo\[Eta]exp", "[", "exp", "]"}], "=", 
       RowBox[{"PppTo\[Eta]Facility", "[", 
        RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"exp", ",", "explistsnd"}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Fraction", " ", "of", " ", "produced", " ", 
     RowBox[{"\[Eta]", "'"}], " ", "per", " ", "PoT", " ", "at", " ", "the", 
     " ", "given", " ", "experiment"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"PppTo\[Eta]prexp", "[", "exp", "]"}], "=", 
       RowBox[{"PppTo\[Eta]prFacility", "[", 
        RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"exp", ",", "explistsnd"}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Fraction", " ", "of", " ", "produced", " ", 
     SuperscriptBox["\[Rho]", "0"], " ", "per", " ", "PoT", " ", "at", " ", 
     "the", " ", "given", " ", "experiment"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"PppTo\[Rho]0exp", "[", "exp", "]"}], "=", 
       RowBox[{"PppTo\[Rho]0Facility", "[", 
        RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"exp", ",", "explistsnd"}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Fraction", " ", "of", " ", "produced", " ", "\[Omega]", " ", "per", " ", 
     "PoT", " ", "at", " ", "the", " ", "given", " ", "experiment"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"PppTo\[Omega]exp", "[", "exp", "]"}], "=", 
       RowBox[{"PppTo\[Omega]Facility", "[", 
        RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"exp", ",", "explistsnd"}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"PppToJpsiexp", "[", "exp", "]"}], "=", 
       RowBox[{
        RowBox[{"PppToJpsiFacility", "[", 
         RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}], 
        SuperscriptBox[
         RowBox[{"AtargetExperiment", "[", "exp", "]"}], "0.29"]}]}], ",", 
      RowBox[{"{", 
       RowBox[{"exp", ",", "explistsnd"}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Fraction", " ", "of", " ", "produced", " ", "\[CapitalUpsilon]", 
     RowBox[{"(", 
      RowBox[{"1", "s"}], ")"}], " ", "per", " ", "PoT", " ", "at", " ", 
     "the", " ", "given", " ", "experiment"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"PppToUpsilonexp", "[", "exp", "]"}], "=", 
       RowBox[{
        RowBox[{"PppToUpsilonFacility", "[", 
         RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}], 
        SuperscriptBox[
         RowBox[{"AtargetExperiment", "[", "exp", "]"}], "0.29"]}]}], ",", 
      RowBox[{"{", 
       RowBox[{"exp", ",", "explistsnd"}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Fraction", " ", "of", " ", "produced", " ", "\[Phi]", " ", "at", " ", 
     "the", " ", "given", " ", "experiment"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"PppToPhiexp", "[", "exp", "]"}], "=", 
       RowBox[{"PppToPhiFacility", "[", 
        RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"exp", ",", "explistsnd"}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Overall", " ", "table", " ", "with", " ", "cross"}], "-", 
     RowBox[{"sections", " ", "used", " ", "for", " ", "exporting"}]}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"TableNumbersParticlesExperiment", "[", "exp", "]"}], "=", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "\"\<Facility\>\"", ",", "\"\<Npot\>\"", ",", "\"\<Atarget\>\"", 
           ",", "\"\<PPi0\>\"", ",", "\"\<PEta\>\"", ",", "\"\<PEtapr\>\"", 
           ",", "\"\<PRho0\>\"", ",", "\"\<POmega\>\"", ",", "\"\<Pc\>\"", 
           ",", "\"\<Pb\>\"", ",", "\"\<PW\>\"", ",", "\"\<Ph\>\"", ",", 
           "\"\<PJpsi\>\"", ",", "\"\<PUpsilon\>\"", ",", "\"\<PPhi\>\""}], 
          "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"FacilityExperiment", "[", "exp", "]"}], ",", 
           RowBox[{"NPOTexperiment", "[", "exp", "]"}], ",", 
           RowBox[{"AtargetExperiment", "[", "exp", "]"}], ",", 
           RowBox[{"PppTo\[Pi]0exp", "[", "exp", "]"}], ",", 
           RowBox[{"PppTo\[Eta]exp", "[", "exp", "]"}], ",", 
           RowBox[{"PppTo\[Eta]prexp", "[", "exp", "]"}], ",", 
           RowBox[{"PppTo\[Rho]0exp", "[", "exp", "]"}], ",", 
           RowBox[{"PppTo\[Omega]exp", "[", "exp", "]"}], ",", 
           RowBox[{"2", 
            RowBox[{"PppToccExperiment", "[", "exp", "]"}]}], ",", 
           RowBox[{"2", 
            RowBox[{"PppTobbExperiment", "[", "exp", "]"}]}], ",", 
           RowBox[{"PppToWExperiment", "[", "exp", "]"}], ",", 
           RowBox[{"PppTohExperiment", "[", "exp", "]"}], ",", 
           RowBox[{"PppToJpsiexp", "[", "exp", "]"}], ",", 
           RowBox[{"PppToUpsilonexp", "[", "exp", "]"}], ",", 
           RowBox[{"PppToPhiexp", "[", "exp", "]"}]}], "}"}]}], "}"}], "//", 
       "N"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistsnd"}], "}"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.8941782511160336`*^9, 3.8941782532367306`*^9}, {
   3.8941787306946573`*^9, 3.8941787323198457`*^9}, {3.897235829267909*^9, 
   3.8972358435924716`*^9}, {3.89728623180696*^9, 3.897286235876445*^9}, 
   3.899196406500745*^9, 3.899197100028205*^9, {3.89919714256129*^9, 
   3.899197142761782*^9}, {3.907695487130719*^9, 3.9076954880827894`*^9}},
 CellLabel->
  "In[769]:=",ExpressionUUID->"31c776a8-f116-4d2e-8e6d-b31393d3c12a"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Conditions for the LLP to decay inside the decay volume and for the products \
to point to the end of the detector\
\>", "Subsubsection",
 CellChangeTimes->{{3.905011297554874*^9, 3.9050113192993593`*^9}, 
   3.915437209428483*^9},ExpressionUUID->"5705842b-3477-4d12-929a-\
2947a2ba190d"],

Cell[BoxData[
 RowBox[{"Do", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"IfLLPinsideDecVol", "[", 
      RowBox[{"zLLP_", ",", "xLLP_", ",", "yLLP_", ",", "exp"}], "]"}], "=", 
     RowBox[{"IfLLPinsideDecVolSimple", "[", "exp", "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"IfLLPtoDet", "[", 
        RowBox[{
        "x1LLPproj_", ",", "x2LLPproj_", ",", "xLongProj_", ",", "exp"}], 
        "]"}], ",", 
       RowBox[{"IfLLPnotToDet", "[", 
        RowBox[{
        "x1LLPproj_", ",", "x2LLPproj_", ",", "xLongProj_", ",", "exp"}], 
        "]"}]}], "}"}], "=", 
     RowBox[{"IfParticlePointsToDetSimple", "[", "exp", "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"IfLLPdecVolToDet", "[", 
      RowBox[{
      "zLLP_", ",", "xLLP_", ",", "yLLP_", ",", "x1LLPproj_", ",", 
       "x2LLPproj_", ",", "xLongProj_", ",", "exp"}], "]"}], "=", 
     RowBox[{
      RowBox[{"IfLLPinsideDecVol", "[", 
       RowBox[{"zLLP", ",", "xLLP", ",", "yLLP", ",", "exp"}], "]"}], "*", 
      RowBox[{"IfLLPtoDet", "[", 
       RowBox[{"x1LLPproj", ",", "x2LLPproj", ",", "xLongProj", ",", "exp"}], 
       "]"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"IfLLPdecVolNotToDet", "[", 
      RowBox[{
      "zLLP_", ",", "xLLP_", ",", "yLLP_", ",", "x1LLPproj_", ",", 
       "x2LLPproj_", ",", "xLongProj_", ",", "exp"}], "]"}], "=", 
     RowBox[{
      RowBox[{"IfLLPinsideDecVol", "[", 
       RowBox[{"zLLP", ",", "xLLP", ",", "yLLP", ",", "exp"}], "]"}], "*", 
      RowBox[{"IfLLPnotToDet", "[", 
       RowBox[{"x1LLPproj", ",", "x2LLPproj", ",", "xLongProj", ",", "exp"}], 
       "]"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"DecayAcceptanceGeometry", "[", 
      RowBox[{"coord1_", ",", "coord2_", ",", "xLongProj_", ",", "exp"}], 
      "]"}], "=", 
     RowBox[{"IfLLPtoDet", "[", 
      RowBox[{"coord1", ",", "coord2", ",", "xLongProj", ",", "exp"}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", ",", 
   RowBox[{"{", 
    RowBox[{"exp", ",", "explistsnd"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.905014954940696*^9, 3.9050149551644964`*^9}, 
   3.9050171519119177`*^9, {3.9050594723410697`*^9, 3.9050594734149313`*^9}, {
   3.910258574558514*^9, 3.910258640960397*^9}, 3.910258818533745*^9, 
   3.910259935721735*^9, {3.915437007156541*^9, 3.9154370915408077`*^9}, {
   3.9154372094481134`*^9, 3.9154372095217514`*^9}},
 CellLabel->
  "In[786]:=",ExpressionUUID->"8ed64fd6-4767-4823-895e-92183af2a11e"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["SND@SHiP/LAr@SHiP", "Subsection",
 CellChangeTimes->{{3.893324399890606*^9, 3.8933244005702376`*^9}, {
  3.8935219267411356`*^9, 3.893521931184104*^9}, {3.8991922967946725`*^9, 
  3.899192303857278*^9}},ExpressionUUID->"45b75dda-4fb8-4569-840f-\
7bfad93f76ca"],

Cell[CellGroupData[{

Cell["Geometry", "Subsubsection",
 CellChangeTimes->{{3.893342623432827*^9, 
  3.893342624458*^9}},ExpressionUUID->"9f87547e-07d2-4ecb-8c96-ad84e2d4e315"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"explistsndship", "=", 
    RowBox[{"{", 
     RowBox[{"\"\<SND-SHiP-ECN3\>\"", ",", "\"\<LAr-SHiP-ECN3\>\""}], "}"}]}],
    ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Distance", " ", "to", " ", "the", " ", "fiducial", " ", "volume", " ", 
    "along", " ", "the", " ", "beamline", " ", 
    RowBox[{"axis", ".", " ", 
     RowBox[{"MapThread", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"list1", "[", "#", "]"}], "=", "#2"}], ")"}], "&"}], ",", 
       RowBox[{"{", 
        RowBox[{"listexp", ",", "listvals"}], "}"}]}], "]"}]}], " ", 
    "equates", " ", "the", " ", "elements", " ", "list1", " ", "with", " ", 
    "keys", " ", "from", " ", "listexp", " ", "to", " ", "the", " ", 
    "corresponding", " ", "elements", " ", "of", " ", "the", " ", "list", " ",
     "listvals"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"zToDecayVolumeExperiment", "[", "#1", "]"}], "=", "#2"}], 
       ")"}], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistsndship", ",", 
       RowBox[{"{", 
        RowBox[{"25", ",", "103"}], "}"}]}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Detector", " ", "has", " ", "the", " ", "axis", " ", "along", " ", 
    "which", " ", "its", " ", "components", " ", "are", " ", 
    RowBox[{"placed", ".", " ", "The"}], " ", "option", " ", "below", " ", 
    "defines", " ", "the", " ", "orientation", " ", "of", " ", "the", " ", 
    "final", " ", "plane", " ", "transverse", " ", "to", " ", "this", " ", 
    "axis", " ", "relative", " ", "to", " ", "the", " ", "beamline"}], "*)"}],
   "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Transverse", " ", "if", " ", "the", " ", "plane", " ", "is", " ", 
     "tranverse", " ", 
     RowBox[{"(", 
      RowBox[{"SHiP", ",", " ", 
       RowBox[{"FACET", " ", "etc"}]}], ")"}]}], ",", " ", 
    RowBox[{
    "and", " ", "Parallel", " ", "if", " ", "it", " ", "is", " ", "parallel", 
     " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Codex", "-", "b"}], ",", " ", "ANUBIS"}]}]}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"DetectorPlaneOrientationExperiment", "[", "#1", "]"}], "=", 
        "#2"}], ")"}], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistsndship", ",", 
       RowBox[{"Table", "[", 
        RowBox[{"\"\<Transverse\>\"", ",", 
         RowBox[{"Length", "[", "explistsndship", "]"}]}], "]"}]}], "}"}]}], 
    "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Facility", " ", "hosting", " ", "the", " ", 
     RowBox[{"experiment", ":", " ", "SPS"}]}], ",", " ", "Fermilab", ",", 
    " ", "LHC", ",", " ", 
    RowBox[{"FCC", "-", "hh"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"FacilityExperiment", "[", "#1", "]"}], "=", "#2"}], ")"}], 
      "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistsndship", ",", 
       RowBox[{"Table", "[", 
        RowBox[{"\"\<SPS\>\"", ",", 
         RowBox[{"Length", "[", "explistsndship", "]"}]}], "]"}]}], "}"}]}], 
    "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Geometry", " ", "of", " ", "the", " ", 
     RowBox[{"experiment", ":", " ", "box"}]}], ",", " ", "cylinder", ",", 
    " ", 
    RowBox[{"annular", " ", "cylinder"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"GeometryExperiment", "[", "#1", "]"}], "=", "#2"}], ")"}], 
      "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistsndship", ",", 
       RowBox[{"Table", "[", 
        RowBox[{"\"\<Box\>\"", ",", 
         RowBox[{"Length", "[", "explistsndship", "]"}]}], "]"}]}], "}"}]}], 
    "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Transverse", " ", "dimensions", " ", "of", " ", "the", " ", "decay", " ",
      "volume", " ", "assuming", " ", "box", " ", "geometry"}], ",", " ", 
    RowBox[{
    "or", " ", "cylindrical", " ", "geometry", " ", "if", " ", "the", " ", 
     "detector", " ", "plane", " ", "is", " ", "parallel", " ", "to", " ", 
     "the", " ", "beamline", " ", 
     RowBox[{
      RowBox[{"(", "ANUBIS", ")"}], ".", " ", "Otherwise"}], " ", "set", " ", 
     "to", " ", "zero"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MapThread", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"dxDecayVolumeExperiment", "[", 
        RowBox[{"z_", ",", "#1"}], "]"}], "=", "#2"}], ")"}], "&"}], ",", 
    RowBox[{"{", 
     RowBox[{"explistsndship", ",", 
      RowBox[{"{", 
       RowBox[{"0.4", ",", "3"}], "}"}]}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"dyDecayVolumeExperiment", "[", 
         RowBox[{"z_", ",", "#1"}], "]"}], "=", "#2"}], ")"}], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistsndship", ",", 
       RowBox[{"{", 
        RowBox[{"0.4", ",", "3"}], "}"}]}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Decay", " ", "volume", " ", "length", " ", "along", " ", "the", " ", 
    "beamline", " ", "axis"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"dzDecayVolumeExperiment", "[", "#1", "]"}], "=", "#2"}], 
       ")"}], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistsndship", ",", 
       RowBox[{"{", 
        RowBox[{"2.6", ",", "10"}], "}"}]}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Distance", " ", "from", " ", "the", " ", "beamline", " ", "to", " ", 
     "the", " ", "decay", " ", "volume", " ", "center", " ", "and", " ", 
     "detector", " ", "along", " ", "the", " ", "x"}], ",", 
    RowBox[{"y", " ", "axes"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MapThread", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"xToDecayVolumeCenterExperiment", "[", 
        RowBox[{"z_", ",", "#1"}], "]"}], "=", "#2"}], ")"}], "&"}], ",", 
    RowBox[{"{", 
     RowBox[{"explistsndship", ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0."}], "}"}]}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"yToDecayVolumeCenterExperiment", "[", 
         RowBox[{"z_", ",", "#1"}], "]"}], "=", "#2"}], ")"}], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistsndship", ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0."}], "}"}]}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Inner", " ", "and", " ", "outer", " ", "radii", " ", "of", " ", "the", 
    " ", "decay", " ", 
    RowBox[{"volume", ".", " ", "Applicable"}], " ", "if", " ", "the", " ", 
    "decay", " ", "volume", " ", "has", " ", "cylindrical", " ", "geometry"}],
    "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"RinnerDecayVolumeExperiment", "[", 
      RowBox[{"exp", ",", "z_"}], "]"}], "=", "0"}], ",", 
    RowBox[{"{", 
     RowBox[{"exp", ",", "explistsndship"}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"RouterDecayVolumeExperiment", "[", 
       RowBox[{"exp", ",", "z_"}], "]"}], "=", "0"}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistsndship"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"z", "-", 
    RowBox[{
    "coordinate", " ", "of", " ", "the", " ", "center", " ", "of", " ", "the",
      " ", "decay", " ", "volume"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"zToDecayVolumeCenterExperiment", "[", "exp", "]"}], "=", 
      RowBox[{
       RowBox[{"zToDecayVolumeExperiment", "[", "exp", "]"}], "+", 
       FractionBox[
        RowBox[{"dzDecayVolumeExperiment", "[", "exp", "]"}], "2"]}]}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistsndship"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Maximal", " ", 
    RowBox[{"long", ".", " ", "displacement"}], " ", "of", " ", "the", " ", 
    "decay", " ", "volume"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"zMaxDecayVolumeExperiment", "[", "exp", "]"}], "=", 
     RowBox[{
      RowBox[{"zToDecayVolumeExperiment", "[", "exp", "]"}], "+", 
      RowBox[{"dzDecayVolumeExperiment", "[", "exp", "]"}]}]}], ",", 
    RowBox[{"{", 
     RowBox[{"exp", ",", "explistsndship"}], "}"}]}], "]"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Whether", " ", "the", " ", "decay", " ", "volume", " ", "serves", " ", 
    "as", " ", "detector", " ", 
    RowBox[{"(", 
     RowBox[{"True", " ", "or", " ", "False"}], ")"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"DecayVolumeAsDetectorExperiment", "[", "exp", "]"}], "=", 
     "\"\<True\>\""}], ",", 
    RowBox[{"{", 
     RowBox[{"exp", ",", "explistsndship"}], "}"}]}], "]"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Transverse", " ", "dimensions", " ", "of", " ", "the", " ", "detector", 
    " ", "assuming", " ", "box", " ", "geometry"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MapThread", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"dxDetectorExperiment", "[", 
        RowBox[{"#1", ",", "z_"}], "]"}], "=", "#2"}], ")"}], "&"}], ",", 
    RowBox[{"{", 
     RowBox[{"explistsndship", ",", 
      RowBox[{"Table", "[", 
       RowBox[{"0", ",", 
        RowBox[{"Length", "[", "explistsndship", "]"}]}], "]"}]}], "}"}]}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"dyDetectorExperiment", "[", 
         RowBox[{"#1", ",", "z_"}], "]"}], "=", "#2"}], ")"}], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistsndship", ",", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", 
         RowBox[{"Length", "[", "explistsndship", "]"}]}], "]"}]}], "}"}]}], 
    "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Length", " ", "of", " ", "the", " ", "detector", " ", "in", " ", "z", " ",
     "plane"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"dzDetectorExperiment", "[", "#1", "]"}], "=", "#2"}], ")"}], 
      "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistsndship", ",", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", 
         RowBox[{"Length", "[", "explistsndship", "]"}]}], "]"}]}], "}"}]}], 
    "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Coordinates", " ", "of", " ", "the", " ", "center", " ", "of", " ", "the",
     " ", "detector"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"xToDetectorCenterExperiment", "[", "exp", "]"}], "=", "0"}], 
    ",", 
    RowBox[{"{", 
     RowBox[{"exp", ",", "explistsndship"}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"yToDetectorCenterExperiment", "[", "exp", "]"}], "=", 
     RowBox[{
      RowBox[{"yToDecayVolumeCenterExperiment", "[", 
       RowBox[{"z", ",", "exp"}], "]"}], "+", 
      FractionBox[
       RowBox[{"dyDecayVolumeExperiment", "[", 
        RowBox[{"z", ",", "exp"}], "]"}], "2"], "+", 
      FractionBox[
       RowBox[{"dyDetectorExperiment", "[", "exp", "]"}], "2"]}]}], ",", 
    RowBox[{"{", 
     RowBox[{"exp", ",", "explistsndship"}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"zToDetectorCenterExperiment", "[", "exp", "]"}], "=", 
      RowBox[{
       RowBox[{"zMaxDecayVolumeExperiment", "[", "exp", "]"}], "+", 
       FractionBox[
        RowBox[{"dzDetectorExperiment", "[", "exp", "]"}], "2"]}]}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistsndship"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Inner", " ", "and", " ", "outer", " ", "radii", " ", "of", " ", "the", 
    " ", "detector"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"RinnerDetectorExperiment", "[", 
      RowBox[{"exp", ",", "z_"}], "]"}], "=", "0"}], ",", 
    RowBox[{"{", 
     RowBox[{"exp", ",", "explistsndship"}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"RouterDetectorExperiment", "[", 
       RowBox[{"exp", ",", "z_"}], "]"}], "=", "0"}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistsndship"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Length", " ", "of", " ", "the", " ", "detector", " ", "along", " ", "the",
     " ", "detector", " ", "axis"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"dxLongDetectorExperiment", "[", "exp", "]"}], "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"DetectorPlaneOrientationExperiment", "[", "exp", "]"}], 
         "\[Equal]", "\"\<Transverse\>\""}], ",", 
        RowBox[{"dzDetectorExperiment", "[", "exp", "]"}], ",", 
        RowBox[{"dyDetectorExperiment", "[", "exp", "]"}]}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistsndship"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "The", " ", "maximal", " ", "coordinate", " ", "of", " ", "the", " ", 
    "end", " ", "of", " ", "the", " ", "detector", " ", "plane", " ", 
    RowBox[{"(", 
     RowBox[{"along", " ", "the", " ", "detector", " ", "axis"}], ")"}], " ", 
    "used", " ", "to", " ", "calculate", " ", "the", " ", "decay", " ", 
    RowBox[{"acceptance", ".", " ", "May"}], " ", "be", " ", "either", " ", 
    "the", " ", "z", " ", "coordinate", " ", "or", " ", "the", " ", "y", " ", 
    "coordinate", " ", 
    RowBox[{"(", 
     RowBox[{
     "if", " ", "the", " ", "final", " ", "detector", " ", "plane", " ", "is",
       " ", "oriented", " ", "parallel", " ", "to", " ", "the", " ", 
      "beamline"}], ")"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"xLongMaxDetectorExperiment", "[", "exp", "]"}], "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"DetectorPlaneOrientationExperiment", "[", "exp", "]"}], 
         "\[Equal]", "\"\<Transverse\>\""}], ",", 
        RowBox[{
         RowBox[{"zMaxDecayVolumeExperiment", "[", "exp", "]"}], "+", 
         RowBox[{"dxLongDetectorExperiment", "[", "exp", "]"}]}], ",", 
        RowBox[{
         RowBox[{"yToDetectorCenterExperiment", "[", "exp", "]"}], "+", 
         RowBox[{
          RowBox[{"dyDetectorExperiment", "[", "exp", "]"}], "/", "2"}]}]}], 
       "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistsndship"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Position", " ", "of", " ", "the", " ", "final", " ", "plane", " ", "for", 
    " ", "the", " ", "decay", " ", "products", " ", "along", " ", "the", " ", 
    "detector", " ", "axis"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"xLongDecayProductFinalPlaneExperiment", "[", "exp", "]"}], "=", 
     RowBox[{"xLongMaxDetectorExperiment", "[", "exp", "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"exp", ",", "explistsndship"}], "}"}]}], "]"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Whether", " ", "the", " ", "experiment", " ", "has", " ", "dipole", " ", 
    "magnet", " ", "in", " ", "the", " ", "detector", " ", 
    RowBox[{"(", 
     RowBox[{"True", ",", " ", "False"}], ")"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"DipoleMagnetOptionExperiment", "[", "#1", "]"}], "=", "#2"}],
        ")"}], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistsndship", ",", 
       RowBox[{"Table", "[", 
        RowBox[{"\"\<False\>\"", ",", 
         RowBox[{"Length", "[", "explistsndship", "]"}]}], "]"}]}], "}"}]}], 
    "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Longitudinal", " ", "positions", " ", "of", " ", "the", " ", "dipole", 
    " ", "magnet", " ", "of", " ", "the", " ", "detector"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MapThread", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"zMagnetMinExperiment", "[", "#1", "]"}], "=", "#2"}], ")"}], 
     "&"}], ",", 
    RowBox[{"{", 
     RowBox[{"explistsndship", ",", 
      RowBox[{"Table", "[", 
       RowBox[{"0", ",", 
        RowBox[{"Length", "[", "explistsndship", "]"}]}], "]"}]}], "}"}]}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"zMagnetMaxExperiment", "[", "#1", "]"}], "=", "#2"}], ")"}], 
      "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistsndship", ",", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", 
         RowBox[{"Length", "[", "explistsndship", "]"}]}], "]"}]}], "}"}]}], 
    "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Mean", " ", "magnetic", " ", "field", " ", "of", " ", "the", " ", 
    "dipole", " ", "magnet"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"MagneticFieldExperiment", "[", "#1", "]"}], "=", "#2"}], 
       ")"}], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistsndship", ",", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", 
         RowBox[{"Length", "[", "explistsndship", "]"}]}], "]"}]}], "}"}]}], 
    "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"ECAL", " ", "option", " ", 
    RowBox[{"(", 
     RowBox[{"True", ",", "False"}], ")"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"ECALoptionExperiment", "[", "exp", "]"}], "=", 
      "\"\<True\>\""}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistsndship"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Position", " ", "of", " ", "the", " ", "beginning", " ", "of", " ", "the",
     " ", "ECAL"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"zECALminExperiment", "[", "#1", "]"}], "=", "#2"}], ")"}], 
      "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistsndship", ",", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", 
         RowBox[{"Length", "[", "explistsndship", "]"}]}], "]"}]}], "}"}]}], 
    "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "The", " ", "final", " ", "detector", " ", "plane", " ", "needed", " ", 
     "to", " ", "reconstruct", " ", 
     RowBox[{"muons", ".", " ", "Depeding"}], " ", "on", " ", "the", " ", 
     "experiment"}], ",", " ", 
    RowBox[{
    "it", " ", "is", " ", "approximated", " ", "by", " ", "be", " ", "end", 
     " ", "of", " ", "the", " ", "trackers", " ", "or", " ", "the", " ", 
     "muon", " ", "system"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"xLongMuonPlaneExperiment", "[", "exp", "]"}], "=", 
      RowBox[{"xLongMaxDetectorExperiment", "[", "exp", "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistsndship"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "The", " ", "final", " ", "detector", " ", "plane", " ", "needed", " ", 
     "to", " ", "reconstruct", " ", "other", " ", 
     RowBox[{"particles", ".", " ", "Depeding"}], " ", "on", " ", "the", " ", 
     "experiment"}], ",", " ", 
    RowBox[{
    "it", " ", "is", " ", "approximated", " ", "by", " ", "the", " ", "end", 
     " ", "of", " ", "the", " ", "trackers", " ", "or", " ", "the", " ", 
     "calorimeter", " ", "system"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"xLongNonMuonPlaneExperiment", "[", "exp", "]"}], "=", 
      RowBox[{
       RowBox[{"zECALminExperiment", "[", "exp", "]"}], "+", "1"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistsndship"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"List", " ", "of", " ", "detectable", " ", 
     RowBox[{"particles", ".", " ", "If"}], " ", "ECAL", " ", "is", " ", 
     "absent"}], ",", " ", 
    RowBox[{
    "it", " ", "is", " ", "assumed", " ", "by", " ", "default", " ", "that", 
     " ", "photons", " ", "and", " ", 
     SubscriptBox[
      SuperscriptBox["K", "0"], "L"], " ", "cannot", " ", "be", " ", 
     "detected"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MapThread", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"DetectablePDGsExperiment", "[", "#1", "]"}], "=", "#2"}], 
      ")"}], "&"}], ",", 
    RowBox[{"{", 
     RowBox[{"explistsndship", ",", 
      RowBox[{"Table", "[", 
       RowBox[{"detectablepdgs", ",", 
        RowBox[{"Length", "[", "explistsndship", "]"}]}], "]"}]}], "}"}]}], 
   "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.8934862862111635`*^9, 3.893486289101931*^9}, {
   3.8934999953831625`*^9, 3.893500001065502*^9}, {3.8935001679579945`*^9, 
   3.8935001709587584`*^9}, {3.8935003606663184`*^9, 3.893500363223881*^9}, {
   3.893518137072644*^9, 3.8935181370796366`*^9}, 3.8935193128475156`*^9, {
   3.893520126029746*^9, 3.8935201693363*^9}, 3.893520658238859*^9, {
   3.8935219485485992`*^9, 3.8935220114931326`*^9}, 3.894438590646804*^9, {
   3.8971453069184313`*^9, 3.897145319404414*^9}, {3.897145473964569*^9, 
   3.89714548696819*^9}, 3.897147806010866*^9, {3.8991923266231728`*^9, 
   3.8991923724629602`*^9}, {3.8991924158711205`*^9, 
   3.8991924372018657`*^9}, {3.899192481682554*^9, 3.8991925208297653`*^9}, {
   3.9050601922833633`*^9, 3.905060192454685*^9}, 3.9102405949107*^9, {
   3.9102469737994795`*^9, 3.9102469738084927`*^9}, {3.9102561474844856`*^9, 
   3.910256155459561*^9}, {3.9102590767015643`*^9, 3.910259079686192*^9}, {
   3.91205738913997*^9, 3.9120573999130764`*^9}},
 CellLabel->
  "In[787]:=",ExpressionUUID->"4f523771-8c20-4ae3-b672-f038478e0761"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Cross-sections", "Subsubsection",
 CellChangeTimes->{{3.8933256308713317`*^9, 
  3.8933256323468237`*^9}},ExpressionUUID->"bda74db0-effd-4eeb-8a60-\
44c117bbb9e0"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"MapThread", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"NPOTexperiment", "[", "#1", "]"}], "=", "#2"}], ")"}], "&"}], 
    ",", 
    RowBox[{"{", 
     RowBox[{"explistsndship", ",", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"6", "*", 
         SuperscriptBox["10", "20."]}], ",", 
        RowBox[{"Length", "[", "explistsndship", "]"}]}], "]"}]}], "}"}]}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"AtargetExperiment", "[", "#1", "]"}], "=", "#2"}], ")"}], 
      "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistsndship", ",", 
       RowBox[{"Table", "[", 
        RowBox[{"96.", ",", 
         RowBox[{"Length", "[", "explistsndship", "]"}]}], "]"}]}], "}"}]}], 
    "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Cascade", " ", "enhancement", " ", "of", " ", "the", " ", "production", 
    " ", "relative", " ", "to", " ", "the", " ", "production", " ", "in", " ",
     "pure", " ", "pp", " ", 
    RowBox[{"collisions", ".", " ", "Relevant"}], " ", "for", " ", "fixed", 
    " ", "target", " ", "experiments"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "For", " ", "all", " ", "experiments", " ", "located", " ", "at", " ", 
     "SPS"}], ",", " ", 
    RowBox[{
     RowBox[{
      RowBox[{
      "the", " ", "cascade", " ", "factors", " ", "is", " ", "taken", " ", 
       "from", " ", 
       RowBox[{"http", ":"}]}], "//", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"cds", ".", "cern", ".", "ch"}], "/", "record"}], "/", 
          "2115534"}], "/", "files"}], "/", "SHiP"}], "-", "NOTE", "-", 
       "2015", "-", 
       RowBox[{"009.", 
        RowBox[{"pdf", "?", "version"}]}]}]}], "=", "1"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"CascadeFactorbb", "[", "#1", "]"}], "=", "#2"}], ")"}], 
      "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistsndship", ",", 
       RowBox[{"Table", "[", 
        RowBox[{"1.7", ",", 
         RowBox[{"Length", "[", "explistsndship", "]"}]}], "]"}]}], "}"}]}], 
    "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Fraction", " ", "of", " ", "produced", " ", "bb", " ", "per", " ", "PoT", 
    " ", "at", " ", "the", " ", "given", " ", "experiment"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"PppTobbExperiment", "[", "exp", "]"}], "=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"\[Sigma]ppTobbInpbFacility", "[", 
        RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}], "/", 
       RowBox[{"\[Sigma]ppInpbFacility", "[", 
        RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}]}], ")"}], 
     SuperscriptBox[
      RowBox[{"AtargetExperiment", "[", "exp", "]"}], "0.29"], "*", 
     RowBox[{"CascadeFactorbb", "[", "exp", "]"}]}]}], ",", 
   RowBox[{"{", 
    RowBox[{"exp", ",", "explistsndship"}], "}"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"CascadeFactorcc", "[", "#1", "]"}], "=", "#2"}], ")"}], 
      "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistsndship", ",", 
       RowBox[{"Table", "[", 
        RowBox[{"2.3", ",", 
         RowBox[{"Length", "[", "explistsndship", "]"}]}], "]"}]}], "}"}]}], 
    "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Fraction", " ", "of", " ", "produced", " ", "cc", " ", "per", " ", "PoT", 
    " ", "at", " ", "the", " ", "given", " ", "experiment"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"PppToccExperiment", "[", "exp", "]"}], "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"\[Sigma]ppToccInpbFacility", "[", 
         RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}], "/", 
        RowBox[{"\[Sigma]ppInpbFacility", "[", 
         RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}]}], ")"}], 
      SuperscriptBox[
       RowBox[{"AtargetExperiment", "[", "exp", "]"}], "0.29"], "*", 
      RowBox[{"CascadeFactorcc", "[", "exp", "]"}]}]}], ",", 
    RowBox[{"{", 
     RowBox[{"exp", ",", "explistsndship"}], "}"}]}], "]"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Fraction", " ", "of", " ", "produced", " ", "h", " ", "per", " ", "PoT", 
    " ", "at", " ", "the", " ", "given", " ", "experiment"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"PppTohExperiment", "[", "exp", "]"}], "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"\[Sigma]ppTohInpbFacility", "[", 
          RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}], "/", 
         RowBox[{"\[Sigma]ppInpbFacility", "[", 
          RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}]}], ")"}], 
       SuperscriptBox[
        RowBox[{"AtargetExperiment", "[", "exp", "]"}], "0.29"]}]}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistsndship"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Fraction", " ", "of", " ", "produced", " ", "W", " ", "per", " ", "PoT", 
    " ", "at", " ", "the", " ", "given", " ", "experiment"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"PppToWExperiment", "[", "exp", "]"}], "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"\[Sigma]ppToWInpbFacility", "[", 
          RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}], "/", 
         RowBox[{"\[Sigma]ppInpbFacility", "[", 
          RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}]}], ")"}], 
       SuperscriptBox[
        RowBox[{"AtargetExperiment", "[", "exp", "]"}], "0.29"]}]}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistsndship"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Fraction", " ", "of", " ", "produced", " ", 
    SuperscriptBox["\[Pi]", "0"], " ", "per", " ", "PoT", " ", "at", " ", 
    "the", " ", "given", " ", "experiment"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"PppTo\[Pi]0exp", "[", "exp", "]"}], "=", 
      RowBox[{"PppTo\[Pi]0Facility", "[", 
       RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistsndship"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Fraction", " ", "of", " ", "produced", " ", "\[Eta]", " ", "per", " ", 
    "PoT", " ", "at", " ", "the", " ", "given", " ", "experiment"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"PppTo\[Eta]exp", "[", "exp", "]"}], "=", 
      RowBox[{"PppTo\[Eta]Facility", "[", 
       RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistsndship"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Fraction", " ", "of", " ", "produced", " ", 
    RowBox[{"\[Eta]", "'"}], " ", "per", " ", "PoT", " ", "at", " ", "the", 
    " ", "given", " ", "experiment"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"PppTo\[Eta]prexp", "[", "exp", "]"}], "=", 
      RowBox[{"PppTo\[Eta]prFacility", "[", 
       RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistsndship"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Fraction", " ", "of", " ", "produced", " ", 
    SuperscriptBox["\[Rho]", "0"], " ", "per", " ", "PoT", " ", "at", " ", 
    "the", " ", "given", " ", "experiment"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"PppTo\[Rho]0exp", "[", "exp", "]"}], "=", 
      RowBox[{"PppTo\[Rho]0Facility", "[", 
       RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistsndship"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Fraction", " ", "of", " ", "produced", " ", "\[Omega]", " ", "per", " ", 
    "PoT", " ", "at", " ", "the", " ", "given", " ", "experiment"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"PppTo\[Omega]exp", "[", "exp", "]"}], "=", 
      RowBox[{"PppTo\[Omega]Facility", "[", 
       RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistsndship"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Fraction", " ", "of", " ", "produced", " ", 
    RowBox[{"J", "/", "\[Psi]"}], 
    RowBox[{"(", 
     RowBox[{"1", "s"}], ")"}], " ", "per", " ", "PoT", " ", "at", " ", "the",
     " ", "given", " ", "experiment"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"PppToJpsiexp", "[", "exp", "]"}], "=", 
      RowBox[{
       RowBox[{"PppToJpsiFacility", "[", 
        RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}], 
       SuperscriptBox[
        RowBox[{"AtargetExperiment", "[", "exp", "]"}], "0.29"]}]}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistsndship"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Fraction", " ", "of", " ", "produced", " ", "\[CapitalUpsilon]", 
    RowBox[{"(", 
     RowBox[{"1", "s"}], ")"}], " ", "per", " ", "PoT", " ", "at", " ", "the",
     " ", "given", " ", "experiment"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"PppToUpsilonexp", "[", "exp", "]"}], "=", 
      RowBox[{
       RowBox[{"PppToUpsilonFacility", "[", 
        RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}], 
       SuperscriptBox[
        RowBox[{"AtargetExperiment", "[", "exp", "]"}], "0.29"]}]}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistsndship"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Fraction", " ", "of", " ", "produced", " ", "\[Phi]", " ", "at", " ", 
    "the", " ", "given", " ", "experiment"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"PppToPhiexp", "[", "exp", "]"}], "=", 
      RowBox[{"PppToPhiFacility", "[", 
       RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistsndship"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Overall", " ", "table", " ", "with", " ", "cross"}], "-", 
    RowBox[{"sections", " ", "used", " ", "for", " ", "exporting"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"TableNumbersParticlesExperiment", "[", "exp", "]"}], "=", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "\"\<Facility\>\"", ",", "\"\<Npot\>\"", ",", "\"\<Atarget\>\"", ",", 
         "\"\<PPi0\>\"", ",", "\"\<PEta\>\"", ",", "\"\<PEtapr\>\"", ",", 
         "\"\<PRho0\>\"", ",", "\"\<POmega\>\"", ",", "\"\<Pc\>\"", ",", 
         "\"\<Pb\>\"", ",", "\"\<PW\>\"", ",", "\"\<Ph\>\"", ",", 
         "\"\<PJpsi\>\"", ",", "\"\<PUpsilon\>\"", ",", "\"\<PPhi\>\""}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"FacilityExperiment", "[", "exp", "]"}], ",", 
         RowBox[{"NPOTexperiment", "[", "exp", "]"}], ",", 
         RowBox[{"AtargetExperiment", "[", "exp", "]"}], ",", 
         RowBox[{"PppTo\[Pi]0exp", "[", "exp", "]"}], ",", 
         RowBox[{"PppTo\[Eta]exp", "[", "exp", "]"}], ",", 
         RowBox[{"PppTo\[Eta]prexp", "[", "exp", "]"}], ",", 
         RowBox[{"PppTo\[Rho]0exp", "[", "exp", "]"}], ",", 
         RowBox[{"PppTo\[Omega]exp", "[", "exp", "]"}], ",", 
         RowBox[{"2", 
          RowBox[{"PppToccExperiment", "[", "exp", "]"}]}], ",", 
         RowBox[{"2", 
          RowBox[{"PppTobbExperiment", "[", "exp", "]"}]}], ",", 
         RowBox[{"PppToWExperiment", "[", "exp", "]"}], ",", 
         RowBox[{"PppTohExperiment", "[", "exp", "]"}], ",", 
         RowBox[{"PppToJpsiexp", "[", "exp", "]"}], ",", 
         RowBox[{"PppToUpsilonexp", "[", "exp", "]"}], ",", 
         RowBox[{"PppToPhiexp", "[", "exp", "]"}]}], "}"}]}], "}"}], "//", 
     "N"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"exp", ",", "explistsndship"}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.8941782511160336`*^9, 3.8941782532367306`*^9}, {
   3.8941787306946573`*^9, 3.8941787323198457`*^9}, {3.897235829267909*^9, 
   3.8972358435924716`*^9}, {3.89728623180696*^9, 3.897286235876445*^9}, {
   3.89919232688999*^9, 3.899192339246267*^9}, {3.8991925697880816`*^9, 
   3.899192581299979*^9}, 3.8991926287947392`*^9, 3.899196413943631*^9, 
   3.8991971055532103`*^9, {3.899197142767766*^9, 3.8991971429673185`*^9}},
 CellLabel->
  "In[822]:=",ExpressionUUID->"46135e3c-8693-44ca-9b33-675bd9677398"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Conditions for the LLP to decay inside the decay volume and for the products \
to point to the end of the detector\
\>", "Subsubsection",
 CellChangeTimes->{{3.905011297554874*^9, 3.9050113192993593`*^9}, 
   3.9154372095298066`*^9},ExpressionUUID->"74cc3f96-2ad9-4305-8e1c-\
7e45ca3aaf57"],

Cell[BoxData[
 RowBox[{"Do", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"IfLLPinsideDecVol", "[", 
      RowBox[{"zLLP_", ",", "xLLP_", ",", "yLLP_", ",", "exp"}], "]"}], "=", 
     RowBox[{"IfLLPinsideDecVolSimple", "[", "exp", "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"IfLLPtoDet", "[", 
        RowBox[{
        "x1LLPproj_", ",", "x2LLPproj_", ",", "xLongProj_", ",", "exp"}], 
        "]"}], ",", 
       RowBox[{"IfLLPnotToDet", "[", 
        RowBox[{
        "x1LLPproj_", ",", "x2LLPproj_", ",", "xLongProj_", ",", "exp"}], 
        "]"}]}], "}"}], "=", 
     RowBox[{"IfParticlePointsToDetSimple", "[", "exp", "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"IfLLPdecVolToDet", "[", 
      RowBox[{
      "zLLP_", ",", "xLLP_", ",", "yLLP_", ",", "x1LLPproj_", ",", 
       "x2LLPproj_", ",", "xLongProj_", ",", "exp"}], "]"}], "=", 
     RowBox[{
      RowBox[{"IfLLPinsideDecVol", "[", 
       RowBox[{"zLLP", ",", "xLLP", ",", "yLLP", ",", "exp"}], "]"}], "*", 
      RowBox[{"IfLLPtoDet", "[", 
       RowBox[{"x1LLPproj", ",", "x2LLPproj", ",", "xLongProj", ",", "exp"}], 
       "]"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"IfLLPdecVolNotToDet", "[", 
      RowBox[{
      "zLLP_", ",", "xLLP_", ",", "yLLP_", ",", "x1LLPproj_", ",", 
       "x2LLPproj_", ",", "xLongProj_", ",", "exp"}], "]"}], "=", 
     RowBox[{
      RowBox[{"IfLLPinsideDecVol", "[", 
       RowBox[{"zLLP", ",", "xLLP", ",", "yLLP", ",", "exp"}], "]"}], "*", 
      RowBox[{"IfLLPnotToDet", "[", 
       RowBox[{"x1LLPproj", ",", "x2LLPproj", ",", "xLongProj", ",", "exp"}], 
       "]"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"DecayAcceptanceGeometry", "[", 
      RowBox[{"coord1_", ",", "coord2_", ",", "xLongProj_", ",", "exp"}], 
      "]"}], "=", 
     RowBox[{"IfLLPtoDet", "[", 
      RowBox[{"coord1", ",", "coord2", ",", "xLongProj", ",", "exp"}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", ",", 
   RowBox[{"{", 
    RowBox[{"exp", ",", "explistsndship"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.90501497848772*^9, 3.9050149789839983`*^9}, 
   3.9050171519172955`*^9, {3.9050594804420967`*^9, 3.905059480643213*^9}, {
   3.9102585745635014`*^9, 3.9102586409653835`*^9}, 3.9102588185393467`*^9, 
   3.9102599357261066`*^9, {3.915437007181905*^9, 3.9154370915448*^9}, {
   3.9154372095487947`*^9, 3.915437209620879*^9}},
 CellLabel->
  "In[839]:=",ExpressionUUID->"8609a49f-08ac-46d5-8ec7-7451182da6a0"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["advSND/FASER\[Nu]2", "Subsection",
 CellChangeTimes->{{3.893324399890606*^9, 3.8933244005702376`*^9}, {
   3.8935219267411356`*^9, 3.893521931184104*^9}, 3.893522106286048*^9, {
   3.89352356196789*^9, 
   3.8935235640656986`*^9}},ExpressionUUID->"a0d9d1ac-3d29-4ae7-a3f5-\
165c80c0f009"],

Cell[CellGroupData[{

Cell["Geometry", "Subsubsection",
 CellChangeTimes->{{3.893342623432827*^9, 
  3.893342624458*^9}},ExpressionUUID->"bd488a61-ba30-4d44-9b24-4b6f4bf05fce"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"explistadvsnd", "=", 
    RowBox[{"{", 
     RowBox[{
     "\"\<advSNDnear\>\"", ",", "\"\<advSNDfar\>\"", ",", 
      "\"\<advSNDfarOld\>\"", ",", "\"\<FASER\[Nu]2\>\""}], "}"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Distance", " ", "to", " ", "the", " ", "fiducial", " ", "volume", " ", 
    "along", " ", "the", " ", "beamline", " ", 
    RowBox[{"axis", ".", " ", 
     RowBox[{"MapThread", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"list1", "[", "#", "]"}], "=", "#2"}], ")"}], "&"}], ",", 
       RowBox[{"{", 
        RowBox[{"listexp", ",", "listvals"}], "}"}]}], "]"}]}], " ", 
    "equates", " ", "the", " ", "elements", " ", "list1", " ", "with", " ", 
    "keys", " ", "from", " ", "listexp", " ", "to", " ", "the", " ", 
    "corresponding", " ", "elements", " ", "of", " ", "the", " ", "list", " ",
     "listvals"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"zToDecayVolumeExperiment", "[", "#1", "]"}], "=", "#2"}], 
       ")"}], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistadvsnd", ",", 
       RowBox[{"{", 
        RowBox[{"55.", ",", "480.", ",", "630.", ",", 
         RowBox[{"480", "-", "6.6"}]}], "}"}]}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Detector", " ", "has", " ", "the", " ", "axis", " ", "along", " ", 
    "which", " ", "its", " ", "components", " ", "are", " ", 
    RowBox[{"placed", ".", " ", "The"}], " ", "option", " ", "below", " ", 
    "defines", " ", "the", " ", "orientation", " ", "of", " ", "the", " ", 
    "final", " ", "plane", " ", "transverse", " ", "to", " ", "this", " ", 
    "axis", " ", "relative", " ", "to", " ", "the", " ", "beamline"}], "*)"}],
   "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Transverse", " ", "if", " ", "the", " ", "plane", " ", "is", " ", 
     "tranverse", " ", 
     RowBox[{"(", 
      RowBox[{"SHiP", ",", " ", 
       RowBox[{"FACET", " ", "etc"}]}], ")"}]}], ",", " ", 
    RowBox[{
    "and", " ", "Parallel", " ", "if", " ", "it", " ", "is", " ", "parallel", 
     " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Codex", "-", "b"}], ",", " ", "ANUBIS"}]}]}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"DetectorPlaneOrientationExperiment", "[", "#1", "]"}], "=", 
        "#2"}], ")"}], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistadvsnd", ",", 
       RowBox[{"Table", "[", 
        RowBox[{"\"\<Transverse\>\"", ",", 
         RowBox[{"Length", "[", "explistadvsnd", "]"}]}], "]"}]}], "}"}]}], 
    "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Facility", " ", "hosting", " ", "the", " ", 
     RowBox[{"experiment", ":", " ", "SPS"}]}], ",", " ", "Fermilab", ",", 
    " ", "LHC", ",", " ", 
    RowBox[{"FCC", "-", "hh"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"FacilityExperiment", "[", "#1", "]"}], "=", "#2"}], ")"}], 
      "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistadvsnd", ",", 
       RowBox[{"Table", "[", 
        RowBox[{"\"\<LHC\>\"", ",", 
         RowBox[{"Length", "[", "explistadvsnd", "]"}]}], "]"}]}], "}"}]}], 
    "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Geometry", " ", "of", " ", "the", " ", 
     RowBox[{"experiment", ":", " ", "box"}]}], ",", " ", "cylinder", ",", 
    " ", 
    RowBox[{"annular", " ", "cylinder"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"GeometryExperiment", "[", "#1", "]"}], "=", "#2"}], ")"}], 
      "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistadvsnd", ",", 
       RowBox[{"Table", "[", 
        RowBox[{"\"\<Box\>\"", ",", 
         RowBox[{"Length", "[", "explistadvsnd", "]"}]}], "]"}]}], "}"}]}], 
    "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Transverse", " ", "dimensions", " ", "of", " ", "the", " ", "decay", " ",
      "volume", " ", "assuming", " ", "box", " ", "geometry"}], ",", " ", 
    RowBox[{
    "or", " ", "cylindrical", " ", "geometry", " ", "if", " ", "the", " ", 
     "detector", " ", "plane", " ", "is", " ", "parallel", " ", "to", " ", 
     "the", " ", "beamline", " ", 
     RowBox[{
      RowBox[{"(", "ANUBIS", ")"}], ".", " ", "Otherwise"}], " ", "set", " ", 
     "to", " ", "zero"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MapThread", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"dxDecayVolumeExperiment", "[", 
        RowBox[{"z_", ",", "#1"}], "]"}], "=", "#2"}], ")"}], "&"}], ",", 
    RowBox[{"{", 
     RowBox[{"explistadvsnd", ",", 
      RowBox[{"{", 
       RowBox[{"1.2", ",", "0.4", ",", "1.", ",", "0.4"}], "}"}]}], "}"}]}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"dyDecayVolumeExperiment", "[", 
         RowBox[{"z_", ",", "#1"}], "]"}], "=", "#2"}], ")"}], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistadvsnd", ",", 
       RowBox[{"{", 
        RowBox[{"1.2", ",", "0.4", ",", "0.55", ",", "0.4"}], "}"}]}], 
      "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Decay", " ", "volume", " ", "length", " ", "along", " ", "the", " ", 
    "beamline", " ", "axis"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"dzDecayVolumeExperiment", "[", "#1", "]"}], "=", "#2"}], 
       ")"}], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistadvsnd", ",", 
       RowBox[{"{", 
        RowBox[{"0.4", ",", "0.648", ",", "1.5", ",", "6.6"}], "}"}]}], 
      "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Distance", " ", "from", " ", "the", " ", "beamline", " ", "to", " ", 
     "the", " ", "decay", " ", "volume", " ", "center", " ", "and", " ", 
     "detector", " ", "along", " ", "the", " ", "x"}], ",", 
    RowBox[{"y", " ", "axes"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MapThread", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"xToDecayVolumeCenterExperiment", "[", 
        RowBox[{"z_", ",", "#1"}], "]"}], "=", "#2"}], ")"}], "&"}], ",", 
    RowBox[{"{", 
     RowBox[{"explistadvsnd", ",", 
      RowBox[{"{", 
       RowBox[{"0.", ",", "0.", ",", "0.", ",", "0."}], "}"}]}], "}"}]}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"yToDecayVolumeCenterExperiment", "[", 
         RowBox[{"z_", ",", "#1"}], "]"}], "=", "#2"}], ")"}], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistadvsnd", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"55.", "*", 
           RowBox[{"Tan", "[", 
            RowBox[{"theta", "[", "5.", "]"}], "]"}]}], "+", 
          FractionBox["1.2", "2"]}], ",", "0.08", ",", 
         RowBox[{
          RowBox[{"630.", "*", 
           RowBox[{"Tan", "[", 
            RowBox[{"theta", "[", "8.4", "]"}], "]"}]}], "+", 
          FractionBox["0.55", "2"]}], ",", "0."}], "}"}]}], "}"}]}], "]"}], 
   ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Inner", " ", "and", " ", "outer", " ", "radii", " ", "of", " ", "the", 
    " ", "decay", " ", 
    RowBox[{"volume", ".", " ", "Applicable"}], " ", "if", " ", "the", " ", 
    "decay", " ", "volume", " ", "has", " ", "cylindrical", " ", "geometry"}],
    "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"RinnerDecayVolumeExperiment", "[", 
      RowBox[{"exp", ",", "z_"}], "]"}], "=", "0"}], ",", 
    RowBox[{"{", 
     RowBox[{"exp", ",", "explistadvsnd"}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"RouterDecayVolumeExperiment", "[", 
       RowBox[{"exp", ",", "z_"}], "]"}], "=", "0"}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistadvsnd"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"z", "-", 
    RowBox[{
    "coordinate", " ", "of", " ", "the", " ", "center", " ", "of", " ", "the",
      " ", "decay", " ", "volume"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"zToDecayVolumeCenterExperiment", "[", "exp", "]"}], "=", 
      RowBox[{
       RowBox[{"zToDecayVolumeExperiment", "[", "exp", "]"}], "+", 
       FractionBox[
        RowBox[{"dzDecayVolumeExperiment", "[", "exp", "]"}], "2"]}]}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistadvsnd"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Maximal", " ", 
    RowBox[{"long", ".", " ", "displacement"}], " ", "of", " ", "the", " ", 
    "decay", " ", "volume"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"zMaxDecayVolumeExperiment", "[", "exp", "]"}], "=", 
     RowBox[{
      RowBox[{"zToDecayVolumeExperiment", "[", "exp", "]"}], "+", 
      RowBox[{"dzDecayVolumeExperiment", "[", "exp", "]"}]}]}], ",", 
    RowBox[{"{", 
     RowBox[{"exp", ",", "explistadvsnd"}], "}"}]}], "]"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Whether", " ", "the", " ", "decay", " ", "volume", " ", "serves", " ", 
    "as", " ", "detector", " ", 
    RowBox[{"(", 
     RowBox[{"True", " ", "or", " ", "False"}], ")"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"DecayVolumeAsDetectorExperiment", "[", "exp", "]"}], "=", 
     "\"\<True\>\""}], ",", 
    RowBox[{"{", 
     RowBox[{"exp", ",", "explistadvsnd"}], "}"}]}], "]"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Transverse", " ", "dimensions", " ", "of", " ", "the", " ", "detector", 
    " ", "assuming", " ", "box", " ", "geometry"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MapThread", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"dxDetectorExperiment", "[", 
        RowBox[{"#1", ",", "z_"}], "]"}], "=", "#2"}], ")"}], "&"}], ",", 
    RowBox[{"{", 
     RowBox[{"explistadvsnd", ",", 
      RowBox[{"Table", "[", 
       RowBox[{"0", ",", 
        RowBox[{"Length", "[", "explistadvsnd", "]"}]}], "]"}]}], "}"}]}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"dyDetectorExperiment", "[", 
         RowBox[{"#1", ",", "z_"}], "]"}], "=", "#2"}], ")"}], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistadvsnd", ",", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", 
         RowBox[{"Length", "[", "explistadvsnd", "]"}]}], "]"}]}], "}"}]}], 
    "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Length", " ", "of", " ", "the", " ", "detector", " ", "in", " ", "z", " ",
     "plane"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"dzDetectorExperiment", "[", "#1", "]"}], "=", "#2"}], ")"}], 
      "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistadvsnd", ",", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", 
         RowBox[{"Length", "[", "explistadvsnd", "]"}]}], "]"}]}], "}"}]}], 
    "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Coordinates", " ", "of", " ", "the", " ", "center", " ", "of", " ", "the",
     " ", "detector"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"xToDetectorCenterExperiment", "[", "exp", "]"}], "=", "0"}], 
    ",", 
    RowBox[{"{", 
     RowBox[{"exp", ",", "explistadvsnd"}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"yToDetectorCenterExperiment", "[", "exp", "]"}], "=", 
     RowBox[{
      RowBox[{"yToDecayVolumeCenterExperiment", "[", 
       RowBox[{"z", ",", "exp"}], "]"}], "+", 
      FractionBox[
       RowBox[{"dyDecayVolumeExperiment", "[", 
        RowBox[{"z", ",", "exp"}], "]"}], "2"], "+", 
      FractionBox[
       RowBox[{"dyDetectorExperiment", "[", "exp", "]"}], "2"]}]}], ",", 
    RowBox[{"{", 
     RowBox[{"exp", ",", "explistadvsnd"}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"zToDetectorCenterExperiment", "[", "exp", "]"}], "=", 
      RowBox[{
       RowBox[{"zMaxDecayVolumeExperiment", "[", "exp", "]"}], "+", 
       FractionBox[
        RowBox[{"dzDetectorExperiment", "[", "exp", "]"}], "2"]}]}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistadvsnd"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Inner", " ", "and", " ", "outer", " ", "radii", " ", "of", " ", "the", 
    " ", "detector"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"RinnerDetectorExperiment", "[", 
      RowBox[{"exp", ",", "z_"}], "]"}], "=", "0"}], ",", 
    RowBox[{"{", 
     RowBox[{"exp", ",", "explistadvsnd"}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"RouterDetectorExperiment", "[", 
       RowBox[{"exp", ",", "z_"}], "]"}], "=", "0"}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistadvsnd"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Length", " ", "of", " ", "the", " ", "detector", " ", "along", " ", "the",
     " ", "detector", " ", "axis"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"dxLongDetectorExperiment", "[", "exp", "]"}], "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"DetectorPlaneOrientationExperiment", "[", "exp", "]"}], 
         "\[Equal]", "\"\<Transverse\>\""}], ",", 
        RowBox[{"dzDetectorExperiment", "[", "exp", "]"}], ",", 
        RowBox[{"dyDetectorExperiment", "[", "exp", "]"}]}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistadvsnd"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "The", " ", "maximal", " ", "coordinate", " ", "of", " ", "the", " ", 
    "end", " ", "of", " ", "the", " ", "detector", " ", "plane", " ", 
    RowBox[{"(", 
     RowBox[{"along", " ", "the", " ", "detector", " ", "axis"}], ")"}], " ", 
    "used", " ", "to", " ", "calculate", " ", "the", " ", "decay", " ", 
    RowBox[{"acceptance", ".", " ", "May"}], " ", "be", " ", "either", " ", 
    "the", " ", "z", " ", "coordinate", " ", "or", " ", "the", " ", "y", " ", 
    "coordinate", " ", 
    RowBox[{"(", 
     RowBox[{
     "if", " ", "the", " ", "final", " ", "detector", " ", "plane", " ", "is",
       " ", "oriented", " ", "parallel", " ", "to", " ", "the", " ", 
      "beamline"}], ")"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"xLongMaxDetectorExperiment", "[", "exp", "]"}], "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"DetectorPlaneOrientationExperiment", "[", "exp", "]"}], 
         "\[Equal]", "\"\<Transverse\>\""}], ",", 
        RowBox[{
         RowBox[{"zMaxDecayVolumeExperiment", "[", "exp", "]"}], "+", 
         RowBox[{"dxLongDetectorExperiment", "[", "exp", "]"}]}], ",", 
        RowBox[{
         RowBox[{"yToDetectorCenterExperiment", "[", "exp", "]"}], "+", 
         RowBox[{
          RowBox[{"dyDetectorExperiment", "[", "exp", "]"}], "/", "2"}]}]}], 
       "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistadvsnd"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Position", " ", "of", " ", "the", " ", "final", " ", "plane", " ", "for", 
    " ", "the", " ", "decay", " ", "products", " ", "along", " ", "the", " ", 
    "detector", " ", "axis"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"xLongDecayProductFinalPlaneExperiment", "[", "exp", "]"}], "=", 
     RowBox[{"xLongMaxDetectorExperiment", "[", "exp", "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"exp", ",", "explistadvsnd"}], "}"}]}], "]"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Whether", " ", "the", " ", "experiment", " ", "has", " ", "dipole", " ", 
    "magnet", " ", "in", " ", "the", " ", "detector", " ", 
    RowBox[{"(", 
     RowBox[{"True", ",", " ", "False"}], ")"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"DipoleMagnetOptionExperiment", "[", "#1", "]"}], "=", "#2"}],
        ")"}], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistadvsnd", ",", 
       RowBox[{"Table", "[", 
        RowBox[{"\"\<False\>\"", ",", 
         RowBox[{"Length", "[", "explistadvsnd", "]"}]}], "]"}]}], "}"}]}], 
    "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Longitudinal", " ", "positions", " ", "of", " ", "the", " ", "dipole", 
    " ", "magnet", " ", "of", " ", "the", " ", "detector"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MapThread", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"zMagnetMinExperiment", "[", "#1", "]"}], "=", "#2"}], ")"}], 
     "&"}], ",", 
    RowBox[{"{", 
     RowBox[{"explistadvsnd", ",", 
      RowBox[{"Table", "[", 
       RowBox[{"0", ",", 
        RowBox[{"Length", "[", "explistadvsnd", "]"}]}], "]"}]}], "}"}]}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"zMagnetMaxExperiment", "[", "#1", "]"}], "=", "#2"}], ")"}], 
      "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistadvsnd", ",", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", 
         RowBox[{"Length", "[", "explistadvsnd", "]"}]}], "]"}]}], "}"}]}], 
    "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Mean", " ", "magnetic", " ", "field", " ", "of", " ", "the", " ", 
    "dipole", " ", "magnet"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"MagneticFieldExperiment", "[", "#1", "]"}], "=", "#2"}], 
       ")"}], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistadvsnd", ",", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", 
         RowBox[{"Length", "[", "explistadvsnd", "]"}]}], "]"}]}], "}"}]}], 
    "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"ECAL", " ", "option", " ", 
    RowBox[{"(", 
     RowBox[{"True", ",", "False"}], ")"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"ECALoptionExperiment", "[", "exp", "]"}], "=", 
      "\"\<True\>\""}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistadvsnd"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Position", " ", "of", " ", "the", " ", "beginning", " ", "of", " ", "the",
     " ", "ECAL"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"zECALminExperiment", "[", "#1", "]"}], "=", "#2"}], ")"}], 
      "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistadvsnd", ",", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", 
         RowBox[{"Length", "[", "explistadvsnd", "]"}]}], "]"}]}], "}"}]}], 
    "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "The", " ", "final", " ", "detector", " ", "plane", " ", "needed", " ", 
     "to", " ", "reconstruct", " ", 
     RowBox[{"muons", ".", " ", "Depeding"}], " ", "on", " ", "the", " ", 
     "experiment"}], ",", " ", 
    RowBox[{
    "it", " ", "is", " ", "approximated", " ", "by", " ", "be", " ", "end", 
     " ", "of", " ", "the", " ", "trackers", " ", "or", " ", "the", " ", 
     "muon", " ", "system"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"xLongMuonPlaneExperiment", "[", "exp", "]"}], "=", "0"}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistadvsnd"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "The", " ", "final", " ", "detector", " ", "plane", " ", "needed", " ", 
     "to", " ", "reconstruct", " ", "other", " ", 
     RowBox[{"particles", ".", " ", "Depeding"}], " ", "on", " ", "the", " ", 
     "experiment"}], ",", " ", 
    RowBox[{
    "it", " ", "is", " ", "approximated", " ", "by", " ", "the", " ", "end", 
     " ", "of", " ", "the", " ", "trackers", " ", "or", " ", "the", " ", 
     "calorimeter", " ", "system"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"xLongNonMuonPlaneExperiment", "[", "exp", "]"}], "=", "0"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistadvsnd"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"List", " ", "of", " ", "detectable", " ", 
     RowBox[{"particles", ".", " ", "If"}], " ", "ECAL", " ", "is", " ", 
     "absent"}], ",", " ", 
    RowBox[{
    "it", " ", "is", " ", "assumed", " ", "by", " ", "default", " ", "that", 
     " ", "photons", " ", "and", " ", 
     SubscriptBox[
      SuperscriptBox["K", "0"], "L"], " ", "cannot", " ", "be", " ", 
     "detected"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MapThread", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"DetectablePDGsExperiment", "[", "#1", "]"}], "=", "#2"}], 
      ")"}], "&"}], ",", 
    RowBox[{"{", 
     RowBox[{"explistadvsnd", ",", 
      RowBox[{"Table", "[", 
       RowBox[{"detectablepdgs", ",", 
        RowBox[{"Length", "[", "explistadvsnd", "]"}]}], "]"}]}], "}"}]}], 
   "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.8934862862111635`*^9, 3.893486289101931*^9}, {
   3.8934999953831625`*^9, 3.893500001065502*^9}, {3.8935001679579945`*^9, 
   3.8935001709587584`*^9}, {3.8935003606663184`*^9, 3.893500363223881*^9}, {
   3.893518137072644*^9, 3.8935181370796366`*^9}, 3.8935193128475156`*^9, {
   3.893520126029746*^9, 3.8935201693363*^9}, 3.893520658238859*^9, {
   3.8935219485485992`*^9, 3.8935220114931326`*^9}, {3.893522123210194*^9, 
   3.8935221395361443`*^9}, {3.8935224774029684`*^9, 3.893522482557907*^9}, {
   3.8935226023683987`*^9, 3.8935227200300174`*^9}, {3.8935227712273984`*^9, 
   3.8935227725526705`*^9}, {3.893523566555051*^9, 3.893523592666511*^9}, 
   3.8944385906762857`*^9, {3.897145306939946*^9, 3.897145319411379*^9}, {
   3.8971454739706173`*^9, 3.897145486974264*^9}, 3.897147806019418*^9, {
   3.89919643389729*^9, 3.8991964345414314`*^9}, {3.9050601979535847`*^9, 
   3.905060198117402*^9}, 3.910240594919752*^9, {3.910246973817509*^9, 
   3.9102469738185167`*^9}, {3.910256161720969*^9, 3.9102561744592624`*^9}, {
   3.9102590865558147`*^9, 3.910259089209283*^9}, {3.910432303931447*^9, 
   3.9104323042209206`*^9}, {3.912057405280252*^9, 3.912057413092595*^9}, {
   3.915182070804219*^9, 3.9151820995752015`*^9}, {3.9151821462454433`*^9, 
   3.9151821665528574`*^9}, {3.9151822170127974`*^9, 3.915182225891651*^9}, {
   3.915182376119027*^9, 3.9151823785575695`*^9}, {3.9151826910078692`*^9, 
   3.9151826912126455`*^9}, {3.9151827795175624`*^9, 3.915182796483204*^9}},
 CellLabel->
  "In[840]:=",ExpressionUUID->"c3bd091a-cad3-433e-a5f4-465bd0c09acc"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Cross-sections", "Subsubsection",
 CellChangeTimes->{{3.8933256308713317`*^9, 
  3.8933256323468237`*^9}},ExpressionUUID->"f37860c0-24f8-4bf0-9ed8-\
e51abb1cec19"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "0.1", " ", "stays", " ", "for", " ", "10", " ", "times", " ", "lower", 
    " ", "luminosity", " ", "of", " ", "running", " ", "time", " ", "of", " ", 
    RowBox[{"SND", "@", "LHC"}], " ", "compared", " ", "to", " ", "high", " ",
     "lumi"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"MapThread", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"NPOTexperiment", "[", "#1", "]"}], "=", "#2"}], ")"}], 
       "&"}], ",", 
      RowBox[{"{", 
       RowBox[{"explistadvsnd", ",", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"LLHChighLumi", "*", 
           RowBox[{"\[Sigma]ppInpbFacility", "[", "\"\<LHC\>\"", "]"}]}], ",", 
          RowBox[{"Length", "[", "explistadvsnd", "]"}]}], "]"}]}], "}"}]}], 
     "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MapThread", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"AtargetExperiment", "[", "#1", "]"}], "=", "#2"}], ")"}], 
       "&"}], ",", 
      RowBox[{"{", 
       RowBox[{"explistadvsnd", ",", 
        RowBox[{"Table", "[", 
         RowBox[{"1.", ",", 
          RowBox[{"Length", "[", "explistadvsnd", "]"}]}], "]"}]}], "}"}]}], 
     "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Cascade", " ", "enhancement", " ", "of", " ", "the", " ", "production", 
     " ", "relative", " ", "to", " ", "the", " ", "production", " ", "in", 
     " ", "pure", " ", "pp", " ", 
     RowBox[{"collisions", ".", " ", "Relevant"}], " ", "for", " ", "fixed", 
     " ", "target", " ", "experiments"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "For", " ", "all", " ", "experiments", " ", "located", " ", "at", " ", 
      "SPS"}], ",", " ", 
     RowBox[{
      RowBox[{
       RowBox[{
       "the", " ", "cascade", " ", "sndtors", " ", "is", " ", "taken", " ", 
        "from", " ", 
        RowBox[{"http", ":"}]}], "//", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"cds", ".", "cern", ".", "ch"}], "/", "record"}], "/", 
           "2115534"}], "/", "files"}], "/", "SHiP"}], "-", "NOTE", "-", 
        "2015", "-", 
        RowBox[{"009.", 
         RowBox[{"pdf", "?", "version"}]}]}]}], "=", "1"}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MapThread", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"CascadeFactorbb", "[", "#1", "]"}], "=", "#2"}], ")"}], 
       "&"}], ",", 
      RowBox[{"{", 
       RowBox[{"explistadvsnd", ",", 
        RowBox[{"Table", "[", 
         RowBox[{"1.", ",", 
          RowBox[{"Length", "[", "explistadvsnd", "]"}]}], "]"}]}], "}"}]}], 
     "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Fraction", " ", "of", " ", "produced", " ", "bb", " ", "per", " ", "PoT",
      " ", "at", " ", "the", " ", "given", " ", "experiment"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"PppTobbExperiment", "[", "exp", "]"}], "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"\[Sigma]ppTobbInpbFacility", "[", 
          RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}], "/", 
         RowBox[{"\[Sigma]ppInpbFacility", "[", 
          RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}]}], ")"}], 
       SuperscriptBox[
        RowBox[{"AtargetExperiment", "[", "exp", "]"}], "0.29"], "*", 
       RowBox[{"CascadeFactorbb", "[", "exp", "]"}]}]}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistadvsnd"}], "}"}]}], "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MapThread", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"CascadeFactorcc", "[", "#1", "]"}], "=", "#2"}], ")"}], 
       "&"}], ",", 
      RowBox[{"{", 
       RowBox[{"explistadvsnd", ",", 
        RowBox[{"Table", "[", 
         RowBox[{"1.", ",", 
          RowBox[{"Length", "[", "explistadvsnd", "]"}]}], "]"}]}], "}"}]}], 
     "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Fraction", " ", "of", " ", "produced", " ", "cc", " ", "per", " ", "PoT",
      " ", "at", " ", "the", " ", "given", " ", "experiment"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"PppToccExperiment", "[", "exp", "]"}], "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"\[Sigma]ppToccInpbFacility", "[", 
          RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}], "/", 
         RowBox[{"\[Sigma]ppInpbFacility", "[", 
          RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}]}], ")"}], 
       SuperscriptBox[
        RowBox[{"AtargetExperiment", "[", "exp", "]"}], "0.29"], "*", 
       RowBox[{"CascadeFactorcc", "[", "exp", "]"}]}]}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistadvsnd"}], "}"}]}], "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Fraction", " ", "of", " ", "produced", " ", "h", " ", "per", " ", "PoT", 
     " ", "at", " ", "the", " ", "given", " ", "experiment"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"PppTohExperiment", "[", "exp", "]"}], "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\[Sigma]ppTohInpbFacility", "[", 
           RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}], "/", 
          RowBox[{"\[Sigma]ppInpbFacility", "[", 
           RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}]}], ")"}], 
        SuperscriptBox[
         RowBox[{"AtargetExperiment", "[", "exp", "]"}], "0.29"]}]}], ",", 
      RowBox[{"{", 
       RowBox[{"exp", ",", "explistadvsnd"}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Fraction", " ", "of", " ", "produced", " ", "W", " ", "per", " ", "PoT", 
     " ", "at", " ", "the", " ", "given", " ", "experiment"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"PppToWExperiment", "[", "exp", "]"}], "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\[Sigma]ppToWInpbFacility", "[", 
           RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}], "/", 
          RowBox[{"\[Sigma]ppInpbFacility", "[", 
           RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}]}], ")"}], 
        SuperscriptBox[
         RowBox[{"AtargetExperiment", "[", "exp", "]"}], "0.29"]}]}], ",", 
      RowBox[{"{", 
       RowBox[{"exp", ",", "explistadvsnd"}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Fraction", " ", "of", " ", "produced", " ", 
     SuperscriptBox["\[Pi]", "0"], " ", "per", " ", "PoT", " ", "at", " ", 
     "the", " ", "given", " ", "experiment"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"PppTo\[Pi]0exp", "[", "exp", "]"}], "=", 
       RowBox[{"PppTo\[Pi]0Facility", "[", 
        RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"exp", ",", "explistadvsnd"}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Fraction", " ", "of", " ", "produced", " ", "\[Eta]", " ", "per", " ", 
     "PoT", " ", "at", " ", "the", " ", "given", " ", "experiment"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"PppTo\[Eta]exp", "[", "exp", "]"}], "=", 
       RowBox[{"PppTo\[Eta]Facility", "[", 
        RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"exp", ",", "explistadvsnd"}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Fraction", " ", "of", " ", "produced", " ", 
     RowBox[{"\[Eta]", "'"}], " ", "per", " ", "PoT", " ", "at", " ", "the", 
     " ", "given", " ", "experiment"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"PppTo\[Eta]prexp", "[", "exp", "]"}], "=", 
       RowBox[{"PppTo\[Eta]prFacility", "[", 
        RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"exp", ",", "explistadvsnd"}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Fraction", " ", "of", " ", "produced", " ", 
     SuperscriptBox["\[Rho]", "0"], " ", "per", " ", "PoT", " ", "at", " ", 
     "the", " ", "given", " ", "experiment"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"PppTo\[Rho]0exp", "[", "exp", "]"}], "=", 
       RowBox[{"PppTo\[Rho]0Facility", "[", 
        RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"exp", ",", "explistadvsnd"}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Fraction", " ", "of", " ", "produced", " ", "\[Omega]", " ", "per", " ", 
     "PoT", " ", "at", " ", "the", " ", "given", " ", "experiment"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"PppTo\[Omega]exp", "[", "exp", "]"}], "=", 
       RowBox[{"PppTo\[Omega]Facility", "[", 
        RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"exp", ",", "explistadvsnd"}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"PppToJpsiexp", "[", "exp", "]"}], "=", 
       RowBox[{
        RowBox[{"PppToJpsiFacility", "[", 
         RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}], 
        SuperscriptBox[
         RowBox[{"AtargetExperiment", "[", "exp", "]"}], "0.29"]}]}], ",", 
      RowBox[{"{", 
       RowBox[{"exp", ",", "explistadvsnd"}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Fraction", " ", "of", " ", "produced", " ", "\[CapitalUpsilon]", 
     RowBox[{"(", 
      RowBox[{"1", "s"}], ")"}], " ", "per", " ", "PoT", " ", "at", " ", 
     "the", " ", "given", " ", "experiment"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"PppToUpsilonexp", "[", "exp", "]"}], "=", 
       RowBox[{
        RowBox[{"PppToUpsilonFacility", "[", 
         RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}], 
        SuperscriptBox[
         RowBox[{"AtargetExperiment", "[", "exp", "]"}], "0.29"]}]}], ",", 
      RowBox[{"{", 
       RowBox[{"exp", ",", "explistadvsnd"}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Fraction", " ", "of", " ", "produced", " ", "\[Phi]", " ", "at", " ", 
     "the", " ", "given", " ", "experiment"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"PppToPhiexp", "[", "exp", "]"}], "=", 
       RowBox[{"PppToPhiFacility", "[", 
        RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"exp", ",", "explistadvsnd"}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Overall", " ", "table", " ", "with", " ", "cross"}], "-", 
     RowBox[{"sections", " ", "used", " ", "for", " ", "exporting"}]}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"TableNumbersParticlesExperiment", "[", "exp", "]"}], "=", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "\"\<Facility\>\"", ",", "\"\<Npot\>\"", ",", "\"\<Atarget\>\"", 
           ",", "\"\<PPi0\>\"", ",", "\"\<PEta\>\"", ",", "\"\<PEtapr\>\"", 
           ",", "\"\<PRho0\>\"", ",", "\"\<POmega\>\"", ",", "\"\<Pc\>\"", 
           ",", "\"\<Pb\>\"", ",", "\"\<PW\>\"", ",", "\"\<Ph\>\"", ",", 
           "\"\<PJpsi\>\"", ",", "\"\<PUpsilon\>\"", ",", "\"\<PPhi\>\""}], 
          "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"FacilityExperiment", "[", "exp", "]"}], ",", 
           RowBox[{"NPOTexperiment", "[", "exp", "]"}], ",", 
           RowBox[{"AtargetExperiment", "[", "exp", "]"}], ",", 
           RowBox[{"PppTo\[Pi]0exp", "[", "exp", "]"}], ",", 
           RowBox[{"PppTo\[Eta]exp", "[", "exp", "]"}], ",", 
           RowBox[{"PppTo\[Eta]prexp", "[", "exp", "]"}], ",", 
           RowBox[{"PppTo\[Rho]0exp", "[", "exp", "]"}], ",", 
           RowBox[{"PppTo\[Omega]exp", "[", "exp", "]"}], ",", 
           RowBox[{"2", 
            RowBox[{"PppToccExperiment", "[", "exp", "]"}]}], ",", 
           RowBox[{"2", 
            RowBox[{"PppTobbExperiment", "[", "exp", "]"}]}], ",", 
           RowBox[{"PppToWExperiment", "[", "exp", "]"}], ",", 
           RowBox[{"PppTohExperiment", "[", "exp", "]"}], ",", 
           RowBox[{"PppToJpsiexp", "[", "exp", "]"}], ",", 
           RowBox[{"PppToUpsilonexp", "[", "exp", "]"}], ",", 
           RowBox[{"PppToPhiexp", "[", "exp", "]"}]}], "}"}]}], "}"}], "//", 
       "N"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistadvsnd"}], "}"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.8935221233287153`*^9, 3.893522123363767*^9}, {
   3.893522755512313*^9, 3.893522755947507*^9}, {3.8941782604745955`*^9, 
   3.8941782638440585`*^9}, {3.89417873741728*^9, 3.894178739906375*^9}, {
   3.8945300441377225`*^9, 3.8945300484085674`*^9}, {3.8972358501675105`*^9, 
   3.8972358665980916`*^9}, {3.8972862403793154`*^9, 3.89728624581529*^9}, {
   3.899196423237883*^9, 3.899196434071004*^9}, 3.899197111298829*^9, {
   3.8991971429733024`*^9, 3.899197143174786*^9}},
 CellLabel->
  "In[875]:=",ExpressionUUID->"52b208a1-e70e-4904-8f37-699564e63eed"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Conditions for the LLP to decay inside the decay volume and for the products \
to point to the end of the detector\
\>", "Subsubsection",
 CellChangeTimes->{{3.905011297554874*^9, 3.9050113192993593`*^9}, 
   3.915437209628518*^9},ExpressionUUID->"c6db9898-1325-437c-afd4-\
f54b43107216"],

Cell[BoxData[
 RowBox[{"Do", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"IfLLPinsideDecVol", "[", 
      RowBox[{"zLLP_", ",", "xLLP_", ",", "yLLP_", ",", "exp"}], "]"}], "=", 
     RowBox[{"IfLLPinsideDecVolSimple", "[", "exp", "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"IfLLPtoDet", "[", 
        RowBox[{
        "x1LLPproj_", ",", "x2LLPproj_", ",", "xLongProj_", ",", "exp"}], 
        "]"}], ",", 
       RowBox[{"IfLLPnotToDet", "[", 
        RowBox[{
        "x1LLPproj_", ",", "x2LLPproj_", ",", "xLongProj_", ",", "exp"}], 
        "]"}]}], "}"}], "=", 
     RowBox[{"IfParticlePointsToDetSimple", "[", "exp", "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"IfLLPdecVolToDet", "[", 
      RowBox[{
      "zLLP_", ",", "xLLP_", ",", "yLLP_", ",", "x1LLPproj_", ",", 
       "x2LLPproj_", ",", "xLongProj_", ",", "exp"}], "]"}], "=", 
     RowBox[{
      RowBox[{"IfLLPinsideDecVol", "[", 
       RowBox[{"zLLP", ",", "xLLP", ",", "yLLP", ",", "exp"}], "]"}], "*", 
      RowBox[{"IfLLPtoDet", "[", 
       RowBox[{"x1LLPproj", ",", "x2LLPproj", ",", "xLongProj", ",", "exp"}], 
       "]"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"IfLLPdecVolNotToDet", "[", 
      RowBox[{
      "zLLP_", ",", "xLLP_", ",", "yLLP_", ",", "x1LLPproj_", ",", 
       "x2LLPproj_", ",", "xLongProj_", ",", "exp"}], "]"}], "=", 
     RowBox[{
      RowBox[{"IfLLPinsideDecVol", "[", 
       RowBox[{"zLLP", ",", "xLLP", ",", "yLLP", ",", "exp"}], "]"}], "*", 
      RowBox[{"IfLLPnotToDet", "[", 
       RowBox[{"x1LLPproj", ",", "x2LLPproj", ",", "xLongProj", ",", "exp"}], 
       "]"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"DecayAcceptanceGeometry", "[", 
      RowBox[{"coord1_", ",", "coord2_", ",", "xLongProj_", ",", "exp"}], 
      "]"}], "=", 
     RowBox[{"IfLLPtoDet", "[", 
      RowBox[{"coord1", ",", "coord2", ",", "xLongProj", ",", "exp"}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", ",", 
   RowBox[{"{", 
    RowBox[{"exp", ",", "explistadvsnd"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.9050149920517483`*^9, 3.9050149927967587`*^9}, 
   3.9050171519212847`*^9, {3.905059487826475*^9, 3.905059488012804*^9}, {
   3.9102585745685687`*^9, 3.910258640969387*^9}, 3.910258818544339*^9, 
   3.910259935731093*^9, {3.9154370072067165`*^9, 3.9154370915477915`*^9}, {
   3.91543720964989*^9, 3.915437209728734*^9}},
 CellLabel->
  "In[892]:=",ExpressionUUID->"023c2ebe-4633-4a62-b4a8-36a84e1988b9"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["LHCb-downstream", "Subsection",
 CellChangeTimes->{{3.8933409821075697`*^9, 3.893340986123767*^9}, {
  3.9074066110245447`*^9, 
  3.9074066130828633`*^9}},ExpressionUUID->"f7b3b221-18ee-4a54-96c2-\
4efdf1e9765c"],

Cell[CellGroupData[{

Cell["Geometry", "Subsubsection",
 CellChangeTimes->{{3.893342623432827*^9, 
  3.893342624458*^9}},ExpressionUUID->"dcc372fd-b420-4058-a209-c96f59c1bef5"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"explistlhcb", "=", 
    RowBox[{"{", 
     RowBox[{
     "\"\<LHCb-downstream-full\>\"", ",", 
      "\"\<LHCb-downstream-T-tracks-only\>\"", ",", "\"\<LHCb-downstream\>\"",
       ",", "\"\<LHCb-muon-chamber\>\""}], "}"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Distance", " ", "to", " ", "the", " ", "fiducial", " ", "volume", " ", 
    "along", " ", "the", " ", "beamline", " ", 
    RowBox[{"axis", ".", " ", 
     RowBox[{"MapThread", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"list1", "[", "#", "]"}], "=", "#2"}], ")"}], "&"}], ",", 
       RowBox[{"{", 
        RowBox[{"listexp", ",", "listvals"}], "}"}]}], "]"}]}], " ", 
    "equates", " ", "the", " ", "elements", " ", "list1", " ", "with", " ", 
    "keys", " ", "from", " ", "listexp", " ", "to", " ", "the", " ", 
    "corresponding", " ", "elements", " ", "of", " ", "the", " ", "list", " ",
     "listvals"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"zToDecayVolumeExperiment", "[", "#1", "]"}], "=", "#2"}], 
       ")"}], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistlhcb", ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "1", ",", "1", ",", "15"}], "}"}]}], "}"}]}], "]"}],
    ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Detector", " ", "has", " ", "the", " ", "axis", " ", "along", " ", 
    "which", " ", "its", " ", "components", " ", "are", " ", 
    RowBox[{"placed", ".", " ", "The"}], " ", "option", " ", "below", " ", 
    "defines", " ", "the", " ", "orientation", " ", "of", " ", "the", " ", 
    "final", " ", "plane", " ", "transverse", " ", "to", " ", "this", " ", 
    "axis", " ", "relative", " ", "to", " ", "the", " ", "beamline"}], "*)"}],
   "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Transverse", " ", "if", " ", "the", " ", "plane", " ", "is", " ", 
     "tranverse", " ", 
     RowBox[{"(", 
      RowBox[{"SHiP", ",", " ", 
       RowBox[{"FACET", " ", "etc"}]}], ")"}]}], ",", " ", 
    RowBox[{
    "and", " ", "Parallel", " ", "if", " ", "it", " ", "is", " ", "parallel", 
     " ", 
     RowBox[{"(", 
      RowBox[{"MATHUSLA", ",", " ", "ANUBIS"}]}]}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"DetectorPlaneOrientationExperiment", "[", "#1", "]"}], "=", 
        "#2"}], ")"}], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistlhcb", ",", 
       RowBox[{"Table", "[", 
        RowBox[{"\"\<Transverse\>\"", ",", 
         RowBox[{"Length", "[", "explistlhcb", "]"}]}], "]"}]}], "}"}]}], 
    "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Facility", " ", "hosting", " ", "the", " ", 
     RowBox[{"experiment", ":", " ", "SPS"}]}], ",", " ", "Fermilab", ",", 
    " ", "LHC", ",", " ", 
    RowBox[{"FCC", "-", "hh"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"FacilityExperiment", "[", "#1", "]"}], "=", "#2"}], ")"}], 
      "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistlhcb", ",", 
       RowBox[{"Table", "[", 
        RowBox[{"\"\<LHC\>\"", ",", 
         RowBox[{"Length", "[", "explistlhcb", "]"}]}], "]"}]}], "}"}]}], 
    "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Geometry", " ", "of", " ", "the", " ", 
     RowBox[{"experiment", ":", " ", "box"}]}], ",", " ", "cylinder", ",", 
    " ", 
    RowBox[{"annular", " ", "cylinder"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"GeometryExperiment", "[", "#1", "]"}], "=", "#2"}], ")"}], 
      "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistlhcb", ",", 
       RowBox[{"{", 
        RowBox[{
        "\"\<Annular cylinder\>\"", ",", "\"\<Annular cylinder\>\"", ",", 
         "\"\<Annular cylinder\>\"", ",", "\"\<Box\>\""}], "}"}]}], "}"}]}], 
    "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Transverse", " ", "dimensions", " ", "of", " ", "the", " ", "decay", " ",
      "volume", " ", "assuming", " ", "box", " ", "geometry"}], ",", " ", 
    RowBox[{
    "or", " ", "cylindrical", " ", "geometry", " ", "if", " ", "the", " ", 
     "detector", " ", "plane", " ", "is", " ", "parallel", " ", "to", " ", 
     "the", " ", "beamline", " ", 
     RowBox[{
      RowBox[{"(", "ANUBIS", ")"}], ".", " ", "Otherwise"}], " ", "set", " ", 
     "to", " ", "zero"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MapThread", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"dxDecayVolumeExperiment", "[", 
        RowBox[{"z_", ",", "#1"}], "]"}], "=", "#2"}], ")"}], "&"}], ",", 
    RowBox[{"{", 
     RowBox[{"explistlhcb", ",", 
      RowBox[{"{", 
       RowBox[{"0.", ",", "0.", ",", "0.", ",", 
        RowBox[{"4.8", "*", "2"}]}], "}"}]}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"dyDecayVolumeExperiment", "[", 
         RowBox[{"z_", ",", "#1"}], "]"}], "=", "#2"}], ")"}], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistlhcb", ",", 
       RowBox[{"{", 
        RowBox[{"0.", ",", "0.", ",", "0.", ",", 
         RowBox[{"4.", "*", "2"}]}], "}"}]}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Decay", " ", "volume", " ", "length", " ", "along", " ", "the", " ", 
    "beamline", " ", "axis"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"dzDecayVolumeExperiment", "[", "#1", "]"}], "=", "#2"}], 
       ")"}], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistlhcb", ",", 
       RowBox[{"{", 
        RowBox[{"6.7", ",", "6.7", ",", "1.5", ",", "4"}], "}"}]}], "}"}]}], 
    "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Distance", " ", "from", " ", "the", " ", "beamline", " ", "to", " ", 
     "the", " ", "decay", " ", "volume", " ", "center", " ", "and", " ", 
     "detector", " ", "along", " ", "the", " ", "x"}], ",", 
    RowBox[{"y", " ", "axes"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MapThread", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"xToDecayVolumeCenterExperiment", "[", 
        RowBox[{"z_", ",", "#1"}], "]"}], "=", "#2"}], ")"}], "&"}], ",", 
    RowBox[{"{", 
     RowBox[{"explistlhcb", ",", 
      RowBox[{"Table", "[", 
       RowBox[{"0", ",", 
        RowBox[{"Length", "[", "explistlhcb", "]"}]}], "]"}]}], "}"}]}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"yToDecayVolumeCenterExperiment", "[", 
         RowBox[{"z_", ",", "#1"}], "]"}], "=", "#2"}], ")"}], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistlhcb", ",", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", 
         RowBox[{"Length", "[", "explistlhcb", "]"}]}], "]"}]}], "}"}]}], 
    "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Inner", " ", "and", " ", "outer", " ", "radii", " ", "of", " ", "the", 
    " ", "decay", " ", 
    RowBox[{"volume", ".", " ", "Applicable"}], " ", "if", " ", "the", " ", 
    "decay", " ", "volume", " ", "has", " ", "cylindrical", " ", "geometry"}],
    "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MapThread", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"RinnerDecayVolumeExperiment", "[", 
        RowBox[{"#1", ",", "z_"}], "]"}], "=", "#2"}], ")"}], "&"}], ",", 
    RowBox[{"{", 
     RowBox[{"explistlhcb", ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"z", "*", 
         RowBox[{"Tan", "[", 
          RowBox[{"theta", "[", "5.", "]"}], "]"}]}], ",", 
        RowBox[{"z", "*", 
         RowBox[{"Tan", "[", 
          RowBox[{"theta", "[", "5.", "]"}], "]"}]}], ",", 
        RowBox[{"z", "*", 
         RowBox[{"Tan", "[", 
          RowBox[{"theta", "[", "5.", "]"}], "]"}]}], ",", "0"}], "}"}]}], 
     "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"RouterDecayVolumeExperiment", "[", 
         RowBox[{"#1", ",", "z_"}], "]"}], "=", "#2"}], ")"}], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistlhcb", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"z", "*", 
          RowBox[{"Tan", "[", 
           RowBox[{"theta", "[", "2.", "]"}], "]"}]}], ",", 
         RowBox[{"z", "*", 
          RowBox[{"Tan", "[", 
           RowBox[{"theta", "[", "2.", "]"}], "]"}]}], ",", 
         RowBox[{"z", "*", 
          RowBox[{"Tan", "[", 
           RowBox[{"theta", "[", "2.", "]"}], "]"}]}], ",", "0"}], "}"}]}], 
      "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"z", "-", 
    RowBox[{
    "coordinate", " ", "of", " ", "the", " ", "center", " ", "of", " ", "the",
      " ", "decay", " ", "volume"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"zToDecayVolumeCenterExperiment", "[", "exp", "]"}], "=", 
      RowBox[{
       RowBox[{"zToDecayVolumeExperiment", "[", "exp", "]"}], "+", 
       FractionBox[
        RowBox[{"dzDecayVolumeExperiment", "[", "exp", "]"}], "2"]}]}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistlhcb"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Maximal", " ", 
    RowBox[{"long", ".", " ", "displacement"}], " ", "of", " ", "the", " ", 
    "decay", " ", "volume"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"zMaxDecayVolumeExperiment", "[", "exp", "]"}], "=", 
     RowBox[{
      RowBox[{"zToDecayVolumeExperiment", "[", "exp", "]"}], "+", 
      RowBox[{"dzDecayVolumeExperiment", "[", "exp", "]"}]}]}], ",", 
    RowBox[{"{", 
     RowBox[{"exp", ",", "explistlhcb"}], "}"}]}], "]"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Whether", " ", "the", " ", "decay", " ", "volume", " ", "serves", " ", 
    "as", " ", "detector", " ", 
    RowBox[{"(", 
     RowBox[{"True", " ", "or", " ", "False"}], ")"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"DecayVolumeAsDetectorExperiment", "[", "#1", "]"}], "=", 
        "#2"}], ")"}], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistlhcb", ",", 
       RowBox[{"{", 
        RowBox[{
        "\"\<False\>\"", ",", "\"\<False\>\"", ",", "\"\<False\>\"", ",", 
         "\"\<True\>\""}], "}"}]}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Transverse", " ", "dimensions", " ", "of", " ", "the", " ", "detector", 
    " ", "assuming", " ", "box", " ", "geometry"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MapThread", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"dxDetectorExperiment", "[", 
        RowBox[{"#1", ",", "z_"}], "]"}], "=", "#2"}], ")"}], "&"}], ",", 
    RowBox[{"{", 
     RowBox[{"explistlhcb", ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "6.48", ",", "6.48", ",", "0"}], "}"}]}], "}"}]}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"dyDetectorExperiment", "[", 
         RowBox[{"#1", ",", "z_"}], "]"}], "=", "#2"}], ")"}], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistlhcb", ",", 
       RowBox[{"{", 
        RowBox[{"0.", ",", "4.83", ",", "4.83", ",", "0"}], "}"}]}], "}"}]}], 
    "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Length", " ", "of", " ", "the", " ", "detector", " ", "in", " ", "z", " ",
     "plane"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"dzDetectorExperiment", "[", "#1", "]"}], "=", "#2"}], ")"}], 
      "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistlhcb", ",", 
       RowBox[{"{", 
        RowBox[{"8", ",", "1.7", ",", "1.7", ",", "0"}], "}"}]}], "}"}]}], 
    "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Coordinates", " ", "of", " ", "the", " ", "center", " ", "of", " ", "the",
     " ", "detector"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"xToDetectorCenterExperiment", "[", "exp", "]"}], "=", "0"}], 
    ",", 
    RowBox[{"{", 
     RowBox[{"exp", ",", "explistlhcb"}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"yToDetectorCenterExperiment", "[", "exp", "]"}], "=", "0"}], 
    ",", 
    RowBox[{"{", 
     RowBox[{"exp", ",", "explistlhcb"}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"zToDetectorCenterExperiment", "[", "#1", "]"}], "=", "#2"}], 
       ")"}], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistlhcb", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{
          "zMaxDecayVolumeExperiment", "[", "\"\<LHCb-downstream-full\>\"", 
           "]"}], "+", 
          FractionBox[
           RowBox[{
           "dzDetectorExperiment", "[", "\"\<LHCb-downstream-full\>\"", "]"}],
            "2"]}], ",", 
         RowBox[{
          RowBox[{
          "zMaxDecayVolumeExperiment", "[", 
           "\"\<LHCb-downstream-T-tracks-only\>\"", "]"}], "+", 
          FractionBox[
           RowBox[{
           "dzDetectorExperiment", "[", 
            "\"\<LHCb-downstream-T-tracks-only\>\"", "]"}], "2"]}], ",", 
         RowBox[{"9.4", "-", 
          FractionBox["1.7", "2"]}], ",", "0."}], "}"}]}], "}"}]}], "]"}], 
   ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Inner", " ", "and", " ", "outer", " ", "radii", " ", "of", " ", "the", 
    " ", "detector"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MapThread", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"RinnerDetectorExperiment", "[", 
        RowBox[{"#1", ",", "z_"}], "]"}], "=", "#2"}], ")"}], "&"}], ",", 
    RowBox[{"{", 
     RowBox[{"explistlhcb", ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"18", "*", 
         RowBox[{"Tan", "[", 
          RowBox[{"theta", "[", "5.", "]"}], "]"}]}], ",", "0.09", ",", 
        "0.09", ",", "0"}], "}"}]}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"RouterDetectorExperiment", "[", 
         RowBox[{"#1", ",", "z_"}], "]"}], "=", "#2"}], ")"}], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistlhcb", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"18", "*", 
          RowBox[{"Tan", "[", 
           RowBox[{"theta", "[", "2.", "]"}], "]"}]}], ",", "0", ",", "0", 
         ",", "0"}], "}"}]}], "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Length", " ", "of", " ", "the", " ", "detector", " ", "along", " ", "the",
     " ", "detector", " ", "axis"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"dxLongDetectorExperiment", "[", "exp", "]"}], "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"DetectorPlaneOrientationExperiment", "[", "exp", "]"}], 
         "\[Equal]", "\"\<Transverse\>\""}], ",", 
        RowBox[{"dzDetectorExperiment", "[", "exp", "]"}], ",", 
        RowBox[{"dyDetectorExperiment", "[", "exp", "]"}]}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistlhcb"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "The", " ", "maximal", " ", "coordinate", " ", "of", " ", "the", " ", 
    "end", " ", "of", " ", "the", " ", "detector", " ", "plane", " ", 
    RowBox[{"(", 
     RowBox[{"along", " ", "the", " ", "detector", " ", "axis"}], ")"}], " ", 
    "used", " ", "to", " ", "calculate", " ", "the", " ", "decay", " ", 
    RowBox[{"acceptance", ".", " ", "May"}], " ", "be", " ", "either", " ", 
    "the", " ", "z", " ", "coordinate", " ", "or", " ", "the", " ", "y", " ", 
    "coordinate", " ", 
    RowBox[{"(", 
     RowBox[{
     "if", " ", "the", " ", "final", " ", "detector", " ", "plane", " ", "is",
       " ", "oriented", " ", "parallel", " ", "to", " ", "the", " ", 
      "beamline"}], ")"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"xLongMaxDetectorExperiment", "[", "exp", "]"}], "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"DetectorPlaneOrientationExperiment", "[", "exp", "]"}], 
         "\[Equal]", "\"\<Transverse\>\""}], ",", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"exp", "==", "\"\<LHCb-downstream\>\""}], ",", "9.4", ",", 
          RowBox[{
           RowBox[{"zMaxDecayVolumeExperiment", "[", "exp", "]"}], "+", 
           RowBox[{"dxLongDetectorExperiment", "[", "exp", "]"}]}]}], "]"}], 
        ",", 
        RowBox[{
         RowBox[{"yToDetectorCenterExperiment", "[", "exp", "]"}], "+", 
         RowBox[{
          RowBox[{"dyDetectorExperiment", "[", "exp", "]"}], "/", "2"}]}]}], 
       "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistlhcb"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Position", " ", "of", " ", "the", " ", "final", " ", "plane", " ", "for", 
    " ", "the", " ", "decay", " ", "products", " ", "along", " ", "the", " ", 
    "detector", " ", "axis"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"xLongDecayProductFinalPlaneExperiment", "[", "exp", "]"}], "=", 
     RowBox[{"xLongMaxDetectorExperiment", "[", "exp", "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"exp", ",", "explistlhcb"}], "}"}]}], "]"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Whether", " ", "the", " ", "experiment", " ", "has", " ", "dipole", " ", 
    "magnet", " ", "in", " ", "the", " ", "detector", " ", 
    RowBox[{"(", 
     RowBox[{"True", ",", " ", "False"}], ")"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"DipoleMagnetOptionExperiment", "[", "#1", "]"}], "=", "#2"}],
        ")"}], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistlhcb", ",", 
       RowBox[{"{", 
        RowBox[{
        "\"\<True\>\"", ",", "\"\<True\>\"", ",", "\"\<True\>\"", ",", 
         "\"\<False\>\""}], "}"}]}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Longitudinal", " ", "positions", " ", "of", " ", "the", " ", "dipole", 
    " ", "magnet", " ", "of", " ", "the", " ", "detector"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MapThread", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"zMagnetMinExperiment", "[", "#1", "]"}], "=", "#2"}], ")"}], 
     "&"}], ",", 
    RowBox[{"{", 
     RowBox[{"explistlhcb", ",", 
      RowBox[{"{", 
       RowBox[{"3.", ",", "3.", ",", "3.", ",", "0"}], "}"}]}], "}"}]}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"zMagnetMaxExperiment", "[", "#1", "]"}], "=", "#2"}], ")"}], 
      "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistlhcb", ",", 
       RowBox[{"{", 
        RowBox[{"7.", ",", "7.", ",", "7.", ",", "0"}], "}"}]}], "}"}]}], 
    "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Mean", " ", "magnetic", " ", "field", " ", "of", " ", "the", " ", 
    "dipole", " ", "magnet"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"MagneticFieldExperiment", "[", "#1", "]"}], "=", "#2"}], 
       ")"}], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistlhcb", ",", 
       RowBox[{"{", 
        RowBox[{
         FractionBox["4", 
          RowBox[{"7", "-", "3."}]], ",", 
         FractionBox["4", 
          RowBox[{"7", "-", "3."}]], ",", 
         FractionBox["4", 
          RowBox[{"7", "-", "3."}]], ",", "0"}], "}"}]}], "}"}]}], "]"}], 
   ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"ECAL", " ", "option", " ", 
    RowBox[{"(", 
     RowBox[{"True", ",", "False"}], ")"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"ECALoptionExperiment", "[", "#1", "]"}], "=", "#2"}], ")"}], 
      "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistlhcb", ",", 
       RowBox[{"{", 
        RowBox[{
        "\"\<True\>\"", ",", "\"\<False\>\"", ",", "\"\<False\>\"", ",", 
         "\"\<False\>\""}], "}"}]}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Position", " ", "of", " ", "the", " ", "beginning", " ", "of", " ", "the",
     " ", "ECAL"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"zECALminExperiment", "[", "#1", "]"}], "=", "#2"}], ")"}], 
      "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistlhcb", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{
          "zMaxDecayVolumeExperiment", "[", "\"\<LHCb-downstream-full\>\"", 
           "]"}], "+", "2.5"}], ",", "0", ",", "0", ",", "0"}], "}"}]}], 
      "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"ECAL", " ", "option", " ", 
    RowBox[{"(", 
     RowBox[{"True", ",", "False"}], ")"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"ECALoptionExperiment", "[", "#1", "]"}], "=", "#2"}], ")"}], 
      "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistlhcb", ",", 
       RowBox[{"{", 
        RowBox[{
        "\"\<True\>\"", ",", "\"\<False\>\"", ",", "\"\<False\>\"", ",", 
         "\"\<False\>\""}], "}"}]}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Position", " ", "of", " ", "the", " ", "beginning", " ", "of", " ", "the",
     " ", "ECAL"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"zECALminExperiment", "[", "#1", "]"}], "=", "#2"}], ")"}], 
      "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistlhcb", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{
          "zMaxDecayVolumeExperiment", "[", "\"\<LHCb-downstream-full\>\"", 
           "]"}], "+", "2.5"}], ",", "0", ",", "0", ",", "0"}], "}"}]}], 
      "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "The", " ", "final", " ", "detector", " ", "plane", " ", "needed", " ", 
     "to", " ", "reconstruct", " ", 
     RowBox[{"muons", ".", " ", "Depeding"}], " ", "on", " ", "the", " ", 
     "experiment"}], ",", " ", 
    RowBox[{
    "it", " ", "is", " ", "approximated", " ", "by", " ", "be", " ", "end", 
     " ", "of", " ", "the", " ", "trackers", " ", "or", " ", "the", " ", 
     "muon", " ", "system"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"xLongMuonPlaneExperiment", "[", "#1", "]"}], "=", "#2"}], 
       ")"}], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistlhcb", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
         "xLongMaxDetectorExperiment", "[", "\"\<LHCb-downstream-full\>\"", 
          "]"}], ",", 
         RowBox[{
         "xLongMaxDetectorExperiment", "[", 
          "\"\<LHCb-downstream-T-tracks-only\>\"", "]"}], ",", 
         RowBox[{
         "xLongMaxDetectorExperiment", "[", "\"\<LHCb-downstream\>\"", "]"}], 
         ",", "0"}], "}"}]}], "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "The", " ", "final", " ", "detector", " ", "plane", " ", "needed", " ", 
     "to", " ", "reconstruct", " ", "other", " ", 
     RowBox[{"particles", ".", " ", "Depeding"}], " ", "on", " ", "the", " ", 
     "experiment"}], ",", " ", 
    RowBox[{
    "it", " ", "is", " ", "approximated", " ", "by", " ", "the", " ", "end", 
     " ", "of", " ", "the", " ", "trackers", " ", "or", " ", "the", " ", 
     "calorimeter", " ", "system"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"xLongNonMuonPlaneExperiment", "[", "#1", "]"}], "=", "#2"}], 
       ")"}], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"explistlhcb", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{
          "xLongMaxDetectorExperiment", "[", "\"\<LHCb-downstream-full\>\"", 
           "]"}], "-", "4"}], ",", 
         RowBox[{
         "xLongMaxDetectorExperiment", "[", 
          "\"\<LHCb-downstream-T-tracks-only\>\"", "]"}], ",", 
         RowBox[{
         "xLongMaxDetectorExperiment", "[", "\"\<LHCb-downstream\>\"", "]"}], 
         ",", "0"}], "}"}]}], "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"List", " ", "of", " ", "detectable", " ", 
     RowBox[{"particles", ".", " ", "If"}], " ", "ECAL", " ", "is", " ", 
     "absent"}], ",", " ", 
    RowBox[{
    "it", " ", "is", " ", "assumed", " ", "by", " ", "default", " ", "that", 
     " ", "photons", " ", "and", " ", 
     SubscriptBox[
      SuperscriptBox["K", "0"], "L"], " ", "cannot", " ", "be", " ", 
     "detected"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MapThread", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"DetectablePDGsExperiment", "[", "#1", "]"}], "=", "#2"}], 
      ")"}], "&"}], ",", 
    RowBox[{"{", 
     RowBox[{"explistlhcb", ",", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"{", "detectablepdgs", "}"}], ",", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Select", "[", 
           RowBox[{"detectablepdgs", ",", 
            RowBox[{
             RowBox[{
              RowBox[{"MemberQ", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"22.", ",", "130.", ",", "2112.", ",", 
                  RowBox[{"-", "2112."}]}], "}"}], ",", "#"}], "]"}], "==", 
              "False"}], "&"}]}], "]"}], ",", 
          RowBox[{
           RowBox[{"Length", "[", "explistlhcb", "]"}], "-", "1"}]}], "]"}]}],
        "]"}]}], "}"}]}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.8934862862196527`*^9, 3.893486289106736*^9}, {
   3.8935181370865774`*^9, 3.893518137093587*^9}, 3.8935193128534994`*^9, {
   3.893520022337234*^9, 3.8935200618099947`*^9}, {3.8935201260337315`*^9, 
   3.8935201693402925`*^9}, 3.8935206582428446`*^9, 3.8944385907290096`*^9, {
   3.8945279648695507`*^9, 3.894528116043619*^9}, {3.894530090302577*^9, 
   3.8945300903858476`*^9}, {3.896777459810172*^9, 3.896777545023183*^9}, {
   3.896777592540549*^9, 3.896777655695156*^9}, {3.896777690369502*^9, 
   3.896777704683185*^9}, {3.8969295406859837`*^9, 3.8969295456821117`*^9}, {
   3.8971453069689236`*^9, 3.8971453194225855`*^9}, {3.897145473981164*^9, 
   3.897145486985555*^9}, 3.897463408471329*^9, {3.8975779371543694`*^9, 
   3.8975781829598618`*^9}, {3.8975783700358586`*^9, 3.897578375535004*^9}, {
   3.9049821903504305`*^9, 3.9049823603933244`*^9}, {3.9049828568488345`*^9, 
   3.9049828584838796`*^9}, {3.904983070705011*^9, 3.904983072042908*^9}, {
   3.9050602042250495`*^9, 3.9050602060295653`*^9}, {3.907406615336426*^9, 
   3.9074066245950603`*^9}, 3.9074067819530396`*^9, 3.910240594919752*^9, {
   3.910246973829612*^9, 3.910246973829612*^9}, {3.9102561893595276`*^9, 
   3.9102562103599763`*^9}, {3.910256268721032*^9, 3.910256362352043*^9}, {
   3.9102563996747217`*^9, 3.9102564225815077`*^9}, {3.9102590979095798`*^9, 
   3.9102591124364195`*^9}, {3.9112333573821325`*^9, 3.91123336255478*^9}, {
   3.9112334052348785`*^9, 3.911233411400197*^9}, {3.9112373564539146`*^9, 
   3.9112373576040664`*^9}, {3.9112374975118265`*^9, 3.911237498466973*^9}, {
   3.912057419153448*^9, 3.912057433609163*^9}, {3.9120574644923596`*^9, 
   3.912057556020269*^9}, 3.9124985247532797`*^9, {3.9145650645464735`*^9, 
   3.91456508151847*^9}, {3.9145651522427535`*^9, 3.9145651803445225`*^9}, {
   3.9145669346887007`*^9, 3.914566935100681*^9}, {3.9145670803971243`*^9, 
   3.9145671781613283`*^9}},
 CellLabel->
  "In[893]:=",ExpressionUUID->"fed7d2a6-ecd8-412c-a472-b78f082bed03"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Cross-sections", "Subsubsection",
 CellChangeTimes->{{3.893343612067218*^9, 
  3.893343613688484*^9}},ExpressionUUID->"6ba9881b-9e8c-446d-895b-\
f71c232e2861"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"50", "/", "3000"}], " ", "stays", " ", "for", " ", "lower", " ",
      "luminosity", " ", "of", " ", "running", " ", "time", " ", "of", " ", 
     "LHCb"}], "-", 
    RowBox[{
    "downstream", " ", "compared", " ", "to", " ", "high", " ", "lumi"}]}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"MapThread", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"NPOTexperiment", "[", "#1", "]"}], "=", "#2"}], ")"}], 
       "&"}], ",", 
      RowBox[{"{", 
       RowBox[{"explistlhcb", ",", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"300", "/", "3000"}], ")"}], "*", "LLHChighLumi", "*", 
           RowBox[{"\[Sigma]ppInpbFacility", "[", "\"\<LHC\>\"", "]"}]}], ",", 
          RowBox[{"Length", "[", "explistlhcb", "]"}]}], "]"}]}], "}"}]}], 
     "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MapThread", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"AtargetExperiment", "[", "#1", "]"}], "=", "#2"}], ")"}], 
       "&"}], ",", 
      RowBox[{"{", 
       RowBox[{"explistlhcb", ",", 
        RowBox[{"Table", "[", 
         RowBox[{"1.", ",", 
          RowBox[{"Length", "[", "explistlhcb", "]"}]}], "]"}]}], "}"}]}], 
     "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Cascade", " ", "enhancement", " ", "of", " ", "the", " ", "production", 
     " ", "relative", " ", "to", " ", "the", " ", "production", " ", "in", 
     " ", "pure", " ", "pp", " ", 
     RowBox[{"collisions", ".", " ", "Relevant"}], " ", "for", " ", "fixed", 
     " ", "target", " ", "experiments"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "For", " ", "all", " ", "experiments", " ", "located", " ", "at", " ", 
      "SPS"}], ",", " ", 
     RowBox[{
      RowBox[{
       RowBox[{
       "the", " ", "cascade", " ", "lhcbtors", " ", "is", " ", "taken", " ", 
        "from", " ", 
        RowBox[{"http", ":"}]}], "//", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"cds", ".", "cern", ".", "ch"}], "/", "record"}], "/", 
           "2115534"}], "/", "files"}], "/", "SHiP"}], "-", "NOTE", "-", 
        "2015", "-", 
        RowBox[{"009.", 
         RowBox[{"pdf", "?", "version"}]}]}]}], "=", "1"}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MapThread", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"CascadeFactorbb", "[", "#1", "]"}], "=", "#2"}], ")"}], 
       "&"}], ",", 
      RowBox[{"{", 
       RowBox[{"explistlhcb", ",", 
        RowBox[{"Table", "[", 
         RowBox[{"1.", ",", 
          RowBox[{"Length", "[", "explistlhcb", "]"}]}], "]"}]}], "}"}]}], 
     "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Fraction", " ", "of", " ", "produced", " ", "bb", " ", "per", " ", "PoT",
      " ", "at", " ", "the", " ", "given", " ", "experiment"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"PppTobbExperiment", "[", "exp", "]"}], "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"\[Sigma]ppTobbInpbFacility", "[", 
          RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}], "/", 
         RowBox[{"\[Sigma]ppInpbFacility", "[", 
          RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}]}], ")"}], 
       SuperscriptBox[
        RowBox[{"AtargetExperiment", "[", "exp", "]"}], "0.29"], "*", 
       RowBox[{"CascadeFactorbb", "[", "exp", "]"}]}]}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistlhcb"}], "}"}]}], "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MapThread", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"CascadeFactorcc", "[", "#1", "]"}], "=", "#2"}], ")"}], 
       "&"}], ",", 
      RowBox[{"{", 
       RowBox[{"explistlhcb", ",", 
        RowBox[{"Table", "[", 
         RowBox[{"1.", ",", 
          RowBox[{"Length", "[", "explistlhcb", "]"}]}], "]"}]}], "}"}]}], 
     "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Fraction", " ", "of", " ", "produced", " ", "cc", " ", "per", " ", "PoT",
      " ", "at", " ", "the", " ", "given", " ", "experiment"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"PppToccExperiment", "[", "exp", "]"}], "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"\[Sigma]ppToccInpbFacility", "[", 
          RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}], "/", 
         RowBox[{"\[Sigma]ppInpbFacility", "[", 
          RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}]}], ")"}], 
       SuperscriptBox[
        RowBox[{"AtargetExperiment", "[", "exp", "]"}], "0.29"], "*", 
       RowBox[{"CascadeFactorcc", "[", "exp", "]"}]}]}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistlhcb"}], "}"}]}], "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Fraction", " ", "of", " ", "produced", " ", "h", " ", "per", " ", "PoT", 
     " ", "at", " ", "the", " ", "given", " ", "experiment"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"PppTohExperiment", "[", "exp", "]"}], "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\[Sigma]ppTohInpbFacility", "[", 
           RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}], "/", 
          RowBox[{"\[Sigma]ppInpbFacility", "[", 
           RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}]}], ")"}], 
        SuperscriptBox[
         RowBox[{"AtargetExperiment", "[", "exp", "]"}], "0.29"]}]}], ",", 
      RowBox[{"{", 
       RowBox[{"exp", ",", "explistlhcb"}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Fraction", " ", "of", " ", "produced", " ", "W", " ", "per", " ", "PoT", 
     " ", "at", " ", "the", " ", "given", " ", "experiment"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"PppToWExperiment", "[", "exp", "]"}], "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\[Sigma]ppToWInpbFacility", "[", 
           RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}], "/", 
          RowBox[{"\[Sigma]ppInpbFacility", "[", 
           RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}]}], ")"}], 
        SuperscriptBox[
         RowBox[{"AtargetExperiment", "[", "exp", "]"}], "0.29"]}]}], ",", 
      RowBox[{"{", 
       RowBox[{"exp", ",", "explistlhcb"}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Fraction", " ", "of", " ", "produced", " ", 
     SuperscriptBox["\[Pi]", "0"], " ", "per", " ", "PoT", " ", "at", " ", 
     "the", " ", "given", " ", "experiment"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"PppTo\[Pi]0exp", "[", "exp", "]"}], "=", 
       RowBox[{"PppTo\[Pi]0Facility", "[", 
        RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"exp", ",", "explistlhcb"}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Fraction", " ", "of", " ", "produced", " ", "\[Eta]", " ", "per", " ", 
     "PoT", " ", "at", " ", "the", " ", "given", " ", "experiment"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"PppTo\[Eta]exp", "[", "exp", "]"}], "=", 
       RowBox[{"PppTo\[Eta]Facility", "[", 
        RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"exp", ",", "explistlhcb"}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Fraction", " ", "of", " ", "produced", " ", 
     RowBox[{"\[Eta]", "'"}], " ", "per", " ", "PoT", " ", "at", " ", "the", 
     " ", "given", " ", "experiment"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"PppTo\[Eta]prexp", "[", "exp", "]"}], "=", 
       RowBox[{"PppTo\[Eta]prFacility", "[", 
        RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"exp", ",", "explistlhcb"}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Fraction", " ", "of", " ", "produced", " ", 
     SuperscriptBox["\[Rho]", "0"], " ", "per", " ", "PoT", " ", "at", " ", 
     "the", " ", "given", " ", "experiment"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"PppTo\[Rho]0exp", "[", "exp", "]"}], "=", 
       RowBox[{"PppTo\[Rho]0Facility", "[", 
        RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"exp", ",", "explistlhcb"}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Fraction", " ", "of", " ", "produced", " ", "\[Omega]", " ", "per", " ", 
     "PoT", " ", "at", " ", "the", " ", "given", " ", "experiment"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"PppTo\[Omega]exp", "[", "exp", "]"}], "=", 
       RowBox[{"PppTo\[Omega]Facility", "[", 
        RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"exp", ",", "explistlhcb"}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"PppToJpsiexp", "[", "exp", "]"}], "=", 
       RowBox[{
        RowBox[{"PppToJpsiFacility", "[", 
         RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}], 
        SuperscriptBox[
         RowBox[{"AtargetExperiment", "[", "exp", "]"}], "0.29"]}]}], ",", 
      RowBox[{"{", 
       RowBox[{"exp", ",", "explistlhcb"}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Fraction", " ", "of", " ", "produced", " ", "\[CapitalUpsilon]", 
     RowBox[{"(", 
      RowBox[{"1", "s"}], ")"}], " ", "per", " ", "PoT", " ", "at", " ", 
     "the", " ", "given", " ", "experiment"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"PppToUpsilonexp", "[", "exp", "]"}], "=", 
       RowBox[{
        RowBox[{"PppToUpsilonFacility", "[", 
         RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}], 
        SuperscriptBox[
         RowBox[{"AtargetExperiment", "[", "exp", "]"}], "0.29"]}]}], ",", 
      RowBox[{"{", 
       RowBox[{"exp", ",", "explistlhcb"}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Fraction", " ", "of", " ", "produced", " ", "\[Phi]", " ", "at", " ", 
     "the", " ", "given", " ", "experiment"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"PppToPhiexp", "[", "exp", "]"}], "=", 
       RowBox[{"PppToPhiFacility", "[", 
        RowBox[{"FacilityExperiment", "[", "exp", "]"}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"exp", ",", "explistlhcb"}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Overall", " ", "table", " ", "with", " ", "cross"}], "-", 
     RowBox[{"sections", " ", "used", " ", "for", " ", "exporting"}]}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"TableNumbersParticlesExperiment", "[", "exp", "]"}], "=", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "\"\<Facility\>\"", ",", "\"\<Npot\>\"", ",", "\"\<Atarget\>\"", 
           ",", "\"\<PPi0\>\"", ",", "\"\<PEta\>\"", ",", "\"\<PEtapr\>\"", 
           ",", "\"\<PRho0\>\"", ",", "\"\<POmega\>\"", ",", "\"\<Pc\>\"", 
           ",", "\"\<Pb\>\"", ",", "\"\<PW\>\"", ",", "\"\<Ph\>\"", ",", 
           "\"\<PJpsi\>\"", ",", "\"\<PUpsilon\>\"", ",", "\"\<PPhi\>\""}], 
          "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"FacilityExperiment", "[", "exp", "]"}], ",", 
           RowBox[{"NPOTexperiment", "[", "exp", "]"}], ",", 
           RowBox[{"AtargetExperiment", "[", "exp", "]"}], ",", 
           RowBox[{"PppTo\[Pi]0exp", "[", "exp", "]"}], ",", 
           RowBox[{"PppTo\[Eta]exp", "[", "exp", "]"}], ",", 
           RowBox[{"PppTo\[Eta]prexp", "[", "exp", "]"}], ",", 
           RowBox[{"PppTo\[Rho]0exp", "[", "exp", "]"}], ",", 
           RowBox[{"PppTo\[Omega]exp", "[", "exp", "]"}], ",", 
           RowBox[{"2", 
            RowBox[{"PppToccExperiment", "[", "exp", "]"}]}], ",", 
           RowBox[{"2", 
            RowBox[{"PppTobbExperiment", "[", "exp", "]"}]}], ",", 
           RowBox[{"PppToWExperiment", "[", "exp", "]"}], ",", 
           RowBox[{"PppTohExperiment", "[", "exp", "]"}], ",", 
           RowBox[{"PppToJpsiexp", "[", "exp", "]"}], ",", 
           RowBox[{"PppToUpsilonexp", "[", "exp", "]"}], ",", 
           RowBox[{"PppToPhiexp", "[", "exp", "]"}]}], "}"}]}], "}"}], "//", 
       "N"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "explistlhcb"}], "}"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.8941782687253485`*^9, 3.894178270999832*^9}, {
   3.8941787455716057`*^9, 3.89417874773307*^9}, {3.897235874177376*^9, 
   3.89723588814003*^9}, {3.897286250492156*^9, 3.8972862572084875`*^9}, 
   3.8991964505229397`*^9, {3.8991971161649218`*^9, 3.899197143379329*^9}, {
   3.9074065837385764`*^9, 3.907406584166896*^9}, 3.9074067819590425`*^9},
 CellLabel->
  "In[930]:=",ExpressionUUID->"bba84095-db6b-474a-9e5d-5089c05c837e"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Conditions for the LLP to decay inside the decay volume and for the products \
to point to the end of the detector\
\>", "Subsubsection",
 CellChangeTimes->{{3.905011297554874*^9, 3.9050113192993593`*^9}, 
   3.915437209735851*^9},ExpressionUUID->"138ae7da-1298-41a4-bd0a-\
1e7f9255fb54"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "For", " ", "the", " ", "configurations", " ", "where", " ", "the", " ", 
    "detector", " ", "is", " ", "SciFi", " ", "layer"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Do", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"x1minDet", "[", "z_", "]"}], "=", 
       RowBox[{
        RowBox[{"xToDetectorCenterExperiment", "[", "exp", "]"}], "-", 
        RowBox[{
         RowBox[{"dxDetectorExperiment", "[", 
          RowBox[{"exp", ",", "z"}], "]"}], "/", "2"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"x1maxDet", "[", "z_", "]"}], "=", 
       RowBox[{
        RowBox[{"xToDetectorCenterExperiment", "[", "exp", "]"}], "+", 
        RowBox[{
         RowBox[{"dxDetectorExperiment", "[", 
          RowBox[{"exp", ",", "z"}], "]"}], "/", "2"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"x2minDet", "[", "z_", "]"}], "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"DetectorPlaneOrientationExperiment", "[", "exp", "]"}], 
          "\[Equal]", "\"\<Transverse\>\""}], ",", 
         RowBox[{
          RowBox[{"yToDetectorCenterExperiment", "[", "exp", "]"}], "-", 
          RowBox[{
           RowBox[{"dyDetectorExperiment", "[", 
            RowBox[{"exp", ",", "z"}], "]"}], "/", "2"}]}], ",", 
         RowBox[{
          RowBox[{"zToDetectorCenterExperiment", "[", "exp", "]"}], "-", 
          RowBox[{
           RowBox[{"dzDetectorExperiment", "[", "exp", "]"}], "/", "2"}]}]}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"x2maxDet", "[", "z_", "]"}], "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"DetectorPlaneOrientationExperiment", "[", "exp", "]"}], 
          "\[Equal]", "\"\<Transverse\>\""}], ",", 
         RowBox[{
          RowBox[{"yToDetectorCenterExperiment", "[", "exp", "]"}], "+", 
          RowBox[{
           RowBox[{"dyDetectorExperiment", "[", 
            RowBox[{"exp", ",", "z"}], "]"}], "/", "2"}]}], ",", 
         RowBox[{
          RowBox[{"zToDetectorCenterExperiment", "[", "exp", "]"}], "+", 
          RowBox[{
           RowBox[{"dzDetectorExperiment", "[", "exp", "]"}], "/", "2"}]}]}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"x2toDetCenter", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"DetectorPlaneOrientationExperiment", "[", "exp", "]"}], 
          "==", "\"\<Transverse\>\""}], ",", " ", 
         RowBox[{"yToDetectorCenterExperiment", "[", "exp", "]"}], ",", 
         RowBox[{"zToDetectorCenterExperiment", "[", "exp", "]"}]}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"IfLLPinsideDecVol", "[", 
        RowBox[{"zLLP_", ",", "xLLP_", ",", "yLLP_", ",", "exp"}], "]"}], "=", 
       RowBox[{"IfLLPinsideDecVolSimple", "[", "exp", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"IfLLPtoDet", "[", 
        RowBox[{
        "x1LLPproj_", ",", "x2LLPproj_", ",", "xLongProj_", ",", "exp"}], 
        "]"}], "=", 
       RowBox[{
        RowBox[{"Boole", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"x1minDet", "[", "xLongProj", "]"}], "<", "x1LLPproj", "<", 
           RowBox[{"x1maxDet", "[", "xLongProj", "]"}]}], "&&", 
          RowBox[{
           RowBox[{"x2minDet", "[", "xLongProj", "]"}], "<", "x2LLPproj", "<", 
           RowBox[{"x2maxDet", "[", "xLongProj", "]"}]}], "&&", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"RinnerDetectorExperiment", "[", 
             RowBox[{"exp", ",", "xLongProj"}], "]"}], "2"], "<", 
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{"xToDetectorCenterExperiment", "[", "exp", "]"}], "-", 
               "x1LLPproj"}], ")"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"x2toDetCenter", "-", "x2LLPproj"}], ")"}], "2"]}]}]}], 
         "]"}], "//", "Simplify"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"IfLLPnotToDet", "[", 
        RowBox[{
        "x1LLPproj_", ",", "x2LLPproj_", ",", "xLongProj_", ",", "exp"}], 
        "]"}], "=", 
       RowBox[{
        RowBox[{"Boole", "[", 
         RowBox[{"!", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"x1minDet", "[", "xLongProj", "]"}], "<", "x1LLPproj", 
             "<", 
             RowBox[{"x1maxDet", "[", "xLongProj", "]"}]}], "&&", 
            RowBox[{
             RowBox[{"x2minDet", "[", "xLongProj", "]"}], "<", "x2LLPproj", 
             "<", 
             RowBox[{"x2maxDet", "[", "xLongProj", "]"}]}], "&&", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"RinnerDetectorExperiment", "[", 
               RowBox[{"exp", ",", "xLongProj"}], "]"}], "2"], "<", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"xToDetectorCenterExperiment", "[", "exp", "]"}], 
                 "-", "x1LLPproj"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x2toDetCenter", "-", "x2LLPproj"}], ")"}], 
               "2"]}]}]}], ")"}]}], "]"}], "//", "Simplify"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"IfLLPdecVolToDet", "[", 
        RowBox[{
        "zLLP_", ",", "xLLP_", ",", "yLLP_", ",", "x1LLPproj_", ",", 
         "x2LLPproj_", ",", "xLongProj_", ",", "exp"}], "]"}], "=", 
       RowBox[{
        RowBox[{"IfLLPinsideDecVol", "[", 
         RowBox[{"zLLP", ",", "xLLP", ",", "yLLP", ",", "exp"}], "]"}], "*", 
        RowBox[{"IfLLPtoDet", "[", 
         RowBox[{
         "x1LLPproj", ",", "x2LLPproj", ",", "xLongProj", ",", "exp"}], 
         "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"IfLLPdecVolNotToDet", "[", 
        RowBox[{
        "zLLP_", ",", "xLLP_", ",", "yLLP_", ",", "x1LLPproj_", ",", 
         "x2LLPproj_", ",", "xLongProj_", ",", "exp"}], "]"}], "=", 
       RowBox[{
        RowBox[{"IfLLPinsideDecVol", "[", 
         RowBox[{"zLLP", ",", "xLLP", ",", "yLLP", ",", "exp"}], "]"}], "*", 
        RowBox[{"IfLLPnotToDet", "[", 
         RowBox[{
         "x1LLPproj", ",", "x2LLPproj", ",", "xLongProj", ",", "exp"}], 
         "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"DecayAcceptanceGeometry", "[", 
        RowBox[{"coord1_", ",", "coord2_", ",", "xLongProj_", ",", "exp"}], 
        "]"}], "=", 
       RowBox[{"IfLLPtoDet", "[", 
        RowBox[{"coord1", ",", "coord2", ",", "xLongProj", ",", "exp"}], 
        "]"}]}], ";"}], "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", 
       RowBox[{"Drop", "[", 
        RowBox[{
         RowBox[{"Drop", "[", 
          RowBox[{"explistlhcb", ",", "1"}], "]"}], ",", 
         RowBox[{"-", "1"}]}], "]"}]}], "}"}]}], "]"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"For", " ", "the", " ", "muon", " ", "chambers"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Do", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"XminDecVol", "[", "zLLP_", "]"}], "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"Evaluate", "[", 
          RowBox[{"Boxcylpar", "[", "exp", "]"}], "]"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"xToDecayVolumeCenterExperiment", "[", 
            RowBox[{"zLLP", ",", "exp"}], "]"}], "-", 
           RowBox[{
            RowBox[{"dxDecayVolumeExperiment", "[", 
             RowBox[{"zLLP", ",", "exp"}], "]"}], "/", "2"}]}], "//", 
          "Simplify"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"XmaxDecVol", "[", "zLLP_", "]"}], "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"Evaluate", "[", 
          RowBox[{"Boxcylpar", "[", "exp", "]"}], "]"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"xToDecayVolumeCenterExperiment", "[", 
            RowBox[{"zLLP", ",", "exp"}], "]"}], "+", 
           RowBox[{
            RowBox[{"dxDecayVolumeExperiment", "[", 
             RowBox[{"zLLP", ",", "exp"}], "]"}], "/", "2"}]}], "//", 
          "Simplify"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"YminDecVol", "[", "zLLP_", "]"}], "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"Evaluate", "[", 
          RowBox[{"Boxcylpar", "[", "exp", "]"}], "]"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"yToDecayVolumeCenterExperiment", "[", 
            RowBox[{"zLLP", ",", "exp"}], "]"}], "-", 
           RowBox[{
            RowBox[{"dyDecayVolumeExperiment", "[", 
             RowBox[{"zLLP", ",", "exp"}], "]"}], "/", "2"}]}], "//", 
          "Simplify"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"YmaxDecVol", "[", "zLLP_", "]"}], "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"Evaluate", "[", 
          RowBox[{"Boxcylpar", "[", "exp", "]"}], "]"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"yToDecayVolumeCenterExperiment", "[", 
            RowBox[{"zLLP", ",", "exp"}], "]"}], "+", 
           RowBox[{
            RowBox[{"dyDecayVolumeExperiment", "[", 
             RowBox[{"zLLP", ",", "exp"}], "]"}], "/", "2"}]}], "//", 
          "Simplify"}]}], "]"}]}], ";", 
      RowBox[{
       RowBox[{"IfLLPinsideDecVol", "[", 
        RowBox[{"zLLP_", ",", "xLLP_", ",", "yLLP_", ",", "exp"}], "]"}], "=", 
       RowBox[{"Boole", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"XminDecVol", "[", "zLLP", "]"}], "<", "xLLP", "<", 
          RowBox[{"XmaxDecVol", "[", "zLLP", "]"}]}], "&&", 
         RowBox[{
          RowBox[{"YminDecVol", "[", "zLLP", "]"}], "<", "yLLP", "<", 
          RowBox[{"YmaxDecVol", "[", "zLLP", "]"}]}], "&&", 
         RowBox[{"!", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "0.03"}], "<", "xLLP", "<", "0.03"}], ")"}]}], "&&", 
         RowBox[{"!", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "0.025"}], "<", "yLLP", "<", "0.025"}], ")"}]}]}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"IfLLPtoDet", "[", 
          RowBox[{
          "x1LLPproj_", ",", "x2LLPproj_", ",", "xLongProj_", ",", "exp"}], 
          "]"}], ",", 
         RowBox[{"IfLLPnotToDet", "[", 
          RowBox[{
          "x1LLPproj_", ",", "x2LLPproj_", ",", "xLongProj_", ",", "exp"}], 
          "]"}]}], "}"}], "=", 
       RowBox[{"IfParticlePointsToDetSimple", "[", "exp", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"IfLLPdecVolToDet", "[", 
        RowBox[{
        "zLLP_", ",", "x1LLP_", ",", "x2LLP_", ",", "x1LLPproj_", ",", 
         "x2LLPproj_", ",", "exp"}], "]"}], "=", 
       RowBox[{
        RowBox[{"IfLLPinsideDecVol", "[", 
         RowBox[{"zLLP", ",", "x1LLP", ",", "x2LLP", ",", "exp"}], "]"}], "*", 
        RowBox[{"IfLLPtoDet", "[", 
         RowBox[{
         "x1LLPproj", ",", "x2LLPproj", ",", "xLongProj", ",", "exp"}], 
         "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"IfLLPdecVolNotToDet", "[", 
        RowBox[{
        "zLLP_", ",", "x1LLP_", ",", "x2LLP_", ",", "x1LLPproj_", ",", 
         "x2LLPproj_", ",", "exp"}], "]"}], "=", 
       RowBox[{
        RowBox[{"IfLLPinsideDecVol", "[", 
         RowBox[{"zLLP", ",", "x1LLP", ",", "x2LLP", ",", "exp"}], "]"}], "*", 
        RowBox[{"IfLLPnotToDet", "[", 
         RowBox[{
         "x1LLPproj", ",", "x2LLPproj", ",", "xLongProj", ",", "exp"}], 
         "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"DecayAcceptanceGeometry", "[", 
        RowBox[{"coord1_", ",", "coord2_", ",", "xLongProj_", ",", "exp"}], 
        "]"}], "=", 
       RowBox[{"IfLLPtoDet", "[", 
        RowBox[{"coord1", ",", "coord2", ",", "xLongProj", ",", "exp"}], 
        "]"}]}], ";"}], "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", 
       RowBox[{"Select", "[", 
        RowBox[{"explistlhcb", ",", 
         RowBox[{
          RowBox[{"StringContainsQ", "[", 
           RowBox[{"#", ",", "\"\<muon-chamber\>\""}], "]"}], "&"}]}], 
        "]"}]}], "}"}]}], "]"}], "\[IndentingNewLine]", 
   RowBox[{"Do", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"IfLLPinsideDecVol", "[", 
        RowBox[{"zLLP_", ",", "xLLP_", ",", "yLLP_", ",", "exp"}], "]"}], "=", 
       RowBox[{"IfLLPinsideDecVolSimple", "[", "exp", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"IfLLPtoDet", "[", 
          RowBox[{
          "x1LLPproj_", ",", "x2LLPproj_", ",", "xLongProj_", ",", "exp"}], 
          "]"}], ",", 
         RowBox[{"IfLLPnotToDet", "[", 
          RowBox[{
          "x1LLPproj_", ",", "x2LLPproj_", ",", "xLongProj_", ",", "exp"}], 
          "]"}]}], "}"}], "=", 
       RowBox[{"IfParticlePointsToDetSimple", "[", "exp", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"IfLLPdecVolToDet", "[", 
        RowBox[{
        "zLLP_", ",", "xLLP_", ",", "yLLP_", ",", "x1LLPproj_", ",", 
         "x2LLPproj_", ",", "xLongProj_", ",", "exp"}], "]"}], "=", 
       RowBox[{
        RowBox[{"IfLLPinsideDecVol", "[", 
         RowBox[{"zLLP", ",", "xLLP", ",", "yLLP", ",", "exp"}], "]"}], "*", 
        RowBox[{"IfLLPtoDet", "[", 
         RowBox[{
         "x1LLPproj", ",", "x2LLPproj", ",", "xLongProj", ",", "exp"}], 
         "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"IfLLPdecVolNotToDet", "[", 
        RowBox[{
        "zLLP_", ",", "xLLP_", ",", "yLLP_", ",", "x1LLPproj_", ",", 
         "x2LLPproj_", ",", "xLongProj_", ",", "exp"}], "]"}], "=", 
       RowBox[{
        RowBox[{"IfLLPinsideDecVol", "[", 
         RowBox[{"zLLP", ",", "xLLP", ",", "yLLP", ",", "exp"}], "]"}], "*", 
        RowBox[{"IfLLPnotToDet", "[", 
         RowBox[{
         "x1LLPproj", ",", "x2LLPproj", ",", "xLongProj", ",", "exp"}], 
         "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"DecayAcceptanceGeometry", "[", 
        RowBox[{"coord1_", ",", "coord2_", ",", "xLongProj_", ",", "exp"}], 
        "]"}], "=", 
       RowBox[{"IfLLPtoDet", "[", 
        RowBox[{"coord1", ",", "coord2", ",", "xLongProj", ",", "exp"}], 
        "]"}]}], ";"}], "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", 
       RowBox[{"{", "\"\<LHCb-downstream-full\>\"", "}"}]}], "}"}]}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGCQAGIQzSsaedFC4q2j0KpYMM2QU3EfRHNYnngNojfN8P0A
og3mZ38G0Q5Mk36B6GNpqf9B9AKFMFZLIM11+ggXiGaZ0s4Houu0rvCDaO+L
YSIg+t+bH9IgOmGatgKI5u03AtNSSvzaIPrYjYtgesGEHCMQfesYmymIjuVl
3AWik5e2HQDRE7b+XW4FpPdJ/gPTHQ8fh/gD6XKh+lgQ7SF9c3ECkJ7Su2Yp
iK6483s1iJZyDVwDolmzXm0C0fuObtoPone83Fd+Uuat41Su/WC6L//SR0ul
t46rt8r/AtFOewIFrID0Of0gMD3vr5EZiN5gp+MBoi9v+j4bRLM9gdABexec
LdB661hdancBRO+48bxSSuetY7FyUQuIllaymAyivRR8wTQA4K+qzQ==
  "],
 CellLabel->
  "In[947]:=",ExpressionUUID->"e12cb55a-0893-4717-868d-0b7a9ced8fff"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Full geometry of the decay volume (needed for visualization+determining \
angular coverage)\
\>", "Section",
 CellChangeTimes->{{3.8850100889942837`*^9, 3.885010112066317*^9}, 
   3.886221244004035*^9, {3.89348637224743*^9, 3.8934863736313033`*^9}, {
   3.9102470209095063`*^9, 3.910247021338585*^9}, {3.9117253466266513`*^9, 
   3.911725346955736*^9}},ExpressionUUID->"f06ff148-ae6b-40aa-ae2c-\
5c35eb0a588f"],

Cell[CellGroupData[{

Cell["Standard decay volumes: box, cylinder, annular cylinder", "Subsection",
 CellChangeTimes->{{3.8862196644680767`*^9, 3.8862196848335905`*^9}, {
  3.8862197859666033`*^9, 
  3.886219788223649*^9}},ExpressionUUID->"706e1c55-511c-4f9f-bc0b-\
e5a7b0c22593"],

Cell[CellGroupData[{

Cell["Box", "Subsubsection",
 CellChangeTimes->{{3.886219879483339*^9, 
  3.886219879711282*^9}},ExpressionUUID->"aed572f9-f229-4a10-aee5-\
31e70c06f455"],

Cell[BoxData[
 RowBox[{
  RowBox[{"StandardShapeDecayVolume", "[", 
   RowBox[{"experiment_", ",", "\"\<Box\>\""}], "]"}], ":=", 
  RowBox[{"Parallelepiped", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"xToDecayVolumeCenterExperiment", "[", 
        RowBox[{"z", ",", "experiment"}], "]"}], "-", 
       RowBox[{
        RowBox[{"dxDecayVolumeExperiment", "[", 
         RowBox[{"z", ",", "experiment"}], "]"}], "/", "2"}]}], ",", 
      RowBox[{
       RowBox[{"yToDecayVolumeCenterExperiment", "[", 
        RowBox[{"z", ",", "experiment"}], "]"}], "-", 
       RowBox[{
        RowBox[{"dyDecayVolumeExperiment", "[", 
         RowBox[{"z", ",", "experiment"}], "]"}], "/", "2"}]}], ",", 
      RowBox[{"zToDecayVolumeExperiment", "[", "experiment", "]"}]}], "}"}], 
    ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"dxDecayVolumeExperiment", "[", 
         RowBox[{"z", ",", "experiment"}], "]"}], ",", "0", ",", "0"}], "}"}],
       ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", 
        RowBox[{"dyDecayVolumeExperiment", "[", 
         RowBox[{"z", ",", "experiment"}], "]"}], ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", 
        RowBox[{"dzDecayVolumeExperiment", "[", "experiment", "]"}]}], 
       "}"}]}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.8862198973470564`*^9, 3.8862199815024414`*^9}, {
   3.886220815824093*^9, 3.8862208172706413`*^9}, {3.886226164391658*^9, 
   3.8862261755169096`*^9}, 3.886324160719892*^9, {3.8916765317308164`*^9, 
   3.8916765360364947`*^9}, {3.891677880049505*^9, 3.891677944119571*^9}, 
   3.8935181370975766`*^9, {3.8971453816942463`*^9, 3.897145389512158*^9}, {
   3.8971454438285236`*^9, 3.897145449160597*^9}},
 CellLabel->
  "In[1012]:=",ExpressionUUID->"410aa567-b6a0-478d-b333-d7c152c75bf9"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Cylinder", "Subsubsection",
 CellChangeTimes->{{3.8862198715880566`*^9, 
  3.886219872640651*^9}},ExpressionUUID->"530ddf66-bf6d-4571-8f51-\
2c65fd646ca6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"StandardShapeDecayVolume", "[", 
   RowBox[{"experiment_", ",", "\"\<Cylinder\>\""}], "]"}], ":=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"DetectorPlaneOrientationExperiment", "[", "experiment", "]"}], 
     "\[Equal]", "\"\<Transverse\>\""}], ",", 
    RowBox[{"Cylinder", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"xToDecayVolumeCenterExperiment", "[", 
           RowBox[{"z", ",", "experiment"}], "]"}], ",", 
          RowBox[{"yToDecayVolumeCenterExperiment", "[", 
           RowBox[{"z", ",", "experiment"}], "]"}], ",", 
          RowBox[{"zToDecayVolumeExperiment", "[", "experiment", "]"}]}], 
         "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"xToDecayVolumeCenterExperiment", "[", 
           RowBox[{"z", ",", "experiment"}], "]"}], ",", 
          RowBox[{"yToDecayVolumeCenterExperiment", "[", 
           RowBox[{"z", ",", "experiment"}], "]"}], ",", 
          RowBox[{"zMaxDecayVolumeExperiment", "[", "experiment", "]"}]}], 
         "}"}]}], "}"}], ",", 
      RowBox[{"RouterDecayVolumeExperiment", "[", 
       RowBox[{"experiment", ",", "z"}], "]"}]}], "]"}], ",", 
    RowBox[{"Cylinder", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"xToDecayVolumeCenterExperiment", "[", 
           RowBox[{"z", ",", "experiment"}], "]"}], ",", 
          RowBox[{
           RowBox[{"yToDecayVolumeCenterExperiment", "[", 
            RowBox[{"z", ",", "experiment"}], "]"}], "-", 
           RowBox[{
            RowBox[{"dyDecayVolumeExperiment", "[", 
             RowBox[{"z", ",", "experiment"}], "]"}], "/", "2"}]}], ",", 
          RowBox[{
           RowBox[{"zToDecayVolumeExperiment", "[", "experiment", "]"}], "+", 
           RowBox[{
            RowBox[{"dzDecayVolumeExperiment", "[", "experiment", "]"}], "/", 
            "2"}]}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"xToDecayVolumeCenterExperiment", "[", 
           RowBox[{"z", ",", "experiment"}], "]"}], ",", 
          RowBox[{
           RowBox[{"yToDecayVolumeCenterExperiment", "[", 
            RowBox[{"z", ",", "experiment"}], "]"}], "+", 
           RowBox[{
            RowBox[{"dyDecayVolumeExperiment", "[", 
             RowBox[{"z", ",", "experiment"}], "]"}], "/", "2"}]}], ",", 
          RowBox[{
           RowBox[{"zToDecayVolumeExperiment", "[", "experiment", "]"}], "+", 
           RowBox[{
            RowBox[{"dzDecayVolumeExperiment", "[", "experiment", "]"}], "/", 
            "2"}]}]}], "}"}]}], "}"}], ",", 
      RowBox[{"RouterDecayVolumeExperiment", "[", 
       RowBox[{"experiment", ",", "z"}], "]"}]}], "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.886219993277174*^9, 3.88622000226497*^9}, {
   3.886220182142823*^9, 3.8862201823544025`*^9}, {3.8862202567231493`*^9, 
   3.8862202931969066`*^9}, 3.8862261111759896`*^9, {3.8862261643975925`*^9, 
   3.8862261644051185`*^9}, 3.886324160723879*^9, {3.891677880049505*^9, 
   3.891677944135148*^9}, {3.891850987455868*^9, 3.8918510116327915`*^9}, {
   3.891851206107811*^9, 3.8918512251363344`*^9}, {3.89185134268355*^9, 
   3.891851344219037*^9}, {3.8918521432091103`*^9, 3.891852151510389*^9}, 
   3.8933405908870745`*^9, {3.8935181371015673`*^9, 3.893518137103561*^9}, {
   3.8971453992937145`*^9, 3.8971454125799932`*^9}, {3.89714544383668*^9, 
   3.8971454491743937`*^9}},
 CellLabel->
  "In[1013]:=",ExpressionUUID->"17963a85-032e-4762-b207-ea5afb4518e1"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Annular cylinder", "Subsubsection",
 CellChangeTimes->{{3.8862198572302313`*^9, 
  3.8862198660903006`*^9}},ExpressionUUID->"9f3eef4a-6429-4142-935a-\
e0bae9d3b45e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"z\[Theta]ConicalFrustum", "[", 
   RowBox[{"z1_", ",", "z2_", ",", "\[Theta]_"}], "]"}], ":=", 
  RowBox[{"ConvexHullMesh", "[", 
   RowBox[{"Join", "@@", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{"Append", "[", "#", "]"}], ",", 
         RowBox[{"CirclePoints", "[", 
          RowBox[{
           RowBox[{"#", " ", 
            RowBox[{"Tan", "[", "\[Theta]", "]"}]}], ",", "100"}], "]"}]}], 
        "]"}], "&"}], "/@", 
      RowBox[{"{", 
       RowBox[{"z1", ",", "z2"}], "}"}]}], ")"}]}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{"StandardShapeDecayVolume", "[", 
   RowBox[{"experiment_", ",", "\"\<Annular cylinder\>\""}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\n", 
    RowBox[{
     RowBox[{"foutAnnular", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
         "DetectorPlaneOrientationExperiment", "[", "experiment", "]"}], 
         "\[Equal]", "\"\<Transverse\>\""}], ",", 
        RowBox[{"Cylinder", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"xToDecayVolumeCenterExperiment", "[", 
               RowBox[{"z", ",", "experiment"}], "]"}], ",", 
              RowBox[{"yToDecayVolumeCenterExperiment", "[", 
               RowBox[{"z", ",", "experiment"}], "]"}], ",", 
              RowBox[{"zToDecayVolumeExperiment", "[", "experiment", "]"}]}], 
             "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"xToDecayVolumeCenterExperiment", "[", 
               RowBox[{"z", ",", "experiment"}], "]"}], ",", 
              RowBox[{"yToDecayVolumeCenterExperiment", "[", 
               RowBox[{"z", ",", "experiment"}], "]"}], ",", 
              RowBox[{"zMaxDecayVolumeExperiment", "[", "experiment", "]"}]}],
              "}"}]}], "}"}], ",", 
          RowBox[{"RouterDecayVolumeExperiment", "[", 
           RowBox[{"experiment", ",", "z"}], "]"}]}], "]"}], ",", 
        RowBox[{"Cylinder", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"xToDecayVolumeCenterExperiment", "[", 
               RowBox[{"z", ",", "experiment"}], "]"}], ",", 
              RowBox[{"zToDecayVolumeExperiment", "[", "experiment", "]"}], 
              ",", 
              RowBox[{"yToDecayVolumeCenterExperiment", "[", 
               RowBox[{"z", ",", "experiment"}], "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"xToDecayVolumeCenterExperiment", "[", 
               RowBox[{"z", ",", "experiment"}], "]"}], ",", 
              RowBox[{"zMaxDecayVolumeExperiment", "[", "experiment", "]"}], 
              ",", 
              RowBox[{"yToDecayVolumeCenterExperiment", "[", 
               RowBox[{"z", ",", "experiment"}], "]"}]}], "}"}]}], "}"}], ",", 
          RowBox[{"RouterDecayVolumeExperiment", "[", 
           RowBox[{"experiment", ",", "z"}], "]"}]}], "]"}]}], "]"}]}], ";", 
     "\n", 
     RowBox[{"finAnnular", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
         "DetectorPlaneOrientationExperiment", "[", "experiment", "]"}], 
         "\[Equal]", "\"\<Transverse\>\""}], ",", 
        RowBox[{"Cylinder", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"xToDecayVolumeCenterExperiment", "[", 
               RowBox[{"z", ",", "experiment"}], "]"}], ",", 
              RowBox[{"yToDecayVolumeCenterExperiment", "[", 
               RowBox[{"z", ",", "experiment"}], "]"}], ",", 
              RowBox[{"zToDecayVolumeExperiment", "[", "experiment", "]"}]}], 
             "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"xToDecayVolumeCenterExperiment", "[", 
               RowBox[{"z", ",", "experiment"}], "]"}], ",", 
              RowBox[{"yToDecayVolumeCenterExperiment", "[", 
               RowBox[{"z", ",", "experiment"}], "]"}], ",", 
              RowBox[{"zMaxDecayVolumeExperiment", "[", "experiment", "]"}]}],
              "}"}]}], "}"}], ",", 
          RowBox[{"RinnerDecayVolumeExperiment", "[", 
           RowBox[{"experiment", ",", "z"}], "]"}]}], "]"}], ",", 
        RowBox[{"Cylinder", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"xToDecayVolumeCenterExperiment", "[", 
               RowBox[{"z", ",", "experiment"}], "]"}], ",", 
              RowBox[{"zToDecayVolumeExperiment", "[", "experiment", "]"}], 
              ",", 
              RowBox[{"yToDecayVolumeCenterExperiment", "[", 
               RowBox[{"z", ",", "experiment"}], "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"xToDecayVolumeCenterExperiment", "[", 
               RowBox[{"z", ",", "experiment"}], "]"}], ",", 
              RowBox[{"zMaxDecayVolumeExperiment", "[", "experiment", "]"}], 
              ",", 
              RowBox[{"yToDecayVolumeCenterExperiment", "[", 
               RowBox[{"z", ",", "experiment"}], "]"}]}], "}"}]}], "}"}], ",", 
          RowBox[{"RinnerDecayVolumeExperiment", "[", 
           RowBox[{"experiment", ",", "z"}], "]"}]}], "]"}]}], "]"}]}], ";", 
     "\n", 
     RowBox[{"RegionDifference", "[", 
      RowBox[{"foutAnnular", ",", "finAnnular"}], "]"}]}]}], "\n", 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.886219862247202*^9, 3.8862198622482023`*^9}, {
   3.886219974601697*^9, 3.8862200089198*^9}, 3.8862200570798273`*^9, {
   3.886220238806739*^9, 3.886220239418629*^9}, {3.886220555349454*^9, 
   3.8862205584281006`*^9}, {3.886222403204079*^9, 3.8862224097517743`*^9}, {
   3.886226164410104*^9, 3.8862261644237704`*^9}, {3.886324160728866*^9, 
   3.8863241607308607`*^9}, {3.8916778800651255`*^9, 3.891677944150801*^9}, {
   3.893340590892063*^9, 3.893340590894566*^9}, {3.8971453993074455`*^9, 
   3.8971454124083076`*^9}, {3.8971454438512917`*^9, 3.897145449203409*^9}},
 CellLabel->
  "In[1014]:=",ExpressionUUID->"68d77cb6-d0e9-4056-97c9-5fbe2e504d1a"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Decay volume of experiments with complicated geometry (currently - SHiP, LHCb)\
\>", "Subsection",
 CellChangeTimes->{{3.8529584759390974`*^9, 3.8529584801372075`*^9}, {
   3.8529586160569925`*^9, 3.852958617535117*^9}, {3.853957864238489*^9, 
   3.8539578673432045`*^9}, {3.8850100992075224`*^9, 3.8850101184858036`*^9}, 
   3.885010226337923*^9, {3.8862203045188656`*^9, 
   3.886220309033764*^9}},ExpressionUUID->"5e4e131b-eb93-4867-a95f-\
13c0641faafa"],

Cell[CellGroupData[{

Cell["Pyramidal frustum (SHiP, CHARM)", "Subsubsection",
 CellChangeTimes->{{3.884838287928994*^9, 3.884838305494379*^9}, {
   3.8848383682024612`*^9, 3.884838381011027*^9}, {3.885010116887697*^9, 
   3.8850101389928827`*^9}, {3.910110122279009*^9, 3.910110137843792*^9}, 
   3.9101113625964127`*^9},ExpressionUUID->"3f1e5604-bb40-41cc-aa68-\
e23dd7cfe4b4"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"BlockDecayVolumePyramidalFrustum", "[", "experiment_", "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", " ", 
    RowBox[{
     RowBox[{"zMin", "=", 
      RowBox[{"zToDecayVolumeExperiment", "[", "experiment", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"zMax", "=", 
      RowBox[{
       RowBox[{"zToDecayVolumeExperiment", "[", "experiment", "]"}], "+", 
       RowBox[{"dzDecayVolumeExperiment", "[", "experiment", "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"xctr", "[", "z_", "]"}], ",", 
        RowBox[{"yctr", "[", "z_", "]"}]}], "}"}], "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"xToDecayVolumeCenterExperiment", "[", 
         RowBox[{"z", ",", "experiment"}], "]"}], ",", 
        RowBox[{"yToDecayVolumeCenterExperiment", "[", 
         RowBox[{"z", ",", "experiment"}], "]"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"dx", "[", "z_", "]"}], "=", 
      RowBox[{"dxDecayVolumeExperiment", "[", 
       RowBox[{"z", ",", "experiment"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"dy", "[", "z_", "]"}], "=", 
      RowBox[{"dyDecayVolumeExperiment", "[", 
       RowBox[{"z", ",", "experiment"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"derx", ",", "dery"}], "}"}], "=", 
      RowBox[{
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"#", "[", "z", "]"}], ",", "z"}], "]"}], "&"}], "/@", 
       RowBox[{"{", 
        RowBox[{"dx", ",", "dy"}], "}"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"FrustumDirection", "=", 
      RowBox[{"Sign", "[", "derx", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"zvtxX", ",", "zvtxY"}], "}"}], "=", 
      RowBox[{"z", "/.", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Solve", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"#", "[", "z", "]"}], "==", "0"}], ",", "z"}], "]"}], 
           "[", 
           RowBox[{"[", "1", "]"}], "]"}], "&"}], "/@", 
         RowBox[{"{", 
          RowBox[{"dx", ",", "dy"}], "}"}]}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "The", " ", "value", " ", "of", " ", "z", " ", "at", " ", "which", " ", 
       "\[CapitalDelta]y", " ", "vanishes"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"zVtxSlow", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Sign", "[", "derx", "]"}], ">", "0"}], ",", 
        RowBox[{"Min", "[", 
         RowBox[{"zvtxX", ",", "zvtxY"}], "]"}], ",", 
        RowBox[{"Max", "[", 
         RowBox[{"zvtxX", ",", "zvtxY"}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "The", " ", "value", " ", "of", " ", "z", " ", "at", " ", "which", " ", 
       "\[CapitalDelta]x", " ", "vanishes"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"zVtxFast", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Sign", "[", "derx", "]"}], ">", "0"}], ",", 
        RowBox[{"Max", "[", 
         RowBox[{"zvtxX", ",", "zvtxY"}], "]"}], ",", 
        RowBox[{"Min", "[", 
         RowBox[{"zvtxX", ",", "zvtxY"}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "The", " ", "z", " ", "coordinate", " ", "of", " ", "the", " ", 
       "widest", " ", "part", " ", "of", " ", "the", " ", "pyramid"}], "*)"}],
      "\[IndentingNewLine]", 
     RowBox[{"zO", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"FrustumDirection", ">", "0"}], ",", "zMax", ",", "zMin"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"p1", "=", 
      RowBox[{"Pyramid", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"xctr", "[", "zO", "]"}], "-", 
            FractionBox[
             RowBox[{"dx", "[", "zO", "]"}], "2"]}], ",", 
           RowBox[{
            RowBox[{"yctr", "[", "zO", "]"}], "-", 
            FractionBox[
             RowBox[{"dy", "[", "zO", "]"}], "2"]}], ",", "zO"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"xctr", "[", "zO", "]"}], "-", 
            FractionBox[
             RowBox[{"dx", "[", "zO", "]"}], "2"]}], ",", 
           RowBox[{
            RowBox[{"yctr", "[", "zO", "]"}], "+", 
            FractionBox[
             RowBox[{"dy", "[", "zO", "]"}], "2"]}], ",", "zO"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"xctr", "[", "zO", "]"}], "+", 
            FractionBox[
             RowBox[{"dx", "[", "zO", "]"}], "2"]}], ",", 
           RowBox[{
            RowBox[{"yctr", "[", "zO", "]"}], "+", 
            FractionBox[
             RowBox[{"dy", "[", "zO", "]"}], "2"]}], ",", "zO"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"xctr", "[", "zO", "]"}], "+", 
            FractionBox[
             RowBox[{"dx", "[", "zO", "]"}], "2"]}], ",", 
           RowBox[{
            RowBox[{"yctr", "[", "zO", "]"}], "-", 
            FractionBox[
             RowBox[{"dy", "[", "zO", "]"}], "2"]}], ",", "zO"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"xctr", "[", "zVtxSlow", "]"}], ",", 
           RowBox[{"yctr", "[", "zVtxSlow", "]"}], ",", "zVtxSlow"}], "}"}]}],
         "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"zVtxFast", "==", "zvtxY"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"\[CapitalDelta]xFakeTemp", "[", 
          RowBox[{"\[CapitalDelta]xIni_", ",", "z_"}], "]"}], "=", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"FrustumDirection", ">", "0"}], ",", 
           RowBox[{
            RowBox[{"\[CapitalDelta]xIni", "*", 
             FractionBox[
              RowBox[{"(", 
               RowBox[{"z", "-", "zMin"}], ")"}], 
              RowBox[{"zMax", "-", "zMin"}]]}], "+", 
            RowBox[{
             RowBox[{"dx", "[", "zMin", "]"}], "*", 
             FractionBox[
              RowBox[{"(", 
               RowBox[{"z", "-", "zMax"}], ")"}], 
              RowBox[{"zMin", "-", "zMax"}]]}]}], ",", 
           RowBox[{
            RowBox[{"\[CapitalDelta]xIni", "*", 
             FractionBox[
              RowBox[{"(", 
               RowBox[{"z", "-", "zMax"}], ")"}], 
              RowBox[{"zMin", "-", "zMax"}]]}], "+", 
            RowBox[{
             RowBox[{"dx", "[", "zMax", "]"}], "*", 
             FractionBox[
              RowBox[{"(", 
               RowBox[{"z", "-", "zMin"}], ")"}], 
              RowBox[{"zMax", "-", "zMin"}]]}]}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"\[CapitalDelta]xIniFake", "=", 
         RowBox[{"\[CapitalDelta]xIni", "/.", 
          RowBox[{
           RowBox[{"Solve", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"\[CapitalDelta]xFakeTemp", "[", 
               RowBox[{"\[CapitalDelta]xIni", ",", "zVtxFast"}], "]"}], "==", 
              "0"}], ",", "\[CapitalDelta]xIni"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"\[CapitalDelta]xFake", "[", "z_", "]"}], "=", 
         RowBox[{"\[CapitalDelta]xFakeTemp", "[", 
          RowBox[{"\[CapitalDelta]xIniFake", ",", "z"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"p2", "=", 
         RowBox[{"Pyramid", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"xctr", "[", "zO", "]"}], "-", 
               FractionBox[
                RowBox[{"\[CapitalDelta]xFake", "[", "zO", "]"}], "2"]}], ",", 
              RowBox[{
               RowBox[{"yctr", "[", "zO", "]"}], "-", 
               FractionBox[
                RowBox[{"dy", "[", "zO", "]"}], "2"]}], ",", "zO"}], "}"}], 
            ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"xctr", "[", "zO", "]"}], "-", 
               FractionBox[
                RowBox[{"\[CapitalDelta]xFake", "[", "zO", "]"}], "2"]}], ",", 
              RowBox[{
               RowBox[{"yctr", "[", "zO", "]"}], "+", 
               FractionBox[
                RowBox[{"dy", "[", "zO", "]"}], "2"]}], ",", "zO"}], "}"}], 
            ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"xctr", "[", "zO", "]"}], "+", 
               FractionBox[
                RowBox[{"\[CapitalDelta]xFake", "[", "zO", "]"}], "2"]}], ",", 
              RowBox[{
               RowBox[{"yctr", "[", "zO", "]"}], "+", 
               FractionBox[
                RowBox[{"dy", "[", "zO", "]"}], "2"]}], ",", "zO"}], "}"}], 
            ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"xctr", "[", "zO", "]"}], "+", 
               FractionBox[
                RowBox[{"\[CapitalDelta]xFake", "[", "zO", "]"}], "2"]}], ",", 
              RowBox[{
               RowBox[{"yctr", "[", "zO", "]"}], "-", 
               FractionBox[
                RowBox[{"dy", "[", "zO", "]"}], "2"]}], ",", "zO"}], "}"}], 
            ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"xctr", "[", "zVtxFast", "]"}], ",", 
              RowBox[{"yctr", "[", "zVtxFast", "]"}], ",", "zVtxFast"}], 
             "}"}]}], "}"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"\[CapitalDelta]yFakeTemp", "[", 
          RowBox[{"\[CapitalDelta]yIni_", ",", "z_"}], "]"}], "=", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"FrustumDirection", ">", "0"}], ",", 
           RowBox[{
            RowBox[{"\[CapitalDelta]yIni", "*", 
             FractionBox[
              RowBox[{"(", 
               RowBox[{"z", "-", "zMin"}], ")"}], 
              RowBox[{"zMax", "-", "zMin"}]]}], "+", 
            RowBox[{
             RowBox[{"dy", "[", "zMin", "]"}], "*", 
             FractionBox[
              RowBox[{"(", 
               RowBox[{"z", "-", "zMax"}], ")"}], 
              RowBox[{"zMin", "-", "zMax"}]]}]}], ",", 
           RowBox[{
            RowBox[{"\[CapitalDelta]yIni", "*", 
             FractionBox[
              RowBox[{"(", 
               RowBox[{"z", "-", "zMax"}], ")"}], 
              RowBox[{"zMin", "-", "zMax"}]]}], "+", 
            RowBox[{
             RowBox[{"dy", "[", "zMax", "]"}], "*", 
             FractionBox[
              RowBox[{"(", 
               RowBox[{"z", "-", "zMin"}], ")"}], 
              RowBox[{"zMax", "-", "zMin"}]]}]}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"\[CapitalDelta]yIniFake", "=", 
         RowBox[{"\[CapitalDelta]yIni", "/.", 
          RowBox[{
           RowBox[{"Solve", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"\[CapitalDelta]yFakeTemp", "[", 
               RowBox[{"\[CapitalDelta]yIni", ",", "zVtxFast"}], "]"}], "==", 
              "0"}], ",", "\[CapitalDelta]yIni"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"\[CapitalDelta]yFake", "[", "z_", "]"}], "=", 
         RowBox[{"\[CapitalDelta]yFakeTemp", "[", 
          RowBox[{"\[CapitalDelta]yIniFake", ",", "z"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"p2", "=", 
         RowBox[{"Pyramid", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"xctr", "[", "zO", "]"}], "-", 
               FractionBox[
                RowBox[{"dx", "[", "zO", "]"}], "2"]}], ",", 
              RowBox[{
               RowBox[{"yctr", "[", "zO", "]"}], "-", 
               FractionBox[
                RowBox[{"\[CapitalDelta]yFake", "[", "zO", "]"}], "2"]}], ",",
               "zO"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"xctr", "[", "zO", "]"}], "-", 
               FractionBox[
                RowBox[{"dx", "[", "zO", "]"}], "2"]}], ",", 
              RowBox[{
               RowBox[{"yctr", "[", "zO", "]"}], "+", 
               FractionBox[
                RowBox[{"\[CapitalDelta]yFake", "[", "zO", "]"}], "2"]}], ",",
               "zO"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"xctr", "[", "zO", "]"}], "+", 
               FractionBox[
                RowBox[{"dx", "[", "zO", "]"}], "2"]}], ",", 
              RowBox[{
               RowBox[{"yctr", "[", "zO", "]"}], "+", 
               FractionBox[
                RowBox[{"\[CapitalDelta]yFake", "[", "zO", "]"}], "2"]}], ",",
               "zO"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"xctr", "[", "zO", "]"}], "+", 
               FractionBox[
                RowBox[{"dx", "[", "zO", "]"}], "2"]}], ",", 
              RowBox[{
               RowBox[{"yctr", "[", "zO", "]"}], "-", 
               FractionBox[
                RowBox[{"\[CapitalDelta]yFake", "[", "zO", "]"}], "2"]}], ",",
               "zO"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"xctr", "[", "zVtxFast", "]"}], ",", 
              RowBox[{"yctr", "[", "zVtxFast", "]"}], ",", "zVtxFast"}], 
             "}"}]}], "}"}], "]"}]}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"zM", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"FrustumDirection", ">", "0"}], ",", "zMin", ",", "zMax"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"cuboid", "=", 
      RowBox[{"Cuboid", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"xctr", "[", "zO", "]"}], "-", 
           FractionBox[
            RowBox[{"dx", "[", "zO", "]"}], "2"]}], ",", 
          RowBox[{
           RowBox[{"yctr", "[", "zO", "]"}], "-", 
           FractionBox[
            RowBox[{"dy", "[", "zO", "]"}], "2"]}], ",", "zMin"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"xctr", "[", "zO", "]"}], "+", 
           FractionBox[
            RowBox[{"dx", "[", "zO", "]"}], "2"]}], ",", 
          RowBox[{
           RowBox[{"yctr", "[", "zO", "]"}], "+", 
           FractionBox[
            RowBox[{"dy", "[", "zO", "]"}], "2"]}], ",", "zMax"}], "}"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"RegionIntersection", "[", 
      RowBox[{"p2", ",", 
       RowBox[{"RegionIntersection", "[", 
        RowBox[{"cuboid", ",", "p1"}], "]"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Region", "[", 
     RowBox[{
     "BlockDecayVolumePyramidalFrustum", "[", "\"\<CHARM-lepton\>\"", "]"}], 
     "]"}], "\[IndentingNewLine]", 
    RowBox[{"Region", "[", 
     RowBox[{
     "BlockDecayVolumePyramidalFrustum", "[", "\"\<SHiP-ECN3\>\"", "]"}], 
     "]"}]}], "*)"}]}]}], "Input",
 CellChangeTimes->{
  3.8849229470540752`*^9, {3.8862205609413805`*^9, 3.8862205614080505`*^9}, {
   3.886226164428712*^9, 3.886226164431704*^9}, {3.8916778800651255`*^9, 
   3.8916779182770753`*^9}, 3.893518137107518*^9, {3.905669757275872*^9, 
   3.905669773106097*^9}, {3.9056698926360917`*^9, 3.905669897815973*^9}, {
   3.9056700778559666`*^9, 3.9056700840097723`*^9}, {3.9056701849857826`*^9, 
   3.905670187217149*^9}, {3.910110142108219*^9, 3.910110708921549*^9}, {
   3.9101107738237867`*^9, 3.9101107898543735`*^9}, {3.910110899352713*^9, 
   3.910110919193243*^9}, {3.910110995538523*^9, 3.910111034387014*^9}, {
   3.9101128639329305`*^9, 3.910112865400218*^9}, 3.910114330207806*^9, {
   3.910115473011484*^9, 3.910115475694575*^9}},
 CellLabel->
  "In[1016]:=",ExpressionUUID->"7cc89b2c-8ce6-432e-98fb-3e1253114a33"]
}, Open  ]],

Cell[CellGroupData[{

Cell["LHCb-downstream", "Subsubsection",
 CellChangeTimes->{{3.8850101640459986`*^9, 3.885010166676833*^9}, {
   3.894528283396414*^9, 3.894528284015489*^9}, 
   3.907406781980513*^9},ExpressionUUID->"38754b3f-4d89-4ba6-8860-\
83a2b5915ace"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"LHCbfarDecayVolume", "[", "exp_", "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"z\[Theta]ConicalFrustum", "[", 
       RowBox[{"z1_", ",", "z2_", ",", "\[Theta]_"}], "]"}], ":=", 
      RowBox[{"ConvexHullMesh", "[", 
       RowBox[{"Join", "@@", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{"Append", "[", "#", "]"}], ",", 
             RowBox[{"CirclePoints", "[", 
              RowBox[{
               RowBox[{"#", " ", 
                RowBox[{"Tan", "[", "\[Theta]", "]"}]}], ",", "100"}], 
              "]"}]}], "]"}], "&"}], "/@", 
          RowBox[{"{", 
           RowBox[{"z1", ",", "z2"}], "}"}]}], ")"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"foutAnnular", "=", 
      RowBox[{"z\[Theta]ConicalFrustum", "[", 
       RowBox[{
        RowBox[{"zToDecayVolumeExperiment", "[", "exp", "]"}], ",", 
        RowBox[{
         RowBox[{"zToDecayVolumeExperiment", "[", "exp", "]"}], "+", 
         RowBox[{"dzDecayVolumeExperiment", "[", "exp", "]"}]}], ",", 
        RowBox[{"theta", "[", "2.", "]"}]}], "]"}]}], ";", "\n", 
     RowBox[{"finAnnular", "=", 
      RowBox[{"z\[Theta]ConicalFrustum", "[", 
       RowBox[{
        RowBox[{"zToDecayVolumeExperiment", "[", "exp", "]"}], ",", 
        RowBox[{
         RowBox[{"zToDecayVolumeExperiment", "[", "exp", "]"}], "+", 
         RowBox[{"dzDecayVolumeExperiment", "[", "exp", "]"}]}], ",", 
        RowBox[{"theta", "[", "5.", "]"}]}], "]"}]}], ";", "\n", 
     RowBox[{"RegionDifference", "[", 
      RowBox[{"foutAnnular", ",", "finAnnular"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Region", "[", 
    RowBox[{
     RowBox[{"Style", "[", 
      RowBox[{"LHCbfarDecayVolume", ",", 
       RowBox[{"Opacity", "[", "0.1", "]"}]}], "]"}], ",", 
     RowBox[{"BoxRatios", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"1", ",", "1", ",", "1"}], "}"}]}], ",", 
     RowBox[{"Boxed", "\[Rule]", "True"}], ",", 
     RowBox[{"Axes", "\[Rule]", "True"}]}], "]"}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.883586817293082*^9, 3.8835868593352547`*^9}, {
   3.883586929969737*^9, 3.8835869846284904`*^9}, 3.883587190886103*^9, {
   3.88358782697309*^9, 3.8835878279864063`*^9}, 3.8862200570842175`*^9, {
   3.886220193500881*^9, 3.886220194063093*^9}, {3.886222353849183*^9, 
   3.8862223545528307`*^9}, {3.8862224180165176`*^9, 
   3.8862224362602205`*^9}, {3.88622618653512*^9, 3.8862262300473223`*^9}, {
   3.8862313662264233`*^9, 3.8862313688349504`*^9}, {3.8864358895517535`*^9, 
   3.8864358999544444`*^9}, {3.8916778800651255`*^9, 3.891677890131877*^9}, {
   3.891873680906371*^9, 3.89187368157959*^9}, {3.8933414637476563`*^9, 
   3.893341487077662*^9}, {3.8935181371135025`*^9, 3.893518137115497*^9}, {
   3.8945282869910097`*^9, 3.894528340969008*^9}},
 CellLabel->
  "In[1017]:=",ExpressionUUID->"b61b639f-42f9-406c-be50-314330c15109"]
}, Open  ]],

Cell[CellGroupData[{

Cell["LHCb-muon chamber", "Subsubsection",
 CellChangeTimes->{{3.8975782211766043`*^9, 
  3.897578227379715*^9}},ExpressionUUID->"111b8c3c-ed59-4669-94e2-\
5cd17a8cc0de"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"LHCbMuonVol2", "=", 
   RowBox[{"Parallelepiped", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"xToDecayVolumeCenterExperiment", "[", 
         RowBox[{"z", ",", "\"\<LHCb-muon-chamber\>\""}], "]"}], "-", 
        RowBox[{
         RowBox[{"dxDecayVolumeExperiment", "[", 
          RowBox[{"z", ",", "\"\<LHCb-muon-chamber\>\""}], "]"}], "/", 
         "2"}]}], ",", 
       RowBox[{
        RowBox[{"yToDecayVolumeCenterExperiment", "[", 
         RowBox[{"z", ",", "\"\<LHCb-muon-chamber\>\""}], "]"}], "-", 
        RowBox[{
         RowBox[{"dyDecayVolumeExperiment", "[", 
          RowBox[{"z", ",", "\"\<LHCb-muon-chamber\>\""}], "]"}], "/", 
         "2"}]}], ",", 
       RowBox[{
       "zToDecayVolumeExperiment", "[", "\"\<LHCb-muon-chamber\>\"", "]"}]}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"dxDecayVolumeExperiment", "[", 
          RowBox[{"z", ",", "\"\<LHCb-muon-chamber\>\""}], "]"}], ",", "0", 
         ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{"dyDecayVolumeExperiment", "[", 
          RowBox[{"z", ",", "\"\<LHCb-muon-chamber\>\""}], "]"}], ",", "0"}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", 
         RowBox[{
         "dzDecayVolumeExperiment", "[", "\"\<LHCb-muon-chamber\>\"", "]"}]}],
         "}"}]}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"LHCbMuonVol1", "=", 
   RowBox[{"Parallelepiped", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "0.03"}], ",", 
       RowBox[{"-", "0.025"}], ",", 
       RowBox[{
       "zToDecayVolumeExperiment", "[", "\"\<LHCb-muon-chamber\>\"", "]"}]}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0.06", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0.05", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", 
         RowBox[{
         "dzDecayVolumeExperiment", "[", "\"\<LHCb-muon-chamber\>\"", "]"}]}],
         "}"}]}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"LHCbMuonVol", "=", 
   RowBox[{"RegionDifference", "[", 
    RowBox[{"LHCbMuonVol2", ",", "LHCbMuonVol1"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8975782331277943`*^9, 3.8975782921260867`*^9}, {
   3.897578400077426*^9, 3.897578406455738*^9}, {3.897578440236015*^9, 
   3.897578474618841*^9}, {3.897578592861884*^9, 3.897578595582947*^9}, {
   3.8975791486438904`*^9, 3.8975791644726753`*^9}, {3.8975792129930506`*^9, 
   3.897579260552046*^9}, 3.8975798285585456`*^9},
 CellLabel->
  "In[1018]:=",ExpressionUUID->"7b547486-f57c-43b2-b259-47a28fc7b638"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"SHADOWSlatestPart1", "=", 
     RowBox[{"Parallelepiped", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"xToDecayVolumeCenterExperiment", "[", 
           RowBox[{"15", ",", "\"\<SHADOWS-latest\>\""}], "]"}], "-", 
          RowBox[{
           RowBox[{"dxDecayVolumeExperiment", "[", 
            RowBox[{"15", ",", "\"\<SHADOWS-latest\>\""}], "]"}], "/", 
           "2"}]}], ",", 
         RowBox[{
          RowBox[{"yToDecayVolumeCenterExperiment", "[", 
           RowBox[{"15", ",", "\"\<SHADOWS-latest\>\""}], "]"}], "-", 
          RowBox[{
           RowBox[{"dyDecayVolumeExperiment", "[", 
            RowBox[{"15", ",", "\"\<SHADOWS-latest\>\""}], "]"}], "/", 
           "2"}]}], ",", 
         RowBox[{
         "zToDecayVolumeExperiment", "[", "\"\<SHADOWS-latest\>\"", "]"}]}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"dxDecayVolumeExperiment", "[", 
            RowBox[{"15", ",", "\"\<SHADOWS-latest\>\""}], "]"}], ",", "0", 
           ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           RowBox[{"dyDecayVolumeExperiment", "[", 
            RowBox[{"15", ",", "\"\<SHADOWS-latest\>\""}], "]"}], ",", "0"}], 
          "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "12"}], "}"}]}], "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"SHADOWSlatestPart2", "=", 
     RowBox[{"Parallelepiped", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"xToDecayVolumeCenterExperiment", "[", 
           RowBox[{
            RowBox[{"14.5", "+", "13"}], ",", "\"\<SHADOWS-latest\>\""}], 
           "]"}], "-", 
          RowBox[{
           RowBox[{"dxDecayVolumeExperiment", "[", 
            RowBox[{
             RowBox[{"14.5", "+", "13"}], ",", "\"\<SHADOWS-latest\>\""}], 
            "]"}], "/", "2"}]}], ",", 
         RowBox[{
          RowBox[{"yToDecayVolumeCenterExperiment", "[", 
           RowBox[{
            RowBox[{"14.5", "+", "13"}], ",", "\"\<SHADOWS-latest\>\""}], 
           "]"}], "-", 
          RowBox[{
           RowBox[{"dyDecayVolumeExperiment", "[", 
            RowBox[{
             RowBox[{"14.5", "+", "13"}], ",", "\"\<SHADOWS-latest\>\""}], 
            "]"}], "/", "2"}]}], ",", 
         RowBox[{
          RowBox[{
          "zToDecayVolumeExperiment", "[", "\"\<SHADOWS-latest\>\"", "]"}], 
          "+", "12"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"dxDecayVolumeExperiment", "[", 
            RowBox[{
             RowBox[{"14.5", "+", "13"}], ",", "\"\<SHADOWS-latest\>\""}], 
            "]"}], ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           RowBox[{"dyDecayVolumeExperiment", "[", 
            RowBox[{
             RowBox[{"14.5", "+", "13"}], ",", "\"\<SHADOWS-latest\>\""}], 
            "]"}], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "7."}], "}"}]}], "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"DecayVolumeSHADOWSlatest", "=", 
     RowBox[{"RegionUnion", "[", 
      RowBox[{"SHADOWSlatestPart1", ",", "SHADOWSlatestPart2"}], "]"}]}], 
    ";"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Region", "[", 
    RowBox[{
     RowBox[{"Style", "[", 
      RowBox[{"LHCbfarDecayVolume", ",", 
       RowBox[{"Opacity", "[", "0.1", "]"}]}], "]"}], ",", 
     RowBox[{"BoxRatios", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"1", ",", "1", ",", "1"}], "}"}]}], ",", 
     RowBox[{"Boxed", "\[Rule]", "True"}], ",", 
     RowBox[{"Axes", "\[Rule]", "True"}]}], "]"}], "*)"}]}]], "Input",
 CellChangeTimes->{{3.883586817293082*^9, 3.8835868593352547`*^9}, {
   3.883586929969737*^9, 3.8835869846284904`*^9}, 3.883587190886103*^9, {
   3.88358782697309*^9, 3.8835878279864063`*^9}, 3.8862200570842175`*^9, {
   3.886220193500881*^9, 3.886220194063093*^9}, {3.886222353849183*^9, 
   3.8862223545528307`*^9}, {3.8862224180165176`*^9, 
   3.8862224362602205`*^9}, {3.88622618653512*^9, 3.8862262300473223`*^9}, {
   3.8862313662264233`*^9, 3.8862313688349504`*^9}, {3.8864358895517535`*^9, 
   3.8864358999544444`*^9}, {3.8916778800651255`*^9, 3.891677890131877*^9}, {
   3.891873680906371*^9, 3.89187368157959*^9}, {3.8933414637476563`*^9, 
   3.893341487077662*^9}, {3.8935181371135025`*^9, 3.893518137115497*^9}, {
   3.8945282869910097`*^9, 3.894528340969008*^9}, {3.8971469089841757`*^9, 
   3.8971469328240623`*^9}, {3.897147384494627*^9, 3.8971474107540207`*^9}, {
   3.897148265249313*^9, 3.8971482660647755`*^9}, {3.8974567202548428`*^9, 
   3.8974567225766945`*^9}, {3.8974580716707683`*^9, 
   3.8974580735444555`*^9}, {3.9028121822895184`*^9, 3.902812185125311*^9}},
 CellLabel->
  "In[1021]:=",ExpressionUUID->"8612ce4e-ca9a-43ab-b390-8491bcf8dc3b"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Total", "Subsubsection",
 CellChangeTimes->{{3.886220383932426*^9, 
  3.8862203843989005`*^9}},ExpressionUUID->"9fa30c80-5ecf-48d8-bb9f-\
94a8f1ae812a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"listgeometrynonstandard", "=", 
   RowBox[{"Join", "[", 
    RowBox[{"explistship", ",", "explistlhcb"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NonStandardDecayVolumeGeometry", "[", "experiment_", "]"}], ":=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"StringContainsQ", "[", 
      RowBox[{"experiment", ",", 
       RowBox[{"{", 
        RowBox[{"\"\<SHiP\>\"", ",", "\"\<CHARM\>\""}], "}"}]}], "]"}], "==", 
     "True"}], ",", 
    RowBox[{"BlockDecayVolumePyramidalFrustum", "[", "experiment", "]"}], ",", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"StringContainsQ", "[", 
        RowBox[{"experiment", ",", "\"\<LHCb-downstream\>\""}], "]"}], "==", 
       "True"}], ",", 
      RowBox[{"LHCbfarDecayVolume", "[", "experiment", "]"}], ",", 
      "LHCbMuonVol"}], "]"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.8862203860504827`*^9, 3.8862204689472294`*^9}, {
  3.893341464468871*^9, 3.893341486533001*^9}, {3.894528348762006*^9, 
  3.894528367641307*^9}, {3.8950356485614653`*^9, 3.8950357028531265`*^9}, {
  3.896930353351035*^9, 3.896930379082113*^9}, {3.897147416655098*^9, 
  3.897147428051713*^9}, {3.8975786024308767`*^9, 3.897578612148483*^9}, {
  3.902812171091827*^9, 3.9028121742121716`*^9}, {3.9049826017820807`*^9, 
  3.90498263012798*^9}, {3.9074067819854994`*^9, 3.907406782000803*^9}, {
  3.9101143877790847`*^9, 3.9101144520324044`*^9}, {3.910114494704656*^9, 
  3.9101144985523443`*^9}, {3.9101145313267465`*^9, 3.910114553372169*^9}, {
  3.9101145917638755`*^9, 3.9101147096927643`*^9}, {3.910248764108335*^9, 
  3.910248766762859*^9}},
 CellLabel->
  "In[1022]:=",ExpressionUUID->"39e55937-a3f7-4527-a69e-a60d51c1aa4a"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Combined - for standard and non-standard geometries", "Subsection",
 CellChangeTimes->{{3.8862203285766573`*^9, 3.886220329422714*^9}, {
  3.8862203685232153`*^9, 
  3.886220375894229*^9}},ExpressionUUID->"44bbe585-5b09-41e8-b180-\
1129cc4e44ac"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"DecayVolumeGeometry", "[", "experiment_", "]"}], ":=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"MemberQ", "[", 
      RowBox[{"listgeometrynonstandard", ",", "experiment"}], "]"}], 
     "\[Equal]", "True"}], ",", 
    RowBox[{"NonStandardDecayVolumeGeometry", "[", "experiment", "]"}], ",", 
    RowBox[{"StandardShapeDecayVolume", "[", 
     RowBox[{"experiment", ",", 
      RowBox[{"GeometryExperiment", "[", "experiment", "]"}]}], "]"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Region", "[", 
    RowBox[{
     RowBox[{"Style", "[", 
      RowBox[{
       RowBox[{"DecayVolumeGeometry", "[", "\"\<LHCb-downstream\>\"", "]"}], 
       ",", "Blue", ",", 
       RowBox[{"Opacity", "[", "0.1", "]"}]}], "]"}], ",", 
     RowBox[{"BoxRatios", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"1", ",", "1", ",", "1"}], "}"}]}], ",", 
     RowBox[{"Boxed", "\[Rule]", "True"}], ",", 
     RowBox[{"Axes", "\[Rule]", "True"}]}], "]"}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.886220332166671*^9, 3.8862203633252163`*^9}, {
   3.8862204744454584`*^9, 3.8862205125564733`*^9}, {3.886220839511469*^9, 
   3.886220840102395*^9}, {3.886222026381688*^9, 3.8862220287166295`*^9}, {
   3.8862223627630534`*^9, 3.886222369628668*^9}, {3.886222441476139*^9, 
   3.886222448255355*^9}, {3.886231361345725*^9, 3.8862313638425274`*^9}, 
   3.893318177690199*^9, {3.893341464472891*^9, 3.893341464473868*^9}, {
   3.8933439559167128`*^9, 3.893343986336771*^9}, {3.8971474351251135`*^9, 
   3.897147442278489*^9}, 3.9028130489681582`*^9, 3.907406782003795*^9, 
   3.910114727705049*^9},
 CellLabel->
  "In[1024]:=",ExpressionUUID->"5a5a6265-a4fd-4cf4-8556-2e980256cc20"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Slice of the decay volume", "Subsection",
 CellChangeTimes->{{3.8850101974603496`*^9, 
  3.885010201625016*^9}},ExpressionUUID->"f9a001f0-8a78-4142-800b-\
f078ade817ff"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Slice", " ", "of", " ", "the", " ", "decay", " ", "volume", " ", "of", 
    " ", "the", " ", "experiment", " ", "in", " ", "the", " ", "plane", " ", 
    "parallel", " ", "to", " ", "detector", " ", "plane"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"ExperimentDecayVolumeSlice", "[", 
     RowBox[{"experiment_", ",", "z_", ",", "\"\<Box\>\""}], "]"}], ":=", 
    RowBox[{"Box", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"xToDecayVolumeCenterExperiment", "[", 
          RowBox[{"z", ",", "experiment"}], "]"}], "-", 
         RowBox[{
          RowBox[{"dxDecayVolumeExperiment", "[", 
           RowBox[{"z", ",", "experiment"}], "]"}], "/", "2"}]}], ",", 
        RowBox[{
         RowBox[{"yToDecayVolumeCenterExperiment", "[", 
          RowBox[{"z", ",", "experiment"}], "]"}], "-", 
         RowBox[{
          RowBox[{"dyDecayVolumeExperiment", "[", 
           RowBox[{"z", ",", "experiment"}], "]"}], "/", "2"}]}]}], "}"}], 
      ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"xToDecayVolumeCenterExperiment", "[", 
          RowBox[{"z", ",", "experiment"}], "]"}], "+", 
         RowBox[{
          RowBox[{"dxDecayVolumeExperiment", "[", 
           RowBox[{"z", ",", "experiment"}], "]"}], "/", "2"}]}], ",", 
        RowBox[{
         RowBox[{"yToDecayVolumeCenterExperiment", "[", 
          RowBox[{"z", ",", "experiment"}], "]"}], "+", 
         RowBox[{
          RowBox[{"dyDecayVolumeExperiment", "[", 
           RowBox[{"z", ",", "experiment"}], "]"}], "/", "2"}]}]}], "}"}]}], 
     "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ExperimentDecayVolumeSlice", "[", 
     RowBox[{"experiment_", ",", "z_", ",", "\"\<Cylinder\>\""}], "]"}], ":=", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"DetectorPlaneOrientationExperiment", "[", "experiment", "]"}],
        "\[Equal]", "\"\<Transverse\>\""}], ",", 
      RowBox[{"Disk", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"xToDecayVolumeCenterExperiment", "[", 
           RowBox[{"z", ",", "experiment"}], "]"}], ",", 
          RowBox[{"yToDecayVolumeCenterExperiment", "[", 
           RowBox[{"z", ",", "experiment"}], "]"}]}], "}"}], ",", 
        RowBox[{"RouterDecayVolumeExperiment", "[", 
         RowBox[{"experiment", ",", "z"}], "]"}]}], "]"}], ",", 
      RowBox[{"Box", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"xToDecayVolumeCenterExperiment", "[", 
            RowBox[{"z", ",", "experiment"}], "]"}], "-", 
           RowBox[{
            RowBox[{"dxDecayVolumeExperiment", "[", 
             RowBox[{"z", ",", "experiment"}], "]"}], "/", "2"}]}], ",", 
          RowBox[{
           RowBox[{"yToDecayVolumeCenterExperiment", "[", 
            RowBox[{"z", ",", "experiment"}], "]"}], "-", 
           RowBox[{
            RowBox[{"dyDecayVolumeExperiment", "[", 
             RowBox[{"z", ",", "experiment"}], "]"}], "/", "2"}]}]}], "}"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"xToDecayVolumeCenterExperiment", "[", 
            RowBox[{"z", ",", "experiment"}], "]"}], "+", 
           RowBox[{
            RowBox[{"dxDecayVolumeExperiment", "[", 
             RowBox[{"z", ",", "experiment"}], "]"}], "/", "2"}]}], ",", 
          RowBox[{
           RowBox[{"yToDecayVolumeCenterExperiment", "[", 
            RowBox[{"z", ",", "experiment"}], "]"}], "+", 
           RowBox[{
            RowBox[{"dyDecayVolumeExperiment", "[", 
             RowBox[{"z", ",", "experiment"}], "]"}], "/", "2"}]}]}], "}"}]}],
        "]"}]}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"For", " ", "annular", " ", 
     RowBox[{"cylinder", ".", " ", "A"}], " ", "priori", " ", "assumed", " ", 
     "that", " ", "the", " ", "detector", " ", "plane", " ", "orientation", 
     " ", "is", " ", "transverse", " ", "to", " ", "the", " ", "beam", " ", 
     "axis"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ExperimentDecayVolumeSlice", "[", 
      RowBox[{"experiment_", ",", "z_", ",", "\"\<Annular cylinder\>\""}], 
      "]"}], ":=", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"GeometryExperiment", "[", "experiment", "]"}], "\[Equal]", 
        "\"\<Annular cylinder\>\""}], ",", 
       RowBox[{"RegionDifference", "[", 
        RowBox[{
         RowBox[{"Disk", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"xToDecayVolumeCenterExperiment", "[", 
              RowBox[{"z", ",", "experiment"}], "]"}], ",", 
             RowBox[{"yToDecayVolumeCenterExperiment", "[", 
              RowBox[{"z", ",", "experiment"}], "]"}]}], "}"}], ",", 
           RowBox[{"RouterDecayVolumeExperiment", "[", 
            RowBox[{"experiment", ",", "z"}], "]"}]}], "]"}], ",", 
         RowBox[{"Disk", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"xToDecayVolumeCenterExperiment", "[", 
              RowBox[{"z", ",", "experiment"}], "]"}], ",", 
             RowBox[{"yToDecayVolumeCenterExperiment", "[", 
              RowBox[{"z", ",", "experiment"}], "]"}]}], "}"}], ",", 
           RowBox[{"RinnerDecayVolumeExperiment", "[", 
            RowBox[{"experiment", ",", "z"}], "]"}]}], "]"}]}], "]"}], ",", 
       "0"}], "]"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.8529591095132666`*^9, 3.852959122481839*^9}, {
   3.8624572623542185`*^9, 3.862457280423027*^9}, {3.862461597797971*^9, 
   3.862461598230899*^9}, {3.877159478042899*^9, 3.8771595027240496`*^9}, {
   3.8775415235789247`*^9, 3.877541536186778*^9}, {3.8834984859356775`*^9, 
   3.883498486424182*^9}, {3.88358690900836*^9, 3.8835869183277607`*^9}, {
   3.8862200313858137`*^9, 3.8862200678906374`*^9}, 3.8862202116903343`*^9, {
   3.886220866563267*^9, 3.886220900101536*^9}, {3.886220944798196*^9, 
   3.8862209464246817`*^9}, {3.886220981566916*^9, 3.886220982636052*^9}, {
   3.8862211041836615`*^9, 3.8862211148452196`*^9}, {3.886221150733485*^9, 
   3.886221190656847*^9}, {3.8862309916783743`*^9, 3.886231026948576*^9}, {
   3.8862313739941263`*^9, 3.8862313764679985`*^9}, {3.891677909531543*^9, 
   3.8916779441603427`*^9}, {3.8916791457095428`*^9, 
   3.8916792536762705`*^9}, {3.8916796015613346`*^9, 
   3.8916796772747383`*^9}, {3.891679709167807*^9, 3.891679730130511*^9}, {
   3.8918514821345854`*^9, 3.8918515325507746`*^9}, 3.893318177702202*^9, 
   3.893340582923444*^9, {3.897145399337111*^9, 3.897145412434089*^9}, {
   3.89714544388043*^9, 3.897145449232189*^9}, {3.904985294447074*^9, 
   3.904985294973032*^9}},
 CellLabel->
  "In[1025]:=",ExpressionUUID->"b2b7c709-b0fc-45ef-bbfa-19bf5a913fe1"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Full geometry of the detector (needed for visualization+determining angular \
coverage)\
\>", "Section",
 CellChangeTimes->{{3.8862212546342063`*^9, 3.8862212588074093`*^9}, {
  3.911725329088329*^9, 
  3.9117253405940065`*^9}},ExpressionUUID->"27470ef3-52d6-41b9-af8a-\
c343799fb5b8"],

Cell[CellGroupData[{

Cell["Standard geometry", "Subsection",
 CellChangeTimes->{{3.886221279404632*^9, 
  3.88622128169722*^9}},ExpressionUUID->"ad126cc8-6ddb-4208-a197-\
7b74a0a4e6d7"],

Cell[CellGroupData[{

Cell["Box", "Subsubsection",
 CellChangeTimes->{{3.886221295495798*^9, 
  3.8862212957023444`*^9}},ExpressionUUID->"8abedd8a-50a6-441a-a28c-\
e3ec143aecdd"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"\[Xi]", " ", "=", " ", 
     RowBox[{"0", " ", "for", " ", "full", " ", "detector"}]}], ",", " ", 
    RowBox[{
    "and", " ", "say", " ", "0.99", " ", "if", " ", "you", " ", "are", " ", 
     "interested", " ", "in", " ", "the", " ", "plane", " ", "defining", " ", 
     "the", " ", "end", " ", "of", " ", "the", " ", "detector"}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"StandardDetectorGeometry", "[", 
    RowBox[{"experiment_", ",", "\"\<Box\>\"", ",", "\[Xi]_"}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"xlongmax", "=", 
       RowBox[{"xLongMaxDetectorExperiment", "[", "experiment", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"dxlong", "=", 
       RowBox[{"dxLongDetectorExperiment", "[", "experiment", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"zmaxdecvol", "=", 
       RowBox[{"zMaxDecayVolumeExperiment", "[", "experiment", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ztodec", "=", 
       RowBox[{"zToDecayVolumeExperiment", "[", "experiment", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"dxdet", "=", 
       RowBox[{"dxDetectorExperiment", "[", 
        RowBox[{"experiment", ",", "xlongmax"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"dydet", "=", 
       RowBox[{"dyDetectorExperiment", "[", 
        RowBox[{"experiment", ",", "xlongmax"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"dzdet", "=", 
       RowBox[{"dzDetectorExperiment", "[", "experiment", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"xcent", "=", 
       RowBox[{"xToDetectorCenterExperiment", "[", "experiment", "]"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"ycent", "=", 
       RowBox[{"yToDetectorCenterExperiment", "[", "experiment", "]"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
         "DetectorPlaneOrientationExperiment", "[", "experiment", "]"}], 
         "\[Equal]", "\"\<Transverse\>\""}], ",", 
        RowBox[{"Parallelepiped", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"xcent", "-", 
             RowBox[{"dxdet", "/", "2"}]}], ",", 
            RowBox[{"ycent", "-", 
             RowBox[{"dydet", "/", "2"}]}], ",", 
            RowBox[{"xlongmax", "-", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"1", "-", "\[Xi]"}], ")"}], "*", "dxlong"}]}]}], "}"}],
           ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"dxdet", ",", "0", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "dydet", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"1", "-", "\[Xi]"}], ")"}], "dxlong"}]}], "}"}]}], 
           "}"}]}], "]"}], ",", 
        RowBox[{"Parallelepiped", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"xcent", "-", 
             RowBox[{"dxdet", "/", "2"}]}], ",", 
            RowBox[{"xlongmax", "-", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"1", "-", "\[Xi]"}], ")"}], "dxlong"}]}], ",", 
            "ztodec"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"dxdet", ",", "0", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"1", "-", "\[Xi]"}], ")"}], "dxlong"}], ",", "0"}], 
             "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", "dzdet"}], "}"}]}], "}"}]}], "]"}]}],
        "]"}]}]}], "\[IndentingNewLine]", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.8862215715158205`*^9, 3.886221624092661*^9}, {
   3.8862250819010897`*^9, 3.8862251732059813`*^9}, {3.886225220161578*^9, 
   3.8862252363516345`*^9}, {3.8862257554290795`*^9, 
   3.8862258372036076`*^9}, {3.8862259556029034`*^9, 
   3.8862259776438475`*^9}, {3.8862261111790147`*^9, 
   3.8862261111840005`*^9}, {3.88622616443452*^9, 3.8862261644395084`*^9}, {
   3.8862264488056383`*^9, 3.886226468668414*^9}, 3.8862304251658187`*^9, {
   3.8863218954330063`*^9, 3.886321895688019*^9}, 3.8863241607358475`*^9, {
   3.886434563053871*^9, 3.8864345731775537`*^9}, {3.886434643195628*^9, 
   3.8864346779612875`*^9}, 3.8916768398630047`*^9, {3.8916769516253214`*^9, 
   3.8916769723446035`*^9}, {3.8916771577738495`*^9, 
   3.8916772457635117`*^9}, {3.891677276504009*^9, 3.8916773057007275`*^9}, {
   3.891677353573576*^9, 3.891677465952899*^9}, {3.891677880083752*^9, 
   3.8916779441668816`*^9}, 3.8916779919369555`*^9, 3.8916781145391417`*^9, 
   3.8933405823534503`*^9, {3.9102469738381653`*^9, 3.910246973847726*^9}, {
   3.910247056517334*^9, 3.9102473329296474`*^9}, {3.9102473724876633`*^9, 
   3.9102473725385737`*^9}, {3.91024789008954*^9, 3.9102479285483646`*^9}, {
   3.910259614080758*^9, 3.910259616690636*^9}, {3.910431556061952*^9, 
   3.910431562540853*^9}, {3.9104328951512175`*^9, 3.910432922252691*^9}, {
   3.9104330034613442`*^9, 3.9104330044319277`*^9}, {3.9104330870941935`*^9, 
   3.910433087961746*^9}},
 CellLabel->
  "In[1028]:=",ExpressionUUID->"0fd3b101-2ccf-4b70-b6f4-f1fa069cf68c"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Cylinder", "Subsubsection",
 CellChangeTimes->{{3.886221300213149*^9, 
  3.8862213012124095`*^9}},ExpressionUUID->"7c291c8b-59a2-4541-b3ae-\
c821c03f0269"],

Cell[BoxData[
 RowBox[{
  RowBox[{"StandardDetectorGeometry", "[", 
   RowBox[{"experiment_", ",", "\"\<Cylinder\>\"", ",", "\[Xi]_"}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"xlongmax", "=", 
      RowBox[{"xLongMaxDetectorExperiment", "[", "experiment", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"xcent", "=", 
      RowBox[{"xToDetectorCenterExperiment", "[", "experiment", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"ycent", "=", 
      RowBox[{"yToDetectorCenterExperiment", "[", "experiment", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"zmaxdecvol", "=", 
      RowBox[{"zMaxDecayVolumeExperiment", "[", "experiment", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"ztodec", "=", 
      RowBox[{"zToDecayVolumeExperiment", "[", "experiment", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"dxlong", "=", 
      RowBox[{"dxLongDetectorExperiment", "[", "experiment", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"dydet", "=", 
      RowBox[{"dyDetectorExperiment", "[", 
       RowBox[{"experiment", ",", "xlongmax"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"rin", "=", 
      RowBox[{"RinnerDetectorExperiment", "[", 
       RowBox[{"experiment", ",", "xlongmax"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"rout", "=", 
      RowBox[{"RouterDetectorExperiment", "[", 
       RowBox[{"experiment", ",", "xlongmax"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"dzdec", "=", 
      RowBox[{"dzDecayVolumeExperiment", "[", "experiment", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
        "DetectorPlaneOrientationExperiment", "[", "experiment", "]"}], 
        "\[Equal]", "\"\<Transverse\>\""}], ",", 
       RowBox[{"Cylinder", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"xcent", ",", "ycent", ",", 
             RowBox[{"xlongmax", "-", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"1", "-", "\[Xi]"}], ")"}], "dxlong"}]}]}], "}"}], 
           ",", 
           RowBox[{"{", 
            RowBox[{"xcent", ",", "ycent", ",", "xlongmax"}], "}"}]}], "}"}], 
         ",", "rout"}], "]"}], ",", 
       RowBox[{"Cylinder", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"xcent", ",", 
             RowBox[{"xlongmax", "-", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"1", "-", "\[Xi]"}], ")"}], "dxlong"}]}], ",", 
             RowBox[{"ztodec", "+", 
              RowBox[{"dzdec", "/", "2"}]}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"xcent", ",", "xlongmax", ",", 
             RowBox[{"ztodec", "+", 
              RowBox[{"dzdec", "/", "2"}]}]}], "}"}]}], "}"}], ",", "rout"}], 
        "]"}]}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.8862214975769243`*^9, 3.886221568507992*^9}, {
   3.8862259874942493`*^9, 3.8862260284297066`*^9}, {3.8862261111879897`*^9, 
   3.8862261111919813`*^9}, {3.8862261644415407`*^9, 
   3.8862261644455333`*^9}, {3.88622632279551*^9, 3.8862263259831104`*^9}, {
   3.8862264080774083`*^9, 3.886226430433976*^9}, {3.886227487883192*^9, 
   3.8862274896373653`*^9}, 3.886324160738839*^9, {3.8864346875112677`*^9, 
   3.886434704547516*^9}, {3.891677900836297*^9, 3.8916779441668816`*^9}, 
   3.8916781145391417`*^9, {3.8918515747508187`*^9, 3.8918515895982866`*^9}, {
   3.89185195416014*^9, 3.891851973841395*^9}, {3.891852057111308*^9, 
   3.8918520639821095`*^9}, 3.893340582359485*^9, {3.8935181371194863`*^9, 
   3.893518137121481*^9}, 3.8971454124381*^9, 3.8971454439068336`*^9, {
   3.9102469738493357`*^9, 3.9102469738573728`*^9}, {3.9102473605227375`*^9, 
   3.910247484538313*^9}, {3.910247568098591*^9, 3.910247580419207*^9}, {
   3.9102476342832937`*^9, 3.910247686289603*^9}, {3.9102477424081497`*^9, 
   3.9102478182075663`*^9}, {3.9102478575682116`*^9, 
   3.9102478676695285`*^9}, {3.9102479365385637`*^9, 3.910247960168586*^9}},
 CellLabel->
  "In[1029]:=",ExpressionUUID->"b6cfb308-d6c4-48c7-a09b-25d83361837b"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Annular cylinder", "Subsubsection",
 CellChangeTimes->{{3.886221288480516*^9, 
  3.8862212903596754`*^9}},ExpressionUUID->"3f775c17-8d7c-43e4-bd03-\
32ec24b58ac8"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"StandardDetectorGeometry", "[", 
   RowBox[{"experiment_", ",", "\"\<Annular cylinder\>\"", ",", "\[Xi]_"}], 
   "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"xlongmax", "=", 
      RowBox[{"xLongMaxDetectorExperiment", "[", "experiment", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"xcent", "=", 
      RowBox[{"xToDetectorCenterExperiment", "[", "experiment", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"ycent", "=", 
      RowBox[{"yToDetectorCenterExperiment", "[", "experiment", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"zmaxdecvol", "=", 
      RowBox[{"zMaxDecayVolumeExperiment", "[", "experiment", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"ztodec", "=", 
      RowBox[{"zToDecayVolumeExperiment", "[", "experiment", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"dxlong", "=", 
      RowBox[{"dxLongDetectorExperiment", "[", "experiment", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"rin", "=", 
      RowBox[{"RinnerDetectorExperiment", "[", 
       RowBox[{"experiment", ",", "xlongmax"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"rout", "=", 
      RowBox[{"RouterDetectorExperiment", "[", 
       RowBox[{"experiment", ",", "xlongmax"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"foutDetAnnular", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
         "DetectorPlaneOrientationExperiment", "[", "experiment", "]"}], 
         "\[Equal]", "\"\<Transverse\>\""}], ",", 
        RowBox[{"Cylinder", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"xcent", ",", "ycent", ",", 
              RowBox[{"zmaxdecvol", "+", 
               RowBox[{"\[Xi]", "*", "dxlong"}]}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"xcent", ",", "ycent", ",", "xlongmax"}], "}"}]}], "}"}],
           ",", "rout"}], "]"}], ",", 
        RowBox[{"Cylinder", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"xcent", ",", 
              RowBox[{"zmaxdecvol", "+", 
               RowBox[{"\[Xi]", "*", "dxlong"}]}], ",", "ycent"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"xcent", ",", "xlongmax", ",", "ycent"}], "}"}]}], "}"}],
           ",", "rout"}], "]"}]}], "]"}]}], ";", "\n", 
     RowBox[{"finDetAnnular", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
         "DetectorPlaneOrientationExperiment", "[", "experiment", "]"}], 
         "\[Equal]", "\"\<Transverse\>\""}], ",", 
        RowBox[{"Cylinder", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"xcent", ",", "ycent", ",", 
              RowBox[{"zmaxdecvol", "+", 
               RowBox[{"\[Xi]", "*", "dxlong"}]}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"xcent", ",", "ycent", ",", "xlongmax"}], "}"}]}], "}"}],
           ",", "rin"}], "]"}], ",", 
        RowBox[{"Cylinder", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"xcent", ",", 
              RowBox[{"zmaxdecvol", "+", 
               RowBox[{"\[Xi]", "*", "dxlong"}]}], ",", "ycent"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"xcent", ",", "xlongmax", ",", "ycent"}], "}"}]}], "}"}],
           ",", "rin"}], "]"}]}], "]"}]}], ";", "\n", 
     RowBox[{"RegionDifference", "[", 
      RowBox[{"foutDetAnnular", ",", "finDetAnnular"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Region", "[", 
    RowBox[{
     RowBox[{"Style", "[", 
      RowBox[{
       RowBox[{"StandardDetectorGeometry", "[", 
        RowBox[{"\"\<FACET\>\"", ",", 
         RowBox[{"GeometryExperiment", "[", "\"\<FACET\>\"", "]"}], ",", 
         "0"}], "]"}], ",", 
       RowBox[{"Opacity", "[", "0.1", "]"}]}], "]"}], ",", 
     RowBox[{"BoxRatios", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"1", ",", "1", ",", "1"}], "}"}]}], ",", 
     RowBox[{"Boxed", "\[Rule]", "True"}], ",", 
     RowBox[{"Axes", "\[Rule]", "True"}]}], "]"}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.8861831487419367`*^9, 3.886183202036121*^9}, 
   3.8862200571031694`*^9, 3.886220220474066*^9, {3.8862213133562555`*^9, 
   3.8862213377630916`*^9}, {3.8862213838837757`*^9, 
   3.8862214877579746`*^9}, {3.8862224944079065`*^9, 3.886222509961864*^9}, {
   3.8862260421290283`*^9, 3.886226046692461*^9}, 3.88622615647198*^9, {
   3.88622633085211*^9, 3.886226396008534*^9}, {3.886226432467829*^9, 
   3.8862264433927565`*^9}, {3.886226908324653*^9, 3.886226908562771*^9}, {
   3.886226940467311*^9, 3.886226940622374*^9}, {3.886227041458662*^9, 
   3.8862270455507507`*^9}, {3.886227088777933*^9, 3.8862271273027945`*^9}, {
   3.8863241607438445`*^9, 3.88632416074582*^9}, {3.8864347101876*^9, 
   3.886434722225918*^9}, {3.8916779008519487`*^9, 3.8916779441825404`*^9}, {
   3.8916781145391417`*^9, 3.8916781145391417`*^9}, 3.893318177712144*^9, {
   3.8933405823662276`*^9, 3.8933405823682585`*^9}, {3.91024697386145*^9, 
   3.910246973869524*^9}, {3.9102479792923594`*^9, 3.9102479890305796`*^9}, {
   3.910248113025752*^9, 3.9102481292904944`*^9}},
 CellLabel->
  "In[1030]:=",ExpressionUUID->"fc7dd65e-2e91-458e-b2ef-28bd92b312ef"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Non-standard geometry", "Subsection",
 CellChangeTimes->{{3.8850102124268165`*^9, 3.8850102156060863`*^9}, {
  3.8862212636720233`*^9, 
  3.886221266647914*^9}},ExpressionUUID->"b6e89d9f-16a2-4f6a-9d55-\
b7bbe096eae6"],

Cell[CellGroupData[{

Cell["LHCb-downstream", "Subsubsection",
 CellChangeTimes->{{3.8529588657882633`*^9, 3.8529588685662055`*^9}, 
   3.885010243357608*^9, 3.8933414644865437`*^9, 
   3.907406782012643*^9},ExpressionUUID->"df8071d5-b0f0-4824-83d6-\
62ff3e211d3a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Assuming", " ", "that", " ", "the", " ", "detector", " ", "is", " ", "a", 
    " ", "cone", " ", "with", " ", "a", " ", "smaller", " ", "cone", " ", 
    "deducted"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"LHCbfarDetectorVolumeTemp", "[", 
     RowBox[{"exp_", ",", "\[Xi]_"}], "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"z\[Theta]ConicalFrustum", "[", 
         RowBox[{"z1_", ",", "z2_", ",", "\[Theta]_"}], "]"}], ":=", 
        RowBox[{"ConvexHullMesh", "[", 
         RowBox[{"Join", "@@", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Map", "[", 
              RowBox[{
               RowBox[{"Append", "[", "#", "]"}], ",", 
               RowBox[{"CirclePoints", "[", 
                RowBox[{
                 RowBox[{"#", " ", 
                  RowBox[{"Tan", "[", "\[Theta]", "]"}]}], ",", "100"}], 
                "]"}]}], "]"}], "&"}], "/@", 
            RowBox[{"{", 
             RowBox[{"z1", ",", "z2"}], "}"}]}], ")"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"foutDetAnnular", "=", 
        RowBox[{"z\[Theta]ConicalFrustum", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"zMaxDecayVolumeExperiment", "[", "exp", "]"}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"xLongMaxDetectorExperiment", "[", "exp", "]"}], "-", 
              RowBox[{"zMaxDecayVolumeExperiment", "[", "exp", "]"}]}], ")"}],
             "*", "\[Xi]"}]}], ",", 
          RowBox[{"xLongMaxDetectorExperiment", "[", "exp", "]"}], ",", 
          RowBox[{"theta", "[", "2.", "]"}]}], "]"}]}], ";", "\n", 
       RowBox[{"finDetAnnular", "=", 
        RowBox[{"z\[Theta]ConicalFrustum", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"zMaxDecayVolumeExperiment", "[", "exp", "]"}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"xLongMaxDetectorExperiment", "[", "exp", "]"}], "-", 
              RowBox[{"zMaxDecayVolumeExperiment", "[", "exp", "]"}]}], ")"}],
             "*", "\[Xi]"}]}], ",", 
          RowBox[{"xLongMaxDetectorExperiment", "[", "exp", "]"}], ",", 
          RowBox[{"theta", "[", "5.", "]"}]}], "]"}]}], ";", "\n", 
       RowBox[{"RegionDifference", "[", 
        RowBox[{"foutDetAnnular", ",", "finDetAnnular"}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"SciFi", " ", "geometry"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"LHCbfarSciFiDetectorVolumeTemp", "[", 
     RowBox[{"experiment_", ",", "\[Xi]_"}], "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"xlongmax", "=", 
        RowBox[{"xLongMaxDetectorExperiment", "[", "experiment", "]"}]}], ";",
        "\[IndentingNewLine]", 
       RowBox[{"xcent", "=", 
        RowBox[{"xToDetectorCenterExperiment", "[", "experiment", "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"ycent", "=", 
        RowBox[{"yToDetectorCenterExperiment", "[", "experiment", "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"zmaxdecvol", "=", 
        RowBox[{"zMaxDecayVolumeExperiment", "[", "experiment", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"ztodec", "=", 
        RowBox[{"zToDecayVolumeExperiment", "[", "experiment", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"dxlong", "=", 
        RowBox[{"dxLongDetectorExperiment", "[", "experiment", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"dydet", "=", 
        RowBox[{"dyDetectorExperiment", "[", 
         RowBox[{"experiment", ",", "xlongmax"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"rin", "=", 
        RowBox[{"RinnerDetectorExperiment", "[", 
         RowBox[{"experiment", ",", "xlongmax"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"rout", "=", 
        RowBox[{"RouterDetectorExperiment", "[", 
         RowBox[{"experiment", ",", "xlongmax"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"dzdec", "=", 
        RowBox[{"dzDecayVolumeExperiment", "[", "experiment", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"dxdet", "=", 
        RowBox[{"dxDetectorExperiment", "[", 
         RowBox[{"experiment", ",", "xlongmax"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"z\[Theta]ConicalFrustum", "[", 
         RowBox[{"z1_", ",", "z2_", ",", "\[Theta]_"}], "]"}], ":=", 
        RowBox[{"ConvexHullMesh", "[", 
         RowBox[{"Join", "@@", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Map", "[", 
              RowBox[{
               RowBox[{"Append", "[", "#", "]"}], ",", 
               RowBox[{"CirclePoints", "[", 
                RowBox[{
                 RowBox[{"#", " ", 
                  RowBox[{"Tan", "[", "\[Theta]", "]"}]}], ",", "100"}], 
                "]"}]}], "]"}], "&"}], "/@", 
            RowBox[{"{", 
             RowBox[{"z1", ",", "z2"}], "}"}]}], ")"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Vol1", "=", 
        RowBox[{"Parallelepiped", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"xcent", "-", 
             RowBox[{"dxdet", "/", "2"}]}], ",", 
            RowBox[{"ycent", "-", 
             RowBox[{"dydet", "/", "2"}]}], ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"xlongmax", "-", "dxlong"}], ")"}], "+", 
             RowBox[{"\[Xi]", "*", "dxlong"}]}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"dxdet", ",", "0", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "dydet", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"1", "-", "\[Xi]"}], ")"}], "dxlong"}]}], "}"}]}], 
           "}"}]}], "]"}]}], ";", "\n", 
       RowBox[{"Vol2", "=", 
        RowBox[{"(*", 
         RowBox[{"z\[Theta]ConicalFrustum", "[", 
          RowBox[{
           RowBox[{"zmaxdecvol", "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"xlongmax", "-", "zmaxdecvol"}], ")"}], "*", 
             "\[Xi]"}]}], ",", "xlongmax", ",", 
           RowBox[{"theta", "[", "5.", "]"}]}], "]"}], "*)"}], 
        RowBox[{"Cylinder", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0.", ",", "0.", ",", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"xlongmax", "-", "dxlong"}], ")"}], "+", 
               RowBox[{"\[Xi]", "*", "dxlong"}]}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0.", ",", "0.", ",", "xlongmax"}], "}"}]}], "}"}], ",", 
          "0.09"}], "]"}]}], ";", "\n", 
       RowBox[{"RegionDifference", "[", 
        RowBox[{"Vol1", ",", "Vol2"}], "]"}]}]}], "\[IndentingNewLine]", 
     "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.8848383992082376`*^9, 3.8848384020510855`*^9}, {
   3.884838614935886*^9, 3.884838651360565*^9}, 3.8862200570991793`*^9, 
   3.88622022061817*^9, {3.8862224668965178`*^9, 3.8862224874065638`*^9}, {
   3.88622648756124*^9, 3.8862265277671347`*^9}, {3.88622660758617*^9, 
   3.886226690421734*^9}, {3.886227083298007*^9, 3.8862270834829607`*^9}, {
   3.886227184903759*^9, 3.8862273078458867`*^9}, {3.8864358122566767`*^9, 
   3.8864358239011836`*^9}, {3.8916779008731112`*^9, 
   3.8916779008836155`*^9}, {3.891678114554761*^9, 3.891678114554761*^9}, {
   3.8933414644998217`*^9, 3.8933414865409746`*^9}, {3.894528203812137*^9, 
   3.894528225476477*^9}, {3.897463543021138*^9, 3.8974635612771378`*^9}, 
   3.9102469738776054`*^9, {3.910248156544176*^9, 3.910248156684033*^9}, {
   3.910248264896635*^9, 3.910248302707903*^9}, {3.9102483572462187`*^9, 
   3.9102483637331514`*^9}, {3.9102484018261566`*^9, 
   3.9102484084134583`*^9}, {3.914561470634921*^9, 3.9145614760806165`*^9}, {
   3.9145615341256123`*^9, 3.914561623902672*^9}},
 CellLabel->
  "In[1031]:=",ExpressionUUID->"19baa3f5-e3bb-4a1e-ba3b-f27a55d717d1"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Common", "Subsubsection",
 CellChangeTimes->{{3.8862216360366244`*^9, 
  3.8862216379457035`*^9}},ExpressionUUID->"522c5807-147e-46cf-883a-\
4f1427140adf"],

Cell[BoxData[
 RowBox[{
  RowBox[{"NonStandardDetectorGeometry", "[", 
   RowBox[{"experiment_", ",", "\[Xi]_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"Association", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\"\<LHCb-downstream-full\>\"", ",", "\[Xi]"}], "}"}], 
       "\[Rule]", 
       RowBox[{"LHCbfarDetectorVolumeTemp", "[", 
        RowBox[{"\"\<LHCb-downstream\>\"", ",", "\[Xi]"}], "]"}]}], ",", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\"\<LHCb-downstream-T-tracks-only\>\"", ",", "\[Xi]"}], 
        "}"}], "\[Rule]", 
       RowBox[{"LHCbfarSciFiDetectorVolumeTemp", "[", 
        RowBox[{"\"\<LHCb-downstream-T-tracks-only\>\"", ",", "\[Xi]"}], 
        "]"}]}], ",", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\"\<LHCb-downstream\>\"", ",", "\[Xi]"}], "}"}], "\[Rule]", 
       RowBox[{"LHCbfarSciFiDetectorVolumeTemp", "[", 
        RowBox[{"\"\<LHCb-downstream\>\"", ",", "\[Xi]"}], "]"}]}]}], "}"}], 
    "]"}], "[", 
   RowBox[{"{", 
    RowBox[{"experiment", ",", "\[Xi]"}], "}"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.886221639878272*^9, 3.886221668035591*^9}, {
  3.886226596528528*^9, 3.886226600910963*^9}, {3.886227317747076*^9, 
  3.886227368488352*^9}, {3.8933414645164595`*^9, 3.8933414865445137`*^9}, {
  3.8945281911820483`*^9, 3.8945281961884713`*^9}, {3.894528245630566*^9, 
  3.8945282610892143`*^9}, {3.896930388741111*^9, 3.8969303969709253`*^9}, {
  3.8974635719203043`*^9, 3.8974635725120106`*^9}, {3.904982651983615*^9, 
  3.9049826677716336`*^9}, {3.9074067820176296`*^9, 3.907406782032708*^9}, {
  3.914565064559857*^9, 3.914565064563868*^9}, {3.9145651522528257`*^9, 
  3.9145651522568216`*^9}, {3.91456555925697*^9, 3.914565559946254*^9}},
 CellLabel->
  "In[1033]:=",ExpressionUUID->"71687223-95c7-4770-93a6-52296e69baf8"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Common definition", "Subsection",
 CellChangeTimes->{{3.886221733658455*^9, 
  3.8862217358164263`*^9}},ExpressionUUID->"888d3710-ab9f-4503-a23a-\
e3e62f92c089"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Full", " ", "geometry", " ", "of", " ", "the", " ", "detector"}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"DetectorGeometry", "[", "experiment_", "]"}], ":=", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"StringContainsQ", "[", 
       RowBox[{"experiment", ",", "\"\<LHCb-downstream\>\""}], "]"}], ",", 
      RowBox[{"NonStandardDetectorGeometry", "[", 
       RowBox[{"experiment", ",", "0"}], "]"}], ",", 
      RowBox[{"StandardDetectorGeometry", "[", 
       RowBox[{"experiment", ",", 
        RowBox[{"GeometryExperiment", "[", "experiment", "]"}], ",", "0"}], 
       "]"}]}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"EndDetectorSliceGeometry", "[", "experiment_", "]"}], ":=", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"MemberQ", "[", 
       RowBox[{"explistlhcb", ",", "experiment"}], "]"}], ",", 
      RowBox[{"NonStandardDetectorGeometry", "[", 
       RowBox[{"experiment", ",", 
        RowBox[{"Max", "[", 
         RowBox[{
          RowBox[{"Min", "[", 
           RowBox[{"0.99", ",", 
            RowBox[{"1", "-", 
             FractionBox["0.2", 
              RowBox[{
              "dxLongDetectorExperiment", "[", "experiment", "]"}]]}]}], 
           "]"}], ",", "0"}], "]"}]}], "]"}], ",", 
      RowBox[{"StandardDetectorGeometry", "[", 
       RowBox[{"experiment", ",", 
        RowBox[{"GeometryExperiment", "[", "experiment", "]"}], ",", 
        RowBox[{"Max", "[", 
         RowBox[{
          RowBox[{"Min", "[", 
           RowBox[{"0.99", ",", 
            RowBox[{"1", "-", 
             FractionBox["0.2", 
              RowBox[{
              "dxLongDetectorExperiment", "[", "experiment", "]"}]]}]}], 
           "]"}], ",", "0"}], "]"}]}], "]"}]}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Graphics3D", "[", 
     RowBox[{"EndDetectorSliceGeometry", "[", "\"\<HIKE\>\"", "]"}], "]"}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"\[Theta]minmaxBlock", "[", 
      RowBox[{"experiment_", ",", "NN_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"Block", "[", 
       RowBox[{
        RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"DecayVolume", "=", 
          RowBox[{"DecayVolumeGeometry", "[", 
           RowBox[{"experiment", ",", 
            RowBox[{"GeometryExperiment", "[", "experiment", "]"}], ",", 
            RowBox[{
            "DetectorPlaneOrientationExperiment", "[", "experiment", "]"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"DetVol", "=", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
             "DecayVolumeAsDetectorExperiment", "[", "experiment", "]"}], 
             "\[Equal]", "\"\<False\>\""}], ",", 
            RowBox[{"DetectorGeometry", "[", 
             RowBox[{"experiment", ",", 
              RowBox[{
              "DetectorPlaneOrientationExperiment", "[", "experiment", "]"}], 
              ",", 
              RowBox[{"GeometryExperiment", "[", "experiment", "]"}]}], 
             "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"pointsDecayVolume", "=", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{"ArcCos", "[", 
               RowBox[{
                RowBox[{"#", "[", 
                 RowBox[{"[", "3", "]"}], "]"}], "/", 
                RowBox[{"(", 
                 RowBox[{"\[Sqrt]", 
                  RowBox[{"(", 
                   RowBox[{
                    SuperscriptBox[
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "2"], "+", 
                    SuperscriptBox[
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "2"], "+", 
                    SuperscriptBox[
                    RowBox[{"#", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "2"]}], ")"}]}], ")"}]}], 
               "]"}], "}"}], "&"}], "/@", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"RandomPoint", "[", "DecayVolume", "]"}], ",", "NN"}], 
             "]"}]}], "//", "Flatten"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"pointsDet", "=", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
             "DecayVolumeAsDetectorExperiment", "[", "experiment", "]"}], 
             "\[Equal]", "\"\<False\>\""}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"{", 
                RowBox[{"ArcCos", "[", 
                 RowBox[{
                  RowBox[{"#", "[", 
                   RowBox[{"[", "3", "]"}], "]"}], "/", 
                  RowBox[{"(", 
                   RowBox[{"\[Sqrt]", 
                    RowBox[{"(", 
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "2"], "+", 
                    SuperscriptBox[
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "2"], "+", 
                    SuperscriptBox[
                    RowBox[{"#", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "2"]}], ")"}]}], ")"}]}], 
                 "]"}], "}"}], "&"}], "/@", 
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"RandomPoint", "[", "DetVol", "]"}], ",", "NN"}], 
               "]"}]}], "//", "Flatten"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"\[Theta]min", "=", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
             "DecayVolumeAsDetectorExperiment", "[", "experiment", "]"}], 
             "\[Equal]", "\"\<False\>\""}], ",", 
            RowBox[{"Max", "[", 
             RowBox[{
              RowBox[{"Min", "[", "pointsDecayVolume", "]"}], ",", 
              RowBox[{"Min", "[", "pointsDet", "]"}]}], "]"}], ",", 
            RowBox[{"Min", "[", "pointsDecayVolume", "]"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"\[Theta]max", "=", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
             "DecayVolumeAsDetectorExperiment", "[", "experiment", "]"}], 
             "\[Equal]", "\"\<False\>\""}], ",", 
            RowBox[{"Min", "[", 
             RowBox[{
              RowBox[{"Max", "[", "pointsDecayVolume", "]"}], ",", 
              RowBox[{"Max", "[", "pointsDet", "]"}]}], "]"}], ",", 
            RowBox[{"Max", "[", "pointsDecayVolume", "]"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"\[Theta]min", ",", "\[Theta]max"}], "}"}]}]}], 
       "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
      RowBox[{"\[Theta]minmaxBlock", "[", 
       RowBox[{"\"\<SHADOWS-Gaia\>\"", ",", 
        SuperscriptBox["10", "5"]}], "]"}]}]}], "*)"}]}]}]], "Input",
 CellChangeTimes->{{3.8529588997745743`*^9, 3.852958973128945*^9}, {
   3.8529594309881697`*^9, 3.8529594935736513`*^9}, {3.8529598153406224`*^9, 
   3.8529598160075216`*^9}, {3.853296925914568*^9, 3.8532969259155655`*^9}, {
   3.862460752453162*^9, 3.862460754007432*^9}, {3.8624610365180745`*^9, 
   3.8624611055989447`*^9}, {3.862461628269144*^9, 3.8624616288665943`*^9}, {
   3.862462145499759*^9, 3.862462148667593*^9}, {3.877159478056405*^9, 
   3.877159502727092*^9}, {3.8775410358802795`*^9, 3.877541056478628*^9}, {
   3.877541087360215*^9, 3.877541128450347*^9}, {3.8775412369917545`*^9, 
   3.8775412941460447`*^9}, 3.877541536186778*^9, {3.8775420818792644`*^9, 
   3.8775420822888594`*^9}, {3.8835904231051364`*^9, 3.883590445164569*^9}, {
   3.883590490941985*^9, 3.8835904991647277`*^9}, {3.8835905381436014`*^9, 
   3.883590594066033*^9}, {3.883590860844515*^9, 3.883590862674817*^9}, {
   3.8848388110596066`*^9, 3.8848388868010178`*^9}, {3.8861832281062684`*^9, 
   3.8861832615061674`*^9}, {3.8861833016218934`*^9, 
   3.8861833031658535`*^9}, {3.8862193867840805`*^9, 
   3.8862194036841593`*^9}, {3.886220031389803*^9, 3.88622006789602*^9}, {
   3.886221673544541*^9, 3.886221742501668*^9}, {3.8862261644511986`*^9, 
   3.8862261644627576`*^9}, {3.8862265357743053`*^9, 
   3.8862265568531537`*^9}, {3.8862273819422812`*^9, 
   3.8862274219334264`*^9}, {3.886227506981105*^9, 3.8862275099112635`*^9}, 
   3.8880459732885733`*^9, {3.8933148501858635`*^9, 3.8933148501908846`*^9}, {
   3.8933181777206345`*^9, 3.893318177724665*^9}, {3.8933405823826227`*^9, 
   3.8933405823856883`*^9}, {3.8933414645204706`*^9, 3.893341464522479*^9}, {
   3.8945281600130424`*^9, 3.8945281825126047`*^9}, {3.8945288535223093`*^9, 
   3.8945288550707064`*^9}, {3.9050095148219285`*^9, 3.9050095494179325`*^9}, 
   3.9074067820366983`*^9, 3.91015860283333*^9, 3.9101594147512093`*^9, {
   3.910159690086485*^9, 3.9101596921876707`*^9}, 3.9101607871686735`*^9, 
   3.9101619417934337`*^9, {3.910162567808735*^9, 3.91016256857854*^9}, {
   3.9101627817835474`*^9, 3.9101628544435883`*^9}, {3.9101629190752335`*^9, 
   3.910162939845947*^9}, {3.910163003056778*^9, 3.910163007973217*^9}, {
   3.910246973882617*^9, 3.910246973882617*^9}, 3.914565622532765*^9},
 CellLabel->
  "In[1034]:=",ExpressionUUID->"9c410249-f331-4058-ba5e-de7dc12a2761"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Plane of the end of the detector", "Subsection",
 CellChangeTimes->{{3.886225020832206*^9, 
  3.886225025115929*^9}},ExpressionUUID->"12ed773d-bd0d-4739-ad8a-\
63bae640e537"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
  "PlaneEndOfDetectorExperimentAxisTransverse", "[", "experiment_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "dx", ",", "dy", ",", "geom", ",", "xlong", ",", "xc", ",", "yc"}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"geom", "=", 
      RowBox[{"GeometryExperiment", "[", "experiment", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"dx", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"geom", "\[Equal]", "\"\<Box\>\""}], ",", 
        RowBox[{"dxDetectorExperiment", "[", 
         RowBox[{"experiment", ",", 
          RowBox[{"xLongMaxDetectorExperiment", "[", "experiment", "]"}]}], 
         "]"}], ",", 
        RowBox[{"RouterDetectorExperiment", "[", 
         RowBox[{"experiment", ",", 
          RowBox[{"xLongMaxDetectorExperiment", "[", "experiment", "]"}]}], 
         "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"dy", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"geom", "\[Equal]", "\"\<Box\>\""}], ",", 
        RowBox[{"dyDetectorExperiment", "[", 
         RowBox[{"experiment", ",", 
          RowBox[{"xLongMaxDetectorExperiment", "[", "experiment", "]"}]}], 
         "]"}], ",", 
        RowBox[{"RouterDetectorExperiment", "[", 
         RowBox[{"experiment", ",", 
          RowBox[{"xLongMaxDetectorExperiment", "[", "experiment", "]"}]}], 
         "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"xlong", "=", 
      RowBox[{"xLongMaxDetectorExperiment", "[", "experiment", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"xc", "=", 
      RowBox[{"xToDetectorCenterExperiment", "[", "experiment", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"yc", "=", 
      RowBox[{"yToDetectorCenterExperiment", "[", "experiment", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Polygon", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"xc", "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "/", "2"}], ")"}], "dx"}]}], ",", 
          RowBox[{"yc", "-", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "/", "2"}], ")"}], "dy"}]}], ",", "xlong"}], "}"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"xc", "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "/", "2"}], ")"}], "dx"}]}], ",", 
          RowBox[{"yc", "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "/", "2"}], ")"}], "dy"}]}], ",", "xlong"}], "}"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"xc", "-", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "/", "2"}], ")"}], "dx"}]}], ",", 
          RowBox[{"yc", "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "/", "2"}], ")"}], "dy"}]}], ",", "xlong"}], "}"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"xc", "-", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "/", "2"}], ")"}], "dx"}]}], ",", 
          RowBox[{"yc", "-", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "/", "2"}], ")"}], "dy"}]}], ",", "xlong"}], 
         "}"}]}], "}"}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
  "PlaneEndOfDetectorExperimentAxisParallel", "[", "experiment_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "dx", ",", "dz", ",", "geom", ",", "xlong", ",", "xc", ",", "zc"}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"geom", "=", 
      RowBox[{"GeometryExperiment", "[", "experiment", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"dx", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"geom", "\[Equal]", "\"\<Box\>\""}], ",", 
        RowBox[{"dxDetectorExperiment", "[", 
         RowBox[{"experiment", ",", 
          RowBox[{"xLongMaxDetectorExperiment", "[", "experiment", "]"}]}], 
         "]"}], ",", 
        RowBox[{"RouterDetectorExperiment", "[", 
         RowBox[{"experiment", ",", 
          RowBox[{"xLongMaxDetectorExperiment", "[", "experiment", "]"}]}], 
         "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"dz", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"geom", "\[Equal]", "\"\<Box\>\""}], ",", 
        RowBox[{"dzDetectorExperiment", "[", "experiment", "]"}], ",", 
        RowBox[{"RouterDetectorExperiment", "[", 
         RowBox[{"experiment", ",", 
          RowBox[{"xLongMaxDetectorExperiment", "[", "experiment", "]"}]}], 
         "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"xlong", "=", 
      RowBox[{"xLongMaxDetectorExperiment", "[", "experiment", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"xc", "=", 
      RowBox[{"xToDetectorCenterExperiment", "[", "experiment", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"zc", "=", 
      RowBox[{"zToDetectorCenterExperiment", "[", "experiment", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Polygon", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"xc", "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "/", "2"}], ")"}], "dx"}]}], ",", "xlong", ",", 
          RowBox[{"zc", "-", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "/", "2"}], ")"}], "dz"}]}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"xc", "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "/", "2"}], ")"}], "dx"}]}], ",", "xlong", ",", 
          RowBox[{"zc", "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "/", "2"}], ")"}], "dz"}]}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"xc", "-", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "/", "2"}], ")"}], "dx"}]}], ",", "xlong", ",", 
          RowBox[{"zc", "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "/", "2"}], ")"}], "dz"}]}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"xc", "-", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "/", "2"}], ")"}], "dx"}]}], ",", "xlong", ",", 
          RowBox[{"zc", "-", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "/", "2"}], ")"}], "dz"}]}]}], "}"}]}], "}"}], 
      "]"}]}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PlaneEndOfDetectorExperiment", "[", "experiment_", "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"DetectorPlaneOrientationExperiment", "[", "experiment", "]"}], 
     "\[Equal]", "\"\<Parallel\>\""}], ",", 
    RowBox[{
    "PlaneEndOfDetectorExperimentAxisParallel", "[", "experiment", "]"}], ",", 
    RowBox[{
    "PlaneEndOfDetectorExperimentAxisTransverse", "[", "experiment", "]"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DetectorEndCrossSectionExperiment", "[", "experiment_", "]"}], ":=", 
  RowBox[{"RegionIntersection", "[", 
   RowBox[{
    RowBox[{"PlaneEndOfDetectorExperiment", "[", "experiment", "]"}], ",", 
    RowBox[{"DetectorGeometry", "[", "experiment", "]"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.8529592098965836`*^9, 3.8529592713108063`*^9}, {
   3.852959565202758*^9, 3.852959568418771*^9}, {3.852959639604207*^9, 
   3.8529596768319035`*^9}, {3.8624611734672327`*^9, 
   3.8624612207244167`*^9}, {3.8624616283129263`*^9, 3.862461628337119*^9}, {
   3.8624672178625555`*^9, 3.8624672180200996`*^9}, {3.8771594780876503`*^9, 
   3.8771595027583675`*^9}, {3.8850104227651997`*^9, 
   3.8850104233336883`*^9}, {3.885010456866689*^9, 3.8850104570278654`*^9}, {
   3.886216004922296*^9, 3.886216026538188*^9}, {3.8862161314546547`*^9, 
   3.886216142338498*^9}, {3.886217365905023*^9, 3.886217368647891*^9}, {
   3.886219358903607*^9, 3.8862193770997376`*^9}, {3.886221786830772*^9, 
   3.886221806133381*^9}, {3.88622616446874*^9, 3.8862261644960766`*^9}, 
   3.8863241194848156`*^9, 3.886324160747815*^9, 3.888050331364544*^9, {
   3.8916777797601814`*^9, 3.8916777986888156`*^9}, {3.8916779008836155`*^9, 
   3.8916779441825404`*^9}, {3.8916779919369555`*^9, 3.891678005353645*^9}, {
   3.891678114554761*^9, 3.891678114570367*^9}, {3.8916803434496775`*^9, 
   3.8916803523717403`*^9}, {3.893238552333947*^9, 3.8932385528382983`*^9}, {
   3.893340582390877*^9, 3.893340612472845*^9}, {3.893518017387412*^9, 
   3.8935180953638945`*^9}, 3.8935181371254716`*^9, {3.8935181966814365`*^9, 
   3.8935182032108994`*^9}, {3.893518246665741*^9, 3.893518369591623*^9}, {
   3.893518404520686*^9, 3.8935187450703344`*^9}, {3.8935188709891224`*^9, 
   3.8935189241314893`*^9}, {3.893518960924904*^9, 3.893518963893947*^9}, {
   3.893519025086424*^9, 3.8935190369198055`*^9}, {3.893519076230219*^9, 
   3.893519112572867*^9}, {3.893519178735259*^9, 3.8935191827540765`*^9}, {
   3.8945285389689245`*^9, 3.8945285512403464`*^9}, {3.910240919432642*^9, 
   3.9102409194396515`*^9}, {3.9102468768982067`*^9, 3.910246916510205*^9}, 
   3.912657765303786*^9},
 CellLabel->
  "In[1036]:=",ExpressionUUID->"c3fb9e7e-496d-4c3a-be72-0a6440bff7d3"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[Theta]", 
    RowBox[{"min", "/", "max"}]], TraditionalForm]],ExpressionUUID->
  "a60e8b53-5abf-4aed-b339-5d93c704c074"],
 " - minimal and maximal angles covered by the end of the detector. If the \
decay volume is fully off-axis, than the minimal angle is defined by the \
minimal angle covered by end of the decay volume"
}], "Subsection",
 CellChangeTimes->{{3.8850103028371077`*^9, 
  3.8850103684893785`*^9}},ExpressionUUID->"ea935def-d43b-4b68-8039-\
d554d2678e28"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"cellmeasure", "[", "\"\<CHARM\>\"", "]"}], "=", ".1"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"cellmeasure", "[", "\"\<NA62-dump\>\"", "]"}], "=", 
   RowBox[{
    RowBox[{"cellmeasure", "[", "\"\<NA62-dump\>\"", "]"}], "=", ".05"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"cellmeasure", "[", "exp", "]"}], "=", ".05"}], ",", 
   RowBox[{"{", 
    RowBox[{"exp", ",", "explistship"}], "}"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"cellmeasure", "[", "exp", "]"}], "=", ".01"}], ",", 
   RowBox[{"{", 
    RowBox[{"exp", ",", "explistlhcb"}], "}"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"cellkeys", "=", 
  RowBox[{
   RowBox[{"Keys", "[", 
    RowBox[{"DownValues", "@", "cellmeasure"}], "]"}], "[", 
   RowBox[{"[", 
    RowBox[{"All", ",", "1", ",", "1"}], "]"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]func", "[", 
    RowBox[{"x_", ",", "y_", ",", "z_"}], "]"}], "=", 
   RowBox[{"ArcCos", "[", 
    RowBox[{"z", "/", 
     RowBox[{"Sqrt", "[", 
      RowBox[{
       RowBox[{"x", "^", "2"}], "+", 
       RowBox[{"y", "^", "2"}], "+", 
       RowBox[{"z", "^", "2"}]}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]minmaxBlock", "[", "experiment_", "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ifdecdet", "=", 
       RowBox[{"!", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"DecayVolumeAsDetectorExperiment", "[", "experiment", "]"}],
           "//", "Symbol"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
        "Geometry", " ", "of", " ", "the", " ", "decay", " ", "volume"}], ",",
         " ", "detector", ",", " ", 
        RowBox[{
         RowBox[{"and", " ", "the", " ", "cross"}], "-", 
         RowBox[{
         "section", " ", "of", " ", "the", " ", "end", " ", "of", " ", "the", 
          " ", "detector"}]}]}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"DecayVolume", "=", 
       RowBox[{"DecayVolumeGeometry", "[", "experiment", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"ifdecdet", ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"DetectorVolume", ",", "EndDetectorVolume"}], "}"}], "=", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"DetectorGeometry", "[", "experiment", "]"}], ",", 
            RowBox[{"EndDetectorSliceGeometry", "[", "experiment", "]"}]}], 
           "}"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{
           "Whether", " ", "the", " ", "decay", " ", "volume", " ", "lies", 
            " ", "on"}], "-", "beamline"}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"WhetherLiesOnAxis", "=", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
             "DetectorPlaneOrientationExperiment", "[", "experiment", "]"}], 
             "\[Equal]", "\"\<Transverse\>\""}], ",", 
            RowBox[{"RegionMeasure", "[", 
             RowBox[{"RegionIntersection", "[", 
              RowBox[{"DetectorVolume", ",", 
               RowBox[{"Point", "[", 
                RowBox[{"{", 
                 RowBox[{"0", ",", "0", ",", 
                  RowBox[{
                  "xLongMaxDetectorExperiment", "[", "experiment", "]"}]}], 
                 "}"}], "]"}]}], "]"}], "]"}], ",", 
            RowBox[{"RegionMeasure", "[", 
             RowBox[{"RegionIntersection", "[", 
              RowBox[{"DetectorVolume", ",", 
               RowBox[{"Point", "[", 
                RowBox[{"{", 
                 RowBox[{"0", ",", 
                  RowBox[{
                  "xLongMaxDetectorExperiment", "[", "experiment", "]"}], ",",
                   "0"}], "}"}], "]"}]}], "]"}], "]"}]}], "]"}]}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"WhetherLiesOnAxis", "=", 
          RowBox[{"RegionMeasure", "[", 
           RowBox[{"RegionIntersection", "[", 
            RowBox[{"DecayVolume", ",", 
             RowBox[{"Point", "[", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0", ",", 
                RowBox[{
                "zMaxDecayVolumeExperiment", "[", "experiment", "]"}]}], 
               "}"}], "]"}]}], "]"}], "]"}]}], ";"}]}], "\[IndentingNewLine]",
        "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"Resolution", " ", "of", " ", "discretization", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"lower", " ", "value", " ", "is", " ", "better"}], ",", " ", 
          RowBox[{"but", " ", "slower"}]}], ")"}]}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"MaxCellMeasureVal", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"MemberQ", "[", 
          RowBox[{"cellkeys", ",", "experiment"}], "]"}], ",", 
         RowBox[{"cellmeasure", "[", "experiment", "]"}], ",", "Automatic"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "Discretization", " ", "of", " ", "the", " ", "decay", " ", "volume"}],
        "*)"}], "\[IndentingNewLine]", 
      RowBox[{"DiscretizedDecayVolume", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"MemberQ", "[", 
          RowBox[{"explistship", ",", "experiment"}], "]"}], ",", 
         RowBox[{"DiscretizeRegion", "[", 
          RowBox[{
           RowBox[{"MeshRegion", "[", "DecayVolume", "]"}], ",", 
           RowBox[{"MaxCellMeasure", "\[Rule]", 
            RowBox[{"\"\<Volume\>\"", "->", "MaxCellMeasureVal"}]}]}], "]"}], 
         ",", 
         RowBox[{"BoundaryDiscretizeRegion", "[", 
          RowBox[{"DecayVolume", ",", 
           RowBox[{"MaxCellMeasure", "\[Rule]", "MaxCellMeasureVal"}]}], 
          "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"DecayVolumeCoordinates", "=", 
       RowBox[{"MeshCoordinates", "[", "DiscretizedDecayVolume", "]"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
        "Find", " ", "the", " ", "smallest", " ", "polar", " ", "angle", " ", 
         "covered", " ", "by", " ", "the", " ", "decay", " ", "volume"}], ",",
         " ", 
        RowBox[{
        "and", " ", "the", " ", "corresponding", " ", "coordinates"}]}], 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"NonTrivialDecayVolumeCond", "=", 
       RowBox[{"StringContainsQ", "[", 
        RowBox[{"experiment", ",", 
         RowBox[{"{", 
          RowBox[{"\"\<SHiP\>\"", ",", "\"\<LHCb-muon-chamber\>\""}], "}"}]}],
         "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", "Point\[Theta]minDecayVolume1", "}"}], "=", 
       RowBox[{
        RowBox[{
         RowBox[{"RegionNearest", "[", 
          RowBox[{"#", ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "]"}], "&"}], "/@", 
        RowBox[{"{", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"!", "NonTrivialDecayVolumeCond"}], ",", "DecayVolume", 
           ",", "DiscretizedDecayVolume"}], "]"}], "}"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\[Theta]minDecayVolume1", ",", "\[Theta]minDecayVolume2"}], 
        "}"}], "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\[Theta]func", "@@", "Point\[Theta]minDecayVolume1"}], ",", 
         RowBox[{"Min", "[", 
          RowBox[{"\[Theta]func", "@@@", "DecayVolumeCoordinates"}], "]"}]}], 
        "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Theta]minIndexDecayVolume", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Position", "[", 
          RowBox[{
           RowBox[{"\[Theta]func", "@@@", "DecayVolumeCoordinates"}], ",", 
           RowBox[{"Min", "[", 
            RowBox[{"\[Theta]func", "@@@", "DecayVolumeCoordinates"}], 
            "]"}]}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Point\[Theta]minDecayVolume2", "=", 
       RowBox[{"DecayVolumeCoordinates", "[", 
        RowBox[{"[", "\[Theta]minIndexDecayVolume", "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Theta]minDecayVolume", "=", 
       RowBox[{"Min", "[", 
        RowBox[{"\[Theta]minDecayVolume1", ",", "\[Theta]minDecayVolume2"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Point\[Theta]minDecayVolume", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"\[Theta]minDecayVolume", "==", "\[Theta]minDecayVolume1"}], 
         ",", "Point\[Theta]minDecayVolume1", ",", 
         "Point\[Theta]minDecayVolume2"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "Finding", " ", "the", " ", "maximal", " ", "polar", " ", "angle", " ",
         "and", " ", "the", " ", "corresponding", " ", "coordinate"}], "*)"}],
       "\[IndentingNewLine]", 
      RowBox[{"\[Theta]maxDecayVolume", "=", 
       RowBox[{"Max", "[", 
        RowBox[{"\[Theta]func", "@@@", "DecayVolumeCoordinates"}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"\[Theta]maxIndexDecayVolume", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Position", "[", 
          RowBox[{
           RowBox[{"\[Theta]func", "@@@", "DecayVolumeCoordinates"}], ",", 
           RowBox[{"Max", "[", 
            RowBox[{"\[Theta]func", "@@@", "DecayVolumeCoordinates"}], 
            "]"}]}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Theta]minmaxCoordinatesDecVol", "=", 
       RowBox[{"{", 
        RowBox[{"Point\[Theta]minDecayVolume", ",", 
         RowBox[{"DecayVolumeCoordinates", "[", 
          RowBox[{"[", "\[Theta]maxIndexDecayVolume", "]"}], "]"}]}], "}"}]}],
       ";", "\[IndentingNewLine]", 
      RowBox[{"\[Theta]minmaxDecVol", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"WhetherLiesOnAxis", "\[Equal]", "1"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "\[Theta]maxDecayVolume"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"\[Theta]minDecayVolume", ",", "\[Theta]maxDecayVolume"}], 
          "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"output", "=", 
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{
         "\[Theta]minmaxCoordinatesDecVol", ",", "\[Theta]minmaxDecVol"}], 
         "}"}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"ifdecdet", ",", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Discretization", " ", "of", " ", "the", " ", "detector"}], 
         "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"DiscretizedDetectorVolume", "=", 
          RowBox[{"If", "[", 
           RowBox[{"ifdecdet", ",", 
            RowBox[{"BoundaryDiscretizeRegion", "[", 
             RowBox[{"DetectorVolume", ",", 
              RowBox[{"MaxCellMeasure", "\[Rule]", "MaxCellMeasureVal"}]}], 
             "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"DetectorCoordinates", "=", 
          RowBox[{"If", "[", 
           RowBox[{"ifdecdet", ",", 
            RowBox[{
            "MeshCoordinates", "[", "DiscretizedDetectorVolume", "]"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"seccoord", "=", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
             "DetectorPlaneOrientationExperiment", "[", "experiment", "]"}], 
             "\[Equal]", "\"\<Transverse\>\""}], ",", "3", ",", "2"}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"DetEndCoordinates", "=", 
          RowBox[{"Select", "[", 
           RowBox[{"DetectorCoordinates", ",", 
            RowBox[{
             RowBox[{
              RowBox[{"#", "[", 
               RowBox[{"[", "seccoord", "]"}], "]"}], "==", 
              RowBox[{"Max", "[", 
               RowBox[{"DetectorCoordinates", "[", 
                RowBox[{"[", 
                 RowBox[{"All", ",", "seccoord"}], "]"}], "]"}], "]"}]}], 
             "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"DetEndCoordinates", "=", 
            RowBox[{"If", "[", 
             RowBox[{"ifdecdet", ",", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                 "DetectorPlaneOrientationExperiment", "[", "experiment", 
                  "]"}], "\[Equal]", "\"\<Transverse\>\""}], ",", 
                RowBox[{"Select", "[", 
                 RowBox[{"DetectorCoordinates", ",", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ">", 
                    RowBox[{"0.995", 
                    RowBox[{
                    "xLongMaxDetectorExperiment", "[", "experiment", 
                    "]"}]}]}], "&"}]}], "]"}], ",", 
                RowBox[{"Select", "[", 
                 RowBox[{"DetectorCoordinates", ",", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ">", 
                    RowBox[{"0.995", 
                    RowBox[{
                    "xLongMaxDetectorExperiment", "[", "experiment", 
                    "]"}]}]}], "&"}]}], "]"}]}], "]"}]}], "]"}]}], ";"}], 
          "*)"}], "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{
           "Find", " ", "the", " ", "smallest", " ", "polar", " ", "angle", 
            " ", "covered", " ", "by", " ", "the", " ", "end", " ", "of", " ",
             "the", " ", "detector"}], ",", " ", 
           RowBox[{
           "and", " ", "the", " ", "corresponding", " ", "coordinates"}]}], 
          "*)"}], "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", "Point\[Theta]minDetEnd1", "}"}], "=", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"experiment", "!=", "\"\<LHCb-downstream\>\""}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"RegionNearest", "[", 
               RowBox[{"#", ",", 
                RowBox[{"{", 
                 RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "]"}], "&"}], "/@", 
             RowBox[{"{", "EndDetectorVolume", "}"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"{", 
              RowBox[{"999.", ",", "999.", ",", "999."}], "}"}], "}"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"\[Theta]minDetEnd1", ",", "\[Theta]minDetEnd2"}], "}"}], 
          "=", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"\[Theta]func", "@@", "Point\[Theta]minDetEnd1"}], ",", 
            RowBox[{"Min", "[", 
             RowBox[{"\[Theta]func", "@@@", "DetEndCoordinates"}], "]"}]}], 
           "}"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"\[Theta]minIndexDetEnd", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"Position", "[", 
             RowBox[{
              RowBox[{"\[Theta]func", "@@@", "DetEndCoordinates"}], ",", 
              "\[Theta]minDetEnd2"}], "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"Point\[Theta]minDetEnd2", "=", 
          RowBox[{"If", "[", 
           RowBox[{"ifdecdet", ",", 
            RowBox[{"DetEndCoordinates", "[", 
             RowBox[{"[", "\[Theta]minIndexDetEnd", "]"}], "]"}]}], "]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"\[Theta]minDetEnd", "=", 
          RowBox[{"Min", "[", 
           RowBox[{"\[Theta]minDetEnd1", ",", "\[Theta]minDetEnd2"}], "]"}]}],
          ";", "\[IndentingNewLine]", 
         RowBox[{"Point\[Theta]minDetEnd", "=", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"\[Theta]minDetEnd", "==", "\[Theta]minDetEnd1"}], ",", 
            "Point\[Theta]minDetEnd1", ",", "Point\[Theta]minDetEnd2"}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{
           "Find", " ", "the", " ", "largest", " ", "polar", " ", "angle", 
            " ", "covered", " ", "by", " ", "the", " ", "decay", " ", 
            "volume", " ", "and", " ", "the", " ", "end", " ", "of", " ", 
            "the", " ", "detector"}], ",", " ", 
           RowBox[{
           "and", " ", "the", " ", "corresponding", " ", "coordinates"}]}], 
          "*)"}], "\[IndentingNewLine]", 
         RowBox[{"\[Theta]maxDetEnd", "=", 
          RowBox[{"Max", "[", 
           RowBox[{"\[Theta]func", "@@@", "DetEndCoordinates"}], "]"}]}], ";",
          "\[IndentingNewLine]", 
         RowBox[{"\[Theta]maxIndexDetEnd", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"Position", "[", 
             RowBox[{
              RowBox[{"\[Theta]func", "@@@", "DetEndCoordinates"}], ",", 
              RowBox[{"Max", "[", 
               RowBox[{"\[Theta]func", "@@@", "DetEndCoordinates"}], "]"}]}], 
             "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"\[Theta]minmaxCoordinatesDet", "=", 
          RowBox[{"{", 
           RowBox[{"Point\[Theta]minDetEnd", ",", 
            RowBox[{"DetEndCoordinates", "[", 
             RowBox[{"[", "\[Theta]maxIndexDetEnd", "]"}], "]"}]}], "}"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"\[Theta]minmaxDet", "=", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"WhetherLiesOnAxis", "\[Equal]", "1"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "\[Theta]maxDetEnd"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"\[Theta]minDetEnd", ",", "\[Theta]maxDetEnd"}], "}"}]}],
            "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"output", "=", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
             "\[Theta]minmaxCoordinatesDecVol", ",", "\[Theta]minmaxDecVol"}],
              "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
             "\[Theta]minmaxCoordinatesDet", ",", "\[Theta]minmaxDet"}], 
             "}"}]}], "}"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
      "\[IndentingNewLine]", "output"}]}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"For", " ", "test"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"blockexp", "[", "experiment_", "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{"Block", "[", 
        RowBox[{
         RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"data", "=", 
           RowBox[{"\[Theta]minmaxBlock", "[", "experiment", "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"{", "experiment", "}"}], ",", "data"}], "]"}]}]}], 
        "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
       "experimentlist"}], "=", 
      RowBox[{
       RowBox[{"Keys", "[", 
        RowBox[{"DownValues", "[", "FacilityExperiment", "]"}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "1", ",", "1"}], "]"}], "]"}]}]}], 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"Keys", "[", "DetectorPlaneOrientation", "]"}], "//", "Sort"}], 
     "*)"}], ";", "\[IndentingNewLine]", 
    RowBox[{"tabb", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"blockexp", "[", "experiment", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"experiment", ",", 
         RowBox[{"Take", "[", 
          RowBox[{"experimentlist", ",", 
           RowBox[{"{", 
            RowBox[{"36", ",", "42"}], "}"}]}], "]"}]}], "}"}]}], "]"}]}], 
    ";", "\[IndentingNewLine]", 
    RowBox[{"tabb", "//", "TableForm"}]}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.910427971728239*^9, 3.910428093547777*^9}, {
   3.9104281601786942`*^9, 3.910428209987998*^9}, {3.9104282442789555`*^9, 
   3.9104282446400137`*^9}, {3.9104282747588625`*^9, 3.910428291903677*^9}, {
   3.910428323022868*^9, 3.9104283694748783`*^9}, {3.9104285412078342`*^9, 
   3.9104286935757656`*^9}, {3.9104287423068824`*^9, 
   3.9104287440765038`*^9}, {3.91042881999759*^9, 3.910428821768083*^9}, {
   3.9104288579883404`*^9, 3.9104288727278986`*^9}, {3.910429025277788*^9, 
   3.9104290324423757`*^9}, {3.9104291251777763`*^9, 3.910429189736585*^9}, {
   3.9104292960094337`*^9, 3.910429296304062*^9}, {3.9104295574564466`*^9, 
   3.9104295631268587`*^9}, {3.9104296175064597`*^9, 
   3.9104296530065002`*^9}, {3.9104297070057535`*^9, 3.910429884247954*^9}, {
   3.9104302532058754`*^9, 3.910430397684826*^9}, {3.910430540445868*^9, 
   3.910430597814537*^9}, {3.910431398186761*^9, 3.910431433314896*^9}, {
   3.910431477148327*^9, 3.9104314930920415`*^9}, {3.9104318987399216`*^9, 
   3.91043190310602*^9}, {3.910431989709073*^9, 3.910431996952445*^9}, {
   3.910432038126526*^9, 3.9104320393345003`*^9}, {3.910432329761698*^9, 
   3.9104323309015474`*^9}, {3.910432421007802*^9, 3.910432451771052*^9}, {
   3.9104324825675507`*^9, 3.910432509554553*^9}, {3.9104326697783113`*^9, 
   3.910432670298803*^9}, {3.9104331090411463`*^9, 3.91043311007189*^9}, {
   3.91043321909475*^9, 3.9104332601457095`*^9}, {3.9104339033288574`*^9, 
   3.910433920999816*^9}, {3.910433963522091*^9, 3.910433968261773*^9}, {
   3.910434620065612*^9, 3.910434620390705*^9}, {3.9117252450705423`*^9, 
   3.9117253245526547`*^9}, 3.9119646799304976`*^9, {3.914562059257148*^9, 
   3.9145620880154123`*^9}, {3.9145622088546743`*^9, 3.9145622391431*^9}, {
   3.914563166839964*^9, 3.9145631672472153`*^9}, {3.9145645329554076`*^9, 
   3.914564731626259*^9}, {3.914564970759776*^9, 3.9145650036845913`*^9}, 
   3.9145650645703936`*^9, {3.914566499770747*^9, 3.9145665997854667`*^9}},
 CellLabel->
  "In[1040]:=",ExpressionUUID->"0424aa27-618a-4432-b14b-59aa276b3d6e"],

Cell[BoxData[
 FormBox[
  RowBox[{"{", 
   RowBox[{"\<\"CHARM\"\>", ",", "\<\"LHCb-downstream\"\>", 
    ",", "\<\"LHCb-downstream-full\"\>", 
    ",", "\<\"LHCb-downstream-T-tracks-only\"\>", 
    ",", "\<\"LHCb-muon-chamber\"\>", ",", "\<\"NA62-dump\"\>", 
    ",", "\<\"SHiP-ECN3\"\>", ",", "\<\"SHiP-ECN3-LoI\"\>", 
    ",", "\<\"SHiP-ECN4\"\>"}], "}"}], TraditionalForm]], "Output",
 CellChangeTimes->{3.914993919275597*^9, 3.9149945978446417`*^9, 
  3.91500225273709*^9, 3.915002463743143*^9, 3.9150127856794558`*^9, 
  3.9151229507775145`*^9, 3.9151236662776814`*^9, 3.9151828710982947`*^9, 
  3.9151831844059753`*^9, 3.9151848040037355`*^9, 3.9151881164868064`*^9, 
  3.9151881638505116`*^9, 3.915189025742454*^9, 3.9152066344929113`*^9},
 CellLabel->
  "Out[5327]=",ExpressionUUID->"5628bd95-8e58-49e6-a1d0-bf03e2e342a4"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Polar angle grid", "Subsubsection",
 CellChangeTimes->{{3.887526463267141*^9, 
  3.887526469273341*^9}},ExpressionUUID->"fc8ed9e2-4593-4c67-8016-\
412d7430b9e4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Theta]grid", "[", 
   RowBox[{
   "DecayVolumeAsDet_", ",", "\[Theta]decVolmin_", ",", "\[Theta]decVolmax_", 
    ",", "\[Theta]detmin_", ",", "\[Theta]detmax_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "\[Theta]detMinEff", ",", "\[Theta]detMaxEff", ",", 
      "\[Theta]gridDetEnd"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"Min", "/", "max"}], " ", "angles", " ", "covered", " ", "by", 
      " ", "detector", " ", "and", " ", "belonging", " ", "simultaneously", 
      " ", "to", " ", "the", " ", "decay", " ", "volume", " ", "acceptance"}],
      "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\[Theta]detMinEff", "=", 
      RowBox[{"Max", "[", 
       RowBox[{"\[Theta]detmin", ",", "\[Theta]decVolmin"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Theta]detMaxEff", "=", 
      RowBox[{"Min", "[", 
       RowBox[{"\[Theta]detmax", ",", "\[Theta]decVolmax"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "Grid", " ", "of", " ", "polar", " ", "angles", " ", "for", " ", "the", 
       " ", "end", " ", "of", " ", "the", " ", "detector"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"\[Theta]gridDetEnd", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"DecayVolumeAsDet", "\[Equal]", "\"\<False\>\""}], ",", 
        RowBox[{"Table", "[", 
         RowBox[{"x", ",", 
          RowBox[{"{", 
           RowBox[{"x", ",", 
            RowBox[{
             RowBox[{"1.001", "\[Theta]detMinEff"}], "+", 
             SuperscriptBox["10", 
              RowBox[{"-", "5."}]]}], ",", 
            RowBox[{"0.99", "\[Theta]detMaxEff"}], ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"0.99", "\[Theta]detMaxEff"}], "-", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"1.001", "\[Theta]detMinEff"}], "+", 
                 SuperscriptBox["10", 
                  RowBox[{"-", "5."}]]}], ")"}]}], ")"}], "/", "16"}]}], 
           "}"}]}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Theta]gridDecVolIfDet", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"DecayVolumeAsDet", "\[Equal]", "\"\<False\>\""}], ",", 
        RowBox[{"Table", "[", 
         RowBox[{"x", ",", 
          RowBox[{"{", 
           RowBox[{"x", ",", 
            RowBox[{
             RowBox[{"1.001", "\[Theta]decVolmin"}], "+", 
             SuperscriptBox["10", 
              RowBox[{"-", "5."}]]}], ",", 
            RowBox[{"0.999", "\[Theta]decVolmax"}], ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"0.999", "\[Theta]decVolmax"}], "-", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"1.001", "\[Theta]detMinEff"}], "+", 
                 SuperscriptBox["10", 
                  RowBox[{"-", "5."}]]}], ")"}]}], ")"}], "/", "13"}]}], 
           "}"}]}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Theta]gridDecVolIfNoDet", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"DecayVolumeAsDet", "\[Equal]", "\"\<True\>\""}], ",", 
        RowBox[{"Table", "[", 
         RowBox[{"x", ",", 
          RowBox[{"{", 
           RowBox[{"x", ",", 
            RowBox[{
             RowBox[{"1.001", "\[Theta]decVolmin"}], "+", 
             SuperscriptBox["10", 
              RowBox[{"-", "5."}]]}], ",", 
            RowBox[{"0.999", "\[Theta]decVolmax"}], ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"0.999", "\[Theta]decVolmax"}], "-", 
               RowBox[{"1.001", "\[Theta]detMinEff"}], "+", 
               SuperscriptBox["10", 
                RowBox[{"-", "5."}]]}], ")"}], "/", "22"}]}], "}"}]}], 
         "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{
       "Total", " ", "grid", " ", "for", " ", "experiments", " ", "where", 
        " ", "decay", " ", "volume", " ", "is", " ", "not", " ", 
        RowBox[{"detector", ".", " ", "Merging"}], " ", "the", " ", "grid", 
        " ", "for", " ", "detector", " ", "and", " ", "decay", " ", 
        "volume"}], ",", " ", 
       RowBox[{
       "selecting", " ", "for", " ", "the", " ", "latter", " ", "only", " ", 
        "the", " ", "angles", " ", "outside", " ", "the", " ", "detector", 
        " ", "coverage"}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"\[Theta]gridTotIfDet", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"DecayVolumeAsDet", "\[Equal]", "\"\<False\>\""}], ",", 
        RowBox[{"Sort", "[", 
         RowBox[{"Join", "[", 
          RowBox[{"\[Theta]gridDetEnd", ",", 
           RowBox[{"Select", "[", 
            RowBox[{"\[Theta]gridDecVolIfDet", ",", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"(", 
                RowBox[{
                "\[Theta]detMinEff", "\[LessEqual]", "#", "\[LessEqual]", 
                 "\[Theta]detMaxEff"}], ")"}]}], "&"}]}], "]"}]}], "]"}], 
         "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"DecayVolumeAsDet", "\[Equal]", "\"\<False\>\""}], ",", 
       "\[Theta]gridTotIfDet", ",", "\[Theta]gridDecVolIfNoDet"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.8875264783662243`*^9, 3.8875265222827024`*^9}, {
   3.887526742295684*^9, 3.887526810919674*^9}, {3.887526976587242*^9, 
   3.8875269784334836`*^9}, {3.887527049772958*^9, 3.88752708808506*^9}, {
   3.8875271515487823`*^9, 3.8875271575533714`*^9}, {3.8875272241199007`*^9, 
   3.8875272310647445`*^9}, {3.8875273449631715`*^9, 
   3.8875274918045177`*^9}, {3.887527592921301*^9, 3.8875276682467494`*^9}, {
   3.88752770475403*^9, 3.887528157694888*^9}, {3.8875289881915703`*^9, 
   3.8875289918074403`*^9}, {3.887529091868435*^9, 3.887529183045274*^9}, {
   3.8915325290406227`*^9, 3.8915325410232162`*^9}, {3.8915329153554935`*^9, 
   3.891532920070578*^9}, {3.891533471822391*^9, 3.8915334832115393`*^9}, {
   3.891533641867587*^9, 3.8915336493077135`*^9}, {3.8916150025620875`*^9, 
   3.8916151681219425`*^9}, {3.8916152887898064`*^9, 
   3.8916152913752537`*^9}, {3.8916153356626363`*^9, 3.8916154447642736`*^9}, 
   3.8916155628250327`*^9, {3.8916156150143037`*^9, 3.8916157853700113`*^9}, {
   3.8916158244791636`*^9, 3.8916158503080406`*^9}, {3.891615954782565*^9, 
   3.8916159558520017`*^9}, {3.893215695593479*^9, 3.893215711915337*^9}, {
   3.893301613100013*^9, 3.893301613176914*^9}, {3.8933017430919356`*^9, 
   3.8933017646199713`*^9}, {3.8935196961260056`*^9, 3.8935196963703794`*^9}},
 CellLabel->
  "In[1047]:=",ExpressionUUID->"af00fc13-1b53-4375-a6a0-56d4d35144a2"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1016.25, 612.75},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"13.2 for Microsoft Windows (64-bit) (November 18, 2022)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"5f9c2474-ed11-4027-884a-f13ee4d513c9"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 160, 3, 69, "Chapter",ExpressionUUID->"d9d3b17d-90ec-48bc-b972-320393e3a836"],
Cell[CellGroupData[{
Cell[765, 29, 269, 6, 67, "Section",ExpressionUUID->"7c91f1fb-76f0-45b4-b381-f8e96e41b025"],
Cell[1037, 37, 15721, 407, 1002, "Input",ExpressionUUID->"ee7bfe9c-2c6e-4b8d-b202-a56eee06adcd"]
}, Open  ]],
Cell[CellGroupData[{
Cell[16795, 449, 198, 3, 67, "Section",ExpressionUUID->"20cfe154-510f-4050-a059-2ca75cd81d28"],
Cell[16996, 454, 18592, 435, 1421, "Input",ExpressionUUID->"0ef6192c-b9ad-46f4-b651-eac4a4953f6f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[35625, 894, 344, 7, 67, "Section",ExpressionUUID->"18f6958a-0a02-4d67-9b4a-ddf4f3df3e04"],
Cell[CellGroupData[{
Cell[35994, 905, 265, 4, 54, "Subsection",ExpressionUUID->"1f41dc1a-706a-4799-b529-a81390f9cf51"],
Cell[CellGroupData[{
Cell[36284, 913, 176, 3, 45, "Subsubsection",ExpressionUUID->"925b911f-43f8-4aca-849e-bdd65f3a4225"],
Cell[36463, 918, 15090, 355, 827, "Input",ExpressionUUID->"dd2fdd33-95dc-4862-94d5-57343f332b43"]
}, Open  ]],
Cell[CellGroupData[{
Cell[51590, 1278, 159, 3, 45, "Subsubsection",ExpressionUUID->"6f0164a1-0935-49d5-ab8e-5bcff377cc74"],
Cell[51752, 1283, 25173, 672, 1402, "Input",ExpressionUUID->"52aa4bbc-aec3-4f12-abbb-6316f8d0867b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[76962, 1960, 169, 3, 45, "Subsubsection",ExpressionUUID->"3198d0fe-50cc-4859-964b-bd937d0a1541"],
Cell[77134, 1965, 14114, 368, 819, "Input",ExpressionUUID->"be056b80-f7c5-40d4-a682-7aed56187183"]
}, Open  ]],
Cell[CellGroupData[{
Cell[91285, 2338, 294, 5, 45, "Subsubsection",ExpressionUUID->"acd32065-39aa-4349-af5f-67b099764ac5"],
Cell[91582, 2345, 2877, 63, 200, "Input",ExpressionUUID->"fc1f5d22-5d88-4cc4-b98f-ee20e05280ab"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[94508, 2414, 222, 4, 54, "Subsection",ExpressionUUID->"8ab71b71-8a97-4513-810e-36a175aafeb7"],
Cell[CellGroupData[{
Cell[94755, 2422, 161, 3, 45, "Subsubsection",ExpressionUUID->"d5d22e24-f7ea-4967-83b7-c4770ca4a591"],
Cell[94919, 2427, 28696, 798, 1435, "Input",ExpressionUUID->"f3a1bcbf-3155-424a-80d6-c37ba43a40f9"]
}, Open  ]],
Cell[CellGroupData[{
Cell[123652, 3230, 169, 3, 45, "Subsubsection",ExpressionUUID->"4149eca7-cb30-4ee1-acd3-7670665d2e51"],
Cell[123824, 3235, 13779, 364, 713, "Input",ExpressionUUID->"e132ac1a-9c1c-437d-8eb4-7fe4b555c52f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[137640, 3604, 300, 6, 45, "Subsubsection",ExpressionUUID->"225b5f49-1ad4-4356-8b01-807e9cd557e0"],
Cell[137943, 3612, 2728, 61, 143, "Input",ExpressionUUID->"4e1ebb16-5c7f-4fdf-9b63-b9b7af8a10bf"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[140720, 3679, 173, 3, 54, "Subsection",ExpressionUUID->"8d8c3c02-4ec6-4830-975c-563fed99b618"],
Cell[CellGroupData[{
Cell[140918, 3686, 154, 2, 45, "Subsubsection",ExpressionUUID->"fcf98f3f-618e-468c-8940-0f99f1aac577"],
Cell[141075, 3690, 24663, 698, 1572, "Input",ExpressionUUID->"cabce260-ce06-45a5-960b-4af96240b582"]
}, Open  ]],
Cell[CellGroupData[{
Cell[165775, 4393, 169, 3, 47, "Subsubsection",ExpressionUUID->"abc2e27a-bdef-4622-904c-81f2dfe64121"],
Cell[165947, 4398, 13439, 356, 798, "Input",ExpressionUUID->"141a19f4-db44-41b0-bde8-c1e4b3144289"]
}, Open  ]],
Cell[CellGroupData[{
Cell[179423, 4759, 297, 6, 45, "Subsubsection",ExpressionUUID->"a4033911-ea60-4b19-bd5e-ebd01eb737c4"],
Cell[179723, 4767, 2622, 60, 200, "Input",ExpressionUUID->"23b82922-d039-4875-83be-7bd67f514620"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[182394, 4833, 167, 3, 54, "Subsection",ExpressionUUID->"5db7b151-2d9f-4951-8715-ad54f9065ca4"],
Cell[CellGroupData[{
Cell[182586, 4840, 154, 2, 45, "Subsubsection",ExpressionUUID->"f89f1cc6-f787-4bd9-8f96-d5ebc9f089a0"],
Cell[182743, 4844, 23774, 683, 1402, "Input",ExpressionUUID->"decc17ca-cd1f-4b47-bc0b-0f716fe4bdb8"]
}, Open  ]],
Cell[CellGroupData[{
Cell[206554, 5532, 169, 3, 47, "Subsubsection",ExpressionUUID->"a37bb646-ea59-4fd5-b13e-320dab3f9173"],
Cell[206726, 5537, 13401, 355, 798, "Input",ExpressionUUID->"b61c25dd-a17f-4945-ae29-a970170e5569"]
}, Open  ]],
Cell[CellGroupData[{
Cell[220164, 5897, 300, 6, 45, "Subsubsection",ExpressionUUID->"b6f59320-6356-4501-b85a-98f5b68ac8c3"],
Cell[220467, 5905, 2625, 60, 200, "Input",ExpressionUUID->"a4fad628-b458-40ae-815b-ce1aa95e6d29"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[223141, 5971, 222, 4, 54, "Subsection",ExpressionUUID->"d1e70b39-7ff7-4667-9ce0-5331cbd2de8e"],
Cell[CellGroupData[{
Cell[223388, 5979, 154, 2, 45, "Subsubsection",ExpressionUUID->"4ece8972-6468-4588-b44b-cfe998a9a3da"],
Cell[223545, 5983, 23998, 685, 1421, "Input",ExpressionUUID->"a5131042-69e6-4716-bf2c-b780ae8b8876"]
}, Open  ]],
Cell[CellGroupData[{
Cell[247580, 6673, 169, 3, 47, "Subsubsection",ExpressionUUID->"1d1b80a6-b212-4fff-b239-7bab1d73e10a"],
Cell[247752, 6678, 13671, 360, 846, "Input",ExpressionUUID->"fddc0f0c-7456-440a-88f4-990f0a40ff40"]
}, Open  ]],
Cell[CellGroupData[{
Cell[261460, 7043, 298, 6, 45, "Subsubsection",ExpressionUUID->"2b078a68-361f-43b1-becf-80bfa3e3fa7c"],
Cell[261761, 7051, 2569, 59, 200, "Input",ExpressionUUID->"82d15f9c-fc0b-4641-95bb-894c0fdf779b"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[264379, 7116, 212, 4, 54, "Subsection",ExpressionUUID->"03c807ab-aa72-4ed4-a63d-ad3a58af6502"],
Cell[CellGroupData[{
Cell[264616, 7124, 166, 3, 45, "Subsubsection",ExpressionUUID->"f93b48e2-202e-4645-be81-b14292c6023f"],
Cell[CellGroupData[{
Cell[264807, 7131, 1673, 45, 165, "Input",ExpressionUUID->"2c7da6e7-d8ac-4110-b95d-9dbc4eea7c83"],
Cell[266483, 7178, 9268, 170, 238, "Output",ExpressionUUID->"c6cc0e05-de15-4799-bed5-ee9ddcc172ec"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[275800, 7354, 163, 3, 47, "Subsubsection",ExpressionUUID->"23f24e26-4009-4fc4-ad78-6ad0e3941fcc"],
Cell[275966, 7359, 25709, 715, 1125, "Input",ExpressionUUID->"2101d0ff-d2aa-4411-a167-7cad968527cd"]
}, Open  ]],
Cell[CellGroupData[{
Cell[301712, 8079, 169, 3, 47, "Subsubsection",ExpressionUUID->"f32359e5-f057-4c91-8c74-4fd4a6b88892"],
Cell[301884, 8084, 13262, 354, 798, "Input",ExpressionUUID->"24079cd3-e09f-4c91-83dd-2edfd503a295"]
}, Open  ]],
Cell[CellGroupData[{
Cell[315183, 8443, 300, 6, 45, "Subsubsection",ExpressionUUID->"b3931b43-f41f-4224-a220-2e6b485c059f"],
Cell[315486, 8451, 2578, 59, 200, "Input",ExpressionUUID->"d58ac2db-c71a-4ff7-8ca2-5ab7d9cc241c"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[318113, 8516, 337, 5, 54, "Subsection",ExpressionUUID->"e91bc72f-65b4-4d01-b674-6e73645d1443"],
Cell[CellGroupData[{
Cell[318475, 8525, 238, 4, 45, "Subsubsection",ExpressionUUID->"fc70ba2e-bd2c-40fc-972b-2cabae35b823"],
Cell[318716, 8531, 25306, 675, 1421, "Input",ExpressionUUID->"5c05308b-f131-4153-91dc-c3c157e191e0"]
}, Open  ]],
Cell[CellGroupData[{
Cell[344059, 9211, 169, 3, 47, "Subsubsection",ExpressionUUID->"90d9d384-18d1-448e-b197-bcf497d3e652"],
Cell[344231, 9216, 13264, 354, 800, "Input",ExpressionUUID->"941f964a-2e08-45e4-98b0-bf1004d95266"]
}, Open  ]],
Cell[CellGroupData[{
Cell[357532, 9575, 298, 6, 45, "Subsubsection",ExpressionUUID->"2db17720-67df-4b6b-b5e7-00b6ff9d69f7"],
Cell[357833, 9583, 2576, 59, 200, "Input",ExpressionUUID->"e848a368-ae09-4896-b2b6-74e880e77ca5"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[360458, 9648, 208, 4, 54, "Subsection",ExpressionUUID->"56870774-cd58-4af7-9e62-0d87871dea89"],
Cell[CellGroupData[{
Cell[360691, 9656, 154, 2, 45, "Subsubsection",ExpressionUUID->"52baf8ed-31d4-431d-a4f0-08066f853f69"],
Cell[360848, 9660, 23056, 654, 1210, "Input",ExpressionUUID->"fbfb8366-c3a8-4be1-a6ee-63373121fb25"]
}, Open  ]],
Cell[CellGroupData[{
Cell[383941, 10319, 169, 3, 45, "Subsubsection",ExpressionUUID->"19e89f76-33ef-4e42-8a28-5187b7399835"],
Cell[384113, 10324, 14532, 357, 711, "Input",ExpressionUUID->"0ad70661-725f-48d0-b8d2-342f65d9fbd4"]
}, Open  ]],
Cell[CellGroupData[{
Cell[398682, 10686, 300, 6, 45, "Subsubsection",ExpressionUUID->"c3880812-e9f5-4729-b69d-b0d0a0716306"],
Cell[398985, 10694, 2579, 59, 143, "Input",ExpressionUUID->"b6a6e877-7cc2-4ceb-b64d-5aa9913bdef3"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[401613, 10759, 442, 9, 54, "Subsection",ExpressionUUID->"e5a162fe-e852-4fc7-a4e9-6da078c9b465"],
Cell[CellGroupData[{
Cell[402080, 10772, 154, 2, 45, "Subsubsection",ExpressionUUID->"0afe546c-ec47-4d12-8908-e06e4be5cb7f"],
Cell[402237, 10776, 24613, 693, 1440, "Input",ExpressionUUID->"251d1973-d893-4f0d-89db-b6f082ac5b38"]
}, Open  ]],
Cell[CellGroupData[{
Cell[426887, 11474, 169, 3, 47, "Subsubsection",ExpressionUUID->"8d8f307b-ebc0-4e6e-8dce-1993ef415004"],
Cell[427059, 11479, 13585, 358, 798, "Input",ExpressionUUID->"958cb9d4-5c58-416a-aab7-b920e8c6baa0"]
}, Open  ]],
Cell[CellGroupData[{
Cell[440681, 11842, 298, 6, 45, "Subsubsection",ExpressionUUID->"c32a953b-71e1-4221-a5c5-945e22cece84"],
Cell[440982, 11850, 2632, 60, 200, "Input",ExpressionUUID->"bfdd3c87-57bf-4537-b530-45fdabd3cbed"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[443663, 11916, 160, 3, 54, "Subsection",ExpressionUUID->"0bf4273c-be61-45b5-8a11-9a4b5d5d9d57"],
Cell[CellGroupData[{
Cell[443848, 11923, 154, 2, 45, "Subsubsection",ExpressionUUID->"831a3c30-5693-4c5c-88f6-6c7605512b85"],
Cell[444005, 11927, 27628, 723, 1497, "Input",ExpressionUUID->"e3ff9ce8-5382-4cce-82e5-24e9c94b91bd"]
}, Open  ]],
Cell[CellGroupData[{
Cell[471670, 12655, 169, 3, 47, "Subsubsection",ExpressionUUID->"26c5373f-244a-4f26-9d83-f8f86200fc98"],
Cell[471842, 12660, 14193, 355, 819, "Input",ExpressionUUID->"de67c2f2-18ed-4af2-a5b1-b32b447e39d7"]
}, Open  ]],
Cell[CellGroupData[{
Cell[486072, 13020, 298, 6, 45, "Subsubsection",ExpressionUUID->"3566005e-ff5d-496f-9f02-93df8acffc80"],
Cell[486373, 13028, 2528, 58, 200, "Input",ExpressionUUID->"ea75023f-e6af-48e1-823d-903a117ed48c"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[488950, 13092, 208, 4, 54, "Subsection",ExpressionUUID->"cb11b78f-aa65-4dc6-917d-a007b5b84062"],
Cell[CellGroupData[{
Cell[489183, 13100, 154, 2, 45, "Subsubsection",ExpressionUUID->"66e0ec27-e432-4aec-9346-1d21923ba8c8"],
Cell[489340, 13104, 24464, 674, 1383, "Input",ExpressionUUID->"360e08a6-002f-4473-a375-717de95c2cde"]
}, Open  ]],
Cell[CellGroupData[{
Cell[513841, 13783, 169, 3, 47, "Subsubsection",ExpressionUUID->"f2926030-9a3a-4574-86ca-3feb85d4f8d8"],
Cell[514013, 13788, 14076, 351, 819, "Input",ExpressionUUID->"de95196c-b3fe-4c90-8a5c-0e9534f27134"]
}, Open  ]],
Cell[CellGroupData[{
Cell[528126, 14144, 300, 6, 45, "Subsubsection",ExpressionUUID->"cfd676e6-2e50-4d1c-80f6-80e3fc34cafd"],
Cell[528429, 14152, 2552, 59, 200, "Input",ExpressionUUID->"5c934d1b-6bd0-44e0-bd74-d3bfa2402466"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[531030, 14217, 215, 4, 54, "Subsection",ExpressionUUID->"4d856511-d201-41c8-a939-ed9023d9bcd9"],
Cell[CellGroupData[{
Cell[531270, 14225, 154, 2, 45, "Subsubsection",ExpressionUUID->"971da7d8-df11-4ef8-a329-c61b93da52b8"],
Cell[531427, 14229, 23714, 672, 1469, "Input",ExpressionUUID->"9e4c2f6e-1fe6-49a0-863f-bd0c7c4958b1"]
}, Open  ]],
Cell[CellGroupData[{
Cell[555178, 14906, 169, 3, 47, "Subsubsection",ExpressionUUID->"339e742a-403e-4af6-a1c8-8a447ca3e0ba"],
Cell[555350, 14911, 13265, 354, 800, "Input",ExpressionUUID->"0620c79b-a426-465d-b3a5-1ef28cb70075"]
}, Open  ]],
Cell[CellGroupData[{
Cell[568652, 15270, 298, 6, 45, "Subsubsection",ExpressionUUID->"94aa29fc-8c83-4d4b-bad6-3ca8379554db"],
Cell[568953, 15278, 2574, 59, 200, "Input",ExpressionUUID->"a9fa46e5-3281-45eb-950c-935e9cf5bf22"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[571576, 15343, 161, 3, 54, "Subsection",ExpressionUUID->"a9f4ed1f-259f-4551-9380-c6b533467630"],
Cell[CellGroupData[{
Cell[571762, 15350, 154, 2, 45, "Subsubsection",ExpressionUUID->"fe8b55ce-2156-45fd-be3f-7a62452c558f"],
Cell[571919, 15354, 23413, 655, 1402, "Input",ExpressionUUID->"44291257-037a-4f98-8147-aa030da8ff2c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[595369, 16014, 169, 3, 47, "Subsubsection",ExpressionUUID->"feb7364a-d1da-4b05-976d-a48497cffd75"],
Cell[595541, 16019, 13266, 353, 800, "Input",ExpressionUUID->"dbda6fb6-acb1-42b8-ab24-7ce9b6c210d9"]
}, Open  ]],
Cell[CellGroupData[{
Cell[608844, 16377, 300, 6, 45, "Subsubsection",ExpressionUUID->"e816a7af-276a-4dd9-971f-9de6fa8be3b8"],
Cell[609147, 16385, 2578, 59, 200, "Input",ExpressionUUID->"ed68ff8d-db9d-41a8-8ecd-da27b402cc2e"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[611774, 16450, 219, 4, 54, "Subsection",ExpressionUUID->"3d40b5f9-720e-4a7d-8279-f492c6f212fa"],
Cell[CellGroupData[{
Cell[612018, 16458, 154, 2, 45, "Subsubsection",ExpressionUUID->"ba977a3a-070a-4ae1-b71a-d70b0feb146d"],
Cell[612175, 16462, 23477, 666, 1488, "Input",ExpressionUUID->"87632c9d-e9c6-44c2-b8cd-340248aca50b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[635689, 17133, 169, 3, 47, "Subsubsection",ExpressionUUID->"d9987b68-7dc2-40fe-a662-1b24aef008ca"],
Cell[635861, 17138, 13905, 350, 730, "Input",ExpressionUUID->"31c776a8-f116-4d2e-8e6d-b31393d3c12a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[649803, 17493, 298, 6, 45, "Subsubsection",ExpressionUUID->"5705842b-3477-4d12-929a-2947a2ba190d"],
Cell[650104, 17501, 2573, 59, 143, "Input",ExpressionUUID->"8ed64fd6-4767-4823-895e-92183af2a11e"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[652726, 17566, 266, 4, 54, "Subsection",ExpressionUUID->"45b75dda-4fb8-4569-840f-7bfad93f76ca"],
Cell[CellGroupData[{
Cell[653017, 17574, 154, 2, 45, "Subsubsection",ExpressionUUID->"9f87547e-07d2-4ecb-8c96-ad84e2d4e315"],
Cell[653174, 17578, 23762, 665, 1251, "Input",ExpressionUUID->"4f523771-8c20-4ae3-b672-f038478e0761"]
}, Open  ]],
Cell[CellGroupData[{
Cell[676973, 18248, 169, 3, 47, "Subsubsection",ExpressionUUID->"bda74db0-effd-4eeb-8a60-44c117bbb9e0"],
Cell[677145, 18253, 13701, 362, 819, "Input",ExpressionUUID->"46135e3c-8693-44ca-9b33-675bd9677398"]
}, Open  ]],
Cell[CellGroupData[{
Cell[690883, 18620, 300, 6, 45, "Subsubsection",ExpressionUUID->"74cc3f96-2ad9-4305-8e1c-7e45ca3aaf57"],
Cell[691186, 18628, 2576, 59, 200, "Input",ExpressionUUID->"8609a49f-08ac-46d5-8ec7-7451182da6a0"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[693811, 18693, 294, 5, 54, "Subsection",ExpressionUUID->"a0d9d1ac-3d29-4ae7-a3f5-165c80c0f009"],
Cell[CellGroupData[{
Cell[694130, 18702, 154, 2, 45, "Subsubsection",ExpressionUUID->"bd488a61-ba30-4d44-9b24-4b6f4bf05fce"],
Cell[694287, 18706, 24702, 682, 1497, "Input",ExpressionUUID->"c3bd091a-cad3-433e-a5f4-465bd0c09acc"]
}, Open  ]],
Cell[CellGroupData[{
Cell[719026, 19393, 169, 3, 47, "Subsubsection",ExpressionUUID->"f37860c0-24f8-4bf0-9ed8-e51abb1cec19"],
Cell[719198, 19398, 14057, 351, 874, "Input",ExpressionUUID->"52b208a1-e70e-4904-8f37-699564e63eed"]
}, Open  ]],
Cell[CellGroupData[{
Cell[733292, 19754, 298, 6, 45, "Subsubsection",ExpressionUUID->"c6db9898-1325-437c-afd4-f54b43107216"],
Cell[733593, 19762, 2573, 59, 200, "Input",ExpressionUUID->"023c2ebe-4633-4a62-b4a8-36a84e1988b9"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[736215, 19827, 218, 4, 54, "Subsection",ExpressionUUID->"f7b3b221-18ee-4a54-96c2-4efdf1e9765c"],
Cell[CellGroupData[{
Cell[736458, 19835, 154, 2, 45, "Subsubsection",ExpressionUUID->"dcc372fd-b420-4058-a209-c96f59c1bef5"],
Cell[736615, 19839, 29994, 838, 1831, "Input",ExpressionUUID->"fed7d2a6-ecd8-412c-a472-b78f082bed03"]
}, Open  ]],
Cell[CellGroupData[{
Cell[766646, 20682, 165, 3, 45, "Subsubsection",ExpressionUUID->"6ba9881b-9e8c-446d-895b-f71c232e2861"],
Cell[766814, 20687, 14001, 354, 874, "Input",ExpressionUUID->"bba84095-db6b-474a-9e5d-5089c05c837e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[780852, 21046, 298, 6, 45, "Subsubsection",ExpressionUUID->"138ae7da-1298-41a4-bd0a-1e7f9255fb54"],
Cell[781153, 21054, 15365, 374, 1208, "Input",ExpressionUUID->"e12cb55a-0893-4717-868d-0b7a9ced8fff"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[796579, 21435, 420, 8, 105, "Section",ExpressionUUID->"f06ff148-ae6b-40aa-ae2c-5c35eb0a588f"],
Cell[CellGroupData[{
Cell[797024, 21447, 258, 4, 54, "Subsection",ExpressionUUID->"706e1c55-511c-4f9f-bc0b-e5a7b0c22593"],
Cell[CellGroupData[{
Cell[797307, 21455, 154, 3, 45, "Subsubsection",ExpressionUUID->"aed572f9-f229-4a10-aee5-31e70c06f455"],
Cell[797464, 21460, 1874, 44, 124, "Input",ExpressionUUID->"410aa567-b6a0-478d-b333-d7c152c75bf9"]
}, Open  ]],
Cell[CellGroupData[{
Cell[799375, 21509, 161, 3, 45, "Subsubsection",ExpressionUUID->"530ddf66-bf6d-4571-8f51-2c65fd646ca6"],
Cell[799539, 21514, 3595, 78, 276, "Input",ExpressionUUID->"17963a85-032e-4762-b207-ea5afb4518e1"]
}, Open  ]],
Cell[CellGroupData[{
Cell[803171, 21597, 171, 3, 45, "Subsubsection",ExpressionUUID->"9f3eef4a-6429-4142-935a-e0bae9d3b45e"],
Cell[803345, 21602, 6279, 142, 428, "Input",ExpressionUUID->"68d77cb6-d0e9-4056-97c9-5fbe2e504d1a"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[809673, 21750, 467, 8, 54, "Subsection",ExpressionUUID->"5e4e131b-eb93-4867-a95f-13c0641faafa"],
Cell[CellGroupData[{
Cell[810165, 21762, 357, 5, 47, "Subsubsection",ExpressionUUID->"3f1e5604-bb40-41cc-aa68-e23dd7cfe4b4"],
Cell[810525, 21769, 16325, 411, 728, "Input",ExpressionUUID->"7cc89b2c-8ce6-432e-98fb-3e1253114a33"]
}, Open  ]],
Cell[CellGroupData[{
Cell[826887, 22185, 241, 4, 47, "Subsubsection",ExpressionUUID->"38754b3f-4d89-4ba6-8860-83a2b5915ace"],
Cell[827131, 22191, 3122, 69, 137, "Input",ExpressionUUID->"b61b639f-42f9-406c-be50-314330c15109"]
}, Open  ]],
Cell[CellGroupData[{
Cell[830290, 22265, 170, 3, 47, "Subsubsection",ExpressionUUID->"111b8c3c-ed59-4669-94e2-5cd17a8cc0de"],
Cell[830463, 22270, 2830, 73, 106, "Input",ExpressionUUID->"7b547486-f57c-43b2-b259-47a28fc7b638"],
Cell[833296, 22345, 5047, 118, 194, "Input",ExpressionUUID->"8612ce4e-ca9a-43ab-b390-8491bcf8dc3b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[838380, 22468, 158, 3, 47, "Subsubsection",ExpressionUUID->"9fa30c80-5ecf-48d8-bb9f-94a8f1ae812a"],
Cell[838541, 22473, 1757, 37, 76, "Input",ExpressionUUID->"39e55937-a3f7-4527-a69e-a60d51c1aa4a"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[840347, 22516, 252, 4, 54, "Subsection",ExpressionUUID->"44bbe585-5b09-41e8-b180-1129cc4e44ac"],
Cell[840602, 22522, 1750, 38, 76, "Input",ExpressionUUID->"5a5a6265-a4fd-4cf4-8556-2e980256cc20"]
}, Open  ]],
Cell[CellGroupData[{
Cell[842389, 22565, 175, 3, 54, "Subsection",ExpressionUUID->"f9a001f0-8a78-4142-800b-f078ade817ff"],
Cell[842567, 22570, 6884, 152, 305, "Input",ExpressionUUID->"b2b7c709-b0fc-45ef-bbfa-19bf5a913fe1"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[849500, 22728, 295, 7, 66, "Section",ExpressionUUID->"27470ef3-52d6-41b9-af8a-c343799fb5b8"],
Cell[CellGroupData[{
Cell[849820, 22739, 164, 3, 54, "Subsection",ExpressionUUID->"ad126cc8-6ddb-4208-a197-7b74a0a4e6d7"],
Cell[CellGroupData[{
Cell[850009, 22746, 156, 3, 47, "Subsubsection",ExpressionUUID->"8abedd8a-50a6-441a-a28c-e3ec143aecdd"],
Cell[850168, 22751, 5528, 124, 258, "Input",ExpressionUUID->"0fd3b101-2ccf-4b70-b6f4-f1fa069cf68c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[855733, 22880, 161, 3, 47, "Subsubsection",ExpressionUUID->"7c291c8b-59a2-4541-b3ae-c821c03f0269"],
Cell[855897, 22885, 4304, 95, 243, "Input",ExpressionUUID->"b6cfb308-d6c4-48c7-a09b-25d83361837b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[860238, 22985, 169, 3, 47, "Subsubsection",ExpressionUUID->"3f775c17-8d7c-43e4-bd03-32ec24b58ac8"],
Cell[860410, 22990, 5541, 128, 273, "Input",ExpressionUUID->"fc7dd65e-2e91-458e-b2ef-28bd92b312ef"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[866000, 23124, 224, 4, 54, "Subsection",ExpressionUUID->"b6e89d9f-16a2-4f6a-9d55-b7bbe096eae6"],
Cell[CellGroupData[{
Cell[866249, 23132, 243, 4, 47, "Subsubsection",ExpressionUUID->"df8071d5-b0f0-4824-83d6-62ff3e211d3a"],
Cell[866495, 23138, 8459, 195, 427, "Input",ExpressionUUID->"19baa3f5-e3bb-4a1e-ba3b-f27a55d717d1"]
}, Open  ]],
Cell[CellGroupData[{
Cell[874991, 23338, 161, 3, 47, "Subsubsection",ExpressionUUID->"522c5807-147e-46cf-883a-4f1427140adf"],
Cell[875155, 23343, 1840, 39, 91, "Input",ExpressionUUID->"71687223-95c7-4770-93a6-52296e69baf8"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[877044, 23388, 167, 3, 54, "Subsection",ExpressionUUID->"888d3710-ab9f-4503-a23a-e3e62f92c089"],
Cell[877214, 23393, 9424, 207, 320, "Input",ExpressionUUID->"9c410249-f331-4058-ba5e-de7dc12a2761"]
}, Open  ]],
Cell[CellGroupData[{
Cell[886675, 23605, 180, 3, 54, "Subsection",ExpressionUUID->"12ed773d-bd0d-4739-ad8a-63bae640e537"],
Cell[886858, 23610, 9439, 228, 351, "Input",ExpressionUUID->"c3fb9e7e-496d-4c3a-be72-0a6440bff7d3"]
}, Open  ]],
Cell[CellGroupData[{
Cell[896334, 23843, 532, 12, 76, "Subsection",ExpressionUUID->"ea935def-d43b-4b68-8039-d554d2678e28"],
Cell[CellGroupData[{
Cell[896891, 23859, 22512, 520, 2616, "Input",ExpressionUUID->"0424aa27-618a-4432-b14b-59aa276b3d6e"],
Cell[919406, 24381, 830, 15, 69, "Output",ExpressionUUID->"5628bd95-8e58-49e6-a1d0-bf03e2e342a4"]
}, Open  ]],
Cell[CellGroupData[{
Cell[920273, 24401, 167, 3, 45, "Subsubsection",ExpressionUUID->"fc8ed9e2-4593-4c67-8016-412d7430b9e4"],
Cell[920443, 24406, 6874, 151, 572, "Input",ExpressionUUID->"af00fc13-1b53-4375-a6a0-56d4d35144a2"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

