(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    441770,      10225]
NotebookOptionsPosition[    395228,       9541]
NotebookOutlinePosition[    423068,       9894]
CellTagsIndexPosition[    422764,       9884]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Just launch the code below to run the notebook (shift+enter)", "Title",
 CellChangeTimes->{{3.8934376452895875`*^9, 
  3.8934376644509068`*^9}},ExpressionUUID->"0839ea5b-1982-4dfb-8c5d-\
195bcd99f6e9"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ParallelEvaluate", "[", 
   RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BlockEvaluation", "[", "tag_", "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"nb", "=", 
      RowBox[{"EvaluationNotebook", "[", "]"}]}], ";", "\n", 
     RowBox[{"NotebookFind", "[", 
      RowBox[{"nb", ",", "tag", ",", "All", ",", "CellTags"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"SelectionEvaluate", "[", "nb", "]"}]}]}], "\[IndentingNewLine]",
    "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CloseKernels", "[", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"LaunchKernels", "[", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"choiceslist", "=", 
   RowBox[{"{", 
    RowBox[{
    "\"\<Tabulated Nevents+sensitivity\>\"", ",", 
     "\"\<Sensitivity only (tabulated Nevents must be produced before)\>\"", 
     ",", "\"\<Tabulated Nevents only\>\"", ",", "\"\<Acceptance\>\""}], 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"taglist", "[", "\"\<Acceptance\>\"", "]"}], "=", 
   "\"\<Acceptance\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"taglist", "[", "\"\<Tabulated Nevents+sensitivity\>\"", "]"}], 
   "=", 
   RowBox[{
    RowBox[{"taglist", "[", "\"\<Tabulated Nevents only\>\"", "]"}], "=", 
    "\"\<Number-of-events+sensitivity\>\""}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
   "taglist", "[", 
    "\"\<Sensitivity only (tabulated Nevents must be produced before)\>\"", 
    "]"}], "=", "\"\<Sensitivity\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NotebookEvaluate", "[", 
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"NotebookDirectory", "[", "]"}], ",", 
      "\"\<codes/dialog-windows.nb\>\""}], "}"}], "]"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"launchoptions", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"Keys", "[", 
     RowBox[{"DownValues", "@", "taglist"}], "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", "1", ",", "1"}], "]"}], "]"}], "//", 
   "Sort"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MapThread", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"explanationlist", "[", "#1", "]"}], "=", "#2"}], ")"}], "&"}],
     ",", 
    RowBox[{"{", 
     RowBox[{"launchoptions", ",", 
      RowBox[{"{", 
       RowBox[{
       "\"\<Produce acceptances plots only (see Fig. 12 and explanation in \
text of 2305.13383)\>\"", ",", 
        "\"\<Produce sensitivities assuming that the tabulated number of \
events has been produced before\>\"", ",", 
        "\"\<Produce tabulated number of events (mass, coupling, \
Nevents(mass, coupling))\>\"", ",", 
        "\"\<Produce tabulated number of events and then sensitivity\>\""}], 
       "}"}]}], "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"computationchoice", "=", 
  RowBox[{"selectionDialogExplanationOneOption", "[", 
   RowBox[{"launchoptions", ",", 
    RowBox[{
     RowBox[{
      RowBox[{"explanationlist", "[", "#", "]"}], "&"}], "/@", 
     "launchoptions"}], ",", 
    "\"\<Select the regime of launching the notebook\>\"", ",", "250"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
    "computationchoice", "==", "\"\<Tabulated Nevents+sensitivity\>\""}], ",", 
    RowBox[{"sensComp", "=", "True"}], ",", 
    RowBox[{"sensComp", "=", "False"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"tagselected", "=", 
  RowBox[{"taglist", "[", "computationchoice", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"BlockEvaluation", "[", "tagselected", "]"}]}], "Input",
 CellChangeTimes->{{3.893437585709897*^9, 3.8934375895369635`*^9}, {
   3.8934376329497385`*^9, 3.893437658846809*^9}, 3.8935730495823717`*^9, {
   3.8936653425702004`*^9, 3.8936653432627907`*^9}, {3.8950526655121717`*^9, 
   3.895052665712869*^9}, {3.895126994040556*^9, 3.8951270001060944`*^9}, {
   3.902561886909021*^9, 3.9025619879179907`*^9}, {3.902562067085945*^9, 
   3.9025620673227577`*^9}, 3.9027294885937986`*^9, {3.903788557154269*^9, 
   3.9037885613831005`*^9}, {3.9038033934699326`*^9, 
   3.9038034371611333`*^9}, {3.903854932333012*^9, 3.9038549328265457`*^9}, {
   3.9146655153366585`*^9, 3.91466553588784*^9}, {3.9168224565291305`*^9, 
   3.9168224567551365`*^9}, {3.9170215579935164`*^9, 3.9170215582897778`*^9}, 
   3.9482581423056545`*^9, {3.950603500868908*^9, 3.95060350105719*^9}, {
   3.950670836728113*^9, 3.95067087567708*^9}, {3.950671475317812*^9, 
   3.9506714754921722`*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"3ff672e3-e982-49fe-8fe3-e69285f06990"]
}, Closed]],

Cell[CellGroupData[{

Cell["Preliminary definitions", "Title",
 CellChangeTimes->{{3.7552434949579296`*^9, 3.755243495237189*^9}, {
   3.88501652694691*^9, 3.885016532955313*^9}, {3.8850204805201235`*^9, 
   3.885020485584347*^9}, 3.887617574733776*^9},
 CellTags->{
  "Acceptance", 
   "Number-of-events+sensitivity"},ExpressionUUID->"dc98cc40-afde-45ba-ae22-\
74afbd95ce04"],

Cell[CellGroupData[{

Cell["Various directories", "Chapter",
 CellChangeTimes->{{3.913804059957842*^9, 3.913804062327417*^9}},
 CellTags->{
  "Acceptance", 
   "Number-of-events+sensitivity"},ExpressionUUID->"1320ba97-7abe-4017-b5a5-\
ae36b7fec1b3"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"LLPdirName", "=", "\"\<ALP-fermion\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"ToString", "[", 
       RowBox[{"Head", "[", "computationchoice", "]"}], "]"}], "==", 
      "\"\<Symbol\>\""}], ",", 
     RowBox[{"computationchoice", "=", "\"\<Tabulated Nevents only\>\""}]}], 
    "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Set", " ", "the", " ", "directory", " ", "for", " ", "the", " ", "search",
     " ", "where", " ", "tabulated", " ", "acceptances", " ", "are", " ", 
    "located"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"directory", "[", "\"\<Acceptances\>\"", "]"}], "=", 
    RowBox[{"FileNameJoin", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"NotebookDirectory", "[", "]"}], ",", "\"\<Acceptances\>\""}], 
      "}"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Set", " ", "the", " ", "directory", " ", "for", " ", "the", " ", 
     "search", " ", "where", " ", "tabulated", " ", "angle"}], "-", 
    RowBox[{"energy", " ", "distributions", " ", "are", " ", "located"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"directory", "[", "\"\<Distribution\>\"", "]"}], "=", 
    RowBox[{"FileNameJoin", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"NotebookDirectory", "[", "]"}], ",", 
       "\"\<spectra/New physics particles spectra\>\"", ",", "LLPdirName"}], 
      "}"}], "]"}]}], ";"}], " ", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "The", " ", "directory", " ", "storing", " ", "production", " ", "weights",
     " ", "of", " ", "the", " ", "given", " ", "LLP"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"directory", "[", "\"\<Production weights\>\"", "]"}], "=", 
    RowBox[{"FileNameJoin", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"NotebookDirectory", "[", "]"}], ",", "\"\<phenomenology\>\"", 
       ",", "LLPdirName", ",", "\"\<Production probabilities\>\""}], "}"}], 
     "]"}]}], ";"}], " ", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Directory", " ", "to", " ", "which", " ", "various", " ", "auxillary", 
    " ", "datasets", " ", "will", " ", "be", " ", "stored"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"directory", "[", "\"\<Auxiliary\>\"", "]"}], "=", 
    RowBox[{"FileNameJoin", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"NotebookDirectory", "[", "]"}], ",", "\"\<Auxiliary data\>\"",
        ",", "LLPdirName"}], "}"}], "]"}]}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"!", 
      RowBox[{"DirectoryQ", "[", 
       RowBox[{"directory", "[", "\"\<Auxiliary\>\"", "]"}], "]"}]}], ",", 
     RowBox[{"CreateDirectory", "[", 
      RowBox[{"directory", "[", "\"\<Auxiliary\>\"", "]"}], "]"}]}], "]"}], 
   ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Directory", " ", "containing", " ", "decay", " ", "widths", " ", "of", 
    " ", "the", " ", "LLPs"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"directory", "[", "\"\<Decays\>\"", "]"}], "=", 
    RowBox[{"FileNameJoin", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"NotebookDirectory", "[", "]"}], ",", "\"\<phenomenology\>\"", 
       ",", "LLPdirName", ",", "\"\<decay widths\>\""}], "}"}], "]"}]}], 
   ";"}], " "}]}], "Input",
 CellChangeTimes->{{3.913804080271287*^9, 3.913804171309696*^9}, {
   3.913804205284999*^9, 3.913804380241178*^9}, {3.9138103204454637`*^9, 
   3.9138103216469903`*^9}, 3.9138295316757774`*^9, {3.9138664030078764`*^9, 
   3.9138664044074554`*^9}, {3.913871718367205*^9, 3.9138717189543257`*^9}, {
   3.9156429956931515`*^9, 3.9156429957114162`*^9}, 3.9506768301872654`*^9, {
   3.9506814495506535`*^9, 3.950681449716963*^9}},
 CellTags->{"Acceptance", "Number-of-events+sensitivity"},
 CellLabel->"In[17]:=",ExpressionUUID->"d67e103e-ff85-49fc-80ad-39fdd6887281"]
}, Closed]],

Cell[CellGroupData[{

Cell["Loading necessary routines", "Chapter",
 CellChangeTimes->{{3.891315426588935*^9, 3.891315432542842*^9}, {
  3.9165033404709945`*^9, 3.9165033463985844`*^9}},
 CellTags->{
  "Acceptance", 
   "Number-of-events+sensitivity"},ExpressionUUID->"57c7a938-d451-c84c-97c8-\
27e9bb6cc729"],

Cell[BoxData[
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Length", "[", "inecessary", "]"}], "==", "0"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"NotebookEvaluate", "[", 
     RowBox[{"FileNameJoin", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"NotebookDirectory", "[", "]"}], ",", 
        "\"\<codes/generic.nb\>\""}], "}"}], "]"}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"NotebookEvaluate", "[", 
     RowBox[{"FileNameJoin", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"NotebookDirectory", "[", "]"}], ",", 
        "\"\<codes/dialog-windows.nb\>\""}], "}"}], "]"}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"NotebookEvaluate", "[", 
     RowBox[{"FileNameJoin", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"NotebookDirectory", "[", "]"}], ",", 
        "\"\<codes/for-sensitivities.nb\>\""}], "}"}], "]"}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"inecessary", "=", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], ";"}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.890711783488103*^9, 3.89071178348964*^9}, {
   3.8907121412539587`*^9, 3.8907121413711557`*^9}, {3.890712694841427*^9, 
   3.8907126950000925`*^9}, {3.890712790376151*^9, 3.8907128219919777`*^9}, {
   3.891018553068019*^9, 3.8910185548862777`*^9}, {3.914141327087761*^9, 
   3.9141413282588053`*^9}, 3.9165033910195627`*^9, {3.916503434997039*^9, 
   3.9165034401725807`*^9}, {3.9165108789774036`*^9, 
   3.9165108974096084`*^9}, {3.9165109290075464`*^9, 3.916510969839264*^9}, {
   3.948258207380787*^9, 3.948258211345028*^9}, 3.9506034636103725`*^9},
 CellTags->{"Acceptance", "Number-of-events+sensitivity"},
 CellLabel->"In[25]:=",ExpressionUUID->"d9f5d65b-f701-cd49-854f-7917d7ca7e42"]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 "LLP phenomenology: production probabilities, decay widths (y = ",
 Cell[BoxData[
  FormBox[
   RowBox[{"2", 
    RowBox[{
     SubscriptBox["v", "h"], "/", 
     SubscriptBox["f", "a"]}]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "ad794fe9-c8ab-734d-ba84-7522b01f5a5e"],
 ")"
}], "Chapter",
 CellChangeTimes->{{3.835270415198964*^9, 3.8352704154970675`*^9}, {
   3.854441650570236*^9, 3.8544416515373263`*^9}, {3.885016402104937*^9, 
   3.8850164030053596`*^9}, 3.885019196491799*^9, {3.885019273945055*^9, 
   3.88501928458453*^9}, {3.9137189927638807`*^9, 3.9137190046798325`*^9}, {
   3.913885716759034*^9, 3.9138857170412054`*^9}, 3.9156429957300444`*^9, {
   3.9165110273298607`*^9, 3.9165110322385736`*^9}, {3.9505894314538918`*^9, 
   3.95058943210466*^9}, {3.9527411308699455`*^9, 3.95274113441243*^9}},
 CellTags->{
  "Acceptance", 
   "Number-of-events+sensitivity"},ExpressionUUID->"89802de9-cd6b-471a-b913-\
4f949b4b89c5"],

Cell[CellGroupData[{

Cell["Fix the ALP production description", "Section",
 CellChangeTimes->{{3.950672462032257*^9, 3.9506724675321465`*^9}},
 CellTags->{
  "Acceptance", 
   "Number-of-events+sensitivity"},ExpressionUUID->"6717ef21-ab4c-fb4b-b107-\
b8c134c5c613"],

Cell[BoxData[{
 RowBox[{"Print", "[", "\"\<Description of the ALP production\>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"SelectedProductionChoice", "=", 
  RowBox[{"selectionDialogExplanationOneOption", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "\"\<Revised (2501.04525)\>\"", ",", "\"\<Old (2201.05170)\>\""}], "}"}],
     ",", 
    RowBox[{"{", 
     RowBox[{
     "\"\<Production is split into proton bremsstrahlung, fragmentation, \
Drell-Yan process, and decays of various mesons (see 2501.04525)\>\"", ",", 
      "\"\<Production is split into production `via mixing` (2201.05170), \
decays of B mesons, and Drell-Yan process. For the production `via mixing`, \
in the squared mixing angles, the quark chiral rotation matrix is set to \!\(\
\*SubscriptBox[\(\[Kappa]\), \(q\)]\) = \
diag(\!\(\*SubscriptBox[SuperscriptBox[\(m\), \(-1\)], \
\(u\)]\),\!\(\*SubscriptBox[SuperscriptBox[\(m\), \(-1\)], \
\(d\)]\),\!\(\*SubscriptBox[SuperscriptBox[\(m\), \(-1\)], \
\(s\)]\))/\!\(\*SubscriptBox[\(\[Sum]\), \
\(q\)]\)\!\(\*SubscriptBox[SuperscriptBox[\(m\), \(-1\)], \(q\)]\)\>\""}], 
     "}"}], ",", 
    RowBox[{
    "\"\<Select the description of the \>\"", "<>", "LLPdirName", "<>", 
     "\"\< production:\>\""}], ",", "200"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"condrev", "=", 
   RowBox[{
   "SelectedProductionChoice", "==", "\"\<Revised (2501.04525)\>\""}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.950866056896988*^9, 3.9508660578184814`*^9}, {
  3.9525913742790775`*^9, 3.9525913874778233`*^9}},
 CellTags->{"Acceptance", "Number-of-events+sensitivity"},
 CellLabel->"In[26]:=",ExpressionUUID->"773cc7e1-5f20-b94f-8ec6-b63220bbd69c"]
}, Closed]],

Cell[CellGroupData[{

Cell["Production probabilities", "Section",
 CellChangeTimes->{{3.826713169183443*^9, 3.8267131698544655`*^9}, {
  3.885138658855132*^9, 3.8851386649516826`*^9}},
 CellTags->{
  "Acceptance", 
   "Number-of-events+sensitivity"},ExpressionUUID->"7792752f-e20c-cf42-841f-\
2b987ee07250"],

Cell[CellGroupData[{

Cell["Preliminary definitions", "Subsection",
 CellChangeTimes->{{3.950606168752966*^9, 3.9506061725392838`*^9}},
 CellTags->{
  "Acceptance", 
   "Number-of-events+sensitivity"},ExpressionUUID->"3623661c-f4fc-b946-b81d-\
9857ff564d5b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ProductionProbabilitiesCoefs", "[", "mLLP_", "]"}], "=", 
   RowBox[{"Import", "[", 
    RowBox[{
     RowBox[{"FileNameJoin", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"directory", "[", "\"\<Production weights\>\"", "]"}], ",", 
        RowBox[{
        "\"\<Coefficients-\>\"", "<>", "LLPdirName", "<>", 
         "\"\<-Lambda=1.-TeV.mx\>\""}]}], "}"}], "]"}], ",", "\"\<MX\>\""}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ProductionProbabilitiesCoefs", "[", "mLLP_", "]"}], "[", 
   RowBox[{"[", 
    RowBox[{"All", ",", "1"}], "]"}], "]"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Effective", " ", "coefficient", " ", "defining", " ", "the", " ", "flux", 
    " ", "via", " ", 
    RowBox[{"DIS", ":", " ", 
     SubscriptBox["\[Sigma]", "DIS"]}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"cGeff2", "[", 
     RowBox[{"mLLP_", ",", "y_"}], "]"}], "=", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"F\[Pi]", "*", 
        RowBox[{"(", 
         FractionBox["y", 
          RowBox[{"2", "vh"}]], ")"}]}], ")"}], "2"], "*", 
     RowBox[{
      RowBox[{
       RowBox[{"ProductionProbabilitiesCoefs", "[", "mLLP", "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}], "[", 
      RowBox[{"[", "2", "]"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Effective", " ", "mixing", " ", "angles", " ", "to", " ", "be", " ", 
    "used", " ", "for", " ", "the", " ", "outdated", " ", "description", " ", 
    "of", " ", "the", " ", "production", " ", "via", " ", "mixing", " ", 
    "with", " ", "neutral", " ", "mesons"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Theta]am02", "[", 
      RowBox[{"\"\<Pi0\>\"", ",", "mLLP_", ",", "y_"}], "]"}], ",", 
     RowBox[{"\[Theta]am02", "[", 
      RowBox[{"\"\<Eta\>\"", ",", "mLLP_", ",", "y_"}], "]"}], ",", 
     RowBox[{"\[Theta]am02", "[", 
      RowBox[{"\"\<EtaPr\>\"", ",", "mLLP_", ",", "y_"}], "]"}]}], "}"}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"F\[Pi]", "*", 
         RowBox[{"(", 
          FractionBox["y", 
           RowBox[{"2", "vh"}]], ")"}]}], ")"}], "2"], 
      RowBox[{
       RowBox[{
        RowBox[{"ProductionProbabilitiesCoefs", "[", "mLLP", "]"}], "[", 
        RowBox[{"[", "#", "]"}], "]"}], "[", 
       RowBox[{"[", "2", "]"}], "]"}]}], "&"}], "/@", 
    RowBox[{"{", 
     RowBox[{"2", ",", "3", ",", "4"}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"LogLogPlot", "[", 
  RowBox[{
   RowBox[{"Evaluate", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"\[Theta]am02", "[", 
       RowBox[{"#", ",", "ma", ",", "1"}], "]"}], "&"}], "/@", 
     RowBox[{"{", 
      RowBox[{"\"\<Pi0\>\"", ",", "\"\<Eta\>\"", ",", "\"\<EtaPr\>\""}], 
      "}"}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"ma", ",", "0.1", ",", "10"}], "}"}], ",", 
   RowBox[{"Frame", "\[Rule]", "True"}], ",", 
   RowBox[{"FrameStyle", "->", 
    RowBox[{"Directive", "[", 
     RowBox[{"Thick", ",", "Black", ",", "18"}], "]"}]}], ",", 
   RowBox[{"FrameLabel", "->", 
    RowBox[{"{", 
     RowBox[{
     "\"\<\!\(\*SubscriptBox[\(m\), \(a\)]\) [GeV]\>\"", ",", 
      "\"\<|\!\(\*SubscriptBox[\(\[Theta]\), \(\*SuperscriptBox[\(m\), \(0\)] \
a\)]\)\!\(\*SuperscriptBox[\(|\), \(2\)]\)\>\""}], "}"}]}], ",", 
   RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
   RowBox[{"PlotLegends", "->", 
    RowBox[{"Placed", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Style", "[", 
         RowBox[{
          RowBox[{"Row", "[", 
           RowBox[{"{", "#", "}"}], "]"}], ",", "18", ",", "Black"}], "]"}], 
        "&"}], "/@", 
       RowBox[{"{", 
        RowBox[{"\"\<Pi0\>\"", ",", "\"\<Eta\>\"", ",", "\"\<EtaPr\>\""}], 
        "}"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"0.8", ",", "0.8"}], "}"}]}], "]"}]}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.95062789520059*^9, 3.9506281133036175`*^9}, {
  3.9506310755647564`*^9, 3.9506310865621166`*^9}, {3.950867662210644*^9, 
  3.9508676793661385`*^9}, {3.952573885927429*^9, 3.952573978898735*^9}, {
  3.9525915982478905`*^9, 3.9525915982478905`*^9}},
 CellTags->{"Acceptance", "Number-of-events+sensitivity"},
 CellLabel->"In[29]:=",ExpressionUUID->"26988afd-11a9-1c44-bd18-59a8a9fac28b"]
}, Closed]],

Cell[CellGroupData[{

Cell["Via decays of light mesons", "Subsection",
 CellChangeTimes->{{3.8867412989661756`*^9, 3.8867413212030272`*^9}, 
   3.9341784414069138`*^9, {3.934603115035019*^9, 3.9346031150669155`*^9}, {
   3.949905959421137*^9, 3.9499059654875813`*^9}, {3.949906019377102*^9, 
   3.949906022103487*^9}, {3.9499071088334007`*^9, 3.949907110015276*^9}, 
   3.950603920259514*^9, {3.9506040408618984`*^9, 3.9506040424213753`*^9}, {
   3.95060449300844*^9, 3.9506044952196712`*^9}},
 CellTags->{
  "Acceptance", 
   "Number-of-events+sensitivity"},ExpressionUUID->"e25a0e24-a022-4842-96cd-\
1f84559c3f94"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"PmotherToLLP", "//", "Clear"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FacilitiesList", "=", 
   RowBox[{"{", 
    RowBox[{
    "\"\<SPS\>\"", ",", "\"\<FermilabBD\>\"", ",", "\"\<LHC\>\"", ",", 
     "\"\<FCC-hh\>\"", ",", "\"\<Serpukhov\>\""}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BrRatiosM2model", "[", 
    RowBox[{"mLLP_", ",", "E1_", ",", "E3_"}], "]"}], "=", 
   RowBox[{"Import", "[", 
    RowBox[{
     RowBox[{"FileNameJoin", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"NotebookDirectory", "[", "]"}], ",", "\"\<phenomenology\>\"",
         ",", "LLPdirName", ",", "\"\<production probabilities\>\"", ",", 
        RowBox[{
        "\"\<BrRatios-Msquared-LightMesonDecays-\>\"", "<>", "LLPdirName", 
         "<>", "\"\<-Lambda=1.-TeV.mx\>\""}]}], "}"}], "]"}], ",", 
     "\"\<MX\>\""}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"proc", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"BrRatiosM2model", "[", 
           RowBox[{"mLLP", ",", "E1", ",", "E3"}], "]"}], "[", 
          RowBox[{"[", "i", "]"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Brproc", "[", 
         RowBox[{"proc", ",", "mLLP_"}], "]"}], "=", 
        RowBox[{
         RowBox[{
          RowBox[{"BrRatiosM2model", "[", 
           RowBox[{"mLLP", ",", "E1", ",", "E3"}], "]"}], "[", 
          RowBox[{"[", "i", "]"}], "]"}], "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], ";"}]}], "\[IndentingNewLine]", 
     "]"}], "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", 
      RowBox[{"Length", "[", 
       RowBox[{"BrRatiosM2model", "[", 
        RowBox[{"mLLP", ",", "E1", ",", "E3"}], "]"}], "]"}], ",", "1"}], 
     "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{"condrev", ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"procs", "=", 
      RowBox[{
       RowBox[{"Keys", "[", 
        RowBox[{"DownValues", "@", "Brproc"}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "1", ",", "1"}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "Extracting", " ", "possible", " ", "mother", " ", "particles"}], 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"mothers", " ", "=", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"StringSplit", "[", 
           RowBox[{"#", ",", "\"\<-to-\>\""}], "]"}], "&"}], "/@", "procs"}], 
        ")"}], "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "1"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"mothersUnique", "=", 
      RowBox[{"mothers", "//", "DeleteDuplicates"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"mothersprocs", "=", 
      RowBox[{"Transpose", "[", 
       RowBox[{"{", 
        RowBox[{"mothers", ",", "procs"}], "}"}], "]"}]}], ";"}], 
    "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"mothers", "=", 
      RowBox[{"mothersUnique", "=", 
       RowBox[{"{", "\"\<B\>\"", "}"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"procs", "=", 
      RowBox[{"{", "\"\<B\>\"", "}"}]}]}]}], "\[IndentingNewLine]", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"!", 
      RowBox[{"MemberQ", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"\"\<Bplus\>\"", ",", "\"\<B0\>\""}], "}"}], ",", "m"}], 
       "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"procsmother", "=", 
       RowBox[{
        RowBox[{"Select", "[", 
         RowBox[{"mothersprocs", ",", 
          RowBox[{
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "==", "m"}], "&"}]}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "2"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"!", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"m", "==", "\"\<B\>\""}], "&&", 
           RowBox[{"Facility", "==", "\"\<Serpukhov\>\""}]}], ")"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"PmotherToLLP", "[", 
          RowBox[{"mLLP_", ",", "y_", ",", "m", ",", "Facility"}], "]"}], "=", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"F\[Pi]", "*", 
             RowBox[{"(", 
              FractionBox["y", 
               RowBox[{"2", "vh"}]], ")"}]}], ")"}], "2"], "*", 
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{"Brproc", "[", 
             RowBox[{"proc", ",", "mLLP"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"proc", ",", "procsmother"}], "}"}]}], "]"}]}]}]}], 
       "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}], 
   "\[IndentingNewLine]", ",", 
   RowBox[{"{", 
    RowBox[{"m", ",", "mothersUnique"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"Facility", ",", "FacilitiesList"}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.886741324632948*^9, 3.88674133750587*^9}, {
   3.886743349704631*^9, 3.886743469951105*^9}, {3.8867435208363976`*^9, 
   3.886743559442109*^9}, {3.8867436030673923`*^9, 3.8867436380024014`*^9}, {
   3.886743677147029*^9, 3.886743791056388*^9}, {3.886759023397938*^9, 
   3.886759051632529*^9}, {3.886759084894906*^9, 3.886759102806116*^9}, {
   3.886759322833825*^9, 3.886759324091713*^9}, {3.8867597957163935`*^9, 
   3.886760018253701*^9}, {3.8867600560403585`*^9, 3.8867601972064524`*^9}, {
   3.8867608717265434`*^9, 3.886760928433196*^9}, {3.8902877382139034`*^9, 
   3.8902877885168395`*^9}, {3.890287908819491*^9, 3.8902879384574685`*^9}, 
   3.890287972630889*^9, {3.892180139844576*^9, 3.8921801533898745`*^9}, {
   3.895134860239647*^9, 3.8951348618856735`*^9}, {3.913885646039929*^9, 
   3.9138856461076612`*^9}, {3.913886132582429*^9, 3.9138862291902003`*^9}, {
   3.9138862898048983`*^9, 3.913886296467663*^9}, {3.9138863354750943`*^9, 
   3.913886444520909*^9}, {3.913886535421424*^9, 3.9138865559413123`*^9}, {
   3.9138866804744043`*^9, 3.91388669116334*^9}, {3.9138867279182673`*^9, 
   3.913886743667845*^9}, {3.913886776305146*^9, 3.913886808473711*^9}, 
   3.913891300284439*^9, {3.9138914285753727`*^9, 3.9138914308549423`*^9}, {
   3.9140569592224464`*^9, 3.914057049571749*^9}, {3.91405713461141*^9, 
   3.9140573182167463`*^9}, {3.9140575578723235`*^9, 
   3.9140575965440426`*^9}, {3.9140576438565454`*^9, 3.91405766710573*^9}, {
   3.914066702491934*^9, 3.9140667055321317`*^9}, {3.9156430596213613`*^9, 
   3.9156430599242363`*^9}, {3.9168531211335497`*^9, 3.9168531508029346`*^9}, 
   3.916853392897682*^9, {3.9183726881038265`*^9, 3.9183726890585165`*^9}, {
   3.9304926142034054`*^9, 3.930492627348414*^9}, {3.930492673679298*^9, 
   3.930492677532892*^9}, {3.9304929656803293`*^9, 3.9304930113803177`*^9}, {
   3.9304931130163293`*^9, 3.93049322093799*^9}, {3.9304932649586377`*^9, 
   3.9304933298752604`*^9}, 3.9304934971411295`*^9, {3.9304935941993275`*^9, 
   3.9304935978649535`*^9}, {3.930493636619055*^9, 3.9304936428913436`*^9}, {
   3.9341783445584946`*^9, 3.934178375802986*^9}, {3.934178508184925*^9, 
   3.934178544741392*^9}, {3.9344710519821224`*^9, 3.9344710525668373`*^9}, {
   3.934473043593466*^9, 3.9344730438118114`*^9}, {3.934521371622252*^9, 
   3.9345213764502163`*^9}, {3.9499075818006134`*^9, 
   3.9499075850145054`*^9}, {3.9506040691800823`*^9, 3.950604117211727*^9}, {
   3.950604814709816*^9, 3.9506048694783115`*^9}, 3.9506049369964657`*^9, {
   3.9506281410472183`*^9, 3.9506283054403515`*^9}, {3.9506283386712055`*^9, 
   3.950628342975775*^9}, {3.9506313626798744`*^9, 3.950631380683359*^9}, {
   3.9506314585059643`*^9, 3.950631459260515*^9}, {3.950631532822956*^9, 
   3.9506315330949173`*^9}, {3.950631874759735*^9, 3.950631874963707*^9}, 
   3.9506333905285454`*^9, {3.9506724964764843`*^9, 3.9506725107358437`*^9}, 
   3.9508676943016396`*^9, 3.9525740363649254`*^9, {3.9525740877792187`*^9, 
   3.952574159658291*^9}, {3.9525742117478504`*^9, 3.952574280865509*^9}, 
   3.952584978135132*^9, {3.952588016832903*^9, 3.9525880524619045`*^9}, {
   3.952588135209532*^9, 3.952588166442375*^9}, {3.9525884128977127`*^9, 
   3.9525884337152023`*^9}, 3.9525915982566776`*^9, {3.952746714646492*^9, 
   3.952746745909502*^9}},
 CellTags->{
  "Acceptance", 
   "Number-of-events+sensitivity"},ExpressionUUID->"93877176-470d-5b4a-87db-\
0f49b1478819"]
}, Closed]],

Cell[CellGroupData[{

Cell["Via Drell-Yan", "Subsection",
 CellChangeTimes->{{3.934178450342802*^9, 3.9341784530070715`*^9}},
 CellTags->{
  "Number-of-events+sensitivity", 
   "Acceptance"},ExpressionUUID->"ec1691b9-f9be-7247-9f9c-d63aa93c450e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "___", "___", "___", "___", "___", "___", "___", "___", "___", "__"}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Production", " ", "from", " ", "Drell"}], "-", 
    RowBox[{"Yan", " ", "process"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "___", "___", "___", "___", "___", "___", "___", "___", "___", "__"}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"\[Sigma]DrellYanData", "[", "Facility_", "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"file", "=", 
        RowBox[{"FileNameJoin", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"directory", "[", "\"\<Production weights\>\"", "]"}], ",", 
           RowBox[{
           "\"\<sigmaDrellYan_\>\"", "<>", "LLPdirName", "<>", "\"\<_\>\"", "<>",
             "Facility", "<>", "\"\<.txt\>\""}]}], "}"}], "]"}]}], "}"}], ",",
       "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"FileExistsQ", "[", "file", "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"dat", "=", 
          RowBox[{"Import", "[", 
           RowBox[{"file", ",", "\"\<Table\>\""}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"MinMaxMassesDrellYan", "[", "Facility", "]"}], "=", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Min", "[", 
             RowBox[{"dat", "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}], ",", 
            RowBox[{"Max", "[", 
             RowBox[{"dat", "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}]}], "}"}]}], ";",
          "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"int", "[", 
             RowBox[{"ma_", ",", "\"\<Central\>\""}], "]"}], ",", 
            RowBox[{"int", "[", 
             RowBox[{"ma_", ",", "\"\<Lower\>\""}], "]"}], ",", 
            RowBox[{"int", "[", 
             RowBox[{"ma_", ",", "\"\<Upper\>\""}], "]"}]}], "}"}], "=", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"MinMaxMassesDrellYan", "[", "Facility", "]"}], "[", 
                RowBox[{"[", "1", "]"}], "]"}], "\[LessEqual]", " ", "ma", 
               "\[LessEqual]", 
               RowBox[{
                RowBox[{"MinMaxMassesDrellYan", "[", "Facility", "]"}], "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], ",", 
              RowBox[{"Evaluate", "[", 
               RowBox[{"10", "^", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"Interpolation", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Log10", "[", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Log10", "[", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "+", 
                    SuperscriptBox["10", 
                    RowBox[{"-", "90"}]]}], "]"}]}], "}"}], "&"}], "/@", 
                    "dat"}], ",", 
                    RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], 
                  "[", 
                  RowBox[{"Log10", "[", "ma", "]"}], "]"}], ")"}]}], "]"}], 
              ",", "0."}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "2", ",", "4"}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"PmotherToLLP", "[", 
             RowBox[{
             "mLLP_", ",", "y_", ",", "\"\<DrellYan-Central\>\"", ",", 
              "Facility"}], "]"}], ",", 
            RowBox[{"PmotherToLLP", "[", 
             RowBox[{
             "mLLP_", ",", "y_", ",", "\"\<DrellYan-Upper\>\"", ",", 
              "Facility"}], "]"}], ",", 
            RowBox[{"PmotherToLLP", "[", 
             RowBox[{
             "mLLP_", ",", "y_", ",", "\"\<DrellYan-Lower\>\"", ",", 
              "Facility"}], "]"}]}], "}"}], "=", 
          RowBox[{
           RowBox[{"cGeff2", "[", 
            RowBox[{"mLLP", ",", "y"}], "]"}], "*", 
           FractionBox[
            RowBox[{
             RowBox[{
              RowBox[{"int", "[", 
               RowBox[{"mLLP", ",", "#"}], "]"}], "&"}], "/@", 
             RowBox[{"{", 
              RowBox[{
              "\"\<Central\>\"", ",", "\"\<Upper\>\"", ",", "\"\<Lower\>\""}],
               "}"}]}], 
            RowBox[{"\[Sigma]pNucleonInpb", "[", "Atarget", "]"}]]}]}]}]}], 
       "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{"\[Sigma]DrellYanData", "[", "Facility", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"Facility", ",", 
       RowBox[{"{", 
        RowBox[{
        "\"\<SPS\>\"", ",", "\"\<FermilabBD\>\"", ",", "\"\<LHC\>\""}], 
        "}"}]}], "}"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.934178591179254*^9, 3.934178591401297*^9}, {
   3.9341803422559166`*^9, 3.934180342695938*^9}, {3.9344730407257247`*^9, 
   3.9344730412754993`*^9}, {3.941857880812441*^9, 3.941857903406212*^9}, {
   3.9418581324598885`*^9, 3.9418581820047417`*^9}, {3.941858238034336*^9, 
   3.941858238518362*^9}, {3.9418582761955223`*^9, 3.941858283120514*^9}, 
   3.9483009204696426`*^9, {3.949907483614649*^9, 3.949907490854973*^9}, {
   3.950605084758272*^9, 3.950605098286371*^9}, {3.950605484553961*^9, 
   3.950605513419489*^9}, {3.9506055469212627`*^9, 3.9506055552143955`*^9}, {
   3.9506061955052834`*^9, 3.950606215840826*^9}, {3.950628127312071*^9, 
   3.9506281309525833`*^9}, {3.952574032282036*^9, 3.952574032282036*^9}, {
   3.952574476997492*^9, 3.9525744908924503`*^9}, {3.952702008578001*^9, 
   3.9527020099782696`*^9}},
 CellTags->{"Number-of-events+sensitivity", "Acceptance"},
 CellLabel->"In[40]:=",ExpressionUUID->"e490f5f0-d959-574c-8b5f-d51735710a2b"]
}, Closed]],

Cell[CellGroupData[{

Cell["Via proton bremsstrahlung", "Subsection",
 CellChangeTimes->{{3.934178450342802*^9, 3.9341784593374634`*^9}, {
  3.9434111585174828`*^9, 3.9434111602318916`*^9}},
 CellTags->{
  "Number-of-events+sensitivity", 
   "Acceptance"},ExpressionUUID->"6e53cf51-459c-464e-9f98-8bbf36d051f6"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"If", "[", 
    RowBox[{"condrev", ",", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"___", "___", "___", "___", "___", "_"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"(*", "Bremsstrahlung", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"___", "___", "___", "___", "___", "_"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"BremProd", "[", "Facility_", "]"}], ":=", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"bremprobfiles", "=", 
           RowBox[{"FileNames", "[", 
            RowBox[{
             RowBox[{
             "\"\<ProdProb*_\>\"", "<>", "Facility", "<>", "\"\<.m\>\""}], 
             ",", 
             RowBox[{"directory", "[", "\"\<Production weights\>\"", "]"}]}], 
            "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"bremprobfiles", "!=", 
             RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{
             "Scanning", " ", "over", " ", "all", " ", "available", " ", 
              "files", " ", "with", " ", "the", " ", "bremsstrahlung", " ", 
              RowBox[{"probability", ".", " ", "They"}], " ", "describe", " ",
               "different", " ", "descriptions", " ", "of", " ", "the", " ", 
              "bremsstrahlung"}], "*)"}], "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{
             "Extract", " ", "the", " ", "bremsstrahlung", " ", "description",
               " ", "from", " ", "the", " ", "filename"}], "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"bremprobfilenames", "=", 
              RowBox[{
               RowBox[{
                RowBox[{"Last", "@", 
                 RowBox[{"FileNameSplit", "[", "#", "]"}]}], "&"}], "/@", 
               "bremprobfiles"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"bremdescriptions", "=", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"StringSplit", "[", 
                   RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    "\"\<ProdProb_\>\"", "<>", "LLPdirName", "<>", 
                    "\"\<_\>\""}], ",", "\"\<_\>\""}], "}"}]}], "]"}], "[", 
                  RowBox[{"[", "1", "]"}], "]"}], ")"}], "&"}], "/@", 
               "bremprobfilenames"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"Do", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"datbrem", "[", 
                  RowBox[{"mLLP_", ",", "\[Theta]LLP_"}], "]"}], "=", 
                 RowBox[{"Import", "[", 
                  RowBox[{
                   RowBox[{"bremprobfiles", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", "\"\<MX\>\""}], 
                  "]"}]}], ";", "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"StringContainsQ", "[", 
                   RowBox[{
                    RowBox[{"bremdescriptions", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", "\"\<Baseline\>\""}],
                    "]"}], ",", "\[IndentingNewLine]", 
                  RowBox[{"(*", 
                   RowBox[{
                    RowBox[{
                    "Bremsstrahlung", " ", "data", " ", "is", " ", "stored", 
                    " ", "assuming", " ", "f"}], " ", "=", " ", 
                    RowBox[{"1", " ", "GeV"}]}], "*)"}], 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"PmotherToLLP", "[", 
                    RowBox[{"mLLP_", ",", "y_", ",", 
                    RowBox[{"bremdescriptions", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", "Facility"}], "]"}], 
                    "=", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"datbrem", "[", 
                    RowBox[{"mLLP", ",", "\[Theta]LLP"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "*", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"F\[Pi]", "*", 
                    RowBox[{"(", 
                    FractionBox["y", 
                    RowBox[{"2", "vh"}]], ")"}]}], ")"}], "2"]}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"ELLPmin", "[", 
                    RowBox[{
                    RowBox[{"bremdescriptions", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", "Facility"}], "]"}], 
                    "=", 
                    RowBox[{"Evaluate", "[", 
                    RowBox[{
                    RowBox[{"datbrem", "[", 
                    RowBox[{"mLLP", ",", "\[Theta]LLP"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "]"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"\[Theta]maxBrem", "[", 
                    RowBox[{
                    RowBox[{"bremdescriptions", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", "Facility"}], "]"}], 
                    "=", 
                    RowBox[{"Evaluate", "[", 
                    RowBox[{
                    RowBox[{"datbrem", "[", 
                    RowBox[{"mLLP", ",", "\[Theta]LLP"}], "]"}], "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "]"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"ELLPmax", "[", 
                    RowBox[{"mLLP_", ",", "\[Theta]LLP_", ",", 
                    RowBox[{"bremdescriptions", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", "Facility"}], "]"}], 
                    "=", 
                    RowBox[{"Evaluate", "[", 
                    RowBox[{
                    RowBox[{"datbrem", "[", 
                    RowBox[{"mLLP", ",", "\[Theta]LLP"}], "]"}], "[", 
                    RowBox[{"[", "4", "]"}], "]"}], "]"}]}], ";"}], 
                  "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
                  RowBox[{"Do", "[", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"PmotherToLLP", "[", 
                    RowBox[{"mLLP_", ",", "y_", ",", 
                    RowBox[{
                    RowBox[{"bremdescriptions", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "<>", "\"\<-\>\"", "<>", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"datbrem", "[", 
                    RowBox[{"mLLP", ",", "\[Theta]LLP"}], "]"}], "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ",", "Facility"}], 
                    "]"}], "=", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"datbrem", "[", 
                    RowBox[{"mLLP", ",", "\[Theta]LLP"}], "]"}], "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "*", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"F\[Pi]", "*", 
                    RowBox[{"(", 
                    FractionBox["y", 
                    RowBox[{"2", "vh"}]], ")"}]}], ")"}], "2"]}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"ELLPmin", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"bremdescriptions", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "<>", "\"\<-\>\"", "<>", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"datbrem", "[", 
                    RowBox[{"mLLP", ",", "\[Theta]LLP"}], "]"}], "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ",", "Facility"}], 
                    "]"}], "=", 
                    RowBox[{"Evaluate", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"datbrem", "[", 
                    RowBox[{"mLLP", ",", "\[Theta]LLP"}], "]"}], "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"\[Theta]maxBrem", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"bremdescriptions", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "<>", "\"\<-\>\"", "<>", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"datbrem", "[", 
                    RowBox[{"mLLP", ",", "\[Theta]LLP"}], "]"}], "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ",", "Facility"}], 
                    "]"}], "=", 
                    RowBox[{"Evaluate", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"datbrem", "[", 
                    RowBox[{"mLLP", ",", "\[Theta]LLP"}], "]"}], "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "[", 
                    RowBox[{"[", "4", "]"}], "]"}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"ELLPmax", "[", 
                    RowBox[{"mLLP_", ",", "\[Theta]LLP_", ",", 
                    RowBox[{
                    RowBox[{"bremdescriptions", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "<>", "\"\<-\>\"", "<>", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"datbrem", "[", 
                    RowBox[{"mLLP", ",", "\[Theta]LLP"}], "]"}], "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ",", "Facility"}], 
                    "]"}], "=", 
                    RowBox[{"Evaluate", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"datbrem", "[", 
                    RowBox[{"mLLP", ",", "\[Theta]LLP"}], "]"}], "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "[", 
                    RowBox[{"[", "5", "]"}], "]"}], "]"}]}], ";"}], 
                    "\[IndentingNewLine]", ",", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", "1", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"datbrem", "[", 
                    RowBox[{"mLLP", ",", "\[Theta]LLP"}], "]"}], "]"}], ",", 
                    "1"}], "}"}]}], "]"}]}], "\[IndentingNewLine]", "]"}]}], 
               "\[IndentingNewLine]", ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", "1", ",", 
                 RowBox[{"Length", "[", "bremdescriptions", "]"}], ",", "1"}],
                 "}"}]}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}]}], 
        "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"BremProd", "[", "Facility", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"Facility", ",", 
          RowBox[{"{", 
           RowBox[{
           "\"\<FCC-hh\>\"", ",", "\"\<Serpukhov\>\"", ",", "\"\<SPS\>\"", 
            ",", "\"\<FermilabBD\>\"", ",", "\"\<LHC\>\"", ",", 
            "\"\<SLAC-E137\>\""}], "}"}]}], "}"}]}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.934178879692268*^9, 3.93417892786508*^9}, {
   3.934179061125416*^9, 3.93417906874356*^9}, {3.9341798648031354`*^9, 
   3.934179867892165*^9}, {3.934179928709987*^9, 3.9341799384204144`*^9}, {
   3.9341803211047697`*^9, 3.934180349510409*^9}, {3.9341803870680065`*^9, 
   3.934180415117526*^9}, {3.9341804615924125`*^9, 3.9341804765221124`*^9}, {
   3.934214880611182*^9, 3.9342149181922135`*^9}, {3.934215377448099*^9, 
   3.934215379333004*^9}, 3.9344709898031907`*^9, {3.9344730366502*^9, 
   3.9344730394875703`*^9}, 3.9345555697247343`*^9, 3.935134776288624*^9, {
   3.9422013100021*^9, 3.942201310976145*^9}, 3.94220149301807*^9, {
   3.9422015802490215`*^9, 3.94220158276997*^9}, {3.9422016841357956`*^9, 
   3.9422016889355507`*^9}, {3.9434111756919174`*^9, 
   3.9434112153434486`*^9}, {3.943413726259733*^9, 3.9434137542767677`*^9}, {
   3.943413807983391*^9, 3.943413874962282*^9}, {3.9434154696599407`*^9, 
   3.9434154768135147`*^9}, {3.949907498363449*^9, 3.949907509024029*^9}, {
   3.949907620845789*^9, 3.9499076225270004`*^9}, 3.9499089923210144`*^9, {
   3.950605576963459*^9, 3.9506055773742466`*^9}, {3.9506056973728695`*^9, 
   3.950605711184326*^9}, {3.9506066992103653`*^9, 3.9506067427672844`*^9}, {
   3.9506283514929466`*^9, 3.9506283588610687`*^9}, {3.9506725192597923`*^9, 
   3.9506725261193676`*^9}, {3.9508677128047543`*^9, 3.950867715168041*^9}, {
   3.952574032297964*^9, 3.952574032297964*^9}, {3.9525915982663765`*^9, 
   3.9525915982760983`*^9}},
 CellTags->{"Number-of-events+sensitivity", "Acceptance"},
 CellLabel->"In[42]:=",ExpressionUUID->"5ea081c9-8fd0-8644-b032-52e8e6b8bdd8"]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Via fragmentation or via old description of the production via mixing\
\>", "Subsection",
 CellChangeTimes->{{3.9344709424253836`*^9, 3.934470943472537*^9}, {
  3.9482570604471397`*^9, 3.9482570620400486`*^9}, {3.950605798997381*^9, 
  3.9506058126893215`*^9}},
 CellTags->{
  "Acceptance", 
   "Number-of-events+sensitivity"},ExpressionUUID->"4e26538e-af17-2b40-87bf-\
2bf941d71722"],

Cell[BoxData[{
 RowBox[{"If", "[", 
  RowBox[{"condrev", ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"YieldsFragmentation", "[", "mLLP_", "]"}], "=", 
     RowBox[{"Import", "[", 
      RowBox[{
       RowBox[{"FileNameJoin", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"directory", "[", "\"\<Production weights\>\"", "]"}], ",", 
          RowBox[{
          "\"\<ProductionProbability-Fragmentation-\>\"", "<>", "LLPdirName", 
           "<>", "\"\<.mx\>\""}]}], "}"}], "]"}], ",", "\"\<MX\>\""}], 
      "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"Do", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"fac", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"YieldsFragmentation", "[", "mLLP", "]"}], "[", 
            RowBox[{"[", "i", "]"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"PmotherToLLP", "[", 
          RowBox[{"mLLP_", ",", "y_", ",", "\"\<Fragmentation\>\"", ",", 
           RowBox[{
            RowBox[{
             RowBox[{"YieldsFragmentation", "[", "mLLP", "]"}], "[", 
             RowBox[{"[", "i", "]"}], "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "=", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"F\[Pi]", "*", 
             RowBox[{"(", 
              FractionBox["y", 
               RowBox[{"2", "vh"}]], ")"}]}], ")"}], "2"], "*", 
          RowBox[{
           RowBox[{
            RowBox[{"YieldsFragmentation", "[", "mLLP", "]"}], "[", 
            RowBox[{"[", "i", "]"}], "]"}], "[", 
           RowBox[{"[", "2", "]"}], "]"}]}]}]}], "\[IndentingNewLine]", "]"}],
       "\[IndentingNewLine]", ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", 
        RowBox[{"Length", "[", 
         RowBox[{"YieldsFragmentation", "[", "mLLP", "]"}], "]"}], ",", "1"}],
        "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", ",", 
   "\[IndentingNewLine]", 
   RowBox[{"Do", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"PmotherToLLP", "[", 
        RowBox[{"mLLP_", ",", "y_", ",", 
         RowBox[{"\"\<Old-Mixing-\>\"", "<>", "part"}], ",", "Facility"}], 
        "]"}], "=", 
       RowBox[{"\[Theta]am02", "[", 
        RowBox[{"part", ",", "mLLP", ",", "y"}], "]"}]}], ";"}], 
     "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{"part", ",", 
       RowBox[{"{", 
        RowBox[{"\"\<Pi0\>\"", ",", "\"\<Eta\>\"", ",", "\"\<EtaPr\>\""}], 
        "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"Facility", ",", "FacilitiesList"}], "}"}]}], "]"}]}], 
  "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
 RowBox[{"WeightsCombinations", "=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Keys", "[", 
        RowBox[{"DownValues", "@", "PmotherToLLP"}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "1", ",", "#"}], "]"}], "]"}], "&"}], "/@", 
     RowBox[{"{", 
      RowBox[{"3", ",", "4"}], "}"}]}], "//", "Transpose"}], "//", 
   "Sort"}]}]}], "Input",
 CellChangeTimes->{{3.934470944210307*^9, 3.9344710692350903`*^9}, {
   3.934471113166834*^9, 3.9344711469034414`*^9}, {3.934472982269247*^9, 
   3.9344730114614*^9}, {3.934473322827702*^9, 3.934473351939787*^9}, {
   3.934473715004074*^9, 3.9344737432851853`*^9}, {3.9344737908876925`*^9, 
   3.9344738349429083`*^9}, {3.934473865593743*^9, 3.9344738702532225`*^9}, {
   3.9344739628834076`*^9, 3.934473975355566*^9}, {3.934521362447957*^9, 
   3.934521367353219*^9}, {3.9355102906915417`*^9, 3.935510290935131*^9}, 
   3.941858841819998*^9, {3.9482570938314323`*^9, 3.9482572473059864`*^9}, {
   3.949907511556019*^9, 3.94990756940633*^9}, {3.9499076355408077`*^9, 
   3.949907650270483*^9}, 3.950547702180895*^9, {3.9505883209283543`*^9, 
   3.9505883407321243`*^9}, {3.950605773694891*^9, 3.9506057740056324`*^9}, {
   3.9506060101576805`*^9, 3.950606036318304*^9}, {3.950606093149065*^9, 
   3.95060612064608*^9}, 3.950606154834013*^9, {3.950606750400011*^9, 
   3.9506067982418785`*^9}, {3.950628405967636*^9, 3.9506284322460423`*^9}, {
   3.950631177041483*^9, 3.9506311807963257`*^9}, {3.9506312117107563`*^9, 
   3.950631218600586*^9}, {3.9506312618889656`*^9, 3.950631264310793*^9}, {
   3.950633280233303*^9, 3.950633319090334*^9}, {3.950672245673088*^9, 
   3.9506724543830566`*^9}, {3.950672532978756*^9, 3.9506725526421337`*^9}, 
   3.9508677210226994`*^9, {3.9525740323137646`*^9, 3.9525740323137646`*^9}, 
   3.9525915982776794`*^9},
 CellTags->{"Acceptance", "Number-of-events+sensitivity"},
 CellLabel->"In[43]:=",ExpressionUUID->"befd8136-275e-2340-a745-079baf99bde3"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Scanning for tabulated distributions", "Section",
 CellChangeTimes->{{3.9137150010274553`*^9, 3.9137150224099426`*^9}, {
  3.913715411520641*^9, 3.913715414252445*^9}},
 CellTags->{
  "Acceptance", 
   "Number-of-events+sensitivity"},ExpressionUUID->"7d59f094-3c95-ed40-a349-\
3c63d1c89424"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Define", " ", "the", " ", "file", " ", "pattern"}], "*)"}], "\n", 
  RowBox[{
   RowBox[{
    RowBox[{"pattern", "=", "\"\<DoubleDistr_*_*_*.m\>\""}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Search", " ", "for", " ", "files", " ", "matching", " ", "the", " ", 
     "pattern", " ", "in", " ", "the", " ", "directory", " ", "and", " ", 
     "its", " ", "subdirectories"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"matchingFiles", "=", 
     RowBox[{"FileNames", "[", 
      RowBox[{"pattern", ",", 
       RowBox[{"{", 
        RowBox[{"directory", "[", "\"\<Distribution\>\"", "]"}], "}"}], ",", 
       "Infinity"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"List", " ", "of", " ", "LLPs"}], ",", " ", 
     RowBox[{"production", " ", "modes"}], ",", " ", 
     RowBox[{
     "and", " ", "facilities", " ", "for", " ", "which", " ", "the", " ", 
      "tabulated", " ", "distributions", " ", "have", " ", "been", " ", 
      "computed", " ", "at", " ", "the", " ", "previous", " ", "stage", " ", 
      "of", " ", "using", " ", "SensCalc"}]}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"ExtractedProductionParameters", "=", 
     RowBox[{"Function", "[", 
      RowBox[{"filename", ",", 
       RowBox[{
        RowBox[{"parts", "=", 
         RowBox[{"StringSplit", "[", 
          RowBox[{
           RowBox[{"FileNameTake", "[", "filename", "]"}], ",", "\"\<_\>\""}],
           "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"parts", "[", 
           RowBox[{"[", "2", "]"}], "]"}], ",", 
          RowBox[{"parts", "[", 
           RowBox[{"[", "3", "]"}], "]"}], ",", 
          RowBox[{"StringDrop", "[", 
           RowBox[{
            RowBox[{"parts", "[", 
             RowBox[{"[", "4", "]"}], "]"}], ",", 
            RowBox[{"-", "2"}]}], "]"}]}], "}"}]}]}], " ", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"combinations", " ", "selected", " ", "LLP"}], ",", " ", 
     RowBox[{"production", " ", "channel"}], ",", " ", 
     RowBox[{
     "facility", " ", "for", " ", "which", " ", "the", " ", "tabulated", " ", 
      "distributions", " ", "are", " ", "present"}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"DistrCombinations", "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"ExtractedProductionParameters", "/@", "matchingFiles"}], 
       ")"}], "//", "Sort"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{"condrev", ",", "\[IndentingNewLine]", 
      RowBox[{"DistrCombinations", "=", 
       RowBox[{"Select", "[", 
        RowBox[{"DistrCombinations", ",", 
         RowBox[{
          RowBox[{"!", 
           RowBox[{"StringContainsQ", "[", 
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "2", "]"}], "]"}], ",", "\"\<Old-Mixing\>\""}], 
            "]"}]}], "&"}]}], "]"}]}], "\[IndentingNewLine]", ",", 
      "\[IndentingNewLine]", 
      RowBox[{"DistrCombinations", "=", 
       RowBox[{"Select", "[", 
        RowBox[{"DistrCombinations", ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"!", 
             RowBox[{"StringContainsQ", "[", 
              RowBox[{
               RowBox[{"#", "[", 
                RowBox[{"[", "2", "]"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{
                "\"\<Decay\>\"", ",", "\"\<Bremsstrahlung\>\"", ",", 
                 "\"\<Fragmentation\>\""}], "}"}]}], "]"}]}], "||", 
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "==", "\"\<Decay-B\>\""}]}], 
           ")"}], "&"}]}], "]"}]}]}], "\[IndentingNewLine]", "]"}], ";"}], 
   "\[IndentingNewLine]", "DistrCombinations"}]}]], "Input",
 CellChangeTimes->{{3.9137151636915593`*^9, 3.9137152465178137`*^9}, {
   3.9137153053586187`*^9, 3.913715399589816*^9}, {3.913718678447782*^9, 
   3.913718708673525*^9}, {3.913719203960288*^9, 3.9137192388759937`*^9}, {
   3.913804074855399*^9, 3.913804089247952*^9}, 3.9138043135262485`*^9, {
   3.913810357631002*^9, 3.913810363616334*^9}, {3.9138256248481245`*^9, 
   3.9138256471350822`*^9}, 3.9138665659237595`*^9, {3.9156430596090527`*^9, 
   3.9156430596110473`*^9}, {3.9341794838520145`*^9, 
   3.9341795032326403`*^9}, {3.934179535824199*^9, 3.934179741282941*^9}, {
   3.934179790853141*^9, 3.934179831711254*^9}, {3.934179997114852*^9, 
   3.9341802099881268`*^9}, {3.9341802674304266`*^9, 3.934180310904458*^9}, {
   3.9344738871254234`*^9, 3.93447392834628*^9}, {3.9344740167243133`*^9, 
   3.9344740168355308`*^9}, {3.9345555974250455`*^9, 3.9345556104131613`*^9}, 
   3.9347024091030283`*^9, {3.941858434521097*^9, 3.9418584369554195`*^9}, {
   3.941858651512392*^9, 3.941858665894823*^9}, {3.9418586972953453`*^9, 
   3.941858813762697*^9}, {3.941859109752636*^9, 3.941859109776163*^9}, 
   3.9505476783226643`*^9, 3.950588317134762*^9, 3.9506331833453407`*^9, {
   3.95063333105307*^9, 3.9506333574722633`*^9}, {3.9506364949483128`*^9, 
   3.950636499994385*^9}, {3.9506722291274014`*^9, 3.950672236988308*^9}, {
   3.950672563975647*^9, 3.95067262297884*^9}, {3.9506726591429653`*^9, 
   3.950672661975546*^9}},
 CellTags->{"Acceptance", "Number-of-events+sensitivity"},
 CellLabel->"In[45]:=",ExpressionUUID->"0edb2b52-1f88-8540-b5df-75246563ec07"]
}, Closed]]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Specifying the experiments and run next sections", "Title",
 CellChangeTimes->{{3.8876177939846563`*^9, 3.8876177965376587`*^9}, {
   3.914140539510558*^9, 3.914140544040797*^9}, 3.9506365840145016`*^9},
 CellTags->{
  "Acceptance", 
   "Number-of-events+sensitivity"},ExpressionUUID->"28586d1f-b279-f445-b5f5-\
a858d8c5e9de"],

Cell[CellGroupData[{

Cell["Specifying the experiments", "Chapter",
 CellChangeTimes->{{3.902729140157612*^9, 3.90272914444062*^9}, {
   3.9141405357221785`*^9, 3.9141405362140307`*^9}, 3.9506365861922264`*^9},
 CellTags->{
  "Acceptance", 
   "Number-of-events+sensitivity"},ExpressionUUID->"7b9ec72b-f300-6947-8118-\
60dfa7620480"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"SetDirectory", "[", 
    RowBox[{"NotebookDirectory", "[", "]"}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Parent", " ", "directory"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"NotebookDirectory", "[", "]"}], "//", "ParentDirectory"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ExperimentDirectoriesList", "=", 
    RowBox[{"Select", "[", 
     RowBox[{
      RowBox[{"FileNames", "[", 
       RowBox[{"\"\<*\>\"", ",", 
        RowBox[{"directory", "[", "\"\<Acceptances\>\"", "]"}], ",", "1"}], 
       "]"}], ",", "DirectoryQ"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"List", " ", "of", " ", "available", " ", "experiments", " ", 
    RowBox[{"(", 
     RowBox[{
     "for", " ", "which", " ", "the", " ", "geometry", " ", "has", " ", 
      "been", " ", "implemented"}], ")"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ExperimentsListTemp", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"FileNameTake", "[", 
      RowBox[{
       RowBox[{"ExperimentDirectoriesList", "[", 
        RowBox[{"[", "i", "]"}], "]"}], ",", 
       RowBox[{"-", "1"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "ExperimentDirectoriesList", "]"}], ",", "1"}], 
      "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ExperimentsListTemp2", "=", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"Partition", "[", 
      RowBox[{"ExperimentsListTemp", ",", "1"}], "]"}], ",", 
     RowBox[{"(*", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"TrueQ", "@", 
          RowBox[{"FileExistsQ", "@", 
           RowBox[{"FileNameJoin", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"directory", "[", "\"\<Acceptances\>\"", "]"}], ",", 
              RowBox[{"ExperimentsListTemp", "[", 
               RowBox[{"[", "i", "]"}], "]"}], ",", 
              RowBox[{"ToString", "@", 
               RowBox[{"StringForm", "[", 
                RowBox[{"\"\<Acceptance_``_for_``.m\>\"", ",", 
                 RowBox[{"ExperimentsListTemp", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], ",", "LLPdirName"}], 
                "]"}]}]}], "}"}], "]"}]}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "ExperimentsListTemp", "]"}]}], "}"}]}], 
       "]"}], "*)"}], 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Length", "[", 
          RowBox[{"FileNames", "[", 
           RowBox[{"FileNameJoin", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"directory", "[", "\"\<Acceptances\>\"", "]"}], ",", 
              RowBox[{"ExperimentsListTemp", "[", 
               RowBox[{"[", "i", "]"}], "]"}], ",", 
              RowBox[{"ToString", "@", 
               RowBox[{"StringForm", "[", 
                RowBox[{"\"\<Acceptance_``_for_``*.m\>\"", ",", 
                 RowBox[{"ExperimentsListTemp", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], ",", "LLPdirName"}], 
                "]"}]}]}], "}"}], "]"}], "]"}], "]"}], ">", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "ExperimentsListTemp", "]"}]}], "}"}]}], 
      "]"}], ",", "2"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", "\"\<List of available experiments:\>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ExperimentsListTemp2", "=", 
   RowBox[{"Select", "[", 
    RowBox[{"ExperimentsListTemp2", ",", 
     RowBox[{
      RowBox[{"FileExistsQ", "[", 
       RowBox[{"FileNameJoin", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"directory", "[", "\"\<Acceptances\>\"", "]"}], ",", 
          RowBox[{"#", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{
          "\"\<AvailableDescriptions-\>\"", "<>", "LLPdirName", "<>", 
           "\"\<.mx\>\""}]}], "}"}], "]"}], "]"}], "&"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"ExperimentsList", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"Select", "[", 
     RowBox[{"ExperimentsListTemp2", ",", 
      RowBox[{
       RowBox[{
        RowBox[{"#", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", "True"}], "&"}]}], "]"}],
     "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", "1"}], "]"}], "]"}], "//", 
   "Sort"}]}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Length", "[", "ExperimentsList", "]"}], "\[Equal]", "0"}], ",", 
   RowBox[{
   "Print", "[", 
    "\"\<No experiment is available, generate first the acceptance for the \
given experiment using module 1\>\"", "]"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", "\"\<Selected experiments:\>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"availablePhenoDescriptions", "[", "exp_", "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", "\t", 
    RowBox[{"descrFile", "=", 
     RowBox[{"Import", "[", 
      RowBox[{
       RowBox[{"FileNameJoin", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"directory", "[", "\"\<Acceptances\>\"", "]"}], ",", "exp", 
          ",", 
          RowBox[{
          "\"\<AvailableDescriptions-\>\"", "<>", "LLPdirName", "<>", 
           "\"\<.mx\>\""}]}], "}"}], "]"}], ",", "\"\<MX\>\""}], "]"}]}]}], 
   "\[IndentingNewLine]", "\t", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"SelectedExperimentListTemp2", "=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Length", "[", "ExperimentsList", "]"}], "\[NotEqual]", "0"}], 
    ",", 
    RowBox[{"selectionDialog", "[", 
     RowBox[{"ExperimentsList", ",", "\"\<Select the experiments:\>\""}], 
     "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"IfAllPheno", "=", "True"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SelectedExperimentList", "=", 
   RowBox[{"{", 
    RowBox[{"{", "}"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{"IfAllPheno", ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Do", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"descriptions", "=", 
          RowBox[{"availablePhenoDescriptions", "[", "exp", "]"}]}], "}"}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{"SelectedExperimentList", "=", 
         RowBox[{"Join", "[", 
          RowBox[{"SelectedExperimentList", ",", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"exp", ",", 
               RowBox[{
                RowBox[{"descriptions", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", 
               RowBox[{
                RowBox[{"descriptions", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", 
               RowBox[{"Length", "[", "descriptions", "]"}], ",", "1"}], 
              "}"}]}], "]"}]}], "]"}]}]}], "\[IndentingNewLine]", "]"}], 
      "\[IndentingNewLine]", ",", 
      RowBox[{"{", 
       RowBox[{"exp", ",", "SelectedExperimentListTemp2"}], "}"}]}], "]"}], 
    ";", "\[IndentingNewLine]", 
    RowBox[{"SelectedExperimentList", "=", 
     RowBox[{"Drop", "[", 
      RowBox[{"SelectedExperimentList", ",", "1"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SelectedExperimentList", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"{", "exp", "}"}], ",", 
         RowBox[{
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"availablePhenoDescriptions", "[", "exp", "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"#", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "==", "\"\<Default\>\""}], 
             "&"}]}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"exp", ",", "SelectedExperimentListTemp2"}], "}"}]}], "]"}]}],
     ";"}]}], "\[IndentingNewLine]", 
  "]"}], "\[IndentingNewLine]", "SelectedExperimentList", \
"\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"icounter", "=", "1"}], ";"}]}], "Input",
 CellChangeTimes->{{3.8851403254718485`*^9, 3.8851403429411273`*^9}, {
   3.8854395484478483`*^9, 3.885439559226637*^9}, {3.8854397351242537`*^9, 
   3.885439739219259*^9}, {3.8858794196350574`*^9, 3.885879423032172*^9}, 
   3.886141121558817*^9, {3.886821665769628*^9, 3.8868216684602585`*^9}, {
   3.887617086304534*^9, 3.8876170990910044`*^9}, 3.889080211074895*^9, {
   3.890287800311657*^9, 3.890287802587648*^9}, {3.892189472726385*^9, 
   3.8921895121150846`*^9}, 3.892705546310735*^9, 3.8932345108531446`*^9, 
   3.902763528561518*^9, {3.902889537778877*^9, 3.9028895446827335`*^9}, {
   3.9138868703932114`*^9, 3.913886928383787*^9}, 3.915643060000375*^9, 
   3.948257367823641*^9, {3.9483017018501377`*^9, 3.9483017557965126`*^9}, {
   3.94830415597225*^9, 3.94830415727532*^9}},
 CellTags->{"Acceptance", "Number-of-events+sensitivity"},
 CellLabel->"In[51]:=",ExpressionUUID->"be98efa4-001b-5e4f-b892-2d0db6c7402a"]
}, Closed]],

Cell[CellGroupData[{

Cell["Running block for next sections", "Chapter",
 CellChangeTimes->{{3.902729140157612*^9, 3.90272914444062*^9}},
 CellTags->{
  "Acceptance", 
   "Number-of-events+sensitivity"},ExpressionUUID->"b8a043b6-ade0-964b-9c3f-\
50520aae2d33"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"BlockEvaluation", "[", "tag_", "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"nb", "=", 
      RowBox[{"EvaluationNotebook", "[", "]"}]}], ";", "\n", 
     RowBox[{"NotebookFind", "[", 
      RowBox[{"nb", ",", "tag", ",", "All", ",", "CellTags"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"SelectionEvaluate", "[", "nb", "]"}]}]}], "\[IndentingNewLine]",
    "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"tagselected", "==", "\"\<Number-of-events+sensitivity\>\""}], ",",
    "\[IndentingNewLine]", 
   RowBox[{"Do", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{
      "BlockEvaluation", "[", 
       "\"\<Number-of-events-computation+sensitivity\>\"", "]"}], ";"}], 
     "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{"icounter", ",", "1", ",", 
       RowBox[{"Length", "[", "SelectedExperimentList", "]"}], ",", "1"}], 
      "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"tagselected", "==", "\"\<Acceptance\>\""}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
        "BlockEvaluation", "[", "\"\<Acceptance-computation\>\"", "]"}], 
        ";"}], "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"icounter", ",", "1", ",", 
         RowBox[{"Length", "[", "SelectedExperimentList", "]"}], ",", "1"}], 
        "}"}]}], "]"}]}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]", "]"}]}], "Input",
 CellChangeTimes->{{3.9027291581950865`*^9, 3.902729215695462*^9}, {
   3.902761777481885*^9, 3.902761802513644*^9}, 3.902889536609843*^9, 
   3.9038925480063467`*^9, 3.914667536575886*^9, {3.915183587630067*^9, 
   3.915183588551358*^9}},
 CellTags->{"Acceptance", "Number-of-events+sensitivity"},
 CellLabel->"In[68]:=",ExpressionUUID->"607ff8ab-dd7c-4a44-bd43-da5ec3ce4038"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Number of events", "Title",
 CellChangeTimes->{{3.885140281753849*^9, 3.8851402836781845`*^9}},
 CellTags->
  "Number-of-events-computation+sensitivity",ExpressionUUID->"3e9a02fd-97c3-\
44ee-9f5b-9ca3983b66da"],

Cell[CellGroupData[{

Cell["Iterating to the next experiment", "Chapter",
 CellChangeTimes->{{3.9165042001551485`*^9, 3.9165042041207294`*^9}, {
  3.9165090857383037`*^9, 3.916509094318386*^9}, {3.952573778252432*^9, 
  3.952573786211399*^9}},
 CellTags->{
  "Acceptance-computation", 
   "Number-of-events-computation+sensitivity"},ExpressionUUID->"76fe3cd1-27a0-\
4d11-852c-ea3c40d76fef"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"{", 
   RowBox[{
   "SelectedExperiment", ",", "SelectedDescr", ",", 
    "ExplanationSelectedDescr"}], "}"}], "=", 
  RowBox[{"SelectedExperimentList", "[", 
   RowBox[{"[", 
    RowBox[{"icounter", "++"}], "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"Row", "[", 
   RowBox[{"{", 
    RowBox[{"\"\<Experiment \>\"", ",", 
     RowBox[{"icounter", "-", "1"}], ",", "\"\</\>\"", ",", 
     RowBox[{"Length", "[", "SelectedExperimentList", "]"}]}], "}"}], "]"}], 
  "]"}]}], "Input",
 CellChangeTimes->{
  3.9506321860462894`*^9, {3.950632438216501*^9, 3.950632438950699*^9}},
 CellTags->{
  "Acceptance-computation", "Number-of-events-computation+sensitivity"},
 CellLabel->"In[70]:=",ExpressionUUID->"10bc767d-43ce-4bd8-89d0-83fd85f2bb40"]
}, Closed]],

Cell[CellGroupData[{

Cell["Cross-sections, acceptances", "Chapter",
 CellChangeTimes->{{3.8876175155563755`*^9, 3.8876175192967377`*^9}, {
  3.8946372037023845`*^9, 3.8946372090126057`*^9}},
 CellTags->{
  "Acceptance-computation", 
   "Number-of-events-computation+sensitivity"},ExpressionUUID->"4cb86986-b7a3-\
4409-91ed-f7461f351ed0"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"dataAcceptances", "=", 
    RowBox[{"Import", "[", 
     RowBox[{
      RowBox[{"FileNameJoin", "[", 
       RowBox[{"{", 
        RowBox[{"FileNameJoin", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"directory", "[", "\"\<Acceptances\>\"", "]"}], ",", 
           "SelectedExperiment", ",", 
           RowBox[{"ToString", "@", 
            RowBox[{"StringForm", "[", 
             RowBox[{
             "\"\<Acceptance_``_for_``_decayDescription_``.m\>\"", ",", 
              RowBox[{"Sequence", "@@", 
               RowBox[{"{", 
                RowBox[{
                "SelectedExperiment", ",", "LLPdirName", ",", 
                 "SelectedDescr"}], "}"}]}]}], "]"}]}]}], "}"}], "]"}], "}"}],
        "]"}], ",", "\"\<MX\>\""}], "]"}]}], ";"}], "//", 
  "AbsoluteTiming"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "FacilityGivenExperiment", ",", "FullAcceptanceData0", ",", "decayDescr", 
     ",", 
     RowBox[{"c\[Tau]LLP", "[", 
      RowBox[{"mLLP_", ",", "y_"}], "]"}]}], "}"}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"dataAcceptances", "[", 
        RowBox[{"[", "#", "]"}], "]"}], "//", "Developer`ToPackedArray"}], 
      ")"}], "&"}], "/@", 
    RowBox[{"{", 
     RowBox[{"1", ",", "3", ",", 
      RowBox[{"-", "2"}], ",", 
      RowBox[{"-", "1"}]}], "}"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ldecayLLP", "[", 
    RowBox[{"mLLP_", ",", "y_", ",", "ELLP_"}], "]"}], "=", 
   RowBox[{
    RowBox[{"c\[Tau]LLP", "[", 
     RowBox[{"mLLP", ",", "y"}], "]"}], "*", 
    FractionBox[
     SqrtBox[
      RowBox[{
       SuperscriptBox["ELLP", "2"], "-", 
       SuperscriptBox["mLLP", "2"]}]], "mLLP"]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BrVis", "[", "mLLP_", "]"}], "=", 
   RowBox[{"dataAcceptances", "[", 
    RowBox[{"[", "5", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  "\"\<Total branching ratio of visible decays (computed by notebook 1):\>\"",
   "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"yval", "=", 
   SuperscriptBox["10", 
    RowBox[{"-", "5"}]]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pt1", "=", 
   RowBox[{"LogLogPlot", "[", 
    RowBox[{
     RowBox[{"Evaluate", "[", 
      RowBox[{"c\[Tau]LLP", "[", 
       RowBox[{"mLLP", ",", "yval"}], "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"mLLP", ",", "0.05", ",", "4"}], "}"}], ",", 
     RowBox[{"Frame", "->", "True"}], ",", 
     RowBox[{"ImageSize", "->", "Large"}], ",", " ", 
     RowBox[{"FrameStyle", "\[Rule]", 
      RowBox[{"Directive", "[", 
       RowBox[{"Black", ",", " ", "22"}], "]"}]}], ",", 
     RowBox[{"PlotRange", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0.05", ",", "4"}], "}"}], ",", "All"}], "}"}]}], ",", 
     RowBox[{"PlotStyle", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"Thick", ",", "Blue"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Thick", ",", 
          RowBox[{"Darker", "@", "Red"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Thick", ",", 
          RowBox[{"Darker", "@", 
           RowBox[{"Darker", "@", "Green"}]}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Thick", ",", 
          RowBox[{"Darker", "@", "Cyan"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Thick", ",", "Magenta"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Thick", ",", "Brown"}], "}"}]}], "}"}]}], ",", 
     RowBox[{"AspectRatio", "\[Rule]", "0.66"}], ",", 
     RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
     RowBox[{"FrameLabel", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
       "\"\<\!\(\*SubscriptBox[\(m\), \(a\)]\) [GeV]\>\"", ",", 
        "\"\<\!\(\*SubscriptBox[\(c\[Tau]\), \(a\)]\) [m]\>\""}], "}"}]}], 
     ",", 
     RowBox[{"PlotLabel", "\[Rule]", 
      RowBox[{"Style", "[", 
       RowBox[{
        RowBox[{"Row", "[", 
         RowBox[{"{", 
          RowBox[{
          "\"\<Proper lifetime of ALP. y = \!\(\*SubscriptBox[\(v\), \
\(h\)]\)/\!\(\*SubscriptBox[\(f\), \(a\)]\) = \>\"", ",", 
           RowBox[{"N", "[", "yval", "]"}]}], "}"}], "]"}], ",", "18", ",", 
        "Black"}], "]"}]}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pt2", "=", 
   RowBox[{"LogLogPlot", "[", 
    RowBox[{
     RowBox[{"Evaluate", "[", 
      RowBox[{"BrVis", "[", "mLLP", "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"mLLP", ",", "0.02", ",", "10"}], "}"}], ",", 
     RowBox[{"Frame", "->", "True"}], ",", 
     RowBox[{"ImageSize", "->", "Large"}], ",", 
     RowBox[{"FrameStyle", "\[Rule]", 
      RowBox[{"Directive", "[", 
       RowBox[{"Black", ",", " ", "22"}], "]"}]}], ",", 
     RowBox[{"PlotStyle", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Thickness", "[", "0.003", "]"}], ",", "Blue"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Thickness", "[", "0.003", "]"}], ",", 
          RowBox[{"Darker", "@", "Red"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Thickness", "[", "0.003", "]"}], ",", 
          RowBox[{"Darker", "@", 
           RowBox[{"Darker", "@", "Green"}]}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Thickness", "[", "0.003", "]"}], ",", "Black"}], "}"}]}], 
       "}"}]}], ",", 
     RowBox[{"GridLines", "\[Rule]", "Automatic"}], ",", 
     RowBox[{"PlotRange", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0.1", ",", "10"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0.01", ",", "1.2"}], "}"}]}], "}"}]}], ",", 
     RowBox[{"Frame", "\[Rule]", "True"}], ",", 
     RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
     RowBox[{"FrameLabel", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
       "\"\<m [GeV]\>\"", ",", 
        "\"\<\!\(\*SubscriptBox[\(Br\), \(vis\)]\)\>\""}], "}"}]}], ",", 
     RowBox[{"PlotLabel", "\[Rule]", " ", 
      RowBox[{"Style", "[", 
       RowBox[{
        RowBox[{"Row", "[", 
         RowBox[{"{", 
          RowBox[{"\"\<For \>\"", ",", "SelectedExperiment"}], "}"}], "]"}], 
        ",", " ", "20", ",", " ", "Black"}], "]"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Style", "[", 
   RowBox[{
    RowBox[{"Row", "[", 
     RowBox[{"{", 
      RowBox[{"pt1", ",", "pt2"}], "}"}], "]"}], ",", 
    RowBox[{"ImageSizeMultipliers", "->", 
     RowBox[{"{", 
      RowBox[{"1", ",", " ", "1"}], "}"}]}]}], "]"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"___", "___", "___", "___", "___", "___", "___", "___", "___"}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Interpolation", " ", "of", " ", "the", " ", "tabulated", " ", 
     "azimuthal", " ", "acceptance"}], ",", " ", 
    RowBox[{"extracting", " ", 
     SubscriptBox["\[Theta]", 
      RowBox[{"min", "/", "max"}]]}], ",", " ", 
    RowBox[{"etc", "."}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"___", "___", "___", "___", "___", "___", "___", "___", "___"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"AzimuthalAcceptanceInt", "[", 
       RowBox[{"\[Theta]LLP_", ",", "zLLP_"}], "]"}], ",", 
      "\[Theta]minExpAll", ",", "\[Theta]maxExpAll", ",", "\[Theta]minExp", 
      ",", "\[Theta]maxExp", ",", "zminExp", ",", "zmaxExp", ",", 
      RowBox[{"zmin\[Theta]", "[", "\[Theta]LLP_", "]"}], ",", 
      RowBox[{"zmax\[Theta]", "[", "\[Theta]LLP_", "]"}]}], "}"}], "=", 
    RowBox[{"Block\[Epsilon]Azimuthal", "[", "FullAcceptanceData0", "]"}]}], 
   ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Logarithmized", " ", "data", " ", "with", " ", "full", " ", 
     "acceptance"}], ",", " ", 
    RowBox[{
    "and", " ", "also", " ", "decay", " ", "acceptance", " ", "and", " ", 
     "full", " ", "acceptance", " ", "interpolations"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"FullAcceptanceData", ",", 
     RowBox[{"DecayAcceptanceInt", "[", 
      RowBox[{"mLLP_", ",", "\[Theta]LLP_", ",", "ELLP_", ",", "zLLP_"}], 
      "]"}], ",", 
     RowBox[{"FullAcceptanceInt", "[", 
      RowBox[{"mLLP_", ",", "\[Theta]LLP_", ",", "ELLP_", ",", "zLLP_"}], 
      "]"}], ",", "InGridm\[Epsilon]", ",", "InGrid\[Theta]\[Epsilon]", ",", 
     "InGridE\[Epsilon]", ",", "InGridz\[Epsilon]", ",", "\[Epsilon]vals", 
     ",", "\[Epsilon]azvals", ",", "mmin\[Epsilon]", ",", "mmax\[Epsilon]"}], 
    "}"}], "=", 
   RowBox[{"Block\[Epsilon]Decay", "[", 
    RowBox[{"FullAcceptanceData0", ",", "zminExp", ",", "BrVis"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CrossSectionData", "=", 
   RowBox[{
    RowBox[{"dataAcceptances", "[", 
     RowBox[{"[", "4", "]"}], "]"}], "//", "Transpose"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NpotGivenExperiment", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Select", "[", 
       RowBox[{"CrossSectionData", ",", 
        RowBox[{
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", "\"\<Npot\>\""}], 
         "&"}]}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}], "[", 
     RowBox[{"[", "2", "]"}], "]"}], "//", "N"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AtargetVal", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Select", "[", 
      RowBox[{"CrossSectionData", ",", 
       RowBox[{
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", "\"\<Atarget\>\""}], 
        "&"}]}], "]"}], "[", 
     RowBox[{"[", "1", "]"}], "]"}], "[", 
    RowBox[{"[", "2", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Row", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"\"\<Search for \>\"", "<>", "LLPdirName", "<>", "\"\< at \>\""}],
     ",", " ", "SelectedExperiment", ",", " ", "\"\< located at \>\"", ",", 
    "FacilityGivenExperiment", ",", 
    "\"\<. \!\(\*SubscriptBox[\(N\), \(collisions\)]\) = \>\"", ",", 
    "NpotGivenExperiment", ",", "\"\<. Decay description: \>\"", ",", " ", 
    "decayDescr"}], "}"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "\"\<Quantity\>\"", ",", 
      "\"\<\!\(\*SubscriptBox[\(\[Theta]\), \(min\)]\), rad\>\"", ",", 
      "\"\<\!\(\*SubscriptBox[\(\[Theta]\), \(max\)]\), rad\>\"", ",", 
      "\"\<\!\(\*SubscriptBox[\(\[Theta]\), \(min\)]\)(\!\(\*SubscriptBox[\(\
\[Epsilon]\), \(dec\)]\)), rad\>\"", ",", 
      "\"\<\!\(\*SubscriptBox[\(\[Theta]\), \(max\)]\)(\!\(\*SubscriptBox[\(\
\[Epsilon]\), \(dec\)]\)), rad\>\"", ",", 
      "\"\<\!\(\*SubscriptBox[\(z\), \(min\)]\), m\>\"", ",", 
      "\"\<\!\(\*SubscriptBox[\(z\), \(max\)]\), m\>\""}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
     "\"\<Description\>\"", ",", "\"\<Min angle covered by experiment\>\"", 
      ",", "\"\<Max angle covered by experiment\>\"", ",", 
      "\"\<Min angle where \!\(\*SubscriptBox[\(\[Epsilon]\), \(decay\)]\)\
\[NotEqual]0\>\"", ",", 
      "\"\<Max angle where \!\(\*SubscriptBox[\(\[Epsilon]\), \(decay\)]\)\
\[NotEqual]0\>\"", ",", "\"\<Min long. displacement of the decay volume\>\"", 
      ",", "\"\<Max long. displacement of the decay volume\>\""}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
     "\"\<Value\>\"", ",", "\[Theta]minExpAll", ",", "\[Theta]maxExpAll", ",",
       "\[Theta]minExp", ",", "\[Theta]maxExp", ",", "zminExp", ",", 
      "zmaxExp"}], "}"}]}], "}"}], "//", "TableForm"}]}], "Input",
 CellChangeTimes->{{3.916251173539231*^9, 3.9162511737225804`*^9}, {
   3.9162854040736876`*^9, 3.9162854095536427`*^9}, 3.916287125468828*^9, {
   3.9162874482060547`*^9, 3.916287453674517*^9}, {3.9165035320027027`*^9, 
   3.9165035321642723`*^9}, {3.916503918435957*^9, 3.9165039519088273`*^9}, {
   3.916504132017181*^9, 3.9165041935770597`*^9}, 3.9165042339914446`*^9, {
   3.9165042651588464`*^9, 3.9165042740503426`*^9}, {3.9165044921155214`*^9, 
   3.9165045233309402`*^9}, {3.9165045589369617`*^9, 3.916504559159195*^9}, {
   3.916505109628378*^9, 3.916505133884837*^9}, {3.916505330421117*^9, 
   3.916505330781499*^9}, {3.9165055300027122`*^9, 3.9165055302172647`*^9}, {
   3.9165064939911013`*^9, 3.9165064942532*^9}, {3.9165065382463965`*^9, 
   3.9165065407795734`*^9}, {3.9505893044707813`*^9, 3.9505893812920856`*^9}, 
   3.9506067659966583`*^9, {3.9506322019711494`*^9, 3.950632240415283*^9}, {
   3.9506322709893303`*^9, 3.9506323395159454`*^9}, {3.950632371666584*^9, 
   3.9506325128110046`*^9}, {3.950632557982811*^9, 3.95063255874358*^9}, {
   3.9506326171190605`*^9, 3.950632617394228*^9}, {3.9506366022226334`*^9, 
   3.950636602417202*^9}, {3.950866460193136*^9, 3.950866512922394*^9}, {
   3.952573803924511*^9, 3.952573807585882*^9}},
 CellTags->{
  "Acceptance-computation", "Number-of-events-computation+sensitivity"},
 CellLabel->"In[72]:=",ExpressionUUID->"68cd4c52-a57e-49cb-9552-92e7a8059080"],

Cell[CellGroupData[{

Cell["\<\
Checking if all distributions have corresponding weights, and vice versa\
\>", "Section",
 CellChangeTimes->{{3.9506325765805607`*^9, 3.9506325768620872`*^9}, {
  3.9506334272032604`*^9, 3.950633428585764*^9}, {3.950633747287016*^9, 
  3.950633760072397*^9}},
 CellTags->{
  "Acceptance-computation", 
   "Number-of-events-computation+sensitivity"},ExpressionUUID->"972feb67-6add-\
ac40-99c7-991aaf347a8f"],

Cell[CellGroupData[{

Cell["\<\
List of angle-energy distributions and production weights for the given \
facility\
\>", "Subsection",
 CellChangeTimes->{{3.950633460120825*^9, 3.950633477192444*^9}},
 CellTags->{
  "Acceptance-computation", 
   "Number-of-events-computation+sensitivity"},ExpressionUUID->"4593d3d7-94ed-\
0247-aa53-76f7ec6f84b3"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"DistrCombinationsSelectedFacility", "=", 
   RowBox[{"Select", "[", 
    RowBox[{"DistrCombinations", ",", 
     RowBox[{
      RowBox[{
       RowBox[{"#", "[", 
        RowBox[{"[", "3", "]"}], "]"}], "==", "FacilityGivenExperiment"}], 
      "&"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"WeightsCombinationsSelectedFacility", "=", 
   RowBox[{"Select", "[", 
    RowBox[{"WeightsCombinations", ",", 
     RowBox[{
      RowBox[{
       RowBox[{"#", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "==", "FacilityGivenExperiment"}], 
      "&"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"MemberQ", "[", 
      RowBox[{
       RowBox[{"DistrCombinationsSelectedFacility", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "2"}], "]"}], "]"}], ",", 
       "\"\<Bremsstrahlung-FR\>\""}], "]"}], "||", 
     RowBox[{"MemberQ", "[", 
      RowBox[{
       RowBox[{"DistrCombinationsSelectedFacility", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "2"}], "]"}], "]"}], ",", 
       "\"\<Bremsstrahlung-AP\>\""}], "]"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"FacilitiesFR", "=", 
      RowBox[{
       RowBox[{"Select", "[", 
        RowBox[{"DistrCombinationsSelectedFacility", ",", 
         RowBox[{
          RowBox[{"StringContainsQ", "[", 
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "2", "]"}], "]"}], ",", 
            RowBox[{"{", "\"\<FR\>\"", "}"}]}], "]"}], "&"}]}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "3"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"FacilitiesAP", "=", 
      RowBox[{
       RowBox[{"Select", "[", 
        RowBox[{"DistrCombinationsSelectedFacility", ",", 
         RowBox[{
          RowBox[{"StringContainsQ", "[", 
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "2", "]"}], "]"}], ",", 
            RowBox[{"{", "\"\<AP\>\"", "}"}]}], "]"}], "&"}]}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "3"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"DistrCombinationsToCheck", "=", 
      RowBox[{"Select", "[", 
       RowBox[{"DistrCombinationsSelectedFacility", ",", 
        RowBox[{
         RowBox[{"!", 
          RowBox[{"StringContainsQ", "[", 
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "2", "]"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"\"\<FR\>\"", ",", "\"\<AP\>\""}], "}"}]}], "]"}]}], 
         "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"DistrCombinationsToCheck", "=", 
      RowBox[{
       RowBox[{"Join", "[", 
        RowBox[{"DistrCombinationsToCheck", ",", 
         RowBox[{"Flatten", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"LLPdirName", ",", "brem", ",", "fac"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"fac", ",", "FacilitiesFR"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"brem", ",", 
               RowBox[{
                RowBox[{"Select", "[", 
                 RowBox[{"WeightsCombinations", ",", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "==", "fac"}], "&&", 
                    RowBox[{"StringContainsQ", "[", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", "\"\<FR\>\""}], 
                    "]"}]}], "&"}]}], "]"}], "[", 
                RowBox[{"[", 
                 RowBox[{"All", ",", "1"}], "]"}], "]"}]}], "}"}]}], "]"}], 
           ",", "1"}], "]"}], ",", 
         RowBox[{"Flatten", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"LLPdirName", ",", "brem", ",", "fac"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"fac", ",", "FacilitiesAP"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"brem", ",", 
               RowBox[{
                RowBox[{"Select", "[", 
                 RowBox[{"WeightsCombinations", ",", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "==", "fac"}], "&&", 
                    RowBox[{"StringContainsQ", "[", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", "\"\<AP\>\""}], 
                    "]"}]}], "&"}]}], "]"}], "[", 
                RowBox[{"[", 
                 RowBox[{"All", ",", "1"}], "]"}], "]"}]}], "}"}]}], "]"}], 
           ",", "1"}], "]"}]}], "]"}], "//", "Sort"}]}], ";"}], 
    "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
    RowBox[{
    "DistrCombinationsToCheck", "=", "DistrCombinationsSelectedFacility"}]}], 
   "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"drellyankeys", "=", 
   RowBox[{"Select", "[", 
    RowBox[{"WeightsCombinationsSelectedFacility", ",", 
     RowBox[{
      RowBox[{"StringContainsQ", "[", 
       RowBox[{
        RowBox[{"#", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", "\"\<DrellYan\>\""}], "]"}], 
      "&"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DistrCombinationsToCheck", "=", 
   RowBox[{"Select", "[", 
    RowBox[{"DistrCombinationsToCheck", ",", 
     RowBox[{
      RowBox[{"!", 
       RowBox[{"StringContainsQ", "[", 
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "2", "]"}], "]"}], ",", "\"\<DrellYan\>\""}], "]"}]}], 
      "&"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DistrCombinationsToCheck", "=", 
   RowBox[{"Join", "[", 
    RowBox[{"DistrCombinationsToCheck", ",", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"LLPdirName", ",", 
         RowBox[{
          RowBox[{"drellyankeys", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", 
         RowBox[{
          RowBox[{"drellyankeys", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "drellyankeys", "]"}], ",", "1"}], "}"}]}], 
      "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", "DistrCombinationsToCheck", "\
\[IndentingNewLine]", "WeightsCombinationsSelectedFacility"}], "Input",
 CellChangeTimes->{{3.950632759830923*^9, 3.950632760199877*^9}, {
  3.950632840248455*^9, 3.950632878926874*^9}, {3.9506329342094135`*^9, 
  3.9506330750435047`*^9}, {3.9506332640043545`*^9, 3.9506332684904785`*^9}, {
  3.95063336592737*^9, 3.950633366140545*^9}, {3.950633423556576*^9, 
  3.950633424039562*^9}, {3.950633489564089*^9, 3.9506334899840126`*^9}, {
  3.952573816207407*^9, 3.952573821623165*^9}, {3.952588352668476*^9, 
  3.952588354145384*^9}},
 CellTags->{
  "Acceptance-computation", "Number-of-events-computation+sensitivity"},
 CellLabel->"In[88]:=",ExpressionUUID->"e7b49a65-12ae-2c4b-8122-ef9651479899"]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Checking if all weights have their corresponding distributions\
\>", "Subsection",
 CellChangeTimes->{{3.950633494221611*^9, 3.9506335163250427`*^9}},
 CellTags->{
  "Acceptance-computation", 
   "Number-of-events-computation+sensitivity"},ExpressionUUID->"2f9d0dea-ca8a-\
9444-b0ab-cc7df9b417d3"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"IfCondDistrToWeights", "=", 
   RowBox[{"IfCondWeightsToDistr", "=", "True"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"allAvailable", "=", "True"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"missingDistr", "=", 
   RowBox[{"{", 
    RowBox[{"{", "}"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"missingWeights", "=", 
   RowBox[{"{", 
    RowBox[{"{", "}"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"condcontinue", "=", "True"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"distrrow", "=", 
     RowBox[{"DistrCombinationsToCheck", "[", 
      RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"condWeights", "=", 
     RowBox[{
      RowBox[{"Select", "[", 
       RowBox[{"WeightsCombinationsSelectedFacility", ",", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "==", 
           RowBox[{"distrrow", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "&&", 
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "==", 
           RowBox[{"distrrow", "[", 
            RowBox[{"[", "3", "]"}], "]"}]}]}], "&"}]}], "]"}], "!=", 
      RowBox[{"{", "}"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"condWeights", "==", "False"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"missingWeights", "=", 
        RowBox[{"Join", "[", 
         RowBox[{"missingWeights", ",", 
          RowBox[{"{", "distrrow", "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"allAvailable", "=", "False"}], ";"}]}], "\[IndentingNewLine]",
      "]"}], ";"}], "\[IndentingNewLine]", ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "1", ",", 
     RowBox[{"Length", "[", "DistrCombinationsToCheck", "]"}], ",", "1"}], 
    "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"weightrow", "=", 
     RowBox[{"WeightsCombinationsSelectedFacility", "[", 
      RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"condDistr", "=", 
     RowBox[{
      RowBox[{"Select", "[", 
       RowBox[{"DistrCombinationsToCheck", ",", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "==", 
           RowBox[{"weightrow", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], "&&", 
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "3", "]"}], "]"}], "==", 
           RowBox[{"weightrow", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}]}], "&"}]}], "]"}], "!=", 
      RowBox[{"{", "}"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"condDistr", "==", "False"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"missingDistr", "=", 
        RowBox[{"Join", "[", 
         RowBox[{"missingDistr", ",", 
          RowBox[{"{", "weightrow", "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"allAvailable", "=", "False"}], ";"}]}], "\[IndentingNewLine]",
      "]"}], ";"}], "\[IndentingNewLine]", ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "1", ",", 
     RowBox[{"Length", "[", "WeightsCombinationsSelectedFacility", "]"}], ",",
      "1"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"!", "allAvailable"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"missingDistr", "=", 
     RowBox[{"Drop", "[", 
      RowBox[{"missingDistr", ",", "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"missingWeights", "=", " ", 
     RowBox[{"Drop", "[", 
      RowBox[{"missingWeights", ",", "1"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"choiceContinue", "=", 
     RowBox[{"DialogInput", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"choice", "=", "\"\<Stop computation\>\""}], "}"}], ",", 
       RowBox[{"Column", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Style", "[", 
           RowBox[{
            RowBox[{"Row", "[", 
             RowBox[{"{", 
              RowBox[{
              "\"\<You have not provided the production probabilities \
PmotherToLLP to all the generated tabulated distributions! Missing \
distributions: \>\"", ",", " ", "missingDistr", ",", 
               "\"\<. Missing weights: \>\"", ",", " ", "missingWeights"}], 
              "}"}], "]"}], ",", "Bold"}], "]"}], ",", 
          RowBox[{"Spacer", "[", "5", "]"}], ",", 
          RowBox[{"Style", "[", 
           RowBox[{
            RowBox[{"Row", "[", 
             RowBox[{
             "{", "\"\<Stop computation or continue (but keeping only the \
production modes with weights and distributions?\>\"", "}"}], "]"}], ",", 
            "Bold"}], "]"}], ",", 
          RowBox[{"PopupMenu", "[", 
           RowBox[{
            RowBox[{"Dynamic", "[", "choice", "]"}], ",", 
            RowBox[{"{", 
             RowBox[{
             "\"\<Stop computation\>\"", ",", "\"\<Continue anyway\>\""}], 
             "}"}]}], "]"}], ",", 
          RowBox[{"Spacer", "[", "5", "]"}], ",", 
          RowBox[{"Button", "[", 
           RowBox[{"\"\<Proceed\>\"", ",", 
            RowBox[{"DialogReturn", "[", "choice", "]"}], ",", 
            RowBox[{"ImageSize", "->", "Automatic"}]}], "]"}]}], "}"}], 
        "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"choiceContinue", "==", "\"\<Stop computation\>\""}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"condcontinue", "=", "False"}], "\[IndentingNewLine]", ",", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"DistrCombinationsSelectedFacility1", "=", 
         RowBox[{"Select", "[", 
          RowBox[{"DistrCombinationsSelectedFacility", ",", 
           RowBox[{
            RowBox[{"!", 
             RowBox[{"MemberQ", "[", 
              RowBox[{"missingWeights", ",", "#"}], "]"}]}], "&"}]}], "]"}]}],
         ";", "\[IndentingNewLine]", 
        RowBox[{"WeightsCombinationsSelectedFacility1", "=", 
         RowBox[{"Select", "[", 
          RowBox[{"WeightsCombinationsSelectedFacility", ",", 
           RowBox[{
            RowBox[{"!", 
             RowBox[{"MemberQ", "[", 
              RowBox[{"missingDistr", ",", "#"}], "]"}]}], "&"}]}], "]"}]}], 
        ";"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"patternsToRemoveWeights", "=", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"missingWeights", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "2"}], "]"}], "]"}], ",", 
          RowBox[{"missingDistr", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "1"}], "]"}], "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"patternsToRemoveDistr", "=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"StringReplace", "[", 
             RowBox[{"#", ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"\"\<-Lower\>\"", "->", "\"\<\>\""}], ",", 
                RowBox[{"\"\<-Central\>\"", "->", "\"\<\>\""}], ",", 
                RowBox[{"\"\<-Upper\>\"", "->", "\"\<\>\""}]}], "}"}]}], 
             "]"}], "&"}], "/@", 
           RowBox[{"Join", "[", 
            RowBox[{
             RowBox[{"missingWeights", "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", "2"}], "]"}], "]"}], ",", 
             RowBox[{"missingDistr", "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", "1"}], "]"}], "]"}]}], "]"}]}], ")"}], "//",
          "DeleteDuplicates"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"DistrCombinationsSelectedFacility", "=", 
        RowBox[{"Select", "[", 
         RowBox[{"DistrCombinationsSelectedFacility", ",", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"MemberQ", "[", 
             RowBox[{"patternsToRemoveDistr", ",", 
              RowBox[{"#", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "&"}]}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"WeightsCombinationsSelectedFacility", "=", 
        RowBox[{"Select", "[", 
         RowBox[{"WeightsCombinationsSelectedFacility", ",", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"MemberQ", "[", 
             RowBox[{"patternsToRemoveWeights", ",", 
              RowBox[{"#", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], "&"}]}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"DistrCombinationsToCheck", "=", 
        RowBox[{"Select", "[", 
         RowBox[{"DistrCombinationsToCheck", ",", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"MemberQ", "[", 
             RowBox[{"patternsToRemoveWeights", ",", 
              RowBox[{"#", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "&"}]}], "]"}]}], 
       ";"}]}], "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
  "]"}]}], "Input",
 CellChangeTimes->{{3.9506331104738274`*^9, 3.950633114577772*^9}, {
   3.95063351901915*^9, 3.9506335426713886`*^9}, {3.9506335729961224`*^9, 
   3.950633733919876*^9}, {3.950634498508953*^9, 3.9506346358571796`*^9}, {
   3.9506346685005493`*^9, 3.9506346804616184`*^9}, {3.9506347360546227`*^9, 
   3.9506347465200996`*^9}, {3.9506347956276207`*^9, 3.950634808025696*^9}, {
   3.950670799326351*^9, 3.9506708156981773`*^9}, {3.9506709225996647`*^9, 
   3.9506709491094894`*^9}, 3.950899032403015*^9, 3.9522500681038322`*^9, {
   3.9527010167105217`*^9, 3.9527010200290184`*^9}},
 CellTags->{
  "Acceptance-computation", "Number-of-events-computation+sensitivity"},
 CellLabel->"In[96]:=",ExpressionUUID->"77f25579-e284-b54e-88fc-e402bfafcc7c"]
}, Closed]]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Angle-energy distributions for the given experiment", "Chapter",
 CellChangeTimes->{{3.885020702966837*^9, 3.885020711525731*^9}, {
   3.8850216924759345`*^9, 3.8850216984444695`*^9}, {3.8851404110391607`*^9, 
   3.8851404117847*^9}, 3.8859669420079484`*^9, {3.8876173662884827`*^9, 
   3.8876173699611483`*^9}, {3.896334866051643*^9, 3.896334870004681*^9}},
 CellTags->{
  "Acceptance-computation", 
   "Number-of-events-computation+sensitivity"},ExpressionUUID->"9c0a6fa2-083d-\
438f-84cb-5fa122f734c4"],

Cell[CellGroupData[{

Cell["Specifying production channels", "Section",
 CellChangeTimes->{{3.934180644626505*^9, 3.934180647632351*^9}, 
   3.9506774820256844`*^9},
 CellTags->{
  "Number-of-events-computation+sensitivity", 
   "Acceptance-computation"},ExpressionUUID->"b0156caa-c6a2-ea49-9d19-\
2e75d36dd380"],

Cell[BoxData[
 RowBox[{"If", "[", 
  RowBox[{"condcontinue", ",", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "List", " ", "of", " ", "production", " ", "channels", " ", "for", " ", 
     "the", " ", "selected", " ", "facility"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
    "ProductionPatternSelectedDistr", "=", 
     "DistrCombinationsSelectedFacility"}], ";", "\[IndentingNewLine]", 
    RowBox[{"ProductionPatternSelected", "=", "DistrCombinationsToCheck"}], 
    ";", "\[IndentingNewLine]", 
    RowBox[{"ProductionListTemp", "=", 
     RowBox[{
      RowBox[{"ProductionPatternSelected", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "2"}], "]"}], "]"}], "//", "DeleteDuplicates"}]}],
     ";", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{
      "Selecting", " ", "only", " ", "those", " ", "proton", " ", 
       "bremsstrahlung", " ", "channels", " ", "for", " ", "which", " ", 
       "the", " ", "distribution", " ", "is", " ", "non"}], "-", 
      RowBox[{
      "zero", " ", "in", " ", "the", " ", "given", " ", "angular", " ", 
       "coverage"}]}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{"BremVariantsGivenFacility", "=", 
     RowBox[{
      RowBox[{"Select", "[", 
       RowBox[{
        RowBox[{"WeightsCombinationsSelectedFacility", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", "2"}], "}"}]}], "]"}], "]"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "==", "FacilityGivenExperiment"}],
           "&&", 
          RowBox[{"StringContainsQ", "[", 
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", "\"\<Bremsstrahlung\>\""}], 
           "]"}], "&&", 
          RowBox[{"!", 
           RowBox[{"StringContainsQ", "[", 
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", 
             "\"\<Bremsstrahlung-e\>\""}], "]"}]}]}], "&"}]}], "]"}], "[", 
      RowBox[{"[", 
       RowBox[{"All", ",", "1"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"Print", "[", "\"\<Production modes list:\>\"", "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
     "Deciding", " ", "if", " ", "the", " ", "bremsstrahlung", " ", 
      "contributes", " ", "to", " ", "the", " ", "production", " ", "by", " ",
       "comparing", " ", 
      SubscriptBox["\[Theta]", 
       RowBox[{"max", ",", "brem"}]], " ", "with", " ", 
      SubscriptBox["\[Theta]", 
       RowBox[{"min", ",", "experiment"}]]}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{"Do", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"ELLPmax", "[", 
         RowBox[{"mLLP_", ",", "\[Theta]LLP_", ",", "ch"}], "]"}], "=", 
        RowBox[{"ELLPmax", "[", 
         RowBox[{
         "mLLP", ",", "\[Theta]LLP", ",", "ch", ",", 
          "FacilityGivenExperiment"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ELLPmin", "[", "ch", "]"}], "=", 
        RowBox[{"ELLPmin", "[", 
         RowBox[{"ch", ",", "FacilityGivenExperiment"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\[Theta]maxBrem", "[", "ch", "]"}], "=", 
        RowBox[{"\[Theta]maxBrem", "[", 
         RowBox[{"ch", ",", "FacilityGivenExperiment"}], "]"}]}]}], 
      "\[IndentingNewLine]", ",", 
      RowBox[{"{", 
       RowBox[{"ch", ",", "BremVariantsGivenFacility"}], "}"}]}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"ProdListBrem", "=", 
     RowBox[{"Select", "[", 
      RowBox[{"ProductionListTemp", ",", 
       RowBox[{
        RowBox[{
         RowBox[{"StringContainsQ", "[", 
          RowBox[{"#", ",", "\"\<Bremsstrahlung\>\""}], "]"}], "&&", 
         RowBox[{"!", 
          RowBox[{"StringContainsQ", "[", 
           RowBox[{"#", ",", "\"\<Bremsstrahlung-e\>\""}], "]"}]}]}], "&"}]}],
       "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"ProdListBremSelected", "=", 
       RowBox[{"Select", "[", 
        RowBox[{"ProdListBrem", ",", 
         RowBox[{
          RowBox[{
           RowBox[{"\[Theta]maxBrem", "[", "#", "]"}], ">", 
           "\[Theta]minExp"}], "&"}]}], "]"}]}], ";"}], "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{"ProdListBremSelected", "=", "ProdListBrem"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"ProductionList", "=", 
     RowBox[{"Join", "[", 
      RowBox[{"ProdListBremSelected", ",", 
       RowBox[{"Select", "[", 
        RowBox[{"ProductionListTemp", ",", 
         RowBox[{
          RowBox[{
           RowBox[{"!", 
            RowBox[{"StringContainsQ", "[", 
             RowBox[{"#", ",", "\"\<Bremsstrahlung\>\""}], "]"}]}], "||", 
           RowBox[{"StringContainsQ", "[", 
            RowBox[{"#", ",", "\"\<Bremsstrahlung-e\>\""}], "]"}]}], "&"}]}], 
        "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"Print", "[", 
     RowBox[{"Row", "[", 
      RowBox[{"{", "ProductionList", "}"}], "]"}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
     "Production", " ", "list", " ", "with", " ", "only", " ", "baseline", 
      " ", "bremsstrahlung", " ", "description"}], "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{
    "Print", "[", 
     "\"\<`Baseline` production modes list - fixed bremsstrahlung and \
Drell-Yan channels:\>\"", "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"BremSelected", "=", "\"\<Bremsstrahlung-AP-Central\>\""}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"DrellYanSelected", "=", "\"\<DrellYan-Central\>\""}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"ProductionListBaseline", "=", 
     RowBox[{"Select", "[", 
      RowBox[{"ProductionList", ",", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"StringContainsQ", "[", 
             RowBox[{"#", ",", "\"\<Bremsstrahlung\>\""}], "]"}]}], "||", 
           RowBox[{"#", "==", "BremSelected"}], "||", 
           RowBox[{"#", "==", "\"\<Bremsstrahlung-e\>\""}]}], ")"}], "&&", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"StringContainsQ", "[", 
             RowBox[{"#", ",", "\"\<DrellYan\>\""}], "]"}]}], "||", 
           RowBox[{"#", "==", "DrellYanSelected"}]}], ")"}]}], "&"}]}], 
      "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"Print", "[", 
     RowBox[{"Row", "[", 
      RowBox[{"{", "ProductionListBaseline", "}"}], "]"}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"Do", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"!", 
          RowBox[{"MemberQ", "[", 
           RowBox[{"ProductionList", ",", 
            RowBox[{"_String", "?", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"StringContainsQ", "[", 
                RowBox[{"#", ",", "pattern"}], "]"}], "&"}], ")"}]}]}], 
           "]"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"ProductionPatternSelectedDistr", "=", 
          RowBox[{"Select", "[", 
           RowBox[{"ProductionPatternSelectedDistr", ",", 
            RowBox[{
             RowBox[{"!", 
              RowBox[{"StringContainsQ", "[", 
               RowBox[{
                RowBox[{"#", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], ",", "pattern"}], "]"}]}], 
             "&"}]}], "]"}]}]}], "\[IndentingNewLine]", "]"}], ";"}], 
      "\[IndentingNewLine]", ",", 
      RowBox[{"{", 
       RowBox[{"pattern", ",", 
        RowBox[{"{", 
         RowBox[{"\"\<AP\>\"", ",", "\"\<FR\>\"", ",", "\"\<Baseline\>\""}], 
         "}"}]}], "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"BremVariantsGivenFacility", "=", 
     RowBox[{"Select", "[", 
      RowBox[{"ProductionList", ",", 
       RowBox[{
        RowBox[{"StringContainsQ", "[", 
         RowBox[{"#", ",", "\"\<Bremsstrahlung\>\""}], "]"}], "&"}]}], 
      "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"DrellYanVariantsGivenFacility", "=", 
     RowBox[{"Select", "[", 
      RowBox[{"ProductionList", ",", 
       RowBox[{
        RowBox[{"StringContainsQ", "[", 
         RowBox[{"#", ",", "\"\<DrellYan\>\""}], "]"}], "&"}]}], "]"}]}], 
    ";"}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{
  3.9341809008331413`*^9, {3.9342136550621533`*^9, 3.9342136625750804`*^9}, {
   3.9342136936480284`*^9, 3.934213730906671*^9}, {3.9342142521798525`*^9, 
   3.934214329804173*^9}, {3.9342153687217464`*^9, 3.934215408825349*^9}, {
   3.934218470980182*^9, 3.9342184907355137`*^9}, {3.934220014951741*^9, 
   3.9342200324395914`*^9}, {3.9342204747469893`*^9, 
   3.9342204752158785`*^9}, {3.934473129912497*^9, 3.934473139112607*^9}, {
   3.934473221915594*^9, 3.934473241085556*^9}, 3.9344741088583755`*^9, {
   3.9345555682197657`*^9, 3.934555609805334*^9}, 3.934597816924536*^9, {
   3.934600923492016*^9, 3.9346009328711786`*^9}, 3.9351347762966237`*^9, {
   3.9418598393807964`*^9, 3.9418599286829033`*^9}, {3.941860026116398*^9, 
   3.941860027811905*^9}, {3.9418602836222324`*^9, 3.941860297728735*^9}, {
   3.9434112696740074`*^9, 3.943411318219393*^9}, {3.9482687821299095`*^9, 
   3.948268803159607*^9}, 3.9505476837440224`*^9, 3.950588317718899*^9, {
   3.950633881096468*^9, 3.950633923132471*^9}, {3.950634124191347*^9, 
   3.950634200597868*^9}, {3.950677505183962*^9, 3.950677505375614*^9}, {
   3.9506779201234035`*^9, 3.9506779204351177`*^9}},
 CellTags->{
  "Acceptance-computation", "Number-of-events-computation+sensitivity"},
 CellLabel->
  "In[104]:=",ExpressionUUID->"6ed3ff0f-7809-5c49-aa01-00d78491ccb3"]
}, Closed]],

Cell[CellGroupData[{

Cell["Yields of mother particles per collision", "Section",
 CellChangeTimes->{{3.9506338070306664`*^9, 3.950633810749895*^9}, {
  3.9506342485113754`*^9, 3.9506342536031246`*^9}},
 CellTags->{
  "Acceptance-computation", 
   "Number-of-events-computation+sensitivity"},ExpressionUUID->"16f565d9-121d-\
a340-bd40-1b7a859a34ef"],

Cell[BoxData[
 RowBox[{"If", "[", 
  RowBox[{"condcontinue", ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ProbMother", "[", "\"\<B\>\"", "]"}], "=", 
     RowBox[{
      RowBox[{
       RowBox[{"Select", "[", 
        RowBox[{"CrossSectionData", ",", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", "\"\<Pb\>\""}], 
          "&"}]}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}], "[", 
      RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ProbMother", "[", "\"\<Pi0\>\"", "]"}], "=", 
     RowBox[{
      RowBox[{
       RowBox[{"Select", "[", 
        RowBox[{"CrossSectionData", ",", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", "\"\<PPi0\>\""}], 
          "&"}]}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}], "[", 
      RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ProbMother", "[", "\"\<Eta\>\"", "]"}], "=", 
     RowBox[{
      RowBox[{
       RowBox[{"Select", "[", 
        RowBox[{"CrossSectionData", ",", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", "\"\<PEta\>\""}], 
          "&"}]}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}], "[", 
      RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ProbMother", "[", "\"\<RhoCh\>\"", "]"}], "=", 
     RowBox[{
      RowBox[{
       RowBox[{"Select", "[", 
        RowBox[{"CrossSectionData", ",", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", "\"\<PRho0\>\""}], 
          "&"}]}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}], "[", 
      RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ProbMother", "[", "\"\<KS\>\"", "]"}], "=", 
     RowBox[{
      RowBox[{
       RowBox[{"Select", "[", 
        RowBox[{"CrossSectionData", ",", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", "\"\<PKS\>\""}], 
          "&"}]}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}], "[", 
      RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ProbMother", "[", "\"\<Omega\>\"", "]"}], "=", 
     RowBox[{
      RowBox[{
       RowBox[{"Select", "[", 
        RowBox[{"CrossSectionData", ",", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", "\"\<POmega\>\""}], 
          "&"}]}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}], "[", 
      RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ProbMother", "[", "\"\<EtaPr\>\"", "]"}], "=", 
     RowBox[{
      RowBox[{
       RowBox[{"Select", "[", 
        RowBox[{"CrossSectionData", ",", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", "\"\<PEtaPr\>\""}], 
          "&"}]}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}], "[", 
      RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"AtargetVal", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"Select", "[", 
        RowBox[{"CrossSectionData", ",", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", "\"\<Atarget\>\""}], 
          "&"}]}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}], "[", 
      RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"Do", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"ProbMother", "[", "channel", "]"}], "=", "1"}], ";"}], 
      "\[IndentingNewLine]", ",", 
      RowBox[{"{", 
       RowBox[{"channel", ",", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"drellyankeys", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", 
          "BremVariantsGivenFacility", ",", 
          RowBox[{"{", "\"\<Fragmentation\>\"", "}"}]}], "]"}]}], "}"}]}], 
     "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"!", "condrev"}], ",", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"ProbMother", "[", 
           RowBox[{"\"\<Old-Mixing-\>\"", "<>", "P0"}], "]"}], "=", 
          RowBox[{
           RowBox[{
            RowBox[{"Select", "[", 
             RowBox[{"CrossSectionData", ",", 
              RowBox[{
               RowBox[{
                RowBox[{"#", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", 
                RowBox[{"(", 
                 RowBox[{"\"\<P\>\"", "<>", "P0"}], ")"}]}], "&"}]}], "]"}], 
            "[", 
            RowBox[{"[", "1", "]"}], "]"}], "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
        ",", 
        RowBox[{"{", 
         RowBox[{"P0", ",", 
          RowBox[{"{", 
           RowBox[{"\"\<Pi0\>\"", ",", "\"\<Eta\>\"", ",", "\"\<EtaPr\>\""}], 
           "}"}]}], "}"}]}], "]"}]}], "\[IndentingNewLine]", "]"}]}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.9506326009176826`*^9, 3.9506326112369804`*^9}, {
   3.950633816216236*^9, 3.950633816557596*^9}, {3.950634052956276*^9, 
   3.9506341052062225`*^9}, {3.9506342152555656`*^9, 3.9506342217473106`*^9}, 
   3.950634819595833*^9, {3.952574672007059*^9, 3.9525746758036957`*^9}, {
   3.9525747085375957`*^9, 3.9525747131034565`*^9}, {3.9525882512187138`*^9, 
   3.9525882542939816`*^9}},
 CellTags->{
  "Acceptance-computation", "Number-of-events-computation+sensitivity"},
 CellLabel->
  "In[105]:=",ExpressionUUID->"410333c8-39b9-db4f-96d8-0fac6e682479"]
}, Closed]],

Cell[CellGroupData[{

Cell["Importing distributions", "Section",
 CellChangeTimes->{{3.950634261919199*^9, 3.9506342643264446`*^9}},
 CellTags->{
  "Acceptance-computation", 
   "Number-of-events-computation+sensitivity"},ExpressionUUID->"8b0c9880-aa3a-\
7b49-a98b-d0fcac093aed"],

Cell[BoxData[
 RowBox[{"If", "[", 
  RowBox[{"condcontinue", ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Do", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"prod", ",", "prodbrem"}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"prod", "=", 
          RowBox[{
           RowBox[{"ProductionPatternSelectedDistr", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"dirimp", "=", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"StringContainsQ", "[", 
              RowBox[{"prod", ",", 
               RowBox[{"{", 
                RowBox[{"\"\<DrellYan\>\"", ",", "\"\<Fragmentation\>\""}], 
                "}"}]}], "]"}], "&&", 
             RowBox[{"!", 
              RowBox[{"StringContainsQ", "[", 
               RowBox[{"prod", ",", "\"\<Old-Mixing\>\""}], "]"}]}]}], ",", 
            RowBox[{"FileNameJoin", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"directory", "[", "\"\<Distribution\>\"", "]"}], ",", 
               "\"\<Pregenerated\>\""}], "}"}], "]"}], ",", 
            RowBox[{"directory", "[", "\"\<Distribution\>\"", "]"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
          "Importing", " ", "the", " ", "data", " ", "with", " ", 
           "distribution"}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"StringContainsQ", "[", 
             RowBox[{"prod", ",", 
              RowBox[{"{", 
               RowBox[{"\"\<AP\>\"", ",", "\"\<FR\>\""}], "}"}]}], "]"}]}], 
           ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"DistrDataImport", "[", "prod", "]"}], "=", 
             RowBox[{"Abs", "[", 
              RowBox[{"Import", "[", 
               RowBox[{
                RowBox[{"FileNameJoin", "[", 
                 RowBox[{"{", 
                  RowBox[{"dirimp", ",", 
                   RowBox[{
                   "\"\<DoubleDistr_\>\"", "<>", "LLPdirName", "<>", 
                    "\"\<_\>\"", "<>", "prod", "<>", "\"\<_\>\"", "<>", 
                    "FacilityGivenExperiment", "<>", "\"\<.m\>\""}]}], "}"}], 
                 "]"}], ",", "\"\<MX\>\""}], "]"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"prod", "==", "\"\<DrellYan\>\""}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"Do", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"DistrDataImport", "[", 
                   RowBox[{"prod", "<>", "\"\<-\>\"", "<>", "vals"}], "]"}], 
                  "=", 
                  RowBox[{"Select", "[", 
                   RowBox[{
                    RowBox[{"DistrDataImport", "[", "prod", "]"}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    "MinMaxMassesDrellYan", "[", "FacilityGivenExperiment", 
                    "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "<=", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "<=", 
                    RowBox[{
                    RowBox[{
                    "MinMaxMassesDrellYan", "[", "FacilityGivenExperiment", 
                    "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "&"}]}], "]"}]}], ";"}],
                 "\[IndentingNewLine]", ",", 
                RowBox[{"{", 
                 RowBox[{"vals", ",", 
                  RowBox[{"{", 
                   RowBox[{
                   "\"\<Lower\>\"", ",", "\"\<Central\>\"", ",", 
                    "\"\<Upper\>\""}], "}"}]}], "}"}]}], "]"}]}], 
             "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", ",", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{
             "If", " ", "the", " ", "selected", " ", "channel", " ", "is", 
              " ", "Bremsstrahlung", " ", "under", " ", "the", " ", 
              "description", " ", "of", " ", "AP", " ", "or", " ", "FR"}], 
             ",", " ", 
             RowBox[{
             "then", " ", "there", " ", "are", " ", "variants", " ", "for", 
              " ", "the", " ", "description", " ", "parametrizing", " ", 
              "the", " ", "theoretical", " ", "uncertainty"}]}], "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"DistrDataImportTemp", "[", "prod", "]"}], "=", 
             RowBox[{"Import", "[", 
              RowBox[{
               RowBox[{"FileNameJoin", "[", 
                RowBox[{"{", 
                 RowBox[{"dirimp", ",", 
                  RowBox[{
                  "\"\<DoubleDistr_\>\"", "<>", "LLPdirName", "<>", 
                   "\"\<_\>\"", "<>", "prod", "<>", "\"\<_\>\"", "<>", 
                   "FacilityGivenExperiment", "<>", "\"\<.m\>\""}]}], "}"}], 
                "]"}], ",", "\"\<MX\>\""}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"Do", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"prodbrem", "=", 
                RowBox[{"prod", "<>", "\"\<-\>\"", "<>", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"DistrDataImportTemp", "[", "prod", "]"}], "[", 
                   RowBox[{"[", "j", "]"}], "]"}], "[", 
                  RowBox[{"[", "1", "]"}], "]"}]}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"DistrDataImport", "[", "prodbrem", "]"}], "=", 
                RowBox[{
                 RowBox[{
                  RowBox[{"DistrDataImportTemp", "[", "prod", "]"}], "[", 
                  RowBox[{"[", "j", "]"}], "]"}], "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"mlistDistr", "[", "prodbrem", "]"}], "=", 
                RowBox[{"DeleteDuplicates", "[", 
                 RowBox[{
                  RowBox[{"DistrDataImport", "[", "prodbrem", "]"}], "[", 
                  RowBox[{"[", 
                   RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"mLLPmin", "[", "prodbrem", "]"}], ",", 
                  RowBox[{"mLLPmax", "[", "prodbrem", "]"}]}], "}"}], "=", 
                RowBox[{"MinMax", "[", 
                 RowBox[{"mlistDistr", "[", "prodbrem", "]"}], "]"}]}], ";"}],
               "\[IndentingNewLine]", ",", 
              RowBox[{"{", 
               RowBox[{"j", ",", "1", ",", 
                RowBox[{"Length", "[", 
                 RowBox[{"DistrDataImportTemp", "[", "prod", "]"}], "]"}], 
                ",", "1"}], "}"}]}], "]"}], ";"}]}], "\[IndentingNewLine]", 
          "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]",
       ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", 
        RowBox[{"Length", "[", "ProductionPatternSelectedDistr", "]"}], ",", 
        "1"}], "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"Do", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"mlistDistr", "[", "prod", "]"}], "=", 
          RowBox[{"DeleteDuplicates", "[", 
           RowBox[{
            RowBox[{"DistrDataImport", "[", "prod", "]"}], "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"mLLPmin", "[", "prod", "]"}], ",", 
            RowBox[{"mLLPmax", "[", "prod", "]"}]}], "}"}], "=", 
          RowBox[{"MinMax", "[", 
           RowBox[{"mlistDistr", "[", "prod", "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"DoubleDistrLLPint", "[", 
           RowBox[{"mLLP_", ",", "\[Theta]LLP_", ",", "ELLP_", ",", "prod"}], 
           "]"}], "=", 
          RowBox[{"10", "^", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Interpolation", "[", 
              RowBox[{
               RowBox[{"distrlogComp", "[", 
                RowBox[{"DistrDataImport", "[", "prod", "]"}], "]"}], ",", 
               RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[", 
             RowBox[{
              RowBox[{"Log10", "[", "mLLP", "]"}], ",", 
              RowBox[{"Log10", "[", "\[Theta]LLP", "]"}], ",", 
              RowBox[{"Log10", "[", "ELLP", "]"}]}], "]"}], ")"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"StringContainsQ", "[", 
             RowBox[{"prod", ",", "\"\<Bremsstrahlung\>\""}], "]"}], "&&", 
            RowBox[{"prod", "!=", "\"\<Bremsstrahlung-e\>\""}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"DoubleDistrLLPint", "[", 
             RowBox[{
             "mLLP_", ",", "\[Theta]LLP_", ",", "ELLP_", ",", "prod"}], "]"}],
             "=", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"ELLP", "<=", 
               RowBox[{"ELLPmax", "[", 
                RowBox[{"mLLP", ",", "\[Theta]LLP", ",", "prod"}], "]"}]}], 
              ",", 
              RowBox[{"Evaluate", "[", 
               RowBox[{"DoubleDistrLLPint", "[", 
                RowBox[{
                "mLLP", ",", "\[Theta]LLP", ",", "ELLP", ",", "prod"}], "]"}],
                "]"}], ",", "0."}], "]"}]}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{"Probability", " ", "to", " ", "produce", " ", "LLP"}], 
          "*)"}], "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"ProbLLP", "[", 
           RowBox[{"mLLP_", ",", "y_", ",", "prod"}], "]"}], "=", 
          RowBox[{
           RowBox[{
            RowBox[{"ProbMother", "[", "prod", "]"}], "*", 
            RowBox[{"PmotherToLLP", "[", 
             RowBox[{
             "mLLP", ",", "y", ",", "prod", ",", "FacilityGivenExperiment"}], 
             "]"}]}], "/.", 
           RowBox[{"{", 
            RowBox[{"Atarget", "->", "AtargetVal"}], "}"}]}]}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", ",", 
      RowBox[{"{", 
       RowBox[{"prod", ",", "ProductionList"}], "}"}]}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"GridInFinal", "[", "prod", "]"}], ",", 
         RowBox[{"DistrVals", "[", "prod", "]"}]}], "}"}], "=", 
       RowBox[{"BlockGridsValsDistr", "[", 
        RowBox[{"prod", ",", "DistrDataImport"}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"prod", ",", "ProductionList"}], "}"}]}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
     "___", "___", "___", "___", "___", "___", "___", "___", "___", "_"}], 
     "*)"}], "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"Finding", " ", 
      SubscriptBox["E", "max"], 
      RowBox[{"(", 
       RowBox[{
        SubscriptBox["m", "LLP"], ",", 
        SubscriptBox["\[Theta]", "LLP"]}], ")"}], " ", "for", " ", "the", " ",
       "angular", " ", "range", " ", "at", " ", "the", " ", "given", " ", 
      "experiment"}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
     "___", "___", "___", "___", "___", "___", "___", "___", "___", "_"}], 
     "*)"}], "\[IndentingNewLine]", 
    RowBox[{"Do", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"ELLPmax", "[", 
        RowBox[{"mfip_", ",", "\[Theta]fip_", ",", "prod"}], "]"}], "=", 
       RowBox[{"EmaxBlock", "[", 
        RowBox[{
        "prod", ",", "8", ",", "DistrDataImport", ",", 
         "FacilityGivenExperiment"}], "]"}]}], "\[IndentingNewLine]", ",", 
      RowBox[{"{", 
       RowBox[{"prod", ",", 
        RowBox[{"Select", "[", 
         RowBox[{"ProductionList", ",", 
          RowBox[{
           RowBox[{
            RowBox[{"!", 
             RowBox[{"StringContainsQ", "[", 
              RowBox[{"#", ",", "\"\<Bremsstrahlung\>\""}], "]"}]}], "||", 
            RowBox[{"#", "==", "\"\<Bremsstrahlung-e\>\""}]}], "&"}]}], 
         "]"}]}], "}"}]}], "]"}], ";"}]}], "\[IndentingNewLine]", 
  "]"}]], "Input",
 CellChangeTimes->{{3.950634270661497*^9, 3.9506343563357487`*^9}, {
  3.95086647389711*^9, 3.9508664739041767`*^9}},
 CellTags->{
  "Acceptance-computation", "Number-of-events-computation+sensitivity"},
 CellLabel->
  "In[106]:=",ExpressionUUID->"f906f3b6-9a26-684c-b4c8-75065a0ccfe5"],

Cell[CellGroupData[{

Cell["Exporting averaged distribution", "Subsection",
 CellChangeTimes->{{3.934180740253267*^9, 3.934180747742608*^9}, {
  3.9342184269992228`*^9, 3.934218430923875*^9}},
 CellTags->{
  "Acceptance-computation", 
   "Number-of-events-computation+sensitivity"},ExpressionUUID->"12c4a047-206a-\
cd41-bac8-3da9c9e8279c"],

Cell[BoxData[
 RowBox[{"If", "[", 
  RowBox[{"condcontinue", ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"directory", "[", "\"\<Auxiliary-experiment\>\"", "]"}], "=", 
     RowBox[{"FileNameJoin", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"directory", "[", "\"\<Auxiliary\>\"", "]"}], ",", 
        "SelectedExperiment"}], "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"!", 
       RowBox[{"DirectoryQ", "[", 
        RowBox[{"directory", "[", "\"\<Auxiliary-experiment\>\"", "]"}], 
        "]"}]}], ",", 
      RowBox[{"CreateDirectory", "[", 
       RowBox[{"directory", "[", "\"\<Auxiliary-experiment\>\"", "]"}], 
       "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{"FileNameJoin", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"directory", "[", "\"\<Auxiliary-experiment\>\"", "]"}], ",", 
         RowBox[{
         "\"\<Double-Distr-Averaged-\>\"", "<>", "LLPdirName", "<>", 
          "\"\<.m\>\""}]}], "}"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"mLLPmin", "[", "prod", "]"}], "<", "mLLP", "<", 
             RowBox[{"mLLPmax", "[", "prod", "]"}]}], ",", 
            RowBox[{"Evaluate", "[", 
             RowBox[{"ProbLLP", "[", 
              RowBox[{"mLLP", ",", "1.", ",", "prod"}], "]"}], "]"}], ",", 
            "0"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"prod", ",", "ProductionList"}], "}"}]}], "]"}], ",", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "/", 
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"mLLPmin", "[", "prod", "]"}], "<", "mLLP", "<", 
                RowBox[{"mLLPmax", "[", "prod", "]"}]}], ",", 
               RowBox[{"Evaluate", "[", 
                RowBox[{"ProbLLP", "[", 
                 RowBox[{"mLLP", ",", "1.", ",", "prod"}], "]"}], "]"}], ",", 
               "0"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"prod", ",", "ProductionList"}], "}"}]}], "]"}]}], 
          ")"}], 
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"mLLPmin", "[", "prod", "]"}], "<", "mLLP", "<", 
              RowBox[{"mLLPmax", "[", "prod", "]"}]}], ",", 
             RowBox[{"Evaluate", "[", 
              RowBox[{
               RowBox[{"ProbLLP", "[", 
                RowBox[{"mLLP", ",", "1.", ",", "prod"}], "]"}], "*", 
               RowBox[{"DoubleDistrLLPint", "[", 
                RowBox[{
                "mLLP", ",", "\[Theta]LLP", ",", "ELLP", ",", "prod"}], 
                "]"}]}], "]"}], ",", "0"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"prod", ",", "ProductionListBaseline"}], "}"}]}], 
          "]"}]}]}], "}"}], ",", "\"\<MX\>\""}], "]"}], ";"}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.9138264426995506`*^9, 3.9138265779867573`*^9}, {
   3.913826965658716*^9, 3.9138270942523136`*^9}, 3.913827173058236*^9, 
   3.9138280725351963`*^9, {3.9138685969328623`*^9, 3.9138686662515535`*^9}, {
   3.9138687097216063`*^9, 3.913868827467691*^9}, {3.9138699081836786`*^9, 
   3.913869908527342*^9}, {3.9138700197640233`*^9, 3.913870024259905*^9}, {
   3.913870742059718*^9, 3.913870786176013*^9}, {3.913871804452815*^9, 
   3.9138718044574027`*^9}, {3.9138882251043167`*^9, 
   3.9138882251093035`*^9}, {3.9140573961516905`*^9, 3.914057451010392*^9}, {
   3.9140667249964046`*^9, 3.9140667374592443`*^9}, {3.9140668849922748`*^9, 
   3.9140668860566907`*^9}, 3.915184627030238*^9, {3.9156430601988077`*^9, 
   3.9156430604241543`*^9}, 3.915727587776414*^9, {3.916672566533353*^9, 
   3.9166725686001234`*^9}, {3.9166726094945087`*^9, 
   3.9166726096747155`*^9}, {3.916679849894617*^9, 3.9166798503945646`*^9}, {
   3.9168533614169364`*^9, 3.916853382014995*^9}, {3.916853454789669*^9, 
   3.9168535530919013`*^9}, {3.91685422632805*^9, 3.9168542271898108`*^9}, 
   3.916856429758537*^9, 3.9168567750740905`*^9, {3.916994194511986*^9, 
   3.916994194639786*^9}, 3.928576878808322*^9, {3.9285769295898595`*^9, 
   3.928577135245227*^9}, {3.9304940756391134`*^9, 3.9304942536874704`*^9}, {
   3.930494292641827*^9, 3.9304943056256866`*^9}, {3.9304954383171363`*^9, 
   3.930495439377903*^9}, {3.9304954744111834`*^9, 3.9304955596511307`*^9}, {
   3.930495594730049*^9, 3.93049563725099*^9}, {3.9304956810266666`*^9, 
   3.930495682018281*^9}, {3.934177965824263*^9, 3.934178024335834*^9}, {
   3.9341780660321517`*^9, 3.934178109488278*^9}, {3.9341781687198305`*^9, 
   3.9341782811178565`*^9}, {3.934180632550871*^9, 3.934180632806182*^9}, {
   3.9341806890054445`*^9, 3.9341806931598024`*^9}, {3.934218259952458*^9, 
   3.93421826091879*^9}, {3.934218296442099*^9, 3.9342183541896987`*^9}, {
   3.93421840615699*^9, 3.9342184371250544`*^9}, 3.9345978169333267`*^9, {
   3.9499078715117855`*^9, 3.9499078764500713`*^9}, {3.9506052255243587`*^9, 
   3.9506052263374043`*^9}, {3.9506343870706463`*^9, 3.950634390274084*^9}},
 CellTags->{
  "Acceptance-computation", "Number-of-events-computation+sensitivity"},
 CellLabel->
  "In[107]:=",ExpressionUUID->"20a78213-5a61-f44c-893d-981a6d71d204"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Plots", "Section",
 CellChangeTimes->{{3.9341806241273217`*^9, 3.9341806246845126`*^9}},
 CellTags->{
  "Number-of-events-computation+sensitivity", 
   "Acceptance-computation"},ExpressionUUID->"6a6edac6-9974-6743-9e9b-\
7607c6f5952f"],

Cell[BoxData[
 RowBox[{"If", "[", 
  RowBox[{"condcontinue", ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"emptyplot", "=", 
     RowBox[{"LogLogPlot", "[", 
      RowBox[{
       SuperscriptBox["10", 
        RowBox[{"-", "99"}]], ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", "10", ",", "10000"}], "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"ptenergies", "=", 
     RowBox[{"LogLogPlot", "[", 
      RowBox[{
       RowBox[{"Evaluate", "[", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"ELLPmax", "[", 
           RowBox[{"0.1", ",", "\[Theta]LLP", ",", "prod"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"prod", ",", "ProductionListBaseline"}], "}"}]}], "]"}], 
        "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Theta]LLP", ",", "\[Theta]minExp", ",", "\[Theta]maxExp"}],
         "}"}], ",", 
       RowBox[{"Frame", "->", "True"}], ",", 
       RowBox[{"ImageSize", "->", "Large"}], ",", 
       RowBox[{"PlotLegends", "\[Rule]", 
        RowBox[{"Placed", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Style", "[", 
             RowBox[{"#", ",", "15"}], "]"}], "&"}], "/@", 
           "ProductionListBaseline"}], ",", "Right"}], "]"}]}]}], "]"}]}], 
    ";", "\[IndentingNewLine]", 
    RowBox[{"colors", "=", 
     RowBox[{"{", 
      RowBox[{"Blue", ",", 
       RowBox[{"Lighter", "@", "Red"}], ",", 
       RowBox[{"Lighter", "@", "Cyan"}], ",", 
       RowBox[{"Darker", "@", "Red"}], ",", 
       RowBox[{"Darker", "@", 
        RowBox[{"Darker", "@", "Green"}]}], ",", 
       RowBox[{"Darker", "@", "Cyan"}], ",", "Magenta", ",", "Brown", ",", 
       "Orange", ",", "Black"}], "}"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"ptprodprob", "=", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"prl", "=", 
         RowBox[{"(", 
          RowBox[{"ProductionListBaseline", "/.", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"BremSelected", "->", "\"\<Bremsstrahlung\>\""}], ",", 
             RowBox[{"\"\<DrellYan-Central\>\"", "->", "\"\<DrellYan\>\""}]}],
             "}"}]}], ")"}]}], "}"}], ",", 
       RowBox[{"LogLogPlot", "[", 
        RowBox[{
         RowBox[{"Evaluate", "[", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"ProbLLP", "[", 
             RowBox[{"ma", ",", "1.", ",", "prod"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"prod", ",", "ProductionListBaseline"}], "}"}]}], "]"}], 
          "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"ma", ",", "mmin\[Epsilon]", ",", "mmax\[Epsilon]"}], "}"}],
          ",", 
         RowBox[{"Frame", "->", "True"}], ",", 
         RowBox[{"ImageSize", "->", "Large"}], ",", 
         RowBox[{"PlotLegends", "\[Rule]", 
          RowBox[{"Placed", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"Style", "[", 
               RowBox[{"#", ",", "13"}], "]"}], "&"}], "/@", 
             RowBox[{"(", "prl", ")"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"0.2", ",", "0.24"}], "}"}]}], "]"}]}], ",", " ", 
         RowBox[{"FrameStyle", "\[Rule]", 
          RowBox[{"Directive", "[", 
           RowBox[{"Black", ",", " ", "25", ",", "Thick"}], "]"}]}], ",", 
         RowBox[{"PlotRange", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0.02", ",", "5"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              SuperscriptBox["10", 
               RowBox[{"-", "12"}]], ",", 
              SuperscriptBox["10", "5"]}], "}"}]}], "}"}]}], ",", 
         RowBox[{"PlotStyle", "\[Rule]", 
          RowBox[{"Evaluate", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{"Thick", ",", "#"}], "}"}], "&"}], "/@", "colors"}], 
           "]"}]}], ",", 
         RowBox[{"AspectRatio", "\[Rule]", "0.66"}], ",", 
         RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
         RowBox[{"FrameLabel", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
           "\"\<\!\(\*SubscriptBox[\(m\), \(LLP\)]\) [GeV]\>\"", ",", 
            "\"\<\!\(\*SubscriptBox[\(P\), \
\(prod\)]\)/\!\(\*SuperscriptBox[\(y\), \(2\)]\)\>\""}], "}"}]}], ",", 
         RowBox[{"PlotLabel", "\[Rule]", 
          RowBox[{"Style", "[", 
           RowBox[{
            RowBox[{"Row", "[", 
             RowBox[{"{", 
              RowBox[{
              "\"\<Production probabilities of \>\"", ",", "LLPdirName", ",", 
               "\"\< at \>\"", ",", "FacilityGivenExperiment"}], "}"}], "]"}],
             ",", "18", ",", "Black"}], "]"}]}]}], "]"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"BremVariantsGivenFacility", "!=", 
       RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"posbrem", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"Position", "[", 
           RowBox[{"ProductionListBaseline", ",", 
            RowBox[{
             RowBox[{"Select", "[", 
              RowBox[{"ProductionListBaseline", ",", 
               RowBox[{
                RowBox[{"StringContainsQ", "[", 
                 RowBox[{"#", ",", "\"\<Bremsstrahlung\>\""}], "]"}], "&"}]}],
               "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"colorbrem", "=", 
        RowBox[{"colors", "[", 
         RowBox[{"[", "posbrem", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"ptprodprobbrem", "=", 
        RowBox[{"LogLogPlot", "[", 
         RowBox[{
          RowBox[{"Evaluate", "[", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"ProbLLP", "[", 
              RowBox[{"ma", ",", "1.", ",", "prod"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"prod", ",", "BremVariantsGivenFacility"}], "}"}]}], 
            "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"ma", ",", "mmin\[Epsilon]", ",", "mmax\[Epsilon]"}], 
           "}"}], ",", 
          RowBox[{"Frame", "->", "True"}], ",", 
          RowBox[{"ImageSize", "->", "Large"}], ",", 
          RowBox[{"FrameStyle", "\[Rule]", 
           RowBox[{"Directive", "[", 
            RowBox[{"Black", ",", " ", "25"}], "]"}]}], ",", 
          RowBox[{"PlotRange", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0.02", ",", "5"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               SuperscriptBox["10", 
                RowBox[{"-", "12"}]], ",", 
               SuperscriptBox["10", "5"]}], "}"}]}], "}"}]}], ",", 
          RowBox[{"PlotStyle", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"Thick", ",", "colorbrem"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"Thick", ",", "colorbrem", ",", 
               RowBox[{"Opacity", "[", "0.", "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"Thick", ",", "colorbrem", ",", 
               RowBox[{"Opacity", "[", "0.", "]"}]}], "}"}]}], "}"}]}], ",", 
          RowBox[{"AspectRatio", "\[Rule]", "0.66"}], ",", 
          RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
          RowBox[{"FrameLabel", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
            "\"\<\!\(\*SubscriptBox[\(m\), \(LLP\)]\) [GeV]\>\"", ",", 
             "\"\<\!\(\*SubscriptBox[\(P\), \(prod\)]\)/\!\(\*SuperscriptBox[\
\(y\), \(2\)]\)\>\""}], "}"}]}], ",", 
          RowBox[{"PlotLabel", "\[Rule]", 
           RowBox[{"Style", "[", 
            RowBox[{
             RowBox[{"Row", "[", 
              RowBox[{"{", 
               RowBox[{
               "\"\<Production probabilities of \>\"", ",", "LLPdirName", 
                ",", "\"\< at \>\"", ",", "FacilityGivenExperiment"}], "}"}], 
              "]"}], ",", "18", ",", "Black"}], "]"}]}], ",", 
          RowBox[{"Filling", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"2", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", "3", "}"}], ",", 
                RowBox[{"Directive", "[", 
                 RowBox[{
                  RowBox[{"Lighter", "@", "Blue"}], ",", 
                  RowBox[{"Opacity", "[", "0.1", "]"}]}], "]"}]}], "}"}]}], 
             ",", 
             RowBox[{"4", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", "5", "}"}], ",", 
                RowBox[{"Directive", "[", 
                 RowBox[{
                  RowBox[{"Lighter", "@", "Red"}], ",", 
                  RowBox[{"Opacity", "[", "0.2", "]"}]}], "]"}]}], "}"}]}]}], 
            "}"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"ptprodprob", "=", 
        RowBox[{"Show", "[", 
         RowBox[{"ptprodprob", ",", "ptprodprobbrem"}], "]"}]}], ";"}]}], 
     "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"DrellYanVariantsGivenFacility", "!=", 
       RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"posdrell", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"Position", "[", 
           RowBox[{"ProductionListBaseline", ",", 
            RowBox[{
             RowBox[{"Select", "[", 
              RowBox[{"ProductionListBaseline", ",", 
               RowBox[{
                RowBox[{"StringContainsQ", "[", 
                 RowBox[{"#", ",", "\"\<DrellYan\>\""}], "]"}], "&"}]}], 
              "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"colordrell", "=", 
        RowBox[{"colors", "[", 
         RowBox[{"[", "posdrell", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"ptprodprobdrellyan", "=", 
        RowBox[{"LogLogPlot", "[", 
         RowBox[{
          RowBox[{"Evaluate", "[", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"ProbLLP", "[", 
              RowBox[{"ma", ",", "1.", ",", "prod"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"prod", ",", "DrellYanVariantsGivenFacility"}], "}"}]}],
             "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"ma", ",", "mmin\[Epsilon]", ",", "mmax\[Epsilon]"}], 
           "}"}], ",", 
          RowBox[{"Frame", "->", "True"}], ",", 
          RowBox[{"ImageSize", "->", "Large"}], ",", 
          RowBox[{"FrameStyle", "\[Rule]", 
           RowBox[{"Directive", "[", 
            RowBox[{"Black", ",", " ", "25"}], "]"}]}], ",", 
          RowBox[{"PlotRange", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0.02", ",", "5"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               SuperscriptBox["10", 
                RowBox[{"-", "12"}]], ",", 
               SuperscriptBox["10", "5"]}], "}"}]}], "}"}]}], ",", 
          RowBox[{"PlotStyle", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"Thick", ",", "colordrell"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"Thick", ",", "colordrell", ",", 
               RowBox[{"Opacity", "[", "0.", "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"Thick", ",", "colordrell", ",", 
               RowBox[{"Opacity", "[", "0.", "]"}]}], "}"}]}], "}"}]}], ",", 
          RowBox[{"AspectRatio", "\[Rule]", "0.66"}], ",", 
          RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
          RowBox[{"FrameLabel", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
            "\"\<\!\(\*SubscriptBox[\(m\), \(LLP\)]\) [GeV]\>\"", ",", 
             "\"\<\!\(\*SubscriptBox[\(P\), \(prod\)]\)/\!\(\*SuperscriptBox[\
\(y\), \(2\)]\)\>\""}], "}"}]}], ",", 
          RowBox[{"PlotLabel", "\[Rule]", 
           RowBox[{"Style", "[", 
            RowBox[{
             RowBox[{"Row", "[", 
              RowBox[{"{", 
               RowBox[{
               "\"\<Production probabilities of \>\"", ",", "LLPdirName", 
                ",", "\"\< at \>\"", ",", "FacilityGivenExperiment"}], "}"}], 
              "]"}], ",", "18", ",", "Black"}], "]"}]}], ",", 
          RowBox[{"Filling", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"2", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", "3", "}"}], ",", 
               RowBox[{"Directive", "[", 
                RowBox[{
                 RowBox[{"Lighter", "@", "Red"}], ",", 
                 RowBox[{"Opacity", "[", "0.2", "]"}]}], "]"}]}], "}"}]}], 
            "}"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"ptprodprob", "=", 
        RowBox[{"Show", "[", 
         RowBox[{"ptprodprob", ",", "ptprodprobdrellyan"}], "]"}]}], ";"}]}], 
     "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"Style", "[", 
     RowBox[{
      RowBox[{"Row", "[", 
       RowBox[{"{", 
        RowBox[{"ptprodprob", ",", "ptenergies"}], "}"}], "]"}], ",", 
      RowBox[{"ImageSizeMultipliers", "->", 
       RowBox[{"{", 
        RowBox[{"1", ",", " ", "1", ",", "1"}], "}"}]}]}], "]"}]}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.934218518515441*^9, 3.934218537902442*^9}, 
   3.9342185941166706`*^9, {3.9342186376090508`*^9, 3.9342186376374598`*^9}, {
   3.93421938331448*^9, 3.9342193923497753`*^9}, {3.9345978169333267`*^9, 
   3.934597816943096*^9}, {3.9347398342293386`*^9, 3.9347398367196236`*^9}, {
   3.93525114124*^9, 3.935251187539447*^9}, {3.9352513550984387`*^9, 
   3.935251357686199*^9}, {3.935251397376196*^9, 3.935251423732613*^9}, {
   3.9352514706619773`*^9, 3.935251474443635*^9}, {3.935251755132921*^9, 
   3.93525175815399*^9}, 3.9354199571415243`*^9, {3.9418601326813984`*^9, 
   3.9418601529320927`*^9}, {3.9418602389029465`*^9, 
   3.9418602420429554`*^9}, {3.941860308578102*^9, 3.941860314009083*^9}, {
   3.941860387840704*^9, 3.9418604727256184`*^9}, {3.941860554710581*^9, 
   3.941860603790945*^9}, {3.9418607274520245`*^9, 3.9418607274917545`*^9}, {
   3.948390122316641*^9, 3.9483901670207767`*^9}, {3.9484280062190723`*^9, 
   3.9484280071973724`*^9}, {3.9499078912661476`*^9, 
   3.9499078943828163`*^9}, {3.949908002420271*^9, 3.94990803895372*^9}, 
   3.950588317759264*^9, {3.950605249224659*^9, 3.950605249851198*^9}, {
   3.9506344089308834`*^9, 3.950634462974476*^9}, {3.950636669247776*^9, 
   3.950636682000351*^9}, 3.9506367387436485`*^9, 3.950786590282524*^9, {
   3.9508677832223015`*^9, 3.9508677994710217`*^9}},
 CellTags->{
  "Number-of-events-computation+sensitivity", "Acceptance-computation"},
 CellLabel->
  "In[108]:=",ExpressionUUID->"f38d7eaf-e37c-2d45-9c7c-f7124f08952e"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Number of events", "Chapter",
 CellChangeTimes->{{3.8935731783578434`*^9, 3.893573180246764*^9}},
 CellTags->
  "Number-of-events-computation+sensitivity",ExpressionUUID->"913a2300-dec2-\
4b0f-8b44-4b75cf0adccf"],

Cell[CellGroupData[{

Cell["Generalized acceptances ", "Section",
 CellChangeTimes->{{3.897198873663946*^9, 3.8971988750678434`*^9}, 
   3.9165065585390453`*^9, 3.9165070655729046`*^9, 3.9166798862174683`*^9, {
   3.9525901333753624`*^9, 3.952590136037901*^9}},
 CellTags->{
  "Acceptance-computation", 
   "Number-of-events-computation+sensitivity"},ExpressionUUID->"b0772e57-8882-\
4e3d-a1f7-c9c6f58dc7ac"],

Cell[CellGroupData[{

Cell["Initializing all routines", "Subsection",
 CellChangeTimes->{{3.897199076623907*^9, 3.8971990900052223`*^9}, {
   3.8972009084104066`*^9, 3.897200920680235*^9}, 3.916506561920749*^9, {
   3.9165071319109154`*^9, 3.916507136145134*^9}},
 CellTags->{
  "Acceptance-computation", 
   "Number-of-events-computation+sensitivity"},ExpressionUUID->"09bda361-200e-\
4474-a4eb-51f045b744b2"],

Cell[BoxData[
 RowBox[{"If", "[", 
  RowBox[{"condcontinue", ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"OutGrid\[Theta]final", "[", "prod", "]"}], ",", 
         RowBox[{"\[CapitalDelta]\[Theta]vals", "[", "prod", "]"}]}], "}"}], 
       "=", 
       RowBox[{"OutGrid\[Theta]Temp", "[", 
        RowBox[{"InGrid\[Theta]\[Epsilon]", ",", "30", ",", "prod", ",", 
         RowBox[{"\[Theta]maxBrem", "[", "prod", "]"}]}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"prod", ",", "ProductionList"}], "}"}]}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"OutGridzfinal", ",", "\[CapitalDelta]zvals"}], "}"}], "=", 
     RowBox[{"OutGridszTemp", "[", 
      RowBox[{"InGridz\[Epsilon]", ",", "30", ",", "zminExp"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"Final", " ", "energy", " ", 
       RowBox[{"grid", ".", " ", "Mass"}]}], "-", " ", 
      RowBox[{"and", " ", "production", " ", "channel"}], "-", "dependent"}], 
     "*)"}], "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"FacilityGivenExperiment", "!=", "\"\<ESS\>\""}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"StepEtemp", "[", "Efip_", "]"}], "=", 
        RowBox[{"Piecewise", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0.3", ",", 
             RowBox[{"Efip", "\[LessEqual]", "2.5"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0.5", ",", 
             RowBox[{"2.5", "<", "Efip", "<", "35"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"2", ",", 
             RowBox[{"35", "\[LessEqual]", "Efip", "\[LessEqual]", "50"}]}], 
            "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"4", ",", 
             RowBox[{"50", "<", "Efip", "<", "160"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"5", ",", 
             RowBox[{"160", "\[LessEqual]", "Efip", "<=", "400"}]}], "}"}], 
           ",", 
           RowBox[{"{", 
            RowBox[{"25", ",", 
             RowBox[{"400", "<", "Efip", "<", "600"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"50", ",", 
             RowBox[{"600", "<=", "Efip", "<", "2000"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"200", ",", 
             RowBox[{"2000", "\[LessEqual]", "Efip", "<", "4000"}]}], "}"}], 
           ",", 
           RowBox[{"{", 
            RowBox[{"400", ",", 
             RowBox[{"4000", "\[LessEqual]", "Efip", "<", "7000"}]}], "}"}], 
           ",", 
           RowBox[{"{", 
            RowBox[{"500", ",", 
             RowBox[{
             "7000", "\[LessEqual]", "Efip", "\[LessEqual]", "50000"}]}], 
            "}"}]}], "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"OutGridEnergy", "[", 
         RowBox[{"m_", ",", "ProdChannel_"}], "]"}], ":=", 
        RowBox[{"Block", "[", 
         RowBox[{
          RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"emin", "=", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"StringContainsQ", "[", 
                RowBox[{"ProdChannel", ",", "\"\<Bremsstrahlung\>\""}], 
                "]"}]}], ",", 
              RowBox[{"N", "[", "m", "]"}], ",", 
              RowBox[{"ELLPmin", "[", "ProdChannel", "]"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"egridtemp", "=", 
            RowBox[{
             RowBox[{"With", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"start", "=", "emin"}], ",", 
                 RowBox[{"end", "=", 
                  RowBox[{"ELLPmax", "[", 
                   RowBox[{"m", ",", "\[Theta]minExp", ",", "ProdChannel"}], 
                   "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Log10", "[", 
                RowBox[{"NestWhileList", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"#", "+", 
                    RowBox[{"StepEtemp", "[", "#", "]"}]}], "&"}], ",", 
                  "start", ",", 
                  RowBox[{
                   RowBox[{"#", "\[LessEqual]", "end"}], "&"}], ",", "1", ",",
                   "\[Infinity]", ",", 
                  RowBox[{"-", "1"}]}], "]"}], "]"}]}], "]"}], "//", "N"}]}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Length", "[", "egridtemp", "]"}], "==", "1"}], ",", 
             RowBox[{"egridtemp", "=", 
              RowBox[{"Join", "[", 
               RowBox[{"egridtemp", ",", 
                RowBox[{"{", 
                 RowBox[{"Log10", "[", 
                  RowBox[{"2", "*", "emin"}], "]"}], "}"}]}], "]"}]}]}], 
            "]"}], ";", "\[IndentingNewLine]", "egridtemp"}]}], 
         "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"StepEtemp", "[", "Efip_", "]"}], "=", "0.001"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"OutGridEnergy", "[", 
         RowBox[{"m_", ",", "ProdChannel_"}], "]"}], ":=", 
        RowBox[{"Block", "[", 
         RowBox[{
          RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"tabt", "=", 
            RowBox[{"Table", "[", 
             RowBox[{"e", ",", 
              RowBox[{"{", 
               RowBox[{"e", ",", 
                RowBox[{"1.0001", "m"}], ",", 
                RowBox[{"ELLPmax", "[", 
                 RowBox[{"m", ",", "\[Theta]minExp", ",", "ProdChannel"}], 
                 "]"}], ",", "0.001"}], "}"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Length", "[", "tabt", "]"}], "==", "1"}], ",", 
             RowBox[{"tabt", "=", 
              RowBox[{
               RowBox[{
                RowBox[{"Join", "[", 
                 RowBox[{"tabt", ",", 
                  RowBox[{"{", 
                   RowBox[{"ELLPmax", "[", 
                    RowBox[{"m", ",", "\[Theta]minExp", ",", "ProdChannel"}], 
                    "]"}], "}"}]}], "]"}], "//", "Sort"}], "//", 
               "DeleteDuplicates"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Log10", "[", "tabt", "]"}], "//", "N"}]}]}], 
         "\[IndentingNewLine]", "]"}]}]}]}], "\[IndentingNewLine]", "]"}], 
    ";", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
     "___", "___", "___", "___", "___", "___", "___", "___", "___", "___", 
      "___", "___", "___", "___", "___", "___", "___", "_"}], "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{
      "Block", " ", "that", " ", "computes", " ", "the", " ", "grid", " ", 
       SubscriptBox["\[Theta]", "S"]}], ",", 
      SubscriptBox["E", "S"], ",", 
      SubscriptBox["z", "S"], ",", " ", 
      RowBox[{
       SubscriptBox["\[Epsilon]", "Full"], "\[Times]", 
       SubscriptBox["f", 
        RowBox[{
         SubscriptBox["\[Theta]", "S"], ",", 
         SubscriptBox["E", "S"]}]]}]}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
     "___", "___", "___", "___", "___", "___", "___", "___", "___", "___", 
      "___", "___", "___", "___", "___", "___", "___", "_"}], "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{
       RowBox[{
       "The", " ", "block", " ", "which", " ", "sets", " ", "all", " ", "the",
         " ", "values", " ", "of", " ", 
        SubscriptBox["\[Epsilon]", "Full"], "\[Times]", 
        SubscriptBox["f", 
         RowBox[{"\[Theta]", ",", "E"}]], " ", "for", " ", "which", " ", 
        "E"}], " ", "<", " ", 
       RowBox[{
        SubscriptBox["E", "max"], " ", "to", " ", "zero"}]}], ",", " ", 
      RowBox[{"for", " ", "Bremsstrahlung"}]}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"createCompiledFunctionBrem", "[", "BremChoice_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "func", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"func", "[", 
          RowBox[{"mfip_", ",", "th_"}], "]"}], "=", 
         RowBox[{"ELLPmax", "[", 
          RowBox[{"mfip", ",", "th", ",", "BremChoice"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"Hold", "@", 
           RowBox[{"Compile", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"angleenergy", ",", "_Real", ",", "1"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"mfip", ",", "_Real"}], "}"}]}], "}"}], ",", 
             RowBox[{"Module", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                "angles", ",", "energies", ",", "distrvals", ",", "d"}], 
                "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"angles", "=", 
                 RowBox[{"Compile`GetElement", "[", 
                  RowBox[{"angleenergy", ",", "1"}], "]"}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"energies", "=", 
                 RowBox[{"Compile`GetElement", "[", 
                  RowBox[{"angleenergy", ",", "2"}], "]"}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"distrvals", "=", 
                 RowBox[{"Compile`GetElement", "[", 
                  RowBox[{"angleenergy", ",", "3"}], "]"}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"d", "=", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"energies", "<", 
                    RowBox[{"func", "[", 
                    RowBox[{"mfip", ",", "angles"}], "]"}]}], ",", 
                   "distrvals", ",", 
                   RowBox[{"10", "^", 
                    RowBox[{"-", "90."}]}]}], "]"}]}], ";", 
                "\[IndentingNewLine]", "d"}]}], "]"}], ",", 
             RowBox[{"CompilationTarget", "->", "\"\<C\>\""}], ",", 
             RowBox[{"RuntimeOptions", "->", "\"\<Speed\>\""}], ",", 
             RowBox[{"RuntimeAttributes", "->", 
              RowBox[{"{", "Listable", "}"}]}], ",", 
             RowBox[{"Parallelization", "->", "True"}]}], "]"}]}], "/.", " ", 
          RowBox[{"DownValues", "@", "func"}]}], "//", "ReleaseHold"}]}]}], 
      "\[IndentingNewLine]", "]"}]}], ";", "\n", 
    RowBox[{"(*", 
     RowBox[{
     "Generate", " ", "a", " ", "dictionary", " ", "of", " ", "compiled", " ",
       "functions", " ", "for", " ", "each", " ", "variant"}], "*)"}], 
    RowBox[{"compiledBremCutter", "=", 
     RowBox[{"AssociationThread", "[", 
      RowBox[{"BremVariantsGivenFacility", ",", 
       RowBox[{
       "createCompiledFunctionBrem", "/@", "BremVariantsGivenFacility"}]}], 
      "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"BremCut", "[", 
      RowBox[{
      "OutGrid\[Theta]final_", ",", "OutGridEfinal_", ",", "distr_", ",", 
       "mLLP_", ",", "bremChoice_"}], "]"}], ":=", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"angleenergy", "=", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"10", "^", 
            RowBox[{"Tuples", "[", 
             RowBox[{"{", 
              RowBox[{"OutGrid\[Theta]final", ",", "OutGridEfinal"}], "}"}], 
             "]"}]}], ",", 
           RowBox[{"Partition", "[", 
            RowBox[{"distr", ",", "1"}], "]"}], ",", "2"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"compiledFunc", "=", 
         RowBox[{"compiledBremCutter", "[", "bremChoice", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"compiledFunc", "[", 
         RowBox[{"angleenergy", ",", "mLLP"}], "]"}]}]}], 
      "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"TableIntegrandDiscret", "[", 
      RowBox[{"m_", ",", "ProdChannel_", ",", "\[Epsilon]DecOp_"}], "]"}], ":=", 
     RowBox[{"TableIntegrandDiscretTemp", "[", 
      RowBox[{
      "m", ",", "ProdChannel", ",", "\[Epsilon]DecOp", ",", "\[Epsilon]vals", 
       ",", "\[Epsilon]azvals", ",", 
       RowBox[{"OutGrid\[Theta]final", "[", "ProdChannel", "]"}], ",", 
       "OutGridzfinal", ",", "OutGridEnergy", ",", "InGridm\[Epsilon]", ",", 
       "InGrid\[Theta]\[Epsilon]", ",", "InGridE\[Epsilon]", ",", 
       "InGridz\[Epsilon]", ",", 
       RowBox[{"\[CapitalDelta]\[Theta]vals", "[", "ProdChannel", "]"}], ",", 
       "\[CapitalDelta]zvals", ",", "zminExp", ",", "GridInFinal", ",", 
       "DistrVals", ",", "FacilityGivenExperiment", ",", "ELLPmax", ",", 
       "\[Theta]minExp"}], "]"}]}]}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{
  3.914065400601883*^9, {3.9144955915086913`*^9, 3.914495605102999*^9}, {
   3.9144963994464297`*^9, 3.91449645003281*^9}, 3.9156429961809263`*^9, 
   3.9162514062581673`*^9, {3.916332203281742*^9, 3.9163322040420866`*^9}, {
   3.916332256159724*^9, 3.916332315776701*^9}, {3.916332682855117*^9, 
   3.9163326972784367`*^9}, {3.916332729581109*^9, 3.9163327827424307`*^9}, {
   3.916332995032469*^9, 3.9163330418518543`*^9}, {3.9163330893535175`*^9, 
   3.9163331201157775`*^9}, {3.9163883031455355`*^9, 
   3.9163883099402237`*^9}, {3.91639027241718*^9, 3.9163902725145645`*^9}, {
   3.916390440036625*^9, 3.9163904429286966`*^9}, {3.9163913725242844`*^9, 
   3.9163913900649643`*^9}, {3.9165060112532883`*^9, 
   3.9165060531405983`*^9}, {3.916506386454261*^9, 3.9165063916867723`*^9}, {
   3.9165064378147545`*^9, 3.9165064402046285`*^9}, {3.9165066063487997`*^9, 
   3.9165066068133373`*^9}, {3.916506770781*^9, 3.916506770986845*^9}, {
   3.916506818360832*^9, 3.9165068344941483`*^9}, {3.91650702210918*^9, 
   3.916507055596775*^9}, 3.9165070945532026`*^9, {3.9165072348013864`*^9, 
   3.916507258828418*^9}, {3.9165082243803825`*^9, 3.9165082246202836`*^9}, {
   3.9165089341902933`*^9, 3.9165089344447165`*^9}, {3.916671056709384*^9, 
   3.9166710572925243`*^9}, {3.916671102174552*^9, 3.9166711025636616`*^9}, 
   3.916680209356353*^9, {3.916763700163747*^9, 3.916763735081332*^9}, {
   3.9167637657945323`*^9, 3.9167637686631947`*^9}, 3.9168551246377473`*^9, 
   3.9168552883087473`*^9, {3.916855405962035*^9, 3.916855407763837*^9}, {
   3.9181394711318083`*^9, 3.918139476958158*^9}, {3.918144058743101*^9, 
   3.918144063662957*^9}, 3.934739493130162*^9, {3.9506694835444508`*^9, 
   3.950669494923252*^9}, {3.9506696492675705`*^9, 3.9506696619255543`*^9}},
 CellTags->{
  "Acceptance-computation", "Number-of-events-computation+sensitivity"},
 CellLabel->
  "In[109]:=",ExpressionUUID->"07d9d00a-b1e3-45a3-8431-e5ba54203718"]
}, Closed]],

Cell[CellGroupData[{

Cell["Generalized acceptances", "Subsection",
 CellChangeTimes->{{3.9165071505021195`*^9, 3.9165071536920986`*^9}},
 CellTags->{
  "Acceptance-computation", 
   "Number-of-events-computation+sensitivity"},ExpressionUUID->"38691406-6de0-\
4e83-9a5b-27156e5454d3"],

Cell[CellGroupData[{

Cell["Definitions", "Subsubsection",
 CellChangeTimes->{{3.9347377057465973`*^9, 3.9347377246837664`*^9}},
 CellTags->{
  "Number-of-events-computation+sensitivity", 
   "Acceptance-computation"},ExpressionUUID->"a3aaf4e0-3a6f-1a4a-9d7f-\
56304c4e55bc"],

Cell[BoxData[
 RowBox[{"If", "[", 
  RowBox[{"condcontinue", ",", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Tabulated", " ", "acceptance"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"FactorANUBISceiling", "=", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"SelectedExperiment", "==", "\"\<ANUBIS-ceiling\>\""}], ",", 
       "2", ",", "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"AcceptanceDiscret", "[", 
      RowBox[{
      "m_", ",", "ProdChannel_", ",", "\[Epsilon]decOp_", ",", "decProb_"}], 
      "]"}], ":=", 
     RowBox[{"AcceptanceDiscretTemp", "[", 
      RowBox[{
      "m", ",", "ProdChannel", ",", "\[Epsilon]decOp", ",", "decProb", ",", 
       "mLLPmin", ",", "mmin\[Epsilon]", ",", "mLLPmax", ",", 
       "mmax\[Epsilon]", ",", "ELLPmax", ",", "\[Theta]minExp", ",", 
       "TableIntegrandDiscret", ",", "BrVis", ",", "zmaxExp", ",", "zminExp", 
       ",", "FactorANUBISceiling", ",", "0."}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"mlistAcceptance", "[", "prod", "]"}], "=", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{"m", ",", 
           RowBox[{"{", 
            RowBox[{"m", ",", 
             RowBox[{"1.01", 
              RowBox[{"Max", "[", 
               RowBox[{
                RowBox[{"mLLPmin", "[", "prod", "]"}], ",", 
                "mmin\[Epsilon]"}], "]"}]}], ",", 
             RowBox[{"0.95", 
              RowBox[{"Min", "[", 
               RowBox[{
                RowBox[{"mLLPmax", "[", "prod", "]"}], ",", 
                "mmax\[Epsilon]"}], "]"}]}], ",", 
             RowBox[{"Min", "[", 
              RowBox[{
               FractionBox[
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"0.95", 
                   RowBox[{"Min", "[", 
                    RowBox[{
                    RowBox[{"mLLPmax", "[", "prod", "]"}], ",", 
                    "mmax\[Epsilon]"}], "]"}]}], "-", 
                  RowBox[{"1.01", 
                   RowBox[{"Max", "[", 
                    RowBox[{
                    RowBox[{"mLLPmin", "[", "prod", "]"}], ",", 
                    "mmin\[Epsilon]"}], "]"}]}]}], ")"}], "20"], ",", "2"}], 
              "]"}]}], "}"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"0.99", 
           RowBox[{"Min", "[", 
            RowBox[{
             RowBox[{"mLLPmax", "[", "prod", "]"}], ",", "mmax\[Epsilon]"}], 
            "]"}]}], "}"}]}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"prod", ",", "ProductionList"}], "}"}]}], "]"}], ";"}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.9506698344634*^9, 3.9506698389783573`*^9}},
 CellTags->{
  "Number-of-events-computation+sensitivity", "Acceptance-computation"},
 CellLabel->
  "In[110]:=",ExpressionUUID->"2ad3871d-9835-3444-9fb8-0a832c2adf15"]
}, Closed]],

Cell[CellGroupData[{

Cell["Calculating tabulated acceptances", "Subsubsection",
 CellChangeTimes->{{3.9347377057465973`*^9, 3.9347377186386113`*^9}},
 CellTags->{
  "Number-of-events-computation+sensitivity", 
   "Acceptance-computation"},ExpressionUUID->"52a0264d-e70c-8e42-96e9-\
463c01c40c40"],

Cell[BoxData[
 RowBox[{"If", "[", 
  RowBox[{"condcontinue", ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ResourceFunction", "[", "\"\<MonitorProgress\>\"", "]"}], "@", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"\[Epsilon]GeomTabs", "[", "prod", "]"}], "=", 
         RowBox[{"ParallelTable", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"m", ",", 
             RowBox[{"AcceptanceDiscret", "[", 
              RowBox[{"m", ",", "prod", ",", "\"\<False\>\"", ",", "0"}], 
              "]"}], ",", 
             RowBox[{"AcceptanceDiscret", "[", 
              RowBox[{"m", ",", "prod", ",", "\"\<True\>\"", ",", "0"}], 
              "]"}], ",", 
             RowBox[{"AcceptanceDiscret", "[", 
              RowBox[{"m", ",", "prod", ",", "\"\<False\>\"", ",", "1"}], 
              "]"}], ",", 
             RowBox[{"AcceptanceDiscret", "[", 
              RowBox[{"m", ",", "prod", ",", "\"\<True\>\"", ",", "1"}], 
              "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"m", ",", 
             RowBox[{"mlistAcceptance", "[", "prod", "]"}]}], "}"}]}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"\[Epsilon]GeomTabs", "[", "prod", "]"}], "=", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"Join", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"Max", "[", 
                RowBox[{
                 RowBox[{"mLLPmin", "[", "prod", "]"}], ",", 
                 "mmin\[Epsilon]"}], "]"}], "}"}], ",", 
              RowBox[{"Drop", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"\[Epsilon]GeomTabs", "[", "prod", "]"}], "[", 
                 RowBox[{"[", "1", "]"}], "]"}], ",", "1"}], "]"}]}], "]"}], 
            "}"}], ",", 
           RowBox[{"\[Epsilon]GeomTabs", "[", "prod", "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"Join", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"Min", "[", 
                RowBox[{
                 RowBox[{"mLLPmax", "[", "prod", "]"}], ",", 
                 "mmax\[Epsilon]"}], "]"}], "}"}], ",", 
              RowBox[{"Drop", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"\[Epsilon]GeomTabs", "[", "prod", "]"}], "[", 
                 RowBox[{"[", 
                  RowBox[{"-", "1"}], "]"}], "]"}], ",", "1"}], "]"}]}], 
             "]"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"prod", ",", "ProductionList"}], "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"PlotAcc", "[", "ProdChannel_", "]"}], ":=", 
     RowBox[{"ListLogPlot", "[", 
      RowBox[{
       RowBox[{"Evaluate", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"\[Epsilon]GeomTabs", "[", "ProdChannel", "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", 
             RowBox[{"{", 
              RowBox[{"1", ",", "2"}], "}"}]}], "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"\[Epsilon]GeomTabs", "[", "ProdChannel", "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", 
             RowBox[{"{", 
              RowBox[{"1", ",", "3"}], "}"}]}], "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"\[Epsilon]GeomTabs", "[", "ProdChannel", "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", 
             RowBox[{"{", 
              RowBox[{"1", ",", "4"}], "}"}]}], "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"\[Epsilon]GeomTabs", "[", "ProdChannel", "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", 
             RowBox[{"{", 
              RowBox[{"1", ",", "5"}], "}"}]}], "]"}], "]"}]}], "}"}], "]"}], 
       ",", 
       RowBox[{"FrameStyle", "\[Rule]", 
        RowBox[{"Directive", "[", 
         RowBox[{"Black", ",", " ", "22"}], "]"}]}], ",", 
       RowBox[{"PlotStyle", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Thickness", "[", "0.003", "]"}], ",", "Blue"}], "}"}], 
          ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Thickness", "[", "0.003", "]"}], ",", 
            RowBox[{"Darker", "@", "Red"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Thickness", "[", "0.003", "]"}], ",", 
            RowBox[{"Darker", "@", 
             RowBox[{"Darker", "@", "Green"}]}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Thickness", "[", "0.003", "]"}], ",", "Black"}], "}"}]}],
          "}"}]}], ",", 
       RowBox[{"GridLines", "\[Rule]", "Automatic"}], ",", 
       RowBox[{"PlotRange", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"MinMax", "[", 
           RowBox[{
            RowBox[{"\[Epsilon]GeomTabs", "[", "ProdChannel", "]"}], "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Max", "[", 
             RowBox[{
              RowBox[{"0.9", 
               RowBox[{"Min", "[", 
                RowBox[{
                 RowBox[{"Min", "[", 
                  RowBox[{
                   RowBox[{"\[Epsilon]GeomTabs", "[", "ProdChannel", "]"}], 
                   "[", 
                   RowBox[{"[", 
                    RowBox[{"All", ",", "4"}], "]"}], "]"}], "]"}], ",", 
                 RowBox[{"Min", "[", 
                  RowBox[{
                   RowBox[{"\[Epsilon]GeomTabs", "[", "ProdChannel", "]"}], 
                   "[", 
                   RowBox[{"[", 
                    RowBox[{"All", ",", "3"}], "]"}], "]"}], "]"}]}], "]"}]}],
               ",", 
              SuperscriptBox["10", 
               RowBox[{"-", "5"}]]}], "]"}], ",", 
            RowBox[{"1.1", 
             RowBox[{"Max", "[", 
              RowBox[{
               RowBox[{"Max", "[", 
                RowBox[{
                 RowBox[{"\[Epsilon]GeomTabs", "[", "ProdChannel", "]"}], "[", 
                 RowBox[{"[", 
                  RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}], ",", 
               RowBox[{"Max", "[", 
                RowBox[{
                 RowBox[{"\[Epsilon]GeomTabs", "[", "ProdChannel", "]"}], "[", 
                 RowBox[{"[", 
                  RowBox[{"All", ",", "4"}], "]"}], "]"}], "]"}]}], "]"}]}]}],
            "}"}]}], "}"}]}], ",", 
       RowBox[{"Joined", "\[Rule]", "True"}], ",", 
       RowBox[{"Frame", "\[Rule]", "True"}], ",", 
       RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
       RowBox[{"FrameLabel", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
         "\"\<\!\(\*SubscriptBox[\(m\), \(LLP\)]\) [GeV]\>\"", ",", 
          "\"\<Acceptance\>\""}], "}"}]}], ",", 
       RowBox[{"PlotLabel", "\[Rule]", " ", 
        RowBox[{"Style", "[", 
         RowBox[{
          RowBox[{"Row", "[", 
           RowBox[{"{", 
            RowBox[{"\"\<From \>\"", ",", "ProdChannel"}], "}"}], "]"}], ",", 
          " ", "20", ",", " ", "Black"}], "]"}]}], ",", 
       RowBox[{"PlotLegends", "\[Rule]", 
        RowBox[{"Placed", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Style", "[", 
             RowBox[{"#", ",", " ", "18"}], "]"}], "&"}], "/@", 
           RowBox[{"{", 
            RowBox[{
            "\"\<<\!\(\*SubscriptBox[\(\[Epsilon]\), \(LLP\)]\)>\>\"", ",", 
             "\"\<<\!\(\*SubscriptBox[\(\[Epsilon]\), \
\(LLP\)]\)\!\(\*SubscriptBox[\(\[Epsilon]\), \(decay\)]\)>\>\"", ",", 
             "\"\<c\[Tau]<\!\(\*SubscriptBox[\(\[Epsilon]\), \
\(LLP\)]\)\!\(\*SubscriptBox[\(P\), \(decay\)]\)>\>\"", ",", 
             
             "\"\<c\[Tau]<\!\(\*SubscriptBox[\(\[Epsilon]\), \
\(LLP\)]\)\!\(\*SubscriptBox[\(P\), \(decay\)]\)\!\(\*SubscriptBox[\(\
\[Epsilon]\), \(decay\)]\)>\>\""}], "}"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"0.75", ",", "0.2"}], "}"}]}], "]"}]}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"FilenameAcceptance", "[", "prod", "]"}], "=", 
         RowBox[{"ToString", "@", 
          RowBox[{"StringForm", "[", 
           RowBox[{"\"\<Acceptance_ALP-fermion_at_``_From_``.dat\>\"", ",", 
            RowBox[{"Sequence", "@@", 
             RowBox[{"{", 
              RowBox[{"SelectedExperiment", ",", 
               RowBox[{"ExportList", "[", "prod", "]"}]}], "}"}]}]}], 
           "]"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Export", "[", 
         RowBox[{
          RowBox[{"FileNameJoin", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"NotebookDirectory", "[", "]"}], ",", 
             "\"\<Auxiliary data/ALPs with fermion coupling\>\"", ",", 
             "SelectedExperiment", ",", 
             RowBox[{"FilenameAcceptance", "[", "prod", "]"}]}], "}"}], "]"}],
           ",", 
          RowBox[{
           RowBox[{"\[Epsilon]GeomTabs", "[", "prod", "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", 
             RowBox[{"{", 
              RowBox[{"1", ",", "2", ",", "4", ",", "5"}], "}"}]}], "]"}], 
           "]"}], ",", "\"\<Table\>\""}], "]"}]}], "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"prod", ",", "ProductionList"}], "}"}]}], "]"}], "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"AccAveraged", "[", 
      RowBox[{"mLLP_", ",", "c\[Tau]_"}], "]"}], "=", 
     RowBox[{"NpotGivenExperiment", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"mLLPmin", "[", "prod", "]"}], "<", "mLLP", "<", 
             RowBox[{"mLLPmax", "[", "prod", "]"}]}], ",", 
            RowBox[{"Evaluate", "[", 
             RowBox[{"ProbLLP", "[", 
              RowBox[{"mLLP", ",", "1.", ",", "prod"}], "]"}], "]"}], ",", 
            "0"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"prod", ",", "ProductionListBaseline"}], "}"}]}], "]"}], 
        ",", 
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Max", "[", 
              RowBox[{
               RowBox[{"mLLPmin", "[", "prod", "]"}], ",", "mmin\[Epsilon]"}],
               "]"}], "<", "mLLP", "<", 
             RowBox[{"Min", "[", 
              RowBox[{
               RowBox[{"mLLPmax", "[", "prod", "]"}], ",", "mmax\[Epsilon]"}],
               "]"}]}], ",", 
            RowBox[{"Evaluate", "[", 
             RowBox[{
              RowBox[{"ProbLLP", "[", 
               RowBox[{"mLLP", ",", "1.", ",", "prod"}], "]"}], "*", 
              RowBox[{
               RowBox[{"Interpolation", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"\[Epsilon]GeomTabs", "[", "prod", "]"}], "[", 
                  RowBox[{"[", 
                   RowBox[{"All", ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "2"}], "}"}]}], "]"}], "]"}], ",", 
                 RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[",
                "mLLP", "]"}]}], "]"}], ",", "0"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"prod", ",", "ProductionListBaseline"}], "}"}]}], "]"}], 
        ",", 
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Max", "[", 
              RowBox[{
               RowBox[{"mLLPmin", "[", "prod", "]"}], ",", "mmin\[Epsilon]"}],
               "]"}], "<", "mLLP", "<", 
             RowBox[{"Min", "[", 
              RowBox[{
               RowBox[{"mLLPmax", "[", "prod", "]"}], ",", "mmax\[Epsilon]"}],
               "]"}]}], ",", 
            RowBox[{"Evaluate", "[", 
             RowBox[{
              FractionBox[
               RowBox[{"ProbLLP", "[", 
                RowBox[{"mLLP", ",", "1.", ",", "prod"}], "]"}], "c\[Tau]"], 
              "*", 
              RowBox[{
               RowBox[{"Interpolation", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"\[Epsilon]GeomTabs", "[", "prod", "]"}], "[", 
                  RowBox[{"[", 
                   RowBox[{"All", ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "4"}], "}"}]}], "]"}], "]"}], ",", 
                 RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[",
                "mLLP", "]"}]}], "]"}], ",", "0"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"prod", ",", "ProductionListBaseline"}], "}"}]}], "]"}], 
        ",", 
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Max", "[", 
              RowBox[{
               RowBox[{"mLLPmin", "[", "prod", "]"}], ",", "mmin\[Epsilon]"}],
               "]"}], "<", "mLLP", "<", 
             RowBox[{"Min", "[", 
              RowBox[{
               RowBox[{"mLLPmax", "[", "prod", "]"}], ",", "mmax\[Epsilon]"}],
               "]"}]}], ",", 
            RowBox[{"Evaluate", "[", 
             RowBox[{
              FractionBox[
               RowBox[{"ProbLLP", "[", 
                RowBox[{"mLLP", ",", "1.", ",", "prod"}], "]"}], "c\[Tau]"], 
              "*", 
              RowBox[{
               RowBox[{"Interpolation", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"\[Epsilon]GeomTabs", "[", "prod", "]"}], "[", 
                  RowBox[{"[", 
                   RowBox[{"All", ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "5"}], "}"}]}], "]"}], "]"}], ",", 
                 RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[",
                "mLLP", "]"}]}], "]"}], ",", "0"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"prod", ",", "ProductionListBaseline"}], "}"}]}], "]"}]}], 
       "}"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{"FileNameJoin", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"directory", "[", "\"\<Auxiliary-experiment\>\"", "]"}], ",", 
         RowBox[{
         "\"\<AcceptanceAveraged-\>\"", "<>", "LLPdirName", "<>", 
          "\"\<.m\>\""}]}], "}"}], "]"}], ",", 
      RowBox[{"AccAveraged", "[", 
       RowBox[{"mLLP", ",", "c\[Tau]"}], "]"}], ",", "\"\<MX\>\""}], "]"}], 
    ";", "\[IndentingNewLine]", 
    RowBox[{"Style", "[", 
     RowBox[{
      RowBox[{"Row", "[", 
       RowBox[{"Evaluate", "[", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"PlotAcc", "[", "prod", "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"prod", ",", "ProductionList"}], "}"}]}], "]"}], "]"}], 
       "]"}], ",", 
      RowBox[{"ImageSizeMultipliers", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"1", ",", "1", ",", "1", ",", "1"}], "}"}]}]}], "]"}]}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.9165072608467913`*^9, 3.91650727179105*^9}, {
   3.916511834115503*^9, 3.9165119704481926`*^9}, {3.9166711144696927`*^9, 
   3.9166711149830294`*^9}, {3.928577551907442*^9, 3.9285775525898123`*^9}, {
   3.934219643234742*^9, 3.9342196518452215`*^9}, {3.934597816963075*^9, 
   3.9345978169732704`*^9}, 3.9347377224678707`*^9, {3.9427359454706364`*^9, 
   3.9427359470532284`*^9}, {3.949908103072439*^9, 3.949908108151289*^9}, 
   3.9499084195651093`*^9, {3.9506052255650005`*^9, 3.9506052255895004`*^9}, {
   3.950669828687237*^9, 3.9506698570067043`*^9}},
 CellTags->{
  "Acceptance-computation", "Number-of-events-computation+sensitivity"},
 CellLabel->
  "In[111]:=",ExpressionUUID->"46fc40d5-c6c5-3e4d-92cd-122e24134dc2"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Rough estimates of the upper and lower bounds", "Subsection",
 CellChangeTimes->{{3.8850328066928463`*^9, 3.8850328135228024`*^9}},
 CellTags->{
  "Acceptance-computation", 
   "Number-of-events-computation+sensitivity"},ExpressionUUID->"1f64e19f-68db-\
451d-9c11-af942b7e295b"],

Cell[BoxData[
 RowBox[{"If", "[", 
  RowBox[{"condcontinue", ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Do", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"LowerBoundEstimate", "[", 
         RowBox[{"mLLP_", ",", "prod"}], "]"}], "=", 
        SuperscriptBox[
         RowBox[{"(", 
          FractionBox[
           RowBox[{"NpotGivenExperiment", "*", 
            RowBox[{"ProbLLP", "[", 
             RowBox[{"mLLP", ",", "1", ",", "prod"}], "]"}], "*", 
            RowBox[{
             RowBox[{"Interpolation", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"\[Epsilon]GeomTabs", "[", "prod", "]"}], "[", 
                RowBox[{"[", 
                 RowBox[{"All", ",", 
                  RowBox[{"{", 
                   RowBox[{"1", ",", "5"}], "}"}]}], "]"}], "]"}], ",", 
               RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[", 
             "mLLP", "]"}]}], 
           RowBox[{"2.3", 
            RowBox[{"ldecayLLP", "[", 
             RowBox[{"mLLP", ",", "1", ",", "ELLP"}], "]"}], 
            FractionBox["mLLP", 
             SqrtBox[
              RowBox[{
               SuperscriptBox["ELLP", "2"], "-", 
               SuperscriptBox["mLLP", "2"]}]]]}]], ")"}], 
         RowBox[{"-", 
          FractionBox["1", "4"]}]]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"UpperBoundEstimate", "[", 
         RowBox[{"mLLP_", ",", "prod"}], "]"}], "=", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"Abs", "[", 
           RowBox[{"Re", "[", 
            RowBox[{"Evaluate", "[", 
             RowBox[{
              RowBox[{"-", 
               FractionBox[
                RowBox[{"ProductLog", "[", 
                 RowBox[{
                  RowBox[{"-", "1"}], ",", 
                  RowBox[{
                   RowBox[{"-", "2.3"}], "*", 
                   FractionBox["b", "a"]}]}], "]"}], "b"]}], "/.", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"a", "\[Rule]", " ", 
                 RowBox[{"NpotGivenExperiment", "*", 
                  RowBox[{"ProbLLP", "[", 
                   RowBox[{"mLLP", ",", "1", ",", "prod"}], "]"}], "*", 
                  RowBox[{
                   RowBox[{"Interpolation", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"\[Epsilon]GeomTabs", "[", "prod", "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "3"}], "}"}]}], "]"}], "]"}], ",", 
                    RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], 
                   "[", "mLLP", "]"}]}]}], ",", 
                RowBox[{"b", "\[Rule]", 
                 FractionBox["zminExp", 
                  RowBox[{"ldecayLLP", "[", 
                   RowBox[{"mLLP", ",", "1", ",", 
                    RowBox[{"ELLPmax", "[", 
                    RowBox[{"0.5", ",", "\[Theta]minExp", ",", "prod"}], 
                    "]"}]}], "]"}]]}]}], "}"}]}], "]"}], "]"}], "]"}], ")"}], 
         FractionBox["1", "2"]]}]}], ",", 
      RowBox[{"{", 
       RowBox[{"prod", ",", "ProductionList"}], "}"}]}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"ProdTest", "=", 
     RowBox[{"ProductionList", "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"LogLogPlot", "[", 
     RowBox[{
      RowBox[{"Evaluate", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"0.3", 
          RowBox[{"LowerBoundEstimate", "[", 
           RowBox[{"mLLP", ",", "ProdTest"}], "]"}]}], ",", 
         RowBox[{"1.8", 
          RowBox[{"UpperBoundEstimate", "[", 
           RowBox[{"mLLP", ",", "ProdTest"}], "]"}]}]}], "}"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"mLLP", ",", 
        RowBox[{"Max", "[", 
         RowBox[{
          RowBox[{"mLLPmin", "[", "ProdTest", "]"}], ",", "mmin\[Epsilon]"}], 
         "]"}], ",", 
        RowBox[{"Min", "[", 
         RowBox[{
          RowBox[{"mLLPmax", "[", "ProdTest", "]"}], ",", "mmax\[Epsilon]"}], 
         "]"}]}], "}"}], ",", 
      RowBox[{"Frame", "->", "True"}], ",", 
      RowBox[{"ImageSize", "->", "Large"}]}], "]"}]}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.8927045521296835`*^9, 3.892704618398532*^9}, {
   3.892704651576499*^9, 3.892704652867281*^9}, 3.8951292466391563`*^9, {
   3.8972064547512426`*^9, 3.8972064548441195`*^9}, {3.8972065272743893`*^9, 
   3.8972065273639555`*^9}, {3.897208556347765*^9, 3.8972085563922853`*^9}, {
   3.8972086426345124`*^9, 3.897208654173244*^9}, {3.897232414966792*^9, 
   3.8972324175870733`*^9}, {3.8972329876997476`*^9, 3.897233009729268*^9}, {
   3.8972333224369483`*^9, 3.8972333287617497`*^9}, 3.897233684153979*^9, {
   3.8972340069416475`*^9, 3.897234007169805*^9}, {3.897234114920539*^9, 
   3.8972341194170074`*^9}, {3.9027273710668883`*^9, 3.902727371070483*^9}, {
   3.9037896747950044`*^9, 3.903789674805071*^9}, {3.903791118363947*^9, 
   3.9037911183684855`*^9}, {3.9037936813200336`*^9, 3.903793682290308*^9}, {
   3.9049231517292624`*^9, 3.904923157976531*^9}, {3.9049231902009006`*^9, 
   3.904923190656528*^9}, 3.904926376200742*^9, {3.911027289230471*^9, 
   3.9110273124658933`*^9}, {3.9110277505648003`*^9, 3.911027764091008*^9}, 
   3.913866752239462*^9, {3.9138675516462307`*^9, 3.9138675637833986`*^9}, {
   3.9138682212474923`*^9, 3.913868221253111*^9}, {3.9138690439766445`*^9, 
   3.913869043981699*^9}, {3.9138691384932814`*^9, 3.913869147288597*^9}, {
   3.913869202156701*^9, 3.9138692055185556`*^9}, {3.913869239652417*^9, 
   3.9138692400334797`*^9}, {3.913869474546574*^9, 3.913869474546574*^9}, {
   3.913870429970599*^9, 3.913870442530464*^9}, {3.9138744135974054`*^9, 
   3.913874414587882*^9}, {3.9156429963777814`*^9, 3.915642996428277*^9}, {
   3.916391759919177*^9, 3.916391773937995*^9}, {3.916512010716703*^9, 
   3.9165120302839413`*^9}, {3.950669916286352*^9, 3.9506699465145874`*^9}, 
   3.952588251258932*^9, {3.9525885904482136`*^9, 3.952588593098467*^9}},
 CellTags->{
  "Acceptance-computation", "Number-of-events-computation+sensitivity"},
 CellLabel->
  "In[112]:=",ExpressionUUID->"2013639a-846d-4ea2-a0b9-81d0edd1cc67"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Number of events", "Section",
 CellChangeTimes->{{3.9506700572614517`*^9, 3.95067005906571*^9}},
 CellTags->{
  "Acceptance-computation", 
   "Number-of-events-computation+sensitivity"},ExpressionUUID->"e71a519c-1cd2-\
c04d-b006-09b39bbbfbf2"],

Cell[CellGroupData[{

Cell["Number of events - fast", "Subsection",
 CellChangeTimes->{{3.897206442190997*^9, 3.8972064427846107`*^9}, {
  3.905840324777521*^9, 3.905840328994842*^9}},
 CellTags->{
  "Number-of-events-computation+sensitivity", 
   "Acceptance-computation"},ExpressionUUID->"42ab82d5-4d7e-4d06-8eb9-\
6e821b04db69"],

Cell[BoxData[
 RowBox[{"If", "[", 
  RowBox[{"condcontinue", ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"FactorLowerBound", "=", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"MemberQ", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "\"\<ANUBIS-shaft-volume-1\>\"", ",", 
            "\"\<ANUBIS-shaft-volume-2\>\"", ",", 
            "\"\<ANUBIS-shaft-volume-3\>\""}], "}"}], ",", 
          "SelectedExperiment"}], "]"}], "==", "True"}], ",", "0.1", ",", 
       "0.3"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"NeventsDiscret", "[", 
      RowBox[{"m_", ",", "ProdChannel_", ",", "couplinglist_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"NevDiscret", ",", "NpotTimes\[Chi]val", ",", "zshift"}], 
        "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"MemberQ", "[", 
          RowBox[{"ProductionList", ",", "ProdChannel"}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Max", "[", 
             RowBox[{
              RowBox[{"mLLPmin", "[", "ProdChannel", "]"}], ",", 
              "mmin\[Epsilon]"}], "]"}], "<", "m", "<", 
            RowBox[{"Min", "[", 
             RowBox[{
              RowBox[{"mLLPmax", "[", "ProdChannel", "]"}], ",", 
              "mmax\[Epsilon]"}], "]"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"integrandtab", "=", 
             RowBox[{"TableIntegrandDiscret", "[", 
              RowBox[{"m", ",", "ProdChannel", ",", "\"\<True\>\""}], "]"}]}],
             ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"NpotTimes\[Chi]val", "[", "coupling_", "]"}], "=", 
             RowBox[{"NpotGivenExperiment", "*", 
              RowBox[{"ProbLLP", "[", 
               RowBox[{"m", ",", "coupling", ",", "ProdChannel"}], "]"}]}]}], 
            ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"lowerbound", ",", "upperbound"}], "}"}], "=", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"LowerBoundEstimate", "[", 
                RowBox[{"m", ",", "ProdChannel"}], "]"}], ",", 
               RowBox[{"UpperBoundEstimate", "[", 
                RowBox[{"m", ",", "ProdChannel"}], "]"}]}], "}"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"brvis", "=", 
             RowBox[{"BrVis", "[", "m", "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"NevDiscret", "[", "coupling_", "]"}], ":=", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"0.1", "lowerbound"}], "<", "coupling", "<", 
                RowBox[{"(*", "1.5", "*)"}], 
                RowBox[{"2", "upperbound"}]}], ",", 
               RowBox[{
                RowBox[{"NpotTimes\[Chi]val", "[", "coupling", "]"}], "*", 
                "brvis", "*", 
                RowBox[{"sumcompile", "[", 
                 RowBox[{"tableprefac", "[", 
                  RowBox[{"integrandtab", ",", "m", ",", 
                   RowBox[{"c\[Tau]LLP", "[", 
                    RowBox[{"m", ",", "coupling"}], "]"}], ",", "1", ",", 
                   "0."}], "]"}], "]"}]}], ",", "0."}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"m", ",", 
                RowBox[{"couplinglist", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], ",", 
                RowBox[{"NevDiscret", "[", 
                 RowBox[{"couplinglist", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "1", ",", 
                RowBox[{"Length", "[", "couplinglist", "]"}], ",", "1"}], 
               "}"}]}], "]"}]}], ",", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"m", ",", 
               RowBox[{"couplinglist", "[", 
                RowBox[{"[", "i", "]"}], "]"}], ",", "0."}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", 
               RowBox[{"Length", "[", "couplinglist", "]"}], ",", "1"}], 
              "}"}]}], "]"}]}], "]"}], "\[IndentingNewLine]", ",", 
         "\[IndentingNewLine]", 
         RowBox[{
         "Print", "[", "\"\<The given production mode does not exist!\>\"", 
          "]"}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
      "]"}]}]}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.897200964730176*^9, 3.897200965970766*^9}, {
   3.89720118259857*^9, 3.8972011870868115`*^9}, {3.8972012433916793`*^9, 
   3.8972012434804716`*^9}, {3.8972021109080114`*^9, 3.897202111357911*^9}, {
   3.897205130000824*^9, 3.8972051305748835`*^9}, 3.897206599004672*^9, {
   3.8972085445054307`*^9, 3.8972085493226857`*^9}, {3.897208729717713*^9, 
   3.897208782995672*^9}, {3.8972323557542253`*^9, 3.897232355758215*^9}, {
   3.8972325208882675`*^9, 3.897232579312927*^9}, {3.8972330183637056`*^9, 
   3.8972330186824365`*^9}, {3.8972330557477093`*^9, 
   3.8972330786629725`*^9}, {3.8972331885872264`*^9, 
   3.8972331892740192`*^9}, {3.897233372953797*^9, 3.8972334102237387`*^9}, {
   3.897233632248149*^9, 3.8972337068313646`*^9}, {3.897233770343194*^9, 
   3.897233794850586*^9}, {3.897234027583762*^9, 3.897234039222018*^9}, 
   3.902727371095085*^9, {3.903789674824919*^9, 3.9037896748651905`*^9}, {
   3.903790316364489*^9, 3.903790327604648*^9}, 3.903791118373599*^9, {
   3.903793681334241*^9, 3.903793681337234*^9}, {3.903793815495824*^9, 
   3.9037938405670385`*^9}, {3.9110273360582485`*^9, 3.911027382154455*^9}, {
   3.9110275909078875`*^9, 3.9110276162959757`*^9}, {3.911027735769429*^9, 
   3.9110277360519323`*^9}, {3.91102782490703*^9, 3.9110278664472694`*^9}, {
   3.911027908345337*^9, 3.9110279086712365`*^9}, 3.913867583368688*^9, {
   3.9138687734466343`*^9, 3.9138687783364944`*^9}, 3.913869043987434*^9, {
   3.91386913849867*^9, 3.91386914700126*^9}, {3.9138718044634438`*^9, 
   3.9138718044763327`*^9}, {3.9138744265895786`*^9, 
   3.9138744439740767`*^9}, {3.915642996438535*^9, 3.9156429964465075`*^9}, {
   3.9166711739039955`*^9, 3.9166711755719423`*^9}, 3.916678793983737*^9, {
   3.9166791229422555`*^9, 3.916679124073281*^9}, {3.9506699739836617`*^9, 
   3.9506699843970375`*^9}},
 CellTags->{
  "Number-of-events-computation+sensitivity", "Acceptance-computation"},
 CellLabel->
  "In[113]:=",ExpressionUUID->"963c4344-4087-43c6-b6e8-508b30bff543"]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Number of events - slow (using built-in Mathematica functions Interpolation, \
NIntegrate)\
\>", "Subsection",
 CellChangeTimes->{{3.916673042143861*^9, 3.9166730501366386`*^9}},
 CellTags->{
  "Number-of-events-computation+sensitivity", 
   "Acceptance-computation"},ExpressionUUID->"a2111b3d-b948-4362-97ab-\
aedd46e94fb9"],

Cell[BoxData[
 RowBox[{"If", "[", 
  RowBox[{"condcontinue", ",", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Differential", " ", "decay", " ", "probability", " ", 
      FractionBox["1", "ldecay"], 
      RowBox[{"Exp", "[", 
       RowBox[{
        RowBox[{"-", "l"}], "/", "ldecay"}], "]"}]}], ",", " ", 
     RowBox[{
     "where", " ", "l", " ", "is", " ", "expressed", " ", "in", " ", "terms", 
      " ", "of", " ", "the", " ", "longitudinal", " ", "displacement", " ", 
      "z", " ", "and", " ", "polar", " ", "angle", " ", "\[Theta]", " ", "as",
       " ", 
      RowBox[{"z", "/", "cos\[Theta]"}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Differential", " ", "decay", " ", "probability", " ", 
      RowBox[{"(", 
       RowBox[{"1", "/", "ldecay"}], ")"}], 
      RowBox[{"Exp", "[", 
       RowBox[{
        RowBox[{"-", "l"}], "/", "ldecay"}], "]"}]}], ",", " ", 
     RowBox[{
     "where", " ", "l", " ", "is", " ", "expressed", " ", "in", " ", "terms", 
      " ", "of", " ", "the", " ", "longitudinal", " ", "displacement", " ", 
      "z", " ", "and", " ", "polar", " ", "angle", " ", "\[Theta]", " ", "as",
       " ", 
      RowBox[{"z", "/", "cos\[Theta]"}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"PdecayDensity", "[", 
      RowBox[{
      "mLLP_", ",", "coupling_", ",", "\[Theta]LLP_", ",", "ELLP_", ",", 
       "zLLP_"}], "]"}], "=", 
     RowBox[{
      RowBox[{"Exp", "[", 
       RowBox[{
        RowBox[{"-", "zLLP"}], "/", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Cos", "[", "\[Theta]LLP", "]"}], "*", 
          RowBox[{"ldecayLLP", "[", 
           RowBox[{"mLLP", ",", "coupling", ",", "ELLP"}], "]"}]}], ")"}]}], 
       "]"}], "/", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Abs", "[", 
         RowBox[{"Cos", "[", "\[Theta]LLP", "]"}], "]"}], "*", 
        RowBox[{"ldecayLLP", "[", 
         RowBox[{"mLLP", ",", "coupling", ",", "ELLP"}], "]"}]}], ")"}]}]}], 
    ";", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
     "The", " ", "integrand", " ", "determining", " ", "the", " ", 
      "differential", " ", "rate", " ", "for", " ", "events"}], "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"IntegrandLLP", "[", 
        RowBox[{
        "mLLP_", ",", "coupling_", ",", "\[Theta]LLP_", ",", "ELLP_", ",", 
         "zLLP_", ",", "prod"}], "]"}], "=", 
       RowBox[{
        RowBox[{"DoubleDistrLLPint", "[", 
         RowBox[{"mLLP", ",", "\[Theta]LLP", ",", "ELLP", ",", "prod"}], 
         "]"}], "*", 
        RowBox[{"PdecayDensity", "[", 
         RowBox[{
         "mLLP", ",", "coupling", ",", "\[Theta]LLP", ",", "ELLP", ",", 
          "zLLP"}], "]"}], "*", 
        RowBox[{"AzimuthalAcceptanceInt", "[", 
         RowBox[{"\[Theta]LLP", ",", "zLLP"}], "]"}], "*", 
        RowBox[{"DecayAcceptanceInt", "[", 
         RowBox[{"mLLP", ",", "\[Theta]LLP", ",", "ELLP", ",", "zLLP"}], 
         "]"}]}]}], ",", 
      RowBox[{"{", 
       RowBox[{"prod", ",", "ProductionList"}], "}"}]}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"IntegralLLP", "[", 
      RowBox[{"mLLP_", ",", "coupling_", ",", "ProdChannel_"}], "]"}], ":=", 
     RowBox[{"NIntegrate", "[", 
      RowBox[{
       RowBox[{"Abs", "[", 
        RowBox[{
         RowBox[{"IntegrandLLP", "[", 
          RowBox[{"mLLP", ",", "coupling", ",", "\[Theta]LLP", ",", 
           RowBox[{"Exp", "[", "ELLP", "]"}], ",", "zLLP", ",", 
           "ProdChannel"}], "]"}], 
         RowBox[{"Exp", "[", "ELLP", "]"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Theta]LLP", ",", "\[Theta]minExp", ",", "\[Theta]maxExp"}],
         "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"ELLP", ",", 
         RowBox[{"Log", "[", "mLLP", "]"}], ",", 
         RowBox[{"Log", "[", 
          RowBox[{"ELLPmax", "[", 
           RowBox[{"mLLP", ",", "\[Theta]LLP", ",", "ProdChannel"}], "]"}], 
          "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"zLLP", ",", 
         RowBox[{"zmin\[Theta]", "[", "\[Theta]LLP", "]"}], ",", 
         RowBox[{"zmax\[Theta]", "[", "\[Theta]LLP", "]"}]}], "}"}], ",", 
       RowBox[{"Method", "\[Rule]", "\"\<AdaptiveMonteCarlo\>\""}]}], "]"}]}],
     ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"NeventsInt", "[", 
      RowBox[{"mLLP_", ",", "coupling_", ",", "ProdChannel_"}], "]"}], ":=", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"mLLPmin", "[", "ProdChannel", "]"}], "\[LessEqual]", "mLLP",
          "\[LessEqual]", 
         RowBox[{"mLLPmax", "[", "ProdChannel", "]"}]}], "&&", 
        RowBox[{
         RowBox[{"BrVis", "[", "mLLP", "]"}], "!=", "0"}]}], ",", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"0.1", 
           RowBox[{"LowerBoundEstimate", "[", 
            RowBox[{"mLLP", ",", "ProdChannel"}], "]"}]}], "<", "coupling", 
          "<", 
          RowBox[{"2", 
           RowBox[{"UpperBoundEstimate", "[", 
            RowBox[{"mLLP", ",", "ProdChannel"}], "]"}]}]}], ",", 
         RowBox[{"NpotGivenExperiment", "*", 
          RowBox[{"ProbLLP", "[", 
           RowBox[{"mLLP", ",", "coupling", ",", "ProdChannel"}], "]"}], "*", 
          RowBox[{"IntegralLLP", "[", 
           RowBox[{"mLLP", ",", "coupling", ",", "ProdChannel"}], "]"}]}], 
         ",", "0."}], "]"}], ",", "0."}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"IntegralLLPE", "[", 
      RowBox[{"mLLP_", ",", "coupling_", ",", "ProdChannel_", ",", "ELLP_"}], 
      "]"}], ":=", 
     RowBox[{"NIntegrate", "[", 
      RowBox[{
       RowBox[{"Abs", "[", 
        RowBox[{"IntegrandLLP", "[", 
         RowBox[{
         "mLLP", ",", "coupling", ",", "\[Theta]LLP", ",", "ELLP", ",", 
          "zLLP", ",", "ProdChannel"}], "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Theta]LLP", ",", "\[Theta]minExp", ",", "\[Theta]maxExp"}],
         "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"zLLP", ",", 
         RowBox[{"zmin\[Theta]", "[", "\[Theta]LLP", "]"}], ",", 
         RowBox[{"zmax\[Theta]", "[", "\[Theta]LLP", "]"}]}], "}"}], ",", 
       RowBox[{"Method", "\[Rule]", "\"\<AdaptiveMonteCarlo\>\""}]}], "]"}]}],
     ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"NeventsDiffInt", "[", 
      RowBox[{"mLLP_", ",", "coupling_", ",", "ProdChannel_", ",", "ELLP_"}], 
      "]"}], ":=", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"mLLPmin", "[", "ProdChannel", "]"}], "\[LessEqual]", "mLLP",
          "\[LessEqual]", 
         RowBox[{"mLLPmax", "[", "ProdChannel", "]"}]}], "&&", 
        RowBox[{
         RowBox[{"BrVis", "[", "mLLP", "]"}], "!=", "0"}], "&&", 
        RowBox[{"mLLP", "<", "ELLP", "<=", 
         RowBox[{"ELLPmax", "[", 
          RowBox[{"mLLP", ",", "\[Theta]minExp", ",", "ProdChannel"}], 
          "]"}]}]}], ",", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"0.1", 
           RowBox[{"LowerBoundEstimate", "[", 
            RowBox[{"mLLP", ",", "ProdChannel"}], "]"}]}], "<", "coupling", 
          "<", 
          RowBox[{"2", 
           RowBox[{"UpperBoundEstimate", "[", 
            RowBox[{"mLLP", ",", "ProdChannel"}], "]"}]}]}], ",", 
         RowBox[{"NpotGivenExperiment", "*", 
          RowBox[{"ProbLLP", "[", 
           RowBox[{"mLLP", ",", "coupling", ",", "ProdChannel"}], "]"}], "*", 
          RowBox[{"IntegralLLPE", "[", 
           RowBox[{"mLLP", ",", "coupling", ",", "ProdChannel", ",", "ELLP"}],
            "]"}]}], ",", "0."}], "]"}], ",", "0."}], "]"}]}]}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.9167656467381687`*^9, 3.9167657391983356`*^9}, {
  3.916765918065031*^9, 3.9167659215606313`*^9}, {3.9167662758901176`*^9, 
  3.916766280761902*^9}, {3.9506699913189754`*^9, 3.950670001542305*^9}},
 CellTags->{
  "Number-of-events-computation+sensitivity", "Acceptance-computation"},
 CellLabel->
  "In[114]:=",ExpressionUUID->"46f4d46b-66b1-4ab0-8fc9-e4f181080153"]
}, Closed]],

Cell[CellGroupData[{

Cell["Differential number of events", "Subsection",
 CellChangeTimes->{{3.892111289211891*^9, 3.892111293865343*^9}},
 CellTags->
  "Number-of-events-computation+sensitivity",ExpressionUUID->"748b8b59-c490-\
462f-bf37-7dc6537c8d0d"],

Cell[BoxData[
 RowBox[{"If", "[", 
  RowBox[{"condcontinue", ",", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "Variable", " ", "=", " ", 
      "\"\<\!\(\*SubscriptBox[\(E\), \(X\)]\)\>\""}], ",", 
     "\"\<\!\(\*SubscriptBox[\(z\), \(X\)]\)\>\"", ",", 
     RowBox[{
      RowBox[{
      "\"\<\!\(\*SubscriptBox[\(\[Theta]\), \(X\)]\)\>\"", ".", " ", "The"}], 
      " ", "number", " ", "belongs", " ", "to", " ", "the", " ", "column", 
      " ", "in", " ", "the", " ", "tabulated", " ", "data"}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"iVal", ":=", 
     RowBox[{"Association", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
        "\"\<\!\(\*SubscriptBox[\(E\), \(LLP\)]\)\>\"", " ", "\[Rule]", "2"}],
         ",", 
        RowBox[{
        "\"\<\!\(\*SubscriptBox[\(\[Theta]\), \(LLP\)]\)\>\"", "\[Rule]", 
         "1"}], ",", 
        RowBox[{
        "\"\<\!\(\*SubscriptBox[\(z\), \(LLP\)]\)\>\"", "\[Rule]", "3"}]}], 
       "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
     "\[CapitalDelta]xvals", "[", 
      "\"\<\!\(\*SubscriptBox[\(E\), \(LLP\)]\)\>\"", "]"}], ":=", 
     "\[CapitalDelta]Evals"}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
     "\[CapitalDelta]xvals", "[", 
      "\"\<\!\(\*SubscriptBox[\(z\), \(LLP\)]\)\>\"", "]"}], "=", 
     "\[CapitalDelta]zvals"}], ";", "\[IndentingNewLine]", 
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"\[CapitalDelta]xvals", "[", 
        RowBox[{
        "\"\<\!\(\*SubscriptBox[\(\[Theta]\), \(X\)]\)\>\"", ",", "prod"}], 
        "]"}], "=", 
       RowBox[{"\[CapitalDelta]\[Theta]vals", "[", "prod", "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"prod", ",", "ProductionList"}], "}"}]}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"LegendX", ":=", 
     RowBox[{"Association", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
        "\"\<\!\(\*SubscriptBox[\(E\), \(LLP\)]\)\>\"", "\[Rule]", 
         "\"\<\!\(\*SubscriptBox[\(E\), \(LLP\)]\) [GeV]\>\""}], ",", 
        RowBox[{
        "\"\<\!\(\*SubscriptBox[\(\[Theta]\), \(LLP\)]\)\>\"", "\[Rule]", 
         "\"\<\!\(\*SubscriptBox[\(\[Theta]\), \(LLP\)]\) [rad]\>\""}], ",", 
        RowBox[{
        "\"\<\!\(\*SubscriptBox[\(z\), \(LLP\)]\)\>\"", "\[Rule]", " ", 
         "\"\<\!\(\*SubscriptBox[\(z\), \(LLP\)]\) [m]\>\""}]}], "}"}], 
      "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"LegendY", ":=", 
     RowBox[{"Association", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
        "\"\<\!\(\*SubscriptBox[\(E\), \(LLP\)]\)\>\"", "\[Rule]", 
         "\"\<\!\(\*SubscriptBox[\(dN\), \(ev\)]\)/\!\(\*SubscriptBox[\(dE\), \
\(LLP\)]\) [\!\(\*SuperscriptBox[\(GeV\), \(-1\)]\)]\>\""}], ",", 
        RowBox[{
        "\"\<\!\(\*SubscriptBox[\(\[Theta]\), \(LLP\)]\)\>\"", "\[Rule]", 
         "\"\<\!\(\*SubscriptBox[\(dN\), \(ev\)]\)/\!\(\*SubscriptBox[\(d\
\[Theta]\), \(LLP\)]\) [\!\(\*SuperscriptBox[\(rad\), \(-1\)]\)]\>\""}], ",", 
        RowBox[{
        "\"\<\!\(\*SubscriptBox[\(z\), \(LLP\)]\)\>\"", "\[Rule]", " ", 
         "\"\<\!\(\*SubscriptBox[\(dN\), \(ev\)]\)/\!\(\*SubscriptBox[\(dz\), \
\(LLP\)]\) [\!\(\*SuperscriptBox[\(m\), \(-1\)]\)]\>\""}]}], "}"}], "]"}]}], 
    ";", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"Differential", " ", "number", " ", "of", " ", "events"}], 
     "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"NeventsDifferentialDiscretProd", "[", 
      RowBox[{"m_", ",", "ProdChannel_", ",", "coupling_", ",", "Variable_"}],
       "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "NpotTimes\[Chi]val", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ival", "=", 
         RowBox[{"iVal", "[", "Variable", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"NpotTimes\[Chi]val", "=", 
         RowBox[{"NpotGivenExperiment", "*", 
          RowBox[{"ProbLLP", "[", 
           RowBox[{"m", ",", "coupling", ",", "ProdChannel"}], "]"}]}]}], ";",
         "\[IndentingNewLine]", 
        RowBox[{"tablegrid0", "=", 
         RowBox[{"TableIntegrandDiscret", "[", 
          RowBox[{"m", ",", "ProdChannel", ",", "\"\<True\>\""}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"OutGridEfinalTemp", "=", 
         RowBox[{"OutGridEnergy", "[", 
          RowBox[{
           RowBox[{"N", "[", "m", "]"}], ",", "ProdChannel"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"\[CapitalDelta]Evals", "=", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Rest", "[", 
            SuperscriptBox["10", "OutGridEfinalTemp"], "]"}], "-", 
           RowBox[{"Most", "[", 
            SuperscriptBox["10", "OutGridEfinalTemp"], "]"}]}], ")"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"\[CapitalDelta]xval", "=", 
         RowBox[{"\[CapitalDelta]xvals", "[", "Variable", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"c\[Tau]Val", "=", 
         RowBox[{"c\[Tau]LLP", "[", 
          RowBox[{"m", ",", "coupling"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"brvis", "=", 
         RowBox[{"BrVis", "[", "m", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"ilist", "=", 
         RowBox[{"DeleteDuplicates", "[", 
          RowBox[{"{", 
           RowBox[{"ival", ",", "1", ",", "2", ",", "3"}], "}"}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"tablegrid1", "=", 
         RowBox[{"SortBy", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"#", "[", 
                RowBox[{"[", 
                 RowBox[{"ilist", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], ",", 
               RowBox[{"#", "[", 
                RowBox[{"[", 
                 RowBox[{"ilist", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}], ",", 
               RowBox[{"#", "[", 
                RowBox[{"[", 
                 RowBox[{"ilist", "[", 
                  RowBox[{"[", "3", "]"}], "]"}], "]"}], "]"}], ",", 
               RowBox[{"#", "[", 
                RowBox[{"[", "4", "]"}], "]"}]}], "}"}], "&"}], "/@", 
            RowBox[{"tableGridPrefac", "[", 
             RowBox[{"tablegrid0", ",", "m", ",", "c\[Tau]Val", ",", "0."}], 
             "]"}]}], ",", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"#", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", 
              RowBox[{"#", "[", 
               RowBox[{"[", "2", "]"}], "]"}], ",", 
              RowBox[{"#", "[", 
               RowBox[{"[", "3", "]"}], "]"}]}], "}"}], "&"}]}], "]"}]}], ";",
         "\[IndentingNewLine]", 
        RowBox[{"GridQuantity", "=", 
         RowBox[{
          RowBox[{"tablegrid1", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "1"}], "]"}], "]"}], "//", 
          "DeleteDuplicates"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"LengthPerVariable", "=", 
         RowBox[{
          RowBox[{"Length", "[", "tablegrid1", "]"}], "/", 
          RowBox[{"Length", "[", "GridQuantity", "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"tab1", "=", 
         RowBox[{"NdiffCompiled", "[", 
          RowBox[{
          "tablegrid1", ",", "GridQuantity", ",", "LengthPerVariable", ",", 
           RowBox[{"NpotTimes\[Chi]val", "*", "brvis"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"tab1", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", 
             RowBox[{"{", "1", "}"}]}], "]"}], "]"}], ",", 
          RowBox[{"Partition", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"tab1", "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", "2"}], "]"}], "]"}], "*", 
             SuperscriptBox["\[CapitalDelta]xval", 
              RowBox[{"-", "1"}]]}], ",", "1"}], "]"}], ",", "2"}], "]"}]}]}],
       "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"NeventsDifferentialDiscret", "[", 
      RowBox[{"m_", ",", "coupling_", ",", "Variable_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "NdiffInt", ",", "LegendList", ",", "QuantityMinMax", ",", 
         "ValueMinMax"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"prodlisttemp", "=", 
         RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Do", "[", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Max", "[", 
              RowBox[{
               RowBox[{"mLLPmin", "[", "prod", "]"}], ",", "mmin\[Epsilon]"}],
               "]"}], "<", "m", "<", 
             RowBox[{"Min", "[", 
              RowBox[{
               RowBox[{"mLLPmax", "[", "prod", "]"}], ",", "mmax\[Epsilon]"}],
               "]"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"prodlisttemp", "=", 
              RowBox[{"Join", "[", 
               RowBox[{"prodlisttemp", ",", 
                RowBox[{"{", "prod", "}"}]}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"NdiffData", "[", "prod", "]"}], "=", 
              RowBox[{"NeventsDifferentialDiscretProd", "[", 
               RowBox[{"m", ",", "prod", ",", "coupling", ",", "Variable"}], 
               "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"XvalminmaxNdiff", "=", 
              RowBox[{
               RowBox[{
                RowBox[{"Select", "[", 
                 RowBox[{
                  RowBox[{"NdiffData", "[", "prod", "]"}], ",", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ">", 
                    SuperscriptBox["10", 
                    RowBox[{"-", "40"}]]}], "&"}]}], "]"}], "[", 
                RowBox[{"[", 
                 RowBox[{"All", ",", "1"}], "]"}], "]"}], "//", "MinMax"}]}], 
             ";", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"NdiffInt", "[", 
               RowBox[{"X_", ",", "prod"}], "]"}], "=", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"XvalminmaxNdiff", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "<", "X", "<", 
                 RowBox[{"XvalminmaxNdiff", "[", 
                  RowBox[{"[", "2", "]"}], "]"}]}], ",", 
                RowBox[{"Evaluate", "[", 
                 RowBox[{"10", "^", 
                  RowBox[{
                   RowBox[{"Interpolation", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Log10", "[", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Log10", "[", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "+", 
                    SuperscriptBox["10", 
                    RowBox[{"-", "90"}]]}], "]"}]}], "}"}], "&"}], "/@", 
                    RowBox[{"NdiffData", "[", "prod", "]"}]}], ",", 
                    RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], 
                   "[", 
                   RowBox[{"Log10", "[", "X", "]"}], "]"}]}], "]"}], ",", 
                "0"}], "]"}]}]}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"prod", ",", "ProductionListBaseline"}], "}"}]}], "]"}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"NdiffInt", "[", 
          RowBox[{"X_", ",", "\"\<Total\>\""}], "]"}], "=", 
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{"NdiffInt", "[", 
            RowBox[{"X", ",", "prod"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"prod", ",", "prodlisttemp"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"LegendList", "=", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"{", "\"\<Total\>\"", "}"}], ",", "prodlisttemp"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"QuantityMinMax", "=", 
         RowBox[{
          RowBox[{"Flatten", "[", 
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"MinMax", "[", 
               RowBox[{
                RowBox[{"NdiffData", "[", "prod", "]"}], "[", 
                RowBox[{"[", 
                 RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"prod", ",", "prodlisttemp"}], "}"}]}], "]"}], ",", 
            "1"}], "]"}], "//", "MinMax"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"ValueMinMax", "=", 
         RowBox[{"Max", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Max", "[", 
             RowBox[{
              RowBox[{"NdiffData", "[", "#", "]"}], "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}], "&"}], "/@", 
           "prodlisttemp"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"NdiffInt", "[", 
             RowBox[{"X", ",", "prod"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"prod", ",", "LegendList"}], "}"}]}], "]"}], ",", 
          "LegendList", ",", "QuantityMinMax", ",", "ValueMinMax"}], 
         "}"}]}]}], "\[IndentingNewLine]", "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"mvaltest", "=", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"FacilityGivenExperiment", "==", "\"\<ESS\>\""}], ",", "0.04", 
       ",", "0.3"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"couplingvaltest", "=", 
     RowBox[{"3", "*", 
      RowBox[{"LowerBoundEstimate", "[", 
       RowBox[{"mvaltest", ",", "\"\<EtaPr\>\""}], "]"}]}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"quantity", "=", "\"\<\!\(\*SubscriptBox[\(E\), \(LLP\)]\)\>\""}],
     ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"NdiffTab", "[", "X_", "]"}], ",", "LegendList", ",", 
       "QuantityMinMax", ",", "ValueMinMax"}], "}"}], "=", 
     RowBox[{"NeventsDifferentialDiscret", "[", 
      RowBox[{"mvaltest", ",", "couplingvaltest", ",", "quantity"}], "]"}]}], 
    ";", "\[IndentingNewLine]", 
    RowBox[{"Do", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"prch", "=", 
        RowBox[{"LegendList", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"NdiffInt", "[", 
         RowBox[{"X_", ",", "prch"}], "]"}], "=", 
        RowBox[{
         RowBox[{"NdiffTab", "[", "X", "]"}], "[", 
         RowBox[{"[", "i", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", 
        RowBox[{"Length", "[", "LegendList", "]"}]}], "}"}]}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"plotdiff", "=", 
     RowBox[{"LogLogPlot", "[", 
      RowBox[{
       RowBox[{"Evaluate", "[", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"NdiffInt", "[", 
           RowBox[{"X", ",", "prod"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"prod", ",", "LegendList"}], "}"}]}], "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"X", ",", 
         RowBox[{"QuantityMinMax", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", 
         RowBox[{"QuantityMinMax", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"Frame", "\[Rule]", "True"}], ",", 
       RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
       RowBox[{"PlotRange", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"All", ",", 
          RowBox[{"{", 
           RowBox[{
            SuperscriptBox["10", 
             RowBox[{"-", "5"}]], ",", 
            RowBox[{"2", "ValueMinMax"}]}], "}"}]}], "}"}]}], ",", 
       RowBox[{"PlotStyle", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"Thick", ",", "Black", ",", 
            RowBox[{"Dashing", "[", "0.02", "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"Thick", ",", 
            RowBox[{"Lighter", "@", "Blue"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"Thick", ",", 
            RowBox[{"Darker", "@", "Red"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"Thick", ",", 
            RowBox[{"Darker", "@", 
             RowBox[{"Darker", "@", "Green"}]}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"Thick", ",", 
            RowBox[{"Darker", "@", "Cyan"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"Thick", ",", "Magenta"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"Thick", ",", 
            RowBox[{"Lighter", "@", "Blue"}], ",", 
            RowBox[{"Dashing", "[", "0.02", "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"Thick", ",", 
            RowBox[{"Darker", "@", "Red"}], ",", 
            RowBox[{"Dashing", "[", "0.02", "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"Thick", ",", 
            RowBox[{"Darker", "@", 
             RowBox[{"Darker", "@", "Green"}]}], ",", 
            RowBox[{"Dashing", "[", "0.02", "]"}]}], "}"}]}], "}"}]}], ",", 
       RowBox[{"PlotLegends", "\[Rule]", 
        RowBox[{"Placed", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Style", "[", 
             RowBox[{"#", ",", "16"}], "]"}], "&"}], "/@", 
           RowBox[{"(", 
            RowBox[{"LegendList", "/.", 
             RowBox[{"{", 
              RowBox[{
              "\"\<Bremsstrahlung-AP-Central\>\"", "->", 
               "\"\<Bremsstrahlung\>\""}], "}"}]}], ")"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"0.82", ",", "0.7"}], "}"}]}], "]"}]}], ",", 
       RowBox[{"FrameLabel", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"LegendX", "[", "quantity", "]"}], " ", ",", 
          RowBox[{"LegendY", "[", "quantity", "]"}]}], "}"}]}], ",", 
       RowBox[{"FrameStyle", "\[Rule]", 
        RowBox[{"Directive", "[", 
         RowBox[{"Black", ",", " ", "18"}], "]"}]}], ",", 
       RowBox[{"PlotLabel", "\[Rule]", 
        RowBox[{"Style", "[", 
         RowBox[{
          RowBox[{"Row", "[", 
           RowBox[{"{", 
            RowBox[{
            "SelectedExperiment", ",", 
             "\"\<. \!\(\*SubscriptBox[\(m\), \(LLP\)]\) = \>\"", ",", 
             "mvaltest", ",", 
             "\"\< GeV, y = 2\!\(\*SubscriptBox[\(v\), \
\(h\)]\)/\!\(\*SubscriptBox[\(f\), \(a\)]\) = \>\"", ",", 
             RowBox[{"couplingvaltest", "//", "N"}]}], "}"}], "]"}], ",", 
          "18", ",", "Black"}], "]"}]}]}], "]"}]}]}]}], "\[IndentingNewLine]",
   "]"}]], "Input",
 CellChangeTimes->{{3.8921163996135225`*^9, 3.8921164016036096`*^9}, {
   3.8921164560955544`*^9, 3.892116475031265*^9}, {3.892116516434699*^9, 
   3.8921165782759094`*^9}, {3.8921166461579666`*^9, 
   3.8921166470109124`*^9}, {3.8921167042134895`*^9, 3.892116729930051*^9}, {
   3.8927049818255663`*^9, 3.8927049991222277`*^9}, {3.8929115471019087`*^9, 
   3.892911593659387*^9}, {3.8929721720425777`*^9, 3.892972173350433*^9}, {
   3.8929722208773427`*^9, 3.8929722211847763`*^9}, {3.8932578131000147`*^9, 
   3.893257813645747*^9}, {3.8934746693595037`*^9, 3.893474675301323*^9}, {
   3.8935154039618015`*^9, 3.893515450284458*^9}, {3.893515943430369*^9, 
   3.893515962817915*^9}, 3.893516005738713*^9, {3.893516036174548*^9, 
   3.893516050479193*^9}, {3.893516088577403*^9, 3.893516089018369*^9}, {
   3.893516189974946*^9, 3.8935161902213464`*^9}, {3.8935162352543807`*^9, 
   3.8935162734266047`*^9}, {3.893516595793399*^9, 3.893516611219179*^9}, {
   3.893606026577932*^9, 3.8936060575609436`*^9}, 3.8955578364377675`*^9, {
   3.8969794021337876`*^9, 3.89697940417612*^9}, {3.897206579842867*^9, 
   3.897206594529684*^9}, {3.8972085445254173`*^9, 3.8972085493347607`*^9}, {
   3.897208919899889*^9, 3.897208931547951*^9}, {3.897232355781791*^9, 
   3.8972323557889285`*^9}, {3.897232650441552*^9, 3.8972326556138897`*^9}, {
   3.8972334458167295`*^9, 3.8972334518776407`*^9}, {3.8972337389260225`*^9, 
   3.8972337484870095`*^9}, {3.8972341759970245`*^9, 3.8972341805239077`*^9}, 
   3.9027273711383595`*^9, 3.903790322052125*^9, 3.9037911184037747`*^9, {
   3.90379388260617*^9, 3.90379391368436*^9}, {3.903793985440897*^9, 
   3.9037939966975904`*^9}, {3.903806138641766*^9, 3.9038061415710564`*^9}, {
   3.9049234022965193`*^9, 3.904923404719922*^9}, {3.9049234552044992`*^9, 
   3.9049234557077*^9}, {3.905241298600586*^9, 3.905241322456391*^9}, 
   3.9138675833998885`*^9, {3.9138682129108057`*^9, 3.9138682129163513`*^9}, {
   3.9138687734647865`*^9, 3.9138687783481526`*^9}, {3.913868990884107*^9, 
   3.9138689908925776`*^9}, 3.9138690440046268`*^9, {3.913871804520094*^9, 
   3.9138718176925616`*^9}, {3.913874095556819*^9, 3.913874098948403*^9}, {
   3.913877232309046*^9, 3.91387723268427*^9}, {3.9138796546092234`*^9, 
   3.91387965462405*^9}, {3.913881645619234*^9, 3.913881646128089*^9}, {
   3.9138817045526066`*^9, 3.9138817092702045`*^9}, {3.9144962634466343`*^9, 
   3.9144962636579084`*^9}, {3.9156429967325897`*^9, 
   3.9156429967532835`*^9}, {3.916289412312564*^9, 3.9162896164655113`*^9}, {
   3.9162896759598684`*^9, 3.916289806201638*^9}, 3.9163945964185715`*^9, {
   3.916395341223231*^9, 3.916395345479702*^9}, {3.9163954358459415`*^9, 
   3.9163954767547026`*^9}, 3.9165075760329185`*^9, 3.9165076364486437`*^9, {
   3.91650772903246*^9, 3.9165077581477613`*^9}, {3.9165115197870893`*^9, 
   3.9165115201957626`*^9}, {3.9165121382558374`*^9, 3.916512144983124*^9}, {
   3.9165122548977995`*^9, 3.916512283348137*^9}, {3.916646757115737*^9, 
   3.9166467592929344`*^9}, {3.916671907731246*^9, 3.9166719140582223`*^9}, {
   3.9166733010223756`*^9, 3.9166733176246023`*^9}, {3.9167651509492083`*^9, 
   3.9167653510067854`*^9}, {3.916765494084095*^9, 3.9167655028579893`*^9}, {
   3.9168061151569767`*^9, 3.91680611529914*^9}, {3.916808195709697*^9, 
   3.9168082014717283`*^9}, 3.9168550009720397`*^9, {3.950670118329479*^9, 
   3.9506701973078785`*^9}, 3.952588251289137*^9, {3.952588917553013*^9, 
   3.952588928852854*^9}, 3.952588961457947*^9, {3.952588994338297*^9, 
   3.9525889950079193`*^9}},
 CellTags->"Number-of-events-computation+sensitivity",
 CellLabel->
  "In[115]:=",ExpressionUUID->"46c1a4a5-1c46-489a-a061-206c6b7873bc"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Tests", "Section",
 CellChangeTimes->{{3.8972012736109533`*^9, 3.897201275449023*^9}, {
  3.9165074771770973`*^9, 3.916507477391102*^9}, {3.9166730568371887`*^9, 
  3.916673057524472*^9}},ExpressionUUID->"d97cf69b-14d7-4226-84be-\
25aa41979380"],

Cell[CellGroupData[{

Cell["Total number of events", "Subsection",
 CellChangeTimes->{{3.9166731223415008`*^9, 
  3.9166731263809366`*^9}},ExpressionUUID->"8b643ea4-d4cf-439d-bf42-\
7d3cf2368f19"],

Cell[BoxData[
 RowBox[{"If", "[", 
  RowBox[{"condcontinue", ",", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "This", " ", "is", " ", "a", " ", "comparison", " ", "between", " ", 
      "the", " ", "slow", " ", "and", " ", "fast", " ", "integration", " ", 
      RowBox[{"methods", ".", " ", "For"}], " ", "the", " ", "selected", " ", 
      "mass", " ", "and", " ", "production", " ", "channel"}], ",", " ", 
     RowBox[{
     "the", " ", "numbers", " ", "of", " ", "events", " ", "obtained", " ", 
      "using", " ", "the", " ", "methods", " ", "should", " ", "agree", " ", 
      "within", " ", "10", "%"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"If", " ", "the", " ", "agreement", " ", "is", " ", "worse"}], 
     ",", " ", 
     RowBox[{
     "there", " ", "may", " ", "be", " ", "a", " ", "few", " ", "reasons"}]}],
     "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"1", ")"}], " ", "The", " ", "grid", " ", "for", " ", "the", 
      " ", "fast", " ", "method", " ", "is", " ", "not", " ", "dense", " ", 
      RowBox[{"enough", ".", " ", "Try"}], " ", "to", " ", "increase", " ", 
      "the", " ", "grid", " ", "density", " ", 
      RowBox[{"(", 
       RowBox[{
       "OutGrid\[Theta]final", ",", " ", "OutGridEfinal", ",", " ", 
        "OutGridzfinal"}], ")"}], " ", "to", " ", "see", " ", "whether", " ", 
      "the", " ", "agreement", " ", 
      RowBox[{"improves", ".", " ", "Sometimes"}]}], ",", " ", 
     RowBox[{
     "even", " ", "a", " ", "slightly", " ", "denser", " ", "grid", " ", 
      "for", " ", 
      RowBox[{"e", ".", "g", ".", " ", "z"}], " ", "may", " ", "lead", " ", 
      "to", " ", "a", " ", "significant", " ", "improvement", " ", "in", " ", 
      "the", " ", "agrement"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"2", ")"}], " ", "The", " ", "Monte"}], "-", 
       RowBox[{
       "Carlo", " ", "integrator", " ", "for", " ", "the", " ", "slow", " ", 
        "method", " ", "fails", " ", "to", " ", "evaluate", " ", 
        "properly"}]}], ";", " ", 
      RowBox[{
      "this", " ", "may", " ", "happen", " ", "if", " ", "the", " ", "range", 
       " ", "of", " ", "the", " ", "integration", " ", "over", " ", 
       "energies", " ", "is", " ", "too", " ", "large", " ", "compared", " ", 
       "to", " ", "the", " ", "domain", " ", "where", " ", "most", " ", "of", 
       " ", "the", " ", "events", " ", "actually", " ", "are", " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"off", "-", 
          RowBox[{
          "axis", " ", "experiments", " ", "such", " ", "as", " ", "MATHUSLA",
            " ", "and", " ", "ANUBIS"}]}], ")"}], ".", " ", "Another"}], " ", 
       "symptom", " ", "is", " ", "that", " ", "for", " ", "the", " ", 
       "given", " ", "mass", " ", "and", " ", "coupling", " ", "the", " ", 
       "integral", " ", "\"\<jumps\>\""}]}], ",", " ", 
     RowBox[{"i", ".", "e", "."}], ",", " ", 
     RowBox[{
     "returns", " ", "values", " ", "with", " ", "large", " ", "error"}]}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "A", " ", "separate", " ", "discussion", " ", "should", " ", "be", " ", 
      "made", " ", "for", " ", "the", " ", "couplings", " ", "belong", " ", 
      "to", " ", "the", " ", "domain", " ", "c\[Tau]", " ", "\[Gamma]", " ", 
      RowBox[{
       RowBox[{"<<", " ", 
        SubscriptBox["z", "experiment"]}], ".", " ", "The"}], " ", 
      "discrepancy", " ", "may", " ", "be", " ", "significant"}], ",", " ", 
     RowBox[{
     "and", " ", "the", " ", "reason", " ", "is", " ", "insufficient", " ", 
      "grid", " ", "density", " ", "for", " ", "the", " ", "fast", " ", 
      "integration", " ", 
      RowBox[{"method", ".", " ", "However"}]}], ",", " ", 
     RowBox[{
     "due", " ", "to", " ", "the", " ", "exponential", " ", "suppression", 
      " ", "of", " ", "the", " ", "number", " ", "of", " ", "events"}], ",", 
     " ", 
     RowBox[{
     "this", " ", "may", " ", "be", " ", "compensated", " ", "by", " ", "a", 
      " ", "tiny", " ", "shift", " ", "in", " ", "the", " ", "coupling"}], 
     ",", " ", 
     RowBox[{
     "so", " ", "the", " ", "discrepancy", " ", "should", " ", "be", " ", 
      "considered", " ", "as", " ", 
      RowBox[{"appropriate", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ProdTest", "=", 
     RowBox[{"ProductionList", "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"mtest", "=", 
     RowBox[{"Max", "[", 
      RowBox[{
       FractionBox[
        RowBox[{
         RowBox[{"mLLPmax", "[", "ProdTest", "]"}], "+", 
         RowBox[{"mLLPmin", "[", "ProdTest", "]"}]}], "2"], ",", 
       RowBox[{"1.2", "*", "mmin\[Epsilon]"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"couplinglist", "=", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         SuperscriptBox["10", 
          RowBox[{"-", "12"}]], ",", 
         RowBox[{"3", "*", 
          SuperscriptBox["10", 
           RowBox[{"-", "12"}]]}], ",", 
         RowBox[{"5", "*", 
          SuperscriptBox["10", 
           RowBox[{"-", "12"}]]}], ",", 
         SuperscriptBox["10", 
          RowBox[{"-", "11"}]], ",", 
         RowBox[{"5", "*", 
          SuperscriptBox["10", 
           RowBox[{"-", "11"}]]}], ",", 
         SuperscriptBox["10", 
          RowBox[{"-", "10"}]], ",", 
         RowBox[{"5", "*", 
          SuperscriptBox["10", 
           RowBox[{"-", "10"}]]}], ",", 
         SuperscriptBox["10", 
          RowBox[{"-", "9"}]], ",", 
         RowBox[{"5", "*", 
          SuperscriptBox["10", 
           RowBox[{"-", "9"}]]}], ",", 
         SuperscriptBox["10", 
          RowBox[{"-", "8"}]], ",", 
         RowBox[{"2", "*", 
          SuperscriptBox["10", 
           RowBox[{"-", "8"}]]}], ",", 
         RowBox[{"4", "*", 
          SuperscriptBox["10", 
           RowBox[{"-", "8"}]]}], ",", 
         SuperscriptBox["10", 
          RowBox[{"-", "7"}]], ",", 
         RowBox[{"5", "*", 
          SuperscriptBox["10", 
           RowBox[{"-", "7"}]]}], ",", 
         RowBox[{"6", "*", 
          SuperscriptBox["10", 
           RowBox[{"-", "7"}]]}], ",", 
         RowBox[{"7", "*", 
          SuperscriptBox["10", 
           RowBox[{"-", "7"}]]}], ",", 
         RowBox[{"8", "*", 
          SuperscriptBox["10", 
           RowBox[{"-", "7"}]]}], ",", 
         RowBox[{"9", "*", 
          SuperscriptBox["10", 
           RowBox[{"-", "7"}]]}], ",", 
         SuperscriptBox["10", 
          RowBox[{"-", "6"}]], ",", 
         RowBox[{"2", "*", 
          SuperscriptBox["10", 
           RowBox[{"-", "6"}]]}]}], "}"}], "//", "N"}], "*)"}], 
     RowBox[{"Table", "[", 
      RowBox[{
       SuperscriptBox["10", "x"], ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", 
         RowBox[{"-", "7.5"}], ",", 
         RowBox[{"-", "0.3"}], ",", "0.1"}], "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"dat1", "=", 
     RowBox[{"NeventsDiscret", "[", 
      RowBox[{"mtest", ",", "ProdTest", ",", "couplinglist"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"dat2", "=", 
     RowBox[{"ParallelTable", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"couplinglist", "[", 
          RowBox[{"[", "i", "]"}], "]"}], ",", 
         RowBox[{"c\[Tau]LLP", "[", 
          RowBox[{"mtest", ",", 
           RowBox[{"couplinglist", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
         RowBox[{"NeventsInt", "[", 
          RowBox[{"mtest", ",", 
           RowBox[{"couplinglist", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", "ProdTest"}], "]"}]}], "}"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "couplinglist", "]"}], ",", "1"}], "}"}]}], 
      "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{
         "\"\<\!\(\*FractionBox[SubscriptBox[\(m\), \(LLP\)], \(GeV\)]\)\>\"",
           ",", "\"\<coupling\>\"", ",", 
          "\"\<\!\(\*FractionBox[\(c\[Tau]\), SubscriptBox[\(z\), \(min\)]]\)\
\>\"", ",", "\"\<\!\(\*SubscriptBox[\(N\), \(events, fast\)]\)\>\"", ",", 
          "\"\<\!\(\*SubscriptBox[\(N\), \(events, slow\)]\)\>\""}], "}"}], 
        "}"}], ",", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"dat1", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", "2"}], "}"}]}], "]"}], "]"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            FractionBox[
             RowBox[{"#", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "zminExp"], "}"}], "&"}], "/@", 
          "dat2"}], ",", 
         RowBox[{"dat1", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", 
            RowBox[{"{", "3", "}"}]}], "]"}], "]"}], ",", 
         RowBox[{"dat2", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", 
            RowBox[{"{", "3", "}"}]}], "]"}], "]"}], ",", "2"}], "]"}]}], 
      "]"}], "//", "TableForm"}]}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.892111330393669*^9, 3.8921113703258653`*^9}, {
   3.8921114855521097`*^9, 3.8921114891326914`*^9}, {3.8921115909252915`*^9, 
   3.89211160107533*^9}, {3.892112023350475*^9, 3.8921120715940514`*^9}, {
   3.8921121043874707`*^9, 3.892112190091645*^9}, {3.892112748834139*^9, 
   3.892112748933666*^9}, {3.8921130465455704`*^9, 3.8921130470314426`*^9}, {
   3.8921131989548674`*^9, 3.8921131992395306`*^9}, {3.892113256325259*^9, 
   3.892113256434625*^9}, {3.892113458241603*^9, 3.8921135323303742`*^9}, {
   3.892116361437076*^9, 3.8921163614848557`*^9}, {3.893257780692194*^9, 
   3.893257792940939*^9}, {3.893260545232792*^9, 3.893260566765787*^9}, {
   3.896953530728937*^9, 3.896953531233162*^9}, {3.896953744363188*^9, 
   3.8969537469343243`*^9}, {3.896953883310589*^9, 3.896953884008139*^9}, {
   3.896971240286153*^9, 3.896971246695673*^9}, {3.8969733757056828`*^9, 
   3.896973378633896*^9}, {3.8969760731711082`*^9, 3.896976348233163*^9}, {
   3.8969763786206193`*^9, 3.896976403680397*^9}, {3.8969764343671703`*^9, 
   3.8969764672032614`*^9}, 3.8972088334478965`*^9, 3.8972326136604834`*^9, 
   3.897233424756247*^9, 3.8972340704293666`*^9, {3.9037938624346867`*^9, 
   3.9037938636976957`*^9}, {3.9049233552208714`*^9, 
   3.9049233846445026`*^9}, {3.905233491599722*^9, 3.9052334916831083`*^9}, {
   3.9104192195014668`*^9, 3.910419220919059*^9}, {3.910437157740117*^9, 
   3.910437198942398*^9}, 3.913866752244583*^9, 3.913867583374674*^9, {
   3.913869518281082*^9, 3.9138695346166315`*^9}, {3.9138740675789223`*^9, 
   3.9138740809976482`*^9}, {3.91387681476606*^9, 3.9138768200447187`*^9}, {
   3.9138810373100653`*^9, 3.913881064778409*^9}, 3.913881099289591*^9, 
   3.913881550640315*^9, {3.913881585879263*^9, 3.9138815982880993`*^9}, {
   3.913881660929047*^9, 3.91388166133914*^9}, {3.914496761652851*^9, 
   3.9144967641801987`*^9}, {3.9144968071881685`*^9, 3.91449701363063*^9}, {
   3.9144970517823005`*^9, 3.9144971085541267`*^9}, 3.914514827811349*^9, {
   3.9156429967004967`*^9, 3.9156429967030597`*^9}, {3.9158780985312195`*^9, 
   3.915878110222004*^9}, {3.9166729113902054`*^9, 3.916672990591911*^9}, {
   3.9167649947762575`*^9, 3.9167649948252363`*^9}, {3.950680128582283*^9, 
   3.950680144535469*^9}},ExpressionUUID->"6608ca61-80df-4c49-a1f8-\
56118e7339da"]
}, Closed]]
}, Closed]]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Exporting tabulated number of events", "Title",
 CellChangeTimes->{{3.8850207904521627`*^9, 3.885020796464762*^9}, 
   3.886649940088234*^9},
 CellTags->
  "Number-of-events-computation+sensitivity",ExpressionUUID->"0923b405-c0ba-\
437a-a0a1-eb2d8707c8c5"],

Cell[CellGroupData[{

Cell["Definitions", "Chapter",
 CellChangeTimes->{{3.8850542017641125`*^9, 3.885054203349573*^9}},
 CellTags->
  "Number-of-events-computation+sensitivity",ExpressionUUID->"2ada0cc1-1695-\
4a57-a86b-b11e240b979f"],

Cell[BoxData[
 RowBox[{"If", "[", 
  RowBox[{"condcontinue", ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"directory", "[", "\"\<Nevents\>\"", "]"}], "=", 
     RowBox[{"FileNameJoin", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"NotebookDirectory", "[", "]"}], ",", 
        "\"\<Tabulated Nevents\>\""}], "}"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"directory", "[", "\"\<Nevents-LLP\>\"", "]"}], "=", 
     RowBox[{"FileNameJoin", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"NotebookDirectory", "[", "]"}], ",", 
        "\"\<Tabulated Nevents\>\"", ",", "LLPdirName"}], "}"}], "]"}]}], ";",
     "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"directory", "[", "\"\<Nevents-LLP-experiment\>\"", "]"}], "=", 
     RowBox[{"FileNameJoin", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"NotebookDirectory", "[", "]"}], ",", 
        "\"\<Tabulated Nevents\>\"", ",", "LLPdirName", ",", 
        "SelectedExperiment"}], "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"!", 
         RowBox[{"DirectoryQ", "[", 
          RowBox[{"directory", "[", "#", "]"}], "]"}]}], ",", 
        RowBox[{"CreateDirectory", "[", 
         RowBox[{"directory", "[", "#", "]"}], "]"}]}], "]"}], "&"}], "/@", 
     RowBox[{"{", 
      RowBox[{
      "\"\<Nevents\>\"", ",", "\"\<Nevents-LLP\>\"", ",", 
       "\"\<Nevents-LLP-experiment\>\""}], "}"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
    "Print", "[", 
     "\"\<Filenames with tabulated \!\(\*SubscriptBox[\(N\), \(events\)]\):\>\
\"", "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"Do", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"FilenameNeventsInt", "[", "prod", "]"}], "=", 
       RowBox[{"ToString", "@", 
        RowBox[{"StringForm", "[", 
         RowBox[{"\"\<Nevents_``_``_at_``_Npot=``_decayDescr=``.dat\>\"", ",", 
          RowBox[{"Sequence", "@@", 
           RowBox[{"{", 
            RowBox[{"LLPdirName", ",", "prod", ",", "SelectedExperiment", ",", 
             RowBox[{
              RowBox[{"NpotGivenExperiment", "//", "CForm"}], "//", 
              "ToString"}], ",", "SelectedDescr"}], "}"}]}]}], "]"}]}]}], 
      "\[IndentingNewLine]", ",", 
      RowBox[{"{", 
       RowBox[{"prod", ",", "ProductionList"}], "}"}]}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"mRangeExport", "[", "prod", "]"}], "=", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
            "0.01", ",", "0.015", ",", "0.02", ",", "0.025", ",", "0.03", ",",
              "0.035", ",", "0.04", ",", "0.045", ",", "0.05", ",", "0.06", 
             ",", "0.07", ",", "0.08", ",", "0.09", ",", "0.1", ",", "0.11", 
             ",", "0.12", ",", "0.13", ",", "0.14", ",", "0.143", ",", 
             "0.148", ",", "0.151", ",", "0.18", ",", "0.2", ",", "0.21", ",",
              "0.215", ",", "0.218", ",", "0.22", ",", "0.225", ",", "0.23", 
             ",", "0.24", ",", "0.25", ",", "0.27", ",", "0.301", ",", "0.33",
              ",", "0.35", ",", "0.38", ",", "0.4", ",", "0.425", ",", "0.45",
              ",", "0.47", ",", "0.5", ",", "0.51", ",", "0.52", ",", "0.53", 
             ",", "0.535", ",", "0.54", ",", "0.543", ",", "0.544", ",", 
             "0.545", ",", "0.546", ",", "0.55", ",", "0.56", ",", "0.57", 
             ",", "0.58", ",", "0.59", ",", "0.6", ",", "0.61", ",", "0.62", 
             ",", "0.63", ",", "0.64", ",", "0.65", ",", "0.67", ",", "0.7", 
             ",", "0.725", ",", "0.75", ",", "0.77", ",", "0.8", ",", "0.825",
              ",", "0.85", ",", "0.87", ",", "0.88", ",", "0.89", ",", "0.9", 
             ",", "0.91", ",", "0.92", ",", "0.93", ",", "0.94", ",", "0.95", 
             ",", "0.953", ",", "0.954", ",", "0.955", ",", "0.956", ",", 
             "0.96", ",", "0.961", ",", "0.962", ",", "0.963", ",", "0.966", 
             ",", "0.97", ",", "0.973", ",", "0.975", ",", "0.98", ",", "1.", 
             ",", "1.01", ",", "1.02", ",", "1.03", ",", "1.05", ",", "1.07", 
             ",", "1.1", ",", "1.12", ",", "1.15", ",", "1.2", ",", "1.25", 
             ",", "1.3", ",", "1.4", ",", "1.5", ",", "1.6", ",", "1.7", ",", 
             "1.8", ",", "1.9", ",", "2.", ",", "2.1", ",", "2.2", ",", "2.3",
              ",", "2.4", ",", "2.5", ",", "2.6", ",", "2.7", ",", "2.9", ",",
              "3.2", ",", "3.3", ",", "3.4", ",", "3.5", ",", "3.6", ",", 
             "3.7", ",", "3.8", ",", "3.9", ",", "4.", ",", "4.1", ",", "4.2",
              ",", "4.3", ",", "4.4", ",", "4.5", ",", "4.6", ",", "4.7", ",",
              "4.76"}], "}"}], "//", "N"}], ",", 
          RowBox[{
           RowBox[{"#", ">=", "mmin\[Epsilon]"}], "&"}]}], "]"}]}], ";"}], 
      "\[IndentingNewLine]", ",", 
      RowBox[{"{", 
       RowBox[{"prod", ",", "ProductionList"}], "}"}]}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"couplingsRangeExport", "=", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        SuperscriptBox["10", "x"], ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", 
          RowBox[{"-", "11."}], ",", 
          RowBox[{"-", "1"}], ",", "0.017"}], "}"}]}], "]"}], "//", "N"}]}], 
    ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"FilenameNeventsInt", "[", "#", "]"}], "&"}], "/@", 
     "ProductionList"}]}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.8850528402073092`*^9, 3.885052964529935*^9}, {
   3.8850529967024455`*^9, 3.88505313318991*^9}, {3.885053172661522*^9, 
   3.885053247354876*^9}, {3.885053717249408*^9, 3.8850537696983976`*^9}, {
   3.885054057416253*^9, 3.88505420740788*^9}, {3.8850542428480587`*^9, 
   3.885054257815028*^9}, {3.885054905514982*^9, 3.885054927992525*^9}, {
   3.88523276755499*^9, 3.885232776819412*^9}, {3.8854556204578223`*^9, 
   3.8854556494874506`*^9}, {3.8854560165278835`*^9, 
   3.8854561921232824`*^9}, {3.8854563516684437`*^9, 
   3.8854563631681647`*^9}, {3.885456439233843*^9, 3.885456605782855*^9}, {
   3.8854567400235205`*^9, 3.885456743964001*^9}, {3.885542660052145*^9, 
   3.8855427304549437`*^9}, {3.8855427881537523`*^9, 3.885542788237467*^9}, {
   3.8855430067620525`*^9, 3.885543013668437*^9}, 3.885966882096207*^9, {
   3.8859669421437807`*^9, 3.8859669421488247`*^9}, {3.885968641323983*^9, 
   3.8859686709916077`*^9}, {3.8859700818035088`*^9, 3.885970116005333*^9}, {
   3.8859726427933483`*^9, 3.8859726621626787`*^9}, {3.8859727076000075`*^9, 
   3.885972770558454*^9}, {3.8860482606809826`*^9, 3.886048270758037*^9}, 
   3.8927074033680506`*^9, {3.892710424494131*^9, 3.8927104396943245`*^9}, {
   3.8929125643997126`*^9, 3.8929125705695467`*^9}, {3.893498037302079*^9, 
   3.893498051475497*^9}, {3.8950528099087305`*^9, 3.8950528378354964`*^9}, {
   3.895069852359413*^9, 3.895069870098545*^9}, {3.8950705608302083`*^9, 
   3.895070565809863*^9}, {3.89507701915416*^9, 3.8950770253258543`*^9}, {
   3.8951278228356895`*^9, 3.8951278681121364`*^9}, {3.8955602017177663`*^9, 
   3.895560203921951*^9}, {3.9027274496040297`*^9, 3.902727450274849*^9}, {
   3.9037911184139233`*^9, 3.903791118423604*^9}, {3.903794012559026*^9, 
   3.903794083915003*^9}, {3.9037944167176495`*^9, 3.9037944454163094`*^9}, {
   3.9037952705519886`*^9, 3.903795270602932*^9}, {3.903797141226776*^9, 
   3.903797172010522*^9}, {3.9037975243027196`*^9, 3.903797527105424*^9}, {
   3.9052336822497454`*^9, 3.9052336869139786`*^9}, {3.9101686014836874`*^9, 
   3.9101686075014696`*^9}, {3.911026697129974*^9, 3.911026781892647*^9}, {
   3.913869518284073*^9, 3.913869518287491*^9}, {3.9138696020664196`*^9, 
   3.9138696621848106`*^9}, {3.9138821703273973`*^9, 
   3.9138821744093027`*^9}, {3.9143993364943857`*^9, 
   3.9143993481228437`*^9}, {3.915642996844098*^9, 3.915642996860921*^9}, {
   3.9158781593886876`*^9, 3.915878173944133*^9}, {3.916393351327223*^9, 
   3.916393364199032*^9}, {3.91651218626814*^9, 3.9165121927656302`*^9}, 
   3.9506707653152447`*^9, {3.9506801583514557`*^9, 3.9506801764127216`*^9}},
 CellTags->"Number-of-events-computation+sensitivity",
 CellLabel->
  "In[116]:=",ExpressionUUID->"d36d89ea-2d97-457b-aa5b-4b098e8235d8"]
}, Closed]],

Cell[CellGroupData[{

Cell["Exporting", "Chapter",
 CellChangeTimes->{{3.885054212114191*^9, 3.885054213032151*^9}},
 CellTags->
  "Number-of-events-computation+sensitivity",ExpressionUUID->"a58bd3a7-f345-\
470d-ba5e-82c520e24a7e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{"condcontinue", ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"DeleteFile", "[", 
      RowBox[{"FileNames", "[", 
       RowBox[{
        RowBox[{"\"\<*\>\"", "<>", "SelectedDescr", "<>", "\"\<*\>\""}], ",", 
        RowBox[{"directory", "[", "\"\<Nevents-LLP-experiment\>\"", "]"}]}], 
       "]"}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"BlockExport", "[", "ProdChannel_", "]"}], ":=", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", "mlist", "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"mlist", "=", 
          RowBox[{"mRangeExport", "[", "ProdChannel", "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"TabFrom", "=", 
          RowBox[{"ParallelTable", "[", 
           RowBox[{
            RowBox[{"Quiet", "[", 
             RowBox[{"NeventsDiscret", "[", 
              RowBox[{
               RowBox[{"mlist", "[", 
                RowBox[{"[", "k", "]"}], "]"}], ",", "ProdChannel", ",", 
               "couplingsRangeExport"}], "]"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"k", ",", "1", ",", 
              RowBox[{"Length", "[", "mlist", "]"}], ",", "1"}], "}"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"Export", "[", 
          RowBox[{
           RowBox[{"FileNameJoin", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
              "directory", "[", "\"\<Nevents-LLP-experiment\>\"", "]"}], ",", 
              RowBox[{"FilenameNeventsInt", "[", "ProdChannel", "]"}]}], 
             "}"}], "]"}], ",", 
           RowBox[{"Flatten", "[", 
            RowBox[{"TabFrom", ",", "1"}], "]"}], ",", "\"\<Table\>\""}], 
          "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Monitor", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Module", "[", 
          RowBox[{
           RowBox[{"{", "prod", "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"prod", "=", 
             RowBox[{"ProductionList", "[", 
              RowBox[{"[", "j", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"BlockExport", "[", "prod", "]"}]}]}], 
          "\[IndentingNewLine]", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", 
           RowBox[{"Length", "[", "ProductionList", "]"}], ",", "1"}], 
          "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Row", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"ProgressIndicator", "[", 
           RowBox[{"j", ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", 
              RowBox[{"Length", "[", "ProductionList", "]"}]}], "}"}]}], 
           "]"}], ",", "\"\< Production mode = \>\"", ",", 
          RowBox[{"ProductionList", "[", 
           RowBox[{"[", "j", "]"}], "]"}], ",", "\"\< (\>\"", ",", " ", "j", 
          ",", "\"\</\>\"", ",", 
          RowBox[{"Length", "[", "ProductionList", "]"}], ",", "\"\<)\>\""}], 
         "}"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"icounter", ">", 
         RowBox[{"Length", "[", "SelectedExperimentList", "]"}]}], "&&", 
        "sensComp"}], ",", 
       RowBox[{"BlockEvaluation", "[", "\"\<Sensitivity\>\"", "]"}]}], 
      "]"}]}]}], "\[IndentingNewLine]", "]"}], "//", 
  "AbsoluteTiming"}]], "Input",
 CellChangeTimes->{{3.8921886102299604`*^9, 3.892188661864987*^9}, {
   3.892188696661598*^9, 3.892188782889353*^9}, {3.8921888713769283`*^9, 
   3.8921888914281387`*^9}, {3.892190937661848*^9, 3.8921909466626697`*^9}, {
   3.8922765048644934`*^9, 3.8922765048725324`*^9}, {3.892541051864915*^9, 
   3.8925411081031237`*^9}, {3.8925422299627275`*^9, 
   3.8925422591259813`*^9}, {3.892542627960807*^9, 3.8925426356350746`*^9}, {
   3.8927104746862555`*^9, 3.892710508465253*^9}, {3.8950703812229633`*^9, 
   3.895070389767537*^9}, 3.9027274561413517`*^9, {3.9037911184286413`*^9, 
   3.90379111843118*^9}, 3.9037940600873704`*^9, 3.9138695182916346`*^9, {
   3.9138696778224015`*^9, 3.9138697217311115`*^9}, {3.9143996243187623`*^9, 
   3.914399633625167*^9}, {3.9146656807477803`*^9, 3.9146656814277797`*^9}, 
   3.9156429968689537`*^9, 3.950671120704256*^9, 3.950671733198265*^9, {
   3.9506801791089897`*^9, 3.9506802013827744`*^9}, {3.9527010307011642`*^9, 
   3.9527010315384903`*^9}},
 CellTags->"Number-of-events-computation+sensitivity",
 CellLabel->
  "In[117]:=",ExpressionUUID->"b5ddb613-f8ce-4354-bf3e-3dc63b62f3d5"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Computing sensitivities", "Title",
 CellChangeTimes->{{3.885020809493571*^9, 3.88502081261261*^9}},
 CellTags->
  "Sensitivity",ExpressionUUID->"9cbf5dbf-7d97-438c-bab1-6a4374076885"],

Cell[CellGroupData[{

Cell["Basic definitions", "Chapter",
 CellChangeTimes->{{3.9138314745388813`*^9, 3.913831477098402*^9}},
 CellTags->
  "Sensitivity",ExpressionUUID->"9d756e77-cb38-4749-bd1a-ec57f9fa383a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"LLPdirName", "=", "\"\<ALP-fermion\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"massLabel", ",", "couplingLabel"}], "}"}], "=", 
   RowBox[{"{", 
    RowBox[{
    "\"\<\!\(\*SubscriptBox[\(m\), \(a\)]\) [GeV]\>\"", ",", 
     "\"\<y = 2\!\(\*SubscriptBox[\(v\), \(h\)]\)/\!\(\*SubscriptBox[\(f\), \
\(a\)]\)\>\""}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"directory", "[", "\"\<Sensitivity\>\"", "]"}], "=", 
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"NotebookDirectory", "[", "]"}], ",", 
      "\"\<Sensitivity domains\>\""}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"directory", "[", "\"\<Sensitivity-LLP\>\"", "]"}], "=", 
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"directory", "[", "\"\<Sensitivity\>\"", "]"}], ",", 
      "LLPdirName"}], "}"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"!", 
       RowBox[{"DirectoryQ", "[", 
        RowBox[{"directory", "[", "#", "]"}], "]"}]}], ",", 
      RowBox[{"CreateDirectory", "[", 
       RowBox[{"directory", "[", "#", "]"}], "]"}]}], "]"}], "&"}], "/@", 
   RowBox[{"{", 
    RowBox[{"\"\<Sensitivity\>\"", ",", "\"\<Sensitivity-LLP\>\""}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"directory", "[", "\"\<Nevents-LLP\>\"", "]"}], "=", 
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"NotebookDirectory", "[", "]"}], ",", 
      "\"\<Tabulated Nevents\>\"", ",", "LLPdirName"}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NotebookEvaluate", "[", 
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"NotebookDirectory", "[", "]"}], ",", 
      "\"\<codes/dialog-windows.nb\>\""}], "}"}], "]"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ExperimentDirectoriesListNevents", "=", 
   RowBox[{"Select", "[", 
    RowBox[{
     RowBox[{"FileNames", "[", 
      RowBox[{"\"\<*\>\"", ",", 
       RowBox[{"directory", "[", "\"\<Nevents-LLP\>\"", "]"}], ",", "1"}], 
      "]"}], ",", "DirectoryQ"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{
  "\"\<List of available experiments with tabulated \!\(\*SubscriptBox[\(N\), \
\(events\)]\) for \>\"", " ", "<>", "LLPdirName", "<>", "\"\<:\>\""}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ExperimentsListNevents", "=", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"FileNameTake", "[", 
       RowBox[{
        RowBox[{"ExperimentDirectoriesListNevents", "[", 
         RowBox[{"[", "i", "]"}], "]"}], ",", 
        RowBox[{"-", "1"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", 
        RowBox[{"Length", "[", "ExperimentDirectoriesListNevents", "]"}], ",",
         "1"}], "}"}]}], "]"}], "//", "Sort"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"ExperimentsListNevents", "//", "TableForm"}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Length", "[", "ExperimentsListNevents", "]"}], "\[Equal]", "0"}],
    ",", "\[IndentingNewLine]", 
   RowBox[{
   "infoDialog", "[", 
    "\"\<No experiment is available, generate first the acceptance for the \
given experiment using module 1\>\"", "]"}], "\[IndentingNewLine]", ",", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ifUncCalc", "=", 
     RowBox[{"dropdownDialog", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"True", ",", "False"}], "}"}], ",", 
       "\"\<Calculate uncertainties of the sensitivity region?\>\""}], 
      "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"SelectedExperimentList", "=", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "ExperimentsListNevents", "]"}], "\[NotEqual]",
         "0"}], ",", 
       RowBox[{"selectionDialog", "[", 
        RowBox[{
        "ExperimentsListNevents", ",", 
         "\"\<Select the experiments for which the sensitivity will be \
computed:\>\""}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"icounter", "=", "1"}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"BlockEvaluation", "[", "tag_", "]"}], ":=", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"nb", "=", 
         RowBox[{"EvaluationNotebook", "[", "]"}]}], ";", "\n", 
        RowBox[{"NotebookFind", "[", 
         RowBox[{"nb", ",", "tag", ",", "All", ",", "CellTags"}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"SelectionEvaluate", "[", "nb", "]"}]}]}], 
      "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"Do", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{
       "BlockEvaluation", "[", "\"\<Sensitivity-computation\>\"", "]"}], 
       ";"}], "\[IndentingNewLine]", ",", 
      RowBox[{"{", 
       RowBox[{"icounter", ",", "1", ",", 
        RowBox[{"Length", "[", "SelectedExperimentList", "]"}], ",", "1"}], 
       "}"}]}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}], "Input",
 CellChangeTimes->{{3.9138315400875525`*^9, 3.91383154039198*^9}, {
   3.913871030317705*^9, 3.9138710360181913`*^9}, {3.9139644847016315`*^9, 
   3.913964485416628*^9}, {3.9139724456373444`*^9, 3.913972445778761*^9}, {
   3.914665701497957*^9, 3.9146657017767367`*^9}, 3.914665747326212*^9, {
   3.914665805927826*^9, 3.914665841488042*^9}, {3.9152626107192097`*^9, 
   3.9152626112812023`*^9}, {3.9156429968842297`*^9, 
   3.9156429969124117`*^9}, {3.9506706811103077`*^9, 3.9506706918058376`*^9}, 
   3.950676829640665*^9, {3.9508953541834297`*^9, 3.9508953568495235`*^9}, {
   3.952738457975212*^9, 3.952738465467926*^9}, {3.952738505489435*^9, 
   3.9527385058231983`*^9}, {3.9527386841522713`*^9, 3.952738694486704*^9}},
 CellTags->"Sensitivity",
 CellLabel->
  "In[538]:=",ExpressionUUID->"09272721-e148-43d5-8826-7b8fa3f9f2fc"]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Specifying the experiment and interpolating the tabulated number of events\
\>", "Chapter",
 CellChangeTimes->{{3.8865657605515084`*^9, 3.886565789800824*^9}, {
  3.889154717919751*^9, 3.88915472812621*^9}},
 CellTags->
  "Sensitivity-computation",ExpressionUUID->"cba6efcf-5800-47ae-95bb-\
fbf537eda806"],

Cell[CellGroupData[{

Cell["Selecting the experiment", "Section",
 CellChangeTimes->{{3.9139658068606853`*^9, 3.913965811150226*^9}},
 CellTags->
  "Sensitivity-computation",ExpressionUUID->"fe300255-d2ee-884b-bc00-\
c6df44595cc6"],

Cell[BoxData[{
 RowBox[{"Print", "[", "\"\<Selected experiment:\>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"GivenExperimentForSensitivityComputation", "=", 
  RowBox[{"SelectedExperimentList", "[", 
   RowBox[{"[", 
    RowBox[{"icounter", "++"}], "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CondANUBIS", "=", 
   RowBox[{"MemberQ", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "\"\<ANUBIS-shaft-volume-1\>\"", ",", "\"\<ANUBIS-shaft-volume-2\>\"", 
       ",", "\"\<ANUBIS-shaft-volume-3\>\""}], "}"}], ",", 
     "GivenExperimentForSensitivityComputation"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"CondANUBIS", "\[Equal]", "True"}], ",", 
   RowBox[{"infoDialog", "[", 
    RowBox[{"Row", "[", 
     RowBox[{
     "{", "\"\<One of the modules of ANUBIS-shaft is chosen. The full \
sensitivity includes three modules. The importing will be over all modules, \
so for all ot the the sensitivity has to be computed\>\"", "}"}], "]"}], 
    "]"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"CondANUBIS", "\[Equal]", "False"}], ",", 
    RowBox[{"GivenExperimentForSensitivityComputationList", "=", 
     RowBox[{"{", "GivenExperimentForSensitivityComputation", "}"}]}], ",", 
    RowBox[{"GivenExperimentForSensitivityComputationList", "=", 
     RowBox[{"{", 
      RowBox[{
      "\"\<ANUBIS-shaft-volume-1\>\"", ",", "\"\<ANUBIS-shaft-volume-2\>\"", 
       ",", "\"\<ANUBIS-shaft-volume-3\>\""}], "}"}]}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PathsNeventsSelected", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{"PathsNeventsSelected", "=", 
      RowBox[{"Join", "[", 
       RowBox[{"PathsNeventsSelected", ",", 
        RowBox[{"FileNames", "[", 
         RowBox[{"\"\<*.dat\>\"", ",", 
          RowBox[{"FileNameJoin", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"directory", "[", "\"\<Nevents-LLP\>\"", "]"}], ",", 
             "exp"}], "}"}], "]"}]}], "]"}]}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "GivenExperimentForSensitivityComputationList"}], 
      "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Creating", " ", "the", " ", "directory", " ", "for", " ", "exporting", 
    " ", "sensitivity", " ", "curves"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ExperimentFolder", "=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"CondANUBIS", "\[Equal]", "True"}], ",", "\"\<ANUBIS\>\"", ",", 
     "GivenExperimentForSensitivityComputation"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"directory", "[", "\"\<Sensitivity-LLP-exp\>\"", "]"}], "=", 
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"directory", "[", "\"\<Sensitivity-LLP\>\"", "]"}], ",", 
      "ExperimentFolder"}], "}"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"!", 
    RowBox[{"DirectoryQ", "[", 
     RowBox[{"directory", "[", "\"\<Sensitivity-LLP-exp\>\"", "]"}], "]"}]}], 
   ",", 
   RowBox[{"CreateDirectory", "[", 
    RowBox[{"directory", "[", "\"\<Sensitivity-LLP-exp\>\"", "]"}], "]"}]}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.886840860661646*^9, 3.886840860664637*^9}, 
   3.8890817880618696`*^9, {3.8891547447151575`*^9, 3.8891549444728413`*^9}, {
   3.8891555762544374`*^9, 3.8891555856760416`*^9}, {3.8932345510125337`*^9, 
   3.89323456368647*^9}, {3.89357120648059*^9, 3.8935714592585745`*^9}, {
   3.893571545207655*^9, 3.8935715786721*^9}, {3.8935716945595617`*^9, 
   3.8935717354831114`*^9}, {3.893572484980073*^9, 3.8935725300692596`*^9}, {
   3.895054024169799*^9, 3.8950540417214823`*^9}, 3.89684678645724*^9, 
   3.89919325721731*^9, {3.905403972343326*^9, 3.9054039725337305`*^9}, {
   3.907411978163224*^9, 3.9074119810572186`*^9}, {3.907412091826584*^9, 
   3.907412094086093*^9}, {3.9138856464971056`*^9, 3.9138856465141516`*^9}, {
   3.9138916838349504`*^9, 3.913891827396206*^9}, {3.9138921667513247`*^9, 
   3.913892172717104*^9}, {3.913892368507559*^9, 3.9138923707397146`*^9}, {
   3.913954268074481*^9, 3.9139542724904437`*^9}, 3.913954515586889*^9, {
   3.9139550482633314`*^9, 3.913955048705912*^9}, {3.913955096763817*^9, 
   3.913955158064865*^9}, {3.913955220888626*^9, 3.9139554719164515`*^9}, {
   3.9139555299768157`*^9, 3.913955594188072*^9}, {3.9139558613427095`*^9, 
   3.9139559117838964`*^9}, {3.9139559447796946`*^9, 
   3.9139560410144596`*^9}, {3.913963274949171*^9, 3.913963326902071*^9}, {
   3.9139633600739164`*^9, 3.9139635321188793`*^9}, {3.913963598616632*^9, 
   3.9139636458854485`*^9}, 3.9139640986736097`*^9, {3.9139652026009254`*^9, 
   3.9139652159221773`*^9}, {3.913965669649431*^9, 3.913965669801878*^9}, {
   3.913965852616486*^9, 3.9139658533797336`*^9}, {3.9139739848899965`*^9, 
   3.9139739939318266`*^9}, 3.9145150076636033`*^9, {3.9146674411334615`*^9, 
   3.9146674532611327`*^9}, 3.9146686803003097`*^9, {3.9156430655724087`*^9, 
   3.915643065581047*^9}, {3.9158205477529774`*^9, 3.9158205483157797`*^9}, {
   3.9158208476984944`*^9, 3.915820847707511*^9}},
 CellTags->"Sensitivity-computation",
 CellLabel->
  "In[550]:=",ExpressionUUID->"5b7a0bfe-29fb-6040-b8ab-4dd79508f2d5"]
}, Closed]],

Cell[CellGroupData[{

Cell["Importing data and interpolations", "Section",
 CellChangeTimes->{{3.9139658068606853`*^9, 3.9139658231084366`*^9}},
 CellTags->
  "Sensitivity-computation",ExpressionUUID->"fc89cd31-0532-b84b-b148-\
fd58a202ae2e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "___", "___", "___", "___", "___", "___", "___", "___", "___", "___", 
    "___", "___", "___", "___", "___", "___", "___", "___"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Importing", " ", "and", " ", "interpolation"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "___", "___", "___", "___", "___", "___", "___", "___", "___", "___", 
    "___", "___", "___", "___", "___", "___", "___", "___"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Print", "[", "\"\<List of production channels:\>\"", "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"FilenamesNeventsSelected", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Last", "@", 
        RowBox[{"FileNameSplit", "@", 
         RowBox[{"PathsNeventsSelected", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "PathsNeventsSelected", "]"}], ",", "1"}], 
        "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"FilenameParameters", "[", "i_", "]"}], ":=", 
    RowBox[{
     RowBox[{"StringCases", "[", 
      RowBox[{
       RowBox[{"FilenamesNeventsSelected", "[", 
        RowBox[{"[", "i", "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"\"\<Nevents_\>\"", "<>", "LLPdirName", "<>", "\"\<_\>\""}], 
         "~~", "mother__", "~~", "\"\<_at_\>\"", "~~", "experiment__", "~~", 
         "\"\<_Npot=\>\"", "~~", "Npot__", "~~", "\"\<_decayDescr=\>\"", "~~",
          "decayDescr__", "~~", "\"\<.dat\>\""}], ":>", 
        RowBox[{"{", 
         RowBox[{
         "mother", ",", "experiment", ",", "Npot", ",", "decayDescr"}], 
         "}"}]}]}], "]"}], "[", 
     RowBox[{"[", "1", "]"}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ProductionInfoList", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"FilenameParameters", "[", "i", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "FilenamesNeventsSelected", "]"}], ",", "1"}],
         "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Join", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{
        "\"\<Mother\>\"", ",", "\"\<Experiment\>\"", ",", 
         "\"\<\!\(\*SubscriptBox[\(N\), \(PoT\)]\)\>\"", ",", 
         "\"\<Decay description\>\""}], "}"}], "}"}], ",", 
      "ProductionInfoList"}], "]"}], "//", "TableForm"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ProductionChannelsList", "=", 
     RowBox[{
      RowBox[{"ProductionInfoList", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "1"}], "]"}], "]"}], "//", "DeleteDuplicates"}]}],
     ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"decaydescriptions", "=", 
     RowBox[{
      RowBox[{"ProductionInfoList", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", 
         RowBox[{"-", "1"}]}], "]"}], "]"}], "//", "DeleteDuplicates"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"NpotDefault", "=", 
     RowBox[{
      RowBox[{"Interpreter", "[", "\"\<Number\>\"", "]"}], "[", 
      RowBox[{
       RowBox[{"ProductionInfoList", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "[", 
       RowBox[{"[", "3", "]"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"NeventsTabulated", "//", "Clear"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Epsilon]reco", "[", "mLLP_", "]"}], "=", "1"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"StringContainsQ", "[", 
       RowBox[{
       "GivenExperimentForSensitivityComputation", ",", 
        "\"\<LHCb-downstream\>\""}], "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\[Epsilon]reco", "[", "mLLP_", "]"}], "=", "0.4"}]}], "]"}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"StringContainsQ", "[", 
       RowBox[{
       "GivenExperimentForSensitivityComputation", ",", "\"\<NuCal\>\""}], 
       "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\[Epsilon]reco", "[", "mLLP_", "]"}], "=", "0.7"}]}], "]"}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"StringContainsQ", "[", 
       RowBox[{
       "GivenExperimentForSensitivityComputation", ",", "\"\<CHARM\>\""}], 
       "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\[Epsilon]reco", "[", "mLLP_", "]"}], "=", "0.6"}]}], "]"}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"mgridfull", "=", 
     RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"Do", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"prod", ",", "decayDescr"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"prod", ",", "decayDescr"}], "}"}], "=", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"ProductionInfoList", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "[", 
            RowBox[{"[", "#", "]"}], "]"}], "&"}], "/@", 
          RowBox[{"{", 
           RowBox[{"1", ",", 
            RowBox[{"-", "1"}]}], "}"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "The", " ", "condition", " ", "if", " ", "one", " ", "sums", " ", 
          "the", " ", "number", " ", "of", " ", "events", " ", "for", " ", 
          "the", " ", "same", " ", "production", " ", "mode", " ", "over", 
          " ", "several", " ", "experiments"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"IfprodExists", "=", 
         RowBox[{
          RowBox[{"MemberQ", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Keys", "[", 
              RowBox[{"DownValues", "@", "NeventsTabulated"}], "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"All", ",", "1", ",", "1"}], "]"}], "]"}], ",", 
            "prod"}], "]"}], "&&", 
          RowBox[{"MemberQ", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Keys", "[", 
              RowBox[{"DownValues", "@", "NeventsTabulated"}], "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"All", ",", "1", ",", "1"}], "]"}], "]"}], ",", 
            "decayDescr"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"NeventsTabulated", "[", 
          RowBox[{"prod", ",", "decayDescr"}], "]"}], "=", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"!", "IfprodExists"}], ",", 
           RowBox[{"Import", "[", 
            RowBox[{
             RowBox[{"PathsNeventsSelected", "[", 
              RowBox[{"[", "i", "]"}], "]"}], ",", "\"\<Table\>\""}], "]"}], 
           ",", 
           RowBox[{"Join", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"NeventsTabulated", "[", 
               RowBox[{"prod", ",", "decayDescr"}], "]"}], "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", 
                RowBox[{"{", 
                 RowBox[{"1", ",", "2"}], "}"}]}], "]"}], "]"}], ",", 
             RowBox[{
              RowBox[{
               RowBox[{"NeventsTabulated", "[", 
                RowBox[{"prod", ",", "decayDescr"}], "]"}], "[", 
               RowBox[{"[", 
                RowBox[{"All", ",", 
                 RowBox[{"{", "3", "}"}]}], "]"}], "]"}], "+", 
              RowBox[{
               RowBox[{"Import", "[", 
                RowBox[{
                 RowBox[{"PathsNeventsSelected", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], ",", "\"\<Table\>\""}], 
                "]"}], "[", 
               RowBox[{"[", 
                RowBox[{"All", ",", 
                 RowBox[{"{", "3", "}"}]}], "]"}], "]"}]}]}], "]"}]}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"mgrid", "[", 
            RowBox[{"prod", ",", "decayDescr"}], "]"}], ",", 
           RowBox[{"couplinggrid", "[", 
            RowBox[{"prod", ",", "decayDescr"}], "]"}]}], "}"}], "=", 
         RowBox[{
          RowBox[{
           RowBox[{"DeleteDuplicates", "[", 
            RowBox[{
             RowBox[{"NeventsTabulated", "[", 
              RowBox[{"prod", ",", "decayDescr"}], "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"All", ",", "#"}], "]"}], "]"}], "]"}], "&"}], "/@", 
          RowBox[{"{", 
           RowBox[{"1", ",", "2"}], "}"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"mgridfull", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Join", "[", 
            RowBox[{"mgridfull", ",", 
             RowBox[{"mgrid", "[", 
              RowBox[{"prod", ",", "decayDescr"}], "]"}]}], "]"}], "//", 
           "DeleteDuplicates"}], "//", "Sort"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"mminmax", "[", 
            RowBox[{"prod", ",", "decayDescr"}], "]"}], ",", 
           RowBox[{"couplingminmax", "[", 
            RowBox[{"prod", ",", "decayDescr"}], "]"}]}], "}"}], "=", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"#", "//", "MinMax"}], ")"}], "&"}], "/@", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"mgrid", "[", 
             RowBox[{"prod", ",", "decayDescr"}], "]"}], ",", 
            RowBox[{"couplinggrid", "[", 
             RowBox[{"prod", ",", "decayDescr"}], "]"}]}], "}"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"NevMax", "[", 
          RowBox[{"prod", ",", "decayDescr"}], "]"}], "=", 
         RowBox[{
          RowBox[{
           RowBox[{"NeventsTabulated", "[", 
            RowBox[{"prod", ",", "decayDescr"}], "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "3"}], "]"}], "]"}], "//", "Max"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"NevInt", "[", 
          RowBox[{"mLLP_", ",", "y_", ",", "prod", ",", "decayDescr"}], "]"}],
          "=", 
         RowBox[{
          RowBox[{"\[Epsilon]reco", "[", "mLLP", "]"}], "*", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"mminmax", "[", 
                RowBox[{"prod", ",", "decayDescr"}], "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}], "\[LessEqual]", " ", "mLLP", 
              "\[LessEqual]", 
              RowBox[{
               RowBox[{"mminmax", "[", 
                RowBox[{"prod", ",", "decayDescr"}], "]"}], "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], "&&", 
             RowBox[{
              RowBox[{
               RowBox[{"couplingminmax", "[", 
                RowBox[{"prod", ",", "decayDescr"}], "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}], "\[LessEqual]", "y", 
              "\[LessEqual]", 
              RowBox[{
               RowBox[{"couplingminmax", "[", 
                RowBox[{"prod", ",", "decayDescr"}], "]"}], "[", 
               RowBox[{"[", "2", "]"}], "]"}]}]}], ",", 
            RowBox[{"Evaluate", "[", 
             RowBox[{"10", "^", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Interpolation", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Log10", "[", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Log10", "[", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Log10", "[", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "+", 
                    SuperscriptBox["10", 
                    RowBox[{"-", "90"}]]}], "]"}]}], "}"}], "&"}], "/@", 
                   RowBox[{"NeventsTabulated", "[", 
                    RowBox[{"prod", ",", "decayDescr"}], "]"}]}], ",", 
                  RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], 
                "[", 
                RowBox[{
                 RowBox[{"Log10", "[", "mLLP", "]"}], ",", 
                 RowBox[{"Log10", "[", "y", "]"}]}], "]"}], ")"}]}], "]"}], 
            ",", "0"}], "]"}]}]}], ";"}]}], "\[IndentingNewLine]", "]"}], 
     "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "ProductionInfoList", "]"}], ",", "1"}], 
      "}"}]}], "]"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"mminmaxOverall", ",", "couplingminmaxOverall"}], "}"}], "=", 
     RowBox[{
      RowBox[{
       RowBox[{"MinMax", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"prod", ",", "dec"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"prod", ",", "ProductionChannelsList"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"dec", ",", "decaydescriptions"}], "}"}]}], "]"}], "//", 
         "Flatten"}], "]"}], "&"}], "/@", 
      RowBox[{"{", 
       RowBox[{"mminmax", ",", "couplingminmax"}], "}"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"NevMaxOverall", "=", 
    RowBox[{"Max", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"NeventsTabulated", "[", 
           RowBox[{"#", ",", "descr"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "3"}], "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"descr", ",", "decaydescriptions"}], "}"}]}], "]"}], "&"}], 
      "/@", "ProductionChannelsList"}], "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.9139740015576224`*^9, 3.913974002429924*^9}, {
   3.914060453150184*^9, 3.914060473916649*^9}, {3.914062253756744*^9, 
   3.914062273041237*^9}, {3.9145150076813545`*^9, 3.9145150076989536`*^9}, {
   3.9146674208960304`*^9, 3.9146674231345167`*^9}, {3.914670783416334*^9, 
   3.9146707834341106`*^9}, {3.9156430656011753`*^9, 3.915643065649435*^9}, {
   3.9158198101069565`*^9, 3.91581981355842*^9}, {3.9158205477702045`*^9, 
   3.915820569650995*^9}, {3.9158208477184887`*^9, 3.9158208477366295`*^9}, {
   3.917768978419938*^9, 3.9177689945791063`*^9}, {3.917852269986107*^9, 
   3.917852293159746*^9}, {3.917852599273158*^9, 3.9178525992954884`*^9}, {
   3.918668246699964*^9, 3.918668246901412*^9}, {3.920109061264347*^9, 
   3.920109061578763*^9}, {3.9342227843903494`*^9, 3.9342230527607665`*^9}, 
   3.934223092127531*^9, {3.9342231421434155`*^9, 3.9342231483195963`*^9}, 
   3.9342231843098392`*^9, {3.9344209284856024`*^9, 3.9344210264501743`*^9}, {
   3.934421059081024*^9, 3.9344210739498034`*^9}, {3.934421382083383*^9, 
   3.9344213824787145`*^9}, {3.9344218864537897`*^9, 3.934421886908209*^9}, 
   3.9482692556553936`*^9, {3.9482702898968525`*^9, 3.948270365394005*^9}, {
   3.948270405911253*^9, 3.948270438504944*^9}, {3.948270477986101*^9, 
   3.948270478204649*^9}, {3.9506727053667374`*^9, 3.9506727282620697`*^9}, {
   3.950866474017618*^9, 3.9508664740264683`*^9}, 3.9525892219775696`*^9, {
   3.9527009608826656`*^9, 3.9527009779643097`*^9}},
 CellTags->"Sensitivity-computation",
 CellLabel->
  "In[560]:=",ExpressionUUID->"3fb1177c-8f25-3542-9db5-6bb033442f9b"],

Cell[CellGroupData[{

Cell["Accounting for various bremsstrahlung descriptions", "Subsection",
 CellChangeTimes->{{3.9344213636600704`*^9, 3.934421371467765*^9}},
 CellTags->
  "Sensitivity-computation",ExpressionUUID->"e7bf7c72-530f-5c49-ad49-\
b971df33c309"],

Cell[BoxData[{
 RowBox[{"Print", "[", "\"\<List of various bremsstrahlung channels:\>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BremChannelsList", "=", 
   RowBox[{
    RowBox[{"Select", "[", 
     RowBox[{"ProductionChannelsList", ",", 
      RowBox[{
       RowBox[{"StringContainsQ", "[", 
        RowBox[{"#", ",", "\"\<Bremsstrahlung\>\""}], "]"}], "&"}]}], "]"}], "//",
     "Sort"}]}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Defining", " ", "the", " ", "baseline", " ", "bremsstrahlung", " ", 
    "setup"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BremChannelBaseline", "=", "\"\<Bremsstrahlung-FR-Central\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"BremChannelsList", "==", 
      RowBox[{"{", "}"}]}], "||", 
     RowBox[{"BremChannelsList", "==", 
      RowBox[{"{", "\"\<None\>\"", "}"}]}]}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ProductionChannelsListUnified", "=", 
      RowBox[{"ProductionChannelsBaseline", "=", "ProductionChannelsList"}]}],
      ";", "\[IndentingNewLine]", 
     RowBox[{"BremChannelsList", "=", 
      RowBox[{"{", "\"\<None\>\"", "}"}]}]}], "\[IndentingNewLine]", ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"MemberQ", "[", 
        RowBox[{"BremChannelsList", ",", "BremChannelBaseline"}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ProductionChannelsBaseline", "=", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"Select", "[", 
            RowBox[{"ProductionChannelsList", ",", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"StringContainsQ", "[", 
                RowBox[{"#", ",", "\"\<Bremsstrahlung\>\""}], "]"}]}], 
              "&"}]}], "]"}], ",", 
           RowBox[{"{", "BremChannelBaseline", "}"}]}], "]"}]}], ";"}], 
       "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
       RowBox[{"ProductionChannelsBaseline", "=", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"Select", "[", 
           RowBox[{"ProductionChannelsList", ",", 
            RowBox[{
             RowBox[{"!", 
              RowBox[{"StringContainsQ", "[", 
               RowBox[{"#", ",", "\"\<Bremsstrahlung\>\""}], "]"}]}], "&"}]}],
            "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"BremChannelsList", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "}"}]}], "]"}]}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"ProductionChannelsListUnified", "=", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"Select", "[", 
         RowBox[{"ProductionChannelsList", ",", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"StringContainsQ", "[", 
             RowBox[{"#", ",", "\"\<Bremsstrahlung\>\""}], "]"}]}], "&"}]}], 
         "]"}], ",", 
        RowBox[{"{", "\"\<Bremsstrahlung\>\"", "}"}]}], "]"}]}], ";"}]}], 
   "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MapThread", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"BremNameExportPattern", "[", "#1", "]"}], "=", "#2"}], ")"}], 
     "&"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"\"\<Bremsstrahlung-\>\"", "<>", "#"}], ")"}], "&"}], "/@", 
         RowBox[{"{", 
          RowBox[{
          "\"\<FR-Upper\>\"", ",", "\"\<FR-Central\>\"", ",", 
           "\"\<FR-Lower\>\"", ",", "\"\<BB\>\"", ",", "\"\<AP-Upper\>\"", 
           ",", "\"\<AP-Central\>\"", ",", "\"\<AP-Lower\>\"", ",", 
           "\"\<Baseline\>\""}], "}"}]}], ",", 
        RowBox[{"{", "\"\<None\>\"", "}"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "\"\<FR-Upper\>\"", ",", "\"\<FR-Central\>\"", ",", "\"\<FR-Lower\>\"",
         ",", "\"\<BB\>\"", ",", "\"\<AP-Upper\>\"", ",", 
        "\"\<AP-Central\>\"", ",", "\"\<AP-Lower\>\"", ",", 
        "\"\<Baseline\>\"", ",", "\"\<None\>\""}], "}"}]}], "}"}]}], "]"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.9344214061369877`*^9, 3.9344214204168596`*^9}, {
   3.9344218908614206`*^9, 3.934421911216852*^9}, {3.934421946639409*^9, 
   3.93442203218508*^9}, {3.9344226880216246`*^9, 3.9344226886615286`*^9}, {
   3.9344227585794473`*^9, 3.9344227618807783`*^9}, {3.9344229632846923`*^9, 
   3.934422985720289*^9}, {3.9344232039753017`*^9, 3.9344232051634417`*^9}, {
   3.934425118417382*^9, 3.9344251228031607`*^9}, {3.934555568906765*^9, 
   3.934555609855014*^9}, {3.935134776652753*^9, 3.9351347766547527`*^9}, 
   3.941877510257313*^9, {3.9418789761345577`*^9, 3.9418789762093983`*^9}, {
   3.948270677047619*^9, 3.948270696651329*^9}, 3.948271091161566*^9, {
   3.9482714892090282`*^9, 3.948271502036175*^9}, {3.9482721589968815`*^9, 
   3.948272177229109*^9}, {3.9482731235537033`*^9, 3.948273136601984*^9}, {
   3.9483021611459084`*^9, 3.948302196168556*^9}},
 CellTags->"Sensitivity-computation",
 CellLabel->
  "In[577]:=",ExpressionUUID->"002e3312-bd69-b34c-9e37-2ca865725ebb"]
}, Closed]],

Cell[CellGroupData[{

Cell["Accounting for various Drell-Yan descriptions", "Subsection",
 CellChangeTimes->{{3.9344213636600704`*^9, 3.934421371467765*^9}, {
  3.941877547911129*^9, 3.9418775514496346`*^9}},
 CellTags->
  "Sensitivity-computation",ExpressionUUID->"2f7cf3db-4b58-b94d-bb4e-\
a9276c35e47e"],

Cell[BoxData[{
 RowBox[{"Print", "[", "\"\<List of various Drell-Yan descriptions:\>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DrellYanChannelsList", "=", 
   RowBox[{
    RowBox[{"Select", "[", 
     RowBox[{"ProductionChannelsList", ",", 
      RowBox[{
       RowBox[{"StringContainsQ", "[", 
        RowBox[{"#", ",", "\"\<DrellYan\>\""}], "]"}], "&"}]}], "]"}], "//", 
    "Sort"}]}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Defining", " ", "the", " ", "baseline", " ", "bremsstrahlung", " ", 
    "setup"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DrellYanChannelBaseline", "=", "\"\<DrellYan-Central\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"DrellYanChannelsList", "!=", 
      RowBox[{"{", "}"}]}], "&&", 
     RowBox[{"DrellYanChannelsList", "!=", 
      RowBox[{"{", "\"\<None\>\"", "}"}]}]}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ProductionChannelsBaseline", "=", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"Select", "[", 
         RowBox[{"ProductionChannelsBaseline", ",", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"StringContainsQ", "[", 
             RowBox[{"#", ",", "\"\<DrellYan\>\""}], "]"}]}], "&"}]}], "]"}], 
        ",", 
        RowBox[{"{", "DrellYanChannelBaseline", "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"ProductionChannelsListUnified", "=", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"Select", "[", 
         RowBox[{"ProductionChannelsListUnified", ",", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"StringContainsQ", "[", 
             RowBox[{"#", ",", "\"\<DrellYan\>\""}], "]"}]}], "&"}]}], "]"}], 
        ",", 
        RowBox[{"{", "\"\<DrellYan\>\"", "}"}]}], "]"}]}], ";"}], 
    "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
    RowBox[{"DrellYanChannelsList", "=", 
     RowBox[{"{", "\"\<None\>\"", "}"}]}]}], "\[IndentingNewLine]", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MapThread", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"DrellYanNameExportPattern", "[", "#1", "]"}], "=", "#2"}], 
      ")"}], "&"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"\"\<DrellYan-\>\"", "<>", "#"}], ")"}], "&"}], "/@", 
         RowBox[{"{", 
          RowBox[{
          "\"\<Central\>\"", ",", "\"\<Lower\>\"", ",", "\"\<Upper\>\""}], 
          "}"}]}], ",", 
        RowBox[{"{", "\"\<None\>\"", "}"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "\"\<Central\>\"", ",", "\"\<Lower\>\"", ",", "\"\<Upper\>\"", ",", 
        "\"\<None\>\""}], "}"}]}], "}"}]}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.9344214061369877`*^9, 3.9344214204168596`*^9}, {
   3.9344218908614206`*^9, 3.934421911216852*^9}, {3.934421946639409*^9, 
   3.93442203218508*^9}, {3.9344226880216246`*^9, 3.9344226886615286`*^9}, {
   3.9344227585794473`*^9, 3.9344227618807783`*^9}, {3.9344229632846923`*^9, 
   3.934422985720289*^9}, {3.9344232039753017`*^9, 3.9344232051634417`*^9}, {
   3.934425118417382*^9, 3.9344251228031607`*^9}, {3.934555568906765*^9, 
   3.934555609855014*^9}, {3.935134776652753*^9, 3.9351347766547527`*^9}, 
   3.941877510257313*^9, {3.9418775824023533`*^9, 3.941877763091366*^9}, {
   3.941879138108612*^9, 3.941879148967924*^9}, {3.941879551972561*^9, 
   3.9418795892015133`*^9}, {3.9482707196111336`*^9, 3.948270719839094*^9}, {
   3.9482710570827312`*^9, 3.9482710709488907`*^9}, {3.948271136816223*^9, 
   3.9482711369835453`*^9}, {3.948271264487789*^9, 3.9482713024025326`*^9}, {
   3.948271470343092*^9, 3.948271482491436*^9}, {3.9482720813661804`*^9, 
   3.948272085401819*^9}, {3.948272118981037*^9, 3.948272151957264*^9}},
 CellTags->"Sensitivity-computation",
 CellLabel->
  "In[582]:=",ExpressionUUID->"0ed97628-be3e-044a-a7b0-0b76d9b8e872"]
}, Closed]]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Some number of events plots", "Chapter",
 CellChangeTimes->{{3.9482707731815777`*^9, 
  3.94827077970364*^9}},ExpressionUUID->"3cdb50bc-b94f-994a-bea4-\
ab6adc062293"],

Cell[CellGroupData[{

Cell["Overall plot with the number of events", "Section",
 CellChangeTimes->{{3.9418775187226887`*^9, 3.9418775325581894`*^9}},
 CellTags->
  "Sensitivity-computation",ExpressionUUID->"04de29f6-78bf-cd45-bbd5-\
c481cbd63244"],

Cell[BoxData[{
 RowBox[{"Do", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"NevIntOverall", "[", 
      RowBox[{"mLLP_", ",", "y_", ",", "descr"}], "]"}], "=", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{"NevInt", "[", 
        RowBox[{"mLLP", ",", "y", ",", "prod", ",", "descr"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"prod", ",", "ProductionChannelsBaseline"}], "}"}]}], "]"}]}],
     ";"}], "\[IndentingNewLine]", ",", 
   RowBox[{"{", 
    RowBox[{"descr", ",", "decaydescriptions"}], "}"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pt", "[", 
   RowBox[{"mLLP_", ",", "descr_"}], "]"}], ":=", 
  RowBox[{"LogLogPlot", "[", 
   RowBox[{
    RowBox[{"Evaluate", "[", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"NevInt", "[", 
        RowBox[{"mLLP", ",", "y", ",", "prod", ",", "descr"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"prod", ",", "ProductionChannelsBaseline"}], "}"}]}], "]"}], 
     "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"y", ",", 
      RowBox[{"couplingminmaxOverall", "[", 
       RowBox[{"[", "1", "]"}], "]"}], ",", 
      RowBox[{"couplingminmaxOverall", "[", 
       RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
    RowBox[{"PlotLegends", "\[Rule]", 
     RowBox[{"Placed", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Style", "[", 
          RowBox[{"#", ",", "15"}], "]"}], "&"}], "/@", 
        "ProductionChannelsBaseline"}], ",", "Right"}], "]"}]}], ",", 
    RowBox[{"PlotRange", "->", 
     RowBox[{"{", 
      RowBox[{"couplingminmaxOverall", ",", 
       RowBox[{"{", 
        RowBox[{
         SuperscriptBox["10", 
          RowBox[{"-", "2"}]], ",", "NevMaxOverall"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"Frame", "->", "True"}], ",", 
    RowBox[{"ImageSize", "->", "Large"}], ",", 
    RowBox[{"FrameLabel", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
      "couplingLabel", ",", " ", 
       "\"\<\!\(\*SubscriptBox[\(N\), \(events\)]\)[\!\(\*SubscriptBox[\(m\), \
\(a\)]\),y]\>\""}], "}"}]}], ",", 
    RowBox[{"FrameStyle", "\[Rule]", 
     RowBox[{"Directive", "[", 
      RowBox[{"Black", ",", " ", "23"}], "]"}]}], ",", 
    RowBox[{"PlotStyle", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"Thick", ",", "Blue"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"Thick", ",", 
         RowBox[{"Darker", "@", "Red"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"Thick", ",", 
         RowBox[{"Darker", "@", 
          RowBox[{"Darker", "@", "Green"}]}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"Thick", ",", "Black"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"Thick", ",", "Blue", ",", 
         RowBox[{"Dashing", "[", "0.02", "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"Thick", ",", 
         RowBox[{"Darker", "@", "Red"}], ",", 
         RowBox[{"Dashing", "[", "0.02", "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"Thick", ",", 
         RowBox[{"Darker", "@", 
          RowBox[{"Darker", "@", "Green"}]}], ",", 
         RowBox[{"Dashing", "[", "0.02", "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"Thick", ",", "Black", ",", 
         RowBox[{"Dashing", "[", "0.02", "]"}]}], "}"}]}], "}"}]}], ",", 
    RowBox[{"PlotLabel", "\[Rule]", 
     RowBox[{"Style", "[", 
      RowBox[{
       RowBox[{"Row", "[", 
        RowBox[{"{", 
         RowBox[{
         "ExperimentFolder", ",", 
          "\"\<. \!\(\*SubscriptBox[\(m\), \(a\)]\) = \>\"", ",", "mLLP", ",",
           " ", "\"\< GeV\>\""}], "}"}], "]"}], ",", "20", ",", "Black"}], 
      "]"}]}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"pt", "[", 
  RowBox[{"0.7", ",", "\"\<Default\>\""}], "]"}]}], "Input",
 CellChangeTimes->{{3.948270564491726*^9, 3.9482706114810963`*^9}, {
  3.9506728494985065`*^9, 3.9506729008964176`*^9}, {3.950866474037363*^9, 
  3.9508664740407867`*^9}, {3.9508679153706055`*^9, 3.9508679241707478`*^9}, {
  3.952738709029974*^9, 3.9527387107115536`*^9}},
 CellTags->"Sensitivity-computation",
 CellLabel->
  "In[587]:=",ExpressionUUID->"c8b8bb9e-591e-884b-8554-349f7c555ef0"]
}, Closed]],

Cell[CellGroupData[{

Cell["Events density plot", "Section",
 CellChangeTimes->{{3.8928925129732084`*^9, 3.8928925141322923`*^9}, {
  3.892910359615284*^9, 3.892910363538608*^9}},
 CellTags->
  "Sensitivity-computation",ExpressionUUID->"1779fba7-f5a1-1f4c-a7e8-\
1890db9d1963"],

Cell[BoxData[{
 RowBox[{"plot", "=", 
  RowBox[{"DensityPlot", "[", 
   RowBox[{
    RowBox[{"Evaluate", "[", 
     RowBox[{"Log10", "[", 
      RowBox[{"NevIntOverall", "[", 
       RowBox[{"mLLP", ",", "y", ",", "\"\<Default\>\""}], "]"}], "]"}], 
     "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"mLLP", ",", 
      RowBox[{"mminmaxOverall", "[", 
       RowBox[{"[", "1", "]"}], "]"}], ",", 
      RowBox[{"mminmaxOverall", "[", 
       RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"y", ",", 
      RowBox[{"couplingminmaxOverall", "[", 
       RowBox[{"[", "1", "]"}], "]"}], ",", 
      RowBox[{"couplingminmaxOverall", "[", 
       RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
    RowBox[{"ScalingFunctions", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"\"\<Log\>\"", ",", "\"\<Log\>\""}], "}"}]}], ",", 
    RowBox[{"AspectRatio", "\[Rule]", "0.78"}], ",", 
    RowBox[{"PlotRange", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"All", ",", "All", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Log10", "[", "2.3", "]"}], ",", 
         RowBox[{"Log10", "[", "NevMaxOverall", "]"}]}], "}"}]}], "}"}]}], 
    ",", 
    RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
    RowBox[{"FrameLabel", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"massLabel", ",", "couplingLabel"}], "}"}]}], ",", " ", 
    RowBox[{"Frame", "\[Rule]", " ", "True"}], ",", " ", 
    RowBox[{"FrameStyle", "\[Rule]", 
     RowBox[{"Directive", "[", 
      RowBox[{"Black", ",", " ", "25"}], "]"}]}], ",", 
    RowBox[{"PlotPoints", "\[Rule]", "100"}], ",", 
    RowBox[{"PlotLegends", "\[Rule]", 
     RowBox[{"Placed", "[", 
      RowBox[{
       RowBox[{"BarLegend", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"Automatic", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Log10", "[", "2.3", "]"}], ",", 
             RowBox[{"Log10", "[", "NevMaxOverall", "]"}]}], "}"}]}], "}"}], 
         ",", 
         RowBox[{"LegendMarkerSize", "\[Rule]", "340"}], ",", 
         RowBox[{"LegendLabel", "\[Rule]", 
          RowBox[{"Placed", "[", 
           RowBox[{
           "\"\<\!\(\*SubscriptBox[\(Log\), \
\(10\)]\)[\!\(\*SubscriptBox[\(N\), \(ev\)]\)]\>\"", ",", "Bottom"}], "]"}]}],
          ",", 
         RowBox[{"LabelStyle", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"FontSize", "\[Rule]", "22"}], "}"}]}], ",", 
         RowBox[{"Method", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"FrameStyle", "\[Rule]", "Black"}], ",", 
            RowBox[{"AxesStyle", "\[Rule]", "None"}], ",", 
            RowBox[{"TicksStyle", "\[Rule]", "Black"}]}], "}"}]}]}], "]"}], 
       ",", "Right"}], "]"}]}], ",", 
    RowBox[{"PlotLabel", "\[Rule]", 
     RowBox[{"Style", "[", 
      RowBox[{
       RowBox[{"Row", "[", 
        RowBox[{"{", "ExperimentFolder", "}"}], "]"}], ",", "20", ",", 
       "Black"}], "]"}]}]}], 
   RowBox[{"(*", 
    RowBox[{",", 
     RowBox[{"FrameTicks", "->", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"Automatic", ",", "Automatic"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"TicksPlotx", ",", "None"}], "}"}]}], "}"}]}]}], "*)"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Export", "[", 
  RowBox[{
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"NotebookDirectory", "[", "]"}], ",", 
      "\"\<plots/SensCalc/NeventsDensityPlotExample.pdf\>\""}], "}"}], "]"}], 
   ",", "plot", ",", 
   RowBox[{"\"\<AllowRasterization\>\"", "->", "False"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.8929096922410564`*^9, 3.892909806303069*^9}, {
   3.8929100920281754`*^9, 3.8929100955435038`*^9}, {3.8929101335841722`*^9, 
   3.892910162228066*^9}, {3.8929101949082084`*^9, 3.8929101952618375`*^9}, {
   3.893481779378194*^9, 3.893481781603961*^9}, {3.8935713726623445`*^9, 
   3.8935713726663337`*^9}, 3.893571593533576*^9, {3.893600462416499*^9, 
   3.893600464823284*^9}, {3.8936007175747695`*^9, 3.8936007273021555`*^9}, {
   3.8936008794615602`*^9, 3.8936008816425495`*^9}, {3.893605565414917*^9, 
   3.8936055685099897`*^9}, {3.894552167897132*^9, 3.894552190947688*^9}, {
   3.9138856465220795`*^9, 3.9138856465250854`*^9}, {3.9139635639485736`*^9, 
   3.913963579089311*^9}, 3.9139636566744375`*^9, {3.9139640983446198`*^9, 
   3.913964098352851*^9}, {3.9139656696637654`*^9, 3.9139656696674147`*^9}, {
   3.915643066011381*^9, 3.9156430660143795`*^9}, {3.9482707598133698`*^9, 
   3.948270762213236*^9}, {3.950672931729332*^9, 3.9506729439513607`*^9}, {
   3.9508664742872257`*^9, 3.950866474289219*^9}, {3.952738716692419*^9, 
   3.952738722293955*^9}},
 CellTags->"Sensitivity-computation",
 CellLabel->
  "In[590]:=",ExpressionUUID->"33a6e888-1b7f-5d4a-b31f-27d02dbd4f4d"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Sensitivity computation", "Chapter",
 CellChangeTimes->{{3.8889936571476183`*^9, 3.8889936597112193`*^9}},
 CellTags->
  "Sensitivity-computation",ExpressionUUID->"6973c073-2e4b-4c34-a088-\
4365694bce10"],

Cell[CellGroupData[{

Cell["Constraints importing", "Section",
 CellChangeTimes->{{3.895052713576123*^9, 3.895052715327282*^9}, {
  3.913967299387415*^9, 3.913967300849271*^9}},
 CellTags->
  "Sensitivity-computation",ExpressionUUID->"d57a2d3d-381f-479e-bde3-\
49c0fb15579a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"importformat", "[", "\"\<txt\>\"", "]"}], "=", 
   RowBox[{
    RowBox[{"importformat", "[", "\"\<dat\>\"", "]"}], "=", 
    "\"\<Table\>\""}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"importformat", "[", "\"\<m\>\"", "]"}], "=", 
   RowBox[{
    RowBox[{"importformat", "[", "\"\<mx\>\"", "]"}], "=", "\"\<MX\>\""}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"importformat", "[", "\"\<xls\>\"", "]"}], "=", "\"\<XLS\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dir", "=", 
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"NotebookDirectory", "[", "]"}], ",", "\"\<contours\>\"", ",", 
      "LLPdirName"}], "}"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"DirectoryQ", "[", "dir", "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"filenames", "=", 
      RowBox[{"FileNames", "[", 
       RowBox[{
        RowBox[{"LLPdirName", "<>", "\"\<-excluded*\>\""}], ",", "dir", ",", 
        "Infinity"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ExcludedRegions", "[", "LLPdirName", "]"}], "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Import", "[", 
         RowBox[{"#", ",", 
          RowBox[{"importformat", "[", 
           RowBox[{"FileExtension", "[", "#", "]"}], "]"}]}], "]"}], "&"}], "/@", 
       RowBox[{"FileNames", "[", 
        RowBox[{
         RowBox[{"LLPdirName", "<>", "\"\<-excluded*\>\""}], ",", "dir", ",", 
         "Infinity"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ExcludedRegions", "[", "LLPdirName", "]"}], "=", 
      RowBox[{
       RowBox[{"ExcludedRegions", "[", "LLPdirName", "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";"}]}], "\[IndentingNewLine]", 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"!", 
    RowBox[{"DirectoryQ", "[", "dir", "]"}]}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ExcludedRegions", "[", "LLPdirName", "]"}], "=", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{"10.", ",", "10."}], "}"}], "}"}], "}"}]}], ";"}]}], 
  "\[IndentingNewLine]", "]"}]}], "Input",
 CellChangeTimes->{{3.903794607976071*^9, 3.9037946091391277`*^9}, 
   3.9037950242375803`*^9, {3.914663829724105*^9, 3.9146638864002028`*^9}, {
   3.9146639634790745`*^9, 3.9146639691212807`*^9}, 3.9146665721390686`*^9, {
   3.9156429970126553`*^9, 3.9156429970218625`*^9}, {3.950674572195156*^9, 
   3.950674611144308*^9}},
 CellTags->"Sensitivity-computation",
 CellLabel->
  "In[592]:=",ExpressionUUID->"4018b168-837a-415b-ac72-f91c637de913"]
}, Closed]],

Cell[CellGroupData[{

Cell["Sensitivity", "Section",
 CellChangeTimes->{{3.895052721789363*^9, 3.8950527227812586`*^9}},
 CellTags->
  "Sensitivity-computation",ExpressionUUID->"9f6548e1-453f-47b5-b82c-\
a2ef474f018e"],

Cell[CellGroupData[{

Cell["Sensitivity calculator block", "Subsection",
 CellChangeTimes->{{3.9344284768399067`*^9, 3.9344284803812065`*^9}, {
  3.9345997252424593`*^9, 3.934599726886627*^9}},
 CellTags->
  "Sensitivity-computation",ExpressionUUID->"6b015ada-f566-6645-af59-\
37c927aa9bed"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"exclRes", "[", "mLLP_", "]"}], "=", 
   RowBox[{"Boole", "[", 
    RowBox[{"!", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"0.125", "<", "mLLP", "<", "0.14"}], "||", 
       RowBox[{"0.538", "<", "mLLP", "<", "0.555"}], "||", 
       RowBox[{"0.94", "<", "mLLP", "<", "0.974"}]}], ")"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"massranges", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"mminmaxOverall", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", "0.125"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.14", ",", "0.538"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.538", ",", "0.94"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.974", ",", 
       RowBox[{"mminmaxOverall", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SensitivityExtractor", "[", 
   RowBox[{
   "SelectedProduction_", ",", "Npot_", ",", "NevMin_", ",", "decayDescr_"}], 
   "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"NevTot", "[", 
       RowBox[{"mLLP_", ",", "finv_"}], "]"}], "=", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{"NevInt", "[", 
         RowBox[{"mLLP", ",", "finv", ",", "prod", ",", "decayDescr"}], "]"}],
         ",", 
        RowBox[{"{", 
         RowBox[{"prod", ",", "SelectedProduction"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "RegSens1", ",", "RegSens2", ",", "RegSens3", ",", "RegSens4"}], "}"}],
       "=", 
      RowBox[{
       RowBox[{"ResourceFunction", "[", "\"\<MonitorProgress\>\"", "]"}], "@", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"RegionPlot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             FractionBox["Npot", "NpotDefault"], 
             RowBox[{"NevTot", "[", 
              RowBox[{
               SuperscriptBox["10", "mLLP"], ",", 
               SuperscriptBox["10", "ga"]}], "]"}], "*", 
             RowBox[{"exclRes", "[", 
              SuperscriptBox["10", "mLLP"], "]"}]}], "\[GreaterEqual]", 
            "NevMin"}], ",", 
           RowBox[{"{", 
            RowBox[{"mLLP", ",", 
             RowBox[{"Log10", "[", 
              RowBox[{
               RowBox[{"massranges", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
             RowBox[{"Log10", "[", 
              RowBox[{
               RowBox[{"massranges", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "[", 
               RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"ga", ",", 
             RowBox[{"Log10", "[", 
              RowBox[{"couplingminmaxOverall", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
             RowBox[{"Log10", "[", 
              RowBox[{"couplingminmaxOverall", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "}"}], ",", 
           RowBox[{"PlotPoints", "->", "200"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "massranges", "]"}], ",", "1"}], "}"}]}], 
        "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Sens", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"10", "^", 
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], ",", 
            RowBox[{"10", "^", 
             RowBox[{"#", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}], "&"}], "/@", 
         RowBox[{"Partition", "[", 
          RowBox[{
           RowBox[{"Flatten", "[", 
            RowBox[{"Cases", "[", 
             RowBox[{
              RowBox[{"Normal", "@", "RegSens"}], ",", 
              RowBox[{
               RowBox[{"Line", "[", "x_", "]"}], "\[RuleDelayed]", "x"}], ",",
               "Infinity"}], "]"}], "]"}], ",", "2"}], "]"}]}]}], ";"}], 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"SensTemp", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Cases", "[", 
         RowBox[{
          RowBox[{"Normal", "@", "#"}], ",", 
          RowBox[{
           RowBox[{"Line", "[", "x_", "]"}], "\[RuleDelayed]", "x"}], ",", 
          "Infinity"}], "]"}], "&"}], "/@", 
       RowBox[{"{", 
        RowBox[{
        "RegSens1", ",", "RegSens2", ",", "RegSens3", ",", "RegSens4"}], 
        "}"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"SensTemp1", "=", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"SensTemp", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", 
        RowBox[{"SensTemp", "[", 
         RowBox[{"[", "2", "]"}], "]"}], ",", 
        RowBox[{"SensTemp", "[", 
         RowBox[{"[", "3", "]"}], "]"}], ",", 
        RowBox[{"SensTemp", "[", 
         RowBox[{"[", "4", "]"}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"10", "^", 
            RowBox[{"#", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], ",", 
           RowBox[{"10", "^", 
            RowBox[{"#", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}], "&"}], "/@", 
        RowBox[{"SensTemp1", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "SensTemp1", "]"}], ",", "1"}], "}"}]}], 
      "]"}]}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SensitivityExtractorBremDrellYan", "[", 
   RowBox[{
   "SelectedProduction_", ",", "Npot_", ",", "NevMin_", ",", "decayDescr_"}], 
   "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "bremch", ",", "selprod", ",", "drellyanch", ",", "bremdescr", ",", 
      "drelyandescr"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"tabsens", "=", 
      RowBox[{"{", 
       RowBox[{"{", "}"}], "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"IfBremSelected", "=", 
      RowBox[{"MemberQ", "[", 
       RowBox[{"SelectedProduction", ",", "\"\<Bremsstrahlung\>\""}], "]"}]}],
      ";", "\[IndentingNewLine]", 
     RowBox[{"IfDrellYanSelected", "=", 
      RowBox[{"MemberQ", "[", 
       RowBox[{"SelectedProduction", ",", "\"\<DrellYan\>\""}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"selprodIni", "=", 
      RowBox[{"Select", "[", 
       RowBox[{"SelectedProduction", ",", 
        RowBox[{
         RowBox[{"!", 
          RowBox[{"MemberQ", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"\"\<Bremsstrahlung\>\"", ",", "\"\<DrellYan\>\""}], 
             "}"}], ",", "#"}], "]"}]}], "&"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{
       "If", " ", "proton", " ", "bremsstrahlung", " ", "is", " ", 
        "selected"}], ",", " ", 
       RowBox[{"looping", " ", "over", " ", "its", " ", "descriptions"}]}], 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{"IfBremSelected", ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"ResourceFunction", "[", "\"\<MonitorProgress\>\"", "]"}], "@", 
         RowBox[{"Do", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"bremch", "=", 
             RowBox[{"BremChannelsList", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"bremdescr", "=", 
             RowBox[{"BremNameExportPattern", "[", "bremch", "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"selprodBrem", "=", 
             RowBox[{"Join", "[", 
              RowBox[{"selprodIni", ",", 
               RowBox[{"{", "bremch", "}"}]}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{
               RowBox[{"If", " ", "Drell"}], "-", 
               RowBox[{"Yan", " ", "is", " ", "selected"}]}], ",", " ", 
              RowBox[{
              "looping", " ", "over", " ", "its", " ", "descriptions"}]}], 
             "*)"}], "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{"IfDrellYanSelected", ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
               "ResourceFunction", "[", "\"\<MonitorProgress\>\"", "]"}], "@", 
               RowBox[{"Do", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{
                  RowBox[{"drellyanch", "=", 
                   RowBox[{"DrellYanChannelsList", "[", 
                    RowBox[{"[", "j", "]"}], "]"}]}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"drelyandescr", "=", 
                   RowBox[{
                   "DrellYanNameExportPattern", "[", "drellyanch", "]"}]}], ";",
                   "\[IndentingNewLine]", 
                  RowBox[{"selprod", "=", 
                   RowBox[{"Join", "[", 
                    RowBox[{"selprodBrem", ",", 
                    RowBox[{"{", "drellyanch", "}"}]}], "]"}]}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"tabsens", "=", 
                   RowBox[{"Join", "[", 
                    RowBox[{"tabsens", ",", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    "selprod", ",", "bremdescr", ",", "drelyandescr", ",", 
                    "decayDescr", ",", 
                    RowBox[{"SensitivityExtractor", "[", 
                    RowBox[{
                    "selprod", ",", "Npot", ",", "NevMin", ",", 
                    "decayDescr"}], "]"}]}], "}"}], "}"}]}], "]"}]}], ";"}], 
                 "\[IndentingNewLine]", ",", 
                 RowBox[{"{", 
                  RowBox[{"j", ",", "1", ",", 
                   RowBox[{"Length", "[", "DrellYanChannelsList", "]"}]}], 
                  "}"}]}], "]"}]}], "\[IndentingNewLine]", ",", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"selprod", "=", "selprodBrem"}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"tabsens", "=", 
                RowBox[{"Join", "[", 
                 RowBox[{"tabsens", ",", 
                  RowBox[{"{", 
                   RowBox[{"{", 
                    RowBox[{
                    "selprod", ",", "bremdescr", ",", "\"\<None\>\"", ",", 
                    "decayDescr", ",", 
                    RowBox[{"SensitivityExtractor", "[", 
                    RowBox[{
                    "selprod", ",", "Npot", ",", "NevMin", ",", 
                    "decayDescr"}], "]"}]}], "}"}], "}"}]}], "]"}]}], ";"}]}],
              "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", 
             RowBox[{"Length", "[", "BremChannelsList", "]"}], ",", "1"}], 
            "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"tabsens", "=", 
         RowBox[{"Drop", "[", 
          RowBox[{"tabsens", ",", "1"}], "]"}]}]}], "\[IndentingNewLine]", ",",
        "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
          RowBox[{"If", " ", "Drell"}], "-", 
          RowBox[{"Yan", " ", "is", " ", "selected"}]}], ",", " ", 
         RowBox[{"looping", " ", "over", " ", "its", " ", "descriptions"}]}], 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{"IfDrellYanSelected", ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"ResourceFunction", "[", "\"\<MonitorProgress\>\"", "]"}], 
           "@", 
           RowBox[{"Do", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"drellyanch", "=", 
               RowBox[{"DrellYanChannelsList", "[", 
                RowBox[{"[", "j", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"drelyandescr", "=", 
               RowBox[{
               "DrellYanNameExportPattern", "[", "drellyanch", "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"selprod", "=", 
               RowBox[{"Join", "[", 
                RowBox[{"selprodIni", ",", 
                 RowBox[{"{", "drellyanch", "}"}]}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"tabsens", "=", 
               RowBox[{"Join", "[", 
                RowBox[{"tabsens", ",", 
                 RowBox[{"{", 
                  RowBox[{"{", 
                   RowBox[{
                   "selprod", ",", "\"\<None\>\"", ",", "drelyandescr", ",", 
                    "decayDescr", ",", 
                    RowBox[{"SensitivityExtractor", "[", 
                    RowBox[{
                    "selprod", ",", "Npot", ",", "NevMin", ",", 
                    "decayDescr"}], "]"}]}], "}"}], "}"}]}], "]"}]}], ";"}], 
             "\[IndentingNewLine]", ",", 
             RowBox[{"{", 
              RowBox[{"j", ",", "1", ",", 
               RowBox[{"Length", "[", "DrellYanChannelsList", "]"}]}], 
              "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"tabsens", "=", 
           RowBox[{"Drop", "[", 
            RowBox[{"tabsens", ",", "1"}], "]"}]}]}], "\[IndentingNewLine]", ",",
          "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"selprod", "=", "SelectedProduction"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"tabsens", "=", 
           RowBox[{"{", 
            RowBox[{"{", 
             RowBox[{
             "selprod", ",", "\"\<None\>\"", ",", "\"\<None\>\"", ",", 
              "decayDescr", ",", 
              RowBox[{"SensitivityExtractor", "[", 
               RowBox[{
               "selprod", ",", "Npot", ",", "NevMin", ",", "decayDescr"}], 
               "]"}]}], "}"}], "}"}]}]}]}], "\[IndentingNewLine]", "]"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", "tabsens"}]}],
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SensitivityBlock", "[", 
   RowBox[{"NevMin_", ",", "Npot_", ",", "SelectedProduction_"}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"TabSens", "=", 
      RowBox[{"Flatten", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"SensitivityExtractorBremDrellYan", "[", 
           RowBox[{
           "SelectedProduction", ",", "Npot", ",", "NevMin", ",", 
            "decayDescr"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"decayDescr", ",", "decaydescriptions"}], "}"}]}], "]"}], ",",
         "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"filenameexport", "=", 
      RowBox[{"FileNameJoin", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"directory", "[", "\"\<Sensitivity-LLP-exp\>\"", "]"}], ",", 
         RowBox[{"ToString", "@", 
          RowBox[{"StringForm", "[", 
           RowBox[{"\"\<Sensitivity_``_at_``_Nev=``_Npot=``.\>\"", ",", 
            RowBox[{"Sequence", "@@", 
             RowBox[{"{", 
              RowBox[{"LLPdirName", ",", "ExperimentFolder", ",", 
               RowBox[{"NevMin", "//", "ToString"}], ",", 
               RowBox[{
                RowBox[{
                 RowBox[{"SetPrecision", "[", 
                  RowBox[{
                   RowBox[{"Npot", "//", "N"}], ",", "3"}], "]"}], "//", 
                 "CForm"}], "//", "ToString"}]}], "}"}]}]}], "]"}]}]}], "}"}],
        "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"assocData", "=", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Association", "[", 
          RowBox[{
           RowBox[{"\"\<Production modes\>\"", "->", 
            RowBox[{"#", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], ",", 
           RowBox[{"\"\<Bremsstrahlung description\>\"", "->", 
            RowBox[{"#", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], ",", 
           RowBox[{"\"\<Drell-Yan description\>\"", "->", 
            RowBox[{"#", "[", 
             RowBox[{"[", "3", "]"}], "]"}]}], ",", 
           RowBox[{"\"\<Decay description\>\"", "->", 
            RowBox[{"#", "[", 
             RowBox[{"[", "4", "]"}], "]"}]}], ",", 
           RowBox[{"\"\<Sensitivity domains\>\"", "->", 
            RowBox[{"#", "[", 
             RowBox[{"[", "5", "]"}], "]"}]}]}], "]"}], "&"}], ",", 
        "TabSens"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Export", "[", 
      RowBox[{
       RowBox[{"filenameexport", "<>", "\"\<mx\>\""}], ",", "TabSens", 
       ",", "\"\<MX\>\""}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Export", "[", 
      RowBox[{
       RowBox[{"filenameexport", "<>", "\"\<json\>\""}], ",", "assocData", 
       ",", "\"\<JSON\>\""}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", "TabSens", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Import", "[", 
      RowBox[{
       RowBox[{"filenameexport", "<>", "\"\<mx\>\""}], ",", "\"\<MX\>\""}], 
      "]"}]}]}], "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.8889936997762337`*^9, 3.8889937382921906`*^9}, {
   3.88899385262287*^9, 3.888993853042823*^9}, {3.8889939031947403`*^9, 
   3.8889939052817664`*^9}, {3.8889939588761787`*^9, 3.888994072394391*^9}, {
   3.8889941392721796`*^9, 3.8889941490041194`*^9}, {3.8889941930377913`*^9, 
   3.888994195131672*^9}, {3.8889942375929303`*^9, 3.888994293018688*^9}, 
   3.889155194091461*^9, {3.8891555444676304`*^9, 3.889155549549215*^9}, {
   3.893571069154917*^9, 3.893571071767774*^9}, {3.8935717622889104`*^9, 
   3.893571762661867*^9}, {3.8937449281930075`*^9, 3.8937449281930075`*^9}, {
   3.895052697251217*^9, 3.8950527065423837`*^9}, {3.895052741520686*^9, 
   3.895052773888977*^9}, {3.8950531140499244`*^9, 3.8950531238647213`*^9}, {
   3.8950534729321213`*^9, 3.8950534805926685`*^9}, {3.895054123563283*^9, 
   3.895054124582183*^9}, {3.89506997775191*^9, 3.895069978330577*^9}, 
   3.8950768982807426`*^9, {3.8955602490044713`*^9, 3.895560287932702*^9}, {
   3.895560370984571*^9, 3.8955603759796324`*^9}, {3.895560785367902*^9, 
   3.895560786049657*^9}, {3.8956541535400777`*^9, 3.895654263939839*^9}, {
   3.8956543140076876`*^9, 3.895654320367178*^9}, {3.895654423200385*^9, 
   3.8956544481154737`*^9}, {3.895654565591157*^9, 3.895654588365079*^9}, {
   3.8956549560646706`*^9, 3.8956549563255477`*^9}, {3.8961553899588184`*^9, 
   3.8961553997391524`*^9}, {3.897234346691803*^9, 3.897234358286152*^9}, {
   3.8975468465813923`*^9, 3.8975468508167267`*^9}, {3.8975468853793488`*^9, 
   3.897546895875827*^9}, {3.903791118494033*^9, 3.903791118498568*^9}, 
   3.9037950980239325`*^9, {3.9037970359365463`*^9, 3.903797035991943*^9}, 
   3.9037971257176876`*^9, {3.903797196741515*^9, 3.903797301701374*^9}, 
   3.903854322563696*^9, {3.906194481542715*^9, 3.9061945201280785`*^9}, {
   3.9072587100895395`*^9, 3.9072587160108223`*^9}, {3.912155799675736*^9, 
   3.912155807333581*^9}, {3.9121643449720187`*^9, 3.9121643509522777`*^9}, {
   3.9138675579944167`*^9, 3.9138675580204244`*^9}, {3.9138715965312796`*^9, 
   3.9138716276874847`*^9}, {3.9138719120212083`*^9, 
   3.9138719199085875`*^9}, {3.9139643504873505`*^9, 3.913964379658358*^9}, {
   3.913964572154082*^9, 3.9139646080225725`*^9}, 3.913965562361379*^9, {
   3.913965634034275*^9, 3.9139656341035943`*^9}, {3.9146658909381113`*^9, 
   3.914665921326827*^9}, {3.914666192147833*^9, 3.9146661927662926`*^9}, {
   3.9146663089179897`*^9, 3.914666309396596*^9}, 3.914666521358018*^9, {
   3.9152626192463336`*^9, 3.915262623648288*^9}, {3.915298144843195*^9, 
   3.9152981509930887`*^9}, {3.9156429970506935`*^9, 3.91564299719407*^9}, {
   3.9162899317194767`*^9, 3.9162899320540724`*^9}, 3.9164596397671323`*^9, {
   3.950673222236952*^9, 3.950673276206747*^9}, {3.950673488118286*^9, 
   3.9506735270151176`*^9}, {3.950673606765167*^9, 3.950673609913294*^9}, {
   3.9506748614678326`*^9, 3.9506749071670647`*^9}, {3.9506749400990143`*^9, 
   3.9506749883051205`*^9}, {3.9506750200756607`*^9, 
   3.9506750394665623`*^9}, {3.950675071373871*^9, 3.950675169208004*^9}, {
   3.950675211487768*^9, 3.9506754597299366`*^9}, {3.9506755267569942`*^9, 
   3.9506755411526585`*^9}, 3.9506759767120457`*^9, {3.9508664748243294`*^9, 
   3.9508664748295*^9}, 3.9521592989406586`*^9, 3.9527001347951546`*^9, {
   3.952736914330944*^9, 3.952736914588217*^9}, {3.952842376433161*^9, 
   3.952842379188059*^9}},
 CellTags->
  "Sensitivity-computation",ExpressionUUID->"8f64fab3-94e2-432a-9ab3-\
44e819bfd780"]
}, Closed]],

Cell[CellGroupData[{

Cell["Sensitivity setup and plot", "Subsection",
 CellChangeTimes->{{3.93442849021461*^9, 3.934428496021304*^9}},
 CellTags->
  "Sensitivity-computation",ExpressionUUID->"582a549f-e1ac-ad4f-a713-\
3310984b98fc"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"productionlist", "=", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"{", "\"\<All\>\"", "}"}], ",", 
     "ProductionChannelsListUnified"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DynamicModule", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"input1", "=", "NpotDefault"}], ",", 
      RowBox[{"input2", "=", "2.3"}], ",", 
      RowBox[{"choice", "=", 
       RowBox[{"{", "\"\<All\>\"", "}"}]}], ",", "list", ",", "phrase"}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"DialogInput", "[", 
     RowBox[{"Column", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Style", "[", 
         RowBox[{"ExperimentFolder", ",", "Bold"}], "]"}], ",", 
        RowBox[{
        "TextCell", "[", "\"\<Enter the number of proton collisions:\>\"", 
         "]"}], ",", 
        RowBox[{"InputField", "[", 
         RowBox[{
          RowBox[{"Dynamic", "[", "input1", "]"}], ",", "Expression"}], "]"}],
         ",", 
        RowBox[{
        "TextCell", "[", 
         "\"\<Enter the value of N_ev,min for which the sensitivity will be \
computed:\>\"", "]"}], ",", 
        RowBox[{"InputField", "[", 
         RowBox[{
          RowBox[{"Dynamic", "[", "input2", "]"}], ",", "Expression"}], "]"}],
         ",", 
        RowBox[{"Row", "[", 
         RowBox[{
         "{", "\"\<Select the production channels to be used for the \
sensitivity calculation:\>\"", "}"}], "]"}], ",", 
        RowBox[{"Pane", "[", 
         RowBox[{
          RowBox[{"TogglerBar", "[", 
           RowBox[{
            RowBox[{"Dynamic", "[", "choice", "]"}], ",", "productionlist", 
            ",", 
            RowBox[{"Appearance", "->", 
             RowBox[{"\"\<Vertical\>\"", "->", 
              RowBox[{"{", 
               RowBox[{"Automatic", ",", "1"}], "}"}]}]}]}], "]"}], ",", 
          RowBox[{"ImageSize", "->", 
           RowBox[{"{", 
            RowBox[{"Automatic", ",", "Automatic"}], "}"}]}], ",", 
          RowBox[{"Scrollbars", "->", 
           RowBox[{"{", 
            RowBox[{"False", ",", "True"}], "}"}]}]}], "]"}], ",", 
        RowBox[{"Button", "[", 
         RowBox[{"\"\<Submit\>\"", ",", 
          RowBox[{"DialogReturn", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"NpotVal", ",", "NevMinVal", ",", "SelectedProduction"}],
              "}"}], "=", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"input1", ",", "input2", ",", "choice"}], "}"}], "//", 
             "N"}]}], "]"}], ",", 
          RowBox[{"ImageSize", "->", "Automatic"}]}], "]"}]}], "}"}], "]"}], 
     "]"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"MemberQ", "[", 
    RowBox[{"SelectedProduction", ",", "\"\<All\>\""}], "]"}], ",", 
   RowBox[{
    RowBox[{"SelectedProduction", "=", "ProductionChannelsListUnified"}], 
    ";"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "\"\<\!\(\*SubscriptBox[\(N\), \(PoT\)]\) for computation\>\"", ",", 
      "\"\<\!\(\*SubscriptBox[\(N\), \(ev, min\)]\)\>\"", ",", 
      "\"\<Selected production modes\>\""}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"NpotVal", ",", "NevMinVal", ",", "SelectedProduction"}], 
     "}"}]}], "}"}], "//", "TableForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sens", "=", 
   RowBox[{"SensitivityBlock", "[", 
    RowBox[{"NevMinVal", ",", "NpotVal", ",", "SelectedProduction"}], "]"}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"legends", "=", 
   RowBox[{"sens", "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", 
      RowBox[{"-", "2"}]}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sensregions", "=", 
   RowBox[{"sens", "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", 
      RowBox[{"-", "1"}]}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"descriptors", "=", 
   RowBox[{"sens", "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", 
      RowBox[{"{", 
       RowBox[{"2", ",", "3", ",", "4"}], "}"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ColorsForPlot", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"Thick", ",", "Blue"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"Thick", ",", 
       RowBox[{"Darker", "@", "Red"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"Thick", ",", 
       RowBox[{"Darker", "@", 
        RowBox[{"Darker", "@", "Green"}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"Thick", ",", 
       RowBox[{"Darker", "@", "Cyan"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"Thick", ",", "Magenta"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"Thick", ",", " ", "Black"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"Thick", ",", 
       RowBox[{"Lighter", "@", "Brown"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"Thick", ",", 
       RowBox[{"Lighter", "@", "Blue"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"Thick", ",", 
       RowBox[{"Lighter", "@", "Red"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"Thick", ",", 
       RowBox[{"Lighter", "@", "Green"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"Thick", ",", "Blue", ",", 
       RowBox[{"Dashing", "[", "0.02", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"Thick", ",", 
       RowBox[{"Darker", "@", "Red"}], ",", 
       RowBox[{"Dashing", "[", "0.02", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"Thick", ",", 
       RowBox[{"Darker", "@", 
        RowBox[{"Darker", "@", "Green"}]}], ",", 
       RowBox[{"Dashing", "[", "0.02", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"Thick", ",", 
       RowBox[{"Darker", "@", "Cyan"}], ",", 
       RowBox[{"Dashing", "[", "0.02", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"Thick", ",", "Magenta", ",", 
       RowBox[{"Dashing", "[", "0.02", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"Thick", ",", "Black", ",", 
       RowBox[{"Dashing", "[", "0.02", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"Thick", ",", 
       RowBox[{"Lighter", "@", "Brown"}], ",", 
       RowBox[{"Dashing", "[", "0.02", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"Thick", ",", 
       RowBox[{"Lighter", "@", "Blue"}], ",", 
       RowBox[{"Dashing", "[", "0.02", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"Thick", ",", 
       RowBox[{"Lighter", "@", "Red"}], ",", 
       RowBox[{"Dashing", "[", "0.02", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"Thick", ",", 
       RowBox[{"Lighter", "@", "Green"}], ",", 
       RowBox[{"Dashing", "[", "0.02", "]"}]}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"plotstylelist", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"ConstantArray", "[", 
        RowBox[{
         RowBox[{"ColorsForPlot", "[", 
          RowBox[{"[", "i", "]"}], "]"}], ",", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"MatrixQ", "[", 
            RowBox[{"sensregions", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", "1", ",", 
           RowBox[{"Length", "@", 
            RowBox[{"sensregions", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}]}], "]"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "sensregions", "]"}], ",", "1"}], "}"}]}], 
      "]"}], ",", "1"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pt2", "=", 
   RowBox[{"Show", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ListLogLogPlot", "[", 
      RowBox[{
       RowBox[{"Cases", "[", 
        RowBox[{"sensregions", ",", 
         RowBox[{"_", "?", "MatrixQ"}], ",", "All"}], "]"}], ",", 
       RowBox[{"Joined", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"True", ",", "True", ",", "True", ",", "True"}], "}"}]}], 
       ",", 
       RowBox[{"Frame", "\[Rule]", " ", "True"}], ",", 
       RowBox[{"FrameLabel", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"massLabel", ",", "couplingLabel"}], "}"}]}], ",", 
       RowBox[{"FrameStyle", "\[Rule]", 
        RowBox[{"Directive", "[", 
         RowBox[{"Black", ",", " ", "23", ",", "Thick"}], "]"}]}], ",", 
       RowBox[{"PlotStyle", "\[Rule]", "plotstylelist"}], ",", 
       RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
       RowBox[{"PlotRange", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"1.01", 
             RowBox[{"mminmaxOverall", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], ",", 
            RowBox[{"1.1", 
             RowBox[{"mminmaxOverall", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"couplingminmaxOverall", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            RowBox[{"Max", "[", 
             RowBox[{"0.99", 
              RowBox[{"couplingminmaxOverall", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "}"}]}], "}"}]}], 
       ",", 
       RowBox[{"PlotLabel", "\[Rule]", 
        RowBox[{"Style", "[", 
         RowBox[{
          RowBox[{"Row", "[", 
           RowBox[{
           "{", "\"\<Uncertainty: bremsstrahlung, Drell-Yan, decays\>\"", 
            "}"}], "]"}], ",", "18", ",", "Black"}], "]"}]}]}], "]"}], ",", 
     RowBox[{"LogLogPlot", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1"}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", "1", ",", "10"}], "}"}], ",", 
       RowBox[{"PlotStyle", "\[Rule]", 
        RowBox[{"DeleteDuplicates", "[", "plotstylelist", "]"}]}], ",", 
       RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
       RowBox[{"PlotRange", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"1.01", 
             RowBox[{"mminmaxOverall", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], ",", 
            RowBox[{"1.1", 
             RowBox[{"mminmaxOverall", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"couplingminmaxOverall", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            RowBox[{"Max", "[", 
             RowBox[{"0.2", ",", 
              RowBox[{"0.99", 
               RowBox[{"couplingminmaxOverall", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}]}], "]"}]}], "}"}]}], "}"}]}],
        ",", 
       RowBox[{"PlotLabel", "\[Rule]", 
        RowBox[{"Style", "[", 
         RowBox[{
          RowBox[{"Row", "[", 
           RowBox[{"{", 
            RowBox[{
            "GivenExperimentForSensitivityComputation", ",", 
             "\"\<, \!\(\*SubscriptBox[\(N\), \(events\)]\) \[GreaterEqual] \
\>\"", ",", "NevMinVal"}], "}"}], "]"}], ",", "18", ",", "Black"}], "]"}]}], 
       ",", 
       RowBox[{"PlotLegends", "\[Rule]", 
        RowBox[{"Placed", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Style", "[", 
             RowBox[{
              RowBox[{"Row", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"#", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], ",", "\"\<,\>\"", ",", 
                 RowBox[{"#", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], ",", "\"\<,\>\"", ",", 
                 RowBox[{"#", "[", 
                  RowBox[{"[", "3", "]"}], "]"}]}], "}"}], "]"}], ",", "15"}],
              "]"}], "&"}], "/@", "descriptors"}], ",", 
          RowBox[{"{", 
           RowBox[{"0.75", ",", "0.75"}], "}"}]}], "]"}]}]}], "]"}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"inum", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
  "infoDialog", "[", 
   "\"\<Note that the current version of constraints is inconsistent with the \
phenomenology used to calculate the sensitivities (to be updated)\>\"", "]"}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pt1", "=", 
   RowBox[{"Show", "[", 
    RowBox[{
     RowBox[{"ListLogLogPlot", "[", 
      RowBox[{
       RowBox[{"Cases", "[", 
        RowBox[{
         RowBox[{"ExcludedRegions", "[", "LLPdirName", "]"}], ",", 
         RowBox[{"_", "?", "MatrixQ"}], ",", "All"}], "]"}], ",", 
       RowBox[{"Joined", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"True", ",", "True", ",", "True", ",", "True"}], "}"}]}], 
       ",", 
       RowBox[{"Frame", "\[Rule]", " ", "True"}], ",", 
       RowBox[{"FrameLabel", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"massLabel", ",", "couplingLabel"}], "}"}]}], ",", 
       RowBox[{"FrameStyle", "\[Rule]", 
        RowBox[{"Directive", "[", 
         RowBox[{"Black", ",", " ", "23", ",", "Thick"}], "]"}]}], ",", 
       RowBox[{"PlotStyle", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{"Thick", ",", "Gray"}], "}"}], "}"}]}], ",", 
       RowBox[{"Filling", "\[Rule]", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"i", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"True", ",", 
             RowBox[{"Directive", "[", 
              RowBox[{"Gray", ",", 
               RowBox[{"Opacity", "[", "0.3", "]"}]}], "]"}]}], "}"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "10", ",", "1"}], "}"}]}], "]"}]}], 
       ",", 
       RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
       RowBox[{"PlotRange", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"1.01", 
             RowBox[{"mminmaxOverall", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], ",", 
            RowBox[{"1.1", 
             RowBox[{"mminmaxOverall", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"0.3", 
             RowBox[{"Min", "[", 
              RowBox[{"Flatten", "[", "sensregions", "]"}], "]"}]}], ",", 
            RowBox[{"0.99", 
             RowBox[{"couplingminmaxOverall", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}]}], "}"}]}], ",", 
       RowBox[{"PlotLabel", "\[Rule]", 
        RowBox[{"Style", "[", 
         RowBox[{
          RowBox[{"Row", "[", 
           RowBox[{"{", 
            RowBox[{
            "GivenExperimentForSensitivityComputation", ",", 
             "\"\<, \!\(\*SubscriptBox[\(N\), \(events\)]\) \[GreaterEqual] \
\>\"", ",", "NevMinVal"}], "}"}], "]"}], ",", "18", ",", "Black"}], "]"}]}]}],
       "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"ListLogLogPlot", "[", 
      RowBox[{
       RowBox[{"Cases", "[", 
        RowBox[{
         RowBox[{"sensregions", "[", 
          RowBox[{"[", "inum", "]"}], "]"}], ",", 
         RowBox[{"_", "?", "MatrixQ"}], ",", "All"}], "]"}], ",", 
       RowBox[{"Joined", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"True", ",", "True", ",", "True", ",", "True"}], "}"}]}], 
       ",", 
       RowBox[{"PlotStyle", "\[Rule]", "plotstylelist"}], ",", 
       RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
       RowBox[{"PlotRange", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"1.01", 
             RowBox[{"mminmaxOverall", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], ",", 
            RowBox[{"1.1", 
             RowBox[{"mminmaxOverall", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"couplingminmaxOverall", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            RowBox[{"Max", "[", 
             RowBox[{"0.2", ",", 
              RowBox[{"0.99", 
               RowBox[{"couplingminmaxOverall", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}]}], "]"}]}], "}"}]}], 
         "}"}]}]}], "]"}], ",", 
     RowBox[{"Graphics", "[", 
      RowBox[{"{", 
       RowBox[{"Text", "[", 
        RowBox[{
         RowBox[{"Style", "[", 
          RowBox[{"\"\<Excluded\>\"", ",", "24", ",", "Black"}], "]"}], ",", 
         RowBox[{"Scaled", "[", 
          RowBox[{"{", 
           RowBox[{"0.2", ",", "0.5"}], "}"}], "]"}]}], "]"}], "}"}], "]"}], 
     ",", 
     RowBox[{"LogLogPlot", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1"}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", "1", ",", "10"}], "}"}], ",", 
       RowBox[{"PlotStyle", "\[Rule]", 
        RowBox[{"DeleteDuplicates", "[", "plotstylelist", "]"}]}], ",", 
       RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
       RowBox[{"PlotRange", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"1.01", 
             RowBox[{"mminmaxOverall", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], ",", 
            RowBox[{"1.1", 
             RowBox[{"mminmaxOverall", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"couplingminmaxOverall", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            RowBox[{"Max", "[", 
             RowBox[{"0.2", ",", 
              RowBox[{"0.99", 
               RowBox[{"couplingminmaxOverall", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}]}], "]"}]}], "}"}]}], "}"}]}],
        ",", 
       RowBox[{"PlotLabel", "\[Rule]", 
        RowBox[{"Style", "[", 
         RowBox[{
          RowBox[{"Row", "[", 
           RowBox[{"{", 
            RowBox[{
            "GivenExperimentForSensitivityComputation", ",", 
             "\"\<, \!\(\*SubscriptBox[\(N\), \(events\)]\) \[GreaterEqual] \
\>\"", ",", "NevMinVal"}], "}"}], "]"}], ",", "18", ",", "Black"}], "]"}]}], 
       ",", 
       RowBox[{"PlotLegends", "\[Rule]", 
        RowBox[{"Placed", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Style", "[", 
             RowBox[{
              RowBox[{"Row", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"#", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], ",", "\"\<,\>\"", ",", 
                 RowBox[{"#", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], ",", "\"\<,\>\"", ",", 
                 RowBox[{"#", "[", 
                  RowBox[{"[", "3", "]"}], "]"}]}], "}"}], "]"}], ",", "15"}],
              "]"}], "&"}], "/@", 
           RowBox[{"(", 
            RowBox[{"{", 
             RowBox[{"descriptors", "[", 
              RowBox[{"[", "inum", "]"}], "]"}], "}"}], ")"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"0.2", ",", "0.15"}], "}"}]}], "]"}]}]}], "]"}]}], "]"}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{"Style", "[", 
  RowBox[{"Row", "[", 
   RowBox[{"{", 
    RowBox[{"pt1", ",", "pt2"}], "}"}], "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.9506736748850727`*^9, 3.950673740143261*^9}, {
   3.9506737866145782`*^9, 3.950673790226671*^9}, 3.950674664251753*^9, {
   3.950675641594269*^9, 3.9506756417058144`*^9}, 3.9506758816311016`*^9, {
   3.9506761028473587`*^9, 3.950676129459345*^9}, {3.9525893266657333`*^9, 
   3.952589339177849*^9}, {3.952738735381014*^9, 3.952738753441761*^9}, {
   3.9527407519128036`*^9, 3.9527407611129017`*^9}},
 CellTags->
  "Sensitivity-computation",ExpressionUUID->"a09d5048-69f6-004c-be52-\
76389258a3d9"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Computing uncertainties regions", "Section",
 CellChangeTimes->{{3.9526691927510204`*^9, 3.952669197462694*^9}},
 CellTags->
  "Sensitivity-computation",ExpressionUUID->"6021facd-3912-304d-883c-\
9c23a498452b"],

Cell[CellGroupData[{

Cell["\<\
Defining boundaries of the number of events within the uncertainty\
\>", "Subsection",
 CellChangeTimes->{{3.952696840786892*^9, 3.952696850881628*^9}},
 CellTags->
  "Sensitivity-computation",ExpressionUUID->"9fde3f02-c676-fb4a-b5e0-\
11624bdc274c"],

Cell[BoxData[
 RowBox[{"If", "[", 
  RowBox[{"ifUncCalc", ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"uncchoices", "=", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"lower", ",", "central", ",", "upper"}], "}"}], "=", 
      RowBox[{"{", 
       RowBox[{
       "\"\<Lower\>\"", ",", "\"\<Central\>\"", ",", "\"\<Upper\>\""}], 
       "}"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"NevIntUnc", ",", "NevTemp"}], "}"}], "//", "Clear"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"Production", " ", "only"}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{"IfBremUnc", "=", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"ToString", "[", 
         RowBox[{"Head", "[", "BremChannelsList", "]"}], "]"}], "==", 
        "\"\<List\>\""}], ",", 
       RowBox[{
        RowBox[{"Select", "[", 
         RowBox[{"BremChannelsList", ",", 
          RowBox[{
           RowBox[{"StringContainsQ", "[", 
            RowBox[{"#", ",", "\"\<Central\>\""}], "]"}], "&"}]}], "]"}], "!=", 
        RowBox[{"{", "}"}]}], ",", "False"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"IfDrellYanUnc", "=", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"ToString", "[", 
         RowBox[{"Head", "[", "DrellYanChannelsList", "]"}], "]"}], "==", 
        "\"\<List\>\""}], ",", 
       RowBox[{
        RowBox[{"Select", "[", 
         RowBox[{"DrellYanChannelsList", ",", 
          RowBox[{
           RowBox[{"StringContainsQ", "[", 
            RowBox[{"#", ",", "\"\<Central\>\""}], "]"}], "&"}]}], "]"}], "!=", 
        RowBox[{"{", "}"}]}], ",", "False"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"IfProdUnc", "=", 
     RowBox[{"IfBremUnc", "||", "IfDrellYanUnc"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"ProductionNoDrellYanBrem", "=", 
     RowBox[{"Select", "[", 
      RowBox[{"ProductionChannelsBaseline", ",", 
       RowBox[{
        RowBox[{"!", 
         RowBox[{"StringContainsQ", "[", 
          RowBox[{"#", ",", 
           RowBox[{"{", 
            RowBox[{"\"\<Bremsstrahlung\>\"", ",", "\"\<DrellYan\>\""}], 
            "}"}]}], "]"}]}], "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"Do", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"ProductionListUnc", "[", "t", "]"}], "=", 
        "ProductionNoDrellYanBrem"}], ";"}], "\[IndentingNewLine]", ",", 
      RowBox[{"{", 
       RowBox[{"t", ",", "uncchoices"}], "}"}]}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{"IfBremUnc", ",", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"bremChoice", "[", "t", "]"}], "=", 
          RowBox[{
           RowBox[{"Select", "[", 
            RowBox[{"BremChannelsList", ",", 
             RowBox[{
              RowBox[{"StringContainsQ", "[", 
               RowBox[{"#", ",", "t"}], "]"}], "&"}]}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"ProductionListUnc", "[", "t", "]"}], "=", 
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"ProductionListUnc", "[", "t", "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"bremChoice", "[", "t", "]"}], "}"}]}], "]"}]}]}], 
        "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"t", ",", "uncchoices"}], "}"}]}], "]"}]}], 
     "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{"IfDrellYanUnc", ",", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"drellYanChoice", "[", "t", "]"}], "=", 
          RowBox[{
           RowBox[{"Select", "[", 
            RowBox[{"DrellYanChannelsList", ",", 
             RowBox[{
              RowBox[{"StringContainsQ", "[", 
               RowBox[{"#", ",", "t"}], "]"}], "&"}]}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"ProductionListUnc", "[", "t", "]"}], "=", 
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"ProductionListUnc", "[", "t", "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"drellYanChoice", "[", "t", "]"}], "}"}]}], "]"}]}]}], 
        "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"t", ",", "uncchoices"}], "}"}]}], "]"}]}], 
     "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"IfDecayUnc", "=", 
     RowBox[{
      RowBox[{"Select", "[", 
       RowBox[{"decaydescriptions", ",", 
        RowBox[{
         RowBox[{"StringContainsQ", "[", 
          RowBox[{"#", ",", "\"\<Central\>\""}], "]"}], "&"}]}], "]"}], "!=", 
      RowBox[{"{", "}"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{"IfDecayUnc", ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"decChoice", "[", "t", "]"}], "=", 
          RowBox[{
           RowBox[{"Select", "[", 
            RowBox[{"decaydescriptions", ",", 
             RowBox[{
              RowBox[{"StringContainsQ", "[", 
               RowBox[{"#", ",", "t"}], "]"}], "&"}]}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"t", ",", "uncchoices"}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"decayDescrProd", "=", 
        RowBox[{"decChoice", "[", "\"\<Central\>\"", "]"}]}], ";"}], 
      "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
      RowBox[{"decayDescrProd", "=", 
       RowBox[{"decaydescriptions", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}]}], "\[IndentingNewLine]", "]"}], ";",
     "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{"IfProdUnc", ",", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"NevIntUnc", "[", 
           RowBox[{"\"\<Production\>\"", ",", "t", ",", "mLLP_", ",", "y_"}], 
           "]"}], "=", 
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{"NevInt", "[", 
             RowBox[{"mLLP", ",", "y", ",", "prod", ",", "decayDescrProd"}], 
             "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"prod", ",", 
              RowBox[{"ProductionListUnc", "[", "t", "]"}]}], "}"}]}], 
           "]"}]}], ";"}], "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"t", ",", "uncchoices"}], "}"}]}], "]"}]}], 
     "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{"IfDecayUnc", ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"ResourceFunction", "[", "\"\<MonitorProgress\>\"", "]"}], 
        "@", 
        RowBox[{"Do", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"NevTemp", "[", 
             RowBox[{"\"\<Decay\>\"", ",", "t", ",", "mLLP_", ",", "y_"}], 
             "]"}], "=", 
            RowBox[{"Sum", "[", 
             RowBox[{
              RowBox[{"NevInt", "[", 
               RowBox[{"mLLP", ",", "y", ",", "prod", ",", 
                RowBox[{"decChoice", "[", "t", "]"}]}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"prod", ",", 
                RowBox[{"ProductionListUnc", "[", "\"\<Central\>\"", "]"}]}], 
               "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{"IfProdUnc", ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"NevTemp", "[", 
                RowBox[{"\"\<All\>\"", ",", "t", ",", "mLLP_", ",", "y_"}], 
                "]"}], "=", 
               RowBox[{"Sum", "[", 
                RowBox[{
                 RowBox[{"NevInt", "[", 
                  RowBox[{"mLLP", ",", "y", ",", "prod", ",", 
                   RowBox[{"decChoice", "[", "t", "]"}]}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"prod", ",", 
                   RowBox[{"ProductionListUnc", "[", "t", "]"}]}], "}"}]}], 
                "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}]}], 
          "\[IndentingNewLine]", ",", 
          RowBox[{"{", 
           RowBox[{"t", ",", "uncchoices"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"signaturesDec", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"Keys", "[", 
           RowBox[{"DownValues", "@", "NevTemp"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "1", ",", "1"}], "]"}], "]"}], "//", 
         "DeleteDuplicates"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"NevIntTabular", "[", "sign", "]"}], "=", 
           RowBox[{
            RowBox[{"Flatten", "[", 
             RowBox[{
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"m", ",", "th", ",", 
                  RowBox[{"NevTemp", "[", 
                   RowBox[{
                   "sign", ",", "\"\<Lower\>\"", ",", "m", ",", "th"}], "]"}],
                   ",", 
                  RowBox[{"NevTemp", "[", 
                   RowBox[{
                   "sign", ",", "\"\<Central\>\"", ",", "m", ",", "th"}], 
                   "]"}], ",", 
                  RowBox[{"NevTemp", "[", 
                   RowBox[{
                   "sign", ",", "\"\<Upper\>\"", ",", "m", ",", "th"}], 
                   "]"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"m", ",", "mgridfull"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"th", ",", 
                  RowBox[{"couplinggrid", "[", 
                   RowBox[{
                    RowBox[{"ProductionChannelsBaseline", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", "decayDescrProd"}], 
                   "]"}]}], "}"}]}], "]"}], ",", "1"}], "]"}], "//", 
            "Developer`ToPackedArray"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"NevIntUnc", "[", 
            RowBox[{"sign", ",", "\"\<Lower\>\"", ",", "mLLP_", ",", "y_"}], 
            "]"}], "=", 
           RowBox[{
            RowBox[{
             RowBox[{"Interpolation", "[", 
              RowBox[{
               RowBox[{"Log", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"Min", "[", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ",", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "4", "]"}], "]"}], ",", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "5", "]"}], "]"}]}], "]"}], "+", 
                    SuperscriptBox["10", 
                    RowBox[{"-", "90."}]]}]}], "}"}], "&"}], "/@", 
                 RowBox[{"NevIntTabular", "[", "sign", "]"}]}], "]"}], ",", 
               RowBox[{"InterpolationOrder", "->", "1"}]}], "]"}], "[", 
             RowBox[{
              RowBox[{"Log", "[", "mLLP", "]"}], ",", 
              RowBox[{"Log", "[", "y", "]"}]}], "]"}], "//", "Exp"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"NevIntUnc", "[", 
            RowBox[{"sign", ",", "\"\<Upper\>\"", ",", "mLLP_", ",", "y_"}], 
            "]"}], "=", 
           RowBox[{
            RowBox[{
             RowBox[{"Interpolation", "[", 
              RowBox[{
               RowBox[{"Log", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"Max", "[", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ",", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "4", "]"}], "]"}], ",", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "5", "]"}], "]"}]}], "]"}], "+", 
                    SuperscriptBox["10", 
                    RowBox[{"-", "90."}]]}]}], "}"}], "&"}], "/@", 
                 RowBox[{"NevIntTabular", "[", "sign", "]"}]}], "]"}], ",", 
               RowBox[{"InterpolationOrder", "->", "1"}]}], "]"}], "[", 
             RowBox[{
              RowBox[{"Log", "[", "mLLP", "]"}], ",", 
              RowBox[{"Log", "[", "y", "]"}]}], "]"}], "//", "Exp"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"NevIntUnc", "[", 
            RowBox[{"sign", ",", "\"\<Central\>\"", ",", "mLLP_", ",", "y_"}],
             "]"}], "=", 
           RowBox[{
            RowBox[{
             RowBox[{"Interpolation", "[", 
              RowBox[{
               RowBox[{"Log", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "4", "]"}], "]"}], "+", 
                    SuperscriptBox["10", 
                    RowBox[{"-", "90."}]]}]}], "}"}], "&"}], "/@", 
                 RowBox[{"NevIntTabular", "[", "sign", "]"}]}], "]"}], ",", 
               RowBox[{"InterpolationOrder", "->", "1"}]}], "]"}], "[", 
             RowBox[{
              RowBox[{"Log", "[", "mLLP", "]"}], ",", 
              RowBox[{"Log", "[", "y", "]"}]}], "]"}], "//", "Exp"}]}], ";"}],
          "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"sign", ",", "signaturesDec"}], "}"}]}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"signaturesAvailable", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"Keys", "[", 
        RowBox[{"DownValues", "@", "NevIntUnc"}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "1", ",", "1"}], "]"}], "]"}], "//", 
      "DeleteDuplicates"}]}]}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{
  3.9526960711465435`*^9, {3.952696176920355*^9, 3.952696231282837*^9}, {
   3.952696280875105*^9, 3.952696581772297*^9}, {3.9526966183636723`*^9, 
   3.952696715683304*^9}, {3.952696757632292*^9, 3.9526968308489895`*^9}, {
   3.9526970262147903`*^9, 3.9526971275477448`*^9}, {3.952697229914341*^9, 
   3.9526973786435184`*^9}, {3.9526974190128536`*^9, 
   3.9526974195026836`*^9}, {3.952697488043375*^9, 3.9526975038935776`*^9}, {
   3.952697728576313*^9, 3.9526977971900883`*^9}, {3.9526979708997*^9, 
   3.952697975482252*^9}, {3.9526984629190025`*^9, 3.9526985008015003`*^9}, {
   3.9526990166407223`*^9, 3.9526990425645084`*^9}, {3.9527001548953896`*^9, 
   3.95270016423489*^9}, {3.9527385137445297`*^9, 3.952738541470089*^9}},
 CellTags->"Sensitivity-computation",
 CellLabel->
  "In[618]:=",ExpressionUUID->"6378a9e4-eb30-8c42-986c-286407554b62"]
}, Closed]],

Cell[CellGroupData[{

Cell["Computing the uncertainty", "Subsection",
 CellChangeTimes->{{3.9526733778376503`*^9, 3.952673395239128*^9}},
 CellTags->
  "Sensitivity-computation",ExpressionUUID->"ad894679-8bc4-0941-86eb-\
6243caebc201"],

Cell[BoxData[
 RowBox[{"If", "[", 
  RowBox[{"ifUncCalc", ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"UncertaintyExtractor", "[", 
      RowBox[{"signature_", ",", "Npot_", ",", "NevMin_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"RegSens", ",", "SensTemp"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Do", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"NevTot", "[", 
             RowBox[{"mLLP_", ",", "coupling_", ",", "t"}], "]"}], "=", 
            RowBox[{"NevIntUnc", "[", 
             RowBox[{"signature", ",", "t", ",", "mLLP", ",", "coupling"}], 
             "]"}]}], ";"}], "\[IndentingNewLine]", ",", 
          RowBox[{"{", 
           RowBox[{"t", ",", "uncchoices"}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"RegUnc1", ",", "RegUnc2", ",", "RegUnc3", ",", "RegUnc4"}],
           "}"}], "=", 
         RowBox[{
          RowBox[{"ResourceFunction", "[", "\"\<MonitorProgress\>\"", "]"}], 
          "@", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"RegionPlot", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 FractionBox["Npot", "NpotDefault"], 
                 RowBox[{"NevTot", "[", 
                  RowBox[{
                   SuperscriptBox["10", "mLLP"], ",", 
                   SuperscriptBox["10", "\[Epsilon]2"], ",", 
                   "\"\<Lower\>\""}], "]"}], "*", 
                 RowBox[{"exclRes", "[", 
                  SuperscriptBox["10", "mLLP"], "]"}]}], "<=", "NevMin"}], "&&", 
               RowBox[{
                RowBox[{
                 FractionBox["Npot", "NpotDefault"], 
                 RowBox[{"NevTot", "[", 
                  RowBox[{
                   SuperscriptBox["10", "mLLP"], ",", 
                   SuperscriptBox["10", "\[Epsilon]2"], ",", 
                   "\"\<Upper\>\""}], "]"}], "*", 
                 RowBox[{"exclRes", "[", 
                  SuperscriptBox["10", "mLLP"], "]"}]}], ">=", "NevMin"}], "&&", 
               RowBox[{
                RowBox[{
                 FractionBox[
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"NevTot", "[", 
                    RowBox[{
                    SuperscriptBox["10", "mLLP"], ",", 
                    SuperscriptBox["10", "\[Epsilon]2"], ",", 
                    "\"\<Upper\>\""}], "]"}], "-", 
                    RowBox[{"NevTot", "[", 
                    RowBox[{
                    SuperscriptBox["10", "mLLP"], ",", 
                    SuperscriptBox["10", "\[Epsilon]2"], ",", 
                    "\"\<Lower\>\""}], "]"}]}], ")"}], 
                  RowBox[{"Max", "[", 
                   RowBox[{
                    RowBox[{"NevTot", "[", 
                    RowBox[{
                    SuperscriptBox["10", "mLLP"], ",", 
                    SuperscriptBox["10", "\[Epsilon]2"], ",", 
                    "\"\<Upper\>\""}], "]"}], ",", 
                    SuperscriptBox["10", 
                    RowBox[{"-", "90."}]]}], "]"}]], "*", 
                 RowBox[{"exclRes", "[", 
                  SuperscriptBox["10", "mLLP"], "]"}]}], ">", "0.1"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"mLLP", ",", 
                RowBox[{"Log10", "[", 
                 RowBox[{
                  RowBox[{"massranges", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
                RowBox[{"Log10", "[", 
                 RowBox[{
                  RowBox[{"massranges", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"\[Epsilon]2", ",", 
                RowBox[{"Log10", "[", 
                 RowBox[{"couplingminmaxOverall", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
                RowBox[{"Log10", "[", 
                 RowBox[{"couplingminmaxOverall", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "}"}], ",", 
              RowBox[{"PlotPoints", "->", "200"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"Length", "[", "massranges", "]"}], ",", "1"}], "}"}]}],
            "]"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"UncTemp", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Join", "[", "##", "]"}], "&"}], "@@", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Cases", "[", 
              RowBox[{
               RowBox[{"Normal", "@", "#"}], ",", 
               RowBox[{
                RowBox[{"Line", "[", "x_", "]"}], "\[RuleDelayed]", "x"}], 
               ",", "Infinity"}], "]"}], "&"}], "/@", 
            RowBox[{"{", 
             RowBox[{
             "RegUnc1", ",", "RegUnc2", ",", "RegUnc3", ",", "RegUnc4"}], 
             "}"}]}], ")"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "RegCentral1", ",", "RegCentral2", ",", "RegCentral3", ",", 
           "RegCentral4"}], "}"}], "=", 
         RowBox[{
          RowBox[{"ResourceFunction", "[", "\"\<MonitorProgress\>\"", "]"}], 
          "@", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"RegionPlot", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                FractionBox["Npot", "NpotDefault"], 
                RowBox[{"NevTot", "[", 
                 RowBox[{
                  SuperscriptBox["10", "mLLP"], ",", 
                  SuperscriptBox["10", "\[Epsilon]2"], ",", 
                  "\"\<Central\>\""}], "]"}], "*", 
                RowBox[{"exclRes", "[", 
                 SuperscriptBox["10", "mLLP"], "]"}]}], ">=", "NevMin"}], ",", 
              RowBox[{"{", 
               RowBox[{"mLLP", ",", 
                RowBox[{"Log10", "[", 
                 RowBox[{
                  RowBox[{"massranges", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
                RowBox[{"Log10", "[", 
                 RowBox[{
                  RowBox[{"massranges", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"\[Epsilon]2", ",", 
                RowBox[{"Log10", "[", 
                 RowBox[{"couplingminmaxOverall", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
                RowBox[{"Log10", "[", 
                 RowBox[{"couplingminmaxOverall", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "}"}], ",", 
              RowBox[{"PlotPoints", "->", "200"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"Length", "[", "massranges", "]"}], ",", "1"}], "}"}]}],
            "]"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"CentrTemp", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Join", "[", "##", "]"}], "&"}], "@@", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Cases", "[", 
              RowBox[{
               RowBox[{"Normal", "@", "#"}], ",", 
               RowBox[{
                RowBox[{"Line", "[", "x_", "]"}], "\[RuleDelayed]", "x"}], 
               ",", "Infinity"}], "]"}], "&"}], "/@", 
            RowBox[{"{", 
             RowBox[{
             "RegCentral1", ",", "RegCentral2", ",", "RegCentral3", ",", 
              "RegCentral4"}], "}"}]}], ")"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"10", "^", 
                 RowBox[{"#", "[", 
                  RowBox[{"[", "1", "]"}], "]"}]}], ",", 
                RowBox[{"10", "^", 
                 RowBox[{"#", "[", 
                  RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}], "&"}], "/@", 
             RowBox[{"s", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"Length", "[", "s", "]"}], ",", "1"}], "}"}]}], "]"}], 
          ",", 
          RowBox[{"{", 
           RowBox[{"s", ",", 
            RowBox[{"{", 
             RowBox[{"CentrTemp", ",", "UncTemp"}], "}"}]}], "}"}]}], 
         "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"DynamicModule", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"input1", "=", "NpotDefault"}], ",", 
          RowBox[{"input2", "=", "2.3"}], ",", "list", ",", "phrase"}], "}"}],
         ",", "\[IndentingNewLine]", 
        RowBox[{"DialogInput", "[", 
         RowBox[{"Column", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Style", "[", 
             RowBox[{"ExperimentFolder", ",", "Bold"}], "]"}], ",", 
            RowBox[{
            "TextCell", "[", "\"\<Enter the number of proton collisions:\>\"",
              "]"}], ",", 
            RowBox[{"InputField", "[", 
             RowBox[{
              RowBox[{"Dynamic", "[", "input1", "]"}], ",", "Expression"}], 
             "]"}], ",", 
            RowBox[{
            "TextCell", "[", 
             "\"\<Enter the value of N_ev,min for which the sensitivity will \
be computed:\>\"", "]"}], ",", 
            RowBox[{"InputField", "[", 
             RowBox[{
              RowBox[{"Dynamic", "[", "input2", "]"}], ",", "Expression"}], 
             "]"}], ",", 
            RowBox[{"Button", "[", 
             RowBox[{"\"\<Submit\>\"", ",", 
              RowBox[{"DialogReturn", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"NpotVal", ",", "NevMinVal"}], "}"}], "=", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"input1", ",", "input2"}], "}"}], "//", "N"}]}], 
               "]"}], ",", 
              RowBox[{"ImageSize", "->", "Automatic"}]}], "]"}]}], "}"}], 
          "]"}], "]"}]}], "]"}], ";"}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{"Print", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "\"\<\!\(\*SubscriptBox[\(N\), \(PoT\)]\) for computation\>\"", ",", 
          "\"\<\!\(\*SubscriptBox[\(N\), \(ev, min\)]\)\>\""}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"NpotVal", ",", "NevMinVal"}], "}"}]}], "}"}], "//", 
      "TableForm"}], "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"Do", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"sensitivityCenter", "[", "type", "]"}], ",", 
         RowBox[{"sensitivityUncertainty", "[", "type", "]"}]}], "}"}], "=", 
       RowBox[{"UncertaintyExtractor", "[", 
        RowBox[{"type", ",", "NpotVal", ",", "NevMinVal"}], "]"}]}], 
      "\[IndentingNewLine]", ",", 
      RowBox[{"{", 
       RowBox[{"type", ",", "signaturesAvailable"}], "}"}]}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"TabSens", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"type", ",", 
         RowBox[{"sensitivityCenter", "[", "type", "]"}], ",", 
         RowBox[{"sensitivityUncertainty", "[", "type", "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"type", ",", "signaturesAvailable"}], "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"filenameexport", "=", 
     RowBox[{"FileNameJoin", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"directory", "[", "\"\<Sensitivity-LLP-exp\>\"", "]"}], ",", 
        RowBox[{"ToString", "@", 
         RowBox[{"StringForm", "[", 
          RowBox[{"\"\<Uncertainties_``_at_``_Nev=``_Npot=``.\>\"", ",", 
           RowBox[{"Sequence", "@@", 
            RowBox[{"{", 
             RowBox[{"LLPdirName", ",", "ExperimentFolder", ",", 
              RowBox[{"NevMinVal", "//", "ToString"}], ",", 
              RowBox[{
               RowBox[{
                RowBox[{"N", "[", "NpotVal", "]"}], "//", "CForm"}], "//", 
               "ToString"}]}], "}"}]}]}], "]"}]}]}], "}"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"assocData", "=", 
     RowBox[{"Map", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{"\"\<Uncertainty source\>\"", "->", 
           RowBox[{"#", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], ",", 
          RowBox[{"\"\<Central sensitivity\>\"", "->", 
           RowBox[{"#", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], ",", 
          RowBox[{"\"\<Uncertainty\>\"", "->", 
           RowBox[{"#", "[", 
            RowBox[{"[", "3", "]"}], "]"}]}]}], "]"}], "&"}], ",", 
       "TabSens"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{"filenameexport", "<>", "\"\<mx\>\""}], ",", "TabSens", ",", 
      "\"\<MX\>\""}], "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{"filenameexport", "<>", "\"\<json\>\""}], ",", "assocData", 
      ",", "\"\<JSON\>\""}], "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"Show", "[", 
     RowBox[{
      RowBox[{"ListLogLogPlot", "[", 
       RowBox[{
        RowBox[{"sensitivityUncertainty", "[", "\"\<Production\>\"", "]"}], 
        ",", 
        RowBox[{"Joined", "->", "True"}], ",", 
        RowBox[{"Filling", "->", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"i", "->", 
            RowBox[{"{", 
             RowBox[{"True", ",", 
              RowBox[{"Directive", "[", 
               RowBox[{"Blue", ",", 
                RowBox[{"Opacity", "[", "0.1", "]"}]}], "]"}]}], "}"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", 
             RowBox[{"Length", "[", 
              RowBox[{
              "sensitivityUncertainty", "[", "\"\<Production\>\"", "]"}], 
              "]"}], ",", "1"}], "}"}]}], "]"}]}], ",", 
        RowBox[{"ImageSize", "->", "Large"}], ",", 
        RowBox[{"Frame", "->", "True"}], ",", 
        RowBox[{"PlotStyle", "->", 
         RowBox[{"{", 
          RowBox[{"{", 
           RowBox[{"Thick", ",", "Blue", ",", 
            RowBox[{"Opacity", "[", "0.1", "]"}]}], "}"}], "}"}]}], ",", 
        RowBox[{"FrameStyle", "->", 
         RowBox[{"Directive", "[", 
          RowBox[{"Thick", ",", "Black", ",", "23"}], "]"}]}], ",", 
        RowBox[{"FrameLabel", "->", 
         RowBox[{"{", 
          RowBox[{"massLabel", ",", "couplingLabel"}], "}"}]}]}], "]"}], ",", 
      RowBox[{"ListLogLogPlot", "[", 
       RowBox[{
        RowBox[{"sensitivityCenter", "[", "\"\<Production\>\"", "]"}], ",", 
        RowBox[{"Joined", "->", "True"}], ",", 
        RowBox[{"ImageSize", "->", "Large"}], ",", 
        RowBox[{"Frame", "->", "True"}], ",", 
        RowBox[{"PlotStyle", "->", 
         RowBox[{"{", 
          RowBox[{"{", 
           RowBox[{"Thick", ",", "Blue"}], "}"}], "}"}]}]}], "]"}]}], 
     "]"}]}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.952674061380926*^9, 3.952674107844225*^9}, {
   3.9526741427261257`*^9, 3.9526742523037376`*^9}, {3.9526743682644386`*^9, 
   3.952674395488739*^9}, 3.952674502935869*^9, {3.9526746361466827`*^9, 
   3.952674668843872*^9}, {3.9526747303442535`*^9, 3.9526747360769463`*^9}, {
   3.9526748054418163`*^9, 3.9526748060098743`*^9}, {3.9526777202542343`*^9, 
   3.952677773781927*^9}, {3.9526778099229374`*^9, 3.952677913526222*^9}, {
   3.9526788384633083`*^9, 3.952678844649328*^9}, 3.9526791612824993`*^9, {
   3.9526792355892715`*^9, 3.9526793237863045`*^9}, 3.9526797179492245`*^9, {
   3.9526974498186073`*^9, 3.952697455142477*^9}, {3.952697512439476*^9, 
   3.9526975783260384`*^9}, 3.9526980707208233`*^9, 3.9526991571272125`*^9, {
   3.952699226836218*^9, 3.952699484580776*^9}, {3.952699634551342*^9, 
   3.9526996347863235`*^9}, {3.952699836699869*^9, 3.95269991469083*^9}, 
   3.952700006132452*^9, 3.952700827845564*^9, {3.9527384251691113`*^9, 
   3.9527384407403316`*^9}, {3.9527385488413105`*^9, 
   3.9527385727154064`*^9}, {3.9527392156205063`*^9, 3.952739225318594*^9}},
 CellTags->"Sensitivity-computation",
 CellLabel->
  "In[619]:=",ExpressionUUID->"1f3c7537-6ec9-b544-a130-87f5d88302bf"]
}, Closed]]
}, Closed]]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Deleting generated cells", "Title",
 CellChangeTimes->{{3.9025559465149946`*^9, 
  3.9025559494966087`*^9}},ExpressionUUID->"519ed843-8f32-4e91-84d0-\
5f5d5f152eee"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"FrontEndTokenExecute", "[", "\"\<DeleteGeneratedCells\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FrontEndTokenExecute", "[", "\"\<SelectAll\>\"", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
  "FrontEndTokenExecute", "[", "\"\<SelectionCloseAllGroups\>\"", "]"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.9025559062888603`*^9, 3.9025559062888603`*^9}, {
   3.902555964086707*^9, 3.902555989355214*^9}, {3.9025615684818387`*^9, 
   3.9025615698168364`*^9}, {3.902729327686987*^9, 3.9027293300327225`*^9}, {
   3.9027673630554657`*^9, 3.902767365763246*^9}, {3.9028567330422525`*^9, 
   3.902856748718687*^9}, {3.9039717334857006`*^9, 3.903971734143115*^9}, {
   3.9181488191231093`*^9, 3.918148824518332*^9}, 3.9200482510516415`*^9},
 CellLabel->
  "In[498]:=",ExpressionUUID->"da6a725b-270d-45e0-bd71-6f5132a81d48"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.91958912091343*^9, 3.919589121035282*^9}},
 CellLabel->
  "In[501]:=",ExpressionUUID->"0b403f30-a3bf-4727-8bcb-0362f9a09fda"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.919589123332487*^9, 3.919589123446026*^9}},
 CellLabel->
  "In[502]:=",ExpressionUUID->"44dd3271-d0c6-481b-9a45-036436435ea1"]
}, Closed]]
},
WindowSize->{1430.25, 822.75},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
TaggingRules-><|"TryRealOnly" -> False|>,
ShowCellTags->True,
Magnification:>0.8 Inherited,
FrontEndVersion->"14.2 for Microsoft Windows (64-bit) (December 26, 2024)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"af073a36-ca59-2c45-a14b-3db41f5ee367"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{
 "Acceptance"->{
  Cell[5717, 148, 354, 7, 68, "Title",ExpressionUUID->"dc98cc40-afde-45ba-ae22-74afbd95ce04",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
  Cell[6096, 159, 227, 5, 65, "Chapter",ExpressionUUID->"1320ba97-7abe-4017-b5a5-ae36b7fec1b3",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
  Cell[6326, 166, 4153, 106, 216, "Input",ExpressionUUID->"d67e103e-ff85-49fc-80ad-39fdd6887281",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
  Cell[10516, 277, 287, 6, 65, "Chapter",ExpressionUUID->"57c7a938-d451-c84c-97c8-27e9bb6cc729",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
  Cell[10806, 285, 1817, 41, 109, "Input",ExpressionUUID->"d9f5d65b-f701-cd49-854f-7917d7ca7e42",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
  Cell[12660, 331, 980, 22, 65, "Chapter",ExpressionUUID->"89802de9-cd6b-471a-b913-4f949b4b89c5",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
  Cell[13665, 357, 244, 5, 64, "Section",ExpressionUUID->"6717ef21-ab4c-fb4b-b107-b8c134c5c613",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
  Cell[13912, 364, 1689, 35, 131, "Input",ExpressionUUID->"773cc7e1-5f20-b94f-8ec6-b63220bbd69c",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
  Cell[15638, 404, 285, 6, 64, "Section",ExpressionUUID->"7792752f-e20c-cf42-841f-2b987ee07250",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
  Cell[15948, 414, 236, 5, 53, "Subsection",ExpressionUUID->"3623661c-f4fc-b946-b81d-9857ff564d5b",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
  Cell[16187, 421, 4464, 118, 172, "Input",ExpressionUUID->"26988afd-11a9-1c44-bd18-59a8a9fac28b",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
  Cell[20688, 544, 594, 10, 53, "Subsection",ExpressionUUID->"e25a0e24-a022-4842-96cd-1f84559c3f94",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
  Cell[21285, 556, 8785, 195, 468, "Input",ExpressionUUID->"93877176-470d-5b4a-87db-0f49b1478819",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
  Cell[30107, 756, 224, 4, 53, "Subsection",ExpressionUUID->"ec1691b9-f9be-7247-9f9c-d63aa93c450e",
   CellTags->{"Number-of-events+sensitivity", "Acceptance"}],
  Cell[30334, 762, 6333, 150, 265, "Input",ExpressionUUID->"e490f5f0-d959-574c-8b5f-d51735710a2b",
   CellTags->{"Number-of-events+sensitivity", "Acceptance"}],
  Cell[36704, 917, 289, 5, 53, "Subsection",ExpressionUUID->"6e53cf51-459c-464e-9f98-8bbf36d051f6",
   CellTags->{"Number-of-events+sensitivity", "Acceptance"}],
  Cell[36996, 924, 13680, 282, 660, "Input",ExpressionUUID->"5ea081c9-8fd0-8644-b032-52e8e6b8bdd8",
   CellTags->{"Number-of-events+sensitivity", "Acceptance"}],
  Cell[50713, 1211, 394, 9, 53, "Subsection",ExpressionUUID->"4e26538e-af17-2b40-87bf-2bf941d71722",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
  Cell[51110, 1222, 4814, 108, 270, "Input",ExpressionUUID->"befd8136-275e-2340-a745-079baf99bde3",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
  Cell[55973, 1336, 297, 6, 64, "Section",ExpressionUUID->"7d59f094-3c95-ed40-a349-3c63d1c89424",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
  Cell[56273, 1344, 5481, 120, 246, "Input",ExpressionUUID->"0edb2b52-1f88-8540-b5df-75246563ec07",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
  Cell[61815, 1471, 332, 6, 68, "Title",ExpressionUUID->"28586d1f-b279-f445-b5f5-a858d8c5e9de",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
  Cell[62172, 1481, 311, 6, 65, "Chapter",ExpressionUUID->"7b9ec72b-f300-6947-8118-60dfa7620480",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
  Cell[62486, 1489, 9530, 237, 520, "Input",ExpressionUUID->"be98efa4-001b-5e4f-b892-2d0db6c7402a",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
  Cell[72053, 1731, 238, 5, 65, "Chapter",ExpressionUUID->"b8a043b6-ade0-964b-9c3f-50520aae2d33",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
  Cell[72294, 1738, 2046, 49, 246, "Input",ExpressionUUID->"607ff8ab-dd7c-4a44-bd43-da5ec3ce4038",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}]},
 "Number-of-events+sensitivity"->{
  Cell[5717, 148, 354, 7, 68, "Title",ExpressionUUID->"dc98cc40-afde-45ba-ae22-74afbd95ce04",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
  Cell[6096, 159, 227, 5, 65, "Chapter",ExpressionUUID->"1320ba97-7abe-4017-b5a5-ae36b7fec1b3",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
  Cell[6326, 166, 4153, 106, 216, "Input",ExpressionUUID->"d67e103e-ff85-49fc-80ad-39fdd6887281",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
  Cell[10516, 277, 287, 6, 65, "Chapter",ExpressionUUID->"57c7a938-d451-c84c-97c8-27e9bb6cc729",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
  Cell[10806, 285, 1817, 41, 109, "Input",ExpressionUUID->"d9f5d65b-f701-cd49-854f-7917d7ca7e42",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
  Cell[12660, 331, 980, 22, 65, "Chapter",ExpressionUUID->"89802de9-cd6b-471a-b913-4f949b4b89c5",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
  Cell[13665, 357, 244, 5, 64, "Section",ExpressionUUID->"6717ef21-ab4c-fb4b-b107-b8c134c5c613",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
  Cell[13912, 364, 1689, 35, 131, "Input",ExpressionUUID->"773cc7e1-5f20-b94f-8ec6-b63220bbd69c",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
  Cell[15638, 404, 285, 6, 64, "Section",ExpressionUUID->"7792752f-e20c-cf42-841f-2b987ee07250",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
  Cell[15948, 414, 236, 5, 53, "Subsection",ExpressionUUID->"3623661c-f4fc-b946-b81d-9857ff564d5b",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
  Cell[16187, 421, 4464, 118, 172, "Input",ExpressionUUID->"26988afd-11a9-1c44-bd18-59a8a9fac28b",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
  Cell[20688, 544, 594, 10, 53, "Subsection",ExpressionUUID->"e25a0e24-a022-4842-96cd-1f84559c3f94",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
  Cell[21285, 556, 8785, 195, 468, "Input",ExpressionUUID->"93877176-470d-5b4a-87db-0f49b1478819",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
  Cell[30107, 756, 224, 4, 53, "Subsection",ExpressionUUID->"ec1691b9-f9be-7247-9f9c-d63aa93c450e",
   CellTags->{"Number-of-events+sensitivity", "Acceptance"}],
  Cell[30334, 762, 6333, 150, 265, "Input",ExpressionUUID->"e490f5f0-d959-574c-8b5f-d51735710a2b",
   CellTags->{"Number-of-events+sensitivity", "Acceptance"}],
  Cell[36704, 917, 289, 5, 53, "Subsection",ExpressionUUID->"6e53cf51-459c-464e-9f98-8bbf36d051f6",
   CellTags->{"Number-of-events+sensitivity", "Acceptance"}],
  Cell[36996, 924, 13680, 282, 660, "Input",ExpressionUUID->"5ea081c9-8fd0-8644-b032-52e8e6b8bdd8",
   CellTags->{"Number-of-events+sensitivity", "Acceptance"}],
  Cell[50713, 1211, 394, 9, 53, "Subsection",ExpressionUUID->"4e26538e-af17-2b40-87bf-2bf941d71722",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
  Cell[51110, 1222, 4814, 108, 270, "Input",ExpressionUUID->"befd8136-275e-2340-a745-079baf99bde3",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
  Cell[55973, 1336, 297, 6, 64, "Section",ExpressionUUID->"7d59f094-3c95-ed40-a349-3c63d1c89424",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
  Cell[56273, 1344, 5481, 120, 246, "Input",ExpressionUUID->"0edb2b52-1f88-8540-b5df-75246563ec07",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
  Cell[61815, 1471, 332, 6, 68, "Title",ExpressionUUID->"28586d1f-b279-f445-b5f5-a858d8c5e9de",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
  Cell[62172, 1481, 311, 6, 65, "Chapter",ExpressionUUID->"7b9ec72b-f300-6947-8118-60dfa7620480",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
  Cell[62486, 1489, 9530, 237, 520, "Input",ExpressionUUID->"be98efa4-001b-5e4f-b892-2d0db6c7402a",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
  Cell[72053, 1731, 238, 5, 65, "Chapter",ExpressionUUID->"b8a043b6-ade0-964b-9c3f-50520aae2d33",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
  Cell[72294, 1738, 2046, 49, 246, "Input",ExpressionUUID->"607ff8ab-dd7c-4a44-bd43-da5ec3ce4038",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}]},
 "Number-of-events-computation+sensitivity"->{
  Cell[74389, 1793, 216, 4, 68, "Title",ExpressionUUID->"3e9a02fd-97c3-44ee-9f5b-9ca3983b66da",
   CellTags->"Number-of-events-computation+sensitivity"],
  Cell[74630, 1801, 368, 7, 65, "Chapter",ExpressionUUID->"76fe3cd1-27a0-4d11-852c-ea3c40d76fef",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[75001, 1810, 805, 20, 49, "Input",ExpressionUUID->"10bc767d-43ce-4bd8-89d0-83fd85f2bb40",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[75843, 1835, 316, 6, 65, "Chapter",ExpressionUUID->"4cb86986-b7a3-4409-91ed-f7461f351ed0",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[76162, 1843, 13242, 331, 468, "Input",ExpressionUUID->"68cd4c52-a57e-49cb-9552-92e7a8059080",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[89429, 2178, 416, 9, 64, "Section",ExpressionUUID->"972feb67-6add-ac40-99c7-991aaf347a8f",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[89870, 2191, 325, 8, 53, "Subsection",ExpressionUUID->"4593d3d7-94ed-0247-aa53-76f7ec6f84b3",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[90198, 2201, 7367, 184, 262, "Input",ExpressionUUID->"e7b49a65-12ae-2c4b-8122-ef9651479899",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[97602, 2390, 307, 7, 53, "Subsection",ExpressionUUID->"2f9d0dea-ca8a-9444-b0ab-cc7df9b417d3",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[97912, 2399, 9956, 241, 642, "Input",ExpressionUUID->"77f25579-e284-b54e-88fc-e402bfafcc7c",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[107929, 2647, 511, 8, 65, "Chapter",ExpressionUUID->"9c0a6fa2-083d-438f-84cb-5fa122f734c4",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[108465, 2659, 290, 6, 64, "Section",ExpressionUUID->"b0156caa-c6a2-ea49-9d19-2e75d36dd380",
   CellTags->{"Number-of-events-computation+sensitivity", "Acceptance-computation"}],
  Cell[108758, 2667, 9799, 230, 521, "Input",ExpressionUUID->"6ed3ff0f-7809-5c49-aa01-00d78491ccb3",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[118594, 2902, 327, 6, 64, "Section",ExpressionUUID->"16f565d9-121d-a340-bd40-1b7a859a34ef",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[118924, 2910, 6038, 161, 292, "Input",ExpressionUUID->"410333c8-39b9-db4f-96d8-0fac6e682479",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[124999, 3076, 257, 5, 64, "Section",ExpressionUUID->"8b0c9880-aa3a-7b49-a98b-d0fcac093aed",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[125259, 3083, 13171, 307, 673, "Input",ExpressionUUID->"f906f3b6-9a26-684c-b4c8-75065a0ccfe5",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[138455, 3394, 317, 6, 53, "Subsection",ExpressionUUID->"12c4a047-206a-cd41-bac8-3da9c9e8279c",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[138775, 3402, 5468, 112, 140, "Input",ExpressionUUID->"20a78213-5a61-f44c-893d-981a6d71d204",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[144292, 3520, 241, 5, 64, "Section",ExpressionUUID->"6a6edac6-9974-6743-9e9b-7607c6f5952f",
   CellTags->{"Number-of-events-computation+sensitivity", "Acceptance-computation"}],
  Cell[144536, 3527, 15126, 353, 450, "Input",ExpressionUUID->"f38d7eaf-e37c-2d45-9c7c-f7124f08952e",
   CellTags->{"Number-of-events-computation+sensitivity", "Acceptance-computation"}],
  Cell[159711, 3886, 218, 4, 65, "Chapter",ExpressionUUID->"913a2300-dec2-4b0f-8b44-4b75cf0adccf",
   CellTags->"Number-of-events-computation+sensitivity"],
  Cell[159954, 3894, 386, 7, 64, "Section",ExpressionUUID->"b0772e57-8882-4e3d-a1f7-c9c6f58dc7ac",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[160365, 3905, 388, 7, 53, "Subsection",ExpressionUUID->"09bda361-200e-4474-a4eb-51f045b744b2",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[160756, 3914, 15148, 342, 690, "Input",ExpressionUUID->"07d9d00a-b1e3-45a3-8431-e5ba54203718",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[175941, 4261, 262, 5, 53, "Subsection",ExpressionUUID->"38691406-6de0-4e83-9a5b-27156e5454d3",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[176228, 4270, 253, 5, 46, "Subsubsection",ExpressionUUID->"a3aaf4e0-3a6f-1a4a-9d7f-56304c4e55bc",
   CellTags->{"Number-of-events-computation+sensitivity", "Acceptance-computation"}],
  Cell[176484, 4277, 2954, 73, 176, "Input",ExpressionUUID->"2ad3871d-9835-3444-9fb8-0a832c2adf15",
   CellTags->{"Number-of-events-computation+sensitivity", "Acceptance-computation"}],
  Cell[179475, 4355, 275, 5, 46, "Subsubsection",ExpressionUUID->"52a0264d-e70c-8e42-96e9-463c01c40c40",
   CellTags->{"Number-of-events-computation+sensitivity", "Acceptance-computation"}],
  Cell[179753, 4362, 16018, 392, 399, "Input",ExpressionUUID->"46fc40d5-c6c5-3e4d-92cd-122e24134dc2",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[195820, 4760, 284, 5, 53, "Subsection",ExpressionUUID->"1f64e19f-68db-451d-9c11-af942b7e295b",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[196107, 4767, 6313, 136, 268, "Input",ExpressionUUID->"2013639a-846d-4ea2-a0b9-81d0edd1cc67",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[202469, 4909, 249, 5, 64, "Section",ExpressionUUID->"e71a519c-1cd2-c04d-b006-09b39bbbfbf2",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[202743, 4918, 309, 6, 53, "Subsection",ExpressionUUID->"42ab82d5-4d7e-4d06-8eb9-6e821b04db69",
   CellTags->{"Number-of-events-computation+sensitivity", "Acceptance-computation"}],
  Cell[203055, 4926, 6742, 139, 262, "Input",ExpressionUUID->"963c4344-4087-43c6-b6e8-508b30bff543",
   CellTags->{"Number-of-events-computation+sensitivity", "Acceptance-computation"}],
  Cell[209834, 5070, 335, 8, 53, "Subsection",ExpressionUUID->"a2111b3d-b948-4362-97ab-aedd46e94fb9",
   CellTags->{"Number-of-events-computation+sensitivity", "Acceptance-computation"}],
  Cell[210172, 5080, 8180, 197, 266, "Input",ExpressionUUID->"46f4d46b-66b1-4ab0-8fc9-e4f181080153",
   CellTags->{"Number-of-events-computation+sensitivity", "Acceptance-computation"}],
  Cell[218389, 5282, 232, 4, 53, "Subsection",ExpressionUUID->"748b8b59-c490-462f-bf37-7dc6537c8d0d",
   CellTags->"Number-of-events-computation+sensitivity"],
  Cell[218624, 5288, 22845, 515, 824, "Input",ExpressionUUID->"46c1a4a5-1c46-489a-a061-206c6b7873bc",
   CellTags->"Number-of-events-computation+sensitivity"],
  Cell[253748, 6095, 262, 5, 68, "Title",ExpressionUUID->"0923b405-c0ba-437a-a0a1-eb2d8707c8c5",
   CellTags->"Number-of-events-computation+sensitivity"],
  Cell[254035, 6104, 213, 4, 65, "Chapter",ExpressionUUID->"2ada0cc1-1695-4a57-a86b-b11e240b979f",
   CellTags->"Number-of-events-computation+sensitivity"],
  Cell[254251, 6110, 8363, 159, 313, "Input",ExpressionUUID->"d36d89ea-2d97-457b-aa5b-4b098e8235d8",
   CellTags->"Number-of-events-computation+sensitivity"],
  Cell[262651, 6274, 209, 4, 65, "Chapter",ExpressionUUID->"a58bd3a7-f345-470d-ba5e-82c520e24a7e",
   CellTags->"Number-of-events-computation+sensitivity"],
  Cell[262863, 6280, 4690, 102, 262, "Input",ExpressionUUID->"b5ddb613-f8ce-4354-bf3e-3dc63b62f3d5",
   CellTags->"Number-of-events-computation+sensitivity"]},
 "Acceptance-computation"->{
  Cell[74630, 1801, 368, 7, 65, "Chapter",ExpressionUUID->"76fe3cd1-27a0-4d11-852c-ea3c40d76fef",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[75001, 1810, 805, 20, 49, "Input",ExpressionUUID->"10bc767d-43ce-4bd8-89d0-83fd85f2bb40",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[75843, 1835, 316, 6, 65, "Chapter",ExpressionUUID->"4cb86986-b7a3-4409-91ed-f7461f351ed0",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[76162, 1843, 13242, 331, 468, "Input",ExpressionUUID->"68cd4c52-a57e-49cb-9552-92e7a8059080",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[89429, 2178, 416, 9, 64, "Section",ExpressionUUID->"972feb67-6add-ac40-99c7-991aaf347a8f",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[89870, 2191, 325, 8, 53, "Subsection",ExpressionUUID->"4593d3d7-94ed-0247-aa53-76f7ec6f84b3",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[90198, 2201, 7367, 184, 262, "Input",ExpressionUUID->"e7b49a65-12ae-2c4b-8122-ef9651479899",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[97602, 2390, 307, 7, 53, "Subsection",ExpressionUUID->"2f9d0dea-ca8a-9444-b0ab-cc7df9b417d3",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[97912, 2399, 9956, 241, 642, "Input",ExpressionUUID->"77f25579-e284-b54e-88fc-e402bfafcc7c",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[107929, 2647, 511, 8, 65, "Chapter",ExpressionUUID->"9c0a6fa2-083d-438f-84cb-5fa122f734c4",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[108465, 2659, 290, 6, 64, "Section",ExpressionUUID->"b0156caa-c6a2-ea49-9d19-2e75d36dd380",
   CellTags->{"Number-of-events-computation+sensitivity", "Acceptance-computation"}],
  Cell[108758, 2667, 9799, 230, 521, "Input",ExpressionUUID->"6ed3ff0f-7809-5c49-aa01-00d78491ccb3",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[118594, 2902, 327, 6, 64, "Section",ExpressionUUID->"16f565d9-121d-a340-bd40-1b7a859a34ef",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[118924, 2910, 6038, 161, 292, "Input",ExpressionUUID->"410333c8-39b9-db4f-96d8-0fac6e682479",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[124999, 3076, 257, 5, 64, "Section",ExpressionUUID->"8b0c9880-aa3a-7b49-a98b-d0fcac093aed",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[125259, 3083, 13171, 307, 673, "Input",ExpressionUUID->"f906f3b6-9a26-684c-b4c8-75065a0ccfe5",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[138455, 3394, 317, 6, 53, "Subsection",ExpressionUUID->"12c4a047-206a-cd41-bac8-3da9c9e8279c",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[138775, 3402, 5468, 112, 140, "Input",ExpressionUUID->"20a78213-5a61-f44c-893d-981a6d71d204",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[144292, 3520, 241, 5, 64, "Section",ExpressionUUID->"6a6edac6-9974-6743-9e9b-7607c6f5952f",
   CellTags->{"Number-of-events-computation+sensitivity", "Acceptance-computation"}],
  Cell[144536, 3527, 15126, 353, 450, "Input",ExpressionUUID->"f38d7eaf-e37c-2d45-9c7c-f7124f08952e",
   CellTags->{"Number-of-events-computation+sensitivity", "Acceptance-computation"}],
  Cell[159954, 3894, 386, 7, 64, "Section",ExpressionUUID->"b0772e57-8882-4e3d-a1f7-c9c6f58dc7ac",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[160365, 3905, 388, 7, 53, "Subsection",ExpressionUUID->"09bda361-200e-4474-a4eb-51f045b744b2",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[160756, 3914, 15148, 342, 690, "Input",ExpressionUUID->"07d9d00a-b1e3-45a3-8431-e5ba54203718",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[175941, 4261, 262, 5, 53, "Subsection",ExpressionUUID->"38691406-6de0-4e83-9a5b-27156e5454d3",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[176228, 4270, 253, 5, 46, "Subsubsection",ExpressionUUID->"a3aaf4e0-3a6f-1a4a-9d7f-56304c4e55bc",
   CellTags->{"Number-of-events-computation+sensitivity", "Acceptance-computation"}],
  Cell[176484, 4277, 2954, 73, 176, "Input",ExpressionUUID->"2ad3871d-9835-3444-9fb8-0a832c2adf15",
   CellTags->{"Number-of-events-computation+sensitivity", "Acceptance-computation"}],
  Cell[179475, 4355, 275, 5, 46, "Subsubsection",ExpressionUUID->"52a0264d-e70c-8e42-96e9-463c01c40c40",
   CellTags->{"Number-of-events-computation+sensitivity", "Acceptance-computation"}],
  Cell[179753, 4362, 16018, 392, 399, "Input",ExpressionUUID->"46fc40d5-c6c5-3e4d-92cd-122e24134dc2",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[195820, 4760, 284, 5, 53, "Subsection",ExpressionUUID->"1f64e19f-68db-451d-9c11-af942b7e295b",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[196107, 4767, 6313, 136, 268, "Input",ExpressionUUID->"2013639a-846d-4ea2-a0b9-81d0edd1cc67",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[202469, 4909, 249, 5, 64, "Section",ExpressionUUID->"e71a519c-1cd2-c04d-b006-09b39bbbfbf2",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[202743, 4918, 309, 6, 53, "Subsection",ExpressionUUID->"42ab82d5-4d7e-4d06-8eb9-6e821b04db69",
   CellTags->{"Number-of-events-computation+sensitivity", "Acceptance-computation"}],
  Cell[203055, 4926, 6742, 139, 262, "Input",ExpressionUUID->"963c4344-4087-43c6-b6e8-508b30bff543",
   CellTags->{"Number-of-events-computation+sensitivity", "Acceptance-computation"}],
  Cell[209834, 5070, 335, 8, 53, "Subsection",ExpressionUUID->"a2111b3d-b948-4362-97ab-aedd46e94fb9",
   CellTags->{"Number-of-events-computation+sensitivity", "Acceptance-computation"}],
  Cell[210172, 5080, 8180, 197, 266, "Input",ExpressionUUID->"46f4d46b-66b1-4ab0-8fc9-e4f181080153",
   CellTags->{"Number-of-events-computation+sensitivity", "Acceptance-computation"}]},
 "Sensitivity"->{
  Cell[267602, 6388, 189, 3, 68, "Title",ExpressionUUID->"9cbf5dbf-7d97-438c-bab1-6a4374076885",
   CellTags->"Sensitivity"],
  Cell[267816, 6395, 188, 3, 65, "Chapter",ExpressionUUID->"9d756e77-cb38-4749-bd1a-ec57f9fa383a",
   CellTags->"Sensitivity"],
  Cell[268007, 6400, 6131, 154, 414, "Input",ExpressionUUID->"09272721-e148-43d5-8826-7b8fa3f9f2fc",
   CellTags->"Sensitivity"]},
 "Sensitivity-computation"->{
  Cell[274175, 6559, 315, 7, 65, "Chapter",ExpressionUUID->"cba6efcf-5800-47ae-95bb-fbf537eda806",
   CellTags->"Sensitivity-computation"],
  Cell[274515, 6570, 209, 4, 64, "Section",ExpressionUUID->"fe300255-d2ee-884b-bc00-c6df44595cc6",
   CellTags->"Sensitivity-computation"],
  Cell[274727, 6576, 5390, 115, 201, "Input",ExpressionUUID->"5b7a0bfe-29fb-6040-b8ab-4dd79508f2d5",
   CellTags->"Sensitivity-computation"],
  Cell[280154, 6696, 220, 4, 64, "Section",ExpressionUUID->"fc89cd31-0532-b84b-b148-fd58a202ae2e",
   CellTags->"Sensitivity-computation"],
  Cell[280377, 6702, 15692, 384, 625, "Input",ExpressionUUID->"3fb1177c-8f25-3542-9db5-6bb033442f9b",
   CellTags->"Sensitivity-computation"],
  Cell[296094, 7090, 238, 4, 53, "Subsection",ExpressionUUID->"e7bf7c72-530f-5c49-ad49-b971df33c309",
   CellTags->"Sensitivity-computation"],
  Cell[296335, 7096, 5197, 123, 277, "Input",ExpressionUUID->"002e3312-bd69-b34c-9e37-2ca865725ebb",
   CellTags->"Sensitivity-computation"],
  Cell[301569, 7224, 284, 5, 53, "Subsection",ExpressionUUID->"2f7cf3db-4b58-b94d-bb4e-a9276c35e47e",
   CellTags->"Sensitivity-computation"],
  Cell[301856, 7231, 4032, 96, 185, "Input",ExpressionUUID->"0ed97628-be3e-044a-a7b0-0b76d9b8e872",
   CellTags->"Sensitivity-computation"],
  Cell[306147, 7341, 225, 4, 64, "Section",ExpressionUUID->"04de29f6-78bf-cd45-bbd5-c481cbd63244",
   CellTags->"Sensitivity-computation"],
  Cell[306375, 7347, 4170, 109, 161, "Input",ExpressionUUID->"c8b8bb9e-591e-884b-8554-349f7c555ef0",
   CellTags->"Sensitivity-computation"],
  Cell[310582, 7461, 255, 5, 64, "Section",ExpressionUUID->"1779fba7-f5a1-1f4c-a7e8-1890db9d1963",
   CellTags->"Sensitivity-computation"],
  Cell[310840, 7468, 4806, 113, 94, "Input",ExpressionUUID->"33a6e888-1b7f-5d4a-b31f-27d02dbd4f4d",
   CellTags->"Sensitivity-computation"],
  Cell[315695, 7587, 210, 4, 65, "Chapter",ExpressionUUID->"6973c073-2e4b-4c34-a088-4365694bce10",
   CellTags->"Sensitivity-computation"],
  Cell[315930, 7595, 253, 5, 64, "Section",ExpressionUUID->"d57a2d3d-381f-479e-bde3-49c0fb15579a",
   CellTags->"Sensitivity-computation"],
  Cell[316186, 7602, 2747, 71, 201, "Input",ExpressionUUID->"4018b168-837a-415b-ac72-f91c637de913",
   CellTags->"Sensitivity-computation"],
  Cell[318970, 7678, 196, 4, 64, "Section",ExpressionUUID->"9f6548e1-453f-47b5-b82c-a2ef474f018e",
   CellTags->"Sensitivity-computation"],
  Cell[319191, 7686, 269, 5, 53, "Subsection",ExpressionUUID->"6b015ada-f566-6645-af59-37c927aa9bed",
   CellTags->"Sensitivity-computation"],
  Cell[319463, 7693, 20946, 476, 1031, "Input",ExpressionUUID->"8f64fab3-94e2-432a-9ab3-44e819bfd780",
   CellTags->"Sensitivity-computation"],
  Cell[340446, 8174, 211, 4, 53, "Subsection",ExpressionUUID->"582a549f-e1ac-ad4f-a713-3310984b98fc",
   CellTags->"Sensitivity-computation"],
  Cell[340660, 8180, 19610, 513, 551, "Input",ExpressionUUID->"a09d5048-69f6-004c-be52-76389258a3d9",
   CellTags->"Sensitivity-computation"],
  Cell[360319, 8699, 216, 4, 64, "Section",ExpressionUUID->"6021facd-3912-304d-883c-9c23a498452b",
   CellTags->"Sensitivity-computation"],
  Cell[360560, 8707, 260, 6, 53, "Subsection",ExpressionUUID->"9fde3f02-c676-fb4a-b5e0-11624bdc274c",
   CellTags->"Sensitivity-computation"],
  Cell[360823, 8715, 15844, 377, 859, "Input",ExpressionUUID->"6378a9e4-eb30-8c42-986c-286407554b62",
   CellTags->"Sensitivity-computation"],
  Cell[376704, 9097, 213, 4, 53, "Subsection",ExpressionUUID->"ad894679-8bc4-0941-86eb-6243caebc201",
   CellTags->"Sensitivity-computation"],
  Cell[376920, 9103, 16798, 395, 624, "Input",ExpressionUUID->"1f3c7537-6ec9-b544-a130-87f5d88302bf",
   CellTags->"Sensitivity-computation"]}
 }
*)
(*CellTagsIndex
CellTagsIndex->{
 {"Acceptance", 395679, 9555},
 {"Number-of-events+sensitivity", 399888, 9608},
 {"Number-of-events-computation+sensitivity", 404109, 9661},
 {"Acceptance-computation", 412090, 9750},
 {"Sensitivity", 418642, 9821},
 {"Sensitivity-computation", 419057, 9828}
 }
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 207, 3, 77, "Title",ExpressionUUID->"0839ea5b-1982-4dfb-8c5d-195bcd99f6e9"],
Cell[790, 27, 4890, 116, 342, "Input",ExpressionUUID->"3ff672e3-e982-49fe-8fe3-e69285f06990"]
}, Closed]],
Cell[CellGroupData[{
Cell[5717, 148, 354, 7, 68, "Title",ExpressionUUID->"dc98cc40-afde-45ba-ae22-74afbd95ce04",
 CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
Cell[CellGroupData[{
Cell[6096, 159, 227, 5, 65, "Chapter",ExpressionUUID->"1320ba97-7abe-4017-b5a5-ae36b7fec1b3",
 CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
Cell[6326, 166, 4153, 106, 216, "Input",ExpressionUUID->"d67e103e-ff85-49fc-80ad-39fdd6887281",
 CellTags->{"Acceptance", "Number-of-events+sensitivity"}]
}, Closed]],
Cell[CellGroupData[{
Cell[10516, 277, 287, 6, 65, "Chapter",ExpressionUUID->"57c7a938-d451-c84c-97c8-27e9bb6cc729",
 CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
Cell[10806, 285, 1817, 41, 109, "Input",ExpressionUUID->"d9f5d65b-f701-cd49-854f-7917d7ca7e42",
 CellTags->{"Acceptance", "Number-of-events+sensitivity"}]
}, Closed]],
Cell[CellGroupData[{
Cell[12660, 331, 980, 22, 65, "Chapter",ExpressionUUID->"89802de9-cd6b-471a-b913-4f949b4b89c5",
 CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
Cell[CellGroupData[{
Cell[13665, 357, 244, 5, 64, "Section",ExpressionUUID->"6717ef21-ab4c-fb4b-b107-b8c134c5c613",
 CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
Cell[13912, 364, 1689, 35, 131, "Input",ExpressionUUID->"773cc7e1-5f20-b94f-8ec6-b63220bbd69c",
 CellTags->{"Acceptance", "Number-of-events+sensitivity"}]
}, Closed]],
Cell[CellGroupData[{
Cell[15638, 404, 285, 6, 64, "Section",ExpressionUUID->"7792752f-e20c-cf42-841f-2b987ee07250",
 CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
Cell[CellGroupData[{
Cell[15948, 414, 236, 5, 53, "Subsection",ExpressionUUID->"3623661c-f4fc-b946-b81d-9857ff564d5b",
 CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
Cell[16187, 421, 4464, 118, 172, "Input",ExpressionUUID->"26988afd-11a9-1c44-bd18-59a8a9fac28b",
 CellTags->{"Acceptance", "Number-of-events+sensitivity"}]
}, Closed]],
Cell[CellGroupData[{
Cell[20688, 544, 594, 10, 53, "Subsection",ExpressionUUID->"e25a0e24-a022-4842-96cd-1f84559c3f94",
 CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
Cell[21285, 556, 8785, 195, 468, "Input",ExpressionUUID->"93877176-470d-5b4a-87db-0f49b1478819",
 CellTags->{"Acceptance", "Number-of-events+sensitivity"}]
}, Closed]],
Cell[CellGroupData[{
Cell[30107, 756, 224, 4, 53, "Subsection",ExpressionUUID->"ec1691b9-f9be-7247-9f9c-d63aa93c450e",
 CellTags->{"Number-of-events+sensitivity", "Acceptance"}],
Cell[30334, 762, 6333, 150, 265, "Input",ExpressionUUID->"e490f5f0-d959-574c-8b5f-d51735710a2b",
 CellTags->{"Number-of-events+sensitivity", "Acceptance"}]
}, Closed]],
Cell[CellGroupData[{
Cell[36704, 917, 289, 5, 53, "Subsection",ExpressionUUID->"6e53cf51-459c-464e-9f98-8bbf36d051f6",
 CellTags->{"Number-of-events+sensitivity", "Acceptance"}],
Cell[36996, 924, 13680, 282, 660, "Input",ExpressionUUID->"5ea081c9-8fd0-8644-b032-52e8e6b8bdd8",
 CellTags->{"Number-of-events+sensitivity", "Acceptance"}]
}, Closed]],
Cell[CellGroupData[{
Cell[50713, 1211, 394, 9, 53, "Subsection",ExpressionUUID->"4e26538e-af17-2b40-87bf-2bf941d71722",
 CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
Cell[51110, 1222, 4814, 108, 270, "Input",ExpressionUUID->"befd8136-275e-2340-a745-079baf99bde3",
 CellTags->{"Acceptance", "Number-of-events+sensitivity"}]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[55973, 1336, 297, 6, 64, "Section",ExpressionUUID->"7d59f094-3c95-ed40-a349-3c63d1c89424",
 CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
Cell[56273, 1344, 5481, 120, 246, "Input",ExpressionUUID->"0edb2b52-1f88-8540-b5df-75246563ec07",
 CellTags->{"Acceptance", "Number-of-events+sensitivity"}]
}, Closed]]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[61815, 1471, 332, 6, 68, "Title",ExpressionUUID->"28586d1f-b279-f445-b5f5-a858d8c5e9de",
 CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
Cell[CellGroupData[{
Cell[62172, 1481, 311, 6, 65, "Chapter",ExpressionUUID->"7b9ec72b-f300-6947-8118-60dfa7620480",
 CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
Cell[62486, 1489, 9530, 237, 520, "Input",ExpressionUUID->"be98efa4-001b-5e4f-b892-2d0db6c7402a",
 CellTags->{"Acceptance", "Number-of-events+sensitivity"}]
}, Closed]],
Cell[CellGroupData[{
Cell[72053, 1731, 238, 5, 65, "Chapter",ExpressionUUID->"b8a043b6-ade0-964b-9c3f-50520aae2d33",
 CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
Cell[72294, 1738, 2046, 49, 246, "Input",ExpressionUUID->"607ff8ab-dd7c-4a44-bd43-da5ec3ce4038",
 CellTags->{"Acceptance", "Number-of-events+sensitivity"}]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[74389, 1793, 216, 4, 68, "Title",ExpressionUUID->"3e9a02fd-97c3-44ee-9f5b-9ca3983b66da",
 CellTags->"Number-of-events-computation+sensitivity"],
Cell[CellGroupData[{
Cell[74630, 1801, 368, 7, 65, "Chapter",ExpressionUUID->"76fe3cd1-27a0-4d11-852c-ea3c40d76fef",
 CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
Cell[75001, 1810, 805, 20, 49, "Input",ExpressionUUID->"10bc767d-43ce-4bd8-89d0-83fd85f2bb40",
 CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}]
}, Closed]],
Cell[CellGroupData[{
Cell[75843, 1835, 316, 6, 65, "Chapter",ExpressionUUID->"4cb86986-b7a3-4409-91ed-f7461f351ed0",
 CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
Cell[76162, 1843, 13242, 331, 468, "Input",ExpressionUUID->"68cd4c52-a57e-49cb-9552-92e7a8059080",
 CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
Cell[CellGroupData[{
Cell[89429, 2178, 416, 9, 64, "Section",ExpressionUUID->"972feb67-6add-ac40-99c7-991aaf347a8f",
 CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
Cell[CellGroupData[{
Cell[89870, 2191, 325, 8, 53, "Subsection",ExpressionUUID->"4593d3d7-94ed-0247-aa53-76f7ec6f84b3",
 CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
Cell[90198, 2201, 7367, 184, 262, "Input",ExpressionUUID->"e7b49a65-12ae-2c4b-8122-ef9651479899",
 CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}]
}, Closed]],
Cell[CellGroupData[{
Cell[97602, 2390, 307, 7, 53, "Subsection",ExpressionUUID->"2f9d0dea-ca8a-9444-b0ab-cc7df9b417d3",
 CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
Cell[97912, 2399, 9956, 241, 642, "Input",ExpressionUUID->"77f25579-e284-b54e-88fc-e402bfafcc7c",
 CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}]
}, Closed]]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[107929, 2647, 511, 8, 65, "Chapter",ExpressionUUID->"9c0a6fa2-083d-438f-84cb-5fa122f734c4",
 CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
Cell[CellGroupData[{
Cell[108465, 2659, 290, 6, 64, "Section",ExpressionUUID->"b0156caa-c6a2-ea49-9d19-2e75d36dd380",
 CellTags->{"Number-of-events-computation+sensitivity", "Acceptance-computation"}],
Cell[108758, 2667, 9799, 230, 521, "Input",ExpressionUUID->"6ed3ff0f-7809-5c49-aa01-00d78491ccb3",
 CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}]
}, Closed]],
Cell[CellGroupData[{
Cell[118594, 2902, 327, 6, 64, "Section",ExpressionUUID->"16f565d9-121d-a340-bd40-1b7a859a34ef",
 CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
Cell[118924, 2910, 6038, 161, 292, "Input",ExpressionUUID->"410333c8-39b9-db4f-96d8-0fac6e682479",
 CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}]
}, Closed]],
Cell[CellGroupData[{
Cell[124999, 3076, 257, 5, 64, "Section",ExpressionUUID->"8b0c9880-aa3a-7b49-a98b-d0fcac093aed",
 CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
Cell[125259, 3083, 13171, 307, 673, "Input",ExpressionUUID->"f906f3b6-9a26-684c-b4c8-75065a0ccfe5",
 CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
Cell[CellGroupData[{
Cell[138455, 3394, 317, 6, 53, "Subsection",ExpressionUUID->"12c4a047-206a-cd41-bac8-3da9c9e8279c",
 CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
Cell[138775, 3402, 5468, 112, 140, "Input",ExpressionUUID->"20a78213-5a61-f44c-893d-981a6d71d204",
 CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[144292, 3520, 241, 5, 64, "Section",ExpressionUUID->"6a6edac6-9974-6743-9e9b-7607c6f5952f",
 CellTags->{"Number-of-events-computation+sensitivity", "Acceptance-computation"}],
Cell[144536, 3527, 15126, 353, 450, "Input",ExpressionUUID->"f38d7eaf-e37c-2d45-9c7c-f7124f08952e",
 CellTags->{"Number-of-events-computation+sensitivity", "Acceptance-computation"}]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[159711, 3886, 218, 4, 65, "Chapter",ExpressionUUID->"913a2300-dec2-4b0f-8b44-4b75cf0adccf",
 CellTags->"Number-of-events-computation+sensitivity"],
Cell[CellGroupData[{
Cell[159954, 3894, 386, 7, 64, "Section",ExpressionUUID->"b0772e57-8882-4e3d-a1f7-c9c6f58dc7ac",
 CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
Cell[CellGroupData[{
Cell[160365, 3905, 388, 7, 53, "Subsection",ExpressionUUID->"09bda361-200e-4474-a4eb-51f045b744b2",
 CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
Cell[160756, 3914, 15148, 342, 690, "Input",ExpressionUUID->"07d9d00a-b1e3-45a3-8431-e5ba54203718",
 CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}]
}, Closed]],
Cell[CellGroupData[{
Cell[175941, 4261, 262, 5, 53, "Subsection",ExpressionUUID->"38691406-6de0-4e83-9a5b-27156e5454d3",
 CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
Cell[CellGroupData[{
Cell[176228, 4270, 253, 5, 46, "Subsubsection",ExpressionUUID->"a3aaf4e0-3a6f-1a4a-9d7f-56304c4e55bc",
 CellTags->{"Number-of-events-computation+sensitivity", "Acceptance-computation"}],
Cell[176484, 4277, 2954, 73, 176, "Input",ExpressionUUID->"2ad3871d-9835-3444-9fb8-0a832c2adf15",
 CellTags->{"Number-of-events-computation+sensitivity", "Acceptance-computation"}]
}, Closed]],
Cell[CellGroupData[{
Cell[179475, 4355, 275, 5, 46, "Subsubsection",ExpressionUUID->"52a0264d-e70c-8e42-96e9-463c01c40c40",
 CellTags->{"Number-of-events-computation+sensitivity", "Acceptance-computation"}],
Cell[179753, 4362, 16018, 392, 399, "Input",ExpressionUUID->"46fc40d5-c6c5-3e4d-92cd-122e24134dc2",
 CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[195820, 4760, 284, 5, 53, "Subsection",ExpressionUUID->"1f64e19f-68db-451d-9c11-af942b7e295b",
 CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
Cell[196107, 4767, 6313, 136, 268, "Input",ExpressionUUID->"2013639a-846d-4ea2-a0b9-81d0edd1cc67",
 CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[202469, 4909, 249, 5, 64, "Section",ExpressionUUID->"e71a519c-1cd2-c04d-b006-09b39bbbfbf2",
 CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
Cell[CellGroupData[{
Cell[202743, 4918, 309, 6, 53, "Subsection",ExpressionUUID->"42ab82d5-4d7e-4d06-8eb9-6e821b04db69",
 CellTags->{"Number-of-events-computation+sensitivity", "Acceptance-computation"}],
Cell[203055, 4926, 6742, 139, 262, "Input",ExpressionUUID->"963c4344-4087-43c6-b6e8-508b30bff543",
 CellTags->{"Number-of-events-computation+sensitivity", "Acceptance-computation"}]
}, Closed]],
Cell[CellGroupData[{
Cell[209834, 5070, 335, 8, 53, "Subsection",ExpressionUUID->"a2111b3d-b948-4362-97ab-aedd46e94fb9",
 CellTags->{"Number-of-events-computation+sensitivity", "Acceptance-computation"}],
Cell[210172, 5080, 8180, 197, 266, "Input",ExpressionUUID->"46f4d46b-66b1-4ab0-8fc9-e4f181080153",
 CellTags->{"Number-of-events-computation+sensitivity", "Acceptance-computation"}]
}, Closed]],
Cell[CellGroupData[{
Cell[218389, 5282, 232, 4, 53, "Subsection",ExpressionUUID->"748b8b59-c490-462f-bf37-7dc6537c8d0d",
 CellTags->"Number-of-events-computation+sensitivity"],
Cell[218624, 5288, 22845, 515, 824, "Input",ExpressionUUID->"46c1a4a5-1c46-489a-a061-206c6b7873bc",
 CellTags->"Number-of-events-computation+sensitivity"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[241518, 5809, 251, 4, 52, "Section",ExpressionUUID->"d97cf69b-14d7-4226-84be-25aa41979380"],
Cell[CellGroupData[{
Cell[241794, 5817, 174, 3, 42, "Subsection",ExpressionUUID->"8b643ea4-d4cf-439d-bf42-7d3cf2368f19"],
Cell[241971, 5822, 11704, 265, 286, "Input",ExpressionUUID->"6608ca61-80df-4c49-a1f8-56118e7339da"]
}, Closed]]
}, Closed]]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[253748, 6095, 262, 5, 68, "Title",ExpressionUUID->"0923b405-c0ba-437a-a0a1-eb2d8707c8c5",
 CellTags->"Number-of-events-computation+sensitivity"],
Cell[CellGroupData[{
Cell[254035, 6104, 213, 4, 65, "Chapter",ExpressionUUID->"2ada0cc1-1695-4a57-a86b-b11e240b979f",
 CellTags->"Number-of-events-computation+sensitivity"],
Cell[254251, 6110, 8363, 159, 313, "Input",ExpressionUUID->"d36d89ea-2d97-457b-aa5b-4b098e8235d8",
 CellTags->"Number-of-events-computation+sensitivity"]
}, Closed]],
Cell[CellGroupData[{
Cell[262651, 6274, 209, 4, 65, "Chapter",ExpressionUUID->"a58bd3a7-f345-470d-ba5e-82c520e24a7e",
 CellTags->"Number-of-events-computation+sensitivity"],
Cell[262863, 6280, 4690, 102, 262, "Input",ExpressionUUID->"b5ddb613-f8ce-4354-bf3e-3dc63b62f3d5",
 CellTags->"Number-of-events-computation+sensitivity"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[267602, 6388, 189, 3, 68, "Title",ExpressionUUID->"9cbf5dbf-7d97-438c-bab1-6a4374076885",
 CellTags->"Sensitivity"],
Cell[CellGroupData[{
Cell[267816, 6395, 188, 3, 65, "Chapter",ExpressionUUID->"9d756e77-cb38-4749-bd1a-ec57f9fa383a",
 CellTags->"Sensitivity"],
Cell[268007, 6400, 6131, 154, 414, "Input",ExpressionUUID->"09272721-e148-43d5-8826-7b8fa3f9f2fc",
 CellTags->"Sensitivity"]
}, Closed]],
Cell[CellGroupData[{
Cell[274175, 6559, 315, 7, 65, "Chapter",ExpressionUUID->"cba6efcf-5800-47ae-95bb-fbf537eda806",
 CellTags->"Sensitivity-computation"],
Cell[CellGroupData[{
Cell[274515, 6570, 209, 4, 64, "Section",ExpressionUUID->"fe300255-d2ee-884b-bc00-c6df44595cc6",
 CellTags->"Sensitivity-computation"],
Cell[274727, 6576, 5390, 115, 201, "Input",ExpressionUUID->"5b7a0bfe-29fb-6040-b8ab-4dd79508f2d5",
 CellTags->"Sensitivity-computation"]
}, Closed]],
Cell[CellGroupData[{
Cell[280154, 6696, 220, 4, 64, "Section",ExpressionUUID->"fc89cd31-0532-b84b-b148-fd58a202ae2e",
 CellTags->"Sensitivity-computation"],
Cell[280377, 6702, 15692, 384, 625, "Input",ExpressionUUID->"3fb1177c-8f25-3542-9db5-6bb033442f9b",
 CellTags->"Sensitivity-computation"],
Cell[CellGroupData[{
Cell[296094, 7090, 238, 4, 53, "Subsection",ExpressionUUID->"e7bf7c72-530f-5c49-ad49-b971df33c309",
 CellTags->"Sensitivity-computation"],
Cell[296335, 7096, 5197, 123, 277, "Input",ExpressionUUID->"002e3312-bd69-b34c-9e37-2ca865725ebb",
 CellTags->"Sensitivity-computation"]
}, Closed]],
Cell[CellGroupData[{
Cell[301569, 7224, 284, 5, 53, "Subsection",ExpressionUUID->"2f7cf3db-4b58-b94d-bb4e-a9276c35e47e",
 CellTags->"Sensitivity-computation"],
Cell[301856, 7231, 4032, 96, 185, "Input",ExpressionUUID->"0ed97628-be3e-044a-a7b0-0b76d9b8e872",
 CellTags->"Sensitivity-computation"]
}, Closed]]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[305949, 7334, 173, 3, 54, "Chapter",ExpressionUUID->"3cdb50bc-b94f-994a-bea4-ab6adc062293"],
Cell[CellGroupData[{
Cell[306147, 7341, 225, 4, 64, "Section",ExpressionUUID->"04de29f6-78bf-cd45-bbd5-c481cbd63244",
 CellTags->"Sensitivity-computation"],
Cell[306375, 7347, 4170, 109, 161, "Input",ExpressionUUID->"c8b8bb9e-591e-884b-8554-349f7c555ef0",
 CellTags->"Sensitivity-computation"]
}, Closed]],
Cell[CellGroupData[{
Cell[310582, 7461, 255, 5, 64, "Section",ExpressionUUID->"1779fba7-f5a1-1f4c-a7e8-1890db9d1963",
 CellTags->"Sensitivity-computation"],
Cell[310840, 7468, 4806, 113, 94, "Input",ExpressionUUID->"33a6e888-1b7f-5d4a-b31f-27d02dbd4f4d",
 CellTags->"Sensitivity-computation"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[315695, 7587, 210, 4, 65, "Chapter",ExpressionUUID->"6973c073-2e4b-4c34-a088-4365694bce10",
 CellTags->"Sensitivity-computation"],
Cell[CellGroupData[{
Cell[315930, 7595, 253, 5, 64, "Section",ExpressionUUID->"d57a2d3d-381f-479e-bde3-49c0fb15579a",
 CellTags->"Sensitivity-computation"],
Cell[316186, 7602, 2747, 71, 201, "Input",ExpressionUUID->"4018b168-837a-415b-ac72-f91c637de913",
 CellTags->"Sensitivity-computation"]
}, Closed]],
Cell[CellGroupData[{
Cell[318970, 7678, 196, 4, 64, "Section",ExpressionUUID->"9f6548e1-453f-47b5-b82c-a2ef474f018e",
 CellTags->"Sensitivity-computation"],
Cell[CellGroupData[{
Cell[319191, 7686, 269, 5, 53, "Subsection",ExpressionUUID->"6b015ada-f566-6645-af59-37c927aa9bed",
 CellTags->"Sensitivity-computation"],
Cell[319463, 7693, 20946, 476, 1031, "Input",ExpressionUUID->"8f64fab3-94e2-432a-9ab3-44e819bfd780",
 CellTags->"Sensitivity-computation"]
}, Closed]],
Cell[CellGroupData[{
Cell[340446, 8174, 211, 4, 53, "Subsection",ExpressionUUID->"582a549f-e1ac-ad4f-a713-3310984b98fc",
 CellTags->"Sensitivity-computation"],
Cell[340660, 8180, 19610, 513, 551, "Input",ExpressionUUID->"a09d5048-69f6-004c-be52-76389258a3d9",
 CellTags->"Sensitivity-computation"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[360319, 8699, 216, 4, 64, "Section",ExpressionUUID->"6021facd-3912-304d-883c-9c23a498452b",
 CellTags->"Sensitivity-computation"],
Cell[CellGroupData[{
Cell[360560, 8707, 260, 6, 53, "Subsection",ExpressionUUID->"9fde3f02-c676-fb4a-b5e0-11624bdc274c",
 CellTags->"Sensitivity-computation"],
Cell[360823, 8715, 15844, 377, 859, "Input",ExpressionUUID->"6378a9e4-eb30-8c42-986c-286407554b62",
 CellTags->"Sensitivity-computation"]
}, Closed]],
Cell[CellGroupData[{
Cell[376704, 9097, 213, 4, 53, "Subsection",ExpressionUUID->"ad894679-8bc4-0941-86eb-6243caebc201",
 CellTags->"Sensitivity-computation"],
Cell[376920, 9103, 16798, 395, 624, "Input",ExpressionUUID->"1f3c7537-6ec9-b544-a130-87f5d88302bf",
 CellTags->"Sensitivity-computation"]
}, Closed]]
}, Closed]]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[393791, 9506, 171, 3, 57, "Title",ExpressionUUID->"519ed843-8f32-4e91-84d0-5f5d5f152eee"],
Cell[393965, 9511, 892, 17, 53, "Input",ExpressionUUID->"da6a725b-270d-45e0-bd71-6f5132a81d48"],
Cell[394860, 9530, 174, 3, 24, "Input",ExpressionUUID->"0b403f30-a3bf-4727-8bcb-0362f9a09fda"],
Cell[395037, 9535, 175, 3, 24, "Input",ExpressionUUID->"44dd3271-d0c6-481b-9a45-036436435ea1"]
}, Closed]]
}
]
*)

