(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    356631,       8435]
NotebookOptionsPosition[    316567,       7851]
NotebookOutlinePosition[    340705,       8157]
CellTagsIndexPosition[    340401,       8147]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Just launch the code below to run the notebook (shift+enter)", "Title",
 CellChangeTimes->{{3.8934376452895875`*^9, 
  3.8934376644509068`*^9}},ExpressionUUID->"3a6189ab-b48c-4865-a933-\
cc9614b95029"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ParallelEvaluate", "[", 
   RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BlockEvaluation", "[", "tag_", "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"nb", "=", 
      RowBox[{"EvaluationNotebook", "[", "]"}]}], ";", "\n", 
     RowBox[{"NotebookFind", "[", 
      RowBox[{"nb", ",", "tag", ",", "All", ",", "CellTags"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"SelectionEvaluate", "[", "nb", "]"}]}]}], "\[IndentingNewLine]",
    "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CloseKernels", "[", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"LaunchKernels", "[", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"choiceslist", "=", 
   RowBox[{"{", 
    RowBox[{"\"\<Tabulated Nevents+sensitivity\>\"", 
     ",", "\"\<Sensitivity only (tabulated Nevents must be produced before)\>\
\"", ",", "\"\<Tabulated Nevents only\>\"", ",", "\"\<Acceptance\>\""}], 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"taglist", "[", "\"\<Acceptance\>\"", "]"}], 
   "=", "\"\<Acceptance\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"taglist", "[", "\"\<Tabulated Nevents+sensitivity\>\"", "]"}], "=", 
   RowBox[{
    RowBox[{"taglist", "[", "\"\<Tabulated Nevents only\>\"", "]"}], 
    "=", "\"\<Number-of-events+sensitivity\>\""}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
   "taglist", 
    "[", "\"\<Sensitivity only (tabulated Nevents must be produced \
before)\>\"", "]"}], "=", "\"\<Sensitivity\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NotebookEvaluate", "[", 
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"NotebookDirectory", "[", "]"}], 
      ",", "\"\<codes/dialog-windows.nb\>\""}], "}"}], "]"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"launchoptions", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"Keys", "[", 
     RowBox[{"DownValues", "@", "taglist"}], "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", "1", ",", "1"}], "]"}], "]"}], "//", "Sort"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MapThread", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"explanationlist", "[", "#1", "]"}], "=", "#2"}], ")"}], "&"}],
     ",", 
    RowBox[{"{", 
     RowBox[{"launchoptions", ",", 
      RowBox[{"{", 
       RowBox[{"\"\<Produce acceptances plots only (see Fig. 12 and \
explanation in text of 2305.13383)\>\"", 
        ",", "\"\<Produce sensitivities assuming that the tabulated number of \
events has been produced before\>\"", 
        ",", "\"\<Produce tabulated number of events (mass, coupling, \
Nevents(mass, coupling))\>\"", 
        ",", "\"\<Produce tabulated number of events and then \
sensitivity\>\""}], "}"}]}], "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"computationchoice", "=", 
  RowBox[{"selectionDialogExplanationOneOption", "[", 
   RowBox[{"launchoptions", ",", 
    RowBox[{
     RowBox[{
      RowBox[{"explanationlist", "[", "#", "]"}], "&"}], "/@", 
     "launchoptions"}], 
    ",", "\"\<Select the regime of launching the notebook\>\"", ",", "250"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"tagselected", "=", 
  RowBox[{"taglist", "[", "computationchoice", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
    "computationchoice", "==", "\"\<Tabulated Nevents+sensitivity\>\""}], ",", 
    RowBox[{"sensComp", "=", "True"}], ",", 
    RowBox[{"sensComp", "=", "False"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"BlockEvaluation", "[", "tagselected", "]"}]}], "Input",
 CellChangeTimes->{{3.893437585709897*^9, 3.8934375895369635`*^9}, {
   3.8934376329497385`*^9, 3.893437658846809*^9}, 3.893573148874529*^9, {
   3.8936653619937787`*^9, 3.893665362662826*^9}, {3.895054198384289*^9, 
   3.895054198620511*^9}, {3.8951271161961904`*^9, 3.8951271342621512`*^9}, 
   3.9025630567005696`*^9, {3.9027294552735224`*^9, 3.9027294812265596`*^9}, 
   3.902817864446456*^9, {3.9038926036482916`*^9, 3.90389261524858*^9}, {
   3.9138040672330217`*^9, 3.913804068186876*^9}, 3.9146681646612635`*^9, {
   3.9168216054586754`*^9, 3.916821605661872*^9}, {3.917021517854858*^9, 
   3.9170215181049953`*^9}, 3.947686373734455*^9, 3.948258117767826*^9, {
   3.9488679138374786`*^9, 3.948867942899235*^9}, {3.948877258781378*^9, 
   3.9488773080704117`*^9}, {3.9506035435416107`*^9, 3.950603543736721*^9}, {
   3.950683385705984*^9, 3.950683385874647*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"67d16bcb-6808-46ec-ae03-72ce61d72bb8"]
}, Closed]],

Cell[CellGroupData[{

Cell["Preliminary definitions (launch first)", "Title",
 CellChangeTimes->{{3.7552434949579296`*^9, 3.755243495237189*^9}, {
  3.88501652694691*^9, 3.885016532955313*^9}, {3.8850204805201235`*^9, 
  3.885020485584347*^9}},
 CellTags->{
  "Acceptance", 
   "Number-of-events+sensitivity"},ExpressionUUID->"f64b31a6-3a21-452a-9085-\
9eaa0b5708aa"],

Cell[CellGroupData[{

Cell["Various directories", "Chapter",
 CellChangeTimes->{{3.913804059957842*^9, 3.913804062327417*^9}},
 CellTags->{
  "Acceptance", 
   "Number-of-events+sensitivity"},ExpressionUUID->"42604705-3a49-4b5e-8e1e-\
dfccfe5f7eee"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"LLPdirName", "=", "\"\<HNL\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"ToString", "[", 
       RowBox[{"Head", "[", "computationchoice", "]"}], "]"}], 
      "==", "\"\<Symbol\>\""}], ",", 
     RowBox[{"computationchoice", "=", "\"\<Tabulated Nevents only\>\""}]}], 
    "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Set", " ", "the", " ", "directory", " ", "for", " ", "the", " ", "search",
     " ", "where", " ", "tabulated", " ", "acceptances", " ", "are", " ", 
    "located"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"directory", "[", "\"\<Acceptances\>\"", "]"}], "=", 
    RowBox[{"FileNameJoin", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"NotebookDirectory", "[", "]"}], ",", "\"\<Acceptances\>\""}], 
      "}"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Set", " ", "the", " ", "directory", " ", "for", " ", "the", " ", 
     "search", " ", "where", " ", "tabulated", " ", "angle"}], "-", 
    RowBox[{"energy", " ", "distributions", " ", "are", " ", "located"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"directory", "[", "\"\<Distribution\>\"", "]"}], "=", 
    RowBox[{"FileNameJoin", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"NotebookDirectory", "[", "]"}], 
       ",", "\"\<spectra/New physics particles spectra\>\"", ",", 
       "LLPdirName"}], "}"}], "]"}]}], ";"}], " ", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "The", " ", "directory", " ", "storing", " ", "production", " ", "weights",
     " ", "of", " ", "the", " ", "given", " ", "LLP"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"directory", "[", "\"\<Production weights\>\"", "]"}], "=", 
    RowBox[{"FileNameJoin", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"NotebookDirectory", "[", "]"}], ",", "\"\<phenomenology\>\"", 
       ",", "LLPdirName", ",", "\"\<Production probabilities\>\""}], "}"}], 
     "]"}]}], ";"}], " ", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Directory", " ", "to", " ", "which", " ", "various", " ", "auxillary", " ",
     "datasets", " ", "will", " ", "be", " ", "stored"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"directory", "[", "\"\<Auxiliary\>\"", "]"}], "=", 
    RowBox[{"FileNameJoin", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"NotebookDirectory", "[", "]"}], ",", "\"\<Auxiliary data\>\"",
        ",", "LLPdirName"}], "}"}], "]"}]}], ";"}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"!", 
      RowBox[{"DirectoryQ", "[", 
       RowBox[{"directory", "[", "\"\<Auxiliary\>\"", "]"}], "]"}]}], ",", 
     RowBox[{"CreateDirectory", "[", 
      RowBox[{"directory", "[", "\"\<Auxiliary\>\"", "]"}], "]"}]}], "]"}], 
   ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Directory", " ", "containing", " ", "decay", " ", "widths", " ", "of", " ",
     "the", " ", "LLPs"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"directory", "[", "\"\<Decays\>\"", "]"}], "=", 
    RowBox[{"FileNameJoin", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"NotebookDirectory", "[", "]"}], ",", "\"\<phenomenology\>\"", 
       ",", "LLPdirName", ",", "\"\<decay widths\>\""}], "}"}], "]"}]}], 
   ";"}], " "}]}], "Input",
 CellChangeTimes->{{3.913804080271287*^9, 3.913804171309696*^9}, {
   3.913804205284999*^9, 3.913804380241178*^9}, 3.913810641365505*^9, {
   3.9156427854806695`*^9, 3.915642785499219*^9}, {3.950683425503538*^9, 
   3.9506834256703033`*^9}},
 CellTags->{"Acceptance", "Number-of-events+sensitivity"},
 CellLabel->"In[79]:=",ExpressionUUID->"6b7757b1-3b9c-4467-ae36-04129f4d3e08"]
}, Closed]],

Cell[CellGroupData[{

Cell["Loading necessary routines", "Chapter",
 CellChangeTimes->{{3.891315426588935*^9, 3.891315432542842*^9}, {
  3.9165033404709945`*^9, 3.9165033463985844`*^9}},
 CellTags->{
  "Acceptance", 
   "Number-of-events+sensitivity"},ExpressionUUID->"59619f15-a7a1-0e41-b4f5-\
0933e4622dbf"],

Cell[BoxData[
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Length", "[", "inecessary", "]"}], "==", "0"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"NotebookEvaluate", "[", 
     RowBox[{"FileNameJoin", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"NotebookDirectory", "[", "]"}], 
        ",", "\"\<codes/generic.nb\>\""}], "}"}], "]"}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"NotebookEvaluate", "[", 
     RowBox[{"FileNameJoin", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"NotebookDirectory", "[", "]"}], 
        ",", "\"\<codes/dialog-windows.nb\>\""}], "}"}], "]"}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"NotebookEvaluate", "[", 
     RowBox[{"FileNameJoin", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"NotebookDirectory", "[", "]"}], 
        ",", "\"\<codes/for-sensitivities.nb\>\""}], "}"}], "]"}], "]"}], ";",
     "\[IndentingNewLine]", 
    RowBox[{"inecessary", "=", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], ";"}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.890711783488103*^9, 3.89071178348964*^9}, {
   3.8907121412539587`*^9, 3.8907121413711557`*^9}, {3.890712694841427*^9, 
   3.8907126950000925`*^9}, {3.890712790376151*^9, 3.8907128219919777`*^9}, {
   3.891018553068019*^9, 3.8910185548862777`*^9}, {3.914141327087761*^9, 
   3.9141413282588053`*^9}, 3.9165033910195627`*^9, {3.916503434997039*^9, 
   3.9165034401725807`*^9}, {3.9165108789774036`*^9, 
   3.9165108974096084`*^9}, {3.9165109290075464`*^9, 3.916510969839264*^9}, {
   3.948258207380787*^9, 3.948258211345028*^9}, {3.9506035507790127`*^9, 
   3.950603551004959*^9}},
 CellTags->{"Acceptance", "Number-of-events+sensitivity"},
 CellLabel->"In[87]:=",ExpressionUUID->"ea90bc64-d743-2647-a02b-45e503c9cce8"]
}, Closed]],

Cell[CellGroupData[{

Cell["LLP phenomenology: production probabilities, decay widths", "Chapter",
 CellChangeTimes->{{3.835270415198964*^9, 3.8352704154970675`*^9}, {
   3.854441650570236*^9, 3.8544416515373263`*^9}, {3.885016402104937*^9, 
   3.8850164030053596`*^9}, 3.885019196491799*^9, {3.885019273945055*^9, 
   3.88501928458453*^9}, {3.9137189927638807`*^9, 3.9137190046798325`*^9}, 
   3.9156427855096855`*^9, 3.9522411038484974`*^9},
 CellTags->{
  "Acceptance", 
   "Number-of-events+sensitivity"},ExpressionUUID->"623267a1-9c4d-426c-8448-\
961507b9c3b3"],

Cell[CellGroupData[{

Cell["Various parameters", "Section",
 CellChangeTimes->{{3.9506834455774574`*^9, 3.95068344778598*^9}},
 CellTags->{
  "Number-of-events+sensitivity", 
   "Acceptance"},ExpressionUUID->"af114df9-b54e-3445-86d3-175387718476"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"chbar", "=", " ", 
    RowBox[{"6.6", "*", 
     SuperscriptBox["10", 
      RowBox[{"-", "25"}]], "*", "3", "*", 
     SuperscriptBox["10", "8"]}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Masses", " ", "of", " ", "various", " ", "SM", " ", "particles"}],
    "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"mSM", "[", "\"\<e\>\"", "]"}], ",", 
     RowBox[{"mSM", "[", "\"\<mu\>\"", "]"}], ",", 
     RowBox[{"mSM", "[", "\"\<tau\>\"", "]"}]}], "}"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"0.5", "*", 
      SuperscriptBox["10", 
       RowBox[{"-", "3"}]]}], ",", "0.105", ",", "1.77"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"mSM", "[", "\"\<W\>\"", "]"}], ",", 
     RowBox[{"mSM", "[", "\"\<Z\>\"", "]"}]}], "}"}], " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"80.369", ",", "91.1876"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"mSM", "[", "\"\<e\>\"", "]"}], ",", 
     RowBox[{"mSM", "[", "\"\<mu\>\"", "]"}], ",", 
     RowBox[{"mSM", "[", "\"\<PiCharged\>\"", "]"}]}], "}"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"0.5", "*", 
      SuperscriptBox["10", 
       RowBox[{"-", "3"}]]}], ",", "0.105", ",", "0.139"}], "}"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.884661904994011*^9, 3.884661921540403*^9}, {
   3.8850164522887964`*^9, 3.8850165245568185`*^9}, {3.885016628097911*^9, 
   3.8850166282886553`*^9}, 3.885016710182028*^9, {3.8850167568987885`*^9, 
   3.885016762395402*^9}, {3.885016799450395*^9, 3.8850170557864246`*^9}, {
   3.88501712653312*^9, 3.885017216885895*^9}, {3.8850173024453783`*^9, 
   3.8850173372383676`*^9}, {3.885017399572728*^9, 3.88501741270778*^9}, {
   3.8850174625354366`*^9, 3.885017462658634*^9}, {3.8850175591211877`*^9, 
   3.8850175593408356`*^9}, {3.8850182535473127`*^9, 
   3.8850182538962827`*^9}, {3.885018314394388*^9, 3.885018333197164*^9}, {
   3.8850189741121674`*^9, 3.885018974433589*^9}, 3.8850190966970725`*^9, {
   3.885019721482507*^9, 3.8850197654258046`*^9}, {3.885019828534438*^9, 
   3.8850198661946564`*^9}, {3.88501995528426*^9, 3.8850201480526233`*^9}, {
   3.885020185062007*^9, 3.8850201894992275`*^9}, {3.885020291896063*^9, 
   3.8850203335305076`*^9}, {3.885020432284384*^9, 3.8850204475138783`*^9}, {
   3.8850205949824495`*^9, 3.885020600587699*^9}, {3.8850212843213625`*^9, 
   3.88502132833275*^9}, {3.885032891250867*^9, 3.8850329826946216`*^9}, {
   3.885033159126209*^9, 3.885033161690289*^9}, {3.8850331946913424`*^9, 
   3.8850331954065113`*^9}, {3.8850336204217644`*^9, 
   3.8850336226032686`*^9}, {3.8850342557191987`*^9, 
   3.8850344920061417`*^9}, {3.8850345924696712`*^9, 3.885034596199212*^9}, {
   3.886095663976947*^9, 3.8860956701025677`*^9}, {3.886096187077428*^9, 
   3.8860963364493656`*^9}, {3.888641759315454*^9, 3.88864182888459*^9}, 
   3.8886421804133463`*^9, {3.8886422161639967`*^9, 3.8886422184142056`*^9}, {
   3.8886422723082395`*^9, 3.88864227597868*^9}, {3.888642315342514*^9, 
   3.888642317618765*^9}, {3.888642509666093*^9, 3.8886425556017246`*^9}, {
   3.890286782146555*^9, 3.8902867825177317`*^9}, {3.8955883793479033`*^9, 
   3.8955883800700903`*^9}, {3.913717069705282*^9, 3.9137171322372255`*^9}, {
   3.9137174909865065`*^9, 3.913717516134427*^9}, {3.9144876980713525`*^9, 
   3.9144876991445985`*^9}, {3.9149112411407185`*^9, 
   3.9149112606666565`*^9}, {3.9149218141493225`*^9, 3.914921819803321*^9}, {
   3.9482582666812*^9, 3.9482582678459053`*^9}},
 CellTags->{"Acceptance", "Number-of-events+sensitivity"},
 CellLabel->"In[88]:=",ExpressionUUID->"38e841c8-a539-4bae-bc89-9632f0a3f574"]
}, Closed]],

Cell[CellGroupData[{

Cell["Production weights", "Section",
 CellChangeTimes->{{3.913715464961954*^9, 3.9137154671131763`*^9}},
 CellTags->{
  "Acceptance", 
   "Number-of-events+sensitivity"},ExpressionUUID->"37172817-c603-4615-8d0d-\
26b3f798db56"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"For", " ", 
    RowBox[{"mesons", ":", " ", 
     FormBox[
      RowBox[{
       RowBox[{
        SubscriptBox["\[Sum]", "meson"], 
        RowBox[{
         SubscriptBox["f", 
          RowBox[{"q", "\[Rule]", "meson"}]], "*", "Br", 
         RowBox[{"(", 
          RowBox[{"meson", "\[Rule]", "N"}], ")"}], " ", "at", " ", 
         SuperscriptBox["U", "2"]}]}], " ", "=", " ", "1"}],
      TraditionalForm]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"For", " ", "X"}], " ", "=", " ", 
    RowBox[{
     RowBox[{"W", "/", 
      RowBox[{"Z", ":", " ", 
       RowBox[{"Br", 
        RowBox[{"(", 
         RowBox[{"X", "->", "N"}], ")"}], " ", "at", " ", 
        SuperscriptBox["U", "2"]}]}]}], " ", "=", " ", "1"}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"PmotherToLLPtemp", ",", "PmotherToLLP"}], "}"}], "//", 
     "Clear"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ProductionWeightsTemp", "[", "mN_", "]"}], "=", 
     RowBox[{"Import", "[", 
      RowBox[{
       RowBox[{"FileNameJoin", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"directory", "[", "\"\<Production weights\>\"", "]"}], 
          ",", "\"\<ProductionWeightsHNL.m\>\""}], "}"}], "]"}], 
       ",", "\"\<MX\>\""}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"Do", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"hnl", ",", "prod", ",", "facility"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"hnl", ",", "prod", ",", "facility"}], "}"}], "=", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"ProductionWeightsTemp", "[", "mLLP", "]"}], "[", 
             RowBox[{"[", "i", "]"}], "]"}], "[", 
            RowBox[{"[", "#", "]"}], "]"}], "&"}], "/@", 
          RowBox[{"{", 
           RowBox[{"1", ",", "2", ",", "3"}], "}"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"PmotherToLLPtemp", "[", 
          RowBox[{
          "mLLP_", ",", "U2_", ",", "hnl", ",", "prod", ",", "facility"}], 
          "]"}], "=", 
         RowBox[{"U2", "*", 
          RowBox[{
           RowBox[{
            RowBox[{"ProductionWeightsTemp", "[", "mLLP", "]"}], "[", 
            RowBox[{"[", "i", "]"}], "]"}], "[", 
           RowBox[{"[", "4", "]"}], "]"}]}]}], ";"}]}], "\[IndentingNewLine]",
       "]"}], "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", 
        RowBox[{"ProductionWeightsTemp", "[", "mLLP", "]"}], "]"}], ",", 
       "1"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"WeightsCombinations", "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Keys", "[", 
           RowBox[{"DownValues", "@", "PmotherToLLPtemp"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "1", ",", "#"}], "]"}], "]"}], "&"}], "/@", 
        RowBox[{"{", 
         RowBox[{"3", ",", "4", ",", "5"}], "}"}]}], "//", "Transpose"}], "//",
       "Sort"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Leaving", " ", "production", " ", "modes", " ", "from", " ", "decays", " ",
      "of", " ", "muons", " ", "and", " ", "pions", " ", "only", " ", "for", " ",
      "ESS"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"WeightsCombinations", "=", 
     RowBox[{"Select", "[", 
      RowBox[{"WeightsCombinations", ",", 
       RowBox[{
        RowBox[{
         RowBox[{"!", 
          RowBox[{"MemberQ", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"\"\<PiCharged\>\"", ",", "\"\<mu\>\""}], "}"}], ",", 
            RowBox[{"#", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "||", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"MemberQ", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"\"\<PiCharged\>\"", ",", "\"\<mu\>\""}], "}"}], ",", 
             RowBox[{"#", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "&&", 
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "3", "]"}], "]"}], "==", "\"\<ESS\>\""}]}], ")"}]}],
         "&"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "Leaving", " ", "production", " ", "modes", " ", "from", " ", "decays", " ",
       "of", " ", "Ws", " ", "only", " ", "for", " ", 
      RowBox[{"LHC", "/", "FCC"}]}], "-", "hh"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"WeightsCombinations", "=", 
     RowBox[{"Select", "[", 
      RowBox[{"WeightsCombinations", ",", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "!=", "\"\<W\>\""}], "||", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "==", "\"\<W\>\""}], "&&", 
           RowBox[{"MemberQ", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"\"\<LHC\>\"", ",", "\"\<FCC-hh\>\""}], "}"}], ",", 
             RowBox[{"#", "[", 
              RowBox[{"[", "3", "]"}], "]"}]}], "]"}]}], ")"}]}], "&"}]}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Leaving", " ", "production", " ", "modes", " ", "from", " ", "decays", " ",
      "of", " ", "Ks", " ", "only", " ", "for", " ", "SPS"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"WeightsCombinations", "=", 
     RowBox[{"Select", "[", 
      RowBox[{"WeightsCombinations", ",", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "!=", "\"\<K\>\""}], "||", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "==", "\"\<K\>\""}], "&&", 
           RowBox[{"MemberQ", "[", 
            RowBox[{
             RowBox[{"{", "\"\<SPS\>\"", "}"}], ",", 
             RowBox[{"#", "[", 
              RowBox[{"[", "3", "]"}], "]"}]}], "]"}]}], ")"}]}], "&"}]}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "Leaving", " ", "production", " ", "modes", " ", "from", " ", "decays", " ",
       "of", " ", "B"}], ",", " ", 
     RowBox[{"D", " ", "only", " ", "for", " ", "SPS"}], ",", " ", 
     "FermilabBD", ",", " ", "LHC", ",", " ", 
     RowBox[{"FCC", "-", "hh"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"WeightsCombinations", "=", 
     RowBox[{"Select", "[", 
      RowBox[{"WeightsCombinations", ",", 
       RowBox[{
        RowBox[{
         RowBox[{"!", 
          RowBox[{"MemberQ", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"\"\<B\>\"", ",", "\"\<D\>\""}], "}"}], ",", 
            RowBox[{"#", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "||", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"MemberQ", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"\"\<B\>\"", ",", "\"\<D\>\""}], "}"}], ",", 
             RowBox[{"#", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "&&", 
           RowBox[{"MemberQ", "[", 
            RowBox[{
             RowBox[{"{", 
              
              RowBox[{"\"\<LHC\>\"", ",", "\"\<FCC-hh\>\"", ",", "\"\<SPS\>\"",
                ",", "\"\<FermilabBD\>\""}], "}"}], ",", 
             RowBox[{"#", "[", 
              RowBox[{"[", "3", "]"}], "]"}]}], "]"}]}], ")"}]}], "&"}]}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"WeightsCombinations", "=", 
      RowBox[{"Cases", "[", 
       RowBox[{"WeightsCombinations", ",", 
        RowBox[{"_", "?", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"MemberQ", "[", 
            RowBox[{"DistrCombinations", ",", "#"}], "]"}], "&"}], ")"}]}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"IfCondDistrToWeights", "=", 
      RowBox[{"DistrCombinations", "==", "WeightsCombinations"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", "IfCondDistrToWeights"}], ",", 
       RowBox[{
        RowBox[{
        "infoDialog", 
         "[", "\"\<You have not provided the production probabilities \
PmotherToLLP to all the generated tabulated distributions! Please do this \
first to avoid problems\>\"", "]"}], ";"}]}], "]"}]}], "\[IndentingNewLine]", 
    "*)"}]}]}]], "Input",
 CellChangeTimes->{{3.9137154830486135`*^9, 3.9137154861654243`*^9}, {
   3.9137156258996983`*^9, 3.9137156656505384`*^9}, {3.9137166072827406`*^9, 
   3.913716909347183*^9}, {3.913717740520071*^9, 3.913717742071462*^9}, {
   3.9137183661693354`*^9, 3.9137185252684245`*^9}, {3.9137185608244286`*^9, 
   3.9137185910373416`*^9}, {3.9137186255780573`*^9, 
   3.9137187453381844`*^9}, {3.913718826235504*^9, 3.9137188271455884`*^9}, {
   3.9137188821150885`*^9, 3.9137189734225225`*^9}, {3.9137999995498495`*^9, 
   3.9138000014610972`*^9}, 3.9138000726722393`*^9, {3.9138006666398582`*^9, 
   3.913800679309887*^9}, {3.913801525795463*^9, 3.9138015269400687`*^9}, {
   3.913804274301155*^9, 3.913804275375497*^9}, 3.913804323078146*^9, 
   3.913810573759503*^9, {3.913810627155449*^9, 3.9138106277845297`*^9}, {
   3.9138106620116177`*^9, 3.9138106744560103`*^9}, {3.9138844578013053`*^9, 
   3.913884460750244*^9}, {3.9156427855192037`*^9, 3.9156427855370984`*^9}, {
   3.950683492075226*^9, 3.950683527104639*^9}, {3.950683569572916*^9, 
   3.9506835917084923`*^9}, {3.9506838765583935`*^9, 
   3.9506839765263195`*^9}, {3.950684035791771*^9, 3.950684227750969*^9}, {
   3.9506843308030205`*^9, 3.9506843420195065`*^9}, {3.9506845776582813`*^9, 
   3.9506846100678177`*^9}, {3.9506848508307457`*^9, 3.950685001475933*^9}, {
   3.9506852463108616`*^9, 3.950685347045183*^9}, {3.9506856026952744`*^9, 
   3.950685610395012*^9}, {3.954699942261484*^9, 3.954699951912554*^9}},
 CellTags->{"Acceptance", "Number-of-events+sensitivity"},
 CellLabel->"In[71]:=",ExpressionUUID->"d1c6616d-40d9-464d-86b7-e83699d2bee4"]
}, Closed]],

Cell[CellGroupData[{

Cell["Scanning for tabulated distributions", "Section",
 CellChangeTimes->{{3.9137150010274553`*^9, 3.9137150224099426`*^9}, {
  3.913715411520641*^9, 3.913715414252445*^9}},
 CellTags->{
  "Acceptance", 
   "Number-of-events+sensitivity"},ExpressionUUID->"c25fdc5a-83d4-4c0d-81f5-\
20768a5e4090"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Define", " ", "the", " ", "file", " ", "pattern"}], "*)"}], "\n", 
  RowBox[{
   RowBox[{
    RowBox[{"pattern", "=", "\"\<DoubleDistr_*_*_*.m\>\""}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Search", " ", "for", " ", "files", " ", "matching", " ", "the", " ", 
     "pattern", " ", "in", " ", "the", " ", "directory", " ", "and", " ", 
     "its", " ", "subdirectories"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"matchingFiles", "=", 
     RowBox[{"FileNames", "[", 
      RowBox[{"pattern", ",", 
       RowBox[{"{", 
        RowBox[{"directory", "[", "\"\<Distribution\>\"", "]"}], "}"}], ",", 
       "Infinity"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"List", " ", "of", " ", "LLPs"}], ",", " ", 
     RowBox[{"production", " ", "modes"}], ",", " ", 
     RowBox[{
     "and", " ", "facilities", " ", "for", " ", "which", " ", "the", " ", 
      "tabulated", " ", "distributions", " ", "have", " ", "been", " ", 
      "computed", " ", "at", " ", "the", " ", "previous", " ", "stage", " ", 
      "of", " ", "using", " ", "SensCalc"}]}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"ExtractedProductionParameters", "=", 
     RowBox[{"Function", "[", 
      RowBox[{"filename", ",", 
       RowBox[{
        RowBox[{"parts", "=", 
         RowBox[{"StringSplit", "[", 
          RowBox[{
           RowBox[{"FileNameTake", "[", "filename", "]"}], ",", "\"\<_\>\""}],
           "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"parts", "[", 
           RowBox[{"[", "2", "]"}], "]"}], ",", 
          RowBox[{"parts", "[", 
           RowBox[{"[", "3", "]"}], "]"}], ",", 
          RowBox[{"StringDrop", "[", 
           RowBox[{
            RowBox[{"parts", "[", 
             RowBox[{"[", "4", "]"}], "]"}], ",", 
            RowBox[{"-", "2"}]}], "]"}]}], "}"}]}]}], " ", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Apply", " ", "the", " ", "function", " ", "to", " ", "each", " ", "file",
      " ", "in", " ", "the", " ", "list"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"DistrCombinations", "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"ExtractedProductionParameters", "/@", "matchingFiles"}], 
       ")"}], "//", "Sort"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"HNLsList", "=", 
     RowBox[{"{", 
      RowBox[{"\"\<HNL-mixing-e\>\"", ",", "\"\<HNL-mixing-mu\>\"", 
       ",", "\"\<HNL-mixing-tau\>\""}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"DistrCombinations", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "1"}], "]"}], "]"}], "//", "DeleteDuplicates"}], 
      "//", "Sort"}], ")"}], "==", "HNLsList"}]}]}]], "Input",
 CellChangeTimes->{{3.9137151636915593`*^9, 3.9137152465178137`*^9}, {
   3.9137153053586187`*^9, 3.913715399589816*^9}, {3.913718678447782*^9, 
   3.913718708673525*^9}, {3.913719203960288*^9, 3.9137192388759937`*^9}, {
   3.913804074855399*^9, 3.913804089247952*^9}, 3.9138043135262485`*^9, 
   3.915642785514675*^9, {3.950683611863859*^9, 3.9506836147885704`*^9}},
 CellTags->{"Acceptance", "Number-of-events+sensitivity"},
 CellLabel->"In[39]:=",ExpressionUUID->"ebd6615e-fb63-4dfd-9eda-c7ad887425a8"]
}, Closed]]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Specifying the experiment and HNL", "Title",
 CellChangeTimes->{{3.8876178747397523`*^9, 3.8876178773785458`*^9}, {
  3.8888191963965187`*^9, 3.8888191979428654`*^9}},
 CellTags->{
  "Acceptance", 
   "Number-of-events+sensitivity"},ExpressionUUID->"6aee5356-b39c-45f1-83d9-\
c276143eb260"],

Cell[CellGroupData[{

Cell["HNL", "Chapter",
 CellChangeTimes->{{3.9027285799460387`*^9, 3.90272858025308*^9}},
 CellTags->{
  "Acceptance", 
   "Number-of-events+sensitivity"},ExpressionUUID->"5b02137e-da6c-4b5c-af74-\
2eb5ac2b44ac"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ListHNLtype", "=", 
   RowBox[{"{", 
    RowBox[{"\"\<Dirac\>\"", ",", "\"\<Majorana\>\""}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"mergedDialog", ":=", 
    RowBox[{"DialogInput", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"choice", "=", "\"\<Majorana\>\""}], ",", 
        RowBox[{"pattern", "=", 
         RowBox[{"{", 
          RowBox[{"1.", ",", "0.", ",", "0."}], "}"}]}]}], "}"}], ",", 
      RowBox[{"Column", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Style", "[", 
          RowBox[{
           RowBox[{"Row", "[", 
            RowBox[{"{", "\"\<Select the HNL type:\>\"", "}"}], "]"}], ",", 
           "Bold"}], "]"}], ",", 
         RowBox[{"PopupMenu", "[", 
          RowBox[{
           RowBox[{"Dynamic", "[", "choice", "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"\"\<Dirac\>\"", ",", "\"\<Majorana\>\""}], "}"}]}], 
          "]"}], ",", 
         RowBox[{"Spacer", "[", "5", "]"}], ",", 
         RowBox[{"Style", "[", 
          RowBox[{
           RowBox[{"Row", "[", 
            RowBox[{
            "{", "\"\<Enter the mixing pattern \
\!\(\*SubscriptBox[SuperscriptBox[\(U\), \(2\)], \
\(e\)]\):\!\(\*SubscriptBox[SuperscriptBox[\(U\), \(2\)], \
\(\[Mu]\)]\):\!\(\*SubscriptBox[SuperscriptBox[\(U\), \(2\)], \(\[Tau]\)]\) = \
\!\(\*SuperscriptBox[\(U\), \(2\)]\)(\!\(\*SubscriptBox[\(x\), \
\(e\)]\):\!\(\*SubscriptBox[\(x\), \(\[Mu]\)]\):\!\(\*SubscriptBox[\(x\), \(\
\[Tau]\)]\)) (where \!\(\*SubscriptBox[\(\[CapitalSigma]\), \
\(i\)]\)\!\(\*SubscriptBox[\(x\), \(i\)]\) = 1) in the form \
{xe,x\[Mu],x\[Tau]}:\>\"", "}"}], "]"}], ",", "Bold"}], "]"}], ",", 
         RowBox[{"InputField", "[", 
          RowBox[{
           RowBox[{"Dynamic", "[", "pattern", "]"}], ",", "Expression"}], 
          "]"}], ",", 
         RowBox[{"Button", "[", 
          RowBox[{"\"\<Proceed\>\"", ",", 
           RowBox[{"DialogReturn", "[", 
            RowBox[{"{", 
             RowBox[{"choice", ",", "pattern"}], "}"}], "]"}], ",", 
           RowBox[{"ImageSize", "->", "Automatic"}]}], "]"}]}], "}"}], 
       "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Get", " ", "the", " ", "merged", " ", "input"}], "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"HNLtype", ",", 
     RowBox[{"{", 
      RowBox[{
      "MixingPatterne", ",", "MixingPattern\[Mu]", ",", 
       "MixingPattern\[Tau]"}], "}"}]}], "}"}], "=", 
   RowBox[{"mergedDialog", "//", "N"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<HNL type: \>\"", ",", "HNLtype"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MixingPattern", "=", 
   RowBox[{
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
       "MixingPatterne", "+", "MixingPattern\[Mu]", "+", 
        "MixingPattern\[Tau]"}], ")"}], 
      RowBox[{"-", "1"}]], 
     RowBox[{"{", 
      RowBox[{
      "MixingPatterne", ",", "MixingPattern\[Mu]", ",", 
       "MixingPattern\[Tau]"}], "}"}]}], "//", "N"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"\"\<Mixing pattern: \>\"", ",", "MixingPattern"}], "]"}]}], "Input",
 CellChangeTimes->{{3.9061842350144906`*^9, 3.9061843007091036`*^9}, {
  3.9137193413022804`*^9, 3.9137194064525204`*^9}, {3.9138054590010815`*^9, 
  3.913805481904211*^9}, {3.913810627218392*^9, 3.913810627234051*^9}, {
  3.9156427855662622`*^9, 3.9156427856002464`*^9}, {3.9476865822198963`*^9, 
  3.9476865824691353`*^9}, {3.9522411549621487`*^9, 3.952241155494604*^9}, {
  3.952241376986412*^9, 3.9522414100600967`*^9}, {3.9522459499053574`*^9, 
  3.952245950712137*^9}},
 CellTags->{"Acceptance", "Number-of-events+sensitivity"},
 CellLabel->"In[45]:=",ExpressionUUID->"43688868-e9bd-4ecd-99df-1169d9e58d62"]
}, Closed]],

Cell[CellGroupData[{

Cell["Experiments", "Chapter",
 CellChangeTimes->{{3.9027285799460387`*^9, 3.9027285850167294`*^9}},
 CellTags->{
  "Acceptance", 
   "Number-of-events+sensitivity"},ExpressionUUID->"bf0d84bb-c61a-4372-9cdb-\
367edc141ad2"],

Cell[BoxData[
 RowBox[{"ExperimentDirectoriesList", "=", 
  RowBox[{"Select", "[", 
   RowBox[{
    RowBox[{"FileNames", "[", 
     RowBox[{"\"\<*\>\"", ",", 
      RowBox[{"directory", "[", "\"\<Acceptances\>\"", "]"}], ",", "1"}], 
     "]"}], ",", "DirectoryQ"}], "]"}]}]], "Input",
 CellChangeTimes->{3.9546999226309547`*^9},
 CellLabel->"In[70]:=",ExpressionUUID->"c6778b23-db29-984b-bffc-bad4bef5efb8"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ExperimentDirectoriesList", "=", 
    RowBox[{"Select", "[", 
     RowBox[{
      RowBox[{"FileNames", "[", 
       RowBox[{"\"\<*\>\"", ",", 
        RowBox[{"directory", "[", "\"\<Acceptances\>\"", "]"}], ",", "1"}], 
       "]"}], ",", "DirectoryQ"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "List", " ", "of", " ", "the", " ", "experiments", " ", "for", " ", 
    "which", " ", "any", " ", "tabulated", " ", "acceptance", " ", "has", " ",
     "been", " ", "produced"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ExperimentsListTemp", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"FileNameTake", "[", 
      RowBox[{
       RowBox[{"ExperimentDirectoriesList", "[", 
        RowBox[{"[", "i", "]"}], "]"}], ",", 
       RowBox[{"-", "1"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "ExperimentDirectoriesList", "]"}], ",", "1"}], 
      "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"IfHNL", "[", "exp_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"expf", "=", 
      RowBox[{"FileNameJoin", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"directory", "[", "\"\<Acceptances\>\"", "]"}], ",", "exp"}],
         "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"tabEx", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Length", "[", 
           RowBox[{"FileNames", "[", 
            RowBox[{"FileNameJoin", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"directory", "[", "\"\<Acceptances\>\"", "]"}], ",", 
               "exp", ",", 
               RowBox[{"ToString", "@", 
                RowBox[{"StringForm", "[", 
                 
                 RowBox[{"\"\<Acceptance_``_for_``*.m\>\"", ",", "exp", ",", 
                  "#"}], "]"}]}]}], "}"}], "]"}], "]"}], "]"}], ">", "0"}], 
         ")"}], "&"}], "/@", "HNLsList"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"!", 
      RowBox[{"MemberQ", "[", 
       RowBox[{"tabEx", ",", "False"}], "]"}]}]}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"ExperimentsList", "=", 
  RowBox[{
   RowBox[{"Select", "[", 
    RowBox[{"ExperimentsListTemp", ",", 
     RowBox[{
      RowBox[{"IfHNL", "[", "#", "]"}], "&"}]}], "]"}], "//", "Sort"}]}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Length", "[", "ExperimentsList", "]"}], "\[Equal]", "0"}], ",", 
   RowBox[{
   "Print", "[", "\"\<No experiment is available, generate first the \
acceptance for the given experiment using module 1\>\"", "]"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", "\"\<Selected experiments:\>\"", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dropdownDialog", "[", 
   RowBox[{"list_", ",", "phrase_"}], "]"}], ":=", 
  RowBox[{"DialogInput", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"choice", "=", "\"\<\>\""}], "}"}], ",", 
    RowBox[{"Column", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"TextCell", "[", "phrase", "]"}], ",", 
       RowBox[{"PopupMenu", "[", 
        RowBox[{
         RowBox[{"Dynamic", "[", "choice", "]"}], ",", "list"}], "]"}], ",", 
       RowBox[{"Button", "[", 
        RowBox[{"\"\<OK\>\"", ",", 
         RowBox[{"DialogReturn", "[", "choice", "]"}]}], "]"}]}], "}"}], 
     "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"selectionDialog", "[", 
   RowBox[{"list_", ",", "phrase_"}], "]"}], ":=", 
  RowBox[{"DialogInput", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"choice", "=", 
      RowBox[{"{", "}"}]}], "}"}], ",", 
    RowBox[{"Column", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Row", "[", 
        RowBox[{
        "{", "\"\<Select the experiments for which the number of events will \
be computed:\>\"", "}"}], "]"}], ",", 
       RowBox[{"Pane", "[", 
        RowBox[{
         RowBox[{"TogglerBar", "[", 
          RowBox[{
           RowBox[{"Dynamic", "[", "choice", "]"}], ",", "list", ",", 
           RowBox[{"Appearance", "->", 
            RowBox[{"\"\<Vertical\>\"", "->", 
             RowBox[{"{", 
              RowBox[{"Automatic", ",", "5"}], "}"}]}]}]}], "]"}], ",", 
         RowBox[{"ImageSize", "->", 
          RowBox[{"{", 
           RowBox[{"Automatic", ",", "Automatic"}], "}"}]}], ",", 
         RowBox[{"Scrollbars", "->", 
          RowBox[{"{", 
           RowBox[{"False", ",", "True"}], "}"}]}]}], "]"}], ",", 
       RowBox[{"Button", "[", 
        RowBox[{"\"\<OK\>\"", ",", 
         RowBox[{"DialogReturn", "[", "choice", "]"}]}], "]"}]}], "}"}], 
     "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"SelectedExperimentListTemp2", "=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Length", "[", "ExperimentsList", "]"}], "\[NotEqual]", "0"}], ",", 
    RowBox[{"selectionDialog", "[", 
     RowBox[{"ExperimentsList", ",", "\"\<Select the experiments:\>\""}], 
     "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"IfAllPheno", "=", "True"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SelectedExperimentList", "=", 
   RowBox[{"{", 
    RowBox[{"{", "}"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"availablePhenoDescriptions", "[", "exp_", "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", "\t", 
     RowBox[{"descrFile", "=", 
      RowBox[{"Import", "[", 
       RowBox[{
        RowBox[{"FileNameJoin", "[", 
         RowBox[{"FileNameJoin", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"directory", "[", "\"\<Acceptances\>\"", "]"}], ",", 
            "exp", ",", 
            RowBox[{"\"\<AvailableDescriptions-\>\"", "<>", 
             RowBox[{"HNLsList", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "<>", "\"\<.mx\>\""}]}], "}"}], 
          "]"}], "]"}], ",", "\"\<MX\>\""}], "]"}]}]}], "\[IndentingNewLine]",
     "\t", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{"IfAllPheno", ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"descriptions", "=", 
          RowBox[{"availablePhenoDescriptions", "[", "exp", "]"}]}], "}"}], ",",
         "\[IndentingNewLine]", 
        RowBox[{"SelectedExperimentList", "=", 
         RowBox[{"Join", "[", 
          RowBox[{"SelectedExperimentList", ",", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"exp", ",", 
               RowBox[{
                RowBox[{"descriptions", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", 
               RowBox[{
                RowBox[{"descriptions", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", 
               RowBox[{"Length", "[", "descriptions", "]"}], ",", "1"}], 
              "}"}]}], "]"}]}], "]"}]}]}], "\[IndentingNewLine]", "]"}], 
      "\[IndentingNewLine]", ",", 
      RowBox[{"{", 
       RowBox[{"exp", ",", "SelectedExperimentListTemp2"}], "}"}]}], "]"}], ";",
     "\[IndentingNewLine]", 
    RowBox[{"SelectedExperimentList", "=", 
     RowBox[{"Drop", "[", 
      RowBox[{"SelectedExperimentList", ",", "1"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SelectedExperimentList", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"{", "exp", "}"}], ",", 
         RowBox[{
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"availablePhenoDescriptions", "[", "exp", "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"#", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "==", "\"\<Default\>\""}], 
             "&"}]}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"exp", ",", "SelectedExperimentListTemp2"}], "}"}]}], "]"}]}],
     ";"}]}], "\[IndentingNewLine]", 
  "]"}], "\[IndentingNewLine]", "SelectedExperimentList", "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"icounter", "=", "1"}], ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.8851403254718485`*^9, 3.8851403429411273`*^9}, {
   3.8854395484478483`*^9, 3.885439559226637*^9}, {3.8854397351242537`*^9, 
   3.885439739219259*^9}, {3.8858794196350574`*^9, 3.885879423032172*^9}, {
   3.8865840272667904`*^9, 3.8865840338661537`*^9}, {3.886607744879512*^9, 
   3.886607745774307*^9}, {3.8872732396769423`*^9, 3.887273255436386*^9}, {
   3.887276631938718*^9, 3.887276634618329*^9}, {3.887276937792802*^9, 
   3.8872769418915215`*^9}, {3.887278937383339*^9, 3.887278940392472*^9}, {
   3.887616450031478*^9, 3.887616452738494*^9}, {3.8876165118788147`*^9, 
   3.887616536357917*^9}, {3.887616583272811*^9, 3.887616613175548*^9}, {
   3.887620318755148*^9, 3.8876203205821953`*^9}, {3.8876324144338245`*^9, 
   3.887632416400697*^9}, {3.887772846060255*^9, 3.8877729560180535`*^9}, {
   3.888377893669921*^9, 3.8883779148425026`*^9}, {3.888380182047347*^9, 
   3.888380266214329*^9}, {3.8888188937293386`*^9, 3.8888189661788025`*^9}, {
   3.888819109452669*^9, 3.888819109639008*^9}, {3.8888191954565873`*^9, 
   3.888819255480569*^9}, {3.888819492067113*^9, 3.8888196279493523`*^9}, {
   3.889769218774189*^9, 3.889769266526089*^9}, {3.8904482370890455`*^9, 
   3.8904482605909295`*^9}, {3.89208996357168*^9, 3.8920899725400596`*^9}, {
   3.8921110030369463`*^9, 3.8921110290305853`*^9}, 3.8921110632787223`*^9, {
   3.892111711813961*^9, 3.892111719191961*^9}, {3.8921117518579416`*^9, 
   3.892111754967971*^9}, {3.8921117999712076`*^9, 3.892111800286845*^9}, {
   3.8921125181524467`*^9, 3.892112518627368*^9}, {3.8926994021374636`*^9, 
   3.89269940915271*^9}, {3.892699456280077*^9, 3.892699497276529*^9}, {
   3.8926995560368094`*^9, 3.89269969587647*^9}, {3.8932345800980372`*^9, 
   3.89323458382977*^9}, {3.8932562309421606`*^9, 3.893256263737067*^9}, 
   3.9027286111757326`*^9, {3.902728991480379*^9, 3.9027290878754635`*^9}, {
   3.902729584713502*^9, 3.902729585732702*^9}, {3.9028220170727324`*^9, 
   3.9028220286172953`*^9}, {3.904898265894932*^9, 3.9048982689551115`*^9}, 
   3.913720102858071*^9, {3.913800725020114*^9, 3.9138007316417155`*^9}, {
   3.913800789659895*^9, 3.913800791118989*^9}, {3.9138041974448605`*^9, 
   3.9138041987276573`*^9}, 3.913804357632984*^9, 3.9138044195106525`*^9, {
   3.9477003501197357`*^9, 3.947700368448308*^9}, {3.9477004351962557`*^9, 
   3.947700436598196*^9}, {3.9477004997378683`*^9, 3.9477005000725403`*^9}, {
   3.9477006796399803`*^9, 3.947700698362924*^9}},
 CellTags->{"Acceptance", "Number-of-events+sensitivity"},
 CellLabel->"In[51]:=",ExpressionUUID->"393e1e21-5cde-41a9-ad41-077747a91d52"],

Cell[BoxData[
 RowBox[{"Length", "[", "ExperimentsList", "]"}]], "Input",
 CellLabel->"In[68]:=",ExpressionUUID->"fe0c1ee1-e318-8a4d-a859-60807ce8369c"]
}, Closed]],

Cell[CellGroupData[{

Cell["Running block for next sections", "Chapter",
 CellChangeTimes->{{3.902729140157612*^9, 3.90272914444062*^9}},
 CellTags->{
  "Acceptance", 
   "Number-of-events+sensitivity"},ExpressionUUID->"e0515968-6d3b-4786-9380-\
8f6efe4a3b24"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"BlockEvaluation", "[", "tag_", "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"nb", "=", 
      RowBox[{"EvaluationNotebook", "[", "]"}]}], ";", "\n", 
     RowBox[{"NotebookFind", "[", 
      RowBox[{"nb", ",", "tag", ",", "All", ",", "CellTags"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"SelectionEvaluate", "[", "nb", "]"}]}]}], "\[IndentingNewLine]",
    "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"tagselected", "==", "\"\<Number-of-events+sensitivity\>\""}], ",",
    "\[IndentingNewLine]", 
   RowBox[{"Do", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{
      "BlockEvaluation", 
       "[", "\"\<Number-of-events-computation+sensitivity\>\"", "]"}], ";"}], 
     "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{"icounter", ",", "1", ",", 
       RowBox[{"Length", "[", "SelectedExperimentList", "]"}], ",", "1"}], 
      "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"tagselected", "==", "\"\<Acceptance\>\""}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
        "BlockEvaluation", "[", "\"\<Acceptance-computation\>\"", "]"}], 
        ";"}], "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"icounter", ",", "1", ",", 
         RowBox[{"Length", "[", "SelectedExperimentList", "]"}], ",", "1"}], 
        "}"}]}], "]"}]}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]", "]"}]}], "Input",
 CellChangeTimes->{{3.9027291581950865`*^9, 3.902729215695462*^9}, {
   3.902761777481885*^9, 3.902761802513644*^9}, {3.9028220263736563`*^9, 
   3.9028220265994596`*^9}, 3.9038926310354977`*^9, 3.9146681364189577`*^9},
 CellTags->{"Acceptance", "Number-of-events+sensitivity"},
 CellLabel->"In[66]:=",ExpressionUUID->"977ebf96-c528-46df-9e58-09288035e8b1"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Number of events", "Title",
 CellChangeTimes->{{3.8850206136728783`*^9, 3.885020619208237*^9}},
 CellTags->
  "Number-of-events-computation+sensitivity",ExpressionUUID->"7ba28ec5-2133-\
49aa-b270-328c555fa667"],

Cell[CellGroupData[{

Cell["Iterating to particular experiment", "Chapter",
 CellChangeTimes->{{3.9165042001551485`*^9, 3.9165042041207294`*^9}, {
  3.9165090857383037`*^9, 3.916509094318386*^9}, {3.9506836416500072`*^9, 
  3.950683645636698*^9}},
 CellTags->{
  "Acceptance-computation", 
   "Number-of-events-computation+sensitivity"},ExpressionUUID->"82430277-593c-\
4ac4-aed6-770f0ac48a74"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"{", 
   RowBox[{
   "SelectedExperiment", ",", "SelectedDescr", ",", 
    "ExplanationSelectedDescr"}], "}"}], "=", 
  RowBox[{"SelectedExperimentList", "[", 
   RowBox[{"[", 
    RowBox[{"icounter", "++"}], "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"Row", "[", 
   RowBox[{"{", 
    RowBox[{"\"\<Experiment \>\"", ",", 
     RowBox[{"icounter", "-", "1"}], ",", "\"\</\>\"", ",", 
     RowBox[{"Length", "[", "SelectedExperimentList", "]"}]}], "}"}], "]"}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.9166742536832967`*^9, 3.9166742572566166`*^9}, {
  3.947686450488884*^9, 3.9476864577738457`*^9}},
 CellTags->{
  "Acceptance-computation", "Number-of-events-computation+sensitivity"},
 CellLabel->"In[68]:=",ExpressionUUID->"6b6a0173-5291-439f-8dd3-9925152a05d9"]
}, Closed]],

Cell[CellGroupData[{

Cell["Cross-sections, acceptances", "Chapter",
 CellChangeTimes->{{3.885020695565913*^9, 3.885020698644303*^9}, {
   3.8866052332485933`*^9, 3.8866052373066683`*^9}, 3.887617904598539*^9, 
   3.8929716629809437`*^9, {3.894637289635679*^9, 3.8946372934959445`*^9}},
 CellTags->{
  "Acceptance-computation", 
   "Number-of-events-computation+sensitivity"},ExpressionUUID->"7bea3ddf-2062-\
4996-86eb-43158cd187b5"],

Cell[CellGroupData[{

Cell["Importing data for separate mixings", "Section",
 CellChangeTimes->{{3.89200413151959*^9, 3.8920041352516775`*^9}, {
  3.9166750983993287`*^9, 3.9166751131015043`*^9}},
 CellTags->{
  "Acceptance-computation", 
   "Number-of-events-computation+sensitivity"},ExpressionUUID->"33c6f4da-aa46-\
4293-b09c-5bf1476c4879"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Do", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"ExperimentData", "[", 
       RowBox[{"HNLsList", "[", 
        RowBox[{"[", "i", "]"}], "]"}], "]"}], "=", 
      RowBox[{"Import", "[", 
       RowBox[{
        RowBox[{"FileNameJoin", "[", 
         RowBox[{"{", 
          RowBox[{"FileNameJoin", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"directory", "[", "\"\<Acceptances\>\"", "]"}], ",", 
             "SelectedExperiment", ",", 
             RowBox[{
             "\"\<Acceptance_\>\"", "<>", "SelectedExperiment", "<>", 
              "\"\<_for_\>\"", "<>", 
              RowBox[{"HNLsList", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "<>", 
              "\"\<_decayDescription_\>\"", "<>", "SelectedDescr", "<>", 
              "\"\<.m\>\""}]}], "}"}], "]"}], "}"}], "]"}], ",", 
        "\"\<MX\>\""}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"AcceptanceData", "[", 
       RowBox[{"HNLsList", "[", 
        RowBox[{"[", "i", "]"}], "]"}], "]"}], "=", 
      RowBox[{
       RowBox[{
        RowBox[{"ExperimentData", "[", 
         RowBox[{"HNLsList", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "]"}], "[", 
        RowBox[{"[", "3", "]"}], "]"}], "//", "Developer`ToPackedArray"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"AcceptanceData", "[", 
       RowBox[{"HNLsList", "[", 
        RowBox[{"[", "i", "]"}], "]"}], "]"}], "=", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{"#", "[", 
           RowBox[{"[", "2", "]"}], "]"}], ",", 
          RowBox[{"#", "[", 
           RowBox[{"[", "3", "]"}], "]"}], ",", 
          RowBox[{"#", "[", 
           RowBox[{"[", "4", "]"}], "]"}], ",", 
          RowBox[{"#", "[", 
           RowBox[{"[", "5", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "6", "]"}], "]"}], "+", 
           SuperscriptBox["10", 
            RowBox[{"-", "90."}]]}]}], "}"}], "&"}], "/@", 
       RowBox[{"AcceptanceData", "[", 
        RowBox[{"HNLsList", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"BrVisMixing", "[", 
       RowBox[{"mLLP_", ",", 
        RowBox[{"HNLsList", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}], "]"}], "=", 
      RowBox[{
       RowBox[{"ExperimentData", "[", 
        RowBox[{"HNLsList", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "]"}], "[", 
       RowBox[{"[", "5", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"DecayWidth", "[", 
       RowBox[{"mLLP_", ",", "U2_", ",", 
        RowBox[{"HNLsList", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}], "]"}], "=", 
      SuperscriptBox[
       RowBox[{"(", 
        FractionBox[
         RowBox[{
          RowBox[{"ExperimentData", "[", 
           RowBox[{"HNLsList", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"-", "1"}], "]"}], "]"}], "chbar"], ")"}], 
       RowBox[{"-", "1"}]]}], ";", "\[IndentingNewLine]", 
     RowBox[{"decayDescr", "=", "SelectedDescr"}], ";"}], 
    "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", 
      RowBox[{"Length", "[", "HNLsList", "]"}], ",", "1"}], "}"}]}], "]"}], "//",
   "AbsoluteTiming"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[CapitalGamma]LLP", "[", 
    RowBox[{"mLLP_", ",", "U2_"}], "]"}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"HNLtype", "\[Equal]", "\"\<Dirac\>\""}], ",", 
       RowBox[{"1", "/", "2"}], ",", "1"}], "]"}], 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"DecayWidth", "[", 
          RowBox[{"mLLP", ",", "U2", ",", "#"}], "]"}], "&"}], "/@", 
        "HNLsList"}], ")"}], ".", "MixingPattern"}]}], "//", "Chop"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"c\[Tau]LLP", "[", 
    RowBox[{"mLLP_", ",", "U2_"}], "]"}], "=", 
   FractionBox["chbar", 
    RowBox[{"\[CapitalGamma]LLP", "[", 
     RowBox[{"mLLP", ",", "U2"}], "]"}]]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ldecayLLP", "[", 
     RowBox[{"mLLP_", ",", "U2_", ",", "EN_"}], "]"}], "=", 
    RowBox[{
     FractionBox[
      SqrtBox[
       RowBox[{
        SuperscriptBox["EN", "2"], "-", 
        SuperscriptBox["mLLP", "2"]}]], "mLLP"], "*", 
     RowBox[{"c\[Tau]LLP", "[", 
      RowBox[{"mLLP", ",", "U2"}], "]"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"AzimuthalAcceptanceInt", "[", 
      RowBox[{"\[Theta]LLP_", ",", "zLLP_"}], "]"}], ",", "\[Theta]minExpAll",
      ",", "\[Theta]maxExpAll", ",", "\[Theta]minExp", ",", "\[Theta]maxExp", 
     ",", "zminExp", ",", "zmaxExp", ",", 
     RowBox[{"zmin\[Theta]", "[", "\[Theta]LLP_", "]"}], ",", 
     RowBox[{"zmax\[Theta]", "[", "\[Theta]LLP_", "]"}]}], "}"}], "=", 
   RowBox[{"Block\[Epsilon]Azimuthal", "[", 
    RowBox[{"AcceptanceData", "[", 
     RowBox[{"HNLsList", "[", 
      RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"brtemp", "[", "mLLP_", "]"}], "=", 
    RowBox[{"BrVisMixing", "[", 
     RowBox[{"mLLP", ",", 
      RowBox[{"HNLsList", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Branching", " ", "ratio", " ", "of", " ", "visible", " ", "HNL", " ", 
    "decays", " ", "averaged", " ", "over", " ", "mixings"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BrVis", "[", "mLLP_", "]"}], "=", 
   RowBox[{
    FractionBox[
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"BrVisMixing", "[", 
         RowBox[{"mLLP", ",", 
          RowBox[{"HNLsList", "[", 
           RowBox[{"[", "#", "]"}], "]"}]}], "]"}], "&"}], "/@", 
       RowBox[{"{", 
        RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], ".", "MixingPattern"}], 
     RowBox[{"MixingPattern", "//", "Total"}]], "//", "Chop"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mlistBr", "=", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{"m", ",", 
       RowBox[{"{", 
        RowBox[{"m", ",", "0.02", ",", "5.1", ",", "0.001"}], "}"}]}], "]"}], 
     ",", 
     RowBox[{"Table", "[", 
      RowBox[{"m", ",", 
       RowBox[{"{", 
        RowBox[{"m", ",", "5.12", ",", "30", ",", "0.01"}], "}"}]}], "]"}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"LogPlot", "[", 
  RowBox[{
   RowBox[{"Evaluate", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"BrVisMixing", "[", 
       RowBox[{"mLLP", ",", 
        RowBox[{"HNLsList", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", 
      RowBox[{"BrVisMixing", "[", 
       RowBox[{"mLLP", ",", 
        RowBox[{"HNLsList", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], "]"}], ",", 
      RowBox[{"BrVisMixing", "[", 
       RowBox[{"mLLP", ",", 
        RowBox[{"HNLsList", "[", 
         RowBox[{"[", "3", "]"}], "]"}]}], "]"}], ",", 
      RowBox[{"BrVis", "[", "mLLP", "]"}]}], "}"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"mLLP", ",", 
     RowBox[{"Min", "[", "mlistBr", "]"}], ",", "7"}], "}"}], ",", 
   RowBox[{"FrameStyle", "\[Rule]", 
    RowBox[{"Directive", "[", 
     RowBox[{"Black", ",", " ", "22"}], "]"}]}], ",", 
   RowBox[{"PlotStyle", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Thickness", "[", "0.003", "]"}], ",", "Blue"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Thickness", "[", "0.003", "]"}], ",", 
        RowBox[{"Darker", "@", "Red"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Thickness", "[", "0.003", "]"}], ",", 
        RowBox[{"Darker", "@", 
         RowBox[{"Darker", "@", "Green"}]}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Thickness", "[", "0.003", "]"}], ",", "Black"}], "}"}]}], 
     "}"}]}], ",", 
   RowBox[{"GridLines", "\[Rule]", "Automatic"}], ",", 
   RowBox[{"PlotRange", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0.02", ",", "7"}], "}"}], ",", "All"}], "}"}]}], ",", 
   RowBox[{"Frame", "\[Rule]", "True"}], ",", 
   RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
   RowBox[{"FrameLabel", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
     "\"\<\!\(\*SubscriptBox[\(m\), \(N\)]\) [GeV]\>\"", ",", 
      "\"\<\!\(\*SubscriptBox[\(Br\), \(vis\)]\)\>\""}], "}"}]}], ",", 
   RowBox[{"PlotLabel", "\[Rule]", " ", 
    RowBox[{"Style", "[", 
     RowBox[{
      RowBox[{"Row", "[", 
       RowBox[{"{", 
        RowBox[{
        "\"\<For \>\"", ",", "SelectedExperiment", ",", 
         "\"\<. \!\(\*SuperscriptBox[SubscriptBox[\(U\), \(e\)], \
\(2\)]\):\!\(\*SuperscriptBox[SubscriptBox[\(U\), \(\[Mu]\)], \
\(2\)]\):\!\(\*SuperscriptBox[SubscriptBox[\(U\), \(\[Tau]\)], \(2\)]\) = \
\>\"", ",", "MixingPattern"}], "}"}], "]"}], ",", " ", "16", ",", " ", 
      "Black"}], "]"}]}], ",", 
   RowBox[{"PlotLegends", "\[Rule]", 
    RowBox[{"Placed", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Style", "[", 
         RowBox[{"#", ",", " ", "18"}], "]"}], "&"}], "/@", 
       RowBox[{"{", 
        RowBox[{
        "\"\<Pure e mixing\>\"", ",", "\"\<Pure \[Mu] mixing\>\"", ",", 
         "\"\<Pure \[Tau] mixing\>\"", ",", 
         "\"\<Averaged for the given pattern\>\""}], "}"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"0.55", ",", "0.2"}], "}"}]}], "]"}]}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "xxx", ",", "yyy", ",", "zzz", ",", "InGridm\[Epsilon]", ",", 
     "InGrid\[Theta]\[Epsilon]", ",", "InGridE\[Epsilon]", ",", 
     "InGridz\[Epsilon]", ",", "\[Epsilon]vals", ",", "\[Epsilon]azvals", ",",
      "mmin\[Epsilon]", ",", "mmax\[Epsilon]"}], "}"}], "=", 
   RowBox[{"Block\[Epsilon]Decay", "[", 
    RowBox[{
     RowBox[{"AcceptanceData", "[", 
      RowBox[{"HNLsList", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", "zminExp", ",", "brtemp"}],
     "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FacilityGivenExperiment", "=", 
   RowBox[{
    RowBox[{"ExperimentData", "[", 
     RowBox[{"HNLsList", "[", 
      RowBox[{"[", "1", "]"}], "]"}], "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CrossSectionData", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"ExperimentData", "[", 
      RowBox[{"HNLsList", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "]"}], "[", 
     RowBox[{"[", "4", "]"}], "]"}], "//", "Transpose"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"NpotGivenExperiment", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"Select", "[", 
       RowBox[{"CrossSectionData", ",", 
        RowBox[{
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", "\"\<Npot\>\""}], 
         "&"}]}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}], "[", 
     RowBox[{"[", "2", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"infoDialog", "[", 
    RowBox[{"Row", "[", 
     RowBox[{"{", 
      RowBox[{
      "\"\<The number of proton collisions is \>\"", ",", " ", 
       "NpotGivenExperiment", ",", 
       "\"\<. You may change it at the stage of computing the sensitivities\>\
\""}], "}"}], "]"}], "]"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"Row", "[", 
  RowBox[{"{", 
   RowBox[{
   "\"\<Search for \>\"", ",", "HNLtype", ",", 
    "\"\< HNLs with the mixing pattern {\!\(\*SuperscriptBox[SubscriptBox[\(U\
\), \(e\)], \(2\)]\),\!\(\*SuperscriptBox[SubscriptBox[\(U\), \(\[Mu]\)], \(2\
\)]\),\!\(\*SuperscriptBox[SubscriptBox[\(U\), \(\[Tau]\)], \(2\)]\)} = \
\!\(\*SuperscriptBox[\(U\), \(2\)]\)\>\"", ",", "MixingPattern", ",", 
    "\"\< at \>\"", ",", " ", "SelectedExperiment", ",", " ", 
    "\"\< located at \>\"", ",", "FacilityGivenExperiment", ",", 
    "\"\<. \!\(\*SubscriptBox[\(N\), \(collisions\)]\) = \>\"", ",", 
    "NpotGivenExperiment", ",", "\"\<. Decay description: \>\"", ",", 
    "ExplanationSelectedDescr"}], "}"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "\"\<Quantity\>\"", ",", 
      "\"\<\!\(\*SubscriptBox[\(\[Theta]\), \(min\)]\), rad\>\"", ",", 
      "\"\<\!\(\*SubscriptBox[\(\[Theta]\), \(max\)]\), rad\>\"", ",", 
      "\"\<\!\(\*SubscriptBox[\(\[Theta]\), \(min\)]\)(\!\(\*SubscriptBox[\(\
\[Epsilon]\), \(dec\)]\)), rad\>\"", ",", 
      "\"\<\!\(\*SubscriptBox[\(\[Theta]\), \(max\)]\)(\!\(\*SubscriptBox[\(\
\[Epsilon]\), \(dec\)]\)), rad\>\"", ",", 
      "\"\<\!\(\*SubscriptBox[\(z\), \(min\)]\), m\>\"", ",", 
      "\"\<\!\(\*SubscriptBox[\(z\), \(max\)]\), m\>\""}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
     "\"\<Description\>\"", ",", "\"\<Min angle covered by experiment\>\"", 
      ",", "\"\<Max angle covered by experiment\>\"", ",", 
      "\"\<Min angle where \!\(\*SubscriptBox[\(\[Epsilon]\), \(decay\)]\)\
\[NotEqual]0\>\"", ",", 
      "\"\<Max angle where \!\(\*SubscriptBox[\(\[Epsilon]\), \(decay\)]\)\
\[NotEqual]0\>\"", ",", "\"\<Min long. displacement of the decay volume\>\"", 
      ",", "\"\<Max long. displacement of the decay volume\>\""}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
     "\"\<Value\>\"", ",", "\[Theta]minExpAll", ",", "\[Theta]maxExpAll", ",",
       "\[Theta]minExp", ",", "\[Theta]maxExp", ",", "zminExp", ",", 
      "zmaxExp"}], "}"}]}], "}"}], "//", "TableForm"}]}], "Input",
 CellChangeTimes->{{3.916674418768098*^9, 3.916674551750697*^9}, {
   3.9166745854775457`*^9, 3.916674700788785*^9}, {3.9166748373684173`*^9, 
   3.916674837711569*^9}, 3.916674870372959*^9, {3.9166749469423018`*^9, 
   3.9166749472269945`*^9}, 3.9423197688725376`*^9, {3.9423241761389427`*^9, 
   3.942324179731077*^9}, {3.9476862260880547`*^9, 3.947686253769165*^9}, {
   3.9476864106162224`*^9, 3.9476864265814857`*^9}, {3.947686499970297*^9, 
   3.9476865204066467`*^9}, {3.947686551251236*^9, 3.9476865595888557`*^9}, {
   3.947686612735033*^9, 3.9476866179564247`*^9}, {3.9477043726454105`*^9, 
   3.947704432051941*^9}, {3.9477300215134106`*^9, 3.947730022696409*^9}, {
   3.947730311376995*^9, 3.9477303211587467`*^9}, {3.950683685301796*^9, 
   3.9506837175108967`*^9}},
 CellTags->{
  "Acceptance-computation", "Number-of-events-computation+sensitivity"},
 CellLabel->"In[70]:=",ExpressionUUID->"055e1389-9973-4458-bf27-703cdb7d2f2f"]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Gluing the data for separate mixings to the given mixing pattern\
\>", "Section",
 CellChangeTimes->{{3.916675174885206*^9, 3.9166751871921873`*^9}},
 CellTags->{
  "Acceptance-computation", 
   "Number-of-events-computation+sensitivity"},ExpressionUUID->"0d5326e5-1661-\
4a0b-b124-0f126fec74e8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Computing", " ", "weights", " ", "for", " ", "decays", " ", "via", " ", 
    "different", " ", 
    RowBox[{"mixing", ".", " ", "The"}], " ", "weights", " ", "are", " ", 
    SubscriptBox["Br", 
     RowBox[{"vis", ",", "x"}]], "*", 
    RowBox[{
     RowBox[{
      SubscriptBox[
       SuperscriptBox["U", "2"], "x"], "/", 
      SuperscriptBox["U", "2"]}], "/", 
     SubscriptBox["\[CapitalSigma]", "x"]}], 
    SubscriptBox["Br", 
     RowBox[{"vis", ",", "x"}]], "*", 
    RowBox[{
     SubscriptBox[
      SuperscriptBox["U", "2"], "x"], "/", 
     SuperscriptBox["U", "2"]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Weight\[Epsilon]DecayMixing", "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        FractionBox["1", 
         RowBox[{"Max", "[", 
          RowBox[{
           RowBox[{"BrVis", "[", "#", "]"}], ",", 
           SuperscriptBox["10", 
            RowBox[{"-", "90."}]]}], "]"}]], 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"BrVisMixing", "[", 
            RowBox[{"#", ",", 
             RowBox[{"HNLsList", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "*", 
           RowBox[{"MixingPattern", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], ",", 
          RowBox[{
           RowBox[{"BrVisMixing", "[", 
            RowBox[{"#", ",", 
             RowBox[{"HNLsList", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "*", 
           RowBox[{"MixingPattern", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], ",", 
          RowBox[{
           RowBox[{"BrVisMixing", "[", 
            RowBox[{"#", ",", 
             RowBox[{"HNLsList", "[", 
              RowBox[{"[", "3", "]"}], "]"}]}], "]"}], "*", 
           RowBox[{"MixingPattern", "[", 
            RowBox[{"[", "3", "]"}], "]"}]}]}], "}"}]}], "&"}], "/@", 
      RowBox[{"(", 
       RowBox[{"10", "^", "InGridm\[Epsilon]"}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"The", " ", "averaged", " ", "decay", " ", 
      RowBox[{"acceptance", ":", " ", 
       RowBox[{
       "the", " ", "weights", " ", "for", " ", "the", " ", "given", " ", 
        "mass", " ", "and", " ", "flavor", " ", "are", " ", "contracted", " ",
         "with", " ", "the", " ", "lists", " ", "of", " ", "the", " ", 
        "decay", " ", "acceptances", " ", "for", " ", "the", " ", "same", " ",
         "mass", " ", "and", " ", "flavor"}]}]}], ",", " ", 
     RowBox[{
     "and", " ", "then", " ", "there", " ", "is", " ", "a", " ", "summation", 
      " ", "over", " ", "flavors"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"FullAcceptanceData0", "=", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"AcceptanceData", "[", 
          RowBox[{"HNLsList", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", 
           RowBox[{"Range", "[", 
            RowBox[{"1", ",", "5"}], "]"}]}], "]"}], "]"}], ",", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"List", "/@", 
             RowBox[{"Flatten", "[", 
              RowBox[{
               RowBox[{"Weight\[Epsilon]DecayMixing", "[", 
                RowBox[{"[", 
                 RowBox[{"All", ",", "#"}], "]"}], "]"}], "*", " ", 
               RowBox[{"Partition", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"AcceptanceData", "[", 
                   RowBox[{"HNLsList", "[", 
                    RowBox[{"[", "#", "]"}], "]"}], "]"}], "[", 
                  RowBox[{"[", 
                   RowBox[{"All", ",", 
                    RowBox[{"-", "1"}]}], "]"}], "]"}], ",", 
                 FractionBox[
                  RowBox[{"Length", "[", 
                   RowBox[{"AcceptanceData", "[", 
                    RowBox[{"HNLsList", "[", 
                    RowBox[{"[", "#", "]"}], "]"}], "]"}], "]"}], 
                  RowBox[{"Length", "[", "InGridm\[Epsilon]", "]"}]]}], 
                "]"}]}], "]"}]}], "&"}], "/@", 
           RowBox[{"{", 
            RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], ")"}], "//", 
         "Total"}], ",", "2"}], "]"}]}], ";"}], "//", "AbsoluteTiming"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"FullAcceptanceData", ",", 
        RowBox[{"DecayAcceptanceInt", "[", 
         RowBox[{"mLLP_", ",", "\[Theta]LLP_", ",", "ELLP_", ",", "zLLP_"}], 
         "]"}], ",", 
        RowBox[{"FullAcceptanceInt", "[", 
         RowBox[{"mLLP_", ",", "\[Theta]LLP_", ",", "ELLP_", ",", "zLLP_"}], 
         "]"}], ",", "InGridm\[Epsilon]", ",", "InGrid\[Theta]\[Epsilon]", 
        ",", "InGridE\[Epsilon]", ",", "InGridz\[Epsilon]", ",", 
        "\[Epsilon]vals", ",", "\[Epsilon]azvals", ",", "mmin\[Epsilon]", ",",
         "mmax\[Epsilon]"}], "}"}], "=", 
      RowBox[{"Block\[Epsilon]Decay", "[", 
       RowBox[{"FullAcceptanceData0", ",", "zminExp", ",", "BrVis"}], "]"}]}],
      ";"}], "//", "AbsoluteTiming"}]}]}]], "Input",
 CellChangeTimes->{{3.9166752155451126`*^9, 3.9166752547243266`*^9}, {
  3.916676684452318*^9, 3.916676687578862*^9}, {3.9423242248291416`*^9, 
  3.942324225938406*^9}, {3.947704629810335*^9, 3.947704636448271*^9}},
 CellTags->{
  "Acceptance-computation", "Number-of-events-computation+sensitivity"},
 CellLabel->"In[85]:=",ExpressionUUID->"96036022-8ea1-4b31-94b4-cfd19deeef28"]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Checking if all distributions have corresponding weights, and vice versa\
\>", "Section",
 CellChangeTimes->{{3.9506325765805607`*^9, 3.9506325768620872`*^9}, {
  3.9506334272032604`*^9, 3.950633428585764*^9}, {3.950633747287016*^9, 
  3.950633760072397*^9}},
 CellTags->{
  "Acceptance-computation", 
   "Number-of-events-computation+sensitivity"},ExpressionUUID->"46fc520f-767c-\
d340-9221-0b972ba2537f"],

Cell[CellGroupData[{

Cell["\<\
List of angle-energy distributions and production weights for the given \
facility\
\>", "Subsection",
 CellChangeTimes->{{3.950633460120825*^9, 3.950633477192444*^9}},
 CellTags->{
  "Acceptance-computation", 
   "Number-of-events-computation+sensitivity"},ExpressionUUID->"683523e8-de9d-\
4a48-af32-73f7d9ee1d73"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"DistrCombinationsSelectedFacility", "=", 
   RowBox[{"Select", "[", 
    RowBox[{"DistrCombinations", ",", 
     RowBox[{
      RowBox[{
       RowBox[{"#", "[", 
        RowBox[{"[", "3", "]"}], "]"}], "==", "FacilityGivenExperiment"}], 
      "&"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DistrCombinationsToCheck", "//", "Clear"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"WeightsCombinationsSelectedFacility", "=", 
   RowBox[{"Select", "[", 
    RowBox[{"WeightsCombinations", ",", 
     RowBox[{
      RowBox[{
       RowBox[{"#", "[", 
        RowBox[{"[", "3", "]"}], "]"}], "==", "FacilityGivenExperiment"}], 
      "&"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"MemberQ", "[", 
      RowBox[{
       RowBox[{"DistrCombinationsSelectedFacility", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "2"}], "]"}], "]"}], ",", 
       "\"\<Bremsstrahlung-FR\>\""}], "]"}], "||", 
     RowBox[{"MemberQ", "[", 
      RowBox[{
       RowBox[{"DistrCombinationsSelectedFacility", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "2"}], "]"}], "]"}], ",", 
       "\"\<Bremsstrahlung-AP\>\""}], "]"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"FacilitiesFR", "=", 
      RowBox[{
       RowBox[{"Select", "[", 
        RowBox[{"DistrCombinationsSelectedFacility", ",", 
         RowBox[{
          RowBox[{"StringContainsQ", "[", 
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "2", "]"}], "]"}], ",", 
            RowBox[{"{", "\"\<FR\>\"", "}"}]}], "]"}], "&"}]}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "3"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"FacilitiesAP", "=", 
      RowBox[{
       RowBox[{"Select", "[", 
        RowBox[{"DistrCombinationsSelectedFacility", ",", 
         RowBox[{
          RowBox[{"StringContainsQ", "[", 
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "2", "]"}], "]"}], ",", 
            RowBox[{"{", "\"\<AP\>\"", "}"}]}], "]"}], "&"}]}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "3"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"DistrCombinationsToCheck", "=", 
      RowBox[{"Select", "[", 
       RowBox[{"DistrCombinationsSelectedFacility", ",", 
        RowBox[{
         RowBox[{"!", 
          RowBox[{"StringContainsQ", "[", 
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "2", "]"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"\"\<FR\>\"", ",", "\"\<AP\>\""}], "}"}]}], "]"}]}], 
         "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"DistrCombinationsToCheck", "=", 
      RowBox[{
       RowBox[{"Join", "[", 
        RowBox[{"DistrCombinationsToCheck", ",", 
         RowBox[{"Flatten", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"LLPdirName", ",", "brem", ",", "fac"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"fac", ",", "FacilitiesFR"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"brem", ",", 
               RowBox[{
                RowBox[{"Select", "[", 
                 RowBox[{"WeightsCombinations", ",", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "==", "fac"}], "&&", 
                    RowBox[{"StringContainsQ", "[", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", "\"\<FR\>\""}], 
                    "]"}]}], "&"}]}], "]"}], "[", 
                RowBox[{"[", 
                 RowBox[{"All", ",", "1"}], "]"}], "]"}]}], "}"}]}], "]"}], 
           ",", "1"}], "]"}], ",", 
         RowBox[{"Flatten", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"LLPdirName", ",", "brem", ",", "fac"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"fac", ",", "FacilitiesAP"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"brem", ",", 
               RowBox[{
                RowBox[{"Select", "[", 
                 RowBox[{"WeightsCombinations", ",", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "==", "fac"}], "&&", 
                    RowBox[{"StringContainsQ", "[", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", "\"\<AP\>\""}], 
                    "]"}]}], "&"}]}], "]"}], "[", 
                RowBox[{"[", 
                 RowBox[{"All", ",", "1"}], "]"}], "]"}]}], "}"}]}], "]"}], 
           ",", "1"}], "]"}]}], "]"}], "//", "Sort"}]}], ";"}], 
    "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
    RowBox[{
    "DistrCombinationsToCheck", "=", "DistrCombinationsSelectedFacility"}]}], 
   "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"drellyankeys", "=", 
   RowBox[{"Select", "[", 
    RowBox[{"WeightsCombinationsSelectedFacility", ",", 
     RowBox[{
      RowBox[{"StringContainsQ", "[", 
       RowBox[{
        RowBox[{"#", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", "\"\<DrellYan\>\""}], "]"}], 
      "&"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DistrCombinationsToCheck", "=", 
   RowBox[{"Select", "[", 
    RowBox[{"DistrCombinationsToCheck", ",", 
     RowBox[{
      RowBox[{"!", 
       RowBox[{"StringContainsQ", "[", 
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "2", "]"}], "]"}], ",", "\"\<DrellYan\>\""}], "]"}]}], 
      "&"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DistrCombinationsToCheck", "=", 
   RowBox[{"Join", "[", 
    RowBox[{"DistrCombinationsToCheck", ",", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"LLPdirName", ",", 
         RowBox[{
          RowBox[{"drellyankeys", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", 
         RowBox[{
          RowBox[{"drellyankeys", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "drellyankeys", "]"}], ",", "1"}], "}"}]}], 
      "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", "DistrCombinationsToCheck", "\
\[IndentingNewLine]", 
 RowBox[{"WeightsCombinationsSelectedFacility", ";"}]}], "Input",
 CellChangeTimes->{{3.950632759830923*^9, 3.950632760199877*^9}, {
  3.950632840248455*^9, 3.950632878926874*^9}, {3.9506329342094135`*^9, 
  3.9506330750435047`*^9}, {3.9506332640043545`*^9, 3.9506332684904785`*^9}, {
  3.95063336592737*^9, 3.950633366140545*^9}, {3.950633423556576*^9, 
  3.950633424039562*^9}, {3.950633489564089*^9, 3.9506334899840126`*^9}, {
  3.9506777639793167`*^9, 3.95067777211491*^9}, {3.9506837900334625`*^9, 
  3.9506838131907425`*^9}, {3.950686005173973*^9, 3.9506860494407215`*^9}, {
  3.952244974191763*^9, 3.95224499777627*^9}, {3.9522460075863*^9, 
  3.9522460179493027`*^9}},
 CellTags->{
  "Acceptance-computation", "Number-of-events-computation+sensitivity"},
 CellLabel->"In[88]:=",ExpressionUUID->"a2c29630-dde0-c34e-8aaa-eff4e3735523"]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Checking if all weights have their corresponding distributions\
\>", "Subsection",
 CellChangeTimes->{{3.950633494221611*^9, 3.9506335163250427`*^9}},
 CellTags->{
  "Acceptance-computation", 
   "Number-of-events-computation+sensitivity"},ExpressionUUID->"eb200bf1-31d9-\
1145-8f0b-9e37e982252d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"IfCondDistrToWeights", "=", 
   RowBox[{"IfCondWeightsToDistr", "=", "True"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"allAvailable", "=", "True"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"missingDistr", "=", 
   RowBox[{"{", 
    RowBox[{"{", "}"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"missingWeights", "=", 
   RowBox[{"{", 
    RowBox[{"{", "}"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"condcontinue", "=", "True"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"distrrow", "=", 
     RowBox[{"DistrCombinationsToCheck", "[", 
      RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"condWeights", "=", 
     RowBox[{
      RowBox[{"Select", "[", 
       RowBox[{"WeightsCombinationsSelectedFacility", ",", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "==", 
           RowBox[{"distrrow", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], "&&", 
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "==", 
           RowBox[{"distrrow", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "&&", 
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "3", "]"}], "]"}], "==", 
           RowBox[{"distrrow", "[", 
            RowBox[{"[", "3", "]"}], "]"}]}]}], "&"}]}], "]"}], "!=", 
      RowBox[{"{", "}"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"condWeights", "==", "False"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"missingWeights", "=", 
        RowBox[{"Join", "[", 
         RowBox[{"missingWeights", ",", 
          RowBox[{"{", "distrrow", "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"allAvailable", "=", "False"}], ";"}]}], "\[IndentingNewLine]",
      "]"}], ";"}], "\[IndentingNewLine]", ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "1", ",", 
     RowBox[{"Length", "[", "DistrCombinationsToCheck", "]"}], ",", "1"}], 
    "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"weightrow", "=", 
     RowBox[{"WeightsCombinationsSelectedFacility", "[", 
      RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"condDistr", "=", 
     RowBox[{
      RowBox[{"Select", "[", 
       RowBox[{"DistrCombinationsToCheck", ",", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "==", 
           RowBox[{"weightrow", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], "&&", 
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "==", 
           RowBox[{"weightrow", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "&&", 
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "3", "]"}], "]"}], "==", 
           RowBox[{"weightrow", "[", 
            RowBox[{"[", "3", "]"}], "]"}]}]}], "&"}]}], "]"}], "!=", 
      RowBox[{"{", "}"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"condDistr", "==", "False"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"missingDistr", "=", 
        RowBox[{"Join", "[", 
         RowBox[{"missingDistr", ",", 
          RowBox[{"{", "weightrow", "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"allAvailable", "=", "False"}], ";"}]}], "\[IndentingNewLine]",
      "]"}], ";"}], "\[IndentingNewLine]", ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "1", ",", 
     RowBox[{"Length", "[", "WeightsCombinationsSelectedFacility", "]"}], ",",
      "1"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"!", "allAvailable"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"missingDistr", "=", 
     RowBox[{"Drop", "[", 
      RowBox[{"missingDistr", ",", "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"missingWeights", "=", " ", 
     RowBox[{"Drop", "[", 
      RowBox[{"missingWeights", ",", "1"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"choiceContinue", "=", 
     RowBox[{"DialogInput", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"choice", "=", "\"\<Stop computation\>\""}], "}"}], ",", 
       RowBox[{"Column", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Style", "[", 
           RowBox[{
            RowBox[{"Row", "[", 
             RowBox[{"{", 
              
              RowBox[{"\"\<You have not provided the production probabilities \
PmotherToLLP to all the generated tabulated distributions! Missing \
distributions: \>\"", ",", " ", "missingDistr", 
               ",", "\"\<. Missing weights: \>\"", ",", " ", 
               "missingWeights"}], "}"}], "]"}], ",", "Bold"}], "]"}], ",", 
          RowBox[{"Spacer", "[", "5", "]"}], ",", 
          RowBox[{"Style", "[", 
           RowBox[{
            RowBox[{"Row", "[", 
             RowBox[{
             "{", "\"\<Stop computation or continue (but keeping only the \
production modes with weights and distributions?\>\"", "}"}], "]"}], ",", 
            "Bold"}], "]"}], ",", 
          RowBox[{"PopupMenu", "[", 
           RowBox[{
            RowBox[{"Dynamic", "[", "choice", "]"}], ",", 
            RowBox[{"{", 
             
             RowBox[{"\"\<Stop computation\>\"", 
              ",", "\"\<Continue anyway\>\""}], "}"}]}], "]"}], ",", 
          RowBox[{"Spacer", "[", "5", "]"}], ",", 
          RowBox[{"Button", "[", 
           RowBox[{"\"\<Proceed\>\"", ",", 
            RowBox[{"DialogReturn", "[", "choice", "]"}], ",", 
            RowBox[{"ImageSize", "->", "Automatic"}]}], "]"}]}], "}"}], 
        "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"choiceContinue", "==", "\"\<Stop computation\>\""}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"condcontinue", "=", "False"}], "\[IndentingNewLine]", ",", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"DistrCombinationsSelectedFacility1", "=", 
         RowBox[{"Select", "[", 
          RowBox[{"DistrCombinationsSelectedFacility", ",", 
           RowBox[{
            RowBox[{"!", 
             RowBox[{"MemberQ", "[", 
              RowBox[{"missingWeights", ",", "#"}], "]"}]}], "&"}]}], "]"}]}],
         ";", "\[IndentingNewLine]", 
        RowBox[{"WeightsCombinationsSelectedFacility1", "=", 
         RowBox[{"Select", "[", 
          RowBox[{"WeightsCombinationsSelectedFacility", ",", 
           RowBox[{
            RowBox[{"!", 
             RowBox[{"MemberQ", "[", 
              RowBox[{"missingDistr", ",", "#"}], "]"}]}], "&"}]}], "]"}]}], 
        ";"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"DistrCombinationsSelectedFacility", "=", 
        RowBox[{"Select", "[", 
         RowBox[{"DistrCombinationsSelectedFacility", ",", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"MemberQ", "[", 
             RowBox[{
              RowBox[{"Join", "[", 
               RowBox[{
                RowBox[{"missingWeights", "[", 
                 RowBox[{"[", 
                  RowBox[{"All", ",", "2"}], "]"}], "]"}], ",", 
                RowBox[{"missingDistr", "[", 
                 RowBox[{"[", 
                  RowBox[{"All", ",", "2"}], "]"}], "]"}]}], "]"}], ",", 
              RowBox[{"#", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "&"}]}], "]"}]}], ";",
        "\[IndentingNewLine]", 
       RowBox[{"WeightsCombinationsSelectedFacility", "=", 
        RowBox[{"Select", "[", 
         RowBox[{"WeightsCombinationsSelectedFacility", ",", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"MemberQ", "[", 
             RowBox[{
              RowBox[{"Join", "[", 
               RowBox[{
                RowBox[{"missingWeights", "[", 
                 RowBox[{"[", 
                  RowBox[{"All", ",", "2"}], "]"}], "]"}], ",", 
                RowBox[{"missingDistr", "[", 
                 RowBox[{"[", 
                  RowBox[{"All", ",", "2"}], "]"}], "]"}]}], "]"}], ",", 
              RowBox[{"#", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "&"}]}], "]"}]}], 
       ";"}]}], "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
  "]"}], "\[IndentingNewLine]", "condcontinue", "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"condcontinue", "&&", 
    RowBox[{"StringContainsQ", "[", 
     RowBox[{"computationchoice", ",", "\"\<Tabulated Nevents\>\""}], "]"}]}],
    ",", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Delete", " ", "previously", " ", "computed", " ", "tabulated", " ", 
     "number", " ", "of", " ", "events"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"directory", "[", "\"\<Nevents\>\"", "]"}], "=", 
     RowBox[{"FileNameJoin", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"NotebookDirectory", "[", "]"}], 
        ",", "\"\<Tabulated Nevents\>\""}], "}"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"directory", "[", "\"\<Nevents-LLP\>\"", "]"}], "=", 
     RowBox[{"FileNameJoin", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"NotebookDirectory", "[", "]"}], 
        ",", "\"\<Tabulated Nevents\>\"", ",", "LLPdirName"}], "}"}], "]"}]}],
     ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"directory", "[", "\"\<Nevents-LLP-experiment\>\"", "]"}], "=", 
     RowBox[{"FileNameJoin", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"NotebookDirectory", "[", "]"}], 
        ",", "\"\<Tabulated Nevents\>\"", ",", "LLPdirName", ",", 
        "SelectedExperiment"}], "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"DirectoryQ", "[", 
       RowBox[{"directory", "[", "\"\<Nevents-LLP-experiment\>\"", "]"}], 
       "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"DeleteFile", "[", 
       RowBox[{"FileNames", "[", 
        RowBox[{
         RowBox[{"\"\<*\>\"", "<>", "SelectedDescr", "<>", "\"\<*\>\""}], ",", 
         RowBox[{"directory", "[", "\"\<Nevents-LLP-experiment\>\"", "]"}]}], 
        "]"}], "]"}]}], "\[IndentingNewLine]", "]"}]}]}], 
  "\[IndentingNewLine]", "]"}]}], "Input",
 CellChangeTimes->{{3.9506331104738274`*^9, 3.950633114577772*^9}, {
   3.95063351901915*^9, 3.9506335426713886`*^9}, {3.9506335729961224`*^9, 
   3.950633733919876*^9}, {3.950634498508953*^9, 3.9506346358571796`*^9}, {
   3.9506346685005493`*^9, 3.9506346804616184`*^9}, {3.9506347360546227`*^9, 
   3.9506347465200996`*^9}, {3.9506347956276207`*^9, 3.950634808025696*^9}, {
   3.950670799326351*^9, 3.9506708156981773`*^9}, {3.9506709225996647`*^9, 
   3.9506709491094894`*^9}, {3.9506860645063744`*^9, 3.9506860749979496`*^9}, 
   3.9508991335595856`*^9, {3.952241614302883*^9, 3.9522416307732944`*^9}, {
   3.952241801053314*^9, 3.952241850567423*^9}, 3.9522420084186745`*^9, {
   3.9522420754799576`*^9, 3.952242076209097*^9}, {3.9522421201701317`*^9, 
   3.9522421830166855`*^9}, {3.952242222422474*^9, 3.952242290601591*^9}, {
   3.9522423429998817`*^9, 3.952242344971493*^9}, {3.952243802786274*^9, 
   3.9522440133453465`*^9}, {3.952244090202299*^9, 3.9522443140290985`*^9}, {
   3.952244357129101*^9, 3.9522445275641804`*^9}, {3.95224463208646*^9, 
   3.952244693587654*^9}, {3.9522447414908714`*^9, 3.9522447455832214`*^9}, {
   3.9522461071902905`*^9, 3.9522461652719*^9}, {3.9522462288218727`*^9, 
   3.952246239845913*^9}, {3.9522462831636105`*^9, 3.952246284324621*^9}},
 CellTags->{
  "Acceptance-computation", "Number-of-events-computation+sensitivity"},
 CellLabel->"In[97]:=",ExpressionUUID->"7c7860b8-5703-0141-8a17-319c3a71af6a"]
}, Closed]]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Angle-energy distributions for the given experiment", "Chapter",
 CellChangeTimes->{{3.885020702966837*^9, 3.885020711525731*^9}, {
   3.8850216924759345`*^9, 3.8850216984444695`*^9}, {3.8851404110391607`*^9, 
   3.8851404117847*^9}, 3.8859669420079484`*^9, {3.8876173662884827`*^9, 
   3.8876173699611483`*^9}, {3.896334866051643*^9, 3.896334870004681*^9}},
 CellTags->{
  "Acceptance-computation", 
   "Number-of-events-computation+sensitivity"},ExpressionUUID->"9cc794fd-a470-\
45d1-9d7b-d197b9cca653"],

Cell[CellGroupData[{

Cell["Yields of mother particles per collision", "Section",
 CellChangeTimes->{{3.950686116046692*^9, 3.9506861238563976`*^9}},
 CellTags->{
  "Acceptance-computation", 
   "Number-of-events-computation+sensitivity"},ExpressionUUID->"630539ee-977c-\
2545-b3de-ba9ba87a98cf"],

Cell[BoxData[
 RowBox[{"If", "[", 
  RowBox[{"condcontinue", ",", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Amounts", " ", 
      RowBox[{"(", 
       RowBox[{"per", " ", "PoT"}], ")"}], " ", "of", " ", "c", " ", "or", 
      " ", 
      OverscriptBox["c", "_"]}], ",", " ", 
     RowBox[{"b", " ", "or", " ", 
      OverscriptBox["b", "_"]}], ",", " ", 
     RowBox[{"and", " ", 
      SuperscriptBox["W", "+"], " ", "or", " ", 
      SuperscriptBox["W", "-"], " ", "at", " ", "the", " ", "given", " ", 
      "experiment", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SubscriptBox["P", 
          RowBox[{"c", " ", "or", " ", 
           OverscriptBox["c", "_"]}]], " ", "=", " ", 
         RowBox[{
          RowBox[{
           SubscriptBox["P", "c"], "+", 
           SubscriptBox["P", 
            OverscriptBox["c", "_"]]}], " ", "=", " ", 
          RowBox[{"2", "*", 
           SubscriptBox["P", 
            RowBox[{"c", 
             OverscriptBox["c", "_"]}]]}]}]}], ",", " ", 
        RowBox[{"etc", "."}]}], ")"}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"ProbMother", "[", "\"\<D\>\"", "]"}], ",", 
       RowBox[{"ProbMother", "[", "\"\<B\>\"", "]"}], ",", 
       RowBox[{"ProbMother", "[", "\"\<W\>\"", "]"}]}], "}"}], "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Select", "[", 
          RowBox[{"CrossSectionData", ",", 
           RowBox[{
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", "\"\<Pc\>\""}], 
            "&"}]}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], "[", 
        RowBox[{"[", "2", "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"Select", "[", 
          RowBox[{"CrossSectionData", ",", 
           RowBox[{
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", "\"\<Pb\>\""}], 
            "&"}]}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], "[", 
        RowBox[{"[", "2", "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"Select", "[", 
          RowBox[{"CrossSectionData", ",", 
           RowBox[{
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", "\"\<PW\>\""}], 
            "&"}]}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"FacilityGivenExperiment", "==", "\"\<SPS\>\""}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ProbMother", "[", "\"\<K\>\"", "]"}], "=", "0.36"}]}], "]"}], 
    ";", "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"FacilityGivenExperiment", "==", "\"\<ESS\>\""}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"ProbMother", "[", "\"\<PiCharged\>\"", "]"}], "=", 
        RowBox[{
         RowBox[{
          RowBox[{"Select", "[", 
           RowBox[{"CrossSectionData", ",", 
            RowBox[{
             RowBox[{
              RowBox[{"#", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", 
              "\"\<PPiCharged\>\""}], "&"}]}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ProbMother", "[", "\"\<mu\>\"", "]"}], "=", 
        RowBox[{
         RowBox[{
          RowBox[{"Select", "[", 
           RowBox[{"CrossSectionData", ",", 
            RowBox[{
             RowBox[{
              RowBox[{"#", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", "\"\<Pmu\>\""}], 
             "&"}]}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], ";"}]}], "\[IndentingNewLine]", 
     "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.9506861544620895`*^9, 3.950686158168272*^9}},
 CellTags->{
  "Acceptance-computation", "Number-of-events-computation+sensitivity"},
 CellLabel->
  "In[107]:=",ExpressionUUID->"1f3e10b7-5bf9-5840-8c8d-e5a73d80479a"]
}, Closed]],

Cell[CellGroupData[{

Cell["Importing for separate mixings", "Section",
 CellChangeTimes->{{3.91667702728163*^9, 3.9166770331496096`*^9}, {
  3.9166770763014307`*^9, 3.9166770774775863`*^9}},
 CellTags->{
  "Acceptance-computation", 
   "Number-of-events-computation+sensitivity"},ExpressionUUID->"155cd82d-e988-\
45a0-86c5-c7c90518cc5b"],

Cell[BoxData[
 RowBox[{"If", "[", 
  RowBox[{"condcontinue", ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
    "ProductionPatternSelected", "=", "DistrCombinationsSelectedFacility"}], 
    ";", "\[IndentingNewLine]", 
    RowBox[{"Print", "[", "\"\<Production list:\>\"", "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"ProductionList", "=", 
     RowBox[{
      RowBox[{"ProductionPatternSelected", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "2"}], "]"}], "]"}], "//", "DeleteDuplicates"}]}],
     ";", "\[IndentingNewLine]", 
    RowBox[{"Print", "[", 
     RowBox[{"Row", "[", 
      RowBox[{"{", "ProductionList", "}"}], "]"}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"MixingPattern", "==", 
       RowBox[{"{", 
        RowBox[{"0.", ",", "0.", ",", "1."}], "}"}]}], ",", 
      RowBox[{"ProductionList", "=", 
       RowBox[{"Select", "[", 
        RowBox[{"ProductionList", ",", 
         RowBox[{
          RowBox[{"#", "!=", "\"\<K\>\""}], "&"}]}], "]"}]}], ",", 
      "ProductionList"}], "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"Do", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"hnl", ",", "prod"}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"hnl", ",", "prod"}], "}"}], "=", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"ProductionPatternSelected", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "[", 
             RowBox[{"[", "#", "]"}], "]"}], "&"}], "/@", 
           RowBox[{"{", 
            RowBox[{"1", ",", "2"}], "}"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
          "Importing", " ", "the", " ", "data", " ", "with", " ", 
           "distribution"}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"DistrDataImportTemp", "[", 
           RowBox[{"hnl", ",", "prod"}], "]"}], "=", 
          RowBox[{"Import", "[", 
           RowBox[{
            RowBox[{"FileNameJoin", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"directory", "[", "\"\<Distribution\>\"", "]"}], ",", 
               RowBox[{
               "\"\<DoubleDistr_\>\"", "<>", "hnl", "<>", "\"\<_\>\"", "<>", 
                "prod", "<>", "\"\<_\>\"", "<>", "FacilityGivenExperiment", 
                "<>", "\"\<.m\>\""}]}], "}"}], "]"}], ",", "\"\<MX\>\""}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"ProbLLP", "[", 
           RowBox[{"mLLP_", ",", "U2_", ",", "hnl", ",", "prod"}], "]"}], "=", 
          RowBox[{
           RowBox[{"ProbMother", "[", "prod", "]"}], "*", 
           RowBox[{"PmotherToLLPtemp", "[", 
            RowBox[{
            "mLLP", ",", "U2", ",", "hnl", ",", "prod", ",", 
             "FacilityGivenExperiment"}], "]"}]}]}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", 
        RowBox[{"Length", "[", "ProductionPatternSelected", "]"}], ",", "1"}],
        "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"prodsno\[Tau]", "=", 
     RowBox[{"{", 
      RowBox[{"\"\<PiCharged\>\"", ",", "\"\<mu\>\""}], "}"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"Do", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"MemberQ", "[", 
         RowBox[{"prodsno\[Tau]", ",", "prod"}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"DistrDataImportTemp", "[", 
           RowBox[{
            RowBox[{"HNLsList", "[", 
             RowBox[{"[", "3", "]"}], "]"}], ",", "prod"}], "]"}], "=", 
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"#", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", 
              RowBox[{"#", "[", 
               RowBox[{"[", "2", "]"}], "]"}], ",", 
              RowBox[{"#", "[", 
               RowBox[{"[", "3", "]"}], "]"}], ",", "0."}], "}"}], "&"}], "/@", 
           RowBox[{"DistrDataImportTemp", "[", 
            RowBox[{
             RowBox[{"HNLsList", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", "prod"}], "]"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"ProbLLP", "[", 
           RowBox[{"mLLP_", ",", "U2_", ",", 
            RowBox[{"HNLsList", "[", 
             RowBox[{"[", "3", "]"}], "]"}], ",", "prod"}], "]"}], "=", 
          "0."}], ";"}]}], "\[IndentingNewLine]", "]"}], 
      "\[IndentingNewLine]", ",", 
      RowBox[{"{", 
       RowBox[{"prod", ",", "ProductionList"}], "}"}]}], "]"}]}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.9166774578674703`*^9, 3.9166774636154413`*^9}, {
   3.9191378800463767`*^9, 3.919137919420907*^9}, {3.942324038542919*^9, 
   3.9423240406815987`*^9}, 3.950683506120737*^9, {3.9506860935211525`*^9, 
   3.950686093946148*^9}, {3.9506861611701927`*^9, 3.950686194730383*^9}, 
   3.9522460672709694`*^9, {3.9522462744125004`*^9, 3.9522462777483234`*^9}, {
   3.9522464325888023`*^9, 3.952246432857439*^9}},
 CellTags->{
  "Acceptance-computation", "Number-of-events-computation+sensitivity"},
 CellLabel->
  "In[108]:=",ExpressionUUID->"1cbbcfc7-f3cf-4dd1-af94-6c36314e0c25"]
}, Closed]],

Cell[CellGroupData[{

Cell["Gluing", "Section",
 CellChangeTimes->{{3.91667702728163*^9, 3.9166770385384245`*^9}},
 CellTags->{
  "Acceptance-computation", 
   "Number-of-events-computation+sensitivity"},ExpressionUUID->"ccd146d2-e9c0-\
4ca4-8cac-bedbd820600b"],

Cell[BoxData[
 RowBox[{"If", "[", 
  RowBox[{"condcontinue", ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"ProbLLP", "[", 
        RowBox[{"mLLP_", ",", "U2_", ",", "prod"}], "]"}], "=", 
       RowBox[{
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"ProbLLP", "[", 
            RowBox[{"mLLP", ",", "U2", ",", 
             RowBox[{"HNLsList", "[", 
              RowBox[{"[", "i", "]"}], "]"}], ",", "prod"}], "]"}], "*", 
           RowBox[{"MixingPattern", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "3", ",", "1"}], "}"}]}], "]"}], "//", 
        "Chop"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"prod", ",", "ProductionList"}], "}"}]}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
     "Code", " ", "supplementing", " ", "the", " ", "data", " ", "for", " ", 
      "the", " ", "distribution", " ", "up", " ", "to", " ", "the", " ", 
      "given", " ", "mass", " ", "with", " ", "zeros"}], "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"DataSupplementedBlock", "[", 
      RowBox[{"data_", ",", "mmax_"}], "]"}], ":=", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"mdatamax", "=", 
         RowBox[{"Max", "[", 
          RowBox[{"data", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"data\[Theta]Egrid", "=", 
         RowBox[{
          RowBox[{"SortBy", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"DeleteDuplicatesBy", "[", 
              RowBox[{"data", ",", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"#", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], ",", 
                  RowBox[{"#", "[", 
                   RowBox[{"[", "3", "]"}], "]"}]}], "}"}], "&"}]}], "]"}], 
             "[", 
             RowBox[{"[", 
              RowBox[{"All", ",", 
               RowBox[{"{", 
                RowBox[{"2", ",", "3"}], "}"}]}], "]"}], "]"}], ",", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"#", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", 
               RowBox[{"#", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "}"}], "&"}]}], "]"}], "//",
           "N"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Join", "[", 
         RowBox[{"data", ",", 
          RowBox[{"Flatten", "[", 
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"mLLP", ",", 
                RowBox[{
                 RowBox[{"data\[Theta]Egrid", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "[", 
                 RowBox[{"[", "1", "]"}], "]"}], ",", 
                RowBox[{
                 RowBox[{"data\[Theta]Egrid", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "[", 
                 RowBox[{"[", "2", "]"}], "]"}], ",", "0"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"mLLP", ",", 
                RowBox[{"1.001", "mdatamax"}], ",", "mmax", ",", 
                FractionBox[
                 RowBox[{"(", 
                  RowBox[{"mmax", "-", 
                   RowBox[{"1.001", "mdatamax"}]}], ")"}], "3"]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "1", ",", 
                RowBox[{"Length", "[", "data\[Theta]Egrid", "]"}], ",", "1"}],
                "}"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", "2"}], "}"}]}], "]"}]}], "]"}]}]}], 
      "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"DataLogarithmiedComp1", "=", 
     RowBox[{"Compile", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"data", ",", "_Real", ",", "2"}], "}"}], "}"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"data", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "[", 
             RowBox[{"[", "4", "]"}], "]"}], "\[Equal]", "0"}], ",", 
           RowBox[{"-", "90."}], ",", 
           RowBox[{"Log10", "[", 
            RowBox[{
             RowBox[{"data", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "[", 
             RowBox[{"[", "4", "]"}], "]"}], "]"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "data", "]"}], ",", "1"}], "}"}]}], "]"}], 
       ",", 
       RowBox[{"CompilationTarget", "\[Rule]", "\"\<MVM\>\""}], ",", 
       RowBox[{"RuntimeOptions", "\[Rule]", "\"\<Speed\>\""}]}], "]"}]}], ";",
     "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
     "The", " ", "block", " ", "that", " ", "glues", " ", "the", " ", 
      "distributions", " ", "according", " ", "to", " ", "the", " ", "mixing",
       " ", "pattern"}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"BlockDistrGluing", "[", "ProdChannel_", "]"}], ":=", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Angle", "-", 
         RowBox[{
         "energy", " ", "distribution", " ", "data", " ", "corresponding", 
          " ", "to", " ", "the", " ", "given", " ", "production", " ", 
          "channel"}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"DataList", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"DistrDataImportTemp", "[", 
            RowBox[{"#", ",", "ProdChannel"}], "]"}], "&"}], "/@", 
          "HNLsList"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "List", " ", "of", " ", "the", " ", "production", " ", 
          "probabilities", " ", "per", " ", "mixing", " ", "for", " ", "the", 
          " ", "given", " ", "production", " ", 
          RowBox[{"channel", ":", " ", 
           RowBox[{
            SubscriptBox["P", "prod"], 
            RowBox[{"(", 
             RowBox[{"m", ",", 
              FractionBox[
               SuperscriptBox[
                SubscriptBox["U", "i"], "2"], 
               SuperscriptBox["U", "2"]]}], ")"}]}]}]}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"\[Chi]list", "[", "mLLP_", "]"}], "=", 
         RowBox[{
          RowBox[{
           RowBox[{"ProbLLP", "[", 
            RowBox[{"mLLP", ",", 
             RowBox[{"MixingPattern", "[", 
              RowBox[{"[", "#", "]"}], "]"}], ",", 
             RowBox[{"HNLsList", "[", 
              RowBox[{"[", "#", "]"}], "]"}], ",", "ProdChannel"}], "]"}], 
           "&"}], "/@", 
          RowBox[{"{", 
           RowBox[{"1", ",", "2", ",", "3"}], "}"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"\[Chi]weights", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"\[Chi]list", "[", "#", "]"}], "&"}], "/@", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"DataList", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"All", ",", "1"}], "]"}], "]"}], "//", 
            "DeleteDuplicates"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"\[Chi]weights", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             FractionBox[
              RowBox[{"#", "[", 
               RowBox[{"[", "1", "]"}], "]"}], 
              RowBox[{"Max", "[", 
               RowBox[{
                SuperscriptBox["10", 
                 RowBox[{"-", "90."}]], ",", 
                RowBox[{
                 RowBox[{"#", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "+", 
                 RowBox[{"#", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "+", 
                 RowBox[{"#", "[", 
                  RowBox[{"[", "3", "]"}], "]"}]}]}], "]"}]], ",", 
             FractionBox[
              RowBox[{"#", "[", 
               RowBox[{"[", "2", "]"}], "]"}], 
              RowBox[{"Max", "[", 
               RowBox[{
                SuperscriptBox["10", 
                 RowBox[{"-", "90."}]], ",", 
                RowBox[{
                 RowBox[{"#", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "+", 
                 RowBox[{"#", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "+", 
                 RowBox[{"#", "[", 
                  RowBox[{"[", "3", "]"}], "]"}]}]}], "]"}]], ",", 
             FractionBox[
              RowBox[{"#", "[", 
               RowBox[{"[", "3", "]"}], "]"}], 
              RowBox[{"Max", "[", 
               RowBox[{
                SuperscriptBox["10", 
                 RowBox[{"-", "90."}]], ",", 
                RowBox[{
                 RowBox[{"#", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "+", 
                 RowBox[{"#", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "+", 
                 RowBox[{"#", "[", 
                  RowBox[{"[", "3", "]"}], "]"}]}]}], "]"}]]}], "}"}], "&"}], 
          "/@", "\[Chi]weights"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"DataListFin", "=", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"DataList", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", 
              RowBox[{"{", 
               RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], "]"}], "]"}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"List", "/@", 
                RowBox[{"Flatten", "[", 
                 RowBox[{
                  RowBox[{"\[Chi]weights", "[", 
                   RowBox[{"[", 
                    RowBox[{"All", ",", "#"}], "]"}], "]"}], " ", 
                  RowBox[{"Partition", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"DataList", "[", 
                    RowBox[{"[", "#", "]"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", 
                    RowBox[{"-", "1"}]}], "]"}], "]"}], ",", 
                    FractionBox[
                    RowBox[{"Length", "[", 
                    RowBox[{"DataList", "[", 
                    RowBox[{"[", "#", "]"}], "]"}], "]"}], 
                    RowBox[{"Length", "[", "\[Chi]weights", "]"}]]}], "]"}]}],
                  "]"}]}], "&"}], "/@", 
              RowBox[{"{", 
               RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], ")"}], "//", 
            "Total"}], ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            RowBox[{"#", "[", 
             RowBox[{"[", "2", "]"}], "]"}], ",", 
            RowBox[{"#", "[", 
             RowBox[{"[", "3", "]"}], "]"}], ",", 
            RowBox[{"Max", "[", 
             RowBox[{
              RowBox[{"#", "[", 
               RowBox[{"[", "4", "]"}], "]"}], ",", 
              SuperscriptBox["10", 
               RowBox[{"-", "90."}]]}], "]"}]}], "}"}], "&"}], "/@", 
         "DataListFin"}]}]}], "\[IndentingNewLine]", "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"Interpolating", " ", "block"}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{"Do", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"DistrDataImport", "[", "prod", "]"}], "=", 
        RowBox[{"BlockDistrGluing", "[", "prod", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"DoubleDistrLLPint", "[", 
         RowBox[{"mLLP_", ",", "\[Theta]LLP_", ",", "ELLP_", ",", "prod"}], 
         "]"}], "=", 
        RowBox[{"10", "^", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Interpolation", "[", 
            RowBox[{
             RowBox[{"distrlogComp", "[", 
              RowBox[{"DistrDataImport", "[", "prod", "]"}], "]"}], ",", 
             RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[", 
           RowBox[{
            RowBox[{"Log10", "[", "mLLP", "]"}], ",", 
            RowBox[{"Log10", "[", "\[Theta]LLP", "]"}], ",", 
            RowBox[{"Log10", "[", "ELLP", "]"}]}], "]"}], ")"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"maxvalGluing", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"DistrDataImport", "[", "prod", "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", 
            RowBox[{"-", "1"}]}], "]"}], "]"}], "//", "Max"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"maxMassGluing", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"DistrDataImport", "[", "prod", "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"#", "[", 
               RowBox[{"[", 
                RowBox[{"-", "1"}], "]"}], "]"}], ">", 
              RowBox[{
               SuperscriptBox["10", 
                RowBox[{"-", "20."}]], "maxvalGluing"}]}], "&"}]}], "]"}], 
          "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "1"}], "]"}], "]"}], "//", "Max"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"MassListDistr", "[", "prod", "]"}], "=", 
        RowBox[{"DeleteDuplicates", "[", 
         RowBox[{
          RowBox[{"DistrDataImport", "[", "prod", "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"mLLPmin", "[", "prod", "]"}], ",", 
          RowBox[{"mLLPmax", "[", "prod", "]"}]}], "}"}], "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Min", "[", 
           RowBox[{"MassListDistr", "[", "prod", "]"}], "]"}], ",", 
          RowBox[{"Min", "[", 
           RowBox[{"maxMassGluing", ",", 
            RowBox[{"Max", "[", 
             RowBox[{"MassListDistr", "[", "prod", "]"}], "]"}]}], "]"}]}], 
         "}"}]}], ";"}], "\[IndentingNewLine]", ",", 
      RowBox[{"{", 
       RowBox[{"prod", ",", "ProductionList"}], "}"}]}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"directory", "[", "\"\<Auxiliary-experiment\>\"", "]"}], "=", 
     RowBox[{"FileNameJoin", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"directory", "[", "\"\<Auxiliary\>\"", "]"}], ",", 
        "SelectedExperiment"}], "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"!", 
       RowBox[{"DirectoryQ", "[", 
        RowBox[{"directory", "[", "\"\<Auxiliary-experiment\>\"", "]"}], 
        "]"}]}], ",", 
      RowBox[{"CreateDirectory", "[", 
       RowBox[{"directory", "[", "\"\<Auxiliary-experiment\>\"", "]"}], 
       "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{"FileNameJoin", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"directory", "[", "\"\<Auxiliary-experiment\>\"", "]"}], ",", 
         RowBox[{"ToString", "@", 
          RowBox[{"StringForm", "[", 
           RowBox[{
           "\"\<Double-Distr-Averaged-HNL_mixing-pattern_``-``-``.m\>\"", ",", 
            RowBox[{"Sequence", "@@", "MixingPattern"}]}], "]"}]}]}], "}"}], 
       "]"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"mLLPmin", "[", "prod", "]"}], "<", "mLLP", "<", 
             RowBox[{"mLLPmax", "[", "prod", "]"}]}], ",", 
            RowBox[{"Evaluate", "[", 
             RowBox[{"ProbLLP", "[", 
              RowBox[{"mLLP", ",", "1", ",", "prod"}], "]"}], "]"}], ",", 
            "0"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"prod", ",", "ProductionList"}], "}"}]}], "]"}], ",", 
        RowBox[{
         FractionBox["1", 
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"mLLPmin", "[", "prod", "]"}], "<", "mLLP", "<", 
               RowBox[{"mLLPmax", "[", "prod", "]"}]}], ",", 
              RowBox[{"Evaluate", "[", 
               RowBox[{"ProbLLP", "[", 
                RowBox[{"mLLP", ",", "1", ",", "prod"}], "]"}], "]"}], ",", 
              "0"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"prod", ",", "ProductionList"}], "}"}]}], "]"}]], 
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"mLLPmin", "[", "prod", "]"}], "<", "mLLP", "<", 
              RowBox[{"mLLPmax", "[", "prod", "]"}]}], ",", 
             RowBox[{"Evaluate", "[", 
              RowBox[{
               RowBox[{"ProbLLP", "[", 
                RowBox[{"mLLP", ",", "1", ",", "prod"}], "]"}], "*", 
               RowBox[{"DoubleDistrLLPint", "[", 
                RowBox[{
                "mLLP", ",", "\[Theta]LLP", ",", "ELLP", ",", "prod"}], 
                "]"}]}], "]"}], ",", "0"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"prod", ",", "ProductionList"}], "}"}]}], "]"}]}]}], 
       "}"}], ",", "\"\<MX\>\""}], "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"GridInFinal", "[", "prod", "]"}], ",", 
         RowBox[{"DistrVals", "[", "prod", "]"}]}], "}"}], "=", 
       RowBox[{"BlockGridsValsDistr", "[", 
        RowBox[{"prod", ",", "DistrDataImport"}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"prod", ",", "ProductionList"}], "}"}]}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
     "___", "___", "___", "___", "___", "___", "___", "___", "___", "_"}], 
     "*)"}], "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"Finding", " ", 
      SubscriptBox["E", "max"], 
      RowBox[{"(", 
       RowBox[{
        SubscriptBox["m", "LLP"], ",", 
        SubscriptBox["\[Theta]", "LLP"]}], ")"}], " ", "for", " ", "the", " ",
       "angular", " ", "range", " ", "at", " ", "the", " ", "given", " ", 
      "experiment"}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
     "___", "___", "___", "___", "___", "___", "___", "___", "___", "_"}], 
     "*)"}], "\[IndentingNewLine]", 
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"ELLPmax", "[", 
        RowBox[{"mfip_", ",", "\[Theta]fip_", ",", "prod"}], "]"}], "=", 
       RowBox[{"EmaxBlock", "[", 
        RowBox[{
        "prod", ",", "11", ",", "DistrDataImport", ",", 
         "FacilityGivenExperiment"}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"prod", ",", 
        RowBox[{"Select", "[", 
         RowBox[{"ProductionList", ",", 
          RowBox[{
           RowBox[{"#", "!=", "\"\<Bremsstrahlung\>\""}], "&"}]}], "]"}]}], 
       "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"FacilityGivenExperiment", "==", "\"\<ESS\>\""}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
         SubscriptBox["E", 
          RowBox[{"max", "/", "min"}]], " ", "for", " ", "HNLs", " ", "from", 
         " ", "pions", " ", "at", " ", "rest", " ", 
         RowBox[{"(", 
          RowBox[{"ESS", " ", "option"}], ")"}]}], ":", " ", 
        RowBox[{
         RowBox[{
         "the", " ", "tabulated", " ", "distribution", " ", "is", " ", 
          "non"}], "-", 
         RowBox[{"zero", " ", "for", " ", 
          SubscriptBox["E", "LLP"], " ", "within", " ", 
          SubscriptBox["E", 
           RowBox[{"LLP", ",", 
            RowBox[{"2", "-", "body"}]}]]}], "+", 
         RowBox[{
          RowBox[{"/", 
           RowBox[{
            FractionBox[
             RowBox[{"-", " ", 
              SubscriptBox["\[CapitalDelta]E", "approx"]}], "2"], ".", " ", 
            "Determining"}]}], " ", 
          SubscriptBox["E", 
           RowBox[{"min", "/", "max"}]], " ", "accordingly"}]}]}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\[CapitalDelta]Eapprox", "=", 
        SuperscriptBox["10", 
         RowBox[{"-", "5."}]]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ELLPmax", "[", 
         RowBox[{"mLLP_", ",", "\[Theta]LLP_", ",", "\"\<PiCharged\>\""}], 
         "]"}], "=", 
        RowBox[{"(*", 
         RowBox[{
          FractionBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"mSM", "[", "\"\<PiCharged\>\"", "]"}], "2"], "+", 
            SuperscriptBox["mLLP", "2"]}], 
           RowBox[{"2", 
            RowBox[{"mSM", "[", "\"\<PiCharged\>\"", "]"}]}]], "+", 
          RowBox[{
           FractionBox["1", "2"], 
           RowBox[{"{", 
            RowBox[{"\[CapitalDelta]Eapprox", ",", 
             RowBox[{"-", "\[CapitalDelta]Eapprox"}]}], "}"}]}]}], "*)"}], 
        RowBox[{"mSM", "[", "\"\<PiCharged\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ELLPmax", "[", 
         RowBox[{"mLLP_", ",", "\[Theta]LLP_", ",", "\"\<mu\>\""}], "]"}], 
        "=", 
        FractionBox[
         RowBox[{
          SuperscriptBox[
           RowBox[{"mSM", "[", "\"\<mu\>\"", "]"}], "2"], "+", 
          SuperscriptBox["mLLP", "2"], "-", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"0.5", "*", 
             SuperscriptBox["10", 
              RowBox[{"-", "3"}]]}], ")"}], "2"]}], 
         RowBox[{"2", 
          RowBox[{"mSM", "[", "\"\<mu\>\"", "]"}]}]]}], ";"}]}], 
     "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"ptenergies", "=", 
     RowBox[{"LogLogPlot", "[", 
      RowBox[{
       RowBox[{"Evaluate", "[", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"ELLPmax", "[", 
           RowBox[{"0.1", ",", "\[Theta]LLP", ",", "prod"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"prod", ",", "ProductionList"}], "}"}]}], "]"}], "]"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"\[Theta]LLP", ",", "\[Theta]minExp", ",", "\[Theta]maxExp"}],
         "}"}], ",", 
       RowBox[{"Frame", "->", "True"}], ",", 
       RowBox[{"ImageSize", "->", "Large"}], ",", 
       RowBox[{"PlotLegends", "\[Rule]", 
        RowBox[{"Placed", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Style", "[", 
             RowBox[{"#", ",", "15"}], "]"}], "&"}], "/@", "ProductionList"}],
           ",", "Right"}], "]"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"ptprodprob", "=", 
     RowBox[{"LogLogPlot", "[", 
      RowBox[{
       RowBox[{"Evaluate", "[", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"ProbLLP", "[", 
           RowBox[{"ma", ",", "1", ",", "prod"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"prod", ",", "ProductionList"}], "}"}]}], "]"}], "]"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"ma", ",", "mmin\[Epsilon]", ",", "mmax\[Epsilon]"}], "}"}], 
       ",", 
       RowBox[{"Frame", "->", "True"}], ",", 
       RowBox[{"ImageSize", "->", "Large"}], ",", 
       RowBox[{"PlotLegends", "\[Rule]", 
        RowBox[{"Placed", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Style", "[", 
             RowBox[{"#", ",", "15"}], "]"}], "&"}], "/@", "ProductionList"}],
           ",", "Right"}], "]"}]}], ",", 
       RowBox[{"FrameStyle", "->", 
        RowBox[{"Directive", "[", 
         RowBox[{"Thick", ",", "Black", ",", "18"}], "]"}]}], ",", 
       RowBox[{"FrameLabel", "->", 
        RowBox[{"{", 
         RowBox[{
         "\"\<\!\(\*SubscriptBox[\(m\), \(LLP\)]\) [GeV]\>\"", ",", 
          "\"\<\!\(\*SubscriptBox[\(P\), \(LLP, \
prod\)]\)/\!\(\*SuperscriptBox[\(U\), \(2\)]\)\>\""}], "}"}]}]}], "]"}]}], 
    ";", "\[IndentingNewLine]", 
    RowBox[{"Style", "[", 
     RowBox[{
      RowBox[{"Row", "[", 
       RowBox[{"{", 
        RowBox[{"ptprodprob", ",", "ptenergies"}], "}"}], "]"}], ",", 
      RowBox[{"ImageSizeMultipliers", "->", 
       RowBox[{"{", 
        RowBox[{"1", ",", " ", "1"}], "}"}]}]}], "]"}]}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.9166771210238476`*^9, 3.916677141721369*^9}, {
   3.916677236873887*^9, 3.916677248735402*^9}, {3.916677310314082*^9, 
   3.916677310654641*^9}, {3.916677397275815*^9, 3.916677397521955*^9}, {
   3.9166774607435346`*^9, 3.916677461279188*^9}, {3.9166775227274175`*^9, 
   3.9166775228975163`*^9}, 3.9168567612993455`*^9, {3.919137947819412*^9, 
   3.9191379480776787`*^9}, {3.9191392533489866`*^9, 3.919139328163204*^9}, {
   3.9423343027350407`*^9, 3.942334334038601*^9}, {3.9506861995343018`*^9, 
   3.950686238833519*^9}},
 CellTags->{
  "Acceptance-computation", "Number-of-events-computation+sensitivity"},
 CellLabel->
  "In[109]:=",ExpressionUUID->"c47ad2f1-f26f-4f12-a585-d6d7a0f1fe8b"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Number of events", "Chapter",
 CellChangeTimes->{{3.8935731783578434`*^9, 3.893573180246764*^9}},
 CellTags->
  "Number-of-events-computation+sensitivity",ExpressionUUID->"5fbb4af8-dafa-\
4fc1-a941-3c9daaf61f32"],

Cell[CellGroupData[{

Cell["Number of events", "Section",
 CellChangeTimes->{{3.897198873663946*^9, 3.8971988750678434`*^9}, 
   3.9165065585390453`*^9, 3.9165070655729046`*^9, {3.942317588465328*^9, 
   3.9423175900388393`*^9}},
 CellTags->{
  "Acceptance-computation", 
   "Number-of-events-computation+sensitivity"},ExpressionUUID->"ff52be39-6054-\
4073-ad88-4e65dd856975"],

Cell[CellGroupData[{

Cell["Initializing all routines", "Subsection",
 CellChangeTimes->{{3.897199076623907*^9, 3.8971990900052223`*^9}, {
   3.8972009084104066`*^9, 3.897200920680235*^9}, 3.916506561920749*^9, {
   3.9165071319109154`*^9, 3.916507136145134*^9}},
 CellTags->{
  "Acceptance-computation", 
   "Number-of-events-computation+sensitivity"},ExpressionUUID->"edc7fdf4-6199-\
4d22-a75d-3a4b2cfa255e"],

Cell[BoxData[
 RowBox[{"If", "[", 
  RowBox[{"condcontinue", ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"OutGrid\[Theta]final", "[", "prod", "]"}], ",", 
         RowBox[{"\[CapitalDelta]\[Theta]vals", "[", "prod", "]"}]}], "}"}], 
       "=", 
       RowBox[{"OutGrid\[Theta]Temp", "[", 
        RowBox[{
        "InGrid\[Theta]\[Epsilon]", ",", "30", ",", "prod", ",", 
         "\[Theta]maxBrem"}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"prod", ",", "ProductionList"}], "}"}]}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"OutGridzfinal", ",", "\[CapitalDelta]zvals"}], "}"}], "=", 
     RowBox[{"OutGridszTemp", "[", 
      RowBox[{"InGridz\[Epsilon]", ",", "30", ",", "zminExp"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"Final", " ", "energy", " ", 
       RowBox[{"grid", ".", " ", "Mass"}]}], "-", " ", 
      RowBox[{"and", " ", "production", " ", "channel"}], "-", "dependent"}], 
     "*)"}], "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"FacilityGivenExperiment", "!=", "\"\<ESS\>\""}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"StepEtemp", "[", "Efip_", "]"}], "=", 
        RowBox[{"Piecewise", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0.3", ",", 
             RowBox[{"Efip", "\[LessEqual]", "2.5"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0.5", ",", 
             RowBox[{"2.5", "<", "Efip", "<", "35"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"2", ",", 
             RowBox[{"35", "\[LessEqual]", "Efip", "\[LessEqual]", "50"}]}], 
            "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"4", ",", 
             RowBox[{"50", "<", "Efip", "<", "160"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"5", ",", 
             RowBox[{"160", "\[LessEqual]", "Efip", "<=", "400"}]}], "}"}], 
           ",", 
           RowBox[{"{", 
            RowBox[{"25", ",", 
             RowBox[{"400", "<", "Efip", "<", "600"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"50", ",", 
             RowBox[{"600", "<=", "Efip", "<", "2000"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"200", ",", 
             RowBox[{"2000", "\[LessEqual]", "Efip", "<", "4000"}]}], "}"}], 
           ",", 
           RowBox[{"{", 
            RowBox[{"400", ",", 
             RowBox[{"4000", "\[LessEqual]", "Efip", "<", "7000"}]}], "}"}], 
           ",", 
           RowBox[{"{", 
            RowBox[{"500", ",", 
             RowBox[{
             "7000", "\[LessEqual]", "Efip", "\[LessEqual]", "50000"}]}], 
            "}"}]}], "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"OutGridEnergy", "[", 
         RowBox[{"m_", ",", "ProdChannel_"}], "]"}], ":=", 
        RowBox[{"Block", "[", 
         RowBox[{
          RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"emin", "=", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"ProdChannel", "!=", "\"\<Bremsstrahlung\>\""}], ",", 
              RowBox[{"N", "[", "m", "]"}], ",", 
              RowBox[{"ELLPmin", "[", "\"\<Bremsstrahlung\>\"", "]"}]}], 
             "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"egridtemp", "=", 
            RowBox[{
             RowBox[{"With", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"start", "=", "emin"}], ",", 
                 RowBox[{"end", "=", 
                  RowBox[{"ELLPmax", "[", 
                   RowBox[{"m", ",", "\[Theta]minExp", ",", "ProdChannel"}], 
                   "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Log10", "[", 
                RowBox[{"NestWhileList", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"#", "+", 
                    RowBox[{"StepEtemp", "[", "#", "]"}]}], "&"}], ",", 
                  "start", ",", 
                  RowBox[{
                   RowBox[{"#", "\[LessEqual]", "end"}], "&"}], ",", "1", ",",
                   "\[Infinity]", ",", 
                  RowBox[{"-", "1"}]}], "]"}], "]"}]}], "]"}], "//", "N"}]}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Length", "[", "egridtemp", "]"}], "==", "1"}], ",", 
             RowBox[{"egridtemp", "=", 
              RowBox[{"Join", "[", 
               RowBox[{"egridtemp", ",", 
                RowBox[{"{", 
                 RowBox[{"Log10", "[", 
                  RowBox[{"2", "*", "emin"}], "]"}], "}"}]}], "]"}]}]}], 
            "]"}], ";", "\[IndentingNewLine]", "egridtemp"}]}], 
         "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"StepEtemp", "[", "Efip_", "]"}], "=", "0.001"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"OutGridEnergy", "[", 
         RowBox[{"m_", ",", "ProdChannel_"}], "]"}], ":=", 
        RowBox[{"Block", "[", 
         RowBox[{
          RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"tabt", "=", 
            RowBox[{"Table", "[", 
             RowBox[{"e", ",", 
              RowBox[{"{", 
               RowBox[{"e", ",", 
                RowBox[{"1.0001", "m"}], ",", 
                RowBox[{"ELLPmax", "[", 
                 RowBox[{"m", ",", "\[Theta]minExp", ",", "ProdChannel"}], 
                 "]"}], ",", "0.001"}], "}"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"\[CapitalDelta]Eapprox", "=", 
            SuperscriptBox["10", 
             RowBox[{"-", "5."}]]}], ";", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Length", "[", "tabt", "]"}], "==", "1"}], ",", 
             RowBox[{"tabt", "=", 
              RowBox[{
               RowBox[{
                RowBox[{"Join", "[", 
                 RowBox[{"tabt", ",", 
                  RowBox[{"{", 
                   RowBox[{"ELLPmax", "[", 
                    RowBox[{"m", ",", "\[Theta]minExp", ",", "ProdChannel"}], 
                    "]"}], "}"}]}], "]"}], "//", "Sort"}], "//", 
               "DeleteDuplicates"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Log10", "[", "tabt", "]"}], "//", "N"}]}]}], 
         "\[IndentingNewLine]", "]"}]}]}]}], "\[IndentingNewLine]", "]"}], 
    ";", "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"FacilityGivenExperiment", "==", "\"\<ESS\>\""}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"OutGridEnergy", "[", 
         RowBox[{"m_", ",", "\"\<PiCharged\>\""}], "]"}], ":=", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"GridInFinal", "[", "\"\<PiCharged\>\"", "]"}], "[", 
           RowBox[{"[", "3", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"#", ">=", 
            RowBox[{"Log10", "[", "m", "]"}]}], "&"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"OutGridEnergy", "[", 
         RowBox[{"m_", ",", "\"\<mu\>\""}], "]"}], ":=", 
        RowBox[{"Log10", "[", 
         RowBox[{"Select", "[", 
          RowBox[{
           RowBox[{"10", "^", 
            RowBox[{
             RowBox[{"GridInFinal", "[", "\"\<mu\>\"", "]"}], "[", 
             RowBox[{"[", "3", "]"}], "]"}]}], ",", 
           RowBox[{
            RowBox[{"m", "<", "#", "<=", 
             RowBox[{"ELLPmax", "[", 
              RowBox[{"m", ",", "\[Theta]LLP", ",", "\"\<mu\>\""}], "]"}]}], 
            "&"}]}], "]"}], "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], 
    ";", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{
      "Block", " ", "that", " ", "computes", " ", "the", " ", "grid", " ", 
       SubscriptBox["\[Theta]", "S"]}], ",", 
      SubscriptBox["E", "S"], ",", 
      SubscriptBox["z", "S"], ",", " ", 
      RowBox[{
       SubscriptBox["\[Epsilon]", "Full"], "\[Times]", 
       SubscriptBox["f", 
        RowBox[{
         SubscriptBox["\[Theta]", "S"], ",", 
         SubscriptBox["E", "S"]}]]}]}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"TableIntegrandDiscret", "[", 
      RowBox[{"m_", ",", "ProdChannel_", ",", "\[Epsilon]DecOp_"}], "]"}], ":=", 
     RowBox[{"TableIntegrandDiscretTemp", "[", 
      RowBox[{
      "m", ",", "ProdChannel", ",", "\[Epsilon]DecOp", ",", "\[Epsilon]vals", 
       ",", "\[Epsilon]azvals", ",", 
       RowBox[{"OutGrid\[Theta]final", "[", "ProdChannel", "]"}], ",", 
       "OutGridzfinal", ",", "OutGridEnergy", ",", "InGridm\[Epsilon]", ",", 
       "InGrid\[Theta]\[Epsilon]", ",", "InGridE\[Epsilon]", ",", 
       "InGridz\[Epsilon]", ",", 
       RowBox[{"\[CapitalDelta]\[Theta]vals", "[", "ProdChannel", "]"}], ",", 
       "\[CapitalDelta]zvals", ",", "zminExp", ",", "GridInFinal", ",", 
       "DistrVals", ",", "FacilityGivenExperiment", ",", "ELLPmax", ",", 
       "\[Theta]minExp"}], "]"}]}]}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{
  3.914065400601883*^9, {3.9144955915086913`*^9, 3.914495605102999*^9}, {
   3.9144963994464297`*^9, 3.91449645003281*^9}, 3.9156429961809263`*^9, 
   3.9162514062581673`*^9, {3.916332203281742*^9, 3.9163322040420866`*^9}, {
   3.916332256159724*^9, 3.916332315776701*^9}, {3.916332682855117*^9, 
   3.9163326972784367`*^9}, {3.916332729581109*^9, 3.9163327827424307`*^9}, {
   3.916332995032469*^9, 3.9163330418518543`*^9}, {3.9163330893535175`*^9, 
   3.9163331201157775`*^9}, {3.9163883031455355`*^9, 
   3.9163883099402237`*^9}, {3.91639027241718*^9, 3.9163902725145645`*^9}, {
   3.916390440036625*^9, 3.9163904429286966`*^9}, {3.9163913725242844`*^9, 
   3.9163913900649643`*^9}, {3.9165060112532883`*^9, 
   3.9165060531405983`*^9}, {3.916506386454261*^9, 3.9165063916867723`*^9}, {
   3.9165064378147545`*^9, 3.9165064402046285`*^9}, {3.9165066063487997`*^9, 
   3.9165066068133373`*^9}, {3.916506770781*^9, 3.916506770986845*^9}, {
   3.916506818360832*^9, 3.9165068344941483`*^9}, {3.91650702210918*^9, 
   3.916507055596775*^9}, 3.9165070945532026`*^9, {3.9165072348013864`*^9, 
   3.916507258828418*^9}, {3.9165082243803825`*^9, 3.9165082246202836`*^9}, {
   3.9165089341902933`*^9, 3.9165089344447165`*^9}, {3.916671056709384*^9, 
   3.9166710572925243`*^9}, {3.916671102174552*^9, 3.9166711025636616`*^9}, {
   3.9166775958845687`*^9, 3.9166775962780275`*^9}, {3.9166776304955206`*^9, 
   3.9166776309358716`*^9}, {3.9166778602777443`*^9, 3.916677861727749*^9}, {
   3.9166782807009416`*^9, 3.916678286852*^9}, 3.916855232330017*^9, 
   3.916855380215355*^9, {3.9168554793643737`*^9, 3.916855481347945*^9}, 
   3.9181396168091927`*^9, {3.918144237226635*^9, 3.9181442384478235`*^9}, 
   3.9347394148505845`*^9, {3.950686273461899*^9, 3.9506862873901405`*^9}},
 CellTags->{
  "Acceptance-computation", "Number-of-events-computation+sensitivity"},
 CellLabel->
  "In[110]:=",ExpressionUUID->"f3d49c05-f284-45a4-a5fe-88a6b8986fc2"]
}, Closed]],

Cell[CellGroupData[{

Cell["Generalized acceptances", "Subsection",
 CellChangeTimes->{{3.9165071505021195`*^9, 3.9165071536920986`*^9}},
 CellTags->{
  "Acceptance-computation", 
   "Number-of-events-computation+sensitivity"},ExpressionUUID->"5cb1c0c2-01a6-\
436d-a5b6-f5173f552a98"],

Cell[CellGroupData[{

Cell["Definitions", "Subsubsection",
 CellChangeTimes->{{3.9506863032208233`*^9, 3.9506863045279675`*^9}},
 CellTags->{
  "Acceptance-computation", 
   "Number-of-events-computation+sensitivity"},ExpressionUUID->"433b1654-a2a2-\
4e45-852e-e246ff7a7422"],

Cell[BoxData[
 RowBox[{"If", "[", 
  RowBox[{"condcontinue", ",", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Tabulated", " ", "acceptance"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"FactorANUBISceiling", "=", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"SelectedExperiment", "==", "\"\<ANUBIS-ceiling\>\""}], ",", 
       "2", ",", "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"AcceptanceDiscret", "[", 
      RowBox[{
      "m_", ",", "ProdChannel_", ",", "\[Epsilon]decOp_", ",", "decProb_"}], 
      "]"}], ":=", 
     RowBox[{"AcceptanceDiscretTemp", "[", 
      RowBox[{
      "m", ",", "ProdChannel", ",", "\[Epsilon]decOp", ",", "decProb", ",", 
       "mLLPmin", ",", "mmin\[Epsilon]", ",", "mLLPmax", ",", 
       "mmax\[Epsilon]", ",", "ELLPmax", ",", "\[Theta]minExp", ",", 
       "TableIntegrandDiscret", ",", "BrVis", ",", "zmaxExp", ",", "zminExp", 
       ",", "FactorANUBISceiling", ",", "0."}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"Do", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"!", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"FacilityGivenExperiment", "==", "\"\<ESS\>\""}], "&&", 
           RowBox[{"MemberQ", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"\"\<PiCharged\>\"", ",", "\"\<mu\>\""}], "}"}], ",", 
             "prod"}], "]"}]}], ")"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"mLLPlistAcceptance", "[", "prod", "]"}], "=", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{"m", ",", 
             RowBox[{"{", 
              RowBox[{"m", ",", 
               RowBox[{"1.01", 
                RowBox[{"Max", "[", 
                 RowBox[{
                  RowBox[{"mLLPmin", "[", "prod", "]"}], ",", 
                  "mmin\[Epsilon]"}], "]"}]}], ",", 
               RowBox[{"0.95", 
                RowBox[{"Min", "[", 
                 RowBox[{
                  RowBox[{"mLLPmax", "[", "prod", "]"}], ",", 
                  "mmax\[Epsilon]"}], "]"}]}], ",", 
               RowBox[{"Min", "[", 
                RowBox[{
                 FractionBox[
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"0.95", 
                    RowBox[{"Min", "[", 
                    RowBox[{
                    RowBox[{"mLLPmax", "[", "prod", "]"}], ",", 
                    "mmax\[Epsilon]"}], "]"}]}], "-", 
                    RowBox[{"1.01", 
                    RowBox[{"Max", "[", 
                    RowBox[{
                    RowBox[{"mLLPmin", "[", "prod", "]"}], ",", 
                    "mmin\[Epsilon]"}], "]"}]}]}], ")"}], "20"], ",", "2"}], 
                "]"}]}], "}"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"0.99", 
             RowBox[{"Min", "[", 
              RowBox[{
               RowBox[{"mLLPmax", "[", "prod", "]"}], ",", "mmax\[Epsilon]"}],
               "]"}]}], "}"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"mLLPlistAcceptance", "[", "prod", "]"}], "=", 
         RowBox[{"10", "^", 
          RowBox[{
           RowBox[{"GridInFinal", "[", "prod", "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}]}]}]}], "\[IndentingNewLine]", "]"}],
       ",", 
      RowBox[{"{", 
       RowBox[{"prod", ",", "ProductionList"}], "}"}]}], "]"}], ";"}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.9506863120776634`*^9, 3.9506863150927124`*^9}},
 CellTags->{
  "Acceptance-computation", "Number-of-events-computation+sensitivity"},
 CellLabel->
  "In[111]:=",ExpressionUUID->"7d811336-b162-a24b-9f72-c21fe9eec453"]
}, Closed]],

Cell[CellGroupData[{

Cell["Computing acceptances", "Subsubsection",
 CellChangeTimes->{{3.9506863032208233`*^9, 3.950686319315218*^9}},
 CellTags->{
  "Acceptance-computation", 
   "Number-of-events-computation+sensitivity"},ExpressionUUID->"31177619-07cd-\
164c-ac93-fb16b11673e3"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"If", "[", 
   RowBox[{"condcontinue", ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"ResourceFunction", "[", "\"\<MonitorProgress\>\"", "]"}], "@", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"\[Epsilon]GeomTabs", "[", "prod", "]"}], "=", 
          RowBox[{"ParallelTable", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"m", ",", 
              RowBox[{"AcceptanceDiscret", "[", 
               RowBox[{"m", ",", "prod", ",", "\"\<False\>\"", ",", "0"}], 
               "]"}], ",", 
              RowBox[{"AcceptanceDiscret", "[", 
               RowBox[{"m", ",", "prod", ",", "\"\<True\>\"", ",", "0"}], 
               "]"}], ",", 
              RowBox[{"AcceptanceDiscret", "[", 
               RowBox[{"m", ",", "prod", ",", "\"\<False\>\"", ",", "1"}], 
               "]"}], ",", 
              RowBox[{"AcceptanceDiscret", "[", 
               RowBox[{"m", ",", "prod", ",", "\"\<True\>\"", ",", "1"}], 
               "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"m", ",", 
              RowBox[{"mLLPlistAcceptance", "[", "prod", "]"}]}], "}"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"FacilityGivenExperiment", "==", "\"\<ESS\>\""}], "&&", 
              RowBox[{"MemberQ", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"\"\<PiCharged\>\"", ",", "\"\<mu\>\""}], "}"}], ",",
                 "prod"}], "]"}]}], ")"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"\[Epsilon]GeomTabs", "[", "prod", "]"}], "=", 
             RowBox[{"SortBy", "[", 
              RowBox[{
               RowBox[{"DeleteDuplicatesBy", "[", 
                RowBox[{
                 RowBox[{"Join", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"Max", "[", 
                    RowBox[{
                    RowBox[{"mLLPmin", "[", "prod", "]"}], ",", 
                    "mmin\[Epsilon]"}], "]"}], "}"}], ",", 
                    RowBox[{"Drop", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"\[Epsilon]GeomTabs", "[", "prod", "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", "1"}], "]"}]}], 
                    "]"}], "}"}], ",", 
                   RowBox[{"\[Epsilon]GeomTabs", "[", "prod", "]"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"Min", "[", 
                    RowBox[{
                    RowBox[{"mLLPmax", "[", "prod", "]"}], ",", 
                    "mmax\[Epsilon]"}], "]"}], "}"}], ",", 
                    RowBox[{"Drop", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"\[Epsilon]GeomTabs", "[", "prod", "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"-", "1"}], "]"}], "]"}], ",", "1"}], "]"}]}], 
                    "]"}], "}"}]}], "]"}], ",", 
                 RowBox[{
                  RowBox[{"#", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "&"}]}], "]"}], ",", 
               RowBox[{
                RowBox[{"#", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "&"}]}], "]"}]}], ";"}]}], 
          "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"prod", ",", "ProductionList"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"PlotAcc", "[", "ProdChannel_", "]"}], ":=", 
      RowBox[{"ListLogPlot", "[", 
       RowBox[{
        RowBox[{"Evaluate", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"\[Epsilon]GeomTabs", "[", "ProdChannel", "]"}], "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", 
              RowBox[{"{", 
               RowBox[{"1", ",", "2"}], "}"}]}], "]"}], "]"}], ",", 
           RowBox[{
            RowBox[{"\[Epsilon]GeomTabs", "[", "ProdChannel", "]"}], "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", 
              RowBox[{"{", 
               RowBox[{"1", ",", "3"}], "}"}]}], "]"}], "]"}], ",", 
           RowBox[{
            RowBox[{"\[Epsilon]GeomTabs", "[", "ProdChannel", "]"}], "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", 
              RowBox[{"{", 
               RowBox[{"1", ",", "4"}], "}"}]}], "]"}], "]"}], ",", 
           RowBox[{
            RowBox[{"\[Epsilon]GeomTabs", "[", "ProdChannel", "]"}], "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", 
              RowBox[{"{", 
               RowBox[{"1", ",", "5"}], "}"}]}], "]"}], "]"}]}], "}"}], "]"}],
         ",", 
        RowBox[{"FrameStyle", "\[Rule]", 
         RowBox[{"Directive", "[", 
          RowBox[{"Black", ",", " ", "22"}], "]"}]}], ",", 
        RowBox[{"PlotStyle", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Thickness", "[", "0.003", "]"}], ",", "Blue"}], "}"}], 
           ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Thickness", "[", "0.003", "]"}], ",", 
             RowBox[{"Darker", "@", "Red"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Thickness", "[", "0.003", "]"}], ",", 
             RowBox[{"Darker", "@", 
              RowBox[{"Darker", "@", "Green"}]}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Thickness", "[", "0.003", "]"}], ",", "Black"}], 
            "}"}]}], "}"}]}], ",", 
        RowBox[{"GridLines", "\[Rule]", "Automatic"}], ",", 
        RowBox[{"PlotRange", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"MinMax", "[", 
            RowBox[{
             RowBox[{"\[Epsilon]GeomTabs", "[", "ProdChannel", "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Max", "[", 
              RowBox[{
               RowBox[{"0.9", 
                RowBox[{"Min", "[", 
                 RowBox[{
                  RowBox[{"Min", "[", 
                   RowBox[{
                    RowBox[{"\[Epsilon]GeomTabs", "[", "ProdChannel", "]"}], 
                    "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "4"}], "]"}], "]"}], "]"}], ",", 
                  RowBox[{"Min", "[", 
                   RowBox[{
                    RowBox[{"\[Epsilon]GeomTabs", "[", "ProdChannel", "]"}], 
                    "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "3"}], "]"}], "]"}], "]"}]}], "]"}]}],
                ",", 
               SuperscriptBox["10", 
                RowBox[{"-", "5"}]]}], "]"}], ",", 
             RowBox[{"1.1", 
              RowBox[{"Max", "[", 
               RowBox[{
                RowBox[{"Max", "[", 
                 RowBox[{
                  RowBox[{"\[Epsilon]GeomTabs", "[", "ProdChannel", "]"}], 
                  "[", 
                  RowBox[{"[", 
                   RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}], ",", 
                RowBox[{"Max", "[", 
                 RowBox[{
                  RowBox[{"\[Epsilon]GeomTabs", "[", "ProdChannel", "]"}], 
                  "[", 
                  RowBox[{"[", 
                   RowBox[{"All", ",", "4"}], "]"}], "]"}], "]"}]}], 
               "]"}]}]}], "}"}]}], "}"}]}], ",", 
        RowBox[{"Joined", "\[Rule]", "True"}], ",", 
        RowBox[{"Frame", "\[Rule]", "True"}], ",", 
        RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
        RowBox[{"FrameLabel", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"\"\<m [GeV]\>\"", ",", "\"\<Acceptance\>\""}], "}"}]}], 
        ",", 
        RowBox[{"PlotLabel", "\[Rule]", " ", 
         RowBox[{"Style", "[", 
          RowBox[{
           RowBox[{"Row", "[", 
            RowBox[{"{", 
             RowBox[{"\"\<From \>\"", ",", "ProdChannel"}], "}"}], "]"}], ",",
            " ", "20", ",", " ", "Black"}], "]"}]}], ",", 
        RowBox[{"PlotLegends", "\[Rule]", 
         RowBox[{"Placed", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Style", "[", 
              RowBox[{"#", ",", " ", "18"}], "]"}], "&"}], "/@", 
            RowBox[{"{", 
             RowBox[{
             "\"\<<\!\(\*SubscriptBox[\(\[Epsilon]\), \(LLP\)]\)>\>\"", ",", 
              "\"\<<\!\(\*SubscriptBox[\(\[Epsilon]\), \
\(LLP\)]\)\!\(\*SubscriptBox[\(\[Epsilon]\), \(decay\)]\)>\>\"", ",", 
              "\"\<c\[Tau]<\!\(\*SubscriptBox[\(\[Epsilon]\), \
\(LLP\)]\)\!\(\*SubscriptBox[\(P\), \(decay\)]\)>\>\"", ",", 
              "\"\<c\[Tau]<\!\(\*SubscriptBox[\(\[Epsilon]\), \
\(LLP\)]\)\!\(\*SubscriptBox[\(P\), \(decay\)]\)\!\(\*SubscriptBox[\(\
\[Epsilon]\), \(decay\)]\)>\>\""}], "}"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"0.75", ",", "0.2"}], "}"}]}], "]"}]}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"FilenameAcceptance", "[", "prod", "]"}], "=", 
          RowBox[{"ToString", "@", 
           RowBox[{"StringForm", "[", 
            RowBox[{"\"\<Acceptance_ALP-fermion_at_``_From_``.dat\>\"", ",", 
             RowBox[{"Sequence", "@@", 
              RowBox[{"{", 
               RowBox[{"SelectedExperiment", ",", 
                RowBox[{"ExportList", "[", "prod", "]"}]}], "}"}]}]}], 
            "]"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"Export", "[", 
          RowBox[{
           RowBox[{"FileNameJoin", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"NotebookDirectory", "[", "]"}], ",", 
              "\"\<Auxiliary data/ALPs with fermion coupling\>\"", ",", 
              "SelectedExperiment", ",", 
              RowBox[{"FilenameAcceptance", "[", "prod", "]"}]}], "}"}], 
            "]"}], ",", 
           RowBox[{
            RowBox[{"\[Epsilon]GeomTabs", "[", "prod", "]"}], "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", 
              RowBox[{"{", 
               RowBox[{"1", ",", "2", ",", "4", ",", "5"}], "}"}]}], "]"}], 
            "]"}], ",", "\"\<Table\>\""}], "]"}]}], "\[IndentingNewLine]", 
        ",", 
        RowBox[{"{", 
         RowBox[{"prod", ",", "ProductionList"}], "}"}]}], "]"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"AccAveraged", "[", 
       RowBox[{"mLLP_", ",", "c\[Tau]_"}], "]"}], "=", 
      RowBox[{"NpotGivenExperiment", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"mLLPmin", "[", "prod", "]"}], "<", "mLLP", "<", 
              RowBox[{"mLLPmax", "[", "prod", "]"}]}], ",", 
             RowBox[{"Evaluate", "[", 
              RowBox[{"ProbLLP", "[", 
               RowBox[{"mLLP", ",", "1", ",", "prod"}], "]"}], "]"}], ",", 
             "0"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"prod", ",", "ProductionList"}], "}"}]}], "]"}], ",", 
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Max", "[", 
               RowBox[{
                RowBox[{"mLLPmin", "[", "prod", "]"}], ",", 
                "mmin\[Epsilon]"}], "]"}], "<", "mLLP", "<", 
              RowBox[{"Min", "[", 
               RowBox[{
                RowBox[{"mLLPmax", "[", "prod", "]"}], ",", 
                "mmax\[Epsilon]"}], "]"}]}], ",", 
             RowBox[{"Evaluate", "[", 
              RowBox[{
               RowBox[{"ProbLLP", "[", 
                RowBox[{"mLLP", ",", "1", ",", "prod"}], "]"}], "*", 
               RowBox[{
                RowBox[{"Interpolation", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"\[Epsilon]GeomTabs", "[", "prod", "]"}], "[", 
                   RowBox[{"[", 
                    RowBox[{"All", ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "2"}], "}"}]}], "]"}], "]"}], ",", 
                  RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], 
                "[", "mLLP", "]"}]}], "]"}], ",", "0"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"prod", ",", "ProductionList"}], "}"}]}], "]"}], ",", 
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Max", "[", 
               RowBox[{
                RowBox[{"mLLPmin", "[", "prod", "]"}], ",", 
                "mmin\[Epsilon]"}], "]"}], "<", "mLLP", "<", 
              RowBox[{"Min", "[", 
               RowBox[{
                RowBox[{"mLLPmax", "[", "prod", "]"}], ",", 
                "mmax\[Epsilon]"}], "]"}]}], ",", 
             RowBox[{"Evaluate", "[", 
              RowBox[{
               FractionBox[
                RowBox[{"ProbLLP", "[", 
                 RowBox[{"mLLP", ",", "1", ",", "prod"}], "]"}], "c\[Tau]"], 
               "*", 
               RowBox[{
                RowBox[{"Interpolation", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"\[Epsilon]GeomTabs", "[", "prod", "]"}], "[", 
                   RowBox[{"[", 
                    RowBox[{"All", ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "4"}], "}"}]}], "]"}], "]"}], ",", 
                  RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], 
                "[", "mLLP", "]"}]}], "]"}], ",", "0"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"prod", ",", "ProductionList"}], "}"}]}], "]"}], ",", 
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Max", "[", 
               RowBox[{
                RowBox[{"mLLPmin", "[", "prod", "]"}], ",", 
                "mmin\[Epsilon]"}], "]"}], "<", "mLLP", "<", 
              RowBox[{"Min", "[", 
               RowBox[{
                RowBox[{"mLLPmax", "[", "prod", "]"}], ",", 
                "mmax\[Epsilon]"}], "]"}]}], ",", 
             RowBox[{"Evaluate", "[", 
              RowBox[{
               FractionBox[
                RowBox[{"ProbLLP", "[", 
                 RowBox[{"mLLP", ",", "1", ",", "prod"}], "]"}], "c\[Tau]"], 
               "*", 
               RowBox[{
                RowBox[{"Interpolation", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"\[Epsilon]GeomTabs", "[", "prod", "]"}], "[", 
                   RowBox[{"[", 
                    RowBox[{"All", ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "5"}], "}"}]}], "]"}], "]"}], ",", 
                  RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], 
                "[", "mLLP", "]"}]}], "]"}], ",", "0"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"prod", ",", "ProductionList"}], "}"}]}], "]"}]}], 
        "}"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Export", "[", 
      RowBox[{
       RowBox[{"FileNameJoin", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"directory", "[", "\"\<Auxiliary-experiment\>\"", "]"}], 
          ",", 
          RowBox[{"ToString", "@", 
           RowBox[{"StringForm", "[", 
            RowBox[{
             RowBox[{
             "\"\<AcceptanceAveraged-\>\"", "<>", "LLPdirName", "<>", 
              "\"\<_mixing-pattern_``-``-``.m\>\""}], ",", 
             RowBox[{"Sequence", "@@", "MixingPattern"}]}], "]"}]}]}], "}"}], 
        "]"}], ",", 
       RowBox[{"AccAveraged", "[", 
        RowBox[{"mLLP", ",", "c\[Tau]"}], "]"}], ",", "\"\<MX\>\""}], "]"}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"Style", "[", 
      RowBox[{
       RowBox[{"Row", "[", 
        RowBox[{"Evaluate", "[", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"PlotAcc", "[", "prod", "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"prod", ",", "ProductionList"}], "}"}]}], "]"}], "]"}], 
        "]"}], ",", 
       RowBox[{"ImageSizeMultipliers", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"1", ",", "1", ",", "1", ",", "1"}], "}"}]}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.9165072608467913`*^9, 3.91650727179105*^9}, {
   3.916511834115503*^9, 3.9165119704481926`*^9}, {3.9166711144696927`*^9, 
   3.9166711149830294`*^9}, 3.9166780922513075`*^9, 3.916678141041499*^9, {
   3.916678530617515*^9, 3.9166785400912275`*^9}, {3.9166785758460608`*^9, 
   3.9166785811324005`*^9}, {3.9166787375236473`*^9, 3.916678749325843*^9}, {
   3.942317609859535*^9, 3.9423176118703785`*^9}, {3.942318895696886*^9, 
   3.9423189292292423`*^9}, {3.950686292337637*^9, 3.950686385121866*^9}},
 CellTags->{
  "Acceptance-computation", "Number-of-events-computation+sensitivity"},
 CellLabel->
  "In[112]:=",ExpressionUUID->"03fb6361-21bd-4434-b71f-bd0f724156f8"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Rough estimates of the upper and lower bounds", "Subsection",
 CellChangeTimes->{{3.8850328066928463`*^9, 3.8850328135228024`*^9}},
 CellTags->{
  "Acceptance-computation", 
   "Number-of-events-computation+sensitivity"},ExpressionUUID->"f37cf8bb-aa0d-\
41e8-b9f0-27df587e3cef"],

Cell[BoxData[
 RowBox[{"If", "[", 
  RowBox[{"condcontinue", ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Do", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"intacc", "[", 
         RowBox[{"prod", ",", "mLLP_"}], "]"}], "=", 
        RowBox[{
         RowBox[{"Interpolation", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"\[Epsilon]GeomTabs", "[", "prod", "]"}], "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", 
              RowBox[{"{", 
               RowBox[{"1", ",", "5"}], "}"}]}], "]"}], "]"}], ",", 
           RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[", 
         "mLLP", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"LowerBoundEstimate", "[", 
         RowBox[{"mLLP_", ",", "prod"}], "]"}], "=", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"intacc", "[", 
            RowBox[{"prod", ",", "mLLP"}], "]"}], ">", "0"}], ",", 
          RowBox[{"Evaluate", "[", 
           SuperscriptBox[
            RowBox[{"(", 
             FractionBox[
              RowBox[{"NpotGivenExperiment", "*", 
               RowBox[{"ProbLLP", "[", 
                RowBox[{"mLLP", ",", "1", ",", "prod"}], "]"}], "*", 
               RowBox[{
                RowBox[{"Interpolation", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"\[Epsilon]GeomTabs", "[", "prod", "]"}], "[", 
                   RowBox[{"[", 
                    RowBox[{"All", ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "5"}], "}"}]}], "]"}], "]"}], ",", 
                  RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], 
                "[", "mLLP", "]"}]}], 
              RowBox[{"2.3", 
               RowBox[{"ldecayLLP", "[", 
                RowBox[{"mLLP", ",", "1", ",", "ELLP"}], "]"}], 
               FractionBox["mLLP", 
                SqrtBox[
                 RowBox[{
                  SuperscriptBox["ELLP", "2"], "-", 
                  SuperscriptBox["mLLP", "2"]}]]]}]], ")"}], 
            RowBox[{"-", 
             FractionBox["1", "2"]}]], "]"}], ",", "1."}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"UpperBoundEstimate", "[", 
         RowBox[{"mLLP_", ",", "prod"}], "]"}], "=", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"intacc", "[", 
            RowBox[{"prod", ",", "mLLP"}], "]"}], ">", "0"}], ",", 
          RowBox[{"Evaluate", "[", 
           RowBox[{"(", 
            RowBox[{"Abs", "[", 
             RowBox[{"Re", "[", 
              RowBox[{"Evaluate", "[", 
               RowBox[{
                RowBox[{"-", 
                 FractionBox[
                  RowBox[{"ProductLog", "[", 
                   RowBox[{
                    RowBox[{"-", "1"}], ",", 
                    RowBox[{
                    RowBox[{"-", "2.3"}], "*", 
                    FractionBox["b", "a"]}]}], "]"}], "b"]}], "/.", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"a", "\[Rule]", " ", 
                   RowBox[{"NpotGivenExperiment", "*", 
                    RowBox[{"ProbLLP", "[", 
                    RowBox[{"mLLP", ",", "1", ",", "prod"}], "]"}], "*", 
                    RowBox[{
                    RowBox[{"Interpolation", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"\[Epsilon]GeomTabs", "[", "prod", "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "3"}], "}"}]}], "]"}], "]"}], ",", 
                    RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], 
                    "[", "mLLP", "]"}]}]}], ",", 
                  RowBox[{"b", "\[Rule]", 
                   FractionBox["zminExp", 
                    RowBox[{"ldecayLLP", "[", 
                    RowBox[{"mLLP", ",", "1", ",", 
                    RowBox[{"ELLPmax", "[", 
                    RowBox[{"0.5", ",", "\[Theta]minExp", ",", "prod"}], 
                    "]"}]}], "]"}]]}]}], "}"}]}], "]"}], "]"}], "]"}], ")"}], 
           "]"}], ",", "0.1"}], "]"}]}]}], "\[IndentingNewLine]", ",", 
      RowBox[{"{", 
       RowBox[{"prod", ",", "ProductionList"}], "}"}]}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"ProdTest", "=", 
     RowBox[{"ProductionList", "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"LogLogPlot", "[", 
     RowBox[{
      RowBox[{"Evaluate", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"0.3", 
          RowBox[{"LowerBoundEstimate", "[", 
           RowBox[{"mLLP", ",", "ProdTest"}], "]"}]}], ",", 
         RowBox[{"1.8", 
          RowBox[{"UpperBoundEstimate", "[", 
           RowBox[{"mLLP", ",", "ProdTest"}], "]"}]}]}], "}"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"mLLP", ",", 
        RowBox[{"Max", "[", 
         RowBox[{
          RowBox[{"mLLPmin", "[", "ProdTest", "]"}], ",", "mmin\[Epsilon]"}], 
         "]"}], ",", 
        RowBox[{"Min", "[", 
         RowBox[{
          RowBox[{"mLLPmax", "[", "ProdTest", "]"}], ",", "mmax\[Epsilon]"}], 
         "]"}]}], "}"}], ",", 
      RowBox[{"Frame", "->", "True"}], ",", 
      RowBox[{"ImageSize", "->", "Large"}]}], "]"}]}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.8927045521296835`*^9, 3.892704618398532*^9}, {
   3.892704651576499*^9, 3.892704652867281*^9}, 3.8951292466391563`*^9, {
   3.8972064547512426`*^9, 3.8972064548441195`*^9}, {3.8972065272743893`*^9, 
   3.8972065273639555`*^9}, {3.897208556347765*^9, 3.8972085563922853`*^9}, {
   3.8972086426345124`*^9, 3.897208654173244*^9}, {3.897232414966792*^9, 
   3.8972324175870733`*^9}, {3.8972329876997476`*^9, 3.897233009729268*^9}, {
   3.8972333224369483`*^9, 3.8972333287617497`*^9}, 3.897233684153979*^9, {
   3.8972340069416475`*^9, 3.897234007169805*^9}, {3.897234114920539*^9, 
   3.8972341194170074`*^9}, {3.9027273710668883`*^9, 3.902727371070483*^9}, {
   3.9037896747950044`*^9, 3.903789674805071*^9}, {3.903791118363947*^9, 
   3.9037911183684855`*^9}, {3.9037936813200336`*^9, 3.903793682290308*^9}, {
   3.9049231517292624`*^9, 3.904923157976531*^9}, {3.9049231902009006`*^9, 
   3.904923190656528*^9}, 3.904926376200742*^9, {3.911027289230471*^9, 
   3.9110273124658933`*^9}, {3.9110277505648003`*^9, 3.911027764091008*^9}, 
   3.913866752239462*^9, {3.9138675516462307`*^9, 3.9138675637833986`*^9}, {
   3.9138682212474923`*^9, 3.913868221253111*^9}, {3.9138690439766445`*^9, 
   3.913869043981699*^9}, {3.9138691384932814`*^9, 3.913869147288597*^9}, {
   3.913869202156701*^9, 3.9138692055185556`*^9}, {3.913869239652417*^9, 
   3.9138692400334797`*^9}, {3.913869474546574*^9, 3.913869474546574*^9}, {
   3.913870429970599*^9, 3.913870442530464*^9}, {3.9138744135974054`*^9, 
   3.913874414587882*^9}, {3.9156429963777814`*^9, 3.915642996428277*^9}, {
   3.916391759919177*^9, 3.916391773937995*^9}, {3.916512010716703*^9, 
   3.9165120302839413`*^9}, {3.9166781594647117`*^9, 
   3.9166781706411057`*^9}, {3.947704784553278*^9, 3.947704809965063*^9}, {
   3.947704854502575*^9, 3.947704907690359*^9}, {3.950686400534422*^9, 
   3.950686405755514*^9}},
 CellTags->{
  "Acceptance-computation", "Number-of-events-computation+sensitivity"},
 CellLabel->
  "In[113]:=",ExpressionUUID->"9b09e04e-df6b-493d-adbb-e52373a5f090"]
}, Closed]],

Cell[CellGroupData[{

Cell["Number of events - fast", "Subsection",
 CellChangeTimes->{{3.897206442190997*^9, 3.8972064427846107`*^9}, {
  3.905840324777521*^9, 3.905840328994842*^9}},
 CellTags->{
  "Number-of-events-computation+sensitivity", 
   "Acceptance-computation"},ExpressionUUID->"43432343-64e9-42df-9641-\
4553672b70c4"],

Cell[BoxData[{
 RowBox[{"If", "[", 
  RowBox[{"condcontinue", ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"FactorLowerBound", "=", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"MemberQ", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "\"\<ANUBIS-shaft-volume-1\>\"", ",", 
            "\"\<ANUBIS-shaft-volume-2\>\"", ",", 
            "\"\<ANUBIS-shaft-volume-3\>\""}], "}"}], ",", 
          "SelectedExperiment"}], "]"}], "==", "True"}], ",", "0.1", ",", 
       "0.3"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"NeventsDiscret", "[", 
      RowBox[{"m_", ",", "ProdChannel_", ",", "couplinglist_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"NevDiscret", ",", "NpotTimes\[Chi]val", ",", "zshift"}], 
        "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"MemberQ", "[", 
          RowBox[{"ProductionList", ",", "ProdChannel"}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Max", "[", 
             RowBox[{
              RowBox[{"mLLPmin", "[", "ProdChannel", "]"}], ",", 
              "mmin\[Epsilon]"}], "]"}], "<", "m", "<", 
            RowBox[{"Min", "[", 
             RowBox[{
              RowBox[{"mLLPmax", "[", "ProdChannel", "]"}], ",", 
              "mmax\[Epsilon]"}], "]"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"integrandtab", "=", 
             RowBox[{"TableIntegrandDiscret", "[", 
              RowBox[{"m", ",", "ProdChannel", ",", "\"\<True\>\""}], "]"}]}],
             ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"NpotTimes\[Chi]val", "[", "coupling_", "]"}], "=", 
             RowBox[{"NpotGivenExperiment", "*", 
              RowBox[{"ProbLLP", "[", 
               RowBox[{"m", ",", "coupling", ",", "ProdChannel"}], "]"}]}]}], 
            ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"lowerbound", ",", "upperbound"}], "}"}], "=", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"LowerBoundEstimate", "[", 
                RowBox[{"m", ",", "ProdChannel"}], "]"}], ",", 
               RowBox[{"UpperBoundEstimate", "[", 
                RowBox[{"m", ",", "ProdChannel"}], "]"}]}], "}"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"brvis", "=", 
             RowBox[{"BrVis", "[", "m", "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"NevDiscret", "[", "coupling_", "]"}], ":=", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"0.1", "lowerbound"}], "<", "coupling", "<", 
                RowBox[{"(*", "1.5", "*)"}], 
                RowBox[{"2", "upperbound"}]}], ",", 
               RowBox[{
                RowBox[{"NpotTimes\[Chi]val", "[", "coupling", "]"}], "*", 
                "brvis", "*", 
                RowBox[{"sumcompile", "[", 
                 RowBox[{"tableprefac", "[", 
                  RowBox[{"integrandtab", ",", "m", ",", 
                   RowBox[{"c\[Tau]LLP", "[", 
                    RowBox[{"m", ",", "coupling"}], "]"}], ",", "1", ",", 
                   "0."}], "]"}], "]"}]}], ",", "0."}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"m", ",", 
                RowBox[{"couplinglist", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], ",", 
                RowBox[{"NevDiscret", "[", 
                 RowBox[{"couplinglist", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "1", ",", 
                RowBox[{"Length", "[", "couplinglist", "]"}], ",", "1"}], 
               "}"}]}], "]"}]}], ",", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"m", ",", 
               RowBox[{"couplinglist", "[", 
                RowBox[{"[", "i", "]"}], "]"}], ",", "0."}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", 
               RowBox[{"Length", "[", "couplinglist", "]"}], ",", "1"}], 
              "}"}]}], "]"}]}], "]"}], "\[IndentingNewLine]", ",", 
         "\[IndentingNewLine]", 
         RowBox[{
         "Print", "[", "\"\<The given production mode does not exist!\>\"", 
          "]"}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
      "]"}]}]}]}], "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"tabtest", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          SuperscriptBox["10", "6"], 
          RowBox[{"#", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], ",", 
         FractionBox[
          RowBox[{"#", "[", 
           RowBox[{"[", "3", "]"}], "]"}], "10."]}], "}"}], "&"}], "/@", 
      RowBox[{"NeventsDiscret", "[", 
       RowBox[{"3.", ",", "\"\<B\>\"", ",", 
        RowBox[{"Table", "[", 
         RowBox[{
          SuperscriptBox["10", "x"], ",", 
          RowBox[{"{", 
           RowBox[{"x", ",", 
            RowBox[{"-", "7."}], ",", 
            RowBox[{"-", "4."}], ",", "0.1"}], "}"}]}], "]"}]}], "]"}]}]}], 
    ";", "\[IndentingNewLine]", 
    RowBox[{"tabtest2", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          SuperscriptBox["10", "6"], 
          RowBox[{"#", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], ",", 
         FractionBox[
          RowBox[{"#", "[", 
           RowBox[{"[", "3", "]"}], "]"}], "10."]}], "}"}], "&"}], "/@", 
      RowBox[{"NeventsDiscret", "[", 
       RowBox[{"2.5", ",", "\"\<B\>\"", ",", 
        RowBox[{"Table", "[", 
         RowBox[{
          SuperscriptBox["10", "x"], ",", 
          RowBox[{"{", 
           RowBox[{"x", ",", 
            RowBox[{"-", "7."}], ",", 
            RowBox[{"-", "4."}], ",", "0.1"}], "}"}]}], "]"}]}], "]"}]}]}], 
    ";", "\[IndentingNewLine]", 
    RowBox[{"tabtest3", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          SuperscriptBox["10", "6"], 
          RowBox[{"#", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], ",", 
         FractionBox[
          RowBox[{"#", "[", 
           RowBox[{"[", "3", "]"}], "]"}], "10."]}], "}"}], "&"}], "/@", 
      RowBox[{"NeventsDiscret", "[", 
       RowBox[{"2.", ",", "\"\<B\>\"", ",", 
        RowBox[{"Table", "[", 
         RowBox[{
          SuperscriptBox["10", "x"], ",", 
          RowBox[{"{", 
           RowBox[{"x", ",", 
            RowBox[{"-", "7."}], ",", 
            RowBox[{"-", "4."}], ",", "0.1"}], "}"}]}], "]"}]}], "]"}]}]}], 
    ";", "\[IndentingNewLine]", 
    RowBox[{"ListLogLogPlot", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"tabtest3", ",", "tabtest2", ",", "tabtest"}], "}"}], ",", 
      RowBox[{"Frame", "->", "True"}], ",", 
      RowBox[{"ImageSize", "->", "Large"}], ",", 
      RowBox[{"PlotRange", "->", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0.1", ",", "100"}], "}"}], ",", "All"}], "}"}]}], ",", 
      RowBox[{"Joined", "->", "True"}], ",", 
      RowBox[{"FrameStyle", "->", 
       RowBox[{"Directive", "[", 
        RowBox[{"Thick", ",", "Black", ",", "22"}], "]"}]}], ",", 
      RowBox[{"FrameLabel", "->", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Row", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Subsuperscript", "[", 
             RowBox[{"\"\<U\>\"", ",", "\"\<e\>\"", ",", "\"\<2\>\""}], "]"}],
             ",", 
            "\"\<, \[Times]\!\(\*SuperscriptBox[\(10\), \(-6\)]\)\>\""}], 
           "}"}], "]"}], ",", 
         "\"\<\!\(\*SubscriptBox[\(N\), \(events\)]\)\>\""}], "}"}]}], ",", 
      RowBox[{"PlotLabel", "->", 
       RowBox[{"Style", "[", 
        RowBox[{
         RowBox[{"Row", "[", 
          RowBox[{
          "{", "\"\<\!\(\*SubscriptBox[\(m\), \(N\)]\) = 3 GeV\>\"", "}"}], 
          "]"}], ",", "18", ",", "Black"}], "]"}]}], ",", 
      RowBox[{"PlotStyle", "->", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"Thick", ",", "Blue"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"Thick", ",", 
           RowBox[{"Darker", "@", "Red"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"Thick", ",", 
           RowBox[{"Darker", "@", 
            RowBox[{"Darker", "@", "Green"}]}]}], "}"}]}], "}"}]}], ",", 
      RowBox[{"PlotLegends", "->", 
       RowBox[{"Placed", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Style", "[", 
            RowBox[{
             RowBox[{"Row", "[", 
              RowBox[{"{", 
               RowBox[{
               "\"\<\!\(\*SubscriptBox[\(m\), \(N\)]\) = \>\"", ",", "#", ",",
                 " ", "\"\< GeV\>\""}], "}"}], "]"}], ",", "Thick", ",", 
             "18"}], "]"}], "&"}], "/@", 
          RowBox[{"{", 
           RowBox[{"2.", ",", "2.5", ",", "3."}], "}"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"0.2", ",", "0.8"}], "}"}]}], "]"}]}]}], "]"}]}], 
   "*)"}]}]}], "Input",
 CellChangeTimes->{{3.897200964730176*^9, 3.897200965970766*^9}, {
   3.89720118259857*^9, 3.8972011870868115`*^9}, {3.8972012433916793`*^9, 
   3.8972012434804716`*^9}, {3.8972021109080114`*^9, 3.897202111357911*^9}, {
   3.897205130000824*^9, 3.8972051305748835`*^9}, 3.897206599004672*^9, {
   3.8972085445054307`*^9, 3.8972085493226857`*^9}, {3.897208729717713*^9, 
   3.897208782995672*^9}, {3.8972323557542253`*^9, 3.897232355758215*^9}, {
   3.8972325208882675`*^9, 3.897232579312927*^9}, {3.8972330183637056`*^9, 
   3.8972330186824365`*^9}, {3.8972330557477093`*^9, 
   3.8972330786629725`*^9}, {3.8972331885872264`*^9, 
   3.8972331892740192`*^9}, {3.897233372953797*^9, 3.8972334102237387`*^9}, {
   3.897233632248149*^9, 3.8972337068313646`*^9}, {3.897233770343194*^9, 
   3.897233794850586*^9}, {3.897234027583762*^9, 3.897234039222018*^9}, 
   3.902727371095085*^9, {3.903789674824919*^9, 3.9037896748651905`*^9}, {
   3.903790316364489*^9, 3.903790327604648*^9}, 3.903791118373599*^9, {
   3.903793681334241*^9, 3.903793681337234*^9}, {3.903793815495824*^9, 
   3.9037938405670385`*^9}, {3.9110273360582485`*^9, 3.911027382154455*^9}, {
   3.9110275909078875`*^9, 3.9110276162959757`*^9}, {3.911027735769429*^9, 
   3.9110277360519323`*^9}, {3.91102782490703*^9, 3.9110278664472694`*^9}, {
   3.911027908345337*^9, 3.9110279086712365`*^9}, 3.913867583368688*^9, {
   3.9138687734466343`*^9, 3.9138687783364944`*^9}, 3.913869043987434*^9, {
   3.91386913849867*^9, 3.91386914700126*^9}, {3.9138718044634438`*^9, 
   3.9138718044763327`*^9}, {3.9138744265895786`*^9, 
   3.9138744439740767`*^9}, {3.915642996438535*^9, 3.9156429964465075`*^9}, {
   3.9166711739039955`*^9, 3.9166711755719423`*^9}, {3.9166781923053007`*^9, 
   3.9166782212011676`*^9}, 3.9166787824450197`*^9, {3.9166791145520115`*^9, 
   3.9166791166317496`*^9}, {3.9427322399425907`*^9, 
   3.9427322401438503`*^9}, {3.9427323805581455`*^9, 3.942732398310457*^9}, {
   3.942922369030464*^9, 3.942922370536297*^9}, {3.942922469555977*^9, 
   3.942922481632736*^9}, {3.9506864099576664`*^9, 3.9506864716450233`*^9}},
 CellTags->{
  "Number-of-events-computation+sensitivity", "Acceptance-computation"},
 CellLabel->
  "In[114]:=",ExpressionUUID->"80589d8c-c093-4f2d-b5ad-20bfa16f8bb5"]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Number of events - slow (using built-in Mathematica functions Interpolation, \
NIntegrate)\
\>", "Subsection",
 CellChangeTimes->{{3.916673042143861*^9, 3.9166730501366386`*^9}},
 CellTags->{
  "Number-of-events-computation+sensitivity", 
   "Acceptance-computation"},ExpressionUUID->"8faea506-240c-4530-9f24-\
b7a3f06c201e"],

Cell[BoxData[
 RowBox[{"If", "[", 
  RowBox[{"condcontinue", ",", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Differential", " ", "decay", " ", "probability", " ", 
      FractionBox["1", "ldecay"], 
      RowBox[{"Exp", "[", 
       RowBox[{
        RowBox[{"-", "l"}], "/", "ldecay"}], "]"}]}], ",", " ", 
     RowBox[{
     "where", " ", "l", " ", "is", " ", "expressed", " ", "in", " ", "terms", 
      " ", "of", " ", "the", " ", "longitudinal", " ", "displacement", " ", 
      "z", " ", "and", " ", "polar", " ", "angle", " ", "\[Theta]", " ", "as",
       " ", 
      RowBox[{"z", "/", "cos\[Theta]"}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Differential", " ", "decay", " ", "probability", " ", 
      RowBox[{"(", 
       RowBox[{"1", "/", "ldecay"}], ")"}], 
      RowBox[{"Exp", "[", 
       RowBox[{
        RowBox[{"-", "l"}], "/", "ldecay"}], "]"}]}], ",", " ", 
     RowBox[{
     "where", " ", "l", " ", "is", " ", "expressed", " ", "in", " ", "terms", 
      " ", "of", " ", "the", " ", "longitudinal", " ", "displacement", " ", 
      "z", " ", "and", " ", "polar", " ", "angle", " ", "\[Theta]", " ", "as",
       " ", 
      RowBox[{"z", "/", "cos\[Theta]"}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"PdecayDensity", "[", 
      RowBox[{
      "mLLP_", ",", "coupling_", ",", "\[Theta]LLP_", ",", "ELLP_", ",", 
       "zLLP_"}], "]"}], "=", 
     RowBox[{
      RowBox[{"Exp", "[", 
       RowBox[{
        RowBox[{"-", "zLLP"}], "/", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Cos", "[", "\[Theta]LLP", "]"}], "*", 
          RowBox[{"ldecayLLP", "[", 
           RowBox[{"mLLP", ",", "coupling", ",", "ELLP"}], "]"}]}], ")"}]}], 
       "]"}], "/", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Abs", "[", 
         RowBox[{"Cos", "[", "\[Theta]LLP", "]"}], "]"}], "*", 
        RowBox[{"ldecayLLP", "[", 
         RowBox[{"mLLP", ",", "coupling", ",", "ELLP"}], "]"}]}], ")"}]}]}], 
    ";", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
     "The", " ", "integrand", " ", "determining", " ", "the", " ", 
      "differential", " ", "rate", " ", "for", " ", "events"}], "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"IntegrandLLP", "[", 
        RowBox[{
        "mLLP_", ",", "coupling_", ",", "\[Theta]LLP_", ",", "ELLP_", ",", 
         "zLLP_", ",", "prod"}], "]"}], "=", 
       RowBox[{
        RowBox[{"DoubleDistrLLPint", "[", 
         RowBox[{"mLLP", ",", "\[Theta]LLP", ",", "ELLP", ",", "prod"}], 
         "]"}], "*", 
        RowBox[{"PdecayDensity", "[", 
         RowBox[{
         "mLLP", ",", "coupling", ",", "\[Theta]LLP", ",", "ELLP", ",", 
          "zLLP"}], "]"}], "*", 
        RowBox[{"AzimuthalAcceptanceInt", "[", 
         RowBox[{"\[Theta]LLP", ",", "zLLP"}], "]"}], "*", 
        RowBox[{"DecayAcceptanceInt", "[", 
         RowBox[{"mLLP", ",", "\[Theta]LLP", ",", "ELLP", ",", "zLLP"}], 
         "]"}]}]}], ",", 
      RowBox[{"{", 
       RowBox[{"prod", ",", "ProductionList"}], "}"}]}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"IntegralLLP", "[", 
      RowBox[{"mLLP_", ",", "coupling_", ",", "ProdChannel_"}], "]"}], ":=", 
     RowBox[{"NIntegrate", "[", 
      RowBox[{
       RowBox[{"Abs", "[", 
        RowBox[{
         RowBox[{"IntegrandLLP", "[", 
          RowBox[{"mLLP", ",", "coupling", ",", "\[Theta]LLP", ",", 
           RowBox[{"Exp", "[", "ELLP", "]"}], ",", "zLLP", ",", 
           "ProdChannel"}], "]"}], 
         RowBox[{"Exp", "[", "ELLP", "]"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Theta]LLP", ",", "\[Theta]minExp", ",", "\[Theta]maxExp"}],
         "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"ELLP", ",", 
         RowBox[{"Log", "[", "mLLP", "]"}], ",", 
         RowBox[{"Log", "[", 
          RowBox[{"ELLPmax", "[", 
           RowBox[{"mLLP", ",", "\[Theta]LLP", ",", "ProdChannel"}], "]"}], 
          "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"zLLP", ",", 
         RowBox[{"zmin\[Theta]", "[", "\[Theta]LLP", "]"}], ",", 
         RowBox[{"zmax\[Theta]", "[", "\[Theta]LLP", "]"}]}], "}"}], ",", 
       RowBox[{"Method", "\[Rule]", "\"\<AdaptiveMonteCarlo\>\""}]}], "]"}]}],
     ";", "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"FacilityGivenExperiment", "==", "\"\<ESS\>\""}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"IntegralLLP", "[", 
        RowBox[{"mLLP_", ",", "U2_", ",", "\"\<PiCharged\>\""}], "]"}], ":=", 
       RowBox[{
        RowBox[{"NIntegrate", "[", 
         RowBox[{
          RowBox[{"Abs", "[", 
           RowBox[{"IntegrandLLP", "[", 
            RowBox[{
            "mLLP", ",", "U2", ",", "\[Theta]LLP", ",", "ELLP", ",", "zLLP", 
             ",", "\"\<PiCharged\>\""}], "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{
           "\[Theta]LLP", ",", "\[Theta]minExp", ",", "\[Theta]maxExp"}], 
           "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"ELLP", ",", 
            RowBox[{
             FractionBox[
              RowBox[{
               SuperscriptBox[
                RowBox[{"mSM", "[", "\"\<PiCharged\>\"", "]"}], "2"], "-", 
               SuperscriptBox[
                RowBox[{"mSM", "[", "\"\<mu\>\"", "]"}], "2"], "+", 
               SuperscriptBox["mLLP", "2"]}], 
              RowBox[{"2", "*", 
               RowBox[{"mSM", "[", "\"\<PiCharged\>\"", "]"}]}]], "-", 
             FractionBox["\[CapitalDelta]Eapprox", "2"]}], ",", 
            RowBox[{
             FractionBox[
              RowBox[{
               SuperscriptBox[
                RowBox[{"mSM", "[", "\"\<PiCharged\>\"", "]"}], "2"], "-", 
               SuperscriptBox[
                RowBox[{"mSM", "[", "\"\<mu\>\"", "]"}], "2"], "+", 
               SuperscriptBox["mLLP", "2"]}], 
              RowBox[{"2", "*", 
               RowBox[{"mSM", "[", "\"\<PiCharged\>\"", "]"}]}]], "+", 
             FractionBox["\[CapitalDelta]Eapprox", "2"]}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"zLLP", ",", 
            RowBox[{"zmin\[Theta]", "[", "\[Theta]LLP", "]"}], ",", 
            RowBox[{"zmax\[Theta]", "[", "\[Theta]LLP", "]"}]}], "}"}], ",", 
          RowBox[{"Method", "\[Rule]", "\"\<AdaptiveMonteCarlo\>\""}]}], 
         "]"}], "+", 
        RowBox[{"NIntegrate", "[", 
         RowBox[{
          RowBox[{"Abs", "[", 
           RowBox[{"IntegrandLLP", "[", 
            RowBox[{
            "mLLP", ",", "U2", ",", "\[Theta]LLP", ",", "ELLP", ",", "zLLP", 
             ",", "\"\<PiCharged\>\""}], "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{
           "\[Theta]LLP", ",", "\[Theta]minExp", ",", "\[Theta]maxExp"}], 
           "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"ELLP", ",", 
            RowBox[{
             FractionBox[
              RowBox[{
               SuperscriptBox[
                RowBox[{"mSM", "[", "\"\<PiCharged\>\"", "]"}], "2"], "-", 
               SuperscriptBox[
                RowBox[{"mSM", "[", "\"\<e\>\"", "]"}], "2"], "+", 
               SuperscriptBox["mLLP", "2"]}], 
              RowBox[{"2", "*", 
               RowBox[{"mSM", "[", "\"\<PiCharged\>\"", "]"}]}]], "-", 
             FractionBox["\[CapitalDelta]Eapprox", "2"]}], ",", 
            RowBox[{
             FractionBox[
              RowBox[{
               SuperscriptBox[
                RowBox[{"mSM", "[", "\"\<PiCharged\>\"", "]"}], "2"], "-", 
               SuperscriptBox[
                RowBox[{"mSM", "[", "\"\<e\>\"", "]"}], "2"], "+", 
               SuperscriptBox["mLLP", "2"]}], 
              RowBox[{"2", "*", 
               RowBox[{"mSM", "[", "\"\<PiCharged\>\"", "]"}]}]], "+", 
             FractionBox["\[CapitalDelta]Eapprox", "2"]}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"zLLP", ",", 
            RowBox[{"zmin\[Theta]", "[", "\[Theta]LLP", "]"}], ",", 
            RowBox[{"zmax\[Theta]", "[", "\[Theta]LLP", "]"}]}], "}"}], ",", 
          RowBox[{"Method", "\[Rule]", "\"\<AdaptiveMonteCarlo\>\""}]}], 
         "]"}]}]}]}], "\[IndentingNewLine]", "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"NeventsInt", "[", 
      RowBox[{"mLLP_", ",", "coupling_", ",", "ProdChannel_"}], "]"}], ":=", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"mLLPmin", "[", "ProdChannel", "]"}], "\[LessEqual]", "mLLP",
          "\[LessEqual]", 
         RowBox[{"mLLPmax", "[", "ProdChannel", "]"}]}], "&&", 
        RowBox[{
         RowBox[{"BrVis", "[", "mLLP", "]"}], "!=", "0"}]}], ",", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"0.1", 
           RowBox[{"LowerBoundEstimate", "[", 
            RowBox[{"mLLP", ",", "ProdChannel"}], "]"}]}], "<", "coupling", 
          "<", 
          RowBox[{"2", 
           RowBox[{"UpperBoundEstimate", "[", 
            RowBox[{"mLLP", ",", "ProdChannel"}], "]"}]}]}], ",", 
         RowBox[{"NpotGivenExperiment", "*", 
          RowBox[{"ProbLLP", "[", 
           RowBox[{"mLLP", ",", "coupling", ",", "ProdChannel"}], "]"}], "*", 
          RowBox[{"IntegralLLP", "[", 
           RowBox[{"mLLP", ",", "coupling", ",", "ProdChannel"}], "]"}]}], 
         ",", "0."}], "]"}], ",", "0."}], "]"}]}]}]}], "\[IndentingNewLine]", 
  "]"}]], "Input",
 CellChangeTimes->{
  3.916678266652649*^9, {3.916808922093241*^9, 3.916808933846073*^9}, {
   3.950686474845661*^9, 3.950686486472025*^9}},
 CellTags->{
  "Number-of-events-computation+sensitivity", "Acceptance-computation"},
 CellLabel->
  "In[115]:=",ExpressionUUID->"db4a3dcf-78a9-45ef-b0f1-1af3bc9e781f"]
}, Closed]],

Cell[CellGroupData[{

Cell["Differential number of events", "Subsection",
 CellChangeTimes->{{3.892111289211891*^9, 3.892111293865343*^9}},
 CellTags->{
  "Number-of-events-computation+sensitivity", 
   "Acceptance-computation"},ExpressionUUID->"81f7b327-4279-40bc-bdd8-\
0cdc2e2facd4"],

Cell[BoxData[
 RowBox[{"If", "[", 
  RowBox[{"condcontinue", ",", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "Variable", " ", "=", " ", 
      "\"\<\!\(\*SubscriptBox[\(E\), \(X\)]\)\>\""}], ",", 
     "\"\<\!\(\*SubscriptBox[\(z\), \(X\)]\)\>\"", ",", 
     RowBox[{
      RowBox[{
      "\"\<\!\(\*SubscriptBox[\(\[Theta]\), \(X\)]\)\>\"", ".", " ", "The"}], 
      " ", "number", " ", "belongs", " ", "to", " ", "the", " ", "column", 
      " ", "in", " ", "the", " ", "tabulated", " ", "data"}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"iVal", ":=", 
     RowBox[{"Association", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
        "\"\<\!\(\*SubscriptBox[\(E\), \(X\)]\)\>\"", " ", "\[Rule]", "2"}], 
        ",", 
        RowBox[{
        "\"\<\!\(\*SubscriptBox[\(\[Theta]\), \(X\)]\)\>\"", "\[Rule]", "1"}],
         ",", 
        RowBox[{
        "\"\<\!\(\*SubscriptBox[\(z\), \(X\)]\)\>\"", "\[Rule]", "3"}]}], 
       "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
     "\[CapitalDelta]xvals", "[", 
      "\"\<\!\(\*SubscriptBox[\(E\), \(X\)]\)\>\"", "]"}], ":=", 
     "\[CapitalDelta]Evals"}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
     "\[CapitalDelta]xvals", "[", 
      "\"\<\!\(\*SubscriptBox[\(z\), \(X\)]\)\>\"", "]"}], "=", 
     "\[CapitalDelta]zvals"}], ";", "\[IndentingNewLine]", 
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"\[CapitalDelta]xvals", "[", 
        RowBox[{
        "\"\<\!\(\*SubscriptBox[\(\[Theta]\), \(X\)]\)\>\"", ",", "prod"}], 
        "]"}], "=", 
       RowBox[{"\[CapitalDelta]\[Theta]vals", "[", "prod", "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"prod", ",", "ProductionList"}], "}"}]}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"LegendX", ":=", 
     RowBox[{"Association", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
        "\"\<\!\(\*SubscriptBox[\(E\), \(X\)]\)\>\"", "\[Rule]", 
         "\"\<\!\(\*SubscriptBox[\(E\), \(X\)]\) [GeV]\>\""}], ",", 
        RowBox[{
        "\"\<\!\(\*SubscriptBox[\(\[Theta]\), \(X\)]\)\>\"", "\[Rule]", 
         "\"\<\!\(\*SubscriptBox[\(\[Theta]\), \(X\)]\) [rad]\>\""}], ",", 
        RowBox[{
        "\"\<\!\(\*SubscriptBox[\(z\), \(X\)]\)\>\"", "\[Rule]", " ", 
         "\"\<\!\(\*SubscriptBox[\(z\), \(X\)]\) [m]\>\""}]}], "}"}], "]"}]}],
     ";", "\[IndentingNewLine]", 
    RowBox[{"LegendY", ":=", 
     RowBox[{"Association", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
        "\"\<\!\(\*SubscriptBox[\(E\), \(X\)]\)\>\"", "\[Rule]", 
         "\"\<\!\(\*SubscriptBox[\(dN\), \(ev\)]\)/\!\(\*SubscriptBox[\(dE\), \
\(X\)]\) [\!\(\*SuperscriptBox[\(GeV\), \(-1\)]\)]\>\""}], ",", 
        RowBox[{
        "\"\<\!\(\*SubscriptBox[\(\[Theta]\), \(X\)]\)\>\"", "\[Rule]", 
         "\"\<\!\(\*SubscriptBox[\(dN\), \(ev\)]\)/\!\(\*SubscriptBox[\(d\
\[Theta]\), \(X\)]\) [\!\(\*SuperscriptBox[\(rad\), \(-1\)]\)]\>\""}], ",", 
        RowBox[{
        "\"\<\!\(\*SubscriptBox[\(z\), \(X\)]\)\>\"", "\[Rule]", " ", 
         "\"\<\!\(\*SubscriptBox[\(dN\), \(ev\)]\)/\!\(\*SubscriptBox[\(dz\), \
\(X\)]\) [\!\(\*SuperscriptBox[\(m\), \(-1\)]\)]\>\""}]}], "}"}], "]"}]}], 
    ";", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"Differential", " ", "number", " ", "of", " ", "events"}], 
     "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"NeventsDifferentialDiscretProd", "[", 
      RowBox[{"m_", ",", "ProdChannel_", ",", "coupling_", ",", "Variable_"}],
       "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "NpotTimes\[Chi]val", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ival", "=", 
         RowBox[{"iVal", "[", "Variable", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"NpotTimes\[Chi]val", "=", 
         RowBox[{"NpotGivenExperiment", "*", 
          RowBox[{"ProbLLP", "[", 
           RowBox[{"m", ",", "coupling", ",", "ProdChannel"}], "]"}]}]}], ";",
         "\[IndentingNewLine]", 
        RowBox[{"tablegrid0", "=", 
         RowBox[{"TableIntegrandDiscret", "[", 
          RowBox[{"m", ",", "ProdChannel", ",", "\"\<True\>\""}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"OutGridEfinalTemp", "=", 
         RowBox[{"OutGridEnergy", "[", 
          RowBox[{
           RowBox[{"N", "[", "m", "]"}], ",", "ProdChannel"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"!", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"FacilityGivenExperiment", "==", "\"\<ESS\>\""}], "&&", 
             RowBox[{"ProdChannel", "==", "\"\<PiCharged\>\""}]}], ")"}]}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{"OutGridEfinal", ",", "\[CapitalDelta]Evals"}], "}"}], 
            "=", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               FractionBox["1", "2"], 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Rest", "[", "OutGridEfinalTemp", "]"}], "+", 
                 RowBox[{"Most", "[", "OutGridEfinalTemp", "]"}]}], ")"}]}], 
              ",", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Rest", "[", 
                 SuperscriptBox["10", "OutGridEfinalTemp"], "]"}], "-", 
                RowBox[{"Most", "[", 
                 SuperscriptBox["10", "OutGridEfinalTemp"], "]"}]}], ")"}]}], 
             "}"}]}], ";"}], "\[IndentingNewLine]", ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"\[CapitalDelta]Eapprox", "=", 
            SuperscriptBox["10", 
             RowBox[{"-", "5."}]]}], ";", "\[IndentingNewLine]", 
           RowBox[{"\[CapitalDelta]Evals", "=", 
            RowBox[{"Table", "[", 
             RowBox[{"\[CapitalDelta]Eapprox", ",", 
              RowBox[{"Length", "[", "OutGridEfinalTemp", "]"}]}], "]"}]}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{"OutGridEfinal", "=", "OutGridEfinalTemp"}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"\[CapitalDelta]xval", "=", 
         RowBox[{"\[CapitalDelta]xvals", "[", "Variable", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"c\[Tau]Val", "=", 
         RowBox[{"c\[Tau]LLP", "[", 
          RowBox[{"m", ",", "coupling"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"brvis", "=", 
         RowBox[{"BrVis", "[", "m", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"ilist", "=", 
         RowBox[{"DeleteDuplicates", "[", 
          RowBox[{"{", 
           RowBox[{"ival", ",", "1", ",", "2", ",", "3"}], "}"}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"tablegrid1", "=", 
         RowBox[{"SortBy", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"#", "[", 
                RowBox[{"[", 
                 RowBox[{"ilist", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], ",", 
               RowBox[{"#", "[", 
                RowBox[{"[", 
                 RowBox[{"ilist", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}], ",", 
               RowBox[{"#", "[", 
                RowBox[{"[", 
                 RowBox[{"ilist", "[", 
                  RowBox[{"[", "3", "]"}], "]"}], "]"}], "]"}], ",", 
               RowBox[{"#", "[", 
                RowBox[{"[", "4", "]"}], "]"}]}], "}"}], "&"}], "/@", 
            RowBox[{"tableGridPrefac", "[", 
             RowBox[{"tablegrid0", ",", "m", ",", "c\[Tau]Val", ",", "0."}], 
             "]"}]}], ",", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"#", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", 
              RowBox[{"#", "[", 
               RowBox[{"[", "2", "]"}], "]"}], ",", 
              RowBox[{"#", "[", 
               RowBox[{"[", "3", "]"}], "]"}]}], "}"}], "&"}]}], "]"}]}], ";",
         "\[IndentingNewLine]", 
        RowBox[{"GridQuantity", "=", 
         RowBox[{
          RowBox[{"tablegrid1", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "1"}], "]"}], "]"}], "//", 
          "DeleteDuplicates"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"LengthPerVariable", "=", 
         RowBox[{
          RowBox[{"Length", "[", "tablegrid1", "]"}], "/", 
          RowBox[{"Length", "[", "GridQuantity", "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"tab1", "=", 
         RowBox[{"NdiffCompiled", "[", 
          RowBox[{
          "tablegrid1", ",", "GridQuantity", ",", "LengthPerVariable", ",", 
           RowBox[{"NpotTimes\[Chi]val", "*", "brvis"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"tab1", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", 
             RowBox[{"{", "1", "}"}]}], "]"}], "]"}], ",", 
          RowBox[{"Partition", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"tab1", "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", "2"}], "]"}], "]"}], "*", 
             SuperscriptBox["\[CapitalDelta]xval", 
              RowBox[{"-", "1"}]]}], ",", "1"}], "]"}], ",", "2"}], "]"}]}]}],
       "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"NeventsDifferentialDiscret", "[", 
      RowBox[{"m_", ",", "coupling_", ",", "Variable_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "NdiffInt", ",", "LegendList", ",", "QuantityMinMax", ",", 
         "ValueMinMax"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"prodlisttemp", "=", 
         RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Do", "[", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Max", "[", 
              RowBox[{
               RowBox[{"mLLPmin", "[", "prod", "]"}], ",", "mmin\[Epsilon]"}],
               "]"}], "<", "m", "<", 
             RowBox[{"Min", "[", 
              RowBox[{
               RowBox[{"mLLPmax", "[", "prod", "]"}], ",", "mmax\[Epsilon]"}],
               "]"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"prodlisttemp", "=", 
              RowBox[{"Join", "[", 
               RowBox[{"prodlisttemp", ",", 
                RowBox[{"{", "prod", "}"}]}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"NdiffData", "[", "prod", "]"}], "=", 
              RowBox[{"NeventsDifferentialDiscretProd", "[", 
               RowBox[{"m", ",", "prod", ",", "coupling", ",", "Variable"}], 
               "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"XvalminmaxNdiff", "=", 
              RowBox[{
               RowBox[{
                RowBox[{"Select", "[", 
                 RowBox[{
                  RowBox[{"NdiffData", "[", "prod", "]"}], ",", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ">", 
                    SuperscriptBox["10", 
                    RowBox[{"-", "40"}]]}], "&"}]}], "]"}], "[", 
                RowBox[{"[", 
                 RowBox[{"All", ",", "1"}], "]"}], "]"}], "//", "MinMax"}]}], 
             ";", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"NdiffInt", "[", 
               RowBox[{"X_", ",", "prod"}], "]"}], "=", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"XvalminmaxNdiff", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "<", "X", "<", 
                 RowBox[{"XvalminmaxNdiff", "[", 
                  RowBox[{"[", "2", "]"}], "]"}]}], ",", 
                RowBox[{"Evaluate", "[", 
                 RowBox[{"10", "^", 
                  RowBox[{
                   RowBox[{"Interpolation", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Log10", "[", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Log10", "[", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "+", 
                    SuperscriptBox["10", 
                    RowBox[{"-", "90"}]]}], "]"}]}], "}"}], "&"}], "/@", 
                    RowBox[{"NdiffData", "[", "prod", "]"}]}], ",", 
                    RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], 
                   "[", 
                   RowBox[{"Log10", "[", "X", "]"}], "]"}]}], "]"}], ",", 
                "0"}], "]"}]}]}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"prod", ",", "ProductionList"}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"NdiffInt", "[", 
          RowBox[{"X_", ",", "\"\<Total\>\""}], "]"}], "=", 
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{"NdiffInt", "[", 
            RowBox[{"X", ",", "prod"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"prod", ",", "prodlisttemp"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"LegendList", "=", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"{", "\"\<Total\>\"", "}"}], ",", "prodlisttemp"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"QuantityMinMax", "=", 
         RowBox[{
          RowBox[{"Flatten", "[", 
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"MinMax", "[", 
               RowBox[{
                RowBox[{"NdiffData", "[", "prod", "]"}], "[", 
                RowBox[{"[", 
                 RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"prod", ",", "prodlisttemp"}], "}"}]}], "]"}], ",", 
            "1"}], "]"}], "//", "MinMax"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"ValueMinMax", "=", 
         RowBox[{"Max", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Max", "[", 
             RowBox[{
              RowBox[{"NdiffData", "[", "#", "]"}], "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}], "&"}], "/@", 
           "prodlisttemp"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"NdiffInt", "[", 
             RowBox[{"X", ",", "prod"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"prod", ",", "LegendList"}], "}"}]}], "]"}], ",", 
          "LegendList", ",", "QuantityMinMax", ",", "ValueMinMax"}], 
         "}"}]}]}], "\[IndentingNewLine]", "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"mvaltest", "=", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"FacilityGivenExperiment", "==", "\"\<ESS\>\""}], ",", "0.04", 
       ",", "0.2"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"couplingvaltest", "=", 
     RowBox[{"1.4", 
      RowBox[{"LowerBoundEstimate", "[", 
       RowBox[{"mvaltest", ",", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"FacilityGivenExperiment", "==", "\"\<ESS\>\""}], ",", 
          "\"\<PiCharged\>\"", ",", "\"\<D\>\""}], "]"}]}], "]"}]}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"quantity", "=", "\"\<\!\(\*SubscriptBox[\(E\), \(X\)]\)\>\""}], 
    ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"NdiffTab", "[", "X_", "]"}], ",", "LegendList", ",", 
       "QuantityMinMax", ",", "ValueMinMax"}], "}"}], "=", 
     RowBox[{"NeventsDifferentialDiscret", "[", 
      RowBox[{"mvaltest", ",", "couplingvaltest", ",", "quantity"}], "]"}]}], 
    ";", "\[IndentingNewLine]", 
    RowBox[{"Do", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"prch", "=", 
        RowBox[{"LegendList", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"NdiffInt", "[", 
         RowBox[{"X_", ",", "prch"}], "]"}], "=", 
        RowBox[{
         RowBox[{"NdiffTab", "[", "X", "]"}], "[", 
         RowBox[{"[", "i", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", 
        RowBox[{"Length", "[", "LegendList", "]"}]}], "}"}]}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"plotdiff", "=", 
     RowBox[{"LogLogPlot", "[", 
      RowBox[{
       RowBox[{"Evaluate", "[", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"NdiffInt", "[", 
           RowBox[{"X", ",", "prod"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"prod", ",", "LegendList"}], "}"}]}], "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"X", ",", 
         RowBox[{"QuantityMinMax", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", 
         RowBox[{"QuantityMinMax", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"Frame", "\[Rule]", "True"}], ",", 
       RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
       RowBox[{"PlotRange", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"All", ",", 
          RowBox[{"{", 
           RowBox[{
            SuperscriptBox["10", 
             RowBox[{"-", "5"}]], ",", 
            RowBox[{"2", "ValueMinMax"}]}], "}"}]}], "}"}]}], ",", 
       RowBox[{"PlotStyle", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"Thick", ",", "Black"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"Thick", ",", "Blue"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"Thick", ",", 
            RowBox[{"Darker", "@", "Red"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"Thick", ",", 
            RowBox[{"Darker", "@", 
             RowBox[{"Darker", "@", "Green"}]}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"Thick", ",", 
            RowBox[{"Darker", "@", "Cyan"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"Thick", ",", "Magenta"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"Thick", ",", "Blue", ",", 
            RowBox[{"Dashing", "[", "0.02", "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"Thick", ",", 
            RowBox[{"Darker", "@", "Red"}], ",", 
            RowBox[{"Dashing", "[", "0.02", "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"Thick", ",", 
            RowBox[{"Darker", "@", 
             RowBox[{"Darker", "@", "Green"}]}], ",", 
            RowBox[{"Dashing", "[", "0.02", "]"}]}], "}"}]}], "}"}]}], ",", 
       RowBox[{"PlotLegends", "\[Rule]", 
        RowBox[{"Placed", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Style", "[", 
             RowBox[{"#", ",", "20"}], "]"}], "&"}], "/@", "LegendList"}], 
          ",", "Right"}], "]"}]}], ",", 
       RowBox[{"FrameLabel", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"LegendX", "[", "quantity", "]"}], " ", ",", 
          RowBox[{"LegendY", "[", "quantity", "]"}]}], "}"}]}], ",", 
       RowBox[{"FrameStyle", "\[Rule]", 
        RowBox[{"Directive", "[", 
         RowBox[{"Black", ",", " ", "18"}], "]"}]}], ",", 
       RowBox[{"PlotLabel", "\[Rule]", 
        RowBox[{"Style", "[", 
         RowBox[{
          RowBox[{"Row", "[", 
           RowBox[{"{", 
            RowBox[{
            "SelectedExperiment", ",", 
             "\"\<. \!\(\*SubscriptBox[\(m\), \(N\)]\) = \>\"", ",", 
             "mvaltest", ",", 
             "\"\< GeV, \!\(\*SuperscriptBox[\(U\), \(2\)]\) = \>\"", ",", 
             RowBox[{"couplingvaltest", "//", "N"}]}], "}"}], "]"}], ",", 
          "14", ",", "Black"}], "]"}]}]}], "]"}]}]}]}], "\[IndentingNewLine]",
   "]"}]], "Input",
 CellChangeTimes->{{3.8921163996135225`*^9, 3.8921164016036096`*^9}, {
   3.8921164560955544`*^9, 3.892116475031265*^9}, {3.892116516434699*^9, 
   3.8921165782759094`*^9}, {3.8921166461579666`*^9, 
   3.8921166470109124`*^9}, {3.8921167042134895`*^9, 3.892116729930051*^9}, {
   3.8927049818255663`*^9, 3.8927049991222277`*^9}, {3.8929115471019087`*^9, 
   3.892911593659387*^9}, {3.8929721720425777`*^9, 3.892972173350433*^9}, {
   3.8929722208773427`*^9, 3.8929722211847763`*^9}, {3.8932578131000147`*^9, 
   3.893257813645747*^9}, {3.8934746693595037`*^9, 3.893474675301323*^9}, {
   3.8935154039618015`*^9, 3.893515450284458*^9}, {3.893515943430369*^9, 
   3.893515962817915*^9}, 3.893516005738713*^9, {3.893516036174548*^9, 
   3.893516050479193*^9}, {3.893516088577403*^9, 3.893516089018369*^9}, {
   3.893516189974946*^9, 3.8935161902213464`*^9}, {3.8935162352543807`*^9, 
   3.8935162734266047`*^9}, {3.893516595793399*^9, 3.893516611219179*^9}, {
   3.893606026577932*^9, 3.8936060575609436`*^9}, 3.8955578364377675`*^9, {
   3.8969794021337876`*^9, 3.89697940417612*^9}, {3.897206579842867*^9, 
   3.897206594529684*^9}, {3.9026499642485466`*^9, 3.902649964280243*^9}, {
   3.902768965184558*^9, 3.9027689658101315`*^9}, {3.9028039373256345`*^9, 
   3.9028039391298485`*^9}, 3.913801457980942*^9, 3.9138022076639795`*^9, {
   3.9138038039049544`*^9, 3.913803837477624*^9}, 3.913805481790023*^9, {
   3.91388501983529*^9, 3.913885024234318*^9}, 3.9138852668782845`*^9, {
   3.914514554104908*^9, 3.914514572287768*^9}, {3.9146690527581024`*^9, 
   3.9146690530777807`*^9}, {3.9149229876233425`*^9, 
   3.9149229901467905`*^9}, {3.914924832848338*^9, 3.9149248460506706`*^9}, {
   3.915642738594464*^9, 3.915642738662793*^9}, {3.915817983571703*^9, 
   3.9158179858039455`*^9}, 3.9159044611145706`*^9, {3.9159067643708715`*^9, 
   3.915906764748571*^9}, {3.9166783359273973`*^9, 3.9166783584918566`*^9}, {
   3.916678887775793*^9, 3.916678917327662*^9}, {3.91667904200069*^9, 
   3.916679052152303*^9}, {3.9168085561043787`*^9, 3.9168086405122657`*^9}, {
   3.9168088082923408`*^9, 3.916808830547592*^9}, 3.916808991549388*^9, 
   3.916809118280636*^9, 3.916855062831204*^9, {3.9506865118775444`*^9, 
   3.950686526030882*^9}},
 CellTags->{
  "Number-of-events-computation+sensitivity", "Acceptance-computation"},
 CellLabel->
  "In[116]:=",ExpressionUUID->"cb90c87c-f03c-424d-b49a-66ae1ce879f0"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Tests", "Section",
 CellChangeTimes->{{3.8972012736109533`*^9, 3.897201275449023*^9}, {
  3.916678250587083*^9, 
  3.916678251343342*^9}},ExpressionUUID->"52ce57d0-f982-4567-bb71-\
be778a9c5b79"],

Cell[CellGroupData[{

Cell["Total number of events", "Subsection",
 CellChangeTimes->{{3.8972050850842867`*^9, 3.897205097581136*^9}, {
  3.9058408064511366`*^9, 3.9058408128973536`*^9}, {3.916678312246011*^9, 
  3.916678314753111*^9}},ExpressionUUID->"291df21e-e39d-48d1-9816-\
af096ec7783f"],

Cell[BoxData[
 RowBox[{"If", "[", 
  RowBox[{"condcontinue", ",", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "This", " ", "is", " ", "a", " ", "comparison", " ", "between", " ", 
      "the", " ", "slow", " ", "and", " ", "fast", " ", "integration", " ", 
      RowBox[{"methods", ".", " ", "For"}], " ", "the", " ", "selected", " ", 
      "mass", " ", "and", " ", "production", " ", "channel"}], ",", " ", 
     RowBox[{
     "the", " ", "numbers", " ", "of", " ", "events", " ", "obtained", " ", 
      "using", " ", "the", " ", "methods", " ", "should", " ", "agree", " ", 
      "within", " ", "10", "%"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"If", " ", "the", " ", "agreement", " ", "is", " ", "worse"}], 
     ",", " ", 
     RowBox[{
     "there", " ", "may", " ", "be", " ", "a", " ", "few", " ", "reasons"}]}],
     "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"1", ")"}], " ", "The", " ", "grid", " ", "for", " ", "the", 
      " ", "fast", " ", "method", " ", "is", " ", "not", " ", "dense", " ", 
      RowBox[{"enough", ".", " ", "Try"}], " ", "to", " ", "increase", " ", 
      "the", " ", "grid", " ", "density", " ", 
      RowBox[{"(", 
       RowBox[{
       "OutGrid\[Theta]final", ",", " ", "OutGridEfinal", ",", " ", 
        "OutGridzfinal"}], ")"}], " ", "to", " ", "see", " ", "whether", " ", 
      "the", " ", "agreement", " ", 
      RowBox[{"improves", ".", " ", "Sometimes"}]}], ",", " ", 
     RowBox[{
     "even", " ", "a", " ", "slightly", " ", "denser", " ", "grid", " ", 
      "for", " ", 
      RowBox[{"e", ".", "g", ".", " ", "z"}], " ", "may", " ", "lead", " ", 
      "to", " ", "a", " ", "significant", " ", "improvement", " ", "in", " ", 
      "the", " ", "agrement"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"2", ")"}], " ", "The", " ", "Monte"}], "-", 
       RowBox[{
       "Carlo", " ", "integrator", " ", "for", " ", "the", " ", "slow", " ", 
        "method", " ", "fails", " ", "to", " ", "evaluate", " ", 
        "properly"}]}], ";", " ", 
      RowBox[{
      "this", " ", "may", " ", "happen", " ", "if", " ", "the", " ", "range", 
       " ", "of", " ", "the", " ", "integration", " ", "over", " ", 
       "energies", " ", "is", " ", "too", " ", "large", " ", "compared", " ", 
       "to", " ", "the", " ", "domain", " ", "where", " ", "most", " ", "of", 
       " ", "the", " ", "events", " ", "actually", " ", "are", " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"off", "-", 
          RowBox[{
          "axis", " ", "experiments", " ", "such", " ", "as", " ", "MATHUSLA",
            " ", "and", " ", "ANUBIS"}]}], ")"}], ".", " ", "Another"}], " ", 
       "symptom", " ", "is", " ", "that", " ", "for", " ", "the", " ", 
       "given", " ", "mass", " ", "and", " ", "coupling", " ", "the", " ", 
       "integral", " ", "\"\<jumps\>\""}]}], ",", " ", 
     RowBox[{"i", ".", "e", "."}], ",", " ", 
     RowBox[{
     "returns", " ", "values", " ", "with", " ", "large", " ", "error"}]}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "A", " ", "separate", " ", "discussion", " ", "should", " ", "be", " ", 
      "made", " ", "for", " ", "the", " ", "couplings", " ", "belong", " ", 
      "to", " ", "the", " ", "domain", " ", "c\[Tau]", " ", "\[Gamma]", " ", 
      RowBox[{
       RowBox[{"<<", " ", 
        SubscriptBox["z", "experiment"]}], ".", " ", "The"}], " ", 
      "discrepancy", " ", "may", " ", "be", " ", "significant"}], ",", " ", 
     RowBox[{
     "and", " ", "the", " ", "reason", " ", "is", " ", "insufficient", " ", 
      "grid", " ", "density", " ", "for", " ", "the", " ", "fast", " ", 
      "integration", " ", 
      RowBox[{"method", ".", " ", "However"}]}], ",", " ", 
     RowBox[{
     "due", " ", "to", " ", "the", " ", "exponential", " ", "suppression", 
      " ", "of", " ", "the", " ", "number", " ", "of", " ", "events"}], ",", 
     " ", 
     RowBox[{
     "this", " ", "may", " ", "be", " ", "compensated", " ", "by", " ", "a", 
      " ", "tiny", " ", "shift", " ", "in", " ", "the", " ", "coupling"}], 
     ",", " ", 
     RowBox[{
     "so", " ", "the", " ", "discrepancy", " ", "should", " ", "be", " ", 
      "considered", " ", "as", " ", 
      RowBox[{"appropriate", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"MemberQ", "[", 
       RowBox[{"ProductionList", ",", "\"\<mu\>\""}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ProdTest", "=", "\"\<mu\>\""}], ";", "\[IndentingNewLine]", 
       RowBox[{"mtest", "=", "0.02"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ProdTest", "=", "\"\<D\>\""}], ";", "\[IndentingNewLine]", 
       RowBox[{"mtest", "=", "0.43"}]}]}], "\[IndentingNewLine]", "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"U2list", "=", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         SuperscriptBox["10", 
          RowBox[{"-", "12"}]], ",", 
         RowBox[{"3", "*", 
          SuperscriptBox["10", 
           RowBox[{"-", "12"}]]}], ",", 
         RowBox[{"5", "*", 
          SuperscriptBox["10", 
           RowBox[{"-", "12"}]]}], ",", 
         SuperscriptBox["10", 
          RowBox[{"-", "11"}]], ",", 
         RowBox[{"5", "*", 
          SuperscriptBox["10", 
           RowBox[{"-", "11"}]]}], ",", 
         SuperscriptBox["10", 
          RowBox[{"-", "10"}]], ",", 
         RowBox[{"5", "*", 
          SuperscriptBox["10", 
           RowBox[{"-", "10"}]]}], ",", 
         SuperscriptBox["10", 
          RowBox[{"-", "9"}]], ",", 
         RowBox[{"5", "*", 
          SuperscriptBox["10", 
           RowBox[{"-", "9"}]]}], ",", 
         SuperscriptBox["10", 
          RowBox[{"-", "8"}]], ",", 
         RowBox[{"2", "*", 
          SuperscriptBox["10", 
           RowBox[{"-", "8"}]]}], ",", 
         RowBox[{"4", "*", 
          SuperscriptBox["10", 
           RowBox[{"-", "8"}]]}], ",", 
         SuperscriptBox["10", 
          RowBox[{"-", "7"}]], ",", 
         RowBox[{"5", "*", 
          SuperscriptBox["10", 
           RowBox[{"-", "7"}]]}], ",", 
         RowBox[{"6", "*", 
          SuperscriptBox["10", 
           RowBox[{"-", "7"}]]}], ",", 
         RowBox[{"7", "*", 
          SuperscriptBox["10", 
           RowBox[{"-", "7"}]]}], ",", 
         RowBox[{"8", "*", 
          SuperscriptBox["10", 
           RowBox[{"-", "7"}]]}], ",", 
         RowBox[{"9", "*", 
          SuperscriptBox["10", 
           RowBox[{"-", "7"}]]}], ",", 
         SuperscriptBox["10", 
          RowBox[{"-", "6"}]], ",", 
         RowBox[{"2", "*", 
          SuperscriptBox["10", 
           RowBox[{"-", "6"}]]}]}], "}"}], "//", "N"}], "*)"}], 
     RowBox[{"Table", "[", 
      RowBox[{
       SuperscriptBox["10", "x"], ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", 
         RowBox[{"-", "12."}], ",", 
         RowBox[{"-", "1.5"}], ",", "0.1"}], "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"dat1", "=", 
     RowBox[{"NeventsDiscret", "[", 
      RowBox[{"mtest", ",", "ProdTest", ",", "U2list"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"dat2", "=", 
     RowBox[{"ParallelTable", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"U2list", "[", 
          RowBox[{"[", "i", "]"}], "]"}], ",", 
         RowBox[{"c\[Tau]LLP", "[", 
          RowBox[{"mtest", ",", 
           RowBox[{"U2list", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
         RowBox[{"Quiet", "[", 
          RowBox[{"NeventsInt", "[", 
           RowBox[{"mtest", ",", 
            RowBox[{"U2list", "[", 
             RowBox[{"[", "i", "]"}], "]"}], ",", "ProdTest"}], "]"}], 
          "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "U2list", "]"}], ",", "1"}], "}"}]}], "]"}]}],
     ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{
         "\"\<\!\(\*FractionBox[SubscriptBox[\(m\), \(LLP\)], \(GeV\)]\)\>\"",
           ",", "\"\<coupling\>\"", ",", 
          "\"\<\!\(\*FractionBox[\(c\[Tau]\), SubscriptBox[\(z\), \(min\)]]\)\
\>\"", ",", "\"\<\!\(\*SubscriptBox[\(N\), \(events, fast\)]\)\>\"", ",", 
          "\"\<\!\(\*SubscriptBox[\(N\), \(events, slow\)]\)\>\""}], "}"}], 
        "}"}], ",", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"dat1", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", "2"}], "}"}]}], "]"}], "]"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            FractionBox[
             RowBox[{"#", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "zminExp"], "}"}], "&"}], "/@", 
          "dat2"}], ",", 
         RowBox[{"dat1", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", 
            RowBox[{"{", "3", "}"}]}], "]"}], "]"}], ",", 
         RowBox[{"dat2", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", 
            RowBox[{"{", "3", "}"}]}], "]"}], "]"}], ",", "2"}], "]"}]}], 
      "]"}], "//", "TableForm"}]}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.9149218806070967`*^9, 3.9149218831762066`*^9}, {
   3.9149222143401403`*^9, 3.9149222652191677`*^9}, {3.91492251234492*^9, 
   3.914922523246348*^9}, {3.914922555466846*^9, 3.9149225923642654`*^9}, 
   3.9149226371808214`*^9, {3.9149227027481656`*^9, 3.914922747983374*^9}, {
   3.9149232867635098`*^9, 3.9149233117272797`*^9}, {3.914923391174813*^9, 
   3.914923392320099*^9}, 3.9149234542857304`*^9, {3.9149258501553135`*^9, 
   3.9149258724447126`*^9}, {3.9156427385265675`*^9, 
   3.9156427385295663`*^9}, {3.9158143249385524`*^9, 
   3.9158143250084887`*^9}, {3.9506865313083096`*^9, 3.950686540060686*^9}},
 CellLabel->
  "In[509]:=",ExpressionUUID->"ab7b5982-2d2a-4e03-a4a9-eb782d90bec0"]
}, Closed]]
}, Closed]]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Exporting tabulated number of events", "Title",
 CellChangeTimes->{{3.8850207904521627`*^9, 3.885020796464762*^9}},
 CellTags->
  "Number-of-events-computation+sensitivity",ExpressionUUID->"d9cc7f48-090a-\
4576-84bf-78e61b4f24e1"],

Cell[CellGroupData[{

Cell["Definitions", "Chapter",
 CellChangeTimes->{{3.8850542017641125`*^9, 3.885054203349573*^9}},
 CellTags->
  "Number-of-events-computation+sensitivity",ExpressionUUID->"2954a636-16b9-\
43d9-baa5-a2a8079c668c"],

Cell[BoxData[
 RowBox[{"If", "[", 
  RowBox[{"condcontinue", ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"directory", "[", "\"\<Nevents\>\"", "]"}], "=", 
     RowBox[{"FileNameJoin", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"NotebookDirectory", "[", "]"}], ",", 
        "\"\<Tabulated Nevents\>\""}], "}"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"directory", "[", "\"\<Nevents-LLP\>\"", "]"}], "=", 
     RowBox[{"FileNameJoin", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"NotebookDirectory", "[", "]"}], ",", 
        "\"\<Tabulated Nevents\>\"", ",", "LLPdirName"}], "}"}], "]"}]}], ";",
     "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"directory", "[", "\"\<Nevents-LLP-experiment\>\"", "]"}], "=", 
     RowBox[{"FileNameJoin", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"NotebookDirectory", "[", "]"}], ",", 
        "\"\<Tabulated Nevents\>\"", ",", "LLPdirName", ",", 
        "SelectedExperiment"}], "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"!", 
         RowBox[{"DirectoryQ", "[", 
          RowBox[{"directory", "[", "#", "]"}], "]"}]}], ",", 
        RowBox[{"CreateDirectory", "[", 
         RowBox[{"directory", "[", "#", "]"}], "]"}]}], "]"}], "&"}], "/@", 
     RowBox[{"{", 
      RowBox[{
      "\"\<Nevents\>\"", ",", "\"\<Nevents-LLP\>\"", ",", 
       "\"\<Nevents-LLP-experiment\>\""}], "}"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
     "Print", "[", 
      "\"\<List of filenames with exported tabulated number of events\>\"", 
      "]"}], "\[IndentingNewLine]", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"FilenameNeventsInt", "[", "prod", "]"}], "=", 
        RowBox[{"ToString", "@", 
         RowBox[{"StringForm", "[", 
          RowBox[{
          "\"\<Nevents_HNL_MixingPattern_``-``-``_type_``_at_``_Npot=``_From_`\
`_decayDescr=``.dat\>\"", ",", 
           RowBox[{"Sequence", "@@", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"ToString", "[", 
               RowBox[{"MixingPattern", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
              RowBox[{"ToString", "[", 
               RowBox[{"MixingPattern", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", 
              RowBox[{"ToString", "[", 
               RowBox[{"MixingPattern", "[", 
                RowBox[{"[", "3", "]"}], "]"}], "]"}], ",", "HNLtype", ",", 
              "SelectedExperiment", ",", 
              RowBox[{
               RowBox[{"NpotGivenExperiment", "//", "CForm"}], "//", 
               "ToString"}], ",", "prod", ",", "decayDescr"}], "}"}]}]}], 
          "]"}]}]}], ",", 
       RowBox[{"{", 
        RowBox[{"prod", ",", "ProductionList"}], "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"mRangeExport", "[", "\"\<K\>\"", "]"}], "=", 
     RowBox[{"Table", "[", 
      RowBox[{"mx", ",", 
       RowBox[{"{", 
        RowBox[{"mx", ",", "0.051", ",", "0.495", ",", "0.02"}], "}"}]}], 
      "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"mRangeExport", "[", "\"\<D\>\"", "]"}], "=", 
     RowBox[{
      RowBox[{
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{"mx", ",", 
           RowBox[{"{", 
            RowBox[{"mx", ",", "0.051", ",", "1.951", ",", "0.02"}], "}"}]}], 
          "]"}], ",", 
         RowBox[{"{", 
          RowBox[{
          "0.161", ",", "0.141", ",", "0.131", ",", "0.171", ",", "0.184", 
           ",", "0.188", ",", "0.181", ",", "0.191", ",", "0.201"}], "}"}]}], 
        "]"}], "//", "Sort"}], "//", "DeleteDuplicates"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"mRangeExport", "[", "\"\<B\>\"", "]"}], "=", 
     RowBox[{"Table", "[", 
      RowBox[{"mx", ",", 
       RowBox[{"{", 
        RowBox[{"mx", ",", "0.051", ",", "6.301", ",", "0.02"}], "}"}]}], 
      "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"mRangeExport", "[", "\"\<W\>\"", "]"}], "=", 
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{"mx", ",", 
         RowBox[{"{", 
          RowBox[{"mx", ",", "0.051", ",", "3.301", ",", "0.02"}], "}"}]}], 
        "]"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{"mx", ",", 
         RowBox[{"{", 
          RowBox[{"mx", ",", "3.35", ",", "10", ",", "0.05"}], "}"}]}], "]"}],
        ",", 
       RowBox[{"Table", "[", 
        RowBox[{"mx", ",", 
         RowBox[{"{", 
          RowBox[{"mx", ",", "10.1", ",", "20.", ",", "0.1"}], "}"}]}], 
        "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"FacilityGivenExperiment", "==", "\"\<ESS\>\""}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"mRangeExport", "[", "\"\<mu\>\"", "]"}], "=", 
        RowBox[{"10", "^", 
         RowBox[{
          RowBox[{"GridInFinal", "[", "\"\<mu\>\"", "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"mRangeExport", "[", "\"\<PiCharged\>\"", "]"}], "=", 
        RowBox[{"10", "^", 
         RowBox[{
          RowBox[{"GridInFinal", "[", "\"\<PiCharged\>\"", "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}]}], ";"}]}], "\[IndentingNewLine]", 
     "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"couplingsRangeExport", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       SuperscriptBox["10", "x"], ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", 
         RowBox[{"-", "13"}], ",", 
         RowBox[{"-", "3"}], ",", "0.03"}], "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"FilenameNeventsInt", "[", "prod", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"prod", ",", "ProductionList"}], "}"}]}], "]"}], "//", 
     "TableForm"}]}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.8850528402073092`*^9, 3.885052964529935*^9}, {
   3.8850529967024455`*^9, 3.88505313318991*^9}, {3.885053172661522*^9, 
   3.885053247354876*^9}, {3.885053717249408*^9, 3.8850537696983976`*^9}, {
   3.885054057416253*^9, 3.88505420740788*^9}, {3.8850542428480587`*^9, 
   3.885054257815028*^9}, {3.885054905514982*^9, 3.885054927992525*^9}, {
   3.88523276755499*^9, 3.885232776819412*^9}, {3.885455723827387*^9, 
   3.885455752199112*^9}, {3.8860943280607367`*^9, 3.88609453355086*^9}, {
   3.886095483621874*^9, 3.8860955126810937`*^9}, {3.886127990264927*^9, 
   3.88612799141245*^9}, 3.888642888624179*^9, {3.8927050133604655`*^9, 
   3.8927050485447173`*^9}, {3.89270509762475*^9, 3.8927051590738735`*^9}, {
   3.8927051996590557`*^9, 3.892705244059099*^9}, {3.892972242768362*^9, 
   3.8929722651603527`*^9}, {3.895054416512721*^9, 3.89505442773033*^9}, {
   3.895129365318982*^9, 3.8951293726690607`*^9}, {3.8951295427032895`*^9, 
   3.8951295742143564`*^9}, {3.9025655422778378`*^9, 
   3.9025655612003827`*^9}, {3.9061950056497498`*^9, 
   3.9061950332851324`*^9}, {3.913803837485773*^9, 3.9138038374937763`*^9}, {
   3.9138057855998926`*^9, 3.9138058967007685`*^9}, {3.9138059356698895`*^9, 
   3.913805937919997*^9}, 3.9138286011730747`*^9, {3.913829719471092*^9, 
   3.9138297339247804`*^9}, {3.9145145196867995`*^9, 
   3.9145145196897917`*^9}, {3.914514779439704*^9, 3.9145147794425545`*^9}, {
   3.9149273094453278`*^9, 3.914927313703643*^9}, {3.914927344988434*^9, 
   3.9149274097643027`*^9}, {3.9156427389103327`*^9, 
   3.9156427389298787`*^9}, {3.9296156966079893`*^9, 
   3.9296157467550173`*^9}, {3.9296158820803733`*^9, 
   3.9296158874988194`*^9}, {3.94768665080884*^9, 3.9476866747829704`*^9}, 
   3.947686725734314*^9, {3.9506865464550457`*^9, 3.9506865591003723`*^9}},
 CellTags->"Number-of-events-computation+sensitivity",
 CellLabel->
  "In[117]:=",ExpressionUUID->"8c0b6592-284c-4a87-9a77-8e50d3c85c08"]
}, Closed]],

Cell[CellGroupData[{

Cell["Exporting", "Chapter",
 CellChangeTimes->{{3.885054212114191*^9, 3.885054213032151*^9}},
 CellTags->
  "Number-of-events-computation+sensitivity",ExpressionUUID->"94264685-3bea-\
4e26-b629-98b9c56f1aa5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{"condcontinue", ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"DeleteFile", "[", 
      RowBox[{"FileNames", "[", 
       RowBox[{
        RowBox[{"\"\<*\>\"", "<>", "SelectedDescr", "<>", "\"\<*\>\""}], ",", 
        RowBox[{"directory", "[", "\"\<Nevents-LLP-experiment\>\"", "]"}]}], 
       "]"}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"BlockExport", "[", "ProdChannel_", "]"}], ":=", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", "mlist", "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"mlist", "=", 
          RowBox[{"mRangeExport", "[", "ProdChannel", "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"TabFrom", "=", 
          RowBox[{"ParallelTable", "[", 
           RowBox[{
            RowBox[{"Quiet", "[", 
             RowBox[{"NeventsDiscret", "[", 
              RowBox[{
               RowBox[{"mlist", "[", 
                RowBox[{"[", "k", "]"}], "]"}], ",", "ProdChannel", ",", 
               "couplingsRangeExport"}], "]"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"k", ",", "1", ",", 
              RowBox[{"Length", "[", "mlist", "]"}], ",", "1"}], "}"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"Export", "[", 
          RowBox[{
           RowBox[{"FileNameJoin", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
              "directory", "[", "\"\<Nevents-LLP-experiment\>\"", "]"}], ",", 
              RowBox[{"FilenameNeventsInt", "[", "ProdChannel", "]"}]}], 
             "}"}], "]"}], ",", 
           RowBox[{"Flatten", "[", 
            RowBox[{"TabFrom", ",", "1"}], "]"}], ",", "\"\<Table\>\""}], 
          "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Monitor", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"prod", "=", 
           RowBox[{"ProductionList", "[", 
            RowBox[{"[", "j", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"BlockExport", "[", "prod", "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", 
           RowBox[{"Length", "[", "ProductionList", "]"}], ",", "1"}], 
          "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Row", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"ProgressIndicator", "[", 
           RowBox[{"j", ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", 
              RowBox[{"Length", "[", "ProductionList", "]"}]}], "}"}]}], 
           "]"}], ",", "\"\< Production mode = \>\"", ",", 
          RowBox[{"ProductionList", "[", 
           RowBox[{"[", "j", "]"}], "]"}], ",", "\"\< (\>\"", ",", " ", "j", 
          ",", "\"\</\>\"", ",", 
          RowBox[{"Length", "[", "ProductionList", "]"}], ",", "\"\<)\>\""}], 
         "}"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"icounter", ">", 
         RowBox[{"Length", "[", "SelectedExperimentList", "]"}]}], "&&", 
        "sensComp"}], ",", 
       RowBox[{"BlockEvaluation", "[", "\"\<Sensitivity\>\"", "]"}]}], 
      "]"}]}]}], "\[IndentingNewLine]", "]"}], "//", 
  "AbsoluteTiming"}]], "Input",
 CellChangeTimes->{{3.8921886102299604`*^9, 3.892188661864987*^9}, {
   3.892188696661598*^9, 3.892188782889353*^9}, {3.8921888713769283`*^9, 
   3.8921888914281387`*^9}, {3.892190937661848*^9, 3.8921909466626697`*^9}, {
   3.8922765048644934`*^9, 3.8922765048725324`*^9}, {3.892541051864915*^9, 
   3.8925411081031237`*^9}, {3.8925422299627275`*^9, 
   3.8925422591259813`*^9}, {3.892542627960807*^9, 3.8925426356350746`*^9}, {
   3.8927052313065047`*^9, 3.892705270088846*^9}, {3.8927053287465887`*^9, 
   3.8927053297156878`*^9}, {3.895077832600239*^9, 3.895077843762785*^9}, 
   3.9138038375067987`*^9, 3.913805957901049*^9, {3.913806044661635*^9, 
   3.913806057909132*^9}, {3.9138063931202383`*^9, 3.9138063951264367`*^9}, {
   3.9138064565946326`*^9, 3.9138065980596933`*^9}, {3.9138066332400713`*^9, 
   3.913806637233926*^9}, 3.9138288098389263`*^9, {3.9138297191441827`*^9, 
   3.913829747334725*^9}, 3.9138298141524925`*^9, 3.9145145196975317`*^9, 
   3.914514779446992*^9, {3.9146680200801663`*^9, 3.914668020581179*^9}, 
   3.9156427389390125`*^9, 3.947689051293808*^9, {3.9506865760609913`*^9, 
   3.9506865969967556`*^9}, {3.9527025555403996`*^9, 3.9527025709763527`*^9}},
 CellTags->
  "Number-of-events-computation+sensitivity",ExpressionUUID->"d8897b55-8608-\
4f93-a9b8-e4eb10318129"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Computing sensitivities", "Title",
 CellChangeTimes->{{3.885020809493571*^9, 3.88502081261261*^9}},
 CellTags->
  "Sensitivity",ExpressionUUID->"02de58fe-c9d7-4ae0-8388-b0795f1824e0"],

Cell[CellGroupData[{

Cell["Basic definitions", "Chapter",
 CellChangeTimes->{{3.9138314745388813`*^9, 3.913831477098402*^9}},
 CellTags->
  "Sensitivity",ExpressionUUID->"658980e6-d3df-4043-b231-c05500456be9"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"LLPdirName", "=", "\"\<HNL\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"directory", "[", "\"\<Sensitivity\>\"", "]"}], "=", 
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"NotebookDirectory", "[", "]"}], ",", 
      "\"\<Sensitivity domains\>\""}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"directory", "[", "\"\<Sensitivity-LLP\>\"", "]"}], "=", 
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"directory", "[", "\"\<Sensitivity\>\"", "]"}], ",", 
      "LLPdirName"}], "}"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"!", 
       RowBox[{"DirectoryQ", "[", 
        RowBox[{"directory", "[", "#", "]"}], "]"}]}], ",", 
      RowBox[{"CreateDirectory", "[", 
       RowBox[{"directory", "[", "#", "]"}], "]"}]}], "]"}], "&"}], "/@", 
   RowBox[{"{", 
    RowBox[{"\"\<Sensitivity\>\"", ",", "\"\<Sensitivity-LLP\>\""}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"directory", "[", "\"\<Nevents-LLP\>\"", "]"}], "=", 
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"NotebookDirectory", "[", "]"}], ",", 
      "\"\<Tabulated Nevents\>\"", ",", "LLPdirName"}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dropdownDialog", "[", 
   RowBox[{"list_", ",", "phrase_"}], "]"}], ":=", 
  RowBox[{"DialogInput", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"choice", "=", "\"\<\>\""}], "}"}], ",", 
    RowBox[{"Column", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"TextCell", "[", "phrase", "]"}], ",", 
       RowBox[{"PopupMenu", "[", 
        RowBox[{
         RowBox[{"Dynamic", "[", "choice", "]"}], ",", "list"}], "]"}], ",", 
       RowBox[{"Button", "[", 
        RowBox[{"\"\<OK\>\"", ",", 
         RowBox[{"DialogReturn", "[", "choice", "]"}]}], "]"}]}], "}"}], 
     "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"infoDialog", "[", "phrase_", "]"}], ":=", 
  RowBox[{"DialogInput", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"choice", "=", "\"\<\>\""}], "}"}], ",", 
    RowBox[{"Column", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"TextCell", "[", "phrase", "]"}], ",", 
       RowBox[{"Button", "[", 
        RowBox[{"\"\<Proceed\>\"", ",", 
         RowBox[{"DialogReturn", "[", "choice", "]"}]}], "]"}]}], "}"}], 
     "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"selectionDialog", "[", 
   RowBox[{"list_", ",", "phrase_"}], "]"}], ":=", 
  RowBox[{"DialogInput", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"choice", "=", 
      RowBox[{"{", "}"}]}], "}"}], ",", 
    RowBox[{"Column", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Row", "[", 
        RowBox[{"{", "phrase", "}"}], "]"}], ",", 
       RowBox[{"Pane", "[", 
        RowBox[{
         RowBox[{"TogglerBar", "[", 
          RowBox[{
           RowBox[{"Dynamic", "[", "choice", "]"}], ",", "list", ",", 
           RowBox[{"Appearance", "->", 
            RowBox[{"\"\<Vertical\>\"", "->", 
             RowBox[{"{", 
              RowBox[{"Automatic", ",", "5"}], "}"}]}]}]}], "]"}], ",", 
         RowBox[{"ImageSize", "->", 
          RowBox[{"{", 
           RowBox[{"Automatic", ",", "Automatic"}], "}"}]}], ",", 
         RowBox[{"Scrollbars", "->", 
          RowBox[{"{", 
           RowBox[{"False", ",", "True"}], "}"}]}]}], "]"}], ",", 
       RowBox[{"Button", "[", 
        RowBox[{"\"\<OK\>\"", ",", 
         RowBox[{"DialogReturn", "[", "choice", "]"}]}], "]"}]}], "}"}], 
     "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ExperimentDirectoriesListNevents", "=", 
   RowBox[{"Select", "[", 
    RowBox[{
     RowBox[{"FileNames", "[", 
      RowBox[{"\"\<*\>\"", ",", 
       RowBox[{"directory", "[", "\"\<Nevents-LLP\>\"", "]"}], ",", "1"}], 
      "]"}], ",", "DirectoryQ"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{
  "\"\<List of available experiments with tabulated \!\(\*SubscriptBox[\(N\), \
\(events\)]\) for \>\"", " ", "<>", "LLPdirName", "<>", "\"\<:\>\""}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ExperimentsListNevents", "=", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"FileNameTake", "[", 
       RowBox[{
        RowBox[{"ExperimentDirectoriesListNevents", "[", 
         RowBox[{"[", "i", "]"}], "]"}], ",", 
        RowBox[{"-", "1"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", 
        RowBox[{"Length", "[", "ExperimentDirectoriesListNevents", "]"}], ",",
         "1"}], "}"}]}], "]"}], "//", "Sort"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"ExperimentsListNevents", "//", "TableForm"}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Length", "[", "ExperimentsListNevents", "]"}], "\[Equal]", "0"}],
    ",", 
   RowBox[{
   "Print", "[", 
    "\"\<No experiment is available, generate first the acceptance for the \
given experiment using module 1\>\"", "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SelectedExperimentList", "=", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "ExperimentsListNevents", "]"}], "\[NotEqual]",
         "0"}], ",", 
       RowBox[{"selectionDialog", "[", 
        RowBox[{
        "ExperimentsListNevents", ",", 
         "\"\<Select the experiments for which the sensitivity will be \
computed:\>\""}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"Print", "[", 
     RowBox[{"Row", "[", 
      RowBox[{"{", "SelectedExperimentList", "}"}], "]"}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"icounter", "=", "1"}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"BlockEvaluation", "[", "tag_", "]"}], ":=", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"nb", "=", 
         RowBox[{"EvaluationNotebook", "[", "]"}]}], ";", "\n", 
        RowBox[{"NotebookFind", "[", 
         RowBox[{"nb", ",", "tag", ",", "All", ",", "CellTags"}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"SelectionEvaluate", "[", "nb", "]"}]}]}], 
      "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"Do", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{
       "BlockEvaluation", "[", "\"\<Sensitivity-computation\>\"", "]"}], 
       ";"}], "\[IndentingNewLine]", ",", 
      RowBox[{"{", 
       RowBox[{"icounter", ",", "1", ",", 
        RowBox[{"Length", "[", "SelectedExperimentList", "]"}], ",", "1"}], 
       "}"}]}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}], "Input",
 CellChangeTimes->{{3.9138315400875525`*^9, 3.91383154039198*^9}, {
   3.9138315903690352`*^9, 3.9138315935704455`*^9}, {3.913964957878894*^9, 
   3.913964958107614*^9}, 3.914668012477874*^9, {3.914668205307027*^9, 
   3.9146682056642895`*^9}, {3.914668587304762*^9, 3.9146685899057875`*^9}, 
   3.914668897552519*^9, {3.915262725158492*^9, 3.915262725490936*^9}, {
   3.9156427389521217`*^9, 3.91564273897951*^9}, 3.9158185114041615`*^9, {
   3.947729085010433*^9, 3.9477290915442104`*^9}, {3.947731945646055*^9, 
   3.947731947401724*^9}, {3.9477328403749294`*^9, 3.9477328507873554`*^9}, {
   3.947746050832041*^9, 3.947746052813963*^9}},
 CellTags->"Sensitivity",
 CellLabel->
  "In[211]:=",ExpressionUUID->"4445aaea-e6ea-488d-a991-f594a83b822e"]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Specifying the experiment and the HNL model, importing and interpolations\
\>", "Chapter",
 CellChangeTimes->{{3.886564872549308*^9, 3.886564875387725*^9}, {
  3.886564937811318*^9, 3.886564939550208*^9}, {3.886565087181673*^9, 
  3.8865650891186666`*^9}, {3.8927054451167526`*^9, 3.892705446139044*^9}, {
  3.9139662921555433`*^9, 3.913966297051978*^9}},
 CellTags->
  "Sensitivity-computation",ExpressionUUID->"ce0499a7-0458-4fca-8906-\
49450de0903c"],

Cell[CellGroupData[{

Cell["Specifying the model of HNLs", "Section",
 CellChangeTimes->{{3.91396630162342*^9, 3.913966305506296*^9}},
 CellTags->
  "Sensitivity-computation",ExpressionUUID->"10aa4c32-023e-4786-bf5f-\
46beab483d63"],

Cell[BoxData[{
 RowBox[{"Print", "[", "\"\<Selected experiment:\>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"GivenExperimentForSensitivityComputation", "=", 
  RowBox[{"SelectedExperimentList", "[", 
   RowBox[{"[", 
    RowBox[{"icounter", "++"}], "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CondANUBIS", "=", 
   RowBox[{"MemberQ", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "\"\<ANUBIS-shaft-volume-1\>\"", ",", "\"\<ANUBIS-shaft-volume-2\>\"", 
       ",", "\"\<ANUBIS-shaft-volume-3\>\""}], "}"}], ",", 
     "GivenExperimentForSensitivityComputation"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"CondANUBIS", "\[Equal]", "True"}], ",", 
   RowBox[{"infoDialog", "[", 
    RowBox[{"Row", "[", 
     RowBox[{
     "{", "\"\<One of the modules of ANUBIS-shaft is chosen. The full \
sensitivity includes three modules. The importing will be over all modules, \
so for all ot the the sensitivity has to be computed\>\"", "}"}], "]"}], 
    "]"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"CondANUBIS", "\[Equal]", "False"}], ",", 
    RowBox[{"GivenExperimentForSensitivityComputationList", "=", 
     RowBox[{"{", "GivenExperimentForSensitivityComputation", "}"}]}], ",", 
    RowBox[{"GivenExperimentForSensitivityComputationList", "=", 
     RowBox[{"{", 
      RowBox[{
      "\"\<ANUBIS-shaft-volume-1\>\"", ",", "\"\<ANUBIS-shaft-volume-2\>\"", 
       ",", "\"\<ANUBIS-shaft-volume-3\>\""}], "}"}]}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pathsNeventsAll", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{"pathsNeventsAll", "=", 
     RowBox[{"Join", "[", 
      RowBox[{"pathsNeventsAll", ",", 
       RowBox[{"FileNames", "[", 
        RowBox[{"\"\<*.dat\>\"", ",", 
         RowBox[{"FileNameJoin", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"directory", "[", "\"\<Nevents-LLP\>\"", "]"}], ",", 
            "exp"}], "}"}], "]"}]}], "]"}]}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"exp", ",", "GivenExperimentForSensitivityComputationList"}], 
     "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FilenamesNevents", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Last", "@", 
      RowBox[{"FileNameSplit", "@", 
       RowBox[{"pathsNeventsAll", "[", 
        RowBox[{"[", "i", "]"}], "]"}]}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "pathsNeventsAll", "]"}], ",", "1"}], "}"}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FilenameParameters", "[", "i_", "]"}], ":=", 
  RowBox[{
   RowBox[{"StringCases", "[", 
    RowBox[{
     RowBox[{"FilenamesNevents", "[", 
      RowBox[{"[", "i", "]"}], "]"}], ",", 
     RowBox[{
      RowBox[{
      "\"\<Nevents_HNL_MixingPattern_\>\"", "~~", "mixinge__", "~~", 
       "\"\<-\>\"", "~~", "mixing\[Mu]__", "~~", "\"\<-\>\"", "~~", 
       "mixing\[Tau]__", "~~", "\"\<_type_\>\"", "~~", "type__", "~~", 
       "\"\<_at_\>\"", "~~", "experiment__", "~~", "\"\<_Npot=\>\"", "~~", 
       "Npot__", "~~", "\"\<_From_\>\"", "~~", "mother__", "~~", 
       "\"\<_decayDescr=\>\"", "~~", "decayDescr__", "~~", "\"\<.dat\>\""}], 
      "\[RuleDelayed]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"mixinge", "//", "ToExpression"}], ",", 
        RowBox[{"mixing\[Mu]", "//", "ToExpression"}], ",", 
        RowBox[{"mixing\[Tau]", "//", "ToExpression"}], ",", "type", ",", 
        "experiment", ",", "Npot", ",", "mother", ",", "decayDescr"}], 
       "}"}]}]}], "]"}], "[", 
   RowBox[{"[", "1", "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FilenameParametersAll", "=", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"FilenameParameters", "[", "i", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", 
        RowBox[{"Length", "[", "FilenamesNevents", "]"}], ",", "1"}], "}"}]}],
      "]"}], "//", "Sort"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TableHNLtype", "=", 
   RowBox[{"DeleteDuplicates", "[", 
    RowBox[{"FilenameParametersAll", "[", 
     RowBox[{"[", 
      RowBox[{"All", ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "2", ",", "3", ",", "4"}], "}"}]}], "]"}], "]"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Join", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{
      "\"\<\!\(\*SuperscriptBox[SubscriptBox[\(U\), \(e\)], \
\(2\)]\)/\!\(\*SuperscriptBox[\(U\), \(2\)]\)\>\"", ",", 
       "\"\<\!\(\*SuperscriptBox[SubscriptBox[\(U\), \(\[Mu]\)], \
\(2\)]\)/\!\(\*SuperscriptBox[\(U\), \(2\)]\)\>\"", ",", 
       "\"\<\!\(\*SuperscriptBox[SubscriptBox[\(U\), \(\[Tau]\)], \(2\)]\)/\!\
\(\*SuperscriptBox[\(U\), \(2\)]\)\>\"", ",", "\"\<HNL type\>\""}], "}"}], 
     "}"}], ",", "TableHNLtype"}], "]"}], "//", 
  "TableForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dataSelected", "=", 
   RowBox[{"dropdownDialog", "[", 
    RowBox[{
    "TableHNLtype", ",", 
     "\"\<Choose available HNL mixing pattern and type \
(xe,x\[Mu],x\[Tau],Type):\>\""}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", "\"\<Selected mixing pattern:\>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"SelectedMixingPattern", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{"dataSelected", "[", 
      RowBox[{"[", "1", "]"}], "]"}], "//", "ToExpression"}], ",", 
    RowBox[{
     RowBox[{"dataSelected", "[", 
      RowBox[{"[", "2", "]"}], "]"}], "//", "ToExpression"}], ",", 
    RowBox[{
     RowBox[{"dataSelected", "[", 
      RowBox[{"[", "3", "]"}], "]"}], "//", "ToExpression"}]}], 
   "}"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"patternsshorten", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"ToString", "[", 
      RowBox[{"NumberForm", "[", 
       RowBox[{"#", ",", 
        RowBox[{"{", 
         RowBox[{"Infinity", ",", "2"}], "}"}]}], "]"}], "]"}], "&"}], "/@", 
    "SelectedMixingPattern"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", "\"\<Selected type - Dirac or Majorana:\>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SelectedHNLtype", "=", 
   RowBox[{"dataSelected", "[", 
    RowBox[{"[", "4", "]"}], "]"}]}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Creating", " ", "the", " ", "directory", " ", "for", " ", "exporting", 
    " ", "sensitivity", " ", "curves"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ExperimentFolder", "=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"CondANUBIS", "\[Equal]", "True"}], ",", "\"\<ANUBIS\>\"", ",", 
     "GivenExperimentForSensitivityComputation"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"directory", "[", "\"\<Sensitivity-LLP-exp\>\"", "]"}], "=", 
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"directory", "[", "\"\<Sensitivity-LLP\>\"", "]"}], ",", 
      "ExperimentFolder"}], "}"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"!", 
     RowBox[{"DirectoryQ", "[", 
      RowBox[{"directory", "[", "\"\<Sensitivity-LLP-exp\>\"", "]"}], "]"}]}],
     ",", 
    RowBox[{"CreateDirectory", "[", 
     RowBox[{"directory", "[", "\"\<Sensitivity-LLP-exp\>\"", "]"}], "]"}]}], 
   "]"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "___", "___", "___", "___", "___", "___", "___", "___", "___", "___", 
    "___", "___", "___", "___", "___", "___", "___", "___"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Importing", " ", "and", " ", "interpolation"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "___", "___", "___", "___", "___", "___", "___", "___", "___", "___", 
    "___", "___", "___", "___", "___", "___", "___", "___"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", "\"\<Data to import:\>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ProductionInfoList", "=", 
   RowBox[{"Select", "[", 
    RowBox[{"FilenameParametersAll", ",", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"#", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "==", 
        RowBox[{"dataSelected", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], "&&", 
       RowBox[{
        RowBox[{"#", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "==", 
        RowBox[{"dataSelected", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], "&&", 
       RowBox[{
        RowBox[{"#", "[", 
         RowBox[{"[", "3", "]"}], "]"}], "==", 
        RowBox[{"dataSelected", "[", 
         RowBox[{"[", "3", "]"}], "]"}]}], "&&", 
       RowBox[{
        RowBox[{"#", "[", 
         RowBox[{"[", "4", "]"}], "]"}], "\[Equal]", 
        RowBox[{"dataSelected", "[", 
         RowBox[{"[", "4", "]"}], "]"}]}]}], "&"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Join", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{
      "\"\<\!\(\*SuperscriptBox[SubscriptBox[\(U\), \(e\)], \
\(2\)]\)/\!\(\*SuperscriptBox[\(U\), \(2\)]\)\>\"", ",", 
       "\"\<\!\(\*SuperscriptBox[SubscriptBox[\(U\), \(\[Mu]\)], \
\(2\)]\)/\!\(\*SuperscriptBox[\(U\), \(2\)]\)\>\"", ",", 
       "\"\<\!\(\*SuperscriptBox[SubscriptBox[\(U\), \(\[Tau]\)], \(2\)]\)/\!\
\(\*SuperscriptBox[\(U\), \(2\)]\)\>\"", ",", "\"\<HNL type\>\"", ",", 
       "\"\<Experiment\>\"", ",", 
       "\"\<\!\(\*SubscriptBox[\(N\), \(PoT\)]\)\>\"", ",", 
       "\"\<Mother\>\""}], "}"}], "}"}], ",", "ProductionInfoList"}], "]"}], "//",
   "TableForm"}]}], "Input",
 CellChangeTimes->{{3.8865649067496457`*^9, 3.88656508233171*^9}, {
   3.8872798363330927`*^9, 3.8872798374280677`*^9}, 3.888895664352442*^9, {
   3.888895713983474*^9, 3.8888957215017242`*^9}, 3.8888980606101313`*^9, {
   3.888898120321432*^9, 3.888898138405764*^9}, {3.8888981782494583`*^9, 
   3.8888982464959397`*^9}, {3.88889833906439*^9, 3.888898345664979*^9}, {
   3.892705420067673*^9, 3.8927054237266884`*^9}, {3.8929729461904254`*^9, 
   3.892973047156645*^9}, {3.892973093086362*^9, 3.8929731659367743`*^9}, {
   3.893234602577506*^9, 3.8932346171023717`*^9}, {3.893260923559686*^9, 
   3.893260927821177*^9}, {3.893525336629264*^9, 3.8935254868389573`*^9}, {
   3.893525528418161*^9, 3.893525657278275*^9}, {3.8935256912872095`*^9, 
   3.8935257678488913`*^9}, {3.8935258136850977`*^9, 3.89352584051357*^9}, {
   3.8935258724344406`*^9, 3.8935259530239325`*^9}, {3.893526006190361*^9, 
   3.8935260203804526`*^9}, {3.8935732569376335`*^9, 
   3.8935732770951977`*^9}, {3.8950544385365515`*^9, 3.895054494246854*^9}, {
   3.895655438994194*^9, 3.895655440194024*^9}, 3.8961549410773125`*^9, {
   3.8961668042998157`*^9, 3.896166837500887*^9}, {3.896715342749509*^9, 
   3.896715356620757*^9}, 3.89684640329733*^9, {3.8968464821165648`*^9, 
   3.8968464933065434`*^9}, {3.8969550572401066`*^9, 3.8969550577754507`*^9}, 
   3.899193236863467*^9, {3.907647330998519*^9, 3.907647332051834*^9}, {
   3.9138066669772596`*^9, 3.9138067624699216`*^9}, {3.9138067956078324`*^9, 
   3.913806866289029*^9}, 3.9138070027913585`*^9, 3.913829956684186*^9, {
   3.913831601038921*^9, 3.913831613494101*^9}, {3.9139649859912744`*^9, 
   3.9139650567538543`*^9}, 3.913965114370762*^9, {3.913966314171273*^9, 
   3.913966339733506*^9}, {3.9139663764200597`*^9, 3.9139664013635874`*^9}, {
   3.913966478916401*^9, 3.9139664805514565`*^9}, {3.9145145197095866`*^9, 
   3.914514519718708*^9}, {3.914514779453601*^9, 3.914514779462216*^9}, {
   3.91466792137669*^9, 3.914667921636713*^9}, 3.9146679597796073`*^9, 
   3.9146685939199553`*^9, {3.9146700704142814`*^9, 3.9146700782569494`*^9}, {
   3.915642738995577*^9, 3.91564273900938*^9}, {3.915817135258117*^9, 
   3.9158171429884863`*^9}, {3.915818085890391*^9, 3.9158180866723833`*^9}, {
   3.9158190715750313`*^9, 3.9158190751467333`*^9}, {3.9158199993087125`*^9, 
   3.915819999548786*^9}, {3.9158201649384503`*^9, 3.915820215557501*^9}, {
   3.9477291560922947`*^9, 3.9477291651721725`*^9}, 3.94775235935845*^9},
 CellTags->"Sensitivity-computation",
 CellLabel->
  "In[224]:=",ExpressionUUID->"0f11c942-1cb1-4bab-9d05-80dde7ee4ac3"]
}, Closed]],

Cell[CellGroupData[{

Cell["Data importing and interpolation", "Section",
 CellChangeTimes->{{3.886565107608671*^9, 3.8865651092900896`*^9}, {
   3.8888989520135384`*^9, 3.888898956208157*^9}, 3.905402568673003*^9},
 CellTags->
  "Sensitivity-computation",ExpressionUUID->"3e602227-00a3-4fb9-8b9d-\
550ce649b396"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"NpotDefault", "=", 
   RowBox[{
    RowBox[{"Interpreter", "[", "\"\<Number\>\"", "]"}], "[", 
    RowBox[{
     RowBox[{"ProductionInfoList", "[", 
      RowBox[{"[", "1", "]"}], "]"}], "[", 
     RowBox[{"[", "6", "]"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NeventsTabulated", "//", "Clear"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Epsilon]reco", "[", "mLLP_", "]"}], "=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"StringContainsQ", "[", 
       RowBox[{
       "GivenExperimentForSensitivityComputation", ",", 
        "\"\<LHCb-downstream\>\""}], "]"}], "&&", 
      RowBox[{"!", 
       RowBox[{"StringContainsQ", "[", 
        RowBox[{"GivenExperimentForSensitivityComputation", ",", 
         RowBox[{"{", 
          RowBox[{
          "\"\<LHCb-downstream-D\>\"", ",", "\"\<LHCb-downstream-T\>\""}], 
          "}"}]}], "]"}]}]}], ",", "0.4", ",", "1"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pathsNeventsIndex", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Position", "[", 
        RowBox[{"FilenameParametersAll", ",", 
         RowBox[{"ProductionInfoList", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "ProductionInfoList", "]"}], ",", "1"}], 
      "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pathsNevents", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"pathsNeventsAll", "[", 
      RowBox[{"[", "#", "]"}], "]"}], "&"}], "/@", "pathsNeventsIndex"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"ProductionChannelsList", ",", "decaydescriptions"}], "}"}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"ProductionInfoList", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "#"}], "]"}], "]"}], "//", "DeleteDuplicates"}], 
      ")"}], "&"}], "/@", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "2"}], ",", 
      RowBox[{"-", "1"}]}], "}"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"prod", "=", 
        RowBox[{
         RowBox[{"ProductionInfoList", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"-", "2"}], "]"}], "]"}]}], ",", 
       RowBox[{"decayDescr", "=", 
        RowBox[{
         RowBox[{"ProductionInfoList", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"-", "1"}], "]"}], "]"}]}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "The", " ", "condition", " ", "if", " ", "one", " ", "sums", " ", "the",
        " ", "number", " ", "of", " ", "events", " ", "for", " ", "the", " ", 
       "same", " ", "production", " ", "mode", " ", "over", " ", "several", 
       " ", "experiments"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"IfprodExists", "=", 
       RowBox[{"MemberQ", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Keys", "[", 
           RowBox[{"DownValues", "@", "NeventsTabulated"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "1", ",", "1"}], "]"}], "]"}], ",", "prod"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"NeventsTabulated", "[", 
        RowBox[{"prod", ",", "decayDescr"}], "]"}], "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"!", "IfprodExists"}], ",", 
         RowBox[{"Import", "[", 
          RowBox[{
           RowBox[{"pathsNevents", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", "\"\<Table\>\""}], "]"}], 
         ",", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"NeventsTabulated", "[", 
             RowBox[{"prod", ",", "decayDescr"}], "]"}], "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", 
              RowBox[{"{", 
               RowBox[{"1", ",", "2"}], "}"}]}], "]"}], "]"}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"NeventsTabulated", "[", 
              RowBox[{"prod", ",", "decayDescr"}], "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"All", ",", 
               RowBox[{"{", "3", "}"}]}], "]"}], "]"}], "+", 
            RowBox[{
             RowBox[{"Import", "[", 
              RowBox[{
               RowBox[{"pathsNevents", "[", 
                RowBox[{"[", "i", "]"}], "]"}], ",", "\"\<Table\>\""}], "]"}],
              "[", 
             RowBox[{"[", 
              RowBox[{"All", ",", 
               RowBox[{"{", "3", "}"}]}], "]"}], "]"}]}]}], "]"}]}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"mminmax", "[", 
          RowBox[{"prod", ",", "decayDescr"}], "]"}], ",", 
         RowBox[{"couplingminmax", "[", 
          RowBox[{"prod", ",", "decayDescr"}], "]"}]}], "}"}], "=", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"NeventsTabulated", "[", 
             RowBox[{"prod", ",", "decayDescr"}], "]"}], "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "#"}], "]"}], "]"}], "//", "MinMax"}], ")"}],
          "&"}], "/@", 
        RowBox[{"{", 
         RowBox[{"1", ",", "2"}], "}"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"NevMax", "[", 
        RowBox[{"prod", ",", "decayDescr"}], "]"}], "=", 
       RowBox[{
        RowBox[{
         RowBox[{"NeventsTabulated", "[", 
          RowBox[{"prod", ",", "decayDescr"}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "3"}], "]"}], "]"}], "//", "Max"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"NevInt", "[", 
        RowBox[{"mLLP_", ",", "U2_", ",", "prod", ",", "decayDescr"}], "]"}], 
       "=", 
       RowBox[{
        RowBox[{"\[Epsilon]reco", "[", "mLLP", "]"}], "*", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"mminmax", "[", 
              RowBox[{"prod", ",", "decayDescr"}], "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}], "\[LessEqual]", " ", "mLLP", 
            "\[LessEqual]", 
            RowBox[{
             RowBox[{"mminmax", "[", 
              RowBox[{"prod", ",", "decayDescr"}], "]"}], "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "&&", 
           RowBox[{
            RowBox[{
             RowBox[{"couplingminmax", "[", 
              RowBox[{"prod", ",", "decayDescr"}], "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}], "\[LessEqual]", "U2", 
            "\[LessEqual]", 
            RowBox[{
             RowBox[{"couplingminmax", "[", 
              RowBox[{"prod", ",", "decayDescr"}], "]"}], "[", 
             RowBox[{"[", "2", "]"}], "]"}]}]}], ",", 
          RowBox[{"Evaluate", "[", 
           RowBox[{"10", "^", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Interpolation", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"Log10", "[", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Log10", "[", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Log10", "[", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "+", 
                    SuperscriptBox["10", 
                    RowBox[{"-", "90"}]]}], "]"}]}], "}"}], "&"}], "/@", 
                 RowBox[{"NeventsTabulated", "[", 
                  RowBox[{"prod", ",", "decayDescr"}], "]"}]}], ",", 
                RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[", 
              RowBox[{
               RowBox[{"Log10", "[", "mLLP", "]"}], ",", 
               RowBox[{"Log10", "[", "U2", "]"}]}], "]"}], ")"}]}], "]"}], 
          ",", "0"}], "]"}]}]}], ";"}]}], "\[IndentingNewLine]", "]"}], 
   "\[IndentingNewLine]", ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "1", ",", 
     RowBox[{"Length", "[", "ProductionInfoList", "]"}], ",", "1"}], "}"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"mminmaxOverall", ",", "couplingminmaxOverall"}], "}"}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{"MinMax", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"prod", ",", "descr"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"prod", ",", "ProductionChannelsList"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"descr", ",", "decaydescriptions"}], "}"}]}], "]"}], "//", 
       "Flatten"}], "]"}], "&"}], "/@", 
    RowBox[{"{", 
     RowBox[{"mminmax", ",", "couplingminmax"}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NevMaxOverall", "=", 
   RowBox[{"Max", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"NevMax", "[", 
        RowBox[{"prod", ",", "descr"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"prod", ",", "ProductionChannelsList"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"descr", ",", "decaydescriptions"}], "}"}]}], "]"}], "//", 
     "Flatten"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"NevIntOverall", "[", 
      RowBox[{"mLLP_", ",", "U2_", ",", "descr"}], "]"}], "=", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{"NevInt", "[", 
        RowBox[{"mLLP", ",", "U2", ",", "prod", ",", "descr"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"prod", ",", "ProductionChannelsList"}], "}"}]}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", ",", 
   RowBox[{"{", 
    RowBox[{"descr", ",", "decaydescriptions"}], "}"}]}], 
  "]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.8888983920663214`*^9, 3.888898635334957*^9}, {
   3.888898667943739*^9, 3.8888988055549335`*^9}, {3.8888988941544647`*^9, 
   3.888898937485649*^9}, {3.8929117504041605`*^9, 3.8929118976198163`*^9}, {
   3.8929119277887383`*^9, 3.8929120594750996`*^9}, {3.892973217274458*^9, 
   3.892973307169466*^9}, 3.893259419669223*^9, {3.8935260718320713`*^9, 
   3.8935260809550447`*^9}, {3.89352616418572*^9, 3.8935261987416224`*^9}, {
   3.8935263033747253`*^9, 3.893526304738557*^9}, {3.895054501255924*^9, 
   3.8950545038904667`*^9}, {3.896715366555463*^9, 3.8967153682258854`*^9}, {
   3.9054022133191314`*^9, 3.905402292437648*^9}, {3.905402524439004*^9, 
   3.905402532797618*^9}, {3.905402605889249*^9, 3.9054026255337467`*^9}, {
   3.9054026998556724`*^9, 3.905402746692725*^9}, {3.9054027914153585`*^9, 
   3.9054028828970246`*^9}, {3.905403703616481*^9, 3.9054037049711976`*^9}, {
   3.9074119162302017`*^9, 3.907411921741251*^9}, {3.9074121276451077`*^9, 
   3.907412131433728*^9}, {3.9138038039216237`*^9, 3.9138038039357753`*^9}, {
   3.913803837510986*^9, 3.91380383752451*^9}, {3.9138070213134923`*^9, 
   3.9138070634917927`*^9}, 3.9138307532608595`*^9, {3.9139650694912405`*^9, 
   3.913965191746135*^9}, {3.91396522790123*^9, 3.913965287834365*^9}, {
   3.913965420667942*^9, 3.913965420826338*^9}, 3.913965504376313*^9, 
   3.914062737444663*^9, {3.9145145197322273`*^9, 3.9145145197362213`*^9}, {
   3.914514779467729*^9, 3.9145147794722557`*^9}, {3.914670070511704*^9, 
   3.914670070516245*^9}, {3.915642739030178*^9, 3.9156427390674033`*^9}, {
   3.9158194278228817`*^9, 3.9158195532897735`*^9}, {3.91581984692834*^9, 
   3.9158198654064984`*^9}, {3.9158199726701727`*^9, 3.915820003058731*^9}, {
   3.91582010789814*^9, 3.915820113687312*^9}, {3.915820235590955*^9, 
   3.9158202618871717`*^9}, {3.947729308021353*^9, 3.947729339045559*^9}, {
   3.947729386076235*^9, 3.947729401542614*^9}, {3.947729433488512*^9, 
   3.9477294844525356`*^9}, {3.947729530685955*^9, 3.947729735001049*^9}, {
   3.947730740460064*^9, 3.9477307498920364`*^9}, 3.9488787481321583`*^9, {
   3.950691854654543*^9, 3.950691855236183*^9}},
 CellTags->"Sensitivity-computation",
 CellLabel->
  "In[248]:=",ExpressionUUID->"b16e043c-492d-45d6-a73a-c48a6829d23f"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Various plots", "Chapter",
 CellChangeTimes->{{3.9488787366095505`*^9, 3.948878739845476*^9}},
 CellTags->
  "Sensitivity-computation",ExpressionUUID->"534554ab-08a0-db4f-8042-\
dce9fe4afd6c"],

Cell[CellGroupData[{

Cell["Number of events plot", "Section",
 CellChangeTimes->{{3.9488787660729885`*^9, 3.9488787732240067`*^9}},
 CellTags->
  "Sensitivity-computation",ExpressionUUID->"b3d2ce0f-6378-9147-9075-\
34edd6f0aa7e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"pt", "[", 
   RowBox[{"mLLP_", ",", "descr_"}], "]"}], ":=", 
  RowBox[{"LogLogPlot", "[", 
   RowBox[{
    RowBox[{"Evaluate", "[", 
     RowBox[{"Join", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"NevInt", "[", 
         RowBox[{"mLLP", ",", "y", ",", "prod", ",", "descr"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"prod", ",", "ProductionChannelsList"}], "}"}]}], "]"}], 
      "]"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"y", ",", 
      RowBox[{"couplingminmaxOverall", "[", 
       RowBox[{"[", "1", "]"}], "]"}], ",", 
      RowBox[{"couplingminmaxOverall", "[", 
       RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
    RowBox[{"PlotLegends", "\[Rule]", 
     RowBox[{"Placed", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Style", "[", 
          RowBox[{"#", ",", "15"}], "]"}], "&"}], "/@", 
        "ProductionChannelsList"}], ",", "Right"}], "]"}]}], ",", 
    RowBox[{"PlotRange", "->", 
     RowBox[{"{", 
      RowBox[{"couplingminmaxOverall", ",", 
       RowBox[{"{", 
        RowBox[{
         SuperscriptBox["10", 
          RowBox[{"-", "2"}]], ",", "NevMaxOverall"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"Frame", "->", "True"}], ",", 
    RowBox[{"ImageSize", "->", "Large"}], ",", 
    RowBox[{"FrameLabel", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
      "\"\<\!\(\*SuperscriptBox[\(U\), \(2\)]\)\>\"", " ", ",", " ", 
       "\"\<\!\(\*SubscriptBox[\(N\), \(events\)]\)[\!\(\*SubscriptBox[\(m\), \
\(N\)]\),\!\(\*SuperscriptBox[\(U\), \(2\)]\)]\>\""}], "}"}]}], ",", 
    RowBox[{"FrameStyle", "\[Rule]", 
     RowBox[{"Directive", "[", 
      RowBox[{"Black", ",", " ", "23"}], "]"}]}], ",", 
    RowBox[{"PlotStyle", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"Thick", ",", "Blue"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"Thick", ",", 
         RowBox[{"Darker", "@", "Red"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"Thick", ",", 
         RowBox[{"Darker", "@", 
          RowBox[{"Darker", "@", "Green"}]}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"Thick", ",", "Black"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"Thick", ",", "Blue", ",", 
         RowBox[{"Dashing", "[", "0.02", "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"Thick", ",", 
         RowBox[{"Darker", "@", "Red"}], ",", 
         RowBox[{"Dashing", "[", "0.02", "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"Thick", ",", 
         RowBox[{"Darker", "@", 
          RowBox[{"Darker", "@", "Green"}]}], ",", 
         RowBox[{"Dashing", "[", "0.02", "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"Thick", ",", "Black", ",", 
         RowBox[{"Dashing", "[", "0.02", "]"}]}], "}"}]}], "}"}]}], ",", 
    RowBox[{"PlotLabel", "\[Rule]", 
     RowBox[{"Style", "[", 
      RowBox[{
       RowBox[{"Row", "[", 
        RowBox[{"{", 
         RowBox[{
         "GivenExperimentForSensitivityComputation", ",", 
          "\"\<. \!\(\*SubscriptBox[\(m\), \(N\)]\) = \>\"", ",", "mLLP", ",",
           " ", "\"\< GeV\>\""}], "}"}], "]"}], ",", "20", ",", "Black"}], 
      "]"}]}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"defaultDescr", "=", 
   RowBox[{"decaydescriptions", "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"pt", "[", 
  RowBox[{"1.2", ",", "defaultDescr"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"pt2", "[", 
     RowBox[{"mlist_", ",", "descr_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"LogLogPlot", "[", 
      RowBox[{
       RowBox[{"Evaluate", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Join", "[", 
           RowBox[{"NevIntOverall", "[", 
            RowBox[{"#", ",", 
             RowBox[{
              SuperscriptBox["10", 
               RowBox[{"-", "6"}]], "y"}], ",", "descr"}], "]"}], "]"}], 
          "&"}], "/@", "mlist"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"y", ",", 
         RowBox[{
          SuperscriptBox["10", "6"], 
          RowBox[{"couplingminmaxOverall", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ",", 
         RowBox[{
          SuperscriptBox["10", "6"], 
          RowBox[{"couplingminmaxOverall", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}], ",", 
       RowBox[{"PlotLegends", "\[Rule]", 
        RowBox[{"Placed", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Style", "[", 
             RowBox[{
              RowBox[{"Row", "[", 
               RowBox[{"{", 
                RowBox[{
                "\"\<\!\(\*SubscriptBox[\(m\), \(N\)]\) = \>\"", " ", ",", 
                 "#", ",", "\"\< GeV\>\""}], "}"}], "]"}], ",", "15"}], "]"}],
             "&"}], "/@", "mlist"}], ",", "Right"}], "]"}]}], ",", 
       RowBox[{"PlotRange", "->", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0.1", ",", "100"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", 
            RowBox[{"0.5", "*", 
             SuperscriptBox["10", "6"]}]}], "}"}]}], "}"}]}], ",", 
       RowBox[{"Frame", "->", "True"}], ",", 
       RowBox[{"ImageSize", "->", "Large"}], ",", 
       RowBox[{"FrameLabel", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Row", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Subsuperscript", "[", 
              RowBox[{"\"\<U\>\"", ",", "\"\<e\>\"", ",", "\"\<2\>\""}], 
              "]"}], ",", "\"\<,\>\"", ",", 
             "\"\< \!\(\*SuperscriptBox[\(10\), \(6\)]\)\[Times]\>\""}], 
            "}"}], "]"}], " ", ",", " ", 
          RowBox[{"Row", "[", 
           RowBox[{"{", 
            RowBox[{
            "\"\<\!\(\*SubscriptBox[\(N\), \
\(events\)]\)[\!\(\*SubscriptBox[\(m\), \(N\)]\),\>\"", ",", 
             RowBox[{"Subsuperscript", "[", 
              RowBox[{"\"\<U\>\"", ",", "\"\<e\>\"", ",", "\"\<2\>\""}], 
              "]"}], ",", "\"\<]\>\""}], "}"}], "]"}]}], "}"}]}], ",", 
       RowBox[{"FrameStyle", "\[Rule]", 
        RowBox[{"Directive", "[", 
         RowBox[{"Black", ",", " ", "23"}], "]"}]}], ",", 
       RowBox[{"PlotStyle", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"Thick", ",", "Blue"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"Thick", ",", 
            RowBox[{"Darker", "@", "Red"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"Thick", ",", 
            RowBox[{"Darker", "@", 
             RowBox[{"Darker", "@", "Green"}]}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"Thick", ",", "Black"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"Thick", ",", "Blue", ",", 
            RowBox[{"Dashing", "[", "0.02", "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"Thick", ",", 
            RowBox[{"Darker", "@", "Red"}], ",", 
            RowBox[{"Dashing", "[", "0.02", "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"Thick", ",", 
            RowBox[{"Darker", "@", 
             RowBox[{"Darker", "@", "Green"}]}], ",", 
            RowBox[{"Dashing", "[", "0.02", "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"Thick", ",", "Black", ",", 
            RowBox[{"Dashing", "[", "0.02", "]"}]}], "}"}]}], "}"}]}], ",", 
       RowBox[{"PlotLabel", "->", 
        RowBox[{"Style", "[", 
         RowBox[{
          RowBox[{"Row", "[", 
           RowBox[{"{", "\"\<HNLs decaying inside PREFACE\>\"", "}"}], "]"}], 
          ",", "18", ",", "Black"}], "]"}]}]}], "]"}], "\[IndentingNewLine]", 
     RowBox[{"pt2", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"2", ",", "2.5", ",", "3"}], "}"}], ",", "defaultDescr"}], 
      "]"}]}]}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.948878976894701*^9, 3.948879301041273*^9}, {
   3.948879701473217*^9, 3.9488797033516064`*^9}, 3.950691854656643*^9},
 CellTags->"Sensitivity-computation",
 CellLabel->
  "In[258]:=",ExpressionUUID->"8a2dcc3f-cd0c-8443-a903-c3befebfddbc"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.948879313640339*^9, 3.9488793342835064`*^9}, {
   3.948879431017166*^9, 3.9488794776338577`*^9}, 
   3.948879699552044*^9},ExpressionUUID->"14d1d7c3-714e-164c-ab23-\
82dd99bab29b"]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   SubscriptBox["N", "events"], TraditionalForm]],ExpressionUUID->
  "bd0209fb-2953-6d4a-a553-83996b6d7553"],
 " density plot"
}], "Section",
 CellChangeTimes->{{3.89291161772971*^9, 3.8929116255034943`*^9}},
 CellTags->
  "Sensitivity-computation",ExpressionUUID->"39e6da3a-e227-483d-be39-\
0d9a1bce65bb"],

Cell[BoxData[{
 RowBox[{"plot", "=", 
  RowBox[{"DensityPlot", "[", 
   RowBox[{
    RowBox[{"Evaluate", "[", 
     RowBox[{"Log10", "[", 
      RowBox[{"NevIntOverall", "[", 
       RowBox[{"mLLP", ",", "\[Epsilon]2", ",", "defaultDescr"}], "]"}], 
      "]"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"mLLP", ",", 
      RowBox[{"mminmaxOverall", "[", 
       RowBox[{"[", "1", "]"}], "]"}], ",", 
      RowBox[{"mminmaxOverall", "[", 
       RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"\[Epsilon]2", ",", 
      RowBox[{"couplingminmaxOverall", "[", 
       RowBox[{"[", "1", "]"}], "]"}], ",", 
      RowBox[{"couplingminmaxOverall", "[", 
       RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
    RowBox[{"ScalingFunctions", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"\"\<Log\>\"", ",", "\"\<Log\>\""}], "}"}]}], ",", 
    RowBox[{"AspectRatio", "\[Rule]", "0.78"}], ",", 
    RowBox[{"PlotRange", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"All", ",", "All", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Log10", "[", "2.3", "]"}], ",", 
         RowBox[{"Log10", "[", "NevMaxOverall", "]"}]}], "}"}]}], "}"}]}], 
    ",", 
    RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
    RowBox[{"FrameLabel", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
      "\"\<\!\(\*SubscriptBox[\(m\), \(N\)]\) [GeV]\>\"", ",", 
       "\"\<\!\(\*SuperscriptBox[\(U\), \(2\)]\)\>\""}], "}"}]}], ",", " ", 
    RowBox[{"Frame", "\[Rule]", " ", "True"}], ",", " ", 
    RowBox[{"FrameStyle", "\[Rule]", 
     RowBox[{"Directive", "[", 
      RowBox[{"Black", ",", " ", "25"}], "]"}]}], ",", 
    RowBox[{"PlotPoints", "\[Rule]", "100"}], ",", 
    RowBox[{"PlotLegends", "\[Rule]", 
     RowBox[{"Placed", "[", 
      RowBox[{
       RowBox[{"BarLegend", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"Automatic", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Log10", "[", "2.3", "]"}], ",", 
             RowBox[{"Log10", "[", "NevMaxOverall", "]"}]}], "}"}]}], "}"}], 
         ",", 
         RowBox[{"LegendMarkerSize", "\[Rule]", "340"}], ",", 
         RowBox[{"LegendLabel", "\[Rule]", 
          RowBox[{"Placed", "[", 
           RowBox[{
           "\"\<\!\(\*SubscriptBox[\(Log\), \
\(10\)]\)[\!\(\*SubscriptBox[\(N\), \(ev\)]\)]\>\"", ",", "Bottom"}], "]"}]}],
          ",", 
         RowBox[{"LabelStyle", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"FontSize", "\[Rule]", "22"}], "}"}]}], ",", 
         RowBox[{"Method", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"FrameStyle", "\[Rule]", "Black"}], ",", 
            RowBox[{"AxesStyle", "\[Rule]", "None"}], ",", 
            RowBox[{"TicksStyle", "\[Rule]", "Black"}]}], "}"}]}]}], "]"}], 
       ",", "Right"}], "]"}]}], ",", 
    RowBox[{"PlotLabel", "\[Rule]", 
     RowBox[{"Style", "[", 
      RowBox[{
       RowBox[{"Row", "[", 
        RowBox[{"{", "ExperimentFolder", "}"}], "]"}], ",", "20", ",", 
       "Black"}], "]"}]}]}], 
   RowBox[{"(*", 
    RowBox[{",", 
     RowBox[{"FrameTicks", "->", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"Automatic", ",", "Automatic"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"TicksPlotx", ",", "None"}], "}"}]}], "}"}]}]}], "*)"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Export", "[", 
    RowBox[{
     RowBox[{"FileNameJoin", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"NotebookDirectory", "[", "]"}], ",", 
        "\"\<plots/SensCalc/NeventsDensityPlotExample.pdf\>\""}], "}"}], 
      "]"}], ",", "plot", ",", 
     RowBox[{"\"\<AllowRasterization\>\"", "->", "False"}]}], "]"}], 
   "*)"}]}]}], "Input",
 CellChangeTimes->{{3.8929116398228235`*^9, 3.892911640819866*^9}, {
   3.8929117000725927`*^9, 3.8929117019883537`*^9}, {3.892912071098483*^9, 
   3.8929121392668476`*^9}, 3.892973399038414*^9, 3.893526212624839*^9, {
   3.893526322069903*^9, 3.8935263243906045`*^9}, {3.8937453741659374`*^9, 
   3.8937453762371025`*^9}, {3.895655470663905*^9, 3.8956555023701625`*^9}, {
   3.9054037163163233`*^9, 3.9054037397249928`*^9}, {3.9138038039431286`*^9, 
   3.9138038039461203`*^9}, {3.913803837527502*^9, 3.9138038375313835`*^9}, {
   3.913965329296404*^9, 3.913965340753069*^9}, {3.913965420682952*^9, 
   3.9139654206869583`*^9}, {3.9156427392633133`*^9, 3.915642739267493*^9}, {
   3.947730729106556*^9, 3.9477307542763977`*^9}},
 CellTags->"Sensitivity-computation",
 CellLabel->
  "In[261]:=",ExpressionUUID->"d4d65c7b-8dd1-4283-851a-4fc0b32dadbc"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Sensitivity", "Chapter",
 CellChangeTimes->{{3.9146680485940638`*^9, 3.914668049725053*^9}},
 CellTags->
  "Sensitivity-computation",ExpressionUUID->"b5c87f48-3922-4ed2-b686-\
e303a73856dc"],

Cell[CellGroupData[{

Cell["Constraints importing", "Section",
 CellChangeTimes->{{3.9146677495839996`*^9, 3.91466775194114*^9}},
 CellTags->
  "Sensitivity-computation",ExpressionUUID->"3d4bde77-8bbe-4c70-80b5-\
0dd60c8bca64"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"importformat", "[", "\"\<txt\>\"", "]"}], "=", 
   RowBox[{
    RowBox[{"importformat", "[", "\"\<dat\>\"", "]"}], "=", 
    "\"\<Table\>\""}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"importformat", "[", "\"\<m\>\"", "]"}], "=", 
   RowBox[{
    RowBox[{"importformat", "[", "\"\<mx\>\"", "]"}], "=", "\"\<MX\>\""}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"importformat", "[", "\"\<xls\>\"", "]"}], "=", "\"\<XLS\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dir", "=", 
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"NotebookDirectory", "[", "]"}], ",", "\"\<contours\>\"", ",", 
      "LLPdirName"}], "}"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"DirectoryQ", "[", "dir", "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"filenames", "=", 
      RowBox[{"FileNames", "[", 
       RowBox[{
        RowBox[{"LLPdirName", "<>", "\"\<-excluded*\>\""}], ",", "dir", ",", 
        "Infinity"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ExcludedRegions", "[", "LLPdirName", "]"}], "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Import", "[", 
         RowBox[{"#", ",", 
          RowBox[{"importformat", "[", 
           RowBox[{"FileExtension", "[", "#", "]"}], "]"}]}], "]"}], "&"}], "/@", 
       RowBox[{"FileNames", "[", 
        RowBox[{
         RowBox[{"LLPdirName", "<>", "\"\<-excluded*\>\""}], ",", "dir", ",", 
         "Infinity"}], "]"}]}]}], ";"}]}], "\[IndentingNewLine]", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"!", 
    RowBox[{"DirectoryQ", "[", "dir", "]"}]}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ExcludedRegions", "[", "LLPdirName", "]"}], "=", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{"10.", ",", "10."}], "}"}], "}"}], "}"}]}], ";"}]}], 
  "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Seesaw", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"mN", ",", 
       RowBox[{"5", "*", 
        RowBox[{
         SuperscriptBox["10", 
          RowBox[{"-", "11"}]], "/", "mN"}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"mN", ",", "0.01", ",", "90", ",", "0.1"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ExcludedRegionsTemp", "[", "LLPdirName", "]"}], "=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"SelectedHNLtype", "==", "\"\<Majorana\>\""}], ",", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"SelectedMixingPattern", "\[Equal]", 
        RowBox[{"{", 
         RowBox[{"1", ",", "0", ",", "0"}], "}"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"Seesaw", ",", 
         RowBox[{
          RowBox[{"ExcludedRegions", "[", "LLPdirName", "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", 
         RowBox[{
          RowBox[{"ExcludedRegions", "[", "LLPdirName", "]"}], "[", 
          RowBox[{"[", "4", "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"SelectedMixingPattern", "\[Equal]", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1", ",", "0"}], "}"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"Seesaw", ",", 
           RowBox[{
            RowBox[{"ExcludedRegions", "[", "LLPdirName", "]"}], "[", 
            RowBox[{"[", "2", "]"}], "]"}], ",", 
           RowBox[{
            RowBox[{"ExcludedRegions", "[", "LLPdirName", "]"}], "[", 
            RowBox[{"[", "5", "]"}], "]"}]}], "}"}], ",", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"SelectedMixingPattern", "\[Equal]", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"Seesaw", ",", 
             RowBox[{
              RowBox[{"ExcludedRegions", "[", "LLPdirName", "]"}], "[", 
              RowBox[{"[", "3", "]"}], "]"}], ",", 
             RowBox[{
              RowBox[{"ExcludedRegions", "[", "LLPdirName", "]"}], "[", 
              RowBox[{"[", "6", "]"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", "Seesaw", "}"}]}], "]"}]}], "]"}]}], "]"}], ",", 
     RowBox[{"{", "Seesaw", "}"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.914667771016816*^9, 3.914667820527609*^9}, {
  3.9146678519341393`*^9, 3.914667852165822*^9}, {3.915642739713396*^9, 
  3.9156427397465334`*^9}},
 CellTags->"Sensitivity-computation",
 CellLabel->
  "In[262]:=",ExpressionUUID->"9eb47f4c-1ae9-473e-acfc-c13e022083f4"]
}, Closed]],

Cell[CellGroupData[{

Cell["Sensitivity", "Section",
 CellChangeTimes->{{3.886565115214114*^9, 3.8865651186785173`*^9}},
 CellTags->
  "Sensitivity-computation",ExpressionUUID->"20efcc73-93a4-4db0-b95c-\
2c9126c9e7ce"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{
  3.9528431945974274`*^9},ExpressionUUID->"86d361cd-16a5-9e4a-b23c-\
af68e8f9a542"],

Cell[CellGroupData[{

Cell["Defining sensitivity block", "Subsection",
 CellChangeTimes->{{3.9528427470362816`*^9, 3.9528427598899193`*^9}},
 CellTags->
  "Sensitivity-computation",ExpressionUUID->"8ea89b86-15dc-2b4e-8097-\
f8b98e610f11"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SensitivityBlock", "[", 
   RowBox[{
   "Npot_", ",", "NevMin_", ",", "SelectedProduction_", ",", "descr_"}], 
   "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"NevTot", "[", 
       RowBox[{"mLLP_", ",", "U2_"}], "]"}], "=", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{"NevInt", "[", 
         RowBox[{"mLLP", ",", "U2", ",", "prod", ",", "descr"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"prod", ",", "SelectedProduction"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"RegSens", "=", 
      RowBox[{"RegionPlot", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          FractionBox["Npot", "NpotDefault"], 
          RowBox[{"NevTot", "[", 
           RowBox[{
            SuperscriptBox["10", "mLLP"], ",", 
            SuperscriptBox["10", "U2"]}], "]"}]}], "\[GreaterEqual]", " ", 
         "NevMin"}], ",", 
        RowBox[{"{", 
         RowBox[{"mLLP", ",", 
          RowBox[{"Log10", "[", 
           RowBox[{"mminmaxOverall", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
          RowBox[{"Log10", "[", 
           RowBox[{"mminmaxOverall", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"U2", ",", 
          RowBox[{"Log10", "[", 
           RowBox[{"couplingminmaxOverall", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
          RowBox[{"Log10", "[", 
           RowBox[{"couplingminmaxOverall", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "}"}], ",", 
        RowBox[{"PlotPoints", "->", "200"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"SensTemp", "=", 
      RowBox[{"Cases", "[", 
       RowBox[{
        RowBox[{"Normal", "@", "RegSens"}], ",", 
        RowBox[{
         RowBox[{"Line", "[", "x_", "]"}], "\[RuleDelayed]", "x"}], ",", 
        "Infinity"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"10", "^", 
            RowBox[{"#", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], ",", 
           RowBox[{"10", "^", 
            RowBox[{"#", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}], "&"}], "/@", 
        RowBox[{"SensTemp", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "SensTemp", "]"}], ",", "1"}], "}"}]}], 
      "]"}]}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SensitivityBlock", "[", 
   RowBox[{"Npot_", ",", "NevMin_", ",", "SelectedProduction_"}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"TabSens", "=", 
      RowBox[{
       RowBox[{"ResourceFunction", "[", "\"\<MonitorProgress\>\"", "]"}], "@", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"SelectedProduction", ",", 
           RowBox[{"decaydescriptions", "[", 
            RowBox[{"[", "j", "]"}], "]"}], ",", 
           RowBox[{"SensitivityBlock", "[", 
            RowBox[{"Npot", ",", "NevMin", ",", "SelectedProduction", ",", 
             RowBox[{"decaydescriptions", "[", 
              RowBox[{"[", "j", "]"}], "]"}]}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", 
           RowBox[{"Length", "[", "decaydescriptions", "]"}]}], "}"}]}], 
        "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"filename", "=", 
      RowBox[{"FileNameJoin", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"directory", "[", "\"\<Sensitivity-LLP\>\"", "]"}], ",", 
         "ExperimentFolder", ",", 
         RowBox[{"ToString", "@", 
          RowBox[{"StringForm", "[", 
           
           RowBox[{"\"\<Sensitivity_HNL_Pattern_``-``-``_``_at_``_Nev=``_Npot=\
``.\>\"", ",", 
            RowBox[{"Sequence", "@@", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"patternsshorten", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", 
               RowBox[{"patternsshorten", "[", 
                RowBox[{"[", "2", "]"}], "]"}], ",", 
               RowBox[{"patternsshorten", "[", 
                RowBox[{"[", "3", "]"}], "]"}], ",", "SelectedHNLtype", ",", 
               "ExperimentFolder", ",", 
               RowBox[{"NevMin", "//", "ToString"}], ",", 
               RowBox[{
                RowBox[{
                 RowBox[{"SetPrecision", "[", 
                  RowBox[{
                   RowBox[{"Npot", "//", "N"}], ",", "3"}], "]"}], "//", 
                 "CForm"}], "//", "ToString"}]}], "}"}]}]}], "]"}]}]}], "}"}],
        "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"assocData", "=", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Association", "[", 
          RowBox[{
           RowBox[{"\"\<Production modes\>\"", "->", 
            RowBox[{"#", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], ",", 
           RowBox[{"\"\<Decay description\>\"", "->", 
            RowBox[{"#", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], ",", 
           RowBox[{"\"\<Sensitivity domains\>\"", "->", 
            RowBox[{"#", "[", 
             RowBox[{"[", "3", "]"}], "]"}]}]}], "]"}], "&"}], ",", 
        "TabSens"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Export", "[", 
      RowBox[{
       RowBox[{"FileNameJoin", "[", 
        RowBox[{"{", 
         RowBox[{"filename", "<>", "\"\<mx\>\""}], "}"}], "]"}], ",", 
       "TabSens", ",", "\"\<MX\>\""}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Export", "[", 
      RowBox[{
       RowBox[{"FileNameJoin", "[", 
        RowBox[{"{", 
         RowBox[{"filename", "<>", "\"\<json\>\""}], "}"}], "]"}], ",", 
       "assocData", ",", "\"\<JSON\>\""}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", "TabSens", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Import", "[", 
      RowBox[{
       RowBox[{"FileNameJoin", "[", 
        RowBox[{"{", 
         RowBox[{"filename", "<>", "\"\<mx\>\""}], "}"}], "]"}], 
       ",", "\"\<MX\>\""}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 CellTags->
  "Sensitivity-computation",ExpressionUUID->"7ddbd626-6352-b64a-b6dc-\
33dc9091a4ee"]
}, Closed]],

Cell[CellGroupData[{

Cell["Computing sensitivity", "Subsection",
 CellChangeTimes->{{3.952842765714447*^9, 3.9528427678653965`*^9}},
 CellTags->
  "Sensitivity-computation",ExpressionUUID->"19da381b-a10f-0d4b-840b-\
faf77888349b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"productionlist", "=", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"{", "\"\<All\>\"", "}"}], ",", "ProductionChannelsList"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DynamicModule", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"input1", "=", "NpotDefault"}], ",", 
      RowBox[{"input2", "=", "2.3"}], ",", 
      RowBox[{"choice", "=", 
       RowBox[{"{", "\"\<All\>\"", "}"}]}], ",", "list", ",", "phrase"}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"DialogInput", "[", 
     RowBox[{"Column", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Style", "[", 
         RowBox[{"ExperimentFolder", ",", "Bold"}], "]"}], ",", 
        RowBox[{
        "TextCell", "[", "\"\<Enter the number of proton collisions:\>\"", 
         "]"}], ",", 
        RowBox[{"InputField", "[", 
         RowBox[{
          RowBox[{"Dynamic", "[", "input1", "]"}], ",", "Expression"}], "]"}],
         ",", 
        RowBox[{
        "TextCell", 
         "[", "\"\<Enter the value of N_ev,min for which the sensitivity will \
be computed:\>\"", "]"}], ",", 
        RowBox[{"InputField", "[", 
         RowBox[{
          RowBox[{"Dynamic", "[", "input2", "]"}], ",", "Expression"}], "]"}],
         ",", 
        RowBox[{"Row", "[", 
         RowBox[{
         "{", "\"\<Select the production channels to be used for the \
sensitivity calculation:\>\"", "}"}], "]"}], ",", 
        RowBox[{"Pane", "[", 
         RowBox[{
          RowBox[{"TogglerBar", "[", 
           RowBox[{
            RowBox[{"Dynamic", "[", "choice", "]"}], ",", "productionlist", ",", 
            RowBox[{"Appearance", "->", 
             RowBox[{"\"\<Vertical\>\"", "->", 
              RowBox[{"{", 
               RowBox[{"Automatic", ",", "1"}], "}"}]}]}]}], "]"}], ",", 
          RowBox[{"ImageSize", "->", 
           RowBox[{"{", 
            RowBox[{"Automatic", ",", "Automatic"}], "}"}]}], ",", 
          RowBox[{"Scrollbars", "->", 
           RowBox[{"{", 
            RowBox[{"False", ",", "True"}], "}"}]}]}], "]"}], ",", 
        RowBox[{"Button", "[", 
         RowBox[{"\"\<Submit\>\"", ",", 
          RowBox[{"DialogReturn", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"NpotVal", ",", "NevMinVal", ",", "SelectedProduction"}],
              "}"}], "=", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"input1", ",", "input2", ",", "choice"}], "}"}], "//", 
             "N"}]}], "]"}], ",", 
          RowBox[{"ImageSize", "->", "Automatic"}]}], "]"}]}], "}"}], "]"}], 
     "]"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"MemberQ", "[", 
    RowBox[{"SelectedProduction", ",", "\"\<All\>\""}], "]"}], ",", 
   RowBox[{
    RowBox[{"SelectedProduction", "=", "ProductionChannelsList"}], ";"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"\"\<\!\(\*SubscriptBox[\(N\), \(PoT\)]\) for computation\>\"", 
      ",", "\"\<\!\(\*SubscriptBox[\(N\), \(ev, min\)]\)\>\"", 
      ",", "\"\<Selected production modes\>\""}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"NpotVal", ",", "NevMinVal", ",", "SelectedProduction"}], 
     "}"}]}], "}"}], "//", "TableForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sens", "=", 
   RowBox[{"SensitivityBlock", "[", 
    RowBox[{"NpotVal", ",", "NevMinVal", ",", "SelectedProduction"}], "]"}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sensDomains", "=", 
   RowBox[{"sens", "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", 
      RowBox[{"-", "1"}]}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Show", "[", 
  RowBox[{
   RowBox[{"ListLogLogPlot", "[", 
    RowBox[{
     RowBox[{"Cases", "[", 
      RowBox[{
       RowBox[{"ExcludedRegionsTemp", "[", "LLPdirName", "]"}], ",", 
       RowBox[{"_", "?", "MatrixQ"}], ",", "All"}], "]"}], ",", 
     RowBox[{"Joined", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"True", ",", "True", ",", "True", ",", "True"}], "}"}]}], ",", 
     RowBox[{"Frame", "\[Rule]", " ", "True"}], ",", 
     RowBox[{"FrameLabel", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"massLabel", ",", "couplingLabel"}], "}"}]}], ",", 
     RowBox[{"FrameStyle", "\[Rule]", 
      RowBox[{"Directive", "[", 
       RowBox[{"Black", ",", " ", "23"}], "]"}]}], ",", 
     RowBox[{"PlotStyle", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{"Thick", ",", "Gray"}], "}"}], "}"}]}], ",", 
     RowBox[{"Filling", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"1", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"Bottom", ",", 
           RowBox[{"Directive", "[", 
            RowBox[{"Gray", ",", 
             RowBox[{"Opacity", "[", "0.3", "]"}]}], "]"}]}], "}"}]}], ",", 
        RowBox[{"2", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"True", ",", 
           RowBox[{"Directive", "[", 
            RowBox[{"Gray", ",", 
             RowBox[{"Opacity", "[", "0.3", "]"}]}], "]"}]}], "}"}]}], ",", 
        RowBox[{"3", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"Bottom", ",", 
           RowBox[{"Directive", "[", 
            RowBox[{"Gray", ",", 
             RowBox[{"Opacity", "[", "0.1", "]"}]}], "]"}]}], "}"}]}], ",", 
        RowBox[{"4", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"True", ",", 
           RowBox[{"Directive", "[", 
            RowBox[{"Gray", ",", 
             RowBox[{"Opacity", "[", "0.3", "]"}]}], "]"}]}], "}"}]}]}], 
       "}"}]}], ",", 
     RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
     RowBox[{"PlotRange", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"1.01", 
           RowBox[{"mminmaxOverall", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], ",", 
          RowBox[{"1.1", 
           RowBox[{"mminmaxOverall", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"0.3", 
           RowBox[{"Min", "[", 
            RowBox[{"Flatten", "[", "sensDomains", "]"}], "]"}]}], ",", 
          RowBox[{"0.98", 
           RowBox[{"couplingminmaxOverall", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}]}], "}"}]}], ",", 
     RowBox[{"PlotLabel", "\[Rule]", 
      RowBox[{"Style", "[", 
       RowBox[{
        RowBox[{"Row", "[", 
         RowBox[{"{", 
          
          RowBox[{"\"\<\!\(\*SubscriptBox[\(N\), \(events\)]\) \
\[GreaterEqual] \>\"", ",", "NevMinVal"}], "}"}], "]"}], ",", "18", ",", 
        "Black"}], "]"}]}]}], "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"ListLogLogPlot", "[", 
    RowBox[{
     RowBox[{"Cases", "[", 
      RowBox[{"sensDomains", ",", 
       RowBox[{"_", "?", "MatrixQ"}], ",", "All"}], "]"}], ",", 
     RowBox[{"Joined", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"True", ",", "True", ",", "True", ",", "True"}], "}"}]}], ",", 
     RowBox[{"PlotStyle", "\[Rule]", 
      RowBox[{"Flatten", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"ConstantArray", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"Thick", ",", "Blue"}], "}"}], ",", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"MatrixQ", "[", "sensDomains", "]"}], ",", "1", ",", 
             RowBox[{"Length", "@", "sensDomains"}]}], "]"}]}], "]"}], "}"}], 
        ",", "1"}], "]"}]}], ",", 
     RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
     RowBox[{"PlotRange", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"1.01", 
           RowBox[{"mminmaxOverall", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], ",", 
          RowBox[{"1.1", 
           RowBox[{"mminmaxOverall", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"couplingminmaxOverall", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{"Max", "[", 
           RowBox[{"0.2", ",", 
            RowBox[{"0.98", 
             RowBox[{"couplingminmaxOverall", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}]}], "]"}]}], "}"}]}], "}"}]}], ",", 
     RowBox[{"PlotLabel", "\[Rule]", 
      RowBox[{"Style", "[", 
       RowBox[{
        RowBox[{"Row", "[", 
         RowBox[{"{", 
          
          RowBox[{"\"\<\!\(\*SubscriptBox[\(N\), \(events\)]\) \
\[GreaterEqual] \>\"", ",", "NevMinVal"}], "}"}], "]"}], ",", "18", ",", 
        "Black"}], "]"}]}], ",", 
     RowBox[{"PlotLegends", "\[Rule]", 
      RowBox[{"Placed", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Style", "[", 
           RowBox[{"#", ",", "15"}], "]"}], "&"}], "/@", 
         RowBox[{"{", "ExperimentFolder", "}"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"0.2", ",", "0.15"}], "}"}]}], "]"}]}]}], "]"}], ",", 
   RowBox[{"Graphics", "[", 
    RowBox[{"{", 
     RowBox[{"Text", "[", 
      RowBox[{
       RowBox[{"Style", "[", 
        RowBox[{"\"\<Excluded\>\"", ",", "24", ",", "Black"}], "]"}], ",", 
       RowBox[{"Scaled", "[", 
        RowBox[{"{", 
         RowBox[{"0.7", ",", "0.95"}], "}"}], "]"}]}], "]"}], "}"}], "]"}]}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.8860950920688515`*^9, 3.8860954655276003`*^9}, {
   3.8861280395485344`*^9, 3.8861280410019855`*^9}, {3.88647972392144*^9, 
   3.886479725273675*^9}, {3.8864797950477133`*^9, 3.8864798018553343`*^9}, {
   3.886480035786476*^9, 3.886480036285406*^9}, {3.8872798675785656`*^9, 
   3.887279880334217*^9}, {3.8888989631474533`*^9, 3.8888990272328596`*^9}, {
   3.888899100854557*^9, 3.8888992662273664`*^9}, {3.8888993007840223`*^9, 
   3.8888993747054234`*^9}, {3.8929116851550765`*^9, 
   3.8929116860606117`*^9}, {3.8929118044484444`*^9, 3.892911804586389*^9}, {
   3.892973424485577*^9, 3.8929735062457585`*^9}, {3.8932595324898405`*^9, 
   3.893259534538739*^9}, {3.893259583943966*^9, 3.89325958408368*^9}, {
   3.8935262192412004`*^9, 3.893526224783012*^9}, {3.893526341108305*^9, 
   3.8935263546094613`*^9}, 3.893526506817713*^9, {3.8950542442741404`*^9, 
   3.895054256837692*^9}, {3.895054513146216*^9, 3.8950545421752167`*^9}, {
   3.8950546520795608`*^9, 3.895054655945615*^9}, 3.895077817943701*^9, {
   3.8950797227800293`*^9, 3.8950797229338818`*^9}, {3.895655520488201*^9, 
   3.8956555290039434`*^9}, {3.8956555648841257`*^9, 
   3.8956556165140133`*^9}, {3.896154836152176*^9, 3.8961548370156183`*^9}, {
   3.896154885845129*^9, 3.89615489312577*^9}, {3.9049027863166275`*^9, 
   3.9049027864672694`*^9}, {3.9061852726254454`*^9, 3.9061853032943134`*^9}, 
   3.906185698355516*^9, {3.906196630429819*^9, 3.906196631035243*^9}, {
   3.9072588833561096`*^9, 3.907258885190167*^9}, {3.907411058568468*^9, 
   3.907411059353714*^9}, {3.907647703646454*^9, 3.9076477066333604`*^9}, 
   3.9121559301058054`*^9, {3.913803804050935*^9, 3.913803804076268*^9}, {
   3.913803837543592*^9, 3.9138038375673976`*^9}, 3.913807092799923*^9, {
   3.9139653591790147`*^9, 3.9139654775956287`*^9}, 3.913965532725506*^9, {
   3.9140862369552293`*^9, 3.914086271678206*^9}, {3.9140863326193724`*^9, 
   3.914086432570679*^9}, {3.914667863329632*^9, 3.914667927126707*^9}, {
   3.914670165464329*^9, 3.914670181620208*^9}, {3.914670215330892*^9, 
   3.9146702188327255`*^9}, {3.9152627349479485`*^9, 3.915262736588694*^9}, 
   3.915262778502839*^9, {3.9152980401567936`*^9, 3.9152980637690544`*^9}, {
   3.9156427397686167`*^9, 3.915642739794487*^9}, {3.9169956229512963`*^9, 
   3.916995623098342*^9}, {3.9170234409629803`*^9, 3.9170234447253256`*^9}, {
   3.9296159187984905`*^9, 3.9296159192561083`*^9}, {3.929627237234564*^9, 
   3.929627237361243*^9}, {3.9296273138838525`*^9, 3.9296273142187448`*^9}, {
   3.929627344422042*^9, 3.929627344757183*^9}, {3.9296275375265565`*^9, 
   3.9296275391086693`*^9}, {3.9477307674022903`*^9, 3.947730837126848*^9}, {
   3.9477309413376217`*^9, 3.947730999372221*^9}, {3.947731108399475*^9, 
   3.9477313430685368`*^9}, {3.9477314401284943`*^9, 
   3.9477314537650585`*^9}, {3.9477314884049816`*^9, 
   3.9477314932579536`*^9}, {3.947746440654045*^9, 3.947746446541012*^9}, {
   3.950691782815277*^9, 3.9506918113763866`*^9}, {3.950691854676449*^9, 
   3.950691854692873*^9}, {3.952842725014118*^9, 3.952842732082823*^9}, {
   3.9528427737819557`*^9, 3.952842777036602*^9}},
 CellTags->
  "Sensitivity-computation",ExpressionUUID->"e7b460ff-2c3e-428c-a2d0-\
619da649c9fd"]
}, Closed]]
}, Closed]]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Deleting generated cells", "Title",
 CellChangeTimes->{{3.9025559465149946`*^9, 
  3.9025559494966087`*^9}},ExpressionUUID->"03eaf80f-3fae-43b9-a3eb-\
4335a406e99e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"FrontEndTokenExecute", "[", "\"\<DeleteGeneratedCells\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FrontEndTokenExecute", "[", "\"\<SelectAll\>\"", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
  "FrontEndTokenExecute", "[", "\"\<SelectionCloseAllGroups\>\"", "]"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.9025559062888603`*^9, 3.9025559062888603`*^9}, {
   3.902555964086707*^9, 3.902555989355214*^9}, {3.9027292861725445`*^9, 
   3.9027292863536406`*^9}, {3.902729355782529*^9, 3.902729362414282*^9}, {
   3.9028515224589033`*^9, 3.902851539338553*^9}, 3.903972016103257*^9, {
   3.9181489156834326`*^9, 3.9181489191047463`*^9}, 3.92004831540319*^9},
 CellLabel->"In[93]:=",ExpressionUUID->"7d10b700-1bba-4e06-966c-f839d4e7cb52"]
}, Closed]]
},
WindowSize->{1429.5, 809.25},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
TaggingRules->{
 "WelcomeScreenSettings" -> {"FEStarting" -> False}, "TryRealOnly" -> False},
ShowCellTags->True,
Magnification:>1.1 Inherited,
FrontEndVersion->"14.2 for Microsoft Windows (64-bit) (December 26, 2024)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"4eb3f58a-f794-4bd8-8522-5a7ff6709a44"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{
 "Acceptance"->{
  Cell[5639, 141, 345, 7, 92, "Title",ExpressionUUID->"f64b31a6-3a21-452a-9085-9eaa0b5708aa",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
  Cell[6009, 152, 227, 5, 89, "Chapter",ExpressionUUID->"42604705-3a49-4b5e-8e1e-dfccfe5f7eee",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
  Cell[6239, 159, 3948, 100, 297, "Input",ExpressionUUID->"6b7757b1-3b9c-4467-ae36-04129f4d3e08",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
  Cell[10224, 264, 287, 6, 89, "Chapter",ExpressionUUID->"59619f15-a7a1-0e41-b4f5-0933e4622dbf",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
  Cell[10514, 272, 1845, 42, 151, "Input",ExpressionUUID->"ea90bc64-d743-2647-a02b-45e503c9cce8",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
  Cell[12396, 319, 544, 9, 89, "Chapter",ExpressionUUID->"623267a1-9c4d-426c-8448-961507b9c3b3",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
  Cell[12965, 332, 225, 4, 88, "Section",ExpressionUUID->"af114df9-b54e-3445-86d3-175387718476",
   CellTags->{"Number-of-events+sensitivity", "Acceptance"}],
  Cell[13193, 338, 3791, 76, 135, "Input",ExpressionUUID->"38e841c8-a539-4bae-bc89-9632f0a3f574",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
  Cell[17021, 419, 228, 5, 88, "Section",ExpressionUUID->"37172817-c603-4615-8d0d-26b3f798db56",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
  Cell[17252, 426, 10448, 260, 593, "Input",ExpressionUUID->"d1c6616d-40d9-464d-86b7-e83699d2bee4",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
  Cell[27737, 691, 297, 6, 88, "Section",ExpressionUUID->"c25fdc5a-83d4-4c0d-81f5-20768a5e4090",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
  Cell[28037, 699, 3401, 80, 255, "Input",ExpressionUUID->"ebd6615e-fb63-4dfd-9eda-c7ad887425a8",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
  Cell[31499, 786, 296, 6, 92, "Title",ExpressionUUID->"6aee5356-b39c-45f1-83d9-c276143eb260",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
  Cell[31820, 796, 212, 5, 89, "Chapter",ExpressionUUID->"5b02137e-da6c-4b5c-af74-2eb5ac2b44ac",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
  Cell[32035, 803, 3866, 93, 246, "Input",ExpressionUUID->"43688868-e9bd-4ecd-99df-1169d9e58d62",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
  Cell[35938, 901, 223, 5, 89, "Chapter",ExpressionUUID->"bf0d84bb-c61a-4372-9cdb-367edc141ad2",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
  Cell[36575, 919, 11185, 257, 758, "Input",ExpressionUUID->"393e1e21-5cde-41a9-ad41-077747a91d52",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
  Cell[47952, 1185, 238, 5, 89, "Chapter",ExpressionUUID->"e0515968-6d3b-4786-9380-8f6efe4a3b24",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
  Cell[48193, 1192, 2026, 48, 339, "Input",ExpressionUUID->"977ebf96-c528-46df-9e58-09288035e8b1",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}]},
 "Number-of-events+sensitivity"->{
  Cell[5639, 141, 345, 7, 92, "Title",ExpressionUUID->"f64b31a6-3a21-452a-9085-9eaa0b5708aa",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
  Cell[6009, 152, 227, 5, 89, "Chapter",ExpressionUUID->"42604705-3a49-4b5e-8e1e-dfccfe5f7eee",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
  Cell[6239, 159, 3948, 100, 297, "Input",ExpressionUUID->"6b7757b1-3b9c-4467-ae36-04129f4d3e08",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
  Cell[10224, 264, 287, 6, 89, "Chapter",ExpressionUUID->"59619f15-a7a1-0e41-b4f5-0933e4622dbf",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
  Cell[10514, 272, 1845, 42, 151, "Input",ExpressionUUID->"ea90bc64-d743-2647-a02b-45e503c9cce8",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
  Cell[12396, 319, 544, 9, 89, "Chapter",ExpressionUUID->"623267a1-9c4d-426c-8448-961507b9c3b3",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
  Cell[12965, 332, 225, 4, 88, "Section",ExpressionUUID->"af114df9-b54e-3445-86d3-175387718476",
   CellTags->{"Number-of-events+sensitivity", "Acceptance"}],
  Cell[13193, 338, 3791, 76, 135, "Input",ExpressionUUID->"38e841c8-a539-4bae-bc89-9632f0a3f574",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
  Cell[17021, 419, 228, 5, 88, "Section",ExpressionUUID->"37172817-c603-4615-8d0d-26b3f798db56",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
  Cell[17252, 426, 10448, 260, 593, "Input",ExpressionUUID->"d1c6616d-40d9-464d-86b7-e83699d2bee4",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
  Cell[27737, 691, 297, 6, 88, "Section",ExpressionUUID->"c25fdc5a-83d4-4c0d-81f5-20768a5e4090",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
  Cell[28037, 699, 3401, 80, 255, "Input",ExpressionUUID->"ebd6615e-fb63-4dfd-9eda-c7ad887425a8",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
  Cell[31499, 786, 296, 6, 92, "Title",ExpressionUUID->"6aee5356-b39c-45f1-83d9-c276143eb260",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
  Cell[31820, 796, 212, 5, 89, "Chapter",ExpressionUUID->"5b02137e-da6c-4b5c-af74-2eb5ac2b44ac",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
  Cell[32035, 803, 3866, 93, 246, "Input",ExpressionUUID->"43688868-e9bd-4ecd-99df-1169d9e58d62",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
  Cell[35938, 901, 223, 5, 89, "Chapter",ExpressionUUID->"bf0d84bb-c61a-4372-9cdb-367edc141ad2",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
  Cell[36575, 919, 11185, 257, 758, "Input",ExpressionUUID->"393e1e21-5cde-41a9-ad41-077747a91d52",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
  Cell[47952, 1185, 238, 5, 89, "Chapter",ExpressionUUID->"e0515968-6d3b-4786-9380-8f6efe4a3b24",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
  Cell[48193, 1192, 2026, 48, 339, "Input",ExpressionUUID->"977ebf96-c528-46df-9e58-09288035e8b1",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}]},
 "Number-of-events-computation+sensitivity"->{
  Cell[50268, 1246, 216, 4, 92, "Title",ExpressionUUID->"7ba28ec5-2133-49aa-b270-328c555fa667",
   CellTags->"Number-of-events-computation+sensitivity"],
  Cell[50509, 1254, 372, 7, 89, "Chapter",ExpressionUUID->"82430277-593c-4ac4-aed6-770f0ac48a74",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[50884, 1263, 833, 20, 67, "Input",ExpressionUUID->"6b6a0173-5291-439f-8dd3-9925152a05d9",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[51754, 1288, 411, 7, 89, "Chapter",ExpressionUUID->"7bea3ddf-2062-4996-86eb-43158cd187b5",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[52190, 1299, 321, 6, 88, "Section",ExpressionUUID->"33c6f4da-aa46-4293-b09c-5bf1476c4879",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[52514, 1307, 14835, 383, 978, "Input",ExpressionUUID->"055e1389-9973-4458-bf27-703cdb7d2f2f",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[67386, 1695, 306, 7, 88, "Section",ExpressionUUID->"0d5326e5-1661-4a0b-b124-0f126fec74e8",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[67695, 1704, 5571, 137, 330, "Input",ExpressionUUID->"96036022-8ea1-4b31-94b4-cfd19deeef28",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[73303, 1846, 416, 9, 88, "Section",ExpressionUUID->"46fc520f-767c-d340-9221-0b972ba2537f",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[73744, 1859, 325, 8, 73, "Subsection",ExpressionUUID->"683523e8-de9d-4a48-af32-73f7d9ee1d73",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[74072, 1869, 7633, 190, 444, "Input",ExpressionUUID->"a2c29630-dde0-c34e-8aaa-eff4e3735523",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[81742, 2064, 307, 7, 73, "Subsection",ExpressionUUID->"eb200bf1-31d9-1145-8f0b-9e37e982252d",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[82052, 2073, 11943, 280, 1051, "Input",ExpressionUUID->"7c7860b8-5703-0141-8a17-319c3a71af6a",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[94056, 2360, 511, 8, 89, "Chapter",ExpressionUUID->"9cc794fd-a470-45d1-9d7b-d197b9cca653",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[94592, 2372, 274, 5, 88, "Section",ExpressionUUID->"630539ee-977c-2545-b3de-ba9ba87a98cf",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[94869, 2379, 4321, 117, 261, "Input",ExpressionUUID->"1f3e10b7-5bf9-5840-8c8d-e5a73d80479a",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[99227, 2501, 316, 6, 88, "Section",ExpressionUUID->"155cd82d-e988-45a0-86c5-c7c90518cc5b",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[99546, 2509, 5450, 131, 506, "Input",ExpressionUUID->"1cbbcfc7-f3cf-4dd1-af94-6c36314e0c25",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[105033, 2645, 239, 5, 88, "Section",ExpressionUUID->"ccd146d2-e9c0-4ca4-8cac-bedbd820600b",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[105275, 2652, 25365, 644, 1499, "Input",ExpressionUUID->"c47ad2f1-f26f-4f12-a585-d6d7a0f1fe8b",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[130689, 3302, 218, 4, 89, "Chapter",ExpressionUUID->"5fbb4af8-dafa-4fc1-a941-3c9daaf61f32",
   CellTags->"Number-of-events-computation+sensitivity"],
  Cell[130932, 3310, 354, 7, 88, "Section",ExpressionUUID->"ff52be39-6054-4073-ad88-4e65dd856975",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[131311, 3321, 388, 7, 73, "Subsection",ExpressionUUID->"edc7fdf4-6199-4d22-a75d-3a4b2cfa255e",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[131702, 3330, 11412, 258, 714, "Input",ExpressionUUID->"f3d49c05-f284-45a4-a5fe-88a6b8986fc2",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[143151, 3593, 262, 5, 73, "Subsection",ExpressionUUID->"5cb1c0c2-01a6-436d-a5b6-f5173f552a98",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[143438, 3602, 253, 5, 63, "Subsubsection",ExpressionUUID->"433b1654-a2a2-4e45-852e-e246ff7a7422",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[143694, 3609, 3768, 91, 394, "Input",ExpressionUUID->"7d811336-b162-a24b-9f72-c21fe9eec453",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[147499, 3705, 261, 5, 63, "Subsubsection",ExpressionUUID->"31177619-07cd-164c-ac93-fb16b11673e3",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[147763, 3712, 17579, 419, 879, "Input",ExpressionUUID->"03fb6361-21bd-4434-b71f-bd0f724156f8",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[165391, 4137, 284, 5, 73, "Subsection",ExpressionUUID->"f37cf8bb-aa0d-41e8-b9f0-27df587e3cef",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[165678, 4144, 7515, 164, 662, "Input",ExpressionUUID->"9b09e04e-df6b-493d-adbb-e52373a5f090",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[173230, 4313, 309, 6, 73, "Subsection",ExpressionUUID->"43432343-64e9-42df-9641-4553672b70c4",
   CellTags->{"Number-of-events-computation+sensitivity", "Acceptance-computation"}],
  Cell[173542, 4321, 11681, 275, 531, "Input",ExpressionUUID->"80589d8c-c093-4f2d-b5ad-20bfa16f8bb5",
   CellTags->{"Number-of-events-computation+sensitivity", "Acceptance-computation"}],
  Cell[185260, 4601, 335, 8, 73, "Subsection",ExpressionUUID->"8faea506-240c-4530-9f24-b7a3f06c201e",
   CellTags->{"Number-of-events-computation+sensitivity", "Acceptance-computation"}],
  Cell[185598, 4611, 9785, 235, 613, "Input",ExpressionUUID->"db4a3dcf-78a9-45ef-b0f1-1af3bc9e781f",
   CellTags->{"Number-of-events-computation+sensitivity", "Acceptance-computation"}],
  Cell[195420, 4851, 264, 5, 73, "Subsection",ExpressionUUID->"81f7b327-4279-40bc-bdd8-0cdc2e2facd4",
   CellTags->{"Number-of-events-computation+sensitivity", "Acceptance-computation"}],
  Cell[195687, 4858, 22647, 525, 1387, "Input",ExpressionUUID->"cb90c87c-f03c-424d-b49a-66ae1ce879f0",
   CellTags->{"Number-of-events-computation+sensitivity", "Acceptance-computation"}],
  Cell[229138, 5656, 236, 4, 92, "Title",ExpressionUUID->"d9cc7f48-090a-4576-84bf-78e61b4f24e1",
   CellTags->"Number-of-events-computation+sensitivity"],
  Cell[229399, 5664, 213, 4, 89, "Chapter",ExpressionUUID->"2954a636-16b9-43d9-baa5-a2a8079c668c",
   CellTags->"Number-of-events-computation+sensitivity"],
  Cell[229615, 5670, 8056, 188, 465, "Input",ExpressionUUID->"8c0b6592-284c-4a87-9a77-8e50d3c85c08",
   CellTags->"Number-of-events-computation+sensitivity"],
  Cell[237708, 5863, 209, 4, 89, "Chapter",ExpressionUUID->"94264685-3bea-4e26-b629-98b9c56f1aa5",
   CellTags->"Number-of-events-computation+sensitivity"],
  Cell[237920, 5869, 4691, 100, 318, "Input",ExpressionUUID->"d8897b55-8608-4f93-a9b8-e4eb10318129",
   CellTags->"Number-of-events-computation+sensitivity"]},
 "Acceptance-computation"->{
  Cell[50509, 1254, 372, 7, 89, "Chapter",ExpressionUUID->"82430277-593c-4ac4-aed6-770f0ac48a74",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[50884, 1263, 833, 20, 67, "Input",ExpressionUUID->"6b6a0173-5291-439f-8dd3-9925152a05d9",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[51754, 1288, 411, 7, 89, "Chapter",ExpressionUUID->"7bea3ddf-2062-4996-86eb-43158cd187b5",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[52190, 1299, 321, 6, 88, "Section",ExpressionUUID->"33c6f4da-aa46-4293-b09c-5bf1476c4879",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[52514, 1307, 14835, 383, 978, "Input",ExpressionUUID->"055e1389-9973-4458-bf27-703cdb7d2f2f",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[67386, 1695, 306, 7, 88, "Section",ExpressionUUID->"0d5326e5-1661-4a0b-b124-0f126fec74e8",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[67695, 1704, 5571, 137, 330, "Input",ExpressionUUID->"96036022-8ea1-4b31-94b4-cfd19deeef28",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[73303, 1846, 416, 9, 88, "Section",ExpressionUUID->"46fc520f-767c-d340-9221-0b972ba2537f",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[73744, 1859, 325, 8, 73, "Subsection",ExpressionUUID->"683523e8-de9d-4a48-af32-73f7d9ee1d73",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[74072, 1869, 7633, 190, 444, "Input",ExpressionUUID->"a2c29630-dde0-c34e-8aaa-eff4e3735523",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[81742, 2064, 307, 7, 73, "Subsection",ExpressionUUID->"eb200bf1-31d9-1145-8f0b-9e37e982252d",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[82052, 2073, 11943, 280, 1051, "Input",ExpressionUUID->"7c7860b8-5703-0141-8a17-319c3a71af6a",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[94056, 2360, 511, 8, 89, "Chapter",ExpressionUUID->"9cc794fd-a470-45d1-9d7b-d197b9cca653",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[94592, 2372, 274, 5, 88, "Section",ExpressionUUID->"630539ee-977c-2545-b3de-ba9ba87a98cf",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[94869, 2379, 4321, 117, 261, "Input",ExpressionUUID->"1f3e10b7-5bf9-5840-8c8d-e5a73d80479a",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[99227, 2501, 316, 6, 88, "Section",ExpressionUUID->"155cd82d-e988-45a0-86c5-c7c90518cc5b",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[99546, 2509, 5450, 131, 506, "Input",ExpressionUUID->"1cbbcfc7-f3cf-4dd1-af94-6c36314e0c25",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[105033, 2645, 239, 5, 88, "Section",ExpressionUUID->"ccd146d2-e9c0-4ca4-8cac-bedbd820600b",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[105275, 2652, 25365, 644, 1499, "Input",ExpressionUUID->"c47ad2f1-f26f-4f12-a585-d6d7a0f1fe8b",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[130932, 3310, 354, 7, 88, "Section",ExpressionUUID->"ff52be39-6054-4073-ad88-4e65dd856975",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[131311, 3321, 388, 7, 73, "Subsection",ExpressionUUID->"edc7fdf4-6199-4d22-a75d-3a4b2cfa255e",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[131702, 3330, 11412, 258, 714, "Input",ExpressionUUID->"f3d49c05-f284-45a4-a5fe-88a6b8986fc2",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[143151, 3593, 262, 5, 73, "Subsection",ExpressionUUID->"5cb1c0c2-01a6-436d-a5b6-f5173f552a98",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[143438, 3602, 253, 5, 63, "Subsubsection",ExpressionUUID->"433b1654-a2a2-4e45-852e-e246ff7a7422",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[143694, 3609, 3768, 91, 394, "Input",ExpressionUUID->"7d811336-b162-a24b-9f72-c21fe9eec453",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[147499, 3705, 261, 5, 63, "Subsubsection",ExpressionUUID->"31177619-07cd-164c-ac93-fb16b11673e3",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[147763, 3712, 17579, 419, 879, "Input",ExpressionUUID->"03fb6361-21bd-4434-b71f-bd0f724156f8",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[165391, 4137, 284, 5, 73, "Subsection",ExpressionUUID->"f37cf8bb-aa0d-41e8-b9f0-27df587e3cef",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[165678, 4144, 7515, 164, 662, "Input",ExpressionUUID->"9b09e04e-df6b-493d-adbb-e52373a5f090",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[173230, 4313, 309, 6, 73, "Subsection",ExpressionUUID->"43432343-64e9-42df-9641-4553672b70c4",
   CellTags->{"Number-of-events-computation+sensitivity", "Acceptance-computation"}],
  Cell[173542, 4321, 11681, 275, 531, "Input",ExpressionUUID->"80589d8c-c093-4f2d-b5ad-20bfa16f8bb5",
   CellTags->{"Number-of-events-computation+sensitivity", "Acceptance-computation"}],
  Cell[185260, 4601, 335, 8, 73, "Subsection",ExpressionUUID->"8faea506-240c-4530-9f24-b7a3f06c201e",
   CellTags->{"Number-of-events-computation+sensitivity", "Acceptance-computation"}],
  Cell[185598, 4611, 9785, 235, 613, "Input",ExpressionUUID->"db4a3dcf-78a9-45ef-b0f1-1af3bc9e781f",
   CellTags->{"Number-of-events-computation+sensitivity", "Acceptance-computation"}],
  Cell[195420, 4851, 264, 5, 73, "Subsection",ExpressionUUID->"81f7b327-4279-40bc-bdd8-0cdc2e2facd4",
   CellTags->{"Number-of-events-computation+sensitivity", "Acceptance-computation"}],
  Cell[195687, 4858, 22647, 525, 1387, "Input",ExpressionUUID->"cb90c87c-f03c-424d-b49a-66ae1ce879f0",
   CellTags->{"Number-of-events-computation+sensitivity", "Acceptance-computation"}]},
 "Sensitivity"->{
  Cell[242660, 5975, 189, 3, 92, "Title",ExpressionUUID->"02de58fe-c9d7-4ae0-8388-b0795f1824e0",
   CellTags->"Sensitivity"],
  Cell[242874, 5982, 188, 3, 89, "Chapter",ExpressionUUID->"658980e6-d3df-4043-b231-c05500456be9",
   CellTags->"Sensitivity"],
  Cell[243065, 5987, 7581, 195, 632, "Input",ExpressionUUID->"4445aaea-e6ea-488d-a991-f594a83b822e",
   CellTags->"Sensitivity"]},
 "Sensitivity-computation"->{
  Cell[250683, 6187, 463, 9, 89, "Chapter",ExpressionUUID->"ce0499a7-0458-4fca-8906-49450de0903c",
   CellTags->"Sensitivity-computation"],
  Cell[251171, 6200, 210, 4, 88, "Section",ExpressionUUID->"10aa4c32-023e-4786-bf5f-46beab483d63",
   CellTags->"Sensitivity-computation"],
  Cell[251384, 6206, 12253, 287, 826, "Input",ExpressionUUID->"0f11c942-1cb1-4bab-9d05-80dde7ee4ac3",
   CellTags->"Sensitivity-computation"],
  Cell[263674, 6498, 291, 5, 88, "Section",ExpressionUUID->"3e602227-00a3-4fb9-8b9d-550ce649b396",
   CellTags->"Sensitivity-computation"],
  Cell[263968, 6505, 12651, 312, 653, "Input",ExpressionUUID->"b16e043c-492d-45d6-a73a-c48a6829d23f",
   CellTags->"Sensitivity-computation"],
  Cell[276668, 6823, 198, 4, 89, "Chapter",ExpressionUUID->"534554ab-08a0-db4f-8042-dce9fe4afd6c",
   CellTags->"Sensitivity-computation"],
  Cell[276891, 6831, 208, 4, 88, "Section",ExpressionUUID->"b3d2ce0f-6378-9147-9075-34edd6f0aa7e",
   CellTags->"Sensitivity-computation"],
  Cell[277102, 6837, 8139, 210, 380, "Input",ExpressionUUID->"8a2dcc3f-cd0c-8443-a903-c3befebfddbc",
   CellTags->"Sensitivity-computation"],
  Cell[285510, 7058, 348, 10, 88, "Section",ExpressionUUID->"39e6da3a-e227-483d-be39-0d9a1bce65bb",
   CellTags->"Sensitivity-computation"],
  Cell[285861, 7070, 4611, 113, 201, "Input",ExpressionUUID->"d4d65c7b-8dd1-4283-851a-4fc0b32dadbc",
   CellTags->"Sensitivity-computation"],
  Cell[290521, 7189, 196, 4, 89, "Chapter",ExpressionUUID->"b5c87f48-3922-4ed2-b686-e303a73856dc",
   CellTags->"Sensitivity-computation"],
  Cell[290742, 7197, 205, 4, 88, "Section",ExpressionUUID->"3d4bde77-8bbe-4c70-80b5-0dd60c8bca64",
   CellTags->"Sensitivity-computation"],
  Cell[290950, 7203, 4679, 124, 363, "Input",ExpressionUUID->"9eb47f4c-1ae9-473e-acfc-c13e022083f4",
   CellTags->"Sensitivity-computation"],
  Cell[295666, 7332, 196, 4, 88, "Section",ExpressionUUID->"20efcc73-93a4-4db0-b95c-2c9126c9e7ce",
   CellTags->"Sensitivity-computation"],
  Cell[296020, 7345, 216, 4, 73, "Subsection",ExpressionUUID->"8ea89b86-15dc-2b4e-8097-f8b98e610f11",
   CellTags->"Sensitivity-computation"],
  Cell[296239, 7351, 6485, 165, 515, "Input",ExpressionUUID->"7ddbd626-6352-b64a-b6dc-33dc9091a4ee",
   CellTags->"Sensitivity-computation"],
  Cell[302761, 7521, 209, 4, 73, "Subsection",ExpressionUUID->"19da381b-a10f-0d4b-840b-faf77888349b",
   CellTags->"Sensitivity-computation"],
  Cell[302973, 7527, 12524, 293, 486, "Input",ExpressionUUID->"e7b460ff-2c3e-428c-a2d0-619da649c9fd",
   CellTags->"Sensitivity-computation"]}
 }
*)
(*CellTagsIndex
CellTagsIndex->{
 {"Acceptance", 317069, 7866},
 {"Number-of-events+sensitivity", 320134, 7905},
 {"Number-of-events-computation+sensitivity", 323211, 7944},
 {"Acceptance-computation", 330869, 8029},
 {"Sensitivity", 337418, 8100},
 {"Sensitivity-computation", 337833, 8107}
 }
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 207, 3, 106, "Title",ExpressionUUID->"3a6189ab-b48c-4865-a933-cc9614b95029"],
Cell[790, 27, 4812, 109, 491, "Input",ExpressionUUID->"67d16bcb-6808-46ec-ae03-72ce61d72bb8"]
}, Closed]],
Cell[CellGroupData[{
Cell[5639, 141, 345, 7, 92, "Title",ExpressionUUID->"f64b31a6-3a21-452a-9085-9eaa0b5708aa",
 CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
Cell[CellGroupData[{
Cell[6009, 152, 227, 5, 89, "Chapter",ExpressionUUID->"42604705-3a49-4b5e-8e1e-dfccfe5f7eee",
 CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
Cell[6239, 159, 3948, 100, 297, "Input",ExpressionUUID->"6b7757b1-3b9c-4467-ae36-04129f4d3e08",
 CellTags->{"Acceptance", "Number-of-events+sensitivity"}]
}, Closed]],
Cell[CellGroupData[{
Cell[10224, 264, 287, 6, 89, "Chapter",ExpressionUUID->"59619f15-a7a1-0e41-b4f5-0933e4622dbf",
 CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
Cell[10514, 272, 1845, 42, 151, "Input",ExpressionUUID->"ea90bc64-d743-2647-a02b-45e503c9cce8",
 CellTags->{"Acceptance", "Number-of-events+sensitivity"}]
}, Closed]],
Cell[CellGroupData[{
Cell[12396, 319, 544, 9, 89, "Chapter",ExpressionUUID->"623267a1-9c4d-426c-8448-961507b9c3b3",
 CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
Cell[CellGroupData[{
Cell[12965, 332, 225, 4, 88, "Section",ExpressionUUID->"af114df9-b54e-3445-86d3-175387718476",
 CellTags->{"Number-of-events+sensitivity", "Acceptance"}],
Cell[13193, 338, 3791, 76, 135, "Input",ExpressionUUID->"38e841c8-a539-4bae-bc89-9632f0a3f574",
 CellTags->{"Acceptance", "Number-of-events+sensitivity"}]
}, Closed]],
Cell[CellGroupData[{
Cell[17021, 419, 228, 5, 88, "Section",ExpressionUUID->"37172817-c603-4615-8d0d-26b3f798db56",
 CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
Cell[17252, 426, 10448, 260, 593, "Input",ExpressionUUID->"d1c6616d-40d9-464d-86b7-e83699d2bee4",
 CellTags->{"Acceptance", "Number-of-events+sensitivity"}]
}, Closed]],
Cell[CellGroupData[{
Cell[27737, 691, 297, 6, 88, "Section",ExpressionUUID->"c25fdc5a-83d4-4c0d-81f5-20768a5e4090",
 CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
Cell[28037, 699, 3401, 80, 255, "Input",ExpressionUUID->"ebd6615e-fb63-4dfd-9eda-c7ad887425a8",
 CellTags->{"Acceptance", "Number-of-events+sensitivity"}]
}, Closed]]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[31499, 786, 296, 6, 92, "Title",ExpressionUUID->"6aee5356-b39c-45f1-83d9-c276143eb260",
 CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
Cell[CellGroupData[{
Cell[31820, 796, 212, 5, 89, "Chapter",ExpressionUUID->"5b02137e-da6c-4b5c-af74-2eb5ac2b44ac",
 CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
Cell[32035, 803, 3866, 93, 246, "Input",ExpressionUUID->"43688868-e9bd-4ecd-99df-1169d9e58d62",
 CellTags->{"Acceptance", "Number-of-events+sensitivity"}]
}, Closed]],
Cell[CellGroupData[{
Cell[35938, 901, 223, 5, 89, "Chapter",ExpressionUUID->"bf0d84bb-c61a-4372-9cdb-367edc141ad2",
 CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
Cell[36164, 908, 408, 9, 31, "Input",ExpressionUUID->"c6778b23-db29-984b-bffc-bad4bef5efb8"],
Cell[36575, 919, 11185, 257, 758, "Input",ExpressionUUID->"393e1e21-5cde-41a9-ad41-077747a91d52",
 CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
Cell[47763, 1178, 152, 2, 31, "Input",ExpressionUUID->"fe0c1ee1-e318-8a4d-a859-60807ce8369c"]
}, Closed]],
Cell[CellGroupData[{
Cell[47952, 1185, 238, 5, 89, "Chapter",ExpressionUUID->"e0515968-6d3b-4786-9380-8f6efe4a3b24",
 CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
Cell[48193, 1192, 2026, 48, 339, "Input",ExpressionUUID->"977ebf96-c528-46df-9e58-09288035e8b1",
 CellTags->{"Acceptance", "Number-of-events+sensitivity"}]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[50268, 1246, 216, 4, 92, "Title",ExpressionUUID->"7ba28ec5-2133-49aa-b270-328c555fa667",
 CellTags->"Number-of-events-computation+sensitivity"],
Cell[CellGroupData[{
Cell[50509, 1254, 372, 7, 89, "Chapter",ExpressionUUID->"82430277-593c-4ac4-aed6-770f0ac48a74",
 CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
Cell[50884, 1263, 833, 20, 67, "Input",ExpressionUUID->"6b6a0173-5291-439f-8dd3-9925152a05d9",
 CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}]
}, Closed]],
Cell[CellGroupData[{
Cell[51754, 1288, 411, 7, 89, "Chapter",ExpressionUUID->"7bea3ddf-2062-4996-86eb-43158cd187b5",
 CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
Cell[CellGroupData[{
Cell[52190, 1299, 321, 6, 88, "Section",ExpressionUUID->"33c6f4da-aa46-4293-b09c-5bf1476c4879",
 CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
Cell[52514, 1307, 14835, 383, 978, "Input",ExpressionUUID->"055e1389-9973-4458-bf27-703cdb7d2f2f",
 CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}]
}, Closed]],
Cell[CellGroupData[{
Cell[67386, 1695, 306, 7, 88, "Section",ExpressionUUID->"0d5326e5-1661-4a0b-b124-0f126fec74e8",
 CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
Cell[67695, 1704, 5571, 137, 330, "Input",ExpressionUUID->"96036022-8ea1-4b31-94b4-cfd19deeef28",
 CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}]
}, Closed]],
Cell[CellGroupData[{
Cell[73303, 1846, 416, 9, 88, "Section",ExpressionUUID->"46fc520f-767c-d340-9221-0b972ba2537f",
 CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
Cell[CellGroupData[{
Cell[73744, 1859, 325, 8, 73, "Subsection",ExpressionUUID->"683523e8-de9d-4a48-af32-73f7d9ee1d73",
 CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
Cell[74072, 1869, 7633, 190, 444, "Input",ExpressionUUID->"a2c29630-dde0-c34e-8aaa-eff4e3735523",
 CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}]
}, Closed]],
Cell[CellGroupData[{
Cell[81742, 2064, 307, 7, 73, "Subsection",ExpressionUUID->"eb200bf1-31d9-1145-8f0b-9e37e982252d",
 CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
Cell[82052, 2073, 11943, 280, 1051, "Input",ExpressionUUID->"7c7860b8-5703-0141-8a17-319c3a71af6a",
 CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}]
}, Closed]]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[94056, 2360, 511, 8, 89, "Chapter",ExpressionUUID->"9cc794fd-a470-45d1-9d7b-d197b9cca653",
 CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
Cell[CellGroupData[{
Cell[94592, 2372, 274, 5, 88, "Section",ExpressionUUID->"630539ee-977c-2545-b3de-ba9ba87a98cf",
 CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
Cell[94869, 2379, 4321, 117, 261, "Input",ExpressionUUID->"1f3e10b7-5bf9-5840-8c8d-e5a73d80479a",
 CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}]
}, Closed]],
Cell[CellGroupData[{
Cell[99227, 2501, 316, 6, 88, "Section",ExpressionUUID->"155cd82d-e988-45a0-86c5-c7c90518cc5b",
 CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
Cell[99546, 2509, 5450, 131, 506, "Input",ExpressionUUID->"1cbbcfc7-f3cf-4dd1-af94-6c36314e0c25",
 CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}]
}, Closed]],
Cell[CellGroupData[{
Cell[105033, 2645, 239, 5, 88, "Section",ExpressionUUID->"ccd146d2-e9c0-4ca4-8cac-bedbd820600b",
 CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
Cell[105275, 2652, 25365, 644, 1499, "Input",ExpressionUUID->"c47ad2f1-f26f-4f12-a585-d6d7a0f1fe8b",
 CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[130689, 3302, 218, 4, 89, "Chapter",ExpressionUUID->"5fbb4af8-dafa-4fc1-a941-3c9daaf61f32",
 CellTags->"Number-of-events-computation+sensitivity"],
Cell[CellGroupData[{
Cell[130932, 3310, 354, 7, 88, "Section",ExpressionUUID->"ff52be39-6054-4073-ad88-4e65dd856975",
 CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
Cell[CellGroupData[{
Cell[131311, 3321, 388, 7, 73, "Subsection",ExpressionUUID->"edc7fdf4-6199-4d22-a75d-3a4b2cfa255e",
 CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
Cell[131702, 3330, 11412, 258, 714, "Input",ExpressionUUID->"f3d49c05-f284-45a4-a5fe-88a6b8986fc2",
 CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}]
}, Closed]],
Cell[CellGroupData[{
Cell[143151, 3593, 262, 5, 73, "Subsection",ExpressionUUID->"5cb1c0c2-01a6-436d-a5b6-f5173f552a98",
 CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
Cell[CellGroupData[{
Cell[143438, 3602, 253, 5, 63, "Subsubsection",ExpressionUUID->"433b1654-a2a2-4e45-852e-e246ff7a7422",
 CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
Cell[143694, 3609, 3768, 91, 394, "Input",ExpressionUUID->"7d811336-b162-a24b-9f72-c21fe9eec453",
 CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}]
}, Closed]],
Cell[CellGroupData[{
Cell[147499, 3705, 261, 5, 63, "Subsubsection",ExpressionUUID->"31177619-07cd-164c-ac93-fb16b11673e3",
 CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
Cell[147763, 3712, 17579, 419, 879, "Input",ExpressionUUID->"03fb6361-21bd-4434-b71f-bd0f724156f8",
 CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[165391, 4137, 284, 5, 73, "Subsection",ExpressionUUID->"f37cf8bb-aa0d-41e8-b9f0-27df587e3cef",
 CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
Cell[165678, 4144, 7515, 164, 662, "Input",ExpressionUUID->"9b09e04e-df6b-493d-adbb-e52373a5f090",
 CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}]
}, Closed]],
Cell[CellGroupData[{
Cell[173230, 4313, 309, 6, 73, "Subsection",ExpressionUUID->"43432343-64e9-42df-9641-4553672b70c4",
 CellTags->{"Number-of-events-computation+sensitivity", "Acceptance-computation"}],
Cell[173542, 4321, 11681, 275, 531, "Input",ExpressionUUID->"80589d8c-c093-4f2d-b5ad-20bfa16f8bb5",
 CellTags->{"Number-of-events-computation+sensitivity", "Acceptance-computation"}]
}, Closed]],
Cell[CellGroupData[{
Cell[185260, 4601, 335, 8, 73, "Subsection",ExpressionUUID->"8faea506-240c-4530-9f24-b7a3f06c201e",
 CellTags->{"Number-of-events-computation+sensitivity", "Acceptance-computation"}],
Cell[185598, 4611, 9785, 235, 613, "Input",ExpressionUUID->"db4a3dcf-78a9-45ef-b0f1-1af3bc9e781f",
 CellTags->{"Number-of-events-computation+sensitivity", "Acceptance-computation"}]
}, Closed]],
Cell[CellGroupData[{
Cell[195420, 4851, 264, 5, 73, "Subsection",ExpressionUUID->"81f7b327-4279-40bc-bdd8-0cdc2e2facd4",
 CellTags->{"Number-of-events-computation+sensitivity", "Acceptance-computation"}],
Cell[195687, 4858, 22647, 525, 1387, "Input",ExpressionUUID->"cb90c87c-f03c-424d-b49a-66ae1ce879f0",
 CellTags->{"Number-of-events-computation+sensitivity", "Acceptance-computation"}]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[218383, 5389, 201, 4, 72, "Section",ExpressionUUID->"52ce57d0-f982-4567-bb71-be778a9c5b79"],
Cell[CellGroupData[{
Cell[218609, 5397, 271, 4, 58, "Subsection",ExpressionUUID->"291df21e-e39d-48d1-9816-af096ec7783f"],
Cell[218883, 5403, 10182, 245, 578, "Input",ExpressionUUID->"ab7b5982-2d2a-4e03-a4a9-eb782d90bec0"]
}, Closed]]
}, Closed]]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[229138, 5656, 236, 4, 92, "Title",ExpressionUUID->"d9cc7f48-090a-4576-84bf-78e61b4f24e1",
 CellTags->"Number-of-events-computation+sensitivity"],
Cell[CellGroupData[{
Cell[229399, 5664, 213, 4, 89, "Chapter",ExpressionUUID->"2954a636-16b9-43d9-baa5-a2a8079c668c",
 CellTags->"Number-of-events-computation+sensitivity"],
Cell[229615, 5670, 8056, 188, 465, "Input",ExpressionUUID->"8c0b6592-284c-4a87-9a77-8e50d3c85c08",
 CellTags->"Number-of-events-computation+sensitivity"]
}, Closed]],
Cell[CellGroupData[{
Cell[237708, 5863, 209, 4, 89, "Chapter",ExpressionUUID->"94264685-3bea-4e26-b629-98b9c56f1aa5",
 CellTags->"Number-of-events-computation+sensitivity"],
Cell[237920, 5869, 4691, 100, 318, "Input",ExpressionUUID->"d8897b55-8608-4f93-a9b8-e4eb10318129",
 CellTags->"Number-of-events-computation+sensitivity"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[242660, 5975, 189, 3, 92, "Title",ExpressionUUID->"02de58fe-c9d7-4ae0-8388-b0795f1824e0",
 CellTags->"Sensitivity"],
Cell[CellGroupData[{
Cell[242874, 5982, 188, 3, 89, "Chapter",ExpressionUUID->"658980e6-d3df-4043-b231-c05500456be9",
 CellTags->"Sensitivity"],
Cell[243065, 5987, 7581, 195, 632, "Input",ExpressionUUID->"4445aaea-e6ea-488d-a991-f594a83b822e",
 CellTags->"Sensitivity"]
}, Closed]],
Cell[CellGroupData[{
Cell[250683, 6187, 463, 9, 89, "Chapter",ExpressionUUID->"ce0499a7-0458-4fca-8906-49450de0903c",
 CellTags->"Sensitivity-computation"],
Cell[CellGroupData[{
Cell[251171, 6200, 210, 4, 88, "Section",ExpressionUUID->"10aa4c32-023e-4786-bf5f-46beab483d63",
 CellTags->"Sensitivity-computation"],
Cell[251384, 6206, 12253, 287, 826, "Input",ExpressionUUID->"0f11c942-1cb1-4bab-9d05-80dde7ee4ac3",
 CellTags->"Sensitivity-computation"]
}, Closed]],
Cell[CellGroupData[{
Cell[263674, 6498, 291, 5, 88, "Section",ExpressionUUID->"3e602227-00a3-4fb9-8b9d-550ce649b396",
 CellTags->"Sensitivity-computation"],
Cell[263968, 6505, 12651, 312, 653, "Input",ExpressionUUID->"b16e043c-492d-45d6-a73a-c48a6829d23f",
 CellTags->"Sensitivity-computation"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[276668, 6823, 198, 4, 89, "Chapter",ExpressionUUID->"534554ab-08a0-db4f-8042-dce9fe4afd6c",
 CellTags->"Sensitivity-computation"],
Cell[CellGroupData[{
Cell[276891, 6831, 208, 4, 88, "Section",ExpressionUUID->"b3d2ce0f-6378-9147-9075-34edd6f0aa7e",
 CellTags->"Sensitivity-computation"],
Cell[277102, 6837, 8139, 210, 380, "Input",ExpressionUUID->"8a2dcc3f-cd0c-8443-a903-c3befebfddbc",
 CellTags->"Sensitivity-computation"],
Cell[285244, 7049, 229, 4, 31, "Input",ExpressionUUID->"14d1d7c3-714e-164c-ab23-82dd99bab29b"]
}, Closed]],
Cell[CellGroupData[{
Cell[285510, 7058, 348, 10, 88, "Section",ExpressionUUID->"39e6da3a-e227-483d-be39-0d9a1bce65bb",
 CellTags->"Sensitivity-computation"],
Cell[285861, 7070, 4611, 113, 201, "Input",ExpressionUUID->"d4d65c7b-8dd1-4283-851a-4fc0b32dadbc",
 CellTags->"Sensitivity-computation"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[290521, 7189, 196, 4, 89, "Chapter",ExpressionUUID->"b5c87f48-3922-4ed2-b686-e303a73856dc",
 CellTags->"Sensitivity-computation"],
Cell[CellGroupData[{
Cell[290742, 7197, 205, 4, 88, "Section",ExpressionUUID->"3d4bde77-8bbe-4c70-80b5-0dd60c8bca64",
 CellTags->"Sensitivity-computation"],
Cell[290950, 7203, 4679, 124, 363, "Input",ExpressionUUID->"9eb47f4c-1ae9-473e-acfc-c13e022083f4",
 CellTags->"Sensitivity-computation"]
}, Closed]],
Cell[CellGroupData[{
Cell[295666, 7332, 196, 4, 88, "Section",ExpressionUUID->"20efcc73-93a4-4db0-b95c-2c9126c9e7ce",
 CellTags->"Sensitivity-computation"],
Cell[295865, 7338, 130, 3, 31, "Input",ExpressionUUID->"86d361cd-16a5-9e4a-b23c-af68e8f9a542"],
Cell[CellGroupData[{
Cell[296020, 7345, 216, 4, 73, "Subsection",ExpressionUUID->"8ea89b86-15dc-2b4e-8097-f8b98e610f11",
 CellTags->"Sensitivity-computation"],
Cell[296239, 7351, 6485, 165, 515, "Input",ExpressionUUID->"7ddbd626-6352-b64a-b6dc-33dc9091a4ee",
 CellTags->"Sensitivity-computation"]
}, Closed]],
Cell[CellGroupData[{
Cell[302761, 7521, 209, 4, 73, "Subsection",ExpressionUUID->"19da381b-a10f-0d4b-840b-faf77888349b",
 CellTags->"Sensitivity-computation"],
Cell[302973, 7527, 12524, 293, 486, "Input",ExpressionUUID->"e7b460ff-2c3e-428c-a2d0-619da649c9fd",
 CellTags->"Sensitivity-computation"]
}, Closed]]
}, Closed]]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[315570, 7828, 171, 3, 77, "Title",ExpressionUUID->"03eaf80f-3fae-43b9-a3eb-4335a406e99e"],
Cell[315744, 7833, 807, 15, 73, "Input",ExpressionUUID->"7d10b700-1bba-4e06-966c-f839d4e7cb52"]
}, Closed]]
}
]
*)

