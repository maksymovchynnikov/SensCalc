(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    440371,      10078]
NotebookOptionsPosition[    395449,       9420]
NotebookOutlinePosition[    422321,       9761]
CellTagsIndexPosition[    422017,       9751]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Just launch the code below to run the notebook (shift+enter)", "Title",
 CellChangeTimes->{{3.8934376452895875`*^9, 
  3.8934376644509068`*^9}},ExpressionUUID->"81e378d2-3dbb-467e-88a3-\
3d73d3bd8f3c"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ParallelEvaluate", "[", 
   RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BlockEvaluation", "[", "tag_", "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"nb", "=", 
      RowBox[{"EvaluationNotebook", "[", "]"}]}], ";", "\n", 
     RowBox[{"NotebookFind", "[", 
      RowBox[{"nb", ",", "tag", ",", "All", ",", "CellTags"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"SelectionEvaluate", "[", "nb", "]"}]}]}], "\[IndentingNewLine]",
    "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CloseKernels", "[", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"LaunchKernels", "[", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"choiceslist", "=", 
   RowBox[{"{", 
    RowBox[{"\"\<Tabulated Nevents+sensitivity\>\"", 
     ",", "\"\<Sensitivity only (tabulated Nevents must be produced before)\>\
\"", ",", "\"\<Tabulated Nevents only\>\"", ",", "\"\<Acceptance\>\""}], 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"taglist", "[", "\"\<Acceptance\>\"", "]"}], 
   "=", "\"\<Acceptance\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"taglist", "[", "\"\<Tabulated Nevents+sensitivity\>\"", "]"}], "=", 
   RowBox[{
    RowBox[{"taglist", "[", "\"\<Tabulated Nevents only\>\"", "]"}], 
    "=", "\"\<Number-of-events+sensitivity\>\""}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
   "taglist", 
    "[", "\"\<Sensitivity only (tabulated Nevents must be produced \
before)\>\"", "]"}], "=", "\"\<Sensitivity\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NotebookEvaluate", "[", 
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"NotebookDirectory", "[", "]"}], 
      ",", "\"\<codes/dialog-windows.nb\>\""}], "}"}], "]"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"launchoptions", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"Keys", "[", 
     RowBox[{"DownValues", "@", "taglist"}], "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", "1", ",", "1"}], "]"}], "]"}], "//", "Sort"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MapThread", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"explanationlist", "[", "#1", "]"}], "=", "#2"}], ")"}], "&"}],
     ",", 
    RowBox[{"{", 
     RowBox[{"launchoptions", ",", 
      RowBox[{"{", 
       RowBox[{"\"\<Produce acceptances plots only (see Fig. 12 and \
explanation in text of 2305.13383)\>\"", 
        ",", "\"\<Produce sensitivities assuming that the tabulated number of \
events has been produced before\>\"", 
        ",", "\"\<Produce tabulated number of events (mass, coupling, \
Nevents(mass, coupling))\>\"", 
        ",", "\"\<Produce tabulated number of events and then \
sensitivity\>\""}], "}"}]}], "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"computationchoice", "=", 
  RowBox[{"selectionDialogExplanationOneOption", "[", 
   RowBox[{"launchoptions", ",", 
    RowBox[{
     RowBox[{
      RowBox[{"explanationlist", "[", "#", "]"}], "&"}], "/@", 
     "launchoptions"}], 
    ",", "\"\<Select the regime of launching the notebook\>\"", ",", "250"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
    "computationchoice", "==", "\"\<Tabulated Nevents+sensitivity\>\""}], ",", 
    RowBox[{"sensComp", "=", "True"}], ",", 
    RowBox[{"sensComp", "=", "False"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"tagselected", "=", 
  RowBox[{"taglist", "[", "computationchoice", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"BlockEvaluation", "[", "tagselected", "]"}]}], "Input",
 CellChangeTimes->{{3.893437585709897*^9, 3.8934375895369635`*^9}, {
   3.8934376329497385`*^9, 3.893437658846809*^9}, {3.8935727521376963`*^9, 
   3.893572934736693*^9}, {3.893572994500379*^9, 3.8935729949911523`*^9}, {
   3.893665375102826*^9, 3.893665376076692*^9}, {3.8950545750556335`*^9, 
   3.895054575228654*^9}, {3.895127153564183*^9, 3.895127164693226*^9}, {
   3.897018713087062*^9, 3.8970187140160637`*^9}, 3.9025631680253534`*^9, 
   3.9027295491093626`*^9, {3.902973838262621*^9, 3.9029738915629826`*^9}, {
   3.902975133619383*^9, 3.902975143436801*^9}, {3.90302115808084*^9, 
   3.9030211591531773`*^9}, 3.9146684818602076`*^9, {3.916810465745122*^9, 
   3.9168104701526756`*^9}, {3.916810720597439*^9, 3.916810721605311*^9}, {
   3.916821884327306*^9, 3.916821884571699*^9}, {3.9169445117900352`*^9, 
   3.9169445163241587`*^9}, {3.9169934041778717`*^9, 3.916993453287859*^9}, {
   3.916993752007572*^9, 3.916993756888117*^9}, {3.9170212464226036`*^9, 
   3.917021246654711*^9}, {3.947651654134136*^9, 3.9476517217795753`*^9}, {
   3.948257503353304*^9, 3.948257511768673*^9}, {3.9482576676941433`*^9, 
   3.948257668029337*^9}, 3.9482580756862774`*^9, 3.948258109704838*^9, {
   3.948270154852442*^9, 3.948270174719162*^9}, 3.9482705432573013`*^9, {
   3.9491409613708534`*^9, 3.949140961501505*^9}, {3.9506710803146954`*^9, 
   3.9506710804531975`*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"b0400bb0-bd38-4283-9a8f-ce5e9e655d1b"]
}, Closed]],

Cell[CellGroupData[{

Cell["Preliminary definitions", "Title",
 CellChangeTimes->{{3.7552434949579296`*^9, 3.755243495237189*^9}, {
  3.88501652694691*^9, 3.885016532955313*^9}, {3.8850204805201235`*^9, 
  3.885020485584347*^9}, {3.8934405078912735`*^9, 3.893440508511178*^9}},
 CellTags->{
  "Acceptance", 
   "Number-of-events+sensitivity"},ExpressionUUID->"c7fbc496-1765-4913-bda1-\
eb19f9d14ec4"],

Cell[CellGroupData[{

Cell["Various directories", "Chapter",
 CellChangeTimes->{{3.913804059957842*^9, 3.913804062327417*^9}},
 CellTags->{
  "Acceptance", 
   "Number-of-events+sensitivity"},ExpressionUUID->"2dfe8dd1-5f59-4b43-b3b9-\
2414e7900cd0"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"LLPdirName", "=", "\"\<Scalar\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"ToString", "[", 
       RowBox[{"Head", "[", "computationchoice", "]"}], "]"}], 
      "==", "\"\<Symbol\>\""}], ",", 
     RowBox[{"computationchoice", "=", "\"\<Tabulated Nevents only\>\""}]}], 
    "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Set", " ", "the", " ", "directory", " ", "for", " ", "the", " ", "search",
     " ", "where", " ", "tabulated", " ", "acceptances", " ", "are", " ", 
    "located"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"directory", "[", "\"\<Acceptances\>\"", "]"}], "=", 
    RowBox[{"FileNameJoin", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"NotebookDirectory", "[", "]"}], ",", "\"\<Acceptances\>\""}], 
      "}"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Set", " ", "the", " ", "directory", " ", "for", " ", "the", " ", 
     "search", " ", "where", " ", "tabulated", " ", "angle"}], "-", 
    RowBox[{"energy", " ", "distributions", " ", "are", " ", "located"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"directory", "[", "\"\<Distribution\>\"", "]"}], "=", 
    RowBox[{"FileNameJoin", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"NotebookDirectory", "[", "]"}], 
       ",", "\"\<spectra/New physics particles spectra\>\"", ",", 
       "LLPdirName"}], "}"}], "]"}]}], ";"}], " ", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "The", " ", "directory", " ", "storing", " ", "production", " ", "weights",
     " ", "of", " ", "the", " ", "given", " ", "LLP"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"directory", "[", "\"\<Production weights\>\"", "]"}], "=", 
    RowBox[{"FileNameJoin", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"NotebookDirectory", "[", "]"}], ",", "\"\<phenomenology\>\"", 
       ",", "LLPdirName", ",", "\"\<Production probabilities\>\""}], "}"}], 
     "]"}]}], ";"}], " ", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Directory", " ", "to", " ", "which", " ", "various", " ", "auxillary", " ",
     "datasets", " ", "will", " ", "be", " ", "stored"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"directory", "[", "\"\<Auxiliary\>\"", "]"}], "=", 
    RowBox[{"FileNameJoin", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"NotebookDirectory", "[", "]"}], ",", "\"\<Auxiliary data\>\"",
        ",", "LLPdirName"}], "}"}], "]"}]}], ";"}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"!", 
      RowBox[{"DirectoryQ", "[", 
       RowBox[{"directory", "[", "\"\<Auxiliary\>\"", "]"}], "]"}]}], ",", 
     RowBox[{"CreateDirectory", "[", 
      RowBox[{"directory", "[", "\"\<Auxiliary\>\"", "]"}], "]"}]}], "]"}], 
   ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Directory", " ", "containing", " ", "decay", " ", "widths", " ", "of", " ",
     "the", " ", "LLPs"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"directory", "[", "\"\<Decays\>\"", "]"}], "=", 
    RowBox[{"FileNameJoin", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"NotebookDirectory", "[", "]"}], ",", "\"\<phenomenology\>\"", 
       ",", "LLPdirName", ",", "\"\<decay widths\>\""}], "}"}], "]"}]}], 
   ";"}], " "}]}], "Input",
 CellChangeTimes->{{3.913804080271287*^9, 3.913804171309696*^9}, {
   3.913804205284999*^9, 3.913804380241178*^9}, {3.9138103204454637`*^9, 
   3.9138103216469903`*^9}, 3.9138295316757774`*^9, {3.9156430914571066`*^9, 
   3.9156430914746857`*^9}, {3.9493110720531673`*^9, 3.94931107225877*^9}, {
   3.9506815067979336`*^9, 3.950681531683466*^9}},
 CellTags->{"Acceptance", "Number-of-events+sensitivity"},
 CellLabel->"In[17]:=",ExpressionUUID->"d75a06c0-54bc-4cc7-8bf8-20131e23d55b"]
}, Closed]],

Cell[CellGroupData[{

Cell["Loading necessary routines", "Chapter",
 CellChangeTimes->{{3.891315426588935*^9, 3.891315432542842*^9}, {
  3.9165033404709945`*^9, 3.9165033463985844`*^9}},
 CellTags->{
  "Acceptance", 
   "Number-of-events+sensitivity"},ExpressionUUID->"1f0363ab-1162-eb4d-b53a-\
7d3dac7a2b58"],

Cell[BoxData[
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Length", "[", "inecessary", "]"}], "==", "0"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"NotebookEvaluate", "[", 
     RowBox[{"FileNameJoin", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"NotebookDirectory", "[", "]"}], 
        ",", "\"\<codes/generic.nb\>\""}], "}"}], "]"}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"NotebookEvaluate", "[", 
     RowBox[{"FileNameJoin", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"NotebookDirectory", "[", "]"}], 
        ",", "\"\<codes/dialog-windows.nb\>\""}], "}"}], "]"}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"NotebookEvaluate", "[", 
     RowBox[{"FileNameJoin", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"NotebookDirectory", "[", "]"}], 
        ",", "\"\<codes/for-sensitivities.nb\>\""}], "}"}], "]"}], "]"}], ";",
     "\[IndentingNewLine]", 
    RowBox[{"NotebookEvaluate", "[", 
     RowBox[{"FileNameJoin", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"NotebookDirectory", "[", "]"}], 
        ",", "\"\<codes/SensCalc/SM particles.nb\>\""}], "}"}], "]"}], "]"}], 
    ";", "\[IndentingNewLine]", 
    RowBox[{"inecessary", "=", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], ";"}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.890711783488103*^9, 3.89071178348964*^9}, {
   3.8907121412539587`*^9, 3.8907121413711557`*^9}, {3.890712694841427*^9, 
   3.8907126950000925`*^9}, {3.890712790376151*^9, 3.8907128219919777`*^9}, {
   3.891018553068019*^9, 3.8910185548862777`*^9}, {3.914141327087761*^9, 
   3.9141413282588053`*^9}, 3.9165033910195627`*^9, {3.916503434997039*^9, 
   3.9165034401725807`*^9}, {3.9165108789774036`*^9, 
   3.9165108974096084`*^9}, {3.9165109290075464`*^9, 3.916510969839264*^9}, {
   3.948258207380787*^9, 3.948258211345028*^9}, 3.9506034636103725`*^9, {
   3.951149335217617*^9, 3.951149345295042*^9}, {3.9511493754060364`*^9, 
   3.9511493754709053`*^9}, {3.9546834736029797`*^9, 3.9546834805482025`*^9}},
 CellTags->{"Acceptance", "Number-of-events+sensitivity"},
 CellLabel->"In[25]:=",ExpressionUUID->"416b7111-552e-c744-a2b2-843317cfd164"]
}, Closed]],

Cell[CellGroupData[{

Cell["LLP phenomenology: production probabilities, decay widths", "Chapter",
 CellChangeTimes->{{3.835270415198964*^9, 3.8352704154970675`*^9}, {
   3.854441650570236*^9, 3.8544416515373263`*^9}, {3.885016402104937*^9, 
   3.8850164030053596`*^9}, 3.885019196491799*^9, {3.885019273945055*^9, 
   3.88501928458453*^9}, {3.9137189927638807`*^9, 3.9137190046798325`*^9}, 
   3.9156430914876757`*^9, 3.953175782633419*^9},
 CellTags->{
  "Acceptance", 
   "Number-of-events+sensitivity"},ExpressionUUID->"26b28c1f-439c-4589-917d-\
6d27e87fcda4"],

Cell[CellGroupData[{

Cell["Various parameters", "Section",
 CellChangeTimes->{{3.950681558102026*^9, 3.95068156027145*^9}},
 CellTags->{
  "Acceptance", 
   "Number-of-events+sensitivity"},ExpressionUUID->"757988c6-ea37-b047-83c5-\
eb63621b4913"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", "chbar", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"chbar", "=", " ", 
     RowBox[{"6.6", "*", 
      SuperscriptBox["10", 
       RowBox[{"-", "25"}]], "*", "3", "*", 
      SuperscriptBox["10", "8"]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Masses", " ", "of", " ", "various", " ", "SM", " ", "particles"}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"Fraction", " ", "of", " ", 
       SuperscriptBox["K", 
        RowBox[{"+", 
         RowBox[{"/", "-"}]}]], " ", "decaying", " ", "in"}], "-", 
      RowBox[{"flight", " ", "at", " ", "SPS"}]}], ",", " ", 
     RowBox[{
      RowBox[{"from", " ", 
       RowBox[{"https", ":"}]}], "//", 
      RowBox[{
       RowBox[{
        RowBox[{"arxiv", ".", "org"}], "/", "pdf"}], "/", 
       RowBox[{"2004.07974", ".", "pdf"}]}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"fractionDecayInFlightKplusKminus", "=", 
     RowBox[{"(", 
      RowBox[{"0.29", "+", "0.07"}], ")"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.950681622548828*^9, 3.9506816256789*^9}, {
  3.9511493214373074`*^9, 3.951149322724964*^9}, {3.95115164748538*^9, 
  3.9511516475354385`*^9}},
 CellTags->{"Acceptance", "Number-of-events+sensitivity"},
 CellLabel->"In[26]:=",ExpressionUUID->"57004dc5-a3e5-d04a-be13-3c411c28c8dd"]
}, Closed]],

Cell[CellGroupData[{

Cell["Production weights", "Section",
 CellChangeTimes->{{3.913715464961954*^9, 3.9137154671131763`*^9}},
 CellTags->{
  "Acceptance", 
   "Number-of-events+sensitivity"},ExpressionUUID->"85035d67-114f-47f6-94db-\
60f0e5c16cfb"],

Cell[CellGroupData[{

Cell[TextData[{
 "Expressing the tri-linear hSS coupling in terms of ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["Br", 
    RowBox[{"h", "->", "SS"}]], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "ece2e232-9ef2-d746-bf76-0e7e26ae9fed"]
}], "Subsection",
 CellChangeTimes->{{3.950681646145727*^9, 3.9506816559879208`*^9}},
 CellTags->{
  "Acceptance", 
   "Number-of-events+sensitivity"},ExpressionUUID->"6e25cf69-fe92-bb4d-9ec8-\
069f4fa65e2f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"BrhtoSS", "[", 
     RowBox[{"mLLP_", ",", "\[Alpha]_"}], "]"}], "=", 
    RowBox[{"2", "*", 
     SuperscriptBox["10", 
      RowBox[{"-", "2"}]], "*", 
     SuperscriptBox["\[Alpha]", "2"], 
     SqrtBox[
      RowBox[{"1", "-", 
       RowBox[{"4", "*", 
        FractionBox[
         SuperscriptBox["mLLP", "2"], 
         SuperscriptBox["125", "2"]]}]}]]}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Value", " ", "of", " ", "\[Alpha]", " ", "corresponding", " ", "to", " ",
      "the", " ", "given", " ", "Br", 
     RowBox[{"(", 
      RowBox[{"h", "\[Rule]", "SS"}], ")"}]}], "=", "0.01"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Alpha]valBrhToSS", "[", 
    RowBox[{"mS_", ",", "BrhToSS_"}], "]"}], "=", 
   RowBox[{"\[Alpha]", "/.", 
    RowBox[{
     RowBox[{"Solve", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"BrhtoSS", "[", 
         RowBox[{"mS", ",", "\[Alpha]"}], "]"}], "\[Equal]", "BrhToSS"}], ",",
        "\[Alpha]"}], "]"}], "[", 
     RowBox[{"[", "2", "]"}], "]"}]}]}], ";"}]}], "Input",
 CellTags->{"Acceptance", "Number-of-events+sensitivity"},
 CellLabel->"In[28]:=",ExpressionUUID->"bbae6bbc-aa1c-fb48-a296-ef340976f551"]
}, Closed]],

Cell[CellGroupData[{

Cell["Non-bremsstrahlung", "Subsection",
 CellChangeTimes->{{3.934595586486958*^9, 3.934595589750381*^9}, {
  3.9527518222909527`*^9, 3.9527518249382267`*^9}},
 CellTags->{
  "Acceptance", 
   "Number-of-events+sensitivity"},ExpressionUUID->"25e60c82-9c5a-4532-952c-\
fb512c328fe4"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"PmotherToLLP", "//", "Clear"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FacilitiesList", "=", 
   RowBox[{"{", 
    RowBox[{"\"\<SPS\>\"", ",", "\"\<FermilabBD\>\"", ",", "\"\<LHC\>\"", 
     ",", "\"\<FCC-hh\>\"", ",", "\"\<Serpukhov\>\""}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"intProd", "[", 
    RowBox[{"filename_", ",", "m1_", ",", "m2_"}], "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"mLLP", "<", 
      RowBox[{"m1", "-", "m2"}]}], ",", 
     RowBox[{"Evaluate", "[", 
      RowBox[{
       RowBox[{"Interpolation", "[", 
        RowBox[{
         RowBox[{"Import", "[", 
          RowBox[{
           RowBox[{"FileNameJoin", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"directory", "[", "\"\<Production weights\>\"", "]"}], ",",
               "filename"}], "}"}], "]"}], ",", "\"\<Table\>\""}], "]"}], ",", 
         RowBox[{"InterpolationOrder", "->", "1"}]}], "]"}], "[", "mLLP", 
       "]"}], "]"}], ",", "0."}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Print", 
  "[", "\"\<Exclusive/inclusive production of dark scalar in decays \
B\[Rule]\!\(\*SubscriptBox[\(X\), \(s\)]\)+S:\>\"", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SelectedBrChoice", "=", "\"\<Exclusive\>\""}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"SelectedBrChoice", "=", 
     RowBox[{"selectionDialogExplanationOneOption", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\"\<Exclusive\>\"", ",", "\"\<Inclusive\>\""}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\"\<Sum over all exclusive decays B \[Rule] \
\!\(\*SubscriptBox[\(X\), \(s/d\)]\) + S \>\"", 
         ",", "\"\<All production is approximated by the decays b \[Rule] s + \
S\>\""}], "}"}], ",", 
       RowBox[{"\"\<Select the description of the \>\"", "<>", "LLPdirName", 
        "<>", "\"\< production by decays of B via mixing (see \
1904.10447):\>\""}], ",", "200"}], "]"}]}], ";"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"PmotherToLLP", "[", 
        RowBox[{
        "mLLP_", ",", "\[Theta]2_", ",", "BrhToSS_", ",", "\"\<B-mixing\>\"", 
         ",", "Facility"}], "]"}], "=", 
       RowBox[{"\[Theta]2", "*", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"fbtob0", "[", "Facility", "]"}], "+", 
          RowBox[{"fbtobplus", "[", "Facility", "]"}]}], ")"}], 
        RowBox[{"intProd", "[", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"SelectedBrChoice", "==", "\"\<Exclusive\>\""}], 
            ",", "\"\<BtoXsStotal.dat\>\"", 
            ",", "\"\<BtoXsSinclusive.dat\>\""}], "]"}], ",", 
          RowBox[{"mSM", "[", "\"\<Bcharged\>\"", "]"}], ",", 
          RowBox[{"mSM", "[", "\"\<PiCharged\>\"", "]"}]}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Factors", " ", "of", " ", "2", " ", "and", " ", 
         FractionBox["1", "2"], " ", "are", " ", "due", " ", "to", " ", "the",
          " ", "production", " ", "of", " ", "scalars", " ", "in", " ", 
         RowBox[{"pairs", ".", " ", "\[Alpha]"}], " ", "is", " ", "the", " ", 
         "quartic", " ", "coupling", " ", "defined", " ", "by", " ", 
         SubscriptBox["L", "int"]}], " ", "=", " ", 
        RowBox[{
         FractionBox["\[Alpha]", 
          RowBox[{"2", "v"}]], 
         SuperscriptBox["S", "2"], 
         SuperscriptBox["H", "+"], "H"}]}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"PmotherToLLP", "[", 
        RowBox[{
        "mLLP_", ",", "\[Theta]2_", ",", "BrhToSS_", ",", "\"\<B-quartic\>\"",
          ",", "Facility"}], "]"}], "=", 
       RowBox[{"2", "*", 
        SuperscriptBox[
         RowBox[{"\[Alpha]valBrhToSS", "[", 
          RowBox[{"mLLP", ",", "BrhToSS"}], "]"}], "2"], "*", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"fbtob0", "[", "Facility", "]"}], "+", 
          RowBox[{"fbtobplus", "[", "Facility", "]"}]}], ")"}], "*", 
        RowBox[{"intProd", "[", 
         RowBox[{"\"\<BplustoXsSStotal.dat\>\"", ",", 
          FractionBox[
           RowBox[{"mSM", "[", "\"\<Bcharged\>\"", "]"}], "2"], ",", 
          FractionBox[
           RowBox[{"mSM", "[", "\"\<PiCharged\>\"", "]"}], "2"]}], "]"}]}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"PmotherToLLP", "[", 
        RowBox[{
        "mLLP_", ",", "\[Theta]2_", ",", "BrhToSS_", ",", "\"\<Bs-quartic\>\"",
          ",", "Facility"}], "]"}], "=", 
       RowBox[{"2", "*", 
        SuperscriptBox[
         RowBox[{"\[Alpha]valBrhToSS", "[", 
          RowBox[{"mLLP", ",", "BrhToSS"}], "]"}], "2"], "*", 
        RowBox[{"fbtobs", "[", "Facility", "]"}], "*", 
        RowBox[{"intProd", "[", 
         RowBox[{"\"\<BstoSS.dat\>\"", ",", 
          FractionBox[
           RowBox[{"mSM", "[", "\"\<Bs\>\"", "]"}], "2"], ",", "0."}], 
         "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"!", 
         RowBox[{"MemberQ", "[", 
          RowBox[{
           RowBox[{"{", 
            
            RowBox[{"\"\<FermilabBD\>\"", ",", "\"\<ESS\>\"", 
             ",", "\"\<Serpukhov\>\""}], "}"}], ",", "Facility"}], "]"}]}], ",",
         "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"PmotherToLLP", "[", 
           RowBox[{
           "mLLP_", ",", "\[Theta]2_", ",", "BrhToSS_", 
            ",", "\"\<Upsilon-quartic\>\"", ",", "Facility"}], "]"}], "=", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"\[Alpha]valBrhToSS", "[", 
             RowBox[{"mLLP", ",", "BrhToSS"}], "]"}], "2"], 
           RowBox[{"intProd", "[", 
            RowBox[{"\"\<UpsilonToSSgamma.dat\>\"", ",", 
             FractionBox[
              RowBox[{"mSM", "[", "\"\<Upsilon\>\"", "]"}], "2"], ",", "0."}],
             "]"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"PmotherToLLP", "[", 
           RowBox[{
           "mLLP_", ",", "\[Theta]2_", ",", "BrhToSS_", 
            ",", "\"\<Upsilon-mixing\>\"", ",", "Facility"}], "]"}], "=", 
          RowBox[{"\[Theta]2", "*", 
           RowBox[{"intProd", "[", 
            RowBox[{"\"\<UpsilonToSgamma.dat\>\"", ",", 
             RowBox[{"mSM", "[", "\"\<Upsilon\>\"", "]"}], ",", "0."}], 
            "]"}]}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"MemberQ", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"\"\<LHC\>\"", ",", "\"\<FCC-hh\>\""}], "}"}], ",", 
          "Facility"}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"PmotherToLLP", "[", 
           RowBox[{
           "mLLP_", ",", "\[Theta]2_", ",", "BrhToSS_", 
            ",", "\"\<h-quartic\>\"", ",", "Facility"}], "]"}], "=", 
          RowBox[{"2", "*", "2", "*", 
           SuperscriptBox["10", 
            RowBox[{"-", "2"}]], "*", 
           SuperscriptBox[
            RowBox[{"\[Alpha]valBrhToSS", "[", 
             RowBox[{"mLLP", ",", "BrhToSS"}], "]"}], "2"], 
           SqrtBox[
            RowBox[{"1", "-", 
             RowBox[{"4", "*", 
              FractionBox[
               SuperscriptBox["mLLP", "2"], 
               SuperscriptBox["125", "2"]]}]}]]}]}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{"Facility", ",", "FacilitiesList"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Production", " ", "from", " ", "K", " ", "at", " ", "beam", " ", "dump", 
     " ", "experiments", " ", "with", " ", "thick", " ", 
     RowBox[{"target", ".", " ", "Assumed"}], " ", "to", " ", "be", " ", 
     "the", " ", "same", " ", "independently", " ", "of", " ", 
     RowBox[{"target", "'"}], "s", " ", 
     RowBox[{"material", ".", " ", "Also"}]}], ",", " ", 
    RowBox[{"the", " ", "fraction", " ", "of", " ", 
     SubscriptBox[
      RowBox[{"(", 
       SuperscriptBox["K", "0"], ")"}], "L"], " ", "decaying", " ", "at", " ",
      "rest", " ", "is", " ", "assumed", " ", "to", " ", "be", " ", "the", " ",
      "same", " ", "as", " ", "the", " ", "fraction", " ", "of", " ", 
     "charged", " ", "kaons"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PmotherToLLP", "[", 
    RowBox[{
    "mLLP_", ",", "\[Theta]2_", ",", "BrhToSS_", ",", "\"\<K-mixing\>\"", 
     ",", "\"\<SPS\>\""}], "]"}], "=", 
   RowBox[{"\[Theta]2", "*", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"fstokplus", "[", "\"\<SPS\>\"", "]"}], "*", 
       RowBox[{"intProd", "[", 
        RowBox[{"\"\<KplustoPiS.dat\>\"", ",", 
         RowBox[{"mSM", "[", "\"\<Kcharged\>\"", "]"}], ",", 
         RowBox[{"mSM", "[", "\"\<PiCharged\>\"", "]"}]}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"fstok0l", "[", "\"\<SPS\>\"", "]"}], "*", 
       RowBox[{"intProd", "[", 
        RowBox[{"\"\<K0LtoPiS.dat\>\"", ",", 
         RowBox[{"mSM", "[", "\"\<KL\>\"", "]"}], ",", 
         RowBox[{"mSM", "[", "\"\<Pi0\>\"", "]"}]}], "]"}]}]}], ")"}]}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.934595706274107*^9, 3.9345957167918158`*^9}, {
  3.934595939155282*^9, 3.9345959453476677`*^9}, {3.949488765812481*^9, 
  3.9494887661323547`*^9}, {3.95068166122624*^9, 3.950681664983137*^9}, {
  3.950681713077297*^9, 3.950681825461176*^9}, {3.951149140387373*^9, 
  3.9511491841841736`*^9}, {3.9511492199561577`*^9, 3.9511492945084057`*^9}, {
  3.951149618231825*^9, 3.9511496207425346`*^9}, {3.9511516582068615`*^9, 
  3.9511516897472153`*^9}, {3.954685696337826*^9, 3.954685719639431*^9}},
 CellTags->{"Acceptance", "Number-of-events+sensitivity"},
 CellLabel->"In[30]:=",ExpressionUUID->"289f9865-078c-48da-b27a-ffade768aeb2"]
}, Closed]],

Cell[CellGroupData[{

Cell["Bremsstrahlung", "Subsection",
 CellChangeTimes->{{3.934595586486958*^9, 3.934595596909358*^9}},
 CellTags->{
  "Acceptance", 
   "Number-of-events+sensitivity"},ExpressionUUID->"c2b9b7a8-7fdf-436e-94e8-\
032145c60732"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"___", "___", "___", "___", "___", "_"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", "Bremsstrahlung", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"___", "___", "___", "___", "___", "_"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"BremProd", "[", "Facility_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"bremprobfiles", "=", 
        RowBox[{"FileNames", "[", 
         RowBox[{
          
          RowBox[{"\"\<ProdProb*_\>\"", "<>", "Facility", 
           "<>", "\"\<.m\>\""}], ",", 
          RowBox[{"directory", "[", "\"\<Production weights\>\"", "]"}]}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"bremprobfiles", "!=", 
          RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
          "Scanning", " ", "over", " ", "all", " ", "available", " ", "files",
            " ", "with", " ", "the", " ", "bremsstrahlung", " ", 
           RowBox[{"probability", ".", " ", "They"}], " ", "describe", " ", 
           "different", " ", "descriptions", " ", "of", " ", "the", " ", 
           "bremsstrahlung"}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
          "Extract", " ", "the", " ", "bremsstrahlung", " ", "description", " ",
            "from", " ", "the", " ", "filename"}], "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"bremprobfilenames", "=", 
           RowBox[{
            RowBox[{
             RowBox[{"Last", "@", 
              RowBox[{"FileNameSplit", "[", "#", "]"}]}], "&"}], "/@", 
            "bremprobfiles"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"bremdescriptions", "=", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"StringSplit", "[", 
                RowBox[{"#", ",", 
                 RowBox[{"{", 
                  RowBox[{
                   
                   RowBox[{"\"\<ProdProb_\>\"", "<>", "LLPdirName", 
                    "<>", "\"\<_\>\""}], ",", "\"\<_\>\""}], "}"}]}], "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}], ")"}], "&"}], "/@", 
            "bremprobfilenames"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"Do", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"datbrem", "[", 
               RowBox[{"mLLP_", ",", "\[Theta]LLP_"}], "]"}], "=", 
              RowBox[{"Import", "[", 
               RowBox[{
                RowBox[{"bremprobfiles", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], ",", "\"\<MX\>\""}], "]"}]}],
              ";", "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"StringContainsQ", "[", 
                RowBox[{
                 RowBox[{"bremdescriptions", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], ",", "\"\<BB\>\""}], "]"}], 
               ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"bremname", "=", 
                 RowBox[{
                  RowBox[{"bremdescriptions", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], 
                  "<>", "\"\<-mixing\>\""}]}], ";", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"PmotherToLLP", "[", 
                  RowBox[{
                  "mLLP_", ",", "\[Theta]2_", ",", "BrhToSS_", ",", 
                   "bremname", ",", "Facility"}], "]"}], "=", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"datbrem", "[", 
                    RowBox[{"mLLP", ",", "\[Theta]LLP"}], "]"}], "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "*", "\[Theta]2"}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"ELLPmin", "[", 
                  RowBox[{"bremname", ",", "Facility"}], "]"}], "=", 
                 RowBox[{"Evaluate", "[", 
                  RowBox[{
                   RowBox[{"datbrem", "[", 
                    RowBox[{"mLLP", ",", "\[Theta]LLP"}], "]"}], "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "]"}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"\[Theta]maxBrem", "[", 
                  RowBox[{"bremname", ",", "Facility"}], "]"}], "=", 
                 RowBox[{"Evaluate", "[", 
                  RowBox[{
                   RowBox[{"datbrem", "[", 
                    RowBox[{"mLLP", ",", "\[Theta]LLP"}], "]"}], "[", 
                   RowBox[{"[", "3", "]"}], "]"}], "]"}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"ELLPmax", "[", 
                  RowBox[{
                  "mLLP_", ",", "\[Theta]LLP_", ",", "bremname", ",", 
                   "Facility"}], "]"}], "=", 
                 RowBox[{"Evaluat", "/", 
                  RowBox[{"e", "[", 
                   RowBox[{
                    RowBox[{"datbrem", "[", 
                    RowBox[{"mLLP", ",", "\[Theta]LLP"}], "]"}], "[", 
                    RowBox[{"[", "4", "]"}], "]"}], "]"}]}]}], ";"}], 
               "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
               RowBox[{"Do", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Module", "[", 
                  RowBox[{
                   RowBox[{"{", "bremname", "}"}], ",", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"bremname", "=", 
                    RowBox[{
                    RowBox[{"bremdescriptions", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "<>", "\"\<-\>\"", "<>", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"datbrem", "[", 
                    RowBox[{"mLLP", ",", "\[Theta]LLP"}], "]"}], "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], 
                    "<>", "\"\<-mixing\>\""}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"PmotherToLLP", "[", 
                    RowBox[{
                    "mLLP_", ",", "\[Theta]2_", ",", "BrhToSS_", ",", 
                    "bremname", ",", "Facility"}], "]"}], "=", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"datbrem", "[", 
                    RowBox[{"mLLP", ",", "\[Theta]LLP"}], "]"}], "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "*", "\[Theta]2"}]}], ";",
                     "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"ELLPmin", "[", 
                    RowBox[{"bremname", ",", "Facility"}], "]"}], "=", 
                    RowBox[{"Evaluate", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"datbrem", "[", 
                    RowBox[{"mLLP", ",", "\[Theta]LLP"}], "]"}], "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"\[Theta]maxBrem", "[", 
                    RowBox[{"bremname", ",", "Facility"}], "]"}], "=", 
                    RowBox[{"Evaluate", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"datbrem", "[", 
                    RowBox[{"mLLP", ",", "\[Theta]LLP"}], "]"}], "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "[", 
                    RowBox[{"[", "4", "]"}], "]"}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"ELLPmax", "[", 
                    RowBox[{
                    "mLLP_", ",", "\[Theta]LLP_", ",", "bremname", ",", 
                    "Facility"}], "]"}], "=", 
                    RowBox[{"Evaluate", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"datbrem", "[", 
                    RowBox[{"mLLP", ",", "\[Theta]LLP"}], "]"}], "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "[", 
                    RowBox[{"[", "5", "]"}], "]"}], "]"}]}], ";"}]}], 
                  "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", ",", 
                 RowBox[{"{", 
                  RowBox[{"j", ",", "1", ",", 
                   RowBox[{"Length", "[", 
                    RowBox[{"datbrem", "[", 
                    RowBox[{"mLLP", ",", "\[Theta]LLP"}], "]"}], "]"}], ",", 
                   "1"}], "}"}]}], "]"}]}], "\[IndentingNewLine]", "]"}]}], 
            "\[IndentingNewLine]", ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"Length", "[", "bremdescriptions", "]"}], ",", "1"}], 
             "}"}]}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Do", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"BremProd", "[", "Facility", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"Facility", ",", 
        RowBox[{"{", 
         RowBox[{"\"\<FCC-hh\>\"", ",", "\"\<Serpukhov\>\"", 
          ",", "\"\<SPS\>\"", ",", "\"\<FermilabBD\>\"", ",", "\"\<LHC\>\""}],
          "}"}]}], "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Scaling", " ", "of", " ", "the", " ", "lower", " ", 
     RowBox[{"bound", ":", " ", 
      RowBox[{
       SubscriptBox[
        RowBox[{"(", 
         SuperscriptBox["\[Theta]", "2"], ")"}], 
        RowBox[{"lower", " ", "bound"}]], " ", "~", " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          SubscriptBox["N", "ev"], 
          SubscriptBox["|", 
           RowBox[{"\[Theta]", " ", "=", " ", "1"}]]}], ")"}], 
        RowBox[{
         RowBox[{"-", "\[Beta]"}], "/", "2"}]]}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"WeightsCombinations", "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Keys", "[", 
           RowBox[{"DownValues", "@", "PmotherToLLP"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "1", ",", "#"}], "]"}], "]"}], "&"}], "/@", 
        RowBox[{"{", 
         RowBox[{"4", ",", "5"}], "}"}]}], "//", "Transpose"}], "//", 
      "Sort"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"LowerBoundScaling", "[", "\"\<B-mixing\>\"", "]"}], "=", 
     RowBox[{
      RowBox[{"LowerBoundScaling", "[", "\"\<K-mixing\>\"", "]"}], "=", 
      "1"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"Do", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"prodLowerBoundScaling", "[", "prod", "]"}], "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"StringContainsQ", "[", 
          RowBox[{"prod", ",", "\"\<mixing\>\""}], "]"}], ",", "1", ",", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"StringContainsQ", "[", 
            RowBox[{"prod", ",", "\"\<quartic\>\""}], "]"}], ",", "2"}], 
          "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{"prod", ",", 
       RowBox[{
        RowBox[{"WeightsCombinations", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "1"}], "]"}], "]"}], "//", 
        "DeleteDuplicates"}]}], "}"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.9345956758278246`*^9, 3.9345956820506344`*^9}, {
   3.934595759751226*^9, 3.934595915283247*^9}, 3.9345959595065527`*^9, {
   3.9345979768366475`*^9, 3.934597978446856*^9}, {3.934598038217847*^9, 
   3.9345980392781906`*^9}, {3.934600186035475*^9, 3.934600364870763*^9}, {
   3.942202346490036*^9, 3.942202408269142*^9}, {3.942202456987625*^9, 
   3.9422024725093365`*^9}, {3.9423010023188896`*^9, 3.9423010069605503`*^9}},
 CellTags->{"Acceptance", "Number-of-events+sensitivity"},
 CellLabel->"In[37]:=",ExpressionUUID->"af9ec9ab-fca6-4165-ac36-57fabe7c3a40"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Scanning for tabulated distributions", "Section",
 CellChangeTimes->{{3.9137150010274553`*^9, 3.9137150224099426`*^9}, {
  3.913715411520641*^9, 3.913715414252445*^9}},
 CellTags->{
  "Acceptance", 
   "Number-of-events+sensitivity"},ExpressionUUID->"35be8a02-4d25-4cbb-9678-\
877dd61d5842"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Define", " ", "the", " ", "file", " ", "pattern"}], "*)"}], "\n", 
  RowBox[{
   RowBox[{
    RowBox[{"pattern", "=", "\"\<DoubleDistr_*_*_*.m\>\""}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Search", " ", "for", " ", "files", " ", "matching", " ", "the", " ", 
     "pattern", " ", "in", " ", "the", " ", "directory", " ", "and", " ", 
     "its", " ", "subdirectories"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"matchingFiles", "=", 
     RowBox[{"FileNames", "[", 
      RowBox[{"pattern", ",", 
       RowBox[{"{", 
        RowBox[{"directory", "[", "\"\<Distribution\>\"", "]"}], "}"}], ",", 
       "Infinity"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"List", " ", "of", " ", "LLPs"}], ",", " ", 
     RowBox[{"production", " ", "modes"}], ",", " ", 
     RowBox[{
     "and", " ", "facilities", " ", "for", " ", "which", " ", "the", " ", 
      "tabulated", " ", "distributions", " ", "have", " ", "been", " ", 
      "computed", " ", "at", " ", "the", " ", "previous", " ", "stage", " ", 
      "of", " ", "using", " ", "SensCalc"}]}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"ExtractedProductionParameters", "=", 
     RowBox[{"Function", "[", 
      RowBox[{"filename", ",", 
       RowBox[{
        RowBox[{"parts", "=", 
         RowBox[{"StringSplit", "[", 
          RowBox[{
           RowBox[{"FileNameTake", "[", "filename", "]"}], ",", "\"\<_\>\""}],
           "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"parts", "[", 
           RowBox[{"[", "2", "]"}], "]"}], ",", 
          RowBox[{"parts", "[", 
           RowBox[{"[", "3", "]"}], "]"}], ",", 
          RowBox[{"StringDrop", "[", 
           RowBox[{
            RowBox[{"parts", "[", 
             RowBox[{"[", "4", "]"}], "]"}], ",", 
            RowBox[{"-", "2"}]}], "]"}]}], "}"}]}]}], " ", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"combinations", " ", "selected", " ", "LLP"}], ",", " ", 
     RowBox[{"production", " ", "channel"}], ",", " ", 
     RowBox[{
     "facility", " ", "for", " ", "which", " ", "the", " ", "tabulated", " ", 
      "distributions", " ", "are", " ", "present"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"Print", "[", "\"\<List of available distributions:\>\"", "]"}], "\[IndentingNewLine]", 
   RowBox[{"DistrCombinations", "=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"ExtractedProductionParameters", "/@", "matchingFiles"}], ")"}],
      "//", "Sort"}]}]}]}]], "Input",
 CellChangeTimes->{{3.9137151636915593`*^9, 3.9137152465178137`*^9}, {
   3.9137153053586187`*^9, 3.913715399589816*^9}, {3.913718678447782*^9, 
   3.913718708673525*^9}, {3.913719203960288*^9, 3.9137192388759937`*^9}, {
   3.913804074855399*^9, 3.913804089247952*^9}, 3.9138043135262485`*^9, {
   3.913810357631002*^9, 3.913810363616334*^9}, {3.9138256248481245`*^9, 
   3.9138256471350822`*^9}, {3.9156430915189877`*^9, 
   3.9156430915220127`*^9}, {3.9345955624494057`*^9, 3.9345955645352535`*^9}, 
   3.9345963916417527`*^9, {3.9345964653436947`*^9, 3.9345964942465725`*^9}, {
   3.9345965636318016`*^9, 3.9345965877359333`*^9}, {3.934596637324805*^9, 
   3.9345967929777403`*^9}, {3.9345968365349293`*^9, 3.934596895584905*^9}, {
   3.9423011246710815`*^9, 3.94230113454982*^9}, {3.9506818672459087`*^9, 
   3.950681868495783*^9}},
 CellTags->{"Acceptance", "Number-of-events+sensitivity"},
 CellLabel->"In[42]:=",ExpressionUUID->"6347abb3-3bd8-4430-a992-f2088673ed8a"]
}, Closed]]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Specifying the experiment", "Title",
 CellChangeTimes->{{3.8876178747397523`*^9, 3.8876178773785458`*^9}},
 CellTags->{
  "Acceptance", 
   "Number-of-events+sensitivity"},ExpressionUUID->"4849bc3c-f2c5-4bec-8c48-\
2c597d5d139d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"SetDirectory", "[", 
    RowBox[{"NotebookDirectory", "[", "]"}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Parent", " ", "directory"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"NotebookDirectory", "[", "]"}], "//", "ParentDirectory"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ExperimentDirectoriesList", "=", 
    RowBox[{"Select", "[", 
     RowBox[{
      RowBox[{"FileNames", "[", 
       RowBox[{"\"\<*\>\"", ",", 
        RowBox[{"directory", "[", "\"\<Acceptances\>\"", "]"}], ",", "1"}], 
       "]"}], ",", "DirectoryQ"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"List", " ", "of", " ", "available", " ", "experiments", " ", 
    RowBox[{"(", 
     RowBox[{
     "for", " ", "which", " ", "the", " ", "geometry", " ", "has", " ", 
      "been", " ", "implemented"}], ")"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ExperimentsListTemp", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"FileNameTake", "[", 
      RowBox[{
       RowBox[{"ExperimentDirectoriesList", "[", 
        RowBox[{"[", "i", "]"}], "]"}], ",", 
       RowBox[{"-", "1"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "ExperimentDirectoriesList", "]"}], ",", "1"}], 
      "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ExperimentsListTemp2", "=", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"Partition", "[", 
      RowBox[{"ExperimentsListTemp", ",", "1"}], "]"}], ",", 
     RowBox[{"(*", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"TrueQ", "@", 
          RowBox[{"FileExistsQ", "@", 
           RowBox[{"FileNameJoin", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"directory", "[", "\"\<Acceptances\>\"", "]"}], ",", 
              RowBox[{"ExperimentsListTemp", "[", 
               RowBox[{"[", "i", "]"}], "]"}], ",", 
              RowBox[{"ToString", "@", 
               RowBox[{"StringForm", "[", 
                RowBox[{"\"\<Acceptance_``_for_``.m\>\"", ",", 
                 RowBox[{"ExperimentsListTemp", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], ",", "LLPdirName"}], 
                "]"}]}]}], "}"}], "]"}]}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "ExperimentsListTemp", "]"}]}], "}"}]}], 
       "]"}], "*)"}], 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Length", "[", 
          RowBox[{"FileNames", "[", 
           RowBox[{"FileNameJoin", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"directory", "[", "\"\<Acceptances\>\"", "]"}], ",", 
              RowBox[{"ExperimentsListTemp", "[", 
               RowBox[{"[", "i", "]"}], "]"}], ",", 
              RowBox[{"ToString", "@", 
               RowBox[{"StringForm", "[", 
                RowBox[{"\"\<Acceptance_``_for_``*.m\>\"", ",", 
                 RowBox[{"ExperimentsListTemp", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], ",", "LLPdirName"}], 
                "]"}]}]}], "}"}], "]"}], "]"}], "]"}], ">", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "ExperimentsListTemp", "]"}]}], "}"}]}], 
      "]"}], ",", "2"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", "\"\<List of available experiments:\>\"", "]"}], "\[IndentingNewLine]", 
 RowBox[{"ExperimentsList", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"Select", "[", 
     RowBox[{"ExperimentsListTemp2", ",", 
      RowBox[{
       RowBox[{
        RowBox[{"#", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", "True"}], "&"}]}], "]"}],
     "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", "1"}], "]"}], "]"}], "//", "Sort"}]}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Length", "[", "ExperimentsList", "]"}], "\[Equal]", "0"}], ",", 
   RowBox[{
   "Print", "[", "\"\<No experiment is available, generate first the \
acceptance for the given experiment using module 1\>\"", "]"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", "\"\<Selected experiments:\>\"", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dropdownDialog", "[", 
   RowBox[{"list_", ",", "phrase_"}], "]"}], ":=", 
  RowBox[{"DialogInput", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"choice", "=", "\"\<\>\""}], "}"}], ",", 
    RowBox[{"Column", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"TextCell", "[", "phrase", "]"}], ",", 
       RowBox[{"PopupMenu", "[", 
        RowBox[{
         RowBox[{"Dynamic", "[", "choice", "]"}], ",", "list"}], "]"}], ",", 
       RowBox[{"Button", "[", 
        RowBox[{"\"\<OK\>\"", ",", 
         RowBox[{"DialogReturn", "[", "choice", "]"}]}], "]"}]}], "}"}], 
     "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"availablePhenoDescriptions", "[", "exp_", "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", "\t", 
    RowBox[{"descrFile", "=", 
     RowBox[{"Import", "[", 
      RowBox[{
       RowBox[{"FileNameJoin", "[", 
        RowBox[{"FileNameJoin", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"directory", "[", "\"\<Acceptances\>\"", "]"}], ",", "exp",
            ",", 
           
           RowBox[{"\"\<AvailableDescriptions-\>\"", "<>", "LLPdirName", 
            "<>", "\"\<.mx\>\""}]}], "}"}], "]"}], "]"}], ",", "\"\<MX\>\""}],
       "]"}]}]}], "\[IndentingNewLine]", "\t", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"SelectedExperimentListTemp2", "=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Length", "[", "ExperimentsList", "]"}], "\[NotEqual]", "0"}], ",", 
    RowBox[{"selectionDialog", "[", 
     RowBox[{"ExperimentsList", ",", "\"\<Select the experiments:\>\""}], 
     "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"IfAllPheno", "=", "True"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SelectedExperimentList", "=", 
   RowBox[{"{", 
    RowBox[{"{", "}"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{"IfAllPheno", ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"descriptions", "=", 
          RowBox[{"availablePhenoDescriptions", "[", "exp", "]"}]}], "}"}], ",",
         "\[IndentingNewLine]", 
        RowBox[{"SelectedExperimentList", "=", 
         RowBox[{"Join", "[", 
          RowBox[{"SelectedExperimentList", ",", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"exp", ",", 
               RowBox[{
                RowBox[{"descriptions", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", 
               RowBox[{
                RowBox[{"descriptions", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", 
               RowBox[{"Length", "[", "descriptions", "]"}], ",", "1"}], 
              "}"}]}], "]"}]}], "]"}]}]}], "\[IndentingNewLine]", "]"}], 
      "\[IndentingNewLine]", ",", 
      RowBox[{"{", 
       RowBox[{"exp", ",", "SelectedExperimentListTemp2"}], "}"}]}], "]"}], ";",
     "\[IndentingNewLine]", 
    RowBox[{"SelectedExperimentList", "=", 
     RowBox[{"Drop", "[", 
      RowBox[{"SelectedExperimentList", ",", "1"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SelectedExperimentList", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"{", "exp", "}"}], ",", 
         RowBox[{
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"availablePhenoDescriptions", "[", "exp", "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"#", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "==", "\"\<Default\>\""}], 
             "&"}]}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"exp", ",", "SelectedExperimentListTemp2"}], "}"}]}], "]"}]}],
     ";"}]}], "\[IndentingNewLine]", 
  "]"}], "\[IndentingNewLine]", "SelectedExperimentList", "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"icounter", "=", "1"}], ";"}]}], "Input",
 CellChangeTimes->{{3.8851403254718485`*^9, 3.8851403429411273`*^9}, {
   3.8854395484478483`*^9, 3.885439559226637*^9}, {3.8854397351242537`*^9, 
   3.885439739219259*^9}, {3.8858794196350574`*^9, 3.885879423032172*^9}, {
   3.8865840272667904`*^9, 3.8865840338661537`*^9}, {3.886607744879512*^9, 
   3.886607745774307*^9}, {3.8872732396769423`*^9, 3.887273255436386*^9}, {
   3.887276631938718*^9, 3.887276634618329*^9}, {3.887276937792802*^9, 
   3.8872769418915215`*^9}, {3.887278937383339*^9, 3.887278940392472*^9}, {
   3.887616450031478*^9, 3.887616452738494*^9}, {3.8876165118788147`*^9, 
   3.887616536357917*^9}, {3.887616583272811*^9, 3.887616613175548*^9}, {
   3.887620318755148*^9, 3.8876203205821953`*^9}, {3.8876324144338245`*^9, 
   3.887632416400697*^9}, {3.887772846060255*^9, 3.8877729560180535`*^9}, {
   3.888377893669921*^9, 3.8883779148425026`*^9}, {3.888380182047347*^9, 
   3.888380266214329*^9}, {3.8892622911432314`*^9, 3.8892622916750484`*^9}, {
   3.8922835930044155`*^9, 3.8922836165540304`*^9}, {3.8932346328784227`*^9, 
   3.893234635004322*^9}, {3.8932347150748158`*^9, 3.8932347228556705`*^9}, 
   3.902763628158878*^9, {3.902975358880166*^9, 3.9029753591313515`*^9}, {
   3.913825708686487*^9, 3.9138257167011356`*^9}, {3.91382574990506*^9, 
   3.913825771690089*^9}, {3.913825804705933*^9, 3.913825834869774*^9}, {
   3.9138259918063545`*^9, 3.9138259935630684`*^9}, 3.9156430917281084`*^9, {
   3.947648581830965*^9, 3.947648586305416*^9}, {3.947648699676653*^9, 
   3.9476487031238613`*^9}, {3.947648745902132*^9, 3.9476487485874023`*^9}, {
   3.9476493695812187`*^9, 3.9476495122258606`*^9}, {3.9476495666893406`*^9, 
   3.9476498955144596`*^9}, {3.9476499294623528`*^9, 
   3.9476499879326916`*^9}, {3.947650078865858*^9, 3.9476500792291393`*^9}},
 CellTags->{"Acceptance", "Number-of-events+sensitivity"},
 CellLabel->"In[47]:=",ExpressionUUID->"a9dc099a-58c7-4b4a-87b0-fae273cf5733"],

Cell[CellGroupData[{

Cell["Running block for next sections", "Chapter",
 CellChangeTimes->{{3.902729140157612*^9, 3.90272914444062*^9}},
 CellTags->{
  "Acceptance", 
   "Number-of-events+sensitivity"},ExpressionUUID->"a74112cd-0181-43f7-98cb-\
cf9ca35460f9"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"BlockEvaluation", "[", "tag_", "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"nb", "=", 
      RowBox[{"EvaluationNotebook", "[", "]"}]}], ";", "\n", 
     RowBox[{"NotebookFind", "[", 
      RowBox[{"nb", ",", "tag", ",", "All", ",", "CellTags"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"SelectionEvaluate", "[", "nb", "]"}]}]}], "\[IndentingNewLine]",
    "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"tagselected", "==", "\"\<Number-of-events+sensitivity\>\""}], ",",
    "\[IndentingNewLine]", 
   RowBox[{"Do", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{
      "BlockEvaluation", 
       "[", "\"\<Number-of-events-computation+sensitivity\>\"", "]"}], ";"}], 
     "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{"icounter", ",", "1", ",", 
       RowBox[{"Length", "[", "SelectedExperimentList", "]"}], ",", "1"}], 
      "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"tagselected", "==", "\"\<Acceptance\>\""}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
        "BlockEvaluation", "[", "\"\<Acceptance-computation\>\"", "]"}], 
        ";"}], "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"icounter", ",", "1", ",", 
         RowBox[{"Length", "[", "SelectedExperimentList", "]"}], ",", "1"}], 
        "}"}]}], "]"}]}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]", "]"}]}], "Input",
 CellChangeTimes->{{3.9027291581950865`*^9, 3.902729215695462*^9}, {
   3.902761777481885*^9, 3.902761802513644*^9}, {3.9029753543924875`*^9, 
   3.902975356561885*^9}, 3.914668443878397*^9},
 CellTags->{"Acceptance", "Number-of-events+sensitivity"},
 CellLabel->"In[64]:=",ExpressionUUID->"188a1091-0abe-4645-9955-08d60cc3dc98"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Number of events", "Title",
 CellChangeTimes->{{3.885140281753849*^9, 3.8851402836781845`*^9}},
 CellTags->
  "Number-of-events-computation+sensitivity",ExpressionUUID->"128d78c3-8bd2-\
4cc0-aade-f5ea999c5498"],

Cell[CellGroupData[{

Cell["Switching iterator to the given experiment", "Chapter",
 CellChangeTimes->{{3.9165042001551485`*^9, 3.9165042041207294`*^9}, {
  3.9165090857383037`*^9, 3.916509094318386*^9}, {3.950683143548872*^9, 
  3.950683152777462*^9}},
 CellTags->{
  "Acceptance-computation", 
   "Number-of-events-computation+sensitivity"},ExpressionUUID->"c9366a31-fab6-\
43c8-bf77-12197eb87f0c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"{", 
   RowBox[{
   "SelectedExperiment", ",", "SelectedDescr", ",", 
    "ExplanationSelectedDescr"}], "}"}], "=", 
  RowBox[{"SelectedExperimentList", "[", 
   RowBox[{"[", 
    RowBox[{"icounter", "++"}], "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"Row", "[", 
   RowBox[{"{", 
    RowBox[{"\"\<Experiment \>\"", ",", 
     RowBox[{"icounter", "-", "1"}], ",", "\"\</\>\"", ",", 
     RowBox[{"Length", "[", "SelectedExperimentList", "]"}]}], "}"}], "]"}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.9354754269409094`*^9, 3.935475455676772*^9}, {
   3.9476500148912888`*^9, 3.947650026989809*^9}, 3.947650092896969*^9},
 CellTags->{
  "Acceptance-computation", "Number-of-events-computation+sensitivity"},
 CellLabel->
  "In[201]:=",ExpressionUUID->"06dc8acb-36d0-41f4-aa29-e8d4d0ec6ad1"]
}, Closed]],

Cell[CellGroupData[{

Cell["Cross-sections, acceptances", "Chapter",
 CellChangeTimes->{{3.885020695565913*^9, 3.885020698644303*^9}, {
   3.8866052332485933`*^9, 3.8866052373066683`*^9}, 3.887617904598539*^9, {
   3.8946364579474945`*^9, 3.8946364660788918`*^9}},
 CellTags->{
  "Acceptance-computation", 
   "Number-of-events-computation+sensitivity"},ExpressionUUID->"cae25615-bc01-\
481f-b6ea-4be09eb8d2a0"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"dataAcceptances", "=", 
    RowBox[{"Import", "[", 
     RowBox[{
      RowBox[{"FileNameJoin", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"directory", "[", "\"\<Acceptances\>\"", "]"}], ",", 
         "SelectedExperiment", ",", 
         RowBox[{"ToString", "@", 
          RowBox[{"StringForm", "[", 
           RowBox[{"\"\<Acceptance_``_for_``_decayDescription_``.m\>\"", ",", 
            RowBox[{"Sequence", "@@", 
             RowBox[{"{", 
              RowBox[{
              "SelectedExperiment", ",", "LLPdirName", ",", "SelectedDescr"}],
               "}"}]}]}], "]"}]}]}], "}"}], "]"}], ",", "\"\<MX\>\""}], 
     "]"}]}], ";"}], "//", "AbsoluteTiming"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "FacilityGivenExperiment", ",", "FullAcceptanceData0", ",", "decayDescr", 
     ",", 
     RowBox[{"c\[Tau]LLP", "[", 
      RowBox[{"mLLP_", ",", "\[Theta]2_"}], "]"}]}], "}"}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"dataAcceptances", "[", 
        RowBox[{"[", "#", "]"}], "]"}], "//", "Developer`ToPackedArray"}], 
      ")"}], "&"}], "/@", 
    RowBox[{"{", 
     RowBox[{"1", ",", "3", ",", 
      RowBox[{"-", "2"}], ",", 
      RowBox[{"-", "1"}]}], "}"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ldecayLLP", "[", 
    RowBox[{"mLLP_", ",", "\[Theta]2_", ",", "ELLP_"}], "]"}], "=", 
   RowBox[{
    RowBox[{"c\[Tau]LLP", "[", 
     RowBox[{"mLLP", ",", "\[Theta]2"}], "]"}], "*", 
    FractionBox[
     SqrtBox[
      RowBox[{
       SuperscriptBox["ELLP", "2"], "-", 
       SuperscriptBox["mLLP", "2"]}]], "mLLP"]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BrVis", "[", "mLLP_", "]"}], "=", 
   RowBox[{"dataAcceptances", "[", 
    RowBox[{"[", "5", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"LogLogPlot", "[", 
   RowBox[{
    RowBox[{"Evaluate", "[", 
     RowBox[{"BrVis", "[", "mLLP", "]"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"mLLP", ",", "0.02", ",", "10"}], "}"}], ",", 
    RowBox[{"Frame", "->", "True"}], ",", 
    RowBox[{"ImageSize", "->", "Large"}], ",", 
    RowBox[{"FrameStyle", "\[Rule]", 
     RowBox[{"Directive", "[", 
      RowBox[{"Black", ",", " ", "22"}], "]"}]}], ",", 
    RowBox[{"PlotStyle", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Thickness", "[", "0.003", "]"}], ",", "Blue"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Thickness", "[", "0.003", "]"}], ",", 
         RowBox[{"Darker", "@", "Red"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Thickness", "[", "0.003", "]"}], ",", 
         RowBox[{"Darker", "@", 
          RowBox[{"Darker", "@", "Green"}]}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Thickness", "[", "0.003", "]"}], ",", "Black"}], "}"}]}], 
      "}"}]}], ",", 
    RowBox[{"GridLines", "\[Rule]", "Automatic"}], ",", 
    RowBox[{"PlotRange", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0.1", ",", "10"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0.01", ",", "1.2"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"Frame", "\[Rule]", "True"}], ",", 
    RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
    RowBox[{"FrameLabel", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"\"\<m [GeV]\>\"", 
       ",", "\"\<\!\(\*SubscriptBox[\(Br\), \(vis\)]\)\>\""}], "}"}]}], ",", 
    RowBox[{"PlotLabel", "\[Rule]", " ", 
     RowBox[{"Style", "[", 
      RowBox[{
       RowBox[{"Row", "[", 
        RowBox[{"{", 
         RowBox[{"\"\<For \>\"", ",", "SelectedExperiment", ",", "\"\<. \>\"",
           ",", "SelectedDescr"}], "}"}], "]"}], ",", " ", "20", ",", " ", 
       "Black"}], "]"}]}]}], "]"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"___", "___", "___", "___", "___", "___", "___", "___", "___"}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Interpolation", " ", "of", " ", "the", " ", "tabulated", " ", 
     "azimuthal", " ", "acceptance"}], ",", " ", 
    RowBox[{"extracting", " ", 
     SubscriptBox["\[Theta]", 
      RowBox[{"min", "/", "max"}]]}], ",", " ", 
    RowBox[{"etc", "."}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"___", "___", "___", "___", "___", "___", "___", "___", "___"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"AzimuthalAcceptanceInt", "[", 
       RowBox[{"\[Theta]LLP_", ",", "zLLP_"}], "]"}], ",", 
      "\[Theta]minExpAll", ",", "\[Theta]maxExpAll", ",", "\[Theta]minExp", ",",
       "\[Theta]maxExp", ",", "zminExp", ",", "zmaxExp", ",", 
      RowBox[{"zmin\[Theta]", "[", "\[Theta]LLP_", "]"}], ",", 
      RowBox[{"zmax\[Theta]", "[", "\[Theta]LLP_", "]"}]}], "}"}], "=", 
    RowBox[{"Block\[Epsilon]Azimuthal", "[", "FullAcceptanceData0", "]"}]}], 
   ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Logarithmized", " ", "data", " ", "with", " ", "full", " ", 
     "acceptance"}], ",", " ", 
    RowBox[{
    "and", " ", "also", " ", "decay", " ", "acceptance", " ", "and", " ", 
     "full", " ", "acceptance", " ", "interpolations"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"FullAcceptanceData", ",", 
     RowBox[{"DecayAcceptanceInt", "[", 
      RowBox[{"mLLP_", ",", "\[Theta]LLP_", ",", "ELLP_", ",", "zLLP_"}], 
      "]"}], ",", 
     RowBox[{"FullAcceptanceInt", "[", 
      RowBox[{"mLLP_", ",", "\[Theta]LLP_", ",", "ELLP_", ",", "zLLP_"}], 
      "]"}], ",", "InGridm\[Epsilon]", ",", "InGrid\[Theta]\[Epsilon]", ",", 
     "InGridE\[Epsilon]", ",", "InGridz\[Epsilon]", ",", "\[Epsilon]vals", ",",
      "\[Epsilon]azvals", ",", "mmin\[Epsilon]", ",", "mmax\[Epsilon]"}], 
    "}"}], "=", 
   RowBox[{"Block\[Epsilon]Decay", "[", 
    RowBox[{"FullAcceptanceData0", ",", "zminExp", ",", "BrVis"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CrossSectionData", "=", 
   RowBox[{
    RowBox[{"dataAcceptances", "[", 
     RowBox[{"[", "4", "]"}], "]"}], "//", "Transpose"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NpotGivenExperiment", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Select", "[", 
       RowBox[{"CrossSectionData", ",", 
        RowBox[{
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", "\"\<Npot\>\""}], 
         "&"}]}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}], "[", 
     RowBox[{"[", "2", "]"}], "]"}], "//", "N"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Row", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"\"\<Search for \>\"", "<>", "LLPdirName", "<>", "\"\< at \>\""}],
     ",", " ", "SelectedExperiment", ",", " ", "\"\< located at \>\"", ",", 
    "FacilityGivenExperiment", 
    ",", "\"\<. \!\(\*SubscriptBox[\(N\), \(collisions\)]\) = \>\"", ",", 
    "NpotGivenExperiment", ",", "\"\<. Decays description: \>\"", ",", 
    "decayDescr"}], "}"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"\"\<Quantity\>\"", 
      ",", "\"\<\!\(\*SubscriptBox[\(\[Theta]\), \(min\)]\), rad\>\"", 
      ",", "\"\<\!\(\*SubscriptBox[\(\[Theta]\), \(max\)]\), rad\>\"", 
      ",", "\"\<\!\(\*SubscriptBox[\(\[Theta]\), \
\(min\)]\)(\!\(\*SubscriptBox[\(\[Epsilon]\), \(dec\)]\)), rad\>\"", 
      ",", "\"\<\!\(\*SubscriptBox[\(\[Theta]\), \
\(max\)]\)(\!\(\*SubscriptBox[\(\[Epsilon]\), \(dec\)]\)), rad\>\"", 
      ",", "\"\<\!\(\*SubscriptBox[\(z\), \(min\)]\), m\>\"", 
      ",", "\"\<\!\(\*SubscriptBox[\(z\), \(max\)]\), m\>\""}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"\"\<Description\>\"", 
      ",", "\"\<Min angle covered by experiment\>\"", 
      ",", "\"\<Max angle covered by experiment\>\"", 
      ",", "\"\<Min angle where \!\(\*SubscriptBox[\(\[Epsilon]\), \(decay\)]\
\)\[NotEqual]0\>\"", 
      ",", "\"\<Max angle where \!\(\*SubscriptBox[\(\[Epsilon]\), \(decay\)]\
\)\[NotEqual]0\>\"", ",", "\"\<Min long. displacement of the decay volume\>\"",
       ",", "\"\<Max long. displacement of the decay volume\>\""}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"\"\<Value\>\"", ",", "\[Theta]minExpAll", ",", 
      "\[Theta]maxExpAll", ",", "\[Theta]minExp", ",", "\[Theta]maxExp", ",", 
      "zminExp", ",", "zmaxExp"}], "}"}]}], "}"}], "//", 
  "TableForm"}]}], "Input",
 CellChangeTimes->{{3.887616632812935*^9, 3.8876168497686005`*^9}, {
   3.888251530196273*^9, 3.8882515340160594`*^9}, 3.8882534456879063`*^9, {
   3.8884784564935985`*^9, 3.888478513515301*^9}, {3.889769450733754*^9, 
   3.8897695160785046`*^9}, {3.890276444268669*^9, 3.8902765197982826`*^9}, {
   3.8902769753320246`*^9, 3.890277063848443*^9}, {3.89029301158574*^9, 
   3.8902930326548223`*^9}, {3.890450545303482*^9, 3.8904505545644875`*^9}, {
   3.8906407235353084`*^9, 3.8906407314124126`*^9}, {3.8906408349101224`*^9, 
   3.8906408684018974`*^9}, {3.890640931765955*^9, 3.8906411157907934`*^9}, {
   3.8906413239966087`*^9, 3.890641351146014*^9}, {3.8906416293135357`*^9, 
   3.8906417006238556`*^9}, 3.890649737845924*^9, {3.8907327710594864`*^9, 
   3.8907328244291196`*^9}, {3.890841045817673*^9, 3.8908410473572907`*^9}, {
   3.8908411795939927`*^9, 3.8908412559394007`*^9}, {3.8908816406962395`*^9, 
   3.8908816414138947`*^9}, {3.8910185044000244`*^9, 
   3.8910185055215836`*^9}, {3.891018598736998*^9, 3.8910186531034822`*^9}, {
   3.8910187603916593`*^9, 3.8910188102489433`*^9}, {3.8910189914791217`*^9, 
   3.8910190052678776`*^9}, {3.8910190582236977`*^9, 
   3.8910190891531334`*^9}, {3.8910191525376396`*^9, 
   3.8910191962576494`*^9}, {3.8910192415536337`*^9, 3.891019242051064*^9}, {
   3.891019278738369*^9, 3.891019289551962*^9}, {3.8922836313067636`*^9, 
   3.892283672257635*^9}, {3.8922839861466465`*^9, 3.892284023704517*^9}, {
   3.8922848675053596`*^9, 3.8922848910145073`*^9}, {3.892286670688157*^9, 
   3.892286670906936*^9}, {3.8925415783035374`*^9, 3.892541579018721*^9}, {
   3.892910981609494*^9, 3.8929109821176815`*^9}, {3.8931718223536196`*^9, 
   3.8931718380115795`*^9}, {3.89322450856604*^9, 3.893224512604451*^9}, {
   3.8946364771706233`*^9, 3.894636590020763*^9}, {3.8946366257009597`*^9, 
   3.894636704342059*^9}, {3.894637111414814*^9, 3.894637139145834*^9}, {
   3.895054585436878*^9, 3.895054597657593*^9}, {3.897208167605433*^9, 
   3.8972081790966396`*^9}, 3.8972082634740195`*^9, {3.899198048024173*^9, 
   3.899198070580115*^9}, {3.9026481259639745`*^9, 3.902648129112234*^9}, {
   3.9027636496644955`*^9, 3.902763650168706*^9}, {3.904889793908601*^9, 
   3.9048897953457546`*^9}, {3.904898805074805*^9, 3.904898805137748*^9}, {
   3.9048989514118404`*^9, 3.9048990615643806`*^9}, {3.9049020270890265`*^9, 
   3.9049020378968315`*^9}, {3.9138256011929398`*^9, 3.913825601212048*^9}, {
   3.9138256681330395`*^9, 3.913825668148815*^9}, {3.913826009552044*^9, 
   3.913826343155006*^9}, {3.9138265848664308`*^9, 3.913826594749091*^9}, 
   3.9138678033463206`*^9, {3.913867856807685*^9, 3.913867865250205*^9}, {
   3.9138681487385883`*^9, 3.9138681647575436`*^9}, {3.9138683472266283`*^9, 
   3.913868364976361*^9}, {3.913891180746874*^9, 3.91389118464016*^9}, {
   3.9139673961123624`*^9, 3.913967406910553*^9}, {3.9139674494342346`*^9, 
   3.9139674550474334`*^9}, {3.914062594955474*^9, 3.9140626001029625`*^9}, {
   3.9145151387923365`*^9, 3.914515148966633*^9}, {3.9156430917522516`*^9, 
   3.9156430919365425`*^9}, {3.916679464890795*^9, 3.9166795026535707`*^9}, {
   3.932531195345968*^9, 3.932531196168898*^9}, {3.934596981096116*^9, 
   3.9345969942903523`*^9}, {3.942322973185732*^9, 3.942323024489277*^9}, {
   3.9476500390812645`*^9, 3.947650060088049*^9}, 3.9476504264762135`*^9, {
   3.947650593611046*^9, 3.947650740016346*^9}, {3.947650812793936*^9, 
   3.9476508135856953`*^9}, {3.947650981100212*^9, 3.947650981237177*^9}, 
   3.947686494168375*^9, 3.9506819607228584`*^9, {3.9506820458145294`*^9, 
   3.950682074528141*^9}},
 CellTags->{
  "Acceptance-computation", "Number-of-events-computation+sensitivity"},
 CellLabel->
  "In[203]:=",ExpressionUUID->"7b50f7c1-8794-4b1c-9865-2720540ddacb"],

Cell[CellGroupData[{

Cell["\<\
Checking if all distributions have corresponding weights, and vice versa\
\>", "Section",
 CellChangeTimes->{{3.9506325765805607`*^9, 3.9506325768620872`*^9}, {
  3.9506334272032604`*^9, 3.950633428585764*^9}, {3.950633747287016*^9, 
  3.950633760072397*^9}},
 CellTags->{
  "Acceptance-computation", 
   "Number-of-events-computation+sensitivity"},ExpressionUUID->"4ddd9b4f-e91e-\
fe43-b1cc-ed99a5ceca23"],

Cell[CellGroupData[{

Cell["\<\
List of angle-energy distributions and production weights for the given \
facility\
\>", "Subsection",
 CellChangeTimes->{{3.950633460120825*^9, 3.950633477192444*^9}},
 CellTags->{
  "Acceptance-computation", 
   "Number-of-events-computation+sensitivity"},ExpressionUUID->"1a318efd-8ede-\
5c47-af63-d2a909300e8b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"DistrCombinationsSelectedFacility", "=", 
   RowBox[{"Select", "[", 
    RowBox[{"DistrCombinations", ",", 
     RowBox[{
      RowBox[{
       RowBox[{"#", "[", 
        RowBox[{"[", "3", "]"}], "]"}], "==", "FacilityGivenExperiment"}], 
      "&"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"WeightsCombinationsSelectedFacility", "=", 
   RowBox[{"Select", "[", 
    RowBox[{"WeightsCombinations", ",", 
     RowBox[{
      RowBox[{
       RowBox[{"#", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "==", "FacilityGivenExperiment"}], 
      "&"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"MemberQ", "[", 
      RowBox[{
       RowBox[{"DistrCombinationsSelectedFacility", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "2"}], "]"}], "]"}], 
       ",", "\"\<Bremsstrahlung-FR-mixing\>\""}], "]"}], "||", 
     RowBox[{"MemberQ", "[", 
      RowBox[{
       RowBox[{"DistrCombinationsSelectedFacility", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "2"}], "]"}], "]"}], 
       ",", "\"\<Bremsstrahlung-AP-mixing\>\""}], "]"}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"FacilitiesFR", "=", 
      RowBox[{
       RowBox[{"Select", "[", 
        RowBox[{"DistrCombinationsSelectedFacility", ",", 
         RowBox[{
          RowBox[{"StringContainsQ", "[", 
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "2", "]"}], "]"}], ",", 
            RowBox[{"{", "\"\<FR\>\"", "}"}]}], "]"}], "&"}]}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "3"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"FacilitiesAP", "=", 
      RowBox[{
       RowBox[{"Select", "[", 
        RowBox[{"DistrCombinationsSelectedFacility", ",", 
         RowBox[{
          RowBox[{"StringContainsQ", "[", 
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "2", "]"}], "]"}], ",", 
            RowBox[{"{", "\"\<AP\>\"", "}"}]}], "]"}], "&"}]}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "3"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"DistrCombinationsToCheck", "=", 
      RowBox[{"Select", "[", 
       RowBox[{"DistrCombinationsSelectedFacility", ",", 
        RowBox[{
         RowBox[{"!", 
          RowBox[{"StringContainsQ", "[", 
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "2", "]"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"\"\<FR\>\"", ",", "\"\<AP\>\""}], "}"}]}], "]"}]}], 
         "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"DistrCombinationsToCheck", "=", 
      RowBox[{
       RowBox[{"Join", "[", 
        RowBox[{"DistrCombinationsToCheck", ",", 
         RowBox[{"Flatten", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"LLPdirName", ",", "brem", ",", "fac"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"fac", ",", "FacilitiesFR"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"brem", ",", 
               RowBox[{
                RowBox[{"Select", "[", 
                 RowBox[{"WeightsCombinations", ",", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "==", "fac"}], "&&", 
                    RowBox[{"StringContainsQ", "[", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", "\"\<FR\>\""}], 
                    "]"}]}], "&"}]}], "]"}], "[", 
                RowBox[{"[", 
                 RowBox[{"All", ",", "1"}], "]"}], "]"}]}], "}"}]}], "]"}], ",",
            "1"}], "]"}], ",", 
         RowBox[{"Flatten", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"LLPdirName", ",", "brem", ",", "fac"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"fac", ",", "FacilitiesAP"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"brem", ",", 
               RowBox[{
                RowBox[{"Select", "[", 
                 RowBox[{"WeightsCombinations", ",", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "==", "fac"}], "&&", 
                    RowBox[{"StringContainsQ", "[", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", "\"\<AP\>\""}], 
                    "]"}]}], "&"}]}], "]"}], "[", 
                RowBox[{"[", 
                 RowBox[{"All", ",", "1"}], "]"}], "]"}]}], "}"}]}], "]"}], ",",
            "1"}], "]"}]}], "]"}], "//", "Sort"}]}], ";"}], 
    "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
    RowBox[{
    "DistrCombinationsToCheck", "=", "DistrCombinationsSelectedFacility"}]}], 
   "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"drellyankeys", "=", 
   RowBox[{"Select", "[", 
    RowBox[{"WeightsCombinationsSelectedFacility", ",", 
     RowBox[{
      RowBox[{"StringContainsQ", "[", 
       RowBox[{
        RowBox[{"#", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", "\"\<DrellYan\>\""}], "]"}], 
      "&"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DistrCombinationsToCheck", "=", 
   RowBox[{"Select", "[", 
    RowBox[{"DistrCombinationsToCheck", ",", 
     RowBox[{
      RowBox[{"!", 
       RowBox[{"StringContainsQ", "[", 
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "2", "]"}], "]"}], ",", "\"\<DrellYan\>\""}], "]"}]}], 
      "&"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DistrCombinationsToCheck", "=", 
   RowBox[{"Join", "[", 
    RowBox[{"DistrCombinationsToCheck", ",", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"LLPdirName", ",", 
         RowBox[{
          RowBox[{"drellyankeys", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", 
         RowBox[{
          RowBox[{"drellyankeys", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "drellyankeys", "]"}], ",", "1"}], "}"}]}], 
      "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"DistrCombinationsToCheck", ";"}], "\[IndentingNewLine]", 
 RowBox[{"WeightsCombinationsSelectedFacility", ";"}]}], "Input",
 CellChangeTimes->{{3.950632759830923*^9, 3.950632760199877*^9}, {
  3.950632840248455*^9, 3.950632878926874*^9}, {3.9506329342094135`*^9, 
  3.9506330750435047`*^9}, {3.9506332640043545`*^9, 3.9506332684904785`*^9}, {
  3.95063336592737*^9, 3.950633366140545*^9}, {3.950633423556576*^9, 
  3.950633424039562*^9}, {3.950633489564089*^9, 3.9506334899840126`*^9}, {
  3.9506820287135544`*^9, 3.9506820337421913`*^9}},
 CellTags->{
  "Acceptance-computation", "Number-of-events-computation+sensitivity"},
 CellLabel->
  "In[214]:=",ExpressionUUID->"5bd80042-e980-5b4f-b4d4-7b8811007fcf"]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Checking if all weights have their corresponding distributions\
\>", "Subsection",
 CellChangeTimes->{{3.950633494221611*^9, 3.9506335163250427`*^9}},
 CellTags->{
  "Acceptance-computation", 
   "Number-of-events-computation+sensitivity"},ExpressionUUID->"fe29ce4a-c131-\
f843-836e-647a8e8e6d9a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"IfCondDistrToWeights", "=", 
   RowBox[{"IfCondWeightsToDistr", "=", "True"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"allAvailable", "=", "True"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"missingDistr", "=", 
   RowBox[{"{", 
    RowBox[{"{", "}"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"missingWeights", "=", 
   RowBox[{"{", 
    RowBox[{"{", "}"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"condcontinue", "=", "True"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"distrrow", "=", 
     RowBox[{"DistrCombinationsToCheck", "[", 
      RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"condWeights", "=", 
     RowBox[{
      RowBox[{"Select", "[", 
       RowBox[{"WeightsCombinationsSelectedFacility", ",", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "==", 
           RowBox[{"distrrow", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "&&", 
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "==", 
           RowBox[{"distrrow", "[", 
            RowBox[{"[", "3", "]"}], "]"}]}]}], "&"}]}], "]"}], "!=", 
      RowBox[{"{", "}"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"condWeights", "==", "False"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"missingWeights", "=", 
        RowBox[{"Join", "[", 
         RowBox[{"missingWeights", ",", 
          RowBox[{"{", "distrrow", "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"allAvailable", "=", "False"}], ";"}]}], "\[IndentingNewLine]",
      "]"}], ";"}], "\[IndentingNewLine]", ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "1", ",", 
     RowBox[{"Length", "[", "DistrCombinationsToCheck", "]"}], ",", "1"}], 
    "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"weightrow", "=", 
     RowBox[{"WeightsCombinationsSelectedFacility", "[", 
      RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"condDistr", "=", 
     RowBox[{
      RowBox[{"Select", "[", 
       RowBox[{"DistrCombinationsToCheck", ",", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "==", 
           RowBox[{"weightrow", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], "&&", 
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "3", "]"}], "]"}], "==", 
           RowBox[{"weightrow", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}]}], "&"}]}], "]"}], "!=", 
      RowBox[{"{", "}"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"condDistr", "==", "False"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"missingDistr", "=", 
        RowBox[{"Join", "[", 
         RowBox[{"missingDistr", ",", 
          RowBox[{"{", "weightrow", "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"allAvailable", "=", "False"}], ";"}]}], "\[IndentingNewLine]",
      "]"}], ";"}], "\[IndentingNewLine]", ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "1", ",", 
     RowBox[{"Length", "[", "WeightsCombinationsSelectedFacility", "]"}], ",",
      "1"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"!", "allAvailable"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"missingDistr", "=", 
     RowBox[{"Drop", "[", 
      RowBox[{"missingDistr", ",", "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"missingWeights", "=", " ", 
     RowBox[{"Drop", "[", 
      RowBox[{"missingWeights", ",", "1"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"choiceContinue", "=", 
     RowBox[{"DialogInput", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"choice", "=", "\"\<Stop computation\>\""}], "}"}], ",", 
       RowBox[{"Column", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Style", "[", 
           RowBox[{
            RowBox[{"Row", "[", 
             RowBox[{
             "{", "\"\<You have not provided the production probabilities \
PmotherToLLP to all the generated tabulated distributions!\>\"", "}"}], "]"}],
             ",", "Bold"}], "]"}], ",", 
          RowBox[{"Style", "[", 
           RowBox[{
            RowBox[{"Row", "[", 
             RowBox[{"{", "\"\<Missing distributions:\>\"", "}"}], "]"}], ",",
             "Bold"}], "]"}], ",", 
          RowBox[{"Style", "[", 
           RowBox[{
            RowBox[{"Row", "[", 
             RowBox[{"{", "missingDistr", "}"}], "]"}], ",", "Bold"}], "]"}], 
          ",", 
          RowBox[{"Style", "[", 
           RowBox[{
            RowBox[{"Row", "[", 
             RowBox[{"{", "\"\<Missing weights:\>\"", "}"}], "]"}], ",", 
            "Bold"}], "]"}], ",", 
          RowBox[{"Style", "[", 
           RowBox[{
            RowBox[{"Row", "[", 
             RowBox[{"{", "missingWeights", "}"}], "]"}], ",", "Bold"}], 
           "]"}], ",", 
          RowBox[{"Spacer", "[", "5", "]"}], ",", 
          RowBox[{"Style", "[", 
           RowBox[{
            RowBox[{"Row", "[", 
             RowBox[{
             "{", "\"\<Stop computation or continue (but keeping only the \
production modes with weights and distributions?\>\"", "}"}], "]"}], ",", 
            "Bold"}], "]"}], ",", 
          RowBox[{"PopupMenu", "[", 
           RowBox[{
            RowBox[{"Dynamic", "[", "choice", "]"}], ",", 
            RowBox[{"{", 
             
             RowBox[{"\"\<Stop computation\>\"", 
              ",", "\"\<Continue anyway\>\""}], "}"}]}], "]"}], ",", 
          RowBox[{"Spacer", "[", "5", "]"}], ",", 
          RowBox[{"Button", "[", 
           RowBox[{"\"\<Proceed\>\"", ",", 
            RowBox[{"DialogReturn", "[", "choice", "]"}], ",", 
            RowBox[{"ImageSize", "->", "Automatic"}]}], "]"}]}], "}"}], 
        "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"choiceContinue", "==", "\"\<Stop computation\>\""}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"condcontinue", "=", "False"}], "\[IndentingNewLine]", ",", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"DistrCombinationsSelectedFacility1", "=", 
         RowBox[{"Select", "[", 
          RowBox[{"DistrCombinationsSelectedFacility", ",", 
           RowBox[{
            RowBox[{"!", 
             RowBox[{"MemberQ", "[", 
              RowBox[{"missingWeights", ",", "#"}], "]"}]}], "&"}]}], "]"}]}],
         ";", "\[IndentingNewLine]", 
        RowBox[{"WeightsCombinationsSelectedFacility1", "=", 
         RowBox[{"Select", "[", 
          RowBox[{"WeightsCombinationsSelectedFacility", ",", 
           RowBox[{
            RowBox[{"!", 
             RowBox[{"MemberQ", "[", 
              RowBox[{"missingDistr", ",", "#"}], "]"}]}], "&"}]}], "]"}]}], 
        ";"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"patternsToRemoveWeights", "=", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"missingWeights", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "2"}], "]"}], "]"}], ",", 
          RowBox[{"missingDistr", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "1"}], "]"}], "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"patternsToRemoveDistr", "=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"StringReplace", "[", 
             RowBox[{"#", ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"\"\<-Lower\>\"", "->", "\"\<\>\""}], ",", 
                RowBox[{"\"\<-Central\>\"", "->", "\"\<\>\""}], ",", 
                RowBox[{"\"\<-Upper\>\"", "->", "\"\<\>\""}]}], "}"}]}], 
             "]"}], "&"}], "/@", 
           RowBox[{"Join", "[", 
            RowBox[{
             RowBox[{"missingWeights", "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", "2"}], "]"}], "]"}], ",", 
             RowBox[{"missingDistr", "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", "1"}], "]"}], "]"}]}], "]"}]}], ")"}], "//",
          "DeleteDuplicates"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"DistrCombinationsSelectedFacility", "=", 
        RowBox[{"Select", "[", 
         RowBox[{"DistrCombinationsSelectedFacility", ",", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"MemberQ", "[", 
             RowBox[{"patternsToRemoveDistr", ",", 
              RowBox[{"#", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "&"}]}], "]"}]}], ";",
        "\[IndentingNewLine]", 
       RowBox[{"WeightsCombinationsSelectedFacility", "=", 
        RowBox[{"Select", "[", 
         RowBox[{"WeightsCombinationsSelectedFacility", ",", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"MemberQ", "[", 
             RowBox[{"patternsToRemoveWeights", ",", 
              RowBox[{"#", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], "&"}]}], "]"}]}], ";",
        "\[IndentingNewLine]", 
       RowBox[{"DistrCombinationsToCheck", "=", 
        RowBox[{"Select", "[", 
         RowBox[{"DistrCombinationsToCheck", ",", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"MemberQ", "[", 
             RowBox[{"patternsToRemoveWeights", ",", 
              RowBox[{"#", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "&"}]}], "]"}]}], 
       ";"}]}], "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"condcontinue", "&&", 
    RowBox[{"StringContainsQ", "[", 
     RowBox[{"computationchoice", ",", "\"\<Tabulated Nevents\>\""}], "]"}]}],
    ",", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Delete", " ", "previously", " ", "computed", " ", "tabulated", " ", 
     "number", " ", "of", " ", "events"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"directory", "[", "\"\<Nevents\>\"", "]"}], "=", 
     RowBox[{"FileNameJoin", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"NotebookDirectory", "[", "]"}], 
        ",", "\"\<Tabulated Nevents\>\""}], "}"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"directory", "[", "\"\<Nevents-LLP\>\"", "]"}], "=", 
     RowBox[{"FileNameJoin", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"NotebookDirectory", "[", "]"}], 
        ",", "\"\<Tabulated Nevents\>\"", ",", "LLPdirName"}], "}"}], "]"}]}],
     ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"directory", "[", "\"\<Nevents-LLP-experiment\>\"", "]"}], "=", 
     RowBox[{"FileNameJoin", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"NotebookDirectory", "[", "]"}], 
        ",", "\"\<Tabulated Nevents\>\"", ",", "LLPdirName", ",", 
        "SelectedExperiment"}], "}"}], "]"}]}], ";"}]}], 
  "\[IndentingNewLine]", "]"}]}], "Input",
 CellChangeTimes->{{3.9506331104738274`*^9, 3.950633114577772*^9}, {
   3.95063351901915*^9, 3.9506335426713886`*^9}, {3.9506335729961224`*^9, 
   3.950633733919876*^9}, {3.950634498508953*^9, 3.9506346358571796`*^9}, {
   3.9506346685005493`*^9, 3.9506346804616184`*^9}, {3.9506347360546227`*^9, 
   3.9506347465200996`*^9}, {3.9506347956276207`*^9, 3.950634808025696*^9}, {
   3.950670799326351*^9, 3.9506708156981773`*^9}, {3.9506709225996647`*^9, 
   3.9506709491094894`*^9}, {3.9508985329055157`*^9, 3.950898549125225*^9}, 
   3.952249289357939*^9, {3.952698621324131*^9, 3.952698621757145*^9}},
 CellTags->{
  "Acceptance-computation", "Number-of-events-computation+sensitivity"},
 CellLabel->
  "In[222]:=",ExpressionUUID->"135cebc8-e0af-7447-94ef-58448a721e2f"]
}, Closed]]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["LLP angle-energy distributions for the given experiment", "Chapter",
 CellChangeTimes->{{3.885020702966837*^9, 3.885020711525731*^9}, {
   3.8850216924759345`*^9, 3.8850216984444695`*^9}, {3.8851404110391607`*^9, 
   3.8851404117847*^9}, {3.887617886112608*^9, 3.8876178892728467`*^9}, {
   3.8937319703346663`*^9, 3.893731971979699*^9}, {3.897229058985351*^9, 
   3.8972290631420875`*^9}, 3.915643091954241*^9},
 CellTags->{
  "Acceptance-computation", 
   "Number-of-events-computation+sensitivity"},ExpressionUUID->"775c9f90-cfc2-\
4104-a914-805ee6203cb5"],

Cell[CellGroupData[{

Cell["Specifying production channels", "Section",
 CellChangeTimes->{{3.9506821321973515`*^9, 3.950682136034788*^9}},
 CellTags->{
  "Acceptance-computation", 
   "Number-of-events-computation+sensitivity"},ExpressionUUID->"a8f01eed-d394-\
2044-8bc4-48a0ab7afd84"],

Cell[BoxData[
 RowBox[{"If", "[", 
  RowBox[{"condcontinue", ",", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "List", " ", "of", " ", "production", " ", "channels", " ", "for", " ", 
     "the", " ", "selected", " ", "facility"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
    "ProductionPatternSelectedDistr", "=", 
     "DistrCombinationsSelectedFacility"}], ";", "\[IndentingNewLine]", 
    RowBox[{"ProductionPatternSelected", "=", "DistrCombinationsToCheck"}], ";",
     "\[IndentingNewLine]", 
    RowBox[{"ProductionListTemp", "=", 
     RowBox[{
      RowBox[{"ProductionPatternSelected", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "2"}], "]"}], "]"}], "//", "DeleteDuplicates"}]}],
     ";", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{
      "Selecting", " ", "only", " ", "those", " ", "bremsstrahlung", " ", 
       "channels", " ", "for", " ", "which", " ", "the", " ", "distribution", 
       " ", "is", " ", "non"}], "-", "zero"}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{"BremVariantsGivenFacility", "=", 
     RowBox[{
      RowBox[{"Select", "[", 
       RowBox[{
        RowBox[{"WeightsCombinationsSelectedFacility", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", "2"}], "}"}]}], "]"}], "]"}], ",", 
        RowBox[{
         RowBox[{"StringContainsQ", "[", 
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", "\"\<Bremsstrahlung\>\""}], 
          "]"}], "&"}]}], "]"}], "[", 
      RowBox[{"[", 
       RowBox[{"All", ",", "1"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"Do", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"ProbMother", "[", "channel", "]"}], "=", "1"}], ";"}], 
      "\[IndentingNewLine]", ",", 
      RowBox[{"{", 
       RowBox[{"channel", ",", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"{", "\"\<DrellYan\>\"", "}"}], ",", 
          "BremVariantsGivenFacility", ",", 
          RowBox[{"{", 
           RowBox[{"\"\<Mixing\>\"", ",", "\"\<Mixing-Old\>\""}], "}"}]}], 
         "]"}]}], "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"Print", "[", "\"\<Production list:\>\"", "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
     "Deciding", " ", "if", " ", "the", " ", "bremsstrahlung", " ", 
      "contributes", " ", "to", " ", "the", " ", "production", " ", "by", " ",
       "comparing", " ", 
      SubscriptBox["\[Theta]", 
       RowBox[{"max", ",", "brem"}]], " ", "with", " ", 
      SubscriptBox["\[Theta]", 
       RowBox[{"min", ",", "experiment"}]]}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{"Do", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"ELLPmax", "[", 
         RowBox[{"mLLP_", ",", "\[Theta]LLP_", ",", "ch"}], "]"}], "=", 
        RowBox[{"ELLPmax", "[", 
         RowBox[{
         "mLLP", ",", "\[Theta]LLP", ",", "ch", ",", 
          "FacilityGivenExperiment"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ELLPmin", "[", "ch", "]"}], "=", 
        RowBox[{"ELLPmin", "[", 
         RowBox[{"ch", ",", "FacilityGivenExperiment"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\[Theta]maxBrem", "[", "ch", "]"}], "=", 
        RowBox[{"\[Theta]maxBrem", "[", 
         RowBox[{"ch", ",", "FacilityGivenExperiment"}], "]"}]}]}], 
      "\[IndentingNewLine]", ",", 
      RowBox[{"{", 
       RowBox[{"ch", ",", "BremVariantsGivenFacility"}], "}"}]}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"ProdListBrem", "=", 
     RowBox[{"Select", "[", 
      RowBox[{"ProductionListTemp", ",", 
       RowBox[{
        RowBox[{"StringContainsQ", "[", 
         RowBox[{"#", ",", "\"\<Bremsstrahlung\>\""}], "]"}], "&"}]}], 
      "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"ProdListBremSelected", "=", 
       RowBox[{"Select", "[", 
        RowBox[{"ProdListBrem", ",", 
         RowBox[{
          RowBox[{
           RowBox[{"\[Theta]maxBrem", "[", "#", "]"}], ">", 
           "\[Theta]minExp"}], "&"}]}], "]"}]}], ";"}], "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{"ProdListBremSelected", "=", "ProdListBrem"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"ProductionList", "=", 
     RowBox[{"Join", "[", 
      RowBox[{"ProdListBremSelected", ",", 
       RowBox[{"Select", "[", 
        RowBox[{"ProductionListTemp", ",", 
         RowBox[{
          RowBox[{"!", 
           RowBox[{"StringContainsQ", "[", 
            RowBox[{"#", ",", "\"\<Bremsstrahlung\>\""}], "]"}]}], "&"}]}], 
        "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"Print", "[", 
     RowBox[{"Row", "[", 
      RowBox[{"{", "ProductionList", "}"}], "]"}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
     "Production", " ", "list", " ", "with", " ", "only", " ", "baseline", " ",
       "bremsstrahlung", " ", "description"}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{"BremSelected", "=", "\"\<Bremsstrahlung-AP-Central-mixing\>\""}],
     ";", "\[IndentingNewLine]", 
    RowBox[{
    "Print", "[", "\"\<Baseline brem channel production list:\>\"", "]"}], ";",
     "\[IndentingNewLine]", 
    RowBox[{"ProductionListBaseline", "=", 
     RowBox[{"Select", "[", 
      RowBox[{"ProductionList", ",", 
       RowBox[{
        RowBox[{
         RowBox[{"!", 
          RowBox[{"StringContainsQ", "[", 
           RowBox[{"#", ",", "\"\<Bremsstrahlung\>\""}], "]"}]}], "||", 
         RowBox[{"#", "==", "BremSelected"}]}], "&"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"Print", "[", 
     RowBox[{"Row", "[", 
      RowBox[{"{", "ProductionListBaseline", "}"}], "]"}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"Do", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"!", 
          RowBox[{"MemberQ", "[", 
           RowBox[{"ProductionList", ",", 
            RowBox[{"_String", "?", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"StringContainsQ", "[", 
                RowBox[{"#", ",", "pattern"}], "]"}], "&"}], ")"}]}]}], 
           "]"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"ProductionPatternSelectedDistr", "=", 
          RowBox[{"Select", "[", 
           RowBox[{"ProductionPatternSelectedDistr", ",", 
            RowBox[{
             RowBox[{"!", 
              RowBox[{"StringContainsQ", "[", 
               RowBox[{
                RowBox[{"#", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], ",", "pattern"}], "]"}]}], 
             "&"}]}], "]"}]}]}], "\[IndentingNewLine]", "]"}], ";"}], 
      "\[IndentingNewLine]", ",", 
      RowBox[{"{", 
       RowBox[{"pattern", ",", 
        RowBox[{"{", 
         RowBox[{"\"\<AP\>\"", ",", "\"\<FR\>\"", ",", "\"\<BB\>\""}], 
         "}"}]}], "}"}]}], "]"}]}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.934597109988983*^9, 3.9345971302002783`*^9}, {
   3.9345971937504687`*^9, 3.9345972049673176`*^9}, 3.934597832397029*^9, {
   3.942301238751831*^9, 3.94230124466667*^9}, {3.950682176452038*^9, 
   3.950682182724062*^9}, {3.950682237120102*^9, 3.95068223730249*^9}, {
   3.950682268926359*^9, 3.9506823523142834`*^9}, 3.9511518102760468`*^9, {
   3.9522493050336914`*^9, 3.9522493097384605`*^9}},
 CellTags->{
  "Acceptance-computation", "Number-of-events-computation+sensitivity"},
 CellLabel->
  "In[231]:=",ExpressionUUID->"051f0c57-57b7-469c-819a-b66e6981ba84"]
}, Closed]],

Cell[CellGroupData[{

Cell["Yields of mother particles per collision", "Section",
 CellChangeTimes->{{3.950681994535095*^9, 3.950681999989935*^9}},
 CellTags->{
  "Acceptance-computation", 
   "Number-of-events-computation+sensitivity"},ExpressionUUID->"bd8630ef-ea3c-\
e146-a2d7-82986e6d4eef"],

Cell[BoxData[
 RowBox[{"If", "[", 
  RowBox[{"condcontinue", ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ProbMother", "[", "\"\<B-mixing\>\"", "]"}], "=", 
     RowBox[{
      RowBox[{"ProbMother", "[", "\"\<B-quartic\>\"", "]"}], "=", 
      RowBox[{
       RowBox[{"ProbMother", "[", "\"\<Bs-quartic\>\"", "]"}], "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Select", "[", 
          RowBox[{"CrossSectionData", ",", 
           RowBox[{
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", "\"\<Pb\>\""}], 
            "&"}]}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], "[", 
        RowBox[{"[", "2", "]"}], "]"}]}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ProbMother", "[", "\"\<h-quartic\>\"", "]"}], "=", 
     RowBox[{
      RowBox[{
       RowBox[{"Select", "[", 
        RowBox[{"CrossSectionData", ",", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", "\"\<Ph\>\""}], 
          "&"}]}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}], "[", 
      RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ProbMother", "[", "\"\<K-mixing\>\"", "]"}], "=", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"FacilityGivenExperiment", "==", "\"\<SPS\>\""}], ",", 
       "fractionDecayInFlightKplusKminus", ",", "0."}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ProbMother", "[", "\"\<Upsilon-mixing\>\"", "]"}], "=", 
     RowBox[{
      RowBox[{"ProbMother", "[", "\"\<Upsilon-quartic\>\"", "]"}], "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Select", "[", 
         RowBox[{"CrossSectionData", ",", 
          RowBox[{
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", "\"\<PUpsilon\>\""}],
            "&"}]}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], "[", 
       RowBox[{"[", "2", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ProbMother", "[", "\"\<Bremsstrahlung-AP-mixing\>\"", "]"}], "=", 
     RowBox[{
      RowBox[{"ProbMother", "[", "\"\<Bremsstrahlung-FR-mixing\>\"", "]"}], "=", 
      RowBox[{
       RowBox[{"ProbMother", "[", "\"\<Bremsstrahlung-BB-mixing\>\"", "]"}], "=",
        "1."}]}]}], ";"}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.950682112332142*^9, 3.9506821174378567`*^9}, {
  3.9511519174657574`*^9, 3.9511519310891914`*^9}},
 CellTags->{
  "Acceptance-computation", "Number-of-events-computation+sensitivity"},
 CellLabel->
  "In[232]:=",ExpressionUUID->"e3236aaa-3f2d-1545-b459-3a77342eee0a"]
}, Closed]],

Cell[CellGroupData[{

Cell["Importing distributions", "Section",
 CellChangeTimes->{{3.934180644626505*^9, 3.934180647632351*^9}, 
   3.9506823677031364`*^9},
 CellTags->{
  "Number-of-events-computation+sensitivity", 
   "Acceptance-computation"},ExpressionUUID->"4cfc4894-9abe-471a-bb9d-\
0878cefc8c61"],

Cell[BoxData[
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{"condcontinue", ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", "prod", 
          RowBox[{"(*", 
           RowBox[{",", "prodbrem"}], "*)"}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"prod", "=", 
           RowBox[{
            RowBox[{"ProductionPatternSelectedDistr", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"dirimp", "=", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"StringContainsQ", "[", 
              RowBox[{"prod", ",", 
               RowBox[{"{", 
                RowBox[{"\"\<DrellYan\>\"", ",", "\"\<Mixing\>\""}], "}"}]}], 
              "]"}], ",", 
             RowBox[{"FileNameJoin", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"directory", "[", "\"\<Distribution\>\"", "]"}], 
                ",", "\"\<Pregenerated\>\""}], "}"}], "]"}], ",", 
             RowBox[{"directory", "[", "\"\<Distribution\>\"", "]"}]}], 
            "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
           "Importing", " ", "the", " ", "data", " ", "with", " ", 
            "distribution"}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"!", 
             RowBox[{"StringContainsQ", "[", 
              RowBox[{"prod", ",", 
               RowBox[{"{", 
                RowBox[{"\"\<AP\>\"", ",", "\"\<FR\>\""}], "}"}]}], "]"}]}], ",",
             "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"DistrDataImport", "[", "prod", "]"}], "=", 
              RowBox[{"Abs", "[", 
               RowBox[{"Import", "[", 
                RowBox[{
                 RowBox[{"FileNameJoin", "[", 
                  RowBox[{"{", 
                   RowBox[{"dirimp", ",", 
                    
                    RowBox[{"\"\<DoubleDistr_\>\"", "<>", "LLPdirName", 
                    "<>", "\"\<_\>\"", "<>", "prod", "<>", "\"\<_\>\"", "<>", 
                    "FacilityGivenExperiment", "<>", "\"\<.m\>\""}]}], "}"}], 
                  "]"}], ",", "\"\<MX\>\""}], "]"}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"prod", "==", "\"\<DrellYan\>\""}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{
                 RowBox[{"DistrDataImport", "[", "prod", "]"}], "=", 
                 RowBox[{"Select", "[", 
                  RowBox[{
                   RowBox[{"DistrDataImport", "[", "prod", "]"}], ",", 
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    "MinMaxMassesDrellYan", "[", "FacilityGivenExperiment", 
                    "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "<=", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "<=", 
                    RowBox[{
                    RowBox[{
                    "MinMaxMassesDrellYan", "[", "FacilityGivenExperiment", 
                    "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "&"}]}], "]"}]}], 
                ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"DistrDataImport", "[", "prod", "]"}], "=", 
              RowBox[{
               RowBox[{
                RowBox[{"DistrDataImport", "[", "prod", "]"}], "//", "N"}], "//",
                "Developer`ToPackedArray"}]}], ";"}], "\[IndentingNewLine]", ",",
             "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{
              "If", " ", "the", " ", "selected", " ", "channel", " ", "is", " ",
                "Bremsstrahlung", " ", "under", " ", "the", " ", 
               "description", " ", "of", " ", "AP", " ", "or", " ", "FR"}], ",",
               " ", 
              RowBox[{
              "then", " ", "there", " ", "are", " ", "variants", " ", "for", " ",
                "the", " ", "description", " ", "parametrizing", " ", "the", " ",
                "theoretical", " ", "uncertainty"}]}], "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"DistrDataImportTemp", "[", "prod", "]"}], "=", 
              RowBox[{"Import", "[", 
               RowBox[{
                RowBox[{"FileNameJoin", "[", 
                 RowBox[{"{", 
                  RowBox[{"dirimp", ",", 
                   
                   RowBox[{"\"\<DoubleDistr_\>\"", "<>", "LLPdirName", 
                    "<>", "\"\<_\>\"", "<>", "prod", "<>", "\"\<_\>\"", "<>", 
                    "FacilityGivenExperiment", "<>", "\"\<.m\>\""}]}], "}"}], 
                 "]"}], ",", "\"\<MX\>\""}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"Do", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{"prodbrem", "=", 
                 RowBox[{
                  RowBox[{"StringReplace", "[", 
                   RowBox[{"prod", ",", 
                    RowBox[{"\"\<-mixing\>\"", "->", "\"\<\>\""}]}], "]"}], 
                  "<>", "\"\<-\>\"", "<>", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"DistrDataImportTemp", "[", "prod", "]"}], "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "[", 
                   RowBox[{"[", "1", "]"}], "]"}], 
                  "<>", "\"\<-mixing\>\""}]}], ";", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"DistrDataImport", "[", "prodbrem", "]"}], "=", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"DistrDataImportTemp", "[", "prod", "]"}], "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "//", "N"}], "//", 
                  "Developer`ToPackedArray"}]}], ";", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"mlistDistr", "[", "prodbrem", "]"}], "=", 
                 RowBox[{"DeleteDuplicates", "[", 
                  RowBox[{
                   RowBox[{"DistrDataImport", "[", "prodbrem", "]"}], "[", 
                   RowBox[{"[", 
                    RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"mLLPmin", "[", "prodbrem", "]"}], ",", 
                   RowBox[{"mLLPmax", "[", "prodbrem", "]"}]}], "}"}], "=", 
                 RowBox[{"MinMax", "[", 
                  RowBox[{"mlistDistr", "[", "prodbrem", "]"}], "]"}]}], 
                ";"}], "\[IndentingNewLine]", ",", 
               RowBox[{"{", 
                RowBox[{"j", ",", "1", ",", 
                 RowBox[{"Length", "[", 
                  RowBox[{"DistrDataImportTemp", "[", "prod", "]"}], "]"}], ",",
                  "1"}], "}"}]}], "]"}], ";"}]}], "\[IndentingNewLine]", 
           "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
       "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "ProductionPatternSelectedDistr", "]"}], ",", 
         "1"}], "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"mlistDistr", "[", "prod", "]"}], "=", 
           RowBox[{"DeleteDuplicates", "[", 
            RowBox[{
             RowBox[{"DistrDataImport", "[", "prod", "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"mLLPmin", "[", "prod", "]"}], ",", 
             RowBox[{"mLLPmax", "[", "prod", "]"}]}], "}"}], "=", 
           RowBox[{"MinMax", "[", 
            RowBox[{"mlistDistr", "[", "prod", "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"DoubleDistrLLPint", "[", 
            RowBox[{"mLLP_", ",", "\[Theta]LLP_", ",", "ELLP_", ",", "prod"}],
             "]"}], "=", 
           RowBox[{"10", "^", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Interpolation", "[", 
               RowBox[{
                RowBox[{"distrlogComp", "[", 
                 RowBox[{"DistrDataImport", "[", "prod", "]"}], "]"}], ",", 
                RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[", 
              RowBox[{
               RowBox[{"Log10", "[", "mLLP", "]"}], ",", 
               RowBox[{"Log10", "[", "\[Theta]LLP", "]"}], ",", 
               RowBox[{"Log10", "[", "ELLP", "]"}]}], "]"}], ")"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"StringContainsQ", "[", 
             RowBox[{"prod", ",", "\"\<Bremsstrahlung\>\""}], "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"DoubleDistrLLPint", "[", 
              RowBox[{
              "mLLP_", ",", "\[Theta]LLP_", ",", "ELLP_", ",", "prod"}], 
              "]"}], "=", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"ELLP", "<=", 
                RowBox[{"ELLPmax", "[", 
                 RowBox[{"mLLP", ",", "\[Theta]LLP", ",", "prod"}], "]"}]}], ",", 
               RowBox[{"Evaluate", "[", 
                RowBox[{"DoubleDistrLLPint", "[", 
                 RowBox[{
                 "mLLP", ",", "\[Theta]LLP", ",", "ELLP", ",", "prod"}], 
                 "]"}], "]"}], ",", "0."}], "]"}]}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{"Probability", " ", "to", " ", "produce", " ", "LLP"}], 
           "*)"}], "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ProbLLP", "[", 
            RowBox[{
            "mLLP_", ",", "\[Theta]2_", ",", "BrhToSS_", ",", "prod"}], "]"}],
            "=", 
           RowBox[{
            RowBox[{
             RowBox[{"ProbMother", "[", "prod", "]"}], "*", 
             RowBox[{"PmotherToLLP", "[", 
              RowBox[{
              "mLLP", ",", "\[Theta]2", ",", "BrhToSS", ",", "prod", ",", 
               "FacilityGivenExperiment"}], "]"}]}], "/.", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Atarget", "->", "AtargetVal"}], ",", 
              RowBox[{"Yield\[Rho]0", "->", 
               RowBox[{"ProbMother", "[", "\"\<Rho0\>\"", "]"}]}]}], 
             "}"}]}]}], ";"}]}], "\[IndentingNewLine]", "]"}], 
       "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"prod", ",", "ProductionList"}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"GridInFinal", "[", "prod", "]"}], ",", 
          RowBox[{"DistrVals", "[", "prod", "]"}]}], "}"}], "=", 
        RowBox[{"BlockGridsValsDistr", "[", 
         RowBox[{"prod", ",", "DistrDataImport"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"prod", ",", "ProductionList"}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "___", "___", "___", "___", "___", "___", "___", "___", "___", "_"}], 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"Finding", " ", 
       SubscriptBox["E", "max"], 
       RowBox[{"(", 
        RowBox[{
         SubscriptBox["m", "LLP"], ",", 
         SubscriptBox["\[Theta]", "LLP"]}], ")"}], " ", "for", " ", "the", " ",
        "angular", " ", "range", " ", "at", " ", "the", " ", "given", " ", 
       "experiment"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "___", "___", "___", "___", "___", "___", "___", "___", "___", "_"}], 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"ELLPmax", "[", 
         RowBox[{"mfip_", ",", "\[Theta]fip_", ",", "prod"}], "]"}], "=", 
        RowBox[{"EmaxBlock", "[", 
         RowBox[{
         "prod", ",", "9", ",", "DistrDataImport", ",", 
          "FacilityGivenExperiment"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"prod", ",", 
         RowBox[{"Select", "[", 
          RowBox[{"ProductionList", ",", 
           RowBox[{
            RowBox[{"!", 
             RowBox[{"StringContainsQ", "[", 
              RowBox[{"#", ",", "\"\<Bremsstrahlung\>\""}], "]"}]}], "&"}]}], 
          "]"}]}], "}"}]}], "]"}]}]}], "\[IndentingNewLine]", "]"}], "//", 
  "AbsoluteTiming"}]], "Input",
 CellChangeTimes->{{3.9345976543374767`*^9, 3.9345976670885286`*^9}, {
  3.9345977132417974`*^9, 3.934597730804302*^9}, {3.9345989484618883`*^9, 
  3.934598948537887*^9}, {3.9423015442699547`*^9, 3.9423015480534344`*^9}, {
  3.9423231434287205`*^9, 3.9423232083727684`*^9}, {3.942481459534952*^9, 
  3.942481459702732*^9}, {3.950682364575201*^9, 3.9506824224958935`*^9}},
 CellTags->{
  "Acceptance-computation", "Number-of-events-computation+sensitivity"},
 CellLabel->
  "In[233]:=",ExpressionUUID->"285b34b1-2177-4110-966a-b403a2b3b0ec"],

Cell[CellGroupData[{

Cell["Exporting averaged distribution", "Subsection",
 CellChangeTimes->{{3.934180740253267*^9, 3.934180747742608*^9}, {
  3.9342184269992228`*^9, 3.934218430923875*^9}},
 CellTags->{
  "Acceptance-computation", 
   "Number-of-events-computation+sensitivity"},ExpressionUUID->"15f44617-c031-\
47b4-abc6-75b3ecf51e41"],

Cell[BoxData[
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{"condcontinue", ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"directory", "[", "\"\<Auxiliary-experiment\>\"", "]"}], "=", 
      RowBox[{"FileNameJoin", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"directory", "[", "\"\<Auxiliary\>\"", "]"}], ",", 
         "SelectedExperiment"}], "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"DirectoryQ", "[", 
         RowBox[{"directory", "[", "\"\<Auxiliary-experiment\>\"", "]"}], 
         "]"}]}], ",", 
       RowBox[{"CreateDirectory", "[", 
        RowBox[{"directory", "[", "\"\<Auxiliary-experiment\>\"", "]"}], 
        "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Export", "[", 
      RowBox[{
       RowBox[{"FileNameJoin", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"directory", "[", "\"\<Auxiliary-experiment\>\"", "]"}], ",", 
          
          RowBox[{"\"\<Double-Distr-Averaged-\>\"", "<>", "LLPdirName", 
           "<>", "\"\<.m\>\""}]}], "}"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"mLLPmin", "[", "prod", "]"}], "<", "mLLP", "<", 
              RowBox[{"mLLPmax", "[", "prod", "]"}]}], ",", 
             RowBox[{"Evaluate", "[", 
              RowBox[{"ProbLLP", "[", 
               RowBox[{"mLLP", ",", "1", ",", "0.01", ",", "prod"}], "]"}], 
              "]"}], ",", "0"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"prod", ",", "ProductionListBaseline"}], "}"}]}], "]"}], ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "/", 
            RowBox[{"Sum", "[", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"mLLPmin", "[", "prod", "]"}], "<", "mLLP", "<", 
                 RowBox[{"mLLPmax", "[", "prod", "]"}]}], ",", 
                RowBox[{"Evaluate", "[", 
                 RowBox[{"ProbLLP", "[", 
                  RowBox[{"mLLP", ",", "1", ",", "0.01", ",", "prod"}], "]"}],
                  "]"}], ",", "0"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"prod", ",", "ProductionListBaseline"}], "}"}]}], 
             "]"}]}], ")"}], 
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"mLLPmin", "[", "prod", "]"}], "<", "mLLP", "<", 
               RowBox[{"mLLPmax", "[", "prod", "]"}]}], ",", 
              RowBox[{"Evaluate", "[", 
               RowBox[{
                RowBox[{"ProbLLP", "[", 
                 RowBox[{"mLLP", ",", "1", ",", "0.01", ",", "prod"}], "]"}], 
                "*", 
                RowBox[{"DoubleDistrLLPint", "[", 
                 RowBox[{
                 "mLLP", ",", "\[Theta]LLP", ",", "ELLP", ",", "prod"}], 
                 "]"}]}], "]"}], ",", "0"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"prod", ",", "ProductionListBaseline"}], "}"}]}], 
           "]"}]}]}], "}"}], ",", "\"\<MX\>\""}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.9138264426995506`*^9, 3.9138265779867573`*^9}, {
   3.913826965658716*^9, 3.9138270942523136`*^9}, 3.913827173058236*^9, 
   3.9138280725351963`*^9, {3.9138685969328623`*^9, 3.9138686662515535`*^9}, {
   3.9138687097216063`*^9, 3.913868827467691*^9}, {3.9138699081836786`*^9, 
   3.913869908527342*^9}, {3.9138700197640233`*^9, 3.913870024259905*^9}, {
   3.913870742059718*^9, 3.913870786176013*^9}, {3.913871804452815*^9, 
   3.9138718044574027`*^9}, {3.9138882251043167`*^9, 
   3.9138882251093035`*^9}, {3.9140573961516905`*^9, 3.914057451010392*^9}, {
   3.9140667249964046`*^9, 3.9140667374592443`*^9}, {3.9140668849922748`*^9, 
   3.9140668860566907`*^9}, 3.915184627030238*^9, {3.9156430601988077`*^9, 
   3.9156430604241543`*^9}, 3.915727587776414*^9, {3.916672566533353*^9, 
   3.9166725686001234`*^9}, {3.9166726094945087`*^9, 
   3.9166726096747155`*^9}, {3.916679849894617*^9, 3.9166798503945646`*^9}, {
   3.9168533614169364`*^9, 3.916853382014995*^9}, {3.916853454789669*^9, 
   3.9168535530919013`*^9}, {3.91685422632805*^9, 3.9168542271898108`*^9}, 
   3.916856429758537*^9, 3.9168567750740905`*^9, {3.916994194511986*^9, 
   3.916994194639786*^9}, 3.928576878808322*^9, {3.9285769295898595`*^9, 
   3.928577135245227*^9}, {3.9304940756391134`*^9, 3.9304942536874704`*^9}, {
   3.930494292641827*^9, 3.9304943056256866`*^9}, {3.9304954383171363`*^9, 
   3.930495439377903*^9}, {3.9304954744111834`*^9, 3.9304955596511307`*^9}, {
   3.930495594730049*^9, 3.93049563725099*^9}, {3.9304956810266666`*^9, 
   3.930495682018281*^9}, {3.934177965824263*^9, 3.934178024335834*^9}, {
   3.9341780660321517`*^9, 3.934178109488278*^9}, {3.9341781687198305`*^9, 
   3.9341782811178565`*^9}, {3.934180632550871*^9, 3.934180632806182*^9}, {
   3.9341806890054445`*^9, 3.9341806931598024`*^9}, {3.934218259952458*^9, 
   3.93421826091879*^9}, {3.934218296442099*^9, 3.9342183541896987`*^9}, {
   3.93421840615699*^9, 3.9342184371250544`*^9}, {3.9345977921028385`*^9, 
   3.9345977974669065`*^9}, 3.934597831655055*^9, {3.9345983449714727`*^9, 
   3.934598345988593*^9}, {3.942301295847742*^9, 3.942301297848036*^9}, {
   3.9423014615527115`*^9, 3.94230146207452*^9}, {3.950682444210518*^9, 
   3.950682447018732*^9}},
 CellTags->{
  "Acceptance-computation", "Number-of-events-computation+sensitivity"},
 CellLabel->
  "In[234]:=",ExpressionUUID->"6c22c64a-fc6b-4872-bbf2-05d39e849f59"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Plots", "Section",
 CellChangeTimes->{{3.9341806241273217`*^9, 3.9341806246845126`*^9}},
 CellTags->{
  "Number-of-events-computation+sensitivity", 
   "Acceptance-computation"},ExpressionUUID->"171422bd-bdb8-498b-8821-\
1a3e5edcdb2a"],

Cell[BoxData[
 RowBox[{"If", "[", 
  RowBox[{"condcontinue", ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ptenergies", "=", 
     RowBox[{"LogLogPlot", "[", 
      RowBox[{
       RowBox[{"Evaluate", "[", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"ELLPmax", "[", 
           RowBox[{"0.1", ",", "\[Theta]LLP", ",", "prod"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"prod", ",", "ProductionListBaseline"}], "}"}]}], "]"}], 
        "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Theta]LLP", ",", "\[Theta]minExp", ",", "\[Theta]maxExp"}],
         "}"}], ",", 
       RowBox[{"Frame", "->", "True"}], ",", 
       RowBox[{"ImageSize", "->", "Large"}], ",", 
       RowBox[{"PlotLegends", "\[Rule]", 
        RowBox[{"Placed", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Style", "[", 
             RowBox[{"#", ",", "15"}], "]"}], "&"}], "/@", 
           "ProductionListBaseline"}], ",", "Right"}], "]"}]}]}], "]"}]}], ";",
     "\[IndentingNewLine]", 
    RowBox[{"\[Theta]2val", "=", 
     SuperscriptBox["10", 
      RowBox[{"-", "10"}]]}], ";", "\[IndentingNewLine]", 
    RowBox[{"BrhToSSval", "=", "0.01"}], ";", "\[IndentingNewLine]", 
    RowBox[{"colors", "=", 
     RowBox[{"{", 
      RowBox[{"Blue", ",", 
       RowBox[{"Darker", "@", "Red"}], ",", 
       RowBox[{"Darker", "@", 
        RowBox[{"Darker", "@", "Green"}]}], ",", 
       RowBox[{"Darker", "@", "Cyan"}], ",", "Magenta", ",", "Brown", ",", 
       "Yellow", ",", 
       RowBox[{"Lighter", "@", "Cyan"}]}], "}"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"ptprodprob", "=", 
     RowBox[{"LogLogPlot", "[", 
      RowBox[{
       RowBox[{"Evaluate", "[", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"ProbLLP", "[", 
           RowBox[{
           "ma", ",", "\[Theta]2val", ",", "BrhToSSval", ",", "prod"}], "]"}],
           ",", 
          RowBox[{"{", 
           RowBox[{"prod", ",", "ProductionListBaseline"}], "}"}]}], "]"}], 
        "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"ma", ",", "mmin\[Epsilon]", ",", "mmax\[Epsilon]"}], "}"}], ",", 
       RowBox[{"Frame", "->", "True"}], ",", 
       RowBox[{"ImageSize", "->", "Large"}], ",", 
       RowBox[{"PlotLegends", "\[Rule]", 
        RowBox[{"Placed", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Style", "[", 
             RowBox[{"#", ",", "16"}], "]"}], "&"}], "/@", 
           RowBox[{"(", 
            RowBox[{"ProductionListBaseline", "/.", 
             RowBox[{"{", 
              RowBox[{"BremSelected", "->", "\"\<Bremsstrahlung\>\""}], 
              "}"}]}], ")"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"0.18", ",", "0.2"}], "}"}]}], "]"}]}], ",", " ", 
       RowBox[{"FrameStyle", "\[Rule]", 
        RowBox[{"Directive", "[", 
         RowBox[{"Black", ",", " ", "25", ",", "Thick"}], "]"}]}], ",", 
       RowBox[{"PlotRange", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0.02", ",", "3"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            SuperscriptBox["10", 
             RowBox[{"-", "22"}]], ",", 
            SuperscriptBox["10", 
             RowBox[{"-", "11"}]]}], "}"}]}], "}"}]}], ",", 
       RowBox[{"PlotStyle", "\[Rule]", 
        RowBox[{"Evaluate", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"Thick", ",", "#"}], "}"}], "&"}], "/@", "colors"}], 
         "]"}]}], ",", 
       RowBox[{"AspectRatio", "\[Rule]", "0.66"}], ",", 
       RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
       RowBox[{"FrameLabel", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"\"\<\!\(\*SubscriptBox[\(m\), \(LLP\)]\) [GeV]\>\"", 
          ",", "\"\<\!\(\*SubscriptBox[\(P\), \(prod\)]\)\>\""}], "}"}]}], ",", 
       RowBox[{"PlotLabel", "\[Rule]", 
        RowBox[{"Style", "[", 
         RowBox[{
          RowBox[{"Row", "[", 
           RowBox[{"{", 
            RowBox[{
            "FacilityGivenExperiment", 
             ",", "\"\<. \!\(\*SuperscriptBox[\(\[Theta]\), \(2\)]\) = \>\"", 
             ",", 
             RowBox[{"N", "[", "\[Theta]2val", "]"}], 
             ",", "\"\<, \!\(\*SubscriptBox[\(Br\), \(h \[Rule] SS\)]\) = \
\>\"", ",", 
             RowBox[{"BrhToSSval", "//", "N"}]}], "}"}], "]"}], ",", "18", ",",
           "Black"}], "]"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"BremVariantsGivenFacility", "!=", 
       RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"position", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"Position", "[", 
           RowBox[{"ProductionListBaseline", ",", 
            RowBox[{
             RowBox[{"Select", "[", 
              RowBox[{"ProductionListBaseline", ",", 
               RowBox[{
                RowBox[{"StringContainsQ", "[", 
                 RowBox[{"#", ",", "\"\<Bremsstrahlung\>\""}], "]"}], "&"}]}],
               "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"colorbrem", "=", 
        RowBox[{"colors", "[", 
         RowBox[{"[", "position", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"ptprodprobbrem", "=", 
        RowBox[{"LogLogPlot", "[", 
         RowBox[{
          RowBox[{"Evaluate", "[", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"ProbLLP", "[", 
              RowBox[{
              "ma", ",", "\[Theta]2val", ",", "BrhToSSval", ",", "prod"}], 
              "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"prod", ",", "BremVariantsGivenFacility"}], "}"}]}], 
            "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"ma", ",", "mmin\[Epsilon]", ",", "mmax\[Epsilon]"}], 
           "}"}], ",", 
          RowBox[{"Frame", "->", "True"}], ",", 
          RowBox[{"ImageSize", "->", "Large"}], 
          RowBox[{"(*", 
           RowBox[{",", 
            RowBox[{"PlotLegends", "\[Rule]", 
             RowBox[{"Placed", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"Style", "[", 
                  RowBox[{"#", ",", "16"}], "]"}], "&"}], "/@", 
                "BremVariantsGivenFacility"}], ",", "Right"}], "]"}]}]}], 
           "*)"}], ",", " ", 
          RowBox[{"FrameStyle", "\[Rule]", 
           RowBox[{"Directive", "[", 
            RowBox[{"Black", ",", " ", "25"}], "]"}]}], ",", 
          RowBox[{"PlotRange", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0.02", ",", "3"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               SuperscriptBox["10", 
                RowBox[{"-", "22"}]], ",", 
               SuperscriptBox["10", 
                RowBox[{"-", "11"}]]}], "}"}]}], "}"}]}], ",", 
          RowBox[{"PlotStyle", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"Thick", ",", "colorbrem"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"Thick", ",", "colorbrem", ",", 
               RowBox[{"Opacity", "[", "0.", "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"Thick", ",", "colorbrem", ",", 
               RowBox[{"Opacity", "[", "0.", "]"}]}], "}"}]}], "}"}]}], ",", 
          RowBox[{"Filling", "->", 
           RowBox[{"{", 
            RowBox[{"2", "->", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", "3", "}"}], ",", 
               RowBox[{"Directive", "[", 
                RowBox[{"Blue", ",", 
                 RowBox[{"Opacity", "[", "0.1", "]"}]}], "]"}]}], "}"}]}], 
            "}"}]}], ",", 
          RowBox[{"AspectRatio", "\[Rule]", "0.66"}], ",", 
          RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
          RowBox[{"FrameLabel", "\[Rule]", 
           RowBox[{"{", 
            
            RowBox[{"\"\<\!\(\*SubscriptBox[\(m\), \(LLP\)]\) [GeV]\>\"", 
             ",", "\"\<\!\(\*SubscriptBox[\(P\), \(prod\)]\)\>\""}], "}"}]}], 
          ",", 
          RowBox[{"PlotLabel", "\[Rule]", 
           RowBox[{"Style", "[", 
            RowBox[{
             RowBox[{"Row", "[", 
              RowBox[{"{", 
               
               RowBox[{"\"\<Production probabilities of \>\"", ",", 
                "LLPdirName", ",", "\"\< at \>\"", ",", 
                "SelectedExperiment"}], "}"}], "]"}], ",", "18", ",", 
             "Black"}], "]"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"ptprodprob", "=", 
        RowBox[{"Show", "[", 
         RowBox[{"ptprodprob", ",", "ptprodprobbrem"}], "]"}]}], ";"}]}], 
     "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"Style", "[", 
     RowBox[{
      RowBox[{"Row", "[", 
       RowBox[{"{", 
        RowBox[{"ptprodprob", ",", "ptenergies"}], "}"}], "]"}], ",", 
      RowBox[{"ImageSizeMultipliers", "->", 
       RowBox[{"{", 
        RowBox[{"1", ",", " ", "1", ",", "1"}], "}"}]}]}], "]"}]}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.934218518515441*^9, 3.934218537902442*^9}, 
   3.9342185941166706`*^9, {3.9342186376090508`*^9, 3.9342186376374598`*^9}, {
   3.93421938331448*^9, 3.9342193923497753`*^9}, {3.9345978316637716`*^9, 
   3.9345978316706643`*^9}, {3.9345986516334677`*^9, 3.934598789752295*^9}, {
   3.935830309996741*^9, 3.9358303551879787`*^9}, {3.94931129250898*^9, 
   3.949311360182026*^9}, 3.9506742273348217`*^9, {3.95068245121278*^9, 
   3.9506824568988895`*^9}, {3.9507828070843925`*^9, 3.950782855785095*^9}, {
   3.950783121625166*^9, 3.9507831308646564`*^9}, {3.9507831816262665`*^9, 
   3.9507832799944286`*^9}, {3.950783342513176*^9, 3.9507835501153545`*^9}, {
   3.951151995122635*^9, 3.9511520019315224`*^9}},
 CellTags->{
  "Number-of-events-computation+sensitivity", "Acceptance-computation"},
 CellLabel->
  "In[235]:=",ExpressionUUID->"c282a484-22c9-4a44-a872-4eb893dc3695"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"ptprodprob", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"pr", "=", 
       RowBox[{"Select", "[", 
        RowBox[{"ProductionListBaseline", ",", 
         RowBox[{
          RowBox[{"!", 
           RowBox[{"StringContainsQ", "[", 
            RowBox[{"#", ",", 
             RowBox[{"{", 
              RowBox[{"\"\<Bremsstrahlung\>\"", ",", "\"\<K-mixing\>\""}], 
              "}"}]}], "]"}]}], "&"}]}], "]"}]}], "}"}], ",", 
     RowBox[{"LogLogPlot", "[", 
      RowBox[{
       RowBox[{"Evaluate", "[", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"ProbLLP", "[", 
           RowBox[{
           "ma", ",", "\[Theta]2val", ",", "BrhToSSval", ",", "prod"}], "]"}],
           ",", 
          RowBox[{"{", 
           RowBox[{"prod", ",", "pr"}], "}"}]}], "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"ma", ",", "0.22", ",", "10"}], "}"}], ",", 
       RowBox[{"Frame", "->", "True"}], ",", 
       RowBox[{"ImageSize", "->", "Large"}], ",", 
       RowBox[{"PlotLegends", "\[Rule]", 
        RowBox[{"Placed", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Style", "[", 
             RowBox[{"#", ",", "16"}], "]"}], "&"}], "/@", 
           RowBox[{"(", 
            RowBox[{"pr", "/.", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"\"\<B-mixing\>\"", "->", "\"\<B\[Rule]S+X\>\""}], ",", 
               RowBox[{"\"\<B-quartic\>\"", "->", "\"\<B\[Rule]SS+X\>\""}], ",", 
               
               RowBox[{"\"\<Bs-quartic\>\"", 
                "->", "\"\<\!\(\*SubscriptBox[\(B\), \(s\)]\)\[Rule]SS\>\""}],
                ",", 
               RowBox[{"\"\<h-quartic\>\"", "->", "\"\<h\[Rule]SS\>\""}]}], 
              "}"}]}], ")"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"0.14", ",", "0.16"}], "}"}]}], "]"}]}], ",", 
       RowBox[{"PlotPoints", "->", "100"}], ",", " ", 
       RowBox[{"FrameStyle", "\[Rule]", 
        RowBox[{"Directive", "[", 
         RowBox[{"Black", ",", " ", "25", ",", "Thick"}], "]"}]}], ",", 
       RowBox[{"PlotRange", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0.22", ",", "10"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            SuperscriptBox["10", 
             RowBox[{"-", "19"}]], ",", 
            SuperscriptBox["10", 
             RowBox[{"-", "15"}]]}], "}"}]}], "}"}]}], ",", 
       RowBox[{"PlotStyle", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"Thick", ",", "Blue"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"Thick", ",", 
            RowBox[{"Darker", "@", "Red"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"Thick", ",", 
            RowBox[{"Darker", "@", 
             RowBox[{"Darker", "@", "Green"}]}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"Thick", ",", 
            RowBox[{"Darker", "@", "Cyan"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"Thick", ",", "Magenta"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"Thick", ",", "Brown"}], "}"}]}], "}"}]}], ",", 
       RowBox[{"AspectRatio", "\[Rule]", "0.66"}], ",", 
       RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
       RowBox[{"FrameLabel", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"\"\<\!\(\*SubscriptBox[\(m\), \(LLP\)]\) [GeV]\>\"", 
          ",", "\"\<\!\(\*SubscriptBox[\(P\), \(prod\)]\)\>\""}], "}"}]}], ",", 
       RowBox[{"PlotLabel", "\[Rule]", 
        RowBox[{"Style", "[", 
         RowBox[{
          RowBox[{"Row", "[", 
           RowBox[{"{", 
            RowBox[{
            "FacilityGivenExperiment", 
             ",", "\"\<. \!\(\*SuperscriptBox[\(\[Theta]\), \(2\)]\) = \>\"", 
             ",", 
             RowBox[{"N", "[", "\[Theta]2val", "]"}], 
             
             ",", "\"\<, \!\(\*SubscriptBox[\(Br\), \(h \[Rule] SS\)]\) = \
\>\"", ",", 
             RowBox[{"BrhToSSval", "//", "N"}]}], "}"}], "]"}], ",", "20", ",",
           "Black"}], "]"}]}]}], "]"}]}], "]"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.9493111449528446`*^9, 3.9493112772415752`*^9}, {
  3.9493113823406773`*^9, 3.949311484195101*^9}, {3.949311547243332*^9, 
  3.949311588725916*^9}, {3.949311643988411*^9, 3.9493116440753975`*^9}, {
  3.949311934794052*^9, 3.9493119392598476`*^9}, {3.9506824753155346`*^9, 
  3.950682482022684*^9}},
 CellTags->{
  "Acceptance-computation", "Number-of-events-computation+sensitivity"},
 CellLabel->
  "In[236]:=",ExpressionUUID->"f2500828-5ccf-1a42-adc3-e79cba87c0ce"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Number of events", "Chapter",
 CellChangeTimes->{{3.8935731783578434`*^9, 3.893573180246764*^9}},
 CellTags->
  "Number-of-events-computation+sensitivity",ExpressionUUID->"2d9780fa-5ba1-\
4c6e-a530-4a9fc49461e6"],

Cell[CellGroupData[{

Cell["Number of events ", "Section",
 CellChangeTimes->{{3.897198873663946*^9, 3.8971988750678434`*^9}, 
   3.9165065585390453`*^9, 3.9165070655729046`*^9, 3.9166798862174683`*^9},
 CellTags->{
  "Acceptance-computation", 
   "Number-of-events-computation+sensitivity"},ExpressionUUID->"c209228b-48aa-\
40d8-8345-52697a87e834"],

Cell[CellGroupData[{

Cell["Initializing all routines", "Subsection",
 CellChangeTimes->{{3.897199076623907*^9, 3.8971990900052223`*^9}, {
   3.8972009084104066`*^9, 3.897200920680235*^9}, 3.916506561920749*^9, {
   3.9165071319109154`*^9, 3.916507136145134*^9}},
 CellTags->{
  "Acceptance-computation", 
   "Number-of-events-computation+sensitivity"},ExpressionUUID->"220522e0-7bc3-\
47cb-a718-f2f23b53197f"],

Cell[BoxData[
 RowBox[{"If", "[", 
  RowBox[{"condcontinue", ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"OutGrid\[Theta]final", "[", "prod", "]"}], ",", 
         RowBox[{"\[CapitalDelta]\[Theta]vals", "[", "prod", "]"}]}], "}"}], "=", 
       RowBox[{"OutGrid\[Theta]Temp", "[", 
        RowBox[{"InGrid\[Theta]\[Epsilon]", ",", "30", ",", "prod", ",", 
         RowBox[{"\[Theta]maxBrem", "[", "prod", "]"}]}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"prod", ",", "ProductionList"}], "}"}]}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"OutGridzfinal", ",", "\[CapitalDelta]zvals"}], "}"}], "=", 
     RowBox[{"OutGridszTemp", "[", 
      RowBox[{"InGridz\[Epsilon]", ",", "30", ",", "zminExp"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"Final", " ", "energy", " ", 
       RowBox[{"grid", ".", " ", "Mass"}]}], "-", " ", 
      RowBox[{"and", " ", "production", " ", "channel"}], "-", "dependent"}], 
     "*)"}], "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"FacilityGivenExperiment", "!=", "\"\<ESS\>\""}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"StepEtemp", "[", "Efip_", "]"}], "=", 
        RowBox[{"Piecewise", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0.3", ",", 
             RowBox[{"Efip", "\[LessEqual]", "2.5"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0.5", ",", 
             RowBox[{"2.5", "<", "Efip", "<", "35"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"2", ",", 
             RowBox[{"35", "\[LessEqual]", "Efip", "\[LessEqual]", "50"}]}], 
            "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"4", ",", 
             RowBox[{"50", "<", "Efip", "<", "160"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"5", ",", 
             RowBox[{"160", "\[LessEqual]", "Efip", "<=", "400"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"25", ",", 
             RowBox[{"400", "<", "Efip", "<", "600"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"50", ",", 
             RowBox[{"600", "<=", "Efip", "<", "2000"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"200", ",", 
             RowBox[{"2000", "\[LessEqual]", "Efip", "<", "4000"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"400", ",", 
             RowBox[{"4000", "\[LessEqual]", "Efip", "<", "7000"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"500", ",", 
             RowBox[{
             "7000", "\[LessEqual]", "Efip", "\[LessEqual]", "50000"}]}], 
            "}"}]}], "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"OutGridEnergy", "[", 
         RowBox[{"m_", ",", "ProdChannel_"}], "]"}], ":=", 
        RowBox[{"Block", "[", 
         RowBox[{
          RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"emin", "=", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"StringContainsQ", "[", 
                RowBox[{"ProdChannel", ",", "\"\<Bremsstrahlung\>\""}], 
                "]"}]}], ",", 
              RowBox[{"N", "[", "m", "]"}], ",", 
              RowBox[{"ELLPmin", "[", "ProdChannel", "]"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"egridtemp", "=", 
            RowBox[{
             RowBox[{"With", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"start", "=", "emin"}], ",", 
                 RowBox[{"end", "=", 
                  RowBox[{"Max", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"ELLPmax", "[", 
                    RowBox[{"m", ",", "#", ",", "ProdChannel"}], "]"}], "&"}],
                     "/@", 
                    RowBox[{"(", 
                    RowBox[{"10", "^", 
                    RowBox[{"(", 
                    RowBox[{"OutGrid\[Theta]final", "[", "ProdChannel", "]"}],
                     ")"}]}], ")"}]}], "]"}]}]}], "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Log10", "[", 
                RowBox[{"NestWhileList", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"#", "+", 
                    RowBox[{"StepEtemp", "[", "#", "]"}]}], "&"}], ",", 
                  "start", ",", 
                  RowBox[{
                   RowBox[{"#", "\[LessEqual]", "end"}], "&"}], ",", "1", ",",
                   "\[Infinity]", ",", 
                  RowBox[{"-", "1"}]}], "]"}], "]"}]}], "]"}], "//", "N"}]}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Length", "[", "egridtemp", "]"}], "==", "1"}], ",", 
             RowBox[{"egridtemp", "=", 
              RowBox[{"Join", "[", 
               RowBox[{"egridtemp", ",", 
                RowBox[{"{", 
                 RowBox[{"Log10", "[", 
                  RowBox[{"2", "*", "emin"}], "]"}], "}"}]}], "]"}]}]}], 
            "]"}], ";", "\[IndentingNewLine]", "egridtemp"}]}], 
         "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"StepEtemp", "[", "Efip_", "]"}], "=", "0.001"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"OutGridEnergy", "[", 
         RowBox[{"m_", ",", "ProdChannel_"}], "]"}], ":=", 
        RowBox[{"Block", "[", 
         RowBox[{
          RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"tabt", "=", 
            RowBox[{"Table", "[", 
             RowBox[{"e", ",", 
              RowBox[{"{", 
               RowBox[{"e", ",", 
                RowBox[{"1.0001", "m"}], ",", 
                RowBox[{"ELLPmax", "[", 
                 RowBox[{"m", ",", "\[Theta]minExp", ",", "ProdChannel"}], 
                 "]"}], ",", "0.001"}], "}"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Length", "[", "tabt", "]"}], "==", "1"}], ",", 
             RowBox[{"tabt", "=", 
              RowBox[{
               RowBox[{
                RowBox[{"Join", "[", 
                 RowBox[{"tabt", ",", 
                  RowBox[{"{", 
                   RowBox[{"ELLPmax", "[", 
                    RowBox[{"m", ",", "\[Theta]minExp", ",", "ProdChannel"}], 
                    "]"}], "}"}]}], "]"}], "//", "Sort"}], "//", 
               "DeleteDuplicates"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Log10", "[", "tabt", "]"}], "//", "N"}]}]}], 
         "\[IndentingNewLine]", "]"}]}]}]}], "\[IndentingNewLine]", "]"}], ";",
     "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
     "___", "___", "___", "___", "___", "___", "___", "___", "___", "___", 
      "___", "___", "___", "___", "___", "___", "___", "_"}], "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{
      "Block", " ", "that", " ", "computes", " ", "the", " ", "grid", " ", 
       SubscriptBox["\[Theta]", "S"]}], ",", 
      SubscriptBox["E", "S"], ",", 
      SubscriptBox["z", "S"], ",", " ", 
      RowBox[{
       SubscriptBox["\[Epsilon]", "Full"], "\[Times]", 
       SubscriptBox["f", 
        RowBox[{
         SubscriptBox["\[Theta]", "S"], ",", 
         SubscriptBox["E", "S"]}]]}]}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
     "___", "___", "___", "___", "___", "___", "___", "___", "___", "___", 
      "___", "___", "___", "___", "___", "___", "___", "_"}], "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{
       RowBox[{
       "The", " ", "block", " ", "which", " ", "sets", " ", "all", " ", "the",
         " ", "values", " ", "of", " ", 
        SubscriptBox["\[Epsilon]", "Full"], "\[Times]", 
        SubscriptBox["f", 
         RowBox[{"\[Theta]", ",", "E"}]], " ", "for", " ", "which", " ", 
        "E"}], " ", "<", " ", 
       RowBox[{
        SubscriptBox["E", "max"], " ", "to", " ", "zero"}]}], ",", " ", 
      RowBox[{"for", " ", "Bremsstrahlung"}]}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"createCompiledFunctionBrem", "[", "BremChoice_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "func", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"func", "[", 
          RowBox[{"mfip_", ",", "th_"}], "]"}], "=", 
         RowBox[{"ELLPmax", "[", 
          RowBox[{"mfip", ",", "th", ",", "BremChoice"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"Hold", "@", 
           RowBox[{"Compile", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"angleenergy", ",", "_Real", ",", "1"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"mfip", ",", "_Real"}], "}"}]}], "}"}], ",", 
             RowBox[{"Module", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                "angles", ",", "energies", ",", "distrvals", ",", "d"}], 
                "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"angles", "=", 
                 RowBox[{"Compile`GetElement", "[", 
                  RowBox[{"angleenergy", ",", "1"}], "]"}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"energies", "=", 
                 RowBox[{"Compile`GetElement", "[", 
                  RowBox[{"angleenergy", ",", "2"}], "]"}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"distrvals", "=", 
                 RowBox[{"Compile`GetElement", "[", 
                  RowBox[{"angleenergy", ",", "3"}], "]"}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"d", "=", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"energies", "<", 
                    RowBox[{"func", "[", 
                    RowBox[{"mfip", ",", "angles"}], "]"}]}], ",", 
                   "distrvals", ",", 
                   RowBox[{"10", "^", 
                    RowBox[{"-", "90."}]}]}], "]"}]}], ";", 
                "\[IndentingNewLine]", "d"}]}], "]"}], ",", 
             RowBox[{"CompilationTarget", "->", "\"\<C\>\""}], ",", 
             RowBox[{"RuntimeOptions", "->", "\"\<Speed\>\""}], ",", 
             RowBox[{"RuntimeAttributes", "->", 
              RowBox[{"{", "Listable", "}"}]}], ",", 
             RowBox[{"Parallelization", "->", "True"}]}], "]"}]}], "/.", " ", 
          RowBox[{"DownValues", "@", "func"}]}], "//", "ReleaseHold"}]}]}], 
      "\[IndentingNewLine]", "]"}]}], ";", "\n", 
    RowBox[{"(*", 
     RowBox[{
     "Generate", " ", "a", " ", "dictionary", " ", "of", " ", "compiled", " ",
       "functions", " ", "for", " ", "each", " ", "variant"}], "*)"}], 
    RowBox[{"compiledBremCutter", "=", 
     RowBox[{"AssociationThread", "[", 
      RowBox[{"BremVariantsGivenFacility", ",", 
       RowBox[{
       "createCompiledFunctionBrem", "/@", "BremVariantsGivenFacility"}]}], 
      "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"BremCut", "[", 
      RowBox[{
      "OutGrid\[Theta]final_", ",", "OutGridEfinal_", ",", "distr_", ",", 
       "mLLP_", ",", "bremChoice_"}], "]"}], ":=", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"angleenergy", "=", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"10", "^", 
            RowBox[{"Tuples", "[", 
             RowBox[{"{", 
              RowBox[{"OutGrid\[Theta]final", ",", "OutGridEfinal"}], "}"}], 
             "]"}]}], ",", 
           RowBox[{"Partition", "[", 
            RowBox[{"distr", ",", "1"}], "]"}], ",", "2"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"compiledFunc", "=", 
         RowBox[{"compiledBremCutter", "[", "bremChoice", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"compiledFunc", "[", 
         RowBox[{"angleenergy", ",", "mLLP"}], "]"}]}]}], 
      "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"TableIntegrandDiscret", "[", 
      RowBox[{"m_", ",", "ProdChannel_", ",", "\[Epsilon]DecOp_"}], "]"}], ":=", 
     RowBox[{"TableIntegrandDiscretTemp", "[", 
      RowBox[{
      "m", ",", "ProdChannel", ",", "\[Epsilon]DecOp", ",", "\[Epsilon]vals", 
       ",", "\[Epsilon]azvals", ",", 
       RowBox[{"OutGrid\[Theta]final", "[", "ProdChannel", "]"}], ",", 
       "OutGridzfinal", ",", "OutGridEnergy", ",", "InGridm\[Epsilon]", ",", 
       "InGrid\[Theta]\[Epsilon]", ",", "InGridE\[Epsilon]", ",", 
       "InGridz\[Epsilon]", ",", 
       RowBox[{"\[CapitalDelta]\[Theta]vals", "[", "ProdChannel", "]"}], ",", 
       "\[CapitalDelta]zvals", ",", "zminExp", ",", "GridInFinal", ",", 
       "DistrVals", ",", "FacilityGivenExperiment", ",", "ELLPmax", ",", 
       "\[Theta]minExp"}], "]"}]}]}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{
  3.914065400601883*^9, {3.9144955915086913`*^9, 3.914495605102999*^9}, {
   3.9144963994464297`*^9, 3.91449645003281*^9}, 3.9156429961809263`*^9, 
   3.9162514062581673`*^9, {3.916332203281742*^9, 3.9163322040420866`*^9}, {
   3.916332256159724*^9, 3.916332315776701*^9}, {3.916332682855117*^9, 
   3.9163326972784367`*^9}, {3.916332729581109*^9, 3.9163327827424307`*^9}, {
   3.916332995032469*^9, 3.9163330418518543`*^9}, {3.9163330893535175`*^9, 
   3.9163331201157775`*^9}, {3.9163883031455355`*^9, 
   3.9163883099402237`*^9}, {3.91639027241718*^9, 3.9163902725145645`*^9}, {
   3.916390440036625*^9, 3.9163904429286966`*^9}, {3.9163913725242844`*^9, 
   3.9163913900649643`*^9}, {3.9165060112532883`*^9, 
   3.9165060531405983`*^9}, {3.916506386454261*^9, 3.9165063916867723`*^9}, {
   3.9165064378147545`*^9, 3.9165064402046285`*^9}, {3.9165066063487997`*^9, 
   3.9165066068133373`*^9}, {3.916506770781*^9, 3.916506770986845*^9}, {
   3.916506818360832*^9, 3.9165068344941483`*^9}, {3.91650702210918*^9, 
   3.916507055596775*^9}, 3.9165070945532026`*^9, {3.9165072348013864`*^9, 
   3.916507258828418*^9}, {3.9165082243803825`*^9, 3.9165082246202836`*^9}, {
   3.9165089341902933`*^9, 3.9165089344447165`*^9}, {3.916671056709384*^9, 
   3.9166710572925243`*^9}, {3.916671102174552*^9, 3.9166711025636616`*^9}, 
   3.9166802198658752`*^9, {3.916680488065048*^9, 3.916680488274705*^9}, {
   3.9166807390344872`*^9, 3.9166807462283087`*^9}, 3.9168552498594556`*^9, 
   3.9168553848489494`*^9, {3.9168554889311547`*^9, 3.9168554910933056`*^9}, {
   3.9181398187046614`*^9, 3.9181398267851543`*^9}, {3.9181442516674995`*^9, 
   3.9181442532188225`*^9}, {3.9325312303632307`*^9, 3.9325312303632307`*^9}, 
   3.934598988026492*^9, {3.9345990764884076`*^9, 3.934599080262788*^9}, 
   3.934703066366703*^9, 3.9347394342463465`*^9, {3.9424812862580853`*^9, 
   3.9424813175993977`*^9}, {3.942481349088835*^9, 3.9424813522998276`*^9}, {
   3.942481398233883*^9, 3.9424813999712925`*^9}, {3.9506824861594524`*^9, 
   3.9506825049038887`*^9}},
 CellTags->{
  "Acceptance-computation", "Number-of-events-computation+sensitivity"},
 CellLabel->
  "In[237]:=",ExpressionUUID->"6b8c7152-6b57-4c59-b874-11f86dd942cc"]
}, Closed]],

Cell[CellGroupData[{

Cell["Generalized acceptances", "Subsection",
 CellChangeTimes->{{3.9165071505021195`*^9, 3.9165071536920986`*^9}},
 CellTags->{
  "Acceptance-computation", 
   "Number-of-events-computation+sensitivity"},ExpressionUUID->"4114198c-dd3f-\
4aad-8e3b-bc66975eb5b1"],

Cell[CellGroupData[{

Cell["Definitions", "Subsubsection",
 CellChangeTimes->{{3.9506826168627033`*^9, 3.950682618169016*^9}},
 CellTags->{
  "Acceptance-computation", 
   "Number-of-events-computation+sensitivity"},ExpressionUUID->"18da6244-b5b1-\
b14e-ad9c-183b6a120e5f"],

Cell[BoxData[
 RowBox[{"If", "[", 
  RowBox[{"condcontinue", ",", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Tabulated", " ", "acceptance"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"FactorANUBISceiling", "=", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"SelectedExperiment", "==", "\"\<ANUBIS-ceiling\>\""}], ",", 
       "2", ",", "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"AcceptanceDiscret", "[", 
      RowBox[{
      "m_", ",", "ProdChannel_", ",", "\[Epsilon]decOp_", ",", "decProb_"}], 
      "]"}], ":=", 
     RowBox[{"AcceptanceDiscretTemp", "[", 
      RowBox[{
      "m", ",", "ProdChannel", ",", "\[Epsilon]decOp", ",", "decProb", ",", 
       "mLLPmin", ",", "mmin\[Epsilon]", ",", "mLLPmax", ",", 
       "mmax\[Epsilon]", ",", "ELLPmax", ",", "\[Theta]minExp", ",", 
       "TableIntegrandDiscret", ",", "BrVis", ",", "zmaxExp", ",", "zminExp", 
       ",", "FactorANUBISceiling", ",", "0."}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"Do", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"mlistAcceptance", "[", "prod", "]"}], "=", 
        RowBox[{
         RowBox[{
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"Join", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"1.01", 
                RowBox[{"Max", "[", 
                 RowBox[{
                  RowBox[{"mLLPmin", "[", "prod", "]"}], ",", 
                  "mmin\[Epsilon]"}], "]"}]}], "}"}], ",", 
              RowBox[{"10", "^", "InGridm\[Epsilon]"}], ",", 
              RowBox[{"{", 
               RowBox[{"Min", "[", 
                RowBox[{
                 RowBox[{"mLLPmax", "[", "prod", "]"}], ",", 
                 "mmax\[Epsilon]"}], "]"}], "}"}]}], "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"mLLPmin", "[", "prod", "]"}], "<=", "#", "<=", 
              RowBox[{"mLLPmax", "[", "prod", "]"}]}], "&"}]}], "]"}], "//", 
          "Sort"}], "//", "DeleteDuplicates"}]}], ";"}], 
      "\[IndentingNewLine]", ",", 
      RowBox[{"{", 
       RowBox[{"prod", ",", "ProductionList"}], "}"}]}], "]"}], ";"}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.9506826303890743`*^9, 3.950682630595314*^9}},
 CellTags->{
  "Acceptance-computation", "Number-of-events-computation+sensitivity"},
 CellLabel->
  "In[238]:=",ExpressionUUID->"9a3fc0b9-9a93-2a4c-a187-ffa50267a3d8"]
}, Closed]],

Cell[CellGroupData[{

Cell["Calculating acceptances", "Subsubsection",
 CellChangeTimes->{{3.9506826168627033`*^9, 3.9506826255382137`*^9}},
 CellTags->{
  "Acceptance-computation", 
   "Number-of-events-computation+sensitivity"},ExpressionUUID->"b10303aa-8637-\
bb48-8b49-de6e8c95bb15"],

Cell[BoxData[
 RowBox[{"If", "[", 
  RowBox[{"condcontinue", ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ResourceFunction", "[", "\"\<MonitorProgress\>\"", "]"}], "@", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"\[Epsilon]GeomTabs", "[", "prod", "]"}], "=", 
         RowBox[{"ParallelTable", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"m", ",", 
             RowBox[{"AcceptanceDiscret", "[", 
              RowBox[{"m", ",", "prod", ",", "\"\<False\>\"", ",", "0"}], 
              "]"}], ",", 
             RowBox[{"AcceptanceDiscret", "[", 
              RowBox[{"m", ",", "prod", ",", "\"\<True\>\"", ",", "0"}], 
              "]"}], ",", 
             RowBox[{"AcceptanceDiscret", "[", 
              RowBox[{"m", ",", "prod", ",", "\"\<False\>\"", ",", "1"}], 
              "]"}], ",", 
             RowBox[{"AcceptanceDiscret", "[", 
              RowBox[{"m", ",", "prod", ",", "\"\<True\>\"", ",", "1"}], 
              "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"m", ",", 
             RowBox[{"mlistAcceptance", "[", "prod", "]"}]}], "}"}]}], 
          "]"}]}], ";"}], "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"prod", ",", "ProductionList"}], "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"PlotAcc", "[", "ProdChannel_", "]"}], ":=", 
     RowBox[{"ListLogPlot", "[", 
      RowBox[{
       RowBox[{"Evaluate", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"\[Epsilon]GeomTabs", "[", "ProdChannel", "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", 
             RowBox[{"{", 
              RowBox[{"1", ",", "2"}], "}"}]}], "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"\[Epsilon]GeomTabs", "[", "ProdChannel", "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", 
             RowBox[{"{", 
              RowBox[{"1", ",", "3"}], "}"}]}], "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"\[Epsilon]GeomTabs", "[", "ProdChannel", "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", 
             RowBox[{"{", 
              RowBox[{"1", ",", "4"}], "}"}]}], "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"\[Epsilon]GeomTabs", "[", "ProdChannel", "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", 
             RowBox[{"{", 
              RowBox[{"1", ",", "5"}], "}"}]}], "]"}], "]"}]}], "}"}], "]"}], 
       ",", 
       RowBox[{"FrameStyle", "\[Rule]", 
        RowBox[{"Directive", "[", 
         RowBox[{"Black", ",", " ", "22"}], "]"}]}], ",", 
       RowBox[{"PlotStyle", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Thickness", "[", "0.003", "]"}], ",", "Blue"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Thickness", "[", "0.003", "]"}], ",", 
            RowBox[{"Darker", "@", "Red"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Thickness", "[", "0.003", "]"}], ",", 
            RowBox[{"Darker", "@", 
             RowBox[{"Darker", "@", "Green"}]}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Thickness", "[", "0.003", "]"}], ",", "Black"}], "}"}]}],
          "}"}]}], ",", 
       RowBox[{"GridLines", "\[Rule]", "Automatic"}], ",", 
       RowBox[{"PlotRange", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"MinMax", "[", 
           RowBox[{
            RowBox[{"\[Epsilon]GeomTabs", "[", "ProdChannel", "]"}], "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Max", "[", 
             RowBox[{
              RowBox[{"0.9", 
               RowBox[{"Min", "[", 
                RowBox[{
                 RowBox[{"Min", "[", 
                  RowBox[{
                   RowBox[{"\[Epsilon]GeomTabs", "[", "ProdChannel", "]"}], "[", 
                   RowBox[{"[", 
                    RowBox[{"All", ",", "4"}], "]"}], "]"}], "]"}], ",", 
                 RowBox[{"Min", "[", 
                  RowBox[{
                   RowBox[{"\[Epsilon]GeomTabs", "[", "ProdChannel", "]"}], "[", 
                   RowBox[{"[", 
                    RowBox[{"All", ",", "3"}], "]"}], "]"}], "]"}]}], "]"}]}],
               ",", 
              SuperscriptBox["10", 
               RowBox[{"-", "5"}]]}], "]"}], ",", 
            RowBox[{"1.1", 
             RowBox[{"Max", "[", 
              RowBox[{
               RowBox[{"Max", "[", 
                RowBox[{
                 RowBox[{"\[Epsilon]GeomTabs", "[", "ProdChannel", "]"}], "[", 
                 RowBox[{"[", 
                  RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}], ",", 
               RowBox[{"Max", "[", 
                RowBox[{
                 RowBox[{"\[Epsilon]GeomTabs", "[", "ProdChannel", "]"}], "[", 
                 RowBox[{"[", 
                  RowBox[{"All", ",", "4"}], "]"}], "]"}], "]"}]}], "]"}]}]}],
            "}"}]}], "}"}]}], ",", 
       RowBox[{"Joined", "\[Rule]", "True"}], ",", 
       RowBox[{"Frame", "\[Rule]", "True"}], ",", 
       RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
       RowBox[{"FrameLabel", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"\"\<\!\(\*SubscriptBox[\(m\), \(LLP\)]\) [GeV]\>\"", 
          ",", "\"\<Acceptance\>\""}], "}"}]}], ",", 
       RowBox[{"PlotLabel", "\[Rule]", " ", 
        RowBox[{"Style", "[", 
         RowBox[{
          RowBox[{"Row", "[", 
           RowBox[{"{", 
            RowBox[{"\"\<From \>\"", ",", "ProdChannel"}], "}"}], "]"}], ",", 
          " ", "20", ",", " ", "Black"}], "]"}]}], ",", 
       RowBox[{"PlotLegends", "\[Rule]", 
        RowBox[{"Placed", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Style", "[", 
             RowBox[{"#", ",", " ", "18"}], "]"}], "&"}], "/@", 
           RowBox[{"{", 
            
            RowBox[{"\"\<<\!\(\*SubscriptBox[\(\[Epsilon]\), \(LLP\)]\)>\>\"",
              ",", "\"\<<\!\(\*SubscriptBox[\(\[Epsilon]\), \
\(LLP\)]\)\!\(\*SubscriptBox[\(\[Epsilon]\), \(decay\)]\)>\>\"", 
             ",", "\"\<c\[Tau]<\!\(\*SubscriptBox[\(\[Epsilon]\), \
\(LLP\)]\)\!\(\*SubscriptBox[\(P\), \(decay\)]\)>\>\"", 
             ",", "\"\<c\[Tau]<\!\(\*SubscriptBox[\(\[Epsilon]\), \
\(LLP\)]\)\!\(\*SubscriptBox[\(P\), \(decay\)]\)\!\(\*SubscriptBox[\(\
\[Epsilon]\), \(decay\)]\)>\>\""}], "}"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"0.75", ",", "0.2"}], "}"}]}], "]"}]}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"FilenameAcceptance", "[", "prod", "]"}], "=", 
         RowBox[{"ToString", "@", 
          RowBox[{"StringForm", "[", 
           RowBox[{"\"\<Acceptance_ALP-fermion_at_``_From_``.dat\>\"", ",", 
            RowBox[{"Sequence", "@@", 
             RowBox[{"{", 
              RowBox[{"SelectedExperiment", ",", 
               RowBox[{"ExportList", "[", "prod", "]"}]}], "}"}]}]}], 
           "]"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Export", "[", 
         RowBox[{
          RowBox[{"FileNameJoin", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"NotebookDirectory", "[", "]"}], 
             ",", "\"\<Auxiliary data/ALPs with fermion coupling\>\"", ",", 
             "SelectedExperiment", ",", 
             RowBox[{"FilenameAcceptance", "[", "prod", "]"}]}], "}"}], "]"}],
           ",", 
          RowBox[{
           RowBox[{"\[Epsilon]GeomTabs", "[", "prod", "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", 
             RowBox[{"{", 
              RowBox[{"1", ",", "2", ",", "4", ",", "5"}], "}"}]}], "]"}], 
           "]"}], ",", "\"\<Table\>\""}], "]"}]}], "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"prod", ",", "ProductionList"}], "}"}]}], "]"}], "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"AccAveraged", "[", 
      RowBox[{"mLLP_", ",", "\[Theta]2_", ",", "BrhToSS_"}], "]"}], "=", 
     RowBox[{"NpotGivenExperiment", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"mLLPmin", "[", "prod", "]"}], "<", "mLLP", "<", 
             RowBox[{"mLLPmax", "[", "prod", "]"}]}], ",", 
            RowBox[{"Evaluate", "[", 
             RowBox[{"ProbLLP", "[", 
              RowBox[{"mLLP", ",", "\[Theta]2", ",", "BrhToSS", ",", "prod"}],
               "]"}], "]"}], ",", "0"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"prod", ",", "ProductionListBaseline"}], "}"}]}], "]"}], ",", 
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Max", "[", 
              RowBox[{
               RowBox[{"mLLPmin", "[", "prod", "]"}], ",", "mmin\[Epsilon]"}],
               "]"}], "<", "mLLP", "<", 
             RowBox[{"Min", "[", 
              RowBox[{
               RowBox[{"mLLPmax", "[", "prod", "]"}], ",", "mmax\[Epsilon]"}],
               "]"}]}], ",", 
            RowBox[{"Evaluate", "[", 
             RowBox[{
              RowBox[{"ProbLLP", "[", 
               RowBox[{
               "mLLP", ",", "\[Theta]2", ",", "BrhToSS", ",", "prod"}], "]"}],
               "*", 
              RowBox[{
               RowBox[{"Interpolation", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"\[Epsilon]GeomTabs", "[", "prod", "]"}], "[", 
                  RowBox[{"[", 
                   RowBox[{"All", ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "2"}], "}"}]}], "]"}], "]"}], ",", 
                 RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[",
                "mLLP", "]"}]}], "]"}], ",", "0"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"prod", ",", "ProductionListBaseline"}], "}"}]}], "]"}], ",", 
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Max", "[", 
              RowBox[{
               RowBox[{"mLLPmin", "[", "prod", "]"}], ",", "mmin\[Epsilon]"}],
               "]"}], "<", "mLLP", "<", 
             RowBox[{"Min", "[", 
              RowBox[{
               RowBox[{"mLLPmax", "[", "prod", "]"}], ",", "mmax\[Epsilon]"}],
               "]"}]}], ",", 
            RowBox[{"Evaluate", "[", 
             RowBox[{
              FractionBox[
               RowBox[{"ProbLLP", "[", 
                RowBox[{
                "mLLP", ",", "\[Theta]2", ",", "BrhToSS", ",", "prod"}], 
                "]"}], "c\[Tau]acc"], "*", 
              RowBox[{
               RowBox[{"Interpolation", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"\[Epsilon]GeomTabs", "[", "prod", "]"}], "[", 
                  RowBox[{"[", 
                   RowBox[{"All", ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "4"}], "}"}]}], "]"}], "]"}], ",", 
                 RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[",
                "mLLP", "]"}]}], "]"}], ",", "0"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"prod", ",", "ProductionListBaseline"}], "}"}]}], "]"}], ",", 
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Max", "[", 
              RowBox[{
               RowBox[{"mLLPmin", "[", "prod", "]"}], ",", "mmin\[Epsilon]"}],
               "]"}], "<", "mLLP", "<", 
             RowBox[{"Min", "[", 
              RowBox[{
               RowBox[{"mLLPmax", "[", "prod", "]"}], ",", "mmax\[Epsilon]"}],
               "]"}]}], ",", 
            RowBox[{"Evaluate", "[", 
             RowBox[{
              FractionBox[
               RowBox[{"ProbLLP", "[", 
                RowBox[{
                "mLLP", ",", "\[Theta]2", ",", "BrhToSS", ",", "prod"}], 
                "]"}], "c\[Tau]acc"], "*", 
              RowBox[{
               RowBox[{"Interpolation", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"\[Epsilon]GeomTabs", "[", "prod", "]"}], "[", 
                  RowBox[{"[", 
                   RowBox[{"All", ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "5"}], "}"}]}], "]"}], "]"}], ",", 
                 RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[",
                "mLLP", "]"}]}], "]"}], ",", "0"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"prod", ",", "ProductionListBaseline"}], "}"}]}], "]"}]}], 
       "}"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{"FileNameJoin", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"directory", "[", "\"\<Auxiliary-experiment\>\"", "]"}], ",", 
         RowBox[{"\"\<AcceptanceAveraged-\>\"", "<>", "LLPdirName", 
          "<>", "\"\<.m\>\""}]}], "}"}], "]"}], ",", 
      RowBox[{"AccAveraged", "[", 
       RowBox[{"mLLP", ",", "\[Theta]2", ",", "BrhToSS"}], "]"}], 
      ",", "\"\<MX\>\""}], "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"Style", "[", 
     RowBox[{
      RowBox[{"Row", "[", 
       RowBox[{"Evaluate", "[", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"PlotAcc", "[", "prod", "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"prod", ",", "ProductionList"}], "}"}]}], "]"}], "]"}], 
       "]"}], ",", 
      RowBox[{"ImageSizeMultipliers", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"1", ",", "1", ",", "1", ",", "1"}], "}"}]}]}], "]"}]}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.9165072608467913`*^9, 3.91650727179105*^9}, {
   3.916511834115503*^9, 3.9165119704481926`*^9}, {3.9166711144696927`*^9, 
   3.9166711149830294`*^9}, {3.916680172167667*^9, 3.9166801738129787`*^9}, {
   3.9168095773531494`*^9, 3.9168095888137484`*^9}, 3.9169423556755576`*^9, {
   3.9345990288706713`*^9, 3.934599035440804*^9}, {3.9421654644479847`*^9, 
   3.9421654663420258`*^9}, {3.942304573551544*^9, 3.9423045742468243`*^9}, {
   3.9506825167342396`*^9, 3.9506825393308067`*^9}, 3.9506825923301983`*^9, {
   3.9506826349205284`*^9, 3.9506826350657673`*^9}, 3.950682674379816*^9},
 CellTags->{
  "Acceptance-computation", "Number-of-events-computation+sensitivity"},
 CellLabel->
  "In[239]:=",ExpressionUUID->"b6b04b5b-33f5-4fa1-bd0e-54d3490da4fa"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Rough estimates of the upper and lower bounds", "Subsection",
 CellChangeTimes->{{3.8850328066928463`*^9, 3.8850328135228024`*^9}},
 CellTags->{
  "Acceptance-computation", 
   "Number-of-events-computation+sensitivity"},ExpressionUUID->"c61f47e8-9fc1-\
439b-8a32-a6f080e12656"],

Cell[BoxData[
 RowBox[{"If", "[", 
  RowBox[{"condcontinue", ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BrhToSSreference", "=", "0.15"}], ";", "\[IndentingNewLine]", 
    RowBox[{"Do", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"factorLowerBound", "=", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"StringContainsQ", "[", 
           RowBox[{"prod", ",", "\"\<mixing\>\""}], "]"}], ",", 
          FractionBox["1", "2"], ",", "1"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"LowerBoundEstimate", "[", 
         RowBox[{"mLLP_", ",", "prod"}], "]"}], "=", 
        SuperscriptBox[
         RowBox[{"(", 
          FractionBox[
           RowBox[{"NpotGivenExperiment", "*", 
            RowBox[{"ProbLLP", "[", 
             RowBox[{"mLLP", ",", "1", ",", "BrhToSSreference", ",", "prod"}],
              "]"}], "*", 
            RowBox[{
             RowBox[{"Interpolation", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"\[Epsilon]GeomTabs", "[", "prod", "]"}], "[", 
                RowBox[{"[", 
                 RowBox[{"All", ",", 
                  RowBox[{"{", 
                   RowBox[{"1", ",", "5"}], "}"}]}], "]"}], "]"}], ",", 
               RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[", 
             "mLLP", "]"}]}], 
           RowBox[{"2.3", 
            RowBox[{"ldecayLLP", "[", 
             RowBox[{"mLLP", ",", "1", ",", "ELLP"}], "]"}], 
            FractionBox["mLLP", 
             SqrtBox[
              RowBox[{
               SuperscriptBox["ELLP", "2"], "-", 
               SuperscriptBox["mLLP", "2"]}]]]}]], ")"}], 
         RowBox[{"-", "factorLowerBound"}]]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"UpperBoundEstimate", "[", 
         RowBox[{"mLLP_", ",", "prod"}], "]"}], "=", 
        RowBox[{"(", 
         RowBox[{"Abs", "[", 
          RowBox[{"Re", "[", 
           RowBox[{"Evaluate", "[", 
            RowBox[{
             RowBox[{"-", 
              FractionBox[
               RowBox[{"ProductLog", "[", 
                RowBox[{
                 RowBox[{"-", "1"}], ",", 
                 RowBox[{
                  RowBox[{"-", "2.3"}], "*", 
                  FractionBox["b", "a"]}]}], "]"}], "b"]}], "/.", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"a", "\[Rule]", " ", 
                RowBox[{"NpotGivenExperiment", "*", 
                 RowBox[{"ProbLLP", "[", 
                  RowBox[{
                  "mLLP", ",", "1", ",", "BrhToSSreference", ",", "prod"}], 
                  "]"}], "*", 
                 RowBox[{
                  RowBox[{"Interpolation", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"\[Epsilon]GeomTabs", "[", "prod", "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "3"}], "}"}]}], "]"}], "]"}], ",", 
                    RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[",
                   "mLLP", "]"}]}]}], ",", 
               RowBox[{"b", "\[Rule]", 
                FractionBox["zminExp", 
                 RowBox[{"ldecayLLP", "[", 
                  RowBox[{"mLLP", ",", "1", ",", 
                   RowBox[{"ELLPmax", "[", 
                    RowBox[{"0.5", ",", "\[Theta]minExp", ",", "prod"}], 
                    "]"}]}], "]"}]]}]}], "}"}]}], "]"}], "]"}], "]"}], 
         ")"}]}]}], ",", 
      RowBox[{"{", 
       RowBox[{"prod", ",", "ProductionList"}], "}"}]}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"ProdTest", "=", 
     RowBox[{"ProductionList", "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"LogLogPlot", "[", 
     RowBox[{
      RowBox[{"Evaluate", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"0.3", 
          RowBox[{"LowerBoundEstimate", "[", 
           RowBox[{"mLLP", ",", "ProdTest"}], "]"}]}], ",", 
         RowBox[{"1.8", 
          RowBox[{"UpperBoundEstimate", "[", 
           RowBox[{"mLLP", ",", "ProdTest"}], "]"}]}]}], "}"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"mLLP", ",", 
        RowBox[{"Max", "[", 
         RowBox[{
          RowBox[{"mLLPmin", "[", "ProdTest", "]"}], ",", "mmin\[Epsilon]"}], 
         "]"}], ",", 
        RowBox[{"Min", "[", 
         RowBox[{
          RowBox[{"mLLPmax", "[", "ProdTest", "]"}], ",", "mmax\[Epsilon]"}], 
         "]"}]}], "}"}], ",", 
      RowBox[{"Frame", "->", "True"}], ",", 
      RowBox[{"ImageSize", "->", "Large"}]}], "]"}]}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.8927045521296835`*^9, 3.892704618398532*^9}, {
   3.892704651576499*^9, 3.892704652867281*^9}, 3.8951292466391563`*^9, {
   3.8972064547512426`*^9, 3.8972064548441195`*^9}, {3.8972065272743893`*^9, 
   3.8972065273639555`*^9}, {3.897208556347765*^9, 3.8972085563922853`*^9}, {
   3.8972086426345124`*^9, 3.897208654173244*^9}, {3.897232414966792*^9, 
   3.8972324175870733`*^9}, {3.8972329876997476`*^9, 3.897233009729268*^9}, {
   3.8972333224369483`*^9, 3.8972333287617497`*^9}, 3.897233684153979*^9, {
   3.8972340069416475`*^9, 3.897234007169805*^9}, {3.897234114920539*^9, 
   3.8972341194170074`*^9}, {3.9027273710668883`*^9, 3.902727371070483*^9}, {
   3.9037896747950044`*^9, 3.903789674805071*^9}, {3.903791118363947*^9, 
   3.9037911183684855`*^9}, {3.9037936813200336`*^9, 3.903793682290308*^9}, {
   3.9049231517292624`*^9, 3.904923157976531*^9}, {3.9049231902009006`*^9, 
   3.904923190656528*^9}, 3.904926376200742*^9, {3.911027289230471*^9, 
   3.9110273124658933`*^9}, {3.9110277505648003`*^9, 3.911027764091008*^9}, 
   3.913866752239462*^9, {3.9138675516462307`*^9, 3.9138675637833986`*^9}, {
   3.9138682212474923`*^9, 3.913868221253111*^9}, {3.9138690439766445`*^9, 
   3.913869043981699*^9}, {3.9138691384932814`*^9, 3.913869147288597*^9}, {
   3.913869202156701*^9, 3.9138692055185556`*^9}, {3.913869239652417*^9, 
   3.9138692400334797`*^9}, {3.913869474546574*^9, 3.913869474546574*^9}, {
   3.913870429970599*^9, 3.913870442530464*^9}, {3.9138744135974054`*^9, 
   3.913874414587882*^9}, {3.9156429963777814`*^9, 3.915642996428277*^9}, {
   3.916391759919177*^9, 3.916391773937995*^9}, {3.916512010716703*^9, 
   3.9165120302839413`*^9}, {3.9166799450317926`*^9, 3.916680024415283*^9}, {
   3.9166801353834095`*^9, 3.916680146758221*^9}, 3.9166802796120076`*^9, {
   3.921651239761982*^9, 3.9216512398142653`*^9}, 3.949934195219322*^9, {
   3.950682560960329*^9, 3.9506825674589577`*^9}},
 CellTags->{
  "Acceptance-computation", "Number-of-events-computation+sensitivity"},
 CellLabel->
  "In[240]:=",ExpressionUUID->"aa0f18f8-518c-4776-85f1-d1b353e8e46e"]
}, Closed]],

Cell[CellGroupData[{

Cell["Number of events - fast", "Subsection",
 CellChangeTimes->{{3.897206442190997*^9, 3.8972064427846107`*^9}, {
  3.905840324777521*^9, 3.905840328994842*^9}},
 CellTags->{
  "Number-of-events-computation+sensitivity", 
   "Acceptance-computation"},ExpressionUUID->"490cedb7-cbf3-448d-ab54-\
bd76b35989e3"],

Cell[BoxData[
 RowBox[{"If", "[", 
  RowBox[{"condcontinue", ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"FactorLowerBound", "=", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"MemberQ", "[", 
         RowBox[{
          RowBox[{"{", 
           
           RowBox[{"\"\<ANUBIS-shaft-volume-1\>\"", 
            ",", "\"\<ANUBIS-shaft-volume-2\>\"", 
            ",", "\"\<ANUBIS-shaft-volume-3\>\""}], "}"}], ",", 
          "SelectedExperiment"}], "]"}], "==", "True"}], ",", "0.1", ",", 
       "0.3"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"NeventsDiscret", "[", 
      RowBox[{
      "m_", ",", "ProdChannel_", ",", "BrhToSS_", ",", "\[Theta]2list_"}], 
      "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "NevDiscret", 
        RowBox[{"(*", 
         RowBox[{",", "NpotTimes\[Chi]val"}], "*)"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"MemberQ", "[", 
          RowBox[{"ProductionList", ",", "ProdChannel"}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Max", "[", 
             RowBox[{"mmin\[Epsilon]", ",", 
              RowBox[{"mLLPmin", "[", "ProdChannel", "]"}]}], "]"}], "<", "m",
             "<", 
            RowBox[{"Min", "[", 
             RowBox[{
              RowBox[{"mLLPmax", "[", "ProdChannel", "]"}], ",", 
              "mmax\[Epsilon]"}], "]"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"integrandtab", "=", 
             RowBox[{"TableIntegrandDiscret", "[", 
              RowBox[{"m", ",", "ProdChannel", ",", "\"\<True\>\""}], "]"}]}],
             ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"NpotTimes\[Chi]val", "[", "\[Theta]2_", "]"}], "=", 
             RowBox[{"FactorANUBISceiling", "*", "NpotGivenExperiment", "*", 
              RowBox[{"ProbLLP", "[", 
               RowBox[{
               "m", ",", "\[Theta]2", ",", "BrhToSS", ",", "ProdChannel"}], 
               "]"}]}]}], ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"lowerbound", ",", "upperbound"}], "}"}], "=", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"LowerBoundEstimate", "[", 
                RowBox[{"m", ",", "ProdChannel"}], "]"}], ",", 
               RowBox[{"UpperBoundEstimate", "[", 
                RowBox[{"m", ",", "ProdChannel"}], "]"}]}], "}"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"brvis", "=", 
             RowBox[{"BrVis", "[", "m", "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"NevDiscret", "[", "\[Theta]2_", "]"}], ":=", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"brvis", "!=", "0"}], ",", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"FactorLowerBound", "*", "lowerbound"}], "<", 
                  "\[Theta]2", "<", 
                  RowBox[{"2", "upperbound"}]}], ",", 
                 RowBox[{
                  RowBox[{"NpotTimes\[Chi]val", "[", "\[Theta]2", "]"}], "*", 
                  "brvis", "*", 
                  RowBox[{"sumcompile", "[", 
                   RowBox[{"tableprefac", "[", 
                    RowBox[{"integrandtab", ",", "m", ",", 
                    RowBox[{"c\[Tau]LLP", "[", 
                    RowBox[{"m", ",", "\[Theta]2"}], "]"}], ",", "1", ",", 
                    "0."}], "]"}], "]"}]}], ",", "0."}], "]"}], ",", "0."}], 
              "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"m", ",", 
                RowBox[{"\[Theta]2list", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], ",", 
                RowBox[{"NevDiscret", "[", 
                 RowBox[{"\[Theta]2list", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "1", ",", 
                RowBox[{"Length", "[", "\[Theta]2list", "]"}], ",", "1"}], 
               "}"}]}], "]"}]}], ",", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"m", ",", 
               RowBox[{"\[Theta]2list", "[", 
                RowBox[{"[", "i", "]"}], "]"}], ",", "0."}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", 
               RowBox[{"Length", "[", "\[Theta]2list", "]"}], ",", "1"}], 
              "}"}]}], "]"}]}], "\[IndentingNewLine]", "]"}], 
         "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
         RowBox[{
         "Print", "[", "\"\<The given production mode does not exist!\>\"", 
          "]"}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
      "]"}]}]}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.897200964730176*^9, 3.897200965970766*^9}, {
   3.89720118259857*^9, 3.8972011870868115`*^9}, {3.8972012433916793`*^9, 
   3.8972012434804716`*^9}, {3.8972021109080114`*^9, 3.897202111357911*^9}, {
   3.897205130000824*^9, 3.8972051305748835`*^9}, 3.897206599004672*^9, {
   3.8972085445054307`*^9, 3.8972085493226857`*^9}, {3.897208729717713*^9, 
   3.897208782995672*^9}, {3.8972323557542253`*^9, 3.897232355758215*^9}, {
   3.8972325208882675`*^9, 3.897232579312927*^9}, {3.8972330183637056`*^9, 
   3.8972330186824365`*^9}, {3.8972330557477093`*^9, 
   3.8972330786629725`*^9}, {3.8972331885872264`*^9, 
   3.8972331892740192`*^9}, {3.897233372953797*^9, 3.8972334102237387`*^9}, {
   3.897233632248149*^9, 3.8972337068313646`*^9}, {3.897233770343194*^9, 
   3.897233794850586*^9}, {3.897234027583762*^9, 3.897234039222018*^9}, 
   3.902727371095085*^9, {3.903789674824919*^9, 3.9037896748651905`*^9}, {
   3.903790316364489*^9, 3.903790327604648*^9}, 3.903791118373599*^9, {
   3.903793681334241*^9, 3.903793681337234*^9}, {3.903793815495824*^9, 
   3.9037938405670385`*^9}, {3.9110273360582485`*^9, 3.911027382154455*^9}, {
   3.9110275909078875`*^9, 3.9110276162959757`*^9}, {3.911027735769429*^9, 
   3.9110277360519323`*^9}, {3.91102782490703*^9, 3.9110278664472694`*^9}, {
   3.911027908345337*^9, 3.9110279086712365`*^9}, 3.913867583368688*^9, {
   3.9138687734466343`*^9, 3.9138687783364944`*^9}, 3.913869043987434*^9, {
   3.91386913849867*^9, 3.91386914700126*^9}, {3.9138718044634438`*^9, 
   3.9138718044763327`*^9}, {3.9138744265895786`*^9, 
   3.9138744439740767`*^9}, {3.915642996438535*^9, 3.9156429964465075`*^9}, {
   3.9166711739039955`*^9, 3.9166711755719423`*^9}, 3.916678793983737*^9, {
   3.9166791229422555`*^9, 3.916679124073281*^9}, {3.9166803177796817`*^9, 
   3.9166803286959105`*^9}, 3.916680582522879*^9, {3.9506826864575424`*^9, 
   3.9506827628043575`*^9}},
 CellTags->{
  "Number-of-events-computation+sensitivity", "Acceptance-computation"},
 CellLabel->
  "In[241]:=",ExpressionUUID->"30a8ad6f-40f7-467d-8082-dbb62ed7d290"]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Number of events - slow (using built-in Mathematica functions Interpolation, \
NIntegrate)\
\>", "Subsection",
 CellChangeTimes->{{3.916673042143861*^9, 3.9166730501366386`*^9}},
 CellTags->{
  "Number-of-events-computation+sensitivity", 
   "Acceptance-computation"},ExpressionUUID->"d5a74d09-3a62-4413-916f-\
24f78ec73fd2"],

Cell[BoxData[
 RowBox[{"If", "[", 
  RowBox[{"condcontinue", ",", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Differential", " ", "decay", " ", "probability", " ", 
      FractionBox["1", "ldecay"], 
      RowBox[{"Exp", "[", 
       RowBox[{
        RowBox[{"-", "l"}], "/", "ldecay"}], "]"}]}], ",", " ", 
     RowBox[{
     "where", " ", "l", " ", "is", " ", "expressed", " ", "in", " ", "terms", 
      " ", "of", " ", "the", " ", "longitudinal", " ", "displacement", " ", 
      "z", " ", "and", " ", "polar", " ", "angle", " ", "\[Theta]", " ", "as",
       " ", 
      RowBox[{"z", "/", "cos\[Theta]"}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Differential", " ", "decay", " ", "probability", " ", 
      RowBox[{"(", 
       RowBox[{"1", "/", "ldecay"}], ")"}], 
      RowBox[{"Exp", "[", 
       RowBox[{
        RowBox[{"-", "l"}], "/", "ldecay"}], "]"}]}], ",", " ", 
     RowBox[{
     "where", " ", "l", " ", "is", " ", "expressed", " ", "in", " ", "terms", 
      " ", "of", " ", "the", " ", "longitudinal", " ", "displacement", " ", 
      "z", " ", "and", " ", "polar", " ", "angle", " ", "\[Theta]", " ", "as",
       " ", 
      RowBox[{"z", "/", "cos\[Theta]"}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"PdecayDensity", "[", 
      RowBox[{
      "mLLP_", ",", "coupling_", ",", "\[Theta]LLP_", ",", "ELLP_", ",", 
       "zLLP_"}], "]"}], "=", 
     RowBox[{
      RowBox[{"Exp", "[", 
       RowBox[{
        RowBox[{"-", "zLLP"}], "/", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Cos", "[", "\[Theta]LLP", "]"}], "*", 
          RowBox[{"ldecayLLP", "[", 
           RowBox[{"mLLP", ",", "coupling", ",", "ELLP"}], "]"}]}], ")"}]}], 
       "]"}], "/", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Abs", "[", 
         RowBox[{"Cos", "[", "\[Theta]LLP", "]"}], "]"}], "*", 
        RowBox[{"ldecayLLP", "[", 
         RowBox[{"mLLP", ",", "coupling", ",", "ELLP"}], "]"}]}], ")"}]}]}], ";",
     "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
     "The", " ", "integrand", " ", "determining", " ", "the", " ", 
      "differential", " ", "rate", " ", "for", " ", "events"}], "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"IntegrandLLP", "[", 
        RowBox[{
        "mLLP_", ",", "coupling_", ",", "\[Theta]LLP_", ",", "ELLP_", ",", 
         "zLLP_", ",", "prod"}], "]"}], "=", 
       RowBox[{
        RowBox[{"DoubleDistrLLPint", "[", 
         RowBox[{"mLLP", ",", "\[Theta]LLP", ",", "ELLP", ",", "prod"}], 
         "]"}], "*", 
        RowBox[{"PdecayDensity", "[", 
         RowBox[{
         "mLLP", ",", "coupling", ",", "\[Theta]LLP", ",", "ELLP", ",", 
          "zLLP"}], "]"}], "*", 
        RowBox[{"AzimuthalAcceptanceInt", "[", 
         RowBox[{"\[Theta]LLP", ",", "zLLP"}], "]"}], "*", 
        RowBox[{"DecayAcceptanceInt", "[", 
         RowBox[{"mLLP", ",", "\[Theta]LLP", ",", "ELLP", ",", "zLLP"}], 
         "]"}]}]}], ",", 
      RowBox[{"{", 
       RowBox[{"prod", ",", "ProductionList"}], "}"}]}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"IntegralLLP", "[", 
      RowBox[{"mLLP_", ",", "coupling_", ",", "ProdChannel_"}], "]"}], ":=", 
     RowBox[{"NIntegrate", "[", 
      RowBox[{
       RowBox[{"Abs", "[", 
        RowBox[{
         RowBox[{"IntegrandLLP", "[", 
          RowBox[{"mLLP", ",", "coupling", ",", "\[Theta]LLP", ",", 
           RowBox[{"Exp", "[", "ELLP", "]"}], ",", "zLLP", ",", 
           "ProdChannel"}], "]"}], 
         RowBox[{"Exp", "[", "ELLP", "]"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Theta]LLP", ",", "\[Theta]minExp", ",", "\[Theta]maxExp"}],
         "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"ELLP", ",", 
         RowBox[{"Log", "[", "mLLP", "]"}], ",", 
         RowBox[{"Log", "[", 
          RowBox[{"ELLPmax", "[", 
           RowBox[{"mLLP", ",", "\[Theta]LLP", ",", "ProdChannel"}], "]"}], 
          "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"zLLP", ",", 
         RowBox[{"zmin\[Theta]", "[", "\[Theta]LLP", "]"}], ",", 
         RowBox[{"zmax\[Theta]", "[", "\[Theta]LLP", "]"}]}], "}"}], ",", 
       RowBox[{"Method", "\[Rule]", "\"\<AdaptiveMonteCarlo\>\""}]}], "]"}]}],
     ";", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"IntegralLLP", "[", 
       RowBox[{"mLLP_", ",", "finv_", ",", "ProdChannel_"}], "]"}], ":=", 
      RowBox[{"NIntegrate", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Abs", "[", 
          RowBox[{"IntegrandLLP", "[", 
           RowBox[{"mLLP", ",", "finv", ",", 
            RowBox[{"Exp", "[", "\[Theta]LLP", "]"}], ",", 
            RowBox[{"Exp", "[", "ELLP", "]"}], ",", 
            RowBox[{"Exp", "[", "zLLP", "]"}], ",", "ProdChannel"}], "]"}], 
          "]"}], 
         RowBox[{"Exp", "[", 
          RowBox[{"\[Theta]LLP", "+", "ELLP", "+", "zLLP"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"\[Theta]LLP", ",", 
          RowBox[{"Log", "[", "\[Theta]minExp", "]"}], ",", 
          RowBox[{"Log", "[", "\[Theta]maxExp", "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"ELLP", ",", 
          RowBox[{"Log", "[", "mLLP", "]"}], ",", 
          RowBox[{"Log", "[", 
           RowBox[{"ELLPmax", "[", 
            RowBox[{"mLLP", ",", 
             RowBox[{"Exp", "[", "\[Theta]LLP", "]"}], ",", "ProdChannel"}], 
            "]"}], "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"zLLP", ",", 
          RowBox[{"Log", "[", 
           RowBox[{"zmin\[Theta]", "[", 
            RowBox[{"Exp", "[", "\[Theta]LLP", "]"}], "]"}], "]"}], ",", 
          RowBox[{"Log", "[", 
           RowBox[{"zmax\[Theta]", "[", 
            RowBox[{"Exp", "[", "\[Theta]LLP", "]"}], "]"}], "]"}]}], "}"}], ",", 
        RowBox[{"Method", "\[Rule]", "\"\<AdaptiveMonteCarlo\>\""}]}], 
       "]"}]}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"NeventsInt", "[", 
      RowBox[{
      "mLLP_", ",", "\[Theta]2_", ",", "BrhToSS_", ",", "ProdChannel_"}], 
      "]"}], ":=", 
     RowBox[{"FactorANUBISceiling", "*", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"mLLPmin", "[", "ProdChannel", "]"}], "\[LessEqual]", 
          "mLLP", "\[LessEqual]", 
          RowBox[{"mLLPmax", "[", "ProdChannel", "]"}]}], "&&", 
         RowBox[{
          RowBox[{"BrVis", "[", "mLLP", "]"}], "!=", "0"}]}], ",", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"FactorLowerBound", "*", 
            RowBox[{"LowerBoundEstimate", "[", 
             RowBox[{"mLLP", ",", "ProdChannel"}], "]"}]}], "<", "\[Theta]2", 
           "<", 
           RowBox[{"2", 
            RowBox[{"UpperBoundEstimate", "[", 
             RowBox[{"mLLP", ",", "ProdChannel"}], "]"}]}]}], ",", 
          RowBox[{"NpotGivenExperiment", "*", 
           RowBox[{"ProbLLP", "[", 
            RowBox[{
            "mLLP", ",", "\[Theta]2", ",", "BrhToSS", ",", "ProdChannel"}], 
            "]"}], "*", 
           RowBox[{"IntegralLLP", "[", 
            RowBox[{"mLLP", ",", "\[Theta]2", ",", "ProdChannel"}], "]"}]}], ",",
           "0."}], "]"}], ",", "0."}], "]"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"IntegralLLPE", "[", 
      RowBox[{"mLLP_", ",", "\[Theta]2_", ",", "ProdChannel_", ",", "ELLP_"}],
       "]"}], ":=", 
     RowBox[{"NIntegrate", "[", 
      RowBox[{
       RowBox[{"Abs", "[", 
        RowBox[{"IntegrandLLP", "[", 
         RowBox[{
         "mLLP", ",", "\[Theta]2", ",", "\[Theta]LLP", ",", "ELLP", ",", 
          "zLLP", ",", "ProdChannel"}], "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Theta]LLP", ",", "\[Theta]minExp", ",", "\[Theta]maxExp"}],
         "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"zLLP", ",", 
         RowBox[{"zmin\[Theta]", "[", "\[Theta]LLP", "]"}], ",", 
         RowBox[{"zmax\[Theta]", "[", "\[Theta]LLP", "]"}]}], "}"}], ",", 
       RowBox[{"Method", "\[Rule]", "\"\<AdaptiveMonteCarlo\>\""}]}], "]"}]}],
     ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"NeventsDiffIntE", "[", 
      RowBox[{
      "mLLP_", ",", "\[Theta]2_", ",", "BrhToSS_", ",", "ProdChannel_", ",", 
       "ELLP_"}], "]"}], ":=", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"mLLPmin", "[", "ProdChannel", "]"}], "\[LessEqual]", "mLLP",
          "\[LessEqual]", 
         RowBox[{"mLLPmax", "[", "ProdChannel", "]"}]}], "&&", 
        RowBox[{
         RowBox[{"BrVis", "[", "mLLP", "]"}], "!=", "0"}], "&&", 
        RowBox[{"mLLP", "<", "ELLP", "<=", 
         RowBox[{"ELLPmax", "[", 
          RowBox[{"mLLP", ",", "\[Theta]minExp", ",", "ProdChannel"}], 
          "]"}]}]}], ",", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"0.1", 
           RowBox[{"LowerBoundEstimate", "[", 
            RowBox[{"mLLP", ",", "ProdChannel"}], "]"}]}], "<", "\[Theta]2", "<", 
          RowBox[{"2", 
           RowBox[{"UpperBoundEstimate", "[", 
            RowBox[{"mLLP", ",", "ProdChannel"}], "]"}]}]}], ",", 
         RowBox[{"NpotGivenExperiment", "*", 
          RowBox[{"ProbLLP", "[", 
           RowBox[{
           "mLLP", ",", "\[Theta]2", ",", "BrhToSS", ",", "ProdChannel"}], 
           "]"}], "*", 
          RowBox[{"IntegralLLPE", "[", 
           RowBox[{
           "mLLP", ",", "\[Theta]2", ",", "ProdChannel", ",", "ELLP"}], 
           "]"}]}], ",", "0."}], "]"}], ",", "0."}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"IntegralLLPz", "[", 
      RowBox[{"mLLP_", ",", "\[Theta]2_", ",", "ProdChannel_", ",", "zLLP_"}],
       "]"}], ":=", 
     RowBox[{"NIntegrate", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Abs", "[", 
         RowBox[{"IntegrandLLP", "[", 
          RowBox[{"mLLP", ",", "\[Theta]2", ",", "\[Theta]LLP", ",", 
           RowBox[{"Exp", "[", "ELLP", "]"}], ",", "zLLP", ",", 
           "ProdChannel"}], "]"}], "]"}], 
        RowBox[{"Exp", "[", "ELLP", "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Theta]LLP", ",", "\[Theta]minExp", ",", "\[Theta]maxExp"}],
         "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"ELLP", ",", 
         RowBox[{"Log", "[", "mLLP", "]"}], ",", 
         RowBox[{"Log", "[", 
          RowBox[{"Evaluate", "[", 
           RowBox[{"ELLPmax", "[", 
            RowBox[{"mLLP", ",", "\[Theta]LLP", ",", "ProdChannel"}], "]"}], 
           "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"Method", "\[Rule]", "\"\<AdaptiveMonteCarlo\>\""}]}], "]"}]}],
     ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"NeventsDiffIntz", "[", 
      RowBox[{
      "mLLP_", ",", "\[Theta]2_", ",", "BrhToSS_", ",", "ProdChannel_", ",", 
       "zLLP_"}], "]"}], ":=", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"mLLPmin", "[", "ProdChannel", "]"}], "\[LessEqual]", "mLLP",
          "\[LessEqual]", 
         RowBox[{"mLLPmax", "[", "ProdChannel", "]"}]}], "&&", 
        RowBox[{
         RowBox[{"BrVis", "[", "mLLP", "]"}], "!=", "0"}], "&&", 
        RowBox[{"zminExp", "<=", "zLLP", "<=", "zmaxExp"}]}], ",", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"0.1", 
           RowBox[{"LowerBoundEstimate", "[", 
            RowBox[{"mLLP", ",", "ProdChannel"}], "]"}]}], "<", "\[Theta]2", "<", 
          RowBox[{"2", 
           RowBox[{"UpperBoundEstimate", "[", 
            RowBox[{"mLLP", ",", "ProdChannel"}], "]"}]}]}], ",", 
         RowBox[{"NpotGivenExperiment", "*", 
          RowBox[{"ProbLLP", "[", 
           RowBox[{
           "mLLP", ",", "\[Theta]2", ",", "BrhToSS", ",", "ProdChannel"}], 
           "]"}], "*", 
          RowBox[{"IntegralLLPz", "[", 
           RowBox[{
           "mLLP", ",", "\[Theta]2", ",", "ProdChannel", ",", "zLLP"}], 
           "]"}]}], ",", "0."}], "]"}], ",", "0."}], "]"}]}]}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.9166799137860527`*^9, 3.916679935477621*^9}, 
   3.916680389549122*^9, {3.9166805900196667`*^9, 3.9166805910297723`*^9}, {
   3.9169004956873865`*^9, 3.9169005056903467`*^9}, {3.9169018559727106`*^9, 
   3.916902012500043*^9}, {3.916902418221156*^9, 3.916902421379345*^9}, {
   3.916902493462449*^9, 3.9169025162406197`*^9}, {3.9506827716296616`*^9, 
   3.950682784622881*^9}},
 CellTags->{
  "Number-of-events-computation+sensitivity", "Acceptance-computation"},
 CellLabel->
  "In[242]:=",ExpressionUUID->"ad444b7f-ed27-4780-9327-f8c397aae568"]
}, Closed]],

Cell[CellGroupData[{

Cell["Differential number of events", "Subsection",
 CellChangeTimes->{{3.892111289211891*^9, 3.892111293865343*^9}},
 CellTags->{
  "Number-of-events-computation+sensitivity", 
   "Acceptance-computation"},ExpressionUUID->"f1d5b5a4-4a7a-4215-92e6-\
b433834a1702"],

Cell[BoxData[
 RowBox[{"If", "[", 
  RowBox[{"condcontinue", ",", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "Variable", " ", "=", 
      " ", "\"\<\!\(\*SubscriptBox[\(E\), \(X\)]\)\>\""}], 
     ",", "\"\<\!\(\*SubscriptBox[\(z\), \(X\)]\)\>\"", ",", 
     RowBox[{
      RowBox[{"\"\<\!\(\*SubscriptBox[\(\[Theta]\), \(X\)]\)\>\"", ".", " ", 
       "The"}], " ", "number", " ", "belongs", " ", "to", " ", "the", " ", 
      "column", " ", "in", " ", "the", " ", "tabulated", " ", "data"}]}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"iVal", ":=", 
     RowBox[{"Association", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\"\<\!\(\*SubscriptBox[\(E\), \(X\)]\)\>\"", " ", "\[Rule]", 
         "2"}], ",", 
        RowBox[{"\"\<\!\(\*SubscriptBox[\(\[Theta]\), \(X\)]\)\>\"", "\[Rule]",
          "1"}], ",", 
        RowBox[{"\"\<\!\(\*SubscriptBox[\(z\), \(X\)]\)\>\"", "\[Rule]", 
         "3"}]}], "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"Do", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"\[CapitalDelta]xvals", "[", 
         RowBox[{"\"\<\!\(\*SubscriptBox[\(E\), \(X\)]\)\>\"", ",", "prod"}], 
         "]"}], ":=", "\[CapitalDelta]Evals"}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\[CapitalDelta]xvals", "[", 
         RowBox[{"\"\<\!\(\*SubscriptBox[\(z\), \(X\)]\)\>\"", ",", "prod"}], 
         "]"}], "=", "\[CapitalDelta]zvals"}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\[CapitalDelta]xvals", "[", 
         RowBox[{"\"\<\!\(\*SubscriptBox[\(\[Theta]\), \(X\)]\)\>\"", ",", 
          "prod"}], "]"}], "=", 
        RowBox[{"\[CapitalDelta]\[Theta]vals", "[", "prod", "]"}]}]}], 
      "\[IndentingNewLine]", ",", 
      RowBox[{"{", 
       RowBox[{"prod", ",", "ProductionList"}], "}"}]}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"LegendX", ":=", 
     RowBox[{"Association", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\"\<\!\(\*SubscriptBox[\(E\), \(X\)]\)\>\"", 
         "\[Rule]", "\"\<\!\(\*SubscriptBox[\(E\), \(X\)]\) [GeV]\>\""}], ",", 
        RowBox[{"\"\<\!\(\*SubscriptBox[\(\[Theta]\), \(X\)]\)\>\"", 
         "\[Rule]", "\"\<\!\(\*SubscriptBox[\(\[Theta]\), \(X\)]\) \
[rad]\>\""}], ",", 
        RowBox[{"\"\<\!\(\*SubscriptBox[\(z\), \(X\)]\)\>\"", "\[Rule]", 
         " ", "\"\<\!\(\*SubscriptBox[\(z\), \(X\)]\) [m]\>\""}]}], "}"}], 
      "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"LegendY", ":=", 
     RowBox[{"Association", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\"\<\!\(\*SubscriptBox[\(E\), \(X\)]\)\>\"", 
         "\[Rule]", "\"\<\!\(\*SubscriptBox[\(dN\), \
\(ev\)]\)/\!\(\*SubscriptBox[\(dE\), \(X\)]\) [\!\(\*SuperscriptBox[\(GeV\), \
\(-1\)]\)]\>\""}], ",", 
        RowBox[{"\"\<\!\(\*SubscriptBox[\(\[Theta]\), \(X\)]\)\>\"", 
         "\[Rule]", "\"\<\!\(\*SubscriptBox[\(dN\), \
\(ev\)]\)/\!\(\*SubscriptBox[\(d\[Theta]\), \(X\)]\) \
[\!\(\*SuperscriptBox[\(rad\), \(-1\)]\)]\>\""}], ",", 
        RowBox[{"\"\<\!\(\*SubscriptBox[\(z\), \(X\)]\)\>\"", "\[Rule]", 
         " ", "\"\<\!\(\*SubscriptBox[\(dN\), \
\(ev\)]\)/\!\(\*SubscriptBox[\(dz\), \(X\)]\) [\!\(\*SuperscriptBox[\(m\), \
\(-1\)]\)]\>\""}]}], "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"Differential", " ", "number", " ", "of", " ", "events"}], 
     "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"NeventsDifferentialDiscretProd", "[", 
      RowBox[{
      "m_", ",", "ProdChannel_", ",", "coupling_", ",", "BrhToSS_", ",", 
       "Variable_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "NpotTimes\[Chi]val", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ival", "=", 
         RowBox[{"iVal", "[", "Variable", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"NpotTimes\[Chi]val", "=", 
         RowBox[{"NpotGivenExperiment", "*", 
          RowBox[{"ProbLLP", "[", 
           RowBox[{"m", ",", "coupling", ",", "BrhToSS", ",", "ProdChannel"}],
            "]"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"tablegrid0", "=", 
         RowBox[{"TableIntegrandDiscret", "[", 
          RowBox[{"m", ",", "ProdChannel", ",", "\"\<True\>\""}], "]"}]}], ";",
         "\[IndentingNewLine]", 
        RowBox[{"OutGridEfinalTemp", "=", 
         RowBox[{"OutGridEnergy", "[", 
          RowBox[{
           RowBox[{"N", "[", "m", "]"}], ",", "ProdChannel"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"\[CapitalDelta]Evals", "=", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Rest", "[", 
            SuperscriptBox["10", "OutGridEfinalTemp"], "]"}], "-", 
           RowBox[{"Most", "[", 
            SuperscriptBox["10", "OutGridEfinalTemp"], "]"}]}], ")"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"\[CapitalDelta]xval", "=", 
         RowBox[{"\[CapitalDelta]xvals", "[", 
          RowBox[{"Variable", ",", "ProdChannel"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"c\[Tau]Val", "=", 
         RowBox[{"c\[Tau]LLP", "[", 
          RowBox[{"m", ",", "coupling"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"brvis", "=", 
         RowBox[{"BrVis", "[", "m", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"ilist", "=", 
         RowBox[{"DeleteDuplicates", "[", 
          RowBox[{"{", 
           RowBox[{"ival", ",", "1", ",", "2", ",", "3"}], "}"}], "]"}]}], ";",
         "\[IndentingNewLine]", 
        RowBox[{"tablegrid1", "=", 
         RowBox[{"SortBy", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"#", "[", 
                RowBox[{"[", 
                 RowBox[{"ilist", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], ",", 
               RowBox[{"#", "[", 
                RowBox[{"[", 
                 RowBox[{"ilist", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}], ",", 
               RowBox[{"#", "[", 
                RowBox[{"[", 
                 RowBox[{"ilist", "[", 
                  RowBox[{"[", "3", "]"}], "]"}], "]"}], "]"}], ",", 
               RowBox[{"#", "[", 
                RowBox[{"[", "4", "]"}], "]"}]}], "}"}], "&"}], "/@", 
            RowBox[{"tableGridPrefac", "[", 
             RowBox[{"tablegrid0", ",", "m", ",", "c\[Tau]Val", ",", "0."}], 
             "]"}]}], ",", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"#", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", 
              RowBox[{"#", "[", 
               RowBox[{"[", "2", "]"}], "]"}], ",", 
              RowBox[{"#", "[", 
               RowBox[{"[", "3", "]"}], "]"}]}], "}"}], "&"}]}], "]"}]}], ";",
         "\[IndentingNewLine]", 
        RowBox[{"GridQuantity", "=", 
         RowBox[{
          RowBox[{"tablegrid1", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "1"}], "]"}], "]"}], "//", 
          "DeleteDuplicates"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"LengthPerVariable", "=", 
         RowBox[{
          RowBox[{"Length", "[", "tablegrid1", "]"}], "/", 
          RowBox[{"Length", "[", "GridQuantity", "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"tab1", "=", 
         RowBox[{"NdiffCompiled", "[", 
          RowBox[{
          "tablegrid1", ",", "GridQuantity", ",", "LengthPerVariable", ",", 
           RowBox[{"NpotTimes\[Chi]val", "*", "brvis"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"tab1", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", 
             RowBox[{"{", "1", "}"}]}], "]"}], "]"}], ",", 
          RowBox[{"Partition", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"tab1", "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", "2"}], "]"}], "]"}], "*", 
             SuperscriptBox["\[CapitalDelta]xval", 
              RowBox[{"-", "1"}]]}], ",", "1"}], "]"}], ",", "2"}], "]"}]}]}],
       "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"NeventsDifferentialDiscret", "[", 
      RowBox[{"m_", ",", "coupling_", ",", "BrhToSS_", ",", "Variable_"}], 
      "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "NdiffInt", ",", "LegendList", ",", "QuantityMinMax", ",", 
         "ValueMinMax"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"prodlisttemp", "=", 
         RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Do", "[", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Max", "[", 
              RowBox[{
               RowBox[{"mLLPmin", "[", "prod", "]"}], ",", "mmin\[Epsilon]"}],
               "]"}], "<", "m", "<", 
             RowBox[{"Min", "[", 
              RowBox[{
               RowBox[{"mLLPmax", "[", "prod", "]"}], ",", "mmax\[Epsilon]"}],
               "]"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"prodlisttemp", "=", 
              RowBox[{"Join", "[", 
               RowBox[{"prodlisttemp", ",", 
                RowBox[{"{", "prod", "}"}]}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"NdiffData", "[", "prod", "]"}], "=", 
              RowBox[{"NeventsDifferentialDiscretProd", "[", 
               RowBox[{
               "m", ",", "prod", ",", "coupling", ",", "BrhToSS", ",", 
                "Variable"}], "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"XvalminmaxNdiff", "=", 
              RowBox[{
               RowBox[{
                RowBox[{"Select", "[", 
                 RowBox[{
                  RowBox[{"NdiffData", "[", "prod", "]"}], ",", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ">", 
                    SuperscriptBox["10", 
                    RowBox[{"-", "40"}]]}], "&"}]}], "]"}], "[", 
                RowBox[{"[", 
                 RowBox[{"All", ",", "1"}], "]"}], "]"}], "//", "MinMax"}]}], 
             ";", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"NdiffInt", "[", 
               RowBox[{"X_", ",", "prod"}], "]"}], "=", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"XvalminmaxNdiff", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "<", "X", "<", 
                 RowBox[{"XvalminmaxNdiff", "[", 
                  RowBox[{"[", "2", "]"}], "]"}]}], ",", 
                RowBox[{"Evaluate", "[", 
                 RowBox[{"10", "^", 
                  RowBox[{
                   RowBox[{"Interpolation", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Log10", "[", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Log10", "[", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "+", 
                    SuperscriptBox["10", 
                    RowBox[{"-", "90"}]]}], "]"}]}], "}"}], "&"}], "/@", 
                    RowBox[{"NdiffData", "[", "prod", "]"}]}], ",", 
                    RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[", 
                   RowBox[{"Log10", "[", "X", "]"}], "]"}]}], "]"}], ",", 
                "0"}], "]"}]}]}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"prod", ",", "ProductionListBaseline"}], "}"}]}], "]"}], ";",
         "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"NdiffInt", "[", 
          RowBox[{"X_", ",", "\"\<Total\>\""}], "]"}], "=", 
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{"NdiffInt", "[", 
            RowBox[{"X", ",", "prod"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"prod", ",", "prodlisttemp"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"LegendList", "=", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"{", "\"\<Total\>\"", "}"}], ",", "prodlisttemp"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"QuantityMinMax", "=", 
         RowBox[{
          RowBox[{"Flatten", "[", 
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"MinMax", "[", 
               RowBox[{
                RowBox[{"NdiffData", "[", "prod", "]"}], "[", 
                RowBox[{"[", 
                 RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"prod", ",", "prodlisttemp"}], "}"}]}], "]"}], ",", 
            "1"}], "]"}], "//", "MinMax"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"ValueMinMax", "=", 
         RowBox[{"Max", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Max", "[", 
             RowBox[{
              RowBox[{"NdiffData", "[", "#", "]"}], "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}], "&"}], "/@", 
           "prodlisttemp"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"NdiffInt", "[", 
             RowBox[{"X", ",", "prod"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"prod", ",", "LegendList"}], "}"}]}], "]"}], ",", 
          "LegendList", ",", "QuantityMinMax", ",", "ValueMinMax"}], 
         "}"}]}]}], "\[IndentingNewLine]", "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"mvaltest", "=", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"FacilityGivenExperiment", "==", "\"\<ESS\>\""}], ",", "0.04", 
       ",", "1.8"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"couplingvaltest", "=", 
     RowBox[{"0.0001", 
      RowBox[{"UpperBoundEstimate", "[", 
       RowBox[{"mvaltest", ",", "\"\<B-mixing\>\""}], "]"}]}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"BrhToSStest", "=", "0.01"}], ";", "\[IndentingNewLine]", 
    RowBox[{"quantity", "=", "\"\<\!\(\*SubscriptBox[\(E\), \(X\)]\)\>\""}], ";",
     "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"NdiffTab", "[", "X_", "]"}], ",", "LegendList", ",", 
       "QuantityMinMax", ",", "ValueMinMax"}], "}"}], "=", 
     RowBox[{"NeventsDifferentialDiscret", "[", 
      RowBox[{
      "mvaltest", ",", "couplingvaltest", ",", "BrhToSStest", ",", 
       "quantity"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"Do", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"prch", "=", 
        RowBox[{"LegendList", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"NdiffInt", "[", 
         RowBox[{"X_", ",", "prch"}], "]"}], "=", 
        RowBox[{
         RowBox[{"NdiffTab", "[", "X", "]"}], "[", 
         RowBox[{"[", "i", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", 
        RowBox[{"Length", "[", "LegendList", "]"}]}], "}"}]}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"plotdiff", "=", 
     RowBox[{"LogLogPlot", "[", 
      RowBox[{
       RowBox[{"Evaluate", "[", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"NdiffInt", "[", 
           RowBox[{"X", ",", "prod"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"prod", ",", "LegendList"}], "}"}]}], "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"X", ",", 
         RowBox[{"QuantityMinMax", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", 
         RowBox[{"QuantityMinMax", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"Frame", "\[Rule]", "True"}], ",", 
       RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
       RowBox[{"PlotRange", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"All", ",", 
          RowBox[{"{", 
           RowBox[{
            SuperscriptBox["10", 
             RowBox[{"-", "5"}]], ",", 
            RowBox[{"2", "ValueMinMax"}]}], "}"}]}], "}"}]}], ",", 
       RowBox[{"PlotStyle", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"Thick", ",", "Black"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"Thick", ",", "Blue"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"Thick", ",", 
            RowBox[{"Darker", "@", "Red"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"Thick", ",", 
            RowBox[{"Darker", "@", 
             RowBox[{"Darker", "@", "Green"}]}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"Thick", ",", 
            RowBox[{"Darker", "@", "Cyan"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"Thick", ",", "Magenta"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"Thick", ",", "Blue", ",", 
            RowBox[{"Dashing", "[", "0.02", "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"Thick", ",", 
            RowBox[{"Darker", "@", "Red"}], ",", 
            RowBox[{"Dashing", "[", "0.02", "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"Thick", ",", 
            RowBox[{"Darker", "@", 
             RowBox[{"Darker", "@", "Green"}]}], ",", 
            RowBox[{"Dashing", "[", "0.02", "]"}]}], "}"}]}], "}"}]}], ",", 
       RowBox[{"PlotLegends", "\[Rule]", 
        RowBox[{"Placed", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Style", "[", 
             RowBox[{"#", ",", "20"}], "]"}], "&"}], "/@", "LegendList"}], ",",
           "Right"}], "]"}]}], ",", 
       RowBox[{"FrameLabel", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"LegendX", "[", "quantity", "]"}], " ", ",", 
          RowBox[{"LegendY", "[", "quantity", "]"}]}], "}"}]}], ",", 
       RowBox[{"FrameStyle", "\[Rule]", 
        RowBox[{"Directive", "[", 
         RowBox[{"Black", ",", " ", "18", ",", "Thick"}], "]"}]}], ",", 
       RowBox[{"PlotLabel", "\[Rule]", 
        RowBox[{"Style", "[", 
         RowBox[{
          RowBox[{"Row", "[", 
           RowBox[{"{", 
            RowBox[{
            "SelectedExperiment", 
             ",", "\"\<. \!\(\*SubscriptBox[\(m\), \(S\)]\) = \>\"", ",", 
             "mvaltest", 
             ",", "\"\< GeV, \!\(\*SuperscriptBox[\(\[Theta]\), \(2\)]\) = \>\
\"", ",", 
             RowBox[{"couplingvaltest", "//", "N"}], 
             ",", "\"\<, \!\(\*SubscriptBox[\(Br\), \(h -> SS\)]\) = \>\"", ",",
              "BrhToSStest"}], "}"}], "]"}], ",", "14", ",", "Black"}], 
         "]"}]}]}], "]"}]}]}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.8921163996135225`*^9, 3.8921164016036096`*^9}, {
   3.8921164560955544`*^9, 3.892116475031265*^9}, {3.892116516434699*^9, 
   3.8921165782759094`*^9}, {3.8921166461579666`*^9, 
   3.8921166470109124`*^9}, {3.8921167042134895`*^9, 3.892116729930051*^9}, {
   3.8927049818255663`*^9, 3.8927049991222277`*^9}, {3.8929115471019087`*^9, 
   3.892911593659387*^9}, {3.8929721720425777`*^9, 3.892972173350433*^9}, {
   3.8929722208773427`*^9, 3.8929722211847763`*^9}, {3.8932578131000147`*^9, 
   3.893257813645747*^9}, {3.8934746693595037`*^9, 3.893474675301323*^9}, {
   3.8935154039618015`*^9, 3.893515450284458*^9}, {3.893515943430369*^9, 
   3.893515962817915*^9}, 3.893516005738713*^9, {3.893516036174548*^9, 
   3.893516050479193*^9}, {3.893516088577403*^9, 3.893516089018369*^9}, {
   3.893516189974946*^9, 3.8935161902213464`*^9}, {3.8935162352543807`*^9, 
   3.8935162734266047`*^9}, {3.893516595793399*^9, 3.893516611219179*^9}, {
   3.893606026577932*^9, 3.8936060575609436`*^9}, 3.8955578364377675`*^9, {
   3.8969794021337876`*^9, 3.89697940417612*^9}, {3.897206579842867*^9, 
   3.897206594529684*^9}, {3.8972085445254173`*^9, 3.8972085493347607`*^9}, {
   3.897208919899889*^9, 3.897208931547951*^9}, {3.913104005959529*^9, 
   3.913104048903023*^9}, 3.9138255645899982`*^9, {3.9138256016430173`*^9, 
   3.9138256016868277`*^9}, {3.913827055766239*^9, 3.913827064730133*^9}, 
   3.913827973236159*^9, {3.9152983484341974`*^9, 3.915298348837672*^9}, {
   3.915301154289317*^9, 3.9153011682074223`*^9}, {3.915643095627222*^9, 
   3.915643095687714*^9}, {3.9166806407475595`*^9, 3.91668066859086*^9}, {
   3.9166807060180616`*^9, 3.9166807071750383`*^9}, {3.9168091851455655`*^9, 
   3.9168091858534904`*^9}, {3.9168092280266666`*^9, 3.916809288070582*^9}, {
   3.916810106366393*^9, 3.916810125681635*^9}, {3.9168102375606956`*^9, 
   3.9168102383449793`*^9}, 3.916855083149126*^9, {3.9169007110335836`*^9, 
   3.9169007375164433`*^9}, {3.916900788843048*^9, 3.916900797071533*^9}, {
   3.916900827619528*^9, 3.9169008501884117`*^9}, {3.9169009955356007`*^9, 
   3.9169010046470137`*^9}, {3.9169010485412765`*^9, 3.916901063963625*^9}, {
   3.9169012036324296`*^9, 3.9169012324016275`*^9}, {3.9169014189594216`*^9, 
   3.9169014190064774`*^9}, {3.916903261677492*^9, 3.9169032643992076`*^9}, {
   3.9345993585778084`*^9, 3.934599360833496*^9}, {3.9424810959633503`*^9, 
   3.9424811430463753`*^9}, {3.9506828046833096`*^9, 3.950682823221447*^9}, {
   3.953178629644224*^9, 3.95317866292688*^9}, 3.9531786980179367`*^9},
 CellTags->{
  "Number-of-events-computation+sensitivity", "Acceptance-computation"},
 CellLabel->
  "In[243]:=",ExpressionUUID->"527d8baf-1a2d-4dd5-9da1-2d533b666b85"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Tests", "Section",
 CellChangeTimes->{{3.8972012736109533`*^9, 3.897201275449023*^9}, {
  3.9166805246512303`*^9, 
  3.916680526511141*^9}},ExpressionUUID->"52dc766a-fc2d-4e27-b20c-\
a2032825a0cb"],

Cell[CellGroupData[{

Cell["Total number of events", "Subsection",
 CellChangeTimes->{{3.8972050850842867`*^9, 3.897205097581136*^9}, {
  3.905840218497635*^9, 3.9058402222864003`*^9}, {3.9166805398516865`*^9, 
  3.9166805427200794`*^9}},ExpressionUUID->"ad2977c7-d9f1-4c24-a632-\
a9cecee3df66"],

Cell[BoxData[
 RowBox[{"If", "[", 
  RowBox[{"condcontinue", ",", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "This", " ", "is", " ", "a", " ", "comparison", " ", "between", " ", 
      "the", " ", "slow", " ", "and", " ", "fast", " ", "integration", " ", 
      RowBox[{"methods", ".", " ", "For"}], " ", "the", " ", "selected", " ", 
      "mass", " ", "and", " ", "production", " ", "channel"}], ",", " ", 
     RowBox[{
     "the", " ", "numbers", " ", "of", " ", "events", " ", "obtained", " ", 
      "using", " ", "the", " ", "methods", " ", "should", " ", "agree", " ", 
      "within", " ", "10", "%"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"If", " ", "the", " ", "agreement", " ", "is", " ", "worse"}], ",",
      " ", 
     RowBox[{
     "there", " ", "may", " ", "be", " ", "a", " ", "few", " ", "reasons"}]}],
     "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"1", ")"}], " ", "The", " ", "grid", " ", "for", " ", "the", " ",
       "fast", " ", "method", " ", "is", " ", "not", " ", "dense", " ", 
      RowBox[{"enough", ".", " ", "Try"}], " ", "to", " ", "increase", " ", 
      "the", " ", "grid", " ", "density", " ", 
      RowBox[{"(", 
       RowBox[{
       "OutGrid\[Theta]final", ",", " ", "OutGridEfinal", ",", " ", 
        "OutGridzfinal"}], ")"}], " ", "to", " ", "see", " ", "whether", " ", 
      "the", " ", "agreement", " ", 
      RowBox[{"improves", ".", " ", "Sometimes"}]}], ",", " ", 
     RowBox[{
     "even", " ", "a", " ", "slightly", " ", "denser", " ", "grid", " ", 
      "for", " ", 
      RowBox[{"e", ".", "g", ".", " ", "z"}], " ", "may", " ", "lead", " ", 
      "to", " ", "a", " ", "significant", " ", "improvement", " ", "in", " ", 
      "the", " ", "agrement"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"2", ")"}], " ", "The", " ", "Monte"}], "-", 
       RowBox[{
       "Carlo", " ", "integrator", " ", "for", " ", "the", " ", "slow", " ", 
        "method", " ", "fails", " ", "to", " ", "evaluate", " ", 
        "properly"}]}], ";", " ", 
      RowBox[{
      "this", " ", "may", " ", "happen", " ", "if", " ", "the", " ", "range", 
       " ", "of", " ", "the", " ", "integration", " ", "over", " ", 
       "energies", " ", "is", " ", "too", " ", "large", " ", "compared", " ", 
       "to", " ", "the", " ", "domain", " ", "where", " ", "most", " ", "of", 
       " ", "the", " ", "events", " ", "actually", " ", "are", " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"off", "-", 
          RowBox[{
          "axis", " ", "experiments", " ", "such", " ", "as", " ", "MATHUSLA",
            " ", "and", " ", "ANUBIS"}]}], ")"}], ".", " ", "Another"}], " ", 
       "symptom", " ", "is", " ", "that", " ", "for", " ", "the", " ", 
       "given", " ", "mass", " ", "and", " ", "coupling", " ", "the", " ", 
       "integral", " ", "\"\<jumps\>\""}]}], ",", " ", 
     RowBox[{"i", ".", "e", "."}], ",", " ", 
     RowBox[{
     "returns", " ", "values", " ", "with", " ", "large", " ", "error"}]}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "A", " ", "separate", " ", "discussion", " ", "should", " ", "be", " ", 
      "made", " ", "for", " ", "the", " ", "couplings", " ", "belong", " ", 
      "to", " ", "the", " ", "domain", " ", "c\[Tau]", " ", "\[Gamma]", " ", 
      RowBox[{
       RowBox[{"<<", " ", 
        SubscriptBox["z", "experiment"]}], ".", " ", "The"}], " ", 
      "discrepancy", " ", "may", " ", "be", " ", "significant"}], ",", " ", 
     RowBox[{
     "and", " ", "the", " ", "reason", " ", "is", " ", "insufficient", " ", 
      "grid", " ", "density", " ", "for", " ", "the", " ", "fast", " ", 
      "integration", " ", 
      RowBox[{"method", ".", " ", "However"}]}], ",", " ", 
     RowBox[{
     "due", " ", "to", " ", "the", " ", "exponential", " ", "suppression", " ",
       "of", " ", "the", " ", "number", " ", "of", " ", "events"}], ",", " ", 
     RowBox[{
     "this", " ", "may", " ", "be", " ", "compensated", " ", "by", " ", "a", " ",
       "tiny", " ", "shift", " ", "in", " ", "the", " ", "coupling"}], ",", 
     " ", 
     RowBox[{
     "so", " ", "the", " ", "discrepancy", " ", "should", " ", "be", " ", 
      "considered", " ", "as", " ", 
      RowBox[{"appropriate", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"mtest", "=", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"MemberQ", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"\"\<LHC\>\"", ",", "\"\<FCC-hh\>\""}], "}"}], ",", 
          "FacilityGivenExperiment"}], "]"}], "==", "True"}], ",", "5", ",", 
       "0.5"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"ProdTest", "=", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"MemberQ", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"\"\<LHC\>\"", ",", "\"\<FCC-hh\>\""}], "}"}], ",", 
          "FacilityGivenExperiment"}], "]"}], "==", "True"}], 
       ",", "\"\<h-quartic\>\"", ",", "\"\<B-mixing\>\""}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"couplinglist", "=", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         SuperscriptBox["10", 
          RowBox[{"-", "12"}]], ",", 
         RowBox[{"3", "*", 
          SuperscriptBox["10", 
           RowBox[{"-", "12"}]]}], ",", 
         RowBox[{"5", "*", 
          SuperscriptBox["10", 
           RowBox[{"-", "12"}]]}], ",", 
         SuperscriptBox["10", 
          RowBox[{"-", "11"}]], ",", 
         RowBox[{"5", "*", 
          SuperscriptBox["10", 
           RowBox[{"-", "11"}]]}], ",", 
         SuperscriptBox["10", 
          RowBox[{"-", "10"}]], ",", 
         RowBox[{"5", "*", 
          SuperscriptBox["10", 
           RowBox[{"-", "10"}]]}], ",", 
         SuperscriptBox["10", 
          RowBox[{"-", "9"}]], ",", 
         RowBox[{"5", "*", 
          SuperscriptBox["10", 
           RowBox[{"-", "9"}]]}], ",", 
         SuperscriptBox["10", 
          RowBox[{"-", "8"}]], ",", 
         RowBox[{"2", "*", 
          SuperscriptBox["10", 
           RowBox[{"-", "8"}]]}], ",", 
         RowBox[{"4", "*", 
          SuperscriptBox["10", 
           RowBox[{"-", "8"}]]}], ",", 
         SuperscriptBox["10", 
          RowBox[{"-", "7"}]], ",", 
         RowBox[{"5", "*", 
          SuperscriptBox["10", 
           RowBox[{"-", "7"}]]}], ",", 
         RowBox[{"6", "*", 
          SuperscriptBox["10", 
           RowBox[{"-", "7"}]]}], ",", 
         RowBox[{"7", "*", 
          SuperscriptBox["10", 
           RowBox[{"-", "7"}]]}], ",", 
         RowBox[{"8", "*", 
          SuperscriptBox["10", 
           RowBox[{"-", "7"}]]}], ",", 
         RowBox[{"9", "*", 
          SuperscriptBox["10", 
           RowBox[{"-", "7"}]]}], ",", 
         SuperscriptBox["10", 
          RowBox[{"-", "6"}]], ",", 
         RowBox[{"2", "*", 
          SuperscriptBox["10", 
           RowBox[{"-", "6"}]]}]}], "}"}], "//", "N"}], "*)"}], 
     RowBox[{"Table", "[", 
      RowBox[{
       SuperscriptBox["10", "x"], ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", 
         RowBox[{"-", "17."}], ",", 
         RowBox[{"-", "3."}], ",", "0.3"}], "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"dat1", "=", 
     RowBox[{"NeventsDiscret", "[", 
      RowBox[{
      "mtest", ",", "ProdTest", ",", "BrhToSSreference", ",", 
       "couplinglist"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"dat2", "=", 
     RowBox[{"ParallelTable", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"couplinglist", "[", 
          RowBox[{"[", "i", "]"}], "]"}], ",", 
         RowBox[{"c\[Tau]LLP", "[", 
          RowBox[{"mtest", ",", 
           RowBox[{"couplinglist", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
         RowBox[{"Quiet", "[", 
          RowBox[{"NeventsInt", "[", 
           RowBox[{"mtest", ",", 
            RowBox[{"couplinglist", "[", 
             RowBox[{"[", "i", "]"}], "]"}], ",", "BrhToSSreference", ",", 
            "ProdTest"}], "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "couplinglist", "]"}], ",", "1"}], "}"}]}], 
      "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"\"\<\!\(\*FractionBox[SubscriptBox[\(m\), \(LLP\)], \
\(GeV\)]\)\>\"", ",", "\"\<coupling\>\"", 
          ",", "\"\<\!\(\*FractionBox[\(c\[Tau]\), SubscriptBox[\(z\), \
\(min\)]]\)\>\"", ",", "\"\<\!\(\*SubscriptBox[\(N\), \(events, fast\)]\)\>\"",
           ",", "\"\<\!\(\*SubscriptBox[\(N\), \(events, slow\)]\)\>\""}], 
         "}"}], "}"}], ",", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"dat1", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", "2"}], "}"}]}], "]"}], "]"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            FractionBox[
             RowBox[{"#", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "zminExp"], "}"}], "&"}], "/@", 
          "dat2"}], ",", 
         RowBox[{"dat1", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", 
            RowBox[{"{", "3", "}"}]}], "]"}], "]"}], ",", 
         RowBox[{"dat2", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", 
            RowBox[{"{", "3", "}"}]}], "]"}], "]"}], ",", "2"}], "]"}]}], 
      "]"}], "//", "TableForm"}]}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.892111330393669*^9, 3.8921113703258653`*^9}, {
   3.8921114855521097`*^9, 3.8921114891326914`*^9}, {3.8921115909252915`*^9, 
   3.89211160107533*^9}, {3.892112023350475*^9, 3.8921120715940514`*^9}, {
   3.8921121043874707`*^9, 3.892112190091645*^9}, {3.892112748834139*^9, 
   3.892112748933666*^9}, {3.8921130465455704`*^9, 3.8921130470314426`*^9}, {
   3.8921131989548674`*^9, 3.8921131992395306`*^9}, {3.892113256325259*^9, 
   3.892113256434625*^9}, {3.892113458241603*^9, 3.8921135323303742`*^9}, {
   3.892116361437076*^9, 3.8921163614848557`*^9}, {3.893257780692194*^9, 
   3.893257792940939*^9}, {3.893260545232792*^9, 3.893260566765787*^9}, {
   3.896953530728937*^9, 3.896953531233162*^9}, {3.896953744363188*^9, 
   3.8969537469343243`*^9}, {3.896953883310589*^9, 3.896953884008139*^9}, {
   3.896971240286153*^9, 3.896971246695673*^9}, {3.8969733757056828`*^9, 
   3.896973378633896*^9}, {3.8969760731711082`*^9, 3.896976348233163*^9}, {
   3.8969763786206193`*^9, 3.896976403680397*^9}, {3.8969764343671703`*^9, 
   3.8969764672032614`*^9}, 3.8972088334478965`*^9, {3.897583304212637*^9, 
   3.8975833265755286`*^9}, {3.897583585283407*^9, 3.897583587625018*^9}, {
   3.8989321141823177`*^9, 3.898932145124889*^9}, {3.9054012126778092`*^9, 
   3.905401239605732*^9}, 3.9138255645174475`*^9, {3.913827965719379*^9, 
   3.9138279732248883`*^9}, {3.914497193077972*^9, 3.914497204542885*^9}, 
   3.914515168090207*^9, {3.915643095539144*^9, 3.9156430955421357`*^9}, {
   3.9168281552106133`*^9, 3.916828171190316*^9}, {3.916828261251734*^9, 
   3.9168282621261525`*^9}, {3.916900655299384*^9, 3.916900657838563*^9}, {
   3.950682789025797*^9, 
   3.9506827959650383`*^9}},ExpressionUUID->"99324d6c-b056-41ec-976e-\
e102b4b6081c"]
}, Closed]]
}, Closed]]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Exporting tabulated number of events", "Title",
 CellChangeTimes->{{3.8850207904521627`*^9, 3.885020796464762*^9}},
 CellTags->
  "Number-of-events-computation+sensitivity",ExpressionUUID->"f5136f97-573d-\
41ec-bafe-cbcb903e581e"],

Cell[CellGroupData[{

Cell["Definitions", "Chapter",
 CellChangeTimes->{{3.8850542017641125`*^9, 3.885054203349573*^9}},
 CellTags->
  "Number-of-events-computation+sensitivity",ExpressionUUID->"75cf786b-3cae-\
4471-be7d-a8f2b6c6b657"],

Cell[BoxData[
 RowBox[{"If", "[", 
  RowBox[{"condcontinue", ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"directory", "[", "\"\<Nevents\>\"", "]"}], "=", 
     RowBox[{"FileNameJoin", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"NotebookDirectory", "[", "]"}], 
        ",", "\"\<Tabulated Nevents\>\""}], "}"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"directory", "[", "\"\<Nevents-LLP\>\"", "]"}], "=", 
     RowBox[{"FileNameJoin", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"NotebookDirectory", "[", "]"}], 
        ",", "\"\<Tabulated Nevents\>\"", ",", "LLPdirName"}], "}"}], "]"}]}],
     ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"directory", "[", "\"\<Nevents-LLP-experiment\>\"", "]"}], "=", 
     RowBox[{"FileNameJoin", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"NotebookDirectory", "[", "]"}], 
        ",", "\"\<Tabulated Nevents\>\"", ",", "LLPdirName", ",", 
        "SelectedExperiment"}], "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"!", 
         RowBox[{"DirectoryQ", "[", 
          RowBox[{"directory", "[", "#", "]"}], "]"}]}], ",", 
        RowBox[{"CreateDirectory", "[", 
         RowBox[{"directory", "[", "#", "]"}], "]"}]}], "]"}], "&"}], "/@", 
     RowBox[{"{", 
      RowBox[{"\"\<Nevents\>\"", ",", "\"\<Nevents-LLP\>\"", 
       ",", "\"\<Nevents-LLP-experiment\>\""}], "}"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
    "Print", "[", "\"\<Filenames with tabulated \!\(\*SubscriptBox[\(N\), \
\(events\)]\):\>\"", "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"Do", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"FilenameNeventsInt", "[", "prod", "]"}], "=", 
       RowBox[{"ToString", "@", 
        RowBox[{"StringForm", "[", 
         RowBox[{"\"\<Nevents_``_``_at_``_Npot=``_decayDescr=``.dat\>\"", ",", 
          RowBox[{"Sequence", "@@", 
           RowBox[{"{", 
            RowBox[{"LLPdirName", ",", "prod", ",", "SelectedExperiment", ",", 
             RowBox[{
              RowBox[{"NpotGivenExperiment", "//", "CForm"}], "//", 
              "ToString"}], ",", "SelectedDescr"}], "}"}]}]}], "]"}]}]}], 
      "\[IndentingNewLine]", ",", 
      RowBox[{"{", 
       RowBox[{"prod", ",", "ProductionList"}], "}"}]}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"mRangeExport", "[", "brem", "]"}], "=", 
        RowBox[{"{", 
         RowBox[{
         "0.021", ",", "0.031", ",", "0.041", ",", "0.051", ",", "0.06", ",", 
          "0.07", ",", "0.08", ",", "0.09", ",", "0.1", ",", "0.13", ",", 
          "0.15", ",", "0.2", ",", "0.205", ",", "0.21", ",", "0.212", ",", 
          "0.214", ",", "0.216", ",", "0.218", ",", "0.22", ",", "0.225", ",",
           "0.23", ",", "0.24", ",", "0.25", ",", "0.26", ",", "0.27", ",", 
          "0.275", ",", "0.28", ",", "0.285", ",", "0.289", ",", "0.3", ",", 
          "0.32", ",", "0.35", ",", "0.4", ",", "0.45", ",", "0.5", ",", 
          "0.6", ",", "0.7", ",", "0.8", ",", "0.85", ",", "0.9", ",", "0.95",
           ",", "0.99", ",", "1.", ",", "1.01", ",", "1.02", ",", "1.025", ",",
           "1.03", ",", "1.05", ",", "1.1", ",", "1.2", ",", "1.3", ",", 
          "1.4", ",", "1.5", ",", "1.6", ",", "1.7", ",", "1.8", ",", "1.9", ",",
           "1.99", ",", "2.1", ",", "2.2", ",", "2.3", ",", "2.4", ",", 
          "2.5"}], "}"}]}], ";"}], "\[IndentingNewLine]", ",", 
      RowBox[{"{", 
       RowBox[{"brem", ",", "BremVariantsGivenFacility"}], "}"}]}], "]"}], ";",
     "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"mRangeExport", "[", "\"\<K-mixing\>\"", "]"}], "=", 
     RowBox[{"{", 
      RowBox[{
      "0.021", ",", "0.051", ",", "0.1", ",", "0.13", ",", "0.15", ",", "0.2",
        ",", "0.205", ",", "0.21", ",", "0.212", ",", "0.214", ",", "0.216", ",",
        "0.218", ",", "0.22", ",", "0.23", ",", "0.24", ",", "0.25", ",", 
       "0.26", ",", "0.27", ",", "0.275", ",", "0.28", ",", "0.285", ",", 
       "0.289", ",", "0.3", ",", "0.32", ",", "0.35", ",", 
       RowBox[{"0.995", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"mSM", "[", "\"\<Kcharged\>\"", "]"}], "-", 
          RowBox[{"mSM", "[", "\"\<PiCharged\>\"", "]"}]}], ")"}]}]}], 
      "}"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"mRangeExport", "[", "\"\<B-quartic\>\"", "]"}], "=", 
     RowBox[{"{", 
      RowBox[{
      "0.021", ",", "0.051", ",", "0.1", ",", "0.13", ",", "0.15", ",", "0.2",
        ",", "0.205", ",", "0.21", ",", "0.212", ",", "0.214", ",", "0.216", ",",
        "0.218", ",", "0.22", ",", "0.23", ",", "0.24", ",", "0.25", ",", 
       "0.26", ",", "0.27", ",", "0.275", ",", "0.28", ",", "0.285", ",", 
       "0.289", ",", "0.3", ",", "0.32", ",", "0.35", ",", "0.4", ",", "0.45",
        ",", "0.5", ",", "0.55", ",", "0.6", ",", "0.65", ",", "0.7", ",", 
       "0.8", ",", "0.85", ",", "0.9", ",", "0.95", ",", "0.99", ",", "1.02", 
       ",", "1.05", ",", "1.1", ",", "1.2", ",", "1.3", ",", "1.4", ",", 
       "1.5", ",", "1.6", ",", "1.7", ",", "1.8", ",", "1.9", ",", "1.99", ",",
        "2.05", ",", "2.1", ",", "2.2", ",", "2.3", ",", "2.4", ",", "2.45", ",",
        "2.5", ",", "2.55"}], "}"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"mRangeExport", "[", "\"\<B-mixing\>\"", "]"}], "=", 
     RowBox[{"{", 
      RowBox[{
      "0.021", ",", "0.051", ",", "0.1", ",", "0.13", ",", "0.15", ",", 
       "0.17", ",", "0.2", ",", "0.205", ",", "0.21", ",", "0.212", ",", 
       "0.214", ",", "0.216", ",", "0.218", ",", "0.22", ",", "0.23", ",", 
       "0.24", ",", "0.25", ",", "0.26", ",", "0.27", ",", "0.275", ",", 
       "0.28", ",", "0.285", ",", "0.289", ",", "0.3", ",", "0.32", ",", 
       "0.35", ",", "0.4", ",", "0.45", ",", "0.5", ",", "0.55", ",", "0.6", ",",
        "0.65", ",", "0.7", ",", "0.8", ",", "0.85", ",", "0.9", ",", "0.95", 
       ",", "0.99", ",", "1.02", ",", "1.05", ",", "1.1", ",", "1.2", ",", 
       "1.3", ",", "1.4", ",", "1.5", ",", "1.6", ",", "1.7", ",", "1.8", ",",
        "1.9", ",", "1.99", ",", "2.1", ",", "2.3", ",", "2.4", ",", "2.5", ",",
        "2.6", ",", "2.7", ",", "2.8", ",", "2.9", ",", "3", ",", "3.1", ",", 
       "3.2", ",", "3.3", ",", "3.5", ",", "3.6", ",", "3.7", ",", "3.8", ",",
        "3.9", ",", "4", ",", "4.1", ",", "4.2", ",", "4.3", ",", "4.4", ",", 
       "4.5", ",", "4.6", ",", "4.65", ",", "4.7", ",", "4.75", ",", "4.77", ",",
        "4.8", ",", "4.83", ",", "4.85", ",", "4.87", ",", "4.9", ",", "4.93",
        ",", "4.95", ",", "4.97", ",", "5", ",", "5.03", ",", "5.05", ",", 
       "5.07", ",", "5.1"}], "}"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"mRangeExport", "[", "\"\<Bs-quartic\>\"", "]"}], "=", 
     RowBox[{"{", 
      RowBox[{
      "0.021", ",", "0.051", ",", "0.1", ",", "0.13", ",", "0.15", ",", 
       "0.17", ",", "0.2", ",", "0.205", ",", "0.21", ",", "0.212", ",", 
       "0.214", ",", "0.216", ",", "0.218", ",", "0.22", ",", "0.23", ",", 
       "0.25", ",", "0.26", ",", "0.275", ",", "0.28", ",", "0.285", ",", 
       "0.289", ",", "0.3", ",", "0.32", ",", "0.35", ",", "0.5", ",", "0.55",
        ",", "0.6", ",", "0.65", ",", "0.7", ",", "0.8", ",", "0.85", ",", 
       "0.9", ",", "0.95", ",", "0.99", ",", "1.02", ",", "1.05", ",", "1.1", 
       ",", "1.2", ",", "1.3", ",", "1.4", ",", "1.5", ",", "1.6", ",", "1.7",
        ",", "1.8", ",", "1.9", ",", "1.99", ",", "2.05", ",", "2.1", ",", 
       "2.2", ",", "2.3", ",", "2.4", ",", "2.45", ",", "2.5", ",", "2.55", ",",
        "2.57", ",", "2.59", ",", "2.6", ",", "2.62", ",", "2.65"}], "}"}]}], 
    ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"mRangeExport", "[", "\"\<Upsilon-mixing\>\"", "]"}], "=", 
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"mRangeExport", "[", "\"\<B-mixing\>\"", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{
        "5.3", ",", "5.6", ",", "5.9", ",", "6.5", ",", "6.7", ",", "7.2", ",",
          "7.5", ",", "8", ",", "8.5", ",", "9.", ",", "9.4"}], "}"}]}], 
      "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"mRangeExport", "[", "\"\<Upsilon-quartic\>\"", "]"}], "=", 
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"Select", "[", 
        RowBox[{
         RowBox[{"mRangeExport", "[", "\"\<B-mixing\>\"", "]"}], ",", 
         RowBox[{
          RowBox[{"#", "<", 
           FractionBox[
            RowBox[{"mSM", "[", "\"\<Upsilon\>\"", "]"}], "2"]}], "&"}]}], 
        "]"}], ",", 
       RowBox[{"{", 
        FractionBox[
         RowBox[{"mSM", "[", "\"\<Upsilon\>\"", "]"}], "2"], "}"}]}], "]"}]}],
     ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"mRangeExport", "[", "\"\<h-quartic\>\"", "]"}], "=", 
     RowBox[{"{", 
      RowBox[{
      "0.021", ",", "0.051", ",", "0.1", ",", "0.13", ",", "0.15", ",", 
       "0.17", ",", "0.2", ",", "0.205", ",", "0.21", ",", "0.212", ",", 
       "0.214", ",", "0.216", ",", "0.218", ",", "0.22", ",", "0.23", ",", 
       "0.24", ",", "0.25", ",", "0.26", ",", "0.27", ",", "0.275", ",", 
       "0.28", ",", "0.285", ",", "0.289", ",", "0.3", ",", "0.32", ",", 
       "0.35", ",", "0.4", ",", "0.45", ",", "0.5", ",", "0.55", ",", "0.6", ",",
        "0.65", ",", "0.7", ",", "0.8", ",", "0.85", ",", "0.9", ",", "0.95", 
       ",", "0.99", ",", "1.02", ",", "1.05", ",", "1.1", ",", "1.2", ",", 
       "1.3", ",", "1.4", ",", "1.5", ",", "1.6", ",", "1.7", ",", "1.8", ",",
        "1.9", ",", "1.99", ",", "2.1", ",", "2.3", ",", "2.4", ",", "2.5", ",",
        "2.6", ",", "2.7", ",", "2.8", ",", "2.9", ",", "3", ",", "3.2", ",", 
       "3.3", ",", "3.4", ",", "3.5", ",", "3.6", ",", "3.7", ",", "3.8", ",",
        "3.9", ",", "4", ",", "4.1", ",", "4.2", ",", "4.3", ",", "4.4", ",", 
       "4.5", ",", "4.6", ",", "4.7", ",", "4.8", ",", "4.9", ",", "5", ",", 
       "5.1", ",", "7.", ",", "10.", ",", "10.6", ",", "12.", ",", "15.", ",",
        "20.", ",", "30.", ",", "40.", ",", "45.", ",", "50.", ",", "55.", ",",
        "60.", ",", "61.", ",", "62.", ",", "62.49"}], "}"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"couplingsRangeExport", "=", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        SuperscriptBox["10", "x"], ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", 
          RowBox[{"-", "20"}], ",", 
          RowBox[{"-", "3"}], ",", "0.02"}], "}"}]}], "]"}], "//", "N"}]}], ";",
     "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"FilenameNeventsInt", "[", "#", "]"}], "&"}], "/@", 
     "ProductionList"}]}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.8850528402073092`*^9, 3.885052964529935*^9}, {
   3.8850529967024455`*^9, 3.88505313318991*^9}, {3.885053172661522*^9, 
   3.885053247354876*^9}, {3.885053717249408*^9, 3.8850537696983976`*^9}, {
   3.885054057416253*^9, 3.88505420740788*^9}, {3.8850542428480587`*^9, 
   3.885054257815028*^9}, {3.885054905514982*^9, 3.885054927992525*^9}, {
   3.88523276755499*^9, 3.885232776819412*^9}, {3.8854556204578223`*^9, 
   3.8854556494874506`*^9}, {3.8854560165278835`*^9, 
   3.8854561921232824`*^9}, {3.8854563516684437`*^9, 
   3.8854563631681647`*^9}, {3.885456439233843*^9, 3.885456605782855*^9}, {
   3.8854567400235205`*^9, 3.885456743964001*^9}, {3.885542660052145*^9, 
   3.8855427304549437`*^9}, {3.8855427881537523`*^9, 3.885542788237467*^9}, {
   3.8855430067620525`*^9, 3.885543013668437*^9}, {3.8881630076234455`*^9, 
   3.8881630744266977`*^9}, {3.8883379248463793`*^9, 
   3.8883379411051774`*^9}, {3.8886382868866987`*^9, 
   3.8886382868866987`*^9}, {3.8886383965066085`*^9, 3.888638435922658*^9}, {
   3.888638717573883*^9, 3.88863872454897*^9}, {3.888638852720187*^9, 
   3.8886388699435844`*^9}, {3.8896724748252106`*^9, 3.889672493479089*^9}, {
   3.8902857190120797`*^9, 3.8902857239010572`*^9}, {3.8908188918117857`*^9, 
   3.890818892549032*^9}, {3.892540910150075*^9, 3.892540970863888*^9}, {
   3.892541004577793*^9, 3.892541067434718*^9}, {3.892542466634867*^9, 
   3.892542498340646*^9}, {3.892911078820797*^9, 3.89291109374372*^9}, {
   3.8939522019177513`*^9, 3.893952258965907*^9}, {3.8939563571944876`*^9, 
   3.893956359715938*^9}, {3.8939564245990934`*^9, 3.893956425278*^9}, {
   3.8950547515339336`*^9, 3.8950547715752497`*^9}, {3.895080280010561*^9, 
   3.895080387472927*^9}, {3.895129880597265*^9, 3.895130003200553*^9}, {
   3.895130043198387*^9, 3.8951300875191574`*^9}, {3.895655873976679*^9, 
   3.8956558783203697`*^9}, {3.9048410895476885`*^9, 
   3.9048411233717313`*^9}, {3.9048411709782667`*^9, 3.904841180680478*^9}, {
   3.9048453387529244`*^9, 3.90484537208286*^9}, {3.9072316334231806`*^9, 
   3.9072316545714455`*^9}, {3.9072317085386596`*^9, 
   3.9072317120761614`*^9}, {3.913827965734951*^9, 3.913827991055028*^9}, {
   3.9138284220292525`*^9, 3.913828460746703*^9}, {3.9138285058070326`*^9, 
   3.9138285972058964`*^9}, {3.913829635239067*^9, 3.9138296573348017`*^9}, {
   3.91382969222601*^9, 3.913829700474972*^9}, {3.913829791221055*^9, 
   3.913829791521369*^9}, {3.9138301337916565`*^9, 3.9138301384620132`*^9}, {
   3.9139670072622137`*^9, 3.9139670244155393`*^9}, {3.913968409883515*^9, 
   3.9139684272016406`*^9}, {3.914515168102391*^9, 3.9145151681077166`*^9}, {
   3.915296482078373*^9, 3.9152965143305044`*^9}, {3.915296768334002*^9, 
   3.9152968286988506`*^9}, {3.9152970046802025`*^9, 
   3.9152970618951845`*^9}, {3.915643095947811*^9, 3.9156430959731874`*^9}, {
   3.920018857323472*^9, 3.9200188814344645`*^9}, 3.9325312303863707`*^9, {
   3.934599385674898*^9, 3.9345993949352713`*^9}, {3.934601613870949*^9, 
   3.9346016309947033`*^9}, {3.934602450079648*^9, 3.9346024588430786`*^9}, {
   3.9476513805933704`*^9, 3.94765139681221*^9}, {3.9500673920215664`*^9, 
   3.950067418888529*^9}, {3.9506828326794186`*^9, 3.950682848609688*^9}, {
   3.9511531111188126`*^9, 3.951153116349291*^9}, {3.95115414462566*^9, 
   3.951154233274868*^9}, {3.9511554734929543`*^9, 3.951155473968052*^9}},
 CellTags->"Number-of-events-computation+sensitivity",
 CellLabel->
  "In[244]:=",ExpressionUUID->"7723a626-82c5-4cfa-9029-8486e71b92ea"]
}, Closed]],

Cell[CellGroupData[{

Cell["Exporting", "Chapter",
 CellChangeTimes->{{3.885054212114191*^9, 3.885054213032151*^9}},
 CellTags->
  "Number-of-events-computation+sensitivity",ExpressionUUID->"e9258198-581c-\
4466-81fa-c2dce211dd65"],

Cell[BoxData[
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{"condcontinue", ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"DeleteFile", "[", 
      RowBox[{"FileNames", "[", 
       RowBox[{
        RowBox[{"\"\<*\>\"", "<>", "SelectedDescr", "<>", "\"\<*\>\""}], ",", 
        RowBox[{"directory", "[", "\"\<Nevents-LLP-experiment\>\"", "]"}]}], 
       "]"}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"BlockExport", "[", "ProdChannel_", "]"}], ":=", 
      RowBox[{"Block", "[", 
       RowBox[{
        RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"mlist", "=", 
          RowBox[{"mRangeExport", "[", "ProdChannel", "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"TabFrom", "=", 
          RowBox[{"ParallelTable", "[", 
           RowBox[{
            RowBox[{"Quiet", "[", 
             RowBox[{"NeventsDiscret", "[", 
              RowBox[{
               RowBox[{"mlist", "[", 
                RowBox[{"[", "k", "]"}], "]"}], ",", "ProdChannel", ",", 
               "BrhToSSreference", ",", "couplingsRangeExport"}], "]"}], 
             "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"k", ",", "1", ",", 
              RowBox[{"Length", "[", "mlist", "]"}], ",", "1"}], "}"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"Export", "[", 
          RowBox[{
           RowBox[{"FileNameJoin", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
              "directory", "[", "\"\<Nevents-LLP-experiment\>\"", "]"}], ",", 
              RowBox[{"FilenameNeventsInt", "[", "ProdChannel", "]"}]}], 
             "}"}], "]"}], ",", 
           RowBox[{"Flatten", "[", 
            RowBox[{"TabFrom", ",", "1"}], "]"}], ",", "\"\<Table\>\""}], 
          "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Monitor", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"prod", "=", 
           RowBox[{"ProductionList", "[", 
            RowBox[{"[", "j", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"BlockExport", "[", "prod", "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", 
           RowBox[{"Length", "[", "ProductionList", "]"}], ",", "1"}], 
          "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Row", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"ProgressIndicator", "[", 
           RowBox[{"j", ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", 
              RowBox[{"Length", "[", "ProductionList", "]"}]}], "}"}]}], 
           "]"}], ",", "\"\< Production mode = \>\"", ",", 
          RowBox[{"ProductionList", "[", 
           RowBox[{"[", "j", "]"}], "]"}], ",", "\"\< (\>\"", ",", " ", "j", 
          ",", "\"\</\>\"", ",", 
          RowBox[{"Length", "[", "ProductionList", "]"}], ",", "\"\<)\>\""}], 
         "}"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"icounter", ">", 
         RowBox[{"Length", "[", "SelectedExperimentList", "]"}]}], "&&", 
        "sensComp"}], ",", 
       RowBox[{"BlockEvaluation", "[", "\"\<Sensitivity\>\"", "]"}]}], 
      "]"}]}]}], "\[IndentingNewLine]", "]"}], "//", 
  "AbsoluteTiming"}]], "Input",
 CellChangeTimes->{{3.8921886102299604`*^9, 3.892188661864987*^9}, {
   3.892188696661598*^9, 3.892188782889353*^9}, {3.8921888713769283`*^9, 
   3.8921888914281387`*^9}, {3.892190937661848*^9, 3.8921909466626697`*^9}, {
   3.8922765048644934`*^9, 3.8922765048725324`*^9}, {3.892541051864915*^9, 
   3.8925411081031237`*^9}, {3.8925422299627275`*^9, 
   3.8925422591259813`*^9}, {3.892542627960807*^9, 3.8925426356350746`*^9}, {
   3.8939562182259045`*^9, 3.8939562188380885`*^9}, {3.89412815552805*^9, 
   3.8941281747081137`*^9}, {3.9138286279115973`*^9, 
   3.9138286418143325`*^9}, {3.9138287941559043`*^9, 
   3.9138287959947634`*^9}, {3.913829639378659*^9, 3.9138296411758256`*^9}, {
   3.913829692038907*^9, 3.913829700304104*^9}, 3.9138298066238384`*^9, {
   3.9138298509061875`*^9, 3.9138298530705376`*^9}, 3.914515168114275*^9, {
   3.9146683977976885`*^9, 3.9146683979700813`*^9}, 3.915643095985222*^9, {
   3.9476517510971203`*^9, 3.947651751620762*^9}, {3.950682881653612*^9, 
   3.95068289468009*^9}, {3.9526986274613724`*^9, 3.952698630924612*^9}, 
   3.952698692795559*^9},
 CellTags->"Number-of-events-computation+sensitivity",
 CellLabel->
  "In[245]:=",ExpressionUUID->"4373bb38-5ade-4168-a342-6cca5c2ca723"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Computing sensitivities", "Title",
 CellChangeTimes->{{3.885020809493571*^9, 3.88502081261261*^9}},
 CellTags->
  "Sensitivity",ExpressionUUID->"2ce189e8-ece2-4e74-afba-65f86fa4e6b1"],

Cell[CellGroupData[{

Cell["Basic definitions", "Chapter",
 CellChangeTimes->{{3.9138314745388813`*^9, 3.913831477098402*^9}},
 CellTags->
  "Sensitivity",ExpressionUUID->"46d55711-0db4-45a7-9164-17597ab946db"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"BrhToSSreference", "=", "0.15"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"massLabel", ",", "couplingLabel"}], "}"}], "=", 
   RowBox[{"{", 
    RowBox[{"\"\<\!\(\*SubscriptBox[\(m\), \(S\)]\) [GeV]\>\"", 
     ",", "\"\<\!\(\*SuperscriptBox[\(\[Theta]\), \(2\)]\)\>\""}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"LLPdirName", "=", "\"\<Scalar\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"directory", "[", "\"\<Sensitivity\>\"", "]"}], "=", 
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"NotebookDirectory", "[", "]"}], 
      ",", "\"\<Sensitivity domains\>\""}], "}"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"directory", "[", "\"\<Sensitivity-LLP\>\"", "]"}], "=", 
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"directory", "[", "\"\<Sensitivity\>\"", "]"}], ",", 
      "LLPdirName"}], "}"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"!", 
       RowBox[{"DirectoryQ", "[", 
        RowBox[{"directory", "[", "#", "]"}], "]"}]}], ",", 
      RowBox[{"CreateDirectory", "[", 
       RowBox[{"directory", "[", "#", "]"}], "]"}]}], "]"}], "&"}], "/@", 
   RowBox[{"{", 
    RowBox[{"\"\<Sensitivity\>\"", ",", "\"\<Sensitivity-LLP\>\""}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"directory", "[", "\"\<Nevents-LLP\>\"", "]"}], "=", 
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"NotebookDirectory", "[", "]"}], 
      ",", "\"\<Tabulated Nevents\>\"", ",", "LLPdirName"}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dropdownDialog", "[", 
   RowBox[{"list_", ",", "phrase_"}], "]"}], ":=", 
  RowBox[{"DialogInput", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"choice", "=", "\"\<\>\""}], "}"}], ",", 
    RowBox[{"Column", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"TextCell", "[", "phrase", "]"}], ",", 
       RowBox[{"PopupMenu", "[", 
        RowBox[{
         RowBox[{"Dynamic", "[", "choice", "]"}], ",", "list"}], "]"}], ",", 
       RowBox[{"Button", "[", 
        RowBox[{"\"\<OK\>\"", ",", 
         RowBox[{"DialogReturn", "[", "choice", "]"}]}], "]"}]}], "}"}], 
     "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"infoDialog", "[", "phrase_", "]"}], ":=", 
  RowBox[{"DialogInput", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"choice", "=", "\"\<\>\""}], "}"}], ",", 
    RowBox[{"Column", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"TextCell", "[", "phrase", "]"}], ",", 
       RowBox[{"Button", "[", 
        RowBox[{"\"\<Proceed\>\"", ",", 
         RowBox[{"DialogReturn", "[", "choice", "]"}]}], "]"}]}], "}"}], 
     "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"selectionDialog", "[", 
   RowBox[{"list_", ",", "phrase_"}], "]"}], ":=", 
  RowBox[{"DialogInput", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"choice", "=", 
      RowBox[{"{", "}"}]}], "}"}], ",", 
    RowBox[{"Column", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Row", "[", 
        RowBox[{"{", "phrase", "}"}], "]"}], ",", 
       RowBox[{"Pane", "[", 
        RowBox[{
         RowBox[{"TogglerBar", "[", 
          RowBox[{
           RowBox[{"Dynamic", "[", "choice", "]"}], ",", "list", ",", 
           RowBox[{"Appearance", "->", 
            RowBox[{"\"\<Vertical\>\"", "->", 
             RowBox[{"{", 
              RowBox[{"Automatic", ",", "5"}], "}"}]}]}]}], "]"}], ",", 
         RowBox[{"ImageSize", "->", 
          RowBox[{"{", 
           RowBox[{"Automatic", ",", "Automatic"}], "}"}]}], ",", 
         RowBox[{"Scrollbars", "->", 
          RowBox[{"{", 
           RowBox[{"False", ",", "True"}], "}"}]}]}], "]"}], ",", 
       RowBox[{"Button", "[", 
        RowBox[{"\"\<OK\>\"", ",", 
         RowBox[{"DialogReturn", "[", "choice", "]"}]}], "]"}]}], "}"}], 
     "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ExperimentDirectoriesListNevents", "=", 
   RowBox[{"Select", "[", 
    RowBox[{
     RowBox[{"FileNames", "[", 
      RowBox[{"\"\<*\>\"", ",", 
       RowBox[{"directory", "[", "\"\<Nevents-LLP\>\"", "]"}], ",", "1"}], 
      "]"}], ",", "DirectoryQ"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"\"\<List of available experiments with tabulated \
\!\(\*SubscriptBox[\(N\), \(events\)]\) for \>\"", " ", "<>", "LLPdirName", 
   "<>", "\"\<:\>\""}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ExperimentsListNevents", "=", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"FileNameTake", "[", 
       RowBox[{
        RowBox[{"ExperimentDirectoriesListNevents", "[", 
         RowBox[{"[", "i", "]"}], "]"}], ",", 
        RowBox[{"-", "1"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", 
        RowBox[{"Length", "[", "ExperimentDirectoriesListNevents", "]"}], ",",
         "1"}], "}"}]}], "]"}], "//", "Sort"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"ExperimentsListNevents", "//", "TableForm"}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Length", "[", "ExperimentsListNevents", "]"}], "\[Equal]", "0"}],
    ",", "\[IndentingNewLine]", 
   RowBox[{
   "infoDialog", 
    "[", "\"\<No experiment is available, generate first the acceptance for \
the given experiment using module 1\>\"", "]"}], "\[IndentingNewLine]", ",", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ifUncCalc", "=", 
     RowBox[{"dropdownDialog", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"True", ",", "False"}], "}"}], 
       ",", "\"\<Calculate uncertainties of the sensitivity region?\>\""}], 
      "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"SelectedExperimentList", "=", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "ExperimentsListNevents", "]"}], "\[NotEqual]",
         "0"}], ",", 
       RowBox[{"selectionDialog", "[", 
        RowBox[{
        "ExperimentsListNevents", 
         ",", "\"\<Select the experiments for which the sensitivity will be \
computed:\>\""}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"icounter", "=", "1"}], ";"}], "\[IndentingNewLine]", ",", 
   "\[IndentingNewLine]", 
   RowBox[{"SelectedExperimentList", "=", 
    RowBox[{"{", "}"}]}]}], "\[IndentingNewLine]", 
  "]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.9138315400875525`*^9, 3.91383154039198*^9}, {
   3.913966069474681*^9, 3.913966069673868*^9}, 3.9146683543392105`*^9, 
   3.915262558652212*^9, {3.9156430959978886`*^9, 3.915643096024549*^9}, {
   3.9168195810010157`*^9, 3.9168195820108824`*^9}, {3.9346024751554394`*^9, 
   3.9346024759100647`*^9}, {3.9476527223734665`*^9, 3.947652725454481*^9}, {
   3.9476603157696*^9, 3.9476603168147526`*^9}, {3.9511530295932674`*^9, 
   3.951153032112335*^9}, {3.9511538518096046`*^9, 3.95115385324078*^9}, 
   3.9516664296422043`*^9, {3.9526130092047634`*^9, 3.9526130111249638`*^9}, {
   3.9526130463103695`*^9, 3.9526130478715687`*^9}, {3.9526131150327606`*^9, 
   3.9526131181432304`*^9}, {3.952615586032543*^9, 3.9526155876312428`*^9}, {
   3.952670985549473*^9, 3.9526709906097813`*^9}, {3.952695649675068*^9, 
   3.952695651446148*^9}, {3.9527374793647785`*^9, 3.9527375016800423`*^9}, {
   3.9527382577804832`*^9, 3.9527382596231785`*^9}, {3.952738483160063*^9, 
   3.952738484459591*^9}, 3.954697856713892*^9, {3.954698166369385*^9, 
   3.954698166669548*^9}, {3.9546985105906544`*^9, 3.9546985108176785`*^9}},
 CellTags->"Sensitivity",
 CellLabel->
  "In[168]:=",ExpressionUUID->"386a3b18-c97e-4830-a3d0-08c67263d3c7"],

Cell[CellGroupData[{

Cell["Importing excluded region", "Section",
 CellChangeTimes->{{3.9139669387362385`*^9, 3.9139669429054976`*^9}},
 CellTags->
  "Sensitivity",ExpressionUUID->"e54f2dc2-3904-41ed-811d-05f57f5483c8"],

Cell[BoxData[
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"SelectedExperimentList", "!=", 
    RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"importformat", "[", "\"\<txt\>\"", "]"}], "=", 
     RowBox[{
      RowBox[{"importformat", "[", "\"\<dat\>\"", "]"}], 
      "=", "\"\<Table\>\""}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"importformat", "[", "\"\<m\>\"", "]"}], "=", 
     RowBox[{
      RowBox[{"importformat", "[", "\"\<mx\>\"", "]"}], "=", "\"\<MX\>\""}]}],
     ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"importformat", "[", "\"\<xls\>\"", "]"}], "=", "\"\<XLS\>\""}], 
    ";", "\[IndentingNewLine]", 
    RowBox[{"dir", "=", 
     RowBox[{"FileNameJoin", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"NotebookDirectory", "[", "]"}], ",", "\"\<contours\>\"", ",",
         "LLPdirName"}], "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"DirectoryQ", "[", "dir", "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"filenames", "=", 
        RowBox[{"FileNames", "[", 
         RowBox[{
          RowBox[{"LLPdirName", "<>", "\"\<-excluded*\>\""}], ",", "dir", ",",
           "Infinity"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ExcludedRegions", "[", "LLPdirName", "]"}], "=", 
        RowBox[{
         RowBox[{
          RowBox[{"Import", "[", 
           RowBox[{"#", ",", 
            RowBox[{"importformat", "[", 
             RowBox[{"FileExtension", "[", "#", "]"}], "]"}]}], "]"}], "&"}], 
         "/@", 
         RowBox[{"FileNames", "[", 
          RowBox[{
           RowBox[{"LLPdirName", "<>", "\"\<-excluded*\>\""}], ",", "dir", ",",
            "Infinity"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ExcludedRegions", "[", "LLPdirName", "]"}], "=", 
        RowBox[{
         RowBox[{"ExcludedRegions", "[", "LLPdirName", "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";"}]}], "\[IndentingNewLine]", 
     "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"!", 
       RowBox[{"DirectoryQ", "[", "dir", "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"ExcludedRegions", "[", "LLPdirName", "]"}], "=", 
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{"{", 
           RowBox[{"10.", ",", "10."}], "}"}], "}"}], "}"}]}], ";"}]}], 
     "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{
  3.9146683148415594`*^9, {3.9156430966026564`*^9, 3.915643096613014*^9}, {
   3.950683073162401*^9, 3.9506830750965977`*^9}, {3.9546981740896683`*^9, 
   3.95469818150494*^9}},
 CellTags->"Sensitivity",
 CellLabel->
  "In[183]:=",ExpressionUUID->"b9b8a51e-c68c-49e6-bca3-bcc8cee90fbd"]
}, Closed]],

Cell[CellGroupData[{

Cell["Launching iterations", "Section",
 CellChangeTimes->{{3.9546978652976055`*^9, 3.9546978699622345`*^9}},
 CellTags->
  "Sensitivity",ExpressionUUID->"133a367f-552c-e54c-af43-d21876161d3e"],

Cell[BoxData[
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"SelectedExperimentList", "!=", 
    RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"BlockEvaluation", "[", "tag_", "]"}], ":=", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"nb", "=", 
         RowBox[{"EvaluationNotebook", "[", "]"}]}], ";", "\n", 
        RowBox[{"NotebookFind", "[", 
         RowBox[{"nb", ",", "tag", ",", "All", ",", "CellTags"}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"SelectionEvaluate", "[", "nb", "]"}]}]}], 
      "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"Do", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{
       "BlockEvaluation", "[", "\"\<Sensitivity-computation\>\"", "]"}], 
       ";"}], "\[IndentingNewLine]", ",", 
      RowBox[{"{", 
       RowBox[{"icounter", ",", "1", ",", 
        RowBox[{"Length", "[", "SelectedExperimentList", "]"}], ",", "1"}], 
       "}"}]}], "]"}]}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.9546981833194427`*^9, 3.954698187367874*^9}, {
  3.954698503457918*^9, 3.954698505756157*^9}},
 CellTags->"Sensitivity",
 CellLabel->
  "In[184]:=",ExpressionUUID->"8ee1c116-bfe3-8d46-ab4e-665f0bb787af"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Importing data and interpolations", "Chapter",
 CellChangeTimes->{{3.888640230459095*^9, 3.8886402340383005`*^9}},
 CellTags->
  "Sensitivity-computation",ExpressionUUID->"07b3dd6c-5bc5-4374-ad95-\
caec94e93ed0"],

Cell[CellGroupData[{

Cell["Selecting experiment", "Section",
 CellChangeTimes->{{3.9139657447716765`*^9, 3.91396574708887*^9}},
 CellTags->
  "Sensitivity-computation",ExpressionUUID->"50b70f7a-3e84-4b3e-ae55-\
9ddcc27d70f4"],

Cell[BoxData[{
 RowBox[{"Print", "[", "\"\<Selected experiment:\>\"", "]"}], "\[IndentingNewLine]", 
 RowBox[{"GivenExperimentForSensitivityComputation", "=", 
  RowBox[{"SelectedExperimentList", "[", 
   RowBox[{"[", 
    RowBox[{"icounter", "++"}], "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CondANUBIS", "=", 
   RowBox[{"MemberQ", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\"\<ANUBIS-shaft-volume-1\>\"", 
       ",", "\"\<ANUBIS-shaft-volume-2\>\"", 
       ",", "\"\<ANUBIS-shaft-volume-3\>\""}], "}"}], ",", 
     "GivenExperimentForSensitivityComputation"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"CondANUBIS", "\[Equal]", "True"}], ",", 
   RowBox[{"infoDialog", "[", 
    RowBox[{"Row", "[", 
     RowBox[{
     "{", "\"\<One of the modules of ANUBIS-shaft is chosen. The full \
sensitivity includes three modules. The importing will be over all modules, \
so for all ot the the sensitivity has to be computed\>\"", "}"}], "]"}], 
    "]"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"CondANUBIS", "\[Equal]", "False"}], ",", 
    RowBox[{"GivenExperimentForSensitivityComputationList", "=", 
     RowBox[{"{", "GivenExperimentForSensitivityComputation", "}"}]}], ",", 
    RowBox[{"GivenExperimentForSensitivityComputationList", "=", 
     RowBox[{"{", 
      RowBox[{"\"\<ANUBIS-shaft-volume-1\>\"", 
       ",", "\"\<ANUBIS-shaft-volume-2\>\"", 
       ",", "\"\<ANUBIS-shaft-volume-3\>\""}], "}"}]}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PathsNeventsSelected", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{"PathsNeventsSelected", "=", 
      RowBox[{"Join", "[", 
       RowBox[{"PathsNeventsSelected", ",", 
        RowBox[{"FileNames", "[", 
         RowBox[{"\"\<*.dat\>\"", ",", 
          RowBox[{"FileNameJoin", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"directory", "[", "\"\<Nevents-LLP\>\"", "]"}], ",", 
             "exp"}], "}"}], "]"}]}], "]"}]}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "GivenExperimentForSensitivityComputationList"}], 
      "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Filenames", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"StringReplace", "[", 
         RowBox[{
          RowBox[{"Last", "@", 
           RowBox[{"FileNameSplit", "@", 
            RowBox[{"files", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}]}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"\"\<e+0\>\"", "\[RuleDelayed]", "\"\<*^\>\""}], ",", 
            RowBox[{"\"\<e-0\>\"", "\[RuleDelayed]", "\"\<*^-\>\""}]}], 
           "}"}]}], "]"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "files", "]"}], ",", "1"}], "}"}]}], "]"}]}], 
    ";"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Creating", " ", "the", " ", "directory", " ", "for", " ", "exporting", " ",
     "sensitivity", " ", "curves"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ExperimentFolder", "=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"CondANUBIS", "\[Equal]", "True"}], ",", "\"\<ANUBIS\>\"", ",", 
     "GivenExperimentForSensitivityComputation"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"directory", "[", "\"\<Sensitivity-LLP-exp\>\"", "]"}], "=", 
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"directory", "[", "\"\<Sensitivity-LLP\>\"", "]"}], ",", 
      "ExperimentFolder"}], "}"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"!", 
    RowBox[{"DirectoryQ", "[", 
     RowBox[{"directory", "[", "\"\<Sensitivity-LLP-exp\>\"", "]"}], "]"}]}], 
   ",", 
   RowBox[{"CreateDirectory", "[", 
    RowBox[{"directory", "[", "\"\<Sensitivity-LLP-exp\>\"", "]"}], "]"}]}], 
  "]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.888640405218465*^9, 3.8886404054828978`*^9}, {
   3.888640688033486*^9, 3.888640712075594*^9}, {3.888640840778393*^9, 
   3.8886408730562687`*^9}, {3.888641405002051*^9, 3.888641442139065*^9}, {
   3.889452416600849*^9, 3.8894524286964445`*^9}, {3.8922863668744907`*^9, 
   3.892286366898034*^9}, {3.892910787474908*^9, 3.8929108155216017`*^9}, {
   3.8929109187901354`*^9, 3.892910919323763*^9}, {3.893234651838106*^9, 
   3.8932346670760703`*^9}, {3.893571856194499*^9, 3.893571900489534*^9}, {
   3.8935719323318167`*^9, 3.8935719482007504`*^9}, {3.893571993126726*^9, 
   3.8935721507849483`*^9}, {3.8935721863559847`*^9, 
   3.8935721867451844`*^9}, {3.893572718278763*^9, 3.893572718623453*^9}, {
   3.89377976849114*^9, 3.893779768594741*^9}, {3.8950547784763613`*^9, 
   3.8950548264035263`*^9}, {3.895080177680457*^9, 3.8950801804435496`*^9}, {
   3.895655903628629*^9, 3.895655943903708*^9}, {3.8965959647894173`*^9, 
   3.8965959729534636`*^9}, {3.896596013730302*^9, 3.8965960150160713`*^9}, {
   3.8967135736414485`*^9, 3.896713576799005*^9}, {3.896846367140677*^9, 
   3.896846378112254*^9}, {3.8991931504610395`*^9, 3.8991931548536186`*^9}, {
   3.905401395401388*^9, 3.9054014545135374`*^9}, {3.905401491608451*^9, 
   3.9054016390604534`*^9}, {3.9054016782548637`*^9, 
   3.9054016978154736`*^9}, {3.9054017331046224`*^9, 3.905401733286791*^9}, {
   3.905402056613489*^9, 3.9054020786916857`*^9}, {3.9054021523921556`*^9, 
   3.9054021525277405`*^9}, {3.907412012873991*^9, 3.9074120401924067`*^9}, {
   3.9138256017071066`*^9, 3.913825601762821*^9}, {3.9138286650119452`*^9, 
   3.9138286687397847`*^9}, 3.9138287036892476`*^9, 3.913828857616336*^9, {
   3.9138298606781945`*^9, 3.9138298683122253`*^9}, {3.913829931091795*^9, 
   3.9138299454298387`*^9}, {3.913830181137083*^9, 3.9138302492474275`*^9}, {
   3.9138303528085012`*^9, 3.913830353219181*^9}, {3.913830452316042*^9, 
   3.9138304532587094`*^9}, {3.913830628801233*^9, 3.91383063098724*^9}, {
   3.913830696056833*^9, 3.91383074284772*^9}, {3.9138313833659563`*^9, 
   3.9138314074250855`*^9}, 3.91383149488262*^9, {3.9138315374639864`*^9, 
   3.913831566828145*^9}, 3.9139657923561897`*^9, {3.9139661751200733`*^9, 
   3.91396617539285*^9}, {3.91396622734949*^9, 3.91396623298088*^9}, {
   3.9139665787084465`*^9, 3.913966579077614*^9}, 3.913967259077413*^9, 
   3.91451516812196*^9, 3.914668340369027*^9, {3.9156430960345483`*^9, 
   3.915643096046157*^9}, {3.915820872107156*^9, 3.9158208721274652`*^9}, {
   3.934602477947754*^9, 3.934602478377197*^9}},
 CellTags->"Sensitivity-computation",
 CellLabel->
  "In[185]:=",ExpressionUUID->"01ff1478-030e-432f-be11-c30e96d2eaaa"]
}, Closed]],

Cell[CellGroupData[{

Cell["Importing and interpolations", "Section",
 CellChangeTimes->{{3.9139657447716765`*^9, 3.913965756626442*^9}},
 CellTags->
  "Sensitivity-computation",ExpressionUUID->"c926b9c8-e111-49d9-935a-\
2823cd916a63"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"NeventsTabulated", ",", "NevInt", ",", "ProductionInfoList"}], 
    "}"}], "//", "Clear"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", "\"\<List of production channels:\>\"", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FilenamesNevents", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Last", "@", 
      RowBox[{"FileNameSplit", "@", 
       RowBox[{"PathsNeventsSelected", "[", 
        RowBox[{"[", "i", "]"}], "]"}]}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "PathsNeventsSelected", "]"}], ",", "1"}], 
      "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FilenameParameters", "[", "i_", "]"}], ":=", 
   RowBox[{
    RowBox[{"StringCases", "[", 
     RowBox[{
      RowBox[{"FilenamesNevents", "[", 
       RowBox[{"[", "i", "]"}], "]"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"\"\<Nevents_\>\"", "<>", "LLPdirName", "<>", "\"\<_\>\""}], "~~",
         "mother__", "~~", "\"\<_at_\>\"", "~~", "experiment__", 
        "~~", "\"\<_Npot=\>\"", "~~", "Npot__", "~~", "\"\<_decayDescr=\>\"", 
        "~~", "decayDescr__", "~~", "\"\<.dat\>\""}], ":>", 
       RowBox[{"{", 
        RowBox[{"mother", ",", "experiment", ",", "Npot", ",", "decayDescr"}],
         "}"}]}]}], "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "___", "___", "___", "___", "___", "___", "___", "___", "___", "___", 
    "___", "___", "___", "___", "___", "___", "___", "___"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Importing", " ", "and", " ", "interpolation"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "___", "___", "___", "___", "___", "___", "___", "___", "___", "___", 
    "___", "___", "___", "___", "___", "___", "___", "___"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ProductionInfoList", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"FilenameParameters", "[", "i", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "FilenamesNevents", "]"}], ",", "1"}], "}"}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"decaydescriptions", "=", 
   RowBox[{
    RowBox[{"ProductionInfoList", "[", 
     RowBox[{"[", 
      RowBox[{"All", ",", 
       RowBox[{"-", "1"}]}], "]"}], "]"}], "//", "DeleteDuplicates"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Join", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"\"\<Mother\>\"", ",", "\"\<Experiment\>\"", 
       ",", "\"\<\!\(\*SubscriptBox[\(N\), \(PoT\)]\)\>\"", 
       ",", "\"\<Decay description\>\""}], "}"}], "}"}], ",", 
    "ProductionInfoList"}], "]"}], "//", "TableForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ProductionChannelsList", "=", 
   RowBox[{
    RowBox[{"ProductionInfoList", "[", 
     RowBox[{"[", 
      RowBox[{"All", ",", "1"}], "]"}], "]"}], "//", "DeleteDuplicates"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NpotDefault", "=", 
   RowBox[{
    RowBox[{"Interpreter", "[", "\"\<Number\>\"", "]"}], "[", 
    RowBox[{
     RowBox[{"ProductionInfoList", "[", 
      RowBox[{"[", "1", "]"}], "]"}], "[", 
     RowBox[{"[", "3", "]"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Epsilon]reco", "[", "mLLP_", "]"}], "=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"StringContainsQ", "[", 
      RowBox[{
      "GivenExperimentForSensitivityComputation", 
       ",", "\"\<LHCb-downstream\>\""}], "]"}], ",", "0.4", ",", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"StringContainsQ", "[", 
        RowBox[{
        "GivenExperimentForSensitivityComputation", 
         ",", "\"\<CHARM-lepton\>\""}], "]"}], ",", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"mLLP", "<", 
          RowBox[{"0.105", "*", "2"}]}], ",", "0.51", ",", "0.85"}], "]"}], ",",
        "1"}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mgridfull", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"prod", ",", "decayDescr"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"prod", ",", "decayDescr"}], "}"}], "=", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"ProductionInfoList", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", "#", "]"}], "]"}], "&"}], "/@", 
        RowBox[{"{", 
         RowBox[{"1", ",", 
          RowBox[{"-", "1"}]}], "}"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "The", " ", "condition", " ", "if", " ", "one", " ", "sums", " ", 
        "the", " ", "number", " ", "of", " ", "events", " ", "for", " ", 
        "the", " ", "same", " ", "production", " ", "mode", " ", "over", " ", 
        "several", " ", "experiments"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"IfprodExists", "=", 
       RowBox[{
        RowBox[{"MemberQ", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Keys", "[", 
            RowBox[{"DownValues", "@", "NeventsTabulated"}], "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "1", ",", "1"}], "]"}], "]"}], ",", "prod"}], 
         "]"}], "&&", 
        RowBox[{"MemberQ", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Keys", "[", 
            RowBox[{"DownValues", "@", "NeventsTabulated"}], "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "1", ",", "1"}], "]"}], "]"}], ",", 
          "decayDescr"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"NeventsTabulated", "[", 
        RowBox[{"prod", ",", "decayDescr"}], "]"}], "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"!", "IfprodExists"}], ",", 
         RowBox[{"Import", "[", 
          RowBox[{
           RowBox[{"PathsNeventsSelected", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", "\"\<Table\>\""}], "]"}], ",", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"NeventsTabulated", "[", 
             RowBox[{"prod", ",", "decayDescr"}], "]"}], "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", 
              RowBox[{"{", 
               RowBox[{"1", ",", "2"}], "}"}]}], "]"}], "]"}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"NeventsTabulated", "[", 
              RowBox[{"prod", ",", "decayDescr"}], "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"All", ",", 
               RowBox[{"{", "3", "}"}]}], "]"}], "]"}], "+", 
            RowBox[{
             RowBox[{"Import", "[", 
              RowBox[{
               RowBox[{"PathsNeventsSelected", "[", 
                RowBox[{"[", "i", "]"}], "]"}], ",", "\"\<Table\>\""}], "]"}],
              "[", 
             RowBox[{"[", 
              RowBox[{"All", ",", 
               RowBox[{"{", "3", "}"}]}], "]"}], "]"}]}]}], "]"}]}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"mgrid", "[", 
          RowBox[{"prod", ",", "decayDescr"}], "]"}], ",", 
         RowBox[{"couplinggrid", "[", 
          RowBox[{"prod", ",", "decayDescr"}], "]"}]}], "}"}], "=", 
       RowBox[{
        RowBox[{
         RowBox[{"DeleteDuplicates", "[", 
          RowBox[{
           RowBox[{"NeventsTabulated", "[", 
            RowBox[{"prod", ",", "decayDescr"}], "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "#"}], "]"}], "]"}], "]"}], "&"}], "/@", 
        RowBox[{"{", 
         RowBox[{"1", ",", "2"}], "}"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"mgridfull", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Join", "[", 
          RowBox[{"mgridfull", ",", 
           RowBox[{"mgrid", "[", 
            RowBox[{"prod", ",", "decayDescr"}], "]"}]}], "]"}], "//", 
         "DeleteDuplicates"}], "//", "Sort"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"mminmax", "[", 
          RowBox[{"prod", ",", "decayDescr"}], "]"}], ",", 
         RowBox[{"couplingminmax", "[", 
          RowBox[{"prod", ",", "decayDescr"}], "]"}]}], "}"}], "=", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"#", "//", "MinMax"}], ")"}], "&"}], "/@", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"mgrid", "[", 
           RowBox[{"prod", ",", "decayDescr"}], "]"}], ",", 
          RowBox[{"couplinggrid", "[", 
           RowBox[{"prod", ",", "decayDescr"}], "]"}]}], "}"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"NevMax", "[", 
        RowBox[{"prod", ",", "decayDescr"}], "]"}], "=", 
       RowBox[{
        RowBox[{
         RowBox[{"NeventsTabulated", "[", 
          RowBox[{"prod", ",", "decayDescr"}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "3"}], "]"}], "]"}], "//", "Max"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"NevInt", "[", 
        RowBox[{
        "mLLP_", ",", "\[Theta]2_", ",", "BrhToSS_", ",", "prod", ",", 
         "decayDescr"}], "]"}], "=", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"StringContainsQ", "[", 
           RowBox[{"prod", ",", "\"\<quartic\>\""}], "]"}], ",", 
          FractionBox["BrhToSS", "BrhToSSreference"], ",", "1"}], "]"}], "*", 
        RowBox[{"\[Epsilon]reco", "[", "mLLP", "]"}], "*", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"mminmax", "[", 
              RowBox[{"prod", ",", "decayDescr"}], "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}], "\[LessEqual]", " ", "mLLP", "\[LessEqual]", 
            RowBox[{
             RowBox[{"mminmax", "[", 
              RowBox[{"prod", ",", "decayDescr"}], "]"}], "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "&&", 
           RowBox[{
            RowBox[{
             RowBox[{"couplingminmax", "[", 
              RowBox[{"prod", ",", "decayDescr"}], "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}], "\[LessEqual]", "\[Theta]2", "\[LessEqual]", 
            RowBox[{
             RowBox[{"couplingminmax", "[", 
              RowBox[{"prod", ",", "decayDescr"}], "]"}], "[", 
             RowBox[{"[", "2", "]"}], "]"}]}]}], ",", 
          RowBox[{"Evaluate", "[", 
           RowBox[{"10", "^", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Interpolation", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"Log10", "[", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Log10", "[", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Log10", "[", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "+", 
                    SuperscriptBox["10", 
                    RowBox[{"-", "90"}]]}], "]"}]}], "}"}], "&"}], "/@", 
                 RowBox[{"NeventsTabulated", "[", 
                  RowBox[{"prod", ",", "decayDescr"}], "]"}]}], ",", 
                RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[", 
              RowBox[{
               RowBox[{"Log10", "[", "mLLP", "]"}], ",", 
               RowBox[{"Log10", "[", "\[Theta]2", "]"}]}], "]"}], ")"}]}], 
           "]"}], ",", "0"}], "]"}]}]}], ";"}]}], "\[IndentingNewLine]", 
    "]"}], "\[IndentingNewLine]", ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "1", ",", 
     RowBox[{"Length", "[", "ProductionInfoList", "]"}], ",", "1"}], "}"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"mminmaxOverall", ",", "couplingminmaxOverall"}], "}"}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{"MinMax", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"prod", ",", "dec"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"prod", ",", "ProductionChannelsList"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"dec", ",", "decaydescriptions"}], "}"}]}], "]"}], "//", 
       "Flatten"}], "]"}], "&"}], "/@", 
    RowBox[{"{", 
     RowBox[{"mminmax", ",", "couplingminmax"}], "}"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"NevMaxOverall", "=", 
  RowBox[{"Max", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"NeventsTabulated", "[", 
         RowBox[{"#", ",", "descr"}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "3"}], "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"descr", ",", "decaydescriptions"}], "}"}]}], "]"}], "&"}], "/@",
     "ProductionChannelsList"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.913965883791148*^9, 3.91396589589476*^9}, {
   3.9139659981305513`*^9, 3.913966150740179*^9}, {3.9139665383054843`*^9, 
   3.9139665387566023`*^9}, {3.9139665828075905`*^9, 3.913966583571893*^9}, 
   3.914062722200712*^9, {3.914515168139216*^9, 3.914515168154531*^9}, {
   3.9152961846117973`*^9, 3.915296192391881*^9}, {3.915643096066443*^9, 
   3.9156430961115103`*^9}, {3.9158208721327257`*^9, 3.915820872148648*^9}, {
   3.934599673757265*^9, 3.934599674050934*^9}, {3.934601995543414*^9, 
   3.934602036342127*^9}, {3.9476515077344666`*^9, 3.947651541543352*^9}, {
   3.947652740931999*^9, 3.947652827986931*^9}, {3.9476528638345413`*^9, 
   3.9476528906566696`*^9}, {3.947652924458416*^9, 3.94765296273114*^9}, {
   3.9476529945192623`*^9, 3.947653100917444*^9}, {3.9476531468677254`*^9, 
   3.9476531485176754`*^9}, {3.9476532655421047`*^9, 
   3.9476532676166058`*^9}, {3.9476868332326565`*^9, 
   3.9476868445594215`*^9}, {3.947687652738329*^9, 3.9476876564785233`*^9}, {
   3.9482693103691006`*^9, 3.948269312875452*^9}, {3.9526705165262127`*^9, 
   3.952670651893305*^9}, {3.954698564027317*^9, 3.9546986008952045`*^9}},
 CellTags->"Sensitivity-computation",
 CellLabel->
  "In[195]:=",ExpressionUUID->"713135b7-c63d-4d84-a215-e8d83c1218c4"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{
  3.9526132008799515`*^9},ExpressionUUID->"84496cf0-5940-4b48-b6ac-\
969bef597d44"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Do", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"NevIntSummedQuartic", "[", 
        RowBox[{"mLLP_", ",", "\[Theta]2_", ",", "BrhToSS_", ",", "descr"}], 
        "]"}], "=", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{"NevInt", "[", 
          RowBox[{
          "mLLP", ",", "\[Theta]2", ",", "0.1", ",", "proc", ",", "descr"}], 
          "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"proc", ",", 
           RowBox[{"{", 
            
            RowBox[{"\"\<B-quartic\>\"", ",", "\"\<Bs-quartic\>\"", 
             ",", "\"\<h-quartic\>\""}], "}"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"NevIntSummedMixing", "[", 
        RowBox[{"mLLP_", ",", "\[Theta]2_", ",", "BrhToSS_", ",", "descr"}], 
        "]"}], "=", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{"NevInt", "[", 
          RowBox[{
          "mLLP", ",", "\[Theta]2", ",", "0.1", ",", "proc", ",", "descr"}], 
          "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"proc", ",", 
           RowBox[{"{", "\"\<B-mixing\>\"", "}"}]}], "}"}]}], "]"}]}]}], 
     "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{"descr", ",", "decaydescriptions"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
   RowBox[{"Do", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"TabulatedNevents", "[", 
        RowBox[{
        "ExperimentFolder", ",", "True", ",", "False", ",", "False", ",", 
         "descr"}], "]"}], "=", 
       RowBox[{"Flatten", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"mLLP", ",", "\[Theta]2", ",", 
             RowBox[{"NevIntSummedMixing", "[", 
              RowBox[{
              "mLLP", ",", "\[Theta]2", ",", "BrhToSS", ",", "descr"}], 
              "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"mLLP", ",", "mSgrid"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"\[Theta]2", ",", "\[Theta]2grid"}], "}"}]}], "]"}], ",", 
         "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"TabulatedNevents", "[", 
        RowBox[{
        "ExperimentFolder", ",", "False", ",", "False", ",", "False", ",", 
         "descr"}], "]"}], "=", 
       RowBox[{"Flatten", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"mLLP", ",", "\[Theta]2", ",", 
             RowBox[{"NevIntSummedQuartic", "[", 
              RowBox[{
              "mLLP", ",", "\[Theta]2", ",", "BrhToSS", ",", "descr"}], 
              "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"mLLP", ",", "mSgrid"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"\[Theta]2", ",", "\[Theta]2grid"}], "}"}]}], "]"}], ",", 
         "1"}], "]"}]}], ";"}], "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{"descr", ",", "decaydescriptions"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{"FileNameJoin", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"NotebookDirectory", "[", "]"}], ",", "\"\<temp1\>\"", 
         ",", "\"\<Di-decays\>\"", ",", "\"\<Tabulated Nevents\>\"", ",", 
         "LLPdirName", ",", "\"\<SHiP-ECN3\>\"", ",", 
         RowBox[{"\"\<Tabulated-Nevents_\>\"", "<>", "LLPdirName", 
          "<>", "\"\<_\>\"", "<>", "\"\<SHiP-ECN3\>\"", "<>", "\"\<_\>\"", 
          "<>", "\"\<False\>\"", "<>", "\"\<_\>\"", "<>", "\"\<False\>\"", 
          "<>", "\"\<_\>\"", "<>", "\"\<False\>\"", "<>", "\"\<.mx\>\""}]}], 
        "}"}], "]"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"#", ",", 
          RowBox[{"TabulatedNevents", "[", 
           RowBox[{
           "ExperimentFolder", ",", "False", ",", "False", ",", "False", ",", 
            "#"}], "]"}]}], "}"}], "&"}], "/@", 
       RowBox[{"decayDescriptions", "[", "\"\<SHiP-ECN3\>\"", "]"}]}], 
      ",", "\"\<MX\>\""}], "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{"FileNameJoin", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"NotebookDirectory", "[", "]"}], ",", "\"\<temp1\>\"", 
         ",", "\"\<Di-decays\>\"", ",", "\"\<Tabulated Nevents\>\"", ",", 
         "LLPdirName", ",", "\"\<SHiP-ECN3\>\"", ",", 
         RowBox[{"\"\<Tabulated-Nevents_\>\"", "<>", "LLPdirName", 
          "<>", "\"\<_\>\"", "<>", "\"\<SHiP-ECN3\>\"", "<>", "\"\<_\>\"", 
          "<>", "\"\<True\>\"", "<>", "\"\<_\>\"", "<>", "\"\<False\>\"", 
          "<>", "\"\<_\>\"", "<>", "\"\<False\>\"", "<>", "\"\<.mx\>\""}]}], 
        "}"}], "]"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"#", ",", 
          RowBox[{"TabulatedNevents", "[", 
           RowBox[{
           "ExperimentFolder", ",", "True", ",", "False", ",", "False", ",", 
            "#"}], "]"}]}], "}"}], "&"}], "/@", 
       RowBox[{"decayDescriptions", "[", "\"\<SHiP-ECN3\>\"", "]"}]}], 
      ",", "\"\<MX\>\""}], "]"}], ";"}], "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.9497474404194183`*^9, 3.9497474656093655`*^9}, {
  3.9497475948807774`*^9, 3.949747619689356*^9}, {3.9497490408679447`*^9, 
  3.9497490761908455`*^9}, {3.9497491555081615`*^9, 3.949749260859009*^9}, {
  3.9497519215119495`*^9, 3.94975192493194*^9}, {3.95067425336108*^9, 
  3.950674282641939*^9}, {3.9516664797924404`*^9, 3.95166649428397*^9}, {
  3.9516665456185246`*^9, 
  3.9516665538631077`*^9}},ExpressionUUID->"e436d26a-c62f-ba4b-b286-\
9ef80ff9a7bd"],

Cell[CellGroupData[{

Cell["Accounting for various bremsstrahlung descriptions", "Subsection",
 CellChangeTimes->{{3.9344213636600704`*^9, 3.934421371467765*^9}},
 CellTags->
  "Sensitivity-computation",ExpressionUUID->"641259e7-dffc-4eb6-96d0-\
4500406ac204"],

Cell[BoxData[{
 RowBox[{"Print", "[", "\"\<List of various bremsstrahlung channels:\>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BremChannelsList", "=", 
   RowBox[{
    RowBox[{"Select", "[", 
     RowBox[{"ProductionChannelsList", ",", 
      RowBox[{
       RowBox[{"StringContainsQ", "[", 
        RowBox[{"#", ",", "\"\<Bremsstrahlung\>\""}], "]"}], "&"}]}], "]"}], "//",
     "Sort"}]}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Defining", " ", "the", " ", "baseline", " ", "bremsstrahlung", " ", 
    "setup"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
  "BremChannelBaseline", "=", "\"\<Bremsstrahlung-AP-Central-mixing\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"BremChannelsList", "==", 
     RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ProductionChannelsListUnified", "=", 
      RowBox[{"ProductionChannelsBaseline", "=", "ProductionChannelsList"}]}],
      ";"}], "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"MemberQ", "[", 
        RowBox[{"BremChannelsList", ",", "BremChannelBaseline"}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ProductionChannelsBaseline", "=", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"Select", "[", 
            RowBox[{"ProductionChannelsList", ",", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"StringContainsQ", "[", 
                RowBox[{"#", ",", "\"\<Bremsstrahlung\>\""}], "]"}]}], 
              "&"}]}], "]"}], ",", 
           RowBox[{"{", "BremChannelBaseline", "}"}]}], "]"}]}], ";"}], 
       "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
       RowBox[{"ProductionChannelsBaseline", "=", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"Select", "[", 
           RowBox[{"ProductionChannelsList", ",", 
            RowBox[{
             RowBox[{"!", 
              RowBox[{"StringContainsQ", "[", 
               RowBox[{"#", ",", "\"\<Bremsstrahlung\>\""}], "]"}]}], "&"}]}],
            "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"BremChannelsList", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "}"}]}], "]"}]}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"ProductionChannelsListUnified", "=", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"Select", "[", 
         RowBox[{"ProductionChannelsList", ",", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"StringContainsQ", "[", 
             RowBox[{"#", ",", "\"\<Bremsstrahlung\>\""}], "]"}]}], "&"}]}], 
         "]"}], ",", 
        RowBox[{"{", "\"\<Bremsstrahlung\>\"", "}"}]}], "]"}]}], ";"}]}], 
   "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MapThread", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"BremNameExportPattern", "[", "#1", "]"}], "=", "#2"}], ")"}], 
     "&"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"\"\<Bremsstrahlung-\>\"", "<>", "#", 
          "<>", "\"\<-mixing\>\""}], ")"}], "&"}], "/@", 
       RowBox[{"{", 
        RowBox[{"\"\<FR-Upper\>\"", ",", "\"\<FR-Central\>\"", 
         ",", "\"\<FR-Lower\>\"", ",", "\"\<BB\>\"", ",", "\"\<AP-Upper\>\"", 
         ",", "\"\<AP-Central\>\"", ",", "\"\<AP-Lower\>\""}], "}"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"\"\<FR-Upper-mixing\>\"", ",", "\"\<FR-Central-mixing\>\"", 
        ",", "\"\<FR-Lower-mixing\>\"", ",", "\"\<BB-mixing\>\"", 
        ",", "\"\<AP-Upper-mixing\>\"", ",", "\"\<AP-Central-mixing\>\"", 
        ",", "\"\<AP-Lower-mixing\>\""}], "}"}]}], "}"}]}], "]"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.9344214061369877`*^9, 3.9344214204168596`*^9}, {
  3.9344218908614206`*^9, 3.934421911216852*^9}, {3.934421946639409*^9, 
  3.93442203218508*^9}, {3.9344226880216246`*^9, 3.9344226886615286`*^9}, {
  3.9344227585794473`*^9, 3.9344227618807783`*^9}, {3.9344229632846923`*^9, 
  3.934422985720289*^9}, {3.9344232039753017`*^9, 3.9344232051634417`*^9}, {
  3.934425118417382*^9, 3.9344251228031607`*^9}, {3.934555568906765*^9, 
  3.934555609855014*^9}, {3.9345995130339813`*^9, 3.9345996379854345`*^9}, {
  3.9345996837704773`*^9, 3.9345996847837586`*^9}, {3.935397999153017*^9, 
  3.9353979995833025`*^9}, {3.9476531954160004`*^9, 3.9476532363239307`*^9}, {
  3.9476533645561886`*^9, 3.947653365237747*^9}, {3.9482706269448853`*^9, 
  3.9482706274455166`*^9}},
 CellTags->"Sensitivity-computation",
 CellLabel->
  "In[209]:=",ExpressionUUID->"3c9f40fc-f6f0-4359-abe3-a8e369511d52"]
}, Closed]]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Plots with the number of events", "Chapter",
 CellChangeTimes->{{3.952737526291605*^9, 3.9527375282727356`*^9}, {
  3.9546978056179047`*^9, 3.9546978101812*^9}},
 CellTags->
  "Sensitivity-computation",ExpressionUUID->"72c1424d-fb71-2a4c-af5e-\
664add5c137d"],

Cell[CellGroupData[{

Cell["Overall plot of the number of events", "Section",
 CellChangeTimes->{{3.9482706358851337`*^9, 3.948270640754364*^9}},
 CellTags->
  "Sensitivity-computation",ExpressionUUID->"a12c9941-3b58-8e4a-8c0a-\
86d9c709b874"],

Cell[BoxData[{
 RowBox[{"Do", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"NevIntOverall", "[", 
      RowBox[{"mLLP_", ",", "\[Theta]2_", ",", "BrhToSS_", ",", "descr"}], 
      "]"}], "=", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{"NevInt", "[", 
        RowBox[{
        "mLLP", ",", "\[Theta]2", ",", "BrhToSS", ",", "prod", ",", "descr"}],
         "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"prod", ",", "ProductionChannelsBaseline"}], "}"}]}], "]"}]}],
     ";"}], "\[IndentingNewLine]", ",", 
   RowBox[{"{", 
    RowBox[{"descr", ",", "decaydescriptions"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pt", "[", 
   RowBox[{"mLLP_", ",", "BrhToSS_", ",", "descr_"}], "]"}], ":=", 
  RowBox[{"LogLogPlot", "[", 
   RowBox[{
    RowBox[{"Evaluate", "[", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"NevInt", "[", 
        RowBox[{"mLLP", ",", "y", ",", "BrhToSS", ",", "prod", ",", "descr"}],
         "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"prod", ",", "ProductionChannelsBaseline"}], "}"}]}], "]"}], 
     "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"y", ",", 
      RowBox[{"couplingminmaxOverall", "[", 
       RowBox[{"[", "1", "]"}], "]"}], ",", 
      RowBox[{"couplingminmaxOverall", "[", 
       RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
    RowBox[{"PlotLegends", "\[Rule]", 
     RowBox[{"Placed", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Style", "[", 
          RowBox[{"#", ",", "15"}], "]"}], "&"}], "/@", 
        "ProductionChannelsBaseline"}], ",", "Right"}], "]"}]}], ",", 
    RowBox[{"PlotRange", "->", 
     RowBox[{"{", 
      RowBox[{"couplingminmaxOverall", ",", 
       RowBox[{"{", 
        RowBox[{
         SuperscriptBox["10", 
          RowBox[{"-", "2"}]], ",", "NevMaxOverall"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"Frame", "->", "True"}], ",", 
    RowBox[{"ImageSize", "->", "Large"}], ",", 
    RowBox[{"FrameLabel", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
      "couplingLabel", ",", 
       " ", "\"\<\!\(\*SubscriptBox[\(N\), \
\(events\)]\)[\!\(\*SubscriptBox[\(m\), \(S\)]\),\!\(\*SuperscriptBox[\(\
\[Theta]\), \(2\)]\),\!\(\*SubscriptBox[\(Br\), \(h -> SS\)]\)]\>\""}], 
      "}"}]}], ",", 
    RowBox[{"FrameStyle", "\[Rule]", 
     RowBox[{"Directive", "[", 
      RowBox[{"Black", ",", " ", "23"}], "]"}]}], ",", 
    RowBox[{"PlotStyle", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"Thick", ",", "Blue"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"Thick", ",", 
         RowBox[{"Darker", "@", "Red"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"Thick", ",", 
         RowBox[{"Darker", "@", 
          RowBox[{"Darker", "@", "Green"}]}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"Thick", ",", "Black"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"Thick", ",", "Orange"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"Thick", ",", 
         RowBox[{"Darker", "@", "Cyan"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"Thick", ",", "Magenta"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"Thick", ",", "Blue", ",", 
         RowBox[{"Dashing", "[", "0.02", "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"Thick", ",", 
         RowBox[{"Darker", "@", "Red"}], ",", 
         RowBox[{"Dashing", "[", "0.02", "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"Thick", ",", 
         RowBox[{"Darker", "@", 
          RowBox[{"Darker", "@", "Green"}]}], ",", 
         RowBox[{"Dashing", "[", "0.02", "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"Thick", ",", "Black", ",", 
         RowBox[{"Dashing", "[", "0.02", "]"}]}], "}"}]}], "}"}]}], ",", 
    RowBox[{"PlotLabel", "\[Rule]", 
     RowBox[{"Style", "[", 
      RowBox[{
       RowBox[{"Row", "[", 
        RowBox[{"{", 
         RowBox[{
         "ExperimentFolder", 
          ",", "\"\<. \!\(\*SubscriptBox[\(m\), \(S\)]\) = \>\"", ",", "mLLP",
           ",", " ", "\"\< GeV, \!\(\*SubscriptBox[\(Br\), \(h -> SS\)]\) = \
\>\"", ",", "BrhToSS"}], "}"}], "]"}], ",", "20", ",", "Black"}], "]"}]}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"pt", "[", 
  RowBox[{"0.7", ",", "0.01", ",", "\"\<Default\>\""}], "]"}]}], "Input",
 CellChangeTimes->{{3.952737461773714*^9, 3.952737463564913*^9}, {
  3.952738193873806*^9, 3.9527382110606594`*^9}},
 CellTags->"Sensitivity-computation",
 CellLabel->
  "In[214]:=",ExpressionUUID->"0b7167ea-a9ec-9c45-89be-9e80ec1e3aa0"]
}, Closed]],

Cell[CellGroupData[{

Cell["Density plot for number of events", "Section",
 CellChangeTimes->{{3.8929107346824093`*^9, 3.8929107391764154`*^9}},
 CellTags->
  "Sensitivity-computation",ExpressionUUID->"774c689c-d8e1-4948-b114-\
3e9e9146e0d5"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"BrhToSSval", "=", "0.01"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "If", " ", "the", " ", "plot", " ", "is", " ", "not", " ", "as", " ", 
     "smooth", " ", "as", " ", "it", " ", "is", " ", "desired"}], ",", " ", 
    RowBox[{
    "increase", " ", "the", " ", "value", " ", "of", " ", "PlotPoints", " ", 
     "option"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"plot", "=", 
   RowBox[{"DensityPlot", "[", 
    RowBox[{
     RowBox[{"Evaluate", "[", 
      RowBox[{"Log10", "[", 
       RowBox[{"NevIntOverall", "[", 
        RowBox[{
        "mLLP", ",", "\[Theta]2", ",", "BrhToSSval", ",", "\"\<Default\>\""}],
         "]"}], "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"mLLP", ",", 
       RowBox[{"mminmaxOverall", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", 
       RowBox[{"mminmaxOverall", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\[Theta]2", ",", 
       RowBox[{"couplingminmaxOverall", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", 
       RowBox[{"couplingminmaxOverall", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
     RowBox[{"ScalingFunctions", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"\"\<Log\>\"", ",", "\"\<Log\>\""}], "}"}]}], ",", 
     RowBox[{"AspectRatio", "\[Rule]", "0.78"}], ",", 
     RowBox[{"PlotRange", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"All", ",", "All", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Log10", "[", "2.3", "]"}], ",", 
          RowBox[{"Log10", "[", "NevMaxOverall", "]"}]}], "}"}]}], "}"}]}], ",", 
     RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
     RowBox[{"FrameLabel", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"massLabel", ",", "couplingLabel"}], "}"}]}], ",", " ", 
     RowBox[{"Frame", "\[Rule]", " ", "True"}], ",", " ", 
     RowBox[{"FrameStyle", "\[Rule]", 
      RowBox[{"Directive", "[", 
       RowBox[{"Black", ",", " ", "25"}], "]"}]}], ",", 
     RowBox[{"PlotPoints", "\[Rule]", "100"}], ",", 
     RowBox[{"PlotLegends", "\[Rule]", 
      RowBox[{"Placed", "[", 
       RowBox[{
        RowBox[{"BarLegend", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"Automatic", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Log10", "[", "2.3", "]"}], ",", 
              RowBox[{"Log10", "[", "NevMaxOverall", "]"}]}], "}"}]}], "}"}], 
          ",", 
          RowBox[{"LegendMarkerSize", "\[Rule]", "340"}], ",", 
          RowBox[{"LegendLabel", "\[Rule]", 
           RowBox[{"Placed", "[", 
            
            RowBox[{"\"\<\!\(\*SubscriptBox[\(Log\), \
\(10\)]\)[\!\(\*SubscriptBox[\(N\), \(ev\)]\)]\>\"", ",", "Bottom"}], "]"}]}],
           ",", 
          RowBox[{"LabelStyle", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"FontSize", "\[Rule]", "22"}], "}"}]}], ",", 
          RowBox[{"Method", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"FrameStyle", "\[Rule]", "Black"}], ",", 
             RowBox[{"AxesStyle", "\[Rule]", "None"}], ",", 
             RowBox[{"TicksStyle", "\[Rule]", "Black"}]}], "}"}]}]}], "]"}], ",",
         "Right"}], "]"}]}], ",", 
     RowBox[{"PlotLabel", "\[Rule]", 
      RowBox[{"Style", "[", 
       RowBox[{
        RowBox[{"Row", "[", 
         RowBox[{"{", 
          RowBox[{
          "ExperimentFolder", ",", "\"\<, Br(h\[Rule]SS) = \>\"", ",", 
           "BrhToSSval"}], "}"}], "]"}], ",", "20", ",", "Black"}], "]"}]}]}], 
    RowBox[{"(*", 
     RowBox[{",", 
      RowBox[{"FrameTicks", "->", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"Automatic", ",", "Automatic"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"TicksPlotx", ",", "None"}], "}"}]}], "}"}]}]}], "*)"}], 
    "]"}]}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"Exporting", ".", " ", "\"\<AllowRasterization\>\""}], "->", 
     RowBox[{
     "False", " ", "option", " ", "reduces", " ", "the", " ", "size", " ", 
      "of", " ", "the", " ", 
      RowBox[{"output", ".", " ", "Without"}], " ", "this", " ", "option"}]}],
     ",", " ", 
    RowBox[{
    "the", " ", "file", " ", "may", " ", "be", " ", "very", " ", "large"}], ",",
     " ", 
    RowBox[{
    "depending", " ", "on", " ", "the", " ", "value", " ", "of", " ", 
     "PlotPoints"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Export", "[", 
    RowBox[{
     RowBox[{"FileNameJoin", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"NotebookDirectory", "[", "]"}], 
        ",", "\"\<NeventsDensityPlotExample.pdf\>\""}], "}"}], "]"}], ",", 
     "plot", ",", 
     RowBox[{"\"\<AllowRasterization\>\"", "->", "False"}]}], "]"}], 
   "*)"}]}]}], "Input",
 CellChangeTimes->{{3.8929107497085266`*^9, 3.8929107744261785`*^9}, {
   3.892910861445203*^9, 3.8929109001869607`*^9}, {3.892910943526046*^9, 
   3.8929109465202713`*^9}, {3.893224729770398*^9, 3.8932247313824215`*^9}, {
   3.893572155852467*^9, 3.8935721598179455`*^9}, {3.8937454038713837`*^9, 
   3.8937454070652494`*^9}, 3.8956463351379347`*^9, 3.89564644289021*^9, {
   3.895647551533736*^9, 3.895647634039733*^9}, {3.895655834660489*^9, 
   3.8956558350038366`*^9}, {3.9138256017702165`*^9, 3.913825601779767*^9}, {
   3.9139666886265564`*^9, 3.913966722084516*^9}, {3.9156430963341904`*^9, 
   3.915643096338379*^9}, {3.9476533063012905`*^9, 3.947653308151045*^9}, {
   3.9527375599946556`*^9, 3.9527375642484016`*^9}},
 CellTags->"Sensitivity-computation",
 CellLabel->
  "In[217]:=",ExpressionUUID->"fae948ac-5c53-425d-8842-e6b4ca896596"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Specifying setup to compute the sensitivity", "Chapter",
 CellChangeTimes->{{3.95469781910042*^9, 3.9546978251110516`*^9}},
 CellTags->
  "Sensitivity-computation",ExpressionUUID->"785f8753-296d-1248-8ab6-\
e5102d40ba91"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"productionlist", "=", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"{", "\"\<All\>\"", "}"}], ",", 
     "ProductionChannelsListUnified"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DynamicModule", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"input0", "=", "0."}], ",", 
      RowBox[{"input1", "=", "NpotDefault"}], ",", 
      RowBox[{"input2", "=", "2.3"}], ",", 
      RowBox[{"choice", "=", 
       RowBox[{"{", "\"\<All\>\"", "}"}]}], ",", "list", ",", "phrase"}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"DialogInput", "[", 
     RowBox[{"Column", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Style", "[", 
         RowBox[{"ExperimentFolder", ",", "Bold"}], "]"}], ",", 
        RowBox[{"TextCell", "[", "\"\<Enter Br(h\[Rule]SS):\>\"", "]"}], ",", 
        RowBox[{"InputField", "[", 
         RowBox[{
          RowBox[{"Dynamic", "[", "input0", "]"}], ",", "Expression"}], "]"}],
         ",", 
        RowBox[{
        "TextCell", "[", "\"\<Enter the number of proton collisions:\>\"", 
         "]"}], ",", 
        RowBox[{"InputField", "[", 
         RowBox[{
          RowBox[{"Dynamic", "[", "input1", "]"}], ",", "Expression"}], "]"}],
         ",", 
        RowBox[{
        "TextCell", 
         "[", "\"\<Enter the value of N_ev,min for which the sensitivity will \
be computed:\>\"", "]"}], ",", 
        RowBox[{"InputField", "[", 
         RowBox[{
          RowBox[{"Dynamic", "[", "input2", "]"}], ",", "Expression"}], "]"}],
         ",", 
        RowBox[{"Row", "[", 
         RowBox[{
         "{", "\"\<Select the production channels to be used for the \
sensitivity calculation:\>\"", "}"}], "]"}], ",", 
        RowBox[{"Pane", "[", 
         RowBox[{
          RowBox[{"TogglerBar", "[", 
           RowBox[{
            RowBox[{"Dynamic", "[", "choice", "]"}], ",", "productionlist", ",", 
            RowBox[{"Appearance", "->", 
             RowBox[{"\"\<Vertical\>\"", "->", 
              RowBox[{"{", 
               RowBox[{"Automatic", ",", "1"}], "}"}]}]}]}], "]"}], ",", 
          RowBox[{"ImageSize", "->", 
           RowBox[{"{", 
            RowBox[{"Automatic", ",", "Automatic"}], "}"}]}], ",", 
          RowBox[{"Scrollbars", "->", 
           RowBox[{"{", 
            RowBox[{"False", ",", "True"}], "}"}]}]}], "]"}], ",", 
        RowBox[{"Button", "[", 
         RowBox[{"\"\<Submit\>\"", ",", 
          RowBox[{"DialogReturn", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
             "BrhToSSval", ",", "NpotVal", ",", "NevMinVal", ",", 
              "SelectedProduction"}], "}"}], "=", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"input0", ",", "input1", ",", "input2", ",", "choice"}],
               "}"}], "//", "N"}]}], "]"}], ",", 
          RowBox[{"ImageSize", "->", "Automatic"}]}], "]"}]}], "}"}], "]"}], 
     "]"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"MemberQ", "[", 
    RowBox[{"SelectedProduction", ",", "\"\<All\>\""}], "]"}], ",", 
   RowBox[{
    RowBox[{"SelectedProduction", "=", "ProductionChannelsListUnified"}], 
    ";"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"\"\<Br(h\[Rule]SS)\>\"", 
      ",", "\"\<\!\(\*SubscriptBox[\(N\), \(PoT\)]\) for computation\>\"", 
      ",", "\"\<\!\(\*SubscriptBox[\(N\), \(ev, min\)]\)\>\"", 
      ",", "\"\<Selected production modes\>\""}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
     "BrhToSSval", ",", "NpotVal", ",", "NevMinVal", ",", 
      "SelectedProduction"}], "}"}]}], "}"}], "//", "TableForm"}]}], "Input",
 CellTags->"Sensitivity-computation",
 CellLabel->
  "In[219]:=",ExpressionUUID->"5dcb378e-b628-4948-a176-b9ff8dc62ce5"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.9546989421084633`*^9, 
  3.954698950438305*^9}},ExpressionUUID->"1af51f82-fec8-f545-b646-\
06d5505eb40e"]
}, Closed]],

Cell[CellGroupData[{

Cell["Sensitivity computation", "Chapter",
 CellChangeTimes->{{3.888640440992809*^9, 3.888640444396226*^9}},
 CellTags->
  "Sensitivity-computation",ExpressionUUID->"0d834004-01d7-412b-b48e-\
402cf64fc469"],

Cell[CellGroupData[{

Cell["Sensitivity calculator block", "Section",
 CellChangeTimes->{{3.9139668920954013`*^9, 3.913966893281294*^9}, 
   3.954697904705908*^9},
 CellTags->
  "Sensitivity-computation",ExpressionUUID->"34ac3bb4-f0d0-4d08-afe5-\
b8db5a9ce429"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SensitivityExtractor", "[", 
   RowBox[{
   "SelectedProduction_", ",", "Npot_", ",", "BrhToSSval_", ",", "NevMin_", ",",
     "decayDescr_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"RegSens", ",", "SensTemp"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"NevTot", "[", 
       RowBox[{"mLLP_", ",", "\[Theta]2_"}], "]"}], "=", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{"NevInt", "[", 
         RowBox[{
         "mLLP", ",", "\[Theta]2", ",", "BrhToSSval", ",", "prod", ",", 
          "decayDescr"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"prod", ",", "SelectedProduction"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"RegSens", "=", 
      RowBox[{"RegionPlot", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          FractionBox["Npot", "NpotDefault"], 
          RowBox[{"NevTot", "[", 
           RowBox[{
            SuperscriptBox["10", "mLLP"], ",", 
            SuperscriptBox["10", "\[Epsilon]2"]}], "]"}]}], "\[GreaterEqual]",
          "NevMin"}], ",", 
        RowBox[{"{", 
         RowBox[{"mLLP", ",", 
          RowBox[{"Log10", "[", 
           RowBox[{"mminmaxOverall", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
          RowBox[{"Log10", "[", 
           RowBox[{"mminmaxOverall", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"\[Epsilon]2", ",", 
          RowBox[{"Log10", "[", 
           RowBox[{"couplingminmaxOverall", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
          RowBox[{"Log10", "[", 
           RowBox[{"couplingminmaxOverall", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "}"}], ",", 
        RowBox[{"PlotPoints", "->", "300"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"SensTemp", "=", 
      RowBox[{"Cases", "[", 
       RowBox[{
        RowBox[{"Normal", "@", "RegSens"}], ",", 
        RowBox[{
         RowBox[{"Line", "[", "x_", "]"}], "\[RuleDelayed]", "x"}], ",", 
        "Infinity"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"10", "^", 
            RowBox[{"#", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], ",", 
           RowBox[{"10", "^", 
            RowBox[{"#", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}], "&"}], "/@", 
        RowBox[{"SensTemp", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "SensTemp", "]"}], ",", "1"}], "}"}]}], 
      "]"}]}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SensitivityExtractorBrem", "[", 
   RowBox[{
   "SelectedProduction_", ",", "i_", ",", "Npot_", ",", "BrhToSSval_", ",", 
    "NevMin_", ",", "decayDescr_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"bremch", ",", "selprod"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"bremch", "=", 
      RowBox[{"BremChannelsList", "[", 
       RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"selprod", "=", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"Select", "[", 
         RowBox[{"SelectedProduction", ",", 
          RowBox[{
           RowBox[{"#", "!=", "\"\<Bremsstrahlung\>\""}], "&"}]}], "]"}], ",", 
        RowBox[{"{", "bremch", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"selprod", ",", 
       RowBox[{"BremNameExportPattern", "[", "bremch", "]"}], ",", 
       "decayDescr", ",", 
       RowBox[{"SensitivityExtractor", "[", 
        RowBox[{
        "selprod", ",", "Npot", ",", "BrhToSSval", ",", "NevMin", ",", 
         "decayDescr"}], "]"}]}], "}"}]}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SensitivityBlock", "[", 
   RowBox[{
   "NevMin_", ",", "BrhToSSval_", ",", "Npot_", ",", "SelectedProduction_"}], 
   "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "TabSens", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"MemberQ", "[", 
         RowBox[{"SelectedProduction", ",", "\"\<Bremsstrahlung\>\""}], 
         "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"TabSens", "=", 
         RowBox[{
          RowBox[{"ResourceFunction", "[", "\"\<MonitorProgress\>\"", "]"}], "@", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"SelectedProduction", ",", "\"\<None\>\"", ",", 
              RowBox[{"decaydescriptions", "[", 
               RowBox[{"[", "j", "]"}], "]"}], ",", 
              RowBox[{"SensitivityExtractor", "[", 
               RowBox[{
               "SelectedProduction", ",", "Npot", ",", "BrhToSSval", ",", 
                "NevMin", ",", 
                RowBox[{"decaydescriptions", "[", 
                 RowBox[{"[", "j", "]"}], "]"}]}], "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", "1", ",", 
              RowBox[{"Length", "[", "decaydescriptions", "]"}]}], "}"}]}], 
           "]"}]}]}], ";"}], "\[IndentingNewLine]", ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"TabSens", "=", 
         RowBox[{"Flatten", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"ResourceFunction", "[", "\"\<MonitorProgress\>\"", "]"}],
             "@", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"SensitivityExtractorBrem", "[", 
               RowBox[{
               "SelectedProduction", ",", "i", ",", "Npot", ",", "BrhToSSval",
                 ",", "NevMin", ",", 
                RowBox[{"decaydescriptions", "[", 
                 RowBox[{"[", "j", "]"}], "]"}]}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "1", ",", 
                RowBox[{"Length", "[", "BremChannelsList", "]"}], ",", "1"}], 
               "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"j", ",", "1", ",", 
                RowBox[{"Length", "[", "decaydescriptions", "]"}]}], "}"}]}], 
             "]"}]}], ",", "1"}], "]"}]}], ";"}]}], "\[IndentingNewLine]", 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"filenameexport", "=", 
      RowBox[{"FileNameJoin", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"directory", "[", "\"\<Sensitivity-LLP-exp\>\"", "]"}], ",", 
         RowBox[{"ToString", "@", 
          RowBox[{"StringForm", "[", 
           
           RowBox[{"\"\<Sensitivity_``_at_``_BrhToSS=``_Nev=``_Npot=``.\>\"", 
            ",", 
            RowBox[{"Sequence", "@@", 
             RowBox[{"{", 
              RowBox[{"LLPdirName", ",", "ExperimentFolder", ",", 
               RowBox[{"BrhToSSval", "//", "ToString"}], ",", 
               RowBox[{"NevMin", "//", "ToString"}], ",", 
               RowBox[{
                RowBox[{
                 RowBox[{"SetPrecision", "[", 
                  RowBox[{
                   RowBox[{"Npot", "//", "N"}], ",", "3"}], "]"}], "//", 
                 "CForm"}], "//", "ToString"}]}], "}"}]}]}], "]"}]}]}], "}"}],
        "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"assocData", "=", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Association", "[", 
          RowBox[{
           RowBox[{"\"\<Production modes\>\"", "->", 
            RowBox[{"#", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], ",", 
           RowBox[{"\"\<Bremsstrahlung description\>\"", "->", 
            RowBox[{"#", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], ",", 
           RowBox[{"\"\<Decay description\>\"", "->", 
            RowBox[{"#", "[", 
             RowBox[{"[", "3", "]"}], "]"}]}], ",", 
           RowBox[{"\"\<Sensitivity domains\>\"", "->", 
            RowBox[{"#", "[", 
             RowBox[{"[", "4", "]"}], "]"}]}]}], "]"}], "&"}], ",", 
        "TabSens"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Export", "[", 
      RowBox[{
       RowBox[{"filenameexport", "<>", "\"\<mx\>\""}], ",", "TabSens", 
       ",", "\"\<MX\>\""}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Export", "[", 
      RowBox[{
       RowBox[{"filenameexport", "<>", "\"\<json\>\""}], ",", "assocData", 
       ",", "\"\<JSON\>\""}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", "TabSens", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Import", "[", 
      RowBox[{
       RowBox[{"filenameexport", "<>", "\"\<mx\>\""}], ",", "\"\<MX\>\""}], 
      "]"}]}]}], "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.934421479980956*^9, 3.934421485637372*^9}, {
   3.9344215212004547`*^9, 3.9344216544224505`*^9}, {3.934421813294731*^9, 
   3.93442184894899*^9}, {3.9344225795802717`*^9, 3.93442259848044*^9}, {
   3.9344226459818587`*^9, 3.9344226510014877`*^9}, {3.9344230006660337`*^9, 
   3.9344230638395133`*^9}, {3.9344231355251417`*^9, 3.934423156451792*^9}, {
   3.934423215387514*^9, 3.9344232768091245`*^9}, {3.9344234615918875`*^9, 
   3.9344234629753327`*^9}, {3.9344235257969522`*^9, 3.934423532738423*^9}, {
   3.934423565109843*^9, 3.9344235672259784`*^9}, {3.9344236206065826`*^9, 
   3.9344236262941875`*^9}, 3.934423717560384*^9, {3.934424163055132*^9, 
   3.934424289932214*^9}, {3.9344243294173565`*^9, 3.934424340227537*^9}, {
   3.934424459148281*^9, 3.9344245173287725`*^9}, {3.9344246092525973`*^9, 
   3.934424658569865*^9}, {3.934424739992304*^9, 3.9344247632089224`*^9}, {
   3.934424888109357*^9, 3.9344249791220064`*^9}, {3.934425254878038*^9, 
   3.934425258561247*^9}, {3.934425404757271*^9, 3.934425404804878*^9}, {
   3.9344279717944*^9, 3.934428038199317*^9}, {3.9344281562037163`*^9, 
   3.9344281576640196`*^9}, {3.934428813513471*^9, 3.934428827909872*^9}, 
   3.934446479432088*^9, {3.934447035578642*^9, 3.9344470368597403`*^9}, {
   3.9345997443494387`*^9, 3.9345997729721527`*^9}, {3.9345998236371956`*^9, 
   3.9345998405092573`*^9}, {3.93460180003234*^9, 3.934601821123973*^9}, {
   3.9347841865048475`*^9, 3.93478418913299*^9}, {3.947653387342058*^9, 
   3.947653416200096*^9}, {3.9476534857899017`*^9, 3.9476535622410984`*^9}, 
   3.9476594521534386`*^9, {3.947659809414215*^9, 3.947659843174095*^9}, {
   3.947660108358881*^9, 3.947660109579191*^9}, {3.947660445325901*^9, 
   3.9476604455451527`*^9}, {3.947730887790806*^9, 3.947730930627947*^9}, 
   3.947731007924856*^9, {3.947731047410862*^9, 3.9477310614291344`*^9}, {
   3.9508970509598503`*^9, 3.9508970670268745`*^9}, {3.9508973160601234`*^9, 
   3.9508973228872185`*^9}, {3.950904399543846*^9, 3.950904400099785*^9}, 
   3.950904549763773*^9, 3.95284240071496*^9, 3.9546994884321384`*^9},
 CellTags->
  "Sensitivity-computation",ExpressionUUID->"77d020ab-0998-4d29-a1a5-\
9b4450dbc4f8"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Computing sensitivity and plots", "Section",
 CellChangeTimes->{{3.9139668920954013`*^9, 3.913966893281294*^9}, {
  3.954697904705908*^9, 3.954697919853239*^9}},
 CellTags->
  "Sensitivity-computation",ExpressionUUID->"8313923f-8d82-f244-a291-\
f219ff1efa02"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"sens", "=", 
   RowBox[{"SensitivityBlock", "[", 
    RowBox[{
    "NevMinVal", ",", "BrhToSSval", ",", "NpotVal", ",", 
     "SelectedProduction"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"legends", "=", 
   RowBox[{"sens", "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", 
      RowBox[{"-", "2"}]}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sensregions", "=", 
   RowBox[{"sens", "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", 
      RowBox[{"-", "1"}]}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ColorsForPlot", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"Thick", ",", "Blue"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"Thick", ",", 
       RowBox[{"Darker", "@", "Red"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"Thick", ",", 
       RowBox[{"Darker", "@", 
        RowBox[{"Darker", "@", "Green"}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"Thick", ",", 
       RowBox[{"Darker", "@", "Cyan"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"Thick", ",", "Magenta"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"Thick", ",", " ", "Black"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"Thick", ",", 
       RowBox[{"Lighter", "@", "Brown"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"Thick", ",", 
       RowBox[{"Lighter", "@", "Blue"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"Thick", ",", 
       RowBox[{"Lighter", "@", "Red"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"Thick", ",", 
       RowBox[{"Lighter", "@", "Green"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"Thick", ",", "Blue", ",", 
       RowBox[{"Dashing", "[", "0.02", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"Thick", ",", 
       RowBox[{"Darker", "@", "Red"}], ",", 
       RowBox[{"Dashing", "[", "0.02", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"Thick", ",", 
       RowBox[{"Darker", "@", 
        RowBox[{"Darker", "@", "Green"}]}], ",", 
       RowBox[{"Dashing", "[", "0.02", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"Thick", ",", 
       RowBox[{"Darker", "@", "Cyan"}], ",", 
       RowBox[{"Dashing", "[", "0.02", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"Thick", ",", "Magenta", ",", 
       RowBox[{"Dashing", "[", "0.02", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"Thick", ",", "Black", ",", 
       RowBox[{"Dashing", "[", "0.02", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"Thick", ",", 
       RowBox[{"Lighter", "@", "Brown"}], ",", 
       RowBox[{"Dashing", "[", "0.02", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"Thick", ",", 
       RowBox[{"Lighter", "@", "Blue"}], ",", 
       RowBox[{"Dashing", "[", "0.02", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"Thick", ",", 
       RowBox[{"Lighter", "@", "Red"}], ",", 
       RowBox[{"Dashing", "[", "0.02", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"Thick", ",", 
       RowBox[{"Lighter", "@", "Green"}], ",", 
       RowBox[{"Dashing", "[", "0.02", "]"}]}], "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"plotstylelist", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"ConstantArray", "[", 
        RowBox[{
         RowBox[{"ColorsForPlot", "[", 
          RowBox[{"[", "i", "]"}], "]"}], ",", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"MatrixQ", "[", 
            RowBox[{"sensregions", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", "1", ",", 
           RowBox[{"Length", "@", 
            RowBox[{"sensregions", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}]}], "]"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "sensregions", "]"}], ",", "1"}], "}"}]}], 
      "]"}], ",", "1"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Show", "[", 
  RowBox[{
   RowBox[{"ListLogLogPlot", "[", 
    RowBox[{
     RowBox[{"Cases", "[", 
      RowBox[{
       RowBox[{"ExcludedRegions", "[", "LLPdirName", "]"}], ",", 
       RowBox[{"_", "?", "MatrixQ"}], ",", "All"}], "]"}], ",", 
     RowBox[{"Joined", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"True", ",", "True", ",", "True", ",", "True"}], "}"}]}], ",", 
     RowBox[{"Frame", "\[Rule]", " ", "True"}], ",", 
     RowBox[{"FrameLabel", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"massLabel", ",", "couplingLabel"}], "}"}]}], ",", 
     RowBox[{"FrameStyle", "\[Rule]", 
      RowBox[{"Directive", "[", 
       RowBox[{"Black", ",", " ", "23", ",", "Black"}], "]"}]}], ",", 
     RowBox[{"PlotStyle", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{"Thick", ",", "Gray"}], "}"}], "}"}]}], ",", 
     RowBox[{"Filling", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"1", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"True", ",", 
           RowBox[{"Directive", "[", 
            RowBox[{"Gray", ",", 
             RowBox[{"Opacity", "[", "0.3", "]"}]}], "]"}]}], "}"}]}], ",", 
        RowBox[{"2", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"True", ",", 
           RowBox[{"Directive", "[", 
            RowBox[{"Gray", ",", 
             RowBox[{"Opacity", "[", "0.3", "]"}]}], "]"}]}], "}"}]}], ",", 
        RowBox[{"3", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"True", ",", 
           RowBox[{"Directive", "[", 
            RowBox[{"Gray", ",", 
             RowBox[{"Opacity", "[", "0.3", "]"}]}], "]"}]}], "}"}]}], ",", 
        RowBox[{"4", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"True", ",", 
           RowBox[{"Directive", "[", 
            RowBox[{"Gray", ",", 
             RowBox[{"Opacity", "[", "0.3", "]"}]}], "]"}]}], "}"}]}]}], 
       "}"}]}], ",", 
     RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
     RowBox[{"PlotRange", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"1.01", 
           RowBox[{"mminmaxOverall", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], ",", 
          RowBox[{"1.1", 
           RowBox[{"mminmaxOverall", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"0.3", 
           RowBox[{"Min", "[", 
            RowBox[{"Flatten", "[", "sensregions", "]"}], "]"}]}], ",", 
          RowBox[{"0.99", 
           RowBox[{"couplingminmaxOverall", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}]}], "}"}]}], ",", 
     RowBox[{"PlotLabel", "\[Rule]", 
      RowBox[{"Style", "[", 
       RowBox[{
        RowBox[{"Row", "[", 
         RowBox[{"{", 
          RowBox[{
          "GivenExperimentForSensitivityComputation", 
           ",", "\"\<, \!\(\*SubscriptBox[\(N\), \(events\)]\) \
\[GreaterEqual] \>\"", ",", "NevMinVal", 
           ",", "\"\<, \!\(\*SubscriptBox[\(Br\), \(h -> SS\)]\) = \>\"", ",",
            "BrhToSSval"}], "}"}], "]"}], ",", "18", ",", "Black"}], 
       "]"}]}]}], "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"ListLogLogPlot", "[", 
    RowBox[{
     RowBox[{"Cases", "[", 
      RowBox[{"sensregions", ",", 
       RowBox[{"_", "?", "MatrixQ"}], ",", "All"}], "]"}], ",", 
     RowBox[{"Joined", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"True", ",", "True", ",", "True", ",", "True"}], "}"}]}], ",", 
     RowBox[{"PlotStyle", "\[Rule]", "plotstylelist"}], ",", 
     RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
     RowBox[{"PlotRange", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"1.01", 
           RowBox[{"mminmaxOverall", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], ",", 
          RowBox[{"1.1", 
           RowBox[{"mminmaxOverall", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"couplingminmaxOverall", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{"Max", "[", 
           RowBox[{"0.2", ",", 
            RowBox[{"0.99", 
             RowBox[{"couplingminmaxOverall", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}]}], "]"}]}], "}"}]}], "}"}]}]}],
     "]"}], ",", 
   RowBox[{"LogLogPlot", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", "1", ",", "10"}], "}"}], ",", 
     RowBox[{"PlotStyle", "\[Rule]", 
      RowBox[{"DeleteDuplicates", "[", "plotstylelist", "]"}]}], ",", 
     RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
     RowBox[{"PlotRange", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"1.01", 
           RowBox[{"mminmaxOverall", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], ",", 
          RowBox[{"1.1", 
           RowBox[{"mminmaxOverall", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"couplingminmaxOverall", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{"Max", "[", 
           RowBox[{"0.2", ",", 
            RowBox[{"0.99", 
             RowBox[{"couplingminmaxOverall", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}]}], "]"}]}], "}"}]}], "}"}]}], ",", 
     RowBox[{"PlotLegends", "\[Rule]", 
      RowBox[{"Placed", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Style", "[", 
           RowBox[{"#", ",", "15"}], "]"}], "&"}], "/@", "legends"}], ",", 
        RowBox[{"{", 
         RowBox[{"0.2", ",", "0.15"}], "}"}]}], "]"}]}]}], "]"}], ",", 
   RowBox[{"Graphics", "[", 
    RowBox[{"{", 
     RowBox[{"Text", "[", 
      RowBox[{
       RowBox[{"Style", "[", 
        RowBox[{"\"\<Excluded\>\"", ",", "24", ",", "Black"}], "]"}], ",", 
       RowBox[{"Scaled", "[", 
        RowBox[{"{", 
         RowBox[{"0.7", ",", "0.95"}], "}"}], "]"}]}], "]"}], "}"}], "]"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Show", "[", 
    RowBox[{
     RowBox[{"ListLogLogPlot", "[", 
      RowBox[{
       RowBox[{"Cases", "[", 
        RowBox[{
         RowBox[{"ExcludedRegions", "[", "LLPdirName", "]"}], ",", 
         RowBox[{"_", "?", "MatrixQ"}], ",", "All"}], "]"}], ",", 
       RowBox[{"Joined", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"True", ",", "True", ",", "True", ",", "True"}], "}"}]}], ",", 
       RowBox[{"Frame", "\[Rule]", " ", "True"}], ",", 
       RowBox[{"FrameLabel", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"\"\<\!\(\*SubscriptBox[\(m\), \(S\)]\) [GeV]\>\"", " ", ",",
           " ", "\"\<\!\(\*SuperscriptBox[\(\[Theta]\), \(2\)]\)\>\""}], 
         "}"}]}], ",", 
       RowBox[{"FrameStyle", "\[Rule]", 
        RowBox[{"Directive", "[", 
         RowBox[{"Black", ",", " ", "23"}], "]"}]}], ",", 
       RowBox[{"PlotStyle", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{"Thick", ",", "Gray"}], "}"}], "}"}]}], ",", 
       RowBox[{"Filling", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"1", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"True", ",", 
             RowBox[{"Directive", "[", 
              RowBox[{"Gray", ",", 
               RowBox[{"Opacity", "[", "0.3", "]"}]}], "]"}]}], "}"}]}], ",", 
          RowBox[{"2", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"True", ",", 
             RowBox[{"Directive", "[", 
              RowBox[{"Gray", ",", 
               RowBox[{"Opacity", "[", "0.3", "]"}]}], "]"}]}], "}"}]}], ",", 
          RowBox[{"3", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"True", ",", 
             RowBox[{"Directive", "[", 
              RowBox[{"Gray", ",", 
               RowBox[{"Opacity", "[", "0.3", "]"}]}], "]"}]}], "}"}]}], ",", 
          RowBox[{"4", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"True", ",", 
             RowBox[{"Directive", "[", 
              RowBox[{"Gray", ",", 
               RowBox[{"Opacity", "[", "0.3", "]"}]}], "]"}]}], "}"}]}]}], 
         "}"}]}], ",", 
       RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
       RowBox[{"PlotRange", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"1.01", 
             RowBox[{"mminmaxOverall", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], ",", 
            RowBox[{"1.1", 
             RowBox[{"mminmaxOverall", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"0.3", "*", 
             RowBox[{"Min", "[", 
              RowBox[{"Flatten", "[", "Sens", "]"}], "]"}]}], ",", 
            RowBox[{"couplingminmaxOverall", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "}"}]}], ",", 
       RowBox[{"PlotLabel", "\[Rule]", 
        RowBox[{"Style", "[", 
         RowBox[{
          RowBox[{"Row", "[", 
           RowBox[{"{", 
            
            RowBox[{"\"\<\!\(\*SubscriptBox[\(N\), \(events\)]\) \
\[GreaterEqual] \>\"", ",", "NevMinVal"}], "}"}], "]"}], ",", "18", ",", 
          "Black"}], "]"}]}]}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"ListLogLogPlot", "[", 
      RowBox[{
       RowBox[{"Cases", "[", 
        RowBox[{"sens", ",", 
         RowBox[{"_", "?", "MatrixQ"}], ",", "All"}], "]"}], ",", 
       RowBox[{"Joined", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"True", ",", "True", ",", "True", ",", "True"}], "}"}]}], ",", 
       RowBox[{"PlotStyle", "\[Rule]", 
        RowBox[{"Flatten", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"ConstantArray", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"Thick", ",", "Blue"}], "}"}], ",", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"MatrixQ", "[", "sens", "]"}], ",", "1", ",", 
               RowBox[{"Length", "@", "sens"}]}], "]"}]}], "]"}], "}"}], ",", 
          "1"}], "]"}]}], ",", 
       RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
       RowBox[{"PlotRange", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"1.01", 
             RowBox[{"mminmaxOverall", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], ",", 
            RowBox[{"1.1", 
             RowBox[{"mminmaxOverall", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"0.3", "*", 
             RowBox[{"Min", "[", 
              RowBox[{"Flatten", "[", "Sens", "]"}], "]"}]}], ",", 
            RowBox[{"0.99", 
             RowBox[{"couplingminmaxOverall", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}]}], "}"}]}], ",", 
       RowBox[{"PlotLabel", "\[Rule]", 
        RowBox[{"Style", "[", 
         RowBox[{
          RowBox[{"Row", "[", 
           RowBox[{"{", 
            
            RowBox[{"\"\<\!\(\*SubscriptBox[\(N\), \(events\)]\) \
\[GreaterEqual] \>\"", ",", "NevMinVal"}], "}"}], "]"}], ",", "18", ",", 
          "Black"}], "]"}]}], ",", 
       RowBox[{"PlotLegends", "\[Rule]", 
        RowBox[{"Placed", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Style", "[", 
             RowBox[{"#", ",", "15"}], "]"}], "&"}], "/@", 
           RowBox[{"{", "ExperimentFolder", "}"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"0.2", ",", "0.15"}], "}"}]}], "]"}]}]}], "]"}], ",", 
     RowBox[{"Graphics", "[", 
      RowBox[{"{", 
       RowBox[{"Text", "[", 
        RowBox[{
         RowBox[{"Style", "[", 
          RowBox[{"\"\<Excluded\>\"", ",", "24", ",", "Black"}], "]"}], ",", 
         RowBox[{"Scaled", "[", 
          RowBox[{"{", 
           RowBox[{"0.7", ",", "0.95"}], "}"}], "]"}]}], "]"}], "}"}], 
      "]"}]}], "]"}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.8886404491464033`*^9, 3.8886404510930166`*^9}, {
   3.888640628876172*^9, 3.8886406463821764`*^9}, {3.8886406837495556`*^9, 
   3.8886406843144956`*^9}, {3.8886410684305754`*^9, 
   3.8886413056057186`*^9}, {3.888641471390818*^9, 3.8886415338395844`*^9}, {
   3.8896724053195105`*^9, 3.889672405439672*^9}, {3.8902858684120636`*^9, 
   3.8902858886879153`*^9}, {3.8910647994035606`*^9, 3.891064802710083*^9}, {
   3.8922863669128327`*^9, 3.8922863669228373`*^9}, {3.8925470759384756`*^9, 
   3.8925470764903564`*^9}, {3.892566669885436*^9, 3.8925666702753496`*^9}, {
   3.892910802053583*^9, 3.8929108020615845`*^9}, {3.893228691501322*^9, 
   3.893228691622405*^9}, {3.893572166996152*^9, 3.893572172347583*^9}, {
   3.894612840035421*^9, 3.8946128439239035`*^9}, {3.895054609165634*^9, 
   3.895054641711184*^9}, {3.895054739583967*^9, 3.89505473972333*^9}, {
   3.895054840823753*^9, 3.895054842946886*^9}, 3.895079856519951*^9, {
   3.895080408543869*^9, 3.895080408681652*^9}, {3.8956476597671003`*^9, 
   3.895647711784693*^9}, 3.8956480109510765`*^9, {3.89564815235528*^9, 
   3.895648153613762*^9}, {3.895648197346319*^9, 3.8956482206462717`*^9}, {
   3.8956490945070057`*^9, 3.895649110966339*^9}, {3.8956495001549854`*^9, 
   3.895649519825077*^9}, {3.895649753175002*^9, 3.8956497562363443`*^9}, {
   3.8961545900577*^9, 3.896154590772591*^9}, {3.896521614438037*^9, 
   3.896521616204466*^9}, {3.8965958972291527`*^9, 3.896595900321556*^9}, {
   3.8967083833693357`*^9, 3.8967083935808964`*^9}, {3.897492615765958*^9, 
   3.897492618552369*^9}, 3.89755259402772*^9, {3.906194745273999*^9, 
   3.9061947577645397`*^9}, {3.9072584554870186`*^9, 
   3.9072584636828003`*^9}, {3.9121551604207964`*^9, 3.91215528078347*^9}, {
   3.9121553455970964`*^9, 3.9121553791287093`*^9}, {3.913825601802038*^9, 
   3.9138256018283825`*^9}, 3.913828872147852*^9, {3.913872017803899*^9, 
   3.9138720220996246`*^9}, {3.9139666886557436`*^9, 3.913966696028305*^9}, {
   3.9139667676129346`*^9, 3.9139667936065636`*^9}, {3.9139668247377367`*^9, 
   3.913966876442911*^9}, {3.913966915493513*^9, 3.913966934010207*^9}, {
   3.914668290748907*^9, 3.9146683050258846`*^9}, {3.915262570252824*^9, 
   3.9152625729945917`*^9}, {3.915296249421674*^9, 3.9152962653043137`*^9}, {
   3.9152963059019537`*^9, 3.9152963626386642`*^9}, {3.915296429230944*^9, 
   3.9152964532724133`*^9}, {3.9156430966338673`*^9, 
   3.9156430966656356`*^9}, {3.9168196369711914`*^9, 3.91681963712529*^9}, {
   3.91958801395323*^9, 3.9195880155419025`*^9}, {3.9345998700166073`*^9, 
   3.934599991450918*^9}, 3.9346021140428286`*^9, 3.934602156023427*^9, 
   3.9346022101747437`*^9, {3.9526788569911575`*^9, 3.95267886057675*^9}, {
   3.9527391483175316`*^9, 3.952739169747677*^9}, {3.954697833946005*^9, 
   3.954697835441103*^9}},
 CellTags->"Sensitivity-computation",
 CellLabel->
  "In[226]:=",ExpressionUUID->"393530ae-64d6-4ec8-b59b-3746dc54333d"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Uncertainty region computation", "Chapter",
 CellChangeTimes->{{3.888640440992809*^9, 3.888640444396226*^9}, {
  3.9546977875101223`*^9, 3.9546977909899178`*^9}},
 CellTags->
  "Sensitivity-computation",ExpressionUUID->"f693b343-a2a4-604f-882b-\
f5291d998abb"],

Cell[CellGroupData[{

Cell["Defining the minimal/maximal number of events", "Section",
 CellChangeTimes->{{3.9526691927510204`*^9, 3.952669197462694*^9}, {
  3.9546979300870686`*^9, 3.954697930354412*^9}},
 CellTags->
  "Sensitivity-computation",ExpressionUUID->"29eddb37-952a-554b-9243-\
fb8fc4e1927a"],

Cell[BoxData[
 RowBox[{"If", "[", 
  RowBox[{"ifUncCalc", ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"uncchoices", "=", 
     RowBox[{"{", 
      RowBox[{"\"\<Lower\>\"", ",", "\"\<Central\>\"", ",", "\"\<Upper\>\""}],
       "}"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"NevIntUnc", ",", "NevTemp"}], "}"}], "//", "Clear"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"Production", " ", "only"}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{"IfBremUnc", "=", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"ToString", "[", 
          RowBox[{"Head", "[", "BremChannelsList", "]"}], "]"}], 
         "==", "\"\<List\>\""}], "&&", 
        RowBox[{
         RowBox[{"Select", "[", 
          RowBox[{"SelectedProduction", ",", 
           RowBox[{
            RowBox[{"StringContainsQ", "[", 
             RowBox[{"#", ",", "\"\<Bremsstrahlung\>\""}], "]"}], "&"}]}], 
          "]"}], "!=", 
         RowBox[{"{", "}"}]}]}], ",", 
       RowBox[{
        RowBox[{"Select", "[", 
         RowBox[{"BremChannelsList", ",", 
          RowBox[{
           RowBox[{"StringContainsQ", "[", 
            RowBox[{"#", ",", "\"\<Central\>\""}], "]"}], "&"}]}], "]"}], "!=", 
        RowBox[{"{", "}"}]}], ",", "False"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"IfDrellYanUnc", "=", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"ToString", "[", 
          RowBox[{"Head", "[", "DrellYanChannelsList", "]"}], "]"}], 
         "==", "\"\<List\>\""}], "&&", 
        RowBox[{
         RowBox[{"Select", "[", 
          RowBox[{"SelectedProduction", ",", 
           RowBox[{
            RowBox[{"StringContainsQ", "[", 
             RowBox[{"#", ",", "\"\<DrellYan\>\""}], "]"}], "&"}]}], "]"}], "!=", 
         RowBox[{"{", "}"}]}]}], ",", 
       RowBox[{
        RowBox[{"Select", "[", 
         RowBox[{"DrellYanChannelsList", ",", 
          RowBox[{
           RowBox[{"StringContainsQ", "[", 
            RowBox[{"#", ",", "\"\<Central\>\""}], "]"}], "&"}]}], "]"}], "!=", 
        RowBox[{"{", "}"}]}], ",", "False"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"IfProdUnc", "=", 
     RowBox[{"IfBremUnc", "||", "IfDrellYanUnc"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"ProductionNoDrellYanBrem", "=", 
     RowBox[{"Select", "[", 
      RowBox[{"SelectedProduction", ",", 
       RowBox[{
        RowBox[{"!", 
         RowBox[{"StringContainsQ", "[", 
          RowBox[{"#", ",", 
           RowBox[{"{", 
            RowBox[{"\"\<Bremsstrahlung\>\"", ",", "\"\<DrellYan\>\""}], 
            "}"}]}], "]"}]}], "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"Do", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"ProductionListUnc", "[", "t", "]"}], "=", 
        "ProductionNoDrellYanBrem"}], ";"}], "\[IndentingNewLine]", ",", 
      RowBox[{"{", 
       RowBox[{"t", ",", "uncchoices"}], "}"}]}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{"IfBremUnc", ",", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"bremChoice", "[", "t", "]"}], "=", 
          RowBox[{
           RowBox[{"Select", "[", 
            RowBox[{"BremChannelsList", ",", 
             RowBox[{
              RowBox[{"StringContainsQ", "[", 
               RowBox[{"#", ",", "t"}], "]"}], "&"}]}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"ProductionListUnc", "[", "t", "]"}], "=", 
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"ProductionListUnc", "[", "t", "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"bremChoice", "[", "t", "]"}], "}"}]}], "]"}]}]}], 
        "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"t", ",", "uncchoices"}], "}"}]}], "]"}]}], 
     "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{"IfDrellYanUnc", ",", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"drellYanChoice", "[", "t", "]"}], "=", 
          RowBox[{
           RowBox[{"Select", "[", 
            RowBox[{"DrellYanChannelsList", ",", 
             RowBox[{
              RowBox[{"StringContainsQ", "[", 
               RowBox[{"#", ",", "t"}], "]"}], "&"}]}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"ProductionListUnc", "[", "t", "]"}], "=", 
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"ProductionListUnc", "[", "t", "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"drellYanChoice", "[", "t", "]"}], "}"}]}], "]"}]}]}], 
        "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"t", ",", "uncchoices"}], "}"}]}], "]"}]}], 
     "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"IfDecayUnc", "=", 
     RowBox[{
      RowBox[{"Select", "[", 
       RowBox[{"decaydescriptions", ",", 
        RowBox[{
         RowBox[{"StringContainsQ", "[", 
          RowBox[{"#", ",", "\"\<Central\>\""}], "]"}], "&"}]}], "]"}], "!=", 
      RowBox[{"{", "}"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{"IfDecayUnc", ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"decChoice", "[", "t", "]"}], "=", 
          RowBox[{
           RowBox[{"Select", "[", 
            RowBox[{"decaydescriptions", ",", 
             RowBox[{
              RowBox[{"StringContainsQ", "[", 
               RowBox[{"#", ",", "t"}], "]"}], "&"}]}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"t", ",", "uncchoices"}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"decayDescrProd", "=", 
        RowBox[{"decChoice", "[", "\"\<Central\>\"", "]"}]}], ";"}], 
      "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
      RowBox[{"decayDescrProd", "=", 
       RowBox[{"decaydescriptions", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}]}], "\[IndentingNewLine]", "]"}], ";",
     "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{"IfProdUnc", ",", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"NevIntUnc", "[", 
           
           RowBox[{"\"\<Production\>\"", ",", "t", ",", "mLLP_", ",", 
            "\[Theta]2_", ",", "BrhToSS_"}], "]"}], "=", 
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{"NevInt", "[", 
             RowBox[{
             "mLLP", ",", "\[Theta]2", ",", "BrhToSS", ",", "prod", ",", 
              "decayDescrProd"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"prod", ",", 
              RowBox[{"ProductionListUnc", "[", "t", "]"}]}], "}"}]}], 
           "]"}]}], ";"}], "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"t", ",", "uncchoices"}], "}"}]}], "]"}]}], 
     "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{"IfDecayUnc", ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"prodlist", "=", 
           RowBox[{"ProductionListUnc", "[", "\"\<Central\>\"", "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"NevTemp", "[", 
            
            RowBox[{"\"\<Decay\>\"", ",", "t", ",", "mLLP_", ",", 
             "\[Theta]2_", ",", "\"\<Mixing\>\""}], "]"}], "=", 
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{"NevInt", "[", 
              RowBox[{"mLLP", ",", "\[Theta]2", ",", "BrhToSS", ",", "prod", ",", 
               RowBox[{"decChoice", "[", "t", "]"}]}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"prod", ",", 
               RowBox[{"Select", "[", 
                RowBox[{"prodlist", ",", 
                 RowBox[{
                  RowBox[{"StringContainsQ", "[", 
                   RowBox[{"#", ",", "\"\<mixing\>\""}], "]"}], "&"}]}], 
                "]"}]}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"NevTemp", "[", 
            
            RowBox[{"\"\<Decay\>\"", ",", "t", ",", "mLLP_", ",", 
             "\[Theta]2_", ",", "BrhToSS_", ",", "\"\<Quartic\>\""}], "]"}], "=", 
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{"NevInt", "[", 
              RowBox[{"mLLP", ",", "\[Theta]2", ",", "BrhToSS", ",", "prod", ",", 
               RowBox[{"decChoice", "[", "t", "]"}]}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"prod", ",", 
               RowBox[{"Select", "[", 
                RowBox[{"prodlist", ",", 
                 RowBox[{
                  RowBox[{"StringContainsQ", "[", 
                   RowBox[{"#", ",", "\"\<quartic\>\""}], "]"}], "&"}]}], 
                "]"}]}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{"IfProdUnc", ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"prodlist", "=", 
              RowBox[{"ProductionListUnc", "[", "t", "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"NevTemp", "[", 
               
               RowBox[{"\"\<All\>\"", ",", "t", ",", "mLLP_", ",", 
                "\[Theta]2_", ",", "\"\<Mixing\>\""}], "]"}], "=", 
              RowBox[{"Sum", "[", 
               RowBox[{
                RowBox[{"NevInt", "[", 
                 RowBox[{
                 "mLLP", ",", "\[Theta]2", ",", "BrhToSS", ",", "prod", ",", 
                  RowBox[{"decChoice", "[", "t", "]"}]}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"prod", ",", 
                  RowBox[{"Select", "[", 
                   RowBox[{"prodlist", ",", 
                    RowBox[{
                    RowBox[{"StringContainsQ", "[", 
                    RowBox[{"#", ",", "\"\<mixing\>\""}], "]"}], "&"}]}], 
                   "]"}]}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"NevTemp", "[", 
               
               RowBox[{"\"\<All\>\"", ",", "t", ",", "mLLP_", ",", 
                "\[Theta]2_", ",", "BrhToSS_", ",", "\"\<Quartic\>\""}], 
               "]"}], "=", 
              RowBox[{"Sum", "[", 
               RowBox[{
                RowBox[{"NevInt", "[", 
                 RowBox[{
                 "mLLP", ",", "\[Theta]2", ",", "BrhToSS", ",", "prod", ",", 
                  RowBox[{"decChoice", "[", "t", "]"}]}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"prod", ",", 
                  RowBox[{"Select", "[", 
                   RowBox[{"prodlist", ",", 
                    RowBox[{
                    RowBox[{"StringContainsQ", "[", 
                    RowBox[{"#", ",", "\"\<quartic\>\""}], "]"}], "&"}]}], 
                   "]"}]}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", ",",
             "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"NevTemp", "[", 
               
               RowBox[{"\"\<All\>\"", ",", "t", ",", "mLLP_", ",", 
                "\[Theta]2_", ",", "\"\<Mixing\>\""}], "]"}], "=", 
              RowBox[{"NevTemp", "[", 
               
               RowBox[{"\"\<Decay\>\"", ",", "t", ",", "mLLP", ",", 
                "\[Theta]2", ",", "\"\<Mixing\>\""}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"NevTemp", "[", 
               
               RowBox[{"\"\<All\>\"", ",", "t", ",", "mLLP_", ",", 
                "\[Theta]2_", ",", "BrhToSS_", ",", "\"\<Quartic\>\""}], 
               "]"}], "=", 
              RowBox[{"NevTemp", "[", 
               
               RowBox[{"\"\<Decay\>\"", ",", "t", ",", "mLLP", ",", 
                "\[Theta]2", ",", "BrhToSS", ",", "\"\<Quartic\>\""}], 
               "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}]}], 
         "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"t", ",", "uncchoices"}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"signaturesDec", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"Keys", "[", 
           RowBox[{"DownValues", "@", "NevTemp"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "1", ",", "1"}], "]"}], "]"}], "//", 
         "DeleteDuplicates"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"NevIntTabular", "[", 
            RowBox[{"sign", ",", "\"\<Mixing\>\""}], "]"}], "=", 
           RowBox[{
            RowBox[{"Flatten", "[", 
             RowBox[{
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"m", ",", "th", ",", 
                  RowBox[{"NevTemp", "[", 
                   RowBox[{
                   "sign", ",", "\"\<Lower\>\"", ",", "m", ",", "th", 
                    ",", "\"\<Mixing\>\""}], "]"}], ",", 
                  RowBox[{"NevTemp", "[", 
                   RowBox[{
                   "sign", ",", "\"\<Central\>\"", ",", "m", ",", "th", 
                    ",", "\"\<Mixing\>\""}], "]"}], ",", 
                  RowBox[{"NevTemp", "[", 
                   RowBox[{
                   "sign", ",", "\"\<Upper\>\"", ",", "m", ",", "th", 
                    ",", "\"\<Mixing\>\""}], "]"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"m", ",", "mgridfull"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"th", ",", 
                  RowBox[{"couplinggrid", "[", 
                   RowBox[{
                    RowBox[{"ProductionChannelsBaseline", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", "decayDescrProd"}], 
                   "]"}]}], "}"}]}], "]"}], ",", "1"}], "]"}], "//", 
            "Developer`ToPackedArray"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"NevIntTabular", "[", 
            RowBox[{"sign", ",", "\"\<Quartic\>\""}], "]"}], "=", 
           RowBox[{
            RowBox[{"Flatten", "[", 
             RowBox[{
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"m", ",", "th", ",", 
                  RowBox[{"NevTemp", "[", 
                   RowBox[{
                   "sign", ",", "\"\<Lower\>\"", ",", "m", ",", "th", ",", 
                    "BrhToSSreference", ",", "\"\<Quartic\>\""}], "]"}], ",", 
                  RowBox[{"NevTemp", "[", 
                   RowBox[{
                   "sign", ",", "\"\<Central\>\"", ",", "m", ",", "th", ",", 
                    "BrhToSSreference", ",", "\"\<Quartic\>\""}], "]"}], ",", 
                  RowBox[{"NevTemp", "[", 
                   RowBox[{
                   "sign", ",", "\"\<Upper\>\"", ",", "m", ",", "th", ",", 
                    "BrhToSSreference", ",", "\"\<Quartic\>\""}], "]"}]}], 
                 "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"m", ",", "mgridfull"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"th", ",", 
                  RowBox[{"couplinggrid", "[", 
                   RowBox[{
                    RowBox[{"ProductionChannelsBaseline", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", "decayDescrProd"}], 
                   "]"}]}], "}"}]}], "]"}], ",", "1"}], "]"}], "//", 
            "Developer`ToPackedArray"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"NevIntTemp", "[", 
            RowBox[{
            "sign", ",", "mLLP_", ",", "\[Theta]2_", ",", "BrhToSS_", 
             ",", "\"\<Mixing\>\"", ",", "\"\<Lower\>\""}], "]"}], "=", 
           RowBox[{
            RowBox[{
             RowBox[{"Interpolation", "[", 
              RowBox[{
               RowBox[{"Log", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"Min", "[", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ",", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "4", "]"}], "]"}], ",", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "5", "]"}], "]"}]}], "]"}], "+", 
                    SuperscriptBox["10", 
                    RowBox[{"-", "90."}]]}]}], "}"}], "&"}], "/@", 
                 RowBox[{"NevIntTabular", "[", 
                  RowBox[{"sign", ",", "\"\<Mixing\>\""}], "]"}]}], "]"}], ",", 
               RowBox[{"InterpolationOrder", "->", "1"}]}], "]"}], "[", 
             RowBox[{
              RowBox[{"Log", "[", "mLLP", "]"}], ",", 
              RowBox[{"Log", "[", "\[Theta]2", "]"}]}], "]"}], "//", 
            "Exp"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"NevIntTemp", "[", 
            RowBox[{
            "sign", ",", "mLLP_", ",", "\[Theta]2_", ",", "BrhToSS_", 
             ",", "\"\<Mixing\>\"", ",", "\"\<Upper\>\""}], "]"}], "=", 
           RowBox[{
            RowBox[{
             RowBox[{"Interpolation", "[", 
              RowBox[{
               RowBox[{"Log", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"Max", "[", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ",", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "4", "]"}], "]"}], ",", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "5", "]"}], "]"}]}], "]"}], "+", 
                    SuperscriptBox["10", 
                    RowBox[{"-", "90."}]]}]}], "}"}], "&"}], "/@", 
                 RowBox[{"NevIntTabular", "[", 
                  RowBox[{"sign", ",", "\"\<Mixing\>\""}], "]"}]}], "]"}], ",", 
               RowBox[{"InterpolationOrder", "->", "1"}]}], "]"}], "[", 
             RowBox[{
              RowBox[{"Log", "[", "mLLP", "]"}], ",", 
              RowBox[{"Log", "[", "\[Theta]2", "]"}]}], "]"}], "//", 
            "Exp"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"NevIntTemp", "[", 
            RowBox[{
            "sign", ",", "mLLP_", ",", "\[Theta]2_", ",", "BrhToSS_", 
             ",", "\"\<Mixing\>\"", ",", "\"\<Central\>\""}], "]"}], "=", 
           RowBox[{
            RowBox[{
             RowBox[{"Interpolation", "[", 
              RowBox[{
               RowBox[{"Log", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "4", "]"}], "]"}], "+", 
                    SuperscriptBox["10", 
                    RowBox[{"-", "90."}]]}]}], "}"}], "&"}], "/@", 
                 RowBox[{"NevIntTabular", "[", 
                  RowBox[{"sign", ",", "\"\<Mixing\>\""}], "]"}]}], "]"}], ",", 
               RowBox[{"InterpolationOrder", "->", "1"}]}], "]"}], "[", 
             RowBox[{
              RowBox[{"Log", "[", "mLLP", "]"}], ",", 
              RowBox[{"Log", "[", "\[Theta]2", "]"}]}], "]"}], "//", 
            "Exp"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"NevIntTemp", "[", 
            RowBox[{
            "sign", ",", "mLLP_", ",", "\[Theta]2_", ",", "BrhToSS_", 
             ",", "\"\<Quartic\>\"", ",", "\"\<Lower\>\""}], "]"}], "=", 
           RowBox[{
            FractionBox["BrhToSS", "BrhToSSreference"], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"Interpolation", "[", 
                RowBox[{
                 RowBox[{"Log", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"Min", "[", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ",", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "4", "]"}], "]"}], ",", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "5", "]"}], "]"}]}], "]"}], "+", 
                    SuperscriptBox["10", 
                    RowBox[{"-", "90."}]]}]}], "}"}], "&"}], "/@", 
                   RowBox[{"NevIntTabular", "[", 
                    RowBox[{"sign", ",", "\"\<Quartic\>\""}], "]"}]}], "]"}], 
                 ",", 
                 RowBox[{"InterpolationOrder", "->", "1"}]}], "]"}], "[", 
               RowBox[{
                RowBox[{"Log", "[", "mLLP", "]"}], ",", 
                RowBox[{"Log", "[", "\[Theta]2", "]"}]}], "]"}], "//", 
              "Exp"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"NevIntTemp", "[", 
            RowBox[{
            "sign", ",", "mLLP_", ",", "\[Theta]2_", ",", "BrhToSS_", 
             ",", "\"\<Quartic\>\"", ",", "\"\<Upper\>\""}], "]"}], "=", 
           RowBox[{
            FractionBox["BrhToSS", "BrhToSSreference"], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"Interpolation", "[", 
                RowBox[{
                 RowBox[{"Log", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"Max", "[", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ",", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "4", "]"}], "]"}], ",", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "5", "]"}], "]"}]}], "]"}], "+", 
                    SuperscriptBox["10", 
                    RowBox[{"-", "90."}]]}]}], "}"}], "&"}], "/@", 
                   RowBox[{"NevIntTabular", "[", 
                    RowBox[{"sign", ",", "\"\<Quartic\>\""}], "]"}]}], "]"}], 
                 ",", 
                 RowBox[{"InterpolationOrder", "->", "1"}]}], "]"}], "[", 
               RowBox[{
                RowBox[{"Log", "[", "mLLP", "]"}], ",", 
                RowBox[{"Log", "[", "\[Theta]2", "]"}]}], "]"}], "//", 
              "Exp"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"NevIntTemp", "[", 
            RowBox[{
            "sign", ",", "mLLP_", ",", "\[Theta]2_", ",", "BrhToSS_", 
             ",", "\"\<Quartic\>\"", ",", "\"\<Central\>\""}], "]"}], "=", 
           RowBox[{
            FractionBox["BrhToSS", "BrhToSSreference"], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"Interpolation", "[", 
                RowBox[{
                 RowBox[{"Log", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "4", "]"}], "]"}], "+", 
                    SuperscriptBox["10", 
                    RowBox[{"-", "90."}]]}]}], "}"}], "&"}], "/@", 
                   RowBox[{"NevIntTabular", "[", 
                    RowBox[{"sign", ",", "\"\<Quartic\>\""}], "]"}]}], "]"}], 
                 ",", 
                 RowBox[{"InterpolationOrder", "->", "1"}]}], "]"}], "[", 
               RowBox[{
                RowBox[{"Log", "[", "mLLP", "]"}], ",", 
                RowBox[{"Log", "[", "\[Theta]2", "]"}]}], "]"}], "//", 
              "Exp"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"Do", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"NevIntUnc", "[", 
               RowBox[{
               "sign", ",", "t", ",", "mLLP_", ",", "\[Theta]2_", ",", 
                "BrhToSS_"}], "]"}], "=", 
              RowBox[{
               RowBox[{"NevIntTemp", "[", 
                RowBox[{
                "sign", ",", "mLLP", ",", "\[Theta]2", ",", "BrhToSS", 
                 ",", "\"\<Mixing\>\"", ",", "t"}], "]"}], "+", 
               RowBox[{"NevIntTemp", "[", 
                RowBox[{
                "sign", ",", "mLLP", ",", "\[Theta]2", ",", "BrhToSS", 
                 ",", "\"\<Quartic\>\"", ",", "t"}], "]"}]}]}], ";"}], 
            "\[IndentingNewLine]", ",", 
            RowBox[{"{", 
             RowBox[{"t", ",", "uncchoices"}], "}"}]}], "]"}]}], 
         "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"sign", ",", 
           RowBox[{"{", 
            RowBox[{"\"\<Decay\>\"", ",", "\"\<All\>\""}], "}"}]}], "}"}]}], 
        "]"}]}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"signaturesAvailable", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"Keys", "[", 
        RowBox[{"DownValues", "@", "NevIntUnc"}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "1", ",", "1"}], "]"}], "]"}], "//", 
      "DeleteDuplicates"}]}]}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.952669246864132*^9, 3.952669577635622*^9}, {
   3.952669622669855*^9, 3.952669684562395*^9}, {3.9526702099235783`*^9, 
   3.9526702407725925`*^9}, {3.9526702746832294`*^9, 3.952670475923252*^9}, {
   3.9526706639787464`*^9, 3.9526706654799576`*^9}, {3.952670699258375*^9, 
   3.9526709105510406`*^9}, {3.952670947749298*^9, 3.9526709500917435`*^9}, {
   3.9526722325099697`*^9, 3.9526724946985207`*^9}, {3.952672893297964*^9, 
   3.9526729556200256`*^9}, {3.952673001706503*^9, 3.9526730219554214`*^9}, {
   3.952673409585371*^9, 3.952673484783745*^9}, {3.9526735239465694`*^9, 
   3.9526735410998554`*^9}, {3.952673654822609*^9, 3.952673704478693*^9}, {
   3.952673739420307*^9, 3.952673807462551*^9}, {3.9526738451326294`*^9, 
   3.9526738520066395`*^9}, {3.95267397052594*^9, 3.9526739980021763`*^9}, {
   3.95267538758288*^9, 3.952675403925665*^9}, {3.9526968905948467`*^9, 
   3.9526969468405113`*^9}, {3.952697003049116*^9, 3.9526970032389164`*^9}, {
   3.9526973992285023`*^9, 3.952697412185951*^9}, {3.952697604292362*^9, 
   3.9526976044711685`*^9}, {3.9526976450688953`*^9, 3.952697717143368*^9}, {
   3.9526978048144894`*^9, 3.9526978415109634`*^9}, {3.952697887962982*^9, 
   3.9526978934537926`*^9}, {3.9526979486176376`*^9, 3.952697964026335*^9}, {
   3.952698253076996*^9, 3.9526982545432777`*^9}, {3.9526982948716717`*^9, 
   3.952698310859133*^9}, {3.9526984280353947`*^9, 3.952698450520426*^9}, 
   3.9526985103986053`*^9, {3.9527375846751175`*^9, 3.9527376114154987`*^9}, {
   3.9546968675029964`*^9, 3.9546969326463966`*^9}, {3.9546971734265137`*^9, 
   3.954697200814169*^9}, {3.9546974126110535`*^9, 3.9546974135107784`*^9}, {
   3.9546974589443684`*^9, 3.9546974619019184`*^9}, 3.954697507134865*^9, {
   3.95469759951486*^9, 3.9546976021860733`*^9}, {3.954697640596115*^9, 
   3.954697649426113*^9}},
 CellTags->"Sensitivity-computation",
 CellLabel->
  "In[232]:=",ExpressionUUID->"33268a1f-1f9f-6249-b432-49d5c6bf53ad"]
}, Closed]],

Cell[CellGroupData[{

Cell["Computing the uncertainty", "Section",
 CellChangeTimes->{{3.9526691927510204`*^9, 3.952669197462694*^9}, {
  3.9546979300870686`*^9, 3.9546979374442253`*^9}},
 CellTags->
  "Sensitivity-computation",ExpressionUUID->"5659e288-d25b-6f4c-8df6-\
c5921e611b1b"],

Cell[BoxData[
 RowBox[{"If", "[", 
  RowBox[{"ifUncCalc", ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"signaturesAvailable", "!=", 
       RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"UncertaintyExtractor", "[", 
         RowBox[{
         "signature_", ",", "Npot_", ",", "BrhToSSval_", ",", "NevMin_"}], 
         "]"}], ":=", 
        RowBox[{"Module", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"RegSens", ",", "SensTemp"}], "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Do", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"NevTot", "[", 
                RowBox[{"mLLP_", ",", "\[Theta]2_", ",", "t"}], "]"}], "=", 
               RowBox[{"NevIntUnc", "[", 
                RowBox[{
                "signature", ",", "t", ",", "mLLP", ",", "\[Theta]2", ",", 
                 "BrhToSSval"}], "]"}]}], ";"}], "\[IndentingNewLine]", ",", 
             RowBox[{"{", 
              RowBox[{"t", ",", "uncchoices"}], "}"}]}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"RegUnc", "=", 
            RowBox[{"RegionPlot", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 FractionBox["Npot", "NpotDefault"], 
                 RowBox[{"NevTot", "[", 
                  RowBox[{
                   SuperscriptBox["10", "mLLP"], ",", 
                   SuperscriptBox["10", "\[Epsilon]2"], 
                   ",", "\"\<Lower\>\""}], "]"}]}], "<=", "NevMin"}], "&&", 
               RowBox[{
                RowBox[{
                 FractionBox["Npot", "NpotDefault"], 
                 RowBox[{"NevTot", "[", 
                  RowBox[{
                   SuperscriptBox["10", "mLLP"], ",", 
                   SuperscriptBox["10", "\[Epsilon]2"], 
                   ",", "\"\<Upper\>\""}], "]"}]}], ">=", "NevMin"}], "&&", 
               RowBox[{
                FractionBox[
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"NevTot", "[", 
                    RowBox[{
                    SuperscriptBox["10", "mLLP"], ",", 
                    SuperscriptBox["10", "\[Epsilon]2"], 
                    ",", "\"\<Upper\>\""}], "]"}], "-", 
                   RowBox[{"NevTot", "[", 
                    RowBox[{
                    SuperscriptBox["10", "mLLP"], ",", 
                    SuperscriptBox["10", "\[Epsilon]2"], 
                    ",", "\"\<Lower\>\""}], "]"}]}], ")"}], 
                 RowBox[{"Max", "[", 
                  RowBox[{
                   RowBox[{"NevTot", "[", 
                    RowBox[{
                    SuperscriptBox["10", "mLLP"], ",", 
                    SuperscriptBox["10", "\[Epsilon]2"], 
                    ",", "\"\<Upper\>\""}], "]"}], ",", 
                   SuperscriptBox["10", 
                    RowBox[{"-", "90."}]]}], "]"}]], ">", "0.1"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"mLLP", ",", 
                RowBox[{"Log10", "[", 
                 RowBox[{"mminmaxOverall", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
                RowBox[{"Log10", "[", 
                 RowBox[{"mminmaxOverall", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"\[Epsilon]2", ",", 
                RowBox[{"Log10", "[", 
                 RowBox[{"couplingminmaxOverall", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
                RowBox[{"Log10", "[", 
                 RowBox[{"couplingminmaxOverall", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "}"}], ",", 
              RowBox[{"PlotPoints", "->", "300"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"RegCentral", "=", 
            RowBox[{"RegionPlot", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                FractionBox["Npot", "NpotDefault"], 
                RowBox[{"NevTot", "[", 
                 RowBox[{
                  SuperscriptBox["10", "mLLP"], ",", 
                  SuperscriptBox["10", "\[Epsilon]2"], 
                  ",", "\"\<Central\>\""}], "]"}]}], ">=", "NevMin"}], ",", 
              RowBox[{"{", 
               RowBox[{"mLLP", ",", 
                RowBox[{"Log10", "[", 
                 RowBox[{"mminmaxOverall", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
                RowBox[{"Log10", "[", 
                 RowBox[{"mminmaxOverall", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"\[Epsilon]2", ",", 
                RowBox[{"Log10", "[", 
                 RowBox[{"couplingminmaxOverall", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
                RowBox[{"Log10", "[", 
                 RowBox[{"couplingminmaxOverall", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "}"}], ",", 
              RowBox[{"PlotPoints", "->", "300"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"UncTemp", "=", 
            RowBox[{"Cases", "[", 
             RowBox[{
              RowBox[{"Normal", "@", "RegUnc"}], ",", 
              RowBox[{
               RowBox[{"Line", "[", "x_", "]"}], "\[RuleDelayed]", "x"}], ",",
               "Infinity"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"CentrTemp", "=", 
            RowBox[{"Cases", "[", 
             RowBox[{
              RowBox[{"Normal", "@", "RegCentral"}], ",", 
              RowBox[{
               RowBox[{"Line", "[", "x_", "]"}], "\[RuleDelayed]", "x"}], ",",
               "Infinity"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"10", "^", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ",", 
                   RowBox[{"10", "^", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}], "&"}], "/@", 
                RowBox[{"s", "[", 
                 RowBox[{"[", "i", "]"}], "]"}]}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", "1", ",", 
                 RowBox[{"Length", "[", "s", "]"}], ",", "1"}], "}"}]}], 
              "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"s", ",", 
               RowBox[{"{", 
                RowBox[{"CentrTemp", ",", "UncTemp"}], "}"}]}], "}"}]}], 
            "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"DynamicModule", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"input0", "=", "0."}], ",", 
             RowBox[{"input1", "=", "NpotDefault"}], ",", 
             RowBox[{"input2", "=", "2.3"}], ",", "list", ",", "phrase"}], 
            "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{"DialogInput", "[", 
            RowBox[{"Column", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Style", "[", 
                RowBox[{"ExperimentFolder", ",", "Bold"}], "]"}], ",", 
               RowBox[{
               "TextCell", "[", "\"\<Enter Br(h\[Rule]SS):\>\"", "]"}], ",", 
               RowBox[{"InputField", "[", 
                RowBox[{
                 RowBox[{"Dynamic", "[", "input0", "]"}], ",", "Expression"}],
                 "]"}], ",", 
               RowBox[{
               "TextCell", 
                "[", "\"\<Enter the number of proton collisions:\>\"", "]"}], 
               ",", 
               RowBox[{"InputField", "[", 
                RowBox[{
                 RowBox[{"Dynamic", "[", "input1", "]"}], ",", "Expression"}],
                 "]"}], ",", 
               RowBox[{
               "TextCell", 
                "[", "\"\<Enter the value of N_ev,min for which the \
sensitivity will be computed:\>\"", "]"}], ",", 
               RowBox[{"InputField", "[", 
                RowBox[{
                 RowBox[{"Dynamic", "[", "input2", "]"}], ",", "Expression"}],
                 "]"}], ",", 
               RowBox[{"Button", "[", 
                RowBox[{"\"\<Submit\>\"", ",", 
                 RowBox[{"DialogReturn", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"BrhToSSval", ",", "NpotVal", ",", "NevMinVal"}], 
                    "}"}], "=", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"input0", ",", "input1", ",", "input2"}], "}"}], "//",
                     "N"}]}], "]"}], ",", 
                 RowBox[{"ImageSize", "->", "Automatic"}]}], "]"}]}], "}"}], 
             "]"}], "]"}]}], "]"}], ";"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            
            RowBox[{"\"\<Br(h\[Rule]SS)\>\"", 
             ",", "\"\<\!\(\*SubscriptBox[\(N\), \(PoT\)]\) for computation\>\
\"", ",", "\"\<\!\(\*SubscriptBox[\(N\), \(ev, min\)]\)\>\""}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"BrhToSSval", ",", "NpotVal", ",", "NevMinVal"}], "}"}]}],
           "}"}], "//", "TableForm"}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"sensitivityCenter", "[", "type", "]"}], ",", 
            RowBox[{"sensitivityUncertainty", "[", "type", "]"}]}], "}"}], "=", 
          RowBox[{"UncertaintyExtractor", "[", 
           RowBox[{
           "type", ",", "NpotVal", ",", "BrhToSSval", ",", "NevMinVal"}], 
           "]"}]}], "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"type", ",", "signaturesAvailable"}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"TabSens", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"type", ",", 
            RowBox[{"sensitivityCenter", "[", "type", "]"}], ",", 
            RowBox[{"sensitivityUncertainty", "[", "type", "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"type", ",", "signaturesAvailable"}], "}"}]}], "]"}]}], 
       ";"}], "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
      RowBox[{"TabSens", "=", 
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"\"\<None\>\"", ",", 
          RowBox[{
           RowBox[{"sens", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"-", "1"}], "]"}], "]"}], ",", 
          RowBox[{"{", "}"}]}], "}"}], "}"}]}]}], "\[IndentingNewLine]", 
     "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"filenameexport", "=", 
     RowBox[{"FileNameJoin", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"directory", "[", "\"\<Sensitivity-LLP-exp\>\"", "]"}], ",", 
        RowBox[{"ToString", "@", 
         RowBox[{"StringForm", "[", 
          
          RowBox[{"\"\<Uncertainties_``_at_``_BrhToSS=``_Nev=``_Npot=``.\>\"",
            ",", 
           RowBox[{"Sequence", "@@", 
            RowBox[{"{", 
             RowBox[{"LLPdirName", ",", "ExperimentFolder", ",", 
              RowBox[{"BrhToSSval", "//", "ToString"}], ",", 
              RowBox[{"NevMinVal", "//", "ToString"}], ",", 
              RowBox[{
               RowBox[{
                RowBox[{"SetPrecision", "[", 
                 RowBox[{
                  RowBox[{"NpotVal", "//", "N"}], ",", "3"}], "]"}], "//", 
                "CForm"}], "//", "ToString"}]}], "}"}]}]}], "]"}]}]}], "}"}], 
      "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"assocData", "=", 
     RowBox[{"Map", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{"\"\<Uncertainty source\>\"", "->", 
           RowBox[{"#", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], ",", 
          RowBox[{"\"\<Central sensitivity\>\"", "->", 
           RowBox[{"#", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], ",", 
          RowBox[{"\"\<Uncertainty\>\"", "->", 
           RowBox[{"#", "[", 
            RowBox[{"[", "3", "]"}], "]"}]}]}], "]"}], "&"}], ",", 
       "TabSens"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{"filenameexport", "<>", "\"\<mx\>\""}], ",", "TabSens", 
      ",", "\"\<MX\>\""}], "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{"filenameexport", "<>", "\"\<json\>\""}], ",", "assocData", 
      ",", "\"\<JSON\>\""}], "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"signaturesAvailable", "!=", 
       RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"Show", "[", 
       RowBox[{
        RowBox[{"ListLogLogPlot", "[", 
         RowBox[{
          RowBox[{"sensitivityUncertainty", "[", "\"\<All\>\"", "]"}], ",", 
          RowBox[{"Joined", "->", "True"}], ",", 
          RowBox[{"Filling", "->", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"i", "->", 
              RowBox[{"{", 
               RowBox[{"True", ",", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Blue", ",", 
                  RowBox[{"Opacity", "[", "0.1", "]"}]}], "]"}]}], "}"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", 
               RowBox[{"Length", "[", 
                RowBox[{"sensitivityUncertainty", "[", "\"\<All\>\"", "]"}], 
                "]"}], ",", "1"}], "}"}]}], "]"}]}], ",", 
          RowBox[{"ImageSize", "->", "Large"}], ",", 
          RowBox[{"Frame", "->", "True"}], ",", 
          RowBox[{"PlotStyle", "->", 
           RowBox[{"{", 
            RowBox[{"{", 
             RowBox[{"Thick", ",", "Blue", ",", 
              RowBox[{"Opacity", "[", "0.1", "]"}]}], "}"}], "}"}]}], ",", 
          RowBox[{"FrameStyle", "->", 
           RowBox[{"Directive", "[", 
            RowBox[{"Thick", ",", "Black", ",", "23"}], "]"}]}], ",", 
          RowBox[{"FrameLabel", "->", 
           RowBox[{"{", 
            RowBox[{"massLabel", ",", "couplingLabel"}], "}"}]}]}], "]"}], ",", 
        RowBox[{"ListLogLogPlot", "[", 
         RowBox[{
          RowBox[{"sensitivityCenter", "[", "\"\<All\>\"", "]"}], ",", 
          RowBox[{"Joined", "->", "True"}], ",", 
          RowBox[{"ImageSize", "->", "Large"}], ",", 
          RowBox[{"Frame", "->", "True"}], ",", 
          RowBox[{"PlotStyle", "->", 
           RowBox[{"{", 
            RowBox[{"{", 
             RowBox[{"Thick", ",", "Blue"}], "}"}], "}"}]}]}], "]"}]}], 
       "]"}]}], "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
  "]"}]], "Input",
 CellChangeTimes->{{3.952674061380926*^9, 3.952674107844225*^9}, {
   3.9526741427261257`*^9, 3.9526742523037376`*^9}, {3.9526743682644386`*^9, 
   3.952674395488739*^9}, 3.952674502935869*^9, {3.9526746361466827`*^9, 
   3.952674668843872*^9}, {3.9526747303442535`*^9, 3.9526747360769463`*^9}, {
   3.9526748054418163`*^9, 3.9526748060098743`*^9}, {3.9526777202542343`*^9, 
   3.952677773781927*^9}, {3.9526778099229374`*^9, 3.952677913526222*^9}, {
   3.9526788384633083`*^9, 3.952678844649328*^9}, 3.9526791612824993`*^9, {
   3.9526792355892715`*^9, 3.9526793237863045`*^9}, 3.9526797179492245`*^9, {
   3.95269761380608*^9, 3.952697616924114*^9}, 3.9526981994171505`*^9, {
   3.952699644503441*^9, 3.952699644740532*^9}, {3.9527376161953697`*^9, 
   3.95273766295998*^9}, {3.9527376970811863`*^9, 3.9527377022979183`*^9}, 
   3.9527382433298855`*^9, {3.9527391979713097`*^9, 3.9527392038608913`*^9}, {
   3.952843393328245*^9, 3.9528433951220036`*^9}, {3.9543860022751675`*^9, 
   3.954386027072504*^9}, {3.954386059712015*^9, 3.9543860621169167`*^9}, {
   3.9546989957195644`*^9, 3.954699019063341*^9}, 3.954699134440357*^9},
 CellTags->
  "Sensitivity-computation",ExpressionUUID->"8d6f5008-4248-2045-912c-\
c12fbda0d725"]
}, Closed]]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Deleting generated cells", "Title",
 CellChangeTimes->{{3.9025559465149946`*^9, 3.9025559494966087`*^9}, {
  3.952674884776943*^9, 
  3.952674885034134*^9}},ExpressionUUID->"203fe031-a989-4ae2-bab2-\
d9be6c6a10c7"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"FrontEndTokenExecute", "[", "\"\<DeleteGeneratedCells\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FrontEndTokenExecute", "[", "\"\<SelectAll\>\"", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
  "FrontEndTokenExecute", "[", "\"\<SelectionCloseAllGroups\>\"", "]"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.9025559062888603`*^9, 3.9025559062888603`*^9}, {
   3.902555964086707*^9, 3.902555989355214*^9}, 3.902763734669232*^9, {
   3.9028879544685755`*^9, 3.9028879657921314`*^9}, 3.90397199508119*^9, {
   3.918148957043585*^9, 3.918148960638934*^9}, 3.920048324604501*^9},
 CellLabel->
  "In[234]:=",ExpressionUUID->"6fde9864-29b5-4d88-a600-c5fcba685bf9"]
}, Closed]]
},
WindowSize->{1430.25, 822.75},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
TaggingRules-><|"TryRealOnly" -> False|>,
ShowCellTags->True,
Magnification:>0.9 Inherited,
FrontEndVersion->"14.2 for Microsoft Windows (64-bit) (December 26, 2024)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"1d04da36-d6b0-45f9-bfb2-de5e59e6aa12"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{
 "Acceptance"->{
  Cell[6141, 148, 378, 7, 76, "Title",ExpressionUUID->"c7fbc496-1765-4913-bda1-eb19f9d14ec4",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
  Cell[6544, 159, 227, 5, 73, "Chapter",ExpressionUUID->"2dfe8dd1-5f59-4b43-b3b9-2414e7900cd0",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
  Cell[6774, 166, 4056, 101, 243, "Input",ExpressionUUID->"d75a06c0-54bc-4cc7-8bf8-20131e23d55b",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
  Cell[10867, 272, 287, 6, 73, "Chapter",ExpressionUUID->"1f0363ab-1162-eb4d-b53a-7d3dac7a2b58",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
  Cell[11157, 280, 2242, 50, 140, "Input",ExpressionUUID->"416b7111-552e-c744-a2b2-843317cfd164",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
  Cell[13436, 335, 542, 9, 73, "Chapter",ExpressionUUID->"26b28c1f-439c-4589-917d-6d27e87fcda4",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
  Cell[14003, 348, 225, 5, 72, "Section",ExpressionUUID->"757988c6-ea37-b047-83c5-eb63621b4913",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
  Cell[14231, 355, 1418, 37, 106, "Input",ExpressionUUID->"57004dc5-a3e5-d04a-be13-3c411c28c8dd",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
  Cell[15686, 397, 228, 5, 72, "Section",ExpressionUUID->"85035d67-114f-47f6-94db-60f0e5c16cfb",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
  Cell[15939, 406, 469, 13, 60, "Subsection",ExpressionUUID->"6e25cf69-fe92-bb4d-9ec8-069f4fa65e2f",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
  Cell[16411, 421, 1288, 37, 98, "Input",ExpressionUUID->"bbae6bbc-aa1c-fb48-a296-ef340976f551",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
  Cell[17736, 463, 282, 6, 60, "Subsection",ExpressionUUID->"25e60c82-9c5a-4532-952c-fb512c328fe4",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
  Cell[18021, 471, 10037, 235, 601, "Input",ExpressionUUID->"289f9865-078c-48da-b27a-ffade768aeb2",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
  Cell[28095, 711, 225, 5, 60, "Subsection",ExpressionUUID->"c2b9b7a8-7fdf-436e-94e8-032145c60732",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
  Cell[28323, 718, 12306, 277, 708, "Input",ExpressionUUID->"af9ec9ab-fca6-4165-ac36-57fabe7c3a40",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
  Cell[40678, 1001, 297, 6, 72, "Section",ExpressionUUID->"35be8a02-4d25-4cbb-9678-877dd61d5842",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
  Cell[40978, 1009, 3612, 77, 192, "Input",ExpressionUUID->"6347abb3-3bd8-4430-a992-f2088673ed8a",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
  Cell[44651, 1093, 235, 5, 76, "Title",ExpressionUUID->"4849bc3c-f2c5-4bec-8c48-2c597d5d139d",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
  Cell[44889, 1100, 10597, 247, 603, "Input",ExpressionUUID->"a9dc099a-58c7-4b4a-87b0-fae273cf5733",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
  Cell[55511, 1351, 238, 5, 73, "Chapter",ExpressionUUID->"a74112cd-0181-43f7-98cb-cf9ca35460f9",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
  Cell[55752, 1358, 1998, 48, 277, "Input",ExpressionUUID->"188a1091-0abe-4645-9955-08d60cc3dc98",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}]},
 "Number-of-events+sensitivity"->{
  Cell[6141, 148, 378, 7, 76, "Title",ExpressionUUID->"c7fbc496-1765-4913-bda1-eb19f9d14ec4",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
  Cell[6544, 159, 227, 5, 73, "Chapter",ExpressionUUID->"2dfe8dd1-5f59-4b43-b3b9-2414e7900cd0",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
  Cell[6774, 166, 4056, 101, 243, "Input",ExpressionUUID->"d75a06c0-54bc-4cc7-8bf8-20131e23d55b",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
  Cell[10867, 272, 287, 6, 73, "Chapter",ExpressionUUID->"1f0363ab-1162-eb4d-b53a-7d3dac7a2b58",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
  Cell[11157, 280, 2242, 50, 140, "Input",ExpressionUUID->"416b7111-552e-c744-a2b2-843317cfd164",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
  Cell[13436, 335, 542, 9, 73, "Chapter",ExpressionUUID->"26b28c1f-439c-4589-917d-6d27e87fcda4",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
  Cell[14003, 348, 225, 5, 72, "Section",ExpressionUUID->"757988c6-ea37-b047-83c5-eb63621b4913",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
  Cell[14231, 355, 1418, 37, 106, "Input",ExpressionUUID->"57004dc5-a3e5-d04a-be13-3c411c28c8dd",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
  Cell[15686, 397, 228, 5, 72, "Section",ExpressionUUID->"85035d67-114f-47f6-94db-60f0e5c16cfb",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
  Cell[15939, 406, 469, 13, 60, "Subsection",ExpressionUUID->"6e25cf69-fe92-bb4d-9ec8-069f4fa65e2f",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
  Cell[16411, 421, 1288, 37, 98, "Input",ExpressionUUID->"bbae6bbc-aa1c-fb48-a296-ef340976f551",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
  Cell[17736, 463, 282, 6, 60, "Subsection",ExpressionUUID->"25e60c82-9c5a-4532-952c-fb512c328fe4",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
  Cell[18021, 471, 10037, 235, 601, "Input",ExpressionUUID->"289f9865-078c-48da-b27a-ffade768aeb2",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
  Cell[28095, 711, 225, 5, 60, "Subsection",ExpressionUUID->"c2b9b7a8-7fdf-436e-94e8-032145c60732",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
  Cell[28323, 718, 12306, 277, 708, "Input",ExpressionUUID->"af9ec9ab-fca6-4165-ac36-57fabe7c3a40",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
  Cell[40678, 1001, 297, 6, 72, "Section",ExpressionUUID->"35be8a02-4d25-4cbb-9678-877dd61d5842",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
  Cell[40978, 1009, 3612, 77, 192, "Input",ExpressionUUID->"6347abb3-3bd8-4430-a992-f2088673ed8a",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
  Cell[44651, 1093, 235, 5, 76, "Title",ExpressionUUID->"4849bc3c-f2c5-4bec-8c48-2c597d5d139d",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
  Cell[44889, 1100, 10597, 247, 603, "Input",ExpressionUUID->"a9dc099a-58c7-4b4a-87b0-fae273cf5733",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
  Cell[55511, 1351, 238, 5, 73, "Chapter",ExpressionUUID->"a74112cd-0181-43f7-98cb-cf9ca35460f9",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
  Cell[55752, 1358, 1998, 48, 277, "Input",ExpressionUUID->"188a1091-0abe-4645-9955-08d60cc3dc98",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}]},
 "Number-of-events-computation+sensitivity"->{
  Cell[57799, 1412, 216, 4, 76, "Title",ExpressionUUID->"128d78c3-8bd2-4cc0-aade-f5ea999c5498",
   CellTags->"Number-of-events-computation+sensitivity"],
  Cell[58040, 1420, 378, 7, 73, "Chapter",ExpressionUUID->"c9366a31-fab6-43c8-bf77-12197eb87f0c",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[58421, 1429, 858, 21, 55, "Input",ExpressionUUID->"06dc8acb-36d0-41f4-aa29-e8d4d0ec6ad1",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[59316, 1455, 389, 7, 64, "Chapter",ExpressionUUID->"cae25615-bc01-481f-b6ea-4be09eb8d2a0",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[59708, 1464, 12337, 268, 422, "Input",ExpressionUUID->"7b50f7c1-8794-4b1c-9865-2720540ddacb",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[72070, 1736, 416, 9, 72, "Section",ExpressionUUID->"4ddd9b4f-e91e-fe43-b1cc-ed99a5ceca23",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[72511, 1749, 325, 8, 60, "Subsection",ExpressionUUID->"1a318efd-8ede-5c47-af63-d2a909300e8b",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[72839, 1759, 7374, 185, 311, "Input",ExpressionUUID->"5bd80042-e980-5b4f-b4d4-7b8811007fcf",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[80250, 1949, 307, 7, 60, "Subsection",ExpressionUUID->"fe29ce4a-c131-f843-836e-647a8e8e6d9a",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[80560, 1958, 11984, 294, 842, "Input",ExpressionUUID->"135cebc8-e0af-7447-94ef-58448a721e2f",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[92605, 2259, 565, 9, 64, "Chapter",ExpressionUUID->"775c9f90-cfc2-4104-a914-805ee6203cb5",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[93195, 2272, 264, 5, 72, "Section",ExpressionUUID->"a8f01eed-d394-2044-8bc4-48a0ab7afd84",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[93462, 2279, 7671, 186, 586, "Input",ExpressionUUID->"051f0c57-57b7-469c-819a-b66e6981ba84",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[101170, 2470, 272, 5, 59, "Section",ExpressionUUID->"bd8630ef-ea3c-e146-a2d7-82986e6d4eef",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[101445, 2477, 2737, 68, 140, "Input",ExpressionUUID->"e3236aaa-3f2d-1545-b459-3a77342eee0a",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[104219, 2550, 283, 6, 59, "Section",ExpressionUUID->"4cfc4894-9abe-471a-bb9d-0878cefc8c61",
   CellTags->{"Number-of-events-computation+sensitivity", "Acceptance-computation"}],
  Cell[104505, 2558, 13747, 313, 722, "Input",ExpressionUUID->"285b34b1-2177-4110-966a-b403a2b3b0ec",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[118277, 2875, 317, 6, 60, "Subsection",ExpressionUUID->"15f44617-c031-47b4-abc6-75b3ecf51e41",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[118597, 2883, 5745, 116, 174, "Input",ExpressionUUID->"6c22c64a-fc6b-4872-bbf2-05d39e849f59",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[124391, 3005, 241, 5, 59, "Section",ExpressionUUID->"171422bd-bdb8-498b-8821-1a3e5edcdb2a",
   CellTags->{"Number-of-events-computation+sensitivity", "Acceptance-computation"}],
  Cell[124635, 3012, 10193, 246, 404, "Input",ExpressionUUID->"c282a484-22c9-4a44-a872-4eb893dc3695",
   CellTags->{"Number-of-events-computation+sensitivity", "Acceptance-computation"}],
  Cell[134831, 3260, 4653, 115, 114, "Input",ExpressionUUID->"f2500828-5ccf-1a42-adc3-e79cba87c0ce",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[139533, 3381, 218, 4, 73, "Chapter",ExpressionUUID->"2d9780fa-5ba1-4c6e-a530-4a9fc49461e6",
   CellTags->"Number-of-events-computation+sensitivity"],
  Cell[139776, 3389, 327, 6, 72, "Section",ExpressionUUID->"c209228b-48aa-40d8-8345-52697a87e834",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[140128, 3399, 388, 7, 60, "Subsection",ExpressionUUID->"220522e0-7bc3-47cb-a718-f2f23b53197f",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[140519, 3408, 15724, 351, 776, "Input",ExpressionUUID->"6b8c7152-6b57-4c59-b874-11f86dd942cc",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[156280, 3764, 262, 5, 60, "Subsection",ExpressionUUID->"4114198c-dd3f-4aad-8e3b-bc66975eb5b1",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[156567, 3773, 251, 5, 52, "Subsubsection",ExpressionUUID->"18da6244-b5b1-b14e-ad9c-183b6a120e5f",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[156821, 3780, 2503, 60, 174, "Input",ExpressionUUID->"9a3fc0b9-9a93-2a4c-a187-ffa50267a3d8",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[159361, 3845, 265, 5, 52, "Subsubsection",ExpressionUUID->"b10303aa-8637-bb48-8b49-de6e8c95bb15",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[159629, 3852, 14774, 353, 530, "Input",ExpressionUUID->"b6b04b5b-33f5-4fa1-bd0e-54d3490da4fa",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[174452, 4211, 284, 5, 60, "Subsection",ExpressionUUID->"c61f47e8-9fc1-439b-8a32-a6f080e12656",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[174739, 4218, 6815, 147, 430, "Input",ExpressionUUID->"aa0f18f8-518c-4776-85f1-d1b353e8e46e",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[181591, 4370, 309, 6, 60, "Subsection",ExpressionUUID->"490cedb7-cbf3-448d-ab54-bd76b35989e3",
   CellTags->{"Number-of-events-computation+sensitivity", "Acceptance-computation"}],
  Cell[181903, 4378, 7105, 147, 311, "Input",ExpressionUUID->"30a8ad6f-40f7-467d-8082-dbb62ed7d290",
   CellTags->{"Number-of-events-computation+sensitivity", "Acceptance-computation"}],
  Cell[189045, 4530, 335, 8, 60, "Subsection",ExpressionUUID->"d5a74d09-3a62-4413-916f-24f78ec73fd2",
   CellTags->{"Number-of-events-computation+sensitivity", "Acceptance-computation"}],
  Cell[189383, 4540, 12647, 306, 487, "Input",ExpressionUUID->"ad444b7f-ed27-4780-9327-f8c397aae568",
   CellTags->{"Number-of-events-computation+sensitivity", "Acceptance-computation"}],
  Cell[202067, 4851, 264, 5, 60, "Subsection",ExpressionUUID->"f1d5b5a4-4a7a-4215-92e6-b433834a1702",
   CellTags->{"Number-of-events-computation+sensitivity", "Acceptance-computation"}],
  Cell[202334, 4858, 21805, 490, 998, "Input",ExpressionUUID->"527d8baf-1a2d-4dd5-9da1-2d533b666b85",
   CellTags->{"Number-of-events-computation+sensitivity", "Acceptance-computation"}],
  Cell[236301, 5643, 236, 4, 76, "Title",ExpressionUUID->"f5136f97-573d-41ec-bafe-cbcb903e581e",
   CellTags->"Number-of-events-computation+sensitivity"],
  Cell[236562, 5651, 213, 4, 73, "Chapter",ExpressionUUID->"75cf786b-3cae-4471-be7d-a8f2b6c6b657",
   CellTags->"Number-of-events-computation+sensitivity"],
  Cell[236778, 5657, 14318, 262, 566, "Input",ExpressionUUID->"7723a626-82c5-4cfa-9029-8486e71b92ea",
   CellTags->"Number-of-events-computation+sensitivity"],
  Cell[251133, 5924, 209, 4, 73, "Chapter",ExpressionUUID->"e9258198-581c-4466-81fa-c2dce211dd65",
   CellTags->"Number-of-events-computation+sensitivity"],
  Cell[251345, 5930, 4645, 101, 260, "Input",ExpressionUUID->"4373bb38-5ade-4168-a342-6cca5c2ca723",
   CellTags->"Number-of-events-computation+sensitivity"]},
 "Acceptance-computation"->{
  Cell[58040, 1420, 378, 7, 73, "Chapter",ExpressionUUID->"c9366a31-fab6-43c8-bf77-12197eb87f0c",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[58421, 1429, 858, 21, 55, "Input",ExpressionUUID->"06dc8acb-36d0-41f4-aa29-e8d4d0ec6ad1",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[59316, 1455, 389, 7, 64, "Chapter",ExpressionUUID->"cae25615-bc01-481f-b6ea-4be09eb8d2a0",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[59708, 1464, 12337, 268, 422, "Input",ExpressionUUID->"7b50f7c1-8794-4b1c-9865-2720540ddacb",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[72070, 1736, 416, 9, 72, "Section",ExpressionUUID->"4ddd9b4f-e91e-fe43-b1cc-ed99a5ceca23",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[72511, 1749, 325, 8, 60, "Subsection",ExpressionUUID->"1a318efd-8ede-5c47-af63-d2a909300e8b",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[72839, 1759, 7374, 185, 311, "Input",ExpressionUUID->"5bd80042-e980-5b4f-b4d4-7b8811007fcf",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[80250, 1949, 307, 7, 60, "Subsection",ExpressionUUID->"fe29ce4a-c131-f843-836e-647a8e8e6d9a",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[80560, 1958, 11984, 294, 842, "Input",ExpressionUUID->"135cebc8-e0af-7447-94ef-58448a721e2f",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[92605, 2259, 565, 9, 64, "Chapter",ExpressionUUID->"775c9f90-cfc2-4104-a914-805ee6203cb5",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[93195, 2272, 264, 5, 72, "Section",ExpressionUUID->"a8f01eed-d394-2044-8bc4-48a0ab7afd84",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[93462, 2279, 7671, 186, 586, "Input",ExpressionUUID->"051f0c57-57b7-469c-819a-b66e6981ba84",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[101170, 2470, 272, 5, 59, "Section",ExpressionUUID->"bd8630ef-ea3c-e146-a2d7-82986e6d4eef",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[101445, 2477, 2737, 68, 140, "Input",ExpressionUUID->"e3236aaa-3f2d-1545-b459-3a77342eee0a",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[104219, 2550, 283, 6, 59, "Section",ExpressionUUID->"4cfc4894-9abe-471a-bb9d-0878cefc8c61",
   CellTags->{"Number-of-events-computation+sensitivity", "Acceptance-computation"}],
  Cell[104505, 2558, 13747, 313, 722, "Input",ExpressionUUID->"285b34b1-2177-4110-966a-b403a2b3b0ec",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[118277, 2875, 317, 6, 60, "Subsection",ExpressionUUID->"15f44617-c031-47b4-abc6-75b3ecf51e41",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[118597, 2883, 5745, 116, 174, "Input",ExpressionUUID->"6c22c64a-fc6b-4872-bbf2-05d39e849f59",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[124391, 3005, 241, 5, 59, "Section",ExpressionUUID->"171422bd-bdb8-498b-8821-1a3e5edcdb2a",
   CellTags->{"Number-of-events-computation+sensitivity", "Acceptance-computation"}],
  Cell[124635, 3012, 10193, 246, 404, "Input",ExpressionUUID->"c282a484-22c9-4a44-a872-4eb893dc3695",
   CellTags->{"Number-of-events-computation+sensitivity", "Acceptance-computation"}],
  Cell[134831, 3260, 4653, 115, 114, "Input",ExpressionUUID->"f2500828-5ccf-1a42-adc3-e79cba87c0ce",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[139776, 3389, 327, 6, 72, "Section",ExpressionUUID->"c209228b-48aa-40d8-8345-52697a87e834",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[140128, 3399, 388, 7, 60, "Subsection",ExpressionUUID->"220522e0-7bc3-47cb-a718-f2f23b53197f",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[140519, 3408, 15724, 351, 776, "Input",ExpressionUUID->"6b8c7152-6b57-4c59-b874-11f86dd942cc",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[156280, 3764, 262, 5, 60, "Subsection",ExpressionUUID->"4114198c-dd3f-4aad-8e3b-bc66975eb5b1",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[156567, 3773, 251, 5, 52, "Subsubsection",ExpressionUUID->"18da6244-b5b1-b14e-ad9c-183b6a120e5f",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[156821, 3780, 2503, 60, 174, "Input",ExpressionUUID->"9a3fc0b9-9a93-2a4c-a187-ffa50267a3d8",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[159361, 3845, 265, 5, 52, "Subsubsection",ExpressionUUID->"b10303aa-8637-bb48-8b49-de6e8c95bb15",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[159629, 3852, 14774, 353, 530, "Input",ExpressionUUID->"b6b04b5b-33f5-4fa1-bd0e-54d3490da4fa",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[174452, 4211, 284, 5, 60, "Subsection",ExpressionUUID->"c61f47e8-9fc1-439b-8a32-a6f080e12656",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[174739, 4218, 6815, 147, 430, "Input",ExpressionUUID->"aa0f18f8-518c-4776-85f1-d1b353e8e46e",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[181591, 4370, 309, 6, 60, "Subsection",ExpressionUUID->"490cedb7-cbf3-448d-ab54-bd76b35989e3",
   CellTags->{"Number-of-events-computation+sensitivity", "Acceptance-computation"}],
  Cell[181903, 4378, 7105, 147, 311, "Input",ExpressionUUID->"30a8ad6f-40f7-467d-8082-dbb62ed7d290",
   CellTags->{"Number-of-events-computation+sensitivity", "Acceptance-computation"}],
  Cell[189045, 4530, 335, 8, 60, "Subsection",ExpressionUUID->"d5a74d09-3a62-4413-916f-24f78ec73fd2",
   CellTags->{"Number-of-events-computation+sensitivity", "Acceptance-computation"}],
  Cell[189383, 4540, 12647, 306, 487, "Input",ExpressionUUID->"ad444b7f-ed27-4780-9327-f8c397aae568",
   CellTags->{"Number-of-events-computation+sensitivity", "Acceptance-computation"}],
  Cell[202067, 4851, 264, 5, 60, "Subsection",ExpressionUUID->"f1d5b5a4-4a7a-4215-92e6-b433834a1702",
   CellTags->{"Number-of-events-computation+sensitivity", "Acceptance-computation"}],
  Cell[202334, 4858, 21805, 490, 998, "Input",ExpressionUUID->"527d8baf-1a2d-4dd5-9da1-2d533b666b85",
   CellTags->{"Number-of-events-computation+sensitivity", "Acceptance-computation"}]},
 "Sensitivity"->{
  Cell[256039, 6037, 189, 3, 76, "Title",ExpressionUUID->"2ce189e8-ece2-4e74-afba-65f86fa4e6b1",
   CellTags->"Sensitivity"],
  Cell[256253, 6044, 188, 3, 73, "Chapter",ExpressionUUID->"46d55711-0db4-45a7-9164-17597ab946db",
   CellTags->"Sensitivity"],
  Cell[256444, 6049, 7818, 193, 485, "Input",ExpressionUUID->"386a3b18-c97e-4830-a3d0-08c67263d3c7",
   CellTags->"Sensitivity"],
  Cell[264287, 6246, 198, 3, 72, "Section",ExpressionUUID->"e54f2dc2-3904-41ed-811d-05f57f5483c8",
   CellTags->"Sensitivity"],
  Cell[264488, 6251, 2860, 71, 260, "Input",ExpressionUUID->"b9b8a51e-c68c-49e6-bca3-bcc8cee90fbd",
   CellTags->"Sensitivity"],
  Cell[267385, 6327, 193, 3, 72, "Section",ExpressionUUID->"133a367f-552c-e54c-af43-d21876161d3e",
   CellTags->"Sensitivity"],
  Cell[267581, 6332, 1354, 33, 192, "Input",ExpressionUUID->"8ee1c116-bfe3-8d46-ab4e-665f0bb787af",
   CellTags->"Sensitivity"]},
 "Sensitivity-computation"->{
  Cell[268984, 6371, 218, 4, 64, "Chapter",ExpressionUUID->"07b3dd6c-5bc5-4374-ad95-caec94e93ed0",
   CellTags->"Sensitivity-computation"],
  Cell[269227, 6379, 204, 4, 72, "Section",ExpressionUUID->"50b70f7a-3e84-4b3e-ae55-9ddcc27d70f4",
   CellTags->"Sensitivity-computation"],
  Cell[269434, 6385, 6802, 141, 294, "Input",ExpressionUUID->"01ff1478-030e-432f-be11-c30e96d2eaaa",
   CellTags->"Sensitivity-computation"],
  Cell[276273, 6531, 213, 4, 72, "Section",ExpressionUUID->"c926b9c8-e111-49d9-935a-2823cd916a63",
   CellTags->"Sensitivity-computation"],
  Cell[276489, 6537, 14542, 363, 673, "Input",ExpressionUUID->"713135b7-c63d-4d84-a215-e8d83c1218c4",
   CellTags->"Sensitivity-computation"],
  Cell[296949, 7050, 238, 4, 60, "Subsection",ExpressionUUID->"641259e7-dffc-4eb6-96d0-4500406ac204",
   CellTags->"Sensitivity-computation"],
  Cell[297190, 7056, 4753, 112, 294, "Input",ExpressionUUID->"3c9f40fc-f6f0-4359-abe3-a8e369511d52",
   CellTags->"Sensitivity-computation"],
  Cell[302004, 7175, 265, 5, 64, "Chapter",ExpressionUUID->"72c1424d-fb71-2a4c-af5e-664add5c137d",
   CellTags->"Sensitivity-computation"],
  Cell[302294, 7184, 221, 4, 72, "Section",ExpressionUUID->"a12c9941-3b58-8e4a-8c0a-86d9c709b874",
   CellTags->"Sensitivity-computation"],
  Cell[302518, 7190, 4556, 120, 201, "Input",ExpressionUUID->"0b7167ea-a9ec-9c45-89be-9e80ec1e3aa0",
   CellTags->"Sensitivity-computation"],
  Cell[307111, 7315, 220, 4, 72, "Section",ExpressionUUID->"774c689c-d8e1-4948-b114-3e9e9146e0d5",
   CellTags->"Sensitivity-computation"],
  Cell[307334, 7321, 5724, 140, 192, "Input",ExpressionUUID->"fae948ac-5c53-425d-8842-e6b4ca896596",
   CellTags->"Sensitivity-computation"],
  Cell[313107, 7467, 227, 4, 64, "Chapter",ExpressionUUID->"785f8753-296d-1248-8ab6-e5102d40ba91",
   CellTags->"Sensitivity-computation"],
  Cell[313337, 7473, 3842, 98, 175, "Input",ExpressionUUID->"5dcb378e-b628-4948-a176-b9ff8dc62ce5",
   CellTags->"Sensitivity-computation"],
  Cell[317373, 7581, 206, 4, 64, "Chapter",ExpressionUUID->"0d834004-01d7-412b-b48e-402cf64fc469",
   CellTags->"Sensitivity-computation"],
  Cell[317604, 7589, 239, 5, 72, "Section",ExpressionUUID->"34ac3bb4-f0d0-4d08-afe5-b8db5a9ce429",
   CellTags->"Sensitivity-computation"],
  Cell[317846, 7596, 11038, 250, 576, "Input",ExpressionUUID->"77d020ab-0998-4d29-a1a5-9b4450dbc4f8",
   CellTags->"Sensitivity-computation"],
  Cell[328921, 7851, 265, 5, 72, "Section",ExpressionUUID->"8313923f-8d82-f244-a291-f219ff1efa02",
   CellTags->"Sensitivity-computation"],
  Cell[329189, 7858, 18971, 466, 437, "Input",ExpressionUUID->"393530ae-64d6-4ec8-b59b-3746dc54333d",
   CellTags->"Sensitivity-computation"],
  Cell[348209, 8330, 266, 5, 64, "Chapter",ExpressionUUID->"f693b343-a2a4-604f-882b-f5291d998abb",
   CellTags->"Sensitivity-computation"],
  Cell[348500, 8339, 281, 5, 72, "Section",ExpressionUUID->"29eddb37-952a-554b-9243-fb8fc4e1927a",
   CellTags->"Sensitivity-computation"],
  Cell[348784, 8346, 28928, 658, 1460, "Input",ExpressionUUID->"33268a1f-1f9f-6249-b432-49d5c6bf53ad",
   CellTags->"Sensitivity-computation"],
  Cell[377749, 9009, 263, 5, 72, "Section",ExpressionUUID->"5659e288-d25b-6f4c-8df6-c5921e611b1b",
   CellTags->"Sensitivity-computation"],
  Cell[378015, 9016, 16403, 373, 814, "Input",ExpressionUUID->"8d6f5008-4248-2045-912c-c12fbda0d725",
   CellTags->"Sensitivity-computation"]}
 }
*)
(*CellTagsIndex
CellTagsIndex->{
 {"Acceptance", 395900, 9434},
 {"Number-of-events+sensitivity", 399299, 9477},
 {"Number-of-events-computation+sensitivity", 402710, 9520},
 {"Acceptance-computation", 410748, 9609},
 {"Sensitivity", 417676, 9684},
 {"Sensitivity-computation", 418605, 9699}
 }
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 207, 3, 86, "Title",ExpressionUUID->"81e378d2-3dbb-467e-88a3-3d73d3bd8f3c"],
Cell[790, 27, 5314, 116, 385, "Input",ExpressionUUID->"b0400bb0-bd38-4283-9a8f-ce5e9e655d1b"]
}, Closed]],
Cell[CellGroupData[{
Cell[6141, 148, 378, 7, 76, "Title",ExpressionUUID->"c7fbc496-1765-4913-bda1-eb19f9d14ec4",
 CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
Cell[CellGroupData[{
Cell[6544, 159, 227, 5, 73, "Chapter",ExpressionUUID->"2dfe8dd1-5f59-4b43-b3b9-2414e7900cd0",
 CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
Cell[6774, 166, 4056, 101, 243, "Input",ExpressionUUID->"d75a06c0-54bc-4cc7-8bf8-20131e23d55b",
 CellTags->{"Acceptance", "Number-of-events+sensitivity"}]
}, Closed]],
Cell[CellGroupData[{
Cell[10867, 272, 287, 6, 73, "Chapter",ExpressionUUID->"1f0363ab-1162-eb4d-b53a-7d3dac7a2b58",
 CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
Cell[11157, 280, 2242, 50, 140, "Input",ExpressionUUID->"416b7111-552e-c744-a2b2-843317cfd164",
 CellTags->{"Acceptance", "Number-of-events+sensitivity"}]
}, Closed]],
Cell[CellGroupData[{
Cell[13436, 335, 542, 9, 73, "Chapter",ExpressionUUID->"26b28c1f-439c-4589-917d-6d27e87fcda4",
 CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
Cell[CellGroupData[{
Cell[14003, 348, 225, 5, 72, "Section",ExpressionUUID->"757988c6-ea37-b047-83c5-eb63621b4913",
 CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
Cell[14231, 355, 1418, 37, 106, "Input",ExpressionUUID->"57004dc5-a3e5-d04a-be13-3c411c28c8dd",
 CellTags->{"Acceptance", "Number-of-events+sensitivity"}]
}, Closed]],
Cell[CellGroupData[{
Cell[15686, 397, 228, 5, 72, "Section",ExpressionUUID->"85035d67-114f-47f6-94db-60f0e5c16cfb",
 CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
Cell[CellGroupData[{
Cell[15939, 406, 469, 13, 60, "Subsection",ExpressionUUID->"6e25cf69-fe92-bb4d-9ec8-069f4fa65e2f",
 CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
Cell[16411, 421, 1288, 37, 98, "Input",ExpressionUUID->"bbae6bbc-aa1c-fb48-a296-ef340976f551",
 CellTags->{"Acceptance", "Number-of-events+sensitivity"}]
}, Closed]],
Cell[CellGroupData[{
Cell[17736, 463, 282, 6, 60, "Subsection",ExpressionUUID->"25e60c82-9c5a-4532-952c-fb512c328fe4",
 CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
Cell[18021, 471, 10037, 235, 601, "Input",ExpressionUUID->"289f9865-078c-48da-b27a-ffade768aeb2",
 CellTags->{"Acceptance", "Number-of-events+sensitivity"}]
}, Closed]],
Cell[CellGroupData[{
Cell[28095, 711, 225, 5, 60, "Subsection",ExpressionUUID->"c2b9b7a8-7fdf-436e-94e8-032145c60732",
 CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
Cell[28323, 718, 12306, 277, 708, "Input",ExpressionUUID->"af9ec9ab-fca6-4165-ac36-57fabe7c3a40",
 CellTags->{"Acceptance", "Number-of-events+sensitivity"}]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[40678, 1001, 297, 6, 72, "Section",ExpressionUUID->"35be8a02-4d25-4cbb-9678-877dd61d5842",
 CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
Cell[40978, 1009, 3612, 77, 192, "Input",ExpressionUUID->"6347abb3-3bd8-4430-a992-f2088673ed8a",
 CellTags->{"Acceptance", "Number-of-events+sensitivity"}]
}, Closed]]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[44651, 1093, 235, 5, 76, "Title",ExpressionUUID->"4849bc3c-f2c5-4bec-8c48-2c597d5d139d",
 CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
Cell[44889, 1100, 10597, 247, 603, "Input",ExpressionUUID->"a9dc099a-58c7-4b4a-87b0-fae273cf5733",
 CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
Cell[CellGroupData[{
Cell[55511, 1351, 238, 5, 73, "Chapter",ExpressionUUID->"a74112cd-0181-43f7-98cb-cf9ca35460f9",
 CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
Cell[55752, 1358, 1998, 48, 277, "Input",ExpressionUUID->"188a1091-0abe-4645-9955-08d60cc3dc98",
 CellTags->{"Acceptance", "Number-of-events+sensitivity"}]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[57799, 1412, 216, 4, 76, "Title",ExpressionUUID->"128d78c3-8bd2-4cc0-aade-f5ea999c5498",
 CellTags->"Number-of-events-computation+sensitivity"],
Cell[CellGroupData[{
Cell[58040, 1420, 378, 7, 73, "Chapter",ExpressionUUID->"c9366a31-fab6-43c8-bf77-12197eb87f0c",
 CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
Cell[58421, 1429, 858, 21, 55, "Input",ExpressionUUID->"06dc8acb-36d0-41f4-aa29-e8d4d0ec6ad1",
 CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}]
}, Closed]],
Cell[CellGroupData[{
Cell[59316, 1455, 389, 7, 64, "Chapter",ExpressionUUID->"cae25615-bc01-481f-b6ea-4be09eb8d2a0",
 CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
Cell[59708, 1464, 12337, 268, 422, "Input",ExpressionUUID->"7b50f7c1-8794-4b1c-9865-2720540ddacb",
 CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
Cell[CellGroupData[{
Cell[72070, 1736, 416, 9, 72, "Section",ExpressionUUID->"4ddd9b4f-e91e-fe43-b1cc-ed99a5ceca23",
 CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
Cell[CellGroupData[{
Cell[72511, 1749, 325, 8, 60, "Subsection",ExpressionUUID->"1a318efd-8ede-5c47-af63-d2a909300e8b",
 CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
Cell[72839, 1759, 7374, 185, 311, "Input",ExpressionUUID->"5bd80042-e980-5b4f-b4d4-7b8811007fcf",
 CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}]
}, Closed]],
Cell[CellGroupData[{
Cell[80250, 1949, 307, 7, 60, "Subsection",ExpressionUUID->"fe29ce4a-c131-f843-836e-647a8e8e6d9a",
 CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
Cell[80560, 1958, 11984, 294, 842, "Input",ExpressionUUID->"135cebc8-e0af-7447-94ef-58448a721e2f",
 CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}]
}, Closed]]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[92605, 2259, 565, 9, 64, "Chapter",ExpressionUUID->"775c9f90-cfc2-4104-a914-805ee6203cb5",
 CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
Cell[CellGroupData[{
Cell[93195, 2272, 264, 5, 72, "Section",ExpressionUUID->"a8f01eed-d394-2044-8bc4-48a0ab7afd84",
 CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
Cell[93462, 2279, 7671, 186, 586, "Input",ExpressionUUID->"051f0c57-57b7-469c-819a-b66e6981ba84",
 CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}]
}, Closed]],
Cell[CellGroupData[{
Cell[101170, 2470, 272, 5, 59, "Section",ExpressionUUID->"bd8630ef-ea3c-e146-a2d7-82986e6d4eef",
 CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
Cell[101445, 2477, 2737, 68, 140, "Input",ExpressionUUID->"e3236aaa-3f2d-1545-b459-3a77342eee0a",
 CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}]
}, Closed]],
Cell[CellGroupData[{
Cell[104219, 2550, 283, 6, 59, "Section",ExpressionUUID->"4cfc4894-9abe-471a-bb9d-0878cefc8c61",
 CellTags->{"Number-of-events-computation+sensitivity", "Acceptance-computation"}],
Cell[104505, 2558, 13747, 313, 722, "Input",ExpressionUUID->"285b34b1-2177-4110-966a-b403a2b3b0ec",
 CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
Cell[CellGroupData[{
Cell[118277, 2875, 317, 6, 60, "Subsection",ExpressionUUID->"15f44617-c031-47b4-abc6-75b3ecf51e41",
 CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
Cell[118597, 2883, 5745, 116, 174, "Input",ExpressionUUID->"6c22c64a-fc6b-4872-bbf2-05d39e849f59",
 CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[124391, 3005, 241, 5, 59, "Section",ExpressionUUID->"171422bd-bdb8-498b-8821-1a3e5edcdb2a",
 CellTags->{"Number-of-events-computation+sensitivity", "Acceptance-computation"}],
Cell[124635, 3012, 10193, 246, 404, "Input",ExpressionUUID->"c282a484-22c9-4a44-a872-4eb893dc3695",
 CellTags->{"Number-of-events-computation+sensitivity", "Acceptance-computation"}],
Cell[134831, 3260, 4653, 115, 114, "Input",ExpressionUUID->"f2500828-5ccf-1a42-adc3-e79cba87c0ce",
 CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[139533, 3381, 218, 4, 73, "Chapter",ExpressionUUID->"2d9780fa-5ba1-4c6e-a530-4a9fc49461e6",
 CellTags->"Number-of-events-computation+sensitivity"],
Cell[CellGroupData[{
Cell[139776, 3389, 327, 6, 72, "Section",ExpressionUUID->"c209228b-48aa-40d8-8345-52697a87e834",
 CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
Cell[CellGroupData[{
Cell[140128, 3399, 388, 7, 60, "Subsection",ExpressionUUID->"220522e0-7bc3-47cb-a718-f2f23b53197f",
 CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
Cell[140519, 3408, 15724, 351, 776, "Input",ExpressionUUID->"6b8c7152-6b57-4c59-b874-11f86dd942cc",
 CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}]
}, Closed]],
Cell[CellGroupData[{
Cell[156280, 3764, 262, 5, 60, "Subsection",ExpressionUUID->"4114198c-dd3f-4aad-8e3b-bc66975eb5b1",
 CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
Cell[CellGroupData[{
Cell[156567, 3773, 251, 5, 52, "Subsubsection",ExpressionUUID->"18da6244-b5b1-b14e-ad9c-183b6a120e5f",
 CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
Cell[156821, 3780, 2503, 60, 174, "Input",ExpressionUUID->"9a3fc0b9-9a93-2a4c-a187-ffa50267a3d8",
 CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}]
}, Closed]],
Cell[CellGroupData[{
Cell[159361, 3845, 265, 5, 52, "Subsubsection",ExpressionUUID->"b10303aa-8637-bb48-8b49-de6e8c95bb15",
 CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
Cell[159629, 3852, 14774, 353, 530, "Input",ExpressionUUID->"b6b04b5b-33f5-4fa1-bd0e-54d3490da4fa",
 CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[174452, 4211, 284, 5, 60, "Subsection",ExpressionUUID->"c61f47e8-9fc1-439b-8a32-a6f080e12656",
 CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
Cell[174739, 4218, 6815, 147, 430, "Input",ExpressionUUID->"aa0f18f8-518c-4776-85f1-d1b353e8e46e",
 CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}]
}, Closed]],
Cell[CellGroupData[{
Cell[181591, 4370, 309, 6, 60, "Subsection",ExpressionUUID->"490cedb7-cbf3-448d-ab54-bd76b35989e3",
 CellTags->{"Number-of-events-computation+sensitivity", "Acceptance-computation"}],
Cell[181903, 4378, 7105, 147, 311, "Input",ExpressionUUID->"30a8ad6f-40f7-467d-8082-dbb62ed7d290",
 CellTags->{"Number-of-events-computation+sensitivity", "Acceptance-computation"}]
}, Closed]],
Cell[CellGroupData[{
Cell[189045, 4530, 335, 8, 60, "Subsection",ExpressionUUID->"d5a74d09-3a62-4413-916f-24f78ec73fd2",
 CellTags->{"Number-of-events-computation+sensitivity", "Acceptance-computation"}],
Cell[189383, 4540, 12647, 306, 487, "Input",ExpressionUUID->"ad444b7f-ed27-4780-9327-f8c397aae568",
 CellTags->{"Number-of-events-computation+sensitivity", "Acceptance-computation"}]
}, Closed]],
Cell[CellGroupData[{
Cell[202067, 4851, 264, 5, 60, "Subsection",ExpressionUUID->"f1d5b5a4-4a7a-4215-92e6-b433834a1702",
 CellTags->{"Number-of-events-computation+sensitivity", "Acceptance-computation"}],
Cell[202334, 4858, 21805, 490, 998, "Input",ExpressionUUID->"527d8baf-1a2d-4dd5-9da1-2d533b666b85",
 CellTags->{"Number-of-events-computation+sensitivity", "Acceptance-computation"}]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[224188, 5354, 203, 4, 59, "Section",ExpressionUUID->"52dc766a-fc2d-4e27-b20c-a2032825a0cb"],
Cell[CellGroupData[{
Cell[224416, 5362, 273, 4, 47, "Subsection",ExpressionUUID->"ad2977c7-d9f1-4c24-a632-a9cecee3df66"],
Cell[224692, 5368, 11536, 267, 353, "Input",ExpressionUUID->"99324d6c-b056-41ec-976e-e102b4b6081c"]
}, Closed]]
}, Closed]]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[236301, 5643, 236, 4, 76, "Title",ExpressionUUID->"f5136f97-573d-41ec-bafe-cbcb903e581e",
 CellTags->"Number-of-events-computation+sensitivity"],
Cell[CellGroupData[{
Cell[236562, 5651, 213, 4, 73, "Chapter",ExpressionUUID->"75cf786b-3cae-4471-be7d-a8f2b6c6b657",
 CellTags->"Number-of-events-computation+sensitivity"],
Cell[236778, 5657, 14318, 262, 566, "Input",ExpressionUUID->"7723a626-82c5-4cfa-9029-8486e71b92ea",
 CellTags->"Number-of-events-computation+sensitivity"]
}, Closed]],
Cell[CellGroupData[{
Cell[251133, 5924, 209, 4, 73, "Chapter",ExpressionUUID->"e9258198-581c-4466-81fa-c2dce211dd65",
 CellTags->"Number-of-events-computation+sensitivity"],
Cell[251345, 5930, 4645, 101, 260, "Input",ExpressionUUID->"4373bb38-5ade-4168-a342-6cca5c2ca723",
 CellTags->"Number-of-events-computation+sensitivity"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[256039, 6037, 189, 3, 76, "Title",ExpressionUUID->"2ce189e8-ece2-4e74-afba-65f86fa4e6b1",
 CellTags->"Sensitivity"],
Cell[CellGroupData[{
Cell[256253, 6044, 188, 3, 73, "Chapter",ExpressionUUID->"46d55711-0db4-45a7-9164-17597ab946db",
 CellTags->"Sensitivity"],
Cell[256444, 6049, 7818, 193, 485, "Input",ExpressionUUID->"386a3b18-c97e-4830-a3d0-08c67263d3c7",
 CellTags->"Sensitivity"],
Cell[CellGroupData[{
Cell[264287, 6246, 198, 3, 72, "Section",ExpressionUUID->"e54f2dc2-3904-41ed-811d-05f57f5483c8",
 CellTags->"Sensitivity"],
Cell[264488, 6251, 2860, 71, 260, "Input",ExpressionUUID->"b9b8a51e-c68c-49e6-bca3-bcc8cee90fbd",
 CellTags->"Sensitivity"]
}, Closed]],
Cell[CellGroupData[{
Cell[267385, 6327, 193, 3, 72, "Section",ExpressionUUID->"133a367f-552c-e54c-af43-d21876161d3e",
 CellTags->"Sensitivity"],
Cell[267581, 6332, 1354, 33, 192, "Input",ExpressionUUID->"8ee1c116-bfe3-8d46-ab4e-665f0bb787af",
 CellTags->"Sensitivity"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[268984, 6371, 218, 4, 64, "Chapter",ExpressionUUID->"07b3dd6c-5bc5-4374-ad95-caec94e93ed0",
 CellTags->"Sensitivity-computation"],
Cell[CellGroupData[{
Cell[269227, 6379, 204, 4, 72, "Section",ExpressionUUID->"50b70f7a-3e84-4b3e-ae55-9ddcc27d70f4",
 CellTags->"Sensitivity-computation"],
Cell[269434, 6385, 6802, 141, 294, "Input",ExpressionUUID->"01ff1478-030e-432f-be11-c30e96d2eaaa",
 CellTags->"Sensitivity-computation"]
}, Closed]],
Cell[CellGroupData[{
Cell[276273, 6531, 213, 4, 72, "Section",ExpressionUUID->"c926b9c8-e111-49d9-935a-2823cd916a63",
 CellTags->"Sensitivity-computation"],
Cell[276489, 6537, 14542, 363, 673, "Input",ExpressionUUID->"713135b7-c63d-4d84-a215-e8d83c1218c4",
 CellTags->"Sensitivity-computation"],
Cell[291034, 6902, 130, 3, 25, "Input",ExpressionUUID->"84496cf0-5940-4b48-b6ac-969bef597d44"],
Cell[291167, 6907, 5757, 139, 282, "Input",ExpressionUUID->"e436d26a-c62f-ba4b-b286-9ef80ff9a7bd"],
Cell[CellGroupData[{
Cell[296949, 7050, 238, 4, 60, "Subsection",ExpressionUUID->"641259e7-dffc-4eb6-96d0-4500406ac204",
 CellTags->"Sensitivity-computation"],
Cell[297190, 7056, 4753, 112, 294, "Input",ExpressionUUID->"3c9f40fc-f6f0-4359-abe3-a8e369511d52",
 CellTags->"Sensitivity-computation"]
}, Closed]]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[302004, 7175, 265, 5, 64, "Chapter",ExpressionUUID->"72c1424d-fb71-2a4c-af5e-664add5c137d",
 CellTags->"Sensitivity-computation"],
Cell[CellGroupData[{
Cell[302294, 7184, 221, 4, 72, "Section",ExpressionUUID->"a12c9941-3b58-8e4a-8c0a-86d9c709b874",
 CellTags->"Sensitivity-computation"],
Cell[302518, 7190, 4556, 120, 201, "Input",ExpressionUUID->"0b7167ea-a9ec-9c45-89be-9e80ec1e3aa0",
 CellTags->"Sensitivity-computation"]
}, Closed]],
Cell[CellGroupData[{
Cell[307111, 7315, 220, 4, 72, "Section",ExpressionUUID->"774c689c-d8e1-4948-b114-3e9e9146e0d5",
 CellTags->"Sensitivity-computation"],
Cell[307334, 7321, 5724, 140, 192, "Input",ExpressionUUID->"fae948ac-5c53-425d-8842-e6b4ca896596",
 CellTags->"Sensitivity-computation"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[313107, 7467, 227, 4, 64, "Chapter",ExpressionUUID->"785f8753-296d-1248-8ab6-e5102d40ba91",
 CellTags->"Sensitivity-computation"],
Cell[313337, 7473, 3842, 98, 175, "Input",ExpressionUUID->"5dcb378e-b628-4948-a176-b9ff8dc62ce5",
 CellTags->"Sensitivity-computation"],
Cell[317182, 7573, 154, 3, 25, "Input",ExpressionUUID->"1af51f82-fec8-f545-b646-06d5505eb40e"]
}, Closed]],
Cell[CellGroupData[{
Cell[317373, 7581, 206, 4, 64, "Chapter",ExpressionUUID->"0d834004-01d7-412b-b48e-402cf64fc469",
 CellTags->"Sensitivity-computation"],
Cell[CellGroupData[{
Cell[317604, 7589, 239, 5, 72, "Section",ExpressionUUID->"34ac3bb4-f0d0-4d08-afe5-b8db5a9ce429",
 CellTags->"Sensitivity-computation"],
Cell[317846, 7596, 11038, 250, 576, "Input",ExpressionUUID->"77d020ab-0998-4d29-a1a5-9b4450dbc4f8",
 CellTags->"Sensitivity-computation"]
}, Open  ]],
Cell[CellGroupData[{
Cell[328921, 7851, 265, 5, 72, "Section",ExpressionUUID->"8313923f-8d82-f244-a291-f219ff1efa02",
 CellTags->"Sensitivity-computation"],
Cell[329189, 7858, 18971, 466, 437, "Input",ExpressionUUID->"393530ae-64d6-4ec8-b59b-3746dc54333d",
 CellTags->"Sensitivity-computation"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[348209, 8330, 266, 5, 64, "Chapter",ExpressionUUID->"f693b343-a2a4-604f-882b-f5291d998abb",
 CellTags->"Sensitivity-computation"],
Cell[CellGroupData[{
Cell[348500, 8339, 281, 5, 72, "Section",ExpressionUUID->"29eddb37-952a-554b-9243-fb8fc4e1927a",
 CellTags->"Sensitivity-computation"],
Cell[348784, 8346, 28928, 658, 1460, "Input",ExpressionUUID->"33268a1f-1f9f-6249-b432-49d5c6bf53ad",
 CellTags->"Sensitivity-computation"]
}, Closed]],
Cell[CellGroupData[{
Cell[377749, 9009, 263, 5, 72, "Section",ExpressionUUID->"5659e288-d25b-6f4c-8df6-c5921e611b1b",
 CellTags->"Sensitivity-computation"],
Cell[378015, 9016, 16403, 373, 814, "Input",ExpressionUUID->"8d6f5008-4248-2045-912c-c12fbda0d725",
 CellTags->"Sensitivity-computation"]
}, Closed]]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[394479, 9396, 220, 4, 86, "Title",ExpressionUUID->"203fe031-a989-4ae2-bab2-d9be6c6a10c7"],
Cell[394702, 9402, 731, 15, 59, "Input",ExpressionUUID->"6fde9864-29b5-4d88-a600-c5fcba685bf9"]
}, Closed]]
}
]
*)

