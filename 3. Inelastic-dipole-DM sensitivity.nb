(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    284378,       6608]
NotebookOptionsPosition[    250199,       6096]
NotebookOutlinePosition[    270174,       6355]
CellTagsIndexPosition[    269870,       6345]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Just launch the code below to run the notebook (shift+enter)", "Title",
 CellChangeTimes->{{3.8934376452895875`*^9, 
  3.8934376644509068`*^9}},ExpressionUUID->"ec489a88-8a17-4268-83b3-\
d4cc980d9075"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ParallelEvaluate", "[", 
   RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BlockEvaluation", "[", "tag_", "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"nb", "=", 
      RowBox[{"EvaluationNotebook", "[", "]"}]}], ";", "\n", 
     RowBox[{"NotebookFind", "[", 
      RowBox[{"nb", ",", "tag", ",", "All", ",", "CellTags"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"SelectionEvaluate", "[", "nb", "]"}]}]}], "\[IndentingNewLine]",
    "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CloseKernels", "[", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"LaunchKernels", "[", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"DirectoryQ", "[", 
        RowBox[{"FileNameJoin", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"NotebookDirectory", "[", "]"}], 
           ",", "\"\<Auxiliary data\>\""}], "}"}], "]"}], "]"}], "//", 
       "ToString"}], ")"}], "\[Equal]", "\"\<False\>\""}], ",", 
    RowBox[{"CreateDirectory", "[", 
     RowBox[{"FileNameJoin", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"NotebookDirectory", "[", "]"}], 
        ",", "\"\<Auxiliary data\>\""}], "}"}], "]"}], "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"choiceslist", "=", 
   RowBox[{"{", 
    RowBox[{"\"\<Tabulated Nevents+sensitivity\>\"", 
     ",", "\"\<Sensitivity only (tabulated Nevents must be produced before)\>\
\"", ",", "\"\<Tabulated Nevents only\>\"", ",", "\"\<Acceptance\>\""}], 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"taglist", "[", "\"\<Acceptance\>\"", "]"}], 
   "=", "\"\<Acceptance\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"taglist", "[", "\"\<Tabulated Nevents+sensitivity\>\"", "]"}], "=", 
   RowBox[{
    RowBox[{"taglist", "[", "\"\<Tabulated Nevents only\>\"", "]"}], 
    "=", "\"\<Number-of-events+sensitivity\>\""}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
   "taglist", 
    "[", "\"\<Sensitivity only (tabulated Nevents must be produced \
before)\>\"", "]"}], "=", "\"\<Sensitivity\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NotebookEvaluate", "[", 
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"NotebookDirectory", "[", "]"}], 
      ",", "\"\<codes/dialog-windows.nb\>\""}], "}"}], "]"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"launchoptions", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"Keys", "[", 
     RowBox[{"DownValues", "@", "taglist"}], "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", "1", ",", "1"}], "]"}], "]"}], "//", "Sort"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MapThread", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"explanationlist", "[", "#1", "]"}], "=", "#2"}], ")"}], "&"}],
     ",", 
    RowBox[{"{", 
     RowBox[{"launchoptions", ",", 
      RowBox[{"{", 
       RowBox[{"\"\<Produce acceptances plots only (see Fig. 12 and \
explanation in text of 2305.13383)\>\"", 
        ",", "\"\<Produce sensitivities assuming that the tabulated number of \
events has been produced before\>\"", 
        ",", "\"\<Produce tabulated number of events (mass, coupling, \
Nevents(mass, coupling))\>\"", 
        ",", "\"\<Produce tabulated number of events and then \
sensitivity\>\""}], "}"}]}], "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"computationchoice", "=", 
  RowBox[{"selectionDialogExplanationOneOption", "[", 
   RowBox[{"launchoptions", ",", 
    RowBox[{
     RowBox[{
      RowBox[{"explanationlist", "[", "#", "]"}], "&"}], "/@", 
     "launchoptions"}], 
    ",", "\"\<Select the regime of launching the notebook\>\"", ",", "250"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"tagselected", "=", 
  RowBox[{"taglist", "[", "computationchoice", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
    "computationchoice", "==", "\"\<Tabulated Nevents+sensitivity\>\""}], ",", 
    RowBox[{"sensComp", "=", "True"}], ",", 
    RowBox[{"sensComp", "=", "False"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"BlockEvaluation", "[", "tagselected", "]"}]}], "Input",
 CellChangeTimes->{{3.893437585709897*^9, 3.8934375895369635`*^9}, {
   3.8934376329497385`*^9, 3.893437658846809*^9}, 3.8935730809859295`*^9, {
   3.893665349653804*^9, 3.8936653502873545`*^9}, {3.895053036918769*^9, 
   3.8950530371382556`*^9}, {3.895127015867475*^9, 3.8951270372355633`*^9}, 
   3.9025622087158365`*^9, 3.9027295043110003`*^9, 3.9029750439217606`*^9, {
   3.9029751084331856`*^9, 3.9029751137586985`*^9}, 3.9146666160581236`*^9, {
   3.9168225613271475`*^9, 3.9168225615398235`*^9}, {3.9170215527964497`*^9, 
   3.917021552947195*^9}, 3.948258133814497*^9, {3.9506035785900745`*^9, 
   3.9506035787537384`*^9}, {3.9506873360521164`*^9, 3.950687336226269*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"4fee1dbc-f123-4728-9e60-81aad253082b"]
}, Closed]],

Cell[CellGroupData[{

Cell["Preliminary definitions (launch first)", "Title",
 CellChangeTimes->{{3.7552434949579296`*^9, 3.755243495237189*^9}, {
  3.88501652694691*^9, 3.885016532955313*^9}, {3.8850204805201235`*^9, 
  3.885020485584347*^9}},
 CellTags->{
  "Acceptance", 
   "Number-of-events+sensitivity"},ExpressionUUID->"c7fbc496-1765-4913-bda1-\
eb19f9d14ec4"],

Cell[CellGroupData[{

Cell["Loading necessary routines", "Chapter",
 CellChangeTimes->{{3.891315426588935*^9, 3.891315432542842*^9}, {
  3.9165033404709945`*^9, 3.9165033463985844`*^9}},
 CellTags->{
  "Acceptance", 
   "Number-of-events+sensitivity"},ExpressionUUID->"7856a6bd-3005-de41-bdc2-\
79f63e2bc7ab"],

Cell[BoxData[
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Length", "[", "inecessary", "]"}], "==", "0"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"NotebookEvaluate", "[", 
     RowBox[{"FileNameJoin", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"NotebookDirectory", "[", "]"}], 
        ",", "\"\<codes/generic.nb\>\""}], "}"}], "]"}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"NotebookEvaluate", "[", 
     RowBox[{"FileNameJoin", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"NotebookDirectory", "[", "]"}], 
        ",", "\"\<codes/dialog-windows.nb\>\""}], "}"}], "]"}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"NotebookEvaluate", "[", 
     RowBox[{"FileNameJoin", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"NotebookDirectory", "[", "]"}], 
        ",", "\"\<codes/for-sensitivities.nb\>\""}], "}"}], "]"}], "]"}], ";",
     "\[IndentingNewLine]", 
    RowBox[{"inecessary", "=", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], ";"}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.890711783488103*^9, 3.89071178348964*^9}, {
   3.8907121412539587`*^9, 3.8907121413711557`*^9}, {3.890712694841427*^9, 
   3.8907126950000925`*^9}, {3.890712790376151*^9, 3.8907128219919777`*^9}, {
   3.891018553068019*^9, 3.8910185548862777`*^9}, {3.914141327087761*^9, 
   3.9141413282588053`*^9}, 3.9165033910195627`*^9, {3.916503434997039*^9, 
   3.9165034401725807`*^9}, {3.9165108789774036`*^9, 
   3.9165108974096084`*^9}, {3.9165109290075464`*^9, 3.916510969839264*^9}, {
   3.948258207380787*^9, 3.948258211345028*^9}, {3.9506035832995644`*^9, 
   3.9506035834849567`*^9}},
 CellTags->{"Acceptance", "Number-of-events+sensitivity"},
 CellLabel->"In[1]:=",ExpressionUUID->"a703e3df-8d64-ce4f-8380-8f0535af55ae"]
}, Closed]],

Cell[CellGroupData[{

Cell["Various directories", "Chapter",
 CellChangeTimes->{{3.913804059957842*^9, 3.913804062327417*^9}},
 CellTags->{
  "Acceptance", 
   "Number-of-events+sensitivity"},ExpressionUUID->"142d4967-f301-4310-a32c-\
a4120d5d4aa9"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"modelsInelastic", "=", 
   RowBox[{"Select", "[", 
    RowBox[{
     RowBox[{"Import", "[", 
      RowBox[{
       RowBox[{"FileNameJoin", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"NotebookDirectory", "[", "]"}], 
          ",", "\"\<phenomenology\>\"", ",", "\"\<ModelDescriptors.mx\>\""}], 
         "}"}], "]"}], ",", "\"\<MX\>\""}], "]"}], ",", 
     RowBox[{
      RowBox[{"StringContainsQ", "[", 
       RowBox[{
        RowBox[{"#", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", "\"\<Inelastic-dipole-DM\>\""}],
        "]"}], "&"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"LLPdirName", "=", 
  RowBox[{"selectionDialogExplanationOneOption", "[", 
   RowBox[{
    RowBox[{"modelsInelastic", "[", 
     RowBox[{"[", 
      RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", 
    RowBox[{"modelsInelastic", "[", 
     RowBox[{"[", 
      RowBox[{"All", ",", "2"}], "]"}], "]"}], 
    ",", "\"\<Select the inelastic dipole DM model\>\"", ",", "400"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"ToString", "[", 
      RowBox[{"Head", "[", "computationchoice", "]"}], "]"}], 
     "==", "\"\<Symbol\>\""}], ",", 
    RowBox[{"computationchoice", "=", "\"\<Tabulated Nevents only\>\""}]}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
     "computationchoice", "==", "\"\<Tabulated Nevents+sensitivity\>\""}], ",", 
     RowBox[{"sensComp", "=", "True"}], ",", 
     RowBox[{"sensComp", "=", "False"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Set", " ", "the", " ", "directory", " ", "for", " ", "the", " ", "search",
     " ", "where", " ", "tabulated", " ", "acceptances", " ", "are", " ", 
    "located"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"directory", "[", "\"\<Acceptances\>\"", "]"}], "=", 
    RowBox[{"FileNameJoin", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"NotebookDirectory", "[", "]"}], ",", "\"\<Acceptances\>\""}], 
      "}"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Set", " ", "the", " ", "directory", " ", "for", " ", "the", " ", 
     "search", " ", "where", " ", "tabulated", " ", "angle"}], "-", 
    RowBox[{"energy", " ", "distributions", " ", "are", " ", "located"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"directory", "[", "\"\<Distribution\>\"", "]"}], "=", 
    RowBox[{"FileNameJoin", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"NotebookDirectory", "[", "]"}], 
       ",", "\"\<spectra/New physics particles spectra\>\"", ",", 
       "LLPdirName"}], "}"}], "]"}]}], ";"}], " ", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "The", " ", "directory", " ", "storing", " ", "production", " ", "weights",
     " ", "of", " ", "the", " ", "given", " ", "LLP"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"directory", "[", "\"\<Production weights\>\"", "]"}], "=", 
    RowBox[{"FileNameJoin", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"NotebookDirectory", "[", "]"}], ",", "\"\<phenomenology\>\"", 
       ",", "LLPdirName", ",", "\"\<Production probabilities\>\""}], "}"}], 
     "]"}]}], ";"}], " ", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Directory", " ", "to", " ", "which", " ", "various", " ", "auxillary", " ",
     "datasets", " ", "will", " ", "be", " ", "stored"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"directory", "[", "\"\<Auxiliary\>\"", "]"}], "=", 
    RowBox[{"FileNameJoin", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"NotebookDirectory", "[", "]"}], ",", "\"\<Auxiliary data\>\"",
        ",", "LLPdirName"}], "}"}], "]"}]}], ";"}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"!", 
      RowBox[{"DirectoryQ", "[", 
       RowBox[{"directory", "[", "\"\<Auxiliary\>\"", "]"}], "]"}]}], ",", 
     RowBox[{"CreateDirectory", "[", 
      RowBox[{"directory", "[", "\"\<Auxiliary\>\"", "]"}], "]"}]}], "]"}], 
   ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Directory", " ", "containing", " ", "decay", " ", "widths", " ", "of", " ",
     "the", " ", "LLPs"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"directory", "[", "\"\<Decays\>\"", "]"}], "=", 
    RowBox[{"FileNameJoin", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"NotebookDirectory", "[", "]"}], ",", "\"\<phenomenology\>\"", 
       ",", "LLPdirName", ",", "\"\<decay widths\>\""}], "}"}], "]"}]}], 
   ";"}], " "}]}], "Input",
 CellChangeTimes->{{3.913804080271287*^9, 3.913804171309696*^9}, {
   3.913804205284999*^9, 3.913804380241178*^9}, {3.9138103204454637`*^9, 
   3.9138103216469903`*^9}, 3.9138295316757774`*^9, {3.9138664030078764`*^9, 
   3.9138664044074554`*^9}, {3.914653345074012*^9, 3.9146533455801425`*^9}, {
   3.9156430041420145`*^9, 3.915643004155946*^9}, {3.9506873706720276`*^9, 
   3.950687370871132*^9}, {3.9512116333235607`*^9, 3.951211688342705*^9}, {
   3.9512128204173393`*^9, 3.951212893903248*^9}, {3.9512129889698296`*^9, 
   3.9512130510044975`*^9}, {3.9514703407009144`*^9, 3.9514703409350014`*^9}},
 CellTags->{"Acceptance", "Number-of-events+sensitivity"},
 CellLabel->"In[2]:=",ExpressionUUID->"b2f3e96a-d2a2-4f84-a6a4-563b842c1e7f"]
}, Closed]],

Cell[CellGroupData[{

Cell["LLP phenomenology: production probabilities", "Chapter",
 CellChangeTimes->{{3.835270415198964*^9, 3.8352704154970675`*^9}, {
   3.854441650570236*^9, 3.8544416515373263`*^9}, {3.885016402104937*^9, 
   3.8850164030053596`*^9}, 3.885019196491799*^9, {3.885019273945055*^9, 
   3.88501928458453*^9}, {3.9137189927638807`*^9, 3.9137190046798325`*^9}, {
   3.913885745903579*^9, 3.9138857544399056`*^9}, {3.914656062909051*^9, 
   3.9146560632562523`*^9}, 3.915643004165702*^9, 3.9166468655201597`*^9, 
   3.9512130678719177`*^9},
 CellTags->{
  "Acceptance", 
   "Number-of-events+sensitivity"},ExpressionUUID->"d6722c5a-93b4-416a-bc00-\
f0c22121cd21"],

Cell[CellGroupData[{

Cell["Production probabilities", "Section",
 CellChangeTimes->{{3.826713169183443*^9, 3.8267131698544655`*^9}, {
  3.885138658855132*^9, 3.8851386649516826`*^9}},
 CellTags->{
  "Acceptance", 
   "Number-of-events+sensitivity"},ExpressionUUID->"862685fe-43b6-482e-b82b-\
9fcf0703194f"],

Cell[BoxData[{
 RowBox[{"PmotherToLLP", "//", "Clear"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FacilitiesList", "=", 
   RowBox[{"{", 
    RowBox[{"\"\<SPS\>\"", ",", "\"\<FermilabBD\>\"", ",", "\"\<LHC\>\"", 
     ",", "\"\<FCC-hh\>\"", ",", "\"\<Serpukhov\>\""}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DataBrRatios", "[", 
    RowBox[{"mLLP_", ",", "\[Mu]_"}], "]"}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Select", "[", 
      RowBox[{
       RowBox[{"Import", "[", 
        RowBox[{
         RowBox[{"FileNameJoin", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"NotebookDirectory", "[", "]"}], 
            ",", "\"\<phenomenology\>\"", ",", "\"\<Inelastic-dipole-DM\>\"", 
            ",", "\"\<Production probabilities\>\"", 
            ",", "\"\<BrRatiosProduction.mx\>\""}], "}"}], "]"}], 
         ",", "\"\<MX\>\""}], "]"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "==", "LLPdirName"}], "&"}]}], 
      "]"}], "[", 
     RowBox[{"[", "1", "]"}], "]"}], "[", 
    RowBox[{"[", "3", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"availableProcs", "[", "\"\<Serpukhov\>\"", "]"}], "=", 
    RowBox[{"{", 
     RowBox[{"\"\<Pi0\>\"", ",", "\"\<Eta\>\"", ",", "\"\<EtaPr\>\"", 
      ",", "\"\<Omega\>\"", ",", "\"\<Rho0\>\"", ",", "\"\<Phi\>\""}], 
     "}"}]}], ";"}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"availableProcs", "[", "\"\<FermilabBD\>\"", "]"}], "=", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"availableProcs", "[", "\"\<Serpukhov\>\"", "]"}], ",", 
     RowBox[{"{", "\"\<JPsi\>\"", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"availableProcs", "[", "\"\<SPS\>\"", "]"}], "=", 
  RowBox[{
   RowBox[{"availableProcs", "[", "\"\<LHC\>\"", "]"}], "=", 
   RowBox[{
    RowBox[{"availableProcs", "[", "\"\<FCC-hh\>\"", "]"}], "=", 
    RowBox[{"Join", "[", 
     RowBox[{
      RowBox[{"availableProcs", "[", "\"\<FermilabBD\>\"", "]"}], ",", 
      RowBox[{"{", "\"\<Upsilon\>\"", "}"}]}], "]"}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"proc", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"DataBrRatios", "[", 
          RowBox[{"mLLP", ",", "\[Mu]"}], "]"}], "[", 
         RowBox[{"[", "i", "]"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"BrRatioDecay", "[", 
        RowBox[{"proc", ",", "mLLP_", ",", "\[Mu]_"}], "]"}], "=", 
       RowBox[{
        RowBox[{
         RowBox[{"DataBrRatios", "[", 
          RowBox[{"mLLP", ",", "\[Mu]"}], "]"}], "[", 
         RowBox[{"[", "i", "]"}], "]"}], "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"MemberQ", "[", 
           RowBox[{
            RowBox[{"availableProcs", "[", "Facility", "]"}], ",", "proc"}], 
           "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"PmotherToLLP", "[", 
             RowBox[{"mLLP_", ",", "\[Mu]_", ",", "proc", ",", "Facility"}], 
             "]"}], "=", 
            RowBox[{"BrRatioDecay", "[", 
             RowBox[{"proc", ",", "mLLP", ",", "\[Mu]"}], "]"}]}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"Facility", ",", "FacilitiesList"}], "}"}]}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "1", ",", 
     RowBox[{"Length", "[", 
      RowBox[{"DataBrRatios", "[", 
       RowBox[{"mLLP_", ",", "\[Mu]_"}], "]"}], "]"}], ",", "1"}], "}"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"WeightsCombinations", "=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Keys", "[", 
        RowBox[{"DownValues", "@", "PmotherToLLP"}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "1", ",", "#"}], "]"}], "]"}], "&"}], "/@", 
     RowBox[{"{", 
      RowBox[{"3", ",", "4"}], "}"}]}], "//", "Transpose"}], "//", 
   "Sort"}]}]}], "Input",
 CellChangeTimes->{{3.9146534326542835`*^9, 3.9146535095213413`*^9}, 
   3.9146541336142807`*^9, {3.9146541848600383`*^9, 3.9146542357599363`*^9}, {
   3.9146543165336637`*^9, 3.914654347483191*^9}, {3.914654382180154*^9, 
   3.914654392990925*^9}, {3.914654428782303*^9, 3.9146545801846075`*^9}, {
   3.9146546319739456`*^9, 3.914654697455997*^9}, {3.914655788254218*^9, 
   3.914655911784731*^9}, {3.914658337910942*^9, 3.9146583613410964`*^9}, {
   3.9146584472314186`*^9, 3.9146584506300526`*^9}, {3.914658582841715*^9, 
   3.9146586808901463`*^9}, {3.914658881471237*^9, 3.914658883771141*^9}, 
   3.914658959489977*^9, {3.915643004196101*^9, 3.9156430042393703`*^9}, {
   3.9168298403429346`*^9, 3.9168298408449087`*^9}, {3.9506881069309864`*^9, 
   3.9506881308843346`*^9}, {3.9506882281653366`*^9, 
   3.9506882423851814`*^9}, {3.9506883499152184`*^9, 3.950688352718355*^9}, {
   3.9506888099970455`*^9, 3.9506888317644024`*^9}, {3.951213257075985*^9, 
   3.9512132921718426`*^9}, {3.9512134238549976`*^9, 
   3.9512134646941223`*^9}, {3.9512135019672813`*^9, 
   3.9512135055287266`*^9}, {3.9512136033923016`*^9, 3.951213753451647*^9}, {
   3.9512138269348335`*^9, 3.951213831996151*^9}, {3.9512141450786*^9, 
   3.9512141907574883`*^9}, {3.9512143021333313`*^9, 
   3.9512143228195057`*^9}, {3.951214384432873*^9, 3.951214465751545*^9}, 
   3.951214650504732*^9, {3.9512148798418713`*^9, 3.9512149249116898`*^9}, {
   3.9512149838615913`*^9, 3.9512150170939617`*^9}, {3.9512156206685543`*^9, 
   3.951215658165018*^9}, 3.9512156984391575`*^9, {3.95121577466922*^9, 
   3.951215787854397*^9}},
 CellTags->{"Acceptance", "Number-of-events+sensitivity"},
 CellLabel->"In[12]:=",ExpressionUUID->"f1d79d2e-d855-44c1-b2cc-e9413f8e981e"]
}, Closed]],

Cell[CellGroupData[{

Cell["Scanning for tabulated distributions", "Section",
 CellChangeTimes->{{3.9137150010274553`*^9, 3.9137150224099426`*^9}, {
  3.913715411520641*^9, 3.913715414252445*^9}},
 CellTags->{
  "Acceptance", 
   "Number-of-events+sensitivity"},ExpressionUUID->"7937f012-5420-4399-b275-\
9d1989e428a9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Define", " ", "the", " ", "file", " ", "pattern"}], "*)"}], "\n", 
  RowBox[{
   RowBox[{
    RowBox[{"pattern", "=", "\"\<DoubleDistr_*_*_*.m\>\""}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Search", " ", "for", " ", "files", " ", "matching", " ", "the", " ", 
     "pattern", " ", "in", " ", "the", " ", "directory", " ", "and", " ", 
     "its", " ", "subdirectories"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"matchingFiles", "=", 
     RowBox[{"FileNames", "[", 
      RowBox[{"pattern", ",", 
       RowBox[{"{", 
        RowBox[{"directory", "[", "\"\<Distribution\>\"", "]"}], "}"}], ",", 
       "Infinity"}], "]"}]}], ";"}], "\n", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"List", " ", "of", " ", "LLPs"}], ",", " ", 
     RowBox[{"production", " ", "modes"}], ",", " ", 
     RowBox[{
     "and", " ", "facilities", " ", "for", " ", "which", " ", "the", " ", 
      "tabulated", " ", "distributions", " ", "have", " ", "been", " ", 
      "computed", " ", "at", " ", "the", " ", "previous", " ", "stage", " ", 
      "of", " ", "using", " ", "SensCalc"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ExtractedProductionParameters", "=", 
     RowBox[{"Function", "[", 
      RowBox[{"filename", ",", 
       RowBox[{
        RowBox[{"parts", "=", 
         RowBox[{"StringSplit", "[", 
          RowBox[{
           RowBox[{"FileNameTake", "[", "filename", "]"}], ",", "\"\<_\>\""}],
           "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"parts", "[", 
           RowBox[{"[", "2", "]"}], "]"}], ",", 
          RowBox[{"parts", "[", 
           RowBox[{"[", "3", "]"}], "]"}], ",", 
          RowBox[{"StringDrop", "[", 
           RowBox[{
            RowBox[{"parts", "[", 
             RowBox[{"[", "4", "]"}], "]"}], ",", 
            RowBox[{"-", "2"}]}], "]"}]}], "}"}]}]}], " ", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"combinations", " ", "selected", " ", "LLP"}], ",", " ", 
     RowBox[{"production", " ", "channel"}], ",", " ", 
     RowBox[{
     "facility", " ", "for", " ", "which", " ", "the", " ", "tabulated", " ", 
      "distributions", " ", "are", " ", "present"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"DistrCombinations", "=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"ExtractedProductionParameters", "/@", "matchingFiles"}], ")"}],
      "//", "Sort"}]}]}]}]], "Input",
 CellChangeTimes->{{3.9137151636915593`*^9, 3.9137152465178137`*^9}, {
   3.9137153053586187`*^9, 3.913715399589816*^9}, {3.913718678447782*^9, 
   3.913718708673525*^9}, {3.913719203960288*^9, 3.9137192388759937`*^9}, {
   3.913804074855399*^9, 3.913804089247952*^9}, 3.9138043135262485`*^9, {
   3.913810357631002*^9, 3.913810363616334*^9}, {3.9138256248481245`*^9, 
   3.9138256471350822`*^9}, 3.9138665659237595`*^9, {3.91564300417898*^9, 
   3.9156430041799445`*^9}, {3.9506884876469383`*^9, 3.950688494468523*^9}},
 CellTags->{"Acceptance", "Number-of-events+sensitivity"},
 CellLabel->"In[20]:=",ExpressionUUID->"25cebf9b-4dec-4ac0-a975-fedfa9a7d346"]
}, Closed]]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Specifying the experiment and run next sections", "Title",
 CellChangeTimes->{{3.8876177939846563`*^9, 3.8876177965376587`*^9}, {
  3.914140539510558*^9, 3.914140544040797*^9}},
 CellTags->{
  "Acceptance", 
   "Number-of-events+sensitivity"},ExpressionUUID->"fa4de700-3b7a-8f4d-90c0-\
187b066f8a23"],

Cell[CellGroupData[{

Cell["Specifying the experiment", "Chapter",
 CellChangeTimes->{{3.902729140157612*^9, 3.90272914444062*^9}, {
  3.9141405357221785`*^9, 3.9141405362140307`*^9}},
 CellTags->{
  "Acceptance", 
   "Number-of-events+sensitivity"},ExpressionUUID->"3e00ad76-64aa-0649-a2d2-\
8e26b6499e53"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"SetDirectory", "[", 
    RowBox[{"NotebookDirectory", "[", "]"}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Parent", " ", "directory"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"NotebookDirectory", "[", "]"}], "//", "ParentDirectory"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ExperimentDirectoriesList", "=", 
    RowBox[{"Select", "[", 
     RowBox[{
      RowBox[{"FileNames", "[", 
       RowBox[{"\"\<*\>\"", ",", 
        RowBox[{"directory", "[", "\"\<Acceptances\>\"", "]"}], ",", "1"}], 
       "]"}], ",", "DirectoryQ"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"List", " ", "of", " ", "available", " ", "experiments", " ", 
    RowBox[{"(", 
     RowBox[{
     "for", " ", "which", " ", "the", " ", "geometry", " ", "has", " ", 
      "been", " ", "implemented"}], ")"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ExperimentsListTemp", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"FileNameTake", "[", 
      RowBox[{
       RowBox[{"ExperimentDirectoriesList", "[", 
        RowBox[{"[", "i", "]"}], "]"}], ",", 
       RowBox[{"-", "1"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "ExperimentDirectoriesList", "]"}], ",", "1"}], 
      "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ExperimentsListTemp2", "=", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"Partition", "[", 
      RowBox[{"ExperimentsListTemp", ",", "1"}], "]"}], ",", 
     RowBox[{"(*", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"TrueQ", "@", 
          RowBox[{"FileExistsQ", "@", 
           RowBox[{"FileNameJoin", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"directory", "[", "\"\<Acceptances\>\"", "]"}], ",", 
              RowBox[{"ExperimentsListTemp", "[", 
               RowBox[{"[", "i", "]"}], "]"}], ",", 
              RowBox[{"ToString", "@", 
               RowBox[{"StringForm", "[", 
                RowBox[{"\"\<Acceptance_``_for_``.m\>\"", ",", 
                 RowBox[{"ExperimentsListTemp", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], ",", "LLPdirName"}], 
                "]"}]}]}], "}"}], "]"}]}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "ExperimentsListTemp", "]"}]}], "}"}]}], 
       "]"}], "*)"}], 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Length", "[", 
          RowBox[{"FileNames", "[", 
           RowBox[{"FileNameJoin", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"directory", "[", "\"\<Acceptances\>\"", "]"}], ",", 
              RowBox[{"ExperimentsListTemp", "[", 
               RowBox[{"[", "i", "]"}], "]"}], ",", 
              RowBox[{"ToString", "@", 
               RowBox[{"StringForm", "[", 
                RowBox[{"\"\<Acceptance_``_for_``*.m\>\"", ",", 
                 RowBox[{"ExperimentsListTemp", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], ",", "LLPdirName"}], 
                "]"}]}]}], "}"}], "]"}], "]"}], "]"}], ">", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "ExperimentsListTemp", "]"}]}], "}"}]}], 
      "]"}], ",", "2"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", "\"\<List of available experiments:\>\"", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ExperimentsListTemp2", "=", 
   RowBox[{"Select", "[", 
    RowBox[{"ExperimentsListTemp2", ",", 
     RowBox[{
      RowBox[{"FileExistsQ", "[", 
       RowBox[{"FileNameJoin", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"directory", "[", "\"\<Acceptances\>\"", "]"}], ",", 
          RowBox[{"#", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          
          RowBox[{"\"\<AvailableDescriptions-\>\"", "<>", "LLPdirName", 
           "<>", "\"\<.mx\>\""}]}], "}"}], "]"}], "]"}], "&"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"ExperimentsList", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"Select", "[", 
     RowBox[{"ExperimentsListTemp2", ",", 
      RowBox[{
       RowBox[{
        RowBox[{"#", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", "True"}], "&"}]}], "]"}],
     "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", "1"}], "]"}], "]"}], "//", "Sort"}]}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Length", "[", "ExperimentsList", "]"}], "\[Equal]", "0"}], ",", 
   RowBox[{
   "Print", "[", "\"\<No experiment is available, generate first the \
acceptance for the given experiment using module 1\>\"", "]"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", "\"\<Selected experiments:\>\"", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"availablePhenoDescriptions", "[", "exp_", "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", "\t", 
    RowBox[{"descrFile", "=", 
     RowBox[{"Import", "[", 
      RowBox[{
       RowBox[{"FileNameJoin", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"directory", "[", "\"\<Acceptances\>\"", "]"}], ",", "exp", 
          ",", 
          
          RowBox[{"\"\<AvailableDescriptions-\>\"", "<>", "LLPdirName", 
           "<>", "\"\<.mx\>\""}]}], "}"}], "]"}], ",", "\"\<MX\>\""}], 
      "]"}]}]}], "\[IndentingNewLine]", "\t", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"SelectedExperimentListTemp2", "=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Length", "[", "ExperimentsList", "]"}], "\[NotEqual]", "0"}], ",", 
    RowBox[{"selectionDialog", "[", 
     RowBox[{"ExperimentsList", ",", "\"\<Select the experiments:\>\""}], 
     "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"IfAllPheno", "=", "True"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SelectedExperimentList", "=", 
   RowBox[{"{", 
    RowBox[{"{", "}"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{"IfAllPheno", ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Do", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"descriptions", "=", 
          RowBox[{"availablePhenoDescriptions", "[", "exp", "]"}]}], "}"}], ",",
         "\[IndentingNewLine]", 
        RowBox[{"SelectedExperimentList", "=", 
         RowBox[{"Join", "[", 
          RowBox[{"SelectedExperimentList", ",", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"exp", ",", 
               RowBox[{
                RowBox[{"descriptions", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", 
               RowBox[{
                RowBox[{"descriptions", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", 
               RowBox[{"Length", "[", "descriptions", "]"}], ",", "1"}], 
              "}"}]}], "]"}]}], "]"}]}]}], "\[IndentingNewLine]", "]"}], 
      "\[IndentingNewLine]", ",", 
      RowBox[{"{", 
       RowBox[{"exp", ",", "SelectedExperimentListTemp2"}], "}"}]}], "]"}], ";",
     "\[IndentingNewLine]", 
    RowBox[{"SelectedExperimentList", "=", 
     RowBox[{"Drop", "[", 
      RowBox[{"SelectedExperimentList", ",", "1"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SelectedExperimentList", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"{", "exp", "}"}], ",", 
         RowBox[{
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"availablePhenoDescriptions", "[", "exp", "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"#", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "==", "\"\<Default\>\""}], 
             "&"}]}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"exp", ",", "SelectedExperimentListTemp2"}], "}"}]}], "]"}]}],
     ";"}]}], "\[IndentingNewLine]", 
  "]"}], "\[IndentingNewLine]", "SelectedExperimentList", "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"icounter", "=", "1"}], ";"}]}], "Input",
 CellChangeTimes->{{3.8851403254718485`*^9, 3.8851403429411273`*^9}, {
   3.8854395484478483`*^9, 3.885439559226637*^9}, {3.8854397351242537`*^9, 
   3.885439739219259*^9}, {3.8858794196350574`*^9, 3.885879423032172*^9}, 
   3.886141121558817*^9, {3.886821665769628*^9, 3.8868216684602585`*^9}, {
   3.887617086304534*^9, 3.8876170990910044`*^9}, 3.889080211074895*^9, {
   3.890287800311657*^9, 3.890287802587648*^9}, {3.892189472726385*^9, 
   3.8921895121150846`*^9}, 3.892705546310735*^9, 3.8932345108531446`*^9, 
   3.902763528561518*^9, {3.902889537778877*^9, 3.9028895446827335`*^9}, {
   3.9138868703932114`*^9, 3.913886928383787*^9}, 3.915643060000375*^9, 
   3.948257367823641*^9, {3.9483017018501377`*^9, 3.9483017557965126`*^9}, {
   3.94830415597225*^9, 3.94830415727532*^9}},
 CellTags->{"Acceptance", "Number-of-events+sensitivity"},
 CellLabel->
  "In[314]:=",ExpressionUUID->"f06baae7-16fd-c94b-a9cb-b17334c76bbd"]
}, Closed]],

Cell[CellGroupData[{

Cell["Running block for next sections", "Chapter",
 CellChangeTimes->{{3.902729140157612*^9, 3.90272914444062*^9}},
 CellTags->{
  "Acceptance", 
   "Number-of-events+sensitivity"},ExpressionUUID->"5473bfb1-869b-a64b-86dd-\
5562306f09e7"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"BlockEvaluation", "[", "tag_", "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"nb", "=", 
      RowBox[{"EvaluationNotebook", "[", "]"}]}], ";", "\n", 
     RowBox[{"NotebookFind", "[", 
      RowBox[{"nb", ",", "tag", ",", "All", ",", "CellTags"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"SelectionEvaluate", "[", "nb", "]"}]}]}], "\[IndentingNewLine]",
    "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"tagselected", "==", "\"\<Number-of-events+sensitivity\>\""}], ",",
    "\[IndentingNewLine]", 
   RowBox[{"Do", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{
      "BlockEvaluation", 
       "[", "\"\<Number-of-events-computation+sensitivity\>\"", "]"}], ";"}], 
     "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{"icounter", ",", "1", ",", 
       RowBox[{"Length", "[", "SelectedExperimentList", "]"}], ",", "1"}], 
      "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"tagselected", "==", "\"\<Acceptance\>\""}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
        "BlockEvaluation", "[", "\"\<Acceptance-computation\>\"", "]"}], 
        ";"}], "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"icounter", ",", "1", ",", 
         RowBox[{"Length", "[", "SelectedExperimentList", "]"}], ",", "1"}], 
        "}"}]}], "]"}]}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]", "]"}]}], "Input",
 CellChangeTimes->{{3.9027291581950865`*^9, 3.902729215695462*^9}, {
   3.902761777481885*^9, 3.902761802513644*^9}, 3.902889536609843*^9, 
   3.9038925480063467`*^9, 3.914667536575886*^9, {3.915183587630067*^9, 
   3.915183588551358*^9}},
 CellTags->{"Acceptance", "Number-of-events+sensitivity"},
 CellLabel->
  "In[331]:=",ExpressionUUID->"cfd541f2-c0a1-7145-845b-c5672633bdaf"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Number of events", "Title",
 CellChangeTimes->{{3.885140281753849*^9, 3.8851402836781845`*^9}},
 CellTags->
  "Number-of-events-computation+sensitivity",ExpressionUUID->"128d78c3-8bd2-\
4cc0-aade-f5ea999c5498"],

Cell[CellGroupData[{

Cell["Particular experiment", "Chapter",
 CellChangeTimes->{{3.9165042001551485`*^9, 3.9165042041207294`*^9}, {
  3.9165090857383037`*^9, 3.916509094318386*^9}},
 CellTags->{
  "Acceptance-computation", 
   "Number-of-events-computation+sensitivity"},ExpressionUUID->"14184674-a362-\
4b71-85ea-2766ddc38791"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"{", 
   RowBox[{
   "SelectedExperiment", ",", "SelectedDescr", ",", 
    "ExplanationSelectedDescr"}], "}"}], "=", 
  RowBox[{"SelectedExperimentList", "[", 
   RowBox[{"[", 
    RowBox[{"icounter", "++"}], "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"Row", "[", 
   RowBox[{"{", 
    RowBox[{"\"\<Experiment \>\"", ",", 
     RowBox[{"icounter", "-", "1"}], ",", "\"\</\>\"", ",", 
     RowBox[{"Length", "[", "SelectedExperimentList", "]"}]}], "}"}], "]"}], 
  "]"}]}], "Input",
 CellChangeTimes->{3.9506889906524696`*^9},
 CellTags->{
  "Acceptance-computation", "Number-of-events-computation+sensitivity"},
 CellLabel->
  "In[333]:=",ExpressionUUID->"3b60b3d0-47b7-475a-950b-e1cd90a1b696"]
}, Closed]],

Cell[CellGroupData[{

Cell["Cross-sections, acceptances", "Chapter",
 CellChangeTimes->{
  3.887617684981284*^9, {3.8946372284965158`*^9, 3.894637232121416*^9}},
 CellTags->{
  "Acceptance-computation", 
   "Number-of-events-computation+sensitivity"},ExpressionUUID->"024306d0-6fd7-\
404c-b503-13b97cb70d6e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"dataAcceptances", "=", 
    RowBox[{"Import", "[", 
     RowBox[{
      RowBox[{"FileNameJoin", "[", 
       RowBox[{"{", 
        RowBox[{"FileNameJoin", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"directory", "[", "\"\<Acceptances\>\"", "]"}], ",", 
           "SelectedExperiment", ",", 
           RowBox[{"ToString", "@", 
            RowBox[{"StringForm", "[", 
             RowBox[{"\"\<Acceptance_``_for_``_decayDescription_``.m\>\"", ",", 
              RowBox[{"Sequence", "@@", 
               RowBox[{"{", 
                RowBox[{
                "SelectedExperiment", ",", "LLPdirName", ",", 
                 "SelectedDescr"}], "}"}]}]}], "]"}]}]}], "}"}], "]"}], "}"}],
        "]"}], ",", "\"\<MX\>\""}], "]"}]}], ";"}], "//", 
  "AbsoluteTiming"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "FacilityGivenExperiment", ",", "FullAcceptanceData0", ",", "decayDescr", 
     ",", 
     RowBox[{"c\[Tau]LLP", "[", 
      RowBox[{"mLLP_", ",", "\[Mu]_"}], "]"}]}], "}"}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"dataAcceptances", "[", 
        RowBox[{"[", "#", "]"}], "]"}], "//", "Developer`ToPackedArray"}], 
      ")"}], "&"}], "/@", 
    RowBox[{"{", 
     RowBox[{"1", ",", "3", ",", 
      RowBox[{"-", "2"}], ",", 
      RowBox[{"-", "1"}]}], "}"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ldecayLLP", "[", 
    RowBox[{"mLLP_", ",", "\[Mu]_", ",", "ELLP_"}], "]"}], "=", 
   RowBox[{
    RowBox[{"c\[Tau]LLP", "[", 
     RowBox[{"mLLP", ",", "\[Mu]"}], "]"}], "*", 
    FractionBox[
     SqrtBox[
      RowBox[{
       SuperscriptBox["ELLP", "2"], "-", 
       SuperscriptBox["mLLP", "2"]}]], "mLLP"]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BrVis", "[", "mLLP_", "]"}], "=", 
   RowBox[{"dataAcceptances", "[", 
    RowBox[{"[", "5", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Mu]val", "=", 
   SuperscriptBox["10", 
    RowBox[{"-", "5"}]]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ptc\[Tau]", "=", 
   RowBox[{"LogLogPlot", "[", 
    RowBox[{
     RowBox[{"c\[Tau]LLP", "[", 
      RowBox[{"ma", ",", "\[Mu]val"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"ma", ",", "0.01", ",", "0.1"}], "}"}], ",", 
     RowBox[{"ImageSize", "->", "Large"}], ",", 
     RowBox[{"Frame", "->", "True"}], ",", 
     RowBox[{"PlotStyle", "->", 
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{"Thick", ",", "Blue"}], "}"}], "}"}]}], ",", 
     RowBox[{"FrameStyle", "->", 
      RowBox[{"Directive", "[", 
       RowBox[{"Thick", ",", "Black", ",", "18"}], "]"}]}], ",", 
     RowBox[{"FrameLabel", "->", 
      RowBox[{"{", 
       RowBox[{"\"\<\!\(\*SubscriptBox[\(m\), \(LLP\)]\) [GeV]\>\"", 
        ",", "\"\<\!\(\*SubscriptBox[\(c\[Tau]\), \(LLP\)]\) [m]\>\""}], 
       "}"}]}], ",", 
     RowBox[{"PlotLabel", "->", 
      RowBox[{"Style", "[", 
       RowBox[{
        RowBox[{"Row", "[", 
         RowBox[{"{", 
          RowBox[{"\"\<\[Mu] = \>\"", ",", 
           RowBox[{"N", "[", "\[Mu]val", "]"}], 
           ",", "\"\< \!\(\*SuperscriptBox[\(GeV\), \(-1\)]\)\>\""}], "}"}], 
         "]"}], ",", "18", ",", "Thick", ",", "Black"}], "]"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ptbrvis", "=", 
   RowBox[{"LogLogPlot", "[", 
    RowBox[{
     RowBox[{"Evaluate", "[", 
      RowBox[{"BrVis", "[", "mLLP", "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"mLLP", ",", "0.02", ",", "10"}], "}"}], ",", 
     RowBox[{"Frame", "->", "True"}], ",", 
     RowBox[{"ImageSize", "->", "Large"}], ",", 
     RowBox[{"FrameStyle", "\[Rule]", 
      RowBox[{"Directive", "[", 
       RowBox[{"Black", ",", " ", "22"}], "]"}]}], ",", 
     RowBox[{"PlotStyle", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Thickness", "[", "0.003", "]"}], ",", "Blue"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Thickness", "[", "0.003", "]"}], ",", 
          RowBox[{"Darker", "@", "Red"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Thickness", "[", "0.003", "]"}], ",", 
          RowBox[{"Darker", "@", 
           RowBox[{"Darker", "@", "Green"}]}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Thickness", "[", "0.003", "]"}], ",", "Black"}], "}"}]}], 
       "}"}]}], ",", 
     RowBox[{"GridLines", "\[Rule]", "Automatic"}], ",", 
     RowBox[{"PlotRange", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0.1", ",", "10"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0.01", ",", "1.2"}], "}"}]}], "}"}]}], ",", 
     RowBox[{"Frame", "\[Rule]", "True"}], ",", 
     RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
     RowBox[{"FrameLabel", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"\"\<\!\(\*SubscriptBox[\(m\), \(LLP\)]\) [GeV]\>\"", 
        ",", "\"\<\!\(\*SubscriptBox[\(Br\), \(vis\)]\)\>\""}], "}"}]}], ",", 
     RowBox[{"PlotLabel", "\[Rule]", " ", 
      RowBox[{"Style", "[", 
       RowBox[{
        RowBox[{"Row", "[", 
         RowBox[{"{", 
          RowBox[{"\"\<For \>\"", ",", "SelectedExperiment"}], "}"}], "]"}], ",",
         " ", "20", ",", " ", "Black"}], "]"}]}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Style", "[", 
   RowBox[{
    RowBox[{"Row", "[", 
     RowBox[{"{", 
      RowBox[{"ptc\[Tau]", ",", "ptbrvis"}], "}"}], "]"}], ",", 
    RowBox[{"ImageSizeMultipliers", "->", 
     RowBox[{"{", 
      RowBox[{"1", ",", "1"}], "}"}]}]}], "]"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"___", "___", "___", "___", "___", "___", "___", "___", "___"}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Interpolation", " ", "of", " ", "the", " ", "tabulated", " ", 
     "azimuthal", " ", "acceptance"}], ",", " ", 
    RowBox[{"extracting", " ", 
     SubscriptBox["\[Theta]", 
      RowBox[{"min", "/", "max"}]]}], ",", " ", 
    RowBox[{"etc", "."}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"___", "___", "___", "___", "___", "___", "___", "___", "___"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"AzimuthalAcceptanceInt", "[", 
       RowBox[{"\[Theta]LLP_", ",", "zLLP_"}], "]"}], ",", 
      "\[Theta]minExpAll", ",", "\[Theta]maxExpAll", ",", "\[Theta]minExp", ",",
       "\[Theta]maxExp", ",", "zminExp", ",", "zmaxExp", ",", 
      RowBox[{"zmin\[Theta]", "[", "\[Theta]LLP_", "]"}], ",", 
      RowBox[{"zmax\[Theta]", "[", "\[Theta]LLP_", "]"}]}], "}"}], "=", 
    RowBox[{"Block\[Epsilon]Azimuthal", "[", "FullAcceptanceData0", "]"}]}], 
   ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Logarithmized", " ", "data", " ", "with", " ", "full", " ", 
     "acceptance"}], ",", " ", 
    RowBox[{
    "and", " ", "also", " ", "decay", " ", "acceptance", " ", "and", " ", 
     "full", " ", "acceptance", " ", "interpolations"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"FullAcceptanceData", ",", 
     RowBox[{"DecayAcceptanceInt", "[", 
      RowBox[{"mLLP_", ",", "\[Theta]LLP_", ",", "ELLP_", ",", "zLLP_"}], 
      "]"}], ",", 
     RowBox[{"FullAcceptanceInt", "[", 
      RowBox[{"mLLP_", ",", "\[Theta]LLP_", ",", "ELLP_", ",", "zLLP_"}], 
      "]"}], ",", "InGridm\[Epsilon]", ",", "InGrid\[Theta]\[Epsilon]", ",", 
     "InGridE\[Epsilon]", ",", "InGridz\[Epsilon]", ",", "\[Epsilon]vals", ",",
      "\[Epsilon]azvals", ",", "mmin\[Epsilon]", ",", "mmax\[Epsilon]"}], 
    "}"}], "=", 
   RowBox[{"Block\[Epsilon]Decay", "[", 
    RowBox[{"FullAcceptanceData0", ",", "zminExp", ",", "BrVis"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CrossSectionData", "=", 
   RowBox[{
    RowBox[{"dataAcceptances", "[", 
     RowBox[{"[", "4", "]"}], "]"}], "//", "Transpose"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"NpotGivenExperiment", "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Select", "[", 
        RowBox[{"CrossSectionData", ",", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", "\"\<Npot\>\""}], 
          "&"}]}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}], "[", 
      RowBox[{"[", "2", "]"}], "]"}], "//", "N"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"infoDialog", "[", 
    RowBox[{"Row", "[", 
     RowBox[{"{", 
      RowBox[{"\"\<The number of proton collisions is \>\"", ",", " ", 
       "NpotGivenExperiment", 
       ",", "\"\<. You may change it at the stage of computing the \
sensitivities\>\""}], "}"}], "]"}], "]"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"Row", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"\"\<Search for \>\"", "<>", "LLPdirName", "<>", "\"\< at \>\""}],
     ",", " ", "SelectedExperiment", ",", " ", "\"\< located at \>\"", ",", 
    "FacilityGivenExperiment", 
    ",", "\"\<. \!\(\*SubscriptBox[\(N\), \(collisions\)]\) = \>\"", ",", 
    "NpotGivenExperiment", ",", "\"\<. Decay description: \>\"", ",", " ", 
    "decayDescr"}], "}"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"\"\<Quantity\>\"", 
      ",", "\"\<\!\(\*SubscriptBox[\(\[Theta]\), \(min\)]\), rad\>\"", 
      ",", "\"\<\!\(\*SubscriptBox[\(\[Theta]\), \(max\)]\), rad\>\"", 
      ",", "\"\<\!\(\*SubscriptBox[\(\[Theta]\), \
\(min\)]\)(\!\(\*SubscriptBox[\(\[Epsilon]\), \(dec\)]\)), rad\>\"", 
      ",", "\"\<\!\(\*SubscriptBox[\(\[Theta]\), \
\(max\)]\)(\!\(\*SubscriptBox[\(\[Epsilon]\), \(dec\)]\)), rad\>\"", 
      ",", "\"\<\!\(\*SubscriptBox[\(z\), \(min\)]\), m\>\"", 
      ",", "\"\<\!\(\*SubscriptBox[\(z\), \(max\)]\), m\>\""}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"\"\<Description\>\"", 
      ",", "\"\<Min angle covered by experiment\>\"", 
      ",", "\"\<Max angle covered by experiment\>\"", 
      ",", "\"\<Min angle where \!\(\*SubscriptBox[\(\[Epsilon]\), \(decay\)]\
\)\[NotEqual]0\>\"", 
      ",", "\"\<Max angle where \!\(\*SubscriptBox[\(\[Epsilon]\), \(decay\)]\
\)\[NotEqual]0\>\"", ",", "\"\<Min long. displacement of the decay volume\>\"",
       ",", "\"\<Max long. displacement of the decay volume\>\""}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"\"\<Value\>\"", ",", "\[Theta]minExpAll", ",", 
      "\[Theta]maxExpAll", ",", "\[Theta]minExp", ",", "\[Theta]maxExp", ",", 
      "zminExp", ",", "zmaxExp"}], "}"}]}], "}"}], "//", 
  "TableForm"}]}], "Input",
 CellChangeTimes->{{3.892273555027376*^9, 3.8922735858455534`*^9}, 
   3.8922736264418793`*^9, 3.89334818729985*^9, {3.8946372359045815`*^9, 
   3.8946372361851187`*^9}, {3.8950530462678795`*^9, 3.895053046621991*^9}, {
   3.895053166341967*^9, 3.895053168018862*^9}, {3.8991984349124603`*^9, 
   3.8991984456906548`*^9}, {3.899214782238123*^9, 3.899214783052837*^9}, {
   3.902762733791559*^9, 3.9027627359917836`*^9}, {3.9027627744784746`*^9, 
   3.902762775030295*^9}, {3.9048896011309633`*^9, 3.9048896029641848`*^9}, 
   3.9049016991836987`*^9, {3.91465631538771*^9, 3.914656326321105*^9}, {
   3.914656367595533*^9, 3.914656370281052*^9}, {3.9156430042963567`*^9, 
   3.9156430044110193`*^9}, {3.916646836445645*^9, 3.9166468410810757`*^9}, {
   3.916829845870922*^9, 3.916829848894029*^9}, {3.9506888711483097`*^9, 
   3.950688887478544*^9}, {3.9506890254788685`*^9, 3.950689135366873*^9}, {
   3.9506891963188*^9, 3.9506892570330467`*^9}, {3.9512158343992653`*^9, 
   3.951215834526493*^9}},
 CellTags->{
  "Acceptance-computation", "Number-of-events-computation+sensitivity"},
 CellLabel->
  "In[335]:=",ExpressionUUID->"5f950072-065f-4973-a235-bace6753e9f0"],

Cell[CellGroupData[{

Cell["\<\
Checking if all distributions have corresponding weights, and vice versa\
\>", "Section",
 CellChangeTimes->{{3.9506325765805607`*^9, 3.9506325768620872`*^9}, {
  3.9506334272032604`*^9, 3.950633428585764*^9}, {3.950633747287016*^9, 
  3.950633760072397*^9}},
 CellTags->{
  "Acceptance-computation", 
   "Number-of-events-computation+sensitivity"},ExpressionUUID->"f7fba8d2-a245-\
8e4e-aba8-b5877eacbaf4"],

Cell[CellGroupData[{

Cell["\<\
List of angle-energy distributions and production weights for the given \
facility\
\>", "Subsection",
 CellChangeTimes->{{3.950633460120825*^9, 3.950633477192444*^9}},
 CellTags->{
  "Acceptance-computation", 
   "Number-of-events-computation+sensitivity"},ExpressionUUID->"851c16e6-94ac-\
3648-a05d-c81e2872b0c5"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"DistrCombinationsSelectedFacility", "=", 
   RowBox[{"Select", "[", 
    RowBox[{"DistrCombinations", ",", 
     RowBox[{
      RowBox[{
       RowBox[{"#", "[", 
        RowBox[{"[", "3", "]"}], "]"}], "==", "FacilityGivenExperiment"}], 
      "&"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"WeightsCombinationsSelectedFacility", "=", 
   RowBox[{"Select", "[", 
    RowBox[{"WeightsCombinations", ",", 
     RowBox[{
      RowBox[{
       RowBox[{"#", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "==", "FacilityGivenExperiment"}], 
      "&"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"MemberQ", "[", 
      RowBox[{
       RowBox[{"DistrCombinationsSelectedFacility", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "2"}], "]"}], "]"}], 
       ",", "\"\<Bremsstrahlung-FR\>\""}], "]"}], "||", 
     RowBox[{"MemberQ", "[", 
      RowBox[{
       RowBox[{"DistrCombinationsSelectedFacility", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "2"}], "]"}], "]"}], 
       ",", "\"\<Bremsstrahlung-AP\>\""}], "]"}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"FacilitiesFR", "=", 
      RowBox[{
       RowBox[{"Select", "[", 
        RowBox[{"DistrCombinationsSelectedFacility", ",", 
         RowBox[{
          RowBox[{"StringContainsQ", "[", 
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "2", "]"}], "]"}], ",", 
            RowBox[{"{", "\"\<FR\>\"", "}"}]}], "]"}], "&"}]}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "3"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"FacilitiesAP", "=", 
      RowBox[{
       RowBox[{"Select", "[", 
        RowBox[{"DistrCombinationsSelectedFacility", ",", 
         RowBox[{
          RowBox[{"StringContainsQ", "[", 
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "2", "]"}], "]"}], ",", 
            RowBox[{"{", "\"\<AP\>\"", "}"}]}], "]"}], "&"}]}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "3"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"DistrCombinationsToCheck", "=", 
      RowBox[{"Select", "[", 
       RowBox[{"DistrCombinationsSelectedFacility", ",", 
        RowBox[{
         RowBox[{"!", 
          RowBox[{"StringContainsQ", "[", 
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "2", "]"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"\"\<FR\>\"", ",", "\"\<AP\>\""}], "}"}]}], "]"}]}], 
         "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"DistrCombinationsToCheck", "=", 
      RowBox[{
       RowBox[{"Join", "[", 
        RowBox[{"DistrCombinationsToCheck", ",", 
         RowBox[{"Flatten", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"LLPdirName", ",", "brem", ",", "fac"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"fac", ",", "FacilitiesFR"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"brem", ",", 
               RowBox[{
                RowBox[{"Select", "[", 
                 RowBox[{"WeightsCombinations", ",", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "==", "fac"}], "&&", 
                    RowBox[{"StringContainsQ", "[", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", "\"\<FR\>\""}], 
                    "]"}]}], "&"}]}], "]"}], "[", 
                RowBox[{"[", 
                 RowBox[{"All", ",", "1"}], "]"}], "]"}]}], "}"}]}], "]"}], ",",
            "1"}], "]"}], ",", 
         RowBox[{"Flatten", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"LLPdirName", ",", "brem", ",", "fac"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"fac", ",", "FacilitiesAP"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"brem", ",", 
               RowBox[{
                RowBox[{"Select", "[", 
                 RowBox[{"WeightsCombinations", ",", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "==", "fac"}], "&&", 
                    RowBox[{"StringContainsQ", "[", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", "\"\<AP\>\""}], 
                    "]"}]}], "&"}]}], "]"}], "[", 
                RowBox[{"[", 
                 RowBox[{"All", ",", "1"}], "]"}], "]"}]}], "}"}]}], "]"}], ",",
            "1"}], "]"}]}], "]"}], "//", "Sort"}]}], ";"}], 
    "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
    RowBox[{
    "DistrCombinationsToCheck", "=", "DistrCombinationsSelectedFacility"}]}], 
   "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"drellyankeys", "=", 
   RowBox[{"Select", "[", 
    RowBox[{"WeightsCombinationsSelectedFacility", ",", 
     RowBox[{
      RowBox[{"StringContainsQ", "[", 
       RowBox[{
        RowBox[{"#", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", "\"\<DrellYan\>\""}], "]"}], 
      "&"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DistrCombinationsToCheck", "=", 
   RowBox[{"Select", "[", 
    RowBox[{"DistrCombinationsToCheck", ",", 
     RowBox[{
      RowBox[{"!", 
       RowBox[{"StringContainsQ", "[", 
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "2", "]"}], "]"}], ",", "\"\<DrellYan\>\""}], "]"}]}], 
      "&"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DistrCombinationsToCheck", "=", 
   RowBox[{"Join", "[", 
    RowBox[{"DistrCombinationsToCheck", ",", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"LLPdirName", ",", 
         RowBox[{
          RowBox[{"drellyankeys", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", 
         RowBox[{
          RowBox[{"drellyankeys", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "drellyankeys", "]"}], ",", "1"}], "}"}]}], 
      "]"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.950632759830923*^9, 3.950632760199877*^9}, {
  3.950632840248455*^9, 3.950632878926874*^9}, {3.9506329342094135`*^9, 
  3.9506330750435047`*^9}, {3.9506332640043545`*^9, 3.9506332684904785`*^9}, {
  3.95063336592737*^9, 3.950633366140545*^9}, {3.950633423556576*^9, 
  3.950633424039562*^9}, {3.950633489564089*^9, 3.9506334899840126`*^9}, {
  3.9506777639793167`*^9, 3.95067777211491*^9}, {3.950689300706131*^9, 
  3.9506893804474583`*^9}},
 CellTags->{
  "Acceptance-computation", "Number-of-events-computation+sensitivity"},
 CellLabel->
  "In[349]:=",ExpressionUUID->"4aa1045c-2dac-174f-8c6e-b96856e5f13e"],

Cell[CellGroupData[{

Cell["Selecting the target in collisions", "Subsubsection",
 CellChangeTimes->{{3.9506893873654823`*^9, 
  3.950689393076992*^9}},ExpressionUUID->"cd7e9a74-7662-2449-b7b0-\
a0c1656eb119"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Now", ",", " ", 
    RowBox[{
    "leaving", " ", "only", " ", "those", " ", "modes", " ", "for", " ", 
     "which", " ", "the", " ", "target", " ", 
     RowBox[{"(", 
      RowBox[{"nucleus", " ", "or", " ", "proton"}], ")"}], " ", "matches", " ",
      "the", " ", "target", " ", "at", " ", "the", " ", "given", " ", 
     "experiment"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"TargetsA", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\"\<Mo\>\"", ",", "96."}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\"\<C\>\"", ",", "12."}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\"\<Fe\>\"", ",", "56."}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\"\<p\>\"", ",", "1."}], "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"AtargetVal", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"Select", "[", 
        RowBox[{"CrossSectionData", ",", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", "\"\<Atarget\>\""}], 
          "&"}]}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}], "[", 
      RowBox[{"[", "2", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"TargetPrimakov", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"Select", "[", 
        RowBox[{"TargetsA", ",", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "==", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"StringContainsQ", "[", 
              RowBox[{"SelectedExperiment", ",", "\"\<FASER\>\""}], "]"}], ",",
              "56", ",", "AtargetVal"}], "]"}]}], "&"}]}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Target", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"Select", "[", 
        RowBox[{"TargetsA", ",", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "==", "AtargetVal"}], "&"}]}], 
        "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"DistrCombinationsSelectedFacility", "=", 
     RowBox[{"Select", "[", 
      RowBox[{"DistrCombinationsSelectedFacility", ",", 
       RowBox[{
        RowBox[{
         RowBox[{"!", 
          RowBox[{"StringContainsQ", "[", 
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "2", "]"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"\"\<fusion\>\"", ",", "\"\<Primakov\>\""}], "}"}]}], 
           "]"}]}], "||", 
         RowBox[{"StringContainsQ", "[", 
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "2", "]"}], "]"}], ",", "Target"}], "]"}]}], "&"}]}],
       "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"DistrCombinationsToCheck", "=", 
     RowBox[{"Select", "[", 
      RowBox[{"DistrCombinationsToCheck", ",", 
       RowBox[{
        RowBox[{
         RowBox[{"!", 
          RowBox[{"StringContainsQ", "[", 
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "2", "]"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"\"\<fusion\>\"", ",", "\"\<Primakov\>\""}], "}"}]}], 
           "]"}]}], "||", 
         RowBox[{"StringContainsQ", "[", 
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "2", "]"}], "]"}], ",", "Target"}], "]"}]}], "&"}]}],
       "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"WeightsCombinationsSelectedFacility", "=", 
     RowBox[{"Select", "[", 
      RowBox[{"WeightsCombinationsSelectedFacility", ",", 
       RowBox[{
        RowBox[{
         RowBox[{"!", 
          RowBox[{"StringContainsQ", "[", 
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"\"\<fusion\>\"", ",", "\"\<Primakov\>\""}], "}"}]}], 
           "]"}]}], "||", 
         RowBox[{"StringContainsQ", "[", 
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", "Target"}], "]"}]}], "&"}]}],
       "]"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.9506894098531094`*^9, 3.9506894672678185`*^9}, {
  3.9506895003213863`*^9, 3.9506895640713806`*^9}},
 CellLabel->
  "In[355]:=",ExpressionUUID->"f49d69af-62a9-5e45-bec1-056a9ad186a4"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Checking if all weights have their corresponding distributions\
\>", "Subsection",
 CellChangeTimes->{{3.950633494221611*^9, 3.9506335163250427`*^9}},
 CellTags->{
  "Acceptance-computation", 
   "Number-of-events-computation+sensitivity"},ExpressionUUID->"d7390003-b4ea-\
ff44-ab0d-985ede19c2cd"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"IfCondDistrToWeights", "=", "True"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"IfCondDistrToWeights", "=", 
     RowBox[{
      RowBox[{"Select", "[", 
       RowBox[{"WeightsCombinationsSelectedFacility", ",", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "==", 
           RowBox[{
            RowBox[{"DistrCombinationsToCheck", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "&&", 
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "==", 
           RowBox[{
            RowBox[{"DistrCombinationsToCheck", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "[", 
            RowBox[{"[", "3", "]"}], "]"}]}]}], "&"}]}], "]"}], "!=", 
      RowBox[{"{", "}"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"IfCondDistrToWeights", "==", "False"}], ",", 
      RowBox[{"Break", "[", "]"}]}], "]"}], ";"}], "\[IndentingNewLine]", ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "1", ",", 
     RowBox[{"Length", "[", "DistrCombinationsToCheck", "]"}], ",", "1"}], 
    "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"IfCondDistrToWeights", ";"}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"!", "IfCondDistrToWeights"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
    "infoDialog", 
     "[", "\"\<You have not provided the production probabilities \
PmotherToLLP to all the generated tabulated distributions! Please do this \
first to avoid problems\>\"", "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"condcontinue", "=", "False"}], ";"}], "\[IndentingNewLine]", ",",
    "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"condcontinue", "=", "True"}], ";"}]}], "\[IndentingNewLine]", 
  "]"}], "\[IndentingNewLine]", "condcontinue", "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"condcontinue", "&&", 
    RowBox[{"StringContainsQ", "[", 
     RowBox[{"computationchoice", ",", "\"\<Tabulated Nevents\>\""}], "]"}]}],
    ",", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Delete", " ", "previously", " ", "computed", " ", "tabulated", " ", 
     "number", " ", "of", " ", "events"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"directory", "[", "\"\<Nevents\>\"", "]"}], "=", 
     RowBox[{"FileNameJoin", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"NotebookDirectory", "[", "]"}], 
        ",", "\"\<Tabulated Nevents\>\""}], "}"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"directory", "[", "\"\<Nevents-LLP\>\"", "]"}], "=", 
     RowBox[{"FileNameJoin", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"NotebookDirectory", "[", "]"}], 
        ",", "\"\<Tabulated Nevents\>\"", ",", "LLPdirName"}], "}"}], "]"}]}],
     ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"directory", "[", "\"\<Nevents-LLP-experiment\>\"", "]"}], "=", 
     RowBox[{"FileNameJoin", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"NotebookDirectory", "[", "]"}], 
        ",", "\"\<Tabulated Nevents\>\"", ",", "LLPdirName", ",", 
        "SelectedExperiment"}], "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"DirectoryQ", "[", 
       RowBox[{"directory", "[", "\"\<Nevents-LLP-experiment\>\"", "]"}], 
       "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"DeleteFile", "[", 
       RowBox[{"FileNames", "[", 
        RowBox[{
         RowBox[{"\"\<*\>\"", "<>", "SelectedDescr", "<>", "\"\<*\>\""}], ",", 
         RowBox[{"directory", "[", "\"\<Nevents-LLP-experiment\>\"", "]"}]}], 
        "]"}], "]"}]}], "\[IndentingNewLine]", "]"}]}]}], 
  "\[IndentingNewLine]", "]"}]}], "Input",
 CellChangeTimes->{{3.9506331104738274`*^9, 3.950633114577772*^9}, {
   3.95063351901915*^9, 3.9506335426713886`*^9}, {3.9506335729961224`*^9, 
   3.950633733919876*^9}, {3.950634498508953*^9, 3.9506346358571796`*^9}, {
   3.9506346685005493`*^9, 3.9506346804616184`*^9}, {3.9506347360546227`*^9, 
   3.9506347465200996`*^9}, {3.9506347956276207`*^9, 3.950634808025696*^9}, {
   3.950670799326351*^9, 3.9506708156981773`*^9}, {3.9506709225996647`*^9, 
   3.9506709491094894`*^9}, 3.95089908500552*^9},
 CellTags->{
  "Acceptance-computation", "Number-of-events-computation+sensitivity"},
 CellLabel->
  "In[362]:=",ExpressionUUID->"b443d5cc-7dba-be40-9faf-007a7d55e11e"]
}, Closed]]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Angle-energy distributions for the given experiment", "Chapter",
 CellChangeTimes->{{3.885020702966837*^9, 3.885020711525731*^9}, {
  3.8850216924759345`*^9, 3.8850216984444695`*^9}, {3.8851404110391607`*^9, 
  3.8851404117847*^9}, {3.8876176661660123`*^9, 3.887617675014727*^9}, {
  3.8963348182882037`*^9, 3.896334822097164*^9}},
 CellTags->{
  "Acceptance-computation", 
   "Number-of-events-computation+sensitivity"},ExpressionUUID->"775c9f90-cfc2-\
4104-a914-805ee6203cb5"],

Cell[CellGroupData[{

Cell["Fractions of mother particles/processes per collision", "Section",
 CellChangeTimes->{{3.9506891466763935`*^9, 
  3.9506891648331776`*^9}},ExpressionUUID->"76394e74-850b-ae49-ad13-\
c00990d4dec8"],

Cell[BoxData[{
 RowBox[{"Do", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"ProbMother", "[", "mes", "]"}], "=", 
    RowBox[{
     RowBox[{
      RowBox[{"Select", "[", 
       RowBox[{"CrossSectionData", ",", 
        RowBox[{
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", 
          RowBox[{"\"\<P\>\"", "<>", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"mes", "!=", "\"\<JPsi\>\""}], ",", "mes", 
             ",", "\"\<Jpsi\>\""}], "]"}]}]}], "&"}]}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}], "[", 
     RowBox[{"[", "2", "]"}], "]"}]}], "\[IndentingNewLine]", ",", 
   RowBox[{"{", 
    RowBox[{"mes", ",", 
     RowBox[{"{", 
      RowBox[{"\"\<Pi0\>\"", ",", "\"\<Eta\>\"", ",", "\"\<EtaPr\>\"", 
       ",", "\"\<Omega\>\"", ",", "\"\<Rho0\>\"", ",", "\"\<Phi\>\"", 
       ",", "\"\<JPsi\>\"", ",", "\"\<Upsilon\>\""}], "}"}]}], "}"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"ProbMother", "[", "proc", "]"}], "=", "1"}], ";"}], 
   "\[IndentingNewLine]", ",", 
   RowBox[{"{", 
    RowBox[{"proc", ",", 
     RowBox[{"Select", "[", 
      RowBox[{
       RowBox[{"DistrCombinationsToCheck", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "2"}], "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{"StringContainsQ", "[", 
         RowBox[{"#", ",", 
          RowBox[{"{", "\"\<fusion\>\"", "}"}]}], "]"}], "&"}]}], "]"}]}], 
    "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"ProbMother", "[", "proc", "]"}], "=", 
     RowBox[{
      RowBox[{"2", "*", 
       RowBox[{"ProbMother", "[", "\"\<Pi0\>\"", "]"}]}], "+", 
      RowBox[{"0.71", "*", 
       RowBox[{"ProbMother", "[", "\"\<Eta\>\"", "]"}]}]}]}], ";"}], 
   "\[IndentingNewLine]", ",", 
   RowBox[{"{", 
    RowBox[{"proc", ",", 
     RowBox[{"Select", "[", 
      RowBox[{
       RowBox[{"DistrCombinationsToCheck", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "2"}], "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{"StringContainsQ", "[", 
         RowBox[{"#", ",", 
          RowBox[{"{", "\"\<Primakov\>\"", "}"}]}], "]"}], "&"}]}], "]"}]}], 
    "}"}]}], "]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.950689403777508*^9, 3.9506894055694466`*^9}, {
  3.9506896020104713`*^9, 3.950689655704521*^9}, {3.9506897116219673`*^9, 
  3.9506897304541607`*^9}, {3.951468182062828*^9, 3.951468260175316*^9}, {
  3.951468368751644*^9, 3.9514683801928043`*^9}},
 CellLabel->
  "In[368]:=",ExpressionUUID->"9ce80e05-97b8-ec43-a9cf-e5ee0a0e6195"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.952012098170328*^9, 3.9520121023765926`*^9}},
 CellLabel->
  "In[371]:=",ExpressionUUID->"2fcdccbb-a624-754c-be2e-b832e3080def"]
}, Closed]],

Cell[CellGroupData[{

Cell["Importing and processing tabulated distributions", "Section",
 CellChangeTimes->{{3.9506895895345078`*^9, 
  3.9506895961571865`*^9}},ExpressionUUID->"987dbef9-3887-6f40-9278-\
2d276260ecb5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{"condcontinue", ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Print", "[", "\"\<Production list:\>\"", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
     "ProductionPatternSelectedTemp", "=", 
      "DistrCombinationsSelectedFacility"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"FacilityGivenExperiment", "==", "\"\<LHC\>\""}], "&&", 
        RowBox[{"!", 
         RowBox[{"StringContainsQ", "[", 
          RowBox[{"SelectedExperiment", ",", "\"\<FASER\>\""}], "]"}]}]}], ",",
        "\[IndentingNewLine]", 
       RowBox[{"ProductionPatternSelected", "=", 
        RowBox[{"Select", "[", 
         RowBox[{"ProductionPatternSelected", ",", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"StringContainsQ", "[", 
             RowBox[{
              RowBox[{"#", "[", 
               RowBox[{"[", "2", "]"}], "]"}], ",", "\"\<Primakov\>\""}], 
             "]"}]}], "&"}]}], "]"}]}], "\[IndentingNewLine]", ",", 
       "\[IndentingNewLine]", 
       RowBox[{
       "ProductionPatternSelected", "=", "ProductionPatternSelectedTemp"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"ProductionList", "=", 
      RowBox[{"ProductionPatternSelected", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "2"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"Row", "[", 
       RowBox[{"{", "ProductionList", "}"}], "]"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", "prod", "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"prod", "=", 
           RowBox[{
            RowBox[{"ProductionPatternSelected", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
           "Importing", " ", "the", " ", "data", " ", "with", " ", 
            "distribution"}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{"dirimp", "=", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"prod", "==", "\"\<DrellYan\>\""}], ",", 
             RowBox[{"FileNameJoin", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"directory", "[", "\"\<Distribution\>\"", "]"}], 
                ",", "\"\<Pregenerated\>\""}], "}"}], "]"}], ",", 
             RowBox[{"directory", "[", "\"\<Distribution\>\"", "]"}]}], 
            "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"DistrDataImport", "[", "prod", "]"}], "=", 
           RowBox[{"Import", "[", 
            RowBox[{
             RowBox[{"FileNameJoin", "[", 
              RowBox[{"{", 
               RowBox[{"dirimp", ",", 
                
                RowBox[{"\"\<DoubleDistr_\>\"", "<>", "LLPdirName", 
                 "<>", "\"\<_\>\"", "<>", "prod", "<>", "\"\<_\>\"", "<>", 
                 "FacilityGivenExperiment", "<>", "\"\<.m\>\""}]}], "}"}], 
              "]"}], ",", "\"\<MX\>\""}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"prod", "==", "\"\<DrellYan\>\""}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"DistrDataImport", "[", "prod", "]"}], "=", 
              RowBox[{"Select", "[", 
               RowBox[{
                RowBox[{"DistrDataImport", "[", "prod", "]"}], ",", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{
                   "MinMaxMassesDrellYan", "[", "FacilityGivenExperiment", 
                    "]"}], "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "<=", 
                  RowBox[{"#", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "<=", 
                  RowBox[{
                   RowBox[{
                   "MinMaxMassesDrellYan", "[", "FacilityGivenExperiment", 
                    "]"}], "[", 
                   RowBox[{"[", "2", "]"}], "]"}]}], "&"}]}], "]"}]}], 
             ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"Min", "/", "mass"}], " ", "mass", " ", "of", " ", "the", 
            " ", "LLP", " ", "from", " ", "the", " ", "data"}], "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"mlistDistr", "[", "prod", "]"}], "=", 
           RowBox[{"DeleteDuplicates", "[", 
            RowBox[{
             RowBox[{"DistrDataImport", "[", "prod", "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"mLLPmin", "[", "prod", "]"}], ",", 
             RowBox[{"mLLPmax", "[", "prod", "]"}]}], "}"}], "=", 
           RowBox[{"MinMax", "[", 
            RowBox[{"mlistDistr", "[", "prod", "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
           "Interpolation", " ", "of", " ", "the", " ", "tabulated", " ", 
            "distribution"}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"DoubleDistrLLPint", "[", 
            RowBox[{"mLLP_", ",", "\[Theta]LLP_", ",", "ELLP_", ",", "prod"}],
             "]"}], "=", 
           RowBox[{"10", "^", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Interpolation", "[", 
               RowBox[{
                RowBox[{"distrlogComp", "[", 
                 RowBox[{"DistrDataImport", "[", "prod", "]"}], "]"}], ",", 
                RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[", 
              RowBox[{
               RowBox[{"Log10", "[", "mLLP", "]"}], ",", 
               RowBox[{"Log10", "[", "\[Theta]LLP", "]"}], ",", 
               RowBox[{"Log10", "[", "ELLP", "]"}]}], "]"}], ")"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{"Probability", " ", "to", " ", "produce", " ", "LLP"}], 
           "*)"}], "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ProbLLP", "[", 
            RowBox[{"mLLP_", ",", "\[Mu]_", ",", "prod"}], "]"}], "=", 
           RowBox[{
            RowBox[{
             RowBox[{"ProbMother", "[", "prod", "]"}], "*", 
             RowBox[{"PmotherToLLP", "[", 
              RowBox[{
              "mLLP", ",", "\[Mu]", ",", "prod", ",", 
               "FacilityGivenExperiment"}], "]"}]}], "/.", 
            RowBox[{"{", 
             RowBox[{"Atarget", "->", "AtargetVal"}], "}"}]}]}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "ProductionPatternSelected", "]"}], ",", 
         "1"}], "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"directory", "[", "\"\<Auxiliary-experiment\>\"", "]"}], "=", 
      RowBox[{"FileNameJoin", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"directory", "[", "\"\<Auxiliary\>\"", "]"}], ",", 
         "SelectedExperiment"}], "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"DirectoryQ", "[", 
         RowBox[{"directory", "[", "\"\<Auxiliary-experiment\>\"", "]"}], 
         "]"}]}], ",", 
       RowBox[{"CreateDirectory", "[", 
        RowBox[{"directory", "[", "\"\<Auxiliary-experiment\>\"", "]"}], 
        "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Export", "[", 
      RowBox[{
       RowBox[{"FileNameJoin", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"directory", "[", "\"\<Auxiliary-experiment\>\"", "]"}], ",", 
          
          RowBox[{"\"\<Double-Distr-Averaged-\>\"", "<>", "LLPdirName", 
           "<>", "\"\<.m\>\""}]}], "}"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"mLLPmin", "[", "prod", "]"}], "<", "mLLP", "<", 
              RowBox[{"mLLPmax", "[", "prod", "]"}]}], ",", 
             RowBox[{"Evaluate", "[", 
              RowBox[{"ProbLLP", "[", 
               RowBox[{"mLLP", ",", "1", ",", "prod"}], "]"}], "]"}], ",", 
             "0"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"prod", ",", "ProductionList"}], "}"}]}], "]"}], ",", 
         RowBox[{
          FractionBox["1", 
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"mLLPmin", "[", "prod", "]"}], "<", "mLLP", "<", 
                RowBox[{"mLLPmax", "[", "prod", "]"}]}], ",", 
               RowBox[{"Evaluate", "[", 
                RowBox[{"ProbLLP", "[", 
                 RowBox[{"mLLP", ",", "1", ",", "prod"}], "]"}], "]"}], ",", 
               "0"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"prod", ",", "ProductionList"}], "}"}]}], "]"}]], 
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"mLLPmin", "[", "prod", "]"}], "<", "mLLP", "<", 
               RowBox[{"mLLPmax", "[", "prod", "]"}]}], ",", 
              RowBox[{"Evaluate", "[", 
               RowBox[{
                RowBox[{"ProbLLP", "[", 
                 RowBox[{"mLLP", ",", "1", ",", "prod"}], "]"}], "*", 
                RowBox[{"DoubleDistrLLPint", "[", 
                 RowBox[{
                 "mLLP", ",", "\[Theta]LLP", ",", "ELLP", ",", "prod"}], 
                 "]"}]}], "]"}], ",", "0"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"prod", ",", "ProductionList"}], "}"}]}], "]"}]}]}], 
        "}"}], ",", "\"\<MX\>\""}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"GridInFinal", "[", "prod", "]"}], ",", 
          RowBox[{"DistrVals", "[", "prod", "]"}]}], "}"}], "=", 
        RowBox[{"BlockGridsValsDistr", "[", 
         RowBox[{"prod", ",", "DistrDataImport"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"prod", ",", "ProductionList"}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "___", "___", "___", "___", "___", "___", "___", "___", "___", "_"}], 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"Finding", " ", 
       SubscriptBox["E", "max"], 
       RowBox[{"(", 
        RowBox[{
         SubscriptBox["m", "LLP"], ",", 
         SubscriptBox["\[Theta]", "LLP"]}], ")"}], " ", "for", " ", "the", " ",
        "angular", " ", "range", " ", "at", " ", "the", " ", "given", " ", 
       "experiment"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "___", "___", "___", "___", "___", "___", "___", "___", "___", "_"}], 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"ELLPmax", "[", 
          RowBox[{"mfip_", ",", "\[Theta]fip_", ",", "prod"}], "]"}], "=", 
         RowBox[{"EmaxBlock", "[", 
          RowBox[{
          "prod", ",", "8", ",", "DistrDataImport", ",", 
           "FacilityGivenExperiment"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"prod", ",", "ProductionList"}], "}"}]}], "]"}], "//", 
      "AbsoluteTiming"}]}]}], "\[IndentingNewLine]", "]"}], 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.9138264426995506`*^9, 3.9138265779867573`*^9}, {
   3.913826965658716*^9, 3.9138270942523136`*^9}, 3.913827173058236*^9, 
   3.9138280725351963`*^9, {3.9138685969328623`*^9, 3.9138686662515535`*^9}, {
   3.9138687097216063`*^9, 3.913868827467691*^9}, {3.9138699081836786`*^9, 
   3.913869908527342*^9}, {3.9138700197640233`*^9, 3.913870024259905*^9}, {
   3.913870742059718*^9, 3.913870786176013*^9}, {3.9138730962078924`*^9, 
   3.913873134995863*^9}, {3.9146564182112637`*^9, 3.914656426422456*^9}, {
   3.9146565926898994`*^9, 3.914656646329817*^9}, {3.914656788632721*^9, 
   3.914656846172041*^9}, {3.914656899191541*^9, 3.914656906123517*^9}, {
   3.9146569870541067`*^9, 3.914657099502392*^9}, {3.9156430044255066`*^9, 
   3.9156430045301285`*^9}, {3.9166516890603843`*^9, 3.916651723255498*^9}, 
   3.916651809721322*^9, {3.916651840777441*^9, 3.9166519036634083`*^9}, {
   3.916652005633021*^9, 3.9166520351454964`*^9}, {3.916828797903153*^9, 
   3.916828852389561*^9}, {3.9168301287142587`*^9, 3.9168301331711607`*^9}, {
   3.9356005109206676`*^9, 3.9356005113130913`*^9}, 3.9356005948072033`*^9, {
   3.950689670890358*^9, 3.950689692678648*^9}, {3.9506897422919884`*^9, 
   3.9506897680054073`*^9}, 3.9506898065691433`*^9, {3.95068993572711*^9, 
   3.9506899760834312`*^9}},
 CellTags->{
  "Acceptance-computation", "Number-of-events-computation+sensitivity"},
 CellLabel->
  "In[372]:=",ExpressionUUID->"ee40f17f-b4bb-43d0-a30f-9da27f9361c2"]
}, Closed]],

Cell[CellGroupData[{

Cell["Plots", "Section",
 CellChangeTimes->{{3.9341806241273217`*^9, 3.9341806246845126`*^9}},
 CellTags->{
  "Number-of-events-computation+sensitivity", 
   "Acceptance-computation"},ExpressionUUID->"0c4f3b67-80f3-f24c-b5d7-\
9b07982e3769"],

Cell[BoxData[
 RowBox[{"If", "[", 
  RowBox[{"condcontinue", ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ptenergies", "=", 
     RowBox[{"LogLogPlot", "[", 
      RowBox[{
       RowBox[{"Evaluate", "[", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"ELLPmax", "[", 
           RowBox[{"0.1", ",", "\[Theta]LLP", ",", "prod"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"prod", ",", "ProductionList"}], "}"}]}], "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Theta]LLP", ",", "\[Theta]minExp", ",", "\[Theta]maxExp"}],
         "}"}], ",", 
       RowBox[{"Frame", "->", "True"}], ",", 
       RowBox[{"ImageSize", "->", "Large"}], ",", 
       RowBox[{"PlotLegends", "\[Rule]", 
        RowBox[{"Placed", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Style", "[", 
             RowBox[{"#", ",", "15"}], "]"}], "&"}], "/@", "ProductionList"}],
           ",", "Right"}], "]"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"ptprodprob", "=", 
     RowBox[{"LogLogPlot", "[", 
      RowBox[{
       RowBox[{"Evaluate", "[", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"ProbLLP", "[", 
           RowBox[{"ma", ",", "1.", ",", "prod"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"prod", ",", "ProductionList"}], "}"}]}], "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"ma", ",", "mmin\[Epsilon]", ",", "mmax\[Epsilon]"}], "}"}], ",", 
       RowBox[{"Frame", "->", "True"}], ",", 
       RowBox[{"ImageSize", "->", "Large"}], ",", 
       RowBox[{"PlotLegends", "\[Rule]", 
        RowBox[{"Placed", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Style", "[", 
             RowBox[{"#", ",", "16"}], "]"}], "&"}], "/@", 
           RowBox[{"(", "ProductionList", ")"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"0.2", ",", "0.24"}], "}"}]}], "]"}]}], ",", " ", 
       RowBox[{"FrameStyle", "\[Rule]", 
        RowBox[{"Directive", "[", 
         RowBox[{"Black", ",", " ", "25", ",", "Thick"}], "]"}]}], ",", 
       RowBox[{"PlotRange", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0.02", ",", "5"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            SuperscriptBox["10", 
             RowBox[{"-", "15"}]], ",", 
            SuperscriptBox["10", 
             RowBox[{"-", "2."}]]}], "}"}]}], "}"}]}], ",", 
       RowBox[{"PlotStyle", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"Thick", ",", "Blue"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"Thick", ",", 
            RowBox[{"Lighter", "@", "Red"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"Thick", ",", 
            RowBox[{"Lighter", "@", "Red"}], ",", 
            RowBox[{"Dashing", "[", "0.02", "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"Thick", ",", 
            RowBox[{"Darker", "@", "Red"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"Thick", ",", 
            RowBox[{"Darker", "@", 
             RowBox[{"Darker", "@", "Green"}]}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"Thick", ",", 
            RowBox[{"Darker", "@", "Cyan"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"Thick", ",", "Magenta"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"Thick", ",", "Brown"}], "}"}]}], "}"}]}], ",", 
       RowBox[{"AspectRatio", "\[Rule]", "0.66"}], ",", 
       RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
       RowBox[{"FrameLabel", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"\"\<\!\(\*SubscriptBox[\(m\), \(a\)]\) [GeV]\>\"", 
          ",", "\"\<\!\(\*SubscriptBox[\(P\), \(prod\)]\) [\[Mu] = 1 \
\!\(\*SuperscriptBox[\(GeV\), \(-1\)]\)]\>\""}], "}"}]}], ",", 
       RowBox[{"PlotLabel", "\[Rule]", 
        RowBox[{"Style", "[", 
         RowBox[{
          RowBox[{"Row", "[", 
           RowBox[{"{", 
            
            RowBox[{"\"\<Production probabilities of \>\"", ",", "LLPdirName",
              ",", "\"\< at \>\"", ",", "FacilityGivenExperiment"}], "}"}], 
           "]"}], ",", "18", ",", "Black"}], "]"}]}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"Style", "[", 
     RowBox[{
      RowBox[{"Row", "[", 
       RowBox[{"{", 
        RowBox[{"ptprodprob", ",", "ptenergies"}], "}"}], "]"}], ",", 
      RowBox[{"ImageSizeMultipliers", "->", 
       RowBox[{"{", 
        RowBox[{"1", ",", " ", "1"}], "}"}]}]}], "]"}]}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.934218518515441*^9, 3.934218537902442*^9}, 
   3.9342185941166706`*^9, {3.9342186376090508`*^9, 3.9342186376374598`*^9}, {
   3.93421938331448*^9, 3.9342193923497753`*^9}, {3.9345978169333267`*^9, 
   3.934597816943096*^9}, {3.9347398342293386`*^9, 3.9347398367196236`*^9}, {
   3.93525114124*^9, 3.935251187539447*^9}, {3.9352513550984387`*^9, 
   3.935251357686199*^9}, {3.935251397376196*^9, 3.935251423732613*^9}, {
   3.9352514706619773`*^9, 3.935251474443635*^9}, {3.935251755132921*^9, 
   3.93525175815399*^9}, 3.9354199571415243`*^9, {3.9418601326813984`*^9, 
   3.9418601529320927`*^9}, {3.9418602389029465`*^9, 
   3.9418602420429554`*^9}, {3.941860308578102*^9, 3.941860314009083*^9}, {
   3.941860387840704*^9, 3.9418604727256184`*^9}, {3.941860554710581*^9, 
   3.941860603790945*^9}, {3.9418607274520245`*^9, 3.9418607274917545`*^9}, {
   3.948390122316641*^9, 3.9483901670207767`*^9}, {3.9484280062190723`*^9, 
   3.9484280071973724`*^9}, {3.9499078912661476`*^9, 
   3.9499078943828163`*^9}, {3.949908002420271*^9, 3.94990803895372*^9}, 
   3.950588317759264*^9, {3.950605249224659*^9, 3.950605249851198*^9}, {
   3.9506782518759727`*^9, 3.9506782606955433`*^9}, {3.9506899076903*^9, 
   3.9506899193957005`*^9}, {3.951232232255142*^9, 3.9512322343330574`*^9}, {
   3.951471216128227*^9, 3.951471216838722*^9}},
 CellTags->{
  "Number-of-events-computation+sensitivity", "Acceptance-computation"},
 CellLabel->
  "In[373]:=",ExpressionUUID->"dc74bfea-24ff-b44b-9949-00eab5b0c7a0"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Defining number of events", "Chapter",
 CellChangeTimes->{{3.8935731783578434`*^9, 3.893573180246764*^9}, {
  3.9514684122703304`*^9, 3.9514684143722153`*^9}},
 CellTags->
  "Number-of-events-computation+sensitivity",ExpressionUUID->"18333902-760f-\
4a49-b2f7-a7db0718c1c0"],

Cell[CellGroupData[{

Cell["Number of events", "Section",
 CellChangeTimes->{{3.897198873663946*^9, 3.8971988750678434`*^9}, 
   3.9165065585390453`*^9, 3.9165070655729046`*^9, 3.951468407639324*^9},
 CellTags->{
  "Acceptance-computation", 
   "Number-of-events-computation+sensitivity"},ExpressionUUID->"ff7853ec-a854-\
4a03-9b03-a9ef2d7f8e39"],

Cell[CellGroupData[{

Cell["Initializing all routines", "Subsection",
 CellChangeTimes->{{3.897199076623907*^9, 3.8971990900052223`*^9}, {
   3.8972009084104066`*^9, 3.897200920680235*^9}, 3.916506561920749*^9, {
   3.9165071319109154`*^9, 3.916507136145134*^9}},
 CellTags->{
  "Acceptance-computation", 
   "Number-of-events-computation+sensitivity"},ExpressionUUID->"973a528b-dac2-\
4eb0-819c-3939e7032851"],

Cell[BoxData[
 RowBox[{"If", "[", 
  RowBox[{"condcontinue", ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"OutGrid\[Theta]final", "[", "prod", "]"}], ",", 
         RowBox[{"\[CapitalDelta]\[Theta]vals", "[", "prod", "]"}]}], "}"}], "=", 
       RowBox[{"OutGrid\[Theta]Temp", "[", 
        RowBox[{
        "InGrid\[Theta]\[Epsilon]", ",", "30", ",", "prod", ",", 
         "\[Theta]maxBrem"}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"prod", ",", "ProductionList"}], "}"}]}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"OutGridzfinal", ",", "\[CapitalDelta]zvals"}], "}"}], "=", 
     RowBox[{"OutGridszTemp", "[", 
      RowBox[{"InGridz\[Epsilon]", ",", "30", ",", "zminExp"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"Final", " ", "energy", " ", 
       RowBox[{"grid", ".", " ", "Mass"}]}], "-", " ", 
      RowBox[{"and", " ", "production", " ", "channel"}], "-", "dependent"}], 
     "*)"}], "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"FacilityGivenExperiment", "!=", "\"\<ESS\>\""}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"StepEtemp", "[", "Efip_", "]"}], "=", 
        RowBox[{"Piecewise", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0.2", ",", 
             RowBox[{"Efip", "\[LessEqual]", "2.5"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0.3", ",", 
             RowBox[{"2.5", "<", "Efip", "<", "35"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"2", ",", 
             RowBox[{"35", "\[LessEqual]", "Efip", "\[LessEqual]", "50"}]}], 
            "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"4", ",", 
             RowBox[{"50", "<", "Efip", "<", "160"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"5", ",", 
             RowBox[{"160", "\[LessEqual]", "Efip", "<=", "400"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"25", ",", 
             RowBox[{"400", "<", "Efip", "<", "600"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"50", ",", 
             RowBox[{"600", "<=", "Efip", "<", "2000"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"200", ",", 
             RowBox[{"2000", "\[LessEqual]", "Efip", "<", "4000"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"400", ",", 
             RowBox[{"4000", "\[LessEqual]", "Efip", "<", "7000"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"500", ",", 
             RowBox[{
             "7000", "\[LessEqual]", "Efip", "\[LessEqual]", "50000"}]}], 
            "}"}]}], "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"OutGridEnergy", "[", 
         RowBox[{"m_", ",", "ProdChannel_"}], "]"}], ":=", 
        RowBox[{"Block", "[", 
         RowBox[{
          RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"emin", "=", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"ProdChannel", "!=", "\"\<Bremsstrahlung\>\""}], ",", 
              RowBox[{"N", "[", "m", "]"}], ",", 
              RowBox[{"ELLPmin", "[", "\"\<Bremsstrahlung\>\"", "]"}]}], 
             "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"egridtemp", "=", 
            RowBox[{
             RowBox[{"With", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"start", "=", "emin"}], ",", 
                 RowBox[{"end", "=", 
                  RowBox[{"ELLPmax", "[", 
                   RowBox[{"m", ",", "\[Theta]minExp", ",", "ProdChannel"}], 
                   "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Log10", "[", 
                RowBox[{"NestWhileList", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"#", "+", 
                    RowBox[{"StepEtemp", "[", "#", "]"}]}], "&"}], ",", 
                  "start", ",", 
                  RowBox[{
                   RowBox[{"#", "\[LessEqual]", "end"}], "&"}], ",", "1", ",",
                   "\[Infinity]", ",", 
                  RowBox[{"-", "1"}]}], "]"}], "]"}]}], "]"}], "//", "N"}]}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Length", "[", "egridtemp", "]"}], "==", "1"}], ",", 
             RowBox[{"egridtemp", "=", 
              RowBox[{"Join", "[", 
               RowBox[{"egridtemp", ",", 
                RowBox[{"{", 
                 RowBox[{"Log10", "[", 
                  RowBox[{"2", "*", "emin"}], "]"}], "}"}]}], "]"}]}]}], 
            "]"}], ";", "\[IndentingNewLine]", "egridtemp"}]}], 
         "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"StepEtemp", "[", "Efip_", "]"}], "=", "0.001"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"OutGridEnergy", "[", 
         RowBox[{"m_", ",", "ProdChannel_"}], "]"}], ":=", 
        RowBox[{"Block", "[", 
         RowBox[{
          RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"tabt", "=", 
            RowBox[{"Table", "[", 
             RowBox[{"e", ",", 
              RowBox[{"{", 
               RowBox[{"e", ",", 
                RowBox[{"1.0001", "m"}], ",", 
                RowBox[{"ELLPmax", "[", 
                 RowBox[{"m", ",", "\[Theta]minExp", ",", "ProdChannel"}], 
                 "]"}], ",", "0.001"}], "}"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Length", "[", "tabt", "]"}], "==", "1"}], ",", 
             RowBox[{"tabt", "=", 
              RowBox[{
               RowBox[{
                RowBox[{"Join", "[", 
                 RowBox[{"tabt", ",", 
                  RowBox[{"{", 
                   RowBox[{"ELLPmax", "[", 
                    RowBox[{"m", ",", "\[Theta]minExp", ",", "ProdChannel"}], 
                    "]"}], "}"}]}], "]"}], "//", "Sort"}], "//", 
               "DeleteDuplicates"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Log10", "[", "tabt", "]"}], "//", "N"}]}]}], 
         "\[IndentingNewLine]", "]"}]}]}]}], "\[IndentingNewLine]", "]"}], ";",
     "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{
      "Block", " ", "that", " ", "computes", " ", "the", " ", "grid", " ", 
       SubscriptBox["\[Theta]", "S"]}], ",", 
      SubscriptBox["E", "S"], ",", 
      SubscriptBox["z", "S"], ",", " ", 
      RowBox[{
       SubscriptBox["\[Epsilon]", "Full"], "\[Times]", 
       SubscriptBox["f", 
        RowBox[{
         SubscriptBox["\[Theta]", "S"], ",", 
         SubscriptBox["E", "S"]}]]}]}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"TableIntegrandDiscret", "[", 
      RowBox[{"m_", ",", "ProdChannel_", ",", "\[Epsilon]DecOp_"}], "]"}], ":=", 
     RowBox[{"TableIntegrandDiscretTemp", "[", 
      RowBox[{
      "m", ",", "ProdChannel", ",", "\[Epsilon]DecOp", ",", "\[Epsilon]vals", 
       ",", "\[Epsilon]azvals", ",", 
       RowBox[{"OutGrid\[Theta]final", "[", "ProdChannel", "]"}], ",", 
       "OutGridzfinal", ",", "OutGridEnergy", ",", "InGridm\[Epsilon]", ",", 
       "InGrid\[Theta]\[Epsilon]", ",", "InGridE\[Epsilon]", ",", 
       "InGridz\[Epsilon]", ",", 
       RowBox[{"\[CapitalDelta]\[Theta]vals", "[", "ProdChannel", "]"}], ",", 
       "\[CapitalDelta]zvals", ",", "zminExp", ",", "GridInFinal", ",", 
       "DistrVals", ",", "FacilityGivenExperiment", ",", "ELLPmax", ",", 
       "\[Theta]minExp"}], "]"}]}]}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{
  3.914065400601883*^9, {3.9144955915086913`*^9, 3.914495605102999*^9}, {
   3.9144963994464297`*^9, 3.91449645003281*^9}, 3.9156429961809263`*^9, 
   3.9162514062581673`*^9, {3.916332203281742*^9, 3.9163322040420866`*^9}, {
   3.916332256159724*^9, 3.916332315776701*^9}, {3.916332682855117*^9, 
   3.9163326972784367`*^9}, {3.916332729581109*^9, 3.9163327827424307`*^9}, {
   3.916332995032469*^9, 3.9163330418518543`*^9}, {3.9163330893535175`*^9, 
   3.9163331201157775`*^9}, {3.9163883031455355`*^9, 
   3.9163883099402237`*^9}, {3.91639027241718*^9, 3.9163902725145645`*^9}, {
   3.916390440036625*^9, 3.9163904429286966`*^9}, {3.9163913725242844`*^9, 
   3.9163913900649643`*^9}, {3.9165060112532883`*^9, 
   3.9165060531405983`*^9}, {3.916506386454261*^9, 3.9165063916867723`*^9}, {
   3.9165064378147545`*^9, 3.9165064402046285`*^9}, {3.9165066063487997`*^9, 
   3.9165066068133373`*^9}, {3.916506770781*^9, 3.916506770986845*^9}, {
   3.916506818360832*^9, 3.9165068344941483`*^9}, {3.91650702210918*^9, 
   3.916507055596775*^9}, 3.9165070945532026`*^9, {3.9165072348013864`*^9, 
   3.916507258828418*^9}, {3.9165082243803825`*^9, 3.9165082246202836`*^9}, {
   3.9165089341902933`*^9, 3.9165089344447165`*^9}, 3.916677949003668*^9, 
   3.916855140147935*^9, {3.9168553372119427`*^9, 3.9168553454037075`*^9}, {
   3.9168554286292353`*^9, 3.9168554310892353`*^9}, {3.9170209033970375`*^9, 
   3.917020906944415*^9}, {3.9181395040493507`*^9, 3.918139505477496*^9}, {
   3.9181441167255173`*^9, 3.9181441186055202`*^9}, 3.934739476582316*^9, {
   3.9506899897093086`*^9, 3.9506900024721737`*^9}},
 CellTags->{
  "Acceptance-computation", "Number-of-events-computation+sensitivity"},
 CellLabel->
  "In[374]:=",ExpressionUUID->"ed9378d5-1972-4ecf-a029-94d16d76a66e"]
}, Closed]],

Cell[CellGroupData[{

Cell["Generalized acceptances", "Subsection",
 CellChangeTimes->{{3.9165071505021195`*^9, 3.9165071536920986`*^9}},
 CellTags->{
  "Acceptance-computation", 
   "Number-of-events-computation+sensitivity"},ExpressionUUID->"90f400a5-a53f-\
4620-b2bb-0b2a8019b373"],

Cell[CellGroupData[{

Cell["Definitions", "Subsubsection",
 CellChangeTimes->{{3.9506900144740944`*^9, 3.9506900165762444`*^9}},
 CellTags->{
  "Number-of-events-computation+sensitivity", 
   "Acceptance-computation"},ExpressionUUID->"aff6e0ae-afea-aa42-92b7-\
e0ae7b047949"],

Cell[BoxData[
 RowBox[{"If", "[", 
  RowBox[{"condcontinue", ",", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Tabulated", " ", "acceptance"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"FactorANUBISceiling", "=", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"SelectedExperiment", "==", "\"\<ANUBIS-ceiling\>\""}], ",", 
       "2", ",", "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"zShiftProd", "[", "prod", "]"}], "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"StringContainsQ", "[", 
          RowBox[{"SelectedExperiment", ",", "\"\<FASER\>\""}], "]"}], ",", 
         "0.", ",", "0."}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"prod", ",", "ProductionList"}], "}"}]}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"AcceptanceDiscret", "[", 
      RowBox[{
      "m_", ",", "ProdChannel_", ",", "\[Epsilon]decOp_", ",", "decProb_"}], 
      "]"}], ":=", 
     RowBox[{"AcceptanceDiscretTemp", "[", 
      RowBox[{
      "m", ",", "ProdChannel", ",", "\[Epsilon]decOp", ",", "decProb", ",", 
       "mLLPmin", ",", "mmin\[Epsilon]", ",", "mLLPmax", ",", 
       "mmax\[Epsilon]", ",", "ELLPmax", ",", "\[Theta]minExp", ",", 
       "TableIntegrandDiscret", ",", "BrVis", ",", "zmaxExp", ",", "zminExp", 
       ",", "FactorANUBISceiling", ",", 
       RowBox[{"zShiftProd", "[", "ProdChannel", "]"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"mlistAcceptance", "[", "prod", "]"}], "=", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{"m", ",", 
           RowBox[{"{", 
            RowBox[{"m", ",", 
             RowBox[{"1.01", 
              RowBox[{"Max", "[", 
               RowBox[{
                RowBox[{"mLLPmin", "[", "prod", "]"}], ",", 
                "mmin\[Epsilon]"}], "]"}]}], ",", 
             RowBox[{"0.95", 
              RowBox[{"Min", "[", 
               RowBox[{
                RowBox[{"mLLPmax", "[", "prod", "]"}], ",", 
                "mmax\[Epsilon]"}], "]"}]}], ",", 
             RowBox[{"Min", "[", 
              RowBox[{
               FractionBox[
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"0.95", 
                   RowBox[{"Min", "[", 
                    RowBox[{
                    RowBox[{"mLLPmax", "[", "prod", "]"}], ",", 
                    "mmax\[Epsilon]"}], "]"}]}], "-", 
                  RowBox[{"1.01", 
                   RowBox[{"Max", "[", 
                    RowBox[{
                    RowBox[{"mLLPmin", "[", "prod", "]"}], ",", 
                    "mmin\[Epsilon]"}], "]"}]}]}], ")"}], "20"], ",", "2"}], 
              "]"}]}], "}"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"0.99", 
           RowBox[{"Min", "[", 
            RowBox[{
             RowBox[{"mLLPmax", "[", "prod", "]"}], ",", "mmax\[Epsilon]"}], 
            "]"}]}], "}"}]}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"prod", ",", "ProductionList"}], "}"}]}], "]"}], ";"}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.9506900428560104`*^9, 3.9506900504018*^9}, {
  3.9514893146700716`*^9, 3.9514893151979685`*^9}},
 CellTags->{
  "Number-of-events-computation+sensitivity", "Acceptance-computation"},
 CellLabel->
  "In[375]:=",ExpressionUUID->"02dabcb5-0a51-a94f-ae07-bb624d4b7504"]
}, Closed]],

Cell[CellGroupData[{

Cell["Calculating acceptances", "Subsubsection",
 CellChangeTimes->{{3.9506900144740944`*^9, 3.950690025389122*^9}},
 CellTags->{
  "Number-of-events-computation+sensitivity", 
   "Acceptance-computation"},ExpressionUUID->"7617dcc7-7638-e04e-b918-\
22c854d2f2aa"],

Cell[BoxData[
 RowBox[{"If", "[", 
  RowBox[{"condcontinue", ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ResourceFunction", "[", "\"\<MonitorProgress\>\"", "]"}], "@", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"\[Epsilon]GeomTabs", "[", "prod", "]"}], "=", 
         RowBox[{"ParallelTable", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"m", ",", 
             RowBox[{"AcceptanceDiscret", "[", 
              RowBox[{"m", ",", "prod", ",", "\"\<False\>\"", ",", "0"}], 
              "]"}], ",", 
             RowBox[{"AcceptanceDiscret", "[", 
              RowBox[{"m", ",", "prod", ",", "\"\<True\>\"", ",", "0"}], 
              "]"}], ",", 
             RowBox[{"AcceptanceDiscret", "[", 
              RowBox[{"m", ",", "prod", ",", "\"\<False\>\"", ",", "1"}], 
              "]"}], ",", 
             RowBox[{"AcceptanceDiscret", "[", 
              RowBox[{"m", ",", "prod", ",", "\"\<True\>\"", ",", "1"}], 
              "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"m", ",", 
             RowBox[{"mlistAcceptance", "[", "prod", "]"}]}], "}"}]}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"\[Epsilon]GeomTabs", "[", "prod", "]"}], "=", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"Join", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"Max", "[", 
                RowBox[{
                 RowBox[{"mLLPmin", "[", "prod", "]"}], ",", 
                 "mmin\[Epsilon]"}], "]"}], "}"}], ",", 
              RowBox[{"Drop", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"\[Epsilon]GeomTabs", "[", "prod", "]"}], "[", 
                 RowBox[{"[", "1", "]"}], "]"}], ",", "1"}], "]"}]}], "]"}], 
            "}"}], ",", 
           RowBox[{"\[Epsilon]GeomTabs", "[", "prod", "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"Join", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"Min", "[", 
                RowBox[{
                 RowBox[{"mLLPmax", "[", "prod", "]"}], ",", 
                 "mmax\[Epsilon]"}], "]"}], "}"}], ",", 
              RowBox[{"Drop", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"\[Epsilon]GeomTabs", "[", "prod", "]"}], "[", 
                 RowBox[{"[", 
                  RowBox[{"-", "1"}], "]"}], "]"}], ",", "1"}], "]"}]}], 
             "]"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"prod", ",", "ProductionList"}], "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"PlotAcc", "[", "ProdChannel_", "]"}], ":=", 
     RowBox[{"ListLogPlot", "[", 
      RowBox[{
       RowBox[{"Evaluate", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"\[Epsilon]GeomTabs", "[", "ProdChannel", "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", 
             RowBox[{"{", 
              RowBox[{"1", ",", "2"}], "}"}]}], "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"\[Epsilon]GeomTabs", "[", "ProdChannel", "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", 
             RowBox[{"{", 
              RowBox[{"1", ",", "3"}], "}"}]}], "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"\[Epsilon]GeomTabs", "[", "ProdChannel", "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", 
             RowBox[{"{", 
              RowBox[{"1", ",", "4"}], "}"}]}], "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"\[Epsilon]GeomTabs", "[", "ProdChannel", "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", 
             RowBox[{"{", 
              RowBox[{"1", ",", "5"}], "}"}]}], "]"}], "]"}]}], "}"}], "]"}], 
       ",", 
       RowBox[{"FrameStyle", "\[Rule]", 
        RowBox[{"Directive", "[", 
         RowBox[{"Black", ",", " ", "22"}], "]"}]}], ",", 
       RowBox[{"PlotStyle", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Thickness", "[", "0.003", "]"}], ",", "Blue"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Thickness", "[", "0.003", "]"}], ",", 
            RowBox[{"Darker", "@", "Red"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Thickness", "[", "0.003", "]"}], ",", 
            RowBox[{"Darker", "@", 
             RowBox[{"Darker", "@", "Green"}]}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Thickness", "[", "0.003", "]"}], ",", "Black"}], "}"}]}],
          "}"}]}], ",", 
       RowBox[{"GridLines", "\[Rule]", "Automatic"}], ",", 
       RowBox[{"PlotRange", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"MinMax", "[", 
           RowBox[{
            RowBox[{"\[Epsilon]GeomTabs", "[", "ProdChannel", "]"}], "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Max", "[", 
             RowBox[{
              RowBox[{"0.9", 
               RowBox[{"Min", "[", 
                RowBox[{
                 RowBox[{"Min", "[", 
                  RowBox[{
                   RowBox[{"\[Epsilon]GeomTabs", "[", "ProdChannel", "]"}], "[", 
                   RowBox[{"[", 
                    RowBox[{"All", ",", "4"}], "]"}], "]"}], "]"}], ",", 
                 RowBox[{"Min", "[", 
                  RowBox[{
                   RowBox[{"\[Epsilon]GeomTabs", "[", "ProdChannel", "]"}], "[", 
                   RowBox[{"[", 
                    RowBox[{"All", ",", "3"}], "]"}], "]"}], "]"}]}], "]"}]}],
               ",", 
              SuperscriptBox["10", 
               RowBox[{"-", "5"}]]}], "]"}], ",", 
            RowBox[{"1.1", 
             RowBox[{"Max", "[", 
              RowBox[{
               RowBox[{"Max", "[", 
                RowBox[{
                 RowBox[{"\[Epsilon]GeomTabs", "[", "ProdChannel", "]"}], "[", 
                 RowBox[{"[", 
                  RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}], ",", 
               RowBox[{"Max", "[", 
                RowBox[{
                 RowBox[{"\[Epsilon]GeomTabs", "[", "ProdChannel", "]"}], "[", 
                 RowBox[{"[", 
                  RowBox[{"All", ",", "4"}], "]"}], "]"}], "]"}]}], "]"}]}]}],
            "}"}]}], "}"}]}], ",", 
       RowBox[{"Joined", "\[Rule]", "True"}], ",", 
       RowBox[{"Frame", "\[Rule]", "True"}], ",", 
       RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
       RowBox[{"FrameLabel", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"\"\<m [GeV]\>\"", ",", "\"\<Acceptance\>\""}], "}"}]}], ",", 
       RowBox[{"PlotLabel", "\[Rule]", " ", 
        RowBox[{"Style", "[", 
         RowBox[{
          RowBox[{"Row", "[", 
           RowBox[{"{", 
            RowBox[{"\"\<From \>\"", ",", "ProdChannel"}], "}"}], "]"}], ",", 
          " ", "20", ",", " ", "Black"}], "]"}]}], ",", 
       RowBox[{"PlotLegends", "\[Rule]", 
        RowBox[{"Placed", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Style", "[", 
             RowBox[{"#", ",", " ", "18"}], "]"}], "&"}], "/@", 
           RowBox[{"{", 
            
            RowBox[{"\"\<<\!\(\*SubscriptBox[\(\[Epsilon]\), \(LLP\)]\)>\>\"",
              ",", "\"\<<\!\(\*SubscriptBox[\(\[Epsilon]\), \
\(LLP\)]\)\!\(\*SubscriptBox[\(\[Epsilon]\), \(decay\)]\)>\>\"", 
             ",", "\"\<c\[Tau]<\!\(\*SubscriptBox[\(\[Epsilon]\), \
\(LLP\)]\)\!\(\*SubscriptBox[\(P\), \(decay\)]\)>\>\"", 
             ",", "\"\<c\[Tau]<\!\(\*SubscriptBox[\(\[Epsilon]\), \
\(LLP\)]\)\!\(\*SubscriptBox[\(P\), \(decay\)]\)\!\(\*SubscriptBox[\(\
\[Epsilon]\), \(decay\)]\)>\>\""}], "}"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"0.75", ",", "0.2"}], "}"}]}], "]"}]}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"FilenameAcceptance", "[", "prod", "]"}], "=", 
         RowBox[{"ToString", "@", 
          RowBox[{"StringForm", "[", 
           RowBox[{"\"\<Acceptance_ALP-fermion_at_``_From_``.dat\>\"", ",", 
            RowBox[{"Sequence", "@@", 
             RowBox[{"{", 
              RowBox[{"SelectedExperiment", ",", 
               RowBox[{"ExportList", "[", "prod", "]"}]}], "}"}]}]}], 
           "]"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Export", "[", 
         RowBox[{
          RowBox[{"FileNameJoin", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"NotebookDirectory", "[", "]"}], 
             ",", "\"\<Auxiliary data/ALPs with fermion coupling\>\"", ",", 
             "SelectedExperiment", ",", 
             RowBox[{"FilenameAcceptance", "[", "prod", "]"}]}], "}"}], "]"}],
           ",", 
          RowBox[{
           RowBox[{"\[Epsilon]GeomTabs", "[", "prod", "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", 
             RowBox[{"{", 
              RowBox[{"1", ",", "2", ",", "4", ",", "5"}], "}"}]}], "]"}], 
           "]"}], ",", "\"\<Table\>\""}], "]"}]}], "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"prod", ",", "ProductionList"}], "}"}]}], "]"}], "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"AccAveraged", "[", 
      RowBox[{"mLLP_", ",", "c\[Tau]_"}], "]"}], "=", 
     RowBox[{"NpotGivenExperiment", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"mLLPmin", "[", "prod", "]"}], "<", "mLLP", "<", 
             RowBox[{"mLLPmax", "[", "prod", "]"}]}], ",", 
            RowBox[{"Evaluate", "[", 
             RowBox[{"ProbLLP", "[", 
              RowBox[{"mLLP", ",", "1", ",", "prod"}], "]"}], "]"}], ",", 
            "0"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"prod", ",", "ProductionList"}], "}"}]}], "]"}], ",", 
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Max", "[", 
              RowBox[{
               RowBox[{"mLLPmin", "[", "prod", "]"}], ",", "mmin\[Epsilon]"}],
               "]"}], "<", "mLLP", "<", 
             RowBox[{"Min", "[", 
              RowBox[{
               RowBox[{"mLLPmax", "[", "prod", "]"}], ",", "mmax\[Epsilon]"}],
               "]"}]}], ",", 
            RowBox[{"Evaluate", "[", 
             RowBox[{
              RowBox[{"ProbLLP", "[", 
               RowBox[{"mLLP", ",", "1", ",", "prod"}], "]"}], "*", 
              RowBox[{
               RowBox[{"Interpolation", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"\[Epsilon]GeomTabs", "[", "prod", "]"}], "[", 
                  RowBox[{"[", 
                   RowBox[{"All", ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "2"}], "}"}]}], "]"}], "]"}], ",", 
                 RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[",
                "mLLP", "]"}]}], "]"}], ",", "0"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"prod", ",", "ProductionList"}], "}"}]}], "]"}], ",", 
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Max", "[", 
              RowBox[{
               RowBox[{"mLLPmin", "[", "prod", "]"}], ",", "mmin\[Epsilon]"}],
               "]"}], "<", "mLLP", "<", 
             RowBox[{"Min", "[", 
              RowBox[{
               RowBox[{"mLLPmax", "[", "prod", "]"}], ",", "mmax\[Epsilon]"}],
               "]"}]}], ",", 
            RowBox[{"Evaluate", "[", 
             RowBox[{
              FractionBox[
               RowBox[{"ProbLLP", "[", 
                RowBox[{"mLLP", ",", "1", ",", "prod"}], "]"}], "c\[Tau]"], "*", 
              RowBox[{
               RowBox[{"Interpolation", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"\[Epsilon]GeomTabs", "[", "prod", "]"}], "[", 
                  RowBox[{"[", 
                   RowBox[{"All", ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "4"}], "}"}]}], "]"}], "]"}], ",", 
                 RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[",
                "mLLP", "]"}]}], "]"}], ",", "0"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"prod", ",", "ProductionList"}], "}"}]}], "]"}], ",", 
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Max", "[", 
              RowBox[{
               RowBox[{"mLLPmin", "[", "prod", "]"}], ",", "mmin\[Epsilon]"}],
               "]"}], "<", "mLLP", "<", 
             RowBox[{"Min", "[", 
              RowBox[{
               RowBox[{"mLLPmax", "[", "prod", "]"}], ",", "mmax\[Epsilon]"}],
               "]"}]}], ",", 
            RowBox[{"Evaluate", "[", 
             RowBox[{
              FractionBox[
               RowBox[{"ProbLLP", "[", 
                RowBox[{"mLLP", ",", "1", ",", "prod"}], "]"}], "c\[Tau]"], "*", 
              RowBox[{
               RowBox[{"Interpolation", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"\[Epsilon]GeomTabs", "[", "prod", "]"}], "[", 
                  RowBox[{"[", 
                   RowBox[{"All", ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "5"}], "}"}]}], "]"}], "]"}], ",", 
                 RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[",
                "mLLP", "]"}]}], "]"}], ",", "0"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"prod", ",", "ProductionList"}], "}"}]}], "]"}]}], 
       "}"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{"FileNameJoin", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"directory", "[", "\"\<Auxiliary-experiment\>\"", "]"}], ",", 
         RowBox[{"\"\<AcceptanceAveraged-\>\"", "<>", "LLPdirName", 
          "<>", "\"\<.m\>\""}]}], "}"}], "]"}], ",", 
      RowBox[{"AccAveraged", "[", 
       RowBox[{"mLLP", ",", "c\[Tau]"}], "]"}], ",", "\"\<MX\>\""}], "]"}], ";",
     "\[IndentingNewLine]", 
    RowBox[{"Style", "[", 
     RowBox[{
      RowBox[{"Row", "[", 
       RowBox[{"Evaluate", "[", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"PlotAcc", "[", "prod", "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"prod", ",", "ProductionList"}], "}"}]}], "]"}], "]"}], 
       "]"}], ",", 
      RowBox[{"ImageSizeMultipliers", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"1", ",", "1", ",", "1", ",", "1"}], "}"}]}]}], "]"}]}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.9165072608467913`*^9, 3.91650727179105*^9}, {
  3.916511834115503*^9, 3.9165119704481926`*^9}, {3.916671557956114*^9, 
  3.916671598040783*^9}, {3.9166717128875666`*^9, 3.9166717253877993`*^9}, {
  3.942917721429304*^9, 3.9429177229104996`*^9}, {3.9506900306728516`*^9, 
  3.950690092352249*^9}},
 CellTags->{
  "Acceptance-computation", "Number-of-events-computation+sensitivity"},
 CellLabel->
  "In[376]:=",ExpressionUUID->"ad7d144a-73ab-4c1a-acd2-06b66fe856e6"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Rough estimates of the upper and lower bounds", "Subsection",
 CellChangeTimes->{{3.8850328066928463`*^9, 3.8850328135228024`*^9}},
 CellTags->{
  "Acceptance-computation", 
   "Number-of-events-computation+sensitivity"},ExpressionUUID->"b08eb94e-c944-\
4b4c-868e-d6afa6f49903"],

Cell[BoxData[
 RowBox[{"If", "[", 
  RowBox[{"condcontinue", ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"LowerBoundEstimate", "[", 
         RowBox[{"mLLP_", ",", "prod"}], "]"}], "=", 
        SuperscriptBox[
         RowBox[{"(", 
          FractionBox[
           RowBox[{"NpotGivenExperiment", "*", 
            RowBox[{"ProbLLP", "[", 
             RowBox[{"mLLP", ",", "1", ",", "prod"}], "]"}], "*", 
            RowBox[{
             RowBox[{"Interpolation", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"\[Epsilon]GeomTabs", "[", "prod", "]"}], "[", 
                RowBox[{"[", 
                 RowBox[{"All", ",", 
                  RowBox[{"{", 
                   RowBox[{"1", ",", "5"}], "}"}]}], "]"}], "]"}], ",", 
               RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[", 
             "mLLP", "]"}]}], 
           RowBox[{"2.3", 
            RowBox[{"ldecayLLP", "[", 
             RowBox[{"mLLP", ",", "1", ",", "ELLP"}], "]"}], 
            FractionBox["mLLP", 
             SqrtBox[
              RowBox[{
               SuperscriptBox["ELLP", "2"], "-", 
               SuperscriptBox["mLLP", "2"]}]]]}]], ")"}], 
         RowBox[{"-", 
          FractionBox["1", "4"]}]]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"UpperBoundEstimate", "[", 
         RowBox[{"mLLP_", ",", "prod"}], "]"}], "=", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"Abs", "[", 
           RowBox[{"Re", "[", 
            RowBox[{"Evaluate", "[", 
             RowBox[{
              RowBox[{"-", 
               FractionBox[
                RowBox[{"ProductLog", "[", 
                 RowBox[{
                  RowBox[{"-", "1"}], ",", 
                  RowBox[{
                   RowBox[{"-", "2.3"}], "*", 
                   FractionBox["b", "a"]}]}], "]"}], "b"]}], "/.", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"a", "\[Rule]", " ", 
                 RowBox[{"NpotGivenExperiment", "*", 
                  RowBox[{"ProbLLP", "[", 
                   RowBox[{"mLLP", ",", "1", ",", "prod"}], "]"}], "*", 
                  RowBox[{
                   RowBox[{"Interpolation", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"\[Epsilon]GeomTabs", "[", "prod", "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "3"}], "}"}]}], "]"}], "]"}], ",", 
                    RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[",
                    "mLLP", "]"}]}]}], ",", 
                RowBox[{"b", "\[Rule]", 
                 FractionBox[
                  RowBox[{"zminExp", "-", 
                   RowBox[{"zShiftProd", "[", "prod", "]"}]}], 
                  RowBox[{"ldecayLLP", "[", 
                   RowBox[{"mLLP", ",", "1", ",", 
                    RowBox[{"ELLPmax", "[", 
                    RowBox[{"0.5", ",", "\[Theta]minExp", ",", "prod"}], 
                    "]"}]}], "]"}]]}]}], "}"}]}], "]"}], "]"}], "]"}], ")"}], 
         FractionBox["1", "2"]]}]}], ",", 
      RowBox[{"{", 
       RowBox[{"prod", ",", "ProductionList"}], "}"}]}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"ProdTest", "=", 
     RowBox[{"ProductionList", "[", 
      RowBox[{"[", 
       RowBox[{"-", "1"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"LogLogPlot", "[", 
     RowBox[{
      RowBox[{"Evaluate", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"0.3", 
          RowBox[{"LowerBoundEstimate", "[", 
           RowBox[{"mLLP", ",", "ProdTest"}], "]"}]}], ",", 
         RowBox[{"1.8", 
          RowBox[{"UpperBoundEstimate", "[", 
           RowBox[{"mLLP", ",", "ProdTest"}], "]"}]}]}], "}"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"mLLP", ",", 
        RowBox[{"Max", "[", 
         RowBox[{
          RowBox[{"mLLPmin", "[", "ProdTest", "]"}], ",", "mmin\[Epsilon]"}], 
         "]"}], ",", 
        RowBox[{"Min", "[", 
         RowBox[{
          RowBox[{"mLLPmax", "[", "ProdTest", "]"}], ",", "mmax\[Epsilon]"}], 
         "]"}]}], "}"}], ",", 
      RowBox[{"Frame", "->", "True"}], ",", 
      RowBox[{"ImageSize", "->", "Large"}]}], "]"}]}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.8927045521296835`*^9, 3.892704618398532*^9}, {
   3.892704651576499*^9, 3.892704652867281*^9}, 3.8951292466391563`*^9, {
   3.8972064547512426`*^9, 3.8972064548441195`*^9}, {3.8972065272743893`*^9, 
   3.8972065273639555`*^9}, {3.897208556347765*^9, 3.8972085563922853`*^9}, {
   3.8972086426345124`*^9, 3.897208654173244*^9}, {3.897232414966792*^9, 
   3.8972324175870733`*^9}, {3.8972329876997476`*^9, 3.897233009729268*^9}, {
   3.8972333224369483`*^9, 3.8972333287617497`*^9}, 3.897233684153979*^9, {
   3.8972340069416475`*^9, 3.897234007169805*^9}, {3.897234114920539*^9, 
   3.8972341194170074`*^9}, {3.9027273710668883`*^9, 3.902727371070483*^9}, {
   3.9037896747950044`*^9, 3.903789674805071*^9}, {3.903791118363947*^9, 
   3.9037911183684855`*^9}, {3.9037936813200336`*^9, 3.903793682290308*^9}, {
   3.9049231517292624`*^9, 3.904923157976531*^9}, {3.9049231902009006`*^9, 
   3.904923190656528*^9}, 3.904926376200742*^9, {3.911027289230471*^9, 
   3.9110273124658933`*^9}, {3.9110277505648003`*^9, 3.911027764091008*^9}, 
   3.913866752239462*^9, {3.9138675516462307`*^9, 3.9138675637833986`*^9}, {
   3.9138682212474923`*^9, 3.913868221253111*^9}, {3.9138690439766445`*^9, 
   3.913869043981699*^9}, {3.9138691384932814`*^9, 3.913869147288597*^9}, {
   3.913869202156701*^9, 3.9138692055185556`*^9}, {3.913869239652417*^9, 
   3.9138692400334797`*^9}, {3.913869474546574*^9, 3.913869474546574*^9}, {
   3.913870429970599*^9, 3.913870442530464*^9}, {3.9138744135974054`*^9, 
   3.913874414587882*^9}, {3.9156429963777814`*^9, 3.915642996428277*^9}, {
   3.916391759919177*^9, 3.916391773937995*^9}, {3.916512010716703*^9, 
   3.9165120302839413`*^9}, {3.9166717602348967`*^9, 3.916671763463215*^9}, {
   3.9506901309754295`*^9, 3.9506901402314453`*^9}, {3.9514684808229237`*^9, 
   3.9514684839192677`*^9}},
 CellTags->{
  "Acceptance-computation", "Number-of-events-computation+sensitivity"},
 CellLabel->
  "In[377]:=",ExpressionUUID->"3457eb9e-7b37-420f-8d27-350e94706731"]
}, Closed]],

Cell[CellGroupData[{

Cell["Number of events - fast", "Subsection",
 CellChangeTimes->{{3.897206442190997*^9, 3.8972064427846107`*^9}, {
  3.905840324777521*^9, 3.905840328994842*^9}},
 CellTags->{
  "Number-of-events-computation+sensitivity", 
   "Acceptance-computation"},ExpressionUUID->"9b4d2cf7-9554-4e8d-bf0e-\
5bc45bc7e4fd"],

Cell[BoxData[
 RowBox[{"If", "[", 
  RowBox[{"condcontinue", ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"FactorLowerBound", "=", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"MemberQ", "[", 
         RowBox[{
          RowBox[{"{", 
           
           RowBox[{"\"\<ANUBIS-shaft-volume-1\>\"", 
            ",", "\"\<ANUBIS-shaft-volume-2\>\"", 
            ",", "\"\<ANUBIS-shaft-volume-3\>\""}], "}"}], ",", 
          "SelectedExperiment"}], "]"}], "==", "True"}], ",", "0.1", ",", 
       "0.3"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"NeventsDiscret", "[", 
      RowBox[{"m_", ",", "ProdChannel_", ",", "couplinglist_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"NevDiscret", ",", "NpotTimes\[Chi]val", ",", "zshift"}], 
        "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"MemberQ", "[", 
          RowBox[{"ProductionList", ",", "ProdChannel"}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Max", "[", 
             RowBox[{
              RowBox[{"mLLPmin", "[", "ProdChannel", "]"}], ",", 
              "mmin\[Epsilon]"}], "]"}], "<", "m", "<", 
            RowBox[{"Min", "[", 
             RowBox[{
              RowBox[{"mLLPmax", "[", "ProdChannel", "]"}], ",", 
              "mmax\[Epsilon]"}], "]"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"integrandtab", "=", 
             RowBox[{"TableIntegrandDiscret", "[", 
              RowBox[{"m", ",", "ProdChannel", ",", "\"\<True\>\""}], "]"}]}],
             ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"NpotTimes\[Chi]val", "[", "coupling_", "]"}], "=", 
             RowBox[{"NpotGivenExperiment", "*", 
              RowBox[{"ProbLLP", "[", 
               RowBox[{"m", ",", "coupling", ",", "ProdChannel"}], "]"}]}]}], 
            ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"lowerbound", ",", "upperbound"}], "}"}], "=", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"LowerBoundEstimate", "[", 
                RowBox[{"m", ",", "ProdChannel"}], "]"}], ",", 
               RowBox[{"UpperBoundEstimate", "[", 
                RowBox[{"m", ",", "ProdChannel"}], "]"}]}], "}"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"brvis", "=", 
             RowBox[{"BrVis", "[", "m", "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"NevDiscret", "[", "coupling_", "]"}], ":=", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"0.1", "lowerbound"}], "<", "coupling", "<", 
                RowBox[{"(*", "1.5", "*)"}], 
                RowBox[{"2", "upperbound"}]}], ",", 
               RowBox[{
                RowBox[{"NpotTimes\[Chi]val", "[", "coupling", "]"}], "*", 
                "brvis", "*", 
                RowBox[{"sumcompile", "[", 
                 RowBox[{"tableprefac", "[", 
                  RowBox[{"integrandtab", ",", "m", ",", 
                   RowBox[{"c\[Tau]LLP", "[", 
                    RowBox[{"m", ",", "coupling"}], "]"}], ",", "1", ",", 
                   RowBox[{"zShiftProd", "[", "ProdChannel", "]"}]}], "]"}], 
                 "]"}]}], ",", "0."}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"m", ",", 
                RowBox[{"couplinglist", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], ",", 
                RowBox[{"NevDiscret", "[", 
                 RowBox[{"couplinglist", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "1", ",", 
                RowBox[{"Length", "[", "couplinglist", "]"}], ",", "1"}], 
               "}"}]}], "]"}]}], ",", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"m", ",", 
               RowBox[{"couplinglist", "[", 
                RowBox[{"[", "i", "]"}], "]"}], ",", "0."}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", 
               RowBox[{"Length", "[", "couplinglist", "]"}], ",", "1"}], 
              "}"}]}], "]"}]}], "]"}], "\[IndentingNewLine]", ",", 
         "\[IndentingNewLine]", 
         RowBox[{
         "Print", "[", "\"\<The given production mode does not exist!\>\"", 
          "]"}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
      "]"}]}]}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.897200964730176*^9, 3.897200965970766*^9}, {
   3.89720118259857*^9, 3.8972011870868115`*^9}, {3.8972012433916793`*^9, 
   3.8972012434804716`*^9}, {3.8972021109080114`*^9, 3.897202111357911*^9}, {
   3.897205130000824*^9, 3.8972051305748835`*^9}, 3.897206599004672*^9, {
   3.8972085445054307`*^9, 3.8972085493226857`*^9}, {3.897208729717713*^9, 
   3.897208782995672*^9}, {3.8972323557542253`*^9, 3.897232355758215*^9}, {
   3.8972325208882675`*^9, 3.897232579312927*^9}, {3.8972330183637056`*^9, 
   3.8972330186824365`*^9}, {3.8972330557477093`*^9, 
   3.8972330786629725`*^9}, {3.8972331885872264`*^9, 
   3.8972331892740192`*^9}, {3.897233372953797*^9, 3.8972334102237387`*^9}, {
   3.897233632248149*^9, 3.8972337068313646`*^9}, {3.897233770343194*^9, 
   3.897233794850586*^9}, {3.897234027583762*^9, 3.897234039222018*^9}, 
   3.902727371095085*^9, {3.903789674824919*^9, 3.9037896748651905`*^9}, {
   3.903790316364489*^9, 3.903790327604648*^9}, 3.903791118373599*^9, {
   3.903793681334241*^9, 3.903793681337234*^9}, {3.903793815495824*^9, 
   3.9037938405670385`*^9}, {3.9110273360582485`*^9, 3.911027382154455*^9}, {
   3.9110275909078875`*^9, 3.9110276162959757`*^9}, {3.911027735769429*^9, 
   3.9110277360519323`*^9}, {3.91102782490703*^9, 3.9110278664472694`*^9}, {
   3.911027908345337*^9, 3.9110279086712365`*^9}, 3.913867583368688*^9, {
   3.9138687734466343`*^9, 3.9138687783364944`*^9}, 3.913869043987434*^9, {
   3.91386913849867*^9, 3.91386914700126*^9}, {3.9138718044634438`*^9, 
   3.9138718044763327`*^9}, {3.9138744265895786`*^9, 
   3.9138744439740767`*^9}, {3.915642996438535*^9, 3.9156429964465075`*^9}, {
   3.9166521753816633`*^9, 3.916652206162878*^9}, {3.916671771350841*^9, 
   3.9166717732263813`*^9}, 3.9166792876243773`*^9, {3.9506901551721153`*^9, 
   3.950690158327841*^9}, {3.9506903544809475`*^9, 3.9506903713040867`*^9}},
 CellTags->{
  "Number-of-events-computation+sensitivity", "Acceptance-computation"},
 CellLabel->
  "In[378]:=",ExpressionUUID->"49dc74a0-e549-437e-844d-546f09d15bc4"]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Number of events - slow (using built-in Mathematica functions Interpolation, \
NIntegrate)\
\>", "Subsection",
 CellChangeTimes->{{3.916673042143861*^9, 3.9166730501366386`*^9}},
 CellTags->{
  "Number-of-events-computation+sensitivity", 
   "Acceptance-computation"},ExpressionUUID->"75741e81-60c2-4769-95be-\
621ef8117a1e"],

Cell[BoxData[
 RowBox[{"If", "[", 
  RowBox[{"condcontinue", ",", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Differential", " ", "decay", " ", "probability", " ", 
      FractionBox["1", "ldecay"], 
      RowBox[{"Exp", "[", 
       RowBox[{
        RowBox[{"-", "l"}], "/", "ldecay"}], "]"}]}], ",", " ", 
     RowBox[{
     "where", " ", "l", " ", "is", " ", "expressed", " ", "in", " ", "terms", 
      " ", "of", " ", "the", " ", "longitudinal", " ", "displacement", " ", 
      "z", " ", "and", " ", "polar", " ", "angle", " ", "\[Theta]", " ", "as",
       " ", 
      RowBox[{"z", "/", "cos\[Theta]"}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Differential", " ", "decay", " ", "probability", " ", 
      RowBox[{"(", 
       RowBox[{"1", "/", "ldecay"}], ")"}], 
      RowBox[{"Exp", "[", 
       RowBox[{
        RowBox[{"-", "l"}], "/", "ldecay"}], "]"}]}], ",", " ", 
     RowBox[{
     "where", " ", "l", " ", "is", " ", "expressed", " ", "in", " ", "terms", 
      " ", "of", " ", "the", " ", "longitudinal", " ", "displacement", " ", 
      "z", " ", "and", " ", "polar", " ", "angle", " ", "\[Theta]", " ", "as",
       " ", 
      RowBox[{"z", "/", "cos\[Theta]"}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"PdecayDensity", "[", 
      RowBox[{
      "mLLP_", ",", "coupling_", ",", "\[Theta]LLP_", ",", "ELLP_", ",", 
       "zLLP_"}], "]"}], "=", 
     RowBox[{
      RowBox[{"Exp", "[", 
       RowBox[{
        RowBox[{"-", "zLLP"}], "/", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Cos", "[", "\[Theta]LLP", "]"}], "*", 
          RowBox[{"ldecayLLP", "[", 
           RowBox[{"mLLP", ",", "coupling", ",", "ELLP"}], "]"}]}], ")"}]}], 
       "]"}], "/", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Abs", "[", 
         RowBox[{"Cos", "[", "\[Theta]LLP", "]"}], "]"}], "*", 
        RowBox[{"ldecayLLP", "[", 
         RowBox[{"mLLP", ",", "coupling", ",", "ELLP"}], "]"}]}], ")"}]}]}], ";",
     "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
     "The", " ", "integrand", " ", "determining", " ", "the", " ", 
      "differential", " ", "rate", " ", "for", " ", "events"}], "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"IntegrandLLP", "[", 
        RowBox[{
        "mLLP_", ",", "coupling_", ",", "\[Theta]LLP_", ",", "ELLP_", ",", 
         "zLLP_", ",", "prod"}], "]"}], "=", 
       RowBox[{
        RowBox[{"DoubleDistrLLPint", "[", 
         RowBox[{"mLLP", ",", "\[Theta]LLP", ",", "ELLP", ",", "prod"}], 
         "]"}], "*", 
        RowBox[{"PdecayDensity", "[", 
         RowBox[{
         "mLLP", ",", "coupling", ",", "\[Theta]LLP", ",", "ELLP", ",", 
          "zLLP"}], "]"}], "*", 
        RowBox[{"AzimuthalAcceptanceInt", "[", 
         RowBox[{"\[Theta]LLP", ",", "zLLP"}], "]"}], "*", 
        RowBox[{"DecayAcceptanceInt", "[", 
         RowBox[{"mLLP", ",", "\[Theta]LLP", ",", "ELLP", ",", "zLLP"}], 
         "]"}]}]}], ",", 
      RowBox[{"{", 
       RowBox[{"prod", ",", "ProductionList"}], "}"}]}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"IntegralLLP", "[", 
      RowBox[{"mLLP_", ",", "coupling_", ",", "ProdChannel_"}], "]"}], ":=", 
     RowBox[{"NIntegrate", "[", 
      RowBox[{
       RowBox[{"Abs", "[", 
        RowBox[{
         RowBox[{"IntegrandLLP", "[", 
          RowBox[{"mLLP", ",", "coupling", ",", "\[Theta]LLP", ",", 
           RowBox[{"Exp", "[", "ELLP", "]"}], ",", "zLLP", ",", 
           "ProdChannel"}], "]"}], 
         RowBox[{"Exp", "[", "ELLP", "]"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Theta]LLP", ",", "\[Theta]minExp", ",", "\[Theta]maxExp"}],
         "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"ELLP", ",", 
         RowBox[{"Log", "[", "mLLP", "]"}], ",", 
         RowBox[{"Log", "[", 
          RowBox[{"ELLPmax", "[", 
           RowBox[{"mLLP", ",", "\[Theta]LLP", ",", "ProdChannel"}], "]"}], 
          "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"zLLP", ",", 
         RowBox[{"zmin\[Theta]", "[", "\[Theta]LLP", "]"}], ",", 
         RowBox[{"zmax\[Theta]", "[", "\[Theta]LLP", "]"}]}], "}"}], ",", 
       RowBox[{"Method", "\[Rule]", "\"\<AdaptiveMonteCarlo\>\""}]}], "]"}]}],
     ";", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"IntegralLLP", "[", 
       RowBox[{"mLLP_", ",", "finv_", ",", "ProdChannel_"}], "]"}], ":=", 
      RowBox[{"NIntegrate", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Abs", "[", 
          RowBox[{"IntegrandLLP", "[", 
           RowBox[{"mLLP", ",", "finv", ",", 
            RowBox[{"Exp", "[", "\[Theta]LLP", "]"}], ",", 
            RowBox[{"Exp", "[", "ELLP", "]"}], ",", 
            RowBox[{"Exp", "[", "zLLP", "]"}], ",", "ProdChannel"}], "]"}], 
          "]"}], 
         RowBox[{"Exp", "[", 
          RowBox[{"\[Theta]LLP", "+", "ELLP", "+", "zLLP"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"\[Theta]LLP", ",", 
          RowBox[{"Log", "[", "\[Theta]minExp", "]"}], ",", 
          RowBox[{"Log", "[", "\[Theta]maxExp", "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"ELLP", ",", 
          RowBox[{"Log", "[", "mLLP", "]"}], ",", 
          RowBox[{"Log", "[", 
           RowBox[{"ELLPmax", "[", 
            RowBox[{"mLLP", ",", 
             RowBox[{"Exp", "[", "\[Theta]LLP", "]"}], ",", "ProdChannel"}], 
            "]"}], "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"zLLP", ",", 
          RowBox[{"Log", "[", 
           RowBox[{"zmin\[Theta]", "[", 
            RowBox[{"Exp", "[", "\[Theta]LLP", "]"}], "]"}], "]"}], ",", 
          RowBox[{"Log", "[", 
           RowBox[{"zmax\[Theta]", "[", 
            RowBox[{"Exp", "[", "\[Theta]LLP", "]"}], "]"}], "]"}]}], "}"}], ",", 
        RowBox[{"Method", "\[Rule]", "\"\<AdaptiveMonteCarlo\>\""}]}], 
       "]"}]}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"NeventsInt", "[", 
      RowBox[{"mLLP_", ",", "coupling_", ",", "ProdChannel_"}], "]"}], ":=", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"mLLPmin", "[", "ProdChannel", "]"}], "\[LessEqual]", "mLLP",
          "\[LessEqual]", 
         RowBox[{"mLLPmax", "[", "ProdChannel", "]"}]}], "&&", 
        RowBox[{
         RowBox[{"BrVis", "[", "mLLP", "]"}], "!=", "0"}]}], ",", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"0.1", 
           RowBox[{"LowerBoundEstimate", "[", 
            RowBox[{"mLLP", ",", "ProdChannel"}], "]"}]}], "<", "coupling", "<", 
          RowBox[{"2", 
           RowBox[{"UpperBoundEstimate", "[", 
            RowBox[{"mLLP", ",", "ProdChannel"}], "]"}]}]}], ",", 
         RowBox[{"NpotGivenExperiment", "*", 
          RowBox[{"ProbLLP", "[", 
           RowBox[{"mLLP", ",", "coupling", ",", "ProdChannel"}], "]"}], "*", 
          RowBox[{"IntegralLLP", "[", 
           RowBox[{"mLLP", ",", "coupling", ",", "ProdChannel"}], "]"}]}], ",",
          "0."}], "]"}], ",", "0."}], "]"}]}]}]}], "\[IndentingNewLine]", 
  "]"}]], "Input",
 CellChangeTimes->{{3.950690413701708*^9, 3.950690427060663*^9}},
 CellTags->{
  "Number-of-events-computation+sensitivity", "Acceptance-computation"},
 CellLabel->
  "In[379]:=",ExpressionUUID->"45d46db1-d451-4a10-a413-f35599d4f890"]
}, Closed]],

Cell[CellGroupData[{

Cell["Differential number of events", "Subsection",
 CellChangeTimes->{{3.892111289211891*^9, 3.892111293865343*^9}},
 CellTags->
  "Number-of-events-computation+sensitivity",ExpressionUUID->"180acaf6-75e1-\
4bab-82db-d1998deec424"],

Cell[BoxData[
 RowBox[{"If", "[", 
  RowBox[{"condcontinue", ",", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "Variable", " ", "=", 
      " ", "\"\<\!\(\*SubscriptBox[\(E\), \(X\)]\)\>\""}], 
     ",", "\"\<\!\(\*SubscriptBox[\(z\), \(X\)]\)\>\"", ",", 
     RowBox[{
      RowBox[{"\"\<\!\(\*SubscriptBox[\(\[Theta]\), \(X\)]\)\>\"", ".", " ", 
       "The"}], " ", "number", " ", "belongs", " ", "to", " ", "the", " ", 
      "column", " ", "in", " ", "the", " ", "tabulated", " ", "data"}]}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"iVal", ":=", 
     RowBox[{"Association", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\"\<\!\(\*SubscriptBox[\(E\), \(X\)]\)\>\"", " ", "\[Rule]", 
         "2"}], ",", 
        RowBox[{"\"\<\!\(\*SubscriptBox[\(\[Theta]\), \(X\)]\)\>\"", "\[Rule]",
          "1"}], ",", 
        RowBox[{"\"\<\!\(\*SubscriptBox[\(z\), \(X\)]\)\>\"", "\[Rule]", 
         "3"}]}], "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
     "\[CapitalDelta]xvals", "[", "\"\<\!\(\*SubscriptBox[\(E\), \(X\)]\)\>\"",
       "]"}], ":=", "\[CapitalDelta]Evals"}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
     "\[CapitalDelta]xvals", "[", "\"\<\!\(\*SubscriptBox[\(z\), \(X\)]\)\>\"",
       "]"}], "=", "\[CapitalDelta]zvals"}], ";", "\[IndentingNewLine]", 
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"\[CapitalDelta]xvals", "[", 
        RowBox[{"\"\<\!\(\*SubscriptBox[\(\[Theta]\), \(X\)]\)\>\"", ",", 
         "prod"}], "]"}], "=", 
       RowBox[{"\[CapitalDelta]\[Theta]vals", "[", "prod", "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"prod", ",", "ProductionList"}], "}"}]}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"LegendX", ":=", 
     RowBox[{"Association", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\"\<\!\(\*SubscriptBox[\(E\), \(X\)]\)\>\"", 
         "\[Rule]", "\"\<\!\(\*SubscriptBox[\(E\), \(X\)]\) [GeV]\>\""}], ",", 
        RowBox[{"\"\<\!\(\*SubscriptBox[\(\[Theta]\), \(X\)]\)\>\"", 
         "\[Rule]", "\"\<\!\(\*SubscriptBox[\(\[Theta]\), \(X\)]\) \
[rad]\>\""}], ",", 
        RowBox[{"\"\<\!\(\*SubscriptBox[\(z\), \(X\)]\)\>\"", "\[Rule]", 
         " ", "\"\<\!\(\*SubscriptBox[\(z\), \(X\)]\) [m]\>\""}]}], "}"}], 
      "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"LegendY", ":=", 
     RowBox[{"Association", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\"\<\!\(\*SubscriptBox[\(E\), \(X\)]\)\>\"", 
         "\[Rule]", "\"\<\!\(\*SubscriptBox[\(dN\), \
\(ev\)]\)/\!\(\*SubscriptBox[\(dE\), \(X\)]\) [\!\(\*SuperscriptBox[\(GeV\), \
\(-1\)]\)]\>\""}], ",", 
        RowBox[{"\"\<\!\(\*SubscriptBox[\(\[Theta]\), \(X\)]\)\>\"", 
         "\[Rule]", "\"\<\!\(\*SubscriptBox[\(dN\), \
\(ev\)]\)/\!\(\*SubscriptBox[\(d\[Theta]\), \(X\)]\) \
[\!\(\*SuperscriptBox[\(rad\), \(-1\)]\)]\>\""}], ",", 
        RowBox[{"\"\<\!\(\*SubscriptBox[\(z\), \(X\)]\)\>\"", "\[Rule]", 
         " ", "\"\<\!\(\*SubscriptBox[\(dN\), \
\(ev\)]\)/\!\(\*SubscriptBox[\(dz\), \(X\)]\) [\!\(\*SuperscriptBox[\(m\), \
\(-1\)]\)]\>\""}]}], "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"Differential", " ", "number", " ", "of", " ", "events"}], 
     "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"NeventsDifferentialDiscretProd", "[", 
      RowBox[{"m_", ",", "ProdChannel_", ",", "coupling_", ",", "Variable_"}],
       "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "NpotTimes\[Chi]val", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ival", "=", 
         RowBox[{"iVal", "[", "Variable", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"NpotTimes\[Chi]val", "=", 
         RowBox[{"NpotGivenExperiment", "*", 
          RowBox[{"ProbLLP", "[", 
           RowBox[{"m", ",", "coupling", ",", "ProdChannel"}], "]"}]}]}], ";",
         "\[IndentingNewLine]", 
        RowBox[{"tablegrid0", "=", 
         RowBox[{"TableIntegrandDiscret", "[", 
          RowBox[{"m", ",", "ProdChannel", ",", "\"\<True\>\""}], "]"}]}], ";",
         "\[IndentingNewLine]", 
        RowBox[{"OutGridEfinalTemp", "=", 
         RowBox[{"OutGridEnergy", "[", 
          RowBox[{
           RowBox[{"N", "[", "m", "]"}], ",", "ProdChannel"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"\[CapitalDelta]Evals", "=", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Rest", "[", 
            SuperscriptBox["10", "OutGridEfinalTemp"], "]"}], "-", 
           RowBox[{"Most", "[", 
            SuperscriptBox["10", "OutGridEfinalTemp"], "]"}]}], ")"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"\[CapitalDelta]xval", "=", 
         RowBox[{"\[CapitalDelta]xvals", "[", "Variable", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"c\[Tau]Val", "=", 
         RowBox[{"c\[Tau]LLP", "[", 
          RowBox[{"m", ",", "coupling"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"brvis", "=", 
         RowBox[{"BrVis", "[", "m", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"ilist", "=", 
         RowBox[{"DeleteDuplicates", "[", 
          RowBox[{"{", 
           RowBox[{"ival", ",", "1", ",", "2", ",", "3"}], "}"}], "]"}]}], ";",
         "\[IndentingNewLine]", 
        RowBox[{"tablegrid1", "=", 
         RowBox[{"SortBy", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"#", "[", 
                RowBox[{"[", 
                 RowBox[{"ilist", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], ",", 
               RowBox[{"#", "[", 
                RowBox[{"[", 
                 RowBox[{"ilist", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}], ",", 
               RowBox[{"#", "[", 
                RowBox[{"[", 
                 RowBox[{"ilist", "[", 
                  RowBox[{"[", "3", "]"}], "]"}], "]"}], "]"}], ",", 
               RowBox[{"#", "[", 
                RowBox[{"[", "4", "]"}], "]"}]}], "}"}], "&"}], "/@", 
            RowBox[{"tableGridPrefac", "[", 
             RowBox[{"tablegrid0", ",", "m", ",", "c\[Tau]Val", ",", "0."}], 
             "]"}]}], ",", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"#", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", 
              RowBox[{"#", "[", 
               RowBox[{"[", "2", "]"}], "]"}], ",", 
              RowBox[{"#", "[", 
               RowBox[{"[", "3", "]"}], "]"}]}], "}"}], "&"}]}], "]"}]}], ";",
         "\[IndentingNewLine]", 
        RowBox[{"GridQuantity", "=", 
         RowBox[{
          RowBox[{"tablegrid1", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "1"}], "]"}], "]"}], "//", 
          "DeleteDuplicates"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"LengthPerVariable", "=", 
         RowBox[{
          RowBox[{"Length", "[", "tablegrid1", "]"}], "/", 
          RowBox[{"Length", "[", "GridQuantity", "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"tab1", "=", 
         RowBox[{"NdiffCompiled", "[", 
          RowBox[{
          "tablegrid1", ",", "GridQuantity", ",", "LengthPerVariable", ",", 
           RowBox[{"NpotTimes\[Chi]val", "*", "brvis"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"tab1", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", 
             RowBox[{"{", "1", "}"}]}], "]"}], "]"}], ",", 
          RowBox[{"Partition", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"tab1", "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", "2"}], "]"}], "]"}], "*", 
             SuperscriptBox["\[CapitalDelta]xval", 
              RowBox[{"-", "1"}]]}], ",", "1"}], "]"}], ",", "2"}], "]"}]}]}],
       "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"NeventsDifferentialDiscret", "[", 
      RowBox[{"m_", ",", "coupling_", ",", "Variable_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "NdiffInt", ",", "LegendList", ",", "QuantityMinMax", ",", 
         "ValueMinMax"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"prodlisttemp", "=", 
         RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Do", "[", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Max", "[", 
              RowBox[{
               RowBox[{"mLLPmin", "[", "prod", "]"}], ",", "mmin\[Epsilon]"}],
               "]"}], "<", "m", "<", 
             RowBox[{"Min", "[", 
              RowBox[{
               RowBox[{"mLLPmax", "[", "prod", "]"}], ",", "mmax\[Epsilon]"}],
               "]"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"prodlisttemp", "=", 
              RowBox[{"Join", "[", 
               RowBox[{"prodlisttemp", ",", 
                RowBox[{"{", "prod", "}"}]}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"NdiffData", "[", "prod", "]"}], "=", 
              RowBox[{"NeventsDifferentialDiscretProd", "[", 
               RowBox[{"m", ",", "prod", ",", "coupling", ",", "Variable"}], 
               "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"XvalminmaxNdiff", "=", 
              RowBox[{
               RowBox[{
                RowBox[{"Select", "[", 
                 RowBox[{
                  RowBox[{"NdiffData", "[", "prod", "]"}], ",", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ">", 
                    SuperscriptBox["10", 
                    RowBox[{"-", "40"}]]}], "&"}]}], "]"}], "[", 
                RowBox[{"[", 
                 RowBox[{"All", ",", "1"}], "]"}], "]"}], "//", "MinMax"}]}], 
             ";", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"NdiffInt", "[", 
               RowBox[{"X_", ",", "prod"}], "]"}], "=", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"XvalminmaxNdiff", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "<", "X", "<", 
                 RowBox[{"XvalminmaxNdiff", "[", 
                  RowBox[{"[", "2", "]"}], "]"}]}], ",", 
                RowBox[{"Evaluate", "[", 
                 RowBox[{"10", "^", 
                  RowBox[{
                   RowBox[{"Interpolation", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Log10", "[", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Log10", "[", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "+", 
                    SuperscriptBox["10", 
                    RowBox[{"-", "90"}]]}], "]"}]}], "}"}], "&"}], "/@", 
                    RowBox[{"NdiffData", "[", "prod", "]"}]}], ",", 
                    RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[", 
                   RowBox[{"Log10", "[", "X", "]"}], "]"}]}], "]"}], ",", 
                "0"}], "]"}]}]}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"prod", ",", "ProductionList"}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"NdiffInt", "[", 
          RowBox[{"X_", ",", "\"\<Total\>\""}], "]"}], "=", 
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{"NdiffInt", "[", 
            RowBox[{"X", ",", "prod"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"prod", ",", "prodlisttemp"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"LegendList", "=", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"{", "\"\<Total\>\"", "}"}], ",", "prodlisttemp"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"QuantityMinMax", "=", 
         RowBox[{
          RowBox[{"Flatten", "[", 
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"MinMax", "[", 
               RowBox[{
                RowBox[{"NdiffData", "[", "prod", "]"}], "[", 
                RowBox[{"[", 
                 RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"prod", ",", "prodlisttemp"}], "}"}]}], "]"}], ",", 
            "1"}], "]"}], "//", "MinMax"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"ValueMinMax", "=", 
         RowBox[{"Max", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Max", "[", 
             RowBox[{
              RowBox[{"NdiffData", "[", "#", "]"}], "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}], "&"}], "/@", 
           "prodlisttemp"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"NdiffInt", "[", 
             RowBox[{"X", ",", "prod"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"prod", ",", "LegendList"}], "}"}]}], "]"}], ",", 
          "LegendList", ",", "QuantityMinMax", ",", "ValueMinMax"}], 
         "}"}]}]}], "\[IndentingNewLine]", "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"mvaltest", "=", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"FacilityGivenExperiment", "==", "\"\<ESS\>\""}], ",", "0.04", 
       ",", "0.25"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"couplingvaltest", "=", 
     RowBox[{"(*", 
      RowBox[{"1.4", 
       RowBox[{"LowerBoundEstimate", "[", 
        RowBox[{"mvaltest", ",", "\"\<Pi0\>\""}], "]"}]}], "*)"}], 
     SqrtBox[
      FractionBox[
       RowBox[{"c\[Tau]LLP", "[", 
        RowBox[{"mvaltest", ",", "1"}], "]"}], "0.003"]]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"quantity", "=", "\"\<\!\(\*SubscriptBox[\(E\), \(X\)]\)\>\""}], ";",
     "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"NdiffTab", "[", "X_", "]"}], ",", "LegendList", ",", 
       "QuantityMinMax", ",", "ValueMinMax"}], "}"}], "=", 
     RowBox[{"NeventsDifferentialDiscret", "[", 
      RowBox[{"mvaltest", ",", "couplingvaltest", ",", "quantity"}], "]"}]}], 
    ";", "\[IndentingNewLine]", 
    RowBox[{"Do", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"prch", "=", 
        RowBox[{"LegendList", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"NdiffInt", "[", 
         RowBox[{"X_", ",", "prch"}], "]"}], "=", 
        RowBox[{
         RowBox[{"NdiffTab", "[", "X", "]"}], "[", 
         RowBox[{"[", "i", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", 
        RowBox[{"Length", "[", "LegendList", "]"}]}], "}"}]}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"plotdiff", "=", 
     RowBox[{"LogLogPlot", "[", 
      RowBox[{
       RowBox[{"Evaluate", "[", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"NdiffInt", "[", 
           RowBox[{"X", ",", "prod"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"prod", ",", "LegendList"}], "}"}]}], "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"X", ",", 
         RowBox[{"QuantityMinMax", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", 
         RowBox[{"QuantityMinMax", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"Frame", "\[Rule]", "True"}], ",", 
       RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
       RowBox[{"PlotRange", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"All", ",", 
          RowBox[{"{", 
           RowBox[{
            SuperscriptBox["10", 
             RowBox[{"-", "5"}]], ",", 
            RowBox[{"4", "ValueMinMax"}]}], "}"}]}], "}"}]}], ",", 
       RowBox[{"PlotStyle", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"Thick", ",", "Black"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"Thick", ",", "Blue"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"Thick", ",", 
            RowBox[{"Darker", "@", "Red"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"Thick", ",", 
            RowBox[{"Darker", "@", 
             RowBox[{"Darker", "@", "Green"}]}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"Thick", ",", 
            RowBox[{"Darker", "@", "Cyan"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"Thick", ",", "Magenta"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"Thick", ",", "Blue", ",", 
            RowBox[{"Dashing", "[", "0.02", "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"Thick", ",", 
            RowBox[{"Darker", "@", "Red"}], ",", 
            RowBox[{"Dashing", "[", "0.02", "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"Thick", ",", 
            RowBox[{"Darker", "@", 
             RowBox[{"Darker", "@", "Green"}]}], ",", 
            RowBox[{"Dashing", "[", "0.02", "]"}]}], "}"}]}], "}"}]}], ",", 
       RowBox[{"PlotLegends", "\[Rule]", 
        RowBox[{"Placed", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Style", "[", 
             RowBox[{"#", ",", "20"}], "]"}], "&"}], "/@", "LegendList"}], ",",
           "Right"}], "]"}]}], ",", 
       RowBox[{"FrameLabel", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"LegendX", "[", "quantity", "]"}], " ", ",", 
          RowBox[{"LegendY", "[", "quantity", "]"}]}], "}"}]}], ",", 
       RowBox[{"FrameStyle", "\[Rule]", 
        RowBox[{"Directive", "[", 
         RowBox[{"Black", ",", " ", "18"}], "]"}]}], ",", 
       RowBox[{"PlotLabel", "\[Rule]", 
        RowBox[{"Style", "[", 
         RowBox[{
          RowBox[{"Row", "[", 
           RowBox[{"{", 
            RowBox[{
            "SelectedExperiment", 
             ",", "\"\<. \!\(\*SubscriptBox[\(m\), \(a\)]\) = \>\"", ",", 
             "mvaltest", 
             ",", "\"\< GeV, \!\(\*SubscriptBox[\(g\), \(a\)]\) = \>\"", ",", 
             RowBox[{"couplingvaltest", "//", "N"}], ",", 
             " ", "\"\< \!\(\*SuperscriptBox[\(GeV\), \(-1\)]\)\>\""}], "}"}],
            "]"}], ",", "14", ",", "Black"}], "]"}]}]}], "]"}]}]}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.8921163996135225`*^9, 3.8921164016036096`*^9}, {
   3.8921164560955544`*^9, 3.892116475031265*^9}, {3.892116516434699*^9, 
   3.8921165782759094`*^9}, {3.8921166461579666`*^9, 
   3.8921166470109124`*^9}, {3.8921167042134895`*^9, 3.892116729930051*^9}, {
   3.8927049818255663`*^9, 3.8927049991222277`*^9}, {3.8929115471019087`*^9, 
   3.892911593659387*^9}, {3.8929721720425777`*^9, 3.892972173350433*^9}, {
   3.8929722208773427`*^9, 3.8929722211847763`*^9}, {3.8932578131000147`*^9, 
   3.893257813645747*^9}, {3.8934746693595037`*^9, 3.893474675301323*^9}, {
   3.8935154039618015`*^9, 3.893515450284458*^9}, {3.893515943430369*^9, 
   3.893515962817915*^9}, 3.893516005738713*^9, {3.893516036174548*^9, 
   3.893516050479193*^9}, {3.893516088577403*^9, 3.893516089018369*^9}, {
   3.893516189974946*^9, 3.8935161902213464`*^9}, {3.8935162352543807`*^9, 
   3.8935162734266047`*^9}, {3.893516595793399*^9, 3.893516611219179*^9}, {
   3.893606026577932*^9, 3.8936060575609436`*^9}, 3.8955578364377675`*^9, {
   3.8969794021337876`*^9, 3.89697940417612*^9}, {3.897206579842867*^9, 
   3.897206594529684*^9}, {3.8972085445254173`*^9, 3.8972085493347607`*^9}, {
   3.897208919899889*^9, 3.897208931547951*^9}, {3.897232355781791*^9, 
   3.8972323557889285`*^9}, {3.897232650441552*^9, 3.8972326556138897`*^9}, {
   3.8972334458167295`*^9, 3.8972334518776407`*^9}, {3.8972337389260225`*^9, 
   3.8972337484870095`*^9}, {3.8972341759970245`*^9, 3.8972341805239077`*^9}, 
   3.9027273711383595`*^9, 3.903790322052125*^9, 3.9037911184037747`*^9, {
   3.90379388260617*^9, 3.90379391368436*^9}, {3.903793985440897*^9, 
   3.9037939966975904`*^9}, {3.903806138641766*^9, 3.9038061415710564`*^9}, {
   3.9049234022965193`*^9, 3.904923404719922*^9}, {3.9049234552044992`*^9, 
   3.9049234557077*^9}, {3.905241298600586*^9, 3.905241322456391*^9}, 
   3.9138675833998885`*^9, {3.9138682129108057`*^9, 3.9138682129163513`*^9}, {
   3.9138687734647865`*^9, 3.9138687783481526`*^9}, {3.913868990884107*^9, 
   3.9138689908925776`*^9}, 3.9138690440046268`*^9, {3.913871804520094*^9, 
   3.9138718176925616`*^9}, {3.913874095556819*^9, 3.913874098948403*^9}, {
   3.913877232309046*^9, 3.91387723268427*^9}, {3.9138796546092234`*^9, 
   3.91387965462405*^9}, {3.913881645619234*^9, 3.913881646128089*^9}, {
   3.9138817045526066`*^9, 3.9138817092702045`*^9}, {3.9144962634466343`*^9, 
   3.9144962636579084`*^9}, {3.9156429967325897`*^9, 
   3.9156429967532835`*^9}, {3.916289412312564*^9, 3.9162896164655113`*^9}, {
   3.9162896759598684`*^9, 3.916289806201638*^9}, 3.9163945964185715`*^9, {
   3.916395341223231*^9, 3.916395345479702*^9}, {3.9163954358459415`*^9, 
   3.9163954767547026`*^9}, 3.9165075760329185`*^9, 3.9165076364486437`*^9, {
   3.91650772903246*^9, 3.9165077581477613`*^9}, {3.9165115197870893`*^9, 
   3.9165115201957626`*^9}, {3.9165121382558374`*^9, 3.916512144983124*^9}, {
   3.9165122548977995`*^9, 3.916512283348137*^9}, {3.916646757115737*^9, 
   3.9166467592929344`*^9}, {3.9166522557787485`*^9, 
   3.9166522558053775`*^9}, {3.9166523064422693`*^9, 3.916652334289917*^9}, {
   3.9166523647214184`*^9, 3.9166523682142267`*^9}, {3.916671870619074*^9, 
   3.9166718709492345`*^9}, {3.916806658633277*^9, 3.916806668135779*^9}, {
   3.9168067803874235`*^9, 3.916806799378209*^9}, {3.916808236354084*^9, 
   3.9168082409159656`*^9}, 3.9168549870353823`*^9, 3.945358056887644*^9, {
   3.945358116004587*^9, 3.9453581410336647`*^9}, {3.9506904400091934`*^9, 
   3.950690455486986*^9}},
 CellTags->"Number-of-events-computation+sensitivity",
 CellLabel->
  "In[380]:=",ExpressionUUID->"4978bbd4-63cc-4b59-ac79-ded561ee9c78"]
}, Closed]]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Tests", "Chapter",
 CellChangeTimes->{{3.951469534937914*^9, 
  3.9514695372752934`*^9}},ExpressionUUID->"421b5663-9f38-a446-82c9-\
dfcc3e9f6602"],

Cell[CellGroupData[{

Cell["Total number of events", "Section",
 CellChangeTimes->{{3.8972012736109533`*^9, 3.897201275449023*^9}, {
   3.9165074771770973`*^9, 3.916507477391102*^9}, {3.916679238462612*^9, 
   3.9166792396390915`*^9}, 
   3.9514695448489876`*^9},ExpressionUUID->"f794792d-e057-42b4-9ecc-\
1e217fb91113"],

Cell[BoxData[
 RowBox[{"If", "[", 
  RowBox[{"condcontinue", ",", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "This", " ", "is", " ", "a", " ", "comparison", " ", "between", " ", 
      "the", " ", "slow", " ", "and", " ", "fast", " ", "integration", " ", 
      RowBox[{"methods", ".", " ", "For"}], " ", "the", " ", "selected", " ", 
      "mass", " ", "and", " ", "production", " ", "channel"}], ",", " ", 
     RowBox[{
     "the", " ", "numbers", " ", "of", " ", "events", " ", "obtained", " ", 
      "using", " ", "the", " ", "methods", " ", "should", " ", "agree", " ", 
      "within", " ", "10", "%"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"If", " ", "the", " ", "agreement", " ", "is", " ", "worse"}], ",",
      " ", 
     RowBox[{
     "there", " ", "may", " ", "be", " ", "a", " ", "few", " ", "reasons"}]}],
     "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"1", ")"}], " ", "The", " ", "grid", " ", "for", " ", "the", " ",
       "fast", " ", "method", " ", "is", " ", "not", " ", "dense", " ", 
      RowBox[{"enough", ".", " ", "Try"}], " ", "to", " ", "increase", " ", 
      "the", " ", "grid", " ", "density", " ", 
      RowBox[{"(", 
       RowBox[{
       "OutGrid\[Theta]final", ",", " ", "OutGridEfinal", ",", " ", 
        "OutGridzfinal"}], ")"}], " ", "to", " ", "see", " ", "whether", " ", 
      "the", " ", "agreement", " ", 
      RowBox[{"improves", ".", " ", "Sometimes"}]}], ",", " ", 
     RowBox[{
     "even", " ", "a", " ", "slightly", " ", "denser", " ", "grid", " ", 
      "for", " ", 
      RowBox[{"e", ".", "g", ".", " ", "z"}], " ", "may", " ", "lead", " ", 
      "to", " ", "a", " ", "significant", " ", "improvement", " ", "in", " ", 
      "the", " ", "agrement"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"2", ")"}], " ", "The", " ", "Monte"}], "-", 
       RowBox[{
       "Carlo", " ", "integrator", " ", "for", " ", "the", " ", "slow", " ", 
        "method", " ", "fails", " ", "to", " ", "evaluate", " ", 
        "properly"}]}], ";", " ", 
      RowBox[{
      "this", " ", "may", " ", "happen", " ", "if", " ", "the", " ", "range", 
       " ", "of", " ", "the", " ", "integration", " ", "over", " ", 
       "energies", " ", "is", " ", "too", " ", "large", " ", "compared", " ", 
       "to", " ", "the", " ", "domain", " ", "where", " ", "most", " ", "of", 
       " ", "the", " ", "events", " ", "actually", " ", "are", " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"off", "-", 
          RowBox[{
          "axis", " ", "experiments", " ", "such", " ", "as", " ", "MATHUSLA",
            " ", "and", " ", "ANUBIS"}]}], ")"}], ".", " ", "Another"}], " ", 
       "symptom", " ", "is", " ", "that", " ", "for", " ", "the", " ", 
       "given", " ", "mass", " ", "and", " ", "coupling", " ", "the", " ", 
       "integral", " ", "\"\<jumps\>\""}]}], ",", " ", 
     RowBox[{"i", ".", "e", "."}], ",", " ", 
     RowBox[{
     "returns", " ", "values", " ", "with", " ", "large", " ", "error"}]}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "A", " ", "separate", " ", "discussion", " ", "should", " ", "be", " ", 
      "made", " ", "for", " ", "the", " ", "couplings", " ", "belong", " ", 
      "to", " ", "the", " ", "domain", " ", "c\[Tau]", " ", "\[Gamma]", " ", 
      RowBox[{
       RowBox[{"<<", " ", 
        SubscriptBox["z", "experiment"]}], ".", " ", "The"}], " ", 
      "discrepancy", " ", "may", " ", "be", " ", "significant"}], ",", " ", 
     RowBox[{
     "and", " ", "the", " ", "reason", " ", "is", " ", "insufficient", " ", 
      "grid", " ", "density", " ", "for", " ", "the", " ", "fast", " ", 
      "integration", " ", 
      RowBox[{"method", ".", " ", "However"}]}], ",", " ", 
     RowBox[{
     "due", " ", "to", " ", "the", " ", "exponential", " ", "suppression", " ",
       "of", " ", "the", " ", "number", " ", "of", " ", "events"}], ",", " ", 
     RowBox[{
     "this", " ", "may", " ", "be", " ", "compensated", " ", "by", " ", "a", " ",
       "tiny", " ", "shift", " ", "in", " ", "the", " ", "coupling"}], ",", 
     " ", 
     RowBox[{
     "so", " ", "the", " ", "discrepancy", " ", "should", " ", "be", " ", 
      "considered", " ", "as", " ", 
      RowBox[{"appropriate", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"mtest", "=", 
     RowBox[{"Max", "[", 
      RowBox[{"0.1", ",", 
       RowBox[{"1.2", "*", "mmin\[Epsilon]"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"ProdTest", "=", "\"\<Pi0\>\""}], ";", "\[IndentingNewLine]", 
    RowBox[{"couplinglist", "=", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         SuperscriptBox["10", 
          RowBox[{"-", "12"}]], ",", 
         RowBox[{"3", "*", 
          SuperscriptBox["10", 
           RowBox[{"-", "12"}]]}], ",", 
         RowBox[{"5", "*", 
          SuperscriptBox["10", 
           RowBox[{"-", "12"}]]}], ",", 
         SuperscriptBox["10", 
          RowBox[{"-", "11"}]], ",", 
         RowBox[{"5", "*", 
          SuperscriptBox["10", 
           RowBox[{"-", "11"}]]}], ",", 
         SuperscriptBox["10", 
          RowBox[{"-", "10"}]], ",", 
         RowBox[{"5", "*", 
          SuperscriptBox["10", 
           RowBox[{"-", "10"}]]}], ",", 
         SuperscriptBox["10", 
          RowBox[{"-", "9"}]], ",", 
         RowBox[{"5", "*", 
          SuperscriptBox["10", 
           RowBox[{"-", "9"}]]}], ",", 
         SuperscriptBox["10", 
          RowBox[{"-", "8"}]], ",", 
         RowBox[{"2", "*", 
          SuperscriptBox["10", 
           RowBox[{"-", "8"}]]}], ",", 
         RowBox[{"4", "*", 
          SuperscriptBox["10", 
           RowBox[{"-", "8"}]]}], ",", 
         SuperscriptBox["10", 
          RowBox[{"-", "7"}]], ",", 
         RowBox[{"5", "*", 
          SuperscriptBox["10", 
           RowBox[{"-", "7"}]]}], ",", 
         RowBox[{"6", "*", 
          SuperscriptBox["10", 
           RowBox[{"-", "7"}]]}], ",", 
         RowBox[{"7", "*", 
          SuperscriptBox["10", 
           RowBox[{"-", "7"}]]}], ",", 
         RowBox[{"8", "*", 
          SuperscriptBox["10", 
           RowBox[{"-", "7"}]]}], ",", 
         RowBox[{"9", "*", 
          SuperscriptBox["10", 
           RowBox[{"-", "7"}]]}], ",", 
         SuperscriptBox["10", 
          RowBox[{"-", "6"}]], ",", 
         RowBox[{"2", "*", 
          SuperscriptBox["10", 
           RowBox[{"-", "6"}]]}]}], "}"}], "//", "N"}], "*)"}], 
     RowBox[{"Table", "[", 
      RowBox[{
       SuperscriptBox["10", "x"], ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", 
         RowBox[{"-", "7.5"}], ",", 
         RowBox[{"-", "0.3"}], ",", "0.1"}], "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"dat1", "=", 
     RowBox[{"NeventsDiscret", "[", 
      RowBox[{"mtest", ",", "ProdTest", ",", "couplinglist"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"dat2", "=", 
     RowBox[{"ParallelTable", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"couplinglist", "[", 
          RowBox[{"[", "i", "]"}], "]"}], ",", 
         RowBox[{"c\[Tau]LLP", "[", 
          RowBox[{"mtest", ",", 
           RowBox[{"couplinglist", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
         RowBox[{"NeventsInt", "[", 
          RowBox[{"mtest", ",", 
           RowBox[{"couplinglist", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", "ProdTest"}], "]"}]}], "}"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "couplinglist", "]"}], ",", "1"}], "}"}]}], 
      "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"\"\<\!\(\*FractionBox[SubscriptBox[\(m\), \(LLP\)], \
\(GeV\)]\)\>\"", ",", "\"\<coupling\>\"", 
          ",", "\"\<\!\(\*FractionBox[\(c\[Tau]\), SubscriptBox[\(z\), \
\(min\)]]\)\>\"", ",", "\"\<\!\(\*SubscriptBox[\(N\), \(events, fast\)]\)\>\"",
           ",", "\"\<\!\(\*SubscriptBox[\(N\), \(events, slow\)]\)\>\""}], 
         "}"}], "}"}], ",", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"dat1", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", "2"}], "}"}]}], "]"}], "]"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            FractionBox[
             RowBox[{"#", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "zminExp"], "}"}], "&"}], "/@", 
          "dat2"}], ",", 
         RowBox[{"dat1", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", 
            RowBox[{"{", "3", "}"}]}], "]"}], "]"}], ",", 
         RowBox[{"dat2", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", 
            RowBox[{"{", "3", "}"}]}], "]"}], "]"}], ",", "2"}], "]"}]}], 
      "]"}], "//", "TableForm"}]}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.892111330393669*^9, 3.8921113703258653`*^9}, {
   3.8921114855521097`*^9, 3.8921114891326914`*^9}, {3.8921115909252915`*^9, 
   3.89211160107533*^9}, {3.892112023350475*^9, 3.8921120715940514`*^9}, {
   3.8921121043874707`*^9, 3.892112190091645*^9}, {3.892112748834139*^9, 
   3.892112748933666*^9}, {3.8921130465455704`*^9, 3.8921130470314426`*^9}, {
   3.8921131989548674`*^9, 3.8921131992395306`*^9}, {3.892113256325259*^9, 
   3.892113256434625*^9}, {3.892113458241603*^9, 3.8921135323303742`*^9}, {
   3.892116361437076*^9, 3.8921163614848557`*^9}, {3.893257780692194*^9, 
   3.893257792940939*^9}, {3.893260545232792*^9, 3.893260566765787*^9}, {
   3.896953530728937*^9, 3.896953531233162*^9}, {3.896953744363188*^9, 
   3.8969537469343243`*^9}, {3.896953883310589*^9, 3.896953884008139*^9}, {
   3.896971240286153*^9, 3.896971246695673*^9}, {3.8969733757056828`*^9, 
   3.896973378633896*^9}, {3.8969760731711082`*^9, 3.896976348233163*^9}, {
   3.8969763786206193`*^9, 3.896976403680397*^9}, {3.8969764343671703`*^9, 
   3.8969764672032614`*^9}, 3.8972088334478965`*^9, 3.8972326136604834`*^9, 
   3.897233424756247*^9, 3.8972340704293666`*^9, {3.9037938624346867`*^9, 
   3.9037938636976957`*^9}, {3.9049233552208714`*^9, 
   3.9049233846445026`*^9}, {3.905233491599722*^9, 3.9052334916831083`*^9}, {
   3.9104192195014668`*^9, 3.910419220919059*^9}, {3.910437157740117*^9, 
   3.910437198942398*^9}, 3.913866752244583*^9, 3.913867583374674*^9, {
   3.913869518281082*^9, 3.9138695346166315`*^9}, {3.9138740675789223`*^9, 
   3.9138740809976482`*^9}, {3.91387681476606*^9, 3.9138768200447187`*^9}, {
   3.9138810373100653`*^9, 3.913881064778409*^9}, 3.913881099289591*^9, 
   3.913881550640315*^9, {3.913881585879263*^9, 3.9138815982880993`*^9}, {
   3.913881660929047*^9, 3.91388166133914*^9}, {3.914496761652851*^9, 
   3.9144967641801987`*^9}, {3.9144968071881685`*^9, 3.91449701363063*^9}, {
   3.9144970517823005`*^9, 3.9144971085541267`*^9}, 3.914514827811349*^9, {
   3.9156429967004967`*^9, 3.9156429967030597`*^9}, {3.9158780985312195`*^9, 
   3.915878110222004*^9}, {3.9166522557553015`*^9, 3.9166522557722254`*^9}, {
   3.916824118216333*^9, 3.9168241211804395`*^9}, {3.91682416023182*^9, 
   3.916824160993893*^9}, {3.9506904702526283`*^9, 
   3.950690479150984*^9}},ExpressionUUID->"3698028a-a816-4e62-b33a-\
d297be011465"]
}, Closed]]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Exporting tabulated number of events", "Title",
 CellChangeTimes->{{3.8850207904521627`*^9, 3.885020796464762*^9}},
 CellTags->
  "Number-of-events-computation+sensitivity",ExpressionUUID->"f5136f97-573d-\
41ec-bafe-cbcb903e581e"],

Cell[CellGroupData[{

Cell["Definitions", "Chapter",
 CellChangeTimes->{{3.8850542017641125`*^9, 3.885054203349573*^9}},
 CellTags->
  "Number-of-events-computation+sensitivity",ExpressionUUID->"75cf786b-3cae-\
4471-be7d-a8f2b6c6b657"],

Cell[BoxData[
 RowBox[{"If", "[", 
  RowBox[{"condcontinue", ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"directory", "[", "\"\<Nevents\>\"", "]"}], "=", 
     RowBox[{"FileNameJoin", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"NotebookDirectory", "[", "]"}], 
        ",", "\"\<Tabulated Nevents\>\""}], "}"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"directory", "[", "\"\<Nevents-LLP\>\"", "]"}], "=", 
     RowBox[{"FileNameJoin", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"NotebookDirectory", "[", "]"}], 
        ",", "\"\<Tabulated Nevents\>\"", ",", "LLPdirName"}], "}"}], "]"}]}],
     ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"directory", "[", "\"\<Nevents-LLP-experiment\>\"", "]"}], "=", 
     RowBox[{"FileNameJoin", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"NotebookDirectory", "[", "]"}], 
        ",", "\"\<Tabulated Nevents\>\"", ",", "LLPdirName", ",", 
        "SelectedExperiment"}], "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"!", 
         RowBox[{"DirectoryQ", "[", 
          RowBox[{"directory", "[", "#", "]"}], "]"}]}], ",", 
        RowBox[{"CreateDirectory", "[", 
         RowBox[{"directory", "[", "#", "]"}], "]"}]}], "]"}], "&"}], "/@", 
     RowBox[{"{", 
      RowBox[{"\"\<Nevents\>\"", ",", "\"\<Nevents-LLP\>\"", 
       ",", "\"\<Nevents-LLP-experiment\>\""}], "}"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
    "Print", "[", "\"\<Filenames with tabulated \!\(\*SubscriptBox[\(N\), \
\(events\)]\):\>\"", "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"Do", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"FilenameNeventsInt", "[", "prod", "]"}], "=", 
       RowBox[{"ToString", "@", 
        RowBox[{"StringForm", "[", 
         RowBox[{"\"\<Nevents_``_``_at_``_Npot=``_decayDescr=``.dat\>\"", ",", 
          RowBox[{"Sequence", "@@", 
           RowBox[{"{", 
            RowBox[{"LLPdirName", ",", "prod", ",", "SelectedExperiment", ",", 
             RowBox[{
              RowBox[{"NpotGivenExperiment", "//", "CForm"}], "//", 
              "ToString"}], ",", "SelectedDescr"}], "}"}]}]}], "]"}]}]}], 
      "\[IndentingNewLine]", ",", 
      RowBox[{"{", 
       RowBox[{"prod", ",", "ProductionList"}], "}"}]}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"mRangeExport", "[", "prod", "]"}], "=", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "0.021", ",", "0.025", ",", "0.03", ",", "0.035", ",", "0.04", ",", 
           "0.045", ",", "0.05", ",", "0.055", ",", "0.06", ",", "0.065", ",",
            "0.07", ",", "0.08", ",", "0.09", ",", "0.1", ",", "0.11", ",", 
           "0.12", ",", "0.13", ",", "0.15", ",", "0.2", ",", "0.22", ",", 
           "0.25", ",", "0.3", ",", "0.35", ",", "0.4", ",", "0.5", ",", 
           "0.55", ",", "0.6", ",", "0.7", ",", "0.8", ",", "0.9", ",", "1", ",",
            "1.1", ",", "1.2", ",", "1.25", ",", "1.3", ",", "1.35", ",", 
           "1.4", ",", "1.43", ",", "1.46", ",", "1.5", ",", "1.55", ",", 
           "1.6", ",", "1.7", ",", "1.8", ",", "1.9", ",", "2.", ",", "2.1", ",",
            "2.2", ",", "2.3", ",", "2.4", ",", "2.5", ",", "2.6", ",", "2.7",
            ",", "2.8", ",", "2.9", ",", "3.", ",", "3.1", ",", "3.2", ",", 
           "3.3", ",", "3.4", ",", "3.5", ",", "3.6", ",", "3.7", ",", "3.8", 
           ",", "3.9", ",", "4.", ",", "4.1", ",", "4.2", ",", "4.3"}], "}"}],
          "//", "N"}]}], ";"}], "\[IndentingNewLine]", ",", 
      RowBox[{"{", 
       RowBox[{"prod", ",", "ProductionList"}], "}"}]}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"couplingsRangeExport", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       SuperscriptBox["10", "x"], ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", 
         RowBox[{"-", "12"}], ",", 
         RowBox[{"-", "2"}], ",", "0.02"}], "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"FilenameNeventsInt", "[", "#", "]"}], "&"}], "/@", 
     "ProductionList"}]}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.8850528402073092`*^9, 3.885052964529935*^9}, {
   3.8850529967024455`*^9, 3.88505313318991*^9}, {3.885053172661522*^9, 
   3.885053247354876*^9}, {3.885053717249408*^9, 3.8850537696983976`*^9}, {
   3.885054057416253*^9, 3.88505420740788*^9}, {3.8850542428480587`*^9, 
   3.885054257815028*^9}, {3.885054905514982*^9, 3.885054927992525*^9}, {
   3.88523276755499*^9, 3.885232776819412*^9}, {3.8854556204578223`*^9, 
   3.8854556494874506`*^9}, {3.8854560165278835`*^9, 
   3.8854561921232824`*^9}, {3.8854563516684437`*^9, 
   3.8854563631681647`*^9}, {3.885456439233843*^9, 3.885456605782855*^9}, {
   3.8854567400235205`*^9, 3.885456743964001*^9}, {3.885542660052145*^9, 
   3.8855427304549437`*^9}, {3.8855427881537523`*^9, 3.885542788237467*^9}, {
   3.8855430067620525`*^9, 3.885543013668437*^9}, {3.8857456752104797`*^9, 
   3.885745675220516*^9}, 3.8857460313253775`*^9, {3.8857468048699565`*^9, 
   3.8857468161665335`*^9}, {3.8857474466697216`*^9, 
   3.8857476005522413`*^9}, {3.8857504900473185`*^9, 3.885750492099847*^9}, {
   3.8858392383072577`*^9, 3.885839268137461*^9}, {3.892272862562935*^9, 
   3.892272925699341*^9}, {3.8922787139487624`*^9, 3.8922787801349196`*^9}, 
   3.892912334270548*^9, {3.89357085256485*^9, 3.893570861922758*^9}, {
   3.8937513515804434`*^9, 3.893751363168453*^9}, {3.895053205775363*^9, 
   3.895053229421281*^9}, {3.8950733209828496`*^9, 3.8950733232675557`*^9}, {
   3.8950740100492163`*^9, 3.895074016358959*^9}, {3.8950743743876824`*^9, 
   3.895074379025027*^9}, {3.8950745100163155`*^9, 3.8950745111007185`*^9}, {
   3.8950753328296204`*^9, 3.8950753333236*^9}, {3.8951282997797675`*^9, 
   3.8951283720189056`*^9}, {3.902764082511567*^9, 3.9027640831394043`*^9}, {
   3.9146579534213157`*^9, 3.9146579534213157`*^9}, {3.914658986289012*^9, 
   3.914659031781306*^9}, {3.915643004922907*^9, 3.9156430049395905`*^9}, {
   3.916806886517645*^9, 3.9168068878369913`*^9}, {3.9506904872767677`*^9, 
   3.9506905347087574`*^9}, {3.952013966761305*^9, 3.952013978397463*^9}, {
   3.9520141023458767`*^9, 3.95201411724646*^9}},
 CellTags->"Number-of-events-computation+sensitivity",
 CellLabel->
  "In[504]:=",ExpressionUUID->"7723a626-82c5-4cfa-9029-8486e71b92ea"]
}, Closed]],

Cell[CellGroupData[{

Cell["Exporting", "Chapter",
 CellChangeTimes->{{3.885054212114191*^9, 3.885054213032151*^9}},
 CellTags->
  "Number-of-events-computation+sensitivity",ExpressionUUID->"df5e70ae-73d2-\
4cb0-8325-e3fe55e2f51a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{"condcontinue", ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"BlockExport", "[", "ProdChannel_", "]"}], ":=", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", "mlist", "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"mlist", "=", 
          RowBox[{"mRangeExport", "[", "ProdChannel", "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"TabFrom", "=", 
          RowBox[{"ParallelTable", "[", 
           RowBox[{
            RowBox[{"Quiet", "[", 
             RowBox[{"NeventsDiscret", "[", 
              RowBox[{
               RowBox[{"mlist", "[", 
                RowBox[{"[", "k", "]"}], "]"}], ",", "ProdChannel", ",", 
               "couplingsRangeExport"}], "]"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"k", ",", "1", ",", 
              RowBox[{"Length", "[", "mlist", "]"}], ",", "1"}], "}"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"Export", "[", 
          RowBox[{
           RowBox[{"FileNameJoin", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
              "directory", "[", "\"\<Nevents-LLP-experiment\>\"", "]"}], ",", 
              RowBox[{"FilenameNeventsInt", "[", "ProdChannel", "]"}]}], 
             "}"}], "]"}], ",", 
           RowBox[{"Flatten", "[", 
            RowBox[{"TabFrom", ",", "1"}], "]"}], ",", "\"\<Table\>\""}], 
          "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Monitor", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"prod", "=", 
           RowBox[{"ProductionList", "[", 
            RowBox[{"[", "j", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"BlockExport", "[", "prod", "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", 
           RowBox[{"Length", "[", "ProductionList", "]"}], ",", "1"}], 
          "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Row", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"ProgressIndicator", "[", 
           RowBox[{"j", ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", 
              RowBox[{"Length", "[", "ProductionList", "]"}]}], "}"}]}], 
           "]"}], ",", "\"\< Production mode = \>\"", ",", 
          RowBox[{"ProductionList", "[", 
           RowBox[{"[", "j", "]"}], "]"}], ",", "\"\< (\>\"", ",", " ", "j", 
          ",", "\"\</\>\"", ",", 
          RowBox[{"Length", "[", "ProductionList", "]"}], ",", "\"\<)\>\""}], 
         "}"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"icounter", ">", 
         RowBox[{"Length", "[", "SelectedExperimentList", "]"}]}], "&&", 
        "sensComp"}], ",", 
       RowBox[{"BlockEvaluation", "[", "\"\<Sensitivity\>\"", "]"}]}], 
      "]"}]}]}], "\[IndentingNewLine]", "]"}], "//", 
  "AbsoluteTiming"}]], "Input",
 CellChangeTimes->{{3.8921886102299604`*^9, 3.892188661864987*^9}, {
   3.892188696661598*^9, 3.892188782889353*^9}, {3.8921888713769283`*^9, 
   3.8921888914281387`*^9}, {3.892190937661848*^9, 3.8921909466626697`*^9}, {
   3.8922765048644934`*^9, 3.8922765048725324`*^9}, {3.892541051864915*^9, 
   3.8925411081031237`*^9}, {3.8925422299627275`*^9, 
   3.8925422591259813`*^9}, {3.892542627960807*^9, 3.8925426356350746`*^9}, {
   3.8927104746862555`*^9, 3.892710508465253*^9}, {3.8950703812229633`*^9, 
   3.895070389767537*^9}, 3.9027274561413517`*^9, {3.9037911184286413`*^9, 
   3.90379111843118*^9}, 3.9037940600873704`*^9, 3.9138695182916346`*^9, {
   3.9138696778224015`*^9, 3.9138697217311115`*^9}, {3.9146665986081*^9, 
   3.9146665993307805`*^9}, 3.9156430049482603`*^9, {3.9166721783872075`*^9, 
   3.916672195717476*^9}, {3.95069054643058*^9, 3.9506905981695805`*^9}},
 CellTags->"Number-of-events-computation+sensitivity",
 CellLabel->
  "In[505]:=",ExpressionUUID->"a4642c06-b9e9-48ef-a903-598c93461b6b"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Computing sensitivities", "Title",
 CellChangeTimes->{{3.885020809493571*^9, 3.88502081261261*^9}},
 CellTags->
  "Sensitivity",ExpressionUUID->"2ce189e8-ece2-4e74-afba-65f86fa4e6b1"],

Cell[CellGroupData[{

Cell["Basic definitions", "Chapter",
 CellChangeTimes->{{3.9138314745388813`*^9, 3.913831477098402*^9}},
 CellTags->
  "Sensitivity",ExpressionUUID->"af6faa59-fd19-4e43-b127-96fda6871c2c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"modelsInelastic", "=", 
   RowBox[{"Select", "[", 
    RowBox[{
     RowBox[{"Import", "[", 
      RowBox[{
       RowBox[{"FileNameJoin", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"NotebookDirectory", "[", "]"}], 
          ",", "\"\<phenomenology\>\"", ",", "\"\<ModelDescriptors.mx\>\""}], 
         "}"}], "]"}], ",", "\"\<MX\>\""}], "]"}], ",", 
     RowBox[{
      RowBox[{"StringContainsQ", "[", 
       RowBox[{
        RowBox[{"#", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", "\"\<Inelastic-dipole-DM\>\""}],
        "]"}], "&"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"LLPdirName", "=", 
  RowBox[{"selectionDialogExplanationOneOption", "[", 
   RowBox[{
    RowBox[{"modelsInelastic", "[", 
     RowBox[{"[", 
      RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", 
    RowBox[{"modelsInelastic", "[", 
     RowBox[{"[", 
      RowBox[{"All", ",", "2"}], "]"}], "]"}], 
    ",", "\"\<Select the inelastic dipole DM model\>\"", ",", "400"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
  "massLabel", 
   "=", "\"\<\!\(\*SubscriptBox[\(m\), SubscriptBox[\(\[Chi]\), \(1\)]]\) \
[GeV]\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"couplingLabel", 
  "=", "\"\<\[Mu] [\!\(\*SuperscriptBox[\(GeV\), \(-1\)]\)]\>\""}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"directory", "[", "\"\<Sensitivity\>\"", "]"}], "=", 
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"NotebookDirectory", "[", "]"}], 
      ",", "\"\<Sensitivity domains\>\""}], "}"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"directory", "[", "\"\<Sensitivity-LLP\>\"", "]"}], "=", 
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"directory", "[", "\"\<Sensitivity\>\"", "]"}], ",", 
      "LLPdirName"}], "}"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"!", 
       RowBox[{"DirectoryQ", "[", 
        RowBox[{"directory", "[", "#", "]"}], "]"}]}], ",", 
      RowBox[{"CreateDirectory", "[", 
       RowBox[{"directory", "[", "#", "]"}], "]"}]}], "]"}], "&"}], "/@", 
   RowBox[{"{", 
    RowBox[{"\"\<Sensitivity\>\"", ",", "\"\<Sensitivity-LLP\>\""}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"directory", "[", "\"\<Nevents-LLP\>\"", "]"}], "=", 
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"NotebookDirectory", "[", "]"}], 
      ",", "\"\<Tabulated Nevents\>\"", ",", "LLPdirName"}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NotebookEvaluate", "[", 
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"NotebookDirectory", "[", "]"}], 
      ",", "\"\<codes/dialog-windows.nb\>\""}], "}"}], "]"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ExperimentDirectoriesListNevents", "=", 
   RowBox[{"Select", "[", 
    RowBox[{
     RowBox[{"FileNames", "[", 
      RowBox[{"\"\<*\>\"", ",", 
       RowBox[{"directory", "[", "\"\<Nevents-LLP\>\"", "]"}], ",", "1"}], 
      "]"}], ",", "DirectoryQ"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"\"\<List of available experiments with tabulated \
\!\(\*SubscriptBox[\(N\), \(events\)]\) for \>\"", " ", "<>", "LLPdirName", 
   "<>", "\"\<:\>\""}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ExperimentsListNevents", "=", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"FileNameTake", "[", 
       RowBox[{
        RowBox[{"ExperimentDirectoriesListNevents", "[", 
         RowBox[{"[", "i", "]"}], "]"}], ",", 
        RowBox[{"-", "1"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", 
        RowBox[{"Length", "[", "ExperimentDirectoriesListNevents", "]"}], ",",
         "1"}], "}"}]}], "]"}], "//", "Sort"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"ExperimentsListNevents", "//", "TableForm"}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Length", "[", "ExperimentsListNevents", "]"}], "\[Equal]", "0"}],
    ",", 
   RowBox[{
   "Print", "[", "\"\<No experiment is available, generate first the \
acceptance for the given experiment using module 1\>\"", "]"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SelectedExperimentList", "=", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "ExperimentsListNevents", "]"}], "\[NotEqual]",
         "0"}], ",", 
       RowBox[{"selectionDialog", "[", 
        RowBox[{
        "ExperimentsListNevents", 
         ",", "\"\<Select the experiments for which the sensitivity will be \
computed:\>\""}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"icounter", "=", "1"}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"BlockEvaluation", "[", "tag_", "]"}], ":=", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"nb", "=", 
         RowBox[{"EvaluationNotebook", "[", "]"}]}], ";", "\n", 
        RowBox[{"NotebookFind", "[", 
         RowBox[{"nb", ",", "tag", ",", "All", ",", "CellTags"}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"SelectionEvaluate", "[", "nb", "]"}]}]}], 
      "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"Do", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{
       "BlockEvaluation", "[", "\"\<Sensitivity-computation\>\"", "]"}], 
       ";"}], "\[IndentingNewLine]", ",", 
      RowBox[{"{", 
       RowBox[{"icounter", ",", "1", ",", 
        RowBox[{"Length", "[", "SelectedExperimentList", "]"}], ",", "1"}], 
       "}"}]}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}], "Input",
 CellChangeTimes->{{3.9138315400875525`*^9, 3.91383154039198*^9}, {
   3.913871030317705*^9, 3.9138710360181913`*^9}, {3.913972431945261*^9, 
   3.9139724320924325`*^9}, {3.9146590766468797`*^9, 3.91465907940434*^9}, {
   3.914666057807935*^9, 3.914666059506883*^9}, {3.9152626406397777`*^9, 
   3.91526264120131*^9}, {3.9156430049590807`*^9, 3.9156430049837103`*^9}, {
   3.950690871009281*^9, 3.9506908938953342`*^9}, 3.9514703662545033`*^9, {
   3.9514851740000668`*^9, 3.9514851781529274`*^9}, {3.9520139850488377`*^9, 
   3.952013985995245*^9}, {3.9528425837820053`*^9, 3.9528426009669933`*^9}},
 CellTags->
  "Sensitivity",ExpressionUUID->"1f2593a4-f79d-4589-b8fb-2a3e3c0366b2"]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Specifying the experiment and interpolating the tabulated number of events\
\>", "Chapter",
 CellChangeTimes->{{3.8865657605515084`*^9, 3.886565789800824*^9}, {
  3.889154717919751*^9, 3.88915472812621*^9}},
 CellTags->
  "Sensitivity-computation",ExpressionUUID->"4b6b6b16-a664-4633-a6f5-\
97c885c527f7"],

Cell[CellGroupData[{

Cell["Selecting the experiment", "Section",
 CellChangeTimes->{{3.91396730853413*^9, 3.913967310881191*^9}},
 CellTags->
  "Sensitivity-computation",ExpressionUUID->"603fee5f-4376-435f-a30d-\
66d5444bd4ab"],

Cell[BoxData[{
 RowBox[{"Print", "[", "\"\<Selected experiment:\>\"", "]"}], "\[IndentingNewLine]", 
 RowBox[{"GivenExperimentForSensitivityComputation", "=", 
  RowBox[{"SelectedExperimentList", "[", 
   RowBox[{"[", 
    RowBox[{"icounter", "++"}], "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CondANUBIS", "=", 
   RowBox[{"MemberQ", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\"\<ANUBIS-shaft-volume-1\>\"", 
       ",", "\"\<ANUBIS-shaft-volume-2\>\"", 
       ",", "\"\<ANUBIS-shaft-volume-3\>\""}], "}"}], ",", 
     "GivenExperimentForSensitivityComputation"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"CondANUBIS", "\[Equal]", "True"}], ",", 
   RowBox[{"infoDialog", "[", 
    RowBox[{"Row", "[", 
     RowBox[{
     "{", "\"\<One of the modules of ANUBIS-shaft is chosen. The full \
sensitivity includes three modules. The importing will be over all modules, \
so for all ot the the sensitivity has to be computed\>\"", "}"}], "]"}], 
    "]"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"CondANUBIS", "\[Equal]", "False"}], ",", 
    RowBox[{"GivenExperimentForSensitivityComputationList", "=", 
     RowBox[{"{", "GivenExperimentForSensitivityComputation", "}"}]}], ",", 
    RowBox[{"GivenExperimentForSensitivityComputationList", "=", 
     RowBox[{"{", 
      RowBox[{"\"\<ANUBIS-shaft-volume-1\>\"", 
       ",", "\"\<ANUBIS-shaft-volume-2\>\"", 
       ",", "\"\<ANUBIS-shaft-volume-3\>\""}], "}"}]}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PathsNeventsSelected", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{"PathsNeventsSelected", "=", 
      RowBox[{"Join", "[", 
       RowBox[{"PathsNeventsSelected", ",", 
        RowBox[{"FileNames", "[", 
         RowBox[{"\"\<*.dat\>\"", ",", 
          RowBox[{"FileNameJoin", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"directory", "[", "\"\<Nevents-LLP\>\"", "]"}], ",", 
             "exp"}], "}"}], "]"}]}], "]"}]}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"exp", ",", "GivenExperimentForSensitivityComputationList"}], 
      "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Creating", " ", "the", " ", "directory", " ", "for", " ", "exporting", " ",
     "sensitivity", " ", "curves"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ExperimentFolder", "=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"CondANUBIS", "\[Equal]", "True"}], ",", "\"\<ANUBIS\>\"", ",", 
     "GivenExperimentForSensitivityComputation"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"directory", "[", "\"\<Sensitivity-LLP-exp\>\"", "]"}], "=", 
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"directory", "[", "\"\<Sensitivity-LLP\>\"", "]"}], ",", 
      "ExperimentFolder"}], "}"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"!", 
    RowBox[{"DirectoryQ", "[", 
     RowBox[{"directory", "[", "\"\<Sensitivity-LLP-exp\>\"", "]"}], "]"}]}], 
   ",", 
   RowBox[{"CreateDirectory", "[", 
    RowBox[{"directory", "[", "\"\<Sensitivity-LLP-exp\>\"", "]"}], "]"}]}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.913967331064651*^9, 3.913967332613941*^9}, {
   3.914666065954961*^9, 3.9146660840070133`*^9}, 3.914668246496646*^9, {
   3.9156430049908347`*^9, 3.9156430050020943`*^9}, {3.9158209540274506`*^9, 
   3.9158209540439143`*^9}, 3.950690943805628*^9},
 CellTags->"Sensitivity-computation",
 CellLabel->
  "In[623]:=",ExpressionUUID->"07e4a048-2562-481d-99b1-8b50727ead91"]
}, Closed]],

Cell[CellGroupData[{

Cell["Importing and interpolations", "Section",
 CellChangeTimes->{{3.91396730853413*^9, 3.9139673172198215`*^9}},
 CellTags->
  "Sensitivity-computation",ExpressionUUID->"e5154548-1e1b-48d8-a1ec-\
1e1ea85c57d3"],

Cell[BoxData[{
 RowBox[{"Print", "[", "\"\<List of production channels:\>\"", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FilenamesNeventsSelected", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Last", "@", 
      RowBox[{"FileNameSplit", "@", 
       RowBox[{"PathsNeventsSelected", "[", 
        RowBox[{"[", "i", "]"}], "]"}]}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "PathsNeventsSelected", "]"}], ",", "1"}], 
      "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FilenameParameters", "[", "i_", "]"}], ":=", 
  RowBox[{
   RowBox[{"StringCases", "[", 
    RowBox[{
     RowBox[{"FilenamesNeventsSelected", "[", 
      RowBox[{"[", "i", "]"}], "]"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"\"\<Nevents_\>\"", "<>", "LLPdirName", "<>", "\"\<_\>\""}], "~~",
        "mother__", "~~", "\"\<_at_\>\"", "~~", "experiment__", 
       "~~", "\"\<_Npot=\>\"", "~~", "Npot__", "~~", "\"\<_decayDescr=\>\"", "~~",
        "decayDescr__", "~~", "\"\<.dat\>\""}], ":>", 
      RowBox[{"{", 
       RowBox[{"mother", ",", "experiment", ",", "Npot", ",", "decayDescr"}], 
       "}"}]}]}], "]"}], "[", 
   RowBox[{"[", "1", "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ProductionInfoList", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"FilenameParameters", "[", "i", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "FilenamesNeventsSelected", "]"}], ",", "1"}], 
      "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Join", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"\"\<Mother\>\"", ",", "\"\<Experiment\>\"", 
       ",", "\"\<\!\(\*SubscriptBox[\(N\), \(PoT\)]\)\>\"", 
       ",", "\"\<Decay description\>\""}], "}"}], "}"}], ",", 
    "ProductionInfoList"}], "]"}], "//", "TableForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ProductionChannelsList", "=", 
   RowBox[{"ProductionInfoList", "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", "1"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"decaydescriptions", "=", 
   RowBox[{
    RowBox[{"ProductionInfoList", "[", 
     RowBox[{"[", 
      RowBox[{"All", ",", 
       RowBox[{"-", "1"}]}], "]"}], "]"}], "//", "DeleteDuplicates"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NpotDefault", "=", 
   RowBox[{
    RowBox[{"Interpreter", "[", "\"\<Number\>\"", "]"}], "[", 
    RowBox[{
     RowBox[{"ProductionInfoList", "[", 
      RowBox[{"[", "1", "]"}], "]"}], "[", 
     RowBox[{"[", "3", "]"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NeventsTabulated", "//", "Clear"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Epsilon]reco", "[", "mLLP_", "]"}], "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"StringContainsQ", "[", 
     RowBox[{
     "GivenExperimentForSensitivityComputation", 
      ",", "\"\<LHCb-downstream\>\""}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\[Epsilon]reco", "[", "mLLP_", "]"}], "=", "0."}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"StringContainsQ", "[", 
     RowBox[{
     "GivenExperimentForSensitivityComputation", ",", "\"\<NuCal\>\""}], 
     "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\[Epsilon]reco", "[", "mLLP_", "]"}], "=", "0.7"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"StringContainsQ", "[", 
     RowBox[{
     "GivenExperimentForSensitivityComputation", ",", "\"\<CHARM\>\""}], 
     "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\[Epsilon]reco", "[", "mLLP_", "]"}], "=", "0.6"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"prod", ",", "decayDescr"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"prod", ",", "decayDescr"}], "}"}], "=", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"ProductionInfoList", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", "#", "]"}], "]"}], "&"}], "/@", 
        RowBox[{"{", 
         RowBox[{"1", ",", 
          RowBox[{"-", "1"}]}], "}"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "The", " ", "condition", " ", "if", " ", "one", " ", "sums", " ", 
        "the", " ", "number", " ", "of", " ", "events", " ", "for", " ", 
        "the", " ", "same", " ", "production", " ", "mode", " ", "over", " ", 
        "several", " ", "experiments"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"IfprodExists", "=", 
       RowBox[{
        RowBox[{"MemberQ", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Keys", "[", 
            RowBox[{"DownValues", "@", "NeventsTabulated"}], "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "1", ",", "1"}], "]"}], "]"}], ",", "prod"}], 
         "]"}], "&&", 
        RowBox[{"MemberQ", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Keys", "[", 
            RowBox[{"DownValues", "@", "NeventsTabulated"}], "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "1", ",", "1"}], "]"}], "]"}], ",", 
          "decayDescr"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"NeventsTabulated", "[", 
        RowBox[{"prod", ",", "decayDescr"}], "]"}], "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"!", "IfprodExists"}], ",", 
         RowBox[{"Import", "[", 
          RowBox[{
           RowBox[{"PathsNeventsSelected", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", "\"\<Table\>\""}], "]"}], ",", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"NeventsTabulated", "[", 
             RowBox[{"prod", ",", "decayDescr"}], "]"}], "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", 
              RowBox[{"{", 
               RowBox[{"1", ",", "2"}], "}"}]}], "]"}], "]"}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"NeventsTabulated", "[", 
              RowBox[{"prod", ",", "decayDescr"}], "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"All", ",", 
               RowBox[{"{", "3", "}"}]}], "]"}], "]"}], "+", 
            RowBox[{
             RowBox[{"Import", "[", 
              RowBox[{
               RowBox[{"PathsNeventsSelected", "[", 
                RowBox[{"[", "i", "]"}], "]"}], ",", "\"\<Table\>\""}], "]"}],
              "[", 
             RowBox[{"[", 
              RowBox[{"All", ",", 
               RowBox[{"{", "3", "}"}]}], "]"}], "]"}]}]}], "]"}]}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"mminmax", "[", 
          RowBox[{"prod", ",", "decayDescr"}], "]"}], ",", 
         RowBox[{"couplingminmax", "[", 
          RowBox[{"prod", ",", "decayDescr"}], "]"}]}], "}"}], "=", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"NeventsTabulated", "[", 
             RowBox[{"prod", ",", "decayDescr"}], "]"}], "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "#"}], "]"}], "]"}], "//", "MinMax"}], ")"}],
          "&"}], "/@", 
        RowBox[{"{", 
         RowBox[{"1", ",", "2"}], "}"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"NevMax", "[", 
        RowBox[{"prod", ",", "decayDescr"}], "]"}], "=", 
       RowBox[{
        RowBox[{
         RowBox[{"NeventsTabulated", "[", 
          RowBox[{"prod", ",", "decayDescr"}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "3"}], "]"}], "]"}], "//", "Max"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"NevInt", "[", 
        RowBox[{"mLLP_", ",", "y_", ",", "prod", ",", "decayDescr"}], "]"}], "=", 
       RowBox[{
        RowBox[{"\[Epsilon]reco", "[", "mLLP", "]"}], "*", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"mminmax", "[", 
              RowBox[{"prod", ",", "decayDescr"}], "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}], "\[LessEqual]", " ", "mLLP", "\[LessEqual]", 
            RowBox[{
             RowBox[{"mminmax", "[", 
              RowBox[{"prod", ",", "decayDescr"}], "]"}], "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "&&", 
           RowBox[{
            RowBox[{
             RowBox[{"couplingminmax", "[", 
              RowBox[{"prod", ",", "decayDescr"}], "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}], "\[LessEqual]", "y", "\[LessEqual]", 
            RowBox[{
             RowBox[{"couplingminmax", "[", 
              RowBox[{"prod", ",", "decayDescr"}], "]"}], "[", 
             RowBox[{"[", "2", "]"}], "]"}]}]}], ",", 
          RowBox[{"Evaluate", "[", 
           RowBox[{"10", "^", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Interpolation", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"Log10", "[", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Log10", "[", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Log10", "[", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "+", 
                    SuperscriptBox["10", 
                    RowBox[{"-", "90"}]]}], "]"}]}], "}"}], "&"}], "/@", 
                 RowBox[{"NeventsTabulated", "[", 
                  RowBox[{"prod", ",", "decayDescr"}], "]"}]}], ",", 
                RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[", 
              RowBox[{
               RowBox[{"Log10", "[", "mLLP", "]"}], ",", 
               RowBox[{"Log10", "[", "y", "]"}]}], "]"}], ")"}]}], "]"}], ",",
           "0"}], "]"}]}]}], ";"}]}], "\[IndentingNewLine]", "]"}], 
   "\[IndentingNewLine]", ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "1", ",", 
     RowBox[{"Length", "[", "ProductionInfoList", "]"}], ",", "1"}], "}"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"mminmaxOverall", ",", "couplingminmaxOverall"}], "}"}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{"MinMax", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"prod", ",", "dec"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"prod", ",", "ProductionChannelsList"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"dec", ",", "decaydescriptions"}], "}"}]}], "]"}], "//", 
       "Flatten"}], "]"}], "&"}], "/@", 
    RowBox[{"{", 
     RowBox[{"mminmax", ",", "couplingminmax"}], "}"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"NevMaxOverall", "=", 
  RowBox[{"Max", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"NeventsTabulated", "[", 
         RowBox[{"#", ",", "descr"}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "3"}], "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"descr", ",", "decaydescriptions"}], "}"}]}], "]"}], "&"}], "/@",
     "ProductionChannelsList"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"NevIntOverall", "[", 
      RowBox[{"mLLP_", ",", "y_", ",", "decaydescr"}], "]"}], "=", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{"NevInt", "[", 
        RowBox[{"mLLP", ",", "y", ",", "prod", ",", "decaydescr"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"prod", ",", "ProductionChannelsList"}], "}"}]}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"decaydescr", ",", "decaydescriptions"}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.8889934219191484`*^9, 3.8889934572936487`*^9}, {
   3.888993488436164*^9, 3.8889935196298246`*^9}, {3.888993631131192*^9, 
   3.8889936317673717`*^9}, {3.8889941168931828`*^9, 3.888994131488901*^9}, {
   3.8891549520226474`*^9, 3.8891549556386333`*^9}, {3.88915555629116*^9, 
   3.889155565695465*^9}, {3.8932343882289743`*^9, 3.89323440249368*^9}, {
   3.8935709181807127`*^9, 3.8935709459623632`*^9}, {3.8935709969349823`*^9, 
   3.893571049142565*^9}, {3.893571774685277*^9, 3.8935717805547934`*^9}, {
   3.8935723217820005`*^9, 3.893572363431644*^9}, {3.893744918014161*^9, 
   3.893744938342885*^9}, {3.8950528479286084`*^9, 3.895052904223016*^9}, {
   3.896846565306531*^9, 3.896846570642375*^9}, 3.8991934061928263`*^9, {
   3.9037911184438295`*^9, 3.903791118468619*^9}, {3.903793882094927*^9, 
   3.9037938820984917`*^9}, {3.903797026745615*^9, 3.9037970452607574`*^9}, {
   3.9049216111057444`*^9, 3.904921662274201*^9}, {3.9049217218934107`*^9, 
   3.9049217261997075`*^9}, {3.90492396885961*^9, 3.9049239690813828`*^9}, {
   3.9049240804362497`*^9, 3.9049240805085564`*^9}, {3.904924179607125*^9, 
   3.904924179705194*^9}, {3.9052412440770025`*^9, 3.90524124436055*^9}, {
   3.905242084580451*^9, 3.9052420935576477`*^9}, {3.9052421641249113`*^9, 
   3.905242164296854*^9}, {3.9052422710738254`*^9, 3.905242280663824*^9}, 
   3.9052780094855423`*^9, {3.9054038445509152`*^9, 3.905403844832307*^9}, 
   3.9058346238696585`*^9, {3.9058347300087337`*^9, 3.905834752542229*^9}, {
   3.907411732383304*^9, 3.907411756240266*^9}, {3.907412241347188*^9, 
   3.9074122616342597`*^9}, {3.907646540157587*^9, 3.907646541817969*^9}, {
   3.907646769227744*^9, 3.907646770045806*^9}, {3.9102621771594887`*^9, 
   3.9102622003857803`*^9}, {3.9104198602211523`*^9, 3.91041992062967*^9}, {
   3.912155734548005*^9, 3.9121557351760345`*^9}, {3.9138675516719847`*^9, 
   3.9138675697677517`*^9}, {3.9138687892109585`*^9, 3.913868789217184*^9}, 
   3.9138694472004433`*^9, {3.913869518299142*^9, 3.913869518315772*^9}, {
   3.9138710596580105`*^9, 3.9138712184697266`*^9}, 3.9138714395639257`*^9, {
   3.913871484442711*^9, 3.913871484514428*^9}, {3.913964035930587*^9, 
   3.913964083316618*^9}, {3.9139641518721075`*^9, 3.9139642425880857`*^9}, 
   3.913964298376277*^9, {3.9139655962465167`*^9, 3.9139656080541754`*^9}, {
   3.9139659553682365`*^9, 3.9139659826523647`*^9}, {3.9139673252774487`*^9, 
   3.913967336029952*^9}, 3.914062808836896*^9, {3.9146591581298556`*^9, 
   3.914659161023219*^9}, {3.9146592107212334`*^9, 3.914659210979342*^9}, 
   3.9146661655777373`*^9, {3.9156430050228515`*^9, 3.91564300506837*^9}, {
   3.915820954047451*^9, 3.915820954058597*^9}, {3.9506909724054585`*^9, 
   3.950691141196554*^9}},
 CellTags->"Sensitivity-computation",
 CellLabel->
  "In[633]:=",ExpressionUUID->"6d91cae4-ab09-467d-8af0-4d3a8f6dbbae"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Some number of events plots", "Chapter",
 CellChangeTimes->{{3.9482707731815777`*^9, 
  3.94827077970364*^9}},ExpressionUUID->"ed312daa-7aef-6343-b2d9-\
7c866c1a28f8"],

Cell[CellGroupData[{

Cell["Overall plot with the number of events", "Section",
 CellChangeTimes->{{3.9418775187226887`*^9, 3.9418775325581894`*^9}},
 CellTags->
  "Sensitivity-computation",ExpressionUUID->"a4957b2d-ca2c-0e4f-9fb7-\
4cd309f41135"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"pt", "[", 
     RowBox[{"mLLP_", ",", "descr_"}], "]"}], ":=", 
    RowBox[{"LogLogPlot", "[", 
     RowBox[{
      RowBox[{"Evaluate", "[", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"NevInt", "[", 
          RowBox[{"mLLP", ",", "y", ",", "prod", ",", "descr"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"prod", ",", "ProductionChannelsList"}], "}"}]}], "]"}], 
       "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"y", ",", 
        RowBox[{"couplingminmaxOverall", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", 
        RowBox[{"couplingminmaxOverall", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
      RowBox[{"PlotLegends", "\[Rule]", 
       RowBox[{"Placed", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Style", "[", 
            RowBox[{"#", ",", "15"}], "]"}], "&"}], "/@", 
          "ProductionChannelsList"}], ",", "Right"}], "]"}]}], ",", 
      RowBox[{"PlotRange", "->", 
       RowBox[{"{", 
        RowBox[{"couplingminmaxOverall", ",", 
         RowBox[{"{", 
          RowBox[{
           SuperscriptBox["10", 
            RowBox[{"-", "2"}]], ",", "NevMaxOverall"}], "}"}]}], "}"}]}], ",", 
      RowBox[{"Frame", "->", "True"}], ",", 
      RowBox[{"ImageSize", "->", "Large"}], ",", 
      RowBox[{"FrameLabel", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
        "couplingLabel", " ", ",", 
         " ", "\"\<\!\(\*SubscriptBox[\(N\), \
\(events\)]\)[\!\(\*SubscriptBox[\(m\), SubscriptBox[\(\[Chi]\), \(1\)]]\),\
\[Mu]]\>\""}], "}"}]}], ",", 
      RowBox[{"FrameStyle", "\[Rule]", 
       RowBox[{"Directive", "[", 
        RowBox[{"Black", ",", " ", "23", ",", "Thick"}], "]"}]}], ",", 
      RowBox[{"PlotStyle", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"Thick", ",", "Blue"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"Thick", ",", 
           RowBox[{"Darker", "@", "Red"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"Thick", ",", 
           RowBox[{"Darker", "@", 
            RowBox[{"Darker", "@", "Green"}]}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"Thick", ",", "Black"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"Thick", ",", "Blue", ",", 
           RowBox[{"Dashing", "[", "0.02", "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"Thick", ",", 
           RowBox[{"Darker", "@", "Red"}], ",", 
           RowBox[{"Dashing", "[", "0.02", "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"Thick", ",", 
           RowBox[{"Darker", "@", 
            RowBox[{"Darker", "@", "Green"}]}], ",", 
           RowBox[{"Dashing", "[", "0.02", "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"Thick", ",", "Black", ",", 
           RowBox[{"Dashing", "[", "0.02", "]"}]}], "}"}]}], "}"}]}], ",", 
      RowBox[{"PlotLabel", "\[Rule]", 
       RowBox[{"Style", "[", 
        RowBox[{
         RowBox[{"Row", "[", 
          RowBox[{"{", 
           RowBox[{
           "ExperimentFolder", 
            ",", "\"\<. \!\(\*SubscriptBox[\(m\), SubscriptBox[\(\[Chi]\), \
\(1\)]]\) = \>\"", ",", "mLLP", ",", " ", "\"\< GeV\>\""}], "}"}], "]"}], ",",
          "20", ",", "Black"}], "]"}]}]}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"pt", "[", 
    RowBox[{"0.7", ",", "\"\<Default\>\""}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.948270564491726*^9, 3.9482706114810963`*^9}, {
  3.950691201574526*^9, 3.950691228111082*^9}, {3.9514704440357704`*^9, 
  3.951470463054592*^9}, {3.95284257495767*^9, 3.952842575592407*^9}, {
  3.9528426355917625`*^9, 3.952842637992756*^9}},
 CellTags->
  "Sensitivity-computation",ExpressionUUID->"211a98d1-4019-414f-b0d1-\
f1c56cd4df69"]
}, Closed]],

Cell[CellGroupData[{

Cell["Events density plot", "Section",
 CellChangeTimes->{{3.8928925129732084`*^9, 3.8928925141322923`*^9}, {
  3.892910359615284*^9, 3.892910363538608*^9}},
 CellTags->
  "Sensitivity-computation",ExpressionUUID->"a4fa0d4e-b9fa-ee4c-b3df-\
03c7c29c49e8"],

Cell[BoxData[{
 RowBox[{"plot", "=", 
  RowBox[{"DensityPlot", "[", 
   RowBox[{
    RowBox[{"Evaluate", "[", 
     RowBox[{"Log10", "[", 
      RowBox[{"NevIntOverall", "[", 
       RowBox[{"mLLP", ",", "\[Mu]", ",", "\"\<Default\>\""}], "]"}], "]"}], 
     "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"mLLP", ",", 
      RowBox[{"mminmaxOverall", "[", 
       RowBox[{"[", "1", "]"}], "]"}], ",", 
      RowBox[{"mminmaxOverall", "[", 
       RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"\[Mu]", ",", 
      RowBox[{"couplingminmaxOverall", "[", 
       RowBox[{"[", "1", "]"}], "]"}], ",", 
      RowBox[{"couplingminmaxOverall", "[", 
       RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
    RowBox[{"ScalingFunctions", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"\"\<Log\>\"", ",", "\"\<Log\>\""}], "}"}]}], ",", 
    RowBox[{"AspectRatio", "\[Rule]", "0.78"}], ",", 
    RowBox[{"PlotRange", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"All", ",", "All", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Log10", "[", "2.3", "]"}], ",", 
         RowBox[{"Log10", "[", "NevMaxOverall", "]"}]}], "}"}]}], "}"}]}], ",", 
    RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
    RowBox[{"FrameLabel", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"massLabel", ",", "couplingLabel"}], "}"}]}], ",", " ", 
    RowBox[{"Frame", "\[Rule]", " ", "True"}], ",", " ", 
    RowBox[{"FrameStyle", "\[Rule]", 
     RowBox[{"Directive", "[", 
      RowBox[{"Black", ",", " ", "25"}], "]"}]}], ",", 
    RowBox[{"PlotPoints", "\[Rule]", "100"}], ",", 
    RowBox[{"PlotLegends", "\[Rule]", 
     RowBox[{"Placed", "[", 
      RowBox[{
       RowBox[{"BarLegend", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"Automatic", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Log10", "[", "2.3", "]"}], ",", 
             RowBox[{"Log10", "[", "NevMaxOverall", "]"}]}], "}"}]}], "}"}], ",", 
         RowBox[{"LegendMarkerSize", "\[Rule]", "340"}], ",", 
         RowBox[{"LegendLabel", "\[Rule]", 
          RowBox[{"Placed", "[", 
           
           RowBox[{"\"\<\!\(\*SubscriptBox[\(Log\), \
\(10\)]\)[\!\(\*SubscriptBox[\(N\), \(ev\)]\)]\>\"", ",", "Bottom"}], "]"}]}],
          ",", 
         RowBox[{"LabelStyle", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"FontSize", "\[Rule]", "22"}], "}"}]}], ",", 
         RowBox[{"Method", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"FrameStyle", "\[Rule]", "Black"}], ",", 
            RowBox[{"AxesStyle", "\[Rule]", "None"}], ",", 
            RowBox[{"TicksStyle", "\[Rule]", "Black"}]}], "}"}]}]}], "]"}], ",",
        "Right"}], "]"}]}], ",", 
    RowBox[{"PlotLabel", "\[Rule]", 
     RowBox[{"Style", "[", 
      RowBox[{
       RowBox[{"Row", "[", 
        RowBox[{"{", "ExperimentFolder", "}"}], "]"}], ",", "20", ",", 
       "Black"}], "]"}]}]}], 
   RowBox[{"(*", 
    RowBox[{",", 
     RowBox[{"FrameTicks", "->", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"Automatic", ",", "Automatic"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"TicksPlotx", ",", "None"}], "}"}]}], "}"}]}]}], "*)"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Export", "[", 
  RowBox[{
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"NotebookDirectory", "[", "]"}], 
      ",", "\"\<plots/SensCalc/NeventsDensityPlotExample.pdf\>\""}], "}"}], 
    "]"}], ",", "plot", ",", 
   RowBox[{"\"\<AllowRasterization\>\"", "->", "False"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.8929096922410564`*^9, 3.892909806303069*^9}, {
   3.8929100920281754`*^9, 3.8929100955435038`*^9}, {3.8929101335841722`*^9, 
   3.892910162228066*^9}, {3.8929101949082084`*^9, 3.8929101952618375`*^9}, {
   3.893481779378194*^9, 3.893481781603961*^9}, {3.8935713726623445`*^9, 
   3.8935713726663337`*^9}, 3.893571593533576*^9, {3.893600462416499*^9, 
   3.893600464823284*^9}, {3.8936007175747695`*^9, 3.8936007273021555`*^9}, {
   3.8936008794615602`*^9, 3.8936008816425495`*^9}, {3.893605565414917*^9, 
   3.8936055685099897`*^9}, {3.894552167897132*^9, 3.894552190947688*^9}, {
   3.9138856465220795`*^9, 3.9138856465250854`*^9}, {3.9139635639485736`*^9, 
   3.913963579089311*^9}, 3.9139636566744375`*^9, {3.9139640983446198`*^9, 
   3.913964098352851*^9}, {3.9139656696637654`*^9, 3.9139656696674147`*^9}, {
   3.915643066011381*^9, 3.9156430660143795`*^9}, {3.9482707598133698`*^9, 
   3.948270762213236*^9}, {3.950691244477396*^9, 3.95069125732535*^9}, {
   3.951470435908903*^9, 3.951470441359167*^9}, {3.9528426444242744`*^9, 
   3.952842648452141*^9}},
 CellTags->
  "Sensitivity-computation",ExpressionUUID->"b8aab91f-21dd-db4a-836c-\
b79b7ef9b0b7"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Sensitivity computation", "Chapter",
 CellChangeTimes->{{3.8889936571476183`*^9, 3.8889936597112193`*^9}},
 CellTags->
  "Sensitivity-computation",ExpressionUUID->"742f7a10-6bda-4531-8fc5-\
a3f03e574d3b"],

Cell[CellGroupData[{

Cell["Constraints importing", "Section",
 CellChangeTimes->{{3.895052713576123*^9, 3.895052715327282*^9}, {
  3.913967299387415*^9, 3.913967300849271*^9}},
 CellTags->
  "Sensitivity-computation",ExpressionUUID->"e44ac122-0059-4356-b219-\
a9e2d60e3ba8"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"importformat", "[", "\"\<txt\>\"", "]"}], "=", 
   RowBox[{
    RowBox[{"importformat", "[", "\"\<dat\>\"", "]"}], 
    "=", "\"\<Table\>\""}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"importformat", "[", "\"\<m\>\"", "]"}], "=", 
   RowBox[{
    RowBox[{"importformat", "[", "\"\<mx\>\"", "]"}], "=", "\"\<MX\>\""}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"importformat", "[", "\"\<xls\>\"", "]"}], "=", "\"\<XLS\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dir", "=", 
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"NotebookDirectory", "[", "]"}], ",", "\"\<contours\>\"", ",", 
      "LLPdirName"}], "}"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"DirectoryQ", "[", "dir", "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"filenames", "=", 
      RowBox[{"FileNames", "[", 
       RowBox[{
        RowBox[{"LLPdirName", "<>", "\"\<-excluded*\>\""}], ",", "dir", ",", 
        "Infinity"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ExcludedRegions", "[", "LLPdirName", "]"}], "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Import", "[", 
         RowBox[{"#", ",", 
          RowBox[{"importformat", "[", 
           RowBox[{"FileExtension", "[", "#", "]"}], "]"}]}], "]"}], "&"}], "/@", 
       RowBox[{"FileNames", "[", 
        RowBox[{
         RowBox[{"LLPdirName", "<>", "\"\<-excluded*\>\""}], ",", "dir", ",", 
         "Infinity"}], "]"}]}]}], ";"}]}], "\[IndentingNewLine]", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"!", 
    RowBox[{"DirectoryQ", "[", "dir", "]"}]}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ExcludedRegions", "[", "LLPdirName", "]"}], "=", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{"10.", ",", "10."}], "}"}], "}"}], "}"}]}], ";"}]}], 
  "\[IndentingNewLine]", "]"}]}], "Input",
 CellChangeTimes->{{3.903794607976071*^9, 3.9037946091391277`*^9}, 
   3.9037950242375803`*^9, 3.914659236229865*^9, 3.9146661351681223`*^9, 
   3.914666582064805*^9, {3.915643005090355*^9, 3.9156430051004467`*^9}},
 CellTags->"Sensitivity-computation",
 CellLabel->
  "In[654]:=",ExpressionUUID->"5f1f448b-9c06-40bf-91d3-bf789e46daf0"]
}, Closed]],

Cell[CellGroupData[{

Cell["Sensitivity evaluation", "Section",
 CellChangeTimes->{{3.895052713576123*^9, 3.895052715327282*^9}, {
  3.913967299387415*^9, 3.913967300849271*^9}, {3.9146592293508873`*^9, 
  3.9146592316736307`*^9}, {3.950691368426628*^9, 3.95069136980159*^9}},
 CellTags->
  "Sensitivity-computation",ExpressionUUID->"cb8c9da8-0737-4936-9e5b-\
431a16e30520"],

Cell[CellGroupData[{

Cell["Sensitivity calculator block", "Subsection",
 CellChangeTimes->{{3.9344284768399067`*^9, 3.9344284803812065`*^9}, {
  3.9345997252424593`*^9, 3.934599726886627*^9}},
 CellTags->
  "Sensitivity-computation",ExpressionUUID->"c5c807e9-ed95-954c-868e-\
705edfa39edf"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SensitivityBlock", "[", 
   RowBox[{
   "Npot_", ",", "NevMin_", ",", "SelectedProduction_", ",", "descr_"}], 
   "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"NevTot", "[", 
       RowBox[{"mLLP_", ",", "U2_"}], "]"}], "=", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{"NevInt", "[", 
         RowBox[{"mLLP", ",", "U2", ",", "prod", ",", "descr"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"prod", ",", "SelectedProduction"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"RegSens", "=", 
      RowBox[{"RegionPlot", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          FractionBox["Npot", "NpotDefault"], 
          RowBox[{"NevTot", "[", 
           RowBox[{
            SuperscriptBox["10", "mLLP"], ",", 
            SuperscriptBox["10", "U2"]}], "]"}]}], "\[GreaterEqual]", " ", 
         "NevMin"}], ",", 
        RowBox[{"{", 
         RowBox[{"mLLP", ",", 
          RowBox[{"Log10", "[", 
           RowBox[{"mminmaxOverall", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
          RowBox[{"Log10", "[", 
           RowBox[{"mminmaxOverall", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"U2", ",", 
          RowBox[{"Log10", "[", 
           RowBox[{"couplingminmaxOverall", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
          RowBox[{"Log10", "[", 
           RowBox[{"couplingminmaxOverall", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "}"}], ",", 
        RowBox[{"PlotPoints", "->", "200"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"SensTemp", "=", 
      RowBox[{"Cases", "[", 
       RowBox[{
        RowBox[{"Normal", "@", "RegSens"}], ",", 
        RowBox[{
         RowBox[{"Line", "[", "x_", "]"}], "\[RuleDelayed]", "x"}], ",", 
        "Infinity"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"10", "^", 
            RowBox[{"#", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], ",", 
           RowBox[{"10", "^", 
            RowBox[{"#", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}], "&"}], "/@", 
        RowBox[{"SensTemp", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "SensTemp", "]"}], ",", "1"}], "}"}]}], 
      "]"}]}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SensitivityBlock", "[", 
   RowBox[{"Npot_", ",", "NevMin_", ",", "SelectedProduction_"}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"TabSens", "=", 
      RowBox[{
       RowBox[{"ResourceFunction", "[", "\"\<MonitorProgress\>\"", "]"}], "@", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"SelectedProduction", ",", 
           RowBox[{"decaydescriptions", "[", 
            RowBox[{"[", "j", "]"}], "]"}], ",", 
           RowBox[{"SensitivityBlock", "[", 
            RowBox[{"Npot", ",", "NevMin", ",", "SelectedProduction", ",", 
             RowBox[{"decaydescriptions", "[", 
              RowBox[{"[", "j", "]"}], "]"}]}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", 
           RowBox[{"Length", "[", "decaydescriptions", "]"}]}], "}"}]}], 
        "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"filenameexport", "=", 
      RowBox[{"FileNameJoin", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"directory", "[", "\"\<Sensitivity-LLP-exp\>\"", "]"}], ",", 
         RowBox[{"ToString", "@", 
          RowBox[{"StringForm", "[", 
           RowBox[{"\"\<Sensitivity_``_at_``_Nev=``_Npot=``.\>\"", ",", 
            RowBox[{"Sequence", "@@", 
             RowBox[{"{", 
              RowBox[{"LLPdirName", ",", "ExperimentFolder", ",", 
               RowBox[{"NevMin", "//", "ToString"}], ",", 
               RowBox[{
                RowBox[{
                 RowBox[{"SetPrecision", "[", 
                  RowBox[{
                   RowBox[{"Npot", "//", "N"}], ",", "3"}], "]"}], "//", 
                 "CForm"}], "//", "ToString"}]}], "}"}]}]}], "]"}]}]}], "}"}],
        "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"assocData", "=", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Association", "[", 
          RowBox[{
           RowBox[{"\"\<Production modes\>\"", "->", 
            RowBox[{"#", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], ",", 
           RowBox[{"\"\<Decay description\>\"", "->", 
            RowBox[{"#", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], ",", 
           RowBox[{"\"\<Sensitivity domains\>\"", "->", 
            RowBox[{"#", "[", 
             RowBox[{"[", "3", "]"}], "]"}]}]}], "]"}], "&"}], ",", 
        "TabSens"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Export", "[", 
      RowBox[{
       RowBox[{"FileNameJoin", "[", 
        RowBox[{"{", 
         RowBox[{"filenameexport", "<>", "\"\<mx\>\""}], "}"}], "]"}], ",", 
       "TabSens", ",", "\"\<MX\>\""}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Export", "[", 
      RowBox[{
       RowBox[{"FileNameJoin", "[", 
        RowBox[{"{", 
         RowBox[{"filenameexport", "<>", "\"\<json\>\""}], "}"}], "]"}], ",", 
       "assocData", ",", "\"\<JSON\>\""}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", "TabSens", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Import", "[", 
      RowBox[{
       RowBox[{"FileNameJoin", "[", 
        RowBox[{"{", 
         RowBox[{"filenameexport", "<>", "\"\<mx\>\""}], "}"}], "]"}], 
       ",", "\"\<MX\>\""}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.950691487895361*^9, 3.950691525859297*^9}, {
   3.9506917167706623`*^9, 3.9506917239319687`*^9}, 3.9528425551695633`*^9},
 CellTags->
  "Sensitivity-computation",ExpressionUUID->"7915025e-2501-5d48-a8e4-\
b45782c1cf1e"]
}, Closed]],

Cell[CellGroupData[{

Cell["Sensitivity evaluator", "Subsection",
 CellChangeTimes->{{3.9344284768399067`*^9, 3.9344284803812065`*^9}, {
  3.9345997252424593`*^9, 3.934599726886627*^9}, {3.9506913849454136`*^9, 
  3.9506913861813087`*^9}},
 CellTags->
  "Sensitivity-computation",ExpressionUUID->"ddbbf97c-e623-8f49-a856-\
4557a4bc5d0a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"productionlist", "=", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"{", "\"\<All\>\"", "}"}], ",", "ProductionChannelsList"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DynamicModule", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"input1", "=", "NpotDefault"}], ",", 
      RowBox[{"input2", "=", "2.3"}], ",", 
      RowBox[{"choice", "=", 
       RowBox[{"{", "\"\<All\>\"", "}"}]}], ",", "list", ",", "phrase"}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"DialogInput", "[", 
     RowBox[{"Column", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Style", "[", 
         RowBox[{"ExperimentFolder", ",", "Bold"}], "]"}], ",", 
        RowBox[{
        "TextCell", "[", "\"\<Enter the number of proton collisions:\>\"", 
         "]"}], ",", 
        RowBox[{"InputField", "[", 
         RowBox[{
          RowBox[{"Dynamic", "[", "input1", "]"}], ",", "Expression"}], "]"}],
         ",", 
        RowBox[{
        "TextCell", 
         "[", "\"\<Enter the value of N_ev,min for which the sensitivity will \
be computed:\>\"", "]"}], ",", 
        RowBox[{"InputField", "[", 
         RowBox[{
          RowBox[{"Dynamic", "[", "input2", "]"}], ",", "Expression"}], "]"}],
         ",", 
        RowBox[{"Row", "[", 
         RowBox[{
         "{", "\"\<Select the production channels to be used for the \
sensitivity calculation:\>\"", "}"}], "]"}], ",", 
        RowBox[{"Pane", "[", 
         RowBox[{
          RowBox[{"TogglerBar", "[", 
           RowBox[{
            RowBox[{"Dynamic", "[", "choice", "]"}], ",", "productionlist", ",", 
            RowBox[{"Appearance", "->", 
             RowBox[{"\"\<Vertical\>\"", "->", 
              RowBox[{"{", 
               RowBox[{"Automatic", ",", "1"}], "}"}]}]}]}], "]"}], ",", 
          RowBox[{"ImageSize", "->", 
           RowBox[{"{", 
            RowBox[{"Automatic", ",", "Automatic"}], "}"}]}], ",", 
          RowBox[{"Scrollbars", "->", 
           RowBox[{"{", 
            RowBox[{"False", ",", "True"}], "}"}]}]}], "]"}], ",", 
        RowBox[{"Button", "[", 
         RowBox[{"\"\<Submit\>\"", ",", 
          RowBox[{"DialogReturn", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"NpotVal", ",", "NevMinVal", ",", "SelectedProduction"}],
              "}"}], "=", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"input1", ",", "input2", ",", "choice"}], "}"}], "//", 
             "N"}]}], "]"}], ",", 
          RowBox[{"ImageSize", "->", "Automatic"}]}], "]"}]}], "}"}], "]"}], 
     "]"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"MemberQ", "[", 
    RowBox[{"SelectedProduction", ",", "\"\<All\>\""}], "]"}], ",", 
   RowBox[{
    RowBox[{"SelectedProduction", "=", "ProductionChannelsList"}], ";"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"\"\<\!\(\*SubscriptBox[\(N\), \(PoT\)]\) for computation\>\"", 
      ",", "\"\<\!\(\*SubscriptBox[\(N\), \(ev, min\)]\)\>\"", 
      ",", "\"\<Selected production modes\>\""}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"NpotVal", ",", "NevMinVal", ",", "SelectedProduction"}], 
     "}"}]}], "}"}], "//", "TableForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sens", "=", 
   RowBox[{"SensitivityBlock", "[", 
    RowBox[{"NpotVal", ",", "NevMinVal", ",", "SelectedProduction"}], "]"}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sensDomains", "=", 
   RowBox[{"sens", "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", 
      RowBox[{"-", "1"}]}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Show", "[", 
  RowBox[{
   RowBox[{"ListLogLogPlot", "[", 
    RowBox[{
     RowBox[{"Cases", "[", 
      RowBox[{
       RowBox[{"ExcludedRegions", "[", "LLPdirName", "]"}], ",", 
       RowBox[{"_", "?", "MatrixQ"}], ",", "All"}], "]"}], ",", 
     RowBox[{"Joined", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"True", ",", "True", ",", "True", ",", "True"}], "}"}]}], ",", 
     RowBox[{"Frame", "\[Rule]", " ", "True"}], ",", 
     RowBox[{"FrameLabel", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"massLabel", ",", "couplingLabel"}], "}"}]}], ",", 
     RowBox[{"FrameStyle", "\[Rule]", 
      RowBox[{"Directive", "[", 
       RowBox[{"Black", ",", " ", "23"}], "]"}]}], ",", 
     RowBox[{"PlotStyle", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{"Thick", ",", "Gray"}], "}"}], "}"}]}], ",", 
     RowBox[{"Filling", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"1", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"Bottom", ",", 
           RowBox[{"Directive", "[", 
            RowBox[{"Gray", ",", 
             RowBox[{"Opacity", "[", "0.3", "]"}]}], "]"}]}], "}"}]}], ",", 
        RowBox[{"2", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"True", ",", 
           RowBox[{"Directive", "[", 
            RowBox[{"Gray", ",", 
             RowBox[{"Opacity", "[", "0.3", "]"}]}], "]"}]}], "}"}]}], ",", 
        RowBox[{"3", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"Bottom", ",", 
           RowBox[{"Directive", "[", 
            RowBox[{"Gray", ",", 
             RowBox[{"Opacity", "[", "0.1", "]"}]}], "]"}]}], "}"}]}], ",", 
        RowBox[{"4", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"True", ",", 
           RowBox[{"Directive", "[", 
            RowBox[{"Gray", ",", 
             RowBox[{"Opacity", "[", "0.3", "]"}]}], "]"}]}], "}"}]}]}], 
       "}"}]}], ",", 
     RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
     RowBox[{"PlotRange", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"1.01", 
           RowBox[{"mminmaxOverall", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], ",", 
          RowBox[{"1.1", 
           RowBox[{"mminmaxOverall", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"0.3", 
           RowBox[{"Min", "[", 
            RowBox[{"Flatten", "[", "sensDomains", "]"}], "]"}]}], ",", 
          RowBox[{"0.98", 
           RowBox[{"couplingminmaxOverall", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}]}], "}"}]}], ",", 
     RowBox[{"PlotLabel", "\[Rule]", 
      RowBox[{"Style", "[", 
       RowBox[{
        RowBox[{"Row", "[", 
         RowBox[{"{", 
          
          RowBox[{"\"\<\!\(\*SubscriptBox[\(N\), \(events\)]\) \
\[GreaterEqual] \>\"", ",", "NevMinVal"}], "}"}], "]"}], ",", "18", ",", 
        "Black"}], "]"}]}]}], "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"ListLogLogPlot", "[", 
    RowBox[{
     RowBox[{"Cases", "[", 
      RowBox[{"sensDomains", ",", 
       RowBox[{"_", "?", "MatrixQ"}], ",", "All"}], "]"}], ",", 
     RowBox[{"Joined", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"True", ",", "True", ",", "True", ",", "True"}], "}"}]}], ",", 
     RowBox[{"PlotStyle", "\[Rule]", 
      RowBox[{"Flatten", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"ConstantArray", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"Thick", ",", "Blue"}], "}"}], ",", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"MatrixQ", "[", "sensDomains", "]"}], ",", "1", ",", 
             RowBox[{"Length", "@", "sensDomains"}]}], "]"}]}], "]"}], "}"}], 
        ",", "1"}], "]"}]}], ",", 
     RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
     RowBox[{"PlotRange", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"1.01", 
           RowBox[{"mminmaxOverall", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], ",", 
          RowBox[{"1.1", 
           RowBox[{"mminmaxOverall", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"couplingminmaxOverall", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{"Max", "[", 
           RowBox[{"0.2", ",", 
            RowBox[{"0.98", 
             RowBox[{"couplingminmaxOverall", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}]}], "]"}]}], "}"}]}], "}"}]}], ",", 
     RowBox[{"PlotLabel", "\[Rule]", 
      RowBox[{"Style", "[", 
       RowBox[{
        RowBox[{"Row", "[", 
         RowBox[{"{", 
          
          RowBox[{"\"\<\!\(\*SubscriptBox[\(N\), \(events\)]\) \
\[GreaterEqual] \>\"", ",", "NevMinVal"}], "}"}], "]"}], ",", "18", ",", 
        "Black"}], "]"}]}], ",", 
     RowBox[{"PlotLegends", "\[Rule]", 
      RowBox[{"Placed", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Style", "[", 
           RowBox[{"#", ",", "15"}], "]"}], "&"}], "/@", 
         RowBox[{"{", "ExperimentFolder", "}"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"0.2", ",", "0.15"}], "}"}]}], "]"}]}]}], "]"}], ",", 
   RowBox[{"Graphics", "[", 
    RowBox[{"{", 
     RowBox[{"Text", "[", 
      RowBox[{
       RowBox[{"Style", "[", 
        RowBox[{"\"\<Excluded\>\"", ",", "24", ",", "Black"}], "]"}], ",", 
       RowBox[{"Scaled", "[", 
        RowBox[{"{", 
         RowBox[{"0.7", ",", "0.95"}], "}"}], "]"}]}], "]"}], "}"}], "]"}]}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.8889936997762337`*^9, 3.8889937382921906`*^9}, {
   3.88899385262287*^9, 3.888993853042823*^9}, {3.8889939031947403`*^9, 
   3.8889939052817664`*^9}, {3.8889939588761787`*^9, 3.888994072394391*^9}, {
   3.8889941392721796`*^9, 3.8889941490041194`*^9}, {3.8889941930377913`*^9, 
   3.888994195131672*^9}, {3.8889942375929303`*^9, 3.888994293018688*^9}, 
   3.889155194091461*^9, {3.8891555444676304`*^9, 3.889155549549215*^9}, {
   3.8895085261021676`*^9, 3.8895085304810085`*^9}, {3.889508590213485*^9, 
   3.889508672502302*^9}, {3.889509235833849*^9, 3.889509245020251*^9}, 
   3.88950942091127*^9, {3.892276969991042*^9, 3.892276969998666*^9}, {
   3.8935262462252254`*^9, 3.8935262529369063`*^9}, {3.8935265499464674`*^9, 
   3.8935265503488092`*^9}, {3.893571339691801*^9, 3.8935713396999893`*^9}, 
   3.8937547419566717`*^9, {3.895053055776411*^9, 3.8950530989740524`*^9}, {
   3.895075030833277*^9, 3.8950750315874023`*^9}, {3.8951246431380773`*^9, 
   3.8951246449600024`*^9}, {3.8956550073948264`*^9, 3.895655106569532*^9}, 
   3.895655141064495*^9, {3.896155184831273*^9, 3.8961552168930655`*^9}, 
   3.906194615223667*^9, {3.9072587825379424`*^9, 3.9072587857841225`*^9}, 
   3.9121559167505903`*^9, {3.914659234361349*^9, 3.9146593105301476`*^9}, {
   3.9146661493769093`*^9, 3.914666172863454*^9}, {3.914666549097825*^9, 
   3.914666558717947*^9}, {3.9146678822113914`*^9, 3.9146678860876284`*^9}, {
   3.915262633295915*^9, 3.91526263548384*^9}, {3.915298167811447*^9, 
   3.915298180836545*^9}, {3.915643005120581*^9, 3.9156430051398344`*^9}, {
   3.9168238298208466`*^9, 3.916823830019537*^9}, {3.950691338525585*^9, 
   3.950691352487234*^9}, 3.950691391206455*^9, {3.9506914329456005`*^9, 
   3.95069147574666*^9}, {3.9514705897216167`*^9, 3.951470597131531*^9}, {
   3.952842656873579*^9, 3.9528426613619995`*^9}},
 CellTags->
  "Sensitivity-computation",ExpressionUUID->"e42c711e-a973-46f4-88a9-\
717948c379ae"]
}, Closed]]
}, Closed]]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Deleting generated cells", "Title",
 CellChangeTimes->{{3.9025559465149946`*^9, 
  3.9025559494966087`*^9}},ExpressionUUID->"268b5966-c044-471d-8d66-\
d25b1ca611fc"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"FrontEndTokenExecute", "[", "\"\<DeleteGeneratedCells\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FrontEndTokenExecute", "[", "\"\<SelectAll\>\"", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
  "FrontEndTokenExecute", "[", "\"\<SelectionCloseAllGroups\>\"", "]"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.9025559062888603`*^9, 3.9025559062888603`*^9}, {
   3.902555964086707*^9, 3.902555989355214*^9}, {3.9027629060419035`*^9, 
   3.9027629063187804`*^9}, {3.902766994175357*^9, 3.9027669973698597`*^9}, {
   3.9028940792862453`*^9, 3.902894096713217*^9}, {3.9039717672337112`*^9, 
   3.903971767738082*^9}, {3.918149103056999*^9, 3.9181491064242797`*^9}, 
   3.920048262180258*^9},
 CellLabel->
  "In[520]:=",ExpressionUUID->"00a97c9c-fda1-4a59-a10c-e35c97e449fb"]
}, Closed]]
},
WindowSize->{1430.25, 822.75},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
TaggingRules-><|"TryRealOnly" -> False|>,
ShowCellTags->True,
Magnification:>1. Inherited,
FrontEndVersion->"14.2 for Microsoft Windows (64-bit) (December 26, 2024)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"3f0cba52-4412-7c49-912c-73a29b6f0c3d"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{
 "Acceptance"->{
  Cell[6107, 158, 345, 7, 84, "Title",ExpressionUUID->"c7fbc496-1765-4913-bda1-eb19f9d14ec4",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
  Cell[6477, 169, 287, 6, 81, "Chapter",ExpressionUUID->"7856a6bd-3005-de41-bdc2-79f63e2bc7ab",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
  Cell[6767, 177, 1846, 42, 136, "Input",ExpressionUUID->"a703e3df-8d64-ce4f-8380-8f0535af55ae",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
  Cell[8650, 224, 227, 5, 81, "Chapter",ExpressionUUID->"142d4967-f301-4310-a32c-a4120d5d4aa9",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
  Cell[8880, 231, 5535, 139, 307, "Input",ExpressionUUID->"b2f3e96a-d2a2-4f84-a6a4-563b842c1e7f",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
  Cell[14452, 375, 656, 11, 82, "Chapter",ExpressionUUID->"d6722c5a-93b4-416a-bc00-f0c22121cd21",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
  Cell[15133, 390, 285, 6, 82, "Section",ExpressionUUID->"862685fe-43b6-482e-b82b-9fcf0703194f",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
  Cell[15421, 398, 6161, 141, 387, "Input",ExpressionUUID->"f1d79d2e-d855-44c1-b2cc-e9413f8e981e",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
  Cell[21619, 544, 297, 6, 82, "Section",ExpressionUUID->"7937f012-5420-4399-b275-9d1989e428a9",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
  Cell[21919, 552, 3196, 71, 196, "Input",ExpressionUUID->"25cebf9b-4dec-4ac0-a975-fedfa9a7d346",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
  Cell[25176, 630, 306, 6, 84, "Title",ExpressionUUID->"fa4de700-3b7a-8f4d-90c0-187b066f8a23",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
  Cell[25507, 640, 285, 6, 81, "Chapter",ExpressionUUID->"3e00ad76-64aa-0649-a2d2-8e26b6499e53",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
  Cell[25795, 648, 9515, 232, 650, "Input",ExpressionUUID->"f06baae7-16fd-c94b-a9cb-b17334c76bbd",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
  Cell[35347, 885, 238, 5, 82, "Chapter",ExpressionUUID->"5473bfb1-869b-a64b-86dd-5562306f09e7",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
  Cell[35588, 892, 2050, 50, 310, "Input",ExpressionUUID->"cfd541f2-c0a1-7145-845b-c5672633bdaf",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}]},
 "Number-of-events+sensitivity"->{
  Cell[6107, 158, 345, 7, 84, "Title",ExpressionUUID->"c7fbc496-1765-4913-bda1-eb19f9d14ec4",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
  Cell[6477, 169, 287, 6, 81, "Chapter",ExpressionUUID->"7856a6bd-3005-de41-bdc2-79f63e2bc7ab",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
  Cell[6767, 177, 1846, 42, 136, "Input",ExpressionUUID->"a703e3df-8d64-ce4f-8380-8f0535af55ae",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
  Cell[8650, 224, 227, 5, 81, "Chapter",ExpressionUUID->"142d4967-f301-4310-a32c-a4120d5d4aa9",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
  Cell[8880, 231, 5535, 139, 307, "Input",ExpressionUUID->"b2f3e96a-d2a2-4f84-a6a4-563b842c1e7f",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
  Cell[14452, 375, 656, 11, 82, "Chapter",ExpressionUUID->"d6722c5a-93b4-416a-bc00-f0c22121cd21",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
  Cell[15133, 390, 285, 6, 82, "Section",ExpressionUUID->"862685fe-43b6-482e-b82b-9fcf0703194f",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
  Cell[15421, 398, 6161, 141, 387, "Input",ExpressionUUID->"f1d79d2e-d855-44c1-b2cc-e9413f8e981e",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
  Cell[21619, 544, 297, 6, 82, "Section",ExpressionUUID->"7937f012-5420-4399-b275-9d1989e428a9",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
  Cell[21919, 552, 3196, 71, 196, "Input",ExpressionUUID->"25cebf9b-4dec-4ac0-a975-fedfa9a7d346",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
  Cell[25176, 630, 306, 6, 84, "Title",ExpressionUUID->"fa4de700-3b7a-8f4d-90c0-187b066f8a23",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
  Cell[25507, 640, 285, 6, 81, "Chapter",ExpressionUUID->"3e00ad76-64aa-0649-a2d2-8e26b6499e53",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
  Cell[25795, 648, 9515, 232, 650, "Input",ExpressionUUID->"f06baae7-16fd-c94b-a9cb-b17334c76bbd",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
  Cell[35347, 885, 238, 5, 82, "Chapter",ExpressionUUID->"5473bfb1-869b-a64b-86dd-5562306f09e7",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
  Cell[35588, 892, 2050, 50, 310, "Input",ExpressionUUID->"cfd541f2-c0a1-7145-845b-c5672633bdaf",
   CellTags->{"Acceptance", "Number-of-events+sensitivity"}]},
 "Number-of-events-computation+sensitivity"->{
  Cell[37687, 948, 216, 4, 84, "Title",ExpressionUUID->"128d78c3-8bd2-4cc0-aade-f5ea999c5498",
   CellTags->"Number-of-events-computation+sensitivity"],
  Cell[37928, 956, 308, 6, 81, "Chapter",ExpressionUUID->"14184674-a362-4b71-85ea-2766ddc38791",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[38239, 964, 760, 20, 61, "Input",ExpressionUUID->"3b60b3d0-47b7-475a-950b-e1cd90a1b696",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[39036, 989, 286, 6, 81, "Chapter",ExpressionUUID->"024306d0-6fd7-404c-b503-13b97cb70d6e",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[39325, 997, 11926, 291, 627, "Input",ExpressionUUID->"5f950072-065f-4973-a235-bace6753e9f0",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[51276, 1292, 416, 9, 80, "Section",ExpressionUUID->"f7fba8d2-a245-8e4e-aba8-b5877eacbaf4",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[51717, 1305, 325, 8, 67, "Subsection",ExpressionUUID->"851c16e6-94ac-3648-a05d-c81e2872b0c5",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[52045, 1315, 7261, 184, 289, "Input",ExpressionUUID->"4aa1045c-2dac-174f-8c6e-b96856e5f13e",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[64192, 1641, 307, 7, 67, "Subsection",ExpressionUUID->"d7390003-b4ea-ff44-ab0d-985ede19c2cd",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[64502, 1650, 4597, 107, 441, "Input",ExpressionUUID->"b443d5cc-7dba-be40-9faf-007a7d55e11e",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[69160, 1764, 484, 8, 81, "Chapter",ExpressionUUID->"775c9f90-cfc2-4104-a914-805ee6203cb5",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[73034, 1869, 13314, 303, 866, "Input",ExpressionUUID->"ee40f17f-b4bb-43d0-a30f-9da27f9361c2",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[86385, 2177, 241, 5, 80, "Section",ExpressionUUID->"0c4f3b67-80f3-f24c-b5d7-9b07982e3769",
   CellTags->{"Number-of-events-computation+sensitivity", "Acceptance-computation"}],
  Cell[86629, 2184, 6144, 139, 188, "Input",ExpressionUUID->"dc74bfea-24ff-b44b-9949-00eab5b0c7a0",
   CellTags->{"Number-of-events-computation+sensitivity", "Acceptance-computation"}],
  Cell[92822, 2329, 280, 5, 81, "Chapter",ExpressionUUID->"18333902-760f-4a49-b2f7-a7db0718c1c0",
   CellTags->"Number-of-events-computation+sensitivity"],
  Cell[93127, 2338, 324, 6, 80, "Section",ExpressionUUID->"ff7853ec-a854-4a03-9b03-a9ef2d7f8e39",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[93476, 2348, 388, 7, 67, "Subsection",ExpressionUUID->"973a528b-dac2-4eb0-819c-3939e7032851",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[93867, 2357, 9772, 216, 519, "Input",ExpressionUUID->"ed9378d5-1972-4ecf-a029-94d16d76a66e",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[103676, 2578, 262, 5, 67, "Subsection",ExpressionUUID->"90f400a5-a53f-4620-b2bb-0b2a8019b373",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[103963, 2587, 253, 5, 57, "Subsubsection",ExpressionUUID->"aff6e0ae-afea-aa42-92b7-e0ae7b047949",
   CellTags->{"Number-of-events-computation+sensitivity", "Acceptance-computation"}],
  Cell[104219, 2594, 3490, 87, 239, "Input",ExpressionUUID->"02dabcb5-0a51-a94f-ae07-bb624d4b7504",
   CellTags->{"Number-of-events-computation+sensitivity", "Acceptance-computation"}],
  Cell[107746, 2686, 263, 5, 57, "Subsubsection",ExpressionUUID->"7617dcc7-7638-e04e-b918-22c854d2f2aa",
   CellTags->{"Number-of-events-computation+sensitivity", "Acceptance-computation"}],
  Cell[108012, 2693, 15534, 377, 498, "Input",ExpressionUUID->"ad7d144a-73ab-4c1a-acd2-06b66fe856e6",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[123595, 3076, 284, 5, 67, "Subsection",ExpressionUUID->"b08eb94e-c944-4b4c-868e-d6afa6f49903",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[123882, 3083, 6443, 140, 358, "Input",ExpressionUUID->"3457eb9e-7b37-420f-8d27-350e94706731",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[130362, 3228, 309, 6, 67, "Subsection",ExpressionUUID->"9b4d2cf7-9554-4e8d-bf0e-5bc45bc7e4fd",
   CellTags->{"Number-of-events-computation+sensitivity", "Acceptance-computation"}],
  Cell[130674, 3236, 6838, 139, 327, "Input",ExpressionUUID->"49dc74a0-e549-437e-844d-546f09d15bc4",
   CellTags->{"Number-of-events-computation+sensitivity", "Acceptance-computation"}],
  Cell[137549, 3380, 335, 8, 67, "Subsection",ExpressionUUID->"75741e81-60c2-4769-95be-621ef8117a1e",
   CellTags->{"Number-of-events-computation+sensitivity", "Acceptance-computation"}],
  Cell[137887, 3390, 7416, 179, 313, "Input",ExpressionUUID->"45d46db1-d451-4a10-a413-f35599d4f890",
   CellTags->{"Number-of-events-computation+sensitivity", "Acceptance-computation"}],
  Cell[145340, 3574, 232, 4, 67, "Subsection",ExpressionUUID->"180acaf6-75e1-4bab-82db-d1998deec424",
   CellTags->"Number-of-events-computation+sensitivity"],
  Cell[145575, 3580, 22439, 499, 1075, "Input",ExpressionUUID->"4978bbd4-63cc-4b59-ac79-ded561ee9c78",
   CellTags->"Number-of-events-computation+sensitivity"],
  Cell[180135, 4365, 236, 4, 84, "Title",ExpressionUUID->"f5136f97-573d-41ec-bafe-cbcb903e581e",
   CellTags->"Number-of-events-computation+sensitivity"],
  Cell[180396, 4373, 213, 4, 81, "Chapter",ExpressionUUID->"75cf786b-3cae-4471-be7d-a8f2b6c6b657",
   CellTags->"Number-of-events-computation+sensitivity"],
  Cell[180612, 4379, 6515, 130, 373, "Input",ExpressionUUID->"7723a626-82c5-4cfa-9029-8486e71b92ea",
   CellTags->"Number-of-events-computation+sensitivity"],
  Cell[187164, 4514, 209, 4, 81, "Chapter",ExpressionUUID->"df5e70ae-73d2-4cb0-8325-e3fe55e2f51a",
   CellTags->"Number-of-events-computation+sensitivity"],
  Cell[187376, 4520, 4119, 90, 270, "Input",ExpressionUUID->"a4642c06-b9e9-48ef-a903-598c93461b6b",
   CellTags->"Number-of-events-computation+sensitivity"]},
 "Acceptance-computation"->{
  Cell[37928, 956, 308, 6, 81, "Chapter",ExpressionUUID->"14184674-a362-4b71-85ea-2766ddc38791",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[38239, 964, 760, 20, 61, "Input",ExpressionUUID->"3b60b3d0-47b7-475a-950b-e1cd90a1b696",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[39036, 989, 286, 6, 81, "Chapter",ExpressionUUID->"024306d0-6fd7-404c-b503-13b97cb70d6e",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[39325, 997, 11926, 291, 627, "Input",ExpressionUUID->"5f950072-065f-4973-a235-bace6753e9f0",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[51276, 1292, 416, 9, 80, "Section",ExpressionUUID->"f7fba8d2-a245-8e4e-aba8-b5877eacbaf4",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[51717, 1305, 325, 8, 67, "Subsection",ExpressionUUID->"851c16e6-94ac-3648-a05d-c81e2872b0c5",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[52045, 1315, 7261, 184, 289, "Input",ExpressionUUID->"4aa1045c-2dac-174f-8c6e-b96856e5f13e",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[64192, 1641, 307, 7, 67, "Subsection",ExpressionUUID->"d7390003-b4ea-ff44-ab0d-985ede19c2cd",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[64502, 1650, 4597, 107, 441, "Input",ExpressionUUID->"b443d5cc-7dba-be40-9faf-007a7d55e11e",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[69160, 1764, 484, 8, 81, "Chapter",ExpressionUUID->"775c9f90-cfc2-4104-a914-805ee6203cb5",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[73034, 1869, 13314, 303, 866, "Input",ExpressionUUID->"ee40f17f-b4bb-43d0-a30f-9da27f9361c2",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[86385, 2177, 241, 5, 80, "Section",ExpressionUUID->"0c4f3b67-80f3-f24c-b5d7-9b07982e3769",
   CellTags->{"Number-of-events-computation+sensitivity", "Acceptance-computation"}],
  Cell[86629, 2184, 6144, 139, 188, "Input",ExpressionUUID->"dc74bfea-24ff-b44b-9949-00eab5b0c7a0",
   CellTags->{"Number-of-events-computation+sensitivity", "Acceptance-computation"}],
  Cell[93127, 2338, 324, 6, 80, "Section",ExpressionUUID->"ff7853ec-a854-4a03-9b03-a9ef2d7f8e39",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[93476, 2348, 388, 7, 67, "Subsection",ExpressionUUID->"973a528b-dac2-4eb0-819c-3939e7032851",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[93867, 2357, 9772, 216, 519, "Input",ExpressionUUID->"ed9378d5-1972-4ecf-a029-94d16d76a66e",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[103676, 2578, 262, 5, 67, "Subsection",ExpressionUUID->"90f400a5-a53f-4620-b2bb-0b2a8019b373",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[103963, 2587, 253, 5, 57, "Subsubsection",ExpressionUUID->"aff6e0ae-afea-aa42-92b7-e0ae7b047949",
   CellTags->{"Number-of-events-computation+sensitivity", "Acceptance-computation"}],
  Cell[104219, 2594, 3490, 87, 239, "Input",ExpressionUUID->"02dabcb5-0a51-a94f-ae07-bb624d4b7504",
   CellTags->{"Number-of-events-computation+sensitivity", "Acceptance-computation"}],
  Cell[107746, 2686, 263, 5, 57, "Subsubsection",ExpressionUUID->"7617dcc7-7638-e04e-b918-22c854d2f2aa",
   CellTags->{"Number-of-events-computation+sensitivity", "Acceptance-computation"}],
  Cell[108012, 2693, 15534, 377, 498, "Input",ExpressionUUID->"ad7d144a-73ab-4c1a-acd2-06b66fe856e6",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[123595, 3076, 284, 5, 67, "Subsection",ExpressionUUID->"b08eb94e-c944-4b4c-868e-d6afa6f49903",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[123882, 3083, 6443, 140, 358, "Input",ExpressionUUID->"3457eb9e-7b37-420f-8d27-350e94706731",
   CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
  Cell[130362, 3228, 309, 6, 67, "Subsection",ExpressionUUID->"9b4d2cf7-9554-4e8d-bf0e-5bc45bc7e4fd",
   CellTags->{"Number-of-events-computation+sensitivity", "Acceptance-computation"}],
  Cell[130674, 3236, 6838, 139, 327, "Input",ExpressionUUID->"49dc74a0-e549-437e-844d-546f09d15bc4",
   CellTags->{"Number-of-events-computation+sensitivity", "Acceptance-computation"}],
  Cell[137549, 3380, 335, 8, 67, "Subsection",ExpressionUUID->"75741e81-60c2-4769-95be-621ef8117a1e",
   CellTags->{"Number-of-events-computation+sensitivity", "Acceptance-computation"}],
  Cell[137887, 3390, 7416, 179, 313, "Input",ExpressionUUID->"45d46db1-d451-4a10-a413-f35599d4f890",
   CellTags->{"Number-of-events-computation+sensitivity", "Acceptance-computation"}]},
 "Sensitivity"->{
  Cell[191544, 4616, 189, 3, 84, "Title",ExpressionUUID->"2ce189e8-ece2-4e74-afba-65f86fa4e6b1",
   CellTags->"Sensitivity"],
  Cell[191758, 4623, 188, 3, 81, "Chapter",ExpressionUUID->"af6faa59-fd19-4e43-b127-96fda6871c2c",
   CellTags->"Sensitivity"],
  Cell[191949, 4628, 6542, 163, 500, "Input",ExpressionUUID->"1f2593a4-f79d-4589-b8fb-2a3e3c0366b2",
   CellTags->"Sensitivity"]},
 "Sensitivity-computation"->{
  Cell[198528, 4796, 315, 7, 81, "Chapter",ExpressionUUID->"4b6b6b16-a664-4633-a6f5-97c885c527f7",
   CellTags->"Sensitivity-computation"],
  Cell[198868, 4807, 206, 4, 80, "Section",ExpressionUUID->"603fee5f-4376-435f-a30d-66d5444bd4ab",
   CellTags->"Sensitivity-computation"],
  Cell[199077, 4813, 3732, 89, 327, "Input",ExpressionUUID->"07e4a048-2562-481d-99b1-8b50727ead91",
   CellTags->"Sensitivity-computation"],
  Cell[202846, 4907, 212, 4, 80, "Section",ExpressionUUID->"e5154548-1e1b-48d8-a1ec-1e1ea85c57d3",
   CellTags->"Sensitivity-computation"],
  Cell[203061, 4913, 15163, 360, 743, "Input",ExpressionUUID->"6d91cae4-ab09-467d-8af0-4d3a8f6dbbae",
   CellTags->"Sensitivity-computation"],
  Cell[218471, 5286, 225, 4, 80, "Section",ExpressionUUID->"a4957b2d-ca2c-0e4f-9fb7-4cd309f41135",
   CellTags->"Sensitivity-computation"],
  Cell[218699, 5292, 3836, 96, 166, "Input",ExpressionUUID->"211a98d1-4019-414f-b0d1-f1c56cd4df69",
   CellTags->"Sensitivity-computation"],
  Cell[222572, 5393, 255, 5, 80, "Section",ExpressionUUID->"a4fa0d4e-b9fa-ee4c-b3df-03c7c29c49e8",
   CellTags->"Sensitivity-computation"],
  Cell[222830, 5400, 4774, 111, 156, "Input",ExpressionUUID->"b8aab91f-21dd-db4a-836c-b79b7ef9b0b7",
   CellTags->"Sensitivity-computation"],
  Cell[227653, 5517, 210, 4, 81, "Chapter",ExpressionUUID->"742f7a10-6bda-4531-8fc5-a3f03e574d3b",
   CellTags->"Sensitivity-computation"],
  Cell[227888, 5525, 253, 5, 80, "Section",ExpressionUUID->"e44ac122-0059-4356-b219-a9e2d60e3ba8",
   CellTags->"Sensitivity-computation"],
  Cell[228144, 5532, 2406, 64, 232, "Input",ExpressionUUID->"5f1f448b-9c06-40bf-91d3-bf789e46daf0",
   CellTags->"Sensitivity-computation"],
  Cell[230587, 5601, 352, 6, 80, "Section",ExpressionUUID->"cb8c9da8-0737-4936-9e5b-431a16e30520",
   CellTags->"Sensitivity-computation"],
  Cell[230964, 5611, 269, 5, 67, "Subsection",ExpressionUUID->"c5c807e9-ed95-954c-868e-705edfa39edf",
   CellTags->"Sensitivity-computation"],
  Cell[231236, 5618, 6260, 157, 431, "Input",ExpressionUUID->"7915025e-2501-5d48-a8e4-b45782c1cf1e",
   CellTags->"Sensitivity-computation"],
  Cell[237533, 5780, 315, 6, 67, "Subsection",ExpressionUUID->"ddbbf97c-e623-8f49-a856-4557a4bc5d0a",
   CellTags->"Sensitivity-computation"],
  Cell[237851, 5788, 11243, 275, 442, "Input",ExpressionUUID->"e42c711e-a973-46f4-88a9-717948c379ae",
   CellTags->"Sensitivity-computation"]}
 }
*)
(*CellTagsIndex
CellTagsIndex->{
 {"Acceptance", 250649, 6110},
 {"Number-of-events+sensitivity", 253071, 6141},
 {"Number-of-events-computation+sensitivity", 255505, 6172},
 {"Acceptance-computation", 261982, 6245},
 {"Sensitivity", 267032, 6300},
 {"Sensitivity-computation", 267447, 6307}
 }
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 207, 3, 96, "Title",ExpressionUUID->"ec489a88-8a17-4268-83b3-d4cc980d9075"],
Cell[790, 27, 5280, 126, 465, "Input",ExpressionUUID->"4fee1dbc-f123-4728-9e60-81aad253082b"]
}, Closed]],
Cell[CellGroupData[{
Cell[6107, 158, 345, 7, 84, "Title",ExpressionUUID->"c7fbc496-1765-4913-bda1-eb19f9d14ec4",
 CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
Cell[CellGroupData[{
Cell[6477, 169, 287, 6, 81, "Chapter",ExpressionUUID->"7856a6bd-3005-de41-bdc2-79f63e2bc7ab",
 CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
Cell[6767, 177, 1846, 42, 136, "Input",ExpressionUUID->"a703e3df-8d64-ce4f-8380-8f0535af55ae",
 CellTags->{"Acceptance", "Number-of-events+sensitivity"}]
}, Closed]],
Cell[CellGroupData[{
Cell[8650, 224, 227, 5, 81, "Chapter",ExpressionUUID->"142d4967-f301-4310-a32c-a4120d5d4aa9",
 CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
Cell[8880, 231, 5535, 139, 307, "Input",ExpressionUUID->"b2f3e96a-d2a2-4f84-a6a4-563b842c1e7f",
 CellTags->{"Acceptance", "Number-of-events+sensitivity"}]
}, Closed]],
Cell[CellGroupData[{
Cell[14452, 375, 656, 11, 82, "Chapter",ExpressionUUID->"d6722c5a-93b4-416a-bc00-f0c22121cd21",
 CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
Cell[CellGroupData[{
Cell[15133, 390, 285, 6, 82, "Section",ExpressionUUID->"862685fe-43b6-482e-b82b-9fcf0703194f",
 CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
Cell[15421, 398, 6161, 141, 387, "Input",ExpressionUUID->"f1d79d2e-d855-44c1-b2cc-e9413f8e981e",
 CellTags->{"Acceptance", "Number-of-events+sensitivity"}]
}, Closed]],
Cell[CellGroupData[{
Cell[21619, 544, 297, 6, 82, "Section",ExpressionUUID->"7937f012-5420-4399-b275-9d1989e428a9",
 CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
Cell[21919, 552, 3196, 71, 196, "Input",ExpressionUUID->"25cebf9b-4dec-4ac0-a975-fedfa9a7d346",
 CellTags->{"Acceptance", "Number-of-events+sensitivity"}]
}, Closed]]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[25176, 630, 306, 6, 84, "Title",ExpressionUUID->"fa4de700-3b7a-8f4d-90c0-187b066f8a23",
 CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
Cell[CellGroupData[{
Cell[25507, 640, 285, 6, 81, "Chapter",ExpressionUUID->"3e00ad76-64aa-0649-a2d2-8e26b6499e53",
 CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
Cell[25795, 648, 9515, 232, 650, "Input",ExpressionUUID->"f06baae7-16fd-c94b-a9cb-b17334c76bbd",
 CellTags->{"Acceptance", "Number-of-events+sensitivity"}]
}, Closed]],
Cell[CellGroupData[{
Cell[35347, 885, 238, 5, 82, "Chapter",ExpressionUUID->"5473bfb1-869b-a64b-86dd-5562306f09e7",
 CellTags->{"Acceptance", "Number-of-events+sensitivity"}],
Cell[35588, 892, 2050, 50, 310, "Input",ExpressionUUID->"cfd541f2-c0a1-7145-845b-c5672633bdaf",
 CellTags->{"Acceptance", "Number-of-events+sensitivity"}]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[37687, 948, 216, 4, 84, "Title",ExpressionUUID->"128d78c3-8bd2-4cc0-aade-f5ea999c5498",
 CellTags->"Number-of-events-computation+sensitivity"],
Cell[CellGroupData[{
Cell[37928, 956, 308, 6, 81, "Chapter",ExpressionUUID->"14184674-a362-4b71-85ea-2766ddc38791",
 CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
Cell[38239, 964, 760, 20, 61, "Input",ExpressionUUID->"3b60b3d0-47b7-475a-950b-e1cd90a1b696",
 CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}]
}, Closed]],
Cell[CellGroupData[{
Cell[39036, 989, 286, 6, 81, "Chapter",ExpressionUUID->"024306d0-6fd7-404c-b503-13b97cb70d6e",
 CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
Cell[39325, 997, 11926, 291, 627, "Input",ExpressionUUID->"5f950072-065f-4973-a235-bace6753e9f0",
 CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
Cell[CellGroupData[{
Cell[51276, 1292, 416, 9, 80, "Section",ExpressionUUID->"f7fba8d2-a245-8e4e-aba8-b5877eacbaf4",
 CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
Cell[CellGroupData[{
Cell[51717, 1305, 325, 8, 67, "Subsection",ExpressionUUID->"851c16e6-94ac-3648-a05d-c81e2872b0c5",
 CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
Cell[52045, 1315, 7261, 184, 289, "Input",ExpressionUUID->"4aa1045c-2dac-174f-8c6e-b96856e5f13e",
 CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
Cell[CellGroupData[{
Cell[59331, 1503, 187, 3, 43, "Subsubsection",ExpressionUUID->"cd7e9a74-7662-2449-b7b0-a0c1656eb119"],
Cell[59521, 1508, 4622, 127, 161, "Input",ExpressionUUID->"f49d69af-62a9-5e45-bec1-056a9ad186a4"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[64192, 1641, 307, 7, 67, "Subsection",ExpressionUUID->"d7390003-b4ea-ff44-ab0d-985ede19c2cd",
 CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
Cell[64502, 1650, 4597, 107, 441, "Input",ExpressionUUID->"b443d5cc-7dba-be40-9faf-007a7d55e11e",
 CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}]
}, Closed]]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[69160, 1764, 484, 8, 81, "Chapter",ExpressionUUID->"775c9f90-cfc2-4104-a914-805ee6203cb5",
 CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
Cell[CellGroupData[{
Cell[69669, 1776, 202, 3, 66, "Section",ExpressionUUID->"76394e74-850b-ae49-ad13-c00990d4dec8"],
Cell[69874, 1781, 2743, 73, 199, "Input",ExpressionUUID->"9ce80e05-97b8-ec43-a9cf-e5ee0a0e6195"],
Cell[72620, 1856, 177, 3, 28, "Input",ExpressionUUID->"2fcdccbb-a624-754c-be2e-b832e3080def"]
}, Closed]],
Cell[CellGroupData[{
Cell[72834, 1864, 197, 3, 66, "Section",ExpressionUUID->"987dbef9-3887-6f40-9278-2d276260ecb5"],
Cell[73034, 1869, 13314, 303, 866, "Input",ExpressionUUID->"ee40f17f-b4bb-43d0-a30f-9da27f9361c2",
 CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}]
}, Closed]],
Cell[CellGroupData[{
Cell[86385, 2177, 241, 5, 80, "Section",ExpressionUUID->"0c4f3b67-80f3-f24c-b5d7-9b07982e3769",
 CellTags->{"Number-of-events-computation+sensitivity", "Acceptance-computation"}],
Cell[86629, 2184, 6144, 139, 188, "Input",ExpressionUUID->"dc74bfea-24ff-b44b-9949-00eab5b0c7a0",
 CellTags->{"Number-of-events-computation+sensitivity", "Acceptance-computation"}]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[92822, 2329, 280, 5, 81, "Chapter",ExpressionUUID->"18333902-760f-4a49-b2f7-a7db0718c1c0",
 CellTags->"Number-of-events-computation+sensitivity"],
Cell[CellGroupData[{
Cell[93127, 2338, 324, 6, 80, "Section",ExpressionUUID->"ff7853ec-a854-4a03-9b03-a9ef2d7f8e39",
 CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
Cell[CellGroupData[{
Cell[93476, 2348, 388, 7, 67, "Subsection",ExpressionUUID->"973a528b-dac2-4eb0-819c-3939e7032851",
 CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
Cell[93867, 2357, 9772, 216, 519, "Input",ExpressionUUID->"ed9378d5-1972-4ecf-a029-94d16d76a66e",
 CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}]
}, Closed]],
Cell[CellGroupData[{
Cell[103676, 2578, 262, 5, 67, "Subsection",ExpressionUUID->"90f400a5-a53f-4620-b2bb-0b2a8019b373",
 CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
Cell[CellGroupData[{
Cell[103963, 2587, 253, 5, 57, "Subsubsection",ExpressionUUID->"aff6e0ae-afea-aa42-92b7-e0ae7b047949",
 CellTags->{"Number-of-events-computation+sensitivity", "Acceptance-computation"}],
Cell[104219, 2594, 3490, 87, 239, "Input",ExpressionUUID->"02dabcb5-0a51-a94f-ae07-bb624d4b7504",
 CellTags->{"Number-of-events-computation+sensitivity", "Acceptance-computation"}]
}, Closed]],
Cell[CellGroupData[{
Cell[107746, 2686, 263, 5, 57, "Subsubsection",ExpressionUUID->"7617dcc7-7638-e04e-b918-22c854d2f2aa",
 CellTags->{"Number-of-events-computation+sensitivity", "Acceptance-computation"}],
Cell[108012, 2693, 15534, 377, 498, "Input",ExpressionUUID->"ad7d144a-73ab-4c1a-acd2-06b66fe856e6",
 CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[123595, 3076, 284, 5, 67, "Subsection",ExpressionUUID->"b08eb94e-c944-4b4c-868e-d6afa6f49903",
 CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}],
Cell[123882, 3083, 6443, 140, 358, "Input",ExpressionUUID->"3457eb9e-7b37-420f-8d27-350e94706731",
 CellTags->{"Acceptance-computation", "Number-of-events-computation+sensitivity"}]
}, Closed]],
Cell[CellGroupData[{
Cell[130362, 3228, 309, 6, 67, "Subsection",ExpressionUUID->"9b4d2cf7-9554-4e8d-bf0e-5bc45bc7e4fd",
 CellTags->{"Number-of-events-computation+sensitivity", "Acceptance-computation"}],
Cell[130674, 3236, 6838, 139, 327, "Input",ExpressionUUID->"49dc74a0-e549-437e-844d-546f09d15bc4",
 CellTags->{"Number-of-events-computation+sensitivity", "Acceptance-computation"}]
}, Closed]],
Cell[CellGroupData[{
Cell[137549, 3380, 335, 8, 67, "Subsection",ExpressionUUID->"75741e81-60c2-4769-95be-621ef8117a1e",
 CellTags->{"Number-of-events-computation+sensitivity", "Acceptance-computation"}],
Cell[137887, 3390, 7416, 179, 313, "Input",ExpressionUUID->"45d46db1-d451-4a10-a413-f35599d4f890",
 CellTags->{"Number-of-events-computation+sensitivity", "Acceptance-computation"}]
}, Closed]],
Cell[CellGroupData[{
Cell[145340, 3574, 232, 4, 67, "Subsection",ExpressionUUID->"180acaf6-75e1-4bab-82db-d1998deec424",
 CellTags->"Number-of-events-computation+sensitivity"],
Cell[145575, 3580, 22439, 499, 1075, "Input",ExpressionUUID->"4978bbd4-63cc-4b59-ac79-ded561ee9c78",
 CellTags->"Number-of-events-computation+sensitivity"]
}, Closed]]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[168075, 4086, 152, 3, 67, "Chapter",ExpressionUUID->"421b5663-9f38-a446-82c9-dfcc3e9f6602"],
Cell[CellGroupData[{
Cell[168252, 4093, 298, 5, 66, "Section",ExpressionUUID->"f794792d-e057-42b4-9ecc-1e217fb91113"],
Cell[168553, 4100, 11521, 258, 374, "Input",ExpressionUUID->"3698028a-a816-4e62-b33a-d297be011465"]
}, Closed]]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[180135, 4365, 236, 4, 84, "Title",ExpressionUUID->"f5136f97-573d-41ec-bafe-cbcb903e581e",
 CellTags->"Number-of-events-computation+sensitivity"],
Cell[CellGroupData[{
Cell[180396, 4373, 213, 4, 81, "Chapter",ExpressionUUID->"75cf786b-3cae-4471-be7d-a8f2b6c6b657",
 CellTags->"Number-of-events-computation+sensitivity"],
Cell[180612, 4379, 6515, 130, 373, "Input",ExpressionUUID->"7723a626-82c5-4cfa-9029-8486e71b92ea",
 CellTags->"Number-of-events-computation+sensitivity"]
}, Closed]],
Cell[CellGroupData[{
Cell[187164, 4514, 209, 4, 81, "Chapter",ExpressionUUID->"df5e70ae-73d2-4cb0-8325-e3fe55e2f51a",
 CellTags->"Number-of-events-computation+sensitivity"],
Cell[187376, 4520, 4119, 90, 270, "Input",ExpressionUUID->"a4642c06-b9e9-48ef-a903-598c93461b6b",
 CellTags->"Number-of-events-computation+sensitivity"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[191544, 4616, 189, 3, 84, "Title",ExpressionUUID->"2ce189e8-ece2-4e74-afba-65f86fa4e6b1",
 CellTags->"Sensitivity"],
Cell[CellGroupData[{
Cell[191758, 4623, 188, 3, 81, "Chapter",ExpressionUUID->"af6faa59-fd19-4e43-b127-96fda6871c2c",
 CellTags->"Sensitivity"],
Cell[191949, 4628, 6542, 163, 500, "Input",ExpressionUUID->"1f2593a4-f79d-4589-b8fb-2a3e3c0366b2",
 CellTags->"Sensitivity"]
}, Closed]],
Cell[CellGroupData[{
Cell[198528, 4796, 315, 7, 81, "Chapter",ExpressionUUID->"4b6b6b16-a664-4633-a6f5-97c885c527f7",
 CellTags->"Sensitivity-computation"],
Cell[CellGroupData[{
Cell[198868, 4807, 206, 4, 80, "Section",ExpressionUUID->"603fee5f-4376-435f-a30d-66d5444bd4ab",
 CellTags->"Sensitivity-computation"],
Cell[199077, 4813, 3732, 89, 327, "Input",ExpressionUUID->"07e4a048-2562-481d-99b1-8b50727ead91",
 CellTags->"Sensitivity-computation"]
}, Closed]],
Cell[CellGroupData[{
Cell[202846, 4907, 212, 4, 80, "Section",ExpressionUUID->"e5154548-1e1b-48d8-a1ec-1e1ea85c57d3",
 CellTags->"Sensitivity-computation"],
Cell[203061, 4913, 15163, 360, 743, "Input",ExpressionUUID->"6d91cae4-ab09-467d-8af0-4d3a8f6dbbae",
 CellTags->"Sensitivity-computation"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[218273, 5279, 173, 3, 67, "Chapter",ExpressionUUID->"ed312daa-7aef-6343-b2d9-7c866c1a28f8"],
Cell[CellGroupData[{
Cell[218471, 5286, 225, 4, 80, "Section",ExpressionUUID->"a4957b2d-ca2c-0e4f-9fb7-4cd309f41135",
 CellTags->"Sensitivity-computation"],
Cell[218699, 5292, 3836, 96, 166, "Input",ExpressionUUID->"211a98d1-4019-414f-b0d1-f1c56cd4df69",
 CellTags->"Sensitivity-computation"]
}, Closed]],
Cell[CellGroupData[{
Cell[222572, 5393, 255, 5, 80, "Section",ExpressionUUID->"a4fa0d4e-b9fa-ee4c-b3df-03c7c29c49e8",
 CellTags->"Sensitivity-computation"],
Cell[222830, 5400, 4774, 111, 156, "Input",ExpressionUUID->"b8aab91f-21dd-db4a-836c-b79b7ef9b0b7",
 CellTags->"Sensitivity-computation"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[227653, 5517, 210, 4, 81, "Chapter",ExpressionUUID->"742f7a10-6bda-4531-8fc5-a3f03e574d3b",
 CellTags->"Sensitivity-computation"],
Cell[CellGroupData[{
Cell[227888, 5525, 253, 5, 80, "Section",ExpressionUUID->"e44ac122-0059-4356-b219-a9e2d60e3ba8",
 CellTags->"Sensitivity-computation"],
Cell[228144, 5532, 2406, 64, 232, "Input",ExpressionUUID->"5f1f448b-9c06-40bf-91d3-bf789e46daf0",
 CellTags->"Sensitivity-computation"]
}, Closed]],
Cell[CellGroupData[{
Cell[230587, 5601, 352, 6, 80, "Section",ExpressionUUID->"cb8c9da8-0737-4936-9e5b-431a16e30520",
 CellTags->"Sensitivity-computation"],
Cell[CellGroupData[{
Cell[230964, 5611, 269, 5, 67, "Subsection",ExpressionUUID->"c5c807e9-ed95-954c-868e-705edfa39edf",
 CellTags->"Sensitivity-computation"],
Cell[231236, 5618, 6260, 157, 431, "Input",ExpressionUUID->"7915025e-2501-5d48-a8e4-b45782c1cf1e",
 CellTags->"Sensitivity-computation"]
}, Closed]],
Cell[CellGroupData[{
Cell[237533, 5780, 315, 6, 67, "Subsection",ExpressionUUID->"ddbbf97c-e623-8f49-a856-4557a4bc5d0a",
 CellTags->"Sensitivity-computation"],
Cell[237851, 5788, 11243, 275, 442, "Input",ExpressionUUID->"e42c711e-a973-46f4-88a9-717948c379ae",
 CellTags->"Sensitivity-computation"]
}, Closed]]
}, Closed]]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[249167, 6071, 171, 3, 70, "Title",ExpressionUUID->"268b5966-c044-471d-8d66-d25b1ca611fc"],
Cell[249341, 6076, 842, 17, 66, "Input",ExpressionUUID->"00a97c9c-fda1-4a59-a10c-e35c97e449fb"]
}, Closed]]
}
]
*)

