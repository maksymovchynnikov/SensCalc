(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[   1307084,      31858]
NotebookOptionsPosition[   1217694,      30206]
NotebookOutlinePosition[   1251764,      30750]
CellTagsIndexPosition[   1251687,      30745]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Launch this section to run the notebook", "Title",
 CellChangeTimes->{{3.8934376452895875`*^9, 3.893437664450907*^9}, 
   3.895121907004884*^9, {3.9137149428245144`*^9, 
   3.913714947095945*^9}},ExpressionUUID->"3ad7abe4-49cc-42b5-bac5-\
0bcccffa73c5"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ParallelEvaluate", "[", 
   RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CloseKernels", "[", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"LaunchKernels", "[", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"FrontEndTokenExecute", "[", "\"\<SelectAll\>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"FrontEndTokenExecute", "[", "\"\<SelectionCloseAllGroups\>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nb", "=", 
   RowBox[{"EvaluationNotebook", "[", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"NotebookFind", "[", 
   RowBox[{"nb", ",", "\"\<Evaluation\>\"", ",", "All", ",", "CellTags"}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"SelectionEvaluate", "[", "nb", "]"}]}], "Input",
 CellChangeTimes->{{3.893437585709897*^9, 3.893437589536964*^9}, {
   3.8934376329497385`*^9, 3.893437658846809*^9}, {3.893665323405223*^9, 
   3.8936653242032266`*^9}, {3.893868353419922*^9, 3.893868353779658*^9}, {
   3.894207913237548*^9, 3.8942079138180323`*^9}, {3.916853046235703*^9, 
   3.9168530464770765`*^9}, 3.917165183937353*^9},
 CellLabel->
  "In[670]:=",ExpressionUUID->"6fc3bbf2-99e6-4e07-be13-873a72c87351"],

Cell[BoxData[
 FormBox[
  TemplateBox[{
   "KernelObject", "timekernels", 
    "\"Timeout for subkernels. Received only \\!\\(\\*FormBox[\\\"0\\\", \
TraditionalForm]\\) of \\!\\(\\*FormBox[\\\"4\\\", TraditionalForm]\\) \
connections.\"", 2, 671, 16, 29079336519732941073, "Local"},
   "MessageTemplate"], TraditionalForm]], "Message", "MSG",
 CellChangeTimes->{3.930822665270398*^9},
 CellLabel->
  "Durante la evaluaci\[OAcute]n de \
In[670]:=",ExpressionUUID->"ebf4d63f-ae6e-4bf5-b051-f030cee3309e"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Preliminary code: various definitions", "Title",
 CellChangeTimes->{{3.8777151922241173`*^9, 3.877715194750234*^9}, {
   3.8877839989301867`*^9, 3.8877840040009236`*^9}, {3.893298574221834*^9, 
   3.89329857463517*^9}, {3.893487854013983*^9, 3.893487854226225*^9}, 
   3.9134358431761165`*^9, {3.913714914062038*^9, 3.913714916917398*^9}},
 CellTags->
  "Evaluation",ExpressionUUID->"9f74c6f1-3857-4415-bd05-374f4b0a6d43"],

Cell[CellGroupData[{

Cell["Creating relevant directories and critical definitions", "Chapter",
 CellChangeTimes->{{3.885440177038927*^9, 3.8854401808610473`*^9}, {
  3.913264315435433*^9, 3.9132643198366766`*^9}},
 CellTags->
  "Evaluation",ExpressionUUID->"4350f6b8-70ba-426b-b952-c2d172f0b593"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"SetAttributes", "[", 
   RowBox[{"ruleDown", ",", "HoldAll"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ruleDown", "[", "list_", "]"}], ":=", 
  RowBox[{"Flatten", "[", 
   RowBox[{"DownValues", "/@", 
    RowBox[{"(", 
     RowBox[{"Unevaluated", "@", "list"}], ")"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetAttributes", "[", 
   RowBox[{"ruleOwn", ",", "HoldAll"}], "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"ruleOwn", "[", "list_", "]"}], ":=", 
  RowBox[{"Flatten", "[", 
   RowBox[{"OwnValues", "/@", 
    RowBox[{"(", 
     RowBox[{"Unevaluated", "@", "list"}], ")"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"<<", "FeynCalc`"}]}], "Input",
 CellChangeTimes->{{3.913264380447282*^9, 3.9132643905454407`*^9}, {
   3.91326447738668*^9, 3.913264504245299*^9}, {3.913264538252445*^9, 
   3.9132645541756*^9}, 3.913708590638978*^9, {3.913709334450181*^9, 
   3.9137094842651663`*^9}, {3.9137100089545946`*^9, 3.9137100294168863`*^9}},
 
 CellTags->"Evaluation",
 CellLabel->
  "In[679]:=",ExpressionUUID->"164a4a0f-e0b1-4b2d-91f1-566d65334670"],

Cell[BoxData[
 FormBox[
  StyleBox["\<\"FeynCalc is already loaded! If you are trying to reload \
FeynCalc or load FeynArts, TARCER, PHI, FeynHelpers or any other add-on, \
please restart the kernel.\"\>", "Text",
   StripOnInput->False,
   LineColor->RGBColor[1, 0, 0],
   FrontFaceColor->RGBColor[1, 0, 0],
   BackFaceColor->RGBColor[1, 0, 0],
   GraphicsColor->RGBColor[1, 0, 0],
   FontWeight->Bold,
   FontColor->RGBColor[1, 0, 0]], TraditionalForm]], "Print",
 CellChangeTimes->{3.930211448566579*^9, 3.9308226731480703`*^9},
 CellTags->"Evaluation",
 CellLabel->
  "Durante la evaluaci\[OAcute]n de \
In[679]:=",ExpressionUUID->"6ec5e9b5-62f4-414a-93e3-efa74abdc54f"],

Cell[BoxData[
 FormBox["$Aborted", TraditionalForm]], "Output",
 CellChangeTimes->{3.930211448570594*^9, 3.9308226731510677`*^9},
 CellTags->"Evaluation",
 CellLabel->
  "Out[683]=",ExpressionUUID->"a78a7710-8828-457c-bc1c-74b8104edab4"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Parameters", "Chapter",
 CellChangeTimes->{{3.8777157242821283`*^9, 3.8777157256793776`*^9}},
 CellTags->
  "Evaluation",ExpressionUUID->"f8243e93-a44c-4fe5-894e-0743d4884863"],

Cell[CellGroupData[{

Cell["Conversion units", "Section",
 CellChangeTimes->{{3.885744053238254*^9, 3.8857440558314605`*^9}},
 CellTags->
  "Evaluation",ExpressionUUID->"80187575-21b6-468f-8e4a-db311a554398"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"GeVm2Topb", "=", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"2", "*", 
       SuperscriptBox["10", 
        RowBox[{"-", "16"}]]}], ")"}], "2"], "*", 
    SuperscriptBox["10", "28"], "*", 
    SuperscriptBox["10", "12."]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"GeVm2Tob", "=", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"2", "*", 
       SuperscriptBox["10", 
        RowBox[{"-", "16"}]]}], ")"}], "2"], "*", 
    SuperscriptBox["10", "28"]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Alpha]EMval", "=", 
   RowBox[{"1", "/", "137."}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.885744058610577*^9, 3.885744059307773*^9}, {
  3.913455921683243*^9, 3.913455925345123*^9}},
 CellTags->"Evaluation",
 CellLabel->
  "In[684]:=",ExpressionUUID->"a1ffc0dc-1570-4f50-ba14-bbefddbce453"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Kinematics at various beam dump facilities", "Section",
 CellChangeTimes->{{3.885956269169467*^9, 3.885956273413191*^9}, {
  3.8859564258946333`*^9, 3.88595643064175*^9}},
 CellTags->
  "Evaluation",ExpressionUUID->"802f0307-65bf-44e4-9bdd-603d6615efc3"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"FacilitiesList", "=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "\"\<FermilabBD\>\"", ",", "\"\<SPS\>\"", ",", "\"\<LHC\>\"", ",", 
      "\"\<FCC-hh\>\"", ",", "\"\<Serpukhov\>\"", ",", "\"\<ESS\>\"", ",", 
      " ", "\"\<LHC_fixed_target\>\""}], "}"}], "//", "Sort"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"EmaxFacility", "[", "\"\<SPS\>\"", "]"}], "=", "400."}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"EmaxFacility", "[", "\"\<FermilabBD\>\"", "]"}], "=", "120."}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"EmaxFacility", "[", "\"\<Serpukhov\>\"", "]"}], "=", "70."}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"EmaxFacility", "[", "\"\<LHC\>\"", "]"}], "=", "6500."}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"EmaxFacility", "[", "\"\<FCC-hh\>\"", "]"}], "=", "50000."}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"EmaxFacility", "[", "\"\<ESS\>\"", "]"}], "=", "2."}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"EmaxFacility", "[", "\"\<LHC_fixed_target\>\"", "]"}], "=", 
   "7000."}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"EcmFacility", "[", "Fac", "]"}], "=", 
    SqrtBox[
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"EmaxFacility", "[", "Fac", "]"}], "+", "0.938"}], ")"}], 
       "2"], "-", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"EmaxFacility", "[", "Fac", "]"}], "2"], "-", 
        SuperscriptBox["0.938", "2"]}], ")"}]}]]}], "\[IndentingNewLine]", 
   ",", 
   RowBox[{"{", 
    RowBox[{"Fac", ",", 
     RowBox[{"{", 
      RowBox[{
      "\"\<Serpukhov\>\"", ",", "\"\<SPS\>\"", ",", "\"\<FermilabBD\>\"", 
       ",", "\"\<ESS\>\"", ",", " ", "\"\<LHC_fixed_target\>\""}], "}"}]}], 
    "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"EcmFacility", "[", "Fac", "]"}], "=", 
     RowBox[{"2", 
      RowBox[{"EmaxFacility", "[", "Fac", "]"}]}]}], ",", 
    RowBox[{"{", 
     RowBox[{"Fac", ",", 
      RowBox[{"{", 
       RowBox[{"\"\<LHC\>\"", ",", "\"\<FCC-hh\>\""}], "}"}]}], "}"}]}], 
   "]"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"vCMbeamDump", "[", 
    RowBox[{"Eplab_", ",", "MP_"}], "]"}], "=", 
   RowBox[{"v", "/.", 
    RowBox[{
     RowBox[{"Solve", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         SqrtBox[
          RowBox[{
           SuperscriptBox["Eplab", "2"], "-", 
           SuperscriptBox["MP", "2"]}]], "-", 
         RowBox[{"Eplab", "*", "v"}]}], "\[Equal]", 
        RowBox[{"MP", "*", "v"}]}], ",", "v"}], "]"}], "[", 
     RowBox[{"[", "1", "]"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Gamma]CMbeamDump", "[", 
    RowBox[{"Eplab_", ",", "MP_"}], "]"}], "=", 
   RowBox[{
    FractionBox["1", 
     SqrtBox[
      RowBox[{"1", "-", 
       SuperscriptBox[
        RowBox[{"vCMbeamDump", "[", 
         RowBox[{"Eplab", ",", "MP"}], "]"}], "2"]}]]], "//", "Simplify"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.885956287725476*^9, 3.885956331130493*^9}, {
   3.885956388100589*^9, 3.8859564327334337`*^9}, {3.8859566482232037`*^9, 
   3.885956673430411*^9}, {3.885958115934278*^9, 3.885958210482833*^9}, {
   3.888572595838107*^9, 3.888572599817439*^9}, 3.893520672986038*^9, 
   3.893521035983716*^9, {3.910413928575221*^9, 3.910413936623124*^9}, {
   3.9132712210700808`*^9, 3.913271222090616*^9}, 3.9132864631898923`*^9, {
   3.913286494131795*^9, 3.913286542902949*^9}, {3.913286633869104*^9, 
   3.9132866596430326`*^9}, {3.9133684189545975`*^9, 3.913368552735506*^9}, {
   3.914832362538298*^9, 3.914832377256514*^9}, 3.914832913095679*^9, 
   3.915705253775929*^9, {3.930823062750761*^9, 3.930823094833708*^9}, {
   3.930823352329474*^9, 3.930823369312973*^9}},
 CellTags->
  "Evaluation",ExpressionUUID->"ce0d3f6c-f69d-4974-bd82-3355d8c6b198"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Fragmentation fractions of mesons", "Section",
 CellChangeTimes->{{3.877715778590942*^9, 3.877715784221675*^9}},
 CellTags->
  "Evaluation",ExpressionUUID->"16dbf08b-1200-4ac4-ad9a-ed04d15b41ef"],

Cell[CellGroupData[{

Cell["LHC and FCC-hh", "Subsection",
 CellChangeTimes->{{3.877715793467651*^9, 3.877715793702867*^9}, {
  3.888575444983039*^9, 3.888575447568259*^9}},
 CellTags->
  "Evaluation",ExpressionUUID->"be5850ea-72d1-4eb6-b945-f4862fadb6d4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Fragmentation", " ", "fractions"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"fdstau", " ", "=", " ", "0.0543"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"fctod0", "[", "\"\<LHC\>\"", "]"}], "=", 
     RowBox[{
      RowBox[{"fctod0", "[", "\"\<FCC-hh\>\"", "]"}], "=", "0.553"}]}], ";"}],
    "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"fctodplus", "[", "\"\<LHC\>\"", "]"}], "=", 
     RowBox[{
      RowBox[{"fctodplus", "[", "\"\<FCC-hh\>\"", "]"}], " ", "=", " ", 
      "0.225"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      SubscriptBox["D", "s"], " ", "mesons"}], " ", "-", " ", 
     RowBox[{"including", " ", 
      SuperscriptBox[
       SubscriptBox["D", "s"], "*"], " ", "contribution"}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"fctods", "[", "\"\<LHC\>\"", "]"}], "=", 
     RowBox[{
      RowBox[{"fctods", "[", "\"\<FCC-hh\>\"", "]"}], "=", "0.105"}]}], ";"}],
    "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"fbtobc", "[", "\"\<LHC\>\"", "]"}], "=", 
     RowBox[{
      RowBox[{"fbtobc", "[", "\"\<FCC-hh\>\"", "]"}], "=", " ", 
      RowBox[{"2.6", "*", 
       SuperscriptBox["10", 
        RowBox[{"-", "3"}]]}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"fbtob0", "[", "\"\<LHC\>\"", "]"}], "=", 
     RowBox[{
      RowBox[{"fbtobplus", "[", "\"\<LHC\>\"", "]"}], "=", 
      RowBox[{
       RowBox[{"fbtob0", "[", "\"\<FCC-hh\>\"", "]"}], "=", 
       RowBox[{
        RowBox[{"fbtobplus", "[", "\"\<FCC-hh\>\"", "]"}], "=", 
        "0.324"}]}]}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.824285433645004*^9, 3.824285446955875*^9}, {
  3.888575449118577*^9, 3.888575478250161*^9}, {3.9132694653727913`*^9, 
  3.9132695105449934`*^9}},
 CellTags->"Evaluation",
 CellLabel->
  "In[698]:=",ExpressionUUID->"57b13a59-bbda-47bd-bcb1-94321ca663e9"]
}, Open  ]],

Cell[CellGroupData[{

Cell["SPS", "Subsection",
 CellChangeTimes->{{3.877715802039713*^9, 3.877715802196947*^9}},
 CellTags->
  "Evaluation",ExpressionUUID->"22b5bbc3-3951-46d3-ad9a-83114d344b4c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"fctod0", "[", "\"\<SPS\>\"", "]"}], "=", " ", "0.632"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"fctodplus", "[", "\"\<SPS\>\"", "]"}], "=", "0.207"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"fctods", "[", "\"\<SPS\>\"", "]"}], "=", "0.088"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"fbtobplus", "[", "\"\<SPS\>\"", "]"}], "=", "0.4"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"fbtob0", "[", "\"\<SPS\>\"", "]"}], "=", "0.4"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"fbtobc", "[", "\"\<SPS\>\"", "]"}], "=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NccbarSHiP", " ", "=", " ", 
   RowBox[{"2.3", "*", "3.4", "*", 
    SuperscriptBox["10", "17"]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NbbbarSHiP", " ", "=", " ", 
   RowBox[{"1.7", "*", "3.2", "*", 
    SuperscriptBox["10", "13"]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NpotSHiP", "=", 
   RowBox[{"2", "*", 
    SuperscriptBox["10", "20"]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Chi]bbbarSPS", "=", 
   FractionBox["NbbbarSHiP", "NpotSHiP"]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Chi]ccbarSPS", "=", 
   FractionBox["NccbarSHiP", "NpotSHiP"]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Chi]ssbarSPS", "=", 
   FractionBox["1", "7"]}], ";"}]}], "Input",
 CellChangeTimes->{{3.913269518106952*^9, 3.913269526708232*^9}, {
  3.913269560631452*^9, 3.913269564226587*^9}},
 CellTags->"Evaluation",
 CellLabel->
  "In[704]:=",ExpressionUUID->"d9f77161-a435-4e0d-a1e7-77d7f183b93b"]
}, Open  ]],

Cell[CellGroupData[{

Cell["FermilabBD (assumed to be the same as at SPS; to be fixed)", \
"Subsection",
 CellChangeTimes->{{3.877715802039713*^9, 3.877715802196947*^9}, {
  3.893577176476961*^9, 3.89357717897411*^9}, {3.8935786632797337`*^9, 
  3.8935786709876175`*^9}},
 CellTags->
  "Evaluation",ExpressionUUID->"095611fb-9a2e-4c4f-91d9-5d2e63f6be49"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"fctod0", "[", "\"\<FermilabBD\>\"", "]"}], "=", " ", "0.632"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"fctodplus", "[", "\"\<FermilabBD\>\"", "]"}], "=", "0.207"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"fctods", "[", "\"\<FermilabBD\>\"", "]"}], "=", "0.088"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"fbtobplus", "[", "\"\<FermilabBD\>\"", "]"}], "=", "0.4"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"fbtob0", "[", "\"\<FermilabBD\>\"", "]"}], "=", "0.4"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"fbtobc", "[", "\"\<FermilabBD\>\"", "]"}], "=", "0"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.8935771814640203`*^9, 3.89357720422649*^9}, {
  3.913269536485689*^9, 3.9132695769711275`*^9}, {3.930989724930991*^9, 
  3.9309897254748697`*^9}},
 CellTags->
  "Evaluation",ExpressionUUID->"79c3c6d2-bec6-41b6-9818-7d5c26b7676d"]
}, Open  ]],

Cell[CellGroupData[{

Cell["LHC_fixed_target", "Subsection",
 CellChangeTimes->{{3.9309897483425293`*^9, 
  3.930989756340974*^9}},ExpressionUUID->"239b0731-d9a0-413a-a3de-\
2e64f11459dd"],

Cell[BoxData[""], "Input",ExpressionUUID->"5b3fec8b-320e-4e23-b87c-6ac77025406a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"fctod0", "[", "\"\<SPS\>\"", "]"}], "=", " ", "0.593"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"fctodplus", "[", "\"\<SPS\>\"", "]"}], "=", "0.287"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"fctods", "[", "\"\<SPS\>\"", "]"}], "=", "0.086"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"fbtobplus", "[", "\"\<SPS\>\"", "]"}], "=", "0.4"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"fbtob0", "[", "\"\<SPS\>\"", "]"}], "=", "0.4"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"fbtobc", "[", "\"\<SPS\>\"", "]"}], "=", "0"}], ";"}]}], "Input",
 CellChangeTimes->{{3.9309897828703623`*^9, 
  3.93098979346754*^9}},ExpressionUUID->"c1207ebb-e6f9-40a5-a407-\
6f08a7175e21"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Masses and other parameters of SM particles", "Section",
 CellChangeTimes->{{3.877715894036441*^9, 3.8777158978751707`*^9}, {
  3.885915513152887*^9, 3.8859155163852773`*^9}, {3.8864390681952677`*^9, 
  3.88643907576572*^9}},
 CellTags->
  "Evaluation",ExpressionUUID->"e56a72b1-83e0-4714-b342-2b505f68174b"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "SetDirectory", "[", 
     "\"\</Users/miksi/AppData/Roaming/Mathematica/Applications/FeynCalc\>\"",
      "]"}], ";"}], "*)"}], "\n", 
  RowBox[{
   RowBox[{"<<", "FeynCalc`"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"mSM", "[", "\"\<Bplus\>\"", "]"}], ",", 
       RowBox[{"mSM", "[", "\"\<B0\>\"", "]"}], ",", 
       RowBox[{"mSM", "[", "\"\<Bs\>\"", "]"}], ",", 
       RowBox[{"mSM", "[", "\"\<Bc\>\"", "]"}]}], "}"}], "=", 
     RowBox[{"{", 
      RowBox[{"5.279", ",", "5.279", ",", "5.366", ",", "6.3"}], "}"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"mSM", "[", "\"\<e\>\"", "]"}], ",", 
       RowBox[{"mSM", "[", "\"\<mu\>\"", "]"}], ",", 
       RowBox[{"mSM", "[", "\"\<tau\>\"", "]"}], ",", 
       RowBox[{"mSM", "[", "\"\<neutrino\>\"", "]"}], ",", 
       RowBox[{"mSM", "[", "\"\<photon\>\"", "]"}]}], "}"}], "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"0.5", "*", 
        SuperscriptBox["10", 
         RowBox[{"-", "3"}]]}], ",", "0.105", ",", "1.77", ",", "0.", ",", 
       "0."}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"mSM", "[", "\"\<h\>\"", "]"}], ",", 
       RowBox[{"mSM", "[", "\"\<W\>\"", "]"}], ",", 
       RowBox[{"mSM", "[", "\"\<Z\>\"", "]"}]}], "}"}], "=", 
     RowBox[{"{", 
      RowBox[{"125.", ",", "80.", ",", "91."}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"mSM", "[", "\"\<Pi0\>\"", "]"}], ",", 
       RowBox[{"mSM", "[", "\"\<Eta\>\"", "]"}], ",", 
       RowBox[{"mSM", "[", "\"\<EtaPr\>\"", "]"}]}], "}"}], "=", 
     RowBox[{"{", 
      RowBox[{"0.135", ",", "0.547", ",", "0.958"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"mSM", "[", "\"\<PiCharged\>\"", "]"}], ",", 
       RowBox[{"mSM", "[", "\"\<Kplus\>\"", "]"}], ",", 
       RowBox[{"mSM", "[", "\"\<K0\>\"", "]"}]}], "}"}], "=", 
     RowBox[{"{", 
      RowBox[{"0.139", ",", "0.495", ",", "0.495"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"mSM", "[", "\"\<Rho0\>\"", "]"}], ",", 
       RowBox[{"mSM", "[", "\"\<Omega\>\"", "]"}], ",", 
       RowBox[{"mSM", "[", "\"\<Phi\>\"", "]"}], ",", 
       RowBox[{"mSM", "[", "\"\<JPsi\>\"", "]"}], ",", 
       RowBox[{"mSM", "[", "\"\<Upsilon\>\"", "]"}]}], "}"}], "=", 
     RowBox[{"{", 
      RowBox[{"0.775", ",", "0.775", ",", "1.02", ",", "3.1", ",", "9.46"}], 
      "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"mSM", "[", "\"\<D0\>\"", "]"}], ",", 
       RowBox[{"mSM", "[", "\"\<Ds\>\"", "]"}], ",", 
       RowBox[{"mSM", "[", "\"\<Dstar\>\"", "]"}], ",", 
       RowBox[{"mSM", "[", "\"\<Dplus\>\"", "]"}]}], "}"}], "=", 
     RowBox[{"{", 
      RowBox[{"1.87", ",", "1.97", ",", "2.", ",", "1.87"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"mSM", "[", "\"\<p\>\"", "]"}], "}"}], "=", 
     RowBox[{"{", "0.938", "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"SMparticles", "=", 
    RowBox[{
     RowBox[{"Keys", "[", 
      RowBox[{"DownValues", "@", "mSM"}], "]"}], "[", 
     RowBox[{"[", 
      RowBox[{"All", ",", "1", ",", "1"}], "]"}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Whether", " ", "the", " ", "given", " ", "SM", " ", "particle", " ", 
     "may", " ", "be", " ", "produced", " ", "at", " ", "the", " ", "fiven", 
     " ", "facility"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"Do", "[", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{
      "How", " ", "many", " ", "particles", " ", "are", " ", "produced", " ", 
       "per", " ", "direct", " ", "production", " ", "process"}], ";", " ", 
      RowBox[{
      "the", " ", "lowest", " ", "possible", " ", "number", " ", "is", " ", 
       "considered"}]}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"nSMperProd", "[", "particle", "]"}], "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"StringContainsQ", "[", 
           RowBox[{"particle", ",", "\"\<B\>\""}], "]"}], "||", 
          RowBox[{"StringContainsQ", "[", 
           RowBox[{"particle", ",", "\"\<D\>\""}], "]"}], "||", 
          RowBox[{"StringContainsQ", "[", 
           RowBox[{"particle", ",", "\"\<K\>\""}], "]"}]}], ",", "2", ",", 
         "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"IfSMatFacility", "[", 
           RowBox[{"particle", ",", "Facility"}], "]"}], "=", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"nSMperProd", "[", "particle", "]"}], "*", 
              RowBox[{"mSM", "[", "particle", "]"}]}], ">", 
             RowBox[{"EcmFacility", "[", "Facility", "]"}]}], ",", "0", ",", 
            "1"}], "]"}]}], ";"}], "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"Facility", ",", "FacilitiesList"}], "}"}]}], "]"}]}], 
     "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{"particle", ",", "SMparticles"}], "}"}]}], "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"fbtobc", "[", "Facility", "]"}], "==", "0."}], ",", 
       RowBox[{
        RowBox[{"IfSMatFacility", "[", 
         RowBox[{"\"\<Bc\>\"", ",", "Facility"}], "]"}], "=", "0"}]}], "]"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"Facility", ",", "FacilitiesList"}], "}"}]}], "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Parameters", " ", "of", " ", "nuclei"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"mnucleus", "[", "\"\<Mo\>\"", "]"}], ",", 
       RowBox[{"anucleus", "[", "\"\<Mo\>\"", "]"}], ",", 
       RowBox[{"znucleus", "[", "\"\<Mo\>\"", "]"}]}], "}"}], "=", 
     RowBox[{"{", 
      RowBox[{"89.38", ",", "96", ",", "42"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"mnucleus", "[", "\"\<Fe\>\"", "]"}], ",", 
       RowBox[{"anucleus", "[", "\"\<Fe\>\"", "]"}], ",", 
       RowBox[{"znucleus", "[", "\"\<Fe\>\"", "]"}]}], "}"}], "=", 
     RowBox[{"{", 
      RowBox[{"54.43", ",", "56", ",", "28"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"mnucleus", "[", "\"\<C\>\"", "]"}], ",", 
       RowBox[{"anucleus", "[", "\"\<C\>\"", "]"}], ",", 
       RowBox[{"znucleus", "[", "\"\<C\>\"", "]"}]}], "}"}], "=", 
     RowBox[{"{", 
      RowBox[{"11.188", ",", "12", ",", "6"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Br", " ", "ratios", " ", "of", " ", "EM", " ", "decays", " ", "of", " ", 
     "light", " ", "mesons"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Br\[Pi]To\[Gamma]\[Gamma]", "=", "0.98799"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Br\[Eta]To\[Gamma]\[Gamma]", "=", "0.3931181"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Photon", " ", "absorption", " ", "cross"}], "-", "sections"}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\[Sigma]\[Gamma]Abs", "[", "\"\<Mo\>\"", "]"}], ",", 
       RowBox[{"\[Sigma]\[Gamma]Abs", "[", "\"\<Fe\>\"", "]"}]}], "}"}], "=", 
     
     RowBox[{
      RowBox[{"{", 
       RowBox[{"12.7", ",", "5.1"}], "}"}], "*", 
      SuperscriptBox["GeVm2Tob", 
       RowBox[{"-", "1"}]]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Sigma]\[Gamma]Abs", "[", "\"\<C\>\"", "]"}], "=", 
     RowBox[{
      RowBox[{"\[Sigma]\[Gamma]Abs", "[", "\"\<Fe\>\"", "]"}], "*", 
      FractionBox[
       RowBox[{
        RowBox[{"znucleus", "[", "\"\<C\>\"", "]"}], "*", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"znucleus", "[", "\"\<C\>\"", "]"}], "+", "1"}], ")"}], 
        RowBox[{"Log", "[", 
         FractionBox["183", 
          SuperscriptBox[
           RowBox[{"znucleus", "[", "\"\<C\>\"", "]"}], 
           FractionBox["1", "3."]]], "]"}]}], 
       RowBox[{
        RowBox[{"znucleus", "[", "\"\<Fe\>\"", "]"}], "*", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"znucleus", "[", "\"\<Fe\>\"", "]"}], "+", "1"}], ")"}], 
        RowBox[{"Log", "[", 
         FractionBox["183", 
          SuperscriptBox[
           RowBox[{"znucleus", "[", "\"\<Fe\>\"", "]"}], 
           FractionBox["1", "3."]]], "]"}]}]]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Nucleus", "-", 
     RowBox[{"proton", " ", "cross"}], "-", 
     RowBox[{"section", " ", "in", " ", "pb"}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Sigma]pNucleus", "[", "Z", "]"}], "=", 
       RowBox[{"53", "*", 
        SuperscriptBox["10", "9"], "*", 
        SuperscriptBox[
         RowBox[{"anucleus", "[", "Z", "]"}], "0.77"]}]}], ",", 
      RowBox[{"{", 
       RowBox[{"Z", ",", 
        RowBox[{"{", 
         RowBox[{"\"\<Mo\>\"", ",", "\"\<Fe\>\"", ",", "\"\<C\>\""}], "}"}]}],
        "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"proton", "-", 
     RowBox[{"proton", " ", "cross"}], "-", 
     RowBox[{"section", " ", "in", " ", "pb"}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\[Sigma]pp", "[", "\"\<Serpukhov\>\"", "]"}], ",", 
       RowBox[{"\[Sigma]pp", "[", "\"\<FermilabBD\>\"", "]"}], ",", 
       RowBox[{"\[Sigma]pp", "[", "\"\<SPS\>\"", "]"}], ",", 
       RowBox[{"\[Sigma]pp", "[", "\"\<LHC\>\"", "]"}], ",", 
       RowBox[{"\[Sigma]pp", "[", "\"\<FCC-hh\>\"", "]"}], ",", 
       RowBox[{"\[Sigma]pp", "[", "\"\<ESS\>\"", "]"}], ",", " ", 
       RowBox[{"\[Sigma]pp", "[", "\"\<LHC_fixed_target\>\"", "]"}]}], " ", 
      "}"}], "=", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "40.", ",", "40.", ",", "40.", ",", "78.", ",", "104.", ",", "44.", 
        ",", "42.5"}], "}"}], "*", 
      SuperscriptBox["10", "9"]}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.8777157343285027`*^9, 3.877715759687971*^9}, {
   3.877715855753553*^9, 3.877715901085358*^9}, {3.877716848735629*^9, 
   3.87771687468854*^9}, {3.877717047314185*^9, 3.877717048788798*^9}, {
   3.877746051169874*^9, 3.877746052414937*^9}, {3.8777531769583926`*^9, 
   3.877753181531331*^9}, {3.885109783213288*^9, 3.885109829933441*^9}, {
   3.8851425259425774`*^9, 3.885142528497978*^9}, {3.8854000170451794`*^9, 
   3.8854000189889555`*^9}, {3.885457146884971*^9, 3.885457152178501*^9}, {
   3.885743380719913*^9, 3.885743386957034*^9}, {3.885743539368781*^9, 
   3.885743549451918*^9}, {3.885915517966817*^9, 3.885915518187371*^9}, {
   3.885917511789866*^9, 3.885917515939419*^9}, {3.8859562839695334`*^9, 
   3.885956284487015*^9}, {3.8864390777757936`*^9, 3.886439149810041*^9}, {
   3.886440363069526*^9, 3.88644037403648*^9}, {3.886736399702718*^9, 
   3.886736401637359*^9}, {3.89226196596692*^9, 3.892262012793322*^9}, {
   3.892262059481433*^9, 3.892262064134064*^9}, {3.8922649439861317`*^9, 
   3.892264944127109*^9}, {3.893574345838452*^9, 3.893574345991643*^9}, {
   3.894182050016764*^9, 3.894182052100931*^9}, {3.897286334547759*^9, 
   3.897286365058141*^9}, {3.897286816033624*^9, 3.8972868181351247`*^9}, {
   3.909729529403797*^9, 3.909729543411754*^9}, {3.913183608529229*^9, 
   3.913183934228864*^9}, {3.9132684577794724`*^9, 3.913268470042717*^9}, {
   3.913268535922775*^9, 3.913268541980592*^9}, {3.913271579866525*^9, 
   3.913271580935754*^9}, {3.913284019962755*^9, 3.913284025703564*^9}, {
   3.913368261313953*^9, 3.913368318063818*^9}, {3.913368378071487*^9, 
   3.9133683918352833`*^9}, {3.9133695919106345`*^9, 3.91336960384499*^9}, {
   3.913369651432967*^9, 3.913369699492822*^9}, {3.913369737874374*^9, 
   3.913369786157632*^9}, {3.913369847573511*^9, 3.913369940291499*^9}, {
   3.9133700051141624`*^9, 3.9133700397169847`*^9}, {3.913370749893598*^9, 
   3.913370750723643*^9}, {3.913371875483689*^9, 3.913371917585121*^9}, {
   3.9133724210454507`*^9, 3.913372455816034*^9}, {3.913476562696164*^9, 
   3.9134765719890428`*^9}, {3.913476915734482*^9, 3.913476999215947*^9}, {
   3.9134801466787634`*^9, 3.913480185807843*^9}, {3.9135326365700197`*^9, 
   3.913532704081658*^9}, {3.9148311838781767`*^9, 3.91483119678964*^9}, 
   3.914831446887204*^9, 3.915442771263859*^9, {3.917507217156157*^9, 
   3.917507217487673*^9}, {3.9308235915290937`*^9, 3.930823608158986*^9}},
 CellTags->
  "Evaluation",ExpressionUUID->"2e3fc200-3d1f-489f-b96a-9e47e0198bbe"],

Cell[BoxData[
 FormBox[
  StyleBox["\<\"FeynCalc is already loaded! If you are trying to reload \
FeynCalc or load FeynArts, TARCER, PHI, FeynHelpers or any other add-on, \
please restart the kernel.\"\>", "Text",
   StripOnInput->False,
   LineColor->RGBColor[1, 0, 0],
   FrontFaceColor->RGBColor[1, 0, 0],
   BackFaceColor->RGBColor[1, 0, 0],
   GraphicsColor->RGBColor[1, 0, 0],
   FontWeight->Bold,
   FontColor->RGBColor[1, 0, 0]], TraditionalForm]], "Print",
 CellChangeTimes->{3.930211448661711*^9, 3.930822673269299*^9},
 CellTags->"Evaluation",
 CellLabel->
  "Durante la evaluaci\[OAcute]n de \
In[722]:=",ExpressionUUID->"41149713-9fda-4b06-8969-5909ba4e2c02"],

Cell[BoxData[
 FormBox["$Aborted", TraditionalForm]], "Output",
 CellChangeTimes->{3.930211448663947*^9, 3.9308226732721148`*^9},
 CellTags->"Evaluation",
 CellLabel->
  "Out[722]=",ExpressionUUID->"dd5ee897-2890-4c89-80bf-f1e2fea317f3"],

Cell[BoxData[
 FormBox[
  RowBox[{"{", 
   RowBox[{"\<\"B0\"\>", ",", "\<\"Bc\"\>", ",", "\<\"Bplus\"\>", 
    ",", "\<\"Bs\"\>", ",", "\<\"D0\"\>", ",", "\<\"Dplus\"\>", 
    ",", "\<\"Ds\"\>", ",", "\<\"Dstar\"\>", ",", "\<\"e\"\>", 
    ",", "\<\"Eta\"\>", ",", "\<\"EtaPr\"\>", ",", "\<\"h\"\>", 
    ",", "\<\"JPsi\"\>", ",", "\<\"K0\"\>", ",", "\<\"Kplus\"\>", 
    ",", "\<\"mu\"\>", ",", "\<\"neutrino\"\>", ",", "\<\"Omega\"\>", 
    ",", "\<\"p\"\>", ",", "\<\"Phi\"\>", ",", "\<\"photon\"\>", 
    ",", "\<\"Pi0\"\>", ",", "\<\"PiCharged\"\>", ",", "\<\"Rho0\"\>", 
    ",", "\<\"tau\"\>", ",", "\<\"Upsilon\"\>", ",", "\<\"W\"\>", 
    ",", "\<\"Z\"\>"}], "}"}], TraditionalForm]], "Output",
 CellChangeTimes->{3.930211448663947*^9, 3.930822673274221*^9},
 CellTags->"Evaluation",
 CellLabel->
  "Out[731]=",ExpressionUUID->"da38fc3e-cd51-461e-b381-0a79a489739a"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Energy-angle grid for the distribution function", "Section",
 CellChangeTimes->{{3.8777159062111173`*^9, 3.877715914401271*^9}, {
  3.877716196027843*^9, 3.877716198636062*^9}, {3.888740376085947*^9, 
  3.888740376235535*^9}, {3.9148341564011297`*^9, 3.914834157395559*^9}},
 CellTags->
  "Evaluation",ExpressionUUID->"ed0ed593-049b-46cb-876d-fd2059f1978e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"StepEtemp", "[", "Efip_", "]"}], "=", 
   RowBox[{"Piecewise", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0.2", ",", 
        RowBox[{"Efip", "\[LessEqual]", "2.5"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0.3", ",", 
        RowBox[{"2.5", "<", "Efip", "<=", "7"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0.5", ",", 
        RowBox[{"7", "<", "Efip", "<=", "10"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", 
        RowBox[{"10", "<", "Efip", "<", "35"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"2", ",", 
        RowBox[{"35", "\[LessEqual]", "Efip", "\[LessEqual]", "50"}]}], "}"}],
       ",", 
      RowBox[{"{", 
       RowBox[{"5", ",", 
        RowBox[{"50", "<", "Efip", "<", "200"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"10", ",", 
        RowBox[{"200", "<=", "Efip", "<", "400"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"20", ",", 
        RowBox[{"400", "\[LessEqual]", "Efip", "<", "700"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"50", ",", 
        RowBox[{"700", "\[LessEqual]", "Efip", "<", "2000"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"200", ",", 
        RowBox[{"2000", "\[LessEqual]", "Efip", "<", "4000"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"400", ",", 
        RowBox[{"4000", "\[LessEqual]", "Efip", "<", "7000"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"500", ",", 
        RowBox[{"7000", "\[LessEqual]", "Efip", "\[LessEqual]", "50000"}]}], 
       "}"}]}], "}"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ENlist", "[", "\"\<SPS\>\"", "]"}], "=", 
   RowBox[{
    RowBox[{"Join", "[", 
     RowBox[{
      RowBox[{"With", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"start", "=", "0.02"}], ",", 
          RowBox[{"end", "=", 
           RowBox[{"EmaxFacility", "[", "\"\<SPS\>\"", "]"}]}]}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"NestWhileList", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "+", 
            RowBox[{"StepEtemp", "[", "#", "]"}]}], "&"}], ",", "start", ",", 
          
          RowBox[{
           RowBox[{"#", "\[LessEqual]", "end"}], "&"}], ",", "1", ",", 
          "\[Infinity]", ",", 
          RowBox[{"-", "1"}]}], "]"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"EmaxFacility", "[", "\"\<SPS\>\"", "]"}], "}"}]}], "]"}], "//",
     "N"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]Nlist", "[", "\"\<SPS\>\"", "]"}], "=", 
   RowBox[{
    RowBox[{"\[Theta]NlistLight", "[", "\"\<SPS\>\"", "]"}], "=", 
    RowBox[{
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         SuperscriptBox["10", 
          RowBox[{"-", "5."}]], ",", 
         RowBox[{"5", "*", 
          SuperscriptBox["10", 
           RowBox[{"-", "5."}]]}], ",", 
         SuperscriptBox["10", 
          RowBox[{"-", "4."}]], ",", 
         RowBox[{"3", "*", 
          SuperscriptBox["10", 
           RowBox[{"-", "4."}]]}], ",", 
         RowBox[{"6", "*", 
          SuperscriptBox["10", 
           RowBox[{"-", "4."}]]}], ",", 
         SuperscriptBox["10", 
          RowBox[{"-", "3."}]], ",", 
         RowBox[{"2", "*", 
          SuperscriptBox["10", 
           RowBox[{"-", "3."}]]}], ",", 
         RowBox[{"4", "*", 
          SuperscriptBox["10", 
           RowBox[{"-", "3."}]]}], ",", 
         RowBox[{"6", "*", 
          SuperscriptBox["10", 
           RowBox[{"-", "3."}]]}], ",", 
         RowBox[{"8", "*", 
          SuperscriptBox["10", 
           RowBox[{"-", "3."}]]}]}], "}"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{
         SuperscriptBox["10", "\[Theta]N"], ",", 
         RowBox[{"{", 
          RowBox[{"\[Theta]N", ",", 
           RowBox[{"Log10", "[", 
            SuperscriptBox["10", 
             RowBox[{"-", "2"}]], "]"}], ",", 
           RowBox[{"Log10", "[", "0.8", "]"}], ",", "0.05"}], "}"}]}], "]"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{
        "0.85", ",", "0.95", ",", "1.05", ",", "1.2", ",", "1.4", ",", "1.6", 
         ",", "1.9", ",", "2.2", ",", "2.4", ",", "2.7", ",", "3.", ",", 
         "Pi"}], "}"}]}], "]"}], "//", "N"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]NlistB", "[", "\"\<SPS\>\"", "]"}], "=", 
   RowBox[{
    RowBox[{"Join", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        SuperscriptBox["10", 
         RowBox[{"-", "5."}]], ",", 
        RowBox[{"5", "*", 
         SuperscriptBox["10", 
          RowBox[{"-", "5."}]]}], ",", 
        SuperscriptBox["10", 
         RowBox[{"-", "4."}]], ",", 
        RowBox[{"3", "*", 
         SuperscriptBox["10", 
          RowBox[{"-", "4."}]]}], ",", 
        RowBox[{"6", "*", 
         SuperscriptBox["10", 
          RowBox[{"-", "4."}]]}], ",", 
        SuperscriptBox["10", 
         RowBox[{"-", "3."}]], ",", 
        RowBox[{"2", "*", 
         SuperscriptBox["10", 
          RowBox[{"-", "3."}]]}], ",", 
        RowBox[{"4", "*", 
         SuperscriptBox["10", 
          RowBox[{"-", "3."}]]}], ",", 
        RowBox[{"6", "*", 
         SuperscriptBox["10", 
          RowBox[{"-", "3."}]]}], ",", 
        RowBox[{"8", "*", 
         SuperscriptBox["10", 
          RowBox[{"-", "3."}]]}]}], "}"}], ",", 
      RowBox[{"Table", "[", 
       RowBox[{
        SuperscriptBox["10", "\[Theta]N"], ",", 
        RowBox[{"{", 
         RowBox[{"\[Theta]N", ",", 
          RowBox[{"Log10", "[", 
           SuperscriptBox["10", 
            RowBox[{"-", "2"}]], "]"}], ",", 
          RowBox[{"Log10", "[", "0.8", "]"}], ",", "0.03"}], "}"}]}], "]"}], 
      ",", 
      RowBox[{"{", 
       RowBox[{
       "0.85", ",", "0.95", ",", "1.05", ",", "1.2", ",", "1.4", ",", "1.6", 
        ",", "1.9", ",", "2.2", ",", "2.4", ",", "2.7", ",", "3.", ",", 
        "Pi"}], "}"}]}], "]"}], "//", "N"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ENlist", "[", "\"\<LHC\>\"", "]"}], "=", 
   RowBox[{
    RowBox[{"Join", "[", 
     RowBox[{
      RowBox[{"With", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"start", "=", "0.02"}], ",", 
          RowBox[{"end", "=", 
           RowBox[{"EmaxFacility", "[", "\"\<LHC\>\"", "]"}]}]}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"NestWhileList", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "+", 
            RowBox[{"StepEtemp", "[", "#", "]"}]}], "&"}], ",", "start", ",", 
          
          RowBox[{
           RowBox[{"#", "\[LessEqual]", "end"}], "&"}], ",", "1", ",", 
          "\[Infinity]", ",", 
          RowBox[{"-", "1"}]}], "]"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"EmaxFacility", "[", "\"\<LHC\>\"", "]"}], "}"}]}], "]"}], "//",
     "N"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ENlist", "[", "\"\<FCC-hh\>\"", "]"}], "=", 
   RowBox[{
    RowBox[{"Join", "[", 
     RowBox[{
      RowBox[{"With", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"start", "=", "0.02"}], ",", 
          RowBox[{"end", "=", 
           RowBox[{"EmaxFacility", "[", "\"\<FCC-hh\>\"", "]"}]}]}], "}"}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{"NestWhileList", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "+", 
            RowBox[{"StepEtemp", "[", "#", "]"}]}], "&"}], ",", "start", ",", 
          
          RowBox[{
           RowBox[{"#", "\[LessEqual]", "end"}], "&"}], ",", "1", ",", 
          "\[Infinity]", ",", 
          RowBox[{"-", "1"}]}], "]"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"EmaxFacility", "[", "\"\<FCC-hh\>\"", "]"}], "}"}]}], "]"}], "//",
     "N"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Theta]NlistTemp", "=", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       SuperscriptBox["10", 
        RowBox[{"-", "5."}]], ",", 
       RowBox[{"3", "*", 
        SuperscriptBox["10", 
         RowBox[{"-", "5."}]]}], ",", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"6", "*", 
          SuperscriptBox["10", 
           RowBox[{"-", "5."}]]}], ","}], "*)"}], 
       RowBox[{"6", "*", 
        SuperscriptBox["10", 
         RowBox[{"-", "5."}]]}], ",", 
       SuperscriptBox["10", 
        RowBox[{"-", "4."}]], ",", 
       RowBox[{"2", "*", 
        SuperscriptBox["10", 
         RowBox[{"-", "4."}]]}], ",", 
       RowBox[{"4", "*", 
        SuperscriptBox["10", 
         RowBox[{"-", "4."}]]}], ",", 
       RowBox[{"6", "*", 
        SuperscriptBox["10", 
         RowBox[{"-", "4."}]]}], ",", 
       SuperscriptBox["10", 
        RowBox[{"-", "3."}]], ",", 
       RowBox[{"2", "*", 
        SuperscriptBox["10", 
         RowBox[{"-", "3."}]]}], ",", 
       RowBox[{"3", "*", 
        SuperscriptBox["10", 
         RowBox[{"-", "3."}]]}], ",", 
       RowBox[{"4", "*", 
        SuperscriptBox["10", 
         RowBox[{"-", "3."}]]}], ",", 
       RowBox[{"5", "*", 
        SuperscriptBox["10", 
         RowBox[{"-", "3."}]]}], ",", 
       RowBox[{"6", "*", 
        SuperscriptBox["10", 
         RowBox[{"-", "3."}]]}], ",", 
       RowBox[{"8", "*", 
        SuperscriptBox["10", 
         RowBox[{"-", "3."}]]}], ",", 
       RowBox[{"9", "*", 
        SuperscriptBox["10", 
         RowBox[{"-", "3."}]]}]}], "}"}], ",", 
     RowBox[{"Table", "[", 
      RowBox[{
       SuperscriptBox["10", "\[Theta]N"], ",", 
       RowBox[{"{", 
        RowBox[{"\[Theta]N", ",", 
         RowBox[{"Log10", "[", 
          SuperscriptBox["10", 
           RowBox[{"-", "2"}]], "]"}], ",", 
         RowBox[{"Log10", "[", "0.5", "]"}], ",", "0.025"}], "}"}]}], "]"}], 
     ",", 
     RowBox[{"Table", "[", 
      RowBox[{
       SuperscriptBox["10", "\[Theta]N"], ",", 
       RowBox[{"{", 
        RowBox[{"\[Theta]N", ",", 
         RowBox[{"Log10", "[", "0.52", "]"}], ",", 
         RowBox[{"Log10", "[", "1.55", "]"}], ",", "0.015"}], "}"}]}], "]"}], 
     ",", 
     RowBox[{"{", "1.57", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]Nlist", "[", "\"\<LHC\>\"", "]"}], "=", 
   RowBox[{
    RowBox[{"SortBy", "[", 
     RowBox[{
      RowBox[{"Partition", "[", 
       RowBox[{
        RowBox[{"Join", "[", 
         RowBox[{"\[Theta]NlistTemp", ",", 
          RowBox[{"Pi", "-", "\[Theta]NlistTemp"}]}], "]"}], ",", "1"}], 
       "]"}], ",", "1"}], "]"}], "//", "Flatten"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Theta]NlistLightTemp", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          SuperscriptBox["10", 
           RowBox[{"-", "5."}]], ",", 
          RowBox[{"3", "*", 
           SuperscriptBox["10", 
            RowBox[{"-", "5."}]]}], ",", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"6", "*", 
             SuperscriptBox["10", 
              RowBox[{"-", "5."}]]}], ","}], "*)"}], 
          RowBox[{"6", "*", 
           SuperscriptBox["10", 
            RowBox[{"-", "5."}]]}], ",", 
          RowBox[{"8", "*", 
           SuperscriptBox["10", 
            RowBox[{"-", "5."}]]}], ",", 
          SuperscriptBox["10", 
           RowBox[{"-", "4."}]], ",", 
          RowBox[{"2", "*", 
           SuperscriptBox["10", 
            RowBox[{"-", "4."}]]}], ",", 
          RowBox[{"3", "*", 
           SuperscriptBox["10", 
            RowBox[{"-", "4."}]]}], ",", 
          RowBox[{"4", "*", 
           SuperscriptBox["10", 
            RowBox[{"-", "4."}]]}], ",", 
          RowBox[{"5", "*", 
           SuperscriptBox["10", 
            RowBox[{"-", "4."}]]}], ",", 
          RowBox[{"6", "*", 
           SuperscriptBox["10", 
            RowBox[{"-", "4."}]]}], ",", 
          RowBox[{"7", "*", 
           SuperscriptBox["10", 
            RowBox[{"-", "4."}]]}], ",", 
          RowBox[{"8", "*", 
           SuperscriptBox["10", 
            RowBox[{"-", "4."}]]}], ",", 
          RowBox[{"9", "*", 
           SuperscriptBox["10", 
            RowBox[{"-", "4."}]]}], ",", 
          SuperscriptBox["10", 
           RowBox[{"-", "3."}]], ",", 
          RowBox[{"1.5", "*", 
           SuperscriptBox["10", 
            RowBox[{"-", "3."}]]}], ",", 
          RowBox[{"2", "*", 
           SuperscriptBox["10", 
            RowBox[{"-", "3."}]]}], ",", 
          RowBox[{"3", "*", 
           SuperscriptBox["10", 
            RowBox[{"-", "3."}]]}], ",", 
          RowBox[{"4", "*", 
           SuperscriptBox["10", 
            RowBox[{"-", "3."}]]}], ",", 
          RowBox[{"5", "*", 
           SuperscriptBox["10", 
            RowBox[{"-", "3."}]]}], ",", 
          RowBox[{"6", "*", 
           SuperscriptBox["10", 
            RowBox[{"-", "3."}]]}], ",", 
          RowBox[{"7", "*", 
           SuperscriptBox["10", 
            RowBox[{"-", "3."}]]}], ",", 
          RowBox[{"8", "*", 
           SuperscriptBox["10", 
            RowBox[{"-", "3."}]]}], ",", 
          RowBox[{"9", "*", 
           SuperscriptBox["10", 
            RowBox[{"-", "3."}]]}]}], "}"}], ",", 
        RowBox[{"Table", "[", 
         RowBox[{
          SuperscriptBox["10", "\[Theta]N"], ",", 
          RowBox[{"{", 
           RowBox[{"\[Theta]N", ",", 
            RowBox[{"Log10", "[", 
             SuperscriptBox["10", 
              RowBox[{"-", "2"}]], "]"}], ",", 
            RowBox[{"Log10", "[", "0.5", "]"}], ",", "0.025"}], "}"}]}], 
         "]"}], ",", 
        RowBox[{"Table", "[", 
         RowBox[{
          SuperscriptBox["10", "\[Theta]N"], ",", 
          RowBox[{"{", 
           RowBox[{"\[Theta]N", ",", 
            RowBox[{"Log10", "[", "0.52", "]"}], ",", 
            RowBox[{"Log10", "[", "1.55", "]"}], ",", "0.015"}], "}"}]}], 
         "]"}], ",", 
        RowBox[{"{", "1.57", "}"}]}], "]"}], "//", "Sort"}], "//", "N"}], "//",
     "DeleteDuplicates"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]NlistLight", "[", "\"\<LHC\>\"", "]"}], "=", 
   RowBox[{
    RowBox[{"SortBy", "[", 
     RowBox[{
      RowBox[{"Partition", "[", 
       RowBox[{
        RowBox[{"Join", "[", 
         RowBox[{"\[Theta]NlistLightTemp", ",", 
          RowBox[{"Pi", "-", "\[Theta]NlistLightTemp"}]}], "]"}], ",", "1"}], 
       "]"}], ",", "1"}], "]"}], "//", "Flatten"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Theta]NlistFCChhTemp", "=", "\[Theta]NlistTemp"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]Nlist", "[", "\"\<FCC-hh\>\"", "]"}], "=", 
   RowBox[{
    RowBox[{"SortBy", "[", 
     RowBox[{
      RowBox[{"Partition", "[", 
       RowBox[{
        RowBox[{"Join", "[", 
         RowBox[{"\[Theta]NlistTemp", ",", 
          RowBox[{"Pi", "-", "\[Theta]NlistFCChhTemp"}]}], "]"}], ",", "1"}], 
       "]"}], ",", "1"}], "]"}], "//", "Flatten"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]NlistLight", "[", "\"\<FCC-hh\>\"", "]"}], "=", 
   RowBox[{
    RowBox[{"SortBy", "[", 
     RowBox[{
      RowBox[{"Partition", "[", 
       RowBox[{
        RowBox[{"Join", "[", 
         RowBox[{"\[Theta]NlistLightTemp", ",", 
          RowBox[{"Pi", "-", "\[Theta]NlistLightTemp"}]}], "]"}], ",", "1"}], 
       "]"}], ",", "1"}], "]"}], "//", "Flatten"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ENlist", "[", "\"\<FermilabBD\>\"", "]"}], "=", 
   RowBox[{
    RowBox[{"Join", "[", 
     RowBox[{
      RowBox[{"With", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"start", "=", "0.02"}], ",", 
          RowBox[{"end", "=", 
           RowBox[{"EmaxFacility", "[", "\"\<FermilabBD\>\"", "]"}]}]}], 
         "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"NestWhileList", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "+", 
            RowBox[{"StepEtemp", "[", "#", "]"}]}], "&"}], ",", "start", ",", 
          
          RowBox[{
           RowBox[{"#", "\[LessEqual]", "end"}], "&"}], ",", "1", ",", 
          "\[Infinity]", ",", 
          RowBox[{"-", "1"}]}], "]"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"EmaxFacility", "[", "\"\<FermilabBD\>\"", "]"}], "}"}]}], 
     "]"}], "//", "N"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]Nlist", "[", "\"\<FermilabBD\>\"", "]"}], "=", 
   RowBox[{
    RowBox[{"\[Theta]NlistLight", "[", "\"\<FermilabBD\>\"", "]"}], "=", 
    RowBox[{"\[Theta]Nlist", "[", "\"\<SPS\>\"", "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ENlist", "[", "\"\<Serpukhov\>\"", "]"}], "=", 
   RowBox[{
    RowBox[{"Join", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        SuperscriptBox["10", "EN"], ",", 
        RowBox[{"{", 
         RowBox[{"EN", ",", 
          RowBox[{"Log10", "[", "0.01", "]"}], ",", 
          RowBox[{"Log10", "[", 
           RowBox[{"EmaxFacility", "[", "\"\<Serpukhov\>\"", "]"}], "]"}], 
          ",", "0.05"}], "}"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"EmaxFacility", "[", "\"\<Serpukhov\>\"", "]"}], "}"}]}], 
     "]"}], "//", "N"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]Nlist", "[", "\"\<Serpukhov\>\"", "]"}], "=", 
   RowBox[{
    RowBox[{"\[Theta]NlistLight", "[", "\"\<Serpukhov\>\"", "]"}], "=", 
    RowBox[{"\[Theta]Nlist", "[", "\"\<SPS\>\"", "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]Nlist", "[", "\"\<ESS\>\"", "]"}], "=", 
   RowBox[{
    RowBox[{"\[Theta]NlistLight", "[", "\"\<ESS\>\"", "]"}], "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SuperscriptBox["10", 
            RowBox[{"-", "6."}]], ",", 
           SuperscriptBox["10", 
            RowBox[{"-", "5."}]], ",", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"3", "*", 
              SuperscriptBox["10", 
               RowBox[{"-", "5."}]]}], ",", 
             RowBox[{"6", "*", 
              SuperscriptBox["10", 
               RowBox[{"-", "5."}]]}], ","}], "*)"}], 
           SuperscriptBox["10", 
            RowBox[{"-", "4."}]], ",", 
           SuperscriptBox["10", 
            RowBox[{"-", "3."}]], ",", 
           SuperscriptBox["10", 
            RowBox[{"-", "2."}]]}], "}"}], ",", 
         RowBox[{"Table", "[", 
          RowBox[{
           SuperscriptBox["10", "\[Theta]N"], ",", 
           RowBox[{"{", 
            RowBox[{"\[Theta]N", ",", 
             RowBox[{"Log10", "[", 
              RowBox[{"3", "*", 
               SuperscriptBox["10", 
                RowBox[{"-", "2."}]]}], "]"}], ",", 
             RowBox[{"Log10", "[", "0.5", "]"}], ",", "0.25"}], "}"}]}], 
          "]"}], ",", 
         RowBox[{"Table", "[", 
          RowBox[{
           SuperscriptBox["10", "\[Theta]N"], ",", 
           RowBox[{"{", 
            RowBox[{"\[Theta]N", ",", 
             RowBox[{"Log10", "[", "0.52", "]"}], ",", 
             RowBox[{"Log10", "[", "Pi", "]"}], ",", "0.01"}], "}"}]}], "]"}],
          ",", 
         RowBox[{"{", "Pi", "}"}]}], "]"}], "//", "N"}], "//", 
      "DeleteDuplicates"}], "//", "Developer`ToPackedArray"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ENlist", "[", "\"\<ESS\>\"", "]"}], "=", 
   RowBox[{
    RowBox[{"Join", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{"e", ",", 
        RowBox[{"{", 
         RowBox[{"e", ",", "0.0051", ",", "0.1401", ",", "0.001"}], "}"}]}], 
       "]"}], ",", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"10", "^", "EN"}], ",", 
        RowBox[{"{", 
         RowBox[{"EN", ",", 
          RowBox[{"Log10", "[", "0.145", "]"}], ",", 
          RowBox[{"Log10", "[", "2.", "]"}], ",", "0.02"}], "}"}]}], "]"}], 
      ",", 
      RowBox[{"{", 
       RowBox[{"EmaxFacility", "[", "\"\<ESS\>\"", "]"}], "}"}]}], "]"}], "//",
     "N"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ENlist", "[", "\"\<LHC_fixed_target\>\"", "]"}], "=", 
   RowBox[{
    RowBox[{"Join", "[", 
     RowBox[{
      RowBox[{"With", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"start", "=", "0.02"}], ",", 
          RowBox[{"end", "=", 
           RowBox[{"EmaxFacility", "[", "\"\<LHC_fixed_target\>\"", "]"}]}]}],
          "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"NestWhileList", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "+", 
            RowBox[{"StepEtemp", "[", "#", "]"}]}], "&"}], ",", "start", ",", 
          
          RowBox[{
           RowBox[{"#", "\[LessEqual]", "end"}], "&"}], ",", "1", ",", 
          "\[Infinity]", ",", 
          RowBox[{"-", "1"}]}], "]"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"EmaxFacility", "[", "\"\<LHC_fixed_target\>\"", "]"}], 
       "}"}]}], "]"}], "//", "N"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]Nlist", "[", "\"\<LHC_fixed_target\>\"", "]"}], "=", 
   RowBox[{
    RowBox[{"\[Theta]NlistLight", "[", "\"\<LHC_fixed_target\>\"", "]"}], "=", 
    RowBox[{
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         SuperscriptBox["10", 
          RowBox[{"-", "5."}]], ",", 
         RowBox[{"5", "*", 
          SuperscriptBox["10", 
           RowBox[{"-", "5."}]]}], ",", 
         SuperscriptBox["10", 
          RowBox[{"-", "4."}]], ",", 
         RowBox[{"3", "*", 
          SuperscriptBox["10", 
           RowBox[{"-", "4."}]]}], ",", 
         RowBox[{"6", "*", 
          SuperscriptBox["10", 
           RowBox[{"-", "4."}]]}], ",", 
         SuperscriptBox["10", 
          RowBox[{"-", "3."}]], ",", 
         RowBox[{"2", "*", 
          SuperscriptBox["10", 
           RowBox[{"-", "3."}]]}], ",", 
         RowBox[{"4", "*", 
          SuperscriptBox["10", 
           RowBox[{"-", "3."}]]}], ",", 
         RowBox[{"6", "*", 
          SuperscriptBox["10", 
           RowBox[{"-", "3."}]]}], ",", 
         RowBox[{"8", "*", 
          SuperscriptBox["10", 
           RowBox[{"-", "3."}]]}]}], "}"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{
         SuperscriptBox["10", "\[Theta]N"], ",", 
         RowBox[{"{", 
          RowBox[{"\[Theta]N", ",", 
           RowBox[{"Log10", "[", 
            SuperscriptBox["10", 
             RowBox[{"-", "2"}]], "]"}], ",", 
           RowBox[{"Log10", "[", "0.8", "]"}], ",", "0.05"}], "}"}]}], "]"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{
        "0.85", ",", "0.95", ",", "1.05", ",", "1.2", ",", "1.4", ",", "1.6", 
         ",", "1.9", ",", "2.2", ",", "2.4", ",", "2.7", ",", "3.", ",", 
         "Pi"}], "}"}]}], "]"}], "//", "N"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]NlistB", "[", "\"\<LHC_fixed_target\>\"", "]"}], "=", 
   RowBox[{
    RowBox[{"Join", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        SuperscriptBox["10", 
         RowBox[{"-", "5."}]], ",", 
        RowBox[{"5", "*", 
         SuperscriptBox["10", 
          RowBox[{"-", "5."}]]}], ",", 
        SuperscriptBox["10", 
         RowBox[{"-", "4."}]], ",", 
        RowBox[{"3", "*", 
         SuperscriptBox["10", 
          RowBox[{"-", "4."}]]}], ",", 
        RowBox[{"6", "*", 
         SuperscriptBox["10", 
          RowBox[{"-", "4."}]]}], ",", 
        SuperscriptBox["10", 
         RowBox[{"-", "3."}]], ",", 
        RowBox[{"2", "*", 
         SuperscriptBox["10", 
          RowBox[{"-", "3."}]]}], ",", 
        RowBox[{"4", "*", 
         SuperscriptBox["10", 
          RowBox[{"-", "3."}]]}], ",", 
        RowBox[{"6", "*", 
         SuperscriptBox["10", 
          RowBox[{"-", "3."}]]}], ",", 
        RowBox[{"8", "*", 
         SuperscriptBox["10", 
          RowBox[{"-", "3."}]]}]}], "}"}], ",", 
      RowBox[{"Table", "[", 
       RowBox[{
        SuperscriptBox["10", "\[Theta]N"], ",", 
        RowBox[{"{", 
         RowBox[{"\[Theta]N", ",", 
          RowBox[{"Log10", "[", 
           SuperscriptBox["10", 
            RowBox[{"-", "2"}]], "]"}], ",", 
          RowBox[{"Log10", "[", "0.8", "]"}], ",", "0.03"}], "}"}]}], "]"}], 
      ",", 
      RowBox[{"{", 
       RowBox[{
       "0.85", ",", "0.95", ",", "1.05", ",", "1.2", ",", "1.4", ",", "1.6", 
        ",", "1.9", ",", "2.2", ",", "2.4", ",", "2.7", ",", "3.", ",", 
        "Pi"}], "}"}]}], "]"}], "//", "N"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ELLPfromKlistSPS", "=", 
   RowBox[{"{", 
    RowBox[{
    "0.02", ",", "0.05", ",", "0.1", ",", "0.25", ",", "0.5", ",", "1.", ",", 
     "1.5", ",", "2.", ",", "2.5", ",", "3.", ",", "3.5", ",", "4.", ",", 
     "5.", ",", "6.", ",", "7.", ",", "8."}], "}"}]}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.8777159186166425`*^9, 3.877715918802336*^9}, {
   3.877716200787959*^9, 3.877716250533572*^9}, {3.884157116904537*^9, 
   3.884157139858*^9}, {3.884161564215628*^9, 3.884161609565316*^9}, {
   3.884618242079443*^9, 3.8846183063503623`*^9}, {3.884853402676318*^9, 
   3.8848534286916313`*^9}, {3.884941541660821*^9, 3.884941561081309*^9}, {
   3.884942222359806*^9, 3.884942299231026*^9}, {3.8851125039878893`*^9, 
   3.8851125226983805`*^9}, {3.885353384939334*^9, 3.885353433136904*^9}, {
   3.8853535882166653`*^9, 3.8853538080748224`*^9}, {3.8853538407344995`*^9, 
   3.885353840810713*^9}, {3.886701182179981*^9, 3.8867011843563957`*^9}, {
   3.887618166732709*^9, 3.887618180208833*^9}, {3.8885726113161793`*^9, 
   3.8885727433172235`*^9}, {3.8935206730064936`*^9, 
   3.8935206730094547`*^9}, {3.893521035994757*^9, 3.893521035995753*^9}, {
   3.89470798513209*^9, 3.89470801007931*^9}, {3.89697211385228*^9, 
   3.896972123027357*^9}, {3.902564143300271*^9, 3.9025641435509453`*^9}, {
   3.905236171367914*^9, 3.905236210997121*^9}, {3.910412549721905*^9, 
   3.9104125812263746`*^9}, {3.9131047029214*^9, 3.913104738568884*^9}, {
   3.913104808829029*^9, 3.913104812310208*^9}, {3.913104871810295*^9, 
   3.913104886468244*^9}, {3.91310495513907*^9, 3.913104968120221*^9}, {
   3.913286274120874*^9, 3.9132864622033553`*^9}, {3.913286493595364*^9, 
   3.913286691074883*^9}, {3.913310421166453*^9, 3.9133104280475516`*^9}, {
   3.913312058560688*^9, 3.913312062526287*^9}, {3.913364980232396*^9, 
   3.9133649802497463`*^9}, {3.914834208706966*^9, 3.9148342816667013`*^9}, 
   3.914850386285075*^9, 3.91485042917365*^9, 3.9154387994814*^9, {
   3.9157081767727137`*^9, 3.91570821104952*^9}, {3.9167616760878663`*^9, 
   3.9167616885205536`*^9}, {3.916763870188702*^9, 3.916763879785193*^9}, {
   3.9169391413766594`*^9, 3.916939168991829*^9}, {3.91716121577544*^9, 
   3.917161320701475*^9}, {3.9171613945177917`*^9, 3.917161396368728*^9}, {
   3.917281395264745*^9, 3.917281557816598*^9}, {3.9172817305606055`*^9, 
   3.917281760844936*^9}, {3.917450374243986*^9, 3.917450390303549*^9}, {
   3.9175016849927473`*^9, 3.917501762328401*^9}, {3.91794759069874*^9, 
   3.9179476055775356`*^9}, {3.91814664324392*^9, 3.918146651754313*^9}, {
   3.930989921513152*^9, 3.93098995591222*^9}},
 CellTags->
  "Evaluation",ExpressionUUID->"72c7a1cb-121c-4aae-ac1f-468c38ac6100"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Preliminary code: mother particles sampling", "Title",
 CellChangeTimes->{{3.913276942888595*^9, 3.91327694747556*^9}, {
  3.9132812505098085`*^9, 3.913281268291277*^9}, {3.913714892140549*^9, 
  3.9137149208189754`*^9}},
 CellTags->
  "Evaluation",ExpressionUUID->"76b860cd-984b-41b4-99cf-16aba9d2025c"],

Cell[CellGroupData[{

Cell["Importing tabulated mother particles distributions", "Chapter",
 CellChangeTimes->{{3.913217578471983*^9, 3.9132175858480544`*^9}, {
  3.913221168302366*^9, 3.9132211692461157`*^9}, {3.913276913863066*^9, 
  3.9132769156991982`*^9}, {3.915704831034233*^9, 3.915704833365085*^9}},
 CellTags->
  "Evaluation",ExpressionUUID->"7c2d3d9c-4846-4861-bd3f-24c69d50f1dc"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "List", " ", "all", " ", "files", " ", "matching", " ", "the", " ", 
    "distribution", " ", "name", " ", "pattern"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"files", "=", 
     RowBox[{"FileNames", "[", 
      RowBox[{"\"\<DoubleDistr_*_*.txt\>\"", ",", 
       RowBox[{"FileNameJoin", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"NotebookDirectory", "[", "]"}], ",", 
          "\"\<spectra/SM particles\>\""}], "}"}], "]"}], ",", "Infinity"}], 
      "]"}]}], ";"}], "\n", 
   RowBox[{"(*", 
    RowBox[{
    "Extracting", " ", "the", " ", "information", " ", "about", " ", "the", 
     " ", "facility", " ", "and", " ", "particle", " ", "from", " ", "the", 
     " ", "filename"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"extractData", "[", "filename_", "]"}], ":=", 
    RowBox[{
     RowBox[{"StringCases", "[", 
      RowBox[{
       RowBox[{"FileNameTake", "[", "filename", "]"}], ",", 
       RowBox[{
        RowBox[{"\"\<DoubleDistr_\>\"", "~~", 
         RowBox[{"facility", ":", 
          RowBox[{"(", 
           RowBox[{"Shortest", "[", "___", "]"}], ")"}]}], "~~", "\"\<_\>\"", 
         "~~", 
         RowBox[{"particle", ":", 
          RowBox[{"(", 
           RowBox[{"ShortestMatch", "[", "___", "]"}], ")"}]}], "~~", 
         "\"\<.txt\>\""}], ":>", 
        RowBox[{"{", 
         RowBox[{"facility", ",", "particle"}], "}"}]}]}], "]"}], "[", 
     RowBox[{"[", "1", "]"}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Extract", "<", "Particle", ">"}], ",", " ", 
     RowBox[{"<", "Facility", ">", 
      RowBox[{"pairs", " ", "and", " ", "remove", " ", "duplicates"}]}]}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"dataPairs", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"extractData", "[", "#", "]"}], "&"}], "/@", "files"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Sort", " ", "the", " ", "pairs", " ", "by", " ", "Facility"}], 
    "*)"}], "\n", 
   RowBox[{
    RowBox[{"sortedDataPairs", "=", 
     RowBox[{"SortBy", "[", 
      RowBox[{"dataPairs", ",", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{"#", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], "}"}], "&"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Importing", " ", "all", " ", "the", " ", "distributions"}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MotherImportingBlock", "[", 
     RowBox[{"Facility_", ",", "Particle_"}], "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"filenameimport", "=", 
        RowBox[{"ToString", "@", 
         RowBox[{"StringForm", "[", 
          RowBox[{"\"\<DoubleDistr_``_``.txt\>\"", ",", 
           RowBox[{"Sequence", "@@", 
            RowBox[{"{", 
             RowBox[{"Facility", ",", "Particle"}], "}"}]}]}], "]"}]}]}], ";",
        "\[IndentingNewLine]", 
       RowBox[{"dataimport", "=", 
        RowBox[{"Import", "[", 
         RowBox[{
          RowBox[{"FileNameJoin", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"NotebookDirectory", "[", "]"}], ",", 
             "\"\<spectra/SM particles\>\"", ",", "filenameimport"}], "}"}], 
           "]"}], ",", "\"\<Table\>\""}], "]"}]}]}]}], "\[IndentingNewLine]", 
     "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"DataDistr", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"sortedDataPairs", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", 
         RowBox[{
          RowBox[{"sortedDataPairs", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "=", 
       RowBox[{"MotherImportingBlock", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"sortedDataPairs", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", 
         RowBox[{
          RowBox[{"sortedDataPairs", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", 
        RowBox[{"Length", "[", "sortedDataPairs", "]"}]}], "}"}]}], "]"}], "//",
     "AbsoluteTiming"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"sortedDataPairs", "=", 
     RowBox[{"SortBy", "[", 
      RowBox[{
       RowBox[{"Join", "[", 
        RowBox[{"sortedDataPairs", ",", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"Facility", ",", "\"\<p\>\""}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"Facility", ",", "FacilitiesList"}], "}"}]}], "]"}], ",", 
         
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"\"\<ESS\>\"", ",", "\"\<PiCharged\>\""}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"\"\<ESS\>\"", ",", "\"\<mu\>\""}], "}"}]}], "}"}]}], 
        "]"}], ",", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{"#", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], "}"}], "&"}]}], "]"}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.913217164971033*^9, 3.913217201930162*^9}, 
   3.9132172692908635`*^9, {3.913217344025357*^9, 3.913217346582526*^9}, {
   3.913217491925939*^9, 3.913217541103717*^9}, {3.913218333925029*^9, 
   3.913218363626208*^9}, {3.913219965834944*^9, 3.9132200563150406`*^9}, {
   3.91322041771476*^9, 3.91322043992981*^9}, {3.913220478825943*^9, 
   3.9132204839912148`*^9}, 3.913221174021563*^9, {3.913397692344595*^9, 
   3.913397712693364*^9}, {3.913449291936092*^9, 3.913449331111113*^9}, {
   3.913449368845928*^9, 3.913449372195831*^9}, {3.9134515764360905`*^9, 
   3.913451579835991*^9}, {3.9144884419671197`*^9, 3.914488446421652*^9}, {
   3.915438930874747*^9, 3.915438930996276*^9}, {3.915702862288344*^9, 
   3.915702918311591*^9}, {3.9157063778312306`*^9, 3.91570638038387*^9}},
 CellTags->"Evaluation",
 CellLabel->
  "In[763]:=",ExpressionUUID->"322a1ea8-52b2-4163-8d33-47a158740375"],

Cell[BoxData[
 FormBox[
  RowBox[{"{", 
   RowBox[{"4.196644`", ",", "Null"}], "}"}], TraditionalForm]], "Output",
 CellChangeTimes->{3.930211452057163*^9, 3.930822677602004*^9},
 CellTags->"Evaluation",
 CellLabel->
  "Out[768]=",ExpressionUUID->"ce7f742b-21f1-45ed-8b9a-53ce5c507312"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Code that samples 4-momenta of mother particles given the tabulated \
distribution\
\>", "Chapter",
 CellChangeTimes->{{3.885141680389603*^9, 3.885141685436587*^9}, {
  3.8855454831028376`*^9, 3.8855454843672276`*^9}, {3.8878174844501143`*^9, 
  3.887817484568447*^9}, {3.913276964664763*^9, 3.913276988959453*^9}},
 CellTags->
  "Evaluation",ExpressionUUID->"a19a94ae-a3db-4a44-b250-a8a4225019c3"],

Cell[CellGroupData[{

Cell["Preliminary definitions", "Section",
 CellChangeTimes->{{3.88514170753627*^9, 3.8851417130791903`*^9}, 
   3.91326460421817*^9},
 CellTags->
  "Evaluation",ExpressionUUID->"20b535ef-a1ee-45b0-9a6f-d52026ce2181"],

Cell[CellGroupData[{

Cell["\<\
Quick mapping the data {x,y,f[x,y]} \
->{x\[CloseCurlyQuote],y\[CloseCurlyQuote],f[x\[CloseCurlyQuote],y\
\[CloseCurlyQuote]]} for some structured grids {x,y} and \
{x\[CloseCurlyQuote], y\[CloseCurlyQuote]}\
\>", "Subsection",
 CellChangeTimes->{{3.913107151768467*^9, 3.9131071573912096`*^9}, {
  3.913264603355554*^9, 3.9132646061065936`*^9}},
 CellTags->
  "Evaluation",ExpressionUUID->"b94b25f8-4bb1-4586-a3a5-2c943d15b6ef"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"nd", "=", "2"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"cf2", "=", 
   RowBox[{
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"xgvars", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Unique", "[", "\"\<xg\>\"", "]"}], "&"}], "/@", 
          RowBox[{"slist", "@@", 
           RowBox[{"Range", "@", "nd"}]}]}]}], ",", 
        RowBox[{"igvars", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Unique", "[", "\"\<ig\>\"", "]"}], "&"}], "/@", 
          RowBox[{"slist", "@@", 
           RowBox[{"Range", "@", "nd"}]}]}]}], ",", 
        RowBox[{"tgvars", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Unique", "[", "\"\<tg\>\"", "]"}], "&"}], "/@", 
          RowBox[{"slist", "@@", 
           RowBox[{"Range", "@", "nd"}]}]}]}], ",", 
        RowBox[{"ivars", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Unique", "[", "\"\<i\>\"", "]"}], "&"}], "/@", 
          RowBox[{"slist", "@@", 
           RowBox[{"Range", "@", "nd"}]}]}]}], ",", 
        RowBox[{"svars", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Unique", "[", "\"\<s\>\"", "]"}], "&"}], "/@", 
          RowBox[{"slist", "@@", 
           RowBox[{"Range", "@", "nd"}]}]}]}], ",", 
        RowBox[{"tvars", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Unique", "[", "\"\<t\>\"", "]"}], "&"}], "/@", 
          RowBox[{"slist", "@@", 
           RowBox[{"Range", "@", "nd"}]}]}]}], ",", 
        RowBox[{"jvars", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Unique", "[", "\"\<j\>\"", "]"}], "&"}], "/@", 
          RowBox[{"slist", "@@", 
           RowBox[{"Range", "@", "nd"}]}]}]}]}], "}"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"Inactivate", "[", 
         RowBox[{
          RowBox[{"Compile", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"seq", "@", 
               RowBox[{"{", 
                RowBox[{"xgvars", ",", "_Real", ",", "1"}], "}"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"y", ",", "_Real", ",", "nd"}], "}"}]}], "}"}], ",", 
            RowBox[{"Module", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"seq", "@", "igvars"}], ",", 
                RowBox[{"seq", "@", "tgvars"}], ",", 
                RowBox[{"seq", "@", "ivars"}], ",", 
                RowBox[{"seq", "@", "svars"}], ",", 
                RowBox[{"seq", "@", "tvars"}]}], "}"}], ",", 
              RowBox[{
               RowBox[{"seq", "[", 
                RowBox[{"igvars", "=", 
                 RowBox[{
                  RowBox[{"Floor", "[", "xgvars", "]"}], "-", 
                  RowBox[{"UnitStep", "[", 
                   RowBox[{"xgvars", "-", 
                    RowBox[{"indexed", "@", 
                    RowBox[{"Dimensions", "@", "y"}]}]}], "]"}]}]}], "]"}], 
               ";", "\[IndentingNewLine]", 
               RowBox[{"seq", "[", 
                RowBox[{"tgvars", "=", 
                 RowBox[{"xgvars", "-", "igvars"}]}], "]"}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"seq", "[", 
                   RowBox[{"tvars", "=", 
                    RowBox[{"Compile`GetElement", "[", 
                    RowBox[{"tgvars", ",", "jvars"}], "]"}]}], "]"}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"seq", "[", 
                   RowBox[{"ivars", "=", 
                    RowBox[{"Compile`GetElement", "[", 
                    RowBox[{"igvars", ",", "jvars"}], "]"}]}], "]"}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"seq", "[", 
                   RowBox[{"svars", "=", 
                    RowBox[{"1.", "-", "tvars"}]}], "]"}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"eval", "@", 
                   RowBox[{"Total", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"Times", "@@", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "1"}], "]"}], "]"}]}], " ", 
                    RowBox[{"Compile`GetElement", "[", 
                    RowBox[{"y", ",", 
                    RowBox[{"Sequence", "@@", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "2"}], "]"}], "]"}]}]}], "]"}]}], 
                    "&"}], "/@", 
                    RowBox[{"Tuples", "@", 
                    RowBox[{"Transpose", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"svars", ",", "ivars"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"tvars", ",", 
                    RowBox[{"ivars", "+", "1"}]}], "}"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"2", ",", "3", ",", "1"}], "}"}]}], "]"}]}]}], 
                    "]"}]}]}], ",", 
                 RowBox[{"seq", "@", 
                  RowBox[{"{", 
                   RowBox[{"jvars", ",", 
                    RowBox[{"Length", "@", "igvars"}]}], "}"}]}]}], "]"}]}]}],
              "]"}], ",", 
            RowBox[{"CompilationTarget", "\[Rule]", "\"\<C\>\""}], ",", 
            RowBox[{"RuntimeAttributes", "\[Rule]", 
             RowBox[{"{", "Listable", "}"}]}], ",", 
            RowBox[{"Parallelization", "\[Rule]", "True"}], ",", 
            RowBox[{"RuntimeOptions", "\[Rule]", "\"\<Speed\>\""}]}], "]"}], 
          ",", 
          RowBox[{"Except", "[", 
           RowBox[{"seq", "|", "eval", "|", "indexed"}], "]"}]}], "]"}], "/.", 
        RowBox[{
         RowBox[{"seq", "[", "expr_", "]"}], "\[RuleDelayed]", 
         RowBox[{"RuleCondition", "@", 
          RowBox[{"(", 
           RowBox[{"Sequence", "@@", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Inactivate", "[", 
                RowBox[{"expr", ",", 
                 RowBox[{"Except", "[", 
                  RowBox[{"slist", "|", "indexed"}], "]"}]}], "]"}], "/.", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"l_slist", "\[RuleDelayed]", 
                  RowBox[{"l", "[", 
                   RowBox[{"[", "i", "]"}], "]"}]}], ",", 
                 RowBox[{
                  RowBox[{"indexed", "[", "l_", "]"}], "\[RuleDelayed]", 
                  RowBox[{
                   RowBox[{"Inactive", "[", "Compile`GetElement", "]"}], "[", 
                   
                   RowBox[{"l", ",", "i"}], "]"}]}]}], "}"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "nd"}], "}"}]}], "]"}]}], ")"}]}]}]}], "/.", 
       
       RowBox[{
        RowBox[{"eval", "@", "expr_"}], "\[RuleDelayed]", 
        RowBox[{"RuleCondition", "[", 
         RowBox[{"Activate", "[", 
          RowBox[{"expr", "/.", 
           RowBox[{"slist", "\[Rule]", "List"}]}], "]"}], "]"}]}]}]}], "]"}], 
    "//", "Activate"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.913107177305175*^9, 3.913107177361599*^9}, {
  3.913109162396256*^9, 3.913109162499637*^9}},
 CellTags->"Evaluation",
 CellLabel->
  "In[770]:=",ExpressionUUID->"d59e1373-0f6f-4224-85da-ecd147c98905"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Compiled linear interpolations - for mapping from {x,y,f[x,y]} to ",
 Cell[BoxData[
  FormBox[
   RowBox[{"{", 
    RowBox[{
     SubscriptBox["x", "random"], ",", 
     SubscriptBox["y", "random"], ",", 
     RowBox[{"f", "[", 
      RowBox[{
       SubscriptBox["x", "random"], ",", 
       SubscriptBox["y", "random"]}], "]"}]}]}], TraditionalForm]],
  ExpressionUUID->"47ba6040-5546-40d9-bcd6-b1e904b4b485"],
 "}"
}], "Subsection",
 CellChangeTimes->{{3.913107151768467*^9, 3.9131071573912096`*^9}, {
  3.913264603355554*^9, 3.913264611963004*^9}},
 CellTags->
  "Evaluation",ExpressionUUID->"b772a033-a7b6-45f9-bf82-037ca4e21689"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Random", " ", 
     RowBox[{"Log", "[", "\[Theta]", "]"}], " ", "points"}], ",", " ", 
    RowBox[{"random", " ", 
     RowBox[{"Log", "[", "E", "]"}], " ", "points"}], ","}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"linint2", "=", 
    RowBox[{"Compile", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"rand\[Theta]log", ",", "_Real"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"randElog", ",", "_Real"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"grid\[Theta]log", ",", "_Real", ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"gridElog", ",", "_Real", ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"index\[Theta]", ",", "_Integer"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"indexE", ",", "_Integer"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"distrlog", ",", "_Real", ",", "2"}], "}"}]}], "}"}], ",", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "\[Theta]el", ",", "Eel", ",", "x1", ",", "x2", ",", "y1", ",", "y2",
           ",", "z11", ",", "z21", ",", "z12", ",", "z22", ",", 
          "\[CapitalDelta]", ",", "indexlarger\[Theta]", ",", "indexlargerE", 
          ",", "lenE"}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "Finding", " ", "the", " ", "index", " ", "of", " ", "the", " ", 
          "grids", " ", "with", " ", "the", " ", "elements", " ", "larged", 
          " ", "than", " ", "the", " ", "given", " ", "random", " ", 
          "point"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"\[Theta]el", "=", 
          RowBox[{"Compile`GetElement", "[", 
           RowBox[{"grid\[Theta]log", ",", "index\[Theta]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"indexlarger\[Theta]", "=", 
          RowBox[{"index\[Theta]", "+", 
           RowBox[{"UnitStep", "[", 
            RowBox[{"rand\[Theta]log", "-", "\[Theta]el"}], "]"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Eel", "=", 
          RowBox[{"Compile`GetElement", "[", 
           RowBox[{"gridElog", ",", "indexE"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"indexlargerE", "=", 
          RowBox[{"indexE", "+", 
           RowBox[{"UnitStep", "[", 
            RowBox[{"randElog", "-", "Eel"}], "]"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"The", " ", "two", " ", "points", " ", "x1"}], ",", " ", 
           RowBox[{
            RowBox[{"x2", " ", "with", " ", "x1"}], " ", "<", " ", "x", " ", 
            "<", " ", "x2"}]}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"x1", "=", 
          RowBox[{"Compile`GetElement", "[", 
           RowBox[{"grid\[Theta]log", ",", 
            RowBox[{"indexlarger\[Theta]", "-", "1"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"x2", "=", 
          RowBox[{"Compile`GetElement", "[", 
           RowBox[{"grid\[Theta]log", ",", "indexlarger\[Theta]"}], "]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"y1", "=", 
          RowBox[{"Compile`GetElement", "[", 
           RowBox[{"gridElog", ",", 
            RowBox[{"indexlargerE", "-", "1"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"y2", "=", 
          RowBox[{"Compile`GetElement", "[", 
           RowBox[{"gridElog", ",", "indexlargerE"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
          "Corresponding", " ", "values", " ", "of", " ", "the", " ", 
           "function"}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"lenE", "=", 
          RowBox[{"Length", "[", "gridElog", "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"z11", "=", 
          RowBox[{"Compile`GetElement", "[", 
           RowBox[{"distrlog", ",", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"indexlarger\[Theta]", "-", "2"}], ")"}], "*", 
              "lenE"}], "+", "indexlargerE", "-", "1"}], ",", "3"}], "]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"z21", "=", 
          RowBox[{"Compile`GetElement", "[", 
           RowBox[{"distrlog", ",", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"indexlarger\[Theta]", "-", "1"}], ")"}], "*", 
              "lenE"}], "+", "indexlargerE", "-", "1"}], ",", "3"}], "]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"z12", "=", 
          RowBox[{"Compile`GetElement", "[", 
           RowBox[{"distrlog", ",", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"indexlarger\[Theta]", "-", "2"}], ")"}], "*", 
              "lenE"}], "+", "indexlargerE"}], ",", "3"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"z22", "=", 
          RowBox[{"Compile`GetElement", "[", 
           RowBox[{"distrlog", ",", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"indexlarger\[Theta]", "-", "1"}], ")"}], "*", 
              "lenE"}], "+", "indexlargerE"}], ",", "3"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"\[CapitalDelta]", "=", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"x2", "-", "x1"}], ")"}], 
           RowBox[{"(", 
            RowBox[{"y2", "-", "y1"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
         
         RowBox[{"Exp", "[", 
          RowBox[{"(*", 
           RowBox[{"{", 
            RowBox[{
            "rand\[Theta]log", ",", "x1", ",", "x2", ",", "randElog", ",", 
             "y1", ",", "y2", ",", "z11", ",", "z21", ",", "z12", ",", "z22", 
             ","}]}], "*)"}], 
          RowBox[{
           RowBox[{
            FractionBox[
             RowBox[{
              RowBox[{"(", 
               RowBox[{"x2", "-", "rand\[Theta]log"}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{"y2", "-", "randElog"}], ")"}]}], "\[CapitalDelta]"], 
            "*", "z11"}], "+", 
           RowBox[{
            FractionBox[
             RowBox[{
              RowBox[{"(", 
               RowBox[{"rand\[Theta]log", "-", "x1"}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{"y2", "-", "randElog"}], ")"}]}], "\[CapitalDelta]"], 
            "z21"}], "+", 
           RowBox[{
            FractionBox[
             RowBox[{
              RowBox[{"(", 
               RowBox[{"x2", "-", "rand\[Theta]log"}], ")"}], 
              RowBox[{"(", 
               RowBox[{"randElog", "-", "y1"}], ")"}]}], "\[CapitalDelta]"], 
            "*", "z12"}], "+", 
           RowBox[{
            FractionBox[
             RowBox[{
              RowBox[{"(", 
               RowBox[{"rand\[Theta]log", "-", "x1"}], ")"}], 
              RowBox[{"(", 
               RowBox[{"randElog", "-", "y1"}], ")"}]}], 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"x2", "-", "x1"}], ")"}], 
              RowBox[{"(", 
               RowBox[{"y2", "-", "y1"}], ")"}]}]], "z22"}]}], 
          RowBox[{"(*", "}", "*)"}], "]"}]}]}], "\[IndentingNewLine]", "]"}], 
      ",", 
      RowBox[{"CompilationTarget", "->", "\"\<C\>\""}], ",", 
      RowBox[{"RuntimeOptions", "->", "\"\<Speed\>\""}], ",", 
      RowBox[{"RuntimeAttributes", "->", 
       RowBox[{"{", "Listable", "}"}]}], ",", 
      RowBox[{"Parallelization", "->", "True"}]}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"<<", "CompiledFunctionTools`"}], "\n", 
   RowBox[{
    RowBox[{"CompilePrint", "@", "linint2"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"linint1", "=", 
    RowBox[{"Compile", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"rand\[Theta]log", ",", "_Real"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"grid\[Theta]log", ",", "_Real", ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"index\[Theta]", ",", "_Integer"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"distrlog", ",", "_Real", ",", "2"}], "}"}]}], "}"}], ",", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "\[Theta]el", ",", "x1", ",", "x2", ",", "z1", ",", "z2", ",", 
          "\[CapitalDelta]", ",", "indexlarger\[Theta]"}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "Finding", " ", "the", " ", "index", " ", "of", " ", "the", " ", 
          "grids", " ", "with", " ", "the", " ", "elements", " ", "larged", 
          " ", "than", " ", "the", " ", "given", " ", "random", " ", 
          "point"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"\[Theta]el", "=", 
          RowBox[{"Compile`GetElement", "[", 
           RowBox[{"grid\[Theta]log", ",", "index\[Theta]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"indexlarger\[Theta]", "=", 
          RowBox[{"index\[Theta]", "+", 
           RowBox[{"UnitStep", "[", 
            RowBox[{"rand\[Theta]log", "-", "\[Theta]el"}], "]"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"The", " ", "two", " ", "points", " ", "x1"}], ",", " ", 
           RowBox[{
            RowBox[{"x2", " ", "with", " ", "x1"}], " ", "<", " ", "x", " ", 
            "<", " ", "x2"}]}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"x1", "=", 
          RowBox[{"Compile`GetElement", "[", 
           RowBox[{"grid\[Theta]log", ",", 
            RowBox[{"indexlarger\[Theta]", "-", "1"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"x2", "=", 
          RowBox[{"Compile`GetElement", "[", 
           RowBox[{"grid\[Theta]log", ",", "indexlarger\[Theta]"}], "]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
          "Corresponding", " ", "values", " ", "of", " ", "the", " ", 
           "function"}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"z1", "=", 
          RowBox[{"Compile`GetElement", "[", 
           RowBox[{"distrlog", ",", "indexlarger\[Theta]", ",", "2"}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"z2", "=", 
          RowBox[{"Compile`GetElement", "[", 
           RowBox[{"distrlog", ",", 
            RowBox[{"indexlarger\[Theta]", "-", "1"}], ",", "2"}], "]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"\[CapitalDelta]", "=", 
          RowBox[{"(", 
           RowBox[{"x2", "-", "x1"}], ")"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{"{", 
           RowBox[{
           "rand\[Theta]log", ",", "x1", ",", "x2", ",", "z1", ",", "z2", 
            ","}]}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"z1", "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"rand\[Theta]log", "-", "x1"}], ")"}], "*", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"z2", "-", "z1"}], ")"}], "/", 
            "\[CapitalDelta]"}]}]}]}]}], 
       RowBox[{"(*", "}", "*)"}], "\[IndentingNewLine]", "]"}], ",", 
      RowBox[{"CompilationTarget", "->", "\"\<C\>\""}], ",", 
      RowBox[{"RuntimeOptions", "->", "\"\<Speed\>\""}], ",", 
      RowBox[{"RuntimeAttributes", "->", 
       RowBox[{"{", "Listable", "}"}]}], ",", 
      RowBox[{"Parallelization", "->", "True"}]}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"<<", "CompiledFunctionTools`"}], "\n", 
   RowBox[{
    RowBox[{"CompilePrint", "@", "linint1"}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.913174770825806*^9, 3.9131747755776596`*^9}, {
   3.913175754441927*^9, 3.913175832848888*^9}, 3.913175876968843*^9, {
   3.913176070505515*^9, 3.913176216392052*^9}, {3.913178090513044*^9, 
   3.913178092141858*^9}, {3.913178521899283*^9, 3.9131785337348037`*^9}, {
   3.913178589289935*^9, 3.9131786589896235`*^9}, {3.913178809847124*^9, 
   3.913178832698764*^9}, {3.913179301217944*^9, 3.913179322325599*^9}},
 CellTags->"Evaluation",
 CellLabel->
  "In[772]:=",ExpressionUUID->"350c467b-7755-44e9-a68b-9e78f62450ae"],

Cell[BoxData[
 FormBox[
  InterpretationBox[
   RowBox[{
    TagBox["CompiledFunction",
     "SummaryHead"], "[", 
    DynamicModuleBox[{Typeset`open$$ = False, Typeset`embedState$$ = "Ready"}, 
     TemplateBox[{
       PaneSelectorBox[{False -> GridBox[{{
             PaneBox[
              ButtonBox[
               DynamicBox[
                FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxOpener"]], 
               ButtonFunction :> (Typeset`open$$ = True), Appearance -> None, 
               BaseStyle -> {}, Evaluator -> Automatic, Method -> 
               "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
              Dynamic[{
                Automatic, 
                 3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                  Magnification])}]], 
             GraphicsBox[{
               Thickness[0.038461538461538464`], {
                FaceForm[{
                  GrayLevel[0.93], 
                  Opacity[1.]}], 
                
                FilledCurveBox[{{{1, 4, 3}, {0, 1, 0}, {1, 3, 3}, {0, 1, 0}, {
                 1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {0, 1, 0}}}, {{{
                 25.499999999999996`, 2.5}, {25.499999999999996`, 
                 1.3953100000000003`}, {24.604699999999998`, 
                 0.49999999999999994`}, {23.5, 0.49999999999999994`}, {2.5, 
                 0.49999999999999994`}, {1.3953100000000003`, 
                 0.49999999999999994`}, {0.49999999999999994`, 
                 1.3953100000000003`}, {0.49999999999999994`, 2.5}, {
                 0.49999999999999994`, 23.5}, {0.49999999999999994`, 
                 24.604699999999998`}, {1.3953100000000003`, 
                 25.499999999999996`}, {2.5, 25.499999999999996`}, {23.5, 
                 25.499999999999996`}, {24.604699999999998`, 
                 25.499999999999996`}, {25.499999999999996`, 
                 24.604699999999998`}, {25.499999999999996`, 23.5}, {
                 25.499999999999996`, 2.5}}}]}, {
                FaceForm[{
                  RGBColor[0.5, 0.5, 0.5], 
                  Opacity[1.]}], 
                
                FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {
                 0, 1, 0}, {0, 1, 0}, {0, 1, 0}}}, {{{20.5426, 
                 19.116799999999998`}, {16.3832, 21.876199999999997`}, {
                 16.3832, 20.021499999999996`}, {6.930469999999999, 
                 20.021499999999996`}, {6.930469999999999, 
                 18.212100000000003`}, {16.3832, 18.212100000000003`}, {
                 16.3832, 16.357399999999995`}, {20.5426, 
                 19.116799999999998`}}}], 
                
                FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {
                 0, 1, 0}, {0, 1, 0}, {0, 1, 0}}}, {{{5.30508, 13.8391}, {
                 9.46445, 11.079700000000003`}, {9.46445, 
                 12.933999999999997`}, {18.917199999999998`, 
                 12.933999999999997`}, {18.917199999999998`, 14.7438}, {
                 9.46445, 14.7438}, {9.46445, 16.598}, {5.30508, 13.8391}}}], 
                
                
                FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {
                 0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
                 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {
                 1, 3, 3}, {1, 3, 3}, {1, 3, 3}}}, CompressedData["
1:eJxTTMoPSmVmYGBgBGJjIGYCYq4u+eR3VWoOxhkv5j+Qk3SA8fu/r5rKOVHM
Yd2vmNyjZ9Qcrt9QXbW9S8RBg59767IidQcPMYPGaHFhB+Nn61SfiGo4xBwp
T7o2V9Dh0Iolfg6/NBxEHv/x1Xgi4FB1XNNqkqQWnP+axUTQjFkbzn+oO2HB
j/3aDg/Xn5T6WiDoYLs3aJpiqI7DrHN+bO6tQg4zfUR7vF7pQOyfIQyRd9d1
WLL0U1kLoyjEPdm6DpoTXfQX7xBzKPjQejLkhDacL5J4+LL2Gm2HtNnSl4Vf
iELM69J2qPZM3tLnJerQX1oozZugDfHPUxGI/4W1HQ5p3TthoyDi4D7lG1v8
Mi2HgqL9zoEHhB1inOxe3BRG8MH62zXhfIbN1Z82CGhC/GMg4nCm3mN/7TYN
iHlCUPdGakDc/1kUEr46GhD/eYnD+d9iBf/kC0vC+TuCrSL+X5Vy2HGR4R5T
uAbEfxYykPBYp+HQqsCuesZAFhL+rJoQ/2rIQdxTpwkJ7yVycPfD+GDzVqLx
xbUd5HYt2JfqBdWfpA2Jj9mykPDpgYaXtaxDy7yzq86vg8qvlIHE5ylY/Eo7
XAt7o787TxfOB5ufqesQ9PbyxxkPZSDhZ6nrMAGU3u7LQtLLEx2HN2253UbX
ofZ76jis/Pay4oynAsT8QG0HKZMv/gW7FCDyTFpwPsz/MD44/Mw1HFjb1uR9
TVVwWKy880/7FHWIexrkIfLX1RzOMDZZVjHIOaDkh3vSDuj5AwCF11Vc
                 "]]}}, Background -> GrayLevel[0.93], Axes -> False, 
              AspectRatio -> 1, ImageSize -> 
              Dynamic[{
                Automatic, 
                 3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                  Magnification])}], Frame -> True, FrameTicks -> None, 
              FrameStyle -> Directive[
                Thickness[Tiny], 
                GrayLevel[0.7]]], 
             GridBox[{{
                RowBox[{
                  TagBox["\"Argument count: \"", "SummaryItemAnnotation"], 
                  "\[InvisibleSpace]", 
                  TagBox["7", "SummaryItem"]}]}, {
                RowBox[{
                  TagBox["\"Argument types: \"", "SummaryItemAnnotation"], 
                  "\[InvisibleSpace]", 
                  TagBox[
                   StyleBox[
                    PaneBox[
                    RowBox[{"{", 
                    RowBox[{"_Real", ",", "_Real", ",", 
                    RowBox[{"{", 
                    RowBox[{"_Real", ",", "1"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"_Real", ",", "1"}], "}"}], ",", "_Integer", ",", 
                    "_Integer", ",", 
                    RowBox[{"{", 
                    RowBox[{"_Real", ",", "2"}], "}"}]}], "}"}], 
                    ContentPadding -> False, FrameMargins -> 0, StripOnInput -> 
                    True, BaselinePosition -> Baseline, 
                    ImageSize -> {{1, 300}, Automatic}], LineBreakWithin -> 
                    False], "SummaryItem"]}]}}, 
              GridBoxAlignment -> {
               "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
              False, GridBoxItemSize -> {
               "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
              GridBoxSpacings -> {
               "Columns" -> {{2}}, "Rows" -> {{Automatic}}}, 
              BaseStyle -> {
               ShowStringCharacters -> False, NumberMarks -> False, 
                PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
           GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
           AutoDelete -> False, 
           GridBoxItemSize -> {
            "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
           BaselinePosition -> {1, 1}], True -> GridBox[{{
             PaneBox[
              ButtonBox[
               DynamicBox[
                FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxCloser"]], 
               ButtonFunction :> (Typeset`open$$ = False), Appearance -> None,
                BaseStyle -> {}, Evaluator -> Automatic, Method -> 
               "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
              Dynamic[{
                Automatic, 
                 3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                  Magnification])}]], 
             GraphicsBox[{
               Thickness[0.038461538461538464`], {
                FaceForm[{
                  GrayLevel[0.93], 
                  Opacity[1.]}], 
                
                FilledCurveBox[{{{1, 4, 3}, {0, 1, 0}, {1, 3, 3}, {0, 1, 0}, {
                 1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {0, 1, 0}}}, {{{
                 25.499999999999996`, 2.5}, {25.499999999999996`, 
                 1.3953100000000003`}, {24.604699999999998`, 
                 0.49999999999999994`}, {23.5, 0.49999999999999994`}, {2.5, 
                 0.49999999999999994`}, {1.3953100000000003`, 
                 0.49999999999999994`}, {0.49999999999999994`, 
                 1.3953100000000003`}, {0.49999999999999994`, 2.5}, {
                 0.49999999999999994`, 23.5}, {0.49999999999999994`, 
                 24.604699999999998`}, {1.3953100000000003`, 
                 25.499999999999996`}, {2.5, 25.499999999999996`}, {23.5, 
                 25.499999999999996`}, {24.604699999999998`, 
                 25.499999999999996`}, {25.499999999999996`, 
                 24.604699999999998`}, {25.499999999999996`, 23.5}, {
                 25.499999999999996`, 2.5}}}]}, {
                FaceForm[{
                  RGBColor[0.5, 0.5, 0.5], 
                  Opacity[1.]}], 
                
                FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {
                 0, 1, 0}, {0, 1, 0}, {0, 1, 0}}}, {{{20.5426, 
                 19.116799999999998`}, {16.3832, 21.876199999999997`}, {
                 16.3832, 20.021499999999996`}, {6.930469999999999, 
                 20.021499999999996`}, {6.930469999999999, 
                 18.212100000000003`}, {16.3832, 18.212100000000003`}, {
                 16.3832, 16.357399999999995`}, {20.5426, 
                 19.116799999999998`}}}], 
                
                FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {
                 0, 1, 0}, {0, 1, 0}, {0, 1, 0}}}, {{{5.30508, 13.8391}, {
                 9.46445, 11.079700000000003`}, {9.46445, 
                 12.933999999999997`}, {18.917199999999998`, 
                 12.933999999999997`}, {18.917199999999998`, 14.7438}, {
                 9.46445, 14.7438}, {9.46445, 16.598}, {5.30508, 13.8391}}}], 
                
                
                FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {
                 0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
                 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {
                 1, 3, 3}, {1, 3, 3}, {1, 3, 3}}}, CompressedData["
1:eJxTTMoPSmVmYGBgBGJjIGYCYq4u+eR3VWoOxhkv5j+Qk3SA8fu/r5rKOVHM
Yd2vmNyjZ9Qcrt9QXbW9S8RBg59767IidQcPMYPGaHFhB+Nn61SfiGo4xBwp
T7o2V9Dh0Iolfg6/NBxEHv/x1Xgi4FB1XNNqkqQWnP+axUTQjFkbzn+oO2HB
j/3aDg/Xn5T6WiDoYLs3aJpiqI7DrHN+bO6tQg4zfUR7vF7pQOyfIQyRd9d1
WLL0U1kLoyjEPdm6DpoTXfQX7xBzKPjQejLkhDacL5J4+LL2Gm2HtNnSl4Vf
iELM69J2qPZM3tLnJerQX1oozZugDfHPUxGI/4W1HQ5p3TthoyDi4D7lG1v8
Mi2HgqL9zoEHhB1inOxe3BRG8MH62zXhfIbN1Z82CGhC/GMg4nCm3mN/7TYN
iHlCUPdGakDc/1kUEr46GhD/eYnD+d9iBf/kC0vC+TuCrSL+X5Vy2HGR4R5T
uAbEfxYykPBYp+HQqsCuesZAFhL+rJoQ/2rIQdxTpwkJ7yVycPfD+GDzVqLx
xbUd5HYt2JfqBdWfpA2Jj9mykPDpgYaXtaxDy7yzq86vg8qvlIHE5ylY/Eo7
XAt7o787TxfOB5ufqesQ9PbyxxkPZSDhZ6nrMAGU3u7LQtLLEx2HN2253UbX
ofZ76jis/Pay4oynAsT8QG0HKZMv/gW7FCDyTFpwPsz/MD44/Mw1HFjb1uR9
TVVwWKy880/7FHWIexrkIfLX1RzOMDZZVjHIOaDkh3vSDuj5AwCF11Vc
                 "]]}}, Background -> GrayLevel[0.93], Axes -> False, 
              AspectRatio -> 1, ImageSize -> 
              Dynamic[{
                Automatic, 
                 3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                  Magnification])}], Frame -> True, FrameTicks -> None, 
              FrameStyle -> Directive[
                Thickness[Tiny], 
                GrayLevel[0.7]]], 
             GridBox[{{
                RowBox[{
                  TagBox["\"Argument count: \"", "SummaryItemAnnotation"], 
                  "\[InvisibleSpace]", 
                  TagBox["7", "SummaryItem"]}]}, {
                RowBox[{
                  TagBox["\"Argument types: \"", "SummaryItemAnnotation"], 
                  "\[InvisibleSpace]", 
                  TagBox[
                   PaneBox[
                    RowBox[{"{", 
                    RowBox[{"_Real", ",", "_Real", ",", 
                    RowBox[{"{", 
                    RowBox[{"_Real", ",", "1"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"_Real", ",", "1"}], "}"}], ",", "_Integer", ",", 
                    "_Integer", ",", 
                    RowBox[{"{", 
                    RowBox[{"_Real", ",", "2"}], "}"}]}], "}"}], 
                    ImageSize -> {{1, 500}, Automatic}, BaselinePosition -> 
                    Baseline, ContentPadding -> False, FrameMargins -> 0, 
                    StripOnInput -> True], "SummaryItem"]}]}, {
                RowBox[{
                  TagBox["\"Variables: \"", "SummaryItemAnnotation"], 
                  "\[InvisibleSpace]", 
                  TagBox[
                   RowBox[{"{", 
                    
                    RowBox[{
                    "rand\[Theta]log", ",", "randElog", ",", 
                    "grid\[Theta]log", ",", "gridElog", ",", "index\[Theta]", 
                    ",", "indexE", ",", "distrlog"}], "}"}], 
                   "SummaryItem"]}]}, {
                RowBox[{
                  TagBox["\"Expression: \"", "SummaryItemAnnotation"], 
                  "\[InvisibleSpace]", 
                  TagBox[
                   PaneBox[
                    RowBox[{"Block", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    
                    RowBox[{
                    "Compile`$126", ",", "Compile`$135", ",", "Compile`$140", 
                    ",", "Compile`$124", ",", "Compile`$125", ",", 
                    "Compile`$145", ",", "Compile`$149", ",", "Compile`$152", 
                    ",", "Compile`$153"}], "}"}], ",", 
                    RowBox[{"Module", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    
                    RowBox[{"\[Theta]el", ",", "Eel", ",", "x1", ",", "x2", 
                    ",", "y1", ",", "y2", ",", "z11", ",", "z21", ",", "z12", 
                    ",", "z22", ",", "\[CapitalDelta]", ",", 
                    "indexlarger\[Theta]", ",", "indexlargerE", ",", "lenE"}],
                     "}"}], ",", 
                    RowBox[{
                    RowBox[{"\[Theta]el", "=", 
                    RowBox[{"Compile`GetElement", "(", 
                    RowBox[{"grid\[Theta]log", ",", "index\[Theta]"}], 
                    ")"}]}], ";", 
                    RowBox[{"indexlarger\[Theta]", "=", 
                    RowBox[{"index\[Theta]", "+", 
                    TemplateBox[{
                    RowBox[{
                    RowBox[{"rand\[Theta]log", "-", "\[Theta]el"}]}]}, 
                    "UnitStepSeq"]}]}], ";", 
                    RowBox[{"Eel", "=", 
                    RowBox[{"Compile`GetElement", "(", 
                    RowBox[{"gridElog", ",", "indexE"}], ")"}]}], ";", 
                    RowBox[{"indexlargerE", "=", 
                    RowBox[{
                    TemplateBox[{
                    RowBox[{
                    RowBox[{"randElog", "-", "Eel"}]}]}, "UnitStepSeq"], "+", 
                    "indexE"}]}], ";", 
                    RowBox[{"x1", "=", 
                    RowBox[{"Compile`GetElement", "(", 
                    RowBox[{"grid\[Theta]log", ",", 
                    RowBox[{"indexlarger\[Theta]", "-", "1"}]}], ")"}]}], ";", 
                    RowBox[{"x2", "=", 
                    RowBox[{"Compile`GetElement", "(", 
                    RowBox[{"grid\[Theta]log", ",", "indexlarger\[Theta]"}], 
                    ")"}]}], ";", 
                    RowBox[{"y1", "=", 
                    RowBox[{"Compile`GetElement", "(", 
                    RowBox[{"gridElog", ",", 
                    RowBox[{"indexlargerE", "-", "1"}]}], ")"}]}], ";", 
                    RowBox[{"y2", "=", 
                    RowBox[{"Compile`GetElement", "(", 
                    RowBox[{"gridElog", ",", "indexlargerE"}], ")"}]}], ";", 
                    RowBox[{"lenE", "=", 
                    RowBox[{"Length", "[", "gridElog", "]"}]}], ";", 
                    RowBox[{"z11", "=", 
                    RowBox[{"Compile`GetElement", "(", 
                    RowBox[{"distrlog", ",", 
                    RowBox[{"indexlargerE", "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"indexlarger\[Theta]", "-", "2"}], ")"}], " ", 
                    "lenE"}], "-", "1"}], ",", "3"}], ")"}]}], ";", 
                    RowBox[{"z21", "=", 
                    RowBox[{"Compile`GetElement", "(", 
                    RowBox[{"distrlog", ",", 
                    RowBox[{"indexlargerE", "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"indexlarger\[Theta]", "-", "1"}], ")"}], " ", 
                    "lenE"}], "-", "1"}], ",", "3"}], ")"}]}], ";", 
                    RowBox[{"z12", "=", 
                    RowBox[{"Compile`GetElement", "(", 
                    RowBox[{"distrlog", ",", 
                    RowBox[{"indexlargerE", "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"indexlarger\[Theta]", "-", "2"}], ")"}], " ", 
                    "lenE"}]}], ",", "3"}], ")"}]}], ";", 
                    RowBox[{"z22", "=", 
                    RowBox[{"Compile`GetElement", "(", 
                    RowBox[{"distrlog", ",", 
                    RowBox[{"indexlargerE", "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"indexlarger\[Theta]", "-", "1"}], ")"}], " ", 
                    "lenE"}]}], ",", "3"}], ")"}]}], ";", 
                    RowBox[{"\[CapitalDelta]", "=", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"x2", "-", "x1"}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{"y2", "-", "y1"}], ")"}]}]}], ";", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Compile`$126", "=", 
                    RowBox[{"-", "randElog"}]}], ";", 
                    RowBox[{"Compile`$135", "=", 
                    RowBox[{"Compile`$126", "+", "y2"}]}], ";", 
                    RowBox[{"Compile`$140", "=", 
                    FractionBox["1", "\[CapitalDelta]"]}], ";", 
                    RowBox[{"Compile`$124", "=", 
                    RowBox[{"-", "rand\[Theta]log"}]}], ";", 
                    RowBox[{"Compile`$125", "=", 
                    RowBox[{"Compile`$124", "+", "x2"}]}], ";", 
                    RowBox[{"Compile`$145", "=", 
                    RowBox[{"-", "x1"}]}], ";", 
                    RowBox[{"Compile`$149", "=", 
                    RowBox[{"Compile`$145", "+", "rand\[Theta]log"}]}], ";", 
                    RowBox[{"Compile`$152", "=", 
                    RowBox[{"-", "y1"}]}], ";", 
                    RowBox[{"Compile`$153", "=", 
                    RowBox[{"Compile`$152", "+", "randElog"}]}], ";", 
                    RowBox[{"exp", "(", 
                    RowBox[{
                    RowBox[{"z11", " ", 
                    RowBox[{"(", 
                    
                    RowBox[{"Compile`$125", " ", "Compile`$135", " ", 
                    "Compile`$140"}], ")"}]}], "+", 
                    RowBox[{"z12", " ", 
                    RowBox[{"(", 
                    
                    RowBox[{"Compile`$125", " ", "Compile`$140", " ", 
                    "Compile`$153"}], ")"}]}], "+", 
                    RowBox[{"z21", " ", 
                    RowBox[{"(", 
                    
                    RowBox[{"Compile`$135", " ", "Compile`$140", " ", 
                    "Compile`$149"}], ")"}]}], "+", 
                    FractionBox[
                    RowBox[{"z22", " ", 
                    RowBox[{"(", 
                    RowBox[{"Compile`$149", " ", "Compile`$153"}], ")"}]}], 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"Compile`$145", "+", "x2"}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{"Compile`$152", "+", "y2"}], ")"}]}]]}], ")"}]}], 
                    ")"}]}]}], "]"}]}], "]"}], 
                    ImageSize -> {{1, 500}, Automatic}, BaselinePosition -> 
                    Baseline, ContentPadding -> False, FrameMargins -> 0, 
                    StripOnInput -> True], "SummaryItem"]}]}}, 
              GridBoxAlignment -> {
               "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
              False, GridBoxItemSize -> {
               "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
              GridBoxSpacings -> {
               "Columns" -> {{2}}, "Rows" -> {{Automatic}}}, 
              BaseStyle -> {
               ShowStringCharacters -> False, NumberMarks -> False, 
                PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
           GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
           AutoDelete -> False, 
           GridBoxItemSize -> {
            "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
           BaselinePosition -> {1, 1}]}, 
        Dynamic[Typeset`open$$], ImageSize -> Automatic]},
      "SummaryPanel"],
     DynamicModuleValues:>{}], "]"}],
   CompiledFunction[{11, 14., 5848}, {
     Blank[Real], 
     Blank[Real], {
      Blank[Real], 1}, {
      Blank[Real], 1}, 
     Blank[Integer], 
     Blank[Integer], {
      Blank[Real], 2}}, {{3, 0, 0}, {3, 0, 1}, {3, 1, 0}, {3, 1, 1}, {2, 0, 
    0}, {2, 0, 1}, {3, 2, 2}, {3, 0, 
    23}}, {{-1, {2, 0, 5}}, {-2, {2, 0, 6}}, {3, {2, 0, 8}}}, {0, 9, 27, 0, 
    3}, {{37, 0, 0, 3, 2}, {19, 2, 3}, {13, 0, 3, 4}, {40, 66, 3, 0, 4, 2, 0, 
     2}, {12, 0, 2, 3}, {37, 1, 1, 3, 4}, {19, 4, 3}, {13, 1, 3, 5}, {40, 66, 
     3, 0, 5, 2, 0, 2}, {12, 1, 2, 4}, {12, 3, 5, 2}, {37, 0, 2, 3, 5}, {37, 
     0, 3, 3, 3}, {12, 4, 5, 2}, {37, 1, 2, 3, 6}, {37, 1, 4, 3, 7}, {33, 1, 
     2}, {12, 3, 6, 7}, {15, 7, 2, 7}, {12, 7, 4, 5, 7}, {37, 2, 7, 8, 3, 
     8}, {12, 3, 5, 7}, {15, 7, 2, 7}, {12, 7, 4, 5, 7}, {37, 2, 7, 8, 3, 
     9}, {12, 3, 6, 7}, {15, 7, 2, 7}, {12, 7, 4, 7}, {37, 2, 7, 8, 3, 10}, {
     12, 3, 5, 7}, {15, 7, 2, 7}, {12, 7, 4, 7}, {37, 2, 7, 8, 3, 11}, {19, 5,
      12}, {13, 3, 12, 13}, {19, 6, 12}, {13, 7, 12, 14}, {16, 13, 14, 13}, {
     19, 1, 14}, {13, 7, 14, 12}, {40, 60, 3, 0, 13, 3, 0, 15}, {19, 0, 16}, {
     13, 3, 16, 17}, {19, 5, 18}, {13, 0, 18, 19}, {19, 6, 20}, {13, 1, 20, 
     21}, {16, 17, 12, 15, 22}, {16, 22, 8, 22}, {16, 19, 12, 15, 23}, {16, 
     23, 9, 23}, {16, 17, 21, 15, 24}, {16, 24, 10, 24}, {13, 3, 18, 25}, {13,
      7, 20, 26}, {16, 25, 26, 25}, {40, 60, 3, 0, 25, 3, 0, 26}, {16, 19, 21,
      26, 25}, {16, 25, 11, 25}, {13, 22, 23, 24, 25, 22}, {40, 32, 3, 0, 22, 
     3, 0, 23}, {1}}, 
    Function[{$CellContext`rand\[Theta]log, $CellContext`randElog, \
$CellContext`grid\[Theta]log, $CellContext`gridElog, $CellContext`index\
\[Theta], $CellContext`indexE, $CellContext`distrlog}, 
     Block[{
      Compile`$126, Compile`$135, Compile`$140, Compile`$124, Compile`$125, 
       Compile`$145, Compile`$149, Compile`$152, Compile`$153}, 
      Module[{$CellContext`\[Theta]el, $CellContext`Eel, $CellContext`x1, \
$CellContext`x2, $CellContext`y1, $CellContext`y2, $CellContext`z11, \
$CellContext`z21, $CellContext`z12, $CellContext`z22, $CellContext`\
\[CapitalDelta], $CellContext`indexlarger\[Theta], $CellContext`indexlargerE, \
$CellContext`lenE}, $CellContext`\[Theta]el = 
        Compile`GetElement[$CellContext`grid\[Theta]log, $CellContext`index\
\[Theta]]; $CellContext`indexlarger\[Theta] = $CellContext`index\[Theta] + 
         UnitStep[$CellContext`rand\[Theta]log - $CellContext`\[Theta]el]; \
$CellContext`Eel = 
        Compile`GetElement[$CellContext`gridElog, $CellContext`indexE]; \
$CellContext`indexlargerE = $CellContext`indexE + 
         UnitStep[$CellContext`randElog - $CellContext`Eel]; $CellContext`x1 = 
        Compile`GetElement[$CellContext`grid\[Theta]log, \
$CellContext`indexlarger\[Theta] - 1]; $CellContext`x2 = 
        Compile`GetElement[$CellContext`grid\[Theta]log, \
$CellContext`indexlarger\[Theta]]; $CellContext`y1 = 
        Compile`GetElement[$CellContext`gridElog, $CellContext`indexlargerE - 
          1]; $CellContext`y2 = 
        Compile`GetElement[$CellContext`gridElog, $CellContext`indexlargerE]; \
$CellContext`lenE = Length[$CellContext`gridElog]; $CellContext`z11 = 
        Compile`GetElement[$CellContext`distrlog, ($CellContext`indexlarger\
\[Theta] - 2) $CellContext`lenE + $CellContext`indexlargerE - 1, 
          3]; $CellContext`z21 = 
        Compile`GetElement[$CellContext`distrlog, ($CellContext`indexlarger\
\[Theta] - 1) $CellContext`lenE + $CellContext`indexlargerE - 1, 
          3]; $CellContext`z12 = 
        Compile`GetElement[$CellContext`distrlog, ($CellContext`indexlarger\
\[Theta] - 2) $CellContext`lenE + $CellContext`indexlargerE, 
          3]; $CellContext`z22 = 
        Compile`GetElement[$CellContext`distrlog, ($CellContext`indexlarger\
\[Theta] - 1) $CellContext`lenE + $CellContext`indexlargerE, 
          3]; $CellContext`\[CapitalDelta] = ($CellContext`x2 - \
$CellContext`x1) ($CellContext`y2 - $CellContext`y1); (
        Compile`$126 = -$CellContext`randElog; 
        Compile`$135 = $CellContext`y2 + Compile`$126; 
        Compile`$140 = $CellContext`\[CapitalDelta]^(-1); 
        Compile`$124 = -$CellContext`rand\[Theta]log; 
        Compile`$125 = $CellContext`x2 + Compile`$124; 
        Compile`$145 = -$CellContext`x1; 
        Compile`$149 = $CellContext`rand\[Theta]log + Compile`$145; 
        Compile`$152 = -$CellContext`y1; 
        Compile`$153 = $CellContext`randElog + Compile`$152; 
        Exp[(Compile`$125 Compile`$135 Compile`$140) $CellContext`z11 + (
            Compile`$149 Compile`$135 Compile`$140) $CellContext`z21 + (
            Compile`$125 Compile`$153 Compile`$140) $CellContext`z12 + (
            Compile`$149 (
             Compile`$153/(($CellContext`x2 + Compile`$145) ($CellContext`y2 + 
              Compile`$152)))) $CellContext`z22])]], Listable], Evaluate, 
    LibraryFunction[
    "/Users/alberto/Library/Mathematica/ApplicationData/CCompilerDriver/\
BuildFolder/eduroam-4014-1219/compiledFunction45.dylib", 
     "compiledFunction45", {{Real, 0, "Constant"}, {Real, 0, "Constant"}, {
      Real, 1, "Constant"}, {Real, 1, "Constant"}, {Integer, 0, "Constant"}, {
      Integer, 0, "Constant"}, {Real, 2, "Constant"}}, Real]],
   Editable->False,
   SelectWithContents->True,
   Selectable->False], TraditionalForm]], "Output",
 CellChangeTimes->{3.9302114533920383`*^9, 3.930822679360955*^9},
 CellTags->"Evaluation",
 CellLabel->
  "Out[772]=",ExpressionUUID->"db8dcd1a-5ab4-494e-8cdd-f9e86a4fb3c4"],

Cell[BoxData[
 FormBox[
  InterpretationBox[
   RowBox[{
    TagBox["CompiledFunction",
     "SummaryHead"], "[", 
    DynamicModuleBox[{Typeset`open$$ = False, Typeset`embedState$$ = "Ready"}, 
     TemplateBox[{
       PaneSelectorBox[{False -> GridBox[{{
             PaneBox[
              ButtonBox[
               DynamicBox[
                FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxOpener"]], 
               ButtonFunction :> (Typeset`open$$ = True), Appearance -> None, 
               BaseStyle -> {}, Evaluator -> Automatic, Method -> 
               "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
              Dynamic[{
                Automatic, 
                 3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                  Magnification])}]], 
             GraphicsBox[{
               Thickness[0.038461538461538464`], {
                FaceForm[{
                  GrayLevel[0.93], 
                  Opacity[1.]}], 
                
                FilledCurveBox[{{{1, 4, 3}, {0, 1, 0}, {1, 3, 3}, {0, 1, 0}, {
                 1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {0, 1, 0}}}, {{{
                 25.499999999999996`, 2.5}, {25.499999999999996`, 
                 1.3953100000000003`}, {24.604699999999998`, 
                 0.49999999999999994`}, {23.5, 0.49999999999999994`}, {2.5, 
                 0.49999999999999994`}, {1.3953100000000003`, 
                 0.49999999999999994`}, {0.49999999999999994`, 
                 1.3953100000000003`}, {0.49999999999999994`, 2.5}, {
                 0.49999999999999994`, 23.5}, {0.49999999999999994`, 
                 24.604699999999998`}, {1.3953100000000003`, 
                 25.499999999999996`}, {2.5, 25.499999999999996`}, {23.5, 
                 25.499999999999996`}, {24.604699999999998`, 
                 25.499999999999996`}, {25.499999999999996`, 
                 24.604699999999998`}, {25.499999999999996`, 23.5}, {
                 25.499999999999996`, 2.5}}}]}, {
                FaceForm[{
                  RGBColor[0.5, 0.5, 0.5], 
                  Opacity[1.]}], 
                
                FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {
                 0, 1, 0}, {0, 1, 0}, {0, 1, 0}}}, {{{20.5426, 
                 19.116799999999998`}, {16.3832, 21.876199999999997`}, {
                 16.3832, 20.021499999999996`}, {6.930469999999999, 
                 20.021499999999996`}, {6.930469999999999, 
                 18.212100000000003`}, {16.3832, 18.212100000000003`}, {
                 16.3832, 16.357399999999995`}, {20.5426, 
                 19.116799999999998`}}}], 
                
                FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {
                 0, 1, 0}, {0, 1, 0}, {0, 1, 0}}}, {{{5.30508, 13.8391}, {
                 9.46445, 11.079700000000003`}, {9.46445, 
                 12.933999999999997`}, {18.917199999999998`, 
                 12.933999999999997`}, {18.917199999999998`, 14.7438}, {
                 9.46445, 14.7438}, {9.46445, 16.598}, {5.30508, 13.8391}}}], 
                
                
                FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {
                 0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
                 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {
                 1, 3, 3}, {1, 3, 3}, {1, 3, 3}}}, CompressedData["
1:eJxTTMoPSmVmYGBgBGJjIGYCYq4u+eR3VWoOxhkv5j+Qk3SA8fu/r5rKOVHM
Yd2vmNyjZ9Qcrt9QXbW9S8RBg59767IidQcPMYPGaHFhB+Nn61SfiGo4xBwp
T7o2V9Dh0Iolfg6/NBxEHv/x1Xgi4FB1XNNqkqQWnP+axUTQjFkbzn+oO2HB
j/3aDg/Xn5T6WiDoYLs3aJpiqI7DrHN+bO6tQg4zfUR7vF7pQOyfIQyRd9d1
WLL0U1kLoyjEPdm6DpoTXfQX7xBzKPjQejLkhDacL5J4+LL2Gm2HtNnSl4Vf
iELM69J2qPZM3tLnJerQX1oozZugDfHPUxGI/4W1HQ5p3TthoyDi4D7lG1v8
Mi2HgqL9zoEHhB1inOxe3BRG8MH62zXhfIbN1Z82CGhC/GMg4nCm3mN/7TYN
iHlCUPdGakDc/1kUEr46GhD/eYnD+d9iBf/kC0vC+TuCrSL+X5Vy2HGR4R5T
uAbEfxYykPBYp+HQqsCuesZAFhL+rJoQ/2rIQdxTpwkJ7yVycPfD+GDzVqLx
xbUd5HYt2JfqBdWfpA2Jj9mykPDpgYaXtaxDy7yzq86vg8qvlIHE5ylY/Eo7
XAt7o787TxfOB5ufqesQ9PbyxxkPZSDhZ6nrMAGU3u7LQtLLEx2HN2253UbX
ofZ76jis/Pay4oynAsT8QG0HKZMv/gW7FCDyTFpwPsz/MD44/Mw1HFjb1uR9
TVVwWKy880/7FHWIexrkIfLX1RzOMDZZVjHIOaDkh3vSDuj5AwCF11Vc
                 "]]}}, Background -> GrayLevel[0.93], Axes -> False, 
              AspectRatio -> 1, ImageSize -> 
              Dynamic[{
                Automatic, 
                 3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                  Magnification])}], Frame -> True, FrameTicks -> None, 
              FrameStyle -> Directive[
                Thickness[Tiny], 
                GrayLevel[0.7]]], 
             GridBox[{{
                RowBox[{
                  TagBox["\"Argument count: \"", "SummaryItemAnnotation"], 
                  "\[InvisibleSpace]", 
                  TagBox["4", "SummaryItem"]}]}, {
                RowBox[{
                  TagBox["\"Argument types: \"", "SummaryItemAnnotation"], 
                  "\[InvisibleSpace]", 
                  TagBox[
                   StyleBox[
                    PaneBox[
                    RowBox[{"{", 
                    RowBox[{"_Real", ",", 
                    RowBox[{"{", 
                    RowBox[{"_Real", ",", "1"}], "}"}], ",", "_Integer", ",", 
                    
                    RowBox[{"{", 
                    RowBox[{"_Real", ",", "2"}], "}"}]}], "}"}], 
                    ContentPadding -> False, FrameMargins -> 0, StripOnInput -> 
                    True, BaselinePosition -> Baseline, 
                    ImageSize -> {{1, 300}, Automatic}], LineBreakWithin -> 
                    False], "SummaryItem"]}]}}, 
              GridBoxAlignment -> {
               "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
              False, GridBoxItemSize -> {
               "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
              GridBoxSpacings -> {
               "Columns" -> {{2}}, "Rows" -> {{Automatic}}}, 
              BaseStyle -> {
               ShowStringCharacters -> False, NumberMarks -> False, 
                PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
           GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
           AutoDelete -> False, 
           GridBoxItemSize -> {
            "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
           BaselinePosition -> {1, 1}], True -> GridBox[{{
             PaneBox[
              ButtonBox[
               DynamicBox[
                FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxCloser"]], 
               ButtonFunction :> (Typeset`open$$ = False), Appearance -> None,
                BaseStyle -> {}, Evaluator -> Automatic, Method -> 
               "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
              Dynamic[{
                Automatic, 
                 3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                  Magnification])}]], 
             GraphicsBox[{
               Thickness[0.038461538461538464`], {
                FaceForm[{
                  GrayLevel[0.93], 
                  Opacity[1.]}], 
                
                FilledCurveBox[{{{1, 4, 3}, {0, 1, 0}, {1, 3, 3}, {0, 1, 0}, {
                 1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {0, 1, 0}}}, {{{
                 25.499999999999996`, 2.5}, {25.499999999999996`, 
                 1.3953100000000003`}, {24.604699999999998`, 
                 0.49999999999999994`}, {23.5, 0.49999999999999994`}, {2.5, 
                 0.49999999999999994`}, {1.3953100000000003`, 
                 0.49999999999999994`}, {0.49999999999999994`, 
                 1.3953100000000003`}, {0.49999999999999994`, 2.5}, {
                 0.49999999999999994`, 23.5}, {0.49999999999999994`, 
                 24.604699999999998`}, {1.3953100000000003`, 
                 25.499999999999996`}, {2.5, 25.499999999999996`}, {23.5, 
                 25.499999999999996`}, {24.604699999999998`, 
                 25.499999999999996`}, {25.499999999999996`, 
                 24.604699999999998`}, {25.499999999999996`, 23.5}, {
                 25.499999999999996`, 2.5}}}]}, {
                FaceForm[{
                  RGBColor[0.5, 0.5, 0.5], 
                  Opacity[1.]}], 
                
                FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {
                 0, 1, 0}, {0, 1, 0}, {0, 1, 0}}}, {{{20.5426, 
                 19.116799999999998`}, {16.3832, 21.876199999999997`}, {
                 16.3832, 20.021499999999996`}, {6.930469999999999, 
                 20.021499999999996`}, {6.930469999999999, 
                 18.212100000000003`}, {16.3832, 18.212100000000003`}, {
                 16.3832, 16.357399999999995`}, {20.5426, 
                 19.116799999999998`}}}], 
                
                FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {
                 0, 1, 0}, {0, 1, 0}, {0, 1, 0}}}, {{{5.30508, 13.8391}, {
                 9.46445, 11.079700000000003`}, {9.46445, 
                 12.933999999999997`}, {18.917199999999998`, 
                 12.933999999999997`}, {18.917199999999998`, 14.7438}, {
                 9.46445, 14.7438}, {9.46445, 16.598}, {5.30508, 13.8391}}}], 
                
                
                FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {
                 0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
                 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {
                 1, 3, 3}, {1, 3, 3}, {1, 3, 3}}}, CompressedData["
1:eJxTTMoPSmVmYGBgBGJjIGYCYq4u+eR3VWoOxhkv5j+Qk3SA8fu/r5rKOVHM
Yd2vmNyjZ9Qcrt9QXbW9S8RBg59767IidQcPMYPGaHFhB+Nn61SfiGo4xBwp
T7o2V9Dh0Iolfg6/NBxEHv/x1Xgi4FB1XNNqkqQWnP+axUTQjFkbzn+oO2HB
j/3aDg/Xn5T6WiDoYLs3aJpiqI7DrHN+bO6tQg4zfUR7vF7pQOyfIQyRd9d1
WLL0U1kLoyjEPdm6DpoTXfQX7xBzKPjQejLkhDacL5J4+LL2Gm2HtNnSl4Vf
iELM69J2qPZM3tLnJerQX1oozZugDfHPUxGI/4W1HQ5p3TthoyDi4D7lG1v8
Mi2HgqL9zoEHhB1inOxe3BRG8MH62zXhfIbN1Z82CGhC/GMg4nCm3mN/7TYN
iHlCUPdGakDc/1kUEr46GhD/eYnD+d9iBf/kC0vC+TuCrSL+X5Vy2HGR4R5T
uAbEfxYykPBYp+HQqsCuesZAFhL+rJoQ/2rIQdxTpwkJ7yVycPfD+GDzVqLx
xbUd5HYt2JfqBdWfpA2Jj9mykPDpgYaXtaxDy7yzq86vg8qvlIHE5ylY/Eo7
XAt7o787TxfOB5ufqesQ9PbyxxkPZSDhZ6nrMAGU3u7LQtLLEx2HN2253UbX
ofZ76jis/Pay4oynAsT8QG0HKZMv/gW7FCDyTFpwPsz/MD44/Mw1HFjb1uR9
TVVwWKy880/7FHWIexrkIfLX1RzOMDZZVjHIOaDkh3vSDuj5AwCF11Vc
                 "]]}}, Background -> GrayLevel[0.93], Axes -> False, 
              AspectRatio -> 1, ImageSize -> 
              Dynamic[{
                Automatic, 
                 3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                  Magnification])}], Frame -> True, FrameTicks -> None, 
              FrameStyle -> Directive[
                Thickness[Tiny], 
                GrayLevel[0.7]]], 
             GridBox[{{
                RowBox[{
                  TagBox["\"Argument count: \"", "SummaryItemAnnotation"], 
                  "\[InvisibleSpace]", 
                  TagBox["4", "SummaryItem"]}]}, {
                RowBox[{
                  TagBox["\"Argument types: \"", "SummaryItemAnnotation"], 
                  "\[InvisibleSpace]", 
                  TagBox[
                   PaneBox[
                    RowBox[{"{", 
                    RowBox[{"_Real", ",", 
                    RowBox[{"{", 
                    RowBox[{"_Real", ",", "1"}], "}"}], ",", "_Integer", ",", 
                    
                    RowBox[{"{", 
                    RowBox[{"_Real", ",", "2"}], "}"}]}], "}"}], 
                    ImageSize -> {{1, 500}, Automatic}, BaselinePosition -> 
                    Baseline, ContentPadding -> False, FrameMargins -> 0, 
                    StripOnInput -> True], "SummaryItem"]}]}, {
                RowBox[{
                  TagBox["\"Variables: \"", "SummaryItemAnnotation"], 
                  "\[InvisibleSpace]", 
                  TagBox[
                   RowBox[{"{", 
                    
                    RowBox[{
                    "rand\[Theta]log", ",", "grid\[Theta]log", ",", 
                    "index\[Theta]", ",", "distrlog"}], "}"}], 
                   "SummaryItem"]}]}, {
                RowBox[{
                  TagBox["\"Expression: \"", "SummaryItemAnnotation"], 
                  "\[InvisibleSpace]", 
                  TagBox[
                   PaneBox[
                    RowBox[{"Module", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    
                    RowBox[{
                    "\[Theta]el", ",", "x1", ",", "x2", ",", "z1", ",", "z2", 
                    ",", "\[CapitalDelta]", ",", "indexlarger\[Theta]"}], 
                    "}"}], ",", 
                    RowBox[{
                    RowBox[{"\[Theta]el", "=", 
                    RowBox[{"Compile`GetElement", "(", 
                    RowBox[{"grid\[Theta]log", ",", "index\[Theta]"}], 
                    ")"}]}], ";", 
                    RowBox[{"indexlarger\[Theta]", "=", 
                    RowBox[{"index\[Theta]", "+", 
                    TemplateBox[{
                    RowBox[{
                    RowBox[{"rand\[Theta]log", "-", "\[Theta]el"}]}]}, 
                    "UnitStepSeq"]}]}], ";", 
                    RowBox[{"x1", "=", 
                    RowBox[{"Compile`GetElement", "(", 
                    RowBox[{"grid\[Theta]log", ",", 
                    RowBox[{"indexlarger\[Theta]", "-", "1"}]}], ")"}]}], ";", 
                    RowBox[{"x2", "=", 
                    RowBox[{"Compile`GetElement", "(", 
                    RowBox[{"grid\[Theta]log", ",", "indexlarger\[Theta]"}], 
                    ")"}]}], ";", 
                    RowBox[{"z1", "=", 
                    RowBox[{"Compile`GetElement", "(", 
                    
                    RowBox[{"distrlog", ",", "indexlarger\[Theta]", ",", 
                    "2"}], ")"}]}], ";", 
                    RowBox[{"z2", "=", 
                    RowBox[{"Compile`GetElement", "(", 
                    RowBox[{"distrlog", ",", 
                    RowBox[{"indexlarger\[Theta]", "-", "1"}], ",", "2"}], 
                    ")"}]}], ";", 
                    RowBox[{"\[CapitalDelta]", "=", 
                    RowBox[{"x2", "-", "x1"}]}], ";", 
                    RowBox[{
                    FractionBox[
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"rand\[Theta]log", "-", "x1"}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{"z2", "-", "z1"}], ")"}]}], "\[CapitalDelta]"], 
                    "+", "z1"}]}]}], "]"}], 
                    ImageSize -> {{1, 500}, Automatic}, BaselinePosition -> 
                    Baseline, ContentPadding -> False, FrameMargins -> 0, 
                    StripOnInput -> True], "SummaryItem"]}]}}, 
              GridBoxAlignment -> {
               "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
              False, GridBoxItemSize -> {
               "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
              GridBoxSpacings -> {
               "Columns" -> {{2}}, "Rows" -> {{Automatic}}}, 
              BaseStyle -> {
               ShowStringCharacters -> False, NumberMarks -> False, 
                PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
           GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
           AutoDelete -> False, 
           GridBoxItemSize -> {
            "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
           BaselinePosition -> {1, 1}]}, 
        Dynamic[Typeset`open$$], ImageSize -> Automatic]},
      "SummaryPanel"],
     DynamicModuleValues:>{}], "]"}],
   CompiledFunction[{11, 14., 5848}, {
     Blank[Real], {
      Blank[Real], 1}, 
     Blank[Integer], {
      Blank[Real], 2}}, {{3, 0, 0}, {3, 1, 0}, {2, 0, 0}, {3, 2, 1}, {3, 0, 
    9}}, {{-1, {2, 0, 3}}, {2, {2, 0, 4}}}, {0, 5, 10, 0, 
    2}, {{37, 0, 0, 3, 1}, {19, 1, 2}, {13, 0, 2, 3}, {40, 66, 3, 0, 3, 2, 0, 
     1}, {12, 0, 1, 2}, {12, 2, 3, 1}, {37, 0, 1, 3, 3}, {37, 0, 2, 3, 2}, {
     37, 1, 2, 4, 3, 4}, {12, 2, 3, 1}, {37, 1, 1, 4, 3, 5}, {19, 3, 6}, {13, 
     2, 6, 7}, {19, 3, 6}, {13, 0, 6, 8}, {19, 4, 6}, {13, 5, 6, 9}, {40, 60, 
     3, 0, 7, 3, 0, 6}, {16, 9, 6, 9}, {16, 8, 9, 8}, {13, 4, 8, 9}, {1}}, 
    Function[{$CellContext`rand\[Theta]log, $CellContext`grid\[Theta]log, \
$CellContext`index\[Theta], $CellContext`distrlog}, 
     Module[{$CellContext`\[Theta]el, $CellContext`x1, $CellContext`x2, \
$CellContext`z1, $CellContext`z2, $CellContext`\[CapitalDelta], \
$CellContext`indexlarger\[Theta]}, $CellContext`\[Theta]el = 
       Compile`GetElement[$CellContext`grid\[Theta]log, $CellContext`index\
\[Theta]]; $CellContext`indexlarger\[Theta] = $CellContext`index\[Theta] + 
        UnitStep[$CellContext`rand\[Theta]log - $CellContext`\[Theta]el]; \
$CellContext`x1 = 
       Compile`GetElement[$CellContext`grid\[Theta]log, \
$CellContext`indexlarger\[Theta] - 1]; $CellContext`x2 = 
       Compile`GetElement[$CellContext`grid\[Theta]log, \
$CellContext`indexlarger\[Theta]]; $CellContext`z1 = 
       Compile`GetElement[$CellContext`distrlog, $CellContext`indexlarger\
\[Theta], 2]; $CellContext`z2 = 
       Compile`GetElement[$CellContext`distrlog, $CellContext`indexlarger\
\[Theta] - 1, 
         2]; $CellContext`\[CapitalDelta] = $CellContext`x2 - $CellContext`x1; \
$CellContext`z1 + ($CellContext`rand\[Theta]log - $CellContext`x1) \
(($CellContext`z2 - $CellContext`z1)/$CellContext`\[CapitalDelta])], 
     Listable], Evaluate, 
    LibraryFunction[
    "/Users/alberto/Library/Mathematica/ApplicationData/CCompilerDriver/\
BuildFolder/eduroam-4014-1219/compiledFunction46.dylib", 
     "compiledFunction46", {{Real, 0, "Constant"}, {Real, 1, "Constant"}, {
      Integer, 0, "Constant"}, {Real, 2, "Constant"}}, Real]],
   Editable->False,
   SelectWithContents->True,
   Selectable->False], TraditionalForm]], "Output",
 CellChangeTimes->{3.9302114533920383`*^9, 3.9308226799978*^9},
 CellTags->"Evaluation",
 CellLabel->
  "Out[775]=",ExpressionUUID->"8b409073-dd31-43a4-a023-99e479e9692d"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Finding ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["E", "max"], "(", "\[Theta]", ")"}], TraditionalForm]],
  ExpressionUUID->"db67b19c-aa2b-4873-b63d-83bd7622cbf3"],
 " - for efficient energy sampling for the given \[Theta]"
}], "Subsection",
 CellChangeTimes->{{3.913107151768467*^9, 3.9131071573912096`*^9}, {
  3.913264603355554*^9, 3.9132646294516373`*^9}},
 CellTags->
  "Evaluation",ExpressionUUID->"f83049fd-8fed-4560-865f-95bb871146be"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Function", " ", "to", " ", "process", " ", "the", " ", "table"}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"FindingMaxEnergy", "[", 
     RowBox[{"tab_", ",", "order_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"Egrouped", ",", "tot"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"Group", " ", "by", " ", "y", " ", "values"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Egrouped", "=", 
        RowBox[{"GatherBy", "[", 
         RowBox[{"tab", ",", 
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "&"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "Sum", " ", "z", " ", "values", " ", "for", " ", "each", " ", "y", 
         " ", "and", " ", "create", " ", "new", " ", "table"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"\[Theta]summed", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Egrouped", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "1", ",", "2"}], "]"}], "]"}], ",", 
            RowBox[{"Total", "[", 
             RowBox[{"Egrouped", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "All", ",", "3"}], "]"}], "]"}], "]"}]}], 
           "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"Length", "[", "Egrouped", "]"}]}], "}"}]}], "]"}]}], ";",
        "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Max", "[", 
           RowBox[{"\[Theta]summed", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}], ">", 
          SuperscriptBox["10", 
           RowBox[{"-", "30."}]]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"tot", "=", 
           RowBox[{
            RowBox[{"\[Theta]summed", "[", 
             RowBox[{"[", 
              RowBox[{"All", ",", "2"}], "]"}], "]"}], "//", "Total"}]}], ";",
           "\[IndentingNewLine]", 
          RowBox[{"accum", "=", 
           FractionBox[
            RowBox[{"tot", "-", 
             RowBox[{"Accumulate", "[", 
              RowBox[{"\[Theta]summed", "[", 
               RowBox[{"[", 
                RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}]}], "tot"]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"sel", "=", 
           RowBox[{"Select", "[", 
            RowBox[{"accum", ",", 
             RowBox[{
              RowBox[{"#", ">=", 
               SuperscriptBox["10", 
                RowBox[{"-", "order"}]]}], "&"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", "sel", "]"}], "!=", "0."}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"emaxpos", "=", 
              RowBox[{"Min", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"Position", "[", 
                    RowBox[{"accum", ",", 
                    RowBox[{"sel", "[", 
                    RowBox[{"[", 
                    RowBox[{"-", "1"}], "]"}], "]"}]}], "]"}], "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "+", "1"}], ",", 
                RowBox[{"Length", "[", "accum", "]"}]}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"emaxval", "=", 
              RowBox[{
               RowBox[{"\[Theta]summed", "[", 
                RowBox[{"[", "emaxpos", "]"}], "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
            RowBox[{"emaxval", "=", 
             RowBox[{
              RowBox[{"\[Theta]summed", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}]}]}], "]"}]}]}], "]"}], ";", 
       "\[IndentingNewLine]", "emaxval"}]}], "\[IndentingNewLine]", "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"DataLogarithmiedComp", "=", 
     RowBox[{"Compile", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"data", ",", "_Real", ",", "1"}], "}"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Log", "[", 
          RowBox[{"Compile`GetElement", "[", 
           RowBox[{"data", ",", "1"}], "]"}], "]"}], ",", 
         RowBox[{"Log", "[", 
          RowBox[{"Compile`GetElement", "[", 
           RowBox[{"data", ",", "2"}], "]"}], "]"}], ",", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Compile`GetElement", "[", 
             RowBox[{"data", ",", "3"}], "]"}], "\[Equal]", "0"}], ",", 
           RowBox[{"Log", "[", 
            SuperscriptBox["10", 
             RowBox[{"-", "90."}]], "]"}], ",", 
           RowBox[{"Log", "[", 
            RowBox[{"Compile`GetElement", "[", 
             RowBox[{"data", ",", "3"}], "]"}], "]"}]}], "]"}]}], "}"}], ",", 
       
       RowBox[{"CompilationTarget", "\[Rule]", "\"\<C\>\""}], ",", 
       RowBox[{"RuntimeOptions", "\[Rule]", "\"\<Speed\>\""}], ",", 
       RowBox[{"RuntimeAttributes", "->", 
        RowBox[{"{", "Listable", "}"}]}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Do", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"\[Theta]gridForEmax", "[", "fac", "]"}], "=", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SuperscriptBox["10", 
            RowBox[{"-", "5."}]], ",", 
           SuperscriptBox["10", 
            RowBox[{"-", "4."}]], ",", "0.001", ",", "0.005", ",", "0.008", 
           ",", "0.01", ",", "0.02", ",", "0.03", ",", "0.04", ",", "0.06", 
           ",", "0.08", ",", "0.1", ",", "0.11", ",", "0.12", ",", "0.13", 
           ",", "0.15", ",", "0.17", ",", "0.2", ",", "0.3", ",", "0.4", ",", 
           "0.5", ",", "0.6", ",", "0.7", ",", "0.8", ",", "0.9", ",", "1.", 
           ",", "1.2", ",", "1.3", ",", 
           FractionBox["Pi", "2"]}], "}"}], "//", "N"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"fac", "==", "\"\<LHC\>\""}], ",", 
         RowBox[{
          RowBox[{"\[Theta]gridForEmax", "[", "fac", "]"}], "=", 
          RowBox[{
           RowBox[{
            RowBox[{"Join", "[", 
             RowBox[{
              RowBox[{"\[Theta]gridForEmax", "[", "fac", "]"}], ",", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"3", "*", 
                  SuperscriptBox["10", 
                   RowBox[{"-", "4."}]]}], ",", 
                 RowBox[{"6", "*", 
                  SuperscriptBox["10", 
                   RowBox[{"-", "4."}]]}], ",", 
                 RowBox[{"2", "*", 
                  SuperscriptBox["10", 
                   RowBox[{"-", "3"}]]}], ",", 
                 RowBox[{"3", "*", 
                  SuperscriptBox["10", 
                   RowBox[{"-", "3"}]]}], ",", 
                 RowBox[{"4", "*", 
                  SuperscriptBox["10", 
                   RowBox[{"-", "3"}]]}], ",", 
                 RowBox[{"6", "*", 
                  SuperscriptBox["10", 
                   RowBox[{"-", "3"}]]}], ",", 
                 RowBox[{"7", "*", 
                  SuperscriptBox["10", 
                   RowBox[{"-", "3"}]]}], ",", 
                 RowBox[{"9", "*", 
                  SuperscriptBox["10", 
                   RowBox[{"-", "3."}]]}], ",", "0.011", ",", "0.013", ",", 
                 "0.016", ",", "0.018", ",", "0.022", ",", "0.024", ",", 
                 "0.027", ",", "0.033", ",", "0.036", ",", "0.045", ",", 
                 "0.05", ",", "0.07", ",", "0.09"}], "}"}], "//", "N"}]}], 
             "]"}], "//", "Sort"}], "//", "DeleteDuplicates"}]}]}], "]"}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"fac", "==", "\"\<FCC-hh\>\""}], ",", 
         RowBox[{
          RowBox[{"\[Theta]gridForEmax", "[", "fac", "]"}], "=", 
          RowBox[{
           RowBox[{
            RowBox[{"Join", "[", 
             RowBox[{
              RowBox[{"\[Theta]gridForEmax", "[", "fac", "]"}], ",", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"5", "*", 
                  SuperscriptBox["10", 
                   RowBox[{"-", "5."}]]}], ",", 
                 RowBox[{"2", "*", 
                  SuperscriptBox["10", 
                   RowBox[{"-", "4."}]]}], ",", 
                 RowBox[{"4", "*", 
                  SuperscriptBox["10", 
                   RowBox[{"-", "4."}]]}], ",", 
                 RowBox[{"6", "*", 
                  SuperscriptBox["10", 
                   RowBox[{"-", "4."}]]}], ",", 
                 RowBox[{"8", "*", 
                  SuperscriptBox["10", 
                   RowBox[{"-", "4."}]]}], ",", 
                 RowBox[{"2", "*", 
                  SuperscriptBox["10", 
                   RowBox[{"-", "3"}]]}], ",", 
                 RowBox[{"3", "*", 
                  SuperscriptBox["10", 
                   RowBox[{"-", "3"}]]}], ",", 
                 RowBox[{"4", "*", 
                  SuperscriptBox["10", 
                   RowBox[{"-", "3."}]]}]}], "}"}], "//", "N"}]}], "]"}], "//",
             "Sort"}], "//", "DeleteDuplicates"}]}]}], "]"}], ";"}], 
      "\[IndentingNewLine]", ",", 
      RowBox[{"{", 
       RowBox[{"fac", ",", "FacilitiesList"}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"FindingEmax\[Theta]", "[", 
     RowBox[{"data_", ",", "Facility_", ",", "order_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"(*", 
        RowBox[{
        "\[Theta]minmax", ",", "eminmax", ",", "GridIn", ",", "distrv", ",", 
         "GridOut", ",", "xigDistr", ",", "distrvals", ",", "mappeddistr", 
         ",", "\[Theta]emax", ",", "emax", ",", "\[Theta]ranges", ",", 
         "distrdatalog"}], "*)"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"IfCollider", "=", 
        RowBox[{"MemberQ", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"\"\<LHC\>\"", ",", "\"\<FCC-hh\>\""}], "}"}], ",", 
          "Facility"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"distrdatalog", "=", 
        RowBox[{"DataLogarithmiedComp", "[", "data", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"GridIn", "=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"DeleteDuplicates", "[", 
             RowBox[{"distrdatalog", "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", "#"}], "]"}], "]"}], "]"}], "&"}], "/@", 
           RowBox[{"{", 
            RowBox[{"1", ",", "2"}], "}"}]}], ")"}], "//", "N"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"distrv", "=", 
        RowBox[{"ArrayReshape", "[", 
         RowBox[{
          RowBox[{"distrdatalog", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "3"}], "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"GridIn", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
            RowBox[{"Length", "[", 
             RowBox[{"GridIn", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"\[Theta]minmax", ",", "eminmax"}], "}"}], "=", 
        RowBox[{
         RowBox[{
          RowBox[{"MinMax", "[", 
           RowBox[{"data", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "#"}], "]"}], "]"}], "]"}], "&"}], "/@", 
         RowBox[{"{", 
          RowBox[{"1", ",", "2"}], "}"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"\[Theta]ranges", "=", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{"IfCollider", ",", 
           RowBox[{"Select", "[", 
            RowBox[{
             RowBox[{"\[Theta]gridForEmax", "[", "Facility", "]"}], ",", 
             RowBox[{
              RowBox[{
               RowBox[{"\[Theta]minmax", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "<=", "#"}], "&"}]}], "]"}], 
           ",", 
           RowBox[{"Select", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"Flatten", "[", 
                 RowBox[{"Join", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"#", ",", 
                    RowBox[{"Pi", "-", "#"}]}], "}"}], "&"}], "/@", 
                   RowBox[{"Join", "[", 
                    RowBox[{
                    RowBox[{"\[Theta]gridForEmax", "[", "Facility", "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"\[Theta]minmax", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "}"}]}], "]"}]}], "]"}], 
                 "]"}], "//", "N"}], "//", "Sort"}], "//", 
              "DeleteDuplicates"}], ",", 
             RowBox[{
              RowBox[{
               RowBox[{"\[Theta]minmax", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "<=", "#", "<=", 
               RowBox[{"\[Theta]minmax", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "&"}]}], "]"}]}], "]"}], "//",
          "N"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"\[Theta]emax", "=", 
        RowBox[{"{", 
         RowBox[{"{", "}"}], "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"nintervals", "=", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"\[Theta]ranges", "[", 
                RowBox[{"[", 
                 RowBox[{"i", "+", "1"}], "]"}], "]"}], "-", 
               RowBox[{"\[Theta]ranges", "[", 
                RowBox[{"[", "i", "]"}], "]"}]}], ">", 
              SuperscriptBox["10", 
               RowBox[{"-", "3"}]]}], ",", "10", ",", "3"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"GridOut", "=", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Table", "[", 
               RowBox[{"th", ",", 
                RowBox[{"{", 
                 RowBox[{"th", ",", 
                  RowBox[{"\[Theta]ranges", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], ",", 
                  RowBox[{"\[Theta]ranges", "[", 
                   RowBox[{"[", 
                    RowBox[{"i", "+", "1"}], "]"}], "]"}], ",", 
                  FractionBox[
                   RowBox[{
                    RowBox[{"\[Theta]ranges", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", "+", "1"}], "]"}], "]"}], "-", 
                    RowBox[{"\[Theta]ranges", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], "nintervals"]}], 
                 "}"}]}], "]"}], ",", 
              RowBox[{
               RowBox[{"Join", "[", 
                RowBox[{
                 RowBox[{"Table", "[", 
                  RowBox[{
                   RowBox[{"Exp", "[", "e", "]"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"e", ",", 
                    RowBox[{"Log", "[", 
                    RowBox[{"eminmax", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Log", "[", 
                    RowBox[{"eminmax", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Max", "[", 
                    RowBox[{"0.1", ",", 
                    FractionBox[
                    RowBox[{
                    RowBox[{"Log", "[", 
                    RowBox[{"eminmax", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "]"}], "-", 
                    RowBox[{"Log", "[", 
                    RowBox[{"eminmax", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "100"]}], 
                    "]"}]}], "}"}]}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"eminmax", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "}"}]}], "]"}], "//", 
               "DeleteDuplicates"}]}], "}"}], "//", "Log"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"xigDistr", "=", 
           RowBox[{"MapThread", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Interpolation", "[", 
                RowBox[{
                 RowBox[{"Transpose", "@", 
                  RowBox[{"{", 
                   RowBox[{"#", ",", 
                    RowBox[{"Range", "@", 
                    RowBox[{"Length", "@", "#"}]}]}], "}"}]}], ",", 
                 RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[",
                "#2", "]"}], "&"}], ",", 
             RowBox[{"{", 
              RowBox[{"GridIn", ",", "GridOut"}], "}"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"distrvals", "=", 
           RowBox[{"Flatten", "@", 
            RowBox[{"cf2", "[", 
             RowBox[{
              RowBox[{"Sequence", "@@", "xigDistr"}], ",", "distrv"}], 
             "]"}]}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"mappeddistr", "=", 
           RowBox[{"Exp", "[", 
            RowBox[{"Join", "[", 
             RowBox[{
              RowBox[{"Tuples", "[", "GridOut", "]"}], ",", 
              RowBox[{"Partition", "[", 
               RowBox[{"distrvals", ",", "1"}], "]"}], ",", "2"}], "]"}], 
            "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"emax", "=", 
           RowBox[{"FindingMaxEnergy", "[", 
            RowBox[{"mappeddistr", ",", "order"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"\[Theta]emax", "=", 
           RowBox[{"Join", "[", 
            RowBox[{"\[Theta]emax", ",", 
             RowBox[{"{", 
              RowBox[{"{", 
               RowBox[{
                FractionBox[
                 RowBox[{
                  RowBox[{"\[Theta]ranges", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], "+", 
                  RowBox[{"\[Theta]ranges", "[", 
                   RowBox[{"[", 
                    RowBox[{"i", "+", "1"}], "]"}], "]"}]}], "2"], ",", 
                "emax"}], "}"}], "}"}]}], "]"}]}], ";"}], 
         "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{
            RowBox[{"Length", "[", "\[Theta]ranges", "]"}], "-", "1"}], ",", 
           "1"}], "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"\[Theta]emax", "=", 
        RowBox[{"Drop", "[", 
         RowBox[{"\[Theta]emax", ",", "1"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"\[Theta]emax", "=", 
        RowBox[{"Log", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{"IfCollider", ",", 
              RowBox[{"Flatten", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Join", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"#", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Pi", "-", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ",", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "}"}], "&"}], "/@", 
                    "#"}]}], "}"}], "&"}], "/@", 
                   RowBox[{"{", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\[Theta]minmax", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"\[Theta]emax", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "}"}], "}"}], ",", 
                    "\[Theta]emax"}], "]"}], "}"}]}], "]"}], "[", 
                 RowBox[{"[", "1", "]"}], "]"}], ",", "1"}], "]"}], ",", 
              RowBox[{"Join", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"\[Theta]minmax", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                   RowBox[{
                    RowBox[{"\[Theta]emax", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "}"}], "}"}], ",", 
                "\[Theta]emax", ",", 
                RowBox[{"{", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"\[Theta]minmax", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                   RowBox[{
                    RowBox[{"\[Theta]emax", "[", 
                    RowBox[{"[", 
                    RowBox[{"-", "1"}], "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "}"}], "}"}]}], "]"}]}],
              "]"}], "//", "Sort"}], "//", "DeleteDuplicates"}], "//", "N"}], 
         "]"}]}]}]}], "\[IndentingNewLine]", "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.9131762698586264`*^9, 3.913176313358836*^9}, {
   3.9131763563091617`*^9, 3.9131764611215096`*^9}, {3.913176874789384*^9, 
   3.913176913085933*^9}, {3.913176965997759*^9, 3.9131770687054257`*^9}, {
   3.913177268212186*^9, 3.91317726859461*^9}, {3.913177307637892*^9, 
   3.913177313509065*^9}, {3.91317734468255*^9, 3.913177361004506*^9}, {
   3.913177409277397*^9, 3.9131774424090986`*^9}, {3.9131778525452356`*^9, 
   3.91317788330419*^9}, {3.91317903671218*^9, 3.913179039408714*^9}, {
   3.9131791215239305`*^9, 3.9131791219144664`*^9}, {3.913179276784492*^9, 
   3.9131792798928676`*^9}, {3.913180146391586*^9, 3.9131801771928606`*^9}, 
   3.913180231617834*^9, 3.9131803256337175`*^9, {3.9131804249086747`*^9, 
   3.913180436471838*^9}, {3.913180484525958*^9, 3.913180520363098*^9}, 
   3.9131834695391173`*^9, {3.9131880736839914`*^9, 3.9131880763988543`*^9}, {
   3.913188274501943*^9, 3.913188324541342*^9}, {3.913188409745428*^9, 
   3.913188410483885*^9}, 3.913188471101928*^9, {3.913202185755698*^9, 
   3.9132021884381733`*^9}, {3.913202237066029*^9, 3.913202237378228*^9}, {
   3.913202314059296*^9, 3.913202334078602*^9}, {3.9132024165220957`*^9, 
   3.913202416773042*^9}, {3.913202808990028*^9, 3.913202881203199*^9}, 
   3.914143172893423*^9, {3.9141432680580235`*^9, 3.914143269412343*^9}, {
   3.914488700474924*^9, 3.9144887005366697`*^9}, {3.915703598940571*^9, 
   3.915703615958143*^9}, 3.9157036507890577`*^9, {3.9157037653217144`*^9, 
   3.915703765473105*^9}, {3.915704018805435*^9, 3.915704038562193*^9}, {
   3.915704105378541*^9, 3.915704143589997*^9}, {3.9157042257790623`*^9, 
   3.915704253480098*^9}, {3.9157043013651543`*^9, 3.915704307933041*^9}, {
   3.915704361722384*^9, 3.91570437405671*^9}, {3.915704741915754*^9, 
   3.915704806916683*^9}, {3.915704844811511*^9, 3.915704978148676*^9}, {
   3.91570502470027*^9, 3.915705048526478*^9}, {3.915705110954241*^9, 
   3.9157052450514493`*^9}, {3.915705276585751*^9, 3.915705338989715*^9}, {
   3.915705636360712*^9, 3.915705703694833*^9}, {3.915705744444703*^9, 
   3.915705765392256*^9}, {3.915705795522413*^9, 3.915705818388652*^9}, {
   3.91745161513745*^9, 3.917451615340181*^9}, {3.917451678532138*^9, 
   3.917451724908331*^9}, {3.9174518952729225`*^9, 3.9174519106810184`*^9}, {
   3.917451952232328*^9, 3.917451959773726*^9}, {3.9174558842889967`*^9, 
   3.917455889804186*^9}},
 CellTags->"Evaluation",
 CellLabel->
  "In[778]:=",ExpressionUUID->"1526fbf7-ef3a-4a98-bdc1-4389e2074498"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Sampling points", "Section",
 CellChangeTimes->{{3.913264638324453*^9, 3.913264643143423*^9}},
 CellTags->
  "Evaluation",ExpressionUUID->"1ff15133-44cb-4c98-a0fa-56621f6338fa"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"erandcomp", "=", 
   RowBox[{
    RowBox[{"Compile", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"eminv", ",", "_Real"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"emaxv", ",", "_Real"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Nev", ",", "_Integer"}], "}"}]}], "}"}], ",", 
      RowBox[{"Log", "[", 
       RowBox[{"RandomReal", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Exp", "[", "eminv", "]"}], ",", 
          RowBox[{"Exp", "[", "emaxv", "]"}]}], "}"}], "]"}], "]"}], ",", 
      RowBox[{"CompilationTarget", "\[Rule]", "\"\<C\>\""}], ",", 
      RowBox[{"RuntimeOptions", "\[Rule]", "\"\<Speed\>\""}], ",", 
      RowBox[{"RuntimeAttributes", "->", 
       RowBox[{"{", "Listable", "}"}]}]}], "]"}], "//", "ReleaseHold"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"MotherDataCompiled", "=", 
  RowBox[{"Compile", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"Events", ",", "_Real", ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"m", ",", "_Real"}], "}"}]}], "}"}], ",", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"thv", ",", "ev", ",", "\[Phi]v", ",", "pv"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"thv", "=", 
        RowBox[{"Compile`GetElement", "[", 
         RowBox[{"Events", ",", "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"ev", "=", 
        RowBox[{"Compile`GetElement", "[", 
         RowBox[{"Events", ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"\[Phi]v", "=", 
        RowBox[{"RandomReal", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "Pi"}], ",", "Pi"}], "}"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"pv", "=", 
        SqrtBox[
         RowBox[{
          SuperscriptBox["ev", "2"], "-", 
          SuperscriptBox["m", "2"]}]]}], ";", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"pv", "*", 
          RowBox[{"Cos", "[", "\[Phi]v", "]"}], "*", 
          RowBox[{"Sin", "[", "thv", "]"}]}], ",", 
         RowBox[{"pv", "*", 
          RowBox[{"Sin", "[", "\[Phi]v", "]"}], "*", 
          RowBox[{"Sin", "[", "thv", "]"}]}], ",", 
         RowBox[{"pv", "*", 
          RowBox[{"Cos", "[", "thv", "]"}]}], ",", "ev", ",", "m"}], 
        "}"}]}]}], "\[IndentingNewLine]", "]"}], ",", 
    RowBox[{"CompilationTarget", "\[Rule]", "\"\<C\>\""}], ",", 
    RowBox[{"RuntimeOptions", "\[Rule]", "\"\<Speed\>\""}], ",", 
    RowBox[{"RuntimeAttributes", "->", 
     RowBox[{"{", "Listable", "}"}]}], ",", 
    RowBox[{"Parallelization", "->", "True"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BlockPointsFromSmoothDistribution1", "[", 
   RowBox[{
   "data_", ",", "m_", ",", "Nevents_", ",", "order_", ",", "Facility_"}], 
   "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "Emaxlist", ",", "\[Theta]minmax", ",", "Data\[Phi]", ",", "Nev", ",", 
      "eminmax", ",", "NevSampl"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"IfCollider", "=", 
      RowBox[{"MemberQ", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"\"\<LHC\>\"", ",", "\"\<FCC-hh\>\""}], "}"}], ",", 
        "Facility"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"distrdatalog", "=", 
      RowBox[{"DataLogarithmiedComp", "[", "data", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"GridIn", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"DeleteDuplicates", "[", 
           RowBox[{"distrdatalog", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "#"}], "]"}], "]"}], "]"}], "&"}], "/@", 
         RowBox[{"{", 
          RowBox[{"1", ",", "2"}], "}"}]}], ")"}], "//", "N"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Theta]minmax", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Min", "[", "#", "]"}], ",", 
            RowBox[{"If", "[", 
             RowBox[{"IfCollider", ",", 
              FractionBox["Pi", "2."], ",", 
              RowBox[{"Max", "[", "#", "]"}]}], "]"}]}], "}"}], "&"}], "/@", 
         RowBox[{"{", 
          RowBox[{"data", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "1"}], "]"}], "]"}], "}"}]}], ")"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"emin", "=", 
      RowBox[{"Log", "[", 
       RowBox[{"Min", "[", 
        RowBox[{"data", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"Computing", " ", "table", " ", 
       SubscriptBox["E", "max"], 
       RowBox[{"(", "\[Theta]", ")"}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Nev", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"!", "IfCollider"}], ",", "Nevents", ",", 
        RowBox[{"IntegerPart", "[", 
         RowBox[{"Nevents", "/", "2"}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"NevSampl", "=", 
      RowBox[{"Max", "[", 
       RowBox[{
        RowBox[{"3", "*", "Nev"}], ",", 
        SuperscriptBox["10", "6"]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Theta]emaxdata", "=", 
      RowBox[{"FindingEmax\[Theta]", "[", 
       RowBox[{"data", ",", "Facility", ",", "order"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "___", "___", "___", "___", "___", "___", "___", "___", "___", "___", 
       "___", "_"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Generating", " ", "the", " ", "grid", " ", "of", " ", 
        SubscriptBox["\[Theta]", "rand"]}], ",", 
       SubscriptBox["E", "rand"]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "___", "___", "___", "___", "___", "___", "___", "___", "___", "___", 
       "___", "_"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"Generating", " ", "random", " ", "\[Theta]"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"\[Theta]rand", "=", 
      RowBox[{"Log", "[", 
       RowBox[{"RandomReal", "[", 
        RowBox[{"\[Theta]minmax", ",", "NevSampl"}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"For", " ", "each", " ", "\[Theta]"}], ",", " ", 
       RowBox[{
        RowBox[{"generaring", " ", "random", " ", "E"}], "\[Element]", 
        RowBox[{"{", 
         RowBox[{
          SubscriptBox["E", "min"], ",", 
          RowBox[{
           SubscriptBox["E", "max"], 
           RowBox[{"(", "\[Theta]", ")"}]}]}], "}"}]}]}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"nf\[Theta]Emaxlog", "=", 
      RowBox[{"Nearest", "[", 
       RowBox[{
        RowBox[{"\[Theta]emaxdata", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "1"}], "]"}], "]"}], "->", "\"\<Index\>\""}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"index\[Theta]Emaxlog", "=", 
      RowBox[{
       RowBox[{"nf\[Theta]Emaxlog", "[", "\[Theta]rand", "]"}], "//", 
       "Flatten"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"emaxrand", "=", 
      RowBox[{"linint1", "[", 
       RowBox[{"\[Theta]rand", ",", 
        RowBox[{"\[Theta]emaxdata", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", 
        "index\[Theta]Emaxlog", ",", "\[Theta]emaxdata"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"erand", "=", 
      RowBox[{"erandcomp", "[", 
       RowBox[{"emin", ",", "emaxrand", ",", "NevSampl"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"Now", ",", " ", 
       RowBox[{
       "calculating", " ", "the", " ", "weights", " ", "for", " ", "the", " ",
         "generated", " ", 
        SubscriptBox["\[Theta]", "rand"]}], ",", 
       SubscriptBox["E", "rand"]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"nf\[Theta]log", "=", 
      RowBox[{"Nearest", "[", 
       RowBox[{
        RowBox[{"GridIn", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "->", "\"\<Index\>\""}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"nfElog", "=", 
      RowBox[{"Nearest", "[", 
       RowBox[{
        RowBox[{"GridIn", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "->", "\"\<Index\>\""}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"index\[Theta]rand", ",", "indexerand"}], "}"}], "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"nf\[Theta]log", "[", "\[Theta]rand", "]"}], "//", 
         "Flatten"}], ",", 
        RowBox[{
         RowBox[{"nfElog", "[", "erand", "]"}], "//", "Flatten"}]}], "}"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"weights", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Exp", "[", "emaxrand", "]"}], "-", 
         RowBox[{"Exp", "[", "emin", "]"}]}], ")"}], "*", 
       RowBox[{"linint2", "[", 
        RowBox[{"\[Theta]rand", ",", "erand", ",", 
         RowBox[{"GridIn", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", 
         RowBox[{"GridIn", "[", 
          RowBox[{"[", "2", "]"}], "]"}], ",", "index\[Theta]rand", ",", 
         "indexerand", ",", "distrdatalog"}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Generating", " ", "\"\<True\>\"", " ", "\[Theta]"}], ",", 
       RowBox[{"E", " ", "based", " ", "on", " ", "the", " ", "weights"}]}], 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"PTS", "=", 
      RowBox[{"RandomChoice", "[", 
       RowBox[{
        RowBox[{"weights", "->", 
         RowBox[{"Transpose", "[", 
          RowBox[{"Exp", "[", 
           RowBox[{"{", 
            RowBox[{"\[Theta]rand", ",", "erand"}], "}"}], "]"}], "]"}]}], 
        ",", "Nev"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"motherdata", "=", 
      RowBox[{"MotherDataCompiled", "[", 
       RowBox[{"PTS", ",", "m"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{"IfCollider", ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"motherdataExtended", "=", "motherdata"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"motherdataExtended", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "3"}], "]"}], "]"}], "=", 
         RowBox[{"-", 
          RowBox[{"motherdataExtended", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "3"}], "]"}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"motherdata", "=", 
         RowBox[{"Join", "[", 
          RowBox[{"motherdata", ",", "motherdataExtended"}], "]"}]}]}]}], 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "motherdata", "]"}], "!=", "Nevents"}], ",", 
        RowBox[{"motherdata", "=", 
         RowBox[{"Join", "[", 
          RowBox[{"motherdata", ",", 
           RowBox[{"{", 
            RowBox[{"motherdata", "[", 
             RowBox[{"[", 
              RowBox[{"-", "1"}], "]"}], "]"}], "}"}]}], "]"}]}]}], "]"}], "//",
       "Developer`ToPackedArray"}], ";", "\[IndentingNewLine]", 
     "motherdata"}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"DataConverted", "=", 
  RowBox[{"Compile", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"data", ",", "_Real", ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"m", ",", "_Real"}], "}"}]}], "}"}], ",", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"px", ",", "py", ",", "pz", ",", "e"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"px", "=", 
        RowBox[{"Compile`GetElement", "[", 
         RowBox[{"data", ",", "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"py", "=", 
        RowBox[{"Compile`GetElement", "[", 
         RowBox[{"data", ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"pz", "=", 
        RowBox[{"Compile`GetElement", "[", 
         RowBox[{"data", ",", "3"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"e", "=", 
        SqrtBox[
         RowBox[{
          SuperscriptBox["px", "2"], "+", 
          SuperscriptBox["py", "2"], "+", 
          SuperscriptBox["pz", "2"], "+", 
          SuperscriptBox["m", "2"]}]]}], ";", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"px", ",", "py", ",", "pz", ",", "e", ",", "m"}], "}"}]}]}], 
     "]"}], ",", 
    RowBox[{"CompilationTarget", "\[Rule]", "\"\<C\>\""}], ",", 
    RowBox[{"RuntimeOptions", "\[Rule]", "\"\<Speed\>\""}], ",", 
    RowBox[{"RuntimeAttributes", "\[Rule]", 
     RowBox[{"{", "Listable", "}"}]}], ",", 
    RowBox[{"Parallelization", "->", "True"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.913106587472008*^9, 3.913106594439848*^9}, {
   3.9131066301476555`*^9, 3.913106654577142*^9}, {3.9131066961468306`*^9, 
   3.9131067840146995`*^9}, {3.9131074758628445`*^9, 3.913107508565968*^9}, {
   3.913108534239568*^9, 3.913108542629727*^9}, {3.91310862730369*^9, 
   3.9131086389070997`*^9}, {3.913109386725669*^9, 3.9131093994871893`*^9}, {
   3.9131094832851663`*^9, 3.913109483359197*^9}, {3.9131095462819133`*^9, 
   3.9131095516081376`*^9}, 3.913174017227763*^9, {3.913174053027907*^9, 
   3.913174055608763*^9}, {3.9131740904276886`*^9, 3.9131740934878674`*^9}, {
   3.913174371617926*^9, 3.9131743816271777`*^9}, {3.913174516016832*^9, 
   3.913174591663071*^9}, {3.913174677947095*^9, 3.913174685127929*^9}, {
   3.91317479979908*^9, 3.91317484641241*^9}, {3.913174881678902*^9, 
   3.913175011997743*^9}, 3.913175083007023*^9, {3.9131751147576723`*^9, 
   3.913175158407481*^9}, {3.913175266417586*^9, 3.9131752755991335`*^9}, {
   3.913175315668645*^9, 3.9131753296276565`*^9}, 3.913175398716926*^9, {
   3.913175435858427*^9, 3.913175436208959*^9}, {3.913175496706813*^9, 
   3.913175534187899*^9}, {3.913175565741685*^9, 3.9131755992978177`*^9}, {
   3.9131756882445*^9, 3.9131756918067503`*^9}, {3.913175728958982*^9, 
   3.91317573247212*^9}, {3.913176268518656*^9, 3.913176280237647*^9}, {
   3.913176471116912*^9, 3.913176586215138*^9}, {3.913176632436755*^9, 
   3.9131766536077366`*^9}, {3.913176687111824*^9, 3.913176691813552*^9}, {
   3.913176725841658*^9, 3.913176855243633*^9}, {3.91317711096293*^9, 
   3.913177162881609*^9}, {3.913177251721398*^9, 3.913177251943059*^9}, 
   3.913178006376798*^9, 3.913178055272434*^9, {3.913178094133986*^9, 
   3.913178094985029*^9}, {3.913179348457934*^9, 3.913179500022968*^9}, {
   3.91317956966864*^9, 3.913179633182292*^9}, {3.9131797988608284`*^9, 
   3.913179852617799*^9}, 3.913180144135728*^9, {3.913180618830075*^9, 
   3.913180619405963*^9}, {3.913180654659948*^9, 3.913180721233328*^9}, {
   3.9131807550814962`*^9, 3.913180758350403*^9}, {3.913180888261049*^9, 
   3.9131810134372225`*^9}, {3.913181360530951*^9, 3.913181364247963*^9}, {
   3.913181773476987*^9, 3.9131817951370816`*^9}, {3.913181938322895*^9, 
   3.9131819406974807`*^9}, {3.9131820788929687`*^9, 
   3.9131820819291444`*^9}, {3.913182351489479*^9, 3.9131823935088367`*^9}, {
   3.9131826084978266`*^9, 3.9131826115693445`*^9}, {3.913182652586989*^9, 
   3.913182718838679*^9}, {3.913182756286029*^9, 3.9131827603788958`*^9}, {
   3.9131828254322186`*^9, 3.913182869568014*^9}, {3.9131829106078825`*^9, 
   3.913182911517872*^9}, {3.913182948723506*^9, 3.9131829506286964`*^9}, {
   3.913182982408037*^9, 3.913182986457778*^9}, {3.913183062012779*^9, 
   3.9131830786975784`*^9}, {3.9131832212597675`*^9, 
   3.9131832466078143`*^9}, {3.913224530954069*^9, 3.913224535674638*^9}, {
   3.913224783404888*^9, 3.9132247869828*^9}, {3.913225395345085*^9, 
   3.913225398907903*^9}, {3.9132619284693756`*^9, 3.9132619287017317`*^9}, {
   3.913356017491578*^9, 3.913356029011331*^9}, {3.91344943487611*^9, 
   3.9134494763373623`*^9}, {3.913449561895245*^9, 3.91344957069576*^9}, {
   3.913450019207034*^9, 3.913450043327329*^9}, {3.91345012555602*^9, 
   3.9134501256460323`*^9}, {3.913450166465826*^9, 3.9134501702329273`*^9}, 
   3.9134509736691847`*^9, {3.913451480805791*^9, 3.913451481955962*^9}, {
   3.91345151337609*^9, 3.913451513936138*^9}, {3.914489155891657*^9, 
   3.9144892220474916`*^9}, {3.9157053619239707`*^9, 3.915705402668686*^9}, {
   3.917947689018881*^9, 3.9179477036439457`*^9}, {3.9179477633886843`*^9, 
   3.9179478071601057`*^9}, {3.9179478545731974`*^9, 3.9179478574288626`*^9}},
 
 CellTags->"Evaluation",
 CellLabel->
  "In[782]:=",ExpressionUUID->"2ec450ed-9c77-4c44-8a53-5405c2d3f3a5"],

Cell[BoxData[
 FormBox[
  InterpretationBox[
   RowBox[{
    TagBox["CompiledFunction",
     "SummaryHead"], "[", 
    DynamicModuleBox[{Typeset`open$$ = False, Typeset`embedState$$ = "Ready"}, 
     TemplateBox[{
       PaneSelectorBox[{False -> GridBox[{{
             PaneBox[
              ButtonBox[
               DynamicBox[
                FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxOpener"]], 
               ButtonFunction :> (Typeset`open$$ = True), Appearance -> None, 
               BaseStyle -> {}, Evaluator -> Automatic, Method -> 
               "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
              Dynamic[{
                Automatic, 
                 3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                  Magnification])}]], 
             GraphicsBox[{
               Thickness[0.038461538461538464`], {
                FaceForm[{
                  GrayLevel[0.93], 
                  Opacity[1.]}], 
                
                FilledCurveBox[{{{1, 4, 3}, {0, 1, 0}, {1, 3, 3}, {0, 1, 0}, {
                 1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {0, 1, 0}}}, {{{
                 25.499999999999996`, 2.5}, {25.499999999999996`, 
                 1.3953100000000003`}, {24.604699999999998`, 
                 0.49999999999999994`}, {23.5, 0.49999999999999994`}, {2.5, 
                 0.49999999999999994`}, {1.3953100000000003`, 
                 0.49999999999999994`}, {0.49999999999999994`, 
                 1.3953100000000003`}, {0.49999999999999994`, 2.5}, {
                 0.49999999999999994`, 23.5}, {0.49999999999999994`, 
                 24.604699999999998`}, {1.3953100000000003`, 
                 25.499999999999996`}, {2.5, 25.499999999999996`}, {23.5, 
                 25.499999999999996`}, {24.604699999999998`, 
                 25.499999999999996`}, {25.499999999999996`, 
                 24.604699999999998`}, {25.499999999999996`, 23.5}, {
                 25.499999999999996`, 2.5}}}]}, {
                FaceForm[{
                  RGBColor[0.5, 0.5, 0.5], 
                  Opacity[1.]}], 
                
                FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {
                 0, 1, 0}, {0, 1, 0}, {0, 1, 0}}}, {{{20.5426, 
                 19.116799999999998`}, {16.3832, 21.876199999999997`}, {
                 16.3832, 20.021499999999996`}, {6.930469999999999, 
                 20.021499999999996`}, {6.930469999999999, 
                 18.212100000000003`}, {16.3832, 18.212100000000003`}, {
                 16.3832, 16.357399999999995`}, {20.5426, 
                 19.116799999999998`}}}], 
                
                FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {
                 0, 1, 0}, {0, 1, 0}, {0, 1, 0}}}, {{{5.30508, 13.8391}, {
                 9.46445, 11.079700000000003`}, {9.46445, 
                 12.933999999999997`}, {18.917199999999998`, 
                 12.933999999999997`}, {18.917199999999998`, 14.7438}, {
                 9.46445, 14.7438}, {9.46445, 16.598}, {5.30508, 13.8391}}}], 
                
                
                FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {
                 0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
                 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {
                 1, 3, 3}, {1, 3, 3}, {1, 3, 3}}}, CompressedData["
1:eJxTTMoPSmVmYGBgBGJjIGYCYq4u+eR3VWoOxhkv5j+Qk3SA8fu/r5rKOVHM
Yd2vmNyjZ9Qcrt9QXbW9S8RBg59767IidQcPMYPGaHFhB+Nn61SfiGo4xBwp
T7o2V9Dh0Iolfg6/NBxEHv/x1Xgi4FB1XNNqkqQWnP+axUTQjFkbzn+oO2HB
j/3aDg/Xn5T6WiDoYLs3aJpiqI7DrHN+bO6tQg4zfUR7vF7pQOyfIQyRd9d1
WLL0U1kLoyjEPdm6DpoTXfQX7xBzKPjQejLkhDacL5J4+LL2Gm2HtNnSl4Vf
iELM69J2qPZM3tLnJerQX1oozZugDfHPUxGI/4W1HQ5p3TthoyDi4D7lG1v8
Mi2HgqL9zoEHhB1inOxe3BRG8MH62zXhfIbN1Z82CGhC/GMg4nCm3mN/7TYN
iHlCUPdGakDc/1kUEr46GhD/eYnD+d9iBf/kC0vC+TuCrSL+X5Vy2HGR4R5T
uAbEfxYykPBYp+HQqsCuesZAFhL+rJoQ/2rIQdxTpwkJ7yVycPfD+GDzVqLx
xbUd5HYt2JfqBdWfpA2Jj9mykPDpgYaXtaxDy7yzq86vg8qvlIHE5ylY/Eo7
XAt7o787TxfOB5ufqesQ9PbyxxkPZSDhZ6nrMAGU3u7LQtLLEx2HN2253UbX
ofZ76jis/Pay4oynAsT8QG0HKZMv/gW7FCDyTFpwPsz/MD44/Mw1HFjb1uR9
TVVwWKy880/7FHWIexrkIfLX1RzOMDZZVjHIOaDkh3vSDuj5AwCF11Vc
                 "]]}}, Background -> GrayLevel[0.93], Axes -> False, 
              AspectRatio -> 1, ImageSize -> 
              Dynamic[{
                Automatic, 
                 3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                  Magnification])}], Frame -> True, FrameTicks -> None, 
              FrameStyle -> Directive[
                Thickness[Tiny], 
                GrayLevel[0.7]]], 
             GridBox[{{
                RowBox[{
                  TagBox["\"Argument count: \"", "SummaryItemAnnotation"], 
                  "\[InvisibleSpace]", 
                  TagBox["2", "SummaryItem"]}]}, {
                RowBox[{
                  TagBox["\"Argument types: \"", "SummaryItemAnnotation"], 
                  "\[InvisibleSpace]", 
                  TagBox[
                   StyleBox[
                    PaneBox[
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"_Real", ",", "1"}], "}"}], ",", "_Real"}], "}"}],
                     ContentPadding -> False, FrameMargins -> 0, StripOnInput -> 
                    True, BaselinePosition -> Baseline, 
                    ImageSize -> {{1, 300}, Automatic}], LineBreakWithin -> 
                    False], "SummaryItem"]}]}}, 
              GridBoxAlignment -> {
               "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
              False, GridBoxItemSize -> {
               "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
              GridBoxSpacings -> {
               "Columns" -> {{2}}, "Rows" -> {{Automatic}}}, 
              BaseStyle -> {
               ShowStringCharacters -> False, NumberMarks -> False, 
                PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
           GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
           AutoDelete -> False, 
           GridBoxItemSize -> {
            "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
           BaselinePosition -> {1, 1}], True -> GridBox[{{
             PaneBox[
              ButtonBox[
               DynamicBox[
                FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxCloser"]], 
               ButtonFunction :> (Typeset`open$$ = False), Appearance -> None,
                BaseStyle -> {}, Evaluator -> Automatic, Method -> 
               "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
              Dynamic[{
                Automatic, 
                 3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                  Magnification])}]], 
             GraphicsBox[{
               Thickness[0.038461538461538464`], {
                FaceForm[{
                  GrayLevel[0.93], 
                  Opacity[1.]}], 
                
                FilledCurveBox[{{{1, 4, 3}, {0, 1, 0}, {1, 3, 3}, {0, 1, 0}, {
                 1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {0, 1, 0}}}, {{{
                 25.499999999999996`, 2.5}, {25.499999999999996`, 
                 1.3953100000000003`}, {24.604699999999998`, 
                 0.49999999999999994`}, {23.5, 0.49999999999999994`}, {2.5, 
                 0.49999999999999994`}, {1.3953100000000003`, 
                 0.49999999999999994`}, {0.49999999999999994`, 
                 1.3953100000000003`}, {0.49999999999999994`, 2.5}, {
                 0.49999999999999994`, 23.5}, {0.49999999999999994`, 
                 24.604699999999998`}, {1.3953100000000003`, 
                 25.499999999999996`}, {2.5, 25.499999999999996`}, {23.5, 
                 25.499999999999996`}, {24.604699999999998`, 
                 25.499999999999996`}, {25.499999999999996`, 
                 24.604699999999998`}, {25.499999999999996`, 23.5}, {
                 25.499999999999996`, 2.5}}}]}, {
                FaceForm[{
                  RGBColor[0.5, 0.5, 0.5], 
                  Opacity[1.]}], 
                
                FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {
                 0, 1, 0}, {0, 1, 0}, {0, 1, 0}}}, {{{20.5426, 
                 19.116799999999998`}, {16.3832, 21.876199999999997`}, {
                 16.3832, 20.021499999999996`}, {6.930469999999999, 
                 20.021499999999996`}, {6.930469999999999, 
                 18.212100000000003`}, {16.3832, 18.212100000000003`}, {
                 16.3832, 16.357399999999995`}, {20.5426, 
                 19.116799999999998`}}}], 
                
                FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {
                 0, 1, 0}, {0, 1, 0}, {0, 1, 0}}}, {{{5.30508, 13.8391}, {
                 9.46445, 11.079700000000003`}, {9.46445, 
                 12.933999999999997`}, {18.917199999999998`, 
                 12.933999999999997`}, {18.917199999999998`, 14.7438}, {
                 9.46445, 14.7438}, {9.46445, 16.598}, {5.30508, 13.8391}}}], 
                
                
                FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {
                 0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
                 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {
                 1, 3, 3}, {1, 3, 3}, {1, 3, 3}}}, CompressedData["
1:eJxTTMoPSmVmYGBgBGJjIGYCYq4u+eR3VWoOxhkv5j+Qk3SA8fu/r5rKOVHM
Yd2vmNyjZ9Qcrt9QXbW9S8RBg59767IidQcPMYPGaHFhB+Nn61SfiGo4xBwp
T7o2V9Dh0Iolfg6/NBxEHv/x1Xgi4FB1XNNqkqQWnP+axUTQjFkbzn+oO2HB
j/3aDg/Xn5T6WiDoYLs3aJpiqI7DrHN+bO6tQg4zfUR7vF7pQOyfIQyRd9d1
WLL0U1kLoyjEPdm6DpoTXfQX7xBzKPjQejLkhDacL5J4+LL2Gm2HtNnSl4Vf
iELM69J2qPZM3tLnJerQX1oozZugDfHPUxGI/4W1HQ5p3TthoyDi4D7lG1v8
Mi2HgqL9zoEHhB1inOxe3BRG8MH62zXhfIbN1Z82CGhC/GMg4nCm3mN/7TYN
iHlCUPdGakDc/1kUEr46GhD/eYnD+d9iBf/kC0vC+TuCrSL+X5Vy2HGR4R5T
uAbEfxYykPBYp+HQqsCuesZAFhL+rJoQ/2rIQdxTpwkJ7yVycPfD+GDzVqLx
xbUd5HYt2JfqBdWfpA2Jj9mykPDpgYaXtaxDy7yzq86vg8qvlIHE5ylY/Eo7
XAt7o787TxfOB5ufqesQ9PbyxxkPZSDhZ6nrMAGU3u7LQtLLEx2HN2253UbX
ofZ76jis/Pay4oynAsT8QG0HKZMv/gW7FCDyTFpwPsz/MD44/Mw1HFjb1uR9
TVVwWKy880/7FHWIexrkIfLX1RzOMDZZVjHIOaDkh3vSDuj5AwCF11Vc
                 "]]}}, Background -> GrayLevel[0.93], Axes -> False, 
              AspectRatio -> 1, ImageSize -> 
              Dynamic[{
                Automatic, 
                 3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                  Magnification])}], Frame -> True, FrameTicks -> None, 
              FrameStyle -> Directive[
                Thickness[Tiny], 
                GrayLevel[0.7]]], 
             GridBox[{{
                RowBox[{
                  TagBox["\"Argument count: \"", "SummaryItemAnnotation"], 
                  "\[InvisibleSpace]", 
                  TagBox["2", "SummaryItem"]}]}, {
                RowBox[{
                  TagBox["\"Argument types: \"", "SummaryItemAnnotation"], 
                  "\[InvisibleSpace]", 
                  TagBox[
                   PaneBox[
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"_Real", ",", "1"}], "}"}], ",", "_Real"}], "}"}],
                     ImageSize -> {{1, 500}, Automatic}, BaselinePosition -> 
                    Baseline, ContentPadding -> False, FrameMargins -> 0, 
                    StripOnInput -> True], "SummaryItem"]}]}, {
                RowBox[{
                  TagBox["\"Variables: \"", "SummaryItemAnnotation"], 
                  "\[InvisibleSpace]", 
                  TagBox[
                   RowBox[{"{", 
                    RowBox[{"Events", ",", "m"}], "}"}], "SummaryItem"]}]}, {
                RowBox[{
                  TagBox["\"Expression: \"", "SummaryItemAnnotation"], 
                  "\[InvisibleSpace]", 
                  TagBox[
                   PaneBox[
                    RowBox[{"Block", "[", 
                    RowBox[{
                    RowBox[{"{", "Compile`$34", "}"}], ",", 
                    RowBox[{"Module", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"thv", ",", "ev", ",", "\[Phi]v", ",", "pv"}], 
                    "}"}], ",", 
                    RowBox[{
                    RowBox[{"thv", "=", 
                    RowBox[{"Compile`GetElement", "(", 
                    RowBox[{"Events", ",", "1"}], ")"}]}], ";", 
                    RowBox[{"ev", "=", 
                    RowBox[{"Compile`GetElement", "(", 
                    RowBox[{"Events", ",", "2"}], ")"}]}], ";", 
                    RowBox[{"\[Phi]v", "=", 
                    RowBox[{"RandomReal", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "\[Pi]"}], ",", "\[Pi]"}], "}"}], "]"}]}], 
                    ";", 
                    RowBox[{"pv", "=", 
                    SqrtBox[
                    RowBox[{
                    SuperscriptBox["ev", "2"], "-", 
                    SuperscriptBox["m", "2"]}]]}], ";", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Compile`$34", "=", 
                    RowBox[{"sin", "(", "thv", ")"}]}], ";", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Compile`$34", " ", "pv", " ", 
                    RowBox[{"cos", "(", "\[Phi]v", ")"}]}], ",", 
                    RowBox[{"Compile`$34", " ", "pv", " ", 
                    RowBox[{"sin", "(", "\[Phi]v", ")"}]}], ",", 
                    RowBox[{"pv", " ", 
                    RowBox[{"cos", "(", "thv", ")"}]}], ",", "ev", ",", "m"}],
                     "}"}]}], ")"}]}]}], "]"}]}], "]"}], 
                    ImageSize -> {{1, 500}, Automatic}, BaselinePosition -> 
                    Baseline, ContentPadding -> False, FrameMargins -> 0, 
                    StripOnInput -> True], "SummaryItem"]}]}}, 
              GridBoxAlignment -> {
               "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
              False, GridBoxItemSize -> {
               "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
              GridBoxSpacings -> {
               "Columns" -> {{2}}, "Rows" -> {{Automatic}}}, 
              BaseStyle -> {
               ShowStringCharacters -> False, NumberMarks -> False, 
                PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
           GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
           AutoDelete -> False, 
           GridBoxItemSize -> {
            "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
           BaselinePosition -> {1, 1}]}, 
        Dynamic[Typeset`open$$], ImageSize -> Automatic]},
      "SummaryPanel"],
     DynamicModuleValues:>{}], "]"}],
   CompiledFunction[{11, 14., 5848}, {{
      Blank[Real], 1}, 
     Blank[Real]}, {{3, 1, 0}, {3, 0, 0}, {3, 1, 
    1}}, {{2, {2, 0, 1}}, {1, {2, 0, 0}}, {3.141592653589793, {3, 0, 3}}}, {0,
     2, 11, 0, 
    2}, {{37, 0, 0, 3, 1}, {37, 0, 1, 3, 2}, {19, 3, 4}, {
     42, "RandomReal", 3, 0, 4, 3, 0, 3, 3, 0, 5}, {40, 56, 3, 0, 2, 3, 0, 
     4}, {40, 56, 3, 0, 0, 3, 0, 6}, {19, 6, 7}, {13, 4, 7, 4}, {40, 57, 3, 0,
      4, 3, 0, 7}, {40, 1, 3, 0, 1, 3, 0, 4}, {40, 2, 3, 0, 5, 3, 0, 6}, {16, 
     7, 6, 4, 8}, {40, 1, 3, 0, 5, 3, 0, 6}, {16, 7, 6, 4, 9}, {40, 2, 3, 0, 
     1, 3, 0, 6}, {16, 7, 6, 10}, {34, 1, 5, 8, 9, 10, 2, 0, 3, 1}, {1}}, 
    Function[{$CellContext`Events, $CellContext`m}, 
     Block[{Compile`$34}, 
      Module[{$CellContext`thv, $CellContext`ev, $CellContext`\[Phi]v, \
$CellContext`pv}, $CellContext`thv = 
        Compile`GetElement[$CellContext`Events, 1]; $CellContext`ev = 
        Compile`GetElement[$CellContext`Events, 2]; $CellContext`\[Phi]v = 
        RandomReal[{-Pi, Pi}]; $CellContext`pv = 
        Sqrt[$CellContext`ev^2 - $CellContext`m^2]; (
        Compile`$34 = 
         Sin[$CellContext`thv]; {$CellContext`pv Cos[$CellContext`\[Phi]v] 
          Compile`$34, $CellContext`pv Sin[$CellContext`\[Phi]v] 
          Compile`$34, $CellContext`pv 
          Cos[$CellContext`thv], $CellContext`ev, $CellContext`m})]], 
     Listable], Evaluate, 
    LibraryFunction[
    "/Users/alberto/Library/Mathematica/ApplicationData/CCompilerDriver/\
BuildFolder/eduroam-4014-1219/compiledFunction49.dylib", 
     "compiledFunction49", {{Real, 1, "Constant"}, {Real, 0, "Constant"}}, {
     Real, 1}]],
   Editable->False,
   SelectWithContents->True,
   Selectable->False], TraditionalForm]], "Output",
 CellChangeTimes->{3.930211455778789*^9, 3.930822682024674*^9},
 CellTags->"Evaluation",
 CellLabel->
  "Out[783]=",ExpressionUUID->"cd34b1ea-7dbf-41a8-8dc5-4f01540a10aa"],

Cell[BoxData[
 FormBox[
  InterpretationBox[
   RowBox[{
    TagBox["CompiledFunction",
     "SummaryHead"], "[", 
    DynamicModuleBox[{Typeset`open$$ = False, Typeset`embedState$$ = "Ready"}, 
     TemplateBox[{
       PaneSelectorBox[{False -> GridBox[{{
             PaneBox[
              ButtonBox[
               DynamicBox[
                FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxOpener"]], 
               ButtonFunction :> (Typeset`open$$ = True), Appearance -> None, 
               BaseStyle -> {}, Evaluator -> Automatic, Method -> 
               "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
              Dynamic[{
                Automatic, 
                 3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                  Magnification])}]], 
             GraphicsBox[{
               Thickness[0.038461538461538464`], {
                FaceForm[{
                  GrayLevel[0.93], 
                  Opacity[1.]}], 
                
                FilledCurveBox[{{{1, 4, 3}, {0, 1, 0}, {1, 3, 3}, {0, 1, 0}, {
                 1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {0, 1, 0}}}, {{{
                 25.499999999999996`, 2.5}, {25.499999999999996`, 
                 1.3953100000000003`}, {24.604699999999998`, 
                 0.49999999999999994`}, {23.5, 0.49999999999999994`}, {2.5, 
                 0.49999999999999994`}, {1.3953100000000003`, 
                 0.49999999999999994`}, {0.49999999999999994`, 
                 1.3953100000000003`}, {0.49999999999999994`, 2.5}, {
                 0.49999999999999994`, 23.5}, {0.49999999999999994`, 
                 24.604699999999998`}, {1.3953100000000003`, 
                 25.499999999999996`}, {2.5, 25.499999999999996`}, {23.5, 
                 25.499999999999996`}, {24.604699999999998`, 
                 25.499999999999996`}, {25.499999999999996`, 
                 24.604699999999998`}, {25.499999999999996`, 23.5}, {
                 25.499999999999996`, 2.5}}}]}, {
                FaceForm[{
                  RGBColor[0.5, 0.5, 0.5], 
                  Opacity[1.]}], 
                
                FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {
                 0, 1, 0}, {0, 1, 0}, {0, 1, 0}}}, {{{20.5426, 
                 19.116799999999998`}, {16.3832, 21.876199999999997`}, {
                 16.3832, 20.021499999999996`}, {6.930469999999999, 
                 20.021499999999996`}, {6.930469999999999, 
                 18.212100000000003`}, {16.3832, 18.212100000000003`}, {
                 16.3832, 16.357399999999995`}, {20.5426, 
                 19.116799999999998`}}}], 
                
                FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {
                 0, 1, 0}, {0, 1, 0}, {0, 1, 0}}}, {{{5.30508, 13.8391}, {
                 9.46445, 11.079700000000003`}, {9.46445, 
                 12.933999999999997`}, {18.917199999999998`, 
                 12.933999999999997`}, {18.917199999999998`, 14.7438}, {
                 9.46445, 14.7438}, {9.46445, 16.598}, {5.30508, 13.8391}}}], 
                
                
                FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {
                 0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
                 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {
                 1, 3, 3}, {1, 3, 3}, {1, 3, 3}}}, CompressedData["
1:eJxTTMoPSmVmYGBgBGJjIGYCYq4u+eR3VWoOxhkv5j+Qk3SA8fu/r5rKOVHM
Yd2vmNyjZ9Qcrt9QXbW9S8RBg59767IidQcPMYPGaHFhB+Nn61SfiGo4xBwp
T7o2V9Dh0Iolfg6/NBxEHv/x1Xgi4FB1XNNqkqQWnP+axUTQjFkbzn+oO2HB
j/3aDg/Xn5T6WiDoYLs3aJpiqI7DrHN+bO6tQg4zfUR7vF7pQOyfIQyRd9d1
WLL0U1kLoyjEPdm6DpoTXfQX7xBzKPjQejLkhDacL5J4+LL2Gm2HtNnSl4Vf
iELM69J2qPZM3tLnJerQX1oozZugDfHPUxGI/4W1HQ5p3TthoyDi4D7lG1v8
Mi2HgqL9zoEHhB1inOxe3BRG8MH62zXhfIbN1Z82CGhC/GMg4nCm3mN/7TYN
iHlCUPdGakDc/1kUEr46GhD/eYnD+d9iBf/kC0vC+TuCrSL+X5Vy2HGR4R5T
uAbEfxYykPBYp+HQqsCuesZAFhL+rJoQ/2rIQdxTpwkJ7yVycPfD+GDzVqLx
xbUd5HYt2JfqBdWfpA2Jj9mykPDpgYaXtaxDy7yzq86vg8qvlIHE5ylY/Eo7
XAt7o787TxfOB5ufqesQ9PbyxxkPZSDhZ6nrMAGU3u7LQtLLEx2HN2253UbX
ofZ76jis/Pay4oynAsT8QG0HKZMv/gW7FCDyTFpwPsz/MD44/Mw1HFjb1uR9
TVVwWKy880/7FHWIexrkIfLX1RzOMDZZVjHIOaDkh3vSDuj5AwCF11Vc
                 "]]}}, Background -> GrayLevel[0.93], Axes -> False, 
              AspectRatio -> 1, ImageSize -> 
              Dynamic[{
                Automatic, 
                 3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                  Magnification])}], Frame -> True, FrameTicks -> None, 
              FrameStyle -> Directive[
                Thickness[Tiny], 
                GrayLevel[0.7]]], 
             GridBox[{{
                RowBox[{
                  TagBox["\"Argument count: \"", "SummaryItemAnnotation"], 
                  "\[InvisibleSpace]", 
                  TagBox["2", "SummaryItem"]}]}, {
                RowBox[{
                  TagBox["\"Argument types: \"", "SummaryItemAnnotation"], 
                  "\[InvisibleSpace]", 
                  TagBox[
                   StyleBox[
                    PaneBox[
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"_Real", ",", "1"}], "}"}], ",", "_Real"}], "}"}],
                     ContentPadding -> False, FrameMargins -> 0, StripOnInput -> 
                    True, BaselinePosition -> Baseline, 
                    ImageSize -> {{1, 300}, Automatic}], LineBreakWithin -> 
                    False], "SummaryItem"]}]}}, 
              GridBoxAlignment -> {
               "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
              False, GridBoxItemSize -> {
               "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
              GridBoxSpacings -> {
               "Columns" -> {{2}}, "Rows" -> {{Automatic}}}, 
              BaseStyle -> {
               ShowStringCharacters -> False, NumberMarks -> False, 
                PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
           GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
           AutoDelete -> False, 
           GridBoxItemSize -> {
            "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
           BaselinePosition -> {1, 1}], True -> GridBox[{{
             PaneBox[
              ButtonBox[
               DynamicBox[
                FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxCloser"]], 
               ButtonFunction :> (Typeset`open$$ = False), Appearance -> None,
                BaseStyle -> {}, Evaluator -> Automatic, Method -> 
               "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
              Dynamic[{
                Automatic, 
                 3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                  Magnification])}]], 
             GraphicsBox[{
               Thickness[0.038461538461538464`], {
                FaceForm[{
                  GrayLevel[0.93], 
                  Opacity[1.]}], 
                
                FilledCurveBox[{{{1, 4, 3}, {0, 1, 0}, {1, 3, 3}, {0, 1, 0}, {
                 1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {0, 1, 0}}}, {{{
                 25.499999999999996`, 2.5}, {25.499999999999996`, 
                 1.3953100000000003`}, {24.604699999999998`, 
                 0.49999999999999994`}, {23.5, 0.49999999999999994`}, {2.5, 
                 0.49999999999999994`}, {1.3953100000000003`, 
                 0.49999999999999994`}, {0.49999999999999994`, 
                 1.3953100000000003`}, {0.49999999999999994`, 2.5}, {
                 0.49999999999999994`, 23.5}, {0.49999999999999994`, 
                 24.604699999999998`}, {1.3953100000000003`, 
                 25.499999999999996`}, {2.5, 25.499999999999996`}, {23.5, 
                 25.499999999999996`}, {24.604699999999998`, 
                 25.499999999999996`}, {25.499999999999996`, 
                 24.604699999999998`}, {25.499999999999996`, 23.5}, {
                 25.499999999999996`, 2.5}}}]}, {
                FaceForm[{
                  RGBColor[0.5, 0.5, 0.5], 
                  Opacity[1.]}], 
                
                FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {
                 0, 1, 0}, {0, 1, 0}, {0, 1, 0}}}, {{{20.5426, 
                 19.116799999999998`}, {16.3832, 21.876199999999997`}, {
                 16.3832, 20.021499999999996`}, {6.930469999999999, 
                 20.021499999999996`}, {6.930469999999999, 
                 18.212100000000003`}, {16.3832, 18.212100000000003`}, {
                 16.3832, 16.357399999999995`}, {20.5426, 
                 19.116799999999998`}}}], 
                
                FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {
                 0, 1, 0}, {0, 1, 0}, {0, 1, 0}}}, {{{5.30508, 13.8391}, {
                 9.46445, 11.079700000000003`}, {9.46445, 
                 12.933999999999997`}, {18.917199999999998`, 
                 12.933999999999997`}, {18.917199999999998`, 14.7438}, {
                 9.46445, 14.7438}, {9.46445, 16.598}, {5.30508, 13.8391}}}], 
                
                
                FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {
                 0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
                 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {
                 1, 3, 3}, {1, 3, 3}, {1, 3, 3}}}, CompressedData["
1:eJxTTMoPSmVmYGBgBGJjIGYCYq4u+eR3VWoOxhkv5j+Qk3SA8fu/r5rKOVHM
Yd2vmNyjZ9Qcrt9QXbW9S8RBg59767IidQcPMYPGaHFhB+Nn61SfiGo4xBwp
T7o2V9Dh0Iolfg6/NBxEHv/x1Xgi4FB1XNNqkqQWnP+axUTQjFkbzn+oO2HB
j/3aDg/Xn5T6WiDoYLs3aJpiqI7DrHN+bO6tQg4zfUR7vF7pQOyfIQyRd9d1
WLL0U1kLoyjEPdm6DpoTXfQX7xBzKPjQejLkhDacL5J4+LL2Gm2HtNnSl4Vf
iELM69J2qPZM3tLnJerQX1oozZugDfHPUxGI/4W1HQ5p3TthoyDi4D7lG1v8
Mi2HgqL9zoEHhB1inOxe3BRG8MH62zXhfIbN1Z82CGhC/GMg4nCm3mN/7TYN
iHlCUPdGakDc/1kUEr46GhD/eYnD+d9iBf/kC0vC+TuCrSL+X5Vy2HGR4R5T
uAbEfxYykPBYp+HQqsCuesZAFhL+rJoQ/2rIQdxTpwkJ7yVycPfD+GDzVqLx
xbUd5HYt2JfqBdWfpA2Jj9mykPDpgYaXtaxDy7yzq86vg8qvlIHE5ylY/Eo7
XAt7o787TxfOB5ufqesQ9PbyxxkPZSDhZ6nrMAGU3u7LQtLLEx2HN2253UbX
ofZ76jis/Pay4oynAsT8QG0HKZMv/gW7FCDyTFpwPsz/MD44/Mw1HFjb1uR9
TVVwWKy880/7FHWIexrkIfLX1RzOMDZZVjHIOaDkh3vSDuj5AwCF11Vc
                 "]]}}, Background -> GrayLevel[0.93], Axes -> False, 
              AspectRatio -> 1, ImageSize -> 
              Dynamic[{
                Automatic, 
                 3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                  Magnification])}], Frame -> True, FrameTicks -> None, 
              FrameStyle -> Directive[
                Thickness[Tiny], 
                GrayLevel[0.7]]], 
             GridBox[{{
                RowBox[{
                  TagBox["\"Argument count: \"", "SummaryItemAnnotation"], 
                  "\[InvisibleSpace]", 
                  TagBox["2", "SummaryItem"]}]}, {
                RowBox[{
                  TagBox["\"Argument types: \"", "SummaryItemAnnotation"], 
                  "\[InvisibleSpace]", 
                  TagBox[
                   PaneBox[
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"_Real", ",", "1"}], "}"}], ",", "_Real"}], "}"}],
                     ImageSize -> {{1, 500}, Automatic}, BaselinePosition -> 
                    Baseline, ContentPadding -> False, FrameMargins -> 0, 
                    StripOnInput -> True], "SummaryItem"]}]}, {
                RowBox[{
                  TagBox["\"Variables: \"", "SummaryItemAnnotation"], 
                  "\[InvisibleSpace]", 
                  TagBox[
                   RowBox[{"{", 
                    RowBox[{"data", ",", "m"}], "}"}], "SummaryItem"]}]}, {
                RowBox[{
                  TagBox["\"Expression: \"", "SummaryItemAnnotation"], 
                  "\[InvisibleSpace]", 
                  TagBox[
                   PaneBox[
                    RowBox[{"Module", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"px", ",", "py", ",", "pz", ",", "e"}], "}"}], 
                    ",", 
                    RowBox[{
                    RowBox[{"px", "=", 
                    RowBox[{"Compile`GetElement", "(", 
                    RowBox[{"data", ",", "1"}], ")"}]}], ";", 
                    RowBox[{"py", "=", 
                    RowBox[{"Compile`GetElement", "(", 
                    RowBox[{"data", ",", "2"}], ")"}]}], ";", 
                    RowBox[{"pz", "=", 
                    RowBox[{"Compile`GetElement", "(", 
                    RowBox[{"data", ",", "3"}], ")"}]}], ";", 
                    RowBox[{"e", "=", 
                    SqrtBox[
                    RowBox[{
                    SuperscriptBox["m", "2"], "+", 
                    SuperscriptBox["px", "2"], "+", 
                    SuperscriptBox["py", "2"], "+", 
                    SuperscriptBox["pz", "2"]}]]}], ";", 
                    RowBox[{"{", 
                    RowBox[{"px", ",", "py", ",", "pz", ",", "e", ",", "m"}], 
                    "}"}]}]}], "]"}], ImageSize -> {{1, 500}, Automatic}, 
                    BaselinePosition -> Baseline, ContentPadding -> False, 
                    FrameMargins -> 0, StripOnInput -> True], 
                   "SummaryItem"]}]}}, 
              GridBoxAlignment -> {
               "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
              False, GridBoxItemSize -> {
               "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
              GridBoxSpacings -> {
               "Columns" -> {{2}}, "Rows" -> {{Automatic}}}, 
              BaseStyle -> {
               ShowStringCharacters -> False, NumberMarks -> False, 
                PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
           GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
           AutoDelete -> False, 
           GridBoxItemSize -> {
            "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
           BaselinePosition -> {1, 1}]}, 
        Dynamic[Typeset`open$$], ImageSize -> Automatic]},
      "SummaryPanel"],
     DynamicModuleValues:>{}], "]"}],
   CompiledFunction[{11, 14., 5848}, {{
      Blank[Real], 1}, 
     Blank[Real]}, {{3, 1, 0}, {3, 0, 0}, {3, 1, 
    1}}, {{2, {2, 0, 1}}, {1, {2, 0, 0}}, {3, {2, 0, 2}}}, {0, 3, 8, 0, 
    2}, {{37, 0, 0, 3, 1}, {37, 0, 1, 3, 2}, {37, 0, 2, 3, 3}, {40, 56, 3, 0, 
     1, 3, 0, 4}, {40, 56, 3, 0, 2, 3, 0, 5}, {40, 56, 3, 0, 3, 3, 0, 6}, {40,
      56, 3, 0, 0, 3, 0, 7}, {13, 4, 5, 6, 7, 4}, {40, 57, 3, 0, 4, 3, 0, 
     5}, {34, 1, 5, 1, 2, 3, 5, 0, 3, 1}, {1}}, 
    Function[{$CellContext`data, $CellContext`m}, 
     Module[{$CellContext`px, $CellContext`py, $CellContext`pz, \
$CellContext`e}, $CellContext`px = 
       Compile`GetElement[$CellContext`data, 1]; $CellContext`py = 
       Compile`GetElement[$CellContext`data, 2]; $CellContext`pz = 
       Compile`GetElement[$CellContext`data, 3]; $CellContext`e = 
       Sqrt[$CellContext`px^2 + $CellContext`py^2 + $CellContext`pz^2 + \
$CellContext`m^2]; {$CellContext`px, $CellContext`py, $CellContext`pz, \
$CellContext`e, $CellContext`m}], Listable], Evaluate, 
    LibraryFunction[
    "/Users/alberto/Library/Mathematica/ApplicationData/CCompilerDriver/\
BuildFolder/eduroam-4014-1219/compiledFunction50.dylib", 
     "compiledFunction50", {{Real, 1, "Constant"}, {Real, 0, "Constant"}}, {
     Real, 1}]],
   Editable->False,
   SelectWithContents->True,
   Selectable->False], TraditionalForm]], "Output",
 CellChangeTimes->{3.930211455778789*^9, 3.9308226826216*^9},
 CellTags->"Evaluation",
 CellLabel->
  "Out[785]=",ExpressionUUID->"903c21f6-cbdd-4de8-88e3-1b97db727d32"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Interpolation and phase space sampling", "Chapter",
 CellChangeTimes->{{3.913217803376299*^9, 3.91321780605317*^9}, {
  3.913221060261714*^9, 3.9132210604119887`*^9}, {3.913221306993131*^9, 
  3.913221325215193*^9}},
 CellTags->
  "Evaluation",ExpressionUUID->"e54bbe8c-2f3c-464c-8714-8e4597d33d99"],

Cell[CellGroupData[{

Cell["Phase space sampling", "Section",
 CellChangeTimes->{{3.914831564732529*^9, 3.9148315686183376`*^9}},
 CellTags->
  "Evaluation",ExpressionUUID->"6a284235-3c44-4a3d-bb13-b42fe2ecb30a"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"MotherInterpolation", "[", 
   RowBox[{"Facility_", ",", "Particle_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"data", ",", "datalog"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"data", "=", 
      RowBox[{"DataDistr", "[", 
       RowBox[{"Facility", ",", "Particle"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"datalog", "=", 
      RowBox[{"DataLogarithmiedComp", "[", "data", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Theta]MinMax", "[", 
       RowBox[{"Facility", ",", "Particle"}], "]"}], "=", 
      RowBox[{"MinMax", "[", 
       RowBox[{"data", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Emax", "[", 
       RowBox[{"\[Theta]X_", ",", "Facility", ",", "Particle"}], "]"}], "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Interpolation", "[", 
         RowBox[{
          RowBox[{"FindingEmax\[Theta]", "[", 
           RowBox[{
            RowBox[{"DataDistr", "[", 
             RowBox[{"Facility", ",", "Particle"}], "]"}], ",", "Facility", 
            ",", "7"}], "]"}], ",", 
          RowBox[{"InterpolationOrder", "->", "1"}]}], "]"}], "[", 
        RowBox[{"Log", "[", "\[Theta]X", "]"}], "]"}], "//", "Exp"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"DoubleDistrMotherInt", "[", 
       RowBox[{"\[Theta]X_", ",", "EX_", ",", "Facility", ",", "Particle"}], 
       "]"}], "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"mSM", "[", "Particle", "]"}], "<=", "EX", "<=", 
          RowBox[{"Emax", "[", 
           RowBox[{"\[Theta]X", ",", "Facility", ",", "Particle"}], "]"}]}], "&&", 
         RowBox[{
          RowBox[{
           RowBox[{"\[Theta]MinMax", "[", 
            RowBox[{"Facility", ",", "Particle"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}], "<=", "\[Theta]X", "<=", 
          RowBox[{
           RowBox[{"\[Theta]MinMax", "[", 
            RowBox[{"Facility", ",", "Particle"}], "]"}], "[", 
           RowBox[{"[", "2", "]"}], "]"}]}]}], ",", 
        RowBox[{"Evaluate", "[", 
         RowBox[{"Exp", "[", 
          RowBox[{
           RowBox[{"Interpolation", "[", 
            RowBox[{"datalog", ",", 
             RowBox[{"InterpolationOrder", "->", "1"}]}], "]"}], "[", 
           RowBox[{
            RowBox[{"Log", "[", "\[Theta]X", "]"}], ",", 
            RowBox[{"Log", "[", "EX", "]"}]}], "]"}], "]"}], "]"}], ",", 
        "0."}], "]"}]}], ";"}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MotherInterpolation", "[", 
   RowBox[{"\"\<LHC\>\"", ",", "\"\<Upsilon\>\""}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"IfMotherInterpolated", "[", 
   RowBox[{"Facility_", ",", "Mother_"}], "]"}], ":=", 
  RowBox[{"MemberQ", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"Keys", "[", 
         RowBox[{"DownValues", "@", "DoubleDistrMotherInt"}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "1", ",", 
          RowBox[{"-", "2"}]}], "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{"Keys", "[", 
         RowBox[{"DownValues", "@", "DoubleDistrMotherInt"}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "1", ",", 
          RowBox[{"-", "1"}]}], "]"}], "]"}]}], "}"}], "//", "Transpose"}], 
    ",", 
    RowBox[{"{", 
     RowBox[{"Facility", ",", "Mother"}], "}"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"{", 
   RowBox[{
    RowBox[{"IfMotherInterpolated", "[", 
     RowBox[{"\"\<LHC\>\"", ",", "\"\<Upsilon\>\""}], "]"}], ",", 
    RowBox[{"IfMotherInterpolated", "[", 
     RowBox[{"\"\<SPS\>\"", ",", "\"\<Kplus\>\""}], "]"}]}], "}"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"For", " ", "the", " ", "moment"}], ",", " ", 
    RowBox[{
    "for", " ", "some", " ", "distributions", " ", "that", " ", "are", " ", 
     "absent"}], ",", " ", 
    RowBox[{
    "they", " ", "will", " ", "be", " ", "approximated", " ", "by", " ", 
     "the", " ", "distributions", " ", "of", " ", "similar", " ", 
     "particles"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SimilarParticle", "[", 
    RowBox[{"\"\<FCC-hh\>\"", ",", "\"\<Bc\>\""}], "]"}], "=", 
   RowBox[{
    RowBox[{"SimilarParticle", "[", 
     RowBox[{"\"\<LHC\>\"", ",", "\"\<Bc\>\""}], "]"}], "=", 
    RowBox[{
     RowBox[{"SimilarParticle", "[", 
      RowBox[{"\"\<SPS\>\"", ",", "\"\<Bc\>\""}], "]"}], "=", 
     RowBox[{
      RowBox[{"SimilarParticle", "[", 
       RowBox[{"\"\<FermilabBD\>\"", ",", "\"\<Bc\>\""}], "]"}], "=", 
      RowBox[{
       RowBox[{"SimilarParticle", "[", 
        RowBox[{"\"\<LHC_fixed_target\>\"", ",", "\"\<Bc\>\""}], "]"}], "=", 
       "\"\<Bplus\>\""}]}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SimilarParticle", "[", 
    RowBox[{"\"\<FCC-hh\>\"", ",", "\"\<B0\>\""}], "]"}], "=", 
   RowBox[{
    RowBox[{"SimilarParticle", "[", 
     RowBox[{"\"\<LHC\>\"", ",", "\"\<B0\>\""}], "]"}], "=", 
    RowBox[{
     RowBox[{"SimilarParticle", "[", 
      RowBox[{"\"\<SPS\>\"", ",", "\"\<B0\>\""}], "]"}], "=", 
     RowBox[{
      RowBox[{"SimilarParticle", "[", 
       RowBox[{"\"\<FermilabBD\>\"", ",", "\"\<B0\>\""}], "]"}], "=", 
      RowBox[{
       RowBox[{"SimilarParticle", "[", 
        RowBox[{"\"\<LHC_fixed_target\>\"", ",", "\"\<B0\>\""}], "]"}], "=", 
       "\"\<Bplus\>\""}]}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SimilarParticle", "[", 
    RowBox[{"\"\<FCC-hh\>\"", ",", "\"\<Bs\>\""}], "]"}], "=", 
   RowBox[{
    RowBox[{"SimilarParticle", "[", 
     RowBox[{"\"\<LHC\>\"", ",", "\"\<Bs\>\""}], "]"}], "=", 
    RowBox[{
     RowBox[{"SimilarParticle", "[", 
      RowBox[{"\"\<SPS\>\"", ",", "\"\<Bs\>\""}], "]"}], "=", 
     RowBox[{
      RowBox[{"SimilarParticle", "[", 
       RowBox[{"\"\<FermilabBD\>\"", ",", "\"\<Bs\>\""}], "]"}], "=", 
      RowBox[{
       RowBox[{"SimilarParticle", "[", 
        RowBox[{"\"\<LHC_fixed_target\>\"", ",", "\"\<Bs\>\""}], "]"}], "=", 
       "\"\<Bplus\>\""}]}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SimilarParticle", "[", 
    RowBox[{"\"\<FCC-hh\>\"", ",", "\"\<tau\>\""}], "]"}], "=", 
   RowBox[{
    RowBox[{"SimilarParticle", "[", 
     RowBox[{"\"\<LHC\>\"", ",", "\"\<tau\>\""}], "]"}], "=", 
    RowBox[{
     RowBox[{"SimilarParticle", "[", 
      RowBox[{"\"\<SPS\>\"", ",", "\"\<tau\>\""}], "]"}], "=", 
     RowBox[{
      RowBox[{"SimilarParticle", "[", 
       RowBox[{"\"\<FermilabBD\>\"", ",", "\"\<tau\>\""}], "]"}], "=", 
      RowBox[{
       RowBox[{"SimilarParticle", "[", 
        RowBox[{"\"\<LHC_fixed_target\>\"", ",", "\"\<tau\>\""}], "]"}], "=", 
       "\"\<Ds\>\""}]}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SimilarParticle", "[", 
    RowBox[{"\"\<FCC-hh\>\"", ",", "\"\<D0\>\""}], "]"}], "=", 
   RowBox[{
    RowBox[{"SimilarParticle", "[", 
     RowBox[{"\"\<FCC-hh\>\"", ",", "\"\<Ds\>\""}], "]"}], "=", 
    "\"\<Dplus\>\""}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PointsSampler", "[", 
   RowBox[{"Facility_", ",", "Particle_", ",", "Nevents_", ",", "IfTwo_"}], 
   "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "data", ",", "Nev", ",", "IfPresent", ",", "particle", ",", 
      "motherpoints", ",", "datafin"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"For", " ", "the", " ", "moment"}], ",", " ", 
      RowBox[{
      "for", " ", "some", " ", "distributions", " ", "that", " ", "are", " ", 
       "absent"}], ",", " ", 
      RowBox[{
      "they", " ", "will", " ", "be", " ", "approximated", " ", "by", " ", 
       "the", " ", "distributions", " ", "of", " ", "similar", " ", 
       "particles"}]}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Facility", "==", "\"\<ESS\>\""}], "&&", 
        RowBox[{"MemberQ", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"\"\<PiCharged\>\"", ",", "\"\<mu\>\""}], "}"}], ",", 
          "Particle"}], "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"datafin", "=", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0.", ",", "0.", ",", "0.", ",", 
            RowBox[{"mSM", "[", "Particle", "]"}], ",", 
            RowBox[{"mSM", "[", "Particle", "]"}]}], "}"}], ",", "Nevents"}], 
         "]"}]}], "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"IfPresent", "=", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"DataDistr", "[", 
              RowBox[{"Facility", ",", "Particle"}], "]"}], "]"}], "==", 
            "2"}], ",", "\"\<False\>\"", ",", "\"\<True\>\""}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"particle", "=", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"IfPresent", "==", "\"\<True\>\""}], ",", "Particle", ",", 
           
           RowBox[{"SimilarParticle", "[", 
            RowBox[{"Facility", ",", "Particle"}], "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"data", "=", 
         RowBox[{"DataDistr", "[", 
          RowBox[{"Facility", ",", "particle"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Option", " ", 
           RowBox[{"IfTwo", ":", " ", 
            RowBox[{"if", " ", "\"\<True\>\""}]}]}], ",", " ", 
          RowBox[{
          "then", " ", "the", " ", "mother", " ", "particle", " ", "is", " ", 
           "supposed", " ", "to", " ", "decay", " ", "into", " ", "two", " ", 
           
           RowBox[{"LLPs", ".", " ", "If"}], " ", "\"\<False\>\""}], ",", " ", 
          RowBox[{
          "then", " ", "it", " ", "will", " ", "produce", " ", "only", " ", 
           "one", " ", "LLP"}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"If", " ", "\"\<True\>\""}], ",", " ", 
          RowBox[{"then", " ", 
           RowBox[{
            SubscriptBox["N", "events"], "/", "2"}], " ", "mother", " ", 
           "particles", " ", "will", " ", "be", " ", "sampled"}], ",", " ", 
          RowBox[{
          "and", " ", "then", " ", "the", " ", "data", " ", "will", " ", "be",
            " ", "doubled"}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"Nev", "=", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"IfTwo", "==", "\"\<True\>\""}], ",", 
           FractionBox["Nevents", "2"], ",", "Nevents"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"datafin", "=", 
         RowBox[{"BlockPointsFromSmoothDistribution1", "[", 
          RowBox[{"data", ",", 
           RowBox[{"mSM", "[", "particle", "]"}], ",", "Nev", ",", "9", ",", 
           "Facility"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"IfTwo", "==", "\"\<True\>\""}], ",", 
          RowBox[{"datafin", "=", 
           RowBox[{"Riffle", "[", 
            RowBox[{"datafin", ",", "datafin"}], "]"}]}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"particle", "!=", "Particle"}], ",", 
          RowBox[{"datafin", "=", 
           RowBox[{"DataConverted", "[", 
            RowBox[{"datafin", ",", 
             RowBox[{"mSM", "[", "Particle", "]"}]}], "]"}]}], ",", 
          "datafin"}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", "datafin"}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.9132214623446712`*^9, 3.913221476903121*^9}, {
   3.913221602854893*^9, 3.913221658174044*^9}, {3.9132216961880336`*^9, 
   3.913221697991794*^9}, {3.913221730861147*^9, 3.913222028594967*^9}, {
   3.913222080440143*^9, 3.913222087962355*^9}, {3.913222120855889*^9, 
   3.913222389117504*^9}, {3.913222443249443*^9, 3.9132224434095573`*^9}, {
   3.9132228671467404`*^9, 3.913222867271918*^9}, {3.913223365195081*^9, 
   3.913223517148328*^9}, {3.913223748961215*^9, 3.913223762354862*^9}, {
   3.913261623833496*^9, 3.9132617795253515`*^9}, {3.91326195456222*^9, 
   3.913262015585236*^9}, {3.91326968750252*^9, 3.9132696964527335`*^9}, {
   3.913368023830302*^9, 3.913368031484419*^9}, 3.913449172405038*^9, 
   3.913887709872455*^9, {3.9144894651298323`*^9, 3.914489472002014*^9}, {
   3.914831380188117*^9, 3.914831473630134*^9}, {3.914831618113033*^9, 
   3.914831663384596*^9}, {3.914831705535822*^9, 3.914831804779361*^9}, {
   3.9148318500151596`*^9, 3.914831887646638*^9}, {3.914833863935631*^9, 
   3.914833928637499*^9}, {3.915438799591983*^9, 3.915438799595004*^9}, 
   3.915703436151754*^9, {3.91570543956771*^9, 3.915705483718461*^9}, 
   3.915705858887656*^9, 3.915705998584048*^9, {3.916331592367295*^9, 
   3.916331621837404*^9}, {3.930989993227909*^9, 3.930990026503811*^9}},
 CellTags->
  "Evaluation",ExpressionUUID->"b82b39d0-f01e-440a-b4d1-dc5e7ce1ccbf"],

Cell[BoxData[
 FormBox[
  RowBox[{"{", 
   RowBox[{"True", ",", "False"}], "}"}], TraditionalForm]], "Output",
 CellChangeTimes->{3.930211456460861*^9, 3.930822682792232*^9},
 CellTags->"Evaluation",
 CellLabel->
  "Out[789]=",ExpressionUUID->"2bba2473-dac8-4dbb-ba25-36668b0f82d1"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Test", "Section",
 CellChangeTimes->{{3.9132224116825085`*^9, 3.9132224122060623`*^9}},
 CellTags->
  "Evaluation",ExpressionUUID->"390f4661-3512-4be2-86d0-5fc0e3625611"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"factest", "=", "\"\<Serpukhov\>\""}], ";", "\[IndentingNewLine]", 
   
   RowBox[{"ptest", "=", "\"\<EtaPr\>\""}], ";", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Length", "[", 
        RowBox[{"DataDistr", "[", 
         RowBox[{"factest", ",", "ptest"}], "]"}], "]"}], "!=", "2"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"pts", "=", 
        RowBox[{"PointsSampler", "[", 
         RowBox[{"factest", ",", "ptest", ",", 
          SuperscriptBox["10", "6"], ",", "\"\<False\>\""}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"MotherInterpolation", "[", 
        RowBox[{"factest", ",", "ptest"}], "]"}], ";", "\[IndentingNewLine]", 
       
       RowBox[{"angdistrIntDat", "=", 
        RowBox[{"With", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"thmin", "=", 
             RowBox[{
              RowBox[{"\[Theta]MinMax", "[", 
               RowBox[{"factest", ",", "ptest"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], ",", 
            RowBox[{"thmax", "=", 
             RowBox[{
              RowBox[{"\[Theta]MinMax", "[", 
               RowBox[{"factest", ",", "ptest"}], "]"}], "[", 
              RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}], ",", 
          RowBox[{"ParallelTable", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              SuperscriptBox["10", "x"], ",", 
              RowBox[{"Quiet", "[", 
               RowBox[{"NIntegrate", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"DoubleDistrMotherInt", "[", 
                   RowBox[{
                    SuperscriptBox["10", "x"], ",", 
                    RowBox[{"Exp", "[", "e", "]"}], ",", "factest", ",", 
                    "ptest"}], "]"}], 
                  RowBox[{"Exp", "[", "e", "]"}]}], ",", 
                 RowBox[{"{", 
                  RowBox[{"e", ",", 
                   RowBox[{"Log", "[", 
                    RowBox[{
                    RowBox[{"pts", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "4"}], "]"}], "]"}], "//", "Min"}], 
                    "]"}], ",", 
                   RowBox[{"Log", "[", 
                    RowBox[{
                    RowBox[{"pts", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "4"}], "]"}], "]"}], "//", "Max"}], 
                    "]"}]}], "}"}], ",", 
                 RowBox[{
                 "Method", "->", "\"\<InterpolationPointsSubdivision\>\""}]}],
                 "]"}], "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"x", ",", 
              RowBox[{"Log10", "[", "thmin", "]"}], ",", 
              RowBox[{"Log10", "[", "thmax", "]"}], ",", 
              FractionBox[
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Log10", "[", "thmax", "]"}], "-", 
                 RowBox[{"Log10", "[", "thmin", "]"}]}], ")"}], "100"]}], 
             "}"}]}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"angdistrInt", "[", "\[Theta]X_", "]"}], "=", 
        RowBox[{
         RowBox[{"Interpolation", "[", 
          RowBox[{"angdistrIntDat", ",", 
           RowBox[{"InterpolationOrder", "->", "1"}]}], "]"}], "[", 
         "\[Theta]X", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"norm1", "=", 
        RowBox[{"NIntegrate", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"angdistrInt", "[", 
            RowBox[{"Exp", "[", "x", "]"}], "]"}], 
           RowBox[{"Exp", "[", "x", "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"x", ",", 
            RowBox[{"Log", "[", 
             RowBox[{"Min", "[", 
              RowBox[{"PTS", "[", 
               RowBox[{"[", 
                RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}], "]"}], ",", 
            RowBox[{"Log", "[", 
             RowBox[{"Max", "[", 
              RowBox[{"PTS", "[", 
               RowBox[{"[", 
                RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}], "]"}]}], 
           "}"}], ",", 
          RowBox[{
          "Method", "->", "\"\<InterpolationPointsSubdivision\>\""}]}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"thvs", "=", 
        RowBox[{"\[Theta]Nlist", "[", "factest", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"angles", "=", 
        RowBox[{"PTS", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "1"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"bns", "=", 
        RowBox[{"BinCounts", "[", 
         RowBox[{"angles", ",", 
          RowBox[{"{", "thvs", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"tabpdf", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Log", "[", 
             FractionBox[
              RowBox[{
               RowBox[{"thvs", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "+", 
               RowBox[{"thvs", "[", 
                RowBox[{"[", 
                 RowBox[{"i", "+", "1"}], "]"}], "]"}]}], "2"], "]"}], ",", 
            RowBox[{"Log", "[", 
             RowBox[{"Max", "[", 
              RowBox[{
               SuperscriptBox["10", 
                RowBox[{"-", "90."}]], ",", 
               FractionBox[
                RowBox[{"bns", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"thvs", "[", 
                   RowBox[{"[", 
                    RowBox[{"i", "+", "1"}], "]"}], "]"}], "-", 
                  RowBox[{"thvs", "[", 
                   RowBox[{"[", "i", "]"}], "]"}]}], ")"}]]}], "]"}], "]"}]}],
            "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{
             RowBox[{"Length", "[", "thvs", "]"}], "-", "1"}], ",", "1"}], 
           "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"pdfint", "[", "x_", "]"}], "=", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Min", "[", 
            RowBox[{"PTS", "[", 
             RowBox[{"[", 
              RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}], "<=", "x", "<=", 
           RowBox[{"Max", "[", 
            RowBox[{"PTS", "[", 
             RowBox[{"[", 
              RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}]}], ",", 
          RowBox[{"Evaluate", "[", 
           RowBox[{"Exp", "[", 
            RowBox[{
             RowBox[{"Interpolation", "[", 
              RowBox[{"tabpdf", ",", 
               RowBox[{"InterpolationOrder", "->", "1"}]}], "]"}], "[", 
             RowBox[{"Log", "[", "x", "]"}], "]"}], "]"}], "]"}], ",", "0."}],
          "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"norm2", "=", 
        RowBox[{"Quiet", "[", 
         RowBox[{"NIntegrate", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"pdfint", "[", 
             RowBox[{"Exp", "[", "x", "]"}], "]"}], 
            RowBox[{"Exp", "[", "x", "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"x", ",", 
             RowBox[{"Log", "[", 
              RowBox[{"Min", "[", 
               RowBox[{"PTS", "[", 
                RowBox[{"[", 
                 RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}], "]"}], ",", 
             RowBox[{"Log", "[", 
              RowBox[{"Max", "[", 
               RowBox[{"PTS", "[", 
                RowBox[{"[", 
                 RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}], "]"}]}], 
            "}"}], ",", 
           RowBox[{
           "Method", "->", "\"\<InterpolationPointsSubdivision\>\""}]}], 
          "]"}], "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], "//", 
    RowBox[{"AbsoluteTiming", "\[IndentingNewLine]", 
     RowBox[{"Quiet", "[", 
      RowBox[{"{", 
       RowBox[{
        FractionBox[
         RowBox[{"NIntegrate", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"pdfint", "[", "x", "]"}], "x"}], ",", 
           RowBox[{"{", 
            RowBox[{"x", ",", 
             SuperscriptBox["10", 
              RowBox[{"-", "5"}]], ",", 
             FractionBox["Pi", "2"]}], "}"}]}], "]"}], 
         RowBox[{"NIntegrate", "[", 
          RowBox[{
           RowBox[{"pdfint", "[", "x", "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"x", ",", 
             SuperscriptBox["10", 
              RowBox[{"-", "5"}]], ",", 
             FractionBox["Pi", "2"]}], "}"}]}], "]"}]], ",", 
        FractionBox[
         RowBox[{"NIntegrate", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"angdistrInt", "[", 
             RowBox[{"Exp", "[", "x", "]"}], "]"}], 
            RowBox[{"Exp", "[", 
             RowBox[{"2", "x"}], "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"x", ",", 
             RowBox[{"Log", "[", 
              RowBox[{"Min", "[", 
               RowBox[{"PTS", "[", 
                RowBox[{"[", 
                 RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}], "]"}], ",", 
             RowBox[{"Min", "[", 
              RowBox[{
               FractionBox["Pi", "2"], ",", 
               RowBox[{"Log", "[", 
                RowBox[{"Max", "[", 
                 RowBox[{"PTS", "[", 
                  RowBox[{"[", 
                   RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}], "]"}]}], 
              "]"}]}], "}"}]}], "]"}], 
         RowBox[{"NIntegrate", "[", 
          RowBox[{
           RowBox[{"angdistrInt", "[", 
            RowBox[{"Exp", "[", "x", "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"x", ",", 
             RowBox[{"Log", "[", 
              RowBox[{"Min", "[", 
               RowBox[{"PTS", "[", 
                RowBox[{"[", 
                 RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}], "]"}], ",", 
             RowBox[{"Min", "[", 
              RowBox[{
               FractionBox["Pi", "2"], ",", 
               RowBox[{"Log", "[", 
                RowBox[{"Max", "[", 
                 RowBox[{"PTS", "[", 
                  RowBox[{"[", 
                   RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}], "]"}]}], 
              "]"}]}], "}"}]}], "]"}]]}], "}"}], "]"}], "\[IndentingNewLine]", 
     RowBox[{"Quiet", "[", 
      RowBox[{"LogLogPlot", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           FractionBox["1", "norm1"], 
           FractionBox[
            RowBox[{"angdistrInt", "[", "x", "]"}], "x"]}], ",", 
          RowBox[{
           FractionBox["1", "norm2"], 
           FractionBox[
            RowBox[{"pdfint", "[", "x", "]"}], "x"]}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", 
          SuperscriptBox["10", 
           RowBox[{"-", "5."}]], ",", 
          FractionBox["Pi", "2"]}], "}"}]}], "]"}], "]"}]}]}]}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.913222419159642*^9, 3.9132226911806145`*^9}, {
   3.913222926022428*^9, 3.9132229493744926`*^9}, {3.913223021063165*^9, 
   3.9132230212470293`*^9}, {3.913223060219344*^9, 3.913223125854771*^9}, {
   3.9132232558149805`*^9, 3.913223270526924*^9}, {3.913223311520055*^9, 
   3.913223312866059*^9}, {3.913223536325856*^9, 3.913223536646686*^9}, {
   3.9132235722174187`*^9, 3.913223642784997*^9}, {3.9132237301702237`*^9, 
   3.913223731154639*^9}, {3.913224415566942*^9, 3.9132244209412565`*^9}, {
   3.913224462539878*^9, 3.913224465465001*^9}, {3.913224618748373*^9, 
   3.9132246500065746`*^9}, {3.91322468792672*^9, 3.9132246891281567`*^9}, {
   3.913224728875929*^9, 3.913224729409983*^9}, 3.9132247975849686`*^9, {
   3.913224858907186*^9, 3.9132248903230743`*^9}, {3.913226399995117*^9, 
   3.9132264566046944`*^9}, {3.9132265651346493`*^9, 3.913226565854848*^9}, {
   3.913226677256049*^9, 3.913226705166434*^9}, {3.913227017134261*^9, 
   3.913227026614871*^9}, {3.9132270716178846`*^9, 3.913227078704997*^9}, 
   3.91322724495176*^9, {3.913227284395825*^9, 3.913227284684663*^9}, {
   3.913227330448598*^9, 3.9132273310609283`*^9}, {3.913227375105749*^9, 
   3.913227376184673*^9}, {3.9132602651306515`*^9, 3.91326028253248*^9}, {
   3.913260407618323*^9, 3.9132604373798275`*^9}, {3.9132605324267397`*^9, 
   3.913260532628066*^9}, {3.913260663290922*^9, 3.9132606636133366`*^9}, {
   3.9132607289222555`*^9, 3.9132607544772635`*^9}, {3.913260788576293*^9, 
   3.913260795276429*^9}, {3.913260830370474*^9, 3.91326097642526*^9}, {
   3.91326109951063*^9, 3.913261119446557*^9}, {3.913261196897052*^9, 
   3.9132612155556726`*^9}, {3.913261264930546*^9, 3.9132612910279055`*^9}, {
   3.913261359235361*^9, 3.913261392026753*^9}, {3.9132614644183073`*^9, 
   3.913261464913422*^9}, {3.913281228524306*^9, 3.913281231030325*^9}, 
   3.913286311123146*^9, 3.913887719546791*^9, {3.917947271744625*^9, 
   3.9179472777701645`*^9}, 3.917947553918462*^9, {3.917947631970441*^9, 
   3.917947632104694*^9}, {3.917947711716378*^9, 3.917947711860165*^9}, {
   3.917948231406792*^9, 3.9179482337296243`*^9}, {3.9181463836496377`*^9, 
   3.918146396458135*^9}, {3.918146520471339*^9, 3.918146524068757*^9}},
 CellTags->"Evaluation",
 CellLabel->
  "In[796]:=",ExpressionUUID->"f067bd9f-1c0a-4be7-aa46-c364af47de64"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Preliminary code: LLP production phenomenology", "Title",
 CellChangeTimes->{{3.913268588535722*^9, 3.9132685930056963`*^9}, 
   3.9137149002468576`*^9, 3.915438799609787*^9},
 CellTags->
  "Evaluation",ExpressionUUID->"b7431e4b-8fd3-4b39-abd9-5de880c5126c"],

Cell[CellGroupData[{

Cell["Preliminary definitions", "Chapter",
 CellChangeTimes->{{3.91326912271598*^9, 3.9132691273359776`*^9}},
 CellTags->
  "Evaluation",ExpressionUUID->"cb022232-9785-4115-9e3d-4db1fdd7c520"],

Cell[CellGroupData[{

Cell[TextData[{
 "Kinematics of 3-body decays in terms of energies ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["E", "1"], ",", 
    SubscriptBox["E", "3"]}], TraditionalForm]],ExpressionUUID->
  "334ab4bc-550b-4e40-9ff1-594af8d7b71f"]
}], "Section",
 CellChangeTimes->{{3.877714719683569*^9, 3.877714752724095*^9}, {
  3.877714838420583*^9, 3.8777148390018888`*^9}},
 CellTags->
  "Evaluation",ExpressionUUID->"91a14f45-0875-4e85-a61d-49cc362d42eb"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Kinematics", " ", "of", " ", "3"}], "-", 
    RowBox[{"body", " ", "decays"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"pPar", "[", 
      RowBox[{"En_", ",", "mn_"}], "]"}], "=", 
     RowBox[{"\[Sqrt]", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["En", "2"], "-", 
        SuperscriptBox["mn", "2"]}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{
     RowBox[{"E2valEnergies", "[", 
      RowBox[{"m_", ",", "E1_", ",", "E3_"}], "]"}], "=", 
     RowBox[{"m", "-", "E1", "-", "E3"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"cos", " ", "between", " ", "particles", " ", "1"}], ",", 
     RowBox[{"2", " ", "and", " ", "1"}], ",", 
     RowBox[{
      RowBox[{
      "3", " ", "at", " ", "rest", " ", "frame", " ", "of", " ", "decaying", 
       " ", "particle", " ", "0"}], " ", "\[Rule]", " ", 
      RowBox[{"1", "+", "2", "+", 
       RowBox[{
       "3", " ", "parametrized", " ", "in", " ", "terms", " ", "of", " ", 
        SubscriptBox["E", "1"]}]}]}], ",", 
     SubscriptBox["E", "3"]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"For", " ", "example"}], ",", " ", 
     RowBox[{
      RowBox[{"cos", 
       RowBox[{"(", 
        SubscriptBox["\[Theta]", "12"], ")"}]}], " ", "=", " ", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          FractionBox[
           RowBox[{
            SubscriptBox[
             OverscriptBox["p", "_"], "1"], "*", 
            SubscriptBox[
             OverscriptBox["p", "_"], "2"]}], 
           RowBox[{"|", 
            RowBox[{
             SubscriptBox["p", "1"], "||", 
             SubscriptBox["p", "2"]}], "|"}]], ".", " ", "We"}], " ", "have", 
         " ", 
         SubscriptBox[
          OverscriptBox["p", "_"], "1"]}], "+", 
        SubscriptBox[
         OverscriptBox["p", "_"], "2"], "+", 
        SubscriptBox[
         OverscriptBox["p", "_"], "3"]}], " ", "=", " ", "0"}]}], ",", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"or", " ", 
        SubscriptBox[
         SuperscriptBox[
          OverscriptBox["p", "_"], "2"], "1"]}], "+", 
       SubscriptBox[
        SuperscriptBox[
         OverscriptBox["p", "_"], "2"], "2"], "+", 
       RowBox[{"2", 
        SubscriptBox[
         OverscriptBox["p", "_"], "1"], "*", 
        SubscriptBox[
         OverscriptBox["p", "_"], "2"]}]}], " ", "=", " ", 
      RowBox[{
       SubscriptBox[
        SuperscriptBox[
         OverscriptBox["p", "_"], "2"], "3"], " ", "=", " ", 
       RowBox[{
        SubscriptBox[
         SuperscriptBox["E", "2"], "3"], "-", 
        SubscriptBox[
         SuperscriptBox["m", "2"], "3"]}]}]}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"cos\[Theta]12", "[", 
      RowBox[{
      "E1_", ",", "E3_", ",", "m_", ",", "m1_", ",", "m2_", ",", "m3_"}], 
      "]"}], "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"pPar", "[", 
          RowBox[{"E3", ",", "m3"}], "]"}], "2"], "-", 
        SuperscriptBox[
         RowBox[{"pPar", "[", 
          RowBox[{"E1", ",", "m1"}], "]"}], "2"], "-", 
        SuperscriptBox[
         RowBox[{"pPar", "[", 
          RowBox[{
           RowBox[{"E2valEnergies", "[", 
            RowBox[{"m", ",", "E1", ",", "E3"}], "]"}], ",", "m2"}], "]"}], 
         "2"]}], ")"}], "/", 
      RowBox[{"(", 
       RowBox[{"2", 
        RowBox[{"pPar", "[", 
         RowBox[{"E1", ",", "m1"}], "]"}], "*", 
        RowBox[{"pPar", "[", 
         RowBox[{
          RowBox[{"E2valEnergies", "[", 
           RowBox[{"m", ",", "E1", ",", "E3"}], "]"}], ",", "m2"}], "]"}]}], 
       ")"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"cos\[Theta]13", "[", 
      RowBox[{
      "E1_", ",", "E3_", ",", "m_", ",", "m1_", ",", "m2_", ",", "m3_"}], 
      "]"}], "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"pPar", "[", 
          RowBox[{
           RowBox[{"E2valEnergies", "[", 
            RowBox[{"m", ",", "E1", ",", "E3"}], "]"}], ",", "m2"}], "]"}], 
         "2"], "-", 
        SuperscriptBox[
         RowBox[{"pPar", "[", 
          RowBox[{"E1", ",", "m1"}], "]"}], "2"], "-", 
        SuperscriptBox[
         RowBox[{"pPar", "[", 
          RowBox[{"E3", ",", "m3"}], "]"}], "2"]}], ")"}], "/", 
      RowBox[{"(", 
       RowBox[{"2", 
        RowBox[{"pPar", "[", 
         RowBox[{"E1", ",", "m1"}], "]"}], "*", 
        RowBox[{"pPar", "[", 
         RowBox[{"E3", ",", "m3"}], "]"}]}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Theta]12", "[", 
      RowBox[{
      "E1_", ",", "E3_", ",", "m_", ",", "m1_", ",", "m2_", ",", "m3_"}], 
      "]"}], "=", 
     RowBox[{"ArcCos", "[", 
      RowBox[{"cos\[Theta]12", "[", 
       RowBox[{"E1", ",", "E3", ",", "m", ",", "m1", ",", "m2", ",", "m3"}], 
       "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Theta]13", "[", 
      RowBox[{
      "E1_", ",", "E3_", ",", "m_", ",", "m1_", ",", "m2_", ",", "m3_"}], 
      "]"}], "=", 
     RowBox[{"ArcCos", "[", 
      RowBox[{"cos\[Theta]13", "[", 
       RowBox[{"E1", ",", "E3", ",", "m", ",", "m1", ",", "m2", ",", "m3"}], 
       "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Domain", " ", "of", " ", "definition", " ", "of", " ", 
      SubscriptBox["E", "1"], " ", "and", " ", 
      SubscriptBox["E", "3"], " ", "in", " ", "decay", " ", "0"}], "\[Rule]", 
     
     RowBox[{"1", "+", "2", "+", 
      RowBox[{
      "3", " ", "at", " ", "rest", " ", "frame", " ", "of", " ", "0"}]}]}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"E3domain", "[", 
     RowBox[{"E1_", ",", "m_", ",", "m1_", ",", "m2_", ",", "m3_"}], "]"}], 
    "=", 
    RowBox[{"E3", "/.", 
     RowBox[{"Simplify", "[", 
      RowBox[{"Solve", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"cos\[Theta]12", "[", 
          RowBox[{
          "E1", ",", "E3", ",", "m", ",", "m1", ",", "m2", ",", "m3"}], "]"}],
          "\[Equal]", "1"}], ",", "E3"}], "]"}], "]"}]}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"E3domain1", "[", 
      RowBox[{"E1_", ",", "m_", ",", "m1_", ",", "m2_", ",", "m3_"}], "]"}], 
     "=", 
     RowBox[{
      RowBox[{"E3domain", "[", 
       RowBox[{"E1", ",", "m", ",", "m1", ",", "m2", ",", "m3"}], "]"}], "[", 
      
      RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"E3domain2", "[", 
      RowBox[{"E1_", ",", "m_", ",", "m1_", ",", "m2_", ",", "m3_"}], "]"}], 
     "=", 
     RowBox[{
      RowBox[{"E3domain", "[", 
       RowBox[{"E1", ",", "m", ",", "m1", ",", "m2", ",", "m3"}], "]"}], "[", 
      
      RowBox[{"[", "2", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[CapitalDelta]E3", "[", 
     RowBox[{"E1_", ",", "m_", ",", "m1_", ",", "m2_", ",", "m3_"}], "]"}], 
    "=", 
    RowBox[{
     RowBox[{
      RowBox[{"E3domain2", "[", 
       RowBox[{"E1", ",", "m", ",", "m1", ",", "m2", ",", "m3"}], "]"}], "-", 
      
      RowBox[{"E3domain1", "[", 
       RowBox[{"E1", ",", "m", ",", "m1", ",", "m2", ",", "m3"}], "]"}]}], "//",
      "Simplify"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"E1domainMin", "[", 
       RowBox[{"m_", ",", "m1_", ",", "m2_", ",", "m3_"}], "]"}], ",", 
      RowBox[{"E1domainMax", "[", 
       RowBox[{"m_", ",", "m1_", ",", "m2_", ",", "m3_"}], "]"}]}], "}"}], 
    "=", 
    RowBox[{
     RowBox[{"E1domain", "[", 
      RowBox[{"m_", ",", "m1_", ",", "m2_", ",", "m3_"}], "]"}], "=", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"E1", "/.", 
         RowBox[{
          RowBox[{"Solve", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"\[CapitalDelta]E3", "[", 
              RowBox[{"E1", ",", "m", ",", "m1", ",", "m2", ",", "m3"}], 
              "]"}], "\[Equal]", "0"}], ",", "E1"}], "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ",", 
        RowBox[{"E1", "/.", 
         RowBox[{
          RowBox[{"Solve", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"\[CapitalDelta]E3", "[", 
              RowBox[{"E1", ",", "m", ",", "m1", ",", "m2", ",", "m3"}], 
              "]"}], "\[Equal]", "0"}], ",", "E1"}], "]"}], "[", 
          RowBox[{"[", "3", "]"}], "]"}]}]}], "}"}], "//", "Simplify"}]}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Domain", " ", "of", " ", "definition", " ", "of", " ", 
      SubscriptBox["E", "1"], " ", "and", " ", 
      SubscriptBox["E", "3"], " ", "in", " ", "decay", " ", "0"}], "\[Rule]", 
     
     RowBox[{"1", "+", "2", "+", 
      RowBox[{
      "3", " ", "at", " ", "rest", " ", "frame", " ", "of", " ", "0"}], " ", 
      "-", " ", 
      RowBox[{
       SubscriptBox["E", "3"], " ", "is", " ", "main", " ", "function"}]}]}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"E1domain1", "[", 
     RowBox[{"E3_", ",", "m_", ",", "m1_", ",", "m2_", ",", "m3_"}], "]"}], 
    "=", 
    RowBox[{
     RowBox[{"E1", "/.", 
      RowBox[{"Simplify", "[", 
       RowBox[{"Solve", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"cos\[Theta]12", "[", 
           RowBox[{
           "E1", ",", "E3", ",", "m", ",", "m1", ",", "m2", ",", "m3"}], 
           "]"}], "\[Equal]", "1"}], ",", "E1"}], "]"}], "]"}]}], "//", 
     "Simplify"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"E3domain1", "[", 
     RowBox[{"m_", ",", "m1_", ",", "m2_", ",", "m3_"}], "]"}], "=", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"E3", "/.", 
        RowBox[{
         RowBox[{"Solve", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"E1domain1", "[", 
               RowBox[{"E3", ",", "m", ",", "m1", ",", "m2", ",", "m3"}], 
               "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}], "-", 
             RowBox[{
              RowBox[{"E1domain1", "[", 
               RowBox[{"E3", ",", "m", ",", "m1", ",", "m2", ",", "m3"}], 
               "]"}], "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], "\[Equal]", "0"}], ",", 
           "E3"}], "]"}], "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], ",", 
       RowBox[{"E3", "/.", 
        RowBox[{
         RowBox[{"Solve", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"E1domain1", "[", 
               RowBox[{"E3", ",", "m", ",", "m1", ",", "m2", ",", "m3"}], 
               "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}], "-", 
             RowBox[{
              RowBox[{"E1domain1", "[", 
               RowBox[{"E3", ",", "m", ",", "m1", ",", "m2", ",", "m3"}], 
               "]"}], "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], "\[Equal]", "0"}], ",", 
           "E3"}], "]"}], "[", 
         RowBox[{"[", "3", "]"}], "]"}]}]}], "}"}], "//", "Simplify"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"Mandelstam", " ", "invariants", " ", 
       SubscriptBox["m", "ij"]}], " ", "=", " ", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          SubscriptBox["p", "i"], "+", 
          SubscriptBox["p", "j"]}], ")"}], "2"], " ", "in", " ", "terms", " ",
        "of", " ", 
       SubscriptBox["E", "1"]}]}], ",", 
     SubscriptBox["E", "3"]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"M13", "[", 
     RowBox[{"E1_", ",", "E3_"}], "]"}], "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"E1", "+", "E3"}], ")"}], "2"], "-", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"pPar", "[", 
           RowBox[{"E1", ",", "m1"}], "]"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{"pPar", "[", 
           RowBox[{"E3", ",", "m3"}], "]"}], "2"], "+", 
         RowBox[{"2", "*", 
          RowBox[{"pPar", "[", 
           RowBox[{"E1", ",", "m1"}], "]"}], "*", 
          RowBox[{"pPar", "[", 
           RowBox[{"E3", ",", "m3"}], "]"}], "*", 
          RowBox[{"cos\[Theta]13", "[", 
           RowBox[{
           "E1", ",", "E3", ",", "m", ",", "m1", ",", "m2", ",", "m3"}], 
           "]"}]}]}], ")"}]}], "//", "Expand"}], "//", "Simplify"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"M12", "[", 
     RowBox[{"E1_", ",", "E3_"}], "]"}], "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"E1", "+", 
          RowBox[{"E2valEnergies", "[", 
           RowBox[{"m", ",", "E1", ",", "E3"}], "]"}]}], ")"}], "2"], "-", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"pPar", "[", 
           RowBox[{"E1", ",", "m1"}], "]"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{"pPar", "[", 
           RowBox[{
            RowBox[{"E2valEnergies", "[", 
             RowBox[{"m", ",", "E1", ",", "E3"}], "]"}], ",", "m2"}], "]"}], 
          "2"], "+", 
         RowBox[{"2", "*", 
          RowBox[{"pPar", "[", 
           RowBox[{"E1", ",", "m1"}], "]"}], "*", 
          RowBox[{"pPar", "[", 
           RowBox[{
            RowBox[{"E2valEnergies", "[", 
             RowBox[{"m", ",", "E1", ",", "E3"}], "]"}], ",", "m2"}], "]"}], 
          "*", 
          RowBox[{"cos\[Theta]12", "[", 
           RowBox[{
           "E1", ",", "E3", ",", "m", ",", "m1", ",", "m2", ",", "m3"}], 
           "]"}]}]}], ")"}]}], "//", "Expand"}], "//", "Simplify"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Q2", "[", 
      RowBox[{"E1_", ",", "E3_", ",", "m_", ",", "m2_"}], "]"}], "=", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["m", "2"], "+", 
       SuperscriptBox["m2", "2"], "-", 
       RowBox[{"2", "*", "m", "*", 
        RowBox[{"E2valEnergies", "[", 
         RowBox[{"m", ",", "E1", ",", "E3"}], "]"}]}]}], ")"}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.8662192582435064`*^9, 3.866219258258467*^9}, {
   3.866610001675725*^9, 3.866610002626925*^9}, {3.8666139006159744`*^9, 
   3.866613933490678*^9}, {3.8853535562123837`*^9, 3.885353557612751*^9}, {
   3.8887405071384497`*^9, 3.888740584282306*^9}, {3.888740638766884*^9, 
   3.888740771746767*^9}, {3.9148477593406544`*^9, 3.914847871334637*^9}, {
   3.915604605929728*^9, 3.915604606200946*^9}, 3.915615040431594*^9, {
   3.915615071104752*^9, 3.915615074720667*^9}, {3.915616002259867*^9, 
   3.915616035723566*^9}},
 CellTags->"Evaluation",
 CellLabel->
  "In[797]:=",ExpressionUUID->"53a6dfba-6611-4b8e-874f-a8a4e369b2f2"],

Cell[BoxData[
 FormBox[
  TemplateBox[{
   "Solve", "nongen", 
    "\"There may be values of the parameters for which some or all solutions \
are not valid.\"", 2, 803, 17, 29079336519732941073, "Local"},
   "MessageTemplate"], TraditionalForm]], "Message", "MSG",
 CellChangeTimes->{3.9302114567095613`*^9, 3.930822683085314*^9},
 CellTags->"Evaluation",
 CellLabel->
  "Durante la evaluaci\[OAcute]n de \
In[797]:=",ExpressionUUID->"1779dff2-a3e0-4a0f-883c-e65ea594844a"],

Cell[BoxData[
 FormBox[
  RowBox[{"{", 
   RowBox[{
    FractionBox[
     RowBox[{
      SqrtBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["E1", "2"], "-", 
          SuperscriptBox["m1", "2"]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"4", " ", 
           SuperscriptBox["E1", "2"], " ", 
           SuperscriptBox["m", "2"]}], "-", 
          RowBox[{"4", " ", "E1", " ", "m", " ", 
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["m", "2"], "+", 
             SuperscriptBox["m1", "2"], "-", 
             SuperscriptBox["m2", "2"], "-", 
             SuperscriptBox["m3", "2"]}], ")"}]}], "+", 
          SuperscriptBox["m", "4"], "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["m", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["m1", "2"], "-", 
             SuperscriptBox["m2", "2"], "-", 
             SuperscriptBox["m3", "2"]}], ")"}]}], "+", 
          SuperscriptBox["m1", "4"], "-", 
          RowBox[{"2", " ", 
           SuperscriptBox["m1", "2"], " ", 
           SuperscriptBox["m2", "2"]}], "-", 
          RowBox[{"2", " ", 
           SuperscriptBox["m1", "2"], " ", 
           SuperscriptBox["m3", "2"]}], "+", 
          SuperscriptBox["m2", "4"], "-", 
          RowBox[{"2", " ", 
           SuperscriptBox["m2", "2"], " ", 
           SuperscriptBox["m3", "2"]}], "+", 
          SuperscriptBox["m3", "4"]}], ")"}]}]], "-", 
      RowBox[{"2", " ", 
       SuperscriptBox["E1", "2"], " ", "m"}], "+", 
      RowBox[{"3", " ", "E1", " ", 
       SuperscriptBox["m", "2"]}], "+", 
      RowBox[{"E1", " ", 
       SuperscriptBox["m1", "2"]}], "-", 
      RowBox[{"E1", " ", 
       SuperscriptBox["m2", "2"]}], "+", 
      RowBox[{"E1", " ", 
       SuperscriptBox["m3", "2"]}], "-", 
      SuperscriptBox["m", "3"], "-", 
      RowBox[{"m", " ", 
       SuperscriptBox["m1", "2"]}], "+", 
      RowBox[{"m", " ", 
       SuperscriptBox["m2", "2"]}], "-", 
      RowBox[{"m", " ", 
       SuperscriptBox["m3", "2"]}]}], 
     RowBox[{
      RowBox[{"4", " ", "E1", " ", "m"}], "-", 
      RowBox[{"2", " ", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["m", "2"], "+", 
         SuperscriptBox["m1", "2"]}], ")"}]}]}]], ",", 
    RowBox[{"-", 
     FractionBox[
      RowBox[{
       SqrtBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["E1", "2"], "-", 
           SuperscriptBox["m1", "2"]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"4", " ", 
            SuperscriptBox["E1", "2"], " ", 
            SuperscriptBox["m", "2"]}], "-", 
           RowBox[{"4", " ", "E1", " ", "m", " ", 
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["m", "2"], "+", 
              SuperscriptBox["m1", "2"], "-", 
              SuperscriptBox["m2", "2"], "-", 
              SuperscriptBox["m3", "2"]}], ")"}]}], "+", 
           SuperscriptBox["m", "4"], "+", 
           RowBox[{"2", " ", 
            SuperscriptBox["m", "2"], " ", 
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["m1", "2"], "-", 
              SuperscriptBox["m2", "2"], "-", 
              SuperscriptBox["m3", "2"]}], ")"}]}], "+", 
           SuperscriptBox["m1", "4"], "-", 
           RowBox[{"2", " ", 
            SuperscriptBox["m1", "2"], " ", 
            SuperscriptBox["m2", "2"]}], "-", 
           RowBox[{"2", " ", 
            SuperscriptBox["m1", "2"], " ", 
            SuperscriptBox["m3", "2"]}], "+", 
           SuperscriptBox["m2", "4"], "-", 
           RowBox[{"2", " ", 
            SuperscriptBox["m2", "2"], " ", 
            SuperscriptBox["m3", "2"]}], "+", 
           SuperscriptBox["m3", "4"]}], ")"}]}]], "+", 
       RowBox[{"2", " ", 
        SuperscriptBox["E1", "2"], " ", "m"}], "-", 
       RowBox[{"3", " ", "E1", " ", 
        SuperscriptBox["m", "2"]}], "-", 
       RowBox[{"E1", " ", 
        SuperscriptBox["m1", "2"]}], "+", 
       RowBox[{"E1", " ", 
        SuperscriptBox["m2", "2"]}], "-", 
       RowBox[{"E1", " ", 
        SuperscriptBox["m3", "2"]}], "+", 
       SuperscriptBox["m", "3"], "+", 
       RowBox[{"m", " ", 
        SuperscriptBox["m1", "2"]}], "-", 
       RowBox[{"m", " ", 
        SuperscriptBox["m2", "2"]}], "+", 
       RowBox[{"m", " ", 
        SuperscriptBox["m3", "2"]}]}], 
      RowBox[{
       RowBox[{"4", " ", "E1", " ", "m"}], "-", 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["m", "2"], "+", 
          SuperscriptBox["m1", "2"]}], ")"}]}]}]]}]}], "}"}], 
  TraditionalForm]], "Output",
 CellChangeTimes->{3.930211456979627*^9, 3.930822683362712*^9},
 CellTags->"Evaluation",
 CellLabel->
  "Out[803]=",ExpressionUUID->"5943677d-5a12-4a81-ada0-a022e968638e"],

Cell[BoxData[
 FormBox[
  FractionBox[
   SqrtBox[
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["E1", "2"], "-", 
       SuperscriptBox["m1", "2"]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"4", " ", 
        SuperscriptBox["E1", "2"], " ", 
        SuperscriptBox["m", "2"]}], "-", 
       RowBox[{"4", " ", "E1", " ", "m", " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["m", "2"], "+", 
          SuperscriptBox["m1", "2"], "-", 
          SuperscriptBox["m2", "2"], "-", 
          SuperscriptBox["m3", "2"]}], ")"}]}], "+", 
       SuperscriptBox["m", "4"], "+", 
       RowBox[{"2", " ", 
        SuperscriptBox["m", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["m1", "2"], "-", 
          SuperscriptBox["m2", "2"], "-", 
          SuperscriptBox["m3", "2"]}], ")"}]}], "+", 
       SuperscriptBox["m1", "4"], "-", 
       RowBox[{"2", " ", 
        SuperscriptBox["m1", "2"], " ", 
        SuperscriptBox["m2", "2"]}], "-", 
       RowBox[{"2", " ", 
        SuperscriptBox["m1", "2"], " ", 
        SuperscriptBox["m3", "2"]}], "+", 
       SuperscriptBox["m2", "4"], "-", 
       RowBox[{"2", " ", 
        SuperscriptBox["m2", "2"], " ", 
        SuperscriptBox["m3", "2"]}], "+", 
       SuperscriptBox["m3", "4"]}], ")"}]}]], 
   RowBox[{
    RowBox[{"-", 
     RowBox[{"2", " ", "E1", " ", "m"}]}], "+", 
    SuperscriptBox["m", "2"], "+", 
    SuperscriptBox["m1", "2"]}]], TraditionalForm]], "Output",
 CellChangeTimes->{3.930211456979627*^9, 3.9308226834063187`*^9},
 CellTags->"Evaluation",
 CellLabel->
  "Out[806]=",ExpressionUUID->"5bf9de3f-d91a-489f-9996-b49440eaff39"],

Cell[BoxData[
 FormBox[
  RowBox[{"{", 
   RowBox[{"m1", ",", 
    FractionBox[
     RowBox[{
      SuperscriptBox["m", "2"], "+", 
      SuperscriptBox["m1", "2"], "-", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"m2", "+", "m3"}], ")"}], "2"]}], 
     RowBox[{"2", " ", "m"}]]}], "}"}], TraditionalForm]], "Output",
 CellChangeTimes->{3.930211456979627*^9, 3.930822683442786*^9},
 CellTags->"Evaluation",
 CellLabel->
  "Out[807]=",ExpressionUUID->"5ecf5ef1-6ecf-435f-9899-f4245e028911"],

Cell[BoxData[
 FormBox[
  TemplateBox[{
   "Solve", "nongen", 
    "\"There may be values of the parameters for which some or all solutions \
are not valid.\"", 2, 808, 18, 29079336519732941073, "Local"},
   "MessageTemplate"], TraditionalForm]], "Message", "MSG",
 CellChangeTimes->{3.9302114567095613`*^9, 3.930822683617022*^9},
 CellTags->"Evaluation",
 CellLabel->
  "Durante la evaluaci\[OAcute]n de \
In[797]:=",ExpressionUUID->"15883a0a-e5cb-4b2d-9901-83672ac077e2"],

Cell[BoxData[
 FormBox[
  RowBox[{"{", 
   RowBox[{
    FractionBox[
     RowBox[{
      SqrtBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["E3", "2"], "-", 
          SuperscriptBox["m3", "2"]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"4", " ", 
           SuperscriptBox["E3", "2"], " ", 
           SuperscriptBox["m", "2"]}], "-", 
          RowBox[{"4", " ", "E3", " ", "m", " ", 
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["m", "2"], "-", 
             SuperscriptBox["m1", "2"], "-", 
             SuperscriptBox["m2", "2"], "+", 
             SuperscriptBox["m3", "2"]}], ")"}]}], "+", 
          SuperscriptBox["m", "4"], "-", 
          RowBox[{"2", " ", 
           SuperscriptBox["m", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["m1", "2"], "+", 
             SuperscriptBox["m2", "2"], "-", 
             SuperscriptBox["m3", "2"]}], ")"}]}], "+", 
          SuperscriptBox["m1", "4"], "-", 
          RowBox[{"2", " ", 
           SuperscriptBox["m1", "2"], " ", 
           SuperscriptBox["m2", "2"]}], "-", 
          RowBox[{"2", " ", 
           SuperscriptBox["m1", "2"], " ", 
           SuperscriptBox["m3", "2"]}], "+", 
          SuperscriptBox["m2", "4"], "-", 
          RowBox[{"2", " ", 
           SuperscriptBox["m2", "2"], " ", 
           SuperscriptBox["m3", "2"]}], "+", 
          SuperscriptBox["m3", "4"]}], ")"}]}]], "-", 
      RowBox[{"2", " ", 
       SuperscriptBox["E3", "2"], " ", "m"}], "+", 
      RowBox[{"3", " ", "E3", " ", 
       SuperscriptBox["m", "2"]}], "+", 
      RowBox[{"E3", " ", 
       SuperscriptBox["m1", "2"]}], "-", 
      RowBox[{"E3", " ", 
       SuperscriptBox["m2", "2"]}], "+", 
      RowBox[{"E3", " ", 
       SuperscriptBox["m3", "2"]}], "-", 
      SuperscriptBox["m", "3"], "-", 
      RowBox[{"m", " ", 
       SuperscriptBox["m1", "2"]}], "+", 
      RowBox[{"m", " ", 
       SuperscriptBox["m2", "2"]}], "-", 
      RowBox[{"m", " ", 
       SuperscriptBox["m3", "2"]}]}], 
     RowBox[{
      RowBox[{"4", " ", "E3", " ", "m"}], "-", 
      RowBox[{"2", " ", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["m", "2"], "+", 
         SuperscriptBox["m3", "2"]}], ")"}]}]}]], ",", 
    RowBox[{"-", 
     FractionBox[
      RowBox[{
       SqrtBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["E3", "2"], "-", 
           SuperscriptBox["m3", "2"]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"4", " ", 
            SuperscriptBox["E3", "2"], " ", 
            SuperscriptBox["m", "2"]}], "-", 
           RowBox[{"4", " ", "E3", " ", "m", " ", 
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["m", "2"], "-", 
              SuperscriptBox["m1", "2"], "-", 
              SuperscriptBox["m2", "2"], "+", 
              SuperscriptBox["m3", "2"]}], ")"}]}], "+", 
           SuperscriptBox["m", "4"], "-", 
           RowBox[{"2", " ", 
            SuperscriptBox["m", "2"], " ", 
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["m1", "2"], "+", 
              SuperscriptBox["m2", "2"], "-", 
              SuperscriptBox["m3", "2"]}], ")"}]}], "+", 
           SuperscriptBox["m1", "4"], "-", 
           RowBox[{"2", " ", 
            SuperscriptBox["m1", "2"], " ", 
            SuperscriptBox["m2", "2"]}], "-", 
           RowBox[{"2", " ", 
            SuperscriptBox["m1", "2"], " ", 
            SuperscriptBox["m3", "2"]}], "+", 
           SuperscriptBox["m2", "4"], "-", 
           RowBox[{"2", " ", 
            SuperscriptBox["m2", "2"], " ", 
            SuperscriptBox["m3", "2"]}], "+", 
           SuperscriptBox["m3", "4"]}], ")"}]}]], "+", 
       RowBox[{"2", " ", 
        SuperscriptBox["E3", "2"], " ", "m"}], "-", 
       RowBox[{"3", " ", "E3", " ", 
        SuperscriptBox["m", "2"]}], "-", 
       RowBox[{"E3", " ", 
        SuperscriptBox["m1", "2"]}], "+", 
       RowBox[{"E3", " ", 
        SuperscriptBox["m2", "2"]}], "-", 
       RowBox[{"E3", " ", 
        SuperscriptBox["m3", "2"]}], "+", 
       SuperscriptBox["m", "3"], "+", 
       RowBox[{"m", " ", 
        SuperscriptBox["m1", "2"]}], "-", 
       RowBox[{"m", " ", 
        SuperscriptBox["m2", "2"]}], "+", 
       RowBox[{"m", " ", 
        SuperscriptBox["m3", "2"]}]}], 
      RowBox[{
       RowBox[{"4", " ", "E3", " ", "m"}], "-", 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["m", "2"], "+", 
          SuperscriptBox["m3", "2"]}], ")"}]}]}]]}]}], "}"}], 
  TraditionalForm]], "Output",
 CellChangeTimes->{3.930211456979627*^9, 3.930822683910015*^9},
 CellTags->"Evaluation",
 CellLabel->
  "Out[808]=",ExpressionUUID->"baecb409-73d0-42da-b5e7-94dd58f43f72"],

Cell[BoxData[
 FormBox[
  RowBox[{"{", 
   RowBox[{"m3", ",", 
    FractionBox[
     RowBox[{
      SuperscriptBox["m", "2"], "-", 
      SuperscriptBox["m1", "2"], "-", 
      RowBox[{"2", " ", "m1", " ", "m2"}], "-", 
      SuperscriptBox["m2", "2"], "+", 
      SuperscriptBox["m3", "2"]}], 
     RowBox[{"2", " ", "m"}]]}], "}"}], TraditionalForm]], "Output",
 CellChangeTimes->{3.930211456979627*^9, 3.930822683971561*^9},
 CellTags->"Evaluation",
 CellLabel->
  "Out[809]=",ExpressionUUID->"18491e02-6e55-40b9-9e1d-6b085e2ab925"],

Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{"2", " ", "E1", " ", "m"}], "+", 
   RowBox[{"2", " ", "E3", " ", "m"}], "-", 
   SuperscriptBox["m", "2"], "+", 
   SuperscriptBox["m2", "2"]}], TraditionalForm]], "Output",
 CellChangeTimes->{3.930211456979627*^9, 3.93082268397819*^9},
 CellTags->"Evaluation",
 CellLabel->
  "Out[810]=",ExpressionUUID->"bf7b2c58-b780-4477-892d-ac366330dcdc"],

Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{"-", 
    RowBox[{"2", " ", "E3", " ", "m"}]}], "+", 
   SuperscriptBox["m", "2"], "+", 
   SuperscriptBox["m3", "2"]}], TraditionalForm]], "Output",
 CellChangeTimes->{3.930211456979627*^9, 3.9308226839811497`*^9},
 CellTags->"Evaluation",
 CellLabel->
  "Out[811]=",ExpressionUUID->"284a65cb-70dc-4387-85ef-06089727d5a8"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Scalar products for 3-body decays at rest", "Subsection",
 CellChangeTimes->{{3.877714847822746*^9, 3.877714855025713*^9}},
 CellTags->
  "Evaluation",ExpressionUUID->"da999496-62ed-45f4-a17e-11b68f45cddb"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ProductKK", "=", 
   SuperscriptBox["m", "2"]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ProductK2K2", "=", 
   SuperscriptBox["m2", "2"]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ProductK3K3", "=", 
   SuperscriptBox["m3", "2"]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ProductK1K1", "=", 
   SuperscriptBox["m1", "2"]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ProductKK2energy", "=", 
   RowBox[{"m", "*", 
    RowBox[{"E2valEnergies", "[", 
     RowBox[{"m", ",", "E1", ",", "E3"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ProductKK1energy", "=", 
   RowBox[{"m", "*", "E1"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ProductKK3energy", "=", 
   RowBox[{"m", "*", "E3"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ProductK1K3energy", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"M13", "[", 
       RowBox[{"E1", ",", "E3"}], "]"}], "-", 
      SuperscriptBox["m1", "2"], "-", 
      SuperscriptBox["m3", "2"]}], ")"}], "/", "2"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ProductK1K2energy", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"M12", "[", 
       RowBox[{"E1", ",", "E3"}], "]"}], "-", 
      SuperscriptBox["m1", "2"], "-", 
      SuperscriptBox["m2", "2"]}], ")"}], "/", "2"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ProductK2K3energy", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["m", "2"], "+", 
      SuperscriptBox["m1", "2"], "-", 
      RowBox[{"2", "*", "m", "*", "E1"}], "-", 
      SuperscriptBox["m2", "2"], "-", 
      SuperscriptBox["m3", "2"]}], ")"}], "/", "2"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.866213385575988*^9, 3.8662134560507913`*^9}, 
   3.866219258270435*^9, 3.866609936547686*^9, 3.8666100179144545`*^9, {
   3.877690378963705*^9, 3.877690379653573*^9}},
 CellTags->"Evaluation",
 CellLabel->
  "In[813]:=",ExpressionUUID->"6193526c-612d-4041-a81d-d0aed1dec4a4"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Proton bremsstrahlung: limitations, angle-energy grid for the tabulation\
\>", "Section",
 CellChangeTimes->{{3.917161638423164*^9, 3.917161646502606*^9}, {
  3.917161714109037*^9, 3.9171617164457235`*^9}, {3.917164207078197*^9, 
  3.9171642140051765`*^9}},
 CellTags->
  "Evaluation",ExpressionUUID->"fb2d743c-1d47-4f3e-9d37-480a38ea1b24"],

Cell[BoxData["\[Theta]listSmall"], "Input",
 CellChangeTimes->{{3.9289898991670384`*^9, 3.928989919476489*^9}, {
   3.928989973079818*^9, 3.928989989952471*^9}, 3.928990620735523*^9},
 CellLabel->
  "In[939]:=",ExpressionUUID->"66e3f84d-a4f6-4f5b-bf9a-60d76027ac3f"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ApplicabilityParameter", "[", 
     RowBox[{"z_", ",", "pT_", ",", "mV_", ",", "Pp_", ",", "mX_"}], "]"}], 
    "=", 
    FractionBox[
     RowBox[{
      RowBox[{
       SuperscriptBox["mV", "2"], " ", 
       RowBox[{"(", 
        RowBox[{"-", 
         RowBox[{"(", 
          RowBox[{"z", "-", "1"}], ")"}]}], ")"}]}], "+", 
      SuperscriptBox["pT", "2"], "+", 
      RowBox[{
       SuperscriptBox["mX", "2"], " ", 
       SuperscriptBox["z", "2"]}]}], 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"z", "-", "1"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["mV", "2"], "+", 
        RowBox[{"4", " ", 
         SuperscriptBox["Pp", "2"], " ", 
         RowBox[{"(", 
          RowBox[{"z", "-", "1"}], ")"}], " ", "z"}]}], ")"}]}]]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{
     "Limitations", " ", "of", " ", "applicability", " ", "of", " ", "the", 
      " ", "approximation", " ", "used", " ", "to", " ", "derive", " ", "the",
       " ", "bremsstrahlung", " ", 
      RowBox[{"probability", ".", " ", "z"}]}], " ", "=", " ", 
     RowBox[{
      SubscriptBox["E", "LLP"], "/", 
      SubscriptBox["E", "p"]}]}], ",", " ", 
    RowBox[{
     SubscriptBox["p", "T"], " ", "is", " ", "the", " ", "transverse", " ", 
     "momentum", " ", "carried", " ", "by", " ", "the", " ", "LLP"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"pTmaxBrem", "[", "\"\<FermilabBD\>\"", "]"}], ",", 
     RowBox[{"pTmaxBrem", "[", "\"\<SPS\>\"", "]"}], ",", 
     RowBox[{"pTmaxBrem", "[", "\"\<LHC\>\"", "]"}], ",", 
     RowBox[{"pTmaxBrem", "[", "\"\<FCC-hh\>\"", "]"}], ",", 
     RowBox[{"pTmaxBrem", "[", "\"\<Serpukhov\>\"", "]"}], ",", 
     RowBox[{"pTmaxBrem", "[", "\"\<ESS\>\"", "]"}], ",", 
     RowBox[{"pTmaxBrem", "[", "\"\<LHC_fixed_target\>\"", "]"}]}], "}"}], 
   "=", 
   RowBox[{"{", 
    RowBox[{
    "1.", ",", "1.", ",", "1.", ",", "1.", ",", "1.", ",", "1.", ",", "1."}], 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"zMinBrem", "[", "\"\<FermilabBD\>\"", "]"}], ",", 
     RowBox[{"zMinBrem", "[", "\"\<SPS\>\"", "]"}], ",", 
     RowBox[{"zMinBrem", "[", "\"\<LHC\>\"", "]"}], ",", 
     RowBox[{"zMinBrem", "[", "\"\<FCC-hh\>\"", "]"}], ",", 
     RowBox[{"zMinBrem", "[", "\"\<Serpukhov\>\"", "]"}], ",", 
     RowBox[{"zMinBrem", "[", "\"\<ESS\>\"", "]"}], ",", 
     RowBox[{"zMinBrem", "[", "\"\<LHC_fixed_target\>\"", "]"}]}], "}"}], "=", 
   RowBox[{"{", 
    RowBox[{
    "0.1", ",", "0.1", ",", "0.005", ",", "0.001", ",", "0.1", ",", "0.4", 
     ",", "0.005"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"zMaxBrem", "[", "\"\<FermilabBD\>\"", "]"}], ",", 
     RowBox[{"zMaxBrem", "[", "\"\<SPS\>\"", "]"}], ",", 
     RowBox[{"zMaxBrem", "[", "\"\<LHC\>\"", "]"}], ",", 
     RowBox[{"zMaxBrem", "[", "\"\<FCC-hh\>\"", "]"}], ",", 
     RowBox[{"zMaxBrem", "[", "\"\<Serpukhov\>\"", "]"}], ",", 
     RowBox[{"zMaxBrem", "[", "\"\<ESS\>\"", "]"}], ",", 
     RowBox[{"zMaxBrem", "[", "\"\<LHC_fixed_target\>\"", "]"}]}], "}"}], "=", 
   RowBox[{"{", 
    RowBox[{
    "0.9", ",", "0.95", ",", "0.99", ",", "0.99", ",", "0.9", ",", "0.6", ",",
      "0.99"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{"mVminFromBrem", ",", "mVmaxFromBrem"}], "}"}], "=", 
    RowBox[{"{", 
     RowBox[{"0.02", ",", "8."}], "}"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    SubscriptBox["p", "T"], ",", 
    RowBox[{"z", " ", "\[Rule]", " ", 
     SubscriptBox["\[Theta]", "V"]}], ",", 
    SubscriptBox["E", "V"]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"pTv", "[", 
    RowBox[{"mV_", ",", "EV_", ",", "\[Theta]_"}], "]"}], "=", 
   RowBox[{
    SqrtBox[
     RowBox[{
      SuperscriptBox["EV", "2"], "-", 
      SuperscriptBox["mV", "2"]}]], "*", 
    RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"zvp", "[", 
    RowBox[{"EV_", ",", "pBeam_"}], "]"}], "=", 
   FractionBox["EV", "pBeam"]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Theta]listSmall", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"i", "*", 
          SuperscriptBox["10", "j"]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "0.2", ",", "9.8", ",", "0.2"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", 
           RowBox[{"-", "5"}], ",", 
           RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "]"}], "//", "Flatten"}], 
      "//", "N"}], "//", "Sort"}], "//", "DeleteDuplicates"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"EVfiltered", "[", 
   RowBox[{"data_", ",", "Facility_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"filteredData", ",", "displ", ",", "j", ",", "el"}], "}"}], ",", 
    "\n", 
    RowBox[{"(*", 
     RowBox[{
     "Initialize", " ", "the", " ", "filtered", " ", "list", " ", "with", " ",
       "the", " ", "first", " ", "element"}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"filteredData", "=", 
      RowBox[{"{", 
       RowBox[{"First", "[", "data", "]"}], "}"}]}], ";", "\n", 
     RowBox[{"(*", 
      RowBox[{
      "Iterate", " ", "over", " ", "the", " ", "list", " ", "starting", " ", 
       "from", " ", "the", " ", "second", " ", "element"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"displ", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"Facility", "==", "\"\<ESS\>\""}], ",", "0.05", ",", "1"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"j", "=", "1"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"el", "=", 
         RowBox[{"filteredData", "[", 
          RowBox[{"[", "j", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Abs", "[", 
            RowBox[{
             RowBox[{"data", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "-", "el"}], "]"}], ">=", 
           "displ"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"AppendTo", "[", 
            RowBox[{"filteredData", ",", 
             RowBox[{"data", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"j", "+=", "1"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
        ";"}], "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "2", ",", 
         RowBox[{"Length", "[", "data", "]"}]}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "filteredData"}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"ptmax", ",", "emaxabs", ",", "eminabs"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ptmax", "=", 
       RowBox[{"pTmaxBrem", "[", "Facility", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"emaxabs", "=", 
       RowBox[{
        RowBox[{"zMaxBrem", "[", "Facility", "]"}], "*", 
        RowBox[{"EmaxFacility", "[", "Facility", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ELLPminBrem", "[", "Facility", "]"}], "=", 
       RowBox[{
        RowBox[{"zMinBrem", "[", "Facility", "]"}], "*", 
        RowBox[{"EmaxFacility", "[", "Facility", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ELLPmaxBrem", "[", 
        RowBox[{"Facility", ",", "mLLP_", ",", "\[Theta]LLP_"}], "]"}], "=", 
       RowBox[{"Quiet", "[", 
        RowBox[{"Min", "[", 
         RowBox[{"emaxabs", ",", 
          RowBox[{"ELLP", "/.", 
           RowBox[{
            RowBox[{"Solve", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"pTv", "[", 
                RowBox[{"mLLP", ",", "ELLP", ",", 
                 RowBox[{"\[Theta]LLP", "+", 
                  SuperscriptBox["10", 
                   RowBox[{"-", "7."}]]}]}], "]"}], "==", "ptmax"}], ",", 
              "ELLP"}], "]"}], "[", 
            RowBox[{"[", "2", "]"}], "]"}]}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\[Theta]maxBrem", "[", "Facility", "]"}], "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"ELLPminBrem", "[", "Facility", "]"}], "<", "ptmax"}], ",", 
         "Pi", ",", 
         RowBox[{"Quiet", "[", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"\[Theta]LLP", "/.", 
             RowBox[{
              RowBox[{"Solve", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"ELLPminBrem", "[", "Facility", "]"}], "\[Equal]", 
                 FractionBox["ptmax", 
                  RowBox[{"Sin", "[", "\[Theta]LLP", "]"}]]}], ",", 
                "\[Theta]LLP"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], "/.", 
            RowBox[{"{", 
             RowBox[{
              TemplateBox[{"1"},
               "C"], "\[Rule]", "0"}], "}"}]}], ")"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Creating", " ", "angle"}], "-", 
        RowBox[{
        "energy", " ", "grids", " ", "with", " ", "sufficient", " ", 
         "density", " ", "for", " ", "the", " ", "tabulated", " ", "angle"}], 
        "-", 
        RowBox[{"energy", " ", "distribution"}]}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\[Theta]Efall", "[", "Facility", "]"}], "=", 
       RowBox[{"\[Theta]LLP", "/.", 
        RowBox[{
         RowBox[{"Solve", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Refine", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"ELLPmaxBrem", "[", 
                RowBox[{"Facility", ",", "0", ",", "\[Theta]LLP"}], "]"}], 
               "[", 
               RowBox[{"[", "2", "]"}], "]"}], ",", 
              RowBox[{"0", "<", "\[Theta]LLP", "<", 
               FractionBox["Pi", "2"]}]}], "]"}], "==", 
            RowBox[{
             RowBox[{"zMaxBrem", "[", "Facility", "]"}], "*", 
             RowBox[{"EmaxFacility", "[", "Facility", "]"}]}]}], ",", 
           "\[Theta]LLP"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Theta]gridBremTemp", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"\[Theta]Efall", "[", "Facility", "]"}], ">", 
            SuperscriptBox["10", 
             RowBox[{"-", "5."}]]}], ",", 
           RowBox[{"With", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"thmin", "=", 
                RowBox[{"\[Theta]Efall", "[", "Facility", "]"}]}], ",", 
               RowBox[{"thmax", "=", 
                RowBox[{"\[Theta]maxBrem", "[", "Facility", "]"}]}]}], "}"}], 
             ",", 
             RowBox[{"Join", "[", 
              RowBox[{
               RowBox[{"Select", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   SuperscriptBox["10", 
                    RowBox[{"-", "5."}]], ",", 
                   RowBox[{"3", "*", 
                    SuperscriptBox["10", 
                    RowBox[{"-", "5."}]]}], ",", 
                   RowBox[{"6", "*", 
                    SuperscriptBox["10", 
                    RowBox[{"-", "5."}]]}], ",", 
                   RowBox[{"8", "*", 
                    SuperscriptBox["10", 
                    RowBox[{"-", "5."}]]}], ",", 
                   SuperscriptBox["10", 
                    RowBox[{"-", "4."}]], ",", 
                   RowBox[{"2", "*", 
                    SuperscriptBox["10", 
                    RowBox[{"-", "4."}]]}], ",", 
                   RowBox[{"4", "*", 
                    SuperscriptBox["10", 
                    RowBox[{"-", "4."}]]}], ",", 
                   RowBox[{"6", "*", 
                    SuperscriptBox["10", 
                    RowBox[{"-", "4."}]]}], ",", 
                   RowBox[{"8", "*", 
                    SuperscriptBox["10", 
                    RowBox[{"-", "4."}]]}], ",", 
                   SuperscriptBox["10", 
                    RowBox[{"-", "3."}]], ",", 
                   RowBox[{"2", "*", 
                    SuperscriptBox["10", 
                    RowBox[{"-", "3."}]]}]}], "}"}], ",", 
                 RowBox[{
                  RowBox[{"#", "<", "thmin"}], "&"}]}], "]"}], ",", 
               RowBox[{"Select", "[", 
                RowBox[{"\[Theta]listSmall", ",", 
                 RowBox[{
                  RowBox[{"thmin", "<=", "#", "<", "thmax"}], "&"}]}], "]"}], 
               ",", 
               RowBox[{"{", "thmax", "}"}]}], "]"}]}], "]"}]}], "]"}], "//", 
         "N"}], "//", "DeleteDuplicates"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"ELLPmaxBrem", "[", 
            RowBox[{"Facility", ",", "0", ",", 
             RowBox[{"\[Theta]gridBremTemp", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ">", 
           RowBox[{"1.1", 
            RowBox[{"ELLPmaxBrem", "[", 
             RowBox[{"Facility", ",", "0", ",", 
              RowBox[{"\[Theta]gridBremTemp", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"\[Theta]gridBremTemp", "=", 
           RowBox[{
            RowBox[{
             RowBox[{"Join", "[", 
              RowBox[{"\[Theta]gridBremTemp", ",", 
               RowBox[{"Table", "[", 
                RowBox[{"x", ",", 
                 RowBox[{"{", 
                  RowBox[{"x", ",", 
                   RowBox[{"\[Theta]gridBremTemp", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                   RowBox[{"\[Theta]gridBremTemp", "[", 
                    RowBox[{"[", "6", "]"}], "]"}], ",", 
                   FractionBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Theta]gridBremTemp", "[", 
                    RowBox[{"[", "13", "]"}], "]"}], "-", 
                    RowBox[{"\[Theta]gridBremTemp", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "40"]}], "}"}]}],
                 "]"}]}], "]"}], "//", "Sort"}], "//", 
            "DeleteDuplicates"}]}]}], "\[IndentingNewLine]", "]"}], ";"}], 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\[Theta]LLPgridBrem", "[", "Facility", "]"}], "=", 
       RowBox[{"Join", "[", 
        RowBox[{"\[Theta]gridBremTemp", ",", 
         RowBox[{"Select", "[", 
          RowBox[{
           RowBox[{"\[Theta]Nlist", "[", "Facility", "]"}], ",", 
           RowBox[{
            RowBox[{"#", ">", 
             RowBox[{"Max", "[", "\[Theta]gridBremTemp", "]"}]}], "&"}]}], 
          "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ELLPgridBrem0", "[", "Facility", "]"}], "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"ELLPminBrem", "[", "Facility", "]"}], "}"}], ",", 
           RowBox[{"Select", "[", 
            RowBox[{
             RowBox[{"ENlist", "[", "Facility", "]"}], ",", 
             RowBox[{
              RowBox[{"#", ">", 
               RowBox[{"ELLPminBrem", "[", "Facility", "]"}]}], "&"}]}], 
            "]"}], ",", " ", 
           RowBox[{
            RowBox[{
             RowBox[{"ELLPmaxBrem", "[", 
              RowBox[{"Facility", ",", "0", ",", "#"}], "]"}], "&"}], "/@", 
            "\[Theta]gridBremTemp"}]}], "]"}], "//", "Sort"}], "//", 
        "DeleteDuplicates"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ELLPgridBrem", "[", "Facility", "]"}], "=", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"Select", "[", 
          RowBox[{
           RowBox[{"ENlist", "[", "Facility", "]"}], ",", 
           RowBox[{
            RowBox[{"#", "<", 
             RowBox[{"ELLPminBrem", "[", "Facility", "]"}]}], "&"}]}], "]"}], 
         ",", 
         RowBox[{"EVfiltered", "[", 
          RowBox[{
           RowBox[{"ELLPgridBrem0", "[", "Facility", "]"}], ",", "Facility"}],
           "]"}]}], "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], 
   "\[IndentingNewLine]", ",", 
   RowBox[{"{", 
    RowBox[{"Facility", ",", "FacilitiesList"}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.917162183690746*^9, 3.917162244368416*^9}, {
   3.917162299736909*^9, 3.917162487905453*^9}, {3.917162938902293*^9, 
   3.917162939028219*^9}, {3.9171629764748573`*^9, 3.917163007681755*^9}, {
   3.917163098188969*^9, 3.917163098272227*^9}, 3.917163182974003*^9, 
   3.9171632147908354`*^9, 3.917163691509415*^9, {3.917163808528348*^9, 
   3.917163858287688*^9}, {3.917163929495495*^9, 3.9171639597433043`*^9}, {
   3.917163990265517*^9, 3.917163990330175*^9}, {3.917164049379137*^9, 
   3.9171640496680045`*^9}, {3.9171641284899626`*^9, 3.917164174384981*^9}, {
   3.917164263072259*^9, 3.917164263171253*^9}, {3.917164404797939*^9, 
   3.917164415541307*^9}, {3.917495192471265*^9, 3.917495223733839*^9}, {
   3.917495277190592*^9, 3.9174952913190384`*^9}, {3.917496142033193*^9, 
   3.917496143800173*^9}, {3.91749625673152*^9, 3.917496355972249*^9}, {
   3.917496418745105*^9, 3.9174964759774055`*^9}, {3.9178598319619074`*^9, 
   3.917859835142969*^9}, {3.919012868655442*^9, 3.919012878646713*^9}, 
   3.9289899945844297`*^9, {3.928990607273936*^9, 3.9289906147192545`*^9}, {
   3.928990645262505*^9, 3.928990649702014*^9}, {3.930990076536159*^9, 
   3.930990119464301*^9}},
 CellTags->
  "Evaluation",ExpressionUUID->"06209544-3773-489e-b401-f3c8152c8319"],

Cell[BoxData[
 FormBox[
  TemplateBox[{
   "Solve", "ifun", 
    "\"Inverse functions are being used by \\!\\(\\*FormBox[\\\"Solve\\\", \
TraditionalForm]\\), so some solutions may not be found; use Reduce for \
complete solution information.\"", 2, 832, 19, 29079336519732941073, "Local"},
   
   "MessageTemplate"], TraditionalForm]], "Message", "MSG",
 CellChangeTimes->{3.93021145781359*^9, 3.9308226842581363`*^9},
 CellTags->"Evaluation",
 CellLabel->
  "Durante la evaluaci\[OAcute]n de \
In[823]:=",ExpressionUUID->"6134ddab-b135-47c2-85ca-9b5e14fe36fc"],

Cell[BoxData[
 FormBox[
  TemplateBox[{
   "Solve", "ifun", 
    "\"Inverse functions are being used by \\!\\(\\*FormBox[\\\"Solve\\\", \
TraditionalForm]\\), so some solutions may not be found; use Reduce for \
complete solution information.\"", 2, 832, 20, 29079336519732941073, "Local"},
   
   "MessageTemplate"], TraditionalForm]], "Message", "MSG",
 CellChangeTimes->{3.93021145781359*^9, 3.9308226842906423`*^9},
 CellTags->"Evaluation",
 CellLabel->
  "Durante la evaluaci\[OAcute]n de \
In[823]:=",ExpressionUUID->"ee525567-b012-48d5-81b5-f9e56b217b93"],

Cell[BoxData[
 FormBox[
  TemplateBox[{
   "Solve", "ifun", 
    "\"Inverse functions are being used by \\!\\(\\*FormBox[\\\"Solve\\\", \
TraditionalForm]\\), so some solutions may not be found; use Reduce for \
complete solution information.\"", 2, 832, 21, 29079336519732941073, "Local"},
   
   "MessageTemplate"], TraditionalForm]], "Message", "MSG",
 CellChangeTimes->{3.93021145781359*^9, 3.930822684298658*^9},
 CellTags->"Evaluation",
 CellLabel->
  "Durante la evaluaci\[OAcute]n de \
In[823]:=",ExpressionUUID->"76c2ce01-0118-498b-b884-1ade7054a0a3"],

Cell[BoxData[
 FormBox[
  TemplateBox[{
   "General", "stop", 
    "\"Further output of \\!\\(\\*FormBox[StyleBox[RowBox[{\\\"Solve\\\", \
\\\"::\\\", \\\"ifun\\\"}], \\\"MessageName\\\"], TraditionalForm]\\) will be \
suppressed during this calculation.\"", 2, 832, 22, 29079336519732941073, 
    "Local"},
   "MessageTemplate"], TraditionalForm]], "Message", "MSG",
 CellChangeTimes->{3.93021145781359*^9, 3.9308226843070593`*^9},
 CellTags->"Evaluation",
 CellLabel->
  "Durante la evaluaci\[OAcute]n de \
In[823]:=",ExpressionUUID->"8825f3ef-0780-43c6-a7d2-eec386a7a2f6"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"\[Theta]Efall", "[", "\"\<LHC\>\"", "]"}]], "Input",
 CellChangeTimes->{{3.928990687586443*^9, 3.928990689847447*^9}, {
  3.928990866834472*^9, 3.92899086864595*^9}},
 CellLabel->
  "In[950]:=",ExpressionUUID->"b6b539ad-e103-4e6b-a93c-1a724b07a7e3"],

Cell[BoxData[{
 RowBox[{"\[Theta]LLPgridBrem", "[", "\"\<SPS\>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"\[Theta]LLPgridBrem", "[", "\"\<LHC\>\"", "]"}]}], "Input",
 CellChangeTimes->{{3.928989825707072*^9, 3.928989827455225*^9}, {
  3.9289900108507776`*^9, 3.9289900181723413`*^9}, {3.928990052719405*^9, 
  3.928990054943564*^9}, {3.928990858062193*^9, 3.928990860130473*^9}},
 CellLabel->
  "In[951]:=",ExpressionUUID->"44b1315f-4233-44e4-afa3-8a7a4afdf9c6"],

Cell[BoxData["\[Theta]gridBremTemp"], "Input",
 CellLabel->
  "In[953]:=",ExpressionUUID->"7728b850-d838-470f-84b5-9ccfb0ce3e24"],

Cell[BoxData[
 RowBox[{"Join", "[", 
  RowBox[{"\[Theta]gridBremTemp", ",", 
   RowBox[{"Select", "[", 
    RowBox[{
     RowBox[{"\[Theta]Nlist", "[", "\"\<SPS\>\"", "]"}], ",", 
     RowBox[{
      RowBox[{"#", ">", 
       RowBox[{"Max", "[", "\[Theta]gridBremTemp", "]"}]}], "&"}]}], "]"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.9289898211854906`*^9, 3.928989822057027*^9}, {
  3.928990906010358*^9, 3.928990910420038*^9}},
 CellLabel->
  "In[954]:=",ExpressionUUID->"e763adb4-f64c-4d95-b2fa-3cbcadba7692"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Theta]gridBremTemp", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"\[Theta]Efall", "[", "\"\<SPS\>\"", "]"}], ">", 
        SuperscriptBox["10", 
         RowBox[{"-", "5."}]]}], ",", 
       RowBox[{"With", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"thmin", "=", 
            RowBox[{"\[Theta]Efall", "[", "\"\<SPS\>\"", "]"}]}], ",", 
           RowBox[{"thmax", "=", 
            RowBox[{"\[Theta]maxBrem", "[", "\"\<SPS\>\"", "]"}]}]}], "}"}], 
         ",", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"Select", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               SuperscriptBox["10", 
                RowBox[{"-", "5."}]], ",", 
               RowBox[{"3", "*", 
                SuperscriptBox["10", 
                 RowBox[{"-", "5."}]]}], ",", 
               RowBox[{"6", "*", 
                SuperscriptBox["10", 
                 RowBox[{"-", "5."}]]}], ",", 
               RowBox[{"8", "*", 
                SuperscriptBox["10", 
                 RowBox[{"-", "5."}]]}], ",", 
               SuperscriptBox["10", 
                RowBox[{"-", "4."}]], ",", 
               RowBox[{"2", "*", 
                SuperscriptBox["10", 
                 RowBox[{"-", "4."}]]}], ",", 
               RowBox[{"4", "*", 
                SuperscriptBox["10", 
                 RowBox[{"-", "4."}]]}], ",", 
               RowBox[{"6", "*", 
                SuperscriptBox["10", 
                 RowBox[{"-", "4."}]]}], ",", 
               RowBox[{"8", "*", 
                SuperscriptBox["10", 
                 RowBox[{"-", "4."}]]}], ",", 
               SuperscriptBox["10", 
                RowBox[{"-", "3."}]], ",", 
               RowBox[{"2", "*", 
                SuperscriptBox["10", 
                 RowBox[{"-", "3."}]]}]}], "}"}], ",", 
             RowBox[{
              RowBox[{"#", "<", "thmin"}], "&"}]}], "]"}], ",", 
           RowBox[{"Select", "[", 
            RowBox[{"\[Theta]listSmall", ",", 
             RowBox[{
              RowBox[{"thmin", "<=", "#", "<", "thmax"}], "&"}]}], "]"}], ",", 
           RowBox[{"{", "thmax", "}"}]}], "]"}]}], "]"}]}], "]"}], "//", 
     "N"}], "//", "DeleteDuplicates"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"ELLPmaxBrem", "[", 
      RowBox[{"\"\<SPS\>\"", ",", "0", ",", 
       RowBox[{"\[Theta]gridBremTemp", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ">", 
     RowBox[{"1.1", 
      RowBox[{"ELLPmaxBrem", "[", 
       RowBox[{"\"\<SPS\>\"", ",", "0", ",", 
        RowBox[{"\[Theta]gridBremTemp", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"\[Theta]gridBremTemp1", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"Join", "[", 
        RowBox[{"\[Theta]gridBremTemp", ",", 
         RowBox[{"Table", "[", 
          RowBox[{"x", ",", 
           RowBox[{"{", 
            RowBox[{"x", ",", 
             RowBox[{"\[Theta]gridBremTemp", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", 
             RowBox[{"\[Theta]gridBremTemp", "[", 
              RowBox[{"[", "6", "]"}], "]"}], ",", 
             FractionBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"\[Theta]gridBremTemp", "[", 
                 RowBox[{"[", "13", "]"}], "]"}], "-", 
                RowBox[{"\[Theta]gridBremTemp", "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "40"]}], "}"}]}], 
          "]"}]}], "]"}], "//", "Sort"}], "//", "DeleteDuplicates"}]}]}], 
   "\[IndentingNewLine]", "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.9289905261192784`*^9, 3.928990541090288*^9}},
 CellLabel->
  "In[955]:=",ExpressionUUID->"b558505e-b45f-4d12-972b-488d98c48566"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{3.928989862486475*^9},
 CellLabel->
  "In[957]:=",ExpressionUUID->"1947cb8b-94c6-4847-a144-30b6c66d1f4b"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Coherent EM processes (WW approximation)", "Section",
 CellChangeTimes->{{3.9174960694162407`*^9, 3.9174960771294785`*^9}},
 CellTags->
  "Evaluation",ExpressionUUID->"ecf5bab7-5ea6-437a-9631-ce3f62c4edfb"],

Cell[CellGroupData[{

Cell["EM elastic form-factors", "Subsection",
 CellChangeTimes->{{3.9174960886150217`*^9, 3.917496092315179*^9}},
 CellTags->
  "Evaluation",ExpressionUUID->"aa0f2d30-2951-433c-8422-3eae16d65609"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", "Helm", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"svalfm", "=", "0.9"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"fmtoGeVm1", "=", "5"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Effective", " ", "radius", " ", "of", " ", "the", " ", "nucleus"}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"R1", "[", "Anucleus_", "]"}], "=", 
     RowBox[{"fmtoGeVm1", 
      SqrtBox[
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"1.23", "*", 
            SuperscriptBox["Anucleus", 
             FractionBox["1", "3"]]}], "-", "0.6"}], ")"}], "2"], "+", 
        RowBox[{
         FractionBox["7", "3"], 
         SuperscriptBox["Pi", "2"], "*", 
         SuperscriptBox["0.52", "2"]}], "-", 
        RowBox[{"5", "*", 
         SuperscriptBox["svalfm", "2"]}]}]]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"FHelm", "[", 
      RowBox[{"q2_", ",", "Anucleus_", ",", "Znucleus_"}], "]"}], "=", 
     RowBox[{"3", "*", "Znucleus", "*", 
      FractionBox[
       RowBox[{
        RowBox[{"(*", 
         RowBox[{"SphericalBesselJ", "[", 
          RowBox[{"1", ",", 
           RowBox[{
            SqrtBox["q2"], "*", 
            RowBox[{"R1", "[", "Anucleus", "]"}]}]}], "]"}], "*)"}], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           FractionBox[
            RowBox[{"Sin", "[", "x", "]"}], 
            SuperscriptBox["x", "2"]], "-", 
           FractionBox[
            RowBox[{"Cos", "[", "x", "]"}], "x"]}], "/.", 
          RowBox[{"{", 
           RowBox[{"x", "->", 
            RowBox[{
             SqrtBox["q2"], "*", 
             RowBox[{"R1", "[", "Anucleus", "]"}]}]}], "}"}]}], ")"}]}], 
       RowBox[{
        SqrtBox["q2"], "*", 
        RowBox[{"R1", "[", "Anucleus", "]"}]}]], 
      RowBox[{"Exp", "[", 
       RowBox[{"-", 
        FractionBox[
         RowBox[{"q2", "*", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"svalfm", "*", "fmtoGeVm1"}], ")"}], "2"]}], "2"]}], 
       "]"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"FHelm1", "[", 
     RowBox[{"q2_", ",", "Rnucl_", ",", "Znucleus_"}], "]"}], "=", 
    RowBox[{"3", "*", "Znucleus", "*", 
     FractionBox[
      RowBox[{
       RowBox[{"(*", 
        RowBox[{"SphericalBesselJ", "[", 
         RowBox[{"1", ",", 
          RowBox[{
           SqrtBox["q2"], "*", 
           RowBox[{"R1", "[", "Anucleus", "]"}]}]}], "]"}], "*)"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          FractionBox[
           RowBox[{"Sin", "[", "x", "]"}], 
           SuperscriptBox["x", "2"]], "-", 
          FractionBox[
           RowBox[{"Cos", "[", "x", "]"}], "x"]}], "/.", 
         RowBox[{"{", 
          RowBox[{"x", "->", 
           RowBox[{
            SqrtBox["q2"], "*", "Rnucl"}]}], "}"}]}], ")"}]}], 
      RowBox[{
       SqrtBox["q2"], "*", "Rnucl"}]], 
     RowBox[{"Exp", "[", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"q2", "*", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"svalfm", "*", "fmtoGeVm1"}], ")"}], "2"]}], "2"]}], 
      "]"}]}]}], "\[IndentingNewLine]", 
   RowBox[{"(*", "Proton", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"GE", "[", "q2_", "]"}], "=", 
     FractionBox["1", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"1", "+", 
         FractionBox["q2", 
          SuperscriptBox["0.843", "2"]]}], ")"}], "2"]]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"GM", "[", "q2_", "]"}], "=", 
     FractionBox[
      SqrtBox["7.78"], 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"1", "+", 
         FractionBox["q2", 
          SuperscriptBox["0.843", "2"]]}], ")"}], "2"]]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"F1", "[", "q2_", "]"}], "=", 
     FractionBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"4", "*", 
         SuperscriptBox["mp", "2"], "*", 
         RowBox[{"GE", "[", "q2", "]"}]}], "+", 
        RowBox[{"q2", "*", 
         RowBox[{"GM", "[", "q2", "]"}]}]}], ")"}], 
      RowBox[{
       RowBox[{"4", "*", 
        SuperscriptBox[
         RowBox[{"mSM", "[", "\"\<p\>\"", "]"}], "2"]}], "+", "q2"}]]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"F2", "[", "q2_", "]"}], "=", 
     FractionBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"GM", "[", "q2", "]"}], "-", 
        RowBox[{"GE", "[", "q2", "]"}]}], ")"}], 
      RowBox[{
       RowBox[{"4", "*", 
        SuperscriptBox[
         RowBox[{"mSM", "[", "\"\<p\>\"", "]"}], "2"]}], "+", "q2"}]]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Dval", "[", "q2_", "]"}], "=", 
     FractionBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"4", "*", 
         SuperscriptBox[
          RowBox[{"mSM", "[", "\"\<p\>\"", "]"}], "2"], "*", 
         SuperscriptBox[
          RowBox[{"GE", "[", "q2", "]"}], "2"]}], "+", 
        RowBox[{"q2", "*", 
         SuperscriptBox[
          RowBox[{"GM", "[", "q2", "]"}], "2"]}]}], ")"}], 
      RowBox[{
       RowBox[{"4", "*", 
        SuperscriptBox[
         RowBox[{"mSM", "[", "\"\<p\>\"", "]"}], "2"]}], "+", "q2"}]]}], 
    ";"}], "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.88566230678675*^9, 3.885662307092316*^9}, {
  3.885662380009367*^9, 3.885662399584614*^9}, {3.8856663911376557`*^9, 
  3.885666410248655*^9}, {3.885666576916359*^9, 3.885666581457991*^9}, {
  3.8857440369105644`*^9, 3.885744045275323*^9}, {3.885915500228934*^9, 
  3.8859155042442837`*^9}, {3.8864375634346085`*^9, 3.88643762086589*^9}, {
  3.886439158232164*^9, 3.886439162340058*^9}, {3.913455877764411*^9, 
  3.913455900323178*^9}, {3.913535793752397*^9, 3.913535819722514*^9}, {
  3.913625264597995*^9, 3.913625289233897*^9}},
 CellTags->"Evaluation",
 CellLabel->
  "In[833]:=",ExpressionUUID->"c49b2c57-3f81-4950-8334-7fcac9bc22cf"],

Cell[BoxData[
 FormBox[
  FractionBox[
   RowBox[{"3", " ", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{
      RowBox[{"-", "10.125`"}], " ", "q2"}]], " ", "Znucleus", " ", 
    RowBox[{"(", 
     RowBox[{
      FractionBox[
       RowBox[{"sin", "(", 
        RowBox[{
         SqrtBox["q2"], " ", "Rnucl"}], ")"}], 
       RowBox[{"q2", " ", 
        SuperscriptBox["Rnucl", "2"]}]], "-", 
      FractionBox[
       RowBox[{"cos", "(", 
        RowBox[{
         SqrtBox["q2"], " ", "Rnucl"}], ")"}], 
       RowBox[{
        SqrtBox["q2"], " ", "Rnucl"}]]}], ")"}]}], 
   RowBox[{
    SqrtBox["q2"], " ", "Rnucl"}]], TraditionalForm]], "Output",
 CellChangeTimes->{3.9302114579489613`*^9, 3.9308226843997726`*^9},
 CellTags->"Evaluation",
 CellLabel->
  "Out[837]=",ExpressionUUID->"1f41b548-adad-4f40-b82a-2d69d7ca3b6a"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Equivalent photon distribution functions", "Subsection",
 CellChangeTimes->{{3.9174960886150217`*^9, 3.917496099281084*^9}},
 CellTags->
  "Evaluation",ExpressionUUID->"a245a9ad-be57-4780-b644-b1f1504e0331"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Magnitude", " ", "of", " ", "the", " ", "momentum", " ", "transfer", " ", 
    "between", " ", "particle", " ", "and", " ", "photon"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"q2pTxVal", "[", 
      RowBox[{"x_", ",", "pT_", ",", "m_"}], "]"}], "=", 
     FractionBox[
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["pT", "2"], "+", 
        RowBox[{
         SuperscriptBox["x", "2"], "*", 
         SuperscriptBox["m", "2"]}]}], ")"}], 
      RowBox[{"1", "-", "x"}]]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"fEPAp", "[", 
      RowBox[{"pT_", ",", "x_", ",", "\[Alpha]EM_"}], "]"}], "=", 
     RowBox[{
      FractionBox["\[Alpha]EM", 
       RowBox[{"2", "*", "Pi"}]], 
      FractionBox[
       RowBox[{"(", 
        RowBox[{"1", "+", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"1", "-", "x"}], ")"}], "2"]}], ")"}], "x"], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         FractionBox[
          SuperscriptBox["pT", "2"], 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["pT", "2"], "+", 
             RowBox[{
              SuperscriptBox["x", "2"], "*", 
              SuperscriptBox[
               RowBox[{"mSM", "[", "\"\<p\>\"", "]"}], "2"]}]}], ")"}], "2"]], 
         RowBox[{"Dval", "[", 
          RowBox[{"q2pTxVal", "[", 
           RowBox[{"x", ",", "pT", ",", 
            RowBox[{"mSM", "[", "\"\<p\>\"", "]"}]}], "]"}], "]"}]}], "+", 
        RowBox[{
         FractionBox[
          SuperscriptBox["x", "2"], "2"], 
         SuperscriptBox[
          RowBox[{"GM", "[", 
           RowBox[{"q2pTxVal", "[", 
            RowBox[{"x", ",", "pT", ",", 
             RowBox[{"mSM", "[", "\"\<p\>\"", "]"}]}], "]"}], "]"}], "2"]}]}],
        ")"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"fEPAnucleus", "[", 
      RowBox[{
      "pT_", ",", "x_", ",", "\[Alpha]EM_", ",", "mNucleus_", ",", 
       "Anucleus_", ",", "Znucleus_"}], "]"}], "=", 
     RowBox[{
      RowBox[{
       FractionBox["\[Alpha]EM", 
        RowBox[{"2", "*", "Pi"}]], 
       FractionBox[
        RowBox[{"(", 
         RowBox[{"1", "+", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"1", "-", "x"}], ")"}], "2"]}], ")"}], "x"], 
       RowBox[{"(", 
        RowBox[{
         FractionBox[
          SuperscriptBox["pT", "2"], 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["pT", "2"], "+", 
             RowBox[{
              SuperscriptBox["x", "2"], "*", 
              SuperscriptBox["mNucleus", "2"]}]}], ")"}], "2"]], 
         SuperscriptBox[
          RowBox[{"FHelm", "[", 
           RowBox[{
            RowBox[{"q2pTxVal", "[", 
             RowBox[{"x", ",", "pT", ",", "mNucleus"}], "]"}], ",", 
            "Anucleus", ",", "Znucleus"}], "]"}], "2"]}], ")"}]}], "//", 
      "Simplify"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"fEPAnucleus1", "[", 
      RowBox[{
      "pT_", ",", "x_", ",", "\[Alpha]EM_", ",", "mNucleus_", ",", "Rnucl_", 
       ",", "Znucleus_"}], "]"}], "=", 
     RowBox[{
      RowBox[{
       FractionBox["\[Alpha]EM", 
        RowBox[{"2", "*", "Pi"}]], 
       FractionBox[
        RowBox[{"(", 
         RowBox[{"1", "+", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"1", "-", "x"}], ")"}], "2"]}], ")"}], "x"], 
       RowBox[{"(", 
        RowBox[{
         FractionBox[
          SuperscriptBox["pT", "2"], 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["pT", "2"], "+", 
             RowBox[{
              SuperscriptBox["x", "2"], "*", 
              SuperscriptBox["mNucleus", "2"]}]}], ")"}], "2"]], 
         SuperscriptBox[
          RowBox[{"FHelm1", "[", 
           RowBox[{
            RowBox[{"q2pTxVal", "[", 
             RowBox[{"x", ",", "pT", ",", "mNucleus"}], "]"}], ",", "Rnucl", 
            ",", "Znucleus"}], "]"}], "2"]}], ")"}]}], "//", "Simplify"}]}], 
    ";"}], "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.885657215720272*^9, 3.885657215897153*^9}, {
  3.885657280908365*^9, 3.8856572820592713`*^9}, {3.885657731785942*^9, 
  3.885657842142995*^9}, {3.886437640500336*^9, 3.886437685211144*^9}, {
  3.886437970621154*^9, 3.88643798159947*^9}, {3.913455904593361*^9, 
  3.913455913035098*^9}, {3.913535883299809*^9, 3.913535897447936*^9}, {
  3.91362530883998*^9, 3.913625352048195*^9}},
 CellTags->"Evaluation",
 CellLabel->
  "In[843]:=",ExpressionUUID->"f5a0a55d-2b6c-42d3-81db-68110c8f100d"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["HNL", "Chapter",
 CellChangeTimes->{{3.8851088986770496`*^9, 3.885108902774522*^9}, {
   3.885112414554508*^9, 3.885112423495655*^9}, 3.8934896803101463`*^9, {
   3.913268598660073*^9, 3.913268600863027*^9}, 3.913971498624044*^9},
 CellTags->
  "Evaluation",ExpressionUUID->"a8f49eab-e7b1-4705-9448-f2a995602fd0"],

Cell[CellGroupData[{

Cell["Relevant processes", "Section",
 CellChangeTimes->{{3.913268643168833*^9, 3.9132686454263844`*^9}},
 CellTags->
  "Evaluation",ExpressionUUID->"c08c78a0-7415-4dd4-a1ce-05c6eb37994e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ListHNLs", "=", 
    RowBox[{"{", 
     RowBox[{
     "\"\<HNL-mixing-e\>\"", ",", "\"\<HNL-mixing-mu\>\"", ",", 
      "\"\<HNL-mixing-tau\>\""}], "}"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "___", "___", "___", "___", "___", "___", "___", "___", "___", "___", 
    "___", "_"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"HNLs", " ", "with", " ", "e", " ", "mixing"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "___", "___", "___", "___", "___", "___", "___", "___", "___", "___", 
    "___", "_"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"List", " ", "of", " ", "processes"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"LLPname", "=", 
   RowBox[{"ListHNLs", "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ProcessesListAll", "[", "LLPname", "]"}], "=", 
    RowBox[{"{", 
     RowBox[{
     "\"\<B-3-body\>\"", ",", "\"\<B-2-body\>\"", ",", "\"\<Bc\>\"", ",", 
      "\"\<D-3-body\>\"", ",", "\"\<D-2-body\>\"", ",", "\"\<K\>\"", ",", 
      "\"\<W\>\"", ",", "\"\<mu\>\"", ",", "\"\<PiCharged\>\""}], "}"}]}], 
   ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Topology", " ", "of", " ", "the", " ", "process"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"ProductionType", "[", 
         RowBox[{"LLPname", ",", "#1"}], "]"}], "=", "#2"}], ")"}], "&"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"ProcessesListAll", "[", "LLPname", "]"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{"\"\<Decay\>\"", ",", 
         RowBox[{"Length", "[", 
          RowBox[{"ProcessesListAll", "[", "LLPname", "]"}], "]"}]}], "]"}]}],
       "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Particle", " ", 
     RowBox[{"content", ":", " ", 
      RowBox[{"mother", " ", "particle"}]}]}], ",", " ", 
    RowBox[{"decay", " ", "products"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"For", " ", "3"}], "-", 
     RowBox[{"body", " ", "decays", " ", "of", " ", "B"}]}], ",", " ", 
    RowBox[{
     RowBox[{
     "one", " ", "reference", " ", "decay", " ", "process", " ", "is", " ", 
      RowBox[{"used", ":", " ", "B"}]}], " ", "->", " ", 
     RowBox[{"N", " ", "+", " ", 
      SuperscriptBox["D", "*"], " ", "+", " ", "l"}]}], ",", " ", 
    RowBox[{"which", " ", "dominates", " ", "the", " ", "production"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"ReactionProductsList", "[", 
         RowBox[{"LLPname", ",", "#1"}], "]"}], "=", "#2"}], ")"}], "&"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"ProcessesListAll", "[", "LLPname", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "\"\<Bplus\>\"", ",", "\"\<Dstar\>\"", ",", "\"\<e\>\"", ",", 
           "LLPname"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"\"\<Bplus\>\"", ",", "\"\<e\>\"", ",", "LLPname"}], "}"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"\"\<Bc\>\"", ",", "\"\<e\>\"", ",", "LLPname"}], "}"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{
          "\"\<Dplus\>\"", ",", "\"\<K0\>\"", ",", "\"\<e\>\"", ",", 
           "LLPname"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"\"\<Ds\>\"", ",", "\"\<e\>\"", ",", "LLPname"}], "}"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"\"\<Kplus\>\"", ",", "\"\<e\>\"", ",", "LLPname"}], "}"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"\"\<W\>\"", ",", "\"\<e\>\"", ",", "LLPname"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
          "\"\<mu\>\"", ",", "\"\<e\>\"", ",", "\"\<neutrino\>\"", ",", 
           "LLPname"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"\"\<PiCharged\>\"", ",", "\"\<e\>\"", ",", "LLPname"}], 
          "}"}]}], "}"}]}], "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "___", "___", "___", "___", "___", "___", "___", "___", "___", "___", 
    "___", "_"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"HNLs", " ", "with", " ", "\[Mu]", " ", "mixing"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "___", "___", "___", "___", "___", "___", "___", "___", "___", "___", 
    "___", "_"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"LLPname", "=", 
   RowBox[{"ListHNLs", "[", 
    RowBox[{"[", "2", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ProcessesListAll", "[", "LLPname", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{
    "\"\<B-3-body\>\"", ",", "\"\<B-2-body\>\"", ",", "\"\<Bc\>\"", ",", 
     "\"\<D-3-body\>\"", ",", "\"\<D-2-body\>\"", ",", "\"\<K\>\"", ",", 
     "\"\<W\>\"", ",", "\"\<mu\>\"", ",", "\"\<PiCharged\>\""}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MapThread", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"ProductionType", "[", 
        RowBox[{"LLPname", ",", "#1"}], "]"}], "=", "#2"}], ")"}], "&"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"ProcessesListAll", "[", "LLPname", "]"}], ",", 
      RowBox[{"Table", "[", 
       RowBox[{"\"\<Decay\>\"", ",", 
        RowBox[{"Length", "[", 
         RowBox[{"ProcessesListAll", "[", "LLPname", "]"}], "]"}]}], "]"}]}], 
     "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"ReactionProductsList", "[", 
         RowBox[{"LLPname", ",", "#1"}], "]"}], "=", "#2"}], ")"}], "&"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"ProcessesListAll", "[", "LLPname", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "\"\<Bplus\>\"", ",", "\"\<Dstar\>\"", ",", "\"\<mu\>\"", ",", 
           "LLPname"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"\"\<Bplus\>\"", ",", "\"\<mu\>\"", ",", "LLPname"}], "}"}],
          ",", 
         RowBox[{"{", 
          RowBox[{"\"\<Bc\>\"", ",", "\"\<mu\>\"", ",", "LLPname"}], "}"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{
          "\"\<Dplus\>\"", ",", "\"\<K0\>\"", ",", "\"\<mu\>\"", ",", 
           "LLPname"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"\"\<Ds\>\"", ",", "\"\<mu\>\"", ",", "LLPname"}], "}"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"\"\<Kplus\>\"", ",", "\"\<mu\>\"", ",", "LLPname"}], "}"}],
          ",", 
         RowBox[{"{", 
          RowBox[{"\"\<W\>\"", ",", "\"\<mu\>\"", ",", "LLPname"}], "}"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{
          "\"\<mu\>\"", ",", "\"\<e\>\"", ",", "\"\<neutrino\>\"", ",", 
           "LLPname"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"\"\<PiCharged\>\"", ",", "\"\<mu\>\"", ",", "LLPname"}], 
          "}"}]}], "}"}]}], "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "___", "___", "___", "___", "___", "___", "___", "___", "___", "___", 
    "___", "_"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"HNLs", " ", "with", " ", "\[Tau]", " ", "mixing"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "___", "___", "___", "___", "___", "___", "___", "___", "___", "___", 
    "___", "_"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"LLPname", "=", 
   RowBox[{"ListHNLs", "[", 
    RowBox[{"[", "3", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ProcessesListAll", "[", "LLPname", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{
    "\"\<B-3-body\>\"", ",", "\"\<B-2-body\>\"", ",", "\"\<Bc\>\"", ",", 
     "\"\<D-2-body\>\"", ",", "\"\<\[Tau]-3-body\>\"", ",", 
     "\"\<\[Tau]-2-body\>\"", ",", "\"\<W\>\""}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MapThread", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"ProductionType", "[", 
        RowBox[{"LLPname", ",", "#1"}], "]"}], "=", "#2"}], ")"}], "&"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"ProcessesListAll", "[", "LLPname", "]"}], ",", 
      RowBox[{"Table", "[", 
       RowBox[{"\"\<Decay\>\"", ",", 
        RowBox[{"Length", "[", 
         RowBox[{"ProcessesListAll", "[", "LLPname", "]"}], "]"}]}], "]"}]}], 
     "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MapThread", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"ReactionProductsList", "[", 
        RowBox[{"LLPname", ",", "#1"}], "]"}], "=", "#2"}], ")"}], "&"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"ProcessesListAll", "[", "LLPname", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "\"\<Bplus\>\"", ",", "\"\<Dstar\>\"", ",", "\"\<tau\>\"", ",", 
          "LLPname"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"\"\<Bplus\>\"", ",", "\"\<tau\>\"", ",", "LLPname"}], "}"}],
         ",", 
        RowBox[{"{", 
         RowBox[{"\"\<Bc\>\"", ",", "\"\<tau\>\"", ",", "LLPname"}], "}"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"\"\<Ds\>\"", ",", "\"\<tau\>\"", ",", "LLPname"}], "}"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{
         "\"\<tau\>\"", ",", "\"\<neutrino\>\"", ",", "\"\<e\>\"", ",", 
          "LLPname"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"\"\<tau\>\"", ",", "\"\<PiCharged\>\"", ",", "LLPname"}], 
         "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"\"\<W\>\"", ",", "\"\<tau\>\"", ",", "LLPname"}], "}"}]}], 
       "}"}]}], "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"LLPname", "//", "Clear"}]}], "Input",
 CellChangeTimes->{{3.913268651639258*^9, 3.913268731959789*^9}, {
   3.913269743023601*^9, 3.913269760636882*^9}, {3.9132704922250967`*^9, 
   3.913270515217724*^9}, {3.913274535814342*^9, 3.913274541705774*^9}, {
   3.913276023882397*^9, 3.913276024274871*^9}, {3.913278154921974*^9, 
   3.913278213933945*^9}, {3.913278320684838*^9, 3.913278361235646*^9}, {
   3.9132785241175838`*^9, 3.9132785245568476`*^9}, {3.9132798569079*^9, 
   3.913279857127489*^9}, {3.913280729313801*^9, 3.91328073035002*^9}, {
   3.913282969137287*^9, 3.913283144403261*^9}, {3.913283998801713*^9, 
   3.913284005157871*^9}, 3.913284245935687*^9, {3.9132880215123806`*^9, 
   3.913288250272523*^9}, {3.913288282124204*^9, 3.913288377623515*^9}, {
   3.913288439319628*^9, 3.913288440967491*^9}, {3.9132885639772277`*^9, 
   3.913288576598701*^9}, {3.913288737346222*^9, 3.913288737605184*^9}, {
   3.9133079830416517`*^9, 3.913307996635379*^9}, {3.9133091786762276`*^9, 
   3.913309188795542*^9}, {3.913370124733569*^9, 3.9133701326171403`*^9}, {
   3.913370164764619*^9, 3.9133702142884445`*^9}, 3.913370250884398*^9, {
   3.913370311662603*^9, 3.913370334058549*^9}, {3.913371552870882*^9, 
   3.913371561574369*^9}, {3.913371892334863*^9, 3.9133719120740595`*^9}, {
   3.913372622553373*^9, 3.913372625515817*^9}, {3.913374258311656*^9, 
   3.913374340616831*^9}, {3.913374395307041*^9, 3.913374442161868*^9}, {
   3.913394790520629*^9, 3.913394814088152*^9}, {3.913395240214464*^9, 
   3.91339524024637*^9}, 3.914831446929443*^9, {3.914831964078404*^9, 
   3.914832003429323*^9}, {3.914832034308422*^9, 3.914832081719884*^9}, {
   3.914835030685507*^9, 3.914835045635773*^9}, {3.9148350855868*^9, 
   3.914835105659685*^9}, {3.914847497840693*^9, 3.9148476078289533`*^9}, {
   3.914908178149752*^9, 3.914908237611875*^9}, {3.9149085260209017`*^9, 
   3.914908529810856*^9}, {3.915438799813634*^9, 3.915438800050008*^9}, {
   3.91544018991398*^9, 3.9154401899221487`*^9}, {3.915440641886875*^9, 
   3.915440677353327*^9}, {3.915440966075803*^9, 3.915440966084864*^9}, {
   3.915604305851432*^9, 3.9156043068459053`*^9}, 3.915604379745659*^9},
 CellTags->"Evaluation",
 CellLabel->
  "In[847]:=",ExpressionUUID->"0c0fb3ea-7b74-4498-9c9b-983eee5abfd7"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Weights for the different processes of D/B decays", "Section",
 CellChangeTimes->{{3.913268773814298*^9, 3.913268777642671*^9}, 
   3.913269206988111*^9, {3.913274073303277*^9, 3.9132740765021152`*^9}, {
   3.9133726099259243`*^9, 3.913372617357512*^9}},
 CellTags->
  "Evaluation",ExpressionUUID->"ffe71289-67cd-43b9-8115-56413162d724"],

Cell[CellGroupData[{

Cell["From B", "Subsection",
 CellChangeTimes->{{3.9132691723884573`*^9, 3.913269196029019*^9}, {
  3.913274088224186*^9, 3.9132740889306035`*^9}},
 CellTags->
  "Evaluation",ExpressionUUID->"7e519fd0-4951-4f22-871f-ef83ce20d9e7"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"brint", "[", 
    RowBox[{"mN_", ",", "file_"}], "]"}], ":=", " ", 
   RowBox[{
    RowBox[{"Interpolation", "[", 
     RowBox[{
      RowBox[{"Import", "[", 
       RowBox[{"FileNameJoin", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"NotebookDirectory", "[", "]"}], ",", 
          "\"\<phenomenology/HNL/Production probabilities\>\"", ",", "file"}],
          "}"}], "]"}], "]"}], ",", 
      RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[", "mN", 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"brsum", "[", "proclist_", "]"}], ":=", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{"brint", "[", 
      RowBox[{"mN", ",", "proc"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"proc", ",", "proclist"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Dominant", " ", "decays", " ", "of", " ", 
    SubscriptBox["B", "c"]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"MapThread", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"\[Omega]HNL", "[", 
          RowBox[{"#1", ",", "Facility", ",", "\"\<Bc\>\"", ",", "mN_"}], 
          "]"}], "=", "#2"}], ")"}], "&"}], ",", 
      RowBox[{"{", 
       RowBox[{"ListHNLs", ",", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"fbtobc", "[", "Facility", "]"}], "*", 
           RowBox[{"brint", "[", 
            RowBox[{"mN", ",", "#"}], "]"}]}], "&"}], "/@", 
         RowBox[{"{", 
          RowBox[{
          "\"\<bc-eN.m\>\"", ",", "\"\<bc-muN.m\>\"", ",", 
           "\"\<bc-tauN.m\>\""}], "}"}]}]}], "}"}]}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"2", "-", 
      RowBox[{"body", " ", "decays", " ", "of", " ", 
       SuperscriptBox["B", "+"]}]}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{"MapThread", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"\[Omega]HNL", "[", 
          RowBox[{
          "#1", ",", "Facility", ",", "\"\<B-2-body\>\"", ",", "mN_"}], "]"}],
          "=", "#2"}], ")"}], "&"}], ",", 
      RowBox[{"{", 
       RowBox[{"ListHNLs", ",", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"fbtobplus", "[", "Facility", "]"}], "+", 
             RowBox[{"fbtob0", "[", "Facility", "]"}]}], ")"}], 
           RowBox[{"brint", "[", 
            RowBox[{"mN", ",", "#"}], "]"}]}], "&"}], "/@", 
         RowBox[{"{", 
          RowBox[{
          "\"\<bplus-eN.m\>\"", ",", "\"\<bplus-muN.m\>\"", ",", 
           "\"\<bplus-tauN.m\>\""}], "}"}]}]}], "}"}]}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"3", "-", 
      RowBox[{"body", " ", "decays", " ", "of", " ", 
       RowBox[{"B", ".", " ", "br"}], " ", "ratios", " ", "for", " ", "other",
        " ", "3"}], "-", 
      RowBox[{
      "body", " ", "processes", " ", "are", " ", "included", " ", "here", " ",
        "as", " ", "well"}]}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"mMax", "[", 
        RowBox[{
         RowBox[{"ListHNLs", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", "\"\<B-3-body\>\""}], "]"}], 
       ",", 
       RowBox[{"mMax", "[", 
        RowBox[{
         RowBox[{"ListHNLs", "[", 
          RowBox[{"[", "2", "]"}], "]"}], ",", "\"\<B-3-body\>\""}], "]"}], 
       ",", 
       RowBox[{"mMax", "[", 
        RowBox[{
         RowBox[{"ListHNLs", "[", 
          RowBox[{"[", "3", "]"}], "]"}], ",", "\"\<B-3-body\>\""}], "]"}]}], 
      "}"}], "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"mSM", "[", "\"\<Bplus\>\"", "]"}], "-", 
        RowBox[{"mSM", "[", "\"\<Dstar\>\"", "]"}], "-", 
        RowBox[{"mSM", "[", "\"\<e\>\"", "]"}]}], ",", 
       RowBox[{
        RowBox[{"mSM", "[", "\"\<Bplus\>\"", "]"}], "-", 
        RowBox[{"mSM", "[", "\"\<Dstar\>\"", "]"}], "-", 
        RowBox[{"mSM", "[", "\"\<mu\>\"", "]"}]}], ",", 
       RowBox[{
        RowBox[{"mSM", "[", "\"\<Bplus\>\"", "]"}], "-", 
        RowBox[{"mSM", "[", "\"\<Dstar\>\"", "]"}], "-", 
        RowBox[{"mSM", "[", "\"\<tau\>\"", "]"}]}]}], "}"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"MapThread", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"\[Omega]HNL", "[", 
          RowBox[{
          "#1", ",", "Facility", ",", "\"\<B-3-body\>\"", ",", "mN_"}], "]"}],
          "=", "#2"}], ")"}], "&"}], ",", 
      RowBox[{"{", 
       RowBox[{"ListHNLs", ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"fbtobplus", "[", "Facility", "]"}], "+", 
           RowBox[{"fbtob0", "[", "Facility", "]"}]}], ")"}], 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"UnitStep", "[", 
             RowBox[{
              RowBox[{"mMax", "[", 
               RowBox[{
                RowBox[{"ListHNLs", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], ",", "\"\<B-3-body\>\""}], 
               "]"}], "-", "mN"}], "]"}], "*", 
            RowBox[{"brsum", "[", 
             RowBox[{"{", 
              RowBox[{
              "\"\<bplus-D0bareN.m\>\"", ",", "\"\<bplus-D0starbareN.m\>\"", 
               ",", "\"\<b0-DeN.m\>\"", ",", "\"\<b0-DminusstareN.m\>\""}], 
              "}"}], "]"}]}], ",", 
           RowBox[{
            RowBox[{"UnitStep", "[", 
             RowBox[{
              RowBox[{"mMax", "[", 
               RowBox[{
                RowBox[{"ListHNLs", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], ",", "\"\<B-3-body\>\""}], 
               "]"}], "-", "mN"}], "]"}], "*", 
            RowBox[{"brsum", "[", 
             RowBox[{"{", 
              RowBox[{
              "\"\<bplus-D0barmuN.m\>\"", ",", "\"\<bplus-D0starbarmuN.m\>\"",
                ",", "\"\<b0-DmuN.m\>\"", ",", "\"\<b0-DminusstarmuN.m\>\""}],
               "}"}], "]"}]}], ",", 
           RowBox[{
            RowBox[{"UnitStep", "[", 
             RowBox[{
              RowBox[{"mMax", "[", 
               RowBox[{
                RowBox[{"ListHNLs", "[", 
                 RowBox[{"[", "3", "]"}], "]"}], ",", "\"\<B-3-body\>\""}], 
               "]"}], "-", "mN"}], "]"}], "*", 
            RowBox[{"brsum", "[", 
             RowBox[{"{", 
              RowBox[{
              "\"\<bplus-D0bartauN.m\>\"", ",", 
               "\"\<bplus-D0starbartauN.m\>\"", ",", "\"\<b0-DtauN.m\>\"", 
               ",", "\"\<b0-DminusstartauN.m\>\""}], "}"}], "]"}]}]}], 
          "}"}]}]}], "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", ",", 
   RowBox[{"{", 
    RowBox[{"Facility", ",", "FacilitiesList"}], "}"}]}], 
  "]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.913270144260224*^9, 3.913270341682565*^9}, {
   3.913270376720025*^9, 3.91327048521688*^9}, {3.913270543232196*^9, 
   3.913270561396222*^9}, {3.913270671662222*^9, 3.9132707580510583`*^9}, {
   3.913273977191364*^9, 3.913274085904173*^9}, 3.913279538985731*^9, {
   3.9132817096656065`*^9, 3.9132817185273*^9}, {3.913281753161658*^9, 
   3.913281859858015*^9}, {3.913287800098625*^9, 3.913287801039863*^9}, {
   3.9132884442004223`*^9, 3.91328845442124*^9}, {3.913288525883397*^9, 
   3.9132885467583985`*^9}, {3.913288598308974*^9, 3.913288698393011*^9}, {
   3.9132887549654484`*^9, 3.913288755142268*^9}, {3.913372018002084*^9, 
   3.913372071821846*^9}, {3.913374447357003*^9, 3.91337447826466*^9}, {
   3.913374876907457*^9, 3.913374940189007*^9}, {3.913374973407539*^9, 
   3.913374998627187*^9}, {3.913394747546246*^9, 3.91339477867945*^9}, 
   3.9138833260601025`*^9},
 CellTags->"Evaluation",
 CellLabel->
  "In[861]:=",ExpressionUUID->"5a037ee8-f108-4a7f-b5e1-64caca67a36d"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Decays of D/\[Tau]", "Subsection",
 CellChangeTimes->{{3.9132691723884573`*^9, 3.9132691800581856`*^9}},
 CellTags->
  "Evaluation",ExpressionUUID->"9a37a07e-462a-4aaf-b23b-e1694ff76248"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Do", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"MapThread", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\[Omega]HNL", "[", 
           RowBox[{
           "#1", ",", "Facility", ",", "\"\<D-2-body\>\"", ",", "mN_"}], 
           "]"}], "=", "#2"}], ")"}], "&"}], ",", 
       RowBox[{"{", 
        RowBox[{"ListHNLs", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"fctods", "[", "Facility", "]"}], "*", 
             RowBox[{"brint", "[", 
              RowBox[{"mN", ",", "\"\<ds-eN.m\>\""}], "]"}]}], "+", 
            RowBox[{
             RowBox[{"fctodplus", "[", "Facility", "]"}], "*", 
             RowBox[{"brint", "[", 
              RowBox[{"mN", ",", "\"\<dplus-eN.m\>\""}], "]"}]}]}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"fctods", "[", "Facility", "]"}], "*", 
             RowBox[{"brint", "[", 
              RowBox[{"mN", ",", "\"\<ds-muN.m\>\""}], "]"}]}], "+", 
            RowBox[{
             RowBox[{"fctodplus", "[", "Facility", "]"}], "*", 
             RowBox[{"brint", "[", 
              RowBox[{"mN", ",", "\"\<dplus-muN.m\>\""}], "]"}]}]}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"fctods", "[", "Facility", "]"}], "*", 
             RowBox[{"brint", "[", 
              RowBox[{"mN", ",", "\"\<ds-tauN.m\>\""}], "]"}]}], "+", 
            RowBox[{
             RowBox[{"fctodplus", "[", "Facility", "]"}], "*", 
             RowBox[{"brint", "[", 
              RowBox[{"mN", ",", "\"\<dplus-tauN.m\>\""}], "]"}]}]}]}], 
          "}"}]}], "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"MapThread", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\[Omega]HNL", "[", 
           RowBox[{
           "#1", ",", "Facility", ",", "\"\<D-3-body\>\"", ",", "mN_"}], 
           "]"}], "=", "#2"}], ")"}], "&"}], ",", 
       RowBox[{"{", 
        RowBox[{"ListHNLs", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"fctodplus", "[", "Facility", "]"}], "*", 
             RowBox[{"brsum", "[", 
              RowBox[{"{", 
               RowBox[{
               "\"\<dplus-K0eN.m\>\"", ",", "\"\<dplus-K0stareN.m\>\""}], 
               "}"}], "]"}]}], "+", 
            RowBox[{
             RowBox[{"fctod0", "[", "Facility", "]"}], "*", 
             RowBox[{"brsum", "[", 
              RowBox[{"{", 
               RowBox[{
               "\"\<d0-KplusstareN.m\>\"", ",", "\"\<d0-KpluseN.m\>\""}], 
               "}"}], "]"}]}]}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"fctodplus", "[", "Facility", "]"}], "*", 
             RowBox[{"brsum", "[", 
              RowBox[{"{", 
               RowBox[{
               "\"\<dplus-K0muN.m\>\"", ",", "\"\<dplus-K0starmuN.m\>\""}], 
               "}"}], "]"}]}], "+", 
            RowBox[{
             RowBox[{"fctod0", "[", "Facility", "]"}], "*", 
             RowBox[{"brsum", "[", 
              RowBox[{"{", 
               RowBox[{
               "\"\<d0-KplusstarmuN.m\>\"", ",", "\"\<d0-KplusmuN.m\>\""}], 
               "}"}], "]"}]}]}], ",", "0."}], "}"}]}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Omega]HNL", "[", 
       RowBox[{
        RowBox[{"ListHNLs", "[", 
         RowBox[{"[", "3", "]"}], "]"}], ",", "Facility", ",", 
        "\"\<\[Tau]-3-body\>\"", ",", "mN_"}], "]"}], "=", 
      RowBox[{
       RowBox[{"fctods", "[", "Facility", "]"}], "*", "fdstau", "*", 
       RowBox[{"brint", "[", 
        RowBox[{"mN", ",", "\"\<tau-lbarnuN.m\>\""}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Omega]HNL", "[", 
       RowBox[{
        RowBox[{"ListHNLs", "[", 
         RowBox[{"[", "3", "]"}], "]"}], ",", "Facility", ",", 
        "\"\<\[Tau]-2-body\>\"", ",", "mN_"}], "]"}], "=", 
      RowBox[{
       RowBox[{"fctods", "[", "Facility", "]"}], "*", "fdstau", "*", 
       RowBox[{"brsum", "[", 
        RowBox[{"{", 
         RowBox[{"\"\<tau-piN.m\>\"", ",", "\"\<tau-KN.m\>\""}], "}"}], 
        "]"}]}]}], ";"}], "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{"Facility", ",", "FacilitiesList"}], "}"}]}], "]"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Given", " ", 
     SubscriptBox["N", "events"]}], ",", " ", 
    RowBox[{
    "for", " ", "the", " ", "given", " ", "processes", " ", "list", " ", "it",
      " ", "is", " ", "splitted", " ", "into", " ", "fractions", " ", 
     "corresponding", " ", "to", " ", "the", " ", "weights"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NeventsSplitterHNL", "[", 
   RowBox[{
   "HNL_", ",", "Facility_", ",", "proclist_", ",", "mN_", ",", "Nevents_"}], 
   "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"proclistsel", "=", 
      RowBox[{"Select", "[", 
       RowBox[{"proclist", ",", 
        RowBox[{
         RowBox[{
          RowBox[{"MemberQ", "[", 
           RowBox[{
            RowBox[{"ProcessesListAll", "[", "HNL", "]"}], ",", "#"}], "]"}], 
          "==", "True"}], "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Omega]list", "=", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"proclistsel", ",", 
         RowBox[{
          RowBox[{
           RowBox[{"\[Omega]HNL", "[", 
            RowBox[{"HNL", ",", "Facility", ",", "#", ",", "mN"}], "]"}], 
           "&"}], "/@", "proclistsel"}]}], "}"}], "//", "Transpose"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Nevlist", "=", 
      RowBox[{"SortBy", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            RowBox[{"IntegerPart", "[", 
             FractionBox[
              RowBox[{"Nevents", 
               RowBox[{"#", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], 
              RowBox[{
               RowBox[{"\[Omega]list", "[", 
                RowBox[{"[", 
                 RowBox[{"All", ",", "2"}], "]"}], "]"}], "//", "Total"}]], 
             "]"}]}], "}"}], "&"}], "/@", "\[Omega]list"}], ",", 
        RowBox[{
         RowBox[{"-", 
          RowBox[{"#", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], "&"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"Nevlist", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "[", 
       RowBox[{"[", "2", "]"}], "]"}], "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Nevlist", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "[", 
        RowBox[{"[", "2", "]"}], "]"}], "+", "Nevents", "-", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Nevlist", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "2"}], "]"}], "]"}], "//", "Total"}], 
        ")"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Select", "[", 
      RowBox[{"Nevlist", ",", 
       RowBox[{
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "2", "]"}], "]"}], ">", "0"}], "&"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"NeventsSplitterHNL", "[", 
  RowBox[{
   RowBox[{"ListHNLs", "[", 
    RowBox[{"[", "3", "]"}], "]"}], ",", "\"\<SPS\>\"", ",", 
   RowBox[{"{", 
    RowBox[{
    "\"\<D-2-body\>\"", ",", "\"\<D-3-body\>\"", ",", "\"\<\[Tau]-2-body\>\"",
      ",", "\"\<\[Tau]-3-body\>\""}], "}"}], ",", "0.9", ",", "20"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"NeventsSplitterHNL", "[", 
  RowBox[{
   RowBox[{"ListHNLs", "[", 
    RowBox[{"[", "3", "]"}], "]"}], ",", "\"\<LHC\>\"", ",", 
   RowBox[{"{", 
    RowBox[{"\"\<B-2-body\>\"", ",", "\"\<B-3-body\>\"", ",", "\"\<Bc\>\""}], 
    "}"}], ",", "2.9", ",", "20"}], "]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.9132731357763443`*^9, 3.913273216760144*^9}, 
   3.913273263665794*^9, {3.9132733049895763`*^9, 3.913273471998028*^9}, {
   3.91327371824101*^9, 3.913273942741333*^9}, {3.913274120175879*^9, 
   3.913274120442904*^9}, {3.9132741549946966`*^9, 3.91327421351707*^9}, {
   3.913276161287152*^9, 3.913276207832935*^9}, {3.9132762934467735`*^9, 
   3.913276308307518*^9}, {3.913281871304182*^9, 3.913281876718135*^9}, {
   3.913284037846414*^9, 3.913284038411223*^9}, {3.9132864328642564`*^9, 
   3.91328644974983*^9}, {3.913287803392355*^9, 3.9132878065281878`*^9}, {
   3.913288761799321*^9, 3.913288790823711*^9}, {3.9132888863635464`*^9, 
   3.913288916902711*^9}, {3.913372102704761*^9, 3.9133721434651427`*^9}, {
   3.913374489546965*^9, 3.9133745132772784`*^9}, {3.913374588937298*^9, 
   3.913374687301255*^9}, {3.9133750013933706`*^9, 3.913375010712429*^9}, {
   3.913375291327817*^9, 3.913375343602026*^9}, {3.913375389317625*^9, 
   3.913375392158079*^9}, {3.913394694790463*^9, 3.913394727761153*^9}, 
   3.913395240250868*^9, {3.930990193006793*^9, 3.930990233729076*^9}, {
   3.930990322174964*^9, 3.930990367419683*^9}},
 CellTags->
  "Evaluation",ExpressionUUID->"1505a48e-36d3-4bc5-9467-a888c370264b"],

Cell[BoxData[
 FormBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"\<\"\[Tau]-3-body\"\>", "11"},
     {"\<\"\[Tau]-2-body\"\>", "9"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}], TraditionalForm]], "Output",
 CellChangeTimes->{3.930211467591851*^9, 3.930822696520698*^9},
 CellTags->"Evaluation",
 CellLabel->
  "Out[866]=",ExpressionUUID->"464c05b8-6c31-4e7c-bcd7-e62fe007952c"],

Cell[BoxData[
 FormBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"\<\"Bc\"\>", "12"},
     {"\<\"B-2-body\"\>", "8"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}], TraditionalForm]], "Output",
 CellChangeTimes->{3.930211467591851*^9, 3.930822696523633*^9},
 CellTags->"Evaluation",
 CellLabel->
  "Out[867]=",ExpressionUUID->"550e0412-0a9b-49d7-8914-30bbf0cfd2dc"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   RowBox[{"Squared", " ", "matrix", " ", "elements"}], TraditionalForm]],
  ExpressionUUID->"771381b3-bca5-4a62-a89a-bc2d700db8d4"],
 " for 3-body processes (Figs. 4,5 + Appendix A.2 from \
https://arxiv.org/pdf/1805.08567.pdf)"
}], "Section",
 CellChangeTimes->{{3.877714876081035*^9, 3.877714881118578*^9}, {
  3.877714952554419*^9, 3.8777149972440877`*^9}, {3.885110697426193*^9, 
  3.885110705432305*^9}, {3.9132692555740337`*^9, 3.9132692637276993`*^9}, {
  3.9133700797906938`*^9, 3.913370082308047*^9}},
 CellTags->
  "Evaluation",ExpressionUUID->"87cf203d-07c5-44e4-84d2-b9c06c63b425"],

Cell[CellGroupData[{

Cell["Definitions", "Subsection",
 CellChangeTimes->{{3.9133724693753757`*^9, 3.913372470755105*^9}},
 CellTags->
  "Evaluation",ExpressionUUID->"26146eba-46ad-47c9-a195-57d58effde05"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"MV", "=", 
   RowBox[{"Association", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Kplus", "\[Rule]", "0.892"}], " ", ",", 
      RowBox[{"Dplus", "\[Rule]", "2.01"}], ",", 
      RowBox[{"D0", "\[Rule]", "2.01"}], ",", 
      RowBox[{"Ds", "\[Rule]", "2.11"}], ",", 
      RowBox[{"Bplus", "\[Rule]", "5.32"}], ",", 
      RowBox[{"B0", "\[Rule]", "5.32"}], ",", 
      RowBox[{"Bs", "\[Rule]", "5.415"}], ",", 
      RowBox[{"Bc", "\[Rule]", "6.33"}]}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fH", "=", 
   RowBox[{"Association", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"piplus", "\[Rule]", " ", "0.13"}], ",", 
      RowBox[{"Kplus", "\[Rule]", " ", "0.156"}], ",", 
      RowBox[{"Dplus", "\[Rule]", " ", "0.212"}], ",", 
      RowBox[{"Ds", "\[Rule]", " ", "0.249"}], ",", 
      RowBox[{"Bplus", "\[Rule]", " ", "0.187"}], ",", 
      RowBox[{"Bs", "\[Rule]", " ", "0.227"}], ",", 
      RowBox[{"B0", "\[Rule]", " ", "0.191"}], ",", 
      RowBox[{"Bc", "\[Rule]", " ", "0.48"}]}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MH", "=", 
   RowBox[{"Association", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"piplus", "\[Rule]", " ", "0.1396"}], ",", 
      RowBox[{"pi0", "\[Rule]", "0.135"}], " ", ",", 
      RowBox[{"Kplus", "\[Rule]", " ", "0.494"}], ",", 
      RowBox[{"K0", "\[Rule]", "0.498"}], ",", 
      RowBox[{"eta", "\[Rule]", " ", "0.548"}], ",", 
      RowBox[{"rho0", "\[Rule]", "0.775"}], ",", 
      RowBox[{"rhoplus", "\[Rule]", "0.775"}], ",", 
      RowBox[{"Dplus", "\[Rule]", " ", "1.87"}], ",", 
      RowBox[{"D0", "\[Rule]", " ", "1.865"}], ",", 
      RowBox[{"Ds", "\[Rule]", " ", "1.97"}], ",", 
      RowBox[{"Dsstar", "\[Rule]", " ", "2.11"}], ",", 
      RowBox[{"etac", "\[Rule]", "2.98"}], " ", ",", 
      RowBox[{"Bplus", "\[Rule]", " ", "5.279"}], ",", 
      RowBox[{"B0", "\[Rule]", "5.279"}], " ", ",", 
      RowBox[{"Bs", "\[Rule]", " ", "5.37"}], ",", 
      RowBox[{"Bc", "\[Rule]", "6.28"}], ",", 
      RowBox[{"Dplusstar", "\[Rule]", "2.01"}], ",", 
      RowBox[{"D0star", "\[Rule]", "2.007"}], ",", " ", 
      RowBox[{"Kplusstar", "\[Rule]", "0.892"}], ",", 
      RowBox[{"K0star", "\[Rule]", "0.892"}]}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MV", "=", 
   RowBox[{"Association", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Kplus", "\[Rule]", "0.892"}], " ", ",", 
      RowBox[{"Dplus", "\[Rule]", "2.01"}], ",", 
      RowBox[{"D0", "\[Rule]", "2.01"}], ",", 
      RowBox[{"Ds", "\[Rule]", "2.11"}], ",", 
      RowBox[{"Bplus", "\[Rule]", "5.32"}], ",", 
      RowBox[{"B0", "\[Rule]", "5.32"}], ",", 
      RowBox[{"Bs", "\[Rule]", "5.415"}], ",", 
      RowBox[{"Bc", "\[Rule]", "6.33"}]}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MS", "=", 
   RowBox[{"Association", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Kplus", "\[Rule]", " ", "1.43"}], ",", 
      RowBox[{"Dplus", "\[Rule]", "2.4"}], ",", 
      RowBox[{"D0", "\[Rule]", "2.4"}], ",", 
      RowBox[{"Ds", "\[Rule]", "2.32"}], ",", 
      RowBox[{"Bplus", "\[Rule]", "5.68"}], ",", 
      RowBox[{"B0", "\[Rule]", "5.68"}], ",", 
      RowBox[{"Bs", "\[Rule]", "5.68"}], ",", 
      RowBox[{"Bc", "\[Rule]", "6.42"}]}], "}"}], "]"}]}], ";"}]}], "Input",
 CellTags->"Evaluation",
 CellLabel->
  "In[868]:=",ExpressionUUID->"42f2e7ee-39f5-4f67-a823-602471499d45"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[Cell[BoxData[
 FormBox[
  RowBox[{"B", "\[Rule]", 
   RowBox[{
    SuperscriptBox["D", "*"], "+", "N", "+", "l"}]}], 
  TraditionalForm]],ExpressionUUID->"8b2b6002-e6b3-4cff-8fbb-d422d9068a22"]], \
"Subsection",
 CellChangeTimes->{{3.877689696838707*^9, 3.877689702643469*^9}, {
  3.877715012482712*^9, 3.877715012482712*^9}},
 CellTags->
  "Evaluation",ExpressionUUID->"211335e5-7f8a-43a9-8ce5-ece646b965e2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Form", "-", "factors"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"ParsDtoK", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{
      "1.03", ",", "0.76", ",", "0.66", ",", "0.49", ",", " ", "0.27", ",", 
       "0.17", ",", "0.30", ",", "0.67", ",", "0", ",", "0", ",", "0.20", ",",
        " ", "0.16", ",", "1.969", ",", "2.112"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ParsBtoD", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{
      "0.76", ",", "0.69", ",", "0.66", ",", "0.62", ",", "0.57", ",", "0.59",
        ",", "0.78", ",", "1.40", ",", "0", ",", "0", ",", "0", ",", "0.41", 
       ",", "6.275", ",", "6.331"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ParsBto\[Rho]", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{
      "0.295", ",", "0.231", ",", "0.269", ",", "0.282", ",", "0.875", ",", 
       "0.796", ",", "0.54", ",", "1.34", ",", "0", ",", "0.055", ",", "0", 
       ",", 
       RowBox[{"-", "0.21"}], ",", "5.279", ",", "5.325"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ParsBstoDs", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{
      "0.95", ",", "0.67", ",", "0.70", ",", "0.75", ",", "0.372", ",", 
       "0.350", ",", "0.463", ",", "1.04", ",", "0.561", ",", "0.600", ",", 
       "0.510", ",", "0.070", ",", "6.275", ",", "6.331"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ParsBstoK", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{"0.291", ",", "0.289", ",", "0.287", ",", "0.286", ",", 
       RowBox[{"-", "0.516"}], ",", 
       RowBox[{"-", "0.383"}], ",", "0", ",", "1.05", ",", "2.10", ",", 
       "1.58", ",", "1.06", ",", 
       RowBox[{"-", "0.074"}], ",", "5.367", ",", "5.415"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ParsHtoV", "[", 
     RowBox[{"H_", ",", "V_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"Association", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"Dplus", ",", "K0star"}], "}"}], "\[Rule]", " ", 
         "ParsDtoK"}], ",", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"D0", ",", "Kplusstar"}], "}"}], "\[Rule]", " ", 
         "ParsDtoK"}], ",", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"Bplus", ",", "D0star"}], "}"}], "\[Rule]", "ParsBtoD"}], 
        ",", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"B0", ",", "Dplusstar"}], "}"}], "\[Rule]", "ParsBtoD"}], 
        ",", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"Bplus", ",", "rho0"}], "}"}], "\[Rule]", "ParsBto\[Rho]"}],
         ",", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"B0", ",", "rhoplus"}], "}"}], "\[Rule]", "ParsBto\[Rho]"}],
         ",", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"Bs", ",", "Dsstar"}], "}"}], "\[Rule]", "ParsBstoDs"}], 
        ",", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"Bs", ",", "Kplusstar"}], "}"}], "\[Rule]", "ParsBstoK"}]}],
        "}"}], "]"}], "[", 
     RowBox[{"{", 
      RowBox[{"H", ",", "V"}], "}"}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"DipoleForm", "[", 
      RowBox[{"a_", ",", " ", "b_", ",", " ", "mhv_", ",", " ", "q2_"}], 
      "]"}], ":=", 
     FractionBox["1", 
      RowBox[{"1", "-", 
       RowBox[{"a", " ", 
        FractionBox["q2", 
         RowBox[{" ", 
          SuperscriptBox["mhv", "2"]}]]}], "-", 
       RowBox[{"b", " ", 
        FractionBox[
         SuperscriptBox["q2", "2"], 
         RowBox[{" ", 
          SuperscriptBox["mhv", "4"]}]]}]}]]}], ";"}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{
     RowBox[{"gVHtoV", "[", 
      RowBox[{"H_", ",", " ", "V_", ",", "q2_"}], "]"}], ":=", 
     RowBox[{
      FractionBox[
       RowBox[{
        RowBox[{"ParsHtoV", "[", 
         RowBox[{"H", ",", "V"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", " ", "-", " ", 
          FractionBox["q2", 
           SuperscriptBox[
            RowBox[{
             RowBox[{"ParsHtoV", "[", 
              RowBox[{"H", ",", "V"}], "]"}], "[", 
             RowBox[{"[", "14", "]"}], "]"}], "2"]]}], ")"}], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"MH", "[", "H", "]"}], "+", " ", 
          RowBox[{"MH", "[", "V", "]"}]}], " ", ")"}]}]], 
      RowBox[{"DipoleForm", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"ParsHtoV", "[", 
          RowBox[{"H", ",", "V"}], "]"}], "[", 
         RowBox[{"[", "5", "]"}], "]"}], ",", " ", 
        RowBox[{
         RowBox[{"ParsHtoV", "[", 
          RowBox[{"H", ",", "V"}], "]"}], "[", 
         RowBox[{"[", "9", "]"}], "]"}], ",", 
        RowBox[{
         RowBox[{"ParsHtoV", "[", 
          RowBox[{"H", ",", "V"}], "]"}], "[", 
         RowBox[{"[", "14", "]"}], "]"}], ",", " ", "q2"}], "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"fVHtoV", "[", 
      RowBox[{"H_", ",", " ", "V_", ",", " ", "q2_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"MH", "[", "H", "]"}], "+", " ", 
        RowBox[{"MH", "[", "V", "]"}]}], " ", ")"}], " ", 
      RowBox[{
       RowBox[{"ParsHtoV", "[", 
        RowBox[{"H", ",", "V"}], "]"}], "[", 
       RowBox[{"[", "3", "]"}], "]"}], "*", 
      RowBox[{"DipoleForm", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"ParsHtoV", "[", 
          RowBox[{"H", ",", "V"}], "]"}], "[", 
         RowBox[{"[", "7", "]"}], "]"}], ",", " ", 
        RowBox[{
         RowBox[{"ParsHtoV", "[", 
          RowBox[{"H", ",", "V"}], "]"}], "[", 
         RowBox[{"[", "11", "]"}], "]"}], ",", 
        RowBox[{
         RowBox[{"ParsHtoV", "[", 
          RowBox[{"H", ",", "V"}], "]"}], "[", 
         RowBox[{"[", "14", "]"}], "]"}], ",", "q2"}], "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"aplHtoV", "[", 
      RowBox[{"H_", ",", " ", "V_", ",", " ", "q2_"}], "]"}], ":=", " ", 
     RowBox[{
      FractionBox[
       RowBox[{"-", "1"}], 
       RowBox[{
        RowBox[{"MH", "[", "H", "]"}], "+", " ", 
        RowBox[{"MH", "[", "V", "]"}], " "}]], 
      RowBox[{
       RowBox[{"ParsHtoV", "[", 
        RowBox[{"H", ",", "V"}], "]"}], "[", 
       RowBox[{"[", "4", "]"}], "]"}], "*", 
      RowBox[{"DipoleForm", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"ParsHtoV", "[", 
          RowBox[{"H", ",", "V"}], "]"}], "[", 
         RowBox[{"[", "8", "]"}], "]"}], ",", " ", 
        RowBox[{
         RowBox[{"ParsHtoV", "[", 
          RowBox[{"H", ",", "V"}], "]"}], "[", 
         RowBox[{"[", "12", "]"}], "]"}], ",", 
        RowBox[{
         RowBox[{"ParsHtoV", "[", 
          RowBox[{"H", ",", "V"}], "]"}], "[", 
         RowBox[{"[", "14", "]"}], "]"}], ",", "q2"}], "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"aminHtoV", "[", 
      RowBox[{"H_", ",", " ", "V_", ",", " ", "q2_"}], "]"}], ":=", " ", 
     RowBox[{
      FractionBox["1", "q2"], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", "  ", 
         RowBox[{"MH", "[", "V", "]"}], " ", 
         FractionBox[
          RowBox[{
           RowBox[{"ParsHtoV", "[", 
            RowBox[{"H", ",", "V"}], "]"}], "[", 
           RowBox[{"[", "2", "]"}], "]"}], 
          RowBox[{"1", " ", "-", " ", 
           FractionBox["q2", 
            SuperscriptBox[
             RowBox[{
              RowBox[{"ParsHtoV", "[", 
               RowBox[{"H", ",", "V"}], "]"}], "[", 
              RowBox[{"[", "13", "]"}], "]"}], "2"]]}]], 
         RowBox[{"DipoleForm", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"ParsHtoV", "[", 
             RowBox[{"H", ",", "V"}], "]"}], "[", 
            RowBox[{"[", "6", "]"}], "]"}], ",", 
           RowBox[{
            RowBox[{"ParsHtoV", "[", 
             RowBox[{"H", ",", "V"}], "]"}], "[", 
            RowBox[{"[", "10", "]"}], "]"}], ",", 
           RowBox[{
            RowBox[{"ParsHtoV", "[", 
             RowBox[{"H", ",", "V"}], "]"}], "[", 
            RowBox[{"[", "14", "]"}], "]"}], ",", " ", "q2"}], "]"}]}], "-", 
        " ", 
        RowBox[{"fVHtoV", "[", 
         RowBox[{"H", ",", "V", ",", "q2"}], "]"}], "-", " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"MH", "[", "H", "]"}], "2"], "-", " ", 
           SuperscriptBox[
            RowBox[{
             RowBox[{"MH", "[", "V", "]"}], " "}], "2"]}], ")"}], 
         RowBox[{"aplHtoV", "[", 
          RowBox[{"H", ",", "V", ",", "q2"}], "]"}]}]}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Squared", " ", "matrix", " ", "elements"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"HadronicCurrentVectorPart", "=", 
     RowBox[{
      RowBox[{"I", "*", "g", "*", 
       RowBox[{"LeviCivita", "[", 
        RowBox[{"\[Mu]", ",", "\[Nu]", ",", "\[Sigma]", ",", "\[Rho]"}], 
        "]"}], "*", 
       RowBox[{"PolarizationVector", "[", 
        RowBox[{"k1", ",", "\[Nu]"}], "]"}], "*", 
       RowBox[{"FV", "[", 
        RowBox[{
         RowBox[{"k", "+", "k1"}], ",", "\[Sigma]"}], "]"}], "*", 
       RowBox[{"FV", "[", 
        RowBox[{
         RowBox[{"k", "-", "k1"}], ",", "\[Rho]"}], "]"}]}], "//", 
      "Contract"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"HadronicCurrentAxialPart", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"f", "*", 
        RowBox[{"PolarizationVector", "[", 
         RowBox[{"k1", ",", "\[Mu]"}], "]"}]}], "+", 
       RowBox[{"aplus", "*", 
        RowBox[{"PolarizationVector", "[", 
         RowBox[{"k1", ",", "\[Kappa]"}], "]"}], "*", 
        RowBox[{"FV", "[", 
         RowBox[{"k", ",", "\[Kappa]"}], "]"}], "*", 
        RowBox[{"FV", "[", 
         RowBox[{
          RowBox[{"k", "+", "k1"}], ",", "\[Mu]"}], "]"}]}], "+", 
       RowBox[{"aminus", "*", 
        RowBox[{"PolarizationVector", "[", 
         RowBox[{"k1", ",", "\[Kappa]"}], "]"}], "*", 
        RowBox[{"FV", "[", 
         RowBox[{"k", ",", "\[Kappa]"}], "]"}], "*", 
        RowBox[{"FV", "[", 
         RowBox[{
          RowBox[{"k", "-", "k1"}], ",", "\[Mu]"}], "]"}]}]}], "//", 
      "Contract"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MBdecay3Body", "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"SpinorVBar", "[", 
         RowBox[{"k2", ",", "m2"}], "]"}], ".", 
        RowBox[{"GA", "[", "\[Mu]", "]"}], ".", 
        RowBox[{"(", 
         RowBox[{"1", "-", "GA5"}], ")"}], ".", 
        RowBox[{"SpinorU", "[", 
         RowBox[{"k3", ",", "m3"}], "]"}]}], 
       RowBox[{"(", 
        RowBox[{
        "HadronicCurrentVectorPart", "-", "HadronicCurrentAxialPart"}], 
        ")"}]}], "//", "Contract"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MBdecay3BodyStar", "=", 
     RowBox[{"MBdecay3Body", "//", "ComplexConjugate"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MBdecay3BodySquaredTemp", "=", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"Simplify", "[", 
            RowBox[{"Expand", "[", 
             RowBox[{"DoPolarizationSums", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"FermionSpinSum", "[", 
                   RowBox[{"MBdecay3Body", "*", "MBdecay3BodyStar"}], "]"}], "/.", 
                  RowBox[{"DiracTrace", "\[Rule]", "TR"}]}], "//", 
                 "Contract"}], "//", "Simplify"}], ",", "k1"}], "]"}], "]"}], 
            "]"}], "/.", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"aminus", "\[Rule]", 
              RowBox[{"aminHtoV", "[", 
               RowBox[{"Bplus", ",", " ", "D0star", ",", " ", 
                RowBox[{
                 RowBox[{"ScalarProduct", "[", 
                  RowBox[{
                   RowBox[{"k", "-", "k1"}], ",", 
                   RowBox[{"k", "-", "k1"}]}], "]"}], "//", 
                 "ExpandScalarProduct"}]}], "]"}]}], ",", 
             RowBox[{"aplus", "\[Rule]", 
              RowBox[{"aplHtoV", "[", 
               RowBox[{"Bplus", ",", " ", "D0star", ",", " ", 
                RowBox[{
                 RowBox[{"ScalarProduct", "[", 
                  RowBox[{
                   RowBox[{"k", "-", "k1"}], ",", 
                   RowBox[{"k", "-", "k1"}]}], "]"}], "//", 
                 "ExpandScalarProduct"}]}], "]"}]}], ",", 
             RowBox[{"g", "\[Rule]", 
              RowBox[{"gVHtoV", "[", 
               RowBox[{"Bplus", ",", " ", "D0star", ",", " ", 
                RowBox[{
                 RowBox[{"ScalarProduct", "[", 
                  RowBox[{
                   RowBox[{"k", "-", "k1"}], ",", 
                   RowBox[{"k", "-", "k1"}]}], "]"}], "//", 
                 "ExpandScalarProduct"}]}], "]"}]}], ",", 
             RowBox[{"f", "\[Rule]", 
              RowBox[{"fVHtoV", "[", 
               RowBox[{"Bplus", ",", " ", "D0star", ",", " ", 
                RowBox[{
                 RowBox[{"ScalarProduct", "[", 
                  RowBox[{
                   RowBox[{"k", "-", "k1"}], ",", 
                   RowBox[{"k", "-", "k1"}]}], "]"}], "//", 
                 "ExpandScalarProduct"}]}], "]"}]}]}], " ", "}"}]}], "//", 
          "Contract"}], ")"}], "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"ScalarProduct", "[", 
            RowBox[{"k", ",", "k"}], "]"}], "\[Rule]", "ProductKK"}], ",", 
          RowBox[{
           RowBox[{"ScalarProduct", "[", 
            RowBox[{"k1", ",", "k1"}], "]"}], "\[Rule]", "ProductK1K1"}], ",", 
          RowBox[{
           RowBox[{"ScalarProduct", "[", 
            RowBox[{"k2", ",", "k2"}], "]"}], "\[Rule]", "ProductK2K2"}], ",", 
          RowBox[{
           RowBox[{"ScalarProduct", "[", 
            RowBox[{"k3", ",", "k3"}], "]"}], "\[Rule]", "ProductK3K3"}]}], 
         "}"}]}], "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"ScalarProduct", "[", 
           RowBox[{"k", ",", "k1"}], "]"}], "\[Rule]", " ", 
          "ProductKK1energy"}], ",", 
         RowBox[{
          RowBox[{"ScalarProduct", "[", 
           RowBox[{"k2", ",", "k3"}], "]"}], "\[Rule]", "ProductK2K3energy"}],
          ",", 
         RowBox[{
          RowBox[{"ScalarProduct", "[", 
           RowBox[{"k1", ",", "k3"}], "]"}], "\[Rule]", "ProductK1K3energy"}],
          ",", 
         RowBox[{
          RowBox[{"ScalarProduct", "[", 
           RowBox[{"k", ",", "k3"}], "]"}], "\[Rule]", "ProductKK3energy"}], 
         ",", 
         RowBox[{
          RowBox[{"ScalarProduct", "[", 
           RowBox[{"k1", ",", "k2"}], "]"}], "\[Rule]", "ProductK1K2energy"}],
          ",", 
         RowBox[{
          RowBox[{"ScalarProduct", "[", 
           RowBox[{"k", ",", "k2"}], "]"}], "\[Rule]", "ProductKK2energy"}]}],
         "}"}]}], ")"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Msquared3Body", "[", 
      RowBox[{
       RowBox[{"ListHNLs", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", "\"\<B-3-body\>\"", ",", "mLLP_",
        ",", "E1_", ",", "E3_"}], "]"}], "=", 
     RowBox[{
      RowBox[{"MBdecay3BodySquaredTemp", "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"m", "\[Rule]", 
          RowBox[{"mSM", "[", "\"\<Bplus\>\"", "]"}]}], ",", 
         RowBox[{"m1", "\[Rule]", " ", 
          RowBox[{"mSM", "[", "\"\<Dstar\>\"", "]"}]}], ",", 
         RowBox[{"m2", "\[Rule]", 
          RowBox[{"mSM", "[", "\"\<e\>\"", "]"}]}], ",", 
         RowBox[{"m3", "\[Rule]", "mLLP"}]}], "}"}]}], "//", "Simplify"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Msquared3Body", "[", 
      RowBox[{
       RowBox[{"ListHNLs", "[", 
        RowBox[{"[", "2", "]"}], "]"}], ",", "\"\<B-3-body\>\"", ",", "mLLP_",
        ",", "E1_", ",", "E3_"}], "]"}], "=", 
     RowBox[{
      RowBox[{"MBdecay3BodySquaredTemp", "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"m", "\[Rule]", 
          RowBox[{"mSM", "[", "\"\<Bplus\>\"", "]"}]}], ",", 
         RowBox[{"m1", "\[Rule]", " ", 
          RowBox[{"mSM", "[", "\"\<Dstar\>\"", "]"}]}], ",", 
         RowBox[{"m2", "\[Rule]", 
          RowBox[{"mSM", "[", "\"\<mu\>\"", "]"}]}], ",", 
         RowBox[{"m3", "\[Rule]", "mLLP"}]}], "}"}]}], "//", "Simplify"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Msquared3Body", "[", 
      RowBox[{
       RowBox[{"ListHNLs", "[", 
        RowBox[{"[", "3", "]"}], "]"}], ",", "\"\<B-3-body\>\"", ",", "mLLP_",
        ",", "E1_", ",", "E3_"}], "]"}], "=", 
     RowBox[{
      RowBox[{"MBdecay3BodySquaredTemp", "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"m", "\[Rule]", 
          RowBox[{"mSM", "[", "\"\<Bplus\>\"", "]"}]}], ",", 
         RowBox[{"m1", "\[Rule]", " ", 
          RowBox[{"mSM", "[", "\"\<Dstar\>\"", "]"}]}], ",", 
         RowBox[{"m2", "\[Rule]", 
          RowBox[{"mSM", "[", "\"\<tau\>\"", "]"}]}], ",", 
         RowBox[{"m3", "\[Rule]", "mLLP"}]}], "}"}]}], "//", "Simplify"}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.877689744528354*^9, 3.877689758854301*^9}, {
  3.877716862057774*^9, 3.877716862198804*^9}, {3.913275199558935*^9, 
  3.913275219798382*^9}, {3.913371892350828*^9, 3.9133718923573923`*^9}, {
  3.9133721593539104`*^9, 3.913372165426217*^9}, {3.913394684341289*^9, 
  3.9133946867221*^9}, {3.9154388001274257`*^9, 3.915438800186373*^9}},
 CellTags->"Evaluation",
 CellLabel->
  "In[873]:=",ExpressionUUID->"db561fe9-9b2a-4977-a5a6-1f008030ce10"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[Cell[BoxData[
 FormBox[
  RowBox[{
   SuperscriptBox["D", "+"], "\[Rule]", 
   RowBox[{
    SuperscriptBox["K", "0"], "+", "N", "+", "l"}]}], 
  TraditionalForm]],ExpressionUUID->"08008bd4-ae9d-4d29-8dc0-c970e751f865"]], \
"Subsection",
 CellChangeTimes->{{3.877689696838707*^9, 3.877689702643469*^9}, {
  3.877715012482712*^9, 3.877715049770177*^9}},
 CellTags->
  "Evaluation",ExpressionUUID->"36c14be9-b412-45f7-9bf3-03acd0e0de40"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Form", "-", "factors"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"fplus0", "[", 
     RowBox[{"H_", ",", "H1_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"Association", "[", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"Kplus", ",", "pi0"}], "}"}], "\[Rule]", " ", "0"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"Dplus", ",", "K0"}], "}"}], "\[Rule]", " ", "0.75"}], ",", 
        
        RowBox[{
         RowBox[{"{", 
          RowBox[{"D0", ",", "Kplus"}], "}"}], "\[Rule]", " ", "0.75"}], ",", 
        
        RowBox[{
         RowBox[{"{", 
          RowBox[{"Ds", ",", "eta"}], "}"}], "\[Rule]", " ", "0"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"Dplus", ",", "pi0"}], "}"}], "\[Rule]", " ", "0.61"}], ",", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"D0", ",", "piplus"}], "}"}], "\[Rule]", " ", "0.61"}], ",", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"Ds", ",", "K0"}], "}"}], "\[Rule]", " ", "0"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"Bplus", ",", "D0"}], "}"}], "\[Rule]", " ", "0.66"}], ",", 
        
        RowBox[{
         RowBox[{"{", 
          RowBox[{"B0", ",", "Dplus"}], "}"}], "\[Rule]", " ", "0.66"}], ",", 
        
        RowBox[{
         RowBox[{"{", 
          RowBox[{"Bs", ",", "Ds"}], "}"}], "\[Rule]", " ", "0.57"}], ",", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"Bc", ",", "etac"}], "}"}], "\[Rule]", " ", "0"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"Bplus", ",", "pi0"}], "}"}], "\[Rule]", " ", "0.27"}], ",", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"B0", ",", "piplus"}], "}"}], "\[Rule]", " ", "0.27"}], ",", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"Bs", ",", "Kplus"}], "}"}], "\[Rule]", " ", "0.323"}], ",", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"Bc", ",", "D0"}], "}"}], "\[Rule]", " ", "0"}], ",", " ", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"Bc", ",", "B0"}], "}"}], "\[Rule]", 
         RowBox[{"-", "0.58"}]}], ",", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"Bc", ",", "Bs"}], "}"}], "\[Rule]", 
         RowBox[{"-", "0.61"}]}]}], "}"}], "]"}], "[", 
     RowBox[{"{", 
      RowBox[{"H", ",", "H1"}], "}"}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"fplus", "[", 
      RowBox[{"H_", ",", "H1_", ",", "q2_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"fplus0", "[", 
       RowBox[{"H", ",", "H1"}], "]"}], "/", 
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"q2", "/", 
         SuperscriptBox[
          RowBox[{"MV", "[", "H", "]"}], "2"]}]}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"fminus", "[", 
      RowBox[{"H_", ",", "H1_", ",", "q2_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"fplus0", "[", 
       RowBox[{"H", ",", "H1"}], "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox[
             RowBox[{"MH", "[", "H", "]"}], "2"], "-", 
            SuperscriptBox[
             RowBox[{"MH", "[", "H1", "]"}], "2"]}], ")"}], 
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox[
             RowBox[{"MV", "[", "H", "]"}], "2"], "-", 
            SuperscriptBox[
             RowBox[{"MS", "[", "H", "]"}], "2"]}], ")"}]}], ")"}], "/", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox[
             RowBox[{"MS", "[", "H", "]"}], "2"], "-", "q2"}], ")"}], 
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox[
             RowBox[{"MV", "[", "H", "]"}], "2"], "-", "q2"}], ")"}]}], 
         ")"}]}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Squared", " ", "matrix", " ", "elements"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"HadronicCurrentDvectorPart", "=", 
     RowBox[{
      RowBox[{"fp", "*", 
       RowBox[{"FV", "[", 
        RowBox[{
         RowBox[{"k", "+", "k1"}], ",", "\[Mu]"}], "]"}]}], "+", 
      RowBox[{"fm", "*", 
       RowBox[{"FV", "[", 
        RowBox[{
         RowBox[{"k", "-", "k1"}], ",", "\[Mu]"}], "]"}]}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MDdecay3Body", "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"SpinorVBar", "[", 
          RowBox[{"k2", ",", "m2"}], "]"}], ".", 
         RowBox[{"GA", "[", "\[Mu]", "]"}], ".", 
         RowBox[{"(", 
          RowBox[{"1", "-", "GA5"}], ")"}], ".", 
         RowBox[{"SpinorU", "[", 
          RowBox[{"k3", ",", "m3"}], "]"}]}], "HadronicCurrentDvectorPart"}], 
       "//", "Contract"}], "//", "ExpandScalarProduct"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MDdecay3BodyStar", "=", 
     RowBox[{"MDdecay3Body", "//", "ComplexConjugate"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MDdecay3BodySquaredTemp", "=", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"Simplify", "[", 
         RowBox[{
          RowBox[{"Expand", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"FermionSpinSum", "[", 
               RowBox[{"MDdecay3Body", "*", "MDdecay3BodyStar"}], "]"}], "/.", 
              RowBox[{"DiracTrace", "\[Rule]", "TR"}]}], "//", "Contract"}], "//",
             "Simplify"}], "]"}], "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"fp", "\[Rule]", " ", 
             RowBox[{"fplus", "[", 
              RowBox[{"Dplus", ",", "K0", ",", 
               RowBox[{
                RowBox[{"ScalarProduct", "[", 
                 RowBox[{
                  RowBox[{"k", "-", "k1"}], ",", 
                  RowBox[{"k", "-", "k1"}]}], "]"}], "//", 
                "ExpandScalarProduct"}]}], "]"}]}], ",", 
            RowBox[{"fm", "\[Rule]", " ", 
             RowBox[{"fminus", "[", 
              RowBox[{"Dplus", ",", "K0", ",", 
               RowBox[{
                RowBox[{"ScalarProduct", "[", 
                 RowBox[{
                  RowBox[{"k", "-", "k1"}], ",", 
                  RowBox[{"k", "-", "k1"}]}], "]"}], "//", 
                "ExpandScalarProduct"}]}], "]"}]}]}], "}"}]}], "]"}], "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"ScalarProduct", "[", 
            RowBox[{"k", ",", "k"}], "]"}], "\[Rule]", "ProductKK"}], ",", 
          RowBox[{
           RowBox[{"ScalarProduct", "[", 
            RowBox[{"k1", ",", "k1"}], "]"}], "\[Rule]", "ProductK1K1"}], ",", 
          RowBox[{
           RowBox[{"ScalarProduct", "[", 
            RowBox[{"k2", ",", "k2"}], "]"}], "\[Rule]", "ProductK2K2"}], ",", 
          RowBox[{
           RowBox[{"ScalarProduct", "[", 
            RowBox[{"k3", ",", "k3"}], "]"}], "\[Rule]", "ProductK3K3"}]}], 
         "}"}]}], "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"ScalarProduct", "[", 
           RowBox[{"k", ",", "k1"}], "]"}], "\[Rule]", " ", 
          "ProductKK1energy"}], ",", 
         RowBox[{
          RowBox[{"ScalarProduct", "[", 
           RowBox[{"k2", ",", "k3"}], "]"}], "\[Rule]", "ProductK2K3energy"}],
          ",", 
         RowBox[{
          RowBox[{"ScalarProduct", "[", 
           RowBox[{"k1", ",", "k3"}], "]"}], "\[Rule]", "ProductK1K3energy"}],
          ",", 
         RowBox[{
          RowBox[{"ScalarProduct", "[", 
           RowBox[{"k", ",", "k3"}], "]"}], "\[Rule]", "ProductKK3energy"}], 
         ",", 
         RowBox[{
          RowBox[{"ScalarProduct", "[", 
           RowBox[{"k1", ",", "k2"}], "]"}], "\[Rule]", "ProductK1K2energy"}],
          ",", 
         RowBox[{
          RowBox[{"ScalarProduct", "[", 
           RowBox[{"k", ",", "k2"}], "]"}], "\[Rule]", "ProductKK2energy"}]}],
         "}"}]}], ")"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Msquared3Body", "[", 
      RowBox[{
       RowBox[{"ListHNLs", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", "\"\<D-3-body\>\"", ",", "mLLP_",
        ",", "E1_", ",", "E3_"}], "]"}], "=", 
     RowBox[{
      RowBox[{"MDdecay3BodySquaredTemp", "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"m", "\[Rule]", 
          RowBox[{"mSM", "[", "\"\<Dplus\>\"", "]"}]}], ",", 
         RowBox[{"m1", "\[Rule]", " ", 
          RowBox[{"mSM", "[", "\"\<K0\>\"", "]"}]}], ",", 
         RowBox[{"m2", "\[Rule]", 
          RowBox[{"mSM", "[", "\"\<e\>\"", "]"}]}], ",", 
         RowBox[{"m3", "\[Rule]", "mLLP"}]}], "}"}]}], "//", "Simplify"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Msquared3Body", "[", 
      RowBox[{
       RowBox[{"ListHNLs", "[", 
        RowBox[{"[", "2", "]"}], "]"}], ",", "\"\<D-3-body\>\"", ",", "mLLP_",
        ",", "E1_", ",", "E3_"}], "]"}], "=", 
     RowBox[{
      RowBox[{"MDdecay3BodySquaredTemp", "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"m", "\[Rule]", 
          RowBox[{"mSM", "[", "\"\<Dplus\>\"", "]"}]}], ",", 
         RowBox[{"m1", "\[Rule]", " ", 
          RowBox[{"mSM", "[", "\"\<K0\>\"", "]"}]}], ",", 
         RowBox[{"m2", "\[Rule]", 
          RowBox[{"mSM", "[", "\"\<mu\>\"", "]"}]}], ",", 
         RowBox[{"m3", "\[Rule]", "mLLP"}]}], "}"}]}], "//", "Simplify"}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.8777165648852625`*^9, 3.877716613368553*^9}, {
   3.87771674243416*^9, 3.877716751804373*^9}, {3.877716911831037*^9, 
   3.8777170267341766`*^9}, 3.877717068433108*^9, {3.913268911671208*^9, 
   3.91326893716963*^9}, {3.91327487835019*^9, 3.913274884407973*^9}, {
   3.9132751676497173`*^9, 3.913275189418754*^9}, {3.913308491966619*^9, 
   3.913308509047708*^9}, {3.913308754906124*^9, 3.913308759947383*^9}, {
   3.9133721715635753`*^9, 3.9133721743528547`*^9}, {3.913394674513927*^9, 
   3.9133946767581444`*^9}, {3.915438800208349*^9, 3.9154388002273283`*^9}},
 CellTags->"Evaluation",
 CellLabel->
  "In[892]:=",ExpressionUUID->"822f4d77-af6c-4066-91bd-8cc13c8b6d92"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[Cell[BoxData[
 FormBox[
  RowBox[{"\[Tau]", " ", "\[Rule]", 
   RowBox[{
    SubscriptBox[
     OverscriptBox["\[Nu]", "_"], "l"], "+", "l", "+", "N"}]}], 
  TraditionalForm]],ExpressionUUID->"de5748f3-cf43-493f-8ff4-2c0d787ec928"]], \
"Subsection",
 CellChangeTimes->{{3.877715057226045*^9, 3.8777150619196315`*^9}, {
  3.87771533207864*^9, 3.877715337066126*^9}, {3.87771653595435*^9, 
  3.8777165417506485`*^9}, {3.913371892363439*^9, 3.913371892363439*^9}},
 CellTags->
  "Evaluation",ExpressionUUID->"3bf4776a-9a9b-4383-aa96-3910e1a621a2"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"M\[Tau]decay3Body", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"SpinorVBar", "[", 
       RowBox[{"k2", ",", "m2"}], "]"}], ".", 
      RowBox[{"GA", "[", "\[Mu]", "]"}], ".", 
      RowBox[{"(", 
       RowBox[{"1", "-", "GA5"}], ")"}], ".", 
      RowBox[{"SpinorU", "[", 
       RowBox[{"k1", ",", "m1"}], "]"}]}], "*", 
     RowBox[{
      RowBox[{"SpinorUBar", "[", 
       RowBox[{"k3", ",", "m3"}], "]"}], ".", 
      RowBox[{"GA", "[", "\[Mu]", "]"}], ".", 
      RowBox[{"(", 
       RowBox[{"1", "-", "GA5"}], ")"}], ".", 
      RowBox[{"SpinorU", "[", 
       RowBox[{"k", ",", "m"}], "]"}]}]}], "//", "Contract"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"M\[Tau]decay3BodyStar", "=", 
   RowBox[{"M\[Tau]decay3Body", "//", "ComplexConjugate"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"M\[Tau]decay3BodySquaredTemp", "=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"Simplify", "[", 
       RowBox[{"Expand", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            FractionBox["1", "2"], 
            RowBox[{"FermionSpinSum", "[", 
             RowBox[{"M\[Tau]decay3Body", "*", "M\[Tau]decay3BodyStar"}], 
             "]"}]}], "/.", 
           RowBox[{"DiracTrace", "\[Rule]", "TR"}]}], "//", "Contract"}], "//",
          "Simplify"}], "]"}], "]"}], "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"ScalarProduct", "[", 
          RowBox[{"k", ",", "k"}], "]"}], "\[Rule]", "ProductKK"}], ",", 
        RowBox[{
         RowBox[{"ScalarProduct", "[", 
          RowBox[{"k1", ",", "k1"}], "]"}], "\[Rule]", "ProductK1K1"}], ",", 
        RowBox[{
         RowBox[{"ScalarProduct", "[", 
          RowBox[{"k2", ",", "k2"}], "]"}], "\[Rule]", "ProductK2K2"}], ",", 
        RowBox[{
         RowBox[{"ScalarProduct", "[", 
          RowBox[{"k3", ",", "k3"}], "]"}], "\[Rule]", "ProductK3K3"}]}], 
       "}"}]}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"ScalarProduct", "[", 
         RowBox[{"k", ",", "k1"}], "]"}], "\[Rule]", " ", 
        "ProductKK1energy"}], ",", 
       RowBox[{
        RowBox[{"ScalarProduct", "[", 
         RowBox[{"k2", ",", "k3"}], "]"}], "\[Rule]", "ProductK2K3energy"}], 
       ",", 
       RowBox[{
        RowBox[{"ScalarProduct", "[", 
         RowBox[{"k1", ",", "k3"}], "]"}], "\[Rule]", "ProductK1K3energy"}], 
       ",", 
       RowBox[{
        RowBox[{"ScalarProduct", "[", 
         RowBox[{"k", ",", "k3"}], "]"}], "\[Rule]", "ProductKK3energy"}], 
       ",", 
       RowBox[{
        RowBox[{"ScalarProduct", "[", 
         RowBox[{"k1", ",", "k2"}], "]"}], "\[Rule]", "ProductK1K2energy"}], 
       ",", 
       RowBox[{
        RowBox[{"ScalarProduct", "[", 
         RowBox[{"k", ",", "k2"}], "]"}], "\[Rule]", "ProductKK2energy"}]}], 
      "}"}]}], ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Msquared3Body", "[", 
    RowBox[{
     RowBox[{"ListHNLs", "[", 
      RowBox[{"[", "3", "]"}], "]"}], ",", "\"\<\[Tau]-3-body\>\"", ",", 
     "mLLP_", ",", "E1_", ",", "E3_"}], "]"}], "=", 
   RowBox[{
    RowBox[{"M\[Tau]decay3BodySquaredTemp", "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"m", "\[Rule]", 
        RowBox[{"mSM", "[", "\"\<tau\>\"", "]"}]}], ",", 
       RowBox[{"m1", "\[Rule]", "0"}], ",", 
       RowBox[{"m2", "\[Rule]", 
        RowBox[{"mSM", "[", "\"\<e\>\"", "]"}]}], ",", 
       RowBox[{"m3", "\[Rule]", "mLLP"}]}], "}"}]}], "//", "Simplify"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.87771631273712*^9, 3.87771631275274*^9}, {
  3.877716353411774*^9, 3.877716430128107*^9}, {3.877716471250784*^9, 
  3.877716534180072*^9}, {3.877717191883597*^9, 3.877717193989443*^9}, {
  3.9132688599294868`*^9, 3.9132688978468924`*^9}, {3.9132748886910586`*^9, 
  3.9132748906369843`*^9}, {3.91327519329269*^9, 3.913275195174985*^9}, {
  3.9133721767821264`*^9, 3.9133721777702074`*^9}, {3.913394668009413*^9, 
  3.913394668188182*^9}, {3.913394870598275*^9, 3.913394872794338*^9}, {
  3.9154388002373185`*^9, 3.9154388002413235`*^9}},
 CellTags->"Evaluation",
 CellLabel->
  "In[901]:=",ExpressionUUID->"9bd49d09-9738-4659-858a-a54557b2b0ee"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   RowBox[{"\[Mu]", " ", "\[Rule]", 
    RowBox[{
     SubscriptBox[
      OverscriptBox["\[Nu]", "_"], "e"], "+", "e", "+", "N"}]}], 
   TraditionalForm]],ExpressionUUID->"93b101cf-4cf4-4a93-adb9-67c1b9e3c060"],
 "/",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[Nu]", "\[Mu]"], TraditionalForm]],ExpressionUUID->
  "b1be9a63-90f4-4da4-ab48-cafcf55aa5d6"],
 "+e+N"
}], "Subsection",
 CellChangeTimes->{{3.877715057226045*^9, 3.8777150619196315`*^9}, {
  3.87771533207864*^9, 3.877715337066126*^9}, {3.87771653595435*^9, 
  3.8777165417506485`*^9}, {3.913371892363439*^9, 3.913371892363439*^9}, {
  3.9148321245737896`*^9, 3.91483216062823*^9}, {3.915596323539323*^9, 
  3.9155963237188845`*^9}, {3.9155963799285126`*^9, 3.91559638544078*^9}},
 CellTags->
  "Evaluation",ExpressionUUID->"54283de7-deea-4f58-ad14-5dafbd438d01"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"M\[Mu]decay3Body", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"SpinorVBar", "[", 
       RowBox[{"k2", ",", "m2"}], "]"}], ".", 
      RowBox[{"GA", "[", "\[Mu]", "]"}], ".", 
      RowBox[{"(", 
       RowBox[{"1", "-", "GA5"}], ")"}], ".", 
      RowBox[{"SpinorU", "[", 
       RowBox[{"k1", ",", "m1"}], "]"}]}], "*", 
     RowBox[{
      RowBox[{"SpinorUBar", "[", 
       RowBox[{"k3", ",", "m3"}], "]"}], ".", 
      RowBox[{"GA", "[", "\[Mu]", "]"}], ".", 
      RowBox[{"(", 
       RowBox[{"1", "-", "GA5"}], ")"}], ".", 
      RowBox[{"SpinorU", "[", 
       RowBox[{"k", ",", "m"}], "]"}]}]}], "//", "Contract"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"M\[Mu]decay3BodyStar", "=", 
   RowBox[{"M\[Mu]decay3Body", "//", "ComplexConjugate"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"M\[Mu]decay3BodySquaredTemp", "=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"Simplify", "[", 
       RowBox[{"Expand", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            FractionBox["1", "2"], 
            RowBox[{"FermionSpinSum", "[", 
             RowBox[{"M\[Mu]decay3Body", "*", "M\[Mu]decay3BodyStar"}], 
             "]"}]}], "/.", 
           RowBox[{"DiracTrace", "\[Rule]", "TR"}]}], "//", "Contract"}], "//",
          "Simplify"}], "]"}], "]"}], "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"ScalarProduct", "[", 
          RowBox[{"k", ",", "k"}], "]"}], "\[Rule]", "ProductKK"}], ",", 
        RowBox[{
         RowBox[{"ScalarProduct", "[", 
          RowBox[{"k1", ",", "k1"}], "]"}], "\[Rule]", "ProductK1K1"}], ",", 
        RowBox[{
         RowBox[{"ScalarProduct", "[", 
          RowBox[{"k2", ",", "k2"}], "]"}], "\[Rule]", "ProductK2K2"}], ",", 
        RowBox[{
         RowBox[{"ScalarProduct", "[", 
          RowBox[{"k3", ",", "k3"}], "]"}], "\[Rule]", "ProductK3K3"}]}], 
       "}"}]}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"ScalarProduct", "[", 
         RowBox[{"k", ",", "k1"}], "]"}], "\[Rule]", " ", 
        "ProductKK1energy"}], ",", 
       RowBox[{
        RowBox[{"ScalarProduct", "[", 
         RowBox[{"k2", ",", "k3"}], "]"}], "\[Rule]", "ProductK2K3energy"}], 
       ",", 
       RowBox[{
        RowBox[{"ScalarProduct", "[", 
         RowBox[{"k1", ",", "k3"}], "]"}], "\[Rule]", "ProductK1K3energy"}], 
       ",", 
       RowBox[{
        RowBox[{"ScalarProduct", "[", 
         RowBox[{"k", ",", "k3"}], "]"}], "\[Rule]", "ProductKK3energy"}], 
       ",", 
       RowBox[{
        RowBox[{"ScalarProduct", "[", 
         RowBox[{"k1", ",", "k2"}], "]"}], "\[Rule]", "ProductK1K2energy"}], 
       ",", 
       RowBox[{
        RowBox[{"ScalarProduct", "[", 
         RowBox[{"k", ",", "k2"}], "]"}], "\[Rule]", "ProductKK2energy"}]}], 
      "}"}]}], ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Msquared3Body", "[", 
    RowBox[{
     RowBox[{"ListHNLs", "[", 
      RowBox[{"[", "2", "]"}], "]"}], ",", "\"\<mu\>\"", ",", "mLLP_", ",", 
     "E1_", ",", "E3_"}], "]"}], "=", 
   RowBox[{
    RowBox[{"M\[Mu]decay3BodySquaredTemp", "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"m", "\[Rule]", 
        RowBox[{"mSM", "[", "\"\<mu\>\"", "]"}]}], ",", 
       RowBox[{"m1", "\[Rule]", "0"}], ",", 
       RowBox[{"m2", "\[Rule]", 
        RowBox[{"mSM", "[", "\"\<e\>\"", "]"}]}], ",", 
       RowBox[{"m3", "\[Rule]", "mLLP"}]}], "}"}]}], "//", "Simplify"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"M\[Mu]decay3Body", "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"SpinorVBar", "[", 
        RowBox[{"k2", ",", "m2"}], "]"}], ".", 
       RowBox[{"GA", "[", "\[Mu]", "]"}], ".", 
       RowBox[{"(", 
        RowBox[{"1", "-", "GA5"}], ")"}], ".", 
       RowBox[{"SpinorU", "[", 
        RowBox[{"k3", ",", "m3"}], "]"}]}], "*", 
      RowBox[{
       RowBox[{"SpinorVBar", "[", 
        RowBox[{"k", ",", "m"}], "]"}], ".", 
       RowBox[{"GA", "[", "\[Mu]", "]"}], ".", 
       RowBox[{"(", 
        RowBox[{"1", "-", "GA5"}], ")"}], ".", 
       RowBox[{"SpinorV", "[", 
        RowBox[{"k1", ",", "m1"}], "]"}]}]}], "//", "Contract"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"M\[Mu]decay3Body", "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"SpinorVBar", "[", 
         RowBox[{"k3", ",", "m3"}], "]"}], ".", 
        RowBox[{"GA", "[", "\[Mu]", "]"}], ".", 
        RowBox[{"(", 
         RowBox[{"1", "-", "GA5"}], ")"}], ".", 
        RowBox[{"SpinorU", "[", 
         RowBox[{"k2", ",", "m2"}], "]"}]}], "*", 
       RowBox[{
        RowBox[{"SpinorUBar", "[", 
         RowBox[{"k1", ",", "m1"}], "]"}], ".", 
        RowBox[{"GA", "[", "\[Mu]", "]"}], ".", 
        RowBox[{"(", 
         RowBox[{"1", "-", "GA5"}], ")"}], ".", 
        RowBox[{"SpinorU", "[", 
         RowBox[{"k", ",", "m"}], "]"}]}]}], "//", "Contract"}]}], ";"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"M\[Mu]decay3BodyStar", "=", 
   RowBox[{"M\[Mu]decay3Body", "//", "ComplexConjugate"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"M\[Mu]decay3BodySquaredTemp", "=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"Simplify", "[", 
       RowBox[{"Expand", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            FractionBox["1", "2"], 
            RowBox[{"FermionSpinSum", "[", 
             RowBox[{"M\[Mu]decay3Body", "*", "M\[Mu]decay3BodyStar"}], 
             "]"}]}], "/.", 
           RowBox[{"DiracTrace", "\[Rule]", "TR"}]}], "//", "Contract"}], "//",
          "Simplify"}], "]"}], "]"}], "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"ScalarProduct", "[", 
          RowBox[{"k", ",", "k"}], "]"}], "\[Rule]", "ProductKK"}], ",", 
        RowBox[{
         RowBox[{"ScalarProduct", "[", 
          RowBox[{"k1", ",", "k1"}], "]"}], "\[Rule]", "ProductK1K1"}], ",", 
        RowBox[{
         RowBox[{"ScalarProduct", "[", 
          RowBox[{"k2", ",", "k2"}], "]"}], "\[Rule]", "ProductK2K2"}], ",", 
        RowBox[{
         RowBox[{"ScalarProduct", "[", 
          RowBox[{"k3", ",", "k3"}], "]"}], "\[Rule]", "ProductK3K3"}]}], 
       "}"}]}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"ScalarProduct", "[", 
         RowBox[{"k", ",", "k1"}], "]"}], "\[Rule]", " ", 
        "ProductKK1energy"}], ",", 
       RowBox[{
        RowBox[{"ScalarProduct", "[", 
         RowBox[{"k2", ",", "k3"}], "]"}], "\[Rule]", "ProductK2K3energy"}], 
       ",", 
       RowBox[{
        RowBox[{"ScalarProduct", "[", 
         RowBox[{"k1", ",", "k3"}], "]"}], "\[Rule]", "ProductK1K3energy"}], 
       ",", 
       RowBox[{
        RowBox[{"ScalarProduct", "[", 
         RowBox[{"k", ",", "k3"}], "]"}], "\[Rule]", "ProductKK3energy"}], 
       ",", 
       RowBox[{
        RowBox[{"ScalarProduct", "[", 
         RowBox[{"k1", ",", "k2"}], "]"}], "\[Rule]", "ProductK1K2energy"}], 
       ",", 
       RowBox[{
        RowBox[{"ScalarProduct", "[", 
         RowBox[{"k", ",", "k2"}], "]"}], "\[Rule]", "ProductKK2energy"}]}], 
      "}"}]}], ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Msquared3Body", "[", 
    RowBox[{
     RowBox[{"ListHNLs", "[", 
      RowBox[{"[", "1", "]"}], "]"}], ",", "\"\<mu\>\"", ",", "mLLP_", ",", 
     "E1_", ",", "E3_"}], "]"}], "=", 
   RowBox[{
    RowBox[{"M\[Mu]decay3BodySquaredTemp", "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"m", "\[Rule]", 
        RowBox[{"mSM", "[", "\"\<mu\>\"", "]"}]}], ",", 
       RowBox[{"m1", "\[Rule]", "0"}], ",", 
       RowBox[{"m2", "\[Rule]", 
        RowBox[{"mSM", "[", "\"\<e\>\"", "]"}]}], ",", 
       RowBox[{"m3", "\[Rule]", "mLLP"}]}], "}"}]}], "//", "Simplify"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.87771631273712*^9, 3.87771631275274*^9}, {
  3.877716353411774*^9, 3.877716430128107*^9}, {3.877716471250784*^9, 
  3.877716534180072*^9}, {3.877717191883597*^9, 3.877717193989443*^9}, {
  3.9132688599294868`*^9, 3.9132688978468924`*^9}, {3.9132748886910586`*^9, 
  3.9132748906369843`*^9}, {3.91327519329269*^9, 3.913275195174985*^9}, {
  3.9133721767821264`*^9, 3.9133721777702074`*^9}, {3.913394668009413*^9, 
  3.913394668188182*^9}, {3.913394870598275*^9, 3.913394872794338*^9}, {
  3.914832163500003*^9, 3.914832232757354*^9}, {3.9148322642984195`*^9, 
  3.914832302228125*^9}, {3.915438800256304*^9, 3.915438800267115*^9}, {
  3.915596473028928*^9, 3.9155965193741198`*^9}},
 CellTags->"Evaluation",
 CellLabel->
  "In[905]:=",ExpressionUUID->"13fba45d-94f9-4916-8795-2b6683129869"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Angle-energy distributions of LLPs if mother particle is at rest\
\>", "Section",
 CellChangeTimes->{{3.914908314670745*^9, 3.914908326545822*^9}, 
   3.9154388002776003`*^9},
 CellTags->
  "Evaluation",ExpressionUUID->"667aee5b-504d-4798-9ccf-7c7f5c539e14"],

Cell[CellGroupData[{

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   RowBox[{"\[Mu]", " ", "\[Rule]", 
    RowBox[{
     SubscriptBox[
      OverscriptBox["\[Nu]", "_"], "e"], "+", "e", "+", "N"}]}], 
   TraditionalForm]],ExpressionUUID->"3acf5d19-2121-47c1-b8b3-79d45c28c3d3"],
 "/N+e+",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[Nu]", "\[Mu]"], TraditionalForm]],ExpressionUUID->
  "99a029b6-fe48-4a45-80c1-132c0987db7b"]
}], "Subsubsection",
 CellChangeTimes->{{3.914847886803888*^9, 3.914847893453364*^9}, {
   3.9148480792100077`*^9, 3.914848081527629*^9}, 3.9149083634969807`*^9},
 CellTags->
  "Evaluation",ExpressionUUID->"ad9e56ec-edc5-45b2-b48a-83ea0326342a"],

Cell[BoxData[
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"EdistrTemp", "[", 
      RowBox[{"HNL", ",", "\"\<mu\>\"", ",", "mLLP_", ",", "E3_"}], "]"}], 
     "=", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Integrate", "[", 
          RowBox[{
           RowBox[{"Msquared3Body", "[", 
            RowBox[{
            "HNL", ",", "\"\<mu\>\"", ",", "mLLP", ",", "E1", ",", "E3"}], 
            "]"}], ",", "E1"}], "]"}], "/.", 
         RowBox[{"{", 
          RowBox[{"E1", "->", 
           RowBox[{
            RowBox[{"E1domain1", "[", 
             RowBox[{"E3", ",", 
              RowBox[{"mSM", "[", "\"\<mu\>\"", "]"}], ",", "0.", ",", 
              RowBox[{"mSM", "[", "\"\<e\>\"", "]"}], ",", "mLLP"}], "]"}], 
            "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], ")"}], "-", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Integrate", "[", 
          RowBox[{
           RowBox[{"Msquared3Body", "[", 
            RowBox[{
            "HNL", ",", "\"\<mu\>\"", ",", "mLLP", ",", "E1", ",", "E3"}], 
            "]"}], ",", "E1"}], "]"}], "/.", 
         RowBox[{"{", 
          RowBox[{"E1", "->", 
           RowBox[{
            RowBox[{"E1domain1", "[", 
             RowBox[{"E3", ",", 
              RowBox[{"mSM", "[", "\"\<mu\>\"", "]"}], ",", "0.", ",", 
              RowBox[{"mSM", "[", "\"\<e\>\"", "]"}], ",", "mLLP"}], "]"}], 
            "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], ")"}]}], "//", 
      "Simplify"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"WidthNorm", "[", 
      RowBox[{"HNL", ",", "\"\<mu\>\"", ",", "mLLP_"}], "]"}], "=", 
     RowBox[{
      RowBox[{"Interpolation", "[", 
       RowBox[{
        RowBox[{"ParallelTable", "[", 
         RowBox[{
          RowBox[{"With", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"m", "=", "mLLP"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"m", ",", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"m", "==", 
                  RowBox[{"mSM", "[", "\"\<mu\>\"", "]"}]}], ",", "0.", ",", 
                 RowBox[{"Quiet", "[", 
                  RowBox[{"NIntegrate", "[", 
                   RowBox[{
                    RowBox[{"EdistrTemp", "[", 
                    RowBox[{"HNL", ",", "\"\<mu\>\"", ",", "m", ",", "E3"}], 
                    "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"E3", ",", 
                    RowBox[{
                    RowBox[{"E3domain1", "[", 
                    RowBox[{
                    RowBox[{"mSM", "[", "\"\<mu\>\"", "]"}], ",", "0", ",", 
                    RowBox[{"mSM", "[", "\"\<e\>\"", "]"}], ",", "m"}], "]"}],
                     "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"E3domain1", "[", 
                    RowBox[{
                    RowBox[{"mSM", "[", "\"\<mu\>\"", "]"}], ",", "0", ",", 
                    RowBox[{"mSM", "[", "\"\<e\>\"", "]"}], ",", "m"}], "]"}],
                     "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "]"}], "]"}]}],
                 "]"}], "//", "Re"}]}], "}"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"mLLP", ",", "0.", ",", 
            RowBox[{"mSM", "[", "\"\<mu\>\"", "]"}], ",", 
            FractionBox[
             RowBox[{"mSM", "[", "\"\<mu\>\"", "]"}], "300."]}], "}"}]}], 
         "]"}], ",", 
        RowBox[{"InterpolationOrder", "->", "1"}]}], "]"}], "[", "mLLP", 
      "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\[Theta]EdistrRest", "[", 
      RowBox[{
      "HNL", ",", "\"\<mu\>\"", ",", "mLLP_", ",", "\[Theta]LLP_", ",", 
       "ELLP_"}], "]"}], "=", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"mLLP", "<=", "ELLP", "<=", 
        RowBox[{
         RowBox[{"E3domain1", "[", 
          RowBox[{
           RowBox[{"mSM", "[", "\"\<mu\>\"", "]"}], ",", "0", ",", 
           RowBox[{"mSM", "[", "\"\<e\>\"", "]"}], ",", "mLLP"}], "]"}], "[", 
         
         RowBox[{"[", "2", "]"}], "]"}]}], ",", 
       RowBox[{"Evaluate", "[", 
        RowBox[{
         FractionBox[
          RowBox[{"Sin", "[", "\[Theta]LLP", "]"}], "2"], 
         FractionBox[
          RowBox[{"EdistrTemp", "[", 
           RowBox[{"HNL", ",", "\"\<mu\>\"", ",", "mLLP", ",", "ELLP"}], 
           "]"}], 
          RowBox[{"WidthNorm", "[", 
           RowBox[{"HNL", ",", "\"\<mu\>\"", ",", "mLLP"}], "]"}]]}], "]"}], 
       ",", "0"}], "]"}]}], ";"}], "\[IndentingNewLine]", ",", 
   RowBox[{"{", 
    RowBox[{"HNL", ",", 
     RowBox[{"Drop", "[", 
      RowBox[{"ListHNLs", ",", 
       RowBox[{"-", "1"}]}], "]"}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.914847901439802*^9, 3.91484791443883*^9}, {
   3.914847961797244*^9, 3.914847962349353*^9}, 3.914849350737581*^9, {
   3.9148494036149073`*^9, 3.914849439173124*^9}, {3.914926446432514*^9, 
   3.9149264466456385`*^9}, {3.91492670101295*^9, 3.914926701196927*^9}, {
   3.915438800305446*^9, 3.915438800418689*^9}, {3.916830635963039*^9, 
   3.916830722306797*^9}},
 CellTags->"Evaluation",
 CellLabel->
  "In[913]:=",ExpressionUUID->"11ecbafc-a5e8-47ed-a97f-18a09b37df83"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\[Pi] -> N + l ", "Subsection",
 CellChangeTimes->{{3.914908280226008*^9, 3.9149082862641544`*^9}},
 CellTags->
  "Evaluation",ExpressionUUID->"291cf4c3-322d-4335-9bdc-e9d66b0d9acf"],

Cell[BoxData[
 RowBox[{"Do", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"mlv", "=", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"HNL", "==", "\"\<HNL-mixing-e\>\""}], ",", 
       RowBox[{"0.5", "*", 
        SuperscriptBox["10", 
         RowBox[{"-", "3"}]]}], ",", "0.105"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"\[CapitalDelta]Eapprox", "=", 
     SuperscriptBox["10", 
      RowBox[{"-", "5."}]]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\[Theta]EdistrRest", "[", 
      RowBox[{
      "HNL", ",", "\"\<PiCharged\>\"", ",", "mLLP_", ",", "\[Theta]LLP_", ",",
        "ELLP_"}], "]"}], "=", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         FractionBox[
          RowBox[{
           SuperscriptBox[
            RowBox[{"mSM", "[", "\"\<PiCharged\>\"", "]"}], "2"], "-", 
           SuperscriptBox["mlv", "2"], "+", 
           SuperscriptBox["mLLP", "2"]}], 
          RowBox[{"2", 
           RowBox[{"mSM", "[", "\"\<PiCharged\>\"", "]"}]}]], "-", 
         FractionBox["\[CapitalDelta]Eapprox", "2"]}], "<=", "ELLP", "<=", 
        RowBox[{
         FractionBox[
          RowBox[{
           SuperscriptBox[
            RowBox[{"mSM", "[", "\"\<PiCharged\>\"", "]"}], "2"], "-", 
           SuperscriptBox["mlv", "2"], "+", 
           SuperscriptBox["mLLP", "2"]}], 
          RowBox[{"2", 
           RowBox[{"mSM", "[", "\"\<PiCharged\>\"", "]"}]}]], "+", 
         FractionBox["\[CapitalDelta]Eapprox", "2"]}]}], ",", 
       RowBox[{"Evaluate", "[", 
        RowBox[{
         FractionBox["1", "\[CapitalDelta]Eapprox"], 
         FractionBox[
          RowBox[{"Sin", "[", "\[Theta]LLP", "]"}], "2"]}], "]"}], ",", "0"}],
       "]"}]}], ";"}], "\[IndentingNewLine]", ",", 
   RowBox[{"{", 
    RowBox[{"HNL", ",", 
     RowBox[{"Drop", "[", 
      RowBox[{"ListHNLs", ",", 
       RowBox[{"-", "1"}]}], "]"}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{
  3.914908370445733*^9, {3.914908422751626*^9, 3.91490843251186*^9}, {
   3.914908481682176*^9, 3.9149085160918703`*^9}, {3.9149085545305867`*^9, 
   3.914908682220578*^9}, {3.914912193760759*^9, 3.914912202685398*^9}, {
   3.914912444551619*^9, 3.914912446781803*^9}, {3.915438800428677*^9, 
   3.91543880044867*^9}},
 CellTags->"Evaluation",
 CellLabel->
  "In[914]:=",ExpressionUUID->"573c73b7-657e-46a8-a6d7-31c4c6f46f48"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["ALP-gluon", "Chapter",
 CellChangeTimes->{{3.9133677446759033`*^9, 3.913367775004802*^9}, {
  3.9139715031511397`*^9, 3.913971503940259*^9}},
 CellTags->
  "Evaluation",ExpressionUUID->"e6032420-000f-4c70-862b-c0e99d95a710"],

Cell[CellGroupData[{

Cell["Relevant processes", "Section",
 CellChangeTimes->{{3.913268643168833*^9, 3.9132686454263844`*^9}},
 CellTags->
  "Evaluation",ExpressionUUID->"d7772fe1-303e-43a1-a6e2-f52f668cffdb"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"List", " ", "of", " ", "processes"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"LLPname", "=", "\"\<ALP-gluon\>\""}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "There", " ", "are", " ", "production", " ", "channels", " ", "via", " ",
       "mixing", " ", "with", " ", "neutral", " ", "light", " ", "mesons"}], 
     ",", " ", 
     RowBox[{"##", "-", 
      RowBox[{"mixing", ".", " ", "Drell"}], "-", 
      RowBox[{"Yan", " ", "is", " ", "computed", " ", "externally", " ", 
       RowBox[{"(", 
        RowBox[{"MadGraph", "+", "pythia"}], ")"}]}]}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ProcessesListAll", "[", "LLPname", "]"}], "=", 
     RowBox[{"{", 
      RowBox[{
      "\"\<B\>\"", ",", "\"\<Pi0\>\"", ",", "\"\<Eta\>\"", ",", 
       "\"\<EtaPr\>\""}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Topology", " ", "of", " ", "the", " ", "process"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MapThread", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"ProductionType", "[", 
          RowBox[{"LLPname", ",", "#1"}], "]"}], "=", "#2"}], ")"}], "&"}], 
      ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"ProcessesListAll", "[", "LLPname", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{
         "\"\<Decay\>\"", ",", "\"\<Mixing\>\"", ",", "\"\<Mixing\>\"", ",", 
          "\"\<Mixing\>\""}], "}"}]}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Particle", " ", 
      RowBox[{"content", ":", " ", 
       RowBox[{"mother", " ", "particle"}]}]}], ",", " ", 
     RowBox[{"decay", " ", "products"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MapThread", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"ReactionProductsList", "[", 
          RowBox[{"LLPname", ",", "#1"}], "]"}], "=", "#2"}], ")"}], "&"}], 
      ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"ProcessesListAll", "[", "LLPname", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "\"\<Bplus\>\"", ",", "\"\<PiCharged\>\"", ",", "LLPname"}], "}"}],
           ",", 
          RowBox[{"{", 
           RowBox[{"\"\<Pi0\>\"", ",", "LLPname"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"\"\<Eta\>\"", ",", "LLPname"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"\"\<EtaPr\>\"", ",", "LLPname"}], "}"}]}], "}"}]}], 
       "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"LLPname", "//", "Clear"}], "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.9133709741041927`*^9, 3.913371001974358*^9}, {
   3.913371059244364*^9, 3.913371202434461*^9}, {3.913371235774322*^9, 
   3.913371302514247*^9}, {3.913371527238197*^9, 3.913371547192785*^9}, {
   3.9133723537698927`*^9, 3.9133723541195774`*^9}, 3.913372596498764*^9, {
   3.913374091321478*^9, 3.913374094106866*^9}, {3.913374171706601*^9, 
   3.913374179763885*^9}, 3.913394646751916*^9, {3.913395240262203*^9, 
   3.9133952402682943`*^9}, 3.913397468058793*^9, {3.913707922380516*^9, 
   3.913707939023467*^9}, 3.914831446949301*^9, {3.915438800458663*^9, 
   3.915438800497667*^9}, 3.915440189927143*^9, {3.915440709086607*^9, 
   3.915440734897721*^9}, 3.915440966088825*^9},
 CellTags->"Evaluation",
 CellLabel->
  "In[915]:=",ExpressionUUID->"4e0e9899-fded-4d72-8877-13bc67a0fdf7"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["ALP-photon", "Chapter",
 CellChangeTimes->{{3.9133677446759033`*^9, 3.913367759869458*^9}, {
  3.9139715059892397`*^9, 3.91397150728731*^9}},
 CellTags->
  "Evaluation",ExpressionUUID->"0f30225e-de51-473d-8156-16ddf2e7a477"],

Cell[CellGroupData[{

Cell["Relevant processes", "Section",
 CellChangeTimes->{{3.913268643168833*^9, 3.9132686454263844`*^9}},
 CellTags->
  "Evaluation",ExpressionUUID->"fbe6c10f-8446-4672-85b1-ebf7ba71b704"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"List", " ", "of", " ", "processes"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"LLPname", "=", "\"\<ALP-photon\>\""}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "There", " ", "are", " ", "production", " ", "channels", " ", "via", " ",
       "scattering", " ", "of", " ", "protons", " ", "or", " ", "photons"}], 
     ",", " ", 
     RowBox[{
     "called", " ", "\"\<photon fusion\>\"", " ", "and", " ", 
      "\"\<Primakov\>\""}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ProcessesListAll", "[", "LLPname", "]"}], "=", 
     RowBox[{"{", 
      RowBox[{
      "\"\<Pi0\>\"", ",", "\"\<Eta\>\"", ",", "\"\<Primakov\>\"", ",", 
       "\"\<Photon-fusion\>\""}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Topology", " ", "of", " ", "the", " ", "process"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MapThread", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"ProductionType", "[", 
          RowBox[{"LLPname", ",", "#1"}], "]"}], "=", "#2"}], ")"}], "&"}], 
      ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"ProcessesListAll", "[", "LLPname", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{
         "\"\<Decay\>\"", ",", "\"\<Decay\>\"", ",", "\"\<Scattering\>\"", 
          ",", "\"\<Scattering\>\""}], "}"}]}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Particle", " ", 
      RowBox[{"content", ":", " ", 
       RowBox[{"mother", " ", "particle"}]}]}], ",", " ", 
     RowBox[{"decay", " ", "products"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MapThread", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"ReactionProductsList", "[", 
          RowBox[{"LLPname", ",", "#1"}], "]"}], "=", "#2"}], ")"}], "&"}], 
      ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"ProcessesListAll", "[", "LLPname", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "\"\<Pi0\>\"", ",", "\"\<photon\>\"", ",", "\"\<photon\>\"", ",", 
            "LLPname"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
           "\"\<Eta\>\"", ",", "\"\<photon\>\"", ",", "\"\<photon\>\"", ",", 
            "LLPname"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"\"\<photon\>\"", ",", "LLPname"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"\"\<p\>\"", ",", "LLPname"}], "}"}]}], "}"}]}], "}"}]}], 
     "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "___", "___", "___", "___", "___", "___", "___", "___", "___", "___", 
     "___", "___"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "List", " ", "of", " ", "possible", " ", "nuclei", " ", "targets", " ", 
     "depending", " ", "on", " ", "the", " ", "facility"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "___", "___", "___", "___", "___", "___", "___", "___", "___", "___", 
     "___", "___"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"NucleiList", "[", 
      RowBox[{"\"\<SPS\>\"", ",", "\"\<Primakov\>\""}], "]"}], "=", 
     RowBox[{
      RowBox[{"NucleiList", "[", 
       RowBox[{"\"\<SPS\>\"", ",", "\"\<Photon-fusion\>\""}], "]"}], "=", 
      RowBox[{"{", 
       RowBox[{"\"\<Mo\>\"", ",", "\"\<Fe\>\"", ",", "\"\<C\>\""}], "}"}]}]}],
     ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"NucleiList", "[", 
      RowBox[{"\"\<FermilabBD\>\"", ",", "\"\<Primakov\>\""}], "]"}], "=", 
     RowBox[{
      RowBox[{"NucleiList", "[", 
       RowBox[{"\"\<FermilabBD\>\"", ",", "\"\<Photon-fusion\>\""}], "]"}], 
      "=", 
      RowBox[{"{", 
       RowBox[{"\"\<Fe\>\"", ",", "\"\<C\>\""}], "}"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"NucleiList", "[", 
      RowBox[{"\"\<Serpukhov\>\"", ",", "\"\<Primakov\>\""}], "]"}], "=", 
     RowBox[{
      RowBox[{"NucleiList", "[", 
       RowBox[{"\"\<Serpukhov\>\"", ",", "\"\<Photon-fusion\>\""}], "]"}], 
      "=", 
      RowBox[{"{", "\"\<Fe\>\"", "}"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"For", " ", 
     RowBox[{"LHC", ":", " ", 
      RowBox[{"colliding", " ", "of", " ", "photons", " ", "with", " ", 
       RowBox[{"TAX", ".", " ", "Relevant"}], " ", "only", " ", "for", " ", 
       RowBox[{"FASER", "/", "FASER2"}]}]}]}], "*)"}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{
     RowBox[{"NucleiList", "[", 
      RowBox[{"\"\<LHC\>\"", ",", "\"\<Primakov\>\""}], "]"}], "=", 
     RowBox[{"{", "\"\<Fe\>\"", "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"NucleiList", "[", 
      RowBox[{"\"\<LHC\>\"", ",", "\"\<Photon-fusion\>\""}], "]"}], "=", 
     RowBox[{
      RowBox[{"NucleiList", "[", 
       RowBox[{"\"\<FCC-hh\>\"", ",", "\"\<Photon-fusion\>\""}], "]"}], "=", 
      RowBox[{"{", "\"\<p\>\"", "}"}]}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.9133709741041927`*^9, 3.913371001974358*^9}, {
   3.913371059244364*^9, 3.913371202434461*^9}, {3.913371235774322*^9, 
   3.913371302514247*^9}, {3.913371527238197*^9, 3.913371547192785*^9}, {
   3.913371582674785*^9, 3.9133716974604445`*^9}, {3.913371760000551*^9, 
   3.913371760957081*^9}, 3.9133718446923547`*^9, {3.913371957085125*^9, 
   3.913371981031015*^9}, 3.913372593048087*^9, {3.913374065578293*^9, 
   3.9133740740517235`*^9}, {3.913374186466676*^9, 3.913374188821747*^9}, 
   3.913394642472583*^9, {3.9133952402712884`*^9, 3.913395240276275*^9}, {
   3.913397756053859*^9, 3.913397771931385*^9}, {3.913474262430569*^9, 
   3.913474262640624*^9}, {3.913707941467159*^9, 3.913708014792344*^9}, {
   3.9137082672284985`*^9, 3.9137082710541677`*^9}, {3.914387502484289*^9, 
   3.914387502820035*^9}, {3.9154388005106597`*^9, 3.915438800548632*^9}, 
   3.915440189933439*^9, {3.915440748555878*^9, 3.915440759918122*^9}, 
   3.915440966094328*^9},
 CellTags->"Evaluation",
 CellLabel->
  "In[920]:=",ExpressionUUID->"ab7d6d0f-dab9-431e-8716-0468ee58c642"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Matrix elements of 3-body decays", "Section",
 CellChangeTimes->{{3.9133717120129466`*^9, 3.913371715503309*^9}},
 CellTags->
  "Evaluation",ExpressionUUID->"5d63056d-9fc8-4495-ac24-5e9fd33dd9c5"],

Cell[CellGroupData[{

Cell[TextData[{
 "Decay of ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox["\[Pi]", "0"], "/", "\[Eta]"}], TraditionalForm]],
  ExpressionUUID->"d39a2c6f-38ed-419d-a1e7-ef0d1b2756fc"]
}], "Subsection",
 CellChangeTimes->{{3.8921984480094795`*^9, 3.8921984526568637`*^9}},
 CellTags->
  "Evaluation",ExpressionUUID->"4d9b925b-3422-4531-b2f2-fb793c1b1962"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"FFvac", "[", 
   RowBox[{
   "p_", ",", "\[Mu]_", ",", "\[Nu]_", ",", "\[Alpha]_", ",", "\[Beta]_"}], 
   "]"}], ":=", 
  RowBox[{
   FractionBox[
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       RowBox[{"FV", "[", 
        RowBox[{"p", ",", "\[Mu]"}], "]"}]}], "*", 
      RowBox[{"FV", "[", 
       RowBox[{"p", ",", "\[Alpha]"}], "]"}], "*", 
      RowBox[{"MT", "[", 
       RowBox[{"\[Nu]", ",", "\[Beta]"}], "]"}]}], "-", 
     RowBox[{
      RowBox[{"FV", "[", 
       RowBox[{"p", ",", "\[Nu]"}], "]"}], "*", 
      RowBox[{"FV", "[", 
       RowBox[{"p", ",", "\[Beta]"}], "]"}], "*", 
      RowBox[{"MT", "[", 
       RowBox[{"\[Mu]", ",", "\[Alpha]"}], "]"}]}], "+", 
     RowBox[{
      RowBox[{"FV", "[", 
       RowBox[{"p", ",", "\[Mu]"}], "]"}], "*", 
      RowBox[{"FV", "[", 
       RowBox[{"p", ",", "\[Beta]"}], "]"}], "*", 
      RowBox[{"MT", "[", 
       RowBox[{"\[Nu]", ",", "\[Alpha]"}], "]"}]}], "+", 
     RowBox[{
      RowBox[{"FV", "[", 
       RowBox[{"p", ",", "\[Nu]"}], "]"}], "*", 
      RowBox[{"FV", "[", 
       RowBox[{"p", ",", "\[Alpha]"}], "]"}], "*", 
      RowBox[{"MT", "[", 
       RowBox[{"\[Mu]", ",", "\[Beta]"}], "]"}]}]}], 
    RowBox[{"ScalarProduct", "[", 
     RowBox[{"p", ",", "p"}], "]"}]], "//", 
   "ExpandScalarProduct"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FFfinal", "[", 
   RowBox[{
   "p1_", ",", "p2_", ",", "\[Mu]_", ",", "\[Nu]_", ",", "\[Alpha]_", ",", 
    "\[Beta]_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"FV", "[", 
       RowBox[{"p1", ",", "\[Mu]"}], "]"}], "*", 
      RowBox[{"PolarizationVector", "[", 
       RowBox[{"p1", ",", "\[Nu]"}], "]"}]}], "-", 
     RowBox[{
      RowBox[{"FV", "[", 
       RowBox[{"p1", ",", "\[Nu]"}], "]"}], "*", 
      RowBox[{"PolarizationVector", "[", 
       RowBox[{"p1", ",", "\[Mu]"}], "]"}]}]}], ")"}], 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"FV", "[", 
       RowBox[{"p2", ",", "\[Alpha]"}], "]"}], "*", 
      RowBox[{"PolarizationVector", "[", 
       RowBox[{"p2", ",", "\[Beta]"}], "]"}]}], "-", 
     RowBox[{
      RowBox[{"FV", "[", 
       RowBox[{"p2", ",", "\[Beta]"}], "]"}], "*", 
      RowBox[{"PolarizationVector", "[", 
       RowBox[{"p2", ",", "\[Alpha]"}], "]"}]}]}], 
    ")"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MdecayMesonToALPphoton", "=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{
       FractionBox["1", "4"], "ga\[Gamma]\[Gamma]", "*", 
       "g\[Pi]\[Gamma]\[Gamma]", "*", "2", "*", 
       RowBox[{"LeviCivita", "[", 
        RowBox[{"\[Mu]1", ",", "\[Nu]1", ",", "\[Mu]2", ",", "\[Nu]2"}], 
        "]"}], "*", 
       RowBox[{"LeviCivita", "[", 
        RowBox[{"\[Mu]3", ",", "\[Nu]3", ",", "\[Mu]4", ",", "\[Nu]4"}], 
        "]"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"FFvac", "[", 
           RowBox[{
            RowBox[{"p2", "+", "p3"}], ",", "\[Mu]1", ",", "\[Nu]1", ",", 
            "\[Mu]2", ",", "\[Nu]2"}], "]"}], "*", 
          RowBox[{"FFfinal", "[", 
           RowBox[{
           "p1", ",", "p2", ",", "\[Mu]3", ",", "\[Nu]3", ",", "\[Mu]4", ",", 
            "\[Nu]4"}], "]"}]}], "+", 
         RowBox[{
          RowBox[{"FFvac", "[", 
           RowBox[{
            RowBox[{"p2", "+", "p3"}], ",", "\[Mu]1", ",", "\[Nu]1", ",", 
            "\[Mu]3", ",", "\[Nu]3"}], "]"}], "*", 
          RowBox[{"FFfinal", "[", 
           RowBox[{
           "p1", ",", "p2", ",", "\[Mu]2", ",", "\[Nu]2", ",", "\[Mu]4", ",", 
            "\[Nu]4"}], "]"}]}], "+", 
         RowBox[{
          RowBox[{"FFvac", "[", 
           RowBox[{
            RowBox[{"p2", "+", "p3"}], ",", "\[Mu]1", ",", "\[Nu]1", ",", 
            "\[Mu]4", ",", "\[Nu]4"}], "]"}], "*", 
          RowBox[{"FFfinal", "[", 
           RowBox[{
           "p1", ",", "p2", ",", "\[Mu]3", ",", "\[Nu]3", ",", "\[Mu]2", ",", 
            "\[Nu]2"}], "]"}]}], "+", 
         RowBox[{
          RowBox[{"FFvac", "[", 
           RowBox[{
            RowBox[{"p2", "+", "p3"}], ",", "\[Mu]2", ",", "\[Nu]2", ",", 
            "\[Mu]3", ",", "\[Nu]3"}], "]"}], "*", 
          RowBox[{"FFfinal", "[", 
           RowBox[{
           "p1", ",", "p2", ",", "\[Mu]1", ",", "\[Nu]1", ",", "\[Mu]4", ",", 
            "\[Nu]4"}], "]"}]}], "+", 
         RowBox[{
          RowBox[{"FFvac", "[", 
           RowBox[{
            RowBox[{"p2", "+", "p3"}], ",", "\[Mu]3", ",", "\[Nu]3", ",", 
            "\[Mu]4", ",", "\[Nu]4"}], "]"}], "*", 
          RowBox[{"FFfinal", "[", 
           RowBox[{
           "p1", ",", "p2", ",", "\[Mu]1", ",", "\[Nu]1", ",", "\[Mu]2", ",", 
            "\[Nu]2"}], "]"}]}], "+", 
         RowBox[{
          RowBox[{"FFvac", "[", 
           RowBox[{
            RowBox[{"p2", "+", "p3"}], ",", "\[Mu]2", ",", "\[Nu]2", ",", 
            "\[Mu]4", ",", "\[Nu]4"}], "]"}], "*", 
          RowBox[{"FFfinal", "[", 
           RowBox[{
           "p1", ",", "p2", ",", "\[Mu]1", ",", "\[Nu]1", ",", "\[Mu]3", ",", 
            "\[Nu]3"}], "]"}]}]}], ")"}]}], "//", "Contract"}], "//", 
     "Simplify"}], ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MdecayMesonToALPphotonSquared", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"DoPolarizationSums", "[", 
          RowBox[{
           RowBox[{"DoPolarizationSums", "[", 
            RowBox[{
             RowBox[{"MdecayMesonToALPphoton", "*", 
              RowBox[{
              "ComplexConjugate", "[", "MdecayMesonToALPphoton", "]"}]}], ",",
              "p1"}], "]"}], ",", "p2"}], "]"}], "//", "Contract"}], "//", 
        "Simplify"}], ")"}], "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"ScalarProduct", "[", 
          RowBox[{"p3", ",", "p3"}], "]"}], "\[Rule]", "ProductK3K3"}], ",", 
        RowBox[{
         RowBox[{"ScalarProduct", "[", 
          RowBox[{"p2", ",", "p2"}], "]"}], "\[Rule]", "ProductK2K2"}], ",", 
        RowBox[{
         RowBox[{"ScalarProduct", "[", 
          RowBox[{"p1", ",", "p1"}], "]"}], "\[Rule]", "ProductK1K1"}], ",", 
        RowBox[{
         RowBox[{"ScalarProduct", "[", 
          RowBox[{"p2", ",", "p3"}], "]"}], "\[Rule]", "ProductK2K3energy"}], 
        ",", 
        RowBox[{
         RowBox[{"ScalarProduct", "[", 
          RowBox[{"p1", ",", "p3"}], "]"}], "\[Rule]", "ProductK1K3energy"}], 
        ",", 
        RowBox[{
         RowBox[{"ScalarProduct", "[", 
          RowBox[{"p1", ",", "p2"}], "]"}], "\[Rule]", " ", 
         "ProductK1K2energy"}]}], "}"}]}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"m1", "\[Rule]", "0"}], ",", 
       RowBox[{"m2", "\[Rule]", "0"}], ",", 
       RowBox[{"m3", "\[Rule]", "ma"}], ",", 
       RowBox[{"m", "\[Rule]", "mmeson"}]}], "}"}]}], "//", "Simplify"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Msquared3Body", "[", 
    RowBox[{
    "LLPname", ",", "\"\<Pi0\>\"", ",", "mLLP_", ",", "E1_", ",", "E3_"}], 
    "]"}], "=", 
   RowBox[{"MdecayMesonToALPphotonSquared", "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"mmeson", "\[Rule]", 
       RowBox[{"mSM", "[", "\"\<Pi0\>\"", "]"}]}], ",", 
      RowBox[{"ma", "->", "mLLP"}], ",", 
      RowBox[{"ga\[Gamma]\[Gamma]", "\[Rule]", "1"}], ",", 
      RowBox[{"g\[Pi]\[Gamma]\[Gamma]", "\[Rule]", "1"}]}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Msquared3Body", "[", 
    RowBox[{
    "LLPname", ",", "\"\<Eta\>\"", ",", "mLLP_", ",", "E1_", ",", "E3_"}], 
    "]"}], "=", 
   RowBox[{"MdecayMesonToALPphotonSquared", "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"mmeson", "\[Rule]", 
       RowBox[{"mSM", "[", "\"\<Eta\>\"", "]"}]}], ",", 
      RowBox[{"ma", "->", "mLLP"}], ",", 
      RowBox[{"ga\[Gamma]\[Gamma]", "\[Rule]", "1"}], ",", 
      RowBox[{"g\[Pi]\[Gamma]\[Gamma]", "\[Rule]", "1"}]}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"LLPname", "//", "Clear"}]}], "Input",
 CellChangeTimes->{{3.89219927515915*^9, 3.8921992855451384`*^9}, {
  3.892199548501564*^9, 3.8921996963442507`*^9}, {3.892199751414859*^9, 
  3.892199848465343*^9}, {3.8921998892385187`*^9, 3.89220038025453*^9}, {
  3.8922199580041428`*^9, 3.8922199585793204`*^9}, {3.892220871236271*^9, 
  3.892220883878686*^9}, {3.892268785788042*^9, 3.892268790620195*^9}, {
  3.9133717523578286`*^9, 3.9133718261333055`*^9}, {3.913371892367079*^9, 
  3.913371892506214*^9}, {3.913394620976291*^9, 3.9133946316511316`*^9}, {
  3.913397784987301*^9, 3.9133977884688215`*^9}, {3.914387499207971*^9, 
  3.914387505567274*^9}, {3.915438800564633*^9, 3.915438800583625*^9}},
 CellTags->"Evaluation",
 CellLabel->
  "In[929]:=",ExpressionUUID->"1828b044-1bf8-4f21-b901-afd828bd05c5"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Primakov cross-section", "Section",
 CellChangeTimes->{{3.9134751819244947`*^9, 3.913475184574743*^9}},
 CellTags->
  "Evaluation",ExpressionUUID->"8caf92d5-70a9-4c4b-b9ed-16ae9de4c52f"],

Cell[CellGroupData[{

Cell["Kinematics", "Subsection",
 CellChangeTimes->{{3.8848517191887846`*^9, 3.8848517215500355`*^9}, 
   3.885666607314666*^9},
 CellTags->
  "Evaluation",ExpressionUUID->"e08d29a5-6da2-449e-ad91-5f45d20ef30c"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"sinv", "[", 
    RowBox[{"E\[Gamma]_", ",", "mt_"}], "]"}], "=", 
   RowBox[{
    RowBox[{"2", "*", "mt", "*", "E\[Gamma]"}], "+", 
    SuperscriptBox["mt", "2"]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"tmin", "[", 
    RowBox[{"ma_", ",", "E\[Gamma]_", ",", "mt_"}], "]"}], "=", 
   RowBox[{
    FractionBox[
     SuperscriptBox["ma", "4"], 
     RowBox[{"4", "*", 
      RowBox[{"sinv", "[", 
       RowBox[{"E\[Gamma]", ",", "mt"}], "]"}]}]], "-", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       FractionBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"sinv", "[", 
           RowBox[{"E\[Gamma]", ",", "mt"}], "]"}], "-", 
          SuperscriptBox["mt", "2"]}], ")"}], 
        RowBox[{"2", "*", 
         SqrtBox[
          RowBox[{"sinv", "[", 
           RowBox[{"E\[Gamma]", ",", "mt"}], "]"}]]}]], "+", 
       SqrtBox[
        RowBox[{
         FractionBox[
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{"sinv", "[", 
              RowBox[{"E\[Gamma]", ",", "mt"}], "]"}], "+", 
             SuperscriptBox["ma", "2"], "-", 
             SuperscriptBox["mt", "2"]}], ")"}], "2"], 
          RowBox[{"4", "*", 
           RowBox[{"sinv", "[", 
            RowBox[{"E\[Gamma]", ",", "mt"}], "]"}]}]], "-", 
         SuperscriptBox["ma", "2"]}]]}], ")"}], "2"]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"tmaxTemp", "[", 
    RowBox[{"ma_", ",", "E\[Gamma]_", ",", "mt_"}], "]"}], "=", 
   RowBox[{
    FractionBox[
     SuperscriptBox["ma", "4"], 
     RowBox[{"4", "*", 
      RowBox[{"sinv", "[", 
       RowBox[{"E\[Gamma]", ",", "mt"}], "]"}]}]], "-", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       FractionBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"sinv", "[", 
           RowBox[{"E\[Gamma]", ",", "mt"}], "]"}], "-", 
          SuperscriptBox["mt", "2"]}], ")"}], 
        RowBox[{"2", "*", 
         SqrtBox[
          RowBox[{"sinv", "[", 
           RowBox[{"E\[Gamma]", ",", "mt"}], "]"}]]}]], "-", 
       SqrtBox[
        RowBox[{
         FractionBox[
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{"sinv", "[", 
              RowBox[{"E\[Gamma]", ",", "mt"}], "]"}], "+", 
             SuperscriptBox["ma", "2"], "-", 
             SuperscriptBox["mt", "2"]}], ")"}], "2"], 
          RowBox[{"4", "*", 
           RowBox[{"sinv", "[", 
            RowBox[{"E\[Gamma]", ",", "mt"}], "]"}]}]], "-", 
         SuperscriptBox["ma", "2"]}]]}], ")"}], "2"]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"tmaxLimit", "[", 
    RowBox[{"ma_", ",", "E\[Gamma]_"}], "]"}], "=", 
   RowBox[{"Assuming", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"E\[Gamma]", ">", "0"}], "&&", 
      RowBox[{"mt", ">", "0"}]}], ",", 
     RowBox[{"Simplify", "[", 
      RowBox[{"Normal", "@", 
       RowBox[{"Series", "[", 
        RowBox[{
         RowBox[{"tmaxTemp", "[", 
          RowBox[{"ma", ",", "E\[Gamma]", ",", "mt"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"ma", ",", "0", ",", "4"}], "}"}]}], "]"}]}], "]"}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"tmax", "[", 
    RowBox[{"ma_", ",", "E\[Gamma]_", ",", "mt_"}], "]"}], "=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      FractionBox["ma", "E\[Gamma]"], ">", "0.01"}], ",", 
     RowBox[{"Evaluate", "[", 
      RowBox[{"tmaxTemp", "[", 
       RowBox[{"ma", ",", "E\[Gamma]", ",", "mt"}], "]"}], "]"}], ",", 
     RowBox[{"Evaluate", "[", 
      RowBox[{"tmaxLimit", "[", 
       RowBox[{"ma", ",", "E\[Gamma]"}], "]"}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
  "Print", "[", 
   "\"\<Expression for \!\(\*SubscriptBox[\(E\), \(a\)]\) in terms of \
\!\(\*SubscriptBox[\(E\), \(\[Gamma]\)]\),\!\(\*SubscriptBox[\(m\), \(T\)]\),\
\!\(\*SuperscriptBox[\(q\), \(2\)]\) = -t:\>\"", "]"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
      "Expression", " ", "for", " ", "the", " ", "squared", " ", "momentum", 
       " ", "transfer", " ", "evaluated", " ", "via"}], " ", "-", 
      SuperscriptBox["q", "2"]}], " ", "=", " ", 
     RowBox[{
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          SubscriptBox["p", "\[Nu]"], "-", 
          SubscriptBox["p", "N"]}], ")"}], "2"], ".", " ", "Depends"}], " ", 
      "on", " ", 
      SubscriptBox["E", "\[Nu]"]}]}], ",", 
    SubscriptBox["E", "N"], ",", 
    RowBox[{"cos", 
     RowBox[{"(", 
      SubscriptBox["\[Theta]", "\[Nu]N"], ")"}]}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Q2p\[Nu]pN", "[", 
     RowBox[{"E\[Gamma]_", ",", "Ea_", ",", "ma_", ",", "cos\[Theta]_"}], 
     "]"}], "=", 
    RowBox[{"-", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["ma", "2"], "-", 
       RowBox[{"2", "*", "Ea", "*", "E\[Gamma]"}], "+", 
       RowBox[{"2", "*", 
        RowBox[{"\[Sqrt]", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["Ea", "2"], "-", 
           SuperscriptBox["ma", "2"]}], ")"}]}], "*", "E\[Gamma]", "*", 
        "cos\[Theta]"}]}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
      "Expression", " ", "for", " ", "the", " ", "squared", " ", "momentum", 
       " ", "transfer", " ", "evaluated", " ", "via"}], " ", "-", 
      SuperscriptBox["q", "2"]}], " ", "=", " ", 
     RowBox[{
      RowBox[{
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           SubscriptBox["p", 
            RowBox[{"T", "'"}]], "-", 
           SubscriptBox["p", "T"]}], ")"}], "2"], ".", " ", "Depends"}], " ", 
       "on", " ", 
       SubscriptBox["E", "T"]}], " ", "=", " ", 
      SubscriptBox["m", "T"]}]}], ",", " ", 
    RowBox[{
     SubscriptBox["E", 
      RowBox[{"T", "'"}]], " ", "=", " ", 
     RowBox[{
      SubscriptBox["E", "\[Gamma]"], "+", 
      SubscriptBox["m", "T"], "-", 
      SubscriptBox["E", "a"]}]}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Q2pTprimepT", "[", 
     RowBox[{"E\[Gamma]_", ",", "Ea_", ",", "ma_", ",", "mT_"}], "]"}], "=", 
    RowBox[{"-", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", 
        SuperscriptBox["mT", "2"]}], "-", 
       RowBox[{"2", "*", "mT", 
        RowBox[{"(", 
         RowBox[{"E\[Gamma]", "+", "mT", "-", "Ea"}], ")"}]}]}], ")"}]}]}], 
   ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"cos\[Theta]", " ", "expressed", " ", "via", " ", 
     SuperscriptBox["q", "2"]}], ",", " ", 
    SubscriptBox["E", "\[Nu]"], ",", 
    SubscriptBox["E", "N"]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"cos\[Theta]\[Gamma]a", "[", 
     RowBox[{"q2_", ",", "E\[Gamma]_", ",", "Ea_", ",", "ma_"}], "]"}], "=", 
    RowBox[{"cos\[Theta]", "/.", 
     RowBox[{
      RowBox[{"Solve", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Q2p\[Nu]pN", "[", 
          RowBox[{"E\[Gamma]", ",", "Ea", ",", "ma", ",", "cos\[Theta]"}], 
          "]"}], "\[Equal]", "q2"}], ",", "cos\[Theta]"}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Finally", ",", " ", 
    RowBox[{"expression", " ", "for", " ", 
     SubscriptBox["E", "N"], " ", "in", " ", "terms", " ", "of", " ", 
     SubscriptBox["E", "\[Nu]"]}], ",", 
    SubscriptBox["m", "T"], ",", 
    SuperscriptBox["q", "2"]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"EavalE\[Gamma]q2", "[", 
   RowBox[{"E\[Gamma]_", ",", "q2_", ",", "mT_"}], "]"}], "=", 
  RowBox[{"Ea", "/.", 
   RowBox[{
    RowBox[{"Solve", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Q2p\[Nu]pN", "[", 
        RowBox[{"E\[Gamma]", ",", "Ea", ",", "ma", ",", 
         RowBox[{"cos\[Theta]\[Gamma]a", "[", 
          RowBox[{"q2", ",", "E\[Gamma]", ",", "Ea", ",", "ma"}], "]"}]}], 
        "]"}], "\[Equal]", 
       RowBox[{"Q2pTprimepT", "[", 
        RowBox[{"E\[Gamma]", ",", "Ea", ",", "ma", ",", "mT"}], "]"}]}], ",", 
      "Ea"}], "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  "\"\<Jacobian \!\(\*SuperscriptBox[\(Q\), \(2\)]\)\[Rule] \
\!\(\*SubscriptBox[\(E\), \(N\)]\):\>\"", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"JacobianQ2E\[Gamma]ToEaE\[Gamma]", "[", 
   RowBox[{"E\[Gamma]_", ",", "mT_", ",", "ma_"}], "]"}], "=", 
  RowBox[{"-", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"Q2pTprimepT", "[", 
         RowBox[{"E\[Gamma]", ",", "Ea", ",", "ma", ",", "mT"}], "]"}], ",", 
        "Ea"}], "]"}], "*", 
      RowBox[{"D", "[", 
       RowBox[{"E\[Gamma]", ",", "E\[Gamma]"}], "]"}]}], "-", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"Q2pTprimepT", "[", 
         RowBox[{"E\[Gamma]", ",", "Ea", ",", "ma", ",", "mT"}], "]"}], ",", 
        "E\[Gamma]"}], "]"}], "*", 
      RowBox[{"D", "[", 
       RowBox[{"E\[Gamma]", ",", "Ea"}], "]"}]}]}], 
    ")"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  "\"\<\!\(\*SubscriptBox[\(E\), \(N, min\)]\),\!\(\*SubscriptBox[\(E\), \(N, \
max\)]\) in terms of \!\(\*SubscriptBox[\(E\), \(\[Nu]\)]\): obtained as \!\(\
\*SubscriptBox[\(E\), \(N\)]\)(\!\(\*SuperscriptBox[\(q\), \(2\)]\) = \
(\!\(\*SuperscriptBox[\(q\), \(2\)]\)\!\(\*SubscriptBox[\()\), \(max\)]\)),\!\
\(\*SubscriptBox[\(E\), \(N\)]\)(\!\(\*SuperscriptBox[\(q\), \(2\)]\) = (\!\(\
\*SuperscriptBox[\(q\), \(2\)]\)\!\(\*SubscriptBox[\()\), \(min\)]\))\>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Eamin", "[", 
   RowBox[{"E\[Gamma]_", ",", "mT_", ",", "ma_"}], "]"}], "=", 
  RowBox[{"Assuming", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"E\[Gamma]", ">", 
      RowBox[{"E\[Gamma]min", "[", 
       RowBox[{"mT", ",", "ma"}], "]"}]}], "&&", 
     RowBox[{"mT", ">", "0"}], "&&", 
     RowBox[{"ma", ">", "0"}]}], ",", 
    RowBox[{"Simplify", "[", 
     RowBox[{"EavalE\[Gamma]q2", "[", 
      RowBox[{"E\[Gamma]", ",", 
       RowBox[{"-", 
        RowBox[{"tmin", "[", 
         RowBox[{"ma", ",", "E\[Gamma]", ",", "mT"}], "]"}]}], ",", "mT"}], 
      "]"}], "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Eamax", "[", 
   RowBox[{"E\[Gamma]_", ",", "mT_", ",", "ma_"}], "]"}], "=", 
  RowBox[{
   RowBox[{"EavalE\[Gamma]q2", "[", 
    RowBox[{"E\[Gamma]", ",", 
     RowBox[{"-", 
      RowBox[{"tmaxTemp", "[", 
       RowBox[{"ma", ",", "E\[Gamma]", ",", "mT"}], "]"}]}], ",", "mT"}], 
    "]"}], "//", "Simplify"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"EamaxLimit", "[", 
    RowBox[{"E\[Gamma]_", ",", "mT_", ",", "ma_"}], "]"}], "=", 
   RowBox[{"Assuming", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"E\[Gamma]", ">", "0"}], "&&", 
      RowBox[{"mT", ">", "0"}]}], ",", 
     RowBox[{"Simplify", "[", 
      RowBox[{"Normal", "@", 
       RowBox[{"Series", "[", 
        RowBox[{
         RowBox[{"Eamax", "[", 
          RowBox[{"E\[Gamma]", ",", "mT", ",", "ma"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"ma", ",", "0", ",", "4"}], "}"}]}], "]"}]}], "]"}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"EamaxNumeric", "[", 
    RowBox[{"E\[Gamma]_", ",", "mT_", ",", "ma_"}], "]"}], "=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      FractionBox["ma", "E\[Gamma]"], ">", 
      SuperscriptBox["10", 
       RowBox[{"-", "3"}]]}], ",", 
     RowBox[{"Eamax", "[", 
      RowBox[{"E\[Gamma]", ",", "mT", ",", "ma"}], "]"}], ",", 
     RowBox[{"EamaxLimit", "[", 
      RowBox[{"E\[Gamma]", ",", "mT", ",", "ma"}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"E\[Gamma]min", "[", 
    RowBox[{"ma_", ",", "mt_"}], "]"}], "=", 
   FractionBox[
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["ma", "2"], "+", 
      RowBox[{"2", "*", "mt", "*", "ma"}]}], ")"}], 
    RowBox[{"2", "*", "mt"}]]}], ";"}]}], "Input",
 CellChangeTimes->{{3.9133718925647545`*^9, 3.913371892591279*^9}},
 CellTags->"Evaluation",
 CellLabel->
  "In[936]:=",ExpressionUUID->"79ee2751-71ac-43ae-9273-0e4f4fdee8cc"],

Cell[BoxData[
 FormBox["\<\"Expression for \\!\\(\\*SubscriptBox[\\(E\\), \\(a\\)]\\) in \
terms of \\!\\(\\*SubscriptBox[\\(E\\), \
\\(\[Gamma]\\)]\\),\\!\\(\\*SubscriptBox[\\(m\\), \
\\(T\\)]\\),\\!\\(\\*SuperscriptBox[\\(q\\), \\(2\\)]\\) = -t:\"\>", 
  TraditionalForm]], "Print",
 CellChangeTimes->{3.930211519575436*^9, 3.930822751534511*^9},
 CellTags->"Evaluation",
 CellLabel->
  "Durante la evaluaci\[OAcute]n de \
In[936]:=",ExpressionUUID->"c4aff447-3018-4bad-8fdb-7ebe9c8d2a89"],

Cell[BoxData[
 FormBox[
  FractionBox[
   RowBox[{
    RowBox[{"2", " ", "E\[Gamma]", " ", "mT"}], "-", "q2"}], 
   RowBox[{"2", " ", "mT"}]], TraditionalForm]], "Output",
 CellChangeTimes->{3.930211519581053*^9, 3.930822751540989*^9},
 CellTags->"Evaluation",
 CellLabel->
  "Out[945]=",ExpressionUUID->"aa39e359-5427-4471-a73f-f8b58f2b8306"],

Cell[BoxData[
 FormBox["\<\"Jacobian \\!\\(\\*SuperscriptBox[\\(Q\\), \\(2\\)]\\)\[Rule] \
\\!\\(\\*SubscriptBox[\\(E\\), \\(N\\)]\\):\"\>", TraditionalForm]], "Print",
 CellChangeTimes->{3.930211519575436*^9, 3.930822751543408*^9},
 CellTags->"Evaluation",
 CellLabel->
  "Durante la evaluaci\[OAcute]n de \
In[936]:=",ExpressionUUID->"ef6af8a9-7a2f-45ee-99fe-f8c010c155af"],

Cell[BoxData[
 FormBox[
  RowBox[{"2", " ", "mT"}], TraditionalForm]], "Output",
 CellChangeTimes->{3.930211519581053*^9, 3.9308227515459213`*^9},
 CellTags->"Evaluation",
 CellLabel->
  "Out[947]=",ExpressionUUID->"0da25b29-89da-4dfc-a7a5-07cccea1698c"],

Cell[BoxData[
 FormBox["\<\"\\!\\(\\*SubscriptBox[\\(E\\), \\(N, \
min\\)]\\),\\!\\(\\*SubscriptBox[\\(E\\), \\(N, max\\)]\\) in terms of \\!\\(\
\\*SubscriptBox[\\(E\\), \\(\[Nu]\\)]\\): obtained as \
\\!\\(\\*SubscriptBox[\\(E\\), \\(N\\)]\\)(\\!\\(\\*SuperscriptBox[\\(q\\), \
\\(2\\)]\\) = (\\!\\(\\*SuperscriptBox[\\(q\\), \
\\(2\\)]\\)\\!\\(\\*SubscriptBox[\\()\\), \
\\(max\\)]\\)),\\!\\(\\*SubscriptBox[\\(E\\), \
\\(N\\)]\\)(\\!\\(\\*SuperscriptBox[\\(q\\), \\(2\\)]\\) = \
(\\!\\(\\*SuperscriptBox[\\(q\\), \\(2\\)]\\)\\!\\(\\*SubscriptBox[\\()\\), \
\\(min\\)]\\))\"\>", TraditionalForm]], "Print",
 CellChangeTimes->{3.930211519575436*^9, 3.930822751547925*^9},
 CellTags->"Evaluation",
 CellLabel->
  "Durante la evaluaci\[OAcute]n de \
In[936]:=",ExpressionUUID->"34ff7d6d-ca66-48cd-b4ca-d914dc770228"],

Cell[BoxData[
 FormBox[
  FractionBox[
   RowBox[{
    RowBox[{"E\[Gamma]", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{
         SqrtBox[
          RowBox[{
           RowBox[{"2", " ", "E\[Gamma]"}], "+", "mT"}]], " ", 
         SqrtBox[
          FractionBox[
           RowBox[{
            RowBox[{"4", " ", 
             SuperscriptBox["E\[Gamma]", "2"], " ", 
             SuperscriptBox["mT", "2"]}], "-", 
            RowBox[{"4", " ", 
             SuperscriptBox["ma", "2"], " ", "mT", " ", 
             RowBox[{"(", 
              RowBox[{"E\[Gamma]", "+", "mT"}], ")"}]}], "+", 
            SuperscriptBox["ma", "4"]}], 
           RowBox[{
            RowBox[{"2", " ", "E\[Gamma]"}], "+", "mT"}]]]}]}], "+", 
       SuperscriptBox["ma", "2"], "+", 
       RowBox[{"2", " ", 
        SuperscriptBox["mT", "2"]}]}], ")"}]}], "+", 
    RowBox[{"2", " ", 
     SuperscriptBox["E\[Gamma]", "2"], " ", "mT"}], "+", 
    RowBox[{
     SuperscriptBox["ma", "2"], " ", "mT"}]}], 
   RowBox[{"2", " ", "mT", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", " ", "E\[Gamma]"}], "+", "mT"}], ")"}]}]], 
  TraditionalForm]], "Output",
 CellChangeTimes->{3.930211519581053*^9, 3.930822752070085*^9},
 CellTags->"Evaluation",
 CellLabel->
  "Out[949]=",ExpressionUUID->"220f840f-ba92-4b99-8a57-bd964b4d08e1"],

Cell[BoxData[
 FormBox[
  FractionBox[
   RowBox[{
    RowBox[{"E\[Gamma]", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SqrtBox[
         RowBox[{"mT", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", " ", "E\[Gamma]"}], "+", "mT"}], ")"}]}]], " ", 
        SqrtBox[
         FractionBox[
          RowBox[{
           RowBox[{"4", " ", 
            SuperscriptBox["E\[Gamma]", "2"], " ", 
            SuperscriptBox["mT", "2"]}], "-", 
           RowBox[{"4", " ", 
            SuperscriptBox["ma", "2"], " ", "mT", " ", 
            RowBox[{"(", 
             RowBox[{"E\[Gamma]", "+", "mT"}], ")"}]}], "+", 
           SuperscriptBox["ma", "4"]}], 
          RowBox[{"mT", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", " ", "E\[Gamma]"}], "+", "mT"}], ")"}]}]]]}], "+", 
       SuperscriptBox["ma", "2"], "+", 
       RowBox[{"2", " ", 
        SuperscriptBox["mT", "2"]}]}], ")"}]}], "+", 
    RowBox[{"2", " ", 
     SuperscriptBox["E\[Gamma]", "2"], " ", "mT"}], "+", 
    RowBox[{
     SuperscriptBox["ma", "2"], " ", "mT"}]}], 
   RowBox[{"2", " ", "mT", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", " ", "E\[Gamma]"}], "+", "mT"}], ")"}]}]], 
  TraditionalForm]], "Output",
 CellChangeTimes->{3.930211519581053*^9, 3.930822752237359*^9},
 CellTags->"Evaluation",
 CellLabel->
  "Out[950]=",ExpressionUUID->"8f9148bb-74de-4d29-b918-2a055fefef27"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Primakov cross-section", "Subsection",
 CellChangeTimes->{{3.884879586069579*^9, 3.88487958999916*^9}},
 CellTags->
  "Evaluation",ExpressionUUID->"e8574462-a41d-4945-b7dd-fa72d898c863"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{
     "Differential", " ", "cross", " ", "sections", " ", "from", " ", 
      RowBox[{"https", ":"}]}], "//", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"arxiv", ".", "org"}], "/", "pdf"}], "/", 
       RowBox[{"2010.15712", ".", "pdf"}]}], "+", 
      RowBox[{"https", ":"}]}]}], "//", 
    RowBox[{
     RowBox[{
      RowBox[{"arxiv", ".", "org"}], "/", "pdf"}], "/", 
     RowBox[{"1903.03586", ".", "pdf"}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"d\[Sigma]PrimakovdtNucleus", "[", 
      RowBox[{
      "ma_", ",", "t_", ",", "E\[Gamma]_", ",", "mNucleus_", ",", "Anucleus_",
        ",", "Znucleus_"}], "]"}], "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"2", "*", "\[Alpha]EM", "*", 
          SuperscriptBox[
           RowBox[{"FHelm", "[", 
            RowBox[{
             RowBox[{"-", "t"}], ",", "Anucleus", ",", "Znucleus"}], "]"}], 
           "2"], "*", 
          FractionBox[
           SuperscriptBox["mNucleus", "4"], 
           RowBox[{
            SuperscriptBox["t", "2"], "*", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["mNucleus", "2"], "-", "s"}], ")"}], "2"], 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"t", "-", 
               RowBox[{"4", "*", 
                SuperscriptBox["mNucleus", "2"]}]}], ")"}], "2"]}]], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             SuperscriptBox["ma", "2"], "*", "t", 
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["mNucleus", "2"], "+", "s"}], ")"}]}], "-", 
            RowBox[{
             SuperscriptBox["ma", "4"], 
             SuperscriptBox["mNucleus", "2"]}], "-", 
            RowBox[{"t", "*", 
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{
                  SuperscriptBox["mNucleus", "2"], "-", "s"}], ")"}], "2"], 
               "+", 
               RowBox[{"s", "*", "t"}]}], ")"}]}]}], ")"}]}], "/.", 
         RowBox[{"{", 
          RowBox[{"s", "\[Rule]", 
           RowBox[{"sinv", "[", 
            RowBox[{"E\[Gamma]", ",", "mNucleus"}], "]"}]}], "}"}]}], "//", 
        "Simplify"}], ")"}], "/.", 
      RowBox[{"{", 
       RowBox[{"\[Alpha]EM", "\[Rule]", "\[Alpha]EMval"}], "}"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"d\[Sigma]PrimakovdEaNucleus", "[", 
      RowBox[{
      "ma_", ",", "Ea_", ",", "E\[Gamma]_", ",", "mNucleus_", ",", 
       "Anucleus_", ",", "Znucleus_"}], "]"}], "=", 
     RowBox[{
      RowBox[{"JacobianQ2E\[Gamma]ToEaE\[Gamma]", "[", 
       RowBox[{"E\[Gamma]", ",", "mNucleus", ",", "ma"}], "]"}], "*", 
      RowBox[{"d\[Sigma]PrimakovdtNucleus", "[", 
       RowBox[{"ma", ",", 
        RowBox[{"-", 
         RowBox[{"Q2pTprimepT", "[", 
          RowBox[{"E\[Gamma]", ",", "Ea", ",", "ma", ",", "mNucleus"}], 
          "]"}]}], ",", "E\[Gamma]", ",", "mNucleus", ",", "Anucleus", ",", 
        "Znucleus"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"d\[Sigma]PrimakovdtNucleons", "[", 
      RowBox[{"ma_", ",", "t_", ",", "E\[Gamma]_", ",", "Znucleus_"}], "]"}], 
     "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        FractionBox[
         RowBox[{"Znucleus", "*", "\[Alpha]EM"}], 
         RowBox[{"32", "*", 
          SuperscriptBox["mp", "2"], "*", 
          SuperscriptBox["t", "2"], 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["mp", "2"], "-", "s"}], ")"}], "2"]}]], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", "*", 
           SuperscriptBox["mp", "2"], 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", "*", 
              SuperscriptBox["ma", "2"], "*", "t", 
              RowBox[{"(", 
               RowBox[{
                SuperscriptBox["mp", "2"], "+", "s", "+", "t"}], ")"}]}], "-", 
             RowBox[{
              SuperscriptBox["ma", "4"], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"2", "*", 
                 SuperscriptBox["mp", "2"]}], "+", "t"}], ")"}]}], "-", 
             RowBox[{"t", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"2", "*", 
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{
                    SuperscriptBox["mp", "2"], "-", "s"}], ")"}], "2"]}], "+", 
                RowBox[{"2", "*", "s", "*", "t"}], "+", 
                SuperscriptBox["t", "2"]}], ")"}]}]}], ")"}], "*", 
           SuperscriptBox[
            RowBox[{"F1", "[", 
             RowBox[{"-", "t"}], "]"}], "2"]}], "+", 
          RowBox[{
           RowBox[{"F1", "[", 
            RowBox[{"-", "t"}], "]"}], "*", 
           RowBox[{"F2", "[", 
            RowBox[{"-", "t"}], "]"}], "*", "t", "*", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"t", "*", 
              RowBox[{"(", 
               RowBox[{
                SuperscriptBox["mp", "4"], "-", 
                RowBox[{"2", "*", 
                 SuperscriptBox["mp", "2"], "*", 
                 RowBox[{"(", 
                  RowBox[{"s", "+", "t"}], ")"}]}], "+", 
                RowBox[{"s", "*", 
                 RowBox[{"(", 
                  RowBox[{"s", "+", "t"}], ")"}]}]}], ")"}]}], "+", 
             RowBox[{"t", "*", 
              SuperscriptBox["ma", "2"], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"3", "*", 
                 SuperscriptBox["mp", "2"]}], "-", "s"}], ")"}]}], "-", 
             RowBox[{
              SuperscriptBox["ma", "4"], 
              SuperscriptBox["mp", "2"]}]}], ")"}]}], "+", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"F2", "[", 
             RowBox[{"-", "t"}], "]"}], "2"], "*", "4", "*", 
           SuperscriptBox["mp", "2"], "*", "t", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["ma", "2"], "-", "t"}], ")"}], "2"]}]}], ")"}]}],
        "/.", 
       RowBox[{"{", 
        RowBox[{"s", "\[Rule]", 
         RowBox[{"sinv", "[", 
          RowBox[{"E\[Gamma]", ",", "mp"}], "]"}]}], "}"}]}], "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\[Alpha]EM", "\[Rule]", "\[Alpha]EMval"}], ",", 
        RowBox[{"mp", "->", 
         RowBox[{"mSM", "[", "\"\<p\>\"", "]"}]}]}], "}"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"q2maxEff", "[", "Anucleus_", "]"}], "=", 
     RowBox[{"20", 
      SuperscriptBox[
       RowBox[{"(", 
        FractionBox["4.49", 
         RowBox[{"R1", "[", "Anucleus", "]"}]], ")"}], "2"]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"\[Sigma]PrimakovNucleus1", "[", 
      RowBox[{
      "ma_", ",", "E\[Gamma]_", ",", "mNucleus_", ",", "Anucleus_", ",", 
       "Znucleus_"}], "]"}], ":=", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"E\[Gamma]", ">", 
        RowBox[{"E\[Gamma]min", "[", 
         RowBox[{"ma", ",", "mNucleus"}], "]"}]}], ",", " ", 
       RowBox[{"NIntegrate", "[", 
        RowBox[{
         RowBox[{"d\[Sigma]PrimakovdtNucleus", "[", 
          RowBox[{
          "ma", ",", "t", ",", "E\[Gamma]", ",", "mNucleus", ",", "Anucleus", 
           ",", "Znucleus"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"t", ",", 
           RowBox[{"Max", "[", 
            RowBox[{
             RowBox[{"tmin", "[", 
              RowBox[{"ma", ",", "E\[Gamma]", ",", "mNucleus"}], "]"}], ",", 
             RowBox[{"-", 
              RowBox[{"q2maxEff", "[", "Anucleus", "]"}]}]}], "]"}], ",", 
           RowBox[{"tmax", "[", 
            RowBox[{"ma", ",", "E\[Gamma]", ",", "mNucleus"}], "]"}]}], 
          "}"}]}], "]"}], ",", "0."}], "]"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Sigma]PrimakovNucleus", "[", 
     RowBox[{
     "ma_", ",", "E\[Gamma]_", ",", "mNucleus_", ",", "Anucleus_", ",", 
      "Znucleus_"}], "]"}], ":=", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"E\[Gamma]", ">", 
       RowBox[{"E\[Gamma]min", "[", 
        RowBox[{"ma", ",", "mNucleus"}], "]"}]}], ",", " ", 
      RowBox[{"NIntegrate", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          RowBox[{"Exp", "[", "u", "]"}]}], "*", 
         RowBox[{"d\[Sigma]PrimakovdtNucleus", "[", 
          RowBox[{"ma", ",", 
           RowBox[{"-", 
            RowBox[{"Exp", "[", "u", "]"}]}], ",", "E\[Gamma]", ",", 
           "mNucleus", ",", "Anucleus", ",", "Znucleus"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"u", ",", 
          RowBox[{"Log", "[", 
           RowBox[{"-", 
            RowBox[{"tmin", "[", 
             RowBox[{"ma", ",", "E\[Gamma]", ",", "mNucleus"}], "]"}]}], 
           "]"}], ",", 
          RowBox[{"Log", "[", 
           RowBox[{"-", 
            RowBox[{"tmax", "[", 
             RowBox[{"ma", ",", "E\[Gamma]", ",", "mNucleus"}], "]"}]}], 
           "]"}]}], "}"}]}], "]"}], ",", "0."}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"EaminEffective", "[", 
       RowBox[{"E\[Gamma]_", ",", "mT_", ",", "Anucleus_"}], "]"}], "=", 
      RowBox[{"EavalE\[Gamma]q2", "[", 
       RowBox[{"E\[Gamma]", ",", 
        RowBox[{"q2maxEff", "[", "Anucleus", "]"}], ",", "mT"}], "]"}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"EaminNumeric", "[", 
       RowBox[{"E\[Gamma]_", ",", "mT_", ",", "ma_", ",", "Anucleus_"}], 
       "]"}], "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         FractionBox["ma", "E\[Gamma]"], ">", "0.05"}], ",", 
        RowBox[{"Eamin", "[", 
         RowBox[{"E\[Gamma]", ",", "mT", ",", "ma"}], "]"}], ",", 
        RowBox[{"EaminEffective", "[", 
         RowBox[{"E\[Gamma]", ",", "mT", ",", "Anucleus"}], "]"}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Sigma]PrimakovNucleusAlt", "[", 
       RowBox[{
       "ma_", ",", "E\[Gamma]_", ",", "mNucleus_", ",", "Anucleus_", ",", 
        "Znucleus_"}], "]"}], ":=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"E\[Gamma]", ">", 
         RowBox[{"E\[Gamma]min", "[", 
          RowBox[{"ma", ",", "mMo"}], "]"}]}], ",", " ", 
        RowBox[{"NIntegrate", "[", 
         RowBox[{
          RowBox[{"d\[Sigma]PrimakovdEaNucleus", "[", 
           RowBox[{
           "ma", ",", "Ea", ",", "E\[Gamma]", ",", "mNucleus", ",", 
            "Anucleus", ",", "Znucleus"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"Ea", ",", 
            RowBox[{"EaminNumeric", "[", 
             RowBox[{
             "E\[Gamma]", ",", "mNucleus", ",", "ma", ",", "Anucleus"}], 
             "]"}], ",", 
            RowBox[{"EamaxNumeric", "[", 
             RowBox[{"E\[Gamma]", ",", "mNucleus", ",", "ma"}], "]"}]}], 
           "}"}]}], "]"}], ",", "0."}], "]"}]}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Sigma]PrimakovNucleons", "[", 
     RowBox[{"ma_", ",", "E\[Gamma]_", ",", "Znucleus_"}], "]"}], ":=", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"E\[Gamma]", ">", 
       RowBox[{"E\[Gamma]min", "[", 
        RowBox[{"ma", ",", 
         RowBox[{"mSM", "[", "\"\<p\>\"", "]"}]}], "]"}]}], ",", 
      RowBox[{"NIntegrate", "[", 
       RowBox[{
        RowBox[{"d\[Sigma]PrimakovdtNucleons", "[", 
         RowBox[{"ma", ",", "t", ",", "E\[Gamma]", ",", "Znucleus"}], "]"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"t", ",", 
          RowBox[{"tmin", "[", 
           RowBox[{"ma", ",", "E\[Gamma]", ",", 
            RowBox[{"mSM", "[", "\"\<p\>\"", "]"}]}], "]"}], ",", 
          RowBox[{"tmax", "[", 
           RowBox[{"ma", ",", "E\[Gamma]", ",", 
            RowBox[{"mSM", "[", "\"\<p\>\"", "]"}]}], "]"}]}], "}"}]}], "]"}],
       ",", "0."}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"E\[Gamma]", ",", 
         RowBox[{"\[Sigma]PrimakovNucleusAlt", "[", 
          RowBox[{"1", ",", "E\[Gamma]"}], "]"}], ",", 
         RowBox[{"\[Sigma]PrimakovNucleus", "[", 
          RowBox[{"1", ",", "E\[Gamma]"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"E\[Gamma]", ",", "3", ",", "200", ",", "10"}], "}"}]}], 
      "]"}], ";"}], "*)"}]}]}]], "Input",
 CellChangeTimes->{
  3.8848806361984963`*^9, {3.885666624291056*^9, 3.8856666271159754`*^9}, {
   3.885748635035523*^9, 3.885748660718854*^9}, {3.8857492194172926`*^9, 
   3.885749219777712*^9}, {3.886441967300949*^9, 3.886441971637037*^9}, {
   3.886442017989791*^9, 3.886442067000454*^9}, {3.8864424253725686`*^9, 
   3.8864424903997374`*^9}, {3.886442524769036*^9, 3.8864426243439207`*^9}, {
   3.886442684828208*^9, 3.886442716103864*^9}, {3.886442748333569*^9, 
   3.886442772264737*^9}, {3.886442829637197*^9, 3.88644284114324*^9}, {
   3.886442949215426*^9, 3.886442969027995*^9}, {3.913474610224891*^9, 
   3.913474638148807*^9}, {3.9138877259852424`*^9, 3.913887737366669*^9}},
 CellTags->"Evaluation",
 CellLabel->
  "In[954]:=",ExpressionUUID->"aa38e0a1-a817-4b7b-a76e-98552d3dae1f"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Photon fusion (following Felix and https://arxiv.org/abs/1512.03069)\
\>", "Section",
 CellChangeTimes->{{3.9134793284609556`*^9, 3.9134793299123993`*^9}, {
  3.9134797275274186`*^9, 3.913479731579117*^9}},
 CellTags->
  "Evaluation",ExpressionUUID->"f5fbce2e-bd61-4cb2-8cc6-8bef2d5b3fae"],

Cell[CellGroupData[{

Cell["\<\
Effective maximal and minimal energy fractions of equivalent photons \
\>", "Subsection",
 CellChangeTimes->{{3.887822277051349*^9, 3.887822296337508*^9}},
 CellTags->
  "Evaluation",ExpressionUUID->"d4edb50b-69e7-4aef-bf71-487cbcc8e1c5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Effective", " ", "maximal", " ", 
    SubscriptBox["p", "T"], " ", "of", " ", "photons", " ", "from", " ", 
    "protons", " ", "and", " ", "nucleus"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"q2nucleusMax", "[", "Anucleus_", "]"}], "=", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"4.49", "/", 
        RowBox[{"R1", "[", "Anucleus", "]"}]}], ")"}], "2"]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"q2pMax", "=", "1"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"pTmaxEPA", "[", 
      RowBox[{"x_", ",", "m_", ",", "q2max_"}], "]"}], "=", 
     SqrtBox[
      RowBox[{"pT2", "/.", 
       RowBox[{
        RowBox[{"Assuming", "[", 
         RowBox[{
          RowBox[{"0", "<", "x", "<", "1"}], ",", 
          RowBox[{"Solve", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"q2pTxVal", "[", 
              RowBox[{"x", ",", 
               SqrtBox["pT2"], ",", "m"}], "]"}], "\[Equal]", "q2max"}], ",", 
            "pT2"}], "]"}]}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}]}]]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"pTminEPA", "[", 
      RowBox[{"x_", ",", "m_", ",", "q2min_"}], "]"}], "=", 
     RowBox[{"pTmaxEPA", "[", 
      RowBox[{"x", ",", "m", ",", "q2min"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"xminmaxEPA", "[", 
      RowBox[{"m_", ",", "q2max_"}], "]"}], "=", 
     RowBox[{"x", "/.", 
      RowBox[{
       RowBox[{"Solve", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"pTmaxEPA", "[", 
           RowBox[{"x", ",", "m", ",", "q2max"}], "]"}], "\[Equal]", "0"}], 
         ",", "x"}], "]"}], "[", 
       RowBox[{"[", "2", "]"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"pTprotonMaxEPA", "[", "x_", "]"}], "=", 
     RowBox[{"pTmaxEPA", "[", 
      RowBox[{"x", ",", 
       RowBox[{"mSM", "[", "\"\<p\>\"", "]"}], ",", "q2pMax"}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"pTnucleusMaxEPA", "[", 
      RowBox[{"x_", ",", "mNucleus_", ",", "Anucleus_"}], "]"}], "=", 
     RowBox[{"pTmaxEPA", "[", 
      RowBox[{"x", ",", "mNucleus", ",", 
       RowBox[{"q2nucleusMax", "[", "Anucleus", "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"Minimal", " ", "momentum", " ", "transfer"}], " ", "-", " ", 
      RowBox[{"for", " ", "smaller", " ", "transfers"}]}], ",", " ", 
     RowBox[{
     "the", " ", "nucleus", " ", "is", " ", "screened", " ", "by", " ", 
      "electrons"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"q2nucleusMin", "=", 
     SuperscriptBox[
      RowBox[{"(", 
       SuperscriptBox["10", 
        RowBox[{"-", "5."}]], ")"}], "2"]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"pTnucleusMinEPA", "[", "mNucleus_", "]"}], "=", 
     RowBox[{
      RowBox[{"pTmaxEPA", "[", 
       RowBox[{"x", ",", "mNucleus", ",", "q2nucleusMin"}], "]"}], "/.", 
      RowBox[{"{", 
       RowBox[{"x", "\[Rule]", "0"}], "}"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"xminNucleusEPA", "[", "mNucleus_", "]"}], "=", 
     RowBox[{"xminmaxEPA", "[", 
      RowBox[{"mNucleus", ",", "q2nucleusMin"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Epsilon]Regularization", "=", 
     SuperscriptBox["10", 
      RowBox[{"-", "9."}]]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.887823045288357*^9, 3.887823047527443*^9}, {
   3.8878234858820357`*^9, 3.887823486047393*^9}, 3.893609318823033*^9, {
   3.913479740469246*^9, 3.913479774837288*^9}, {3.9134814626974583`*^9, 
   3.913481485544579*^9}, {3.9135698505045266`*^9, 3.913569850779605*^9}, {
   3.913622962195806*^9, 3.913622964094075*^9}, {3.9146483889598336`*^9, 
   3.914648405340093*^9}, 3.9146519956459713`*^9},
 CellTags->"Evaluation",
 CellLabel->
  "In[960]:=",ExpressionUUID->"5f3ed18a-4865-483b-9084-1c493c97c698"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Differential cross-section - beam dumps", "Subsection",
 CellChangeTimes->{{3.887821786538535*^9, 3.887821788238156*^9}, {
  3.913479644965727*^9, 3.913479652535743*^9}},
 CellTags->
  "Evaluation",ExpressionUUID->"129ed7d0-3b9a-4c3b-b008-b68f20fdb211"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"CM", " ", "kinematics", " ", "of", " ", "proton"}], "-", 
    RowBox[{
    "target", " ", "collisions", " ", "at", " ", "beam", " ", "dump"}]}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"vLabToCM", "[", 
      RowBox[{"EpLab_", ",", "MP_", ",", "mNucleus_"}], "]"}], "=", 
     RowBox[{"v", "/.", 
      RowBox[{
       RowBox[{"Solve", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           SqrtBox[
            RowBox[{
             SuperscriptBox["EpLab", "2"], "-", 
             SuperscriptBox["MP", "2"]}]], "-", 
           RowBox[{"v", "*", "EpLab"}]}], "\[Equal]", 
          RowBox[{"mNucleus", "*", "v"}]}], ",", "v"}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"pCMprotonZ", "[", 
      RowBox[{"EpLab_", ",", "MP_", ",", "mNucleus_"}], "]"}], "=", 
     RowBox[{"Assuming", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"EpLab", ">", "0"}], "&&", 
        RowBox[{"mNucleus", ">", "0"}]}], ",", 
       RowBox[{"Simplify", "[", 
        FractionBox[
         RowBox[{
          SqrtBox[
           RowBox[{
            SuperscriptBox["EpLab", "2"], "-", 
            SuperscriptBox["MP", "2"]}]], "-", 
          RowBox[{
           RowBox[{"vLabToCM", "[", 
            RowBox[{"EpLab", ",", "MP", ",", "mNucleus"}], "]"}], "*", 
           "EpLab"}]}], 
         SqrtBox[
          RowBox[{"1", "-", 
           SuperscriptBox[
            RowBox[{"vLabToCM", "[", 
             RowBox[{"EpLab", ",", "MP", ",", "mNucleus"}], "]"}], "2"]}]]], 
        "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"EpCMvalBD", "[", 
      RowBox[{"EpLab_", ",", "mNucleus_"}], "]"}], "=", 
     SqrtBox[
      RowBox[{
       SuperscriptBox[
        RowBox[{"pCMprotonZ", "[", 
         RowBox[{"EpLab", ",", 
          RowBox[{"mSM", "[", "\"\<p\>\"", "]"}], ",", "mNucleus"}], "]"}], 
        "2"], "+", 
       SuperscriptBox[
        RowBox[{"mSM", "[", "\"\<p\>\"", "]"}], "2"]}]]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"EnucleusCMvalBD", "[", 
      RowBox[{"EpLab_", ",", "mNucleus_"}], "]"}], "=", 
     SqrtBox[
      RowBox[{
       SuperscriptBox[
        RowBox[{"pCMprotonZ", "[", 
         RowBox[{"EpLab", ",", 
          RowBox[{"mSM", "[", "\"\<p\>\"", "]"}], ",", "mNucleus"}], "]"}], 
        "2"], "+", 
       SuperscriptBox["mNucleus", "2"]}]]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Solutions", " ", "for", " ", "energy", " ", "fractions", " ", 
      SubscriptBox["x", "1"]}], ",", 
     RowBox[{
      SubscriptBox["x", "2"], " ", "carried", " ", "by", " ", "photons", " ", 
      "from", " ", "protons", " ", "and", " ", "the", " ", "nucleus", " ", 
      "Z", " ", "in", " ", "terms", " ", "of", " ", "the", " ", "ALP", " ", 
      "mass", " ", "and", " ", "its", " ", "transverse", " ", "momentum"}]}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"max1x2", "[", 
      RowBox[{"x1_", ",", "x2_", ",", "EpCM_", ",", "EnucleusCM_"}], "]"}], 
     "=", 
     RowBox[{"2", " ", 
      RowBox[{"Sqrt", "[", 
       RowBox[{"x1", "*", "x2"}], "]"}], "*", 
      RowBox[{"Sqrt", "[", 
       RowBox[{"EpCM", "*", "EnucleusCM"}], "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"kzx1x2", "[", 
      RowBox[{"x1_", ",", "x2_", ",", "EpCM_", ",", "EnucleusCM_"}], "]"}], 
     "=", 
     RowBox[{
      RowBox[{"x1", "*", "EpCM"}], "-", 
      RowBox[{"x2", "*", "EnucleusCM"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"sols", "[", 
      RowBox[{"kzCM_", ",", "ma_", ",", "EpCM_", ",", "EnucleusCM_"}], "]"}], 
     "=", 
     RowBox[{
      RowBox[{"Assuming", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"ma", ">", "0"}], "&&", 
         RowBox[{"kZ", ">", "0"}], "&&", 
         RowBox[{"EpCM", ">", "0"}], "&&", 
         RowBox[{"kzCM", ">", "0"}], "&&", 
         RowBox[{"EnucleusCM", ">", "0"}]}], ",", 
        RowBox[{"Simplify", "[", 
         RowBox[{"Solve", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"max1x2", "[", 
               RowBox[{"x1", ",", "x2", ",", "EpCM", ",", "EnucleusCM"}], 
               "]"}], "\[Equal]", "ma"}], "&&", 
             RowBox[{
              RowBox[{"kzx1x2", "[", 
               RowBox[{"x1", ",", "x2", ",", "EpCM", ",", "EnucleusCM"}], 
               "]"}], "\[Equal]", "kzCM"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"x1", ",", "x2"}], "}"}]}], "]"}], "]"}]}], "]"}], "[", 
      RowBox[{"[", "2", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"xpkz", "[", 
        RowBox[{"kzCM_", ",", "ma_", ",", "EpCM_"}], "]"}], ",", 
       RowBox[{"xNucleuskz", "[", 
        RowBox[{"kzCM_", ",", "ma_", ",", "EnucleusCM_"}], "]"}]}], "}"}], 
     "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"x1", "/.", 
        RowBox[{"sols", "[", 
         RowBox[{"kzCM", ",", "ma", ",", "EpCM", ",", "EnucleusCM"}], "]"}]}],
        ",", 
       RowBox[{"x2", "/.", 
        RowBox[{"sols", "[", 
         RowBox[{"kzCM", ",", "ma", ",", "EpCM", ",", "EnucleusCM"}], 
         "]"}]}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"differential", " ", "cross", " ", "section", " ", 
     RowBox[{"d\[Sigma]", "/", 
      SubscriptBox["dk", "T"]}], 
     SubscriptBox["dk", "Z"], 
     SubscriptBox["dp", 
      RowBox[{"T", ",", "1"}]], 
     SubscriptBox["dp", 
      RowBox[{"T", ",", "2"}]]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"IntegrandFusionBeamDumpCMframe", "[", 
      RowBox[{
      "ma_", ",", "kzCM_", ",", "kT_", ",", "pT1_", ",", "pT2_", ",", "EpCM_",
        ",", "EnucleusCM_", ",", "mNucleus_", ",", "Anucleus_", ",", 
       "Znucleus_"}], "]"}], "=", 
     RowBox[{
     "2", "*", "kT", "*", "2", "*", "pT1", "*", "2", "*", "pT2", "*", 
      FractionBox[
       SuperscriptBox["ma", "2"], 
       RowBox[{"32", "*", "EpCM", "*", "EnucleusCM", 
        SqrtBox[
         RowBox[{
          SuperscriptBox["kzCM", "2"], "+", 
          SuperscriptBox["ma", "2"]}]]}]], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"fEPAp", "[", 
           RowBox[{"pT1", ",", 
            RowBox[{"xpkz", "[", 
             RowBox[{"kzCM", ",", "ma", ",", "EpCM"}], "]"}], ",", 
            "\[Alpha]EMval"}], "]"}], "*", 
          RowBox[{"fEPAnucleus", "[", 
           RowBox[{"pT2", ",", 
            RowBox[{"xNucleuskz", "[", 
             RowBox[{"kzCM", ",", "ma", ",", "EnucleusCM"}], "]"}], ",", 
            "\[Alpha]EMval", ",", "mNucleus", ",", "Anucleus", ",", 
            "Znucleus"}], "]"}]}], ")"}], "/", 
        RowBox[{"(", 
         SqrtBox[
          RowBox[{
           RowBox[{"2", "*", 
            SuperscriptBox["kT", "2"], 
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["pT1", "2"], "+", 
              SuperscriptBox["pT2", "2"]}], ")"}]}], "-", 
           SuperscriptBox["kT", "4"], "-", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["pT1", "2"], "-", 
              SuperscriptBox["pT2", "2"]}], ")"}], "2"]}]], ")"}]}], 
       ")"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Jacobian", " ", "of", " ", "transformation", " ", 
      SubscriptBox["k", 
       RowBox[{"z", ",", "CM"}]]}], ",", 
     RowBox[{
      SubscriptBox["k", "T"], " ", "\[Rule]", " ", 
      SubscriptBox["E", "a"]}], ",", 
     SubscriptBox["\[Theta]", "a"]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"kTto\[Theta]a", "[", 
      RowBox[{"ma_", ",", "\[Theta]a_", ",", "Ea_"}], "]"}], "=", 
     RowBox[{
      SqrtBox[
       RowBox[{
        SuperscriptBox["Ea", "2"], "-", 
        SuperscriptBox["ma", "2"]}]], "*", 
      RowBox[{"Sin", "[", "\[Theta]a", "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"kzCMtoEa", "[", 
      RowBox[{
      "ma_", ",", "\[Theta]a_", ",", "Ea_", ",", "EpLab_", ",", "mNucleus_"}],
       "]"}], "=", 
     FractionBox[
      RowBox[{"(", 
       RowBox[{
        SqrtBox[
         RowBox[{
          SuperscriptBox["Ea", "2"], "-", 
          SuperscriptBox["ma", "2"], "-", 
          SuperscriptBox[
           RowBox[{"kTto\[Theta]a", "[", 
            RowBox[{"ma", ",", "\[Theta]a", ",", "Ea"}], "]"}], "2"]}]], "-", 
        
        RowBox[{
         RowBox[{"vLabToCM", "[", 
          RowBox[{"EpLab", ",", 
           RowBox[{"mSM", "[", "\"\<p\>\"", "]"}], ",", "mNucleus"}], "]"}], 
         "*", "Ea"}]}], ")"}], 
      SqrtBox[
       RowBox[{"1", "-", 
        SuperscriptBox[
         RowBox[{"vLabToCM", "[", 
          RowBox[{"EpLab", ",", 
           RowBox[{"mSM", "[", "\"\<p\>\"", "]"}], ",", "mNucleus"}], "]"}], 
         "2"]}]]]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"JacobiankzCMkTto\[Theta]aEa", "[", 
     RowBox[{
     "ma_", ",", "\[Theta]a_", ",", "Ea_", ",", "EpLab_", ",", "mNucleus_"}], 
     "]"}], "=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"kzCMtoEa", "[", 
           RowBox[{
           "ma", ",", "\[Theta]a", ",", "Ea", ",", "EpLab", ",", "mNucleus"}],
            "]"}], ",", "\[Theta]a"}], "]"}], "*", 
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"kTto\[Theta]a", "[", 
           RowBox[{"ma", ",", "\[Theta]a", ",", "Ea"}], "]"}], ",", "Ea"}], 
         "]"}]}], "-", 
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"kzCMtoEa", "[", 
           RowBox[{
           "ma", ",", "\[Theta]a", ",", "Ea", ",", "EpLab", ",", "mNucleus"}],
            "]"}], ",", "Ea"}], "]"}], "*", 
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"kTto\[Theta]a", "[", 
           RowBox[{"ma", ",", "\[Theta]a", ",", "Ea"}], "]"}], ",", 
          "\[Theta]a"}], "]"}]}]}], ")"}], "//", "Simplify"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Differential", " ", "probability", " ", 
     SuperscriptBox["d", "2"], 
     RowBox[{"P", "/", 
      SubscriptBox["d\[Theta]", "a"]}], 
     SubscriptBox["dE", "a"]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"IntegrandFusionBeamDump", "[", 
      RowBox[{
      "ma_", ",", "\[Theta]a_", ",", "Ea_", ",", "pT1_", ",", "pT2_", ",", 
       "EpLab_", ",", "mNucleus_", ",", "Anucleus_", ",", "Znucleus_"}], 
      "]"}], "=", 
     RowBox[{
      RowBox[{"Abs", "[", 
       RowBox[{"JacobiankzCMkTto\[Theta]aEa", "[", 
        RowBox[{
        "ma", ",", "\[Theta]a", ",", "Ea", ",", "EpLab", ",", "mNucleus"}], 
        "]"}], "]"}], "*", 
      RowBox[{"IntegrandFusionBeamDumpCMframe", "[", 
       RowBox[{"ma", ",", 
        RowBox[{"kzCMtoEa", "[", 
         RowBox[{
         "ma", ",", "\[Theta]a", ",", "Ea", ",", "EpLab", ",", "mNucleus"}], 
         "]"}], ",", 
        RowBox[{"kTto\[Theta]a", "[", 
         RowBox[{"ma", ",", "\[Theta]a", ",", "Ea"}], "]"}], ",", "pT1", ",", 
        "pT2", ",", 
        RowBox[{"EpCMvalBD", "[", 
         RowBox[{"EpLab", ",", "mNucleus"}], "]"}], ",", 
        RowBox[{"EnucleusCMvalBD", "[", 
         RowBox[{"EpLab", ",", "mNucleus"}], "]"}], ",", "mNucleus", ",", 
        "Anucleus", ",", "Znucleus"}], "]"}]}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{
  3.88782180303936*^9, {3.887821872558405*^9, 3.8878218731281548`*^9}, {
   3.887821925008505*^9, 3.887821927720916*^9}, 3.887822228229649*^9, {
   3.8878222719698057`*^9, 3.887822272318781*^9}, {3.8878234819382324`*^9, 
   3.8878234839100513`*^9}, {3.8922727485591493`*^9, 
   3.8922727485591493`*^9}, {3.892273765035659*^9, 3.89227376505128*^9}, {
   3.893658188156721*^9, 3.893658317312301*^9}, {3.89365867959823*^9, 
   3.8936586840451984`*^9}, {3.893660309724543*^9, 3.8936603361089144`*^9}, {
   3.893660379537732*^9, 3.8936603836720176`*^9}, {3.913479686174681*^9, 
   3.913479701789462*^9}, {3.913479801724353*^9, 3.913479810920942*^9}, {
   3.913534092800067*^9, 3.913534092984067*^9}, {3.913627024244894*^9, 
   3.913627043666946*^9}, {3.9136270742662635`*^9, 3.913627074836466*^9}, {
   3.914651870785683*^9, 3.914651874344766*^9}, {3.916285721667618*^9, 
   3.916285724011607*^9}},
 CellTags->"Evaluation",
 CellLabel->
  "In[971]:=",ExpressionUUID->"eb94db9a-b0be-4ec4-a74c-00f25a0acfd3"],

Cell[BoxData[
 FormBox[
  TemplateBox[{
   "Solve", "nongen", 
    "\"There may be values of the parameters for which some or all solutions \
are not valid.\"", 2, 977, 23, 29079336519732941073, "Local"},
   "MessageTemplate"], TraditionalForm]], "Message", "MSG",
 CellChangeTimes->{3.9302115215707693`*^9, 3.930822753669879*^9},
 CellTags->"Evaluation",
 CellLabel->
  "Durante la evaluaci\[OAcute]n de \
In[971]:=",ExpressionUUID->"4f8baeed-6e1b-4564-9f60-5abe007a30b3"],

Cell[BoxData[
 FormBox[
  RowBox[{"-", 
   FractionBox[
    RowBox[{
     SqrtBox[
      RowBox[{
       SuperscriptBox["Ea", "2"], "-", 
       SuperscriptBox["ma", "2"]}]], " ", 
     RowBox[{"cos", "(", "\[Theta]a", ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Ea", " ", 
        RowBox[{"(", 
         RowBox[{"EpLab", "+", "mNucleus"}], ")"}]}], "-", 
       RowBox[{
        SqrtBox[
         RowBox[{
          SuperscriptBox["EpLab", "2"], "-", "0.8798439999999998`"}]], " ", 
        SqrtBox[
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["Ea", "2"], "-", 
            SuperscriptBox["ma", "2"]}], ")"}], " ", 
          RowBox[{
           SuperscriptBox["cos", "2"], "(", "\[Theta]a", ")"}]}]]}]}], 
      ")"}]}], 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"EpLab", "+", "mNucleus"}], ")"}], " ", 
     SqrtBox[
      RowBox[{"1", "-", 
       FractionBox[
        RowBox[{
         SuperscriptBox["EpLab", "2"], "-", "0.8798439999999998`"}], 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"EpLab", "+", "mNucleus"}], ")"}], "2"]]}]], " ", 
     SqrtBox[
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["Ea", "2"], "-", 
         SuperscriptBox["ma", "2"]}], ")"}], " ", 
       RowBox[{
        SuperscriptBox["cos", "2"], "(", "\[Theta]a", ")"}]}]]}]]}], 
  TraditionalForm]], "Output",
 CellChangeTimes->{3.9302115217508907`*^9, 3.930822753850415*^9},
 CellTags->"Evaluation",
 CellLabel->
  "Out[982]=",ExpressionUUID->"a4d1980b-a2f3-4f4c-b4b5-efcb30b9222e"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Explicit form (with all parameters inserted)", "Subsubsection",
 CellChangeTimes->{{3.913480267109129*^9, 3.9134802736387873`*^9}},
 CellTags->
  "Evaluation",ExpressionUUID->"444afafe-c64f-41b7-b6cf-aa908a1e192f"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Do", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"Z", ",", "Facility"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Z", "=", "z"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Facility", "=", "facility"}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"IntegrandFusionTemp", "[", 
         RowBox[{
         "ma_", ",", "\[Theta]a_", ",", "Ea_", ",", "pT1_", ",", "pT2_", ",", 
          "Facility", ",", "Z"}], "]"}], "=", 
        RowBox[{"IntegrandFusionBeamDump", "[", 
         RowBox[{
         "ma", ",", "\[Theta]a", ",", "Ea", ",", "pT1", ",", "pT2", ",", 
          RowBox[{"EmaxFacility", "[", "Facility", "]"}], ",", 
          RowBox[{"mnucleus", "[", "Z", "]"}], ",", 
          RowBox[{"anucleus", "[", "Z", "]"}], ",", 
          RowBox[{"znucleus", "[", "Z", "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"IntegrandFusion", "[", 
         RowBox[{
         "ma_", ",", "\[Theta]a_", ",", "Ea_", ",", "pT1_", ",", "pT2_", ",", 
          "Facility", ",", "Z"}], "]"}], "=", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Abs", "[", 
             RowBox[{"pT1", "-", "pT2"}], "]"}], 
            RowBox[{"(", 
             RowBox[{"1", "+", "\[Epsilon]Regularization"}], ")"}]}], "<", 
           RowBox[{"kTto\[Theta]a", "[", 
            RowBox[{"ma", ",", "\[Theta]a", ",", "Ea"}], "]"}], "<", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"pT1", "+", "pT2"}], ")"}], 
            RowBox[{"(", 
             RowBox[{"1", "-", "\[Epsilon]Regularization"}], ")"}]}]}], ",", 
          RowBox[{"Evaluate", "[", 
           RowBox[{"IntegrandFusionTemp", "[", 
            RowBox[{
            "ma", ",", "\[Theta]a", ",", "Ea", ",", "pT1", ",", "pT2", ",", 
             "Facility", ",", "Z"}], "]"}], "]"}], ",", "0."}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"xpkzExpl", "[", 
           RowBox[{
           "ma_", ",", "\[Theta]a_", ",", "Ea_", ",", "Facility", ",", "Z"}], 
           "]"}], ",", 
          RowBox[{"xNucleuskzExpl", "[", 
           RowBox[{
           "ma_", ",", "\[Theta]a_", ",", "Ea_", ",", "Facility", ",", "Z"}], 
           "]"}], ",", 
          RowBox[{"pTprotonMaxEPAexpl", "[", 
           RowBox[{
           "ma_", ",", "\[Theta]a_", ",", "Ea_", ",", "Facility", ",", "Z"}], 
           "]"}], ",", 
          RowBox[{"pTnucleusMaxEPAexpl", "[", 
           RowBox[{
           "ma_", ",", "\[Theta]a_", ",", "Ea_", ",", "Facility", ",", "Z"}], 
           "]"}]}], "}"}], "=", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"xpkz", "[", 
            RowBox[{
             RowBox[{"kzCMtoEa", "[", 
              RowBox[{
              "ma", ",", "\[Theta]a", ",", "Ea", ",", "EpLab", ",", 
               "mNucleus"}], "]"}], ",", "ma", ",", 
             RowBox[{"EpCMvalBD", "[", 
              RowBox[{"EpLab", ",", "mNucleus"}], "]"}]}], "]"}], ",", 
           RowBox[{"xNucleuskz", "[", 
            RowBox[{
             RowBox[{"kzCMtoEa", "[", 
              RowBox[{
              "ma", ",", "\[Theta]a", ",", "Ea", ",", "EpLab", ",", 
               "mNucleus"}], "]"}], ",", "ma", ",", 
             RowBox[{"EnucleusCMvalBD", "[", 
              RowBox[{"EpLab", ",", "mNucleus"}], "]"}]}], "]"}], ",", 
           RowBox[{"pTprotonMaxEPA", "[", 
            RowBox[{"xpkz", "[", 
             RowBox[{
              RowBox[{"kzCMtoEa", "[", 
               RowBox[{
               "ma", ",", "\[Theta]a", ",", "Ea", ",", "EpLab", ",", 
                "mNucleus"}], "]"}], ",", "ma", ",", 
              RowBox[{"EpCMvalBD", "[", 
               RowBox[{"EpLab", ",", "mNucleus"}], "]"}]}], "]"}], "]"}], ",", 
           RowBox[{"pTnucleusMaxEPA", "[", 
            RowBox[{
             RowBox[{"xNucleuskz", "[", 
              RowBox[{
               RowBox[{"kzCMtoEa", "[", 
                RowBox[{
                "ma", ",", "\[Theta]a", ",", "Ea", ",", "EpLab", ",", 
                 "mNucleus"}], "]"}], ",", "ma", ",", 
               RowBox[{"EnucleusCMvalBD", "[", 
                RowBox[{"EpLab", ",", "mNucleus"}], "]"}]}], "]"}], ",", 
             "mNucleus", ",", "Anucleus"}], "]"}]}], "}"}], "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"mNucleus", "\[Rule]", 
            RowBox[{"mnucleus", "[", "Z", "]"}]}], ",", 
           RowBox[{"EpLab", "\[Rule]", 
            RowBox[{"EmaxFacility", "[", "Facility", "]"}]}], ",", 
           RowBox[{"Anucleus", "\[Rule]", 
            RowBox[{"anucleus", "[", "Z", "]"}]}]}], "}"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
          RowBox[{
          "Converting", " ", "the", " ", "integrand", " ", "to", " ", "the", 
           " ", "variables", " ", "m"}], " ", "=", " ", 
          RowBox[{"(", 
           RowBox[{
            SubscriptBox["p", 
             RowBox[{"T", ",", "1"}]], "+", 
            SubscriptBox["p", 
             RowBox[{"T", ",", "2"}]]}], ")"}]}], ",", 
         RowBox[{"t", "=", 
          RowBox[{"(", 
           RowBox[{
            SubscriptBox["p", 
             RowBox[{"T", ",", "1"}]], "-", 
            SubscriptBox["p", 
             RowBox[{"T", ",", "2"}]]}], ")"}]}]}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"tmax", "[", 
         RowBox[{
         "ma_", ",", "\[Theta]a_", ",", "Ea_", ",", "Facility", ",", "Z"}], 
         "]"}], "=", 
        RowBox[{"Min", "[", 
         RowBox[{
          RowBox[{"kTto\[Theta]a", "[", 
           RowBox[{"ma", ",", "\[Theta]a", ",", "Ea"}], "]"}], ",", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"pTprotonMaxEPAexpl", "[", 
             RowBox[{
             "ma", ",", "\[Theta]a", ",", "Ea", ",", "Facility", ",", "Z"}], 
             "]"}], "-", 
            RowBox[{"pTnucleusMinEPA", "[", 
             RowBox[{"mnucleus", "[", "Z", "]"}], "]"}]}], ")"}]}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"tmin", "[", 
         RowBox[{
         "ma_", ",", "\[Theta]a_", ",", "Ea_", ",", "Facility", ",", "Z"}], 
         "]"}], "=", 
        RowBox[{"-", 
         RowBox[{"Min", "[", 
          RowBox[{
           RowBox[{"pTnucleusMaxEPAexpl", "[", 
            RowBox[{
            "ma", ",", "\[Theta]a", ",", "Ea", ",", "Facility", ",", "Z"}], 
            "]"}], ",", 
           RowBox[{"kTto\[Theta]a", "[", 
            RowBox[{"ma", ",", "\[Theta]a", ",", "Ea"}], "]"}]}], "]"}]}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"mmax", "[", 
         RowBox[{
         "ma_", ",", "\[Theta]a_", ",", "Ea_", ",", "Facility", ",", "Z"}], 
         "]"}], "=", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"pTprotonMaxEPAexpl", "[", 
           RowBox[{
           "ma", ",", "\[Theta]a", ",", "Ea", ",", "Facility", ",", "Z"}], 
           "]"}], "+", 
          RowBox[{"pTnucleusMaxEPAexpl", "[", 
           RowBox[{
           "ma", ",", "\[Theta]a", ",", "Ea", ",", "Facility", ",", "Z"}], 
           "]"}]}], ")"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"mmin", "[", 
         RowBox[{
         "ma_", ",", "\[Theta]a_", ",", "Ea_", ",", "Facility", ",", "Z"}], 
         "]"}], "=", 
        RowBox[{"Max", "[", 
         RowBox[{
          RowBox[{"pTnucleusMinEPA", "[", 
           RowBox[{"mnucleus", "[", "Z", "]"}], "]"}], ",", 
          RowBox[{"kTto\[Theta]a", "[", 
           RowBox[{"ma", ",", "\[Theta]a", ",", "Ea"}], "]"}]}], "]"}]}], ";",
        "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"IntegrandFusionConverted", "[", 
         RowBox[{
         "ma_", ",", "\[Theta]a_", ",", "Ea_", ",", "m_", ",", "t_", ",", 
          "Facility", ",", "Z"}], "]"}], "=", 
        RowBox[{
         FractionBox["1", "2"], 
         RowBox[{
          RowBox[{"IntegrandFusion", "[", 
           RowBox[{"ma", ",", "\[Theta]a", ",", "Ea", ",", 
            FractionBox[
             RowBox[{"m", "+", "t"}], "2"], ",", 
            FractionBox[
             RowBox[{"(", 
              RowBox[{"m", "-", "t"}], ")"}], "2"], ",", "Facility", ",", 
            "Z"}], "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"\[Epsilon]v", "=", 
        SuperscriptBox["10", 
         RowBox[{"-", "9"}]]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
          RowBox[{"d2\[Sigma]d\[Theta]adEaFusionFast", "[", 
           RowBox[{
           "ma_", ",", "\[Theta]a_", ",", "Ea_", ",", "Facility", ",", "Z"}], 
           "]"}], ":=", 
          RowBox[{"With", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"MMAX", "=", 
               RowBox[{"mmax", "[", 
                RowBox[{
                "ma", ",", "\[Theta]a", ",", "Ea", ",", "Facility", ",", 
                 "Z"}], "]"}]}], ",", 
              RowBox[{"MMIN", "=", 
               RowBox[{"mmin", "[", 
                RowBox[{
                "ma", ",", "\[Theta]a", ",", "Ea", ",", "Facility", ",", 
                 "Z"}], "]"}]}]}], "}"}], ",", 
            RowBox[{"GeVm2Topb", "*", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"ma", "<", "Ea"}], "&&", 
                RowBox[{
                 RowBox[{"xpkzExpl", "[", 
                  RowBox[{
                  "ma", ",", "\[Theta]a", ",", "Ea", ",", "Facility", ",", 
                   "Z"}], "]"}], "<", 
                 RowBox[{"xminmaxEPA", "[", 
                  RowBox[{
                   RowBox[{"mSM", "[", "\"\<p\>\"", "]"}], ",", "q2pMax"}], 
                  "]"}]}], "&&", 
                RowBox[{
                 RowBox[{"xminNucleusEPA", "[", 
                  RowBox[{"mnucleus", "[", "Z", "]"}], "]"}], "<", 
                 "\[IndentingNewLine]", 
                 RowBox[{"xNucleuskzExpl", "[", 
                  RowBox[{
                  "ma", ",", "\[Theta]a", ",", "Ea", ",", "Facility", ",", 
                   "Z"}], "]"}], "<", 
                 RowBox[{"xminmaxEPA", "[", 
                  RowBox[{
                   RowBox[{"mnucleus", "[", "Z", "]"}], ",", 
                   RowBox[{"q2nucleusMax", "[", 
                    RowBox[{"anucleus", "[", "Z", "]"}], "]"}]}], "]"}]}], "&&", 
                RowBox[{"MMIN", "<", "MMAX"}]}], ",", 
               RowBox[{"NIntegrate", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"IntegrandFusionConverted", "[", 
                   RowBox[{"ma", ",", "\[Theta]a", ",", "Ea", ",", 
                    RowBox[{"Exp", "[", "m", "]"}], ",", "t", ",", "Facility",
                     ",", "Z"}], "]"}], 
                  RowBox[{"Exp", "[", "m", "]"}]}], ",", 
                 RowBox[{"{", 
                  RowBox[{"t", ",", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "\[Epsilon]Regularization"}], ")"}], 
                    RowBox[{"tmin", "[", 
                    RowBox[{
                    "ma", ",", "\[Theta]a", ",", "Ea", ",", "Facility", ",", 
                    "Z"}], "]"}]}], ",", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "\[Epsilon]Regularization"}], ")"}], 
                    RowBox[{"tmax", "[", 
                    RowBox[{
                    "ma", ",", "\[Theta]a", ",", "Ea", ",", "Facility", ",", 
                    "Z"}], "]"}]}]}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"m", ",", 
                   RowBox[{"Log", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "+", "\[Epsilon]Regularization"}], ")"}], 
                    "MMIN"}], "]"}], ",", 
                   RowBox[{"Log", "[", "MMAX", "]"}]}], "}"}], ",", 
                 RowBox[{"Method", "->", "\"\<AdaptiveMonteCarlo\>\""}]}], 
                "]"}], ",", "0."}], "]"}]}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"d2\[Sigma]d\[Theta]adEaFusionSlow", "[", 
           RowBox[{
           "ma_", ",", "\[Theta]a_", ",", "Ea_", ",", "Facility", ",", "Z"}], 
           "]"}], ":=", 
          RowBox[{"With", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"MMAX", "=", 
               RowBox[{"mmax", "[", 
                RowBox[{
                "ma", ",", "\[Theta]a", ",", "Ea", ",", "Facility", ",", 
                 "Z"}], "]"}]}], ",", 
              RowBox[{"MMIN", "=", 
               RowBox[{"mmin", "[", 
                RowBox[{
                "ma", ",", "\[Theta]a", ",", "Ea", ",", "Facility", ",", 
                 "Z"}], "]"}]}]}], "}"}], ",", 
            RowBox[{"GeVm2Topb", "*", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"ma", "<", "Ea"}], "&&", 
                RowBox[{
                 RowBox[{"xpkzExpl", "[", 
                  RowBox[{
                  "ma", ",", "\[Theta]a", ",", "Ea", ",", "Facility", ",", 
                   "Z"}], "]"}], "<", 
                 RowBox[{"xminmaxEPA", "[", 
                  RowBox[{
                   RowBox[{"mSM", "[", "\"\<p\>\"", "]"}], ",", "q2pMax"}], 
                  "]"}]}], "&&", 
                RowBox[{
                 RowBox[{"xminNucleusEPA", "[", 
                  RowBox[{"mnucleus", "[", "Z", "]"}], "]"}], "<", 
                 "\[IndentingNewLine]", 
                 RowBox[{"xNucleuskzExpl", "[", 
                  RowBox[{
                  "ma", ",", "\[Theta]a", ",", "Ea", ",", "Facility", ",", 
                   "Z"}], "]"}], "<", 
                 RowBox[{"xminmaxEPA", "[", 
                  RowBox[{
                   RowBox[{"mnucleus", "[", "Z", "]"}], ",", 
                   RowBox[{"q2nucleusMax", "[", 
                    RowBox[{"anucleus", "[", "Z", "]"}], "]"}]}], "]"}]}], "&&", 
                RowBox[{"MMIN", "<", "MMAX"}]}], ",", 
               RowBox[{"NIntegrate", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"IntegrandFusionConverted", "[", 
                   RowBox[{"ma", ",", "\[Theta]a", ",", "Ea", ",", 
                    RowBox[{"Exp", "[", "m", "]"}], ",", "t", ",", "Facility",
                     ",", "Z"}], "]"}], 
                  RowBox[{"Exp", "[", "m", "]"}]}], ",", 
                 RowBox[{"{", 
                  RowBox[{"t", ",", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "\[Epsilon]Regularization"}], ")"}], 
                    RowBox[{"tmin", "[", 
                    RowBox[{
                    "ma", ",", "\[Theta]a", ",", "Ea", ",", "Facility", ",", 
                    "Z"}], "]"}]}], ",", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "\[Epsilon]Regularization"}], ")"}], 
                    RowBox[{"tmax", "[", 
                    RowBox[{
                    "ma", ",", "\[Theta]a", ",", "Ea", ",", "Facility", ",", 
                    "Z"}], "]"}]}]}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"m", ",", 
                   RowBox[{"Log", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "+", "\[Epsilon]Regularization"}], ")"}], 
                    "MMIN"}], "]"}], ",", 
                   RowBox[{"Log", "[", "MMAX", "]"}]}], "}"}]}], "]"}], ",", 
               "0."}], "]"}]}]}], "]"}]}], ";"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"d2\[Sigma]d\[Theta]adEaFusion", "[", 
         RowBox[{
         "ma_", ",", "\[Theta]a_", ",", "Ea_", ",", "Facility", ",", "Z"}], 
         "]"}], ":=", 
        RowBox[{"With", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"MMAX", "=", 
             RowBox[{"mmax", "[", 
              RowBox[{
              "ma", ",", "\[Theta]a", ",", "Ea", ",", "Facility", ",", "Z"}], 
              "]"}]}], ",", 
            RowBox[{"MMIN", "=", 
             RowBox[{"mmin", "[", 
              RowBox[{
              "ma", ",", "\[Theta]a", ",", "Ea", ",", "Facility", ",", "Z"}], 
              "]"}]}]}], "}"}], ",", 
          RowBox[{"GeVm2Topb", "*", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"ma", "<", "Ea"}], "&&", 
              RowBox[{
               RowBox[{"xpkzExpl", "[", 
                RowBox[{
                "ma", ",", "\[Theta]a", ",", "Ea", ",", "Facility", ",", 
                 "Z"}], "]"}], "<", 
               RowBox[{"xminmaxEPA", "[", 
                RowBox[{
                 RowBox[{"mSM", "[", "\"\<p\>\"", "]"}], ",", "q2pMax"}], 
                "]"}]}], "&&", 
              RowBox[{
               RowBox[{"xminNucleusEPA", "[", 
                RowBox[{"mnucleus", "[", "Z", "]"}], "]"}], "<", 
               "\[IndentingNewLine]", 
               RowBox[{"xNucleuskzExpl", "[", 
                RowBox[{
                "ma", ",", "\[Theta]a", ",", "Ea", ",", "Facility", ",", 
                 "Z"}], "]"}], "<", 
               RowBox[{"xminmaxEPA", "[", 
                RowBox[{
                 RowBox[{"mnucleus", "[", "Z", "]"}], ",", 
                 RowBox[{"q2nucleusMax", "[", 
                  RowBox[{"anucleus", "[", "Z", "]"}], "]"}]}], "]"}]}], "&&", 
              RowBox[{"MMIN", "<", "MMAX"}]}], ",", 
             RowBox[{"NIntegrate", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"IntegrandFusionConverted", "[", 
                 RowBox[{"ma", ",", "\[Theta]a", ",", "Ea", ",", 
                  RowBox[{"Exp", "[", "m", "]"}], ",", "t", ",", "Facility", 
                  ",", "Z"}], "]"}], 
                RowBox[{"Exp", "[", "m", "]"}]}], ",", 
               RowBox[{"{", 
                RowBox[{"t", ",", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"1", "-", "\[Epsilon]v"}], ")"}], 
                  RowBox[{"tmin", "[", 
                   RowBox[{
                   "ma", ",", "\[Theta]a", ",", "Ea", ",", "Facility", ",", 
                    "Z"}], "]"}]}], ",", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"1", "-", "\[Epsilon]v"}], ")"}], 
                  RowBox[{"tmax", "[", 
                   RowBox[{
                   "ma", ",", "\[Theta]a", ",", "Ea", ",", "Facility", ",", 
                    "Z"}], "]"}]}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"m", ",", 
                 RowBox[{"Log", "[", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"1", "+", "\[Epsilon]v"}], ")"}], "MMIN"}], "]"}],
                  ",", 
                 RowBox[{"Log", "[", "MMAX", "]"}]}], "}"}], ",", 
               RowBox[{"Method", "->", "\"\<DoubleExponential\>\""}]}], "]"}],
              ",", "0."}], "]"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"d2\[Sigma]d\[Theta]adEaFusion1", "[", 
         RowBox[{
         "ma_", ",", "\[Theta]a_", ",", "Ea_", ",", "Facility", ",", "Z"}], 
         "]"}], ":=", 
        RowBox[{"With", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"MMAX", "=", 
             RowBox[{"mmax", "[", 
              RowBox[{
              "ma", ",", "\[Theta]a", ",", "Ea", ",", "Facility", ",", "Z"}], 
              "]"}]}], ",", 
            RowBox[{"MMIN", "=", 
             RowBox[{"mmin", "[", 
              RowBox[{
              "ma", ",", "\[Theta]a", ",", "Ea", ",", "Facility", ",", "Z"}], 
              "]"}]}]}], "}"}], ",", 
          RowBox[{"GeVm2Topb", "*", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"ma", "<", "Ea"}], "&&", 
              RowBox[{
               RowBox[{"xpkzExpl", "[", 
                RowBox[{
                "ma", ",", "\[Theta]a", ",", "Ea", ",", "Facility", ",", 
                 "Z"}], "]"}], "<", 
               RowBox[{"xminmaxEPA", "[", 
                RowBox[{
                 RowBox[{"mSM", "[", "\"\<p\>\"", "]"}], ",", "q2pMax"}], 
                "]"}]}], "&&", 
              RowBox[{
               RowBox[{"xminNucleusEPA", "[", 
                RowBox[{"mnucleus", "[", "Z", "]"}], "]"}], "<", 
               "\[IndentingNewLine]", 
               RowBox[{"xNucleuskzExpl", "[", 
                RowBox[{
                "ma", ",", "\[Theta]a", ",", "Ea", ",", "Facility", ",", 
                 "Z"}], "]"}], "<", 
               RowBox[{"xminmaxEPA", "[", 
                RowBox[{
                 RowBox[{"mnucleus", "[", "Z", "]"}], ",", 
                 RowBox[{"q2nucleusMax", "[", 
                  RowBox[{"anucleus", "[", "Z", "]"}], "]"}]}], "]"}]}], "&&", 
              RowBox[{"MMIN", "<", "MMAX"}]}], ",", 
             RowBox[{"NIntegrate", "[", 
              RowBox[{
               RowBox[{"IntegrandFusionConverted", "[", 
                RowBox[{
                "ma", ",", "\[Theta]a", ",", "Ea", ",", "m", ",", "t", ",", 
                 "Facility", ",", "Z"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"t", ",", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"1", "-", "\[Epsilon]v"}], ")"}], 
                  RowBox[{"tmin", "[", 
                   RowBox[{
                   "ma", ",", "\[Theta]a", ",", "Ea", ",", "Facility", ",", 
                    "Z"}], "]"}]}], ",", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"1", "-", "\[Epsilon]v"}], ")"}], 
                  RowBox[{"tmax", "[", 
                   RowBox[{
                   "ma", ",", "\[Theta]a", ",", "Ea", ",", "Facility", ",", 
                    "Z"}], "]"}]}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"m", ",", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"1", "+", "\[Epsilon]v"}], ")"}], "MMIN"}], ",", 
                 "MMAX"}], "}"}], ",", 
               RowBox[{"Method", "->", "\"\<DoubleExponential\>\""}]}], "]"}],
              ",", "0."}], "]"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Because", " ", "of", " ", "numeric", " ", "inaccuracy"}], 
         ",", " ", 
         RowBox[{
         "Mathematica", " ", "will", " ", "return", " ", "some", " ", 
          "imaginary", " ", 
          RowBox[{"part", ".", " ", "This"}], " ", "is", " ", "omitted", " ", 
          "by", " ", "taking", " ", "Re"}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"d2Pd\[Theta]adEaFusion", "[", 
         RowBox[{
         "ma_", ",", "\[Theta]a_", ",", "Ea_", ",", "Facility", ",", "Z"}], 
         "]"}], ":=", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"Ea", ">", "ma"}], ",", 
          RowBox[{"Re", "[", 
           FractionBox[
            RowBox[{"d2\[Sigma]d\[Theta]adEaFusion", "[", 
             RowBox[{
             "ma", ",", "\[Theta]a", ",", "Ea", ",", "Facility", ",", "Z"}], 
             "]"}], 
            RowBox[{"\[Sigma]pNucleus", "[", "Z", "]"}]], "]"}], ",", "0."}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"d2Pd\[Theta]adEaFusion1", "[", 
         RowBox[{
         "ma_", ",", "\[Theta]a_", ",", "Ea_", ",", "Facility", ",", "Z"}], 
         "]"}], ":=", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"Ea", ">", "ma"}], ",", 
          RowBox[{"Re", "[", 
           FractionBox[
            RowBox[{"d2\[Sigma]d\[Theta]adEaFusion1", "[", 
             RowBox[{
             "ma", ",", "\[Theta]a", ",", "Ea", ",", "Facility", ",", "Z"}], 
             "]"}], 
            RowBox[{"\[Sigma]pNucleus", "[", "Z", "]"}]], "]"}], ",", "0."}], 
         "]"}]}], ";"}]}], "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{
        RowBox[{"d2Pd\[Theta]adEaFusionSlow", "[", 
         RowBox[{
         "ma_", ",", "\[Theta]a_", ",", "Ea_", ",", "Facility", ",", "Z"}], 
         "]"}], ":=", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"Ea", ">", "ma"}], ",", 
          FractionBox[
           RowBox[{"d2\[Sigma]d\[Theta]adEaFusionSlow", "[", 
            RowBox[{
            "ma", ",", "\[Theta]a", ",", "Ea", ",", "Facility", ",", "Z"}], 
            "]"}], 
           RowBox[{"\[Sigma]pNucleus", "[", "Z", "]"}]], ",", "0."}], "]"}]}],
        ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"d2Pd\[Theta]adEaFusionFast", "[", 
         RowBox[{
         "ma_", ",", "\[Theta]a_", ",", "Ea_", ",", "Facility", ",", "Z"}], 
         "]"}], ":=", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"Ea", ">", "ma"}], ",", 
          FractionBox[
           RowBox[{"d2\[Sigma]d\[Theta]adEaFusionFast", "[", 
            RowBox[{
            "ma", ",", "\[Theta]a", ",", "Ea", ",", "Facility", ",", "Z"}], 
            "]"}], 
           RowBox[{"\[Sigma]pNucleus", "[", "Z", "]"}]], ",", "0."}], "]"}]}],
        ";"}], "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}], 
    ";"}], "\[IndentingNewLine]", ",", 
   RowBox[{"{", 
    RowBox[{"z", ",", 
     RowBox[{"{", 
      RowBox[{"\"\<Fe\>\"", ",", "\"\<Mo\>\"", ",", "\"\<C\>\""}], "}"}]}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"facility", ",", 
     RowBox[{"{", 
      RowBox[{
      "\"\<SPS\>\"", ",", "\"\<FermilabBD\>\"", ",", "\"\<Serpukhov\>\""}], 
      "}"}]}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Quiet", "[", 
   RowBox[{"d2Pd\[Theta]adEaFusion", "[", 
    RowBox[{"1", ",", 
     SuperscriptBox["10", 
      RowBox[{"-", "4."}]], ",", "100", ",", "\"\<SPS\>\"", ",", 
     "\"\<Mo\>\""}], "]"}], "]"}], "//", 
  "AbsoluteTiming"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"Quiet", "[", 
      RowBox[{"d2Pd\[Theta]adEaFusionSlow", "[", 
       RowBox[{"0.02", ",", 
        SuperscriptBox["10", 
         RowBox[{"-", "4."}]], ",", "10", ",", "\"\<SPS\>\"", ",", 
        "\"\<Mo\>\""}], "]"}], "]"}], "//", 
     RowBox[{"AbsoluteTiming", "\[IndentingNewLine]", 
      RowBox[{"Quiet", "[", 
       RowBox[{"d2Pd\[Theta]adEaFusionFast", "[", 
        RowBox[{"0.02", ",", 
         SuperscriptBox["10", 
          RowBox[{"-", "4."}]], ",", "10", ",", "\"\<SPS\>\"", ",", 
         "\"\<Mo\>\""}], "]"}], "]"}]}]}], "//", "AbsoluteTiming"}], 
   "*)"}]}]}], "Input",
 CellChangeTimes->{{3.9134802767136145`*^9, 3.9134808498628926`*^9}, {
   3.913480882144353*^9, 3.913480884041393*^9}, {3.913481088393675*^9, 
   3.9134810885962095`*^9}, {3.913481185317958*^9, 3.913481188442723*^9}, 
   3.913481251046889*^9, {3.9134813813086576`*^9, 3.913481412818684*^9}, {
   3.9135330869281077`*^9, 3.913533121057399*^9}, {3.913534071491436*^9, 
   3.913534092806863*^9}, {3.91356983120631*^9, 3.9135698324589667`*^9}, {
   3.913569921740131*^9, 3.913569941142585*^9}, {3.913618724445203*^9, 
   3.913618727057599*^9}, {3.913619107835983*^9, 3.913619176317072*^9}, {
   3.913619216218994*^9, 3.913619249244993*^9}, {3.9136219014538574`*^9, 
   3.9136219053916445`*^9}, {3.913622602326371*^9, 3.913622676632349*^9}, {
   3.913623094852784*^9, 3.913623100076094*^9}, {3.913623175901532*^9, 
   3.913623238015996*^9}, {3.913623295357414*^9, 3.913623295541677*^9}, {
   3.913623331998661*^9, 3.91362334448648*^9}, 3.913626127104907*^9, {
   3.9136270742875857`*^9, 3.913627074308478*^9}, 3.913651232662139*^9, {
   3.9136539168704424`*^9, 3.9136539275972238`*^9}, {3.913654033001672*^9, 
   3.9136540352920666`*^9}, 3.91365408828963*^9, {3.913654192015275*^9, 
   3.913654195014103*^9}, {3.913654460678055*^9, 3.913654509681278*^9}, {
   3.913654550282878*^9, 3.9136545685947847`*^9}, {3.913654609923876*^9, 
   3.91365461103159*^9}, {3.913654665365252*^9, 3.913654684329713*^9}, {
   3.913657178598042*^9, 3.9136571883385334`*^9}, {3.913657435816974*^9, 
   3.913657451606913*^9}, {3.913657610898428*^9, 3.913657704766993*^9}, {
   3.913657835606594*^9, 3.913657856974626*^9}, {3.9136579056403913`*^9, 
   3.913657926622077*^9}, {3.913658165817791*^9, 3.913658172670468*^9}, {
   3.913658279140143*^9, 3.913658280956685*^9}, {3.913658846849459*^9, 
   3.9136589208137264`*^9}, {3.913659083891081*^9, 3.9136590881522827`*^9}, {
   3.91365922631232*^9, 3.913659230725526*^9}, {3.913706207022867*^9, 
   3.9137063093496523`*^9}, {3.913706372336832*^9, 3.9137063813335066`*^9}, {
   3.9137070202945833`*^9, 3.913707082382078*^9}, {3.913707142968283*^9, 
   3.9137071556641197`*^9}, {3.913710688758175*^9, 3.913710724739009*^9}, {
   3.913887740450247*^9, 3.913887746570723*^9}, {3.914648032299428*^9, 
   3.914648205159799*^9}, {3.914648238490009*^9, 3.914648287855261*^9}, {
   3.9146492852212124`*^9, 3.914649328860623*^9}, {3.914650123957951*^9, 
   3.914650142828501*^9}, {3.91465017380006*^9, 3.914650179079395*^9}, {
   3.914652015083134*^9, 3.9146520488512306`*^9}, 3.9166496943893604`*^9, 
   3.916649737522194*^9, {3.916650086171131*^9, 3.916650092008735*^9}, 
   3.9166501421084967`*^9, {3.916650508660209*^9, 3.916650523364876*^9}, {
   3.916650591098569*^9, 3.9166505946982374`*^9}, {3.928649463640676*^9, 
   3.928649466100207*^9}},
 CellTags->"Evaluation",
 CellLabel->
  "In[984]:=",ExpressionUUID->"327c34bc-65bf-496b-b6ce-ace808862596"],

Cell[BoxData[
 FormBox[
  RowBox[{"{", 
   RowBox[{"0.089283`", ",", "2.4400921917195078`*^-8"}], "}"}], 
  TraditionalForm]], "Output",
 CellChangeTimes->{3.93021152197314*^9, 3.930822754106488*^9},
 CellTags->"Evaluation",
 CellLabel->
  "Out[985]=",ExpressionUUID->"e4ef8695-e24c-40e8-a7b3-a11e5a01ecf8"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"#", ",", 
     RowBox[{"d2Pd\[Theta]adEaFusion", "[", 
      RowBox[{
      "1.3", ",", "0.0005", ",", "#", ",", "\"\<SPS\>\"", ",", "\"\<Mo\>\""}],
       "]"}]}], "}"}], "&"}], "/@", 
  RowBox[{"Table", "[", 
   RowBox[{"x", ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", "1.31", ",", "400", ",", "5"}], "}"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"d2Pd\[Theta]adEaFusion1", "[", 
   RowBox[{
   "1.3", ",", "0.0005", ",", "45", ",", "\"\<SPS\>\"", ",", "\"\<Mo\>\""}], 
   "]"}], "//", "AbsoluteTiming"}]}], "Input",
 CellChangeTimes->{{3.928649339849527*^9, 3.928649374847888*^9}, {
  3.928649450282753*^9, 3.928649497688061*^9}, {3.928650231929888*^9, 
  3.9286502601299844`*^9}},
 CellLabel->
  "In[1111]:=",ExpressionUUID->"6bc9af04-7e00-4a29-a187-7213669d03bf"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Select", "[", 
   RowBox[{"ddd", ",", 
    RowBox[{
     RowBox[{
      RowBox[{"#", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "==", "1.3"}], "&"}]}], "]"}], "[", 
  RowBox[{"[", "1", "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"d2Pd\[Theta]adEaFusion", "[", 
  RowBox[{
  "1.3`", ",", "0.00001`", ",", "0.02`", ",", "\"\<SPS\>\"", ",", 
   "\"\<Mo\>\""}], "]"}]}], "Input",
 CellChangeTimes->{{3.9286504466578765`*^9, 3.9286504885868163`*^9}},
 CellLabel->
  "In[1113]:=",ExpressionUUID->"845047b1-c6bc-4878-bc39-d5470b5da3c2"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ddd", "=", 
   RowBox[{"Import", "[", 
    RowBox[{
     RowBox[{"FileNameJoin", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"NotebookDirectory", "[", "]"}], ",", 
        "\"\<spectra/New physics particles spectra\>\"", ",", 
        RowBox[{"LLPfolder", "[", "\"\<ALP-photon\>\"", "]"}], ",", 
        RowBox[{"ToString", "@", 
         RowBox[{"StringForm", "[", 
          RowBox[{"\"\<DoubleDistr_``_``-``_``.m\>\"", ",", 
           RowBox[{"Sequence", "@@", 
            RowBox[{"{", 
             RowBox[{
             "\"\<ALP-photon\>\"", ",", "\"\<Photon-fusion\>\"", ",", 
              "\"\<Mo\>\"", ",", "\"\<SPS\>\""}], "}"}]}]}], "]"}]}]}], "}"}],
       "]"}], ",", "\"\<MX\>\""}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Select", "[", 
   RowBox[{"ddd", ",", 
    RowBox[{
     RowBox[{
      RowBox[{"#", "[", 
       RowBox[{"[", 
        RowBox[{"-", "1"}], "]"}], "]"}], ">", 
      SuperscriptBox["10", "5"]}], "&"}]}], "]"}], "[", 
  RowBox[{"[", "1", "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.9286502832505145`*^9, 3.9286503516776853`*^9}},
 CellLabel->
  "In[1115]:=",ExpressionUUID->"736e1286-be83-486d-a71b-089ba3c3a599"],

Cell[BoxData[{
 RowBox[{"d2Pd\[Theta]adEaFusion", "[", 
  RowBox[{
  "1.3`", ",", "0.00001`", ",", "4.72`", ",", "\"\<SPS\>\"", ",", 
   "\"\<Mo\>\""}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"d2Pd\[Theta]adEaFusion1", "[", 
  RowBox[{
  "1.3`", ",", "0.00001`", ",", "4.72`", ",", "\"\<SPS\>\"", ",", 
   "\"\<Mo\>\""}], "]"}]}], "Input",
 CellChangeTimes->{
  3.928650431120146*^9, {3.928650523512783*^9, 3.9286505299699745`*^9}},
 CellLabel->
  "In[1117]:=",ExpressionUUID->"99771ca0-5cca-4c57-91f4-14b03a0063b1"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"#", ",", 
     RowBox[{"d2Pd\[Theta]adEaFusion", "[", 
      RowBox[{
      "1.3", ",", "0.00001", ",", "#", ",", "\"\<SPS\>\"", ",", 
       "\"\<Mo\>\""}], "]"}]}], "}"}], "&"}], "/@", 
  RowBox[{"Table", "[", 
   RowBox[{"x", ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", "1.31", ",", "400", ",", "5"}], "}"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.92865036718209*^9, 3.928650409114913*^9}},
 CellLabel->
  "In[1119]:=",ExpressionUUID->"d3a6f92f-307d-40ee-b3d9-d448ec857e30"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Tests  (compare with Fig. 4 from https://arxiv.org/abs/1512.03069, results \
should be larger by the factor ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       SubscriptBox["Z", "mo"], "/", 
       SubscriptBox["Z", "copper"]}], ")"}], "2"], "=", "2.1"}], 
   TraditionalForm]],ExpressionUUID->"5edf72c3-92fe-46f7-9ebc-19368e245475"],
 ")"
}], "Subsubsection",
 CellChangeTimes->{{3.8878216060483685`*^9, 3.887821634869414*^9}},
 CellTags->
  "Evaluation",ExpressionUUID->"bf14ac37-c134-491d-affc-c438fea539d6"],

Cell[CellGroupData[{

Cell["Test 1", "Item",
 CellChangeTimes->{{3.88782160985414*^9, 3.887821617848337*^9}},
 CellTags->
  "Evaluation",ExpressionUUID->"f68843f3-917e-475e-942c-cdc3a338c4d9"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"gatest", "=", 
      SuperscriptBox["10", 
       RowBox[{"-", "4"}]]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Theta]atest", "=", 
      SuperscriptBox["10", 
       RowBox[{"-", "2"}]]}], ";", "\[IndentingNewLine]", 
     RowBox[{"ZmoZcopper2", "=", "2.1"}], ";", "\[IndentingNewLine]", 
     RowBox[{"tabb", "=", 
      RowBox[{"Join", "[", 
       RowBox[{"ParallelTable", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"Ea", ",", 
           RowBox[{
            FractionBox["1", "ZmoZcopper2"], 
            RowBox[{"Quiet", "[", 
             RowBox[{
              FractionBox[
               RowBox[{"d2\[Sigma]d\[Theta]adEaFusion1", "[", 
                RowBox[{
                "0.05", ",", "\[Theta]atest", ",", "Ea", ",", "\"\<SPS\>\"", 
                 ",", "\"\<Mo\>\""}], "]"}], "\[Theta]atest"], "*", 
              SuperscriptBox["gatest", "2"]}], "]"}]}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"Ea", ",", 
           RowBox[{"Table", "[", 
            RowBox[{
             SuperscriptBox["10", "x"], ",", 
             RowBox[{"{", 
              RowBox[{"x", ",", 
               RowBox[{"Log10", "[", "0.08", "]"}], ",", "2", ",", "0.1"}], 
              "}"}]}], "]"}]}], "}"}]}], "]"}], "]"}]}], ";"}], "//", 
    RowBox[{"AbsoluteTiming", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"tabb2", "=", 
       RowBox[{"Join", "[", 
        RowBox[{"ParallelTable", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"Ea", ",", 
            RowBox[{
             FractionBox["1", "ZmoZcopper2"], 
             RowBox[{"Quiet", "[", 
              RowBox[{
               FractionBox[
                RowBox[{"d2\[Sigma]d\[Theta]adEaFusion1", "[", 
                 RowBox[{
                 "0.5", ",", "\[Theta]atest", ",", "Ea", ",", "\"\<SPS\>\"", 
                  ",", "\"\<Mo\>\""}], "]"}], "\[Theta]atest"], "*", 
               SuperscriptBox["gatest", "2"]}], "]"}]}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"Ea", ",", 
            RowBox[{"Table", "[", 
             RowBox[{
              SuperscriptBox["10", "x"], ",", 
              RowBox[{"{", 
               RowBox[{"x", ",", 
                RowBox[{"Log10", "[", "0.7", "]"}], ",", "2", ",", "0.1"}], 
               "}"}]}], "]"}]}], "}"}]}], "]"}], "]"}]}], ";"}]}]}], "//", 
   RowBox[{"AbsoluteTiming", "\[IndentingNewLine]", 
    RowBox[{"ListLogLogPlot", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"tabb", ",", "tabb2"}], "}"}], ",", 
      RowBox[{"PlotRange", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", "100"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"5", ",", "1100"}], "}"}]}], "}"}]}], ",", 
      RowBox[{"Joined", "\[Rule]", "True"}], ",", 
      RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
      RowBox[{"Frame", "\[Rule]", "True"}], ",", 
      RowBox[{"GridLines", "\[Rule]", "Automatic"}]}], "]"}]}]}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.892265011985068*^9, 3.892265022894273*^9}, {
  3.913532478520653*^9, 3.9135325211378074`*^9}, {3.913626640051108*^9, 
  3.9136267421597815`*^9}, {3.914648296073534*^9, 3.914648302650948*^9}, {
  3.914648336029183*^9, 3.914648338250651*^9}, {3.914648431437482*^9, 
  3.914648431609402*^9}, {3.91464850662225*^9, 3.914648597119946*^9}, {
  3.914648683757358*^9, 3.9146486859492025`*^9}, {3.914649255247367*^9, 
  3.914649257578535*^9}, {3.916650597617199*^9, 3.9166506085082607`*^9}, {
  3.916830794055399*^9, 3.9168307976335354`*^9}, {3.9168309461605864`*^9, 
  3.9168310121272593`*^9}},
 CellTags->"Evaluation",
 CellLabel->
  "In[986]:=",ExpressionUUID->"d10de36e-1aea-4fd7-b054-4e006d790cb3"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Test 2", "Item",
 CellChangeTimes->{{3.8878216197965736`*^9, 3.887821621078315*^9}},
 CellTags->
  "Evaluation",ExpressionUUID->"e0222495-2a30-444e-95b1-1ffda468252f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Eatest", "=", "10"}], ";", "\[IndentingNewLine]", 
      RowBox[{"gatest", "=", 
       SuperscriptBox["10", 
        RowBox[{"-", "4"}]]}], ";", "\[IndentingNewLine]", 
      RowBox[{"tabb", "=", 
       RowBox[{"Join", "[", 
        RowBox[{"ParallelTable", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            SuperscriptBox["10", "x"], ",", 
            RowBox[{
             FractionBox["1", "ZmoZcopper2"], 
             RowBox[{"Quiet", "[", 
              RowBox[{
               FractionBox[
                RowBox[{"d2\[Sigma]d\[Theta]adEaFusion1", "[", 
                 RowBox[{"0.05", ",", 
                  SuperscriptBox["10", "x"], ",", "Eatest", ",", 
                  "\"\<SPS\>\"", ",", "\"\<Mo\>\""}], "]"}], 
                RowBox[{"Sin", "[", 
                 SuperscriptBox["10", "x"], "]"}]], "*", 
               SuperscriptBox["gatest", "2"]}], "]"}]}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"x", ",", 
            RowBox[{"-", "4"}], ",", 
            RowBox[{"-", "1"}], ",", "0.2"}], "}"}]}], "]"}], "]"}]}], ";"}], 
     "//", 
     RowBox[{"AbsoluteTiming", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"tabb2", "=", 
        RowBox[{"Join", "[", 
         RowBox[{"ParallelTable", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             SuperscriptBox["10", "x"], ",", 
             RowBox[{
              FractionBox["1", "ZmoZcopper2"], 
              RowBox[{"Quiet", "[", 
               RowBox[{
                FractionBox[
                 RowBox[{"d2\[Sigma]d\[Theta]adEaFusion1", "[", 
                  RowBox[{"0.5", ",", 
                   SuperscriptBox["10", "x"], ",", "Eatest", ",", 
                   "\"\<SPS\>\"", ",", "\"\<Mo\>\""}], "]"}], 
                 RowBox[{"Sin", "[", 
                  SuperscriptBox["10", "x"], "]"}]], "*", 
                SuperscriptBox["gatest", "2"]}], "]"}]}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"x", ",", 
             RowBox[{"-", "4"}], ",", 
             RowBox[{"-", "1"}], ",", "0.2"}], "}"}]}], "]"}], "]"}]}], 
       ";"}]}]}], "//", 
    RowBox[{"AbsoluteTiming", "\[IndentingNewLine]", 
     RowBox[{"ListLogLogPlot", "[", 
      RowBox[{
       RowBox[{"Evaluate", "[", 
        RowBox[{"{", 
         RowBox[{"tabb", ",", "tabb2"}], "}"}], "]"}], ",", 
       RowBox[{"Joined", "\[Rule]", "True"}], ",", 
       RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
       RowBox[{"Frame", "\[Rule]", "True"}], ",", 
       RowBox[{"PlotRange", "->", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            SuperscriptBox["10", 
             RowBox[{"-", "4."}]], ",", "0.1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", "1000"}], "}"}]}], "}"}]}], ",", 
       RowBox[{"GridLines", "\[Rule]", "Automatic"}]}], "]"}]}]}], "*)"}], 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.892265019362926*^9, 3.892265020528227*^9}, {
  3.9135325344624205`*^9, 3.913532555686444*^9}, {3.913626746001495*^9, 
  3.913626789300541*^9}, {3.913627006249159*^9, 3.913627009864963*^9}, {
  3.914648417390436*^9, 3.9146484194668794`*^9}, {3.914648703284447*^9, 
  3.9146487523819885`*^9}, {3.9146492600279894`*^9, 3.9146492627544746`*^9}, {
  3.916830874246751*^9, 3.9168308758220196`*^9}, {3.916830921957075*^9, 
  3.916830943014066*^9}},
 CellTags->"Evaluation",
 CellLabel->
  "In[987]:=",ExpressionUUID->"1aa3601e-3cf5-4a65-ab2b-e8461899e49e"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Differential cross-section - colliders", "Subsection",
 CellChangeTimes->{{3.887821797818385*^9, 3.887821799899389*^9}, {
  3.913479657744767*^9, 3.9134796613959727`*^9}},
 CellTags->
  "Evaluation",ExpressionUUID->"82f5b9ee-eff5-4f8a-90eb-19c98e947bd1"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Solutions", " ", "for", " ", "energy", " ", "fractions", " ", 
     SubscriptBox["x", "1"]}], ",", 
    RowBox[{
     SubscriptBox["x", "2"], " ", "carried", " ", "by", " ", "photons", " ", 
     "from", " ", "protons", " ", "in", " ", "terms", " ", "of", " ", "the", 
     " ", "ALP", " ", "mass", " ", "and", " ", "its", " ", "transverse", " ", 
     "momentum"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"max1x2Colliders", "[", 
      RowBox[{"x1_", ",", "x2_", ",", "EpCM_"}], "]"}], "=", 
     RowBox[{"2", " ", 
      RowBox[{"Sqrt", "[", 
       RowBox[{"x1", "*", "x2"}], "]"}], "*", "EpCM"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"kzx1x2Colliders", "[", 
      RowBox[{"x1_", ",", "x2_", ",", "EpCM_"}], "]"}], "=", 
     RowBox[{"EpCM", "*", 
      RowBox[{"(", 
       RowBox[{"x1", "-", "x2"}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"solsColliders", "[", 
      RowBox[{"kzCM_", ",", "ma_", ",", "EpCM_"}], "]"}], "=", 
     RowBox[{
      RowBox[{"Assuming", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"ma", ">", "0"}], "&&", 
         RowBox[{"kZ", ">", "0"}], "&&", 
         RowBox[{"EpCM", ">", "0"}], "&&", 
         RowBox[{"kzCM", ">", "0"}]}], ",", 
        RowBox[{"Simplify", "[", 
         RowBox[{"Solve", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"max1x2Colliders", "[", 
               RowBox[{"x1", ",", "x2", ",", "EpCM"}], "]"}], "\[Equal]", 
              "ma"}], "&&", 
             RowBox[{
              RowBox[{"kzx1x2Colliders", "[", 
               RowBox[{"x1", ",", "x2", ",", "EpCM"}], "]"}], "\[Equal]", 
              "kzCM"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"x1", ",", "x2"}], "}"}]}], "]"}], "]"}]}], "]"}], "[", 
      RowBox[{"[", "2", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"xp1kzColliders", "[", 
        RowBox[{"kzCM_", ",", "ma_", ",", "EpCM_"}], "]"}], ",", 
       RowBox[{"xp2kzColliders", "[", 
        RowBox[{"kzCM_", ",", "ma_", ",", "EpCM_"}], "]"}]}], "}"}], "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"x1", "/.", 
        RowBox[{"solsColliders", "[", 
         RowBox[{"kzCM", ",", "ma", ",", "EpCM"}], "]"}]}], ",", 
       RowBox[{"x2", "/.", 
        RowBox[{"solsColliders", "[", 
         RowBox[{"kzCM", ",", "ma", ",", "EpCM"}], "]"}]}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Diff", ".", " ", "cross"}], "-", 
     RowBox[{
     "section", " ", "of", " ", "the", " ", "ALP", " ", "production", " ", 
      "in", " ", "terms", " ", "of", " ", 
      SubscriptBox["k", "T"], " ", "and", " ", 
      SubscriptBox["k", "z"], " ", "of", " ", "the", " ", "ALP"}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"IntegrandFusionCollidersTemp", "[", 
      RowBox[{
      "ma_", ",", "kzCM_", ",", "kT_", ",", "pT1_", ",", "pT2_", ",", 
       "EpCM_"}], "]"}], "=", 
     RowBox[{
      RowBox[{"2", "*", "kT", "*", "2", "*", "pT1", "*", "2", "*", "pT2", "*", 
       FractionBox[
        SuperscriptBox["ma", "2"], 
        RowBox[{"32", "*", "EpCM", "*", "EpCM", 
         SqrtBox[
          RowBox[{
           SuperscriptBox["kzCM", "2"], "+", 
           SuperscriptBox["ma", "2"]}]]}]], 
       FractionBox[
        RowBox[{
         RowBox[{"fEPAp", "[", 
          RowBox[{"pT1", ",", 
           RowBox[{"xp1kzColliders", "[", 
            RowBox[{"kzCM", ",", "ma", ",", "EpCM"}], "]"}], ",", 
           "\[Alpha]EMval"}], "]"}], "*", 
         RowBox[{"fEPAp", "[", 
          RowBox[{"pT2", ",", 
           RowBox[{"xp2kzColliders", "[", 
            RowBox[{"kzCM", ",", "ma", ",", "EpCM"}], "]"}], ",", 
           "\[Alpha]EMval"}], "]"}]}], 
        SqrtBox[
         RowBox[{
          RowBox[{"2", "*", 
           SuperscriptBox["kT", "2"], 
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["pT1", "2"], "+", 
             SuperscriptBox["pT2", "2"]}], ")"}]}], "-", 
          SuperscriptBox["kT", "4"], "-", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["pT1", "2"], "-", 
             SuperscriptBox["pT2", "2"]}], ")"}], "2"]}]]]}], "//", 
      "Simplify"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"kTto\[Theta]aCMEaCM", "[", 
      RowBox[{"ma_", ",", "\[Theta]a_", ",", "Ea_"}], "]"}], "=", 
     RowBox[{
      SqrtBox[
       RowBox[{
        SuperscriptBox["Ea", "2"], "-", 
        SuperscriptBox["ma", "2"]}]], 
      RowBox[{"Sin", "[", "\[Theta]a", "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"kzCMto\[Theta]aCMEaCM", "[", 
      RowBox[{"ma_", ",", "\[Theta]a_", ",", "Ea_"}], "]"}], "=", 
     RowBox[{
      SqrtBox[
       RowBox[{
        SuperscriptBox["Ea", "2"], "-", 
        SuperscriptBox["ma", "2"]}]], 
      RowBox[{"Cos", "[", "\[Theta]a", "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"JacobiankTkzCMto\[Theta]aCMEaCM", "[", 
      RowBox[{"ma_", ",", "\[Theta]a_", ",", "Ea_"}], "]"}], "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"kTto\[Theta]aCMEaCM", "[", 
           RowBox[{"ma", ",", "\[Theta]a", ",", "Ea"}], "]"}], ",", 
          "\[Theta]a"}], "]"}], "*", 
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"kzCMto\[Theta]aCMEaCM", "[", 
           RowBox[{"ma", ",", "\[Theta]a", ",", "Ea"}], "]"}], ",", "Ea"}], 
         "]"}]}], "-", 
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"kTto\[Theta]aCMEaCM", "[", 
           RowBox[{"ma", ",", "\[Theta]a", ",", "Ea"}], "]"}], ",", "Ea"}], 
         "]"}], "*", 
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"kzCMto\[Theta]aCMEaCM", "[", 
           RowBox[{"ma", ",", "\[Theta]a", ",", "Ea"}], "]"}], ",", 
          "\[Theta]a"}], "]"}]}]}], "//", "Simplify"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Diff", ".", " ", "cross"}], "-", 
     RowBox[{
     "section", " ", "of", " ", "the", " ", "ALP", " ", "production", " ", 
      "in", " ", "terms", " ", "of", " ", 
      SubscriptBox["\[Theta]", "a"], " ", "and", " ", 
      SubscriptBox["E", "a"], " ", "of", " ", "the", " ", "ALP"}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"IntegrandFusionColliders", "[", 
      RowBox[{
      "ma_", ",", "\[Theta]a_", ",", "Ea_", ",", "pT1_", ",", "pT2_", ",", 
       "EpCM_"}], "]"}], "=", 
     RowBox[{
      RowBox[{"JacobiankTkzCMto\[Theta]aCMEaCM", "[", 
       RowBox[{"ma", ",", "\[Theta]a", ",", "Ea"}], "]"}], "*", 
      RowBox[{"IntegrandFusionCollidersTemp", "[", 
       RowBox[{"ma", ",", 
        RowBox[{"kzCMto\[Theta]aCMEaCM", "[", 
         RowBox[{"ma", ",", "\[Theta]a", ",", "Ea"}], "]"}], ",", 
        RowBox[{"kTto\[Theta]aCMEaCM", "[", 
         RowBox[{"ma", ",", "\[Theta]a", ",", "Ea"}], "]"}], ",", "pT1", ",", 
        "pT2", ",", "EpCM"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"xp1\[Theta]aEaColliders", "[", 
      RowBox[{"ma_", ",", "\[Theta]a_", ",", "Ea_", ",", "EpCM_"}], "]"}], 
     "=", 
     RowBox[{"xp1kzColliders", "[", 
      RowBox[{
       RowBox[{"kzCMto\[Theta]aCMEaCM", "[", 
        RowBox[{"ma", ",", "\[Theta]a", ",", "Ea"}], "]"}], ",", "ma", ",", 
       "EpCM"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"xp2\[Theta]aEaColliders", "[", 
      RowBox[{"ma_", ",", "\[Theta]a_", ",", "Ea_", ",", "EpCM_"}], "]"}], 
     "=", 
     RowBox[{"xp2kzColliders", "[", 
      RowBox[{
       RowBox[{"kzCMto\[Theta]aCMEaCM", "[", 
        RowBox[{"ma", ",", "\[Theta]a", ",", "Ea"}], "]"}], ",", "ma", ",", 
       "EpCM"}], "]"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.887821811339939*^9, 3.887821844659382*^9}, {
  3.8878218786382866`*^9, 3.887821879709427*^9}, {3.887821955514191*^9, 
  3.887821963532744*^9}, {3.887822039940846*^9, 3.887822199349122*^9}, {
  3.8878224883693647`*^9, 3.887822490149894*^9}, {3.887822574208996*^9, 
  3.887822864978417*^9}, {3.887823229429274*^9, 3.887823267757331*^9}, {
  3.89222260444915*^9, 3.8922226170204144`*^9}, {3.89227274857492*^9, 
  3.89227274857492*^9}, {3.89227376505128*^9, 3.892273765066942*^9}, {
  3.913532366587214*^9, 3.9135324143353477`*^9}, {3.9135327226038046`*^9, 
  3.913533066200532*^9}, {3.913533147458164*^9, 3.913533148616649*^9}, {
  3.913533558242602*^9, 3.913533612978258*^9}, {3.913533684276423*^9, 
  3.913533684917178*^9}, {3.913533974155208*^9, 3.9135339743861647`*^9}},
 CellTags->"Evaluation",
 CellLabel->
  "In[988]:=",ExpressionUUID->"4ddf9aea-d127-4514-9c49-953ffbcc3e21"],

Cell[BoxData[
 FormBox[
  TemplateBox[{
   "Solve", "nongen", 
    "\"There may be values of the parameters for which some or all solutions \
are not valid.\"", 2, 990, 24, 29079336519732941073, "Local"},
   "MessageTemplate"], TraditionalForm]], "Message", "MSG",
 CellChangeTimes->{3.930211522102115*^9, 3.930822754198783*^9},
 CellTags->"Evaluation",
 CellLabel->
  "Durante la evaluaci\[OAcute]n de \
In[988]:=",ExpressionUUID->"6e10fa7e-339d-4d3b-b413-2ed070682892"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Explicit form (with all parameters inserted)", "Subsubsection",
 CellChangeTimes->{{3.913480267109129*^9, 3.9134802736387873`*^9}},
 CellTags->
  "Evaluation",ExpressionUUID->"fcfc4fa2-fd1d-4eed-8d52-0dd17a028b08"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Do", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "Facility", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Facility", "=", "facility"}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Epsilon]Regularization", "=", 
       RowBox[{"(*", 
        SuperscriptBox["10", 
         RowBox[{"-", "10."}]], "*)"}], "0."}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"IntegrandFusionTemp1", "[", 
        RowBox[{
        "ma_", ",", "\[Theta]a_", ",", "Ea_", ",", "pT1_", ",", "pT2_", ",", 
         "Facility", ",", "\"\<p\>\""}], "]"}], "=", 
       RowBox[{"IntegrandFusionColliders", "[", 
        RowBox[{
        "ma", ",", "\[Theta]a", ",", "Ea", ",", "pT1", ",", "pT2", ",", 
         RowBox[{"EmaxFacility", "[", "Facility", "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"IntegrandFusionTemp2", "[", 
        RowBox[{
        "ma_", ",", "\[Theta]a_", ",", "Ea_", ",", "pT1_", ",", "pT2_", ",", 
         "Facility", ",", "\"\<p\>\""}], "]"}], "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Abs", "[", 
            RowBox[{"pT1", "-", "pT2"}], "]"}], 
           RowBox[{"(", 
            RowBox[{"1", "+", "\[Epsilon]Regularization"}], ")"}]}], "<", 
          RowBox[{"kTto\[Theta]aCMEaCM", "[", 
           RowBox[{"ma", ",", "\[Theta]a", ",", "Ea"}], "]"}], "<", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"pT1", "+", "pT2"}], ")"}], 
           RowBox[{"(", 
            RowBox[{"1", "-", "\[Epsilon]Regularization"}], ")"}]}]}], ",", 
         RowBox[{"Evaluate", "[", 
          RowBox[{"IntegrandFusionTemp1", "[", 
           RowBox[{
           "ma", ",", "\[Theta]a", ",", "Ea", ",", "pT1", ",", "pT2", ",", 
            "Facility", ",", "\"\<p\>\""}], "]"}], "]"}], ",", 
         SuperscriptBox["10", 
          RowBox[{"-", "90."}]]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"pTp1MaxEPA", "[", 
          RowBox[{
          "ma_", ",", "\[Theta]a_", ",", "Ea_", ",", "Facility", ",", 
           "\"\<p\>\""}], "]"}], ",", 
         RowBox[{"pTp2MaxEPA", "[", 
          RowBox[{
          "ma_", ",", "\[Theta]a_", ",", "Ea_", ",", "Facility", ",", 
           "\"\<p\>\""}], "]"}]}], "}"}], "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"pTprotonMaxEPA", "[", 
          RowBox[{"xp1\[Theta]aEaColliders", "[", 
           RowBox[{"ma", ",", "\[Theta]a", ",", "Ea", ",", 
            RowBox[{"EmaxFacility", "[", "Facility", "]"}]}], "]"}], "]"}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{"pTprotonMaxEPA", "[", 
          RowBox[{"xp2\[Theta]aEaColliders", "[", 
           RowBox[{"ma", ",", "\[Theta]a", ",", "Ea", ",", 
            RowBox[{"EmaxFacility", "[", "Facility", "]"}]}], "]"}], "]"}]}], 
        "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
         RowBox[{
         "Converting", " ", "the", " ", "integrand", " ", "to", " ", "the", 
          " ", "variables", " ", "m"}], " ", "=", " ", 
         RowBox[{"(", 
          RowBox[{
           SubscriptBox["p", 
            RowBox[{"T", ",", "1"}]], "+", 
           SubscriptBox["p", 
            RowBox[{"T", ",", "2"}]]}], ")"}]}], ",", 
        RowBox[{"t", "=", 
         RowBox[{"(", 
          RowBox[{
           SubscriptBox["p", 
            RowBox[{"T", ",", "1"}]], "-", 
           SubscriptBox["p", 
            RowBox[{"T", ",", "2"}]]}], ")"}]}]}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"tmax", "[", 
        RowBox[{
        "ma_", ",", "\[Theta]a_", ",", "Ea_", ",", "Facility", ",", 
         "\"\<p\>\""}], "]"}], "=", 
       RowBox[{"Min", "[", 
        RowBox[{
         RowBox[{"kTto\[Theta]a", "[", 
          RowBox[{"ma", ",", "\[Theta]a", ",", "Ea"}], "]"}], ",", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"pTp1MaxEPA", "[", 
            RowBox[{
            "ma", ",", "\[Theta]a", ",", "Ea", ",", "Facility", ",", 
             "\"\<p\>\""}], "]"}], "-", "0."}], ")"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"tmin", "[", 
        RowBox[{
        "ma_", ",", "\[Theta]a_", ",", "Ea_", ",", "Facility", ",", 
         "\"\<p\>\""}], "]"}], "=", 
       RowBox[{"-", 
        RowBox[{"Min", "[", 
         RowBox[{
          RowBox[{"pTp2MaxEPA", "[", 
           RowBox[{
           "ma", ",", "\[Theta]a", ",", "Ea", ",", "Facility", ",", 
            "\"\<p\>\""}], "]"}], ",", 
          RowBox[{"kTto\[Theta]a", "[", 
           RowBox[{"ma", ",", "\[Theta]a", ",", "Ea"}], "]"}]}], "]"}]}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"mmax", "[", 
        RowBox[{
        "ma_", ",", "\[Theta]a_", ",", "Ea_", ",", "Facility", ",", 
         "\"\<p\>\""}], "]"}], "=", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"pTp1MaxEPA", "[", 
          RowBox[{
          "ma", ",", "\[Theta]a", ",", "Ea", ",", "Facility", ",", 
           "\"\<p\>\""}], "]"}], "+", 
         RowBox[{"pTp2MaxEPA", "[", 
          RowBox[{
          "ma", ",", "\[Theta]a", ",", "Ea", ",", "Facility", ",", 
           "\"\<p\>\""}], "]"}]}], ")"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"mmin", "[", 
        RowBox[{
        "ma_", ",", "\[Theta]a_", ",", "Ea_", ",", "Facility", ",", 
         "\"\<p\>\""}], "]"}], "=", 
       RowBox[{"kTto\[Theta]a", "[", 
        RowBox[{"ma", ",", "\[Theta]a", ",", "Ea"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"IntegrandFusionConverted1", "[", 
        RowBox[{
        "ma_", ",", "\[Theta]a_", ",", "Ea_", ",", "m_", ",", "t_", ",", 
         "Facility", ",", "\"\<p\>\""}], "]"}], "=", 
       RowBox[{
        FractionBox["1", "2"], 
        RowBox[{
         RowBox[{"IntegrandFusionTemp2", "[", 
          RowBox[{"ma", ",", "\[Theta]a", ",", "Ea", ",", 
           FractionBox[
            RowBox[{"m", "+", "t"}], "2"], ",", 
           FractionBox[
            RowBox[{"(", 
             RowBox[{"m", "-", "t"}], ")"}], "2"], ",", "Facility", ",", 
           "\"\<p\>\""}], "]"}], "[", 
         RowBox[{"[", "2", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Epsilon]v", "=", 
       SuperscriptBox["10", 
        RowBox[{"-", "9."}]]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
         RowBox[{"d2\[Sigma]d\[Theta]adEaFusionSlow", "[", 
          RowBox[{
          "ma_", ",", "\[Theta]a_", ",", "Ea_", ",", "Facility", ",", 
           "\"\<p\>\""}], "]"}], ":=", 
         RowBox[{"With", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"MMIN", "=", 
              RowBox[{"mmin", "[", 
               RowBox[{
               "ma", ",", "\[Theta]a", ",", "Ea", ",", "Facility", ",", 
                "\"\<p\>\""}], "]"}]}], ",", 
             RowBox[{"MMAX", "=", 
              RowBox[{"mmax", "[", 
               RowBox[{
               "ma", ",", "\[Theta]a", ",", "Ea", ",", "Facility", ",", 
                "\"\<p\>\""}], "]"}]}], ",", 
             RowBox[{"x2", "=", 
              RowBox[{"xp2\[Theta]aEaColliders", "[", 
               RowBox[{"ma", ",", "\[Theta]a", ",", "Ea", ",", 
                RowBox[{"EmaxFacility", "[", "Facility", "]"}]}], "]"}]}]}], 
            "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Module", "[", 
             RowBox[{
              RowBox[{"{", "\[Epsilon]", "}"}], ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"\[Epsilon]", "=", 
                RowBox[{"(*", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"x2", "<", 
                    SuperscriptBox["10", 
                    RowBox[{"-", "10"}]]}], ",", 
                   SuperscriptBox["10", 
                    RowBox[{"-", "7."}]], ",", 
                   SuperscriptBox["10", 
                    RowBox[{"-", "7."}]]}], "]"}], "*)"}], 
                SuperscriptBox["10", 
                 RowBox[{"-", "7."}]]}], ";", 
               RowBox[{"GeVm2Topb", "*", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"ma", "<", "Ea"}], "&&", 
                   RowBox[{
                    RowBox[{"xp1\[Theta]aEaColliders", "[", 
                    RowBox[{"ma", ",", "\[Theta]a", ",", "Ea", ",", 
                    RowBox[{"EmaxFacility", "[", "Facility", "]"}]}], "]"}], 
                    "<", 
                    RowBox[{"xminmaxEPA", "[", 
                    RowBox[{
                    RowBox[{"mSM", "[", "\"\<p\>\"", "]"}], ",", "q2pMax"}], 
                    "]"}]}], "&&", 
                   RowBox[{"x2", "<", 
                    RowBox[{"xminmaxEPA", "[", 
                    RowBox[{
                    RowBox[{"mSM", "[", "\"\<p\>\"", "]"}], ",", "q2pMax"}], 
                    "]"}]}], "&&", 
                   RowBox[{"MMIN", "<", "MMAX"}]}], ",", 
                  RowBox[{"NIntegrate", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"IntegrandFusionConverted1", "[", 
                    RowBox[{"ma", ",", "\[Theta]a", ",", "Ea", ",", 
                    RowBox[{"Exp", "[", "m", "]"}], ",", "t", ",", "Facility",
                     ",", "\"\<p\>\""}], "]"}], 
                    RowBox[{"Exp", "[", "m", "]"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"m", ",", 
                    RowBox[{"Log", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "+", "\[Epsilon]"}], ")"}], "MMIN"}], "]"}], 
                    ",", 
                    RowBox[{"Log", "[", "MMAX", "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"t", ",", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "\[Epsilon]"}], ")"}], 
                    RowBox[{"tmin", "[", 
                    RowBox[{
                    "ma", ",", "\[Theta]a", ",", "Ea", ",", "Facility", ",", 
                    "\"\<p\>\""}], "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "\[Epsilon]"}], ")"}], 
                    RowBox[{"tmax", "[", 
                    RowBox[{
                    "ma", ",", "\[Theta]a", ",", "Ea", ",", "Facility", ",", 
                    "\"\<p\>\""}], "]"}]}]}], "}"}], ",", 
                    RowBox[{"Method", "->", "Automatic"}]}], "]"}], ",", 
                  "0."}], "]"}]}]}]}], "]"}], "//", "Re"}]}], 
          "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"d2\[Sigma]d\[Theta]adEaFusionFast", "[", 
          RowBox[{
          "ma_", ",", "\[Theta]a_", ",", "Ea_", ",", "Facility", ",", 
           "\"\<p\>\""}], "]"}], ":=", 
         RowBox[{
          RowBox[{"With", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"MMIN", "=", 
               RowBox[{"mmin", "[", 
                RowBox[{
                "ma", ",", "\[Theta]a", ",", "Ea", ",", "Facility", ",", 
                 "\"\<p\>\""}], "]"}]}], ",", 
              RowBox[{"MMAX", "=", 
               RowBox[{"mmax", "[", 
                RowBox[{
                "ma", ",", "\[Theta]a", ",", "Ea", ",", "Facility", ",", 
                 "\"\<p\>\""}], "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
            
            RowBox[{"GeVm2Topb", "*", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"ma", "<", "Ea"}], "&&", 
                RowBox[{
                 RowBox[{"xp1\[Theta]aEaColliders", "[", 
                  RowBox[{"ma", ",", "\[Theta]a", ",", "Ea", ",", 
                   RowBox[{"EmaxFacility", "[", "Facility", "]"}]}], "]"}], 
                 "<", 
                 RowBox[{"xminmaxEPA", "[", 
                  RowBox[{
                   RowBox[{"mSM", "[", "\"\<p\>\"", "]"}], ",", "q2pMax"}], 
                  "]"}]}], "&&", 
                RowBox[{
                 RowBox[{"xp2\[Theta]aEaColliders", "[", 
                  RowBox[{"ma", ",", "\[Theta]a", ",", "Ea", ",", 
                   RowBox[{"EmaxFacility", "[", "Facility", "]"}]}], "]"}], 
                 "<", 
                 RowBox[{"xminmaxEPA", "[", 
                  RowBox[{
                   RowBox[{"mSM", "[", "\"\<p\>\"", "]"}], ",", "q2pMax"}], 
                  "]"}]}], "&&", 
                RowBox[{"MMIN", "<", "MMAX"}]}], ",", 
               RowBox[{"NIntegrate", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"IntegrandFusionConverted1", "[", 
                   RowBox[{"ma", ",", "\[Theta]a", ",", "Ea", ",", 
                    RowBox[{"Exp", "[", "m", "]"}], ",", "t", ",", "Facility",
                     ",", "\"\<p\>\""}], "]"}], 
                  RowBox[{"Exp", "[", "m", "]"}]}], ",", 
                 RowBox[{"{", 
                  RowBox[{"m", ",", 
                   RowBox[{"Log", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "+", "\[Epsilon]v"}], ")"}], "MMIN"}], "]"}],
                    ",", 
                   RowBox[{"Log", "[", "MMAX", "]"}]}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"t", ",", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "\[Epsilon]v"}], ")"}], 
                    RowBox[{"tmin", "[", 
                    RowBox[{
                    "ma", ",", "\[Theta]a", ",", "Ea", ",", "Facility", ",", 
                    "\"\<p\>\""}], "]"}]}], ",", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "\[Epsilon]v"}], ")"}], 
                    RowBox[{"tmax", "[", 
                    RowBox[{
                    "ma", ",", "\[Theta]a", ",", "Ea", ",", "Facility", ",", 
                    "\"\<p\>\""}], "]"}]}]}], "}"}], ",", 
                 RowBox[{"Method", "->", "\"\<AdaptiveMonteCarlo\>\""}]}], 
                "]"}], ",", "0."}], "]"}]}]}], "]"}], "//", "Re"}]}], ";"}], 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"d2\[Sigma]d\[Theta]adEaFusion", "[", 
        RowBox[{
        "ma_", ",", "\[Theta]a_", ",", "Ea_", ",", "Facility", ",", 
         "\"\<p\>\""}], "]"}], ":=", 
       RowBox[{
        RowBox[{"With", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"MMIN", "=", 
             RowBox[{"mmin", "[", 
              RowBox[{
              "ma", ",", "\[Theta]a", ",", "Ea", ",", "Facility", ",", 
               "\"\<p\>\""}], "]"}]}], ",", 
            RowBox[{"MMAX", "=", 
             RowBox[{"mmax", "[", 
              RowBox[{
              "ma", ",", "\[Theta]a", ",", "Ea", ",", "Facility", ",", 
               "\"\<p\>\""}], "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{"GeVm2Topb", "*", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"ma", "<", "Ea"}], "&&", 
              RowBox[{
               RowBox[{"xp1\[Theta]aEaColliders", "[", 
                RowBox[{"ma", ",", "\[Theta]a", ",", "Ea", ",", 
                 RowBox[{"EmaxFacility", "[", "Facility", "]"}]}], "]"}], "<", 
               RowBox[{"xminmaxEPA", "[", 
                RowBox[{
                 RowBox[{"mSM", "[", "\"\<p\>\"", "]"}], ",", "q2pMax"}], 
                "]"}]}], "&&", 
              RowBox[{
               RowBox[{"xp2\[Theta]aEaColliders", "[", 
                RowBox[{"ma", ",", "\[Theta]a", ",", "Ea", ",", 
                 RowBox[{"EmaxFacility", "[", "Facility", "]"}]}], "]"}], "<", 
               RowBox[{"xminmaxEPA", "[", 
                RowBox[{
                 RowBox[{"mSM", "[", "\"\<p\>\"", "]"}], ",", "q2pMax"}], 
                "]"}]}], "&&", 
              RowBox[{"MMIN", "<", "MMAX"}]}], ",", 
             RowBox[{"NIntegrate", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"IntegrandFusionConverted1", "[", 
                 RowBox[{"ma", ",", "\[Theta]a", ",", "Ea", ",", 
                  RowBox[{"Exp", "[", "m", "]"}], ",", "t", ",", "Facility", 
                  ",", "\"\<p\>\""}], "]"}], 
                RowBox[{"Exp", "[", "m", "]"}]}], ",", 
               RowBox[{"{", 
                RowBox[{"m", ",", 
                 RowBox[{"Log", "[", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"1", "+", "\[Epsilon]v"}], ")"}], "MMIN"}], "]"}],
                  ",", 
                 RowBox[{"Log", "[", "MMAX", "]"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"t", ",", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"1", "-", "\[Epsilon]v"}], ")"}], 
                  RowBox[{"tmin", "[", 
                   RowBox[{
                   "ma", ",", "\[Theta]a", ",", "Ea", ",", "Facility", ",", 
                    "\"\<p\>\""}], "]"}]}], ",", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"1", "-", "\[Epsilon]v"}], ")"}], 
                  RowBox[{"tmax", "[", 
                   RowBox[{
                   "ma", ",", "\[Theta]a", ",", "Ea", ",", "Facility", ",", 
                    "\"\<p\>\""}], "]"}]}]}], "}"}], ",", 
               RowBox[{"Method", "->", "\"\<DoubleExponential\>\""}]}], "]"}],
              ",", "0."}], "]"}]}]}], "]"}], "//", "Re"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"d2Pd\[Theta]adEaFusion", "[", 
        RowBox[{
        "ma_", ",", "\[Theta]a_", ",", "Ea_", ",", "Facility", ",", 
         "\"\<p\>\""}], "]"}], ":=", 
       RowBox[{
        FractionBox["1", 
         RowBox[{"\[Sigma]pp", "[", "Facility", "]"}]], 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"Ea", ">", "ma"}], ",", 
          RowBox[{"d2\[Sigma]d\[Theta]adEaFusion", "[", 
           RowBox[{
           "ma", ",", "\[Theta]a", ",", "Ea", ",", "Facility", ",", 
            "\"\<p\>\""}], "]"}], ",", "0."}], "]"}]}]}], ";"}]}], 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{
       RowBox[{"d2Pd\[Theta]adEaFusionFast", "[", 
        RowBox[{
        "ma_", ",", "\[Theta]a_", ",", "Ea_", ",", "Facility", ",", 
         "\"\<p\>\""}], "]"}], ":=", 
       RowBox[{
        FractionBox["1", 
         RowBox[{"\[Sigma]pp", "[", "Facility", "]"}]], 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"Ea", ">", "ma"}], ",", 
          RowBox[{"d2\[Sigma]d\[Theta]adEaFusionFast", "[", 
           RowBox[{
           "ma", ",", "\[Theta]a", ",", "Ea", ",", "Facility", ",", 
            "\"\<p\>\""}], "]"}], ",", "0."}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"d2Pd\[Theta]adEaFusionSlow", "[", 
        RowBox[{
        "ma_", ",", "\[Theta]a_", ",", "Ea_", ",", "Facility", ",", 
         "\"\<p\>\""}], "]"}], ":=", 
       RowBox[{
        FractionBox["1", 
         RowBox[{"\[Sigma]pp", "[", "Facility", "]"}]], 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"Ea", ">", "ma"}], ",", 
          RowBox[{"d2\[Sigma]d\[Theta]adEaFusionSlow", "[", 
           RowBox[{
           "ma", ",", "\[Theta]a", ",", "Ea", ",", "Facility", ",", 
            "\"\<p\>\""}], "]"}], ",", "0."}], "]"}]}]}], ";"}], "*)"}], 
    "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", ",", 
   RowBox[{"{", 
    RowBox[{"facility", ",", 
     RowBox[{"{", 
      RowBox[{"\"\<LHC\>\"", ",", "\"\<FCC-hh\>\""}], "}"}]}], "}"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mf", "=", "0.3"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"thf", "=", 
   SuperscriptBox["10", 
    RowBox[{"-", "3."}]]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Ef", "=", "500"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"xp2\[Theta]aEaColliders", "[", 
  RowBox[{"mf", ",", "thf", ",", "Ef", ",", 
   RowBox[{"EmaxFacility", "[", "\"\<LHC\>\"", "]"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"d2Pd\[Theta]adEaFusion", "[", 
    RowBox[{
    "mf", ",", "thf", ",", "Ef", ",", "\"\<LHC\>\"", ",", "\"\<p\>\""}], 
    "]"}], "//", "AbsoluteTiming"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"d2Pd\[Theta]adEaFusionSlow", "[", 
      RowBox[{
      "mf", ",", "thf", ",", "Ef", ",", "\"\<LHC\>\"", ",", "\"\<p\>\""}], 
      "]"}], "//", 
     RowBox[{"AbsoluteTiming", "\[IndentingNewLine]", 
      RowBox[{"d2Pd\[Theta]adEaFusionFast", "[", 
       RowBox[{
       "mf", ",", "thf", ",", "Ef", ",", "\"\<LHC\>\"", ",", "\"\<p\>\""}], 
       "]"}]}]}], "//", "AbsoluteTiming"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"nsim", "=", "100"}], ";", "\[IndentingNewLine]", 
       RowBox[{"thvals", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"10", "^", 
           RowBox[{"RandomReal", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "5"}], ",", 
               RowBox[{"Log10", "[", 
                FractionBox["Pi", "2"], "]"}]}], "}"}], ",", "nsim"}], 
            "]"}]}], "//", 
          RowBox[{"N", "\[IndentingNewLine]", "fac"}]}], "=", 
         "\"\<LHC\>\""}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"mf", "=", "0.02"}], ";", "\[IndentingNewLine]", 
       RowBox[{"evals", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"10", "^", 
           RowBox[{"RandomReal", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Log10", "[", "mf", "]"}], ",", 
               RowBox[{"Log10", "[", 
                RowBox[{"EmaxFacility", "[", "fac", "]"}], "]"}]}], "}"}], 
             ",", "nsim"}], "]"}]}], "//", 
          RowBox[{"N", "\[IndentingNewLine]", "tabb"}]}], "=", 
         RowBox[{"Select", "[", 
          RowBox[{
           RowBox[{"ParallelTable", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"thvals", "[", 
                RowBox[{"[", "i", "]"}], "]"}], ",", 
               RowBox[{"evals", "[", 
                RowBox[{"[", "i", "]"}], "]"}], ",", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"evals", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], ">", "mf"}], ",", 
                 RowBox[{"xp1\[Theta]aEaColliders", "[", 
                  RowBox[{"mf", ",", 
                   RowBox[{"thvals", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", 
                   RowBox[{"evals", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", 
                   RowBox[{"EmaxFacility", "[", "fac", "]"}]}], "]"}], ",", 
                 "0."}], "]"}], ",", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"evals", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], ">", "mf"}], ",", 
                 RowBox[{"xp2\[Theta]aEaColliders", "[", 
                  RowBox[{"mf", ",", 
                   RowBox[{"thvals", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", 
                   RowBox[{"evals", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", 
                   RowBox[{"EmaxFacility", "[", "fac", "]"}]}], "]"}], ",", 
                 "0."}], "]"}], ",", 
               RowBox[{
                RowBox[{"Quiet", "[", 
                 RowBox[{"d2Pd\[Theta]adEaFusion", "[", 
                  RowBox[{"mf", ",", 
                   RowBox[{"thvals", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", 
                   RowBox[{"evals", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", "fac", ",", 
                   "\"\<p\>\""}], "]"}], "]"}], "//", "AbsoluteTiming"}], ",", 
               RowBox[{
                RowBox[{
                 RowBox[{"Table", "[", 
                  RowBox[{
                   RowBox[{"Quiet", "[", 
                    RowBox[{"d2Pd\[Theta]adEaFusionFast", "[", 
                    RowBox[{"mf", ",", 
                    RowBox[{"thvals", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", 
                    RowBox[{"evals", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", "fac", ",", 
                    "\"\<p\>\""}], "]"}], "]"}], ",", "3"}], "]"}], "//", 
                 "Mean"}], "//", "AbsoluteTiming"}], ",", 
               RowBox[{
                RowBox[{"Quiet", "[", 
                 RowBox[{"d2Pd\[Theta]adEaFusionSlow", "[", 
                  RowBox[{"mf", ",", 
                   RowBox[{"thvals", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", 
                   RowBox[{"evals", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", "fac", ",", 
                   "\"\<p\>\""}], "]"}], "]"}], "//", "AbsoluteTiming"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"mmin", "[", 
                  RowBox[{"mf", ",", 
                   RowBox[{"thvals", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", 
                   RowBox[{"evals", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", "fac", ",", 
                   "\"\<p\>\""}], "]"}], ",", 
                 RowBox[{"mmax", "[", 
                  RowBox[{"mf", ",", 
                   RowBox[{"thvals", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", 
                   RowBox[{"evals", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", "fac", ",", 
                   "\"\<p\>\""}], "]"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"tmin", "[", 
                  RowBox[{"mf", ",", 
                   RowBox[{"thvals", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", 
                   RowBox[{"evals", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", "fac", ",", 
                   "\"\<p\>\""}], "]"}], ",", 
                 RowBox[{"tmax", "[", 
                  RowBox[{"mf", ",", 
                   RowBox[{"thvals", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", 
                   RowBox[{"evals", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", "fac", ",", 
                   "\"\<p\>\""}], "]"}]}], "}"}], ",", 
               RowBox[{"kTto\[Theta]aCMEaCM", "[", 
                RowBox[{"mf", ",", 
                 RowBox[{"thvals", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], ",", 
                 RowBox[{"evals", "[", 
                  RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", "nsim", ",", "1"}], "}"}]}], "]"}], 
           ",", 
           RowBox[{
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", 
               RowBox[{"5", ",", "2"}], "]"}], "]"}], "!=", "0."}], "&"}]}], 
          "]"}]}]}], ";"}], "//", 
      RowBox[{"AbsoluteTiming", "\[IndentingNewLine]", "tttt1"}]}], "=", 
     RowBox[{"Take", "[", 
      RowBox[{
       RowBox[{"SortBy", "[", 
        RowBox[{"tabb", ",", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"#", "[", 
            RowBox[{"[", 
             RowBox[{"5", ",", "1"}], "]"}], "]"}]}], "&"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", 
         RowBox[{"Min", "[", 
          RowBox[{"50", ",", 
           RowBox[{"Length", "[", "tabb", "]"}]}], "]"}]}], "}"}]}], "]"}]}], 
    ";", "\[IndentingNewLine]", 
    RowBox[{"tttt2", "=", 
     RowBox[{"Take", "[", 
      RowBox[{
       RowBox[{"SortBy", "[", 
        RowBox[{"tabb", ",", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"Abs", "[", 
            FractionBox[
             RowBox[{
              RowBox[{"#", "[", 
               RowBox[{"[", 
                RowBox[{"5", ",", "2"}], "]"}], "]"}], "-", 
              RowBox[{"#", "[", 
               RowBox[{"[", 
                RowBox[{"7", ",", "2"}], "]"}], "]"}]}], 
             RowBox[{"#", "[", 
              RowBox[{"[", 
               RowBox[{"5", ",", "2"}], "]"}], "]"}]], "]"}]}], "&"}]}], 
        "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", 
         RowBox[{"Min", "[", 
          RowBox[{"50", ",", 
           RowBox[{"Length", "[", "tabb", "]"}]}], "]"}]}], "}"}]}], 
      "]"}]}]}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.9135331546267185`*^9, 3.9135331990696917`*^9}, {
   3.9135332382277055`*^9, 3.913533242628696*^9}, 3.913533684281912*^9, {
   3.913533725631549*^9, 3.913533727115402*^9}, {3.913533831983086*^9, 
   3.913533833094895*^9}, {3.913533881447709*^9, 3.913533900172921*^9}, {
   3.913533961669006*^9, 3.913533974161707*^9}, {3.913567651307775*^9, 
   3.9135676700712433`*^9}, 3.913568343518099*^9, {3.913568397946997*^9, 
   3.913568476404889*^9}, {3.913569756616196*^9, 3.913569810679627*^9}, {
   3.9136268310815945`*^9, 3.913626871017726*^9}, {3.913626904599171*^9, 
   3.913626927644871*^9}, {3.913627074320835*^9, 3.9136270743325615`*^9}, {
   3.913627148694927*^9, 3.913627331513077*^9}, {3.913657980508067*^9, 
   3.9136579989516873`*^9}, {3.913659109881278*^9, 3.9136591847332788`*^9}, {
   3.913698918133847*^9, 3.91369893969195*^9}, {3.9136990122384386`*^9, 
   3.913699130421724*^9}, {3.9136991966514235`*^9, 3.913699227559761*^9}, {
   3.913699380913145*^9, 3.913699433692333*^9}, {3.913699534438909*^9, 
   3.913699768381665*^9}, {3.9136999636409407`*^9, 3.913699977841719*^9}, {
   3.9137000999217277`*^9, 3.9137001445610657`*^9}, {3.913701000835127*^9, 
   3.913701036461141*^9}, {3.913701128996993*^9, 3.913701170285653*^9}, {
   3.913701247776954*^9, 3.913701258839254*^9}, {3.913701444641365*^9, 
   3.913701460761441*^9}, {3.913706394578785*^9, 3.9137065047780437`*^9}, {
   3.913706539057423*^9, 3.913706561859051*^9}, {3.913706626892897*^9, 
   3.913706636135937*^9}, {3.913706692623239*^9, 3.913706746568286*^9}, {
   3.913706883428511*^9, 3.9137069811357765`*^9}, {3.913710739935781*^9, 
   3.9137107435172415`*^9}, {3.9137133497862835`*^9, 3.913713349880442*^9}, {
   3.9137134400057983`*^9, 3.9137134475740576`*^9}, {3.913713562507284*^9, 
   3.9137135693706055`*^9}, {3.913713601794433*^9, 3.913713690270368*^9}, {
   3.913713759546733*^9, 3.913713872447173*^9}, {3.913713975456929*^9, 
   3.913713978847554*^9}, {3.913887755098401*^9, 3.913887761053695*^9}, {
   3.914582095823398*^9, 3.914582115379328*^9}, {3.9146062228711643`*^9, 
   3.914606224560523*^9}, {3.914607100567834*^9, 3.91460711306735*^9}, 
   3.914607156067551*^9, {3.9146071919776587`*^9, 3.914607197272869*^9}, {
   3.914607484229732*^9, 3.914607493366827*^9}, {3.9146075576322856`*^9, 
   3.914607595193862*^9}, {3.91464293033431*^9, 3.914642953838776*^9}, {
   3.914647143351423*^9, 3.91464714710096*^9}, {3.914647214170017*^9, 
   3.91464723587014*^9}, {3.914647268321004*^9, 3.9146473707485027`*^9}, {
   3.914647406611492*^9, 3.914647480520096*^9}, {3.914647525082757*^9, 
   3.91464752970203*^9}, {3.914648880549932*^9, 3.914648969511582*^9}},
 CellTags->"Evaluation",
 CellLabel->
  "In[999]:=",ExpressionUUID->"f2da0d26-3c00-49af-bd13-df9967726d3d"],

Cell[BoxData[
 FormBox["6.923081007069134`*^-9", TraditionalForm]], "Output",
 CellChangeTimes->{3.930211524103719*^9, 3.930822756152685*^9},
 CellTags->"Evaluation",
 CellLabel->
  "Out[1003]=",ExpressionUUID->"5b70f01b-9d42-4a19-a1ca-8c39f760dab9"],

Cell[BoxData[
 FormBox[
  TemplateBox[{
   "NIntegrate", "ncvi", 
    "\"NIntegrate failed to converge to prescribed accuracy after \
\\!\\(\\*FormBox[\\\"9\\\", TraditionalForm]\\) iterated refinements in \
\\!\\(\\*FormBox[\\\"t\\\", TraditionalForm]\\) in the region \
\\!\\(\\*FormBox[RowBox[{\\\"(\\\", \\\"\[NoBreak]\\\", \
GridBox[{{RowBox[{\\\"-\\\", \\\"0.6931475262266498`\\\"}], \
\\\"0.6719520087315761`\\\"}, {RowBox[{\\\"-\\\", \
\\\"0.49999982616667793`\\\"}], \\\"0.49999982616667793`\\\"}}, \
Rule[RowSpacings, 1], Rule[ColumnSpacings, 1], Rule[RowAlignments, Baseline], \
Rule[ColumnAlignments, Center]], \\\"\[NoBreak]\\\", \\\")\\\"}], \
TraditionalForm]\\). NIntegrate obtained \
\\!\\(\\*FormBox[RowBox[{RowBox[{\\\"0.00010711410830609846`\\\", \\\"\
\[VeryThinSpace]\\\"}], \\\"-\\\", RowBox[{\\\"7.824056399781664`*^-16\\\", \
\\\" \\\", \\\"\[ImaginaryI]\\\"}]}], TraditionalForm]\\) and \
\\!\\(\\*FormBox[\\\"0.00001609776309746661`\\\", TraditionalForm]\\) for the \
integral and error estimates.\"", 2, 1004, 25, 29079336519732941073, "Local"},
   
   "MessageTemplate"], TraditionalForm]], "Message", "MSG",
 CellChangeTimes->{3.930211524136778*^9, 3.930822756182276*^9},
 CellTags->"Evaluation",
 CellLabel->
  "Durante la evaluaci\[OAcute]n de \
In[999]:=",ExpressionUUID->"88f8481d-3d25-4c00-9152-a7f4b84a488b"],

Cell[BoxData[
 FormBox[
  RowBox[{"{", 
   RowBox[{"0.03218`", ",", "5.493031195184536`*^-7"}], "}"}], 
  TraditionalForm]], "Output",
 CellChangeTimes->{3.930211524103719*^9, 3.9308227561966*^9},
 CellTags->"Evaluation",
 CellLabel->
  "Out[1004]=",ExpressionUUID->"0ed8f885-a490-41bd-bc3c-345e9f71a996"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["ALP-fermion", "Chapter",
 CellChangeTimes->{{3.9133677446759033`*^9, 3.9133677671766*^9}, {
  3.913971522019177*^9, 3.913971524772543*^9}},
 CellTags->
  "Evaluation",ExpressionUUID->"9a636fc2-d498-4319-80ef-14ed0a162393"],

Cell[CellGroupData[{

Cell["Relevant processes", "Section",
 CellChangeTimes->{{3.913268643168833*^9, 3.9132686454263844`*^9}},
 CellTags->
  "Evaluation",ExpressionUUID->"c5166301-41a3-4dfe-a676-ad3eb38406fd"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"List", " ", "of", " ", "processes"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"LLPname", "=", "\"\<ALP-fermion\>\""}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "There", " ", "are", " ", "production", " ", "channels", " ", "via", " ",
       "mixing", " ", "with", " ", "neutral", " ", "light", " ", "mesons"}], 
     ",", " ", 
     RowBox[{"##", "-", "mixing"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ProcessesListAll", "[", "LLPname", "]"}], "=", 
     RowBox[{"{", 
      RowBox[{
      "\"\<B\>\"", ",", "\"\<Pi0\>\"", ",", "\"\<Eta\>\"", ",", 
       "\"\<EtaPr\>\""}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Topology", " ", "of", " ", "the", " ", "process"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MapThread", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"ProductionType", "[", 
          RowBox[{"LLPname", ",", "#1"}], "]"}], "=", "#2"}], ")"}], "&"}], 
      ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"ProcessesListAll", "[", "LLPname", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{
         "\"\<Decay\>\"", ",", "\"\<Mixing\>\"", ",", "\"\<Mixing\>\"", ",", 
          "\"\<Mixing\>\""}], "}"}]}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Particle", " ", 
      RowBox[{"content", ":", " ", 
       RowBox[{"mother", " ", "particle"}]}]}], ",", " ", 
     RowBox[{"decay", " ", "products"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MapThread", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"ReactionProductsList", "[", 
          RowBox[{"LLPname", ",", "#1"}], "]"}], "=", "#2"}], ")"}], "&"}], 
      ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"ProcessesListAll", "[", "LLPname", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "\"\<Bplus\>\"", ",", "\"\<PiCharged\>\"", ",", "LLPname"}], "}"}],
           ",", 
          RowBox[{"{", 
           RowBox[{"\"\<Pi0\>\"", ",", "LLPname"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"\"\<Eta\>\"", ",", "LLPname"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"\"\<EtaPr\>\"", ",", "LLPname"}], "}"}]}], "}"}]}], 
       "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"LLPname", "//", "Clear"}]}]}]], "Input",
 CellChangeTimes->{{3.9133722201995955`*^9, 3.913372221659536*^9}, 
   3.9133725866195974`*^9, {3.91337404087928*^9, 3.913374056366901*^9}, {
   3.913374193982582*^9, 3.913374201192292*^9}, 3.9133946104283466`*^9, {
   3.9133952402792835`*^9, 3.913395240285315*^9}, 3.913397474686342*^9, 
   3.914831446978381*^9, {3.915438811013764*^9, 3.915438811043748*^9}, 
   3.915440189941433*^9, {3.915440734252693*^9, 3.915440734262265*^9}, {
   3.915440787458973*^9, 3.9154407880542774`*^9}, 3.915440966101881*^9},
 CellTags->"Evaluation",
 CellLabel->
  "In[1005]:=",ExpressionUUID->"5d8a13e1-6fe7-4b7c-ac02-33c32d8f05a3"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["DP", "Chapter",
 CellChangeTimes->{{3.9133677446759033`*^9, 3.913367785341027*^9}, {
  3.913971527750192*^9, 3.9139715278242025`*^9}},
 CellTags->
  "Evaluation",ExpressionUUID->"2f10beda-a98e-47ce-9b25-6d5b2e9fb0bb"],

Cell[CellGroupData[{

Cell["Relevant processes", "Section",
 CellChangeTimes->{{3.913268643168833*^9, 3.9132686454263844`*^9}},
 CellTags->
  "Evaluation",ExpressionUUID->"3242138f-40ad-4247-a5df-a2c5fd3b5d6b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"List", " ", "of", " ", "processes"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"LLPname", "=", "\"\<DP\>\""}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Only", " ", "decays"}], ",", " ", 
     RowBox[{"mixing", " ", "with", " ", 
      SuperscriptBox["\[Rho]", "0"]}], ",", " ", 
     RowBox[{
      RowBox[{"and", " ", "proton", " ", "bremsstrahlung", " ", "are", " ", 
       RowBox[{"listed", ".", " ", "Drell"}]}], "-", 
      RowBox[{"Yan", " ", "is", " ", "computed", " ", "externally", " ", 
       RowBox[{"(", 
        RowBox[{"MadGraph", "+", "pythia"}], ")"}]}]}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ProcessesListAll", "[", "LLPname", "]"}], "=", 
     RowBox[{"{", 
      RowBox[{
      "\"\<Pi0\>\"", ",", "\"\<Eta\>\"", ",", "\"\<EtaPr\>\"", ",", 
       "\"\<Bremsstrahlung\>\"", ",", "\"\<Rho0\>\""}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Topology", " ", "of", " ", "the", " ", "process"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MapThread", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"ProductionType", "[", 
          RowBox[{"LLPname", ",", "#1"}], "]"}], "=", "#2"}], ")"}], "&"}], 
      ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"ProcessesListAll", "[", "LLPname", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{
         "\"\<Decay\>\"", ",", "\"\<Decay\>\"", ",", "\"\<Decay\>\"", ",", 
          "\"\<Scattering\>\"", ",", "\"\<Mixing\>\""}], "}"}]}], "}"}]}], 
     "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Particle", " ", 
      RowBox[{"content", ":", " ", 
       RowBox[{"mother", " ", "particle"}]}]}], ",", " ", 
     RowBox[{"decay", " ", "products"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MapThread", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"ReactionProductsList", "[", 
          RowBox[{"LLPname", ",", "#1"}], "]"}], "=", "#2"}], ")"}], "&"}], 
      ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"ProcessesListAll", "[", "LLPname", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"\"\<Pi0\>\"", ",", "\"\<photon\>\"", ",", "LLPname"}], 
           "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"\"\<Eta\>\"", ",", "\"\<photon\>\"", ",", "LLPname"}], 
           "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"\"\<EtaPr\>\"", ",", "\"\<photon\>\"", ",", "LLPname"}], 
           "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"\"\<p\>\"", ",", "LLPname"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"\"\<Rho0\>\"", ",", "LLPname"}], "}"}]}], "}"}]}], 
       "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"LLPname", "//", "Clear"}]}]}]], "Input",
 CellChangeTimes->{{3.9133722201995955`*^9, 3.913372408612541*^9}, 
   3.9133725829842834`*^9, {3.913372821963607*^9, 3.913372846306506*^9}, {
   3.913374019606778*^9, 3.913374030396451*^9}, {3.913374205059467*^9, 
   3.913374212432632*^9}, 3.913394578887174*^9, {3.913395240287383*^9, 
   3.9133952402886057`*^9}, {3.915438811050797*^9, 3.9154388110789723`*^9}, 
   3.915440189946421*^9, 3.915440734264833*^9, {3.9154407980853205`*^9, 
   3.915440806928323*^9}, 3.915440966104872*^9},
 CellTags->"Evaluation",
 CellLabel->
  "In[1010]:=",ExpressionUUID->"8d58ff6f-3146-4e5b-93dd-e4eae55647ba"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Proton bremsstrahlung probability", "Section",
 CellChangeTimes->{{3.9138073498597403`*^9, 3.9138073591296988`*^9}},
 CellTags->
  "Evaluation",ExpressionUUID->"c612d41a-c2ca-437f-aa92-cc3f13f94bcc"],

Cell[CellGroupData[{

Cell["Proton form-factor in timelike region", "Subsection",
 CellChangeTimes->{{3.886741266905027*^9, 3.886741268810368*^9}, {
   3.913457093447189*^9, 3.91345709478583*^9}, 3.913807362240102*^9},
 CellTags->
  "Evaluation",ExpressionUUID->"b35bbc0d-1a12-4b76-9979-036733dfba57"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"The", " ", "form"}], "-", 
      RowBox[{
      "factor", " ", "is", " ", "derived", " ", "assuming", " ", "the", " ", 
       "mixing", " ", "of", " ", "DPs", " ", "with", " ", "3", " ", "\[Rho]", 
       " ", "and", " ", "3", " ", "\[Omega]", " ", "resonances"}]}], ",", 
     RowBox[{
      RowBox[{
      "with", " ", "the", " ", "6", " ", "couplings", " ", "fixed", " ", 
       "from", " ", "experiment", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"lowest", " ", "\[Rho]"}], ",", 
         RowBox[{"\[Omega]", " ", "resonances"}]}], ")"}]}], " ", "+", 
      RowBox[{"boundary", " ", "conditions"}]}]}], ")"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Masses", " ", "and", " ", "other", " ", "parameters"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"f\[Omega]DP", "=", "1.011"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"f\[Rho]DP", "=", "0.616"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"M\[Omega]780", ",", "M\[Omega]1420", ",", "M\[Omega]1650"}], 
      "}"}], "=", 
     RowBox[{"{", 
      RowBox[{"0.78", ",", "1.42", ",", "1.65"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "Gamma\[Omega]780", ",", "Gamma\[Omega]1420", ",", 
       "Gamma\[Omega]1650"}], "}"}], "=", 
     RowBox[{"{", 
      RowBox[{"0.0084", ",", "0.29", ",", "0.315"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"M\[Rho]780", ",", "M\[Rho]1450", ",", "M\[Rho]1700"}], "}"}], 
     "=", 
     RowBox[{"{", 
      RowBox[{"0.77", ",", "1.45", ",", "1.7"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "Gamma\[Rho]780", ",", "Gamma\[Rho]1450", ",", "Gamma\[Rho]1700"}], 
      "}"}], "=", 
     RowBox[{"{", 
      RowBox[{"0.15", ",", "0.4", ",", "0.25"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"FormFactorBremDPTemp", "[", 
      RowBox[{"mV_", ",", "mx_", ",", "\[CapitalGamma]x_", ",", "fx_"}], 
      "]"}], "=", 
     FractionBox[
      RowBox[{"fx", "*", 
       SuperscriptBox["mx", "2"]}], 
      RowBox[{
       SuperscriptBox["mx", "2"], "-", 
       SuperscriptBox["mV", "2"], "-", 
       RowBox[{"I", "*", "\[CapitalGamma]x", "*", "mx"}]}]]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"FormFactorBremDP\[Omega]Temp", "[", "mV_", "]"}], "=", 
     RowBox[{"Chop", "[", 
      RowBox[{
       RowBox[{"FormFactorBremDPTemp", "[", 
        RowBox[{
         RowBox[{"I", "*", "mV"}], ",", "M\[Omega]780", ",", "0", ",", 
         "f\[Omega]DP"}], "]"}], "+", 
       RowBox[{"FormFactorBremDPTemp", "[", 
        RowBox[{
         RowBox[{"I", "*", "mV"}], ",", "M\[Omega]1420", ",", "0", ",", 
         "f\[Omega]Pr"}], "]"}], "+", 
       RowBox[{"FormFactorBremDPTemp", "[", 
        RowBox[{
         RowBox[{"I", "*", "mV"}], ",", "M\[Omega]1650", ",", "0", ",", 
         "f\[Omega]PrPr"}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"FormFactorBremDP\[Rho]Temp", "[", "mV_", "]"}], "=", 
     RowBox[{"Chop", "[", 
      RowBox[{
       RowBox[{"FormFactorBremDPTemp", "[", 
        RowBox[{
         RowBox[{"I", "*", "mV"}], ",", "M\[Rho]780", ",", "0", ",", 
         "f\[Rho]DP"}], "]"}], "+", 
       RowBox[{"FormFactorBremDPTemp", "[", 
        RowBox[{
         RowBox[{"I", "*", "mV"}], ",", "M\[Rho]1450", ",", "0", ",", 
         "f\[Rho]Pr"}], "]"}], "+", 
       RowBox[{"FormFactorBremDPTemp", "[", 
        RowBox[{
         RowBox[{"I", "*", "mV"}], ",", "M\[Rho]1700", ",", "0", ",", 
         "f\[Rho]PrPr"}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"sol\[Omega]", "=", 
     RowBox[{
      RowBox[{"Solve", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"FormFactorBremDP\[Omega]Temp", "[", "0", "]"}], 
           "\[Equal]", "0.5"}], "&&", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"Limit", "[", 
             RowBox[{
              RowBox[{
               SuperscriptBox["mV", "2"], 
               RowBox[{"FormFactorBremDP\[Omega]Temp", "[", "mV", "]"}]}], 
              ",", 
              RowBox[{"mV", "\[Rule]", "Infinity"}]}], "]"}], ")"}], 
           "\[Equal]", "0"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"f\[Omega]Pr", ",", "f\[Omega]PrPr"}], "}"}]}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"sol\[Rho]", "=", 
     RowBox[{
      RowBox[{"Solve", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"FormFactorBremDP\[Rho]Temp", "[", "0", "]"}], "\[Equal]", 
           "0.5"}], "&&", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"Limit", "[", 
             RowBox[{
              RowBox[{
               SuperscriptBox["mV", "2"], 
               RowBox[{"FormFactorBremDP\[Rho]Temp", "[", "mV", "]"}]}], ",", 
              
              RowBox[{"mV", "\[Rule]", "Infinity"}]}], "]"}], ")"}], 
           "\[Equal]", "0"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"f\[Rho]Pr", ",", "f\[Rho]PrPr"}], "}"}]}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"FormFactorSquaredBrem", "[", 
      RowBox[{"mV_", ",", "\"\<DP\>\""}], "]"}], "=", 
     SuperscriptBox[
      RowBox[{"Abs", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"FormFactorBremDPTemp", "[", 
           RowBox[{
           "mV", ",", "M\[Omega]780", ",", "Gamma\[Omega]780", ",", 
            "f\[Omega]DP"}], "]"}], "+", 
          RowBox[{"FormFactorBremDPTemp", "[", 
           RowBox[{
           "mV", ",", "M\[Omega]1420", ",", "Gamma\[Omega]1420", ",", 
            RowBox[{"f\[Omega]Pr", "/.", "sol\[Omega]"}]}], "]"}], "+", 
          RowBox[{"FormFactorBremDPTemp", "[", 
           RowBox[{
           "mV", ",", "M\[Omega]1650", ",", "Gamma\[Omega]1650", ",", 
            RowBox[{"f\[Omega]PrPr", "/.", "sol\[Omega]"}]}], "]"}]}], ")"}], 
        "+", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"FormFactorBremDPTemp", "[", 
           RowBox[{
           "mV", ",", "M\[Rho]780", ",", "Gamma\[Rho]780", ",", "f\[Rho]DP"}],
            "]"}], "+", 
          RowBox[{"FormFactorBremDPTemp", "[", 
           RowBox[{"mV", ",", "M\[Rho]1450", ",", "Gamma\[Rho]1450", ",", 
            RowBox[{"f\[Rho]Pr", "/.", "sol\[Rho]"}]}], "]"}], "+", 
          RowBox[{"FormFactorBremDPTemp", "[", 
           RowBox[{"mV", ",", "M\[Rho]1700", ",", "Gamma\[Rho]1700", ",", 
            RowBox[{"f\[Rho]PrPr", "/.", "sol\[Rho]"}]}], "]"}]}], ")"}]}], 
       "]"}], "2"]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"LogLogPlot", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"Abs", "[", 
        RowBox[{"FormFactorBremDP", "[", "mV", "]"}], "]"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"mV", ",", "0.1", ",", "2"}], "}"}], ",", 
      RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
      RowBox[{"Frame", "\[Rule]", "True"}], ",", 
      RowBox[{"ImageSize", "\[Rule]", "Large"}]}], "]"}], "*)"}]}]}]], "Input",\

 CellChangeTimes->{{3.822472937377986*^9, 3.822472958787899*^9}, {
   3.822473164264882*^9, 3.8224732169513645`*^9}, {3.8224732650870314`*^9, 
   3.82247340649076*^9}, {3.8224739149924173`*^9, 3.822473921513314*^9}, {
   3.82247395840426*^9, 3.8224739701273427`*^9}, 3.822474249386196*^9, {
   3.822474485929841*^9, 3.822474542582522*^9}, {3.822474838040749*^9, 
   3.822474846410581*^9}, {3.8765031553789*^9, 3.8765031570765734`*^9}, {
   3.8867410352643704`*^9, 3.886741035534209*^9}, {3.8867410760390997`*^9, 
   3.8867410783231735`*^9}, {3.886741117233474*^9, 3.886741208713107*^9}, {
   3.886759249554492*^9, 3.8867592836208363`*^9}, {3.88675937342173*^9, 
   3.88675940039068*^9}, {3.886759559571762*^9, 3.8867596483855095`*^9}, {
   3.913456552763573*^9, 3.9134565605031033`*^9}, {3.914054477519086*^9, 
   3.914054507785887*^9}},
 CellTags->"Evaluation",
 CellLabel->
  "In[1015]:=",ExpressionUUID->"af1793a9-c991-4eb5-bb7b-068722ea5e83"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Bremsstrahlung probability", "Subsection",
 CellChangeTimes->{{3.886741266905027*^9, 3.886741268810368*^9}, {
  3.913457093447189*^9, 3.91345709478583*^9}, {3.913807362240102*^9, 
  3.913807371750985*^9}},
 CellTags->
  "Evaluation",ExpressionUUID->"66f54253-4a11-4da9-92bf-5b4a170d0c9c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"Double", " ", "differential", " ", "cross"}], "-", 
     RowBox[{"section", " ", 
      FractionBox[
       RowBox[{
        SuperscriptBox["d", "2"], 
        SubscriptBox["\[Sigma]", "brem"]}], 
       RowBox[{
        SubscriptBox["dp", "T"], "dz"}]]}]}], ",", " ", 
    RowBox[{
     RowBox[{"where", " ", 
      SubscriptBox["p", "T"], " ", "is", " ", "the", " ", 
      RowBox[{"DP", "'"}], "s", " ", "transverse", " ", "momentum", " ", 
      "and", " ", "z"}], " ", "=", " ", 
     RowBox[{
      SubscriptBox["E", "DP"], "/", 
      SubscriptBox["p", "beam"]}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"H1", "[", 
      RowBox[{"z_", ",", "pT_", ",", "mp_", ",", "mV_"}], "]"}], "=", 
     RowBox[{
      SuperscriptBox["pT", "2"], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", "z"}], ")"}], "*", 
       SuperscriptBox["mV", "2"]}], "+", 
      RowBox[{
       SuperscriptBox["z", "2"], "*", 
       SuperscriptBox["mp", "2"]}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"d2NdpTdz", "[", 
      RowBox[{
      "mp_", ",", "z_", ",", "pT_", ",", "Pp_", ",", "mV_", ",", 
       "\[Epsilon]2_", ",", "\[Alpha]em_"}], "]"}], "=", 
     RowBox[{
      FractionBox[
       RowBox[{"2", "*", "pT", "*", "\[Epsilon]2", "*", "\[Alpha]em"}], 
       RowBox[{"2", "*", "Pi", "*", 
        RowBox[{"H1", "[", 
         RowBox[{"z", ",", "pT", ",", "mp", ",", "mV"}], "]"}]}]], "*", 
      RowBox[{"(", 
       RowBox[{
        FractionBox[
         RowBox[{"(", 
          RowBox[{"1", "+", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"1", "-", "z"}], ")"}], "2"]}], ")"}], "z"], "-", 
        RowBox[{"2", "*", "z", "*", 
         RowBox[{"(", 
          RowBox[{"1", "-", "z"}], ")"}], "*", 
         RowBox[{"(", 
          RowBox[{
           FractionBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", "*", 
               SuperscriptBox["mp", "2"]}], "+", 
              SuperscriptBox["mV", "2"]}], ")"}], 
            RowBox[{"H1", "[", 
             RowBox[{"z", ",", "pT", ",", "mp", ",", "mV"}], "]"}]], "-", 
           FractionBox[
            RowBox[{
             SuperscriptBox["z", "2"], "*", "2", "*", 
             SuperscriptBox["mp", "4"]}], 
            SuperscriptBox[
             RowBox[{"H1", "[", 
              RowBox[{"z", ",", "pT", ",", "mp", ",", "mV"}], "]"}], "2"]]}], 
          ")"}]}], "+", 
        FractionBox[
         RowBox[{"2", "*", "z", "*", 
          RowBox[{"(", 
           RowBox[{"1", "-", "z"}], ")"}], "*", 
          RowBox[{"(", 
           RowBox[{"1", "+", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"1", "-", "z"}], ")"}], "2"]}], ")"}], "*", 
          SuperscriptBox["mp", "2"], "*", 
          SuperscriptBox["mV", "2"]}], 
         SuperscriptBox[
          RowBox[{"H1", "[", 
           RowBox[{"z", ",", "pT", ",", "mp", ",", "mV"}], "]"}], "2"]], "+", 
        
        FractionBox[
         RowBox[{"2", "*", "z", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"1", "-", "z"}], ")"}], "2"], 
          SuperscriptBox["mV", "4"]}], 
         SuperscriptBox[
          RowBox[{"H1", "[", 
           RowBox[{"z", ",", "pT", ",", "mp", ",", "mV"}], "]"}], "2"]]}], 
       ")"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"JacobianpTzToEV\[Theta]", "[", 
      RowBox[{"mV_", ",", "EV_", ",", "pBeam_", ",", "\[Theta]_"}], "]"}], 
     "=", 
     RowBox[{"-", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{"pTv", "[", 
            RowBox[{"mV", ",", "EV", ",", "\[Theta]"}], "]"}], ",", "EV"}], 
          "]"}], "*", 
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{"zvp", "[", 
            RowBox[{"EV", ",", "pBeam"}], "]"}], ",", "\[Theta]"}], "]"}]}], 
        "-", 
        RowBox[{
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{"pTv", "[", 
            RowBox[{"mV", ",", "EV", ",", "\[Theta]"}], "]"}], ",", 
           "\[Theta]"}], "]"}], "*", 
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{"zvp", "[", 
            RowBox[{"EV", ",", "pBeam"}], "]"}], ",", "EV"}], "]"}]}]}], 
       ")"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"Do", "[", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
     "Producing", " ", "normalized", " ", "distribution", " ", "and", " ", 
      "normalization", " ", 
      RowBox[{"(", 
       RowBox[{"==", 
        RowBox[{"total", " ", "flux"}]}], ")"}]}], "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "eminabs", ",", "emaxabs", ",", "pbeam", ",", "ptmax", ",", "norm", 
         ",", "distr", ",", "normdata"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"pbeam", "=", 
         RowBox[{"EmaxFacility", "[", "Facility", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"eminabs", "=", 
         RowBox[{"ELLPminBrem", "[", "Facility", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"emaxabs", "=", 
         RowBox[{
          RowBox[{"zMaxBrem", "[", "Facility", "]"}], "*", "pbeam"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"ptmax", "=", 
         RowBox[{"pTmaxBrem", "[", "Facility", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Double", " ", "distribution", " ", "for", " ", 
           RowBox[{"bremsstrahlung", ".", " ", "The"}], " ", "cut", " ", 
           "E"}], "<=", 
          RowBox[{
           SubscriptBox["E", "max"], 
           RowBox[{"(", "\[Theta]", ")"}], " ", "is", " ", "not", " ", 
           "included", " ", "for", " ", "more", " ", "robust", " ", "work", 
           " ", "with", " ", "tabulating", " ", "the", " ", 
           "distribution"}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"DoubleDistrBremNonNormalized", "[", 
          RowBox[{
          "mV_", ",", "\[Theta]V_", ",", "EV_", ",", "\"\<DP\>\"", ",", 
           "Facility"}], "]"}], "=", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"\[Theta]V", "<=", 
             RowBox[{"\[Theta]maxBrem", "[", "Facility", "]"}]}], "&&", 
            RowBox[{"EV", ">", "eminabs"}]}], ",", 
           RowBox[{"Evaluate", "[", 
            RowBox[{
             RowBox[{"JacobianpTzToEV\[Theta]", "[", 
              RowBox[{"mV", ",", "EV", ",", "pbeam", ",", "\[Theta]V"}], 
              "]"}], "*", 
             RowBox[{"d2NdpTdz", "[", 
              RowBox[{
               RowBox[{"mSM", "[", "\"\<p\>\"", "]"}], ",", 
               RowBox[{"zvp", "[", 
                RowBox[{"EV", ",", "pbeam"}], "]"}], ",", 
               RowBox[{"pTv", "[", 
                RowBox[{"mV", ",", "EV", ",", "\[Theta]V"}], "]"}], ",", 
               "pbeam", ",", "mV", ",", "1", ",", "\[Alpha]EMval"}], "]"}], 
             "*", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"Facility", "==", "\"\<ESS\>\""}], ",", 
               RowBox[{"UnitStep", "[", 
                RowBox[{"0.1", "-", 
                 RowBox[{"ApplicabilityParameter", "[", 
                  RowBox[{
                   RowBox[{"zvp", "[", 
                    RowBox[{"EV", ",", "pbeam"}], "]"}], ",", 
                   RowBox[{"pTv", "[", 
                    RowBox[{"mV", ",", "EV", ",", "\[Theta]V"}], "]"}], ",", 
                   "mV", ",", "pbeam", ",", 
                   RowBox[{"mSM", "[", "\"\<p\>\"", "]"}]}], "]"}]}], "]"}], 
               ",", "1."}], "]"}]}], "]"}], ",", 
           SuperscriptBox["10", 
            RowBox[{"-", "90."}]]}], "]"}]}], ";"}]}], "\[IndentingNewLine]", 
      
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
         RowBox[{"distr", "[", 
          RowBox[{"mV_", ",", "\[Theta]V_", ",", "EV_"}], "]"}], "=", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"eminabs", "<=", "EV", "<=", 
             RowBox[{"ELLPmaxBrem", "[", 
              RowBox[{"Facility", ",", "mV", ",", "\[Theta]V"}], "]"}]}], "&&", 
            RowBox[{"\[Theta]V", "<=", 
             RowBox[{"\[Theta]maxBrem", "[", "Facility", "]"}]}]}], ",", 
           RowBox[{"Evaluate", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"JacobianpTzToEV\[Theta]", "[", 
               RowBox[{"mV", ",", "EV", ",", "pbeam", ",", "\[Theta]V"}], 
               "]"}], "*", 
              RowBox[{"d2NdpTdz", "[", 
               RowBox[{
                RowBox[{"mSM", "[", "\"\<p\>\"", "]"}], ",", 
                RowBox[{"zvp", "[", 
                 RowBox[{"EV", ",", "pbeam"}], "]"}], ",", 
                RowBox[{"pTv", "[", 
                 RowBox[{"mV", ",", "EV", ",", "\[Theta]V"}], "]"}], ",", 
                "pbeam", ",", "mV", ",", "1", ",", "\[Alpha]EMval"}], "]"}]}], 
             RowBox[{"(*", 
              RowBox[{"*", 
               RowBox[{"UnitStep", "[", 
                RowBox[{"0.1", "-", 
                 RowBox[{"ApplicabilityParameter", "[", 
                  RowBox[{
                   RowBox[{"zvp", "[", 
                    RowBox[{"EV", ",", "pBeam"}], "]"}], ",", 
                   RowBox[{"pTv", "[", 
                    RowBox[{"EV", ",", "\[Theta]V"}], "]"}], ",", "mV", ",", 
                   "pBeam", ",", "MP"}], "]"}]}], "]"}]}], "*)"}], ",", 
             SuperscriptBox["10", 
              RowBox[{"-", "90."}]]}], "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"normdata", "=", 
         RowBox[{"ParallelTable", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"mV", ",", 
             RowBox[{"NIntegrate", "[", 
              RowBox[{
               RowBox[{"distr", "[", 
                RowBox[{"mV", ",", "\[Theta]V", ",", "EV"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"\[Theta]V", ",", "0", ",", 
                 RowBox[{"\[Theta]maxBrem", "[", "Facility", "]"}]}], "}"}], 
               ",", 
               RowBox[{"{", 
                RowBox[{"EV", ",", "eminabs", ",", 
                 RowBox[{"Max", "[", 
                  RowBox[{"eminabs", ",", 
                   RowBox[{"ELLPmaxBrem", "[", 
                    RowBox[{"Facility", ",", "mV", ",", "\[Theta]V"}], 
                    "]"}]}], "]"}]}], "}"}]}], 
              RowBox[{"(*", 
               RowBox[{",", 
                RowBox[{"Method", "\[Rule]", "\"\<AdaptiveMonteCarlo\>\""}]}],
                "*)"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"mV", ",", "mVminFromBrem", ",", "mVmaxFromBrem", ",", 
             FractionBox[
              RowBox[{"(", 
               RowBox[{"mVmaxFromBrem", "-", "mVminFromBrem"}], ")"}], 
              "20"]}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"norm", "[", "mV_", "]"}], "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Interpolation", "[", 
            RowBox[{
             RowBox[{"normdata", "//", "Log"}], ",", 
             RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[", 
           RowBox[{"Log", "[", "mV", "]"}], "]"}], "//", "Exp"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"DoubleDistrBrem", "[", 
          RowBox[{
          "mV_", ",", "\[Theta]V_", ",", "EV_", ",", "\"\<DP\>\"", ",", 
           "Facility"}], "]"}], "=", 
         FractionBox[
          RowBox[{"distr", "[", 
           RowBox[{"mV", ",", "\[Theta]V", ",", "EV"}], "]"}], 
          RowBox[{"norm", "[", "mV", "]"}]]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"NormalizationBremDP", "[", 
          RowBox[{"mV_", ",", "Facility"}], "]"}], "=", 
         RowBox[{
          RowBox[{"norm", "[", "mV", "]"}], "*", 
          SuperscriptBox[
           RowBox[{"Abs", "[", 
            RowBox[{"FormFactorBremDP", "[", "mV", "]"}], "]"}], "2"]}]}], 
        ";"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"Export", "[", 
        RowBox[{
         RowBox[{"FileNameJoin", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"NotebookDirectory", "[", "]"}], ",", 
            "\"\<phenomenology/Dark photon/Production probabilities/Pbrem.m\>\
\""}], "}"}], "]"}], ",", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"Facility", ",", 
             RowBox[{"NormalizationBremDP", "[", 
              RowBox[{"mV", ",", "Facility"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"Facility", ",", "FacilitiesList"}], "}"}]}], "]"}], ",", 
         "\"\<MX\>\""}], "]"}], "*)"}], "\[IndentingNewLine]", "]"}], 
     "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{"Facility", ",", "FacilitiesList"}], "}"}]}], "]"}], 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.8867413870113516`*^9, 3.886741540701558*^9}, {
   3.886741615008592*^9, 3.886741685891787*^9}, {3.886741763910581*^9, 
   3.886741873463111*^9}, {3.8867431693622923`*^9, 3.88674317047512*^9}, {
   3.88675912650349*^9, 3.886759206087909*^9}, {3.886759704352801*^9, 
   3.886759755586966*^9}, {3.8867603578143253`*^9, 3.8867604196106277`*^9}, {
   3.886760617244815*^9, 3.886760865322702*^9}, {3.8867611750575757`*^9, 
   3.88676119071132*^9}, {3.886822306577469*^9, 3.886822316571784*^9}, {
   3.886832736983899*^9, 3.88683285265881*^9}, {3.886837622565453*^9, 
   3.8868376275089264`*^9}, {3.8868377047500257`*^9, 3.886837750042342*^9}, {
   3.886839169235644*^9, 3.8868391981720943`*^9}, {3.892175213078042*^9, 
   3.8921752473571453`*^9}, {3.892175350303725*^9, 3.892175351846941*^9}, {
   3.892175521630472*^9, 3.89217552388402*^9}, {3.89217562082114*^9, 
   3.892175674689103*^9}, {3.89217595151208*^9, 3.892175983283363*^9}, {
   3.8921761179182386`*^9, 3.892176129808582*^9}, {3.892176317215189*^9, 
   3.892176651308589*^9}, {3.892176803789099*^9, 3.892176993972706*^9}, {
   3.893471786674537*^9, 3.893471944190617*^9}, {3.8934719923316636`*^9, 
   3.893472120538704*^9}, {3.893472172040388*^9, 3.893472237278451*^9}, {
   3.8934724280610037`*^9, 3.8934724478702726`*^9}, {3.893472490621408*^9, 
   3.893472610023154*^9}, {3.893472696578033*^9, 3.893472719078771*^9}, 
   3.893472814711776*^9, {3.8934728976727943`*^9, 3.8934730876325455`*^9}, {
   3.8934731519633265`*^9, 3.893473184555513*^9}, 3.893473338336842*^9, {
   3.8934743664461913`*^9, 3.893474395564608*^9}, {3.89347444304001*^9, 
   3.893474491803772*^9}, {3.893520967114831*^9, 3.893520967130301*^9}, {
   3.893600420970427*^9, 3.893600421656349*^9}, {3.8936018530142164`*^9, 
   3.89360185318885*^9}, 3.893601958152903*^9, {3.893602164820368*^9, 
   3.8936021993678646`*^9}, {3.8936041500444*^9, 3.893604150255808*^9}, {
   3.8936049169399033`*^9, 3.893604967103578*^9}, {3.89394980424424*^9, 
   3.8939498280077534`*^9}, {3.9134555293231926`*^9, 3.913455838015944*^9}, {
   3.9134559627931924`*^9, 3.913456031170876*^9}, {3.913456071313234*^9, 
   3.913456126704509*^9}, {3.9134563937525263`*^9, 3.913456567924281*^9}, {
   3.913456608833413*^9, 3.913456660364135*^9}, {3.913456755197287*^9, 
   3.913456811278873*^9}, {3.913456851632535*^9, 3.913457051861486*^9}, {
   3.913457085908905*^9, 3.91345725302555*^9}, {3.9134572910544057`*^9, 
   3.913457342020426*^9}, {3.913457505040144*^9, 3.9134575228384466`*^9}, {
   3.913458367116445*^9, 3.913458367725425*^9}, {3.9134584488065186`*^9, 
   3.913458459285909*^9}, {3.9134611697649083`*^9, 3.913461174138076*^9}, {
   3.9138273138463836`*^9, 3.913827321126279*^9}, 3.913883326138311*^9, 
   3.914050870893146*^9, {3.9140509269493*^9, 3.914050936644663*^9}, {
   3.914054301094025*^9, 3.914054308381184*^9}, {3.9140543666031165`*^9, 
   3.914054370522285*^9}, {3.914054599455654*^9, 3.9140547578002625`*^9}, {
   3.9140548039699793`*^9, 3.9140548090843987`*^9}, {3.9148324538419247`*^9, 
   3.914832552194564*^9}, {3.914832796306642*^9, 3.914832817580805*^9}, {
   3.914832953316688*^9, 3.91483296836609*^9}, {3.917161669043167*^9, 
   3.9171616758761253`*^9}, {3.917161837557369*^9, 3.9171618378285713`*^9}, {
   3.91716201525734*^9, 3.9171620418812046`*^9}, {3.917164304719488*^9, 
   3.917164310694111*^9}, {3.9171647316150618`*^9, 3.9171647321391945`*^9}, {
   3.9186710146684227`*^9, 3.918671014773458*^9}},
 CellTags->"Evaluation",
 CellLabel->
  "In[1027]:=",ExpressionUUID->"888ea411-eb05-433d-82af-9b42dc20abe5"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[Cell[BoxData[
 FormBox[
  RowBox[{"B", "-", 
   SubscriptBox["L", "\[Alpha]"]}], 
  TraditionalForm]],ExpressionUUID->"2c76bacf-958f-48dd-a3e7-b5a8eb1d86ef"]], \
"Chapter",
 CellChangeTimes->{{3.9133677446759033`*^9, 3.913367795257998*^9}, 
   3.91397153664133*^9},
 CellTags->
  "Evaluation",ExpressionUUID->"0c16d797-cf97-45d5-a5da-b7b1cf6d99d3"],

Cell[CellGroupData[{

Cell["Relevant processes", "Section",
 CellChangeTimes->{{3.913268643168833*^9, 3.9132686454263844`*^9}},
 CellTags->
  "Evaluation",ExpressionUUID->"22ac6846-672b-4d66-9cfa-1e19aad1e49d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"BLlist", "=", 
   RowBox[{"{", 
    RowBox[{
    "\"\<B-L\>\"", ",", "\"\<B-3Lmu\>\"", ",", "\"\<B-Le-3Lmu+Ltau\>\"", ",", 
     "\"\<B-3Le-Lmu+Ltau\>\""}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"List", " ", "of", " ", "processes"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"LLPname", "=", "fipname"}], ";", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"Only", " ", "decays"}], ",", " ", 
      RowBox[{"mixing", " ", "with", " ", "\[Omega]"}], ",", " ", 
      RowBox[{
       RowBox[{"and", " ", "proton", " ", "bremsstrahlung", " ", "are", " ", 
        RowBox[{"listed", ".", " ", "Drell"}]}], "-", 
       RowBox[{"Yan", " ", "is", " ", "computed", " ", "externally", " ", 
        RowBox[{"(", 
         RowBox[{"MadGraph", "+", "pythia"}], ")"}]}]}]}], "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ProcessesListAll", "[", "LLPname", "]"}], "=", 
     RowBox[{"{", 
      RowBox[{
      "\"\<Pi0\>\"", ",", "\"\<Eta\>\"", ",", "\"\<EtaPr\>\"", ",", 
       "\"\<Bremsstrahlung\>\"", ",", "\"\<Omega\>\""}], "}"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"Topology", " ", "of", " ", "the", " ", "process"}], "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{"MapThread", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"ProductionType", "[", 
          RowBox[{"LLPname", ",", "#1"}], "]"}], "=", "#2"}], ")"}], "&"}], 
      ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"ProcessesListAll", "[", "LLPname", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{
         "\"\<Decay\>\"", ",", "\"\<Decay\>\"", ",", "\"\<Decay\>\"", ",", 
          "\"\<Scattering\>\"", ",", "\"\<Mixing\>\""}], "}"}]}], "}"}]}], 
     "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"Particle", " ", 
       RowBox[{"content", ":", " ", 
        RowBox[{"mother", " ", "particle"}]}]}], ",", " ", 
      RowBox[{"decay", " ", "products"}]}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{"MapThread", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"ReactionProductsList", "[", 
          RowBox[{"LLPname", ",", "#1"}], "]"}], "=", "#2"}], ")"}], "&"}], 
      ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"ProcessesListAll", "[", "LLPname", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"\"\<Pi0\>\"", ",", "\"\<photon\>\"", ",", "LLPname"}], 
           "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"\"\<Eta\>\"", ",", "\"\<photon\>\"", ",", "LLPname"}], 
           "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"\"\<EtaPr\>\"", ",", "\"\<photon\>\"", ",", "LLPname"}], 
           "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"\"\<p\>\"", ",", "LLPname"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"\"\<Omega\>\"", ",", "LLPname"}], "}"}]}], "}"}]}], 
       "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", ",", 
   RowBox[{"{", 
    RowBox[{"fipname", ",", "BLlist"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"LLPname", "//", "Clear"}]}], "Input",
 CellChangeTimes->{{3.9133722201995955`*^9, 3.913372281989397*^9}, {
   3.9133725022728834`*^9, 3.913372513873137*^9}, {3.913372578431034*^9, 
   3.913372579172832*^9}, {3.9133728174657536`*^9, 3.9133728606330585`*^9}, {
   3.913373958636708*^9, 3.9133739959314203`*^9}, {3.913374217194346*^9, 
   3.913374224867088*^9}, 3.9133945726127167`*^9, {3.9133952402886057`*^9, 
   3.913395240302261*^9}, {3.913971542812166*^9, 3.913971624397476*^9}, {
   3.9154388111241503`*^9, 3.915438811157645*^9}, 3.915440189951427*^9, 
   3.91544073426882*^9, {3.915440798096418*^9, 3.9154408066169195`*^9}, 
   3.91544096610886*^9},
 CellTags->"Evaluation",
 CellLabel->
  "In[1031]:=",ExpressionUUID->"0923bf32-7001-48e0-b6cc-8caa6b1a676a"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Proton bremsstrahlung probability", "Section",
 CellChangeTimes->{{3.9138073498597403`*^9, 3.9138073591296988`*^9}},
 CellTags->
  "Evaluation",ExpressionUUID->"6f4c2c05-ba47-4584-a3a8-5975da8e7acd"],

Cell[CellGroupData[{

Cell["Proton form-factor in timelike region", "Subsection",
 CellChangeTimes->{{3.886741266905027*^9, 3.886741268810368*^9}, {
   3.913457093447189*^9, 3.91345709478583*^9}, 3.913807362240102*^9},
 CellTags->
  "Evaluation",ExpressionUUID->"eddd0b80-7620-4305-bdc4-6d501e9ea0d1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"The", " ", "form"}], "-", 
      RowBox[{
      "factor", " ", "is", " ", "derived", " ", "assuming", " ", "the", " ", 
       "mixing", " ", "of", " ", "BLs", " ", "with", " ", "3", " ", "\[Rho]", 
       " ", "and", " ", "3", " ", "\[Omega]", " ", "resonances"}]}], ",", 
     RowBox[{
      RowBox[{
      "with", " ", "the", " ", "6", " ", "couplings", " ", "fixed", " ", 
       "from", " ", "experiment", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"lowest", " ", "\[Rho]"}], ",", 
         RowBox[{"\[Omega]", " ", "resonances"}]}], ")"}]}], " ", "+", 
      RowBox[{"boundary", " ", "conditions"}]}]}], ")"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Masses", " ", "and", " ", "other", " ", "parameters"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"f\[Omega]BL", "=", "1.011"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"f\[Rho]BL", "=", "0.616"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"M\[Omega]780", ",", "M\[Omega]1420", ",", "M\[Omega]1650"}], 
      "}"}], "=", 
     RowBox[{"{", 
      RowBox[{"0.78", ",", "1.42", ",", "1.65"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "Gamma\[Omega]780", ",", "Gamma\[Omega]1420", ",", 
       "Gamma\[Omega]1650"}], "}"}], "=", 
     RowBox[{"{", 
      RowBox[{"0.0084", ",", "0.29", ",", "0.315"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Qel", "=", 
     RowBox[{"DiagonalMatrix", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"2", "/", "3"}], ",", 
        RowBox[{"-", 
         RowBox[{"(", 
          RowBox[{"1", "/", "3"}], ")"}]}], ",", 
        RowBox[{"-", 
         RowBox[{"(", 
          RowBox[{"1", "/", "3"}], ")"}]}]}], "}"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"T\[Omega]", " ", "=", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "/", "2"}], ")"}], 
      RowBox[{"DiagonalMatrix", "[", 
       RowBox[{"{", 
        RowBox[{"1", ",", "1", ",", "0"}], "}"}], "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"T\[Phi]", " ", "=", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "/", 
        RowBox[{"(", 
         RowBox[{"\[Sqrt]", "2"}], ")"}]}], ")"}], 
      RowBox[{"DiagonalMatrix", "[", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "1"}], "}"}], "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"f\[Omega]N", "=", "17.2"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"g\[Omega]", "=", 
     RowBox[{"17.1", "*", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "/", "3"}], ")"}], 
          RowBox[{"Tr", "[", "T\[Omega]", "]"}]}], ")"}], "/", 
        RowBox[{"Tr", "[", 
         RowBox[{"Qel", ".", "T\[Omega]"}], "]"}]}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"G\[Omega]", "=", 
     RowBox[{"4", 
      RowBox[{"(", 
       RowBox[{"f\[Omega]N", "/", "g\[Omega]"}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"FVectorMeson", "[", 
      RowBox[{"q2_", ",", "mV_", ",", "\[CapitalGamma]V_"}], "]"}], "=", 
     RowBox[{"-", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["mV", "2"], "/", 
        RowBox[{"(", 
         RowBox[{"q2", "-", 
          SuperscriptBox["mV", "2"], "+", 
          RowBox[{"I", "*", "\[CapitalGamma]V", "*", "mV"}]}], ")"}]}], 
       ")"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"FormFactorBremBL3\[Omega]Temp", "[", 
      RowBox[{
      "q2_", ",", "m\[Omega]780_", ",", "m\[Omega]1420_", ",", 
       "m\[Omega]1650_", ",", "\[CapitalGamma]\[Omega]780_", ",", 
       "\[CapitalGamma]\[Omega]1420_", ",", "\[CapitalGamma]\[Omega]1650_"}], 
      "]"}], "=", 
     RowBox[{
      RowBox[{"G\[Omega]", "*", 
       RowBox[{"FVectorMeson", "[", 
        RowBox[{
        "q2", ",", "m\[Omega]780", ",", "\[CapitalGamma]\[Omega]780"}], 
        "]"}]}], "+", 
      RowBox[{"G\[Omega]1420", "*", 
       RowBox[{"FVectorMeson", "[", 
        RowBox[{
        "q2", ",", "m\[Omega]1420", ",", "\[CapitalGamma]\[Omega]1420"}], 
        "]"}]}], "+", 
      RowBox[{"G\[Omega]1650", "*", 
       RowBox[{"FVectorMeson", "[", 
        RowBox[{
        "q2", ",", "m\[Omega]1650", ",", "\[CapitalGamma]\[Omega]1650"}], 
        "]"}]}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"EquationsBL3\[Omega]", "[", 
      RowBox[{"m\[Omega]780_", ",", "m\[Omega]1420_", ",", "m\[Omega]1650_"}],
       "]"}], ":=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"Limit", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"FormFactorBremBL3\[Omega]Temp", "[", 
             RowBox[{
              RowBox[{"-", "q2"}], ",", "m\[Omega]780", ",", "m\[Omega]1420", 
              ",", "m\[Omega]1650", ",", "Gamma\[Omega]780", ",", 
              "Gamma\[Omega]1420", ",", "Gamma\[Omega]1650"}], "]"}], "q2"}], 
           ",", 
           RowBox[{"q2", "\[Rule]", "Infinity"}]}], "]"}], ")"}], "\[Equal]", 
        "0"}], "&&", 
       RowBox[{
        RowBox[{"FormFactorBremBL3\[Omega]Temp", "[", 
         RowBox[{
         "0", ",", "m\[Omega]780", ",", "m\[Omega]1420", ",", "m\[Omega]1650",
           ",", "Gamma\[Omega]780", ",", "Gamma\[Omega]1420", ",", 
          "Gamma\[Omega]1650"}], "]"}], "\[Equal]", "1"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"solFormBL3\[Omega]", "=", 
     RowBox[{
      RowBox[{"Solve", "[", 
       RowBox[{
        RowBox[{"EquationsBL3\[Omega]", "[", 
         RowBox[{"M\[Omega]780", ",", "M\[Omega]1420", ",", "M\[Omega]1650"}],
          "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"G\[Omega]1420", ",", "G\[Omega]1650"}], "}"}]}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"FormFactorSquaredBrem", "[", 
        RowBox[{"q_", ",", "LLP"}], "]"}], "=", 
       SuperscriptBox[
        RowBox[{"Abs", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"FormFactorBremBL3\[Omega]Temp", "[", 
            RowBox[{
             SuperscriptBox["q", "2"], ",", "M\[Omega]780", ",", 
             "M\[Omega]1420", ",", "M\[Omega]1650", ",", "Gamma\[Omega]780", 
             ",", "Gamma\[Omega]1420", ",", "Gamma\[Omega]1650"}], "]"}], "/.", 
           RowBox[{"{", 
            RowBox[{"G\[Omega]1420", "\[Rule]", 
             RowBox[{"(", 
              RowBox[{"G\[Omega]1420", "/.", "solFormBL3\[Omega]"}], ")"}]}], 
            "}"}]}], "/.", 
          RowBox[{"{", 
           RowBox[{"G\[Omega]1650", "\[Rule]", 
            RowBox[{"(", 
             RowBox[{"G\[Omega]1650", "/.", "solFormBL3\[Omega]"}], ")"}]}], 
           "}"}]}], "]"}], "2"]}], ",", 
      RowBox[{"{", 
       RowBox[{"LLP", ",", "BLlist"}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"LogPlot", "[", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"FormFactorBremBL", "[", "mV", "]"}], "2"], ",", 
      RowBox[{"{", 
       RowBox[{"mV", ",", "0.0", ",", "5"}], "}"}], ",", 
      RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
      RowBox[{"Frame", "\[Rule]", "True"}], ",", 
      RowBox[{"ImageSize", "\[Rule]", "Large"}]}], "]"}], "*)"}]}]}]], "Input",\

 CellChangeTimes->{{3.914054522755436*^9, 3.9140545841865187`*^9}, {
  3.9154388111701307`*^9, 3.915438811172634*^9}},
 CellTags->"Evaluation",
 CellLabel->
  "In[1034]:=",ExpressionUUID->"9a3e14c8-a701-4a7b-bd5e-079830f196e6"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Bremsstrahlung probability", "Subsection",
 CellChangeTimes->{{3.886741266905027*^9, 3.886741268810368*^9}, {
  3.913457093447189*^9, 3.91345709478583*^9}, {3.913807362240102*^9, 
  3.913807371750985*^9}},
 CellTags->
  "Evaluation",ExpressionUUID->"bd015ad4-8be9-47db-97c8-e1ef0e8bd304"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Do", "[", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Producing", " ", "normalized", " ", "distribution", " ", "and", " ", 
     "normalization", " ", 
     RowBox[{"(", 
      RowBox[{"==", 
       RowBox[{"total", " ", "flux"}]}], ")"}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "LLPname", ",", "eminabs", ",", "emaxabs", ",", "pbeam", ",", "ptmax", 
        ",", "norm", ",", "distr", ",", "normdata"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"LLPname", "=", "fipname"}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "Tabulated", " ", "distribution", " ", "to", " ", "be", " ", "used", 
         " ", "in", " ", "next", " ", "sections"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
         "Express", " ", "the", " ", "normalization", " ", "in", " ", "terms",
           " ", "of", " ", "DP", " ", 
          RowBox[{"normalization", ".", " ", 
           RowBox[{"Difference", ":", " ", 
            RowBox[{"form", "-", "factors", " ", "+", " ", 
             RowBox[{
              SubscriptBox["g", "BL"], "/", 
              SubscriptBox["\[Alpha]", "EM"]}]}]}]}]}], " ", "=", " ", 
         RowBox[{"4", 
          RowBox[{
           SubscriptBox["\[Pi]\[Alpha]", "D"], "/", 
           SubscriptBox["\[Alpha]", "EM"]}]}]}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"DoubleDistrBremNonNormalized", "[", 
         RowBox[{
         "mV_", ",", "\[Theta]V_", ",", "EV_", ",", "LLPname", ",", 
          "Facility"}], "]"}], "=", 
        RowBox[{
         FractionBox[
          RowBox[{"4", "Pi"}], "\[Alpha]EMval"], 
         RowBox[{"DoubleDistrBremNonNormalized", "[", 
          RowBox[{
          "mV", ",", "\[Theta]V", ",", "EV", ",", "\"\<DP\>\"", ",", 
           "Facility"}], "]"}]}]}], ";"}]}], "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{
        RowBox[{"NormalizationBremBL", "[", 
         RowBox[{"mV_", ",", "Facility"}], "]"}], "=", 
        RowBox[{
         RowBox[{
          RowBox[{"NormalizationBremDP", "[", 
           RowBox[{"mV", ",", "Facility"}], "]"}], "*", 
          FractionBox[
           RowBox[{"4", "Pi"}], "\[Alpha]EMval"], 
          FractionBox[
           RowBox[{"FormFactorSquaredBrem", "[", 
            RowBox[{"mV", ",", "LLPname"}], "]"}], 
           RowBox[{"FormFactorSquaredBrem", "[", 
            RowBox[{"mV", ",", "\"\<DP\>\""}], "]"}]]}], "//", "Simplify"}]}],
        ";", "\[IndentingNewLine]", 
       RowBox[{"Export", "[", 
        RowBox[{
         RowBox[{"FileNameJoin", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"NotebookDirectory", "[", "]"}], ",", 
            "\"\<phenomenology\>\"", ",", "LLPname", ",", 
            "\"\<Production probabilities/Pbrem.m\>\""}], "}"}], "]"}], ",", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"Facility", ",", 
             RowBox[{"NormalizationBremBL", "[", 
              RowBox[{"mV", ",", "Facility"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"Facility", ",", "FacilitiesList"}], "}"}]}], "]"}], ",", 
         "\"\<MX\>\""}], "]"}]}], "*)"}], "\[IndentingNewLine]", "]"}], 
    "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{"fipname", ",", "BLlist"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"Facility", ",", "FacilitiesList"}], "}"}]}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{
  3.9138833261633744`*^9, {3.913971597608085*^9, 3.913971661818284*^9}, {
   3.9139716967102084`*^9, 3.9139717139591*^9}, {3.9140547989391994`*^9, 
   3.914054942831914*^9}, 3.9149266679058847`*^9, {3.915438811186893*^9, 
   3.915438811200884*^9}},
 CellTags->"Evaluation",
 CellLabel->
  "In[1049]:=",ExpressionUUID->"44f080a3-313f-4151-85aa-82221d6fcc7f"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Scalar", "Chapter",
 CellChangeTimes->{{3.9133677446759033`*^9, 3.913367748391884*^9}, {
  3.913971690980274*^9, 3.9139716916755486`*^9}},
 CellTags->
  "Evaluation",ExpressionUUID->"b06bae0d-0042-4908-8c65-fa53403402b2"],

Cell[CellGroupData[{

Cell["Relevant processes", "Section",
 CellChangeTimes->{{3.913268643168833*^9, 3.9132686454263844`*^9}},
 CellTags->
  "Evaluation",ExpressionUUID->"87dbf68c-da68-49fd-aa77-8727e25def3f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"List", " ", "of", " ", "processes"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"LLPname", "=", "\"\<Scalar\>\""}], ";"}], "\[IndentingNewLine]", 
   
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"The", " ", "kinematics", " ", "of", " ", "2"}], "-", 
       RowBox[{
       "body", " ", "decays", " ", "of", " ", "B", " ", "via", " ", "the", 
        " ", "mixing", " ", "channel", " ", "is", " ", "approximated", " ", 
        "by", " ", "B"}]}], " ", "->", " ", 
      RowBox[{"\[Pi]", "+", 
       RowBox[{
        RowBox[{"S", ".", " ", "This"}], " ", "is", " ", "reasonable", " ", 
        "since", " ", "at", " ", "low", " ", "scalar", " ", "masses", " ", 
        "the", " ", "accompanying", " ", "meson", " ", "mass", " ", "is", " ",
         "irrelevant"}]}]}], ",", " ", 
     RowBox[{"while", " ", "at", " ", "higher", " ", "masses"}], ",", " ", 
     RowBox[{"only", " ", "\[Pi]"}], ",", 
     RowBox[{"K", " ", "may", " ", "be"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ProcessesListAll", "[", "LLPname", "]"}], "=", 
     RowBox[{"{", 
      RowBox[{
      "\"\<B-mixing\>\"", ",", "\"\<Bs-quartic\>\"", ",", "\"\<B-quartic\>\"",
        ",", "\"\<h-quartic\>\"", ",", "\"\<K-mixing\>\"", ",", 
       "\"\<Bremsstrahlung\>\""}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Topology", " ", "of", " ", "the", " ", "process"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MapThread", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"ProductionType", "[", 
          RowBox[{"LLPname", ",", "#1"}], "]"}], "=", "#2"}], ")"}], "&"}], 
      ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"ProcessesListAll", "[", "LLPname", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{
         "\"\<Decay\>\"", ",", "\"\<Decay\>\"", ",", "\"\<Decay\>\"", ",", 
          "\"\<Decay\>\"", ",", "\"\<Decay\>\"", ",", "\"\<Scattering\>\""}], 
         "}"}]}], "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Particle", " ", 
      RowBox[{"content", ":", " ", 
       RowBox[{"mother", " ", "particle"}]}]}], ",", " ", 
     RowBox[{"decay", " ", "products"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MapThread", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"ReactionProductsList", "[", 
          RowBox[{"LLPname", ",", "#1"}], "]"}], "=", "#2"}], ")"}], "&"}], 
      ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"ProcessesListAll", "[", "LLPname", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "\"\<Bplus\>\"", ",", "\"\<PiCharged\>\"", ",", "LLPname"}], "}"}],
           ",", 
          RowBox[{"{", 
           RowBox[{"\"\<Bs\>\"", ",", "LLPname", ",", "LLPname"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
           "\"\<Bplus\>\"", ",", "\"\<Kplus\>\"", ",", "LLPname", ",", 
            "LLPname"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"\"\<h\>\"", ",", "LLPname", ",", "LLPname"}], "}"}], ",", 
          
          RowBox[{"{", 
           RowBox[{
           "\"\<Kplus\>\"", ",", "\"\<PiCharged\>\"", ",", "LLPname"}], "}"}],
           ",", 
          RowBox[{"{", 
           RowBox[{"\"\<p\>\"", ",", "LLPname"}], "}"}]}], "}"}]}], "}"}]}], 
     "]"}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.913268651639258*^9, 3.913268731959789*^9}, {
   3.913269743023601*^9, 3.913269760636882*^9}, {3.9132704922250967`*^9, 
   3.913270515217724*^9}, {3.913274535814342*^9, 3.913274541705774*^9}, {
   3.913276023882397*^9, 3.913276024274871*^9}, {3.913278154921974*^9, 
   3.913278213933945*^9}, {3.913278320684838*^9, 3.913278361235646*^9}, {
   3.9132785241175838`*^9, 3.9132785245568476`*^9}, {3.9132798569079*^9, 
   3.913279857127489*^9}, {3.913280729313801*^9, 3.91328073035002*^9}, {
   3.913282969137287*^9, 3.913283144403261*^9}, {3.913283998801713*^9, 
   3.913284005157871*^9}, 3.913284245935687*^9, {3.9132880215123806`*^9, 
   3.913288250272523*^9}, {3.913288282124204*^9, 3.913288377623515*^9}, {
   3.913288439319628*^9, 3.913288440967491*^9}, {3.9132885639772277`*^9, 
   3.913288576598701*^9}, {3.913288737346222*^9, 3.913288737605184*^9}, {
   3.9133079830416517`*^9, 3.913307996635379*^9}, {3.9133091786762276`*^9, 
   3.913309188795542*^9}, {3.913367875758139*^9, 3.9133678984536057`*^9}, {
   3.9133679450492773`*^9, 3.913367996606799*^9}, {3.913368049633053*^9, 
   3.913368214941719*^9}, {3.913370350663658*^9, 3.913370357263413*^9}, {
   3.9133704657984266`*^9, 3.913370636278497*^9}, {3.913370677973692*^9, 
   3.913370679634003*^9}, {3.913370794696863*^9, 3.913370810074821*^9}, {
   3.913371137276737*^9, 3.9133711812942195`*^9}, {3.913371540870612*^9, 
   3.913371541199168*^9}, {3.913371994298341*^9, 3.913372000546988*^9}, 
   3.91337260121929*^9, {3.913374106046937*^9, 3.913374163997956*^9}, 
   3.9133946538362236`*^9, {3.9133952402538595`*^9, 3.913395240259123*^9}, {
   3.913448185107002*^9, 3.913448186687129*^9}, {3.913807227601019*^9, 
   3.913807245301691*^9}, {3.914831447021508*^9, 3.914831447027542*^9}, {
   3.915438811210874*^9, 3.915438811248358*^9}, 3.915440189956416*^9, {
   3.915440798107267*^9, 3.91544083642699*^9}, 3.915440966112955*^9},
 CellTags->"Evaluation",
 CellLabel->
  "In[1050]:=",ExpressionUUID->"e1ed0d49-9570-4820-b744-0bdb07787dba"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   RowBox[{"Squared", " ", "matrix", " ", "elements"}], TraditionalForm]],
  ExpressionUUID->"9a06879d-c401-4674-9c4c-c91b4605050e"],
 " for 3-body processes (https://arxiv.org/abs/1904.10447)"
}], "Section",
 CellChangeTimes->{{3.885110713454113*^9, 3.8851107251942005`*^9}, {
  3.885110997617735*^9, 3.885110998121342*^9}, {3.885111065838665*^9, 
  3.885111066689054*^9}, {3.91336783328274*^9, 3.913367836688823*^9}},
 CellTags->
  "Evaluation",ExpressionUUID->"b97b4e66-c521-4117-8848-be907144e732"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"MBpole", "=", 
   SqrtBox["38."]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Msquared3Body", "[", 
   RowBox[{
   "LLPname", ",", "\"\<B-quartic\>\"", ",", "mLLP_", ",", "E1_", ",", 
    "E3_"}], "]"}], "=", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      FractionBox["1", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{
           RowBox[{"ScalarProduct", "[", 
            RowBox[{
             RowBox[{"k", "-", "k1"}], ",", 
             RowBox[{"k", "-", "k1"}]}], "]"}], "/", 
           SuperscriptBox["MBpole", "2"]}]}], ")"}], "2"]], "//", 
      "ExpandScalarProduct"}], ")"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"ScalarProduct", "[", 
        RowBox[{"k", ",", "k"}], "]"}], "\[Rule]", "ProductKK"}], ",", 
      RowBox[{
       RowBox[{"ScalarProduct", "[", 
        RowBox[{"k1", ",", "k1"}], "]"}], "\[Rule]", "ProductK1K1"}], ",", 
      RowBox[{
       RowBox[{"ScalarProduct", "[", 
        RowBox[{"k", ",", "k1"}], "]"}], "\[Rule]", " ", 
       "ProductKK1energy"}]}], "}"}]}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"m", "\[Rule]", 
      RowBox[{"mSM", "[", "\"\<Bplus\>\"", "]"}]}], ",", 
     RowBox[{"m1", "\[Rule]", 
      RowBox[{"mSM", "[", "\"\<PiCharged\>\"", "]"}]}]}], 
    "}"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"LLPname", "//", "Clear"}]}], "Input",
 CellChangeTimes->{{3.885111000802554*^9, 3.885111040814557*^9}, {
   3.88511107936763*^9, 3.885111189042398*^9}, {3.88545503444947*^9, 
   3.8854550349407*^9}, {3.913367842073926*^9, 3.913367848920541*^9}, {
   3.913371995652422*^9, 3.913371997607713*^9}, 3.9133721876677847`*^9, {
   3.91339466005204*^9, 3.913394662707048*^9}, {3.91370955114787*^9, 
   3.9137095614138393`*^9}, 3.914831447028082*^9, {3.915438811257351*^9, 
   3.915438811262354*^9}},
 CellTags->"Evaluation",
 CellLabel->
  "In[1054]:=",ExpressionUUID->"e9469ab9-0236-4da8-981e-4f96c1d0f893"],

Cell[BoxData[
 FormBox[
  FractionBox["1", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"1", "-", 
      RowBox[{"0.026315789473684216`", " ", 
       RowBox[{"(", 
        RowBox[{"27.887162`", "\[VeryThinSpace]", "-", 
         RowBox[{"10.558`", " ", "E1"}]}], ")"}]}]}], ")"}], "2"]], 
  TraditionalForm]], "Output",
 CellChangeTimes->{3.930211524465686*^9, 3.930822756523271*^9},
 CellTags->"Evaluation",
 CellLabel->
  "Out[1055]=",ExpressionUUID->"e1efcd43-45e8-471c-aa88-c6c234cd6788"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Proton bremsstrahlung probability", "Section",
 CellChangeTimes->{{3.893947898444198*^9, 3.893947904344373*^9}},
 CellTags->
  "Evaluation",ExpressionUUID->"cc2312ac-4e04-4612-9e6b-593fe31948b9"],

Cell[CellGroupData[{

Cell["Various parameters", "Subsection",
 CellChangeTimes->{{3.893948024186832*^9, 3.893948026744702*^9}},
 CellTags->
  "Evaluation",ExpressionUUID->"346ee184-7723-44c1-b589-5bb27d0a63ef"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Scalar", "-", 
    RowBox[{"nucleon", " ", "low"}], "-", 
    RowBox[{"energy", " ", "coupling"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"GSNN", "=", 
     RowBox[{"1.2", "*", 
      SuperscriptBox["10", 
       RowBox[{"-", "3"}]]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "Fit", " ", "for", " ", "the", " ", "pp", " ", "total", " ", "cross"}], 
     "-", 
     RowBox[{
     "section", " ", "in", " ", "mb", " ", "in", " ", "terms", " ", "of", " ",
       "invariant", " ", "mass", " ", "s"}]}], "*)"}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{"Zfit", "=", "35.45"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Bfit", "=", "0.308"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Y1fit", "=", "42.53"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Y2fit", "=", "33.34"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"s0fit", "=", 
     SuperscriptBox["5.38", "2"]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"s1fit", "=", "1"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Eta]1fit", "=", "0.458"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Eta]2fit", "=", "0.545"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Sinvariant", "[", 
      RowBox[{"Pp_", ",", "mp_"}], "]"}], "=", 
     RowBox[{"2", "*", "Pp", "*", "mp"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Sprime", "[", 
      RowBox[{"Pp_", ",", "mp_", ",", "z_"}], "]"}], "=", 
     RowBox[{
      RowBox[{"2", "*", "mp", "*", "Pp", 
       RowBox[{"(", 
        RowBox[{"1", "-", "z"}], ")"}]}], "+", 
      RowBox[{"2", "*", 
       SuperscriptBox["mp", "2"]}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"sigmapp", "[", "s_", "]"}], "=", 
     RowBox[{"Zfit", "+", 
      RowBox[{"Bfit", "*", 
       SuperscriptBox[
        RowBox[{"Log", "[", 
         RowBox[{"s", "/", "s0fit"}], "]"}], "2"]}], "+", 
      RowBox[{"Y1fit", "*", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"s1fit", "/", "s"}], ")"}], "\[Eta]1fit"]}], "-", 
      RowBox[{"Y2fit", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"s1fit", "/", "s"}], ")"}], "\[Eta]2fit"]}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Elastic", " ", "SNN", " ", "form"}], "-", "factor"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"FormFactorSquaredBrem", "[", 
      RowBox[{"mS_", ",", "\"\<Scalar\>\""}], "]"}], "=", 
     RowBox[{
      RowBox[{"Interpolation", "[", 
       RowBox[{
        RowBox[{"Import", "[", 
         RowBox[{
          RowBox[{"FileNameJoin", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"NotebookDirectory", "[", "]"}], ",", 
             "\"\<phenomenology/Scalar/Production \
probabilities/proton-timelike-form-factor-scalar.txt\>\""}], "}"}], "]"}], 
          ",", "\"\<Table\>\""}], "]"}], ",", 
        RowBox[{"InterpolationOrder", "->", "1"}]}], "]"}], "[", "mS", 
      "]"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.893948147851899*^9, 3.893948216706112*^9}, {
  3.89395058466586*^9, 3.893950620528405*^9}, {3.8939511202016788`*^9, 
  3.893951147576815*^9}, {3.893951208147995*^9, 3.8939512325535116`*^9}, {
  3.893953295328858*^9, 3.8939533032600737`*^9}, {3.8939536066961417`*^9, 
  3.893953611335486*^9}, {3.9138073165825853`*^9, 3.913807324569834*^9}, {
  3.913807637759537*^9, 3.9138076512140408`*^9}, {3.9138077367492523`*^9, 
  3.913807776631175*^9}, {3.9138078555566745`*^9, 3.913807857775626*^9}, {
  3.913808147141215*^9, 3.913808151443604*^9}, {3.914054574677546*^9, 
  3.91405458993285*^9}},
 CellTags->"Evaluation",
 CellLabel->
  "In[1057]:=",ExpressionUUID->"fbde88eb-bc2d-4ac9-a0dd-e946ef2c3168"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Differential probability calculation", "Subsection",
 CellChangeTimes->{{3.913807763049945*^9, 3.913807769113969*^9}},
 CellTags->
  "Evaluation",ExpressionUUID->"cb40b9db-653b-4159-a38b-7faabf033ced"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Kinematics", " ", "of", " ", "the", " ", "1"}], " ", "\[Rule]", 
    " ", 
    RowBox[{
     RowBox[{"2", " ", "process", " ", "p"}], " ", "\[Rule]", " ", 
     RowBox[{"p", " ", "+", " ", 
      RowBox[{
      "S", " ", "within", " ", "the", " ", "WW", " ", "approximation"}]}]}]}],
    "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"EPbrem", "=", 
     RowBox[{"Pp", "+", 
      FractionBox[
       SuperscriptBox["mp", "2"], 
       RowBox[{"2", "*", "Pp"}]]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"EpprimeBrem", "=", 
     RowBox[{
      RowBox[{"Pp", "*", 
       RowBox[{"(", 
        RowBox[{"1", "-", "z"}], ")"}]}], "+", 
      FractionBox[
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["mp", "2"], "+", 
         SuperscriptBox["pT", "2"]}], ")"}], 
       RowBox[{"2", "*", "Pp", 
        RowBox[{"(", 
         RowBox[{"1", "-", "z"}], ")"}]}]]}]}], ";"}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{"ppprimeBrem", "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "z"}], ")"}], "*", "Pp"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ESbrem", "=", 
     RowBox[{
      RowBox[{"Pp", "*", "z"}], "+", 
      FractionBox[
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["pT", "2"], "+", 
         SuperscriptBox["mS", "2"]}], ")"}], 
       RowBox[{"2", "*", "Pp", "*", "z"}]]}]}], ";"}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{"pSbrem", "=", 
     RowBox[{"pp", "-", "ppprimeBrem"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
   "Print", "[", "\"\<Applicability parameter (must be << 1):\>\"", "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ApplicabilityParameterScalar", "[", 
     RowBox[{"Pp_", ",", "z_", ",", "pT_", ",", "mX_", ",", "mp_"}], "]"}], 
    "=", 
    RowBox[{
     RowBox[{
      RowBox[{"Simplify", "[", 
       FractionBox[
        RowBox[{"(", 
         RowBox[{"EpprimeBrem", "+", "ESbrem", "-", "EPbrem"}], ")"}], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"EpprimeBrem", "-", "ESbrem", "+", "EPbrem"}], ")"}], "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"pT", "\[Rule]", "0"}], ",", 
            RowBox[{"mp", "\[Rule]", "0"}], ",", 
            RowBox[{"mX", "\[Rule]", "0"}]}], "}"}]}], ")"}]], "]"}], "/.", 
      RowBox[{"{", 
       RowBox[{"mS", "\[Rule]", "mX"}], "}"}]}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        SuperscriptBox["mX", "2"], "+", 
        RowBox[{"4", " ", 
         SuperscriptBox["Pp", "2"], " ", 
         RowBox[{"(", 
          RowBox[{"z", "-", "1"}], ")"}], " ", "z"}]}], "\[Rule]", 
       RowBox[{"4", 
        SuperscriptBox["Pp", "2"], "z", 
        RowBox[{"(", 
         RowBox[{"z", "-", "1"}], ")"}]}]}], "}"}]}]}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{
      "Matrix", " ", "element", " ", "corresponding", " ", "to", " ", "the", 
       " ", "sub"}], "-", 
      RowBox[{"process", " ", "p"}]}], " ", "\[Rule]", " ", 
     RowBox[{"p", " ", "+", " ", "S"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MscalarBrem", "=", 
     RowBox[{"gSNN", " ", 
      RowBox[{
       RowBox[{"SpinorUBar", "[", 
        RowBox[{"p1", ",", "mp"}], "]"}], ".", 
       RowBox[{"SpinorU", "[", 
        RowBox[{"k1", ",", "mp"}], "]"}]}]}]}], ";"}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{"MscalarBremStar", "=", 
     RowBox[{"ComplexConjugate", "[", "MscalarBrem", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Squared", " ", "matrix", " ", "element"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MScalarBremSquared", "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           FractionBox["1", "2"], 
           RowBox[{"FermionSpinSum", "[", 
            RowBox[{"MscalarBrem", " ", "MscalarBremStar"}], "]"}]}], "/.", 
          RowBox[{"DiracTrace", "\[Rule]", "TR"}]}], "//", "Contract"}], "//",
         "Simplify"}], ")"}], "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"ScalarProduct", "[", 
         RowBox[{"k1", ",", "p1"}], "]"}], "\[Rule]", " ", 
        RowBox[{
         RowBox[{"Pp", "*", "EpprimeBrem"}], "-", 
         RowBox[{"Pp", "*", "ppprimeBrem"}]}]}], "}"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Differential", " ", "splitting", " ", "probability"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"DifferentialSplittingProbabilityScalar", "[", 
      RowBox[{
      "mp_", ",", "z_", ",", "pT_", ",", "mS_", ",", "gSNN_", ",", "Pp_"}], 
      "]"}], "=", 
     RowBox[{
      RowBox[{"Simplify", "[", 
       RowBox[{"(", 
        RowBox[{
         FractionBox["1", 
          RowBox[{"16", "*", 
           SuperscriptBox["Pi", "2"], "*", "z"}]], 
         FractionBox["1", 
          RowBox[{"4", "*", "Pp", "*", "EpprimeBrem"}]], "*", 
         FractionBox["MScalarBremSquared", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"EpprimeBrem", "+", "ESbrem", "-", "Pp"}], ")"}], "2"]]}],
         ")"}], "]"}], "/.", 
      RowBox[{"{", " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["mp", "2"], "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["Pp", "2"]}]}], ")"}], " ", "\[Rule]", 
        RowBox[{"2", "*", 
         SuperscriptBox["Pp", "2"]}]}], "}"}]}]}], 
    RowBox[{"(*", 
     RowBox[{"/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         SuperscriptBox["mp", "2"], "+", 
         RowBox[{"2", " ", 
          SuperscriptBox["Pp", "2"], " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"z", "-", "1"}], ")"}], "2"]}], "+", 
         SuperscriptBox["pT", "2"]}], "\[Rule]", 
        RowBox[{"2", "*", 
         SuperscriptBox["Pp", "2"], 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"z", "-", "1"}], ")"}], "2"]}]}], "}"}]}], "*)"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Do", "[", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
     "Producing", " ", "normalized", " ", "distribution", " ", "and", " ", 
      "normalization", " ", 
      RowBox[{"(", 
       RowBox[{"==", 
        RowBox[{"total", " ", "flux"}]}], ")"}]}], "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "eminabs", ",", "emaxabs", ",", "pbeam", ",", "ptmax", ",", "norm", 
         ",", 
         RowBox[{"(*", 
          RowBox[{"distr", ","}], "*)"}], "normdata"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"pbeam", "=", 
         RowBox[{"EmaxFacility", "[", "Facility", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"eminabs", "=", 
         RowBox[{"ELLPminBrem", "[", "Facility", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"emaxabs", "=", 
         RowBox[{
          RowBox[{"zMaxBrem", "[", "Facility", "]"}], "*", "pbeam"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"ptmax", "=", 
         RowBox[{"pTmaxBrem", "[", "Facility", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"DoubleDistrBremNonNormalized", "[", 
          RowBox[{
          "mV_", ",", "\[Theta]V_", ",", "EV_", ",", "\"\<Scalar\>\"", ",", 
           "Facility"}], "]"}], "=", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"eminabs", "<=", "EV"}], 
            RowBox[{"(*", 
             RowBox[{"<=", 
              RowBox[{"ELLPmaxBrem", "[", 
               RowBox[{"Facility", ",", "mV", ",", "\[Theta]V"}], "]"}]}], 
             "*)"}], "&&", 
            RowBox[{"\[Theta]V", "<=", 
             RowBox[{"\[Theta]maxBrem", "[", "Facility", "]"}]}]}], ",", 
           RowBox[{"Evaluate", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"JacobianpTzToEV\[Theta]", "[", 
               RowBox[{"mV", ",", "EV", ",", "pbeam", ",", "\[Theta]V"}], 
               "]"}], "*", 
              RowBox[{"DifferentialSplittingProbabilityScalar", "[", 
               RowBox[{
                RowBox[{"mSM", "[", "\"\<p\>\"", "]"}], ",", 
                RowBox[{"zvp", "[", 
                 RowBox[{"EV", ",", "pbeam"}], "]"}], ",", 
                RowBox[{"pTv", "[", 
                 RowBox[{"mV", ",", "EV", ",", "\[Theta]V"}], "]"}], ",", 
                "mV", ",", "GSNN", ",", "pbeam"}], "]"}], "*", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"Facility", "==", "\"\<ESS\>\""}], ",", 
                RowBox[{"UnitStep", "[", 
                 RowBox[{"0.1", "-", 
                  RowBox[{"ApplicabilityParameter", "[", 
                   RowBox[{
                    RowBox[{"zvp", "[", 
                    RowBox[{"EV", ",", "pbeam"}], "]"}], ",", 
                    RowBox[{"pTv", "[", 
                    RowBox[{"mV", ",", "EV", ",", "\[Theta]V"}], "]"}], ",", 
                    "mV", ",", "pbeam", ",", 
                    RowBox[{"mSM", "[", "\"\<p\>\"", "]"}]}], "]"}]}], "]"}], 
                ",", "1."}], "]"}]}], ",", 
             SuperscriptBox["10", 
              RowBox[{"-", "90."}]]}], "]"}]}], "]"}]}], ";"}]}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"normdata", "=", 
         RowBox[{"ParallelTable", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"mV", ",", 
             RowBox[{"NIntegrate", "[", 
              RowBox[{
               RowBox[{"distr", "[", 
                RowBox[{"mV", ",", "\[Theta]V", ",", "EV"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"\[Theta]V", ",", "0", ",", 
                 RowBox[{"\[Theta]maxBrem", "[", "Facility", "]"}]}], "}"}], 
               ",", 
               RowBox[{"{", 
                RowBox[{"EV", ",", "eminabs", ",", 
                 RowBox[{"Max", "[", 
                  RowBox[{"eminabs", ",", 
                   RowBox[{"ELLPmaxBrem", "[", 
                    RowBox[{"Facility", ",", "mV", ",", "\[Theta]V"}], 
                    "]"}]}], "]"}]}], "}"}], ",", 
               RowBox[{"Method", "\[Rule]", "\"\<AdaptiveMonteCarlo\>\""}]}], 
              "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"mV", ",", "mVminFromBrem", ",", "mVmaxFromBrem", ",", 
             FractionBox[
              RowBox[{"(", 
               RowBox[{"mVmaxFromBrem", "-", "mVminFromBrem"}], ")"}], 
              "20"]}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"norm", "[", "mV_", "]"}], "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Interpolation", "[", 
            RowBox[{
             RowBox[{"normdata", "//", "Log"}], ",", 
             RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[", 
           RowBox[{"Log", "[", "mV", "]"}], "]"}], "//", "Exp"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"DoubleDistrBrem", "[", 
          RowBox[{
          "mV_", ",", "\[Theta]V_", ",", "EV_", ",", "\"\<Scalar\>\"", ",", 
           "Facility"}], "]"}], "=", 
         FractionBox[
          RowBox[{"distr", "[", 
           RowBox[{"mV", ",", "\[Theta]V", ",", "EV"}], "]"}], 
          RowBox[{"norm", "[", "mV", "]"}]]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"NormalizationBremScalar", "[", 
          RowBox[{"mV_", ",", "Facility"}], "]"}], "=", 
         RowBox[{
          RowBox[{"norm", "[", "mV", "]"}], "*", 
          RowBox[{"BremFormFactorSquared", "[", "mV", "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Export", "[", 
         RowBox[{
          RowBox[{"FileNameJoin", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"NotebookDirectory", "[", "]"}], ",", 
             "\"\<phenomenology/Scalar/Production \
probabilities/Pbrem.m\>\""}], "}"}], "]"}], ",", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"Facility", ",", 
              RowBox[{"NormalizationBremScalar", "[", 
               RowBox[{"mS", ",", "Facility"}], "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"Facility", ",", "FacilitiesList"}], "}"}]}], "]"}], 
          ",", "\"\<MX\>\""}], "]"}]}], "*)"}], "\[IndentingNewLine]", "]"}], 
     "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{"Facility", ",", "FacilitiesList"}], "}"}]}], "]"}], 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.913807780433511*^9, 3.913807794526042*^9}, {
  3.9138078261790705`*^9, 3.913807896103809*^9}, {3.9138079453065605`*^9, 
  3.9138080066845584`*^9}, {3.913808038839263*^9, 3.9138081235712795`*^9}, {
  3.9138081800976663`*^9, 3.913808200218096*^9}, {3.913808244386348*^9, 
  3.91380827633218*^9}, {3.913808310369869*^9, 3.913808311010066*^9}, {
  3.9138083857599535`*^9, 3.91380840247072*^9}, {3.913808441154157*^9, 
  3.913808441259919*^9}, {3.913827369234762*^9, 3.91382737425508*^9}, {
  3.91405495979826*^9, 3.914055000747855*^9}, {3.914055453814864*^9, 
  3.9140554561820908`*^9}, {3.914055525850032*^9, 3.914055555472018*^9}, {
  3.9148329904693*^9, 3.91483300933533*^9}, {3.917162015271364*^9, 
  3.9171620152753925`*^9}, {3.917164325898129*^9, 3.917164331190135*^9}},
 CellTags->"Evaluation",
 CellLabel->
  "In[1070]:=",ExpressionUUID->"95b0b7c6-bc89-4a24-aed8-0f38fa0b1f5d"],

Cell[BoxData[
 FormBox["\<\"Applicability parameter (must be << 1):\"\>", 
  TraditionalForm]], "Print",
 CellChangeTimes->{3.9302115245396357`*^9, 3.9308227566140842`*^9},
 CellTags->"Evaluation",
 CellLabel->
  "Durante la evaluaci\[OAcute]n de \
In[1070]:=",ExpressionUUID->"b2c50bb1-78a2-4b29-b7a8-c815c814fe95"],

Cell[BoxData[
 FormBox[
  FractionBox[
   RowBox[{
    RowBox[{
     SuperscriptBox["mp", "2"], " ", 
     SuperscriptBox["z", "2"]}], "-", 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["mX", "2"], " ", 
      RowBox[{"(", 
       RowBox[{"z", "-", "1"}], ")"}]}], ")"}], "+", 
    SuperscriptBox["pT", "2"]}], 
   RowBox[{"4", " ", 
    SuperscriptBox["Pp", "2"], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"z", "-", "1"}], ")"}], "2"], " ", "z"}]], 
  TraditionalForm]], "Output",
 CellChangeTimes->{3.930211524689093*^9, 3.930822756640828*^9},
 CellTags->"Evaluation",
 CellLabel->
  "Out[1076]=",ExpressionUUID->"47ba5612-5e44-4d09-ab6c-f99e2fb7ae9b"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["MCPs", "Chapter",
 CellChangeTimes->{{3.9133677446759033`*^9, 3.9133678076549654`*^9}},
 CellTags->
  "Evaluation",ExpressionUUID->"6abe80dc-cac1-4951-a70c-ab85c8903212"],

Cell[CellGroupData[{

Cell["Relevant processes", "Section",
 CellChangeTimes->{{3.913268643168833*^9, 3.9132686454263844`*^9}},
 CellTags->
  "Evaluation",ExpressionUUID->"4f876c3d-1254-4870-97d6-e76e6b07ff3f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"LLPname", "=", "\"\<MCP\>\""}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Only", " ", "decays", " ", "are", " ", 
     RowBox[{"listed", ".", " ", "Drell"}]}], "-", 
    RowBox[{"Yan", " ", "is", " ", "computed", " ", "externally", " ", 
     RowBox[{"(", 
      RowBox[{"MadGraph", "+", "pythia"}], ")"}]}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ProcessesListAll", "[", "LLPname", "]"}], "=", 
    RowBox[{"{", 
     RowBox[{
     "\"\<Pi0\>\"", ",", "\"\<Eta\>\"", ",", "\"\<Phi\>\"", ",", 
      "\"\<JPsi\>\"", ",", "\"\<Rho0\>\"", ",", "\"\<Omega\>\"", ",", 
      "\"\<Upsilon\>\""}], "}"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Topology", " ", "of", " ", "the", " ", "process"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"ProductionType", "[", 
         RowBox[{"LLPname", ",", "#1"}], "]"}], "=", "#2"}], ")"}], "&"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"ProcessesListAll", "[", "LLPname", "]"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{"\"\<Decay\>\"", ",", 
         RowBox[{"Length", "[", 
          RowBox[{"ProcessesListAll", "[", "LLPname", "]"}], "]"}]}], "]"}]}],
       "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Particle", " ", 
     RowBox[{"content", ":", " ", 
      RowBox[{"mother", " ", "particle"}]}]}], ",", " ", 
    RowBox[{"decay", " ", "products"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MapThread", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"ReactionProductsList", "[", 
        RowBox[{"LLPname", ",", "#1"}], "]"}], "=", "#2"}], ")"}], "&"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"ProcessesListAll", "[", "LLPname", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "\"\<Pi0\>\"", ",", "\"\<photon\>\"", ",", "LLPname", ",", 
          "LLPname"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
         "\"\<Eta\>\"", ",", "\"\<photon\>\"", ",", "LLPname", ",", 
          "LLPname"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"\"\<Phi\>\"", ",", "LLPname", ",", "LLPname"}], "}"}], ",", 
        
        RowBox[{"{", 
         RowBox[{"\"\<JPsi\>\"", ",", "LLPname", ",", "LLPname"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"\"\<Rho0\>\"", ",", "LLPname", ",", "LLPname"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"\"\<Omega\>\"", ",", "LLPname", ",", "LLPname"}], "}"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"\"\<Upsilon\>\"", ",", "LLPname", ",", "LLPname"}], "}"}]}],
        "}"}]}], "}"}]}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.913372672476434*^9, 3.913372673613281*^9}, {
   3.9133727579791746`*^9, 3.913372809675759*^9}, {3.913372873308109*^9, 
   3.913372878452074*^9}, {3.913372941633641*^9, 3.913373013823183*^9}, {
   3.913373826131261*^9, 3.913373868451662*^9}, {3.9133739066364*^9, 
   3.913373945657801*^9}, {3.913374002546357*^9, 3.913374005206761*^9}, 
   3.913394583225469*^9, {3.913395240305252*^9, 3.913395240309671*^9}, {
   3.915438811281021*^9, 3.915438811332352*^9}, 3.915440189959916*^9, {
   3.915440798120658*^9, 3.91544085478469*^9}, 3.915440966116959*^9},
 CellTags->"Evaluation",
 CellLabel->
  "In[1082]:=",ExpressionUUID->"6daf334b-bcc0-4439-b3da-8dbd64e4d545"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Matrix elements of 3-body decays", "Section",
 CellChangeTimes->{{3.9133717120129466`*^9, 3.913371715503309*^9}},
 CellTags->
  "Evaluation",ExpressionUUID->"4564a7c0-aa3b-445e-81ec-851b73c8ebfb"],

Cell[CellGroupData[{

Cell[TextData[{
 "Decay of ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox["\[Pi]", "0"], "/", "\[Eta]"}], TraditionalForm]],
  ExpressionUUID->"e5dd687f-6a1b-4315-8c87-11255963544e"]
}], "Subsection",
 CellChangeTimes->{{3.8921984480094795`*^9, 3.8921984526568637`*^9}},
 CellTags->
  "Evaluation",ExpressionUUID->"eeca7a08-c73f-42d8-a8cd-007897690c92"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"MmesonDecayMCP3Body", "=", 
   RowBox[{
    RowBox[{
     FractionBox[
      RowBox[{"LeviCivita", "[", 
       RowBox[{"\[Mu]", ",", "\[Nu]", ",", "\[Alpha]", ",", "\[Beta]"}], 
       "]"}], 
      RowBox[{"ScalarProduct", "[", 
       RowBox[{
        RowBox[{"k2", "+", "k3"}], ",", 
        RowBox[{"k2", "+", "k3"}]}], "]"}]], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"FV", "[", 
         RowBox[{"k1", ",", "\[Mu]"}], "]"}], "*", 
        RowBox[{"PolarizationVector", "[", 
         RowBox[{"k1", ",", "\[Nu]"}], "]"}]}], "-", 
       RowBox[{
        RowBox[{"FV", "[", 
         RowBox[{"k1", ",", "\[Nu]"}], "]"}], "*", 
        RowBox[{"PolarizationVector", "[", 
         RowBox[{"k1", ",", "\[Mu]"}], "]"}]}]}], ")"}], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         RowBox[{"FV", "[", 
          RowBox[{
           RowBox[{"k2", "+", "k3"}], ",", "\[Alpha]"}], "]"}]}], "*", 
        RowBox[{"MT", "[", 
         RowBox[{"\[Beta]", ",", "\[Delta]"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"FV", "[", 
         RowBox[{
          RowBox[{"k2", "+", "k3"}], ",", "\[Beta]"}], "]"}], "*", 
        RowBox[{"MT", "[", 
         RowBox[{"\[Alpha]", ",", "\[Delta]"}], "]"}]}]}], ")"}], 
     RowBox[{
      RowBox[{"SpinorVBar", "[", 
       RowBox[{"k2", ",", "m2"}], "]"}], ".", 
      RowBox[{"GA", "[", "\[Delta]", "]"}], ".", 
      RowBox[{"SpinorU", "[", 
       RowBox[{"k3", ",", "m3"}], "]"}]}]}], "//", "Contract"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MmesonDecayMCP3BodyStar", "=", 
   RowBox[{"MmesonDecayMCP3Body", "//", "ComplexConjugate"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MmesonDecayMCP3BodySquaredTemp", "=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"Simplify", "[", 
       RowBox[{"Expand", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"DoPolarizationSums", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"FermionSpinSum", "[", 
              RowBox[{"MmesonDecayMCP3Body", "*", "MmesonDecayMCP3BodyStar"}],
               "]"}], "/.", 
             RowBox[{"DiracTrace", "\[Rule]", "TR"}]}], ",", "k1"}], "]"}], "//",
           "Contract"}], "//", "Simplify"}], "]"}], "]"}], "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"ScalarProduct", "[", 
          RowBox[{"k", ",", "k"}], "]"}], "\[Rule]", "ProductKK"}], ",", 
        RowBox[{
         RowBox[{"ScalarProduct", "[", 
          RowBox[{"k1", ",", "k1"}], "]"}], "\[Rule]", "ProductK1K1"}], ",", 
        RowBox[{
         RowBox[{"ScalarProduct", "[", 
          RowBox[{"k2", ",", "k2"}], "]"}], "\[Rule]", "ProductK2K2"}], ",", 
        RowBox[{
         RowBox[{"ScalarProduct", "[", 
          RowBox[{"k3", ",", "k3"}], "]"}], "\[Rule]", "ProductK3K3"}]}], 
       "}"}]}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"ScalarProduct", "[", 
         RowBox[{"k", ",", "k1"}], "]"}], "\[Rule]", " ", 
        "ProductKK1energy"}], ",", 
       RowBox[{
        RowBox[{"ScalarProduct", "[", 
         RowBox[{"k2", ",", "k3"}], "]"}], "\[Rule]", "ProductK2K3energy"}], 
       ",", 
       RowBox[{
        RowBox[{"ScalarProduct", "[", 
         RowBox[{"k1", ",", "k3"}], "]"}], "\[Rule]", "ProductK1K3energy"}], 
       ",", 
       RowBox[{
        RowBox[{"ScalarProduct", "[", 
         RowBox[{"k", ",", "k3"}], "]"}], "\[Rule]", "ProductKK3energy"}], 
       ",", 
       RowBox[{
        RowBox[{"ScalarProduct", "[", 
         RowBox[{"k1", ",", "k2"}], "]"}], "\[Rule]", "ProductK1K2energy"}], 
       ",", 
       RowBox[{
        RowBox[{"ScalarProduct", "[", 
         RowBox[{"k", ",", "k2"}], "]"}], "\[Rule]", "ProductKK2energy"}]}], 
      "}"}]}], ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Msquared3Body", "[", 
    RowBox[{
    "LLPname", ",", "\"\<Pi0\>\"", ",", "mLLP_", ",", "E1_", ",", "E3_"}], 
    "]"}], "=", 
   RowBox[{
    RowBox[{"MmesonDecayMCP3BodySquaredTemp", "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"m", "\[Rule]", 
        RowBox[{"mSM", "[", "\"\<Pi0\>\"", "]"}]}], ",", 
       RowBox[{"m1", "\[Rule]", "0"}], ",", 
       RowBox[{"m2", "\[Rule]", "mLLP"}], ",", 
       RowBox[{"m3", "\[Rule]", "mLLP"}]}], "}"}]}], "//", "Simplify"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Msquared3Body", "[", 
    RowBox[{
    "LLPname", ",", "\"\<Eta\>\"", ",", "mLLP_", ",", "E1_", ",", "E3_"}], 
    "]"}], "=", 
   RowBox[{
    RowBox[{"MmesonDecayMCP3BodySquaredTemp", "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"m", "\[Rule]", 
        RowBox[{"mSM", "[", "\"\<Eta\>\"", "]"}]}], ",", 
       RowBox[{"m1", "\[Rule]", "0"}], ",", 
       RowBox[{"m2", "\[Rule]", "mLLP"}], ",", 
       RowBox[{"m3", "\[Rule]", "mLLP"}]}], "}"}]}], "//", "Simplify"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"LLPname", "//", "Clear"}]}], "Input",
 CellChangeTimes->{{3.89219927515915*^9, 3.8921992855451384`*^9}, {
  3.892199548501564*^9, 3.8921996963442507`*^9}, {3.892199751414859*^9, 
  3.892199848465343*^9}, {3.8921998892385187`*^9, 3.89220038025453*^9}, {
  3.8922199580041428`*^9, 3.8922199585793204`*^9}, {3.892220871236271*^9, 
  3.892220883878686*^9}, {3.892268785788042*^9, 3.892268790620195*^9}, {
  3.9133717523578286`*^9, 3.9133718261333055`*^9}, {3.913371892367079*^9, 
  3.913371892506214*^9}, {3.91337265221241*^9, 3.913372663369148*^9}, {
  3.913372714198771*^9, 3.913372755847519*^9}, {3.9133945944532747`*^9, 
  3.913394596046309*^9}, {3.9154388113424835`*^9, 3.9154388113618507`*^9}},
 CellTags->"Evaluation",
 CellLabel->
  "In[1086]:=",ExpressionUUID->"6c06cb31-19e9-4bf7-8220-6ba1b3081bb2"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Common definitions", "Chapter",
 CellChangeTimes->{{3.9133713104176497`*^9, 3.91337131285549*^9}},
 CellTags->
  "Evaluation",ExpressionUUID->"3fa2b705-4843-44b9-81de-a4a582e96a5b"],

Cell[CellGroupData[{

Cell["Threshold mass for all processes", "Section",
 CellChangeTimes->{{3.913395307783634*^9, 3.9133953168209066`*^9}},
 CellTags->
  "Evaluation",ExpressionUUID->"b447eeb3-44b8-4ee7-a162-5aca9ea00874"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "The", " ", "list", " ", "with", " ", "all", " ", "particular", " ", 
    "LLPs"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"LLPlist", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"Keys", "[", 
        RowBox[{"DownValues", "@", "ProcessesListAll"}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "1", ",", "1"}], "]"}], "]"}], "//", "Sort"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"The", " ", "list", " ", "where", " ", "HNL"}], "-", "mixing", 
      "-", "e"}], ",", " ", 
     RowBox[{"HNL", "-", "mixing", "-", "mu"}], ",", " ", 
     RowBox[{"HNL", "-", "mixing", "-", 
      RowBox[{
      "tau", " ", "is", " ", "replaced", " ", "with", " ", "single", " ", 
       "HNL"}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"LLPlistEffective", "=", 
     RowBox[{
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"Select", "[", 
         RowBox[{"LLPlist", ",", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"StringContainsQ", "[", 
             RowBox[{"#", ",", "\"\<HNL\>\""}], "]"}]}], "&"}]}], "]"}], ",", 
        
        RowBox[{"{", "\"\<HNL\>\"", "}"}]}], "]"}], "//", "Sort"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Maximal", " ", "LLP", " ", "mass", " ", "for", " ", "the", " ", 
     "implemented", " ", "production", " ", "channels"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Do", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"partlist", ",", "mother", ",", "nfips"}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"partlist", "=", 
           RowBox[{"ReactionProductsList", "[", 
            RowBox[{"LLP", ",", "mode"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"mother", "=", 
           RowBox[{"partlist", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{
            "If", " ", "the", " ", "production", " ", "is", " ", "via", " ", 
             "mixing", " ", "or", " ", "the", " ", "mother", " ", "particle", 
             " ", "is", " ", "proton"}], ",", " ", 
            RowBox[{
            "no", " ", "robust", " ", "estimate", " ", "of", " ", "the", " ", 
             "threshold", " ", "exists"}]}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"Length", "[", "partlist", "]"}], "==", "2"}], "||", 
             RowBox[{"mother", "==", "\"\<p\>\""}]}], ",", 
            RowBox[{
             RowBox[{"MaxMass", "[", 
              RowBox[{"LLP", ",", "Facility", ",", "mode"}], "]"}], "=", 
             RowBox[{"Min", "[", 
              RowBox[{"4.", ",", 
               RowBox[{
                RowBox[{"EcmFacility", "[", "Facility", "]"}], "-", 
                RowBox[{"2", "*", "0.938"}]}]}], "]"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{
              "If", " ", "the", " ", "mother", " ", "particle", " ", "cannot",
                " ", "be", " ", "produced", " ", "at", " ", "the", " ", 
               "given", " ", "facility"}], ",", " ", 
              RowBox[{
               RowBox[{"then", " ", "MaxMass"}], " ", "=", " ", "0"}]}], 
             "*)"}], "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"IfSMatFacility", "[", 
                 RowBox[{"mother", ",", "Facility"}], "]"}], "==", "0"}], ",", 
               RowBox[{
                RowBox[{"MaxMass", "[", 
                 RowBox[{"LLP", ",", "Facility", ",", "mode"}], "]"}], "=", 
                "0."}]}], "]"}], ";", "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{
               RowBox[{
               "If", " ", "it", " ", "may", " ", "be", " ", "produced"}], ",",
                " ", 
               RowBox[{
               "then", " ", "calculating", " ", "the", " ", "max", " ", 
                "mass", " ", "as", " ", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   SubscriptBox["m", "mother"], "-", 
                   RowBox[{"\[Sum]", 
                    SubscriptBox["m", 
                    RowBox[{"SM", " ", "products"}]]}]}], ")"}], "/", 
                 SubscriptBox["n", 
                  RowBox[{"LLPs", ",", 
                   RowBox[{"per", " ", "decay"}]}]]}]}]}], "*)"}], 
             "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"IfSMatFacility", "[", 
                 RowBox[{"mother", ",", "Facility"}], "]"}], "!=", "0"}], ",",
                "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"nfips", "=", 
                 RowBox[{
                  RowBox[{"Select", "[", 
                   RowBox[{"partlist", ",", 
                    RowBox[{
                    RowBox[{"#", "==", "LLP"}], "&"}]}], "]"}], "//", 
                  "Length"}]}], ";", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"MaxMass", "[", 
                  RowBox[{"LLP", ",", "Facility", ",", "mode"}], "]"}], "=", 
                 RowBox[{
                  RowBox[{"mSM", "[", 
                   RowBox[{"partlist", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], "-", 
                  RowBox[{"Sum", "[", 
                   RowBox[{
                    RowBox[{"mSM", "[", 
                    RowBox[{"partlist", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "2", ",", 
                    RowBox[{
                    RowBox[{"Length", "[", "partlist", "]"}], "-", 
                    "nfips"}]}], "}"}]}], "]"}]}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"nfips", ">", "1"}], ",", 
                  RowBox[{
                   RowBox[{"MaxMass", "[", 
                    RowBox[{"LLP", ",", "Facility", ",", "mode"}], "]"}], "=", 
                   FractionBox[
                    RowBox[{"MaxMass", "[", 
                    RowBox[{"LLP", ",", "Facility", ",", "mode"}], "]"}], 
                    "nfips"]}]}], "]"}], ";"}]}], "\[IndentingNewLine]", 
              "]"}]}]}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"mode", ",", 
         RowBox[{"ProcessesListAll", "[", "LLP", "]"}]}], "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"Facility", ",", "FacilitiesList"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"LLP", ",", "LLPlist"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
   
   RowBox[{"(*", 
    RowBox[{"___", "___", "___", "___", "___"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"For", " ", "averaged", " ", "HNL", " ", "production"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"___", "___", "___", "___", "___"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Max", " ", "mass", " ", "for", " ", "averaged", " ", "production", " ", 
     "from", " ", "B"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"MaxMass", "[", 
       RowBox[{"HNL", ",", "Facility", ",", "\"\<B\>\""}], "]"}], "=", 
      RowBox[{"Max", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"MaxMass", "[", 
          RowBox[{"HNL", ",", "Facility", ",", "#"}], "]"}], "&"}], "/@", 
        RowBox[{"{", 
         RowBox[{
         "\"\<B-3-body\>\"", ",", "\"\<Bc\>\"", ",", "\"\<B-2-body\>\""}], 
         "}"}]}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"HNL", ",", "ListHNLs"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"Facility", ",", "FacilitiesList"}], "}"}]}], "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Max", " ", "mass", " ", "for", " ", "averaged", " ", "production", " ", 
     "from", " ", "D"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"Do", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"prl", "=", 
       RowBox[{"Select", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "\"\<D-3-body\>\"", ",", "\"\<D-2-body\>\"", ",", 
           "\"\<\[Tau]-2-body\>\"", ",", "\"\<\[Tau]-3-body\>\""}], "}"}], 
         ",", 
         RowBox[{
          RowBox[{
           RowBox[{"MemberQ", "[", 
            RowBox[{
             RowBox[{"ProcessesListAll", "[", "HNL", "]"}], ",", "#"}], "]"}],
            "==", "True"}], "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"MaxMass", "[", 
        RowBox[{"HNL", ",", "Facility", ",", "\"\<D\>\""}], "]"}], "=", 
       RowBox[{"Max", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"MaxMass", "[", 
           RowBox[{"HNL", ",", "Facility", ",", "#"}], "]"}], "&"}], "/@", 
         "prl"}], "]"}]}]}], ",", 
     RowBox[{"{", 
      RowBox[{"HNL", ",", "ListHNLs"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"Facility", ",", "FacilitiesList"}], "}"}]}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.913371313427085*^9, 3.9133714507945695`*^9}, {
   3.913375020337415*^9, 3.913375035879208*^9}, {3.913394836729551*^9, 
   3.913394847769238*^9}, {3.913395240316249*^9, 3.913395240319749*^9}, 
   3.9133952966700745`*^9, {3.9133953811317396`*^9, 3.913395413211723*^9}, {
   3.913397900112206*^9, 3.91339792978276*^9}, {3.9134359284587507`*^9, 
   3.913435930238897*^9}, {3.913439013534738*^9, 3.913439105703475*^9}, {
   3.915438811377933*^9, 3.915438811442811*^9}, 3.9154409661222067`*^9, {
   3.916286050966194*^9, 3.9162860586644754`*^9}, {3.916286109069848*^9, 
   3.916286118427676*^9}},
 CellTags->"Evaluation",
 CellLabel->
  "In[1092]:=",ExpressionUUID->"bedfb77e-9a79-45eb-a4fb-5477f78b7dda"]
}, Open  ]],

Cell[CellGroupData[{

Cell["List of facility-specific channels", "Section",
 CellChangeTimes->{{3.913395325621219*^9, 3.9133953277871695`*^9}, {
  3.9133954188528185`*^9, 3.913395429342928*^9}},
 CellTags->
  "Evaluation",ExpressionUUID->"4284abbf-6507-47bb-af57-77152272f71f"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Selecting", " ", "only", " ", "those", " ", "channels", " ", "for", " ", 
    RowBox[{"which", ":"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "1.", " ", "Is", " ", "kinematically", " ", "possible", " ", "to", " ", 
    "produce", " ", "LLP", " ", "at", " ", "the", " ", "given", " ", 
    "facility", " ", 
    RowBox[{"(", 
     RowBox[{"==", 
      RowBox[{
      "max", " ", "LLP", " ", "mass", " ", "at", " ", "the", " ", "given", 
       " ", "facility", " ", "is"}], " ", ">", " ", "0"}], ")"}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "2.", " ", "There", " ", "is", " ", "available", " ", "mother", " ", 
    "particle", " ", "distribution"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Do", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"proc", ",", "mother"}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"StringContainsQ", "[", 
             RowBox[{"LLP", ",", "\"\<HNL\>\""}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{"First", ",", " ", 
             RowBox[{
             "filtering", " ", "to", " ", "processes", " ", "which", " ", 
              "are", " ", "kinematically", " ", "possible"}]}], "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"ProcessesListFacilityTemp", "[", 
              RowBox[{"LLP", ",", "Facility"}], "]"}], "=", 
             RowBox[{"Select", "[", 
              RowBox[{
               RowBox[{"ProcessesListAll", "[", "LLP", "]"}], ",", 
               RowBox[{
                RowBox[{
                 RowBox[{"MaxMass", "[", 
                  RowBox[{"LLP", ",", "Facility", ",", "#"}], "]"}], ">", 
                 "0"}], "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{"Second", ",", " ", 
              RowBox[{
              "checking", " ", "if", " ", "the", " ", "mother", " ", 
               "distribution", " ", "is", " ", "present"}]}], "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ProcessesListFacility", "[", 
              RowBox[{"LLP", ",", "Facility"}], "]"}], "=", 
             RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"Do", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"proc", "=", 
                RowBox[{
                 RowBox[{"ProcessesListFacilityTemp", "[", 
                  RowBox[{"LLP", ",", "Facility"}], "]"}], "[", 
                 RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
               RowBox[{"mother", "=", 
                RowBox[{
                 RowBox[{"ReactionProductsList", "[", 
                  RowBox[{"LLP", ",", "proc"}], "]"}], "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
               RowBox[{"(*", 
                RowBox[{"Specific", " ", "condition", " ", "is", " ", "to"}], 
                " ", "*)"}], "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Select", "[", 
                   RowBox[{"sortedDataPairs", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "==", "Facility"}], "&&", 
                    
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"mother", ",", 
                    RowBox[{"SimilarParticle", "[", 
                    RowBox[{"Facility", ",", "mother"}], "]"}]}], "}"}], ",", 
                    
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "&"}]}], "]"}],
                   "!=", 
                  RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"ProcessesListFacility", "[", 
                   RowBox[{"LLP", ",", "Facility"}], "]"}], "=", 
                  RowBox[{"Join", "[", 
                   RowBox[{
                    RowBox[{"ProcessesListFacility", "[", 
                    RowBox[{"LLP", ",", "Facility"}], "]"}], ",", 
                    RowBox[{"{", "proc", "}"}]}], "]"}]}]}], 
                "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
              ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "1", ",", 
                RowBox[{"Length", "[", 
                 RowBox[{"ProcessesListFacilityTemp", "[", 
                  RowBox[{"LLP", ",", "Facility"}], "]"}], "]"}], ",", "1"}], 
               "}"}]}], "]"}]}]}], "\[IndentingNewLine]", "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"StringContainsQ", "[", 
            RowBox[{"LLP", ",", "\"\<HNL\>\""}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"ProcessesListFacilityTemp", "[", 
              RowBox[{"LLP", ",", "Facility"}], "]"}], "=", 
             RowBox[{"Select", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                "\"\<W\>\"", ",", "\"\<K\>\"", ",", "\"\<D\>\"", ",", 
                 "\"\<B\>\"", ",", "\"\<mu\>\"", ",", "\"\<PiCharged\>\""}], 
                "}"}], ",", 
               RowBox[{
                RowBox[{
                 RowBox[{"MaxMass", "[", 
                  RowBox[{"LLP", ",", "Facility", ",", "#"}], "]"}], ">", 
                 "0"}], "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ProcessesListFacility", "[", 
              RowBox[{"LLP", ",", "Facility"}], "]"}], "=", 
             RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"Do", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"proc", "=", 
                RowBox[{
                 RowBox[{"ProcessesListFacilityTemp", "[", 
                  RowBox[{"LLP", ",", "Facility"}], "]"}], "[", 
                 RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
               RowBox[{"mother", "=", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"proc", "==", "\"\<D\>\""}], ",", "\"\<tau\>\"", 
                  ",", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"proc", "==", "\"\<B\>\""}], ",", "\"\<Bplus\>\"",
                     ",", 
                    RowBox[{
                    RowBox[{"ReactionProductsList", "[", 
                    RowBox[{"LLP", ",", "proc"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"(*", 
                RowBox[{"Specific", " ", "condition", " ", "is", " ", "to"}], 
                " ", "*)"}], "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Select", "[", 
                   RowBox[{"sortedDataPairs", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "==", "Facility"}], "&&", 
                    
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"mother", ",", 
                    RowBox[{"SimilarParticle", "[", 
                    RowBox[{"Facility", ",", "mother"}], "]"}]}], "}"}], ",", 
                    
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "&"}]}], "]"}],
                   "!=", 
                  RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"ProcessesListFacility", "[", 
                   RowBox[{"LLP", ",", "Facility"}], "]"}], "=", 
                  RowBox[{"Join", "[", 
                   RowBox[{
                    RowBox[{"ProcessesListFacility", "[", 
                    RowBox[{"LLP", ",", "Facility"}], "]"}], ",", 
                    RowBox[{"{", "proc", "}"}]}], "]"}]}]}], 
                "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
              ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "1", ",", 
                RowBox[{"Length", "[", 
                 RowBox[{"ProcessesListFacilityTemp", "[", 
                  RowBox[{"LLP", ",", "Facility"}], "]"}], "]"}], ",", "1"}], 
               "}"}]}], "]"}]}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{"LLP", ",", "LLPlist"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"Facility", ",", "FacilitiesList"}], "}"}]}], "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"ProcessesListFacility", "[", 
       RowBox[{"\"\<HNL\>\"", ",", "Facility"}], "]"}], "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"ProcessesListFacility", "[", 
           RowBox[{"LLP", ",", "Facility"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"LLP", ",", "ListHNLs"}], "}"}]}], "]"}], "//", 
        "Flatten"}], "//", "DeleteDuplicates"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"Facility", ",", "FacilitiesList"}], "}"}]}], "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Print", "[", "\"\<List of all implemented channels:\>\"", "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"TabProcesses", "=", 
    RowBox[{"Flatten", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"LLP", ",", "Facility", ",", 
          RowBox[{"ProcessesListFacility", "[", 
           RowBox[{"LLP", ",", "Facility"}], "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"LLP", ",", "LLPlist"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Facility", ",", "FacilitiesList"}], "}"}]}], "]"}], ",", 
      "1"}], "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.9133954360421247`*^9, 3.913395544174184*^9}, {
   3.913395592097353*^9, 3.913395648154515*^9}, {3.913395750817597*^9, 
   3.913395900441537*^9}, {3.913396047313565*^9, 3.913396149689185*^9}, {
   3.9133962590984945`*^9, 3.9133963218572245`*^9}, {3.91339645196734*^9, 
   3.9133964724981775`*^9}, {3.913396508788177*^9, 3.9133965332582307`*^9}, {
   3.913396564847192*^9, 3.91339656779128*^9}, {3.913396615997447*^9, 
   3.913396642588444*^9}, {3.913396696431204*^9, 3.913396729008161*^9}, {
   3.91339679050718*^9, 3.913396791218513*^9}, {3.913396960308601*^9, 
   3.913397034350453*^9}, {3.913397088000754*^9, 3.913397116799147*^9}, {
   3.9133971887406898`*^9, 3.9133972523632855`*^9}, {3.913397557609911*^9, 
   3.913397588797212*^9}, {3.913400626535961*^9, 3.91340063590666*^9}, {
   3.913435914863307*^9, 3.913435925033703*^9}, {3.9134389325557127`*^9, 
   3.913438985067481*^9}, {3.9137082020444603`*^9, 3.9137082235651765`*^9}, 
   3.9148330276453466`*^9, {3.9148355014178915`*^9, 3.9148355024893517`*^9}, {
   3.9149088144709597`*^9, 3.9149088171519794`*^9}, {3.915438811459031*^9, 
   3.915438811568327*^9}, {3.9154409661287985`*^9, 3.915440966133808*^9}},
 CellTags->"Evaluation",
 CellLabel->
  "In[1097]:=",ExpressionUUID->"ce721738-ca6a-40b8-920b-aaf912e39c22"],

Cell[BoxData[
 FormBox["\<\"List of all implemented channels:\"\>", 
  TraditionalForm]], "Print",
 CellChangeTimes->{3.930211535065086*^9, 3.930822767156753*^9},
 CellTags->"Evaluation",
 CellLabel->
  "Durante la evaluaci\[OAcute]n de \
In[1097]:=",ExpressionUUID->"126c85d9-072b-4783-b558-ea9f91a77c14"],

Cell[BoxData[
 FormBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"\<\"ALP-fermion\"\>", "\<\"ESS\"\>", 
      RowBox[{"{", "}"}]},
     {"\<\"ALP-fermion\"\>", "\<\"FCC-hh\"\>", 
      RowBox[{"{", 
       RowBox[{"\<\"B\"\>", ",", "\<\"Pi0\"\>", ",", "\<\"Eta\"\>", 
        ",", "\<\"EtaPr\"\>"}], "}"}]},
     {"\<\"ALP-fermion\"\>", "\<\"FermilabBD\"\>", 
      RowBox[{"{", 
       RowBox[{"\<\"B\"\>", ",", "\<\"Pi0\"\>", ",", "\<\"Eta\"\>", 
        ",", "\<\"EtaPr\"\>"}], "}"}]},
     {"\<\"ALP-fermion\"\>", "\<\"LHC\"\>", 
      RowBox[{"{", 
       RowBox[{"\<\"B\"\>", ",", "\<\"Pi0\"\>", ",", "\<\"Eta\"\>", 
        ",", "\<\"EtaPr\"\>"}], "}"}]},
     {"\<\"ALP-fermion\"\>", "\<\"Serpukhov\"\>", 
      RowBox[{"{", 
       RowBox[{"\<\"Pi0\"\>", ",", "\<\"Eta\"\>", ",", "\<\"EtaPr\"\>"}], 
       "}"}]},
     {"\<\"ALP-fermion\"\>", "\<\"SPS\"\>", 
      RowBox[{"{", 
       RowBox[{"\<\"B\"\>", ",", "\<\"Pi0\"\>", ",", "\<\"Eta\"\>", 
        ",", "\<\"EtaPr\"\>"}], "}"}]},
     {"\<\"ALP-gluon\"\>", "\<\"ESS\"\>", 
      RowBox[{"{", "}"}]},
     {"\<\"ALP-gluon\"\>", "\<\"FCC-hh\"\>", 
      RowBox[{"{", 
       RowBox[{"\<\"B\"\>", ",", "\<\"Pi0\"\>", ",", "\<\"Eta\"\>", 
        ",", "\<\"EtaPr\"\>"}], "}"}]},
     {"\<\"ALP-gluon\"\>", "\<\"FermilabBD\"\>", 
      RowBox[{"{", 
       RowBox[{"\<\"B\"\>", ",", "\<\"Pi0\"\>", ",", "\<\"Eta\"\>", 
        ",", "\<\"EtaPr\"\>"}], "}"}]},
     {"\<\"ALP-gluon\"\>", "\<\"LHC\"\>", 
      RowBox[{"{", 
       RowBox[{"\<\"B\"\>", ",", "\<\"Pi0\"\>", ",", "\<\"Eta\"\>", 
        ",", "\<\"EtaPr\"\>"}], "}"}]},
     {"\<\"ALP-gluon\"\>", "\<\"Serpukhov\"\>", 
      RowBox[{"{", 
       RowBox[{"\<\"Pi0\"\>", ",", "\<\"Eta\"\>", ",", "\<\"EtaPr\"\>"}], 
       "}"}]},
     {"\<\"ALP-gluon\"\>", "\<\"SPS\"\>", 
      RowBox[{"{", 
       RowBox[{"\<\"B\"\>", ",", "\<\"Pi0\"\>", ",", "\<\"Eta\"\>", 
        ",", "\<\"EtaPr\"\>"}], "}"}]},
     {"\<\"ALP-photon\"\>", "\<\"ESS\"\>", 
      RowBox[{"{", "\<\"Photon-fusion\"\>", "}"}]},
     {"\<\"ALP-photon\"\>", "\<\"FCC-hh\"\>", 
      RowBox[{"{", 
       RowBox[{"\<\"Pi0\"\>", ",", "\<\"Eta\"\>", 
        ",", "\<\"Photon-fusion\"\>"}], "}"}]},
     {"\<\"ALP-photon\"\>", "\<\"FermilabBD\"\>", 
      RowBox[{"{", 
       RowBox[{"\<\"Pi0\"\>", ",", "\<\"Eta\"\>", ",", "\<\"Primakov\"\>", 
        ",", "\<\"Photon-fusion\"\>"}], "}"}]},
     {"\<\"ALP-photon\"\>", "\<\"LHC\"\>", 
      RowBox[{"{", 
       RowBox[{"\<\"Pi0\"\>", ",", "\<\"Eta\"\>", ",", "\<\"Primakov\"\>", 
        ",", "\<\"Photon-fusion\"\>"}], "}"}]},
     {"\<\"ALP-photon\"\>", "\<\"Serpukhov\"\>", 
      RowBox[{"{", 
       RowBox[{"\<\"Pi0\"\>", ",", "\<\"Eta\"\>", ",", "\<\"Primakov\"\>", 
        ",", "\<\"Photon-fusion\"\>"}], "}"}]},
     {"\<\"ALP-photon\"\>", "\<\"SPS\"\>", 
      RowBox[{"{", 
       RowBox[{"\<\"Pi0\"\>", ",", "\<\"Eta\"\>", ",", "\<\"Primakov\"\>", 
        ",", "\<\"Photon-fusion\"\>"}], "}"}]},
     {"\<\"B-3Le-Lmu+Ltau\"\>", "\<\"ESS\"\>", 
      RowBox[{"{", "\<\"Bremsstrahlung\"\>", "}"}]},
     {"\<\"B-3Le-Lmu+Ltau\"\>", "\<\"FCC-hh\"\>", 
      RowBox[{"{", 
       RowBox[{"\<\"Pi0\"\>", ",", "\<\"Eta\"\>", ",", "\<\"EtaPr\"\>", 
        ",", "\<\"Bremsstrahlung\"\>", ",", "\<\"Omega\"\>"}], "}"}]},
     {"\<\"B-3Le-Lmu+Ltau\"\>", "\<\"FermilabBD\"\>", 
      RowBox[{"{", 
       RowBox[{"\<\"Pi0\"\>", ",", "\<\"Eta\"\>", ",", "\<\"EtaPr\"\>", 
        ",", "\<\"Bremsstrahlung\"\>", ",", "\<\"Omega\"\>"}], "}"}]},
     {"\<\"B-3Le-Lmu+Ltau\"\>", "\<\"LHC\"\>", 
      RowBox[{"{", 
       RowBox[{"\<\"Pi0\"\>", ",", "\<\"Eta\"\>", ",", "\<\"EtaPr\"\>", 
        ",", "\<\"Bremsstrahlung\"\>", ",", "\<\"Omega\"\>"}], "}"}]},
     {"\<\"B-3Le-Lmu+Ltau\"\>", "\<\"Serpukhov\"\>", 
      RowBox[{"{", 
       RowBox[{"\<\"Pi0\"\>", ",", "\<\"Eta\"\>", ",", "\<\"EtaPr\"\>", 
        ",", "\<\"Bremsstrahlung\"\>", ",", "\<\"Omega\"\>"}], "}"}]},
     {"\<\"B-3Le-Lmu+Ltau\"\>", "\<\"SPS\"\>", 
      RowBox[{"{", 
       RowBox[{"\<\"Pi0\"\>", ",", "\<\"Eta\"\>", ",", "\<\"EtaPr\"\>", 
        ",", "\<\"Bremsstrahlung\"\>", ",", "\<\"Omega\"\>"}], "}"}]},
     {"\<\"B-3Lmu\"\>", "\<\"ESS\"\>", 
      RowBox[{"{", "\<\"Bremsstrahlung\"\>", "}"}]},
     {"\<\"B-3Lmu\"\>", "\<\"FCC-hh\"\>", 
      RowBox[{"{", 
       RowBox[{"\<\"Pi0\"\>", ",", "\<\"Eta\"\>", ",", "\<\"EtaPr\"\>", 
        ",", "\<\"Bremsstrahlung\"\>", ",", "\<\"Omega\"\>"}], "}"}]},
     {"\<\"B-3Lmu\"\>", "\<\"FermilabBD\"\>", 
      RowBox[{"{", 
       RowBox[{"\<\"Pi0\"\>", ",", "\<\"Eta\"\>", ",", "\<\"EtaPr\"\>", 
        ",", "\<\"Bremsstrahlung\"\>", ",", "\<\"Omega\"\>"}], "}"}]},
     {"\<\"B-3Lmu\"\>", "\<\"LHC\"\>", 
      RowBox[{"{", 
       RowBox[{"\<\"Pi0\"\>", ",", "\<\"Eta\"\>", ",", "\<\"EtaPr\"\>", 
        ",", "\<\"Bremsstrahlung\"\>", ",", "\<\"Omega\"\>"}], "}"}]},
     {"\<\"B-3Lmu\"\>", "\<\"Serpukhov\"\>", 
      RowBox[{"{", 
       RowBox[{"\<\"Pi0\"\>", ",", "\<\"Eta\"\>", ",", "\<\"EtaPr\"\>", 
        ",", "\<\"Bremsstrahlung\"\>", ",", "\<\"Omega\"\>"}], "}"}]},
     {"\<\"B-3Lmu\"\>", "\<\"SPS\"\>", 
      RowBox[{"{", 
       RowBox[{"\<\"Pi0\"\>", ",", "\<\"Eta\"\>", ",", "\<\"EtaPr\"\>", 
        ",", "\<\"Bremsstrahlung\"\>", ",", "\<\"Omega\"\>"}], "}"}]},
     {"\<\"B-L\"\>", "\<\"ESS\"\>", 
      RowBox[{"{", "\<\"Bremsstrahlung\"\>", "}"}]},
     {"\<\"B-L\"\>", "\<\"FCC-hh\"\>", 
      RowBox[{"{", 
       RowBox[{"\<\"Pi0\"\>", ",", "\<\"Eta\"\>", ",", "\<\"EtaPr\"\>", 
        ",", "\<\"Bremsstrahlung\"\>", ",", "\<\"Omega\"\>"}], "}"}]},
     {"\<\"B-L\"\>", "\<\"FermilabBD\"\>", 
      RowBox[{"{", 
       RowBox[{"\<\"Pi0\"\>", ",", "\<\"Eta\"\>", ",", "\<\"EtaPr\"\>", 
        ",", "\<\"Bremsstrahlung\"\>", ",", "\<\"Omega\"\>"}], "}"}]},
     {"\<\"B-L\"\>", "\<\"LHC\"\>", 
      RowBox[{"{", 
       RowBox[{"\<\"Pi0\"\>", ",", "\<\"Eta\"\>", ",", "\<\"EtaPr\"\>", 
        ",", "\<\"Bremsstrahlung\"\>", ",", "\<\"Omega\"\>"}], "}"}]},
     {"\<\"B-L\"\>", "\<\"Serpukhov\"\>", 
      RowBox[{"{", 
       RowBox[{"\<\"Pi0\"\>", ",", "\<\"Eta\"\>", ",", "\<\"EtaPr\"\>", 
        ",", "\<\"Bremsstrahlung\"\>", ",", "\<\"Omega\"\>"}], "}"}]},
     {"\<\"B-L\"\>", "\<\"SPS\"\>", 
      RowBox[{"{", 
       RowBox[{"\<\"Pi0\"\>", ",", "\<\"Eta\"\>", ",", "\<\"EtaPr\"\>", 
        ",", "\<\"Bremsstrahlung\"\>", ",", "\<\"Omega\"\>"}], "}"}]},
     {"\<\"B-Le-3Lmu+Ltau\"\>", "\<\"ESS\"\>", 
      RowBox[{"{", "\<\"Bremsstrahlung\"\>", "}"}]},
     {"\<\"B-Le-3Lmu+Ltau\"\>", "\<\"FCC-hh\"\>", 
      RowBox[{"{", 
       RowBox[{"\<\"Pi0\"\>", ",", "\<\"Eta\"\>", ",", "\<\"EtaPr\"\>", 
        ",", "\<\"Bremsstrahlung\"\>", ",", "\<\"Omega\"\>"}], "}"}]},
     {"\<\"B-Le-3Lmu+Ltau\"\>", "\<\"FermilabBD\"\>", 
      RowBox[{"{", 
       RowBox[{"\<\"Pi0\"\>", ",", "\<\"Eta\"\>", ",", "\<\"EtaPr\"\>", 
        ",", "\<\"Bremsstrahlung\"\>", ",", "\<\"Omega\"\>"}], "}"}]},
     {"\<\"B-Le-3Lmu+Ltau\"\>", "\<\"LHC\"\>", 
      RowBox[{"{", 
       RowBox[{"\<\"Pi0\"\>", ",", "\<\"Eta\"\>", ",", "\<\"EtaPr\"\>", 
        ",", "\<\"Bremsstrahlung\"\>", ",", "\<\"Omega\"\>"}], "}"}]},
     {"\<\"B-Le-3Lmu+Ltau\"\>", "\<\"Serpukhov\"\>", 
      RowBox[{"{", 
       RowBox[{"\<\"Pi0\"\>", ",", "\<\"Eta\"\>", ",", "\<\"EtaPr\"\>", 
        ",", "\<\"Bremsstrahlung\"\>", ",", "\<\"Omega\"\>"}], "}"}]},
     {"\<\"B-Le-3Lmu+Ltau\"\>", "\<\"SPS\"\>", 
      RowBox[{"{", 
       RowBox[{"\<\"Pi0\"\>", ",", "\<\"Eta\"\>", ",", "\<\"EtaPr\"\>", 
        ",", "\<\"Bremsstrahlung\"\>", ",", "\<\"Omega\"\>"}], "}"}]},
     {"\<\"DP\"\>", "\<\"ESS\"\>", 
      RowBox[{"{", "\<\"Bremsstrahlung\"\>", "}"}]},
     {"\<\"DP\"\>", "\<\"FCC-hh\"\>", 
      RowBox[{"{", 
       RowBox[{"\<\"Pi0\"\>", ",", "\<\"Eta\"\>", ",", "\<\"EtaPr\"\>", 
        ",", "\<\"Bremsstrahlung\"\>", ",", "\<\"Rho0\"\>"}], "}"}]},
     {"\<\"DP\"\>", "\<\"FermilabBD\"\>", 
      RowBox[{"{", 
       RowBox[{"\<\"Pi0\"\>", ",", "\<\"Eta\"\>", ",", "\<\"EtaPr\"\>", 
        ",", "\<\"Bremsstrahlung\"\>", ",", "\<\"Rho0\"\>"}], "}"}]},
     {"\<\"DP\"\>", "\<\"LHC\"\>", 
      RowBox[{"{", 
       RowBox[{"\<\"Pi0\"\>", ",", "\<\"Eta\"\>", ",", "\<\"EtaPr\"\>", 
        ",", "\<\"Bremsstrahlung\"\>", ",", "\<\"Rho0\"\>"}], "}"}]},
     {"\<\"DP\"\>", "\<\"Serpukhov\"\>", 
      RowBox[{"{", 
       RowBox[{"\<\"Pi0\"\>", ",", "\<\"Eta\"\>", ",", "\<\"EtaPr\"\>", 
        ",", "\<\"Bremsstrahlung\"\>", ",", "\<\"Rho0\"\>"}], "}"}]},
     {"\<\"DP\"\>", "\<\"SPS\"\>", 
      RowBox[{"{", 
       RowBox[{"\<\"Pi0\"\>", ",", "\<\"Eta\"\>", ",", "\<\"EtaPr\"\>", 
        ",", "\<\"Bremsstrahlung\"\>", ",", "\<\"Rho0\"\>"}], "}"}]},
     {"\<\"HNL-mixing-e\"\>", "\<\"ESS\"\>", 
      RowBox[{"{", 
       RowBox[{"\<\"mu\"\>", ",", "\<\"PiCharged\"\>"}], "}"}]},
     {"\<\"HNL-mixing-e\"\>", "\<\"FCC-hh\"\>", 
      RowBox[{"{", 
       RowBox[{"\<\"W\"\>", ",", "\<\"B\"\>"}], "}"}]},
     {"\<\"HNL-mixing-e\"\>", "\<\"FermilabBD\"\>", 
      RowBox[{"{", 
       RowBox[{"\<\"D\"\>", ",", "\<\"B\"\>"}], "}"}]},
     {"\<\"HNL-mixing-e\"\>", "\<\"LHC\"\>", 
      RowBox[{"{", 
       RowBox[{"\<\"W\"\>", ",", "\<\"D\"\>", ",", "\<\"B\"\>"}], "}"}]},
     {"\<\"HNL-mixing-e\"\>", "\<\"Serpukhov\"\>", 
      RowBox[{"{", "}"}]},
     {"\<\"HNL-mixing-e\"\>", "\<\"SPS\"\>", 
      RowBox[{"{", 
       RowBox[{"\<\"K\"\>", ",", "\<\"D\"\>", ",", "\<\"B\"\>"}], "}"}]},
     {"\<\"HNL-mixing-mu\"\>", "\<\"ESS\"\>", 
      RowBox[{"{", 
       RowBox[{"\<\"mu\"\>", ",", "\<\"PiCharged\"\>"}], "}"}]},
     {"\<\"HNL-mixing-mu\"\>", "\<\"FCC-hh\"\>", 
      RowBox[{"{", 
       RowBox[{"\<\"W\"\>", ",", "\<\"B\"\>"}], "}"}]},
     {"\<\"HNL-mixing-mu\"\>", "\<\"FermilabBD\"\>", 
      RowBox[{"{", 
       RowBox[{"\<\"D\"\>", ",", "\<\"B\"\>"}], "}"}]},
     {"\<\"HNL-mixing-mu\"\>", "\<\"LHC\"\>", 
      RowBox[{"{", 
       RowBox[{"\<\"W\"\>", ",", "\<\"D\"\>", ",", "\<\"B\"\>"}], "}"}]},
     {"\<\"HNL-mixing-mu\"\>", "\<\"Serpukhov\"\>", 
      RowBox[{"{", "}"}]},
     {"\<\"HNL-mixing-mu\"\>", "\<\"SPS\"\>", 
      RowBox[{"{", 
       RowBox[{"\<\"K\"\>", ",", "\<\"D\"\>", ",", "\<\"B\"\>"}], "}"}]},
     {"\<\"HNL-mixing-tau\"\>", "\<\"ESS\"\>", 
      RowBox[{"{", "}"}]},
     {"\<\"HNL-mixing-tau\"\>", "\<\"FCC-hh\"\>", 
      RowBox[{"{", 
       RowBox[{"\<\"W\"\>", ",", "\<\"B\"\>"}], "}"}]},
     {"\<\"HNL-mixing-tau\"\>", "\<\"FermilabBD\"\>", 
      RowBox[{"{", 
       RowBox[{"\<\"D\"\>", ",", "\<\"B\"\>"}], "}"}]},
     {"\<\"HNL-mixing-tau\"\>", "\<\"LHC\"\>", 
      RowBox[{"{", 
       RowBox[{"\<\"W\"\>", ",", "\<\"D\"\>", ",", "\<\"B\"\>"}], "}"}]},
     {"\<\"HNL-mixing-tau\"\>", "\<\"Serpukhov\"\>", 
      RowBox[{"{", "}"}]},
     {"\<\"HNL-mixing-tau\"\>", "\<\"SPS\"\>", 
      RowBox[{"{", 
       RowBox[{"\<\"D\"\>", ",", "\<\"B\"\>"}], "}"}]},
     {"\<\"MCP\"\>", "\<\"ESS\"\>", 
      RowBox[{"{", "}"}]},
     {"\<\"MCP\"\>", "\<\"FCC-hh\"\>", 
      RowBox[{"{", 
       RowBox[{"\<\"Pi0\"\>", ",", "\<\"Eta\"\>", ",", "\<\"Phi\"\>", 
        ",", "\<\"Rho0\"\>", ",", "\<\"Omega\"\>"}], "}"}]},
     {"\<\"MCP\"\>", "\<\"FermilabBD\"\>", 
      RowBox[{"{", 
       RowBox[{"\<\"Pi0\"\>", ",", "\<\"Eta\"\>", ",", "\<\"Phi\"\>", 
        ",", "\<\"JPsi\"\>", ",", "\<\"Rho0\"\>", ",", "\<\"Omega\"\>"}], 
       "}"}]},
     {"\<\"MCP\"\>", "\<\"LHC\"\>", 
      RowBox[{"{", 
       RowBox[{"\<\"Pi0\"\>", ",", "\<\"Eta\"\>", ",", "\<\"Phi\"\>", 
        ",", "\<\"JPsi\"\>", ",", "\<\"Rho0\"\>", ",", "\<\"Omega\"\>", 
        ",", "\<\"Upsilon\"\>"}], "}"}]},
     {"\<\"MCP\"\>", "\<\"Serpukhov\"\>", 
      RowBox[{"{", 
       RowBox[{"\<\"Pi0\"\>", ",", "\<\"Eta\"\>", ",", "\<\"Phi\"\>", 
        ",", "\<\"Rho0\"\>", ",", "\<\"Omega\"\>"}], "}"}]},
     {"\<\"MCP\"\>", "\<\"SPS\"\>", 
      RowBox[{"{", 
       RowBox[{"\<\"Pi0\"\>", ",", "\<\"Eta\"\>", ",", "\<\"Phi\"\>", 
        ",", "\<\"JPsi\"\>", ",", "\<\"Rho0\"\>", ",", "\<\"Omega\"\>"}], 
       "}"}]},
     {"\<\"Scalar\"\>", "\<\"ESS\"\>", 
      RowBox[{"{", "\<\"Bremsstrahlung\"\>", "}"}]},
     {"\<\"Scalar\"\>", "\<\"FCC-hh\"\>", 
      RowBox[{"{", 
       RowBox[{"\<\"B-mixing\"\>", ",", "\<\"Bs-quartic\"\>", 
        ",", "\<\"B-quartic\"\>", ",", "\<\"h-quartic\"\>", 
        ",", "\<\"Bremsstrahlung\"\>"}], "}"}]},
     {"\<\"Scalar\"\>", "\<\"FermilabBD\"\>", 
      RowBox[{"{", 
       RowBox[{"\<\"B-mixing\"\>", ",", "\<\"Bs-quartic\"\>", 
        ",", "\<\"B-quartic\"\>", ",", "\<\"Bremsstrahlung\"\>"}], "}"}]},
     {"\<\"Scalar\"\>", "\<\"LHC\"\>", 
      RowBox[{"{", 
       RowBox[{"\<\"B-mixing\"\>", ",", "\<\"Bs-quartic\"\>", 
        ",", "\<\"B-quartic\"\>", ",", "\<\"h-quartic\"\>", 
        ",", "\<\"Bremsstrahlung\"\>"}], "}"}]},
     {"\<\"Scalar\"\>", "\<\"Serpukhov\"\>", 
      RowBox[{"{", "\<\"Bremsstrahlung\"\>", "}"}]},
     {"\<\"Scalar\"\>", "\<\"SPS\"\>", 
      RowBox[{"{", 
       RowBox[{"\<\"B-mixing\"\>", ",", "\<\"Bs-quartic\"\>", 
        ",", "\<\"B-quartic\"\>", ",", "\<\"K-mixing\"\>", 
        ",", "\<\"Bremsstrahlung\"\>"}], "}"}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}], TraditionalForm]], "Output",
 CellChangeTimes->{3.930211535124151*^9, 3.930822767192189*^9},
 CellTags->"Evaluation",
 CellLabel->
  "Out[1100]=",ExpressionUUID->"51f0b98c-7f8c-46ec-880c-e3b2c8cac0b8"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Preliminary code: PDFs of LLPs", "Title",
 CellChangeTimes->{{3.9132744451552525`*^9, 3.91327446376923*^9}, {
   3.913276371155023*^9, 3.9132763727554474`*^9}, {3.9134597514254026`*^9, 
   3.9134597544782243`*^9}, {3.9137148491542287`*^9, 3.913714861737934*^9}, {
   3.913714903902453*^9, 3.913714908312052*^9}, 3.9154388115785527`*^9},
 CellTags->
  "Evaluation",ExpressionUUID->"745366ac-d59b-4ddb-b8ff-34a888539c66"],

Cell[CellGroupData[{

Cell["Production via decays: sampling boosted LLPs", "Chapter",
 CellChangeTimes->{{3.8851089217945366`*^9, 3.8851089234565606`*^9}, {
   3.8851105131555185`*^9, 3.885110520802391*^9}, {3.913276520922725*^9, 
   3.913276534364999*^9}, {3.913461092847869*^9, 3.9134610963450475`*^9}, 
   3.915438811585671*^9},
 CellTags->
  "Evaluation",ExpressionUUID->"60e6b013-89b6-4931-8d1e-85654302cfde"],

Cell[CellGroupData[{

Cell["\<\
Generic code for phase space of 2-body and 3-body decays  at rest frame of \
the decaying particle\
\>", "Section",
 CellChangeTimes->{{3.877714895863616*^9, 3.8777149132965145`*^9}, {
  3.8851105484739537`*^9, 3.885110556434745*^9}, {3.913276366524795*^9, 
  3.913276368487024*^9}},
 CellTags->
  "Evaluation",ExpressionUUID->"9fab6c33-4c62-41ba-93ab-0c39e3261114"],

Cell[CellGroupData[{

Cell["2-body", "Subsection",
 CellChangeTimes->{{3.877691041323384*^9, 3.8776910462459583`*^9}, {
  3.8851105459942493`*^9, 3.885110547379161*^9}},
 CellTags->
  "Evaluation",ExpressionUUID->"2031739c-957f-45b9-906c-9275efa46dd4"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"tabPS2bodyCompiled", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Hold", "@", 
      RowBox[{"Compile", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"MASSM", ",", "_Real"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"mLLP", ",", "_Real"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"m1", ",", "_Real"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"\[Theta]rand", ",", "_Real"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"\[Phi]rand", ",", "_Real"}], "}"}]}], "}"}], ",", 
        RowBox[{"Module", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "pval", ",", "px1", ",", "py1", ",", "pz1", ",", "E12body", ",", 
            "E22body"}], "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{"Energies", " ", "of", " ", "particles", " ", "1", " ", 
            RowBox[{"(", "E12body", ")"}], " ", "and", " ", "2", " ", 
            RowBox[{"(", "E22body", ")"}], " ", "at", " ", "the", " ", "rest",
             " ", "frame", " ", "of", " ", "decaying", " ", "particle"}], 
           "*)"}], "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"E12body", "=", 
            FractionBox[
             RowBox[{
              SuperscriptBox["MASSM", "2"], "-", 
              SuperscriptBox["mLLP", "2"], "+", 
              SuperscriptBox["m1", "2"]}], 
             RowBox[{"2", "*", "MASSM"}]]}], ";", "\[IndentingNewLine]", 
           RowBox[{"E22body", "=", 
            FractionBox[
             RowBox[{
              SuperscriptBox["MASSM", "2"], "-", 
              SuperscriptBox["m1", "2"], "+", 
              SuperscriptBox["mLLP", "2"]}], 
             RowBox[{"2", "*", "MASSM"}]]}], ";", "\[IndentingNewLine]", 
           RowBox[{"pval", "=", 
            RowBox[{"pPar", "[", 
             RowBox[{"E22body", ",", "mLLP"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"px1", "=", 
            RowBox[{"pval", "*", 
             RowBox[{"Cos", "[", "\[Phi]rand", "]"}], "*", 
             RowBox[{"Sin", "[", "\[Theta]rand", "]"}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"py1", "=", 
            RowBox[{"pval", "*", 
             RowBox[{"Sin", "[", "\[Phi]rand", "]"}], "*", 
             RowBox[{"Sin", "[", "\[Theta]rand", "]"}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"pz1", "=", 
            RowBox[{"pval", "*", 
             RowBox[{"Cos", "[", "\[Theta]rand", "]"}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "px1"}], ",", 
             RowBox[{"-", "py1"}], ",", 
             RowBox[{"-", "pz1"}], ",", "E12body", ",", "m1", ",", "px1", ",",
              "py1", ",", "pz1", ",", "E22body", ",", "mLLP"}], "}"}]}]}], 
         "\[IndentingNewLine]", "]"}], ",", 
        RowBox[{"CompilationTarget", "\[Rule]", "\"\<C\>\""}], ",", 
        RowBox[{"RuntimeOptions", "\[Rule]", "\"\<Speed\>\""}], ",", 
        RowBox[{"RuntimeAttributes", "->", 
         RowBox[{"{", "Listable", "}"}]}], ",", 
        RowBox[{"Parallelization", "->", "True"}]}], "]"}]}], "/.", 
     RowBox[{"DownValues", "@", "pPar"}]}], "//", "ReleaseHold"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"<<", "CompiledFunctionTools`"}], "\n", 
 RowBox[{
  RowBox[{"CompilePrint", "@", "tabPS2bodyCompiled"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TwoBodyDecaysEventsAtRest", "[", 
   RowBox[{"LLP_", ",", "Process_", ",", " ", "mLLP_", ",", "Nevents_"}], 
   "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "partcontent", ",", "MASSM", ",", "MASS1", ",", "\[Phi]Rand", ",", 
      "\[Theta]Rand"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"partcontent", "=", 
      RowBox[{"ReactionProductsList", "[", 
       RowBox[{"LLP", ",", "Process"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"MASSM", ",", "MASS1"}], "}"}], "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"mSM", "[", 
         RowBox[{"partcontent", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"partcontent", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "==", "LLP"}], ",", "mLLP", ",", 
          RowBox[{"mSM", "[", 
           RowBox[{"partcontent", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "]"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{
       "Array", " ", "of", " ", "random", " ", "values", " ", "of", " ", 
        "\[Phi]", " ", "and", " ", "\[Theta]", " ", "defined", " ", "via", 
        " ", 
        SubscriptBox["p", "2"]}], " ", "=", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "p"}], "\[Times]", 
          RowBox[{"Cos", "[", "\[Phi]", "]"}], "\[Times]", 
          RowBox[{"Sin", "[", "\[Theta]", "]"}]}], ",", 
         RowBox[{
          RowBox[{"-", "p"}], "\[Times]", 
          RowBox[{"Sin", "[", "\[Phi]", "]"}], "\[Times]", 
          RowBox[{"Sin", "[", "\[Theta]", "]"}]}], ",", 
         RowBox[{
          RowBox[{"-", "p"}], "\[Times]", 
          RowBox[{"Cos", "[", "\[Theta]", "]"}]}]}], ")"}]}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Distribution", " ", "in", " ", "\[Phi]", " ", "is", " ", 
        RowBox[{"isotropic", ".", " ", "Distribution"}], " ", "in", " ", 
        "cos", 
        RowBox[{"(", "\[Theta]", ")"}], " ", "is", " ", 
        RowBox[{"isotropic", ".", " ", "Hence"}]}], ",", " ", 
       RowBox[{
        RowBox[{
        "one", " ", "should", " ", "generate", " ", "random", " ", "values", 
         " ", "of", " ", "\[Phi]", " ", "in", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "Pi"}], ",", "Pi"}], ")"}], " ", "and", " ", "random",
          " ", "values", " ", "of", " ", "cos", 
         RowBox[{"(", "\[Theta]", ")"}], " ", "from"}], " ", "-", 
        RowBox[{"1", " ", "to", " ", "1"}]}], ",", " ", 
       RowBox[{"then", " ", "takin", " ", "arccos", 
        RowBox[{"(", ")"}]}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"\[Phi]Rand", "=", 
      RowBox[{"RandomReal", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "Pi"}], ",", "Pi"}], "}"}], ",", "Nevents"}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"\[Theta]Rand", "=", 
      RowBox[{"ArcCos", "[", 
       RowBox[{"RandomReal", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", "Nevents"}], "]"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"The", " ", "final", " ", "phase", " ", "space"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"TabPS2bodyTemp", "=", 
      RowBox[{"tabPS2bodyCompiled", "[", 
       RowBox[{
       "MASSM", ",", "mLLP", ",", "MASS1", ",", "\[Theta]Rand", ",", 
        "\[Phi]Rand"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"partcontent", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "==", "LLP"}], ",", 
       RowBox[{"Riffle", "[", 
        RowBox[{
         RowBox[{"TabPS2bodyTemp", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", 
            RowBox[{"Range", "[", 
             RowBox[{"1", ",", "5"}], "]"}]}], "]"}], "]"}], ",", 
         RowBox[{"TabPS2bodyTemp", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", 
            RowBox[{"Range", "[", 
             RowBox[{"6", ",", "10"}], "]"}]}], "]"}], "]"}]}], "]"}], ",", 
       RowBox[{"TabPS2bodyTemp", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", 
          RowBox[{"Range", "[", 
           RowBox[{"6", ",", "10"}], "]"}]}], "]"}], "]"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"tabtest", "=", 
    RowBox[{"TwoBodyDecaysEventsAtRest", "[", 
     RowBox[{"\"\<HNL-mixing-e\>\"", ",", "\"\<B-2-body\>\"", ",", "1", ",", 
      RowBox[{"5", "*", 
       SuperscriptBox["10", "6"]}]}], "]"}]}], ";"}], "//", 
  "AbsoluteTiming"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  "\"\<Distribution in cos(\[Theta]) (must be isotropic):\>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Histogram", "[", 
  RowBox[{
   FractionBox[
    RowBox[{"tabtest", "[", 
     RowBox[{"[", 
      RowBox[{"All", ",", "3"}], "]"}], "]"}], 
    SqrtBox[
     RowBox[{
      SuperscriptBox[
       RowBox[{
        RowBox[{"tabtest", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "[", 
        RowBox[{"[", "4", "]"}], "]"}], "2"], "-", 
      SuperscriptBox[
       RowBox[{
        RowBox[{"tabtest", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "[", 
        RowBox[{"[", "5", "]"}], "]"}], "2"]}]]], ",", "100", ",", 
   "\"\<ProbabilityDensity\>\""}], "]"}]}], "Input",
 CellChangeTimes->{{3.913263457235407*^9, 3.913263496776415*^9}, {
   3.9132635330867143`*^9, 3.913263614505486*^9}, {3.9132636453356113`*^9, 
   3.91326376970642*^9}, {3.913263875756357*^9, 3.913263905020344*^9}, {
   3.91326396412959*^9, 3.913264153776613*^9}, {3.913265163298602*^9, 
   3.9132651678272133`*^9}, {3.913274504897067*^9, 3.9132745145462704`*^9}, {
   3.913274551919711*^9, 3.913274640891887*^9}, {3.913274678831163*^9, 
   3.913274721244623*^9}, 3.913277393372783*^9, {3.9132776063235703`*^9, 
   3.9132776221735954`*^9}, 3.913280729313801*^9, {3.913394308875176*^9, 
   3.9133943105181155`*^9}, 3.913394947448184*^9, {3.9134527724372797`*^9, 
   3.9134527732761564`*^9}, {3.915438811591802*^9, 3.915438811630966*^9}, 
   3.915440966138796*^9},
 CellTags->"Evaluation",
 CellLabel->
  "In[1101]:=",ExpressionUUID->"529007c0-1e37-442a-b393-824254dc20bf"],

Cell[BoxData[
 FormBox[
  RowBox[{"{", 
   RowBox[{"0.955065`", ",", "Null"}], "}"}], TraditionalForm]], "Output",
 CellChangeTimes->{3.930211536749454*^9, 3.930822768807886*^9},
 CellTags->"Evaluation",
 CellLabel->
  "Out[1105]=",ExpressionUUID->"a13d4f85-9be4-4284-b645-10f415769c53"],

Cell[BoxData[
 FormBox["\<\"Distribution in cos(\[Theta]) (must be isotropic):\"\>", 
  TraditionalForm]], "Print",
 CellChangeTimes->{3.930211536763745*^9, 3.9308227688105593`*^9},
 CellTags->"Evaluation",
 CellLabel->
  "Durante la evaluaci\[OAcute]n de \
In[1101]:=",ExpressionUUID->"34c09bca-6830-4b57-9f40-e9649c03f098"],

Cell[BoxData[
 FormBox[
  GraphicsBox[{
    {RGBColor[0.987148, 0.8073604000000001, 0.49470040000000004`], EdgeForm[
     Opacity[0.]], {}, 
     {RGBColor[0.987148, 0.8073604000000001, 0.49470040000000004`], EdgeForm[
      Opacity[0.]], RectangleBox[{-1., 0}, {-0.98, 0.49712},
       RoundingRadius->0], RectangleBox[{-0.98, 0}, {-0.96, 0.50423},
       RoundingRadius->0], RectangleBox[{-0.96, 0}, {-0.94, 0.50262},
       RoundingRadius->0], RectangleBox[{-0.94, 0}, {-0.92, 0.49892},
       RoundingRadius->0], RectangleBox[{-0.92, 0}, {-0.9, 0.49646},
       RoundingRadius->0], RectangleBox[{-0.9, 0}, {-0.88, 0.50135},
       RoundingRadius->0], RectangleBox[{-0.88, 0}, {-0.86, 0.50166},
       RoundingRadius->0], RectangleBox[{-0.86, 0}, {-0.84, 0.49936},
       RoundingRadius->0], RectangleBox[{-0.84, 0}, {-0.82, 0.50166},
       RoundingRadius->0], RectangleBox[{-0.82, 0}, {-0.8, 0.49647},
       RoundingRadius->0], RectangleBox[{-0.8, 0}, {-0.78, 0.50156},
       RoundingRadius->0], RectangleBox[{-0.78, 0}, {-0.76, 0.50054},
       RoundingRadius->0], RectangleBox[{-0.76, 0}, {-0.74, 0.49967},
       RoundingRadius->0], RectangleBox[{-0.74, 0}, {-0.72, 0.49932},
       RoundingRadius->0], RectangleBox[{-0.72, 0}, {-0.7, 0.50022},
       RoundingRadius->0], RectangleBox[{-0.7, 0}, {-0.68, 0.49989},
       RoundingRadius->0], RectangleBox[{-0.68, 0}, {-0.66, 0.50377},
       RoundingRadius->0], RectangleBox[{-0.66, 0}, {-0.64, 0.50338},
       RoundingRadius->0], RectangleBox[{-0.64, 0}, {-0.62, 0.50008},
       RoundingRadius->0], RectangleBox[{-0.62, 0}, {-0.6, 0.49972},
       RoundingRadius->0], RectangleBox[{-0.6, 0}, {-0.58, 0.49741},
       RoundingRadius->0], RectangleBox[{-0.58, 0}, {-0.56, 0.50139},
       RoundingRadius->0], RectangleBox[{-0.56, 0}, {-0.54, 0.5011},
       RoundingRadius->0], RectangleBox[{-0.54, 0}, {-0.52, 0.49963},
       RoundingRadius->0], RectangleBox[{-0.52, 0}, {-0.5, 0.49555},
       RoundingRadius->0], RectangleBox[{-0.5, 0}, {-0.48, 0.50402},
       RoundingRadius->0], RectangleBox[{-0.48, 0}, {-0.46, 0.49935},
       RoundingRadius->0], RectangleBox[{-0.46, 0}, {-0.44, 0.49827},
       RoundingRadius->0], RectangleBox[{-0.44, 0}, {-0.42, 0.50203},
       RoundingRadius->0], RectangleBox[{-0.42, 0}, {-0.4, 0.49809},
       RoundingRadius->0], RectangleBox[{-0.4, 0}, {-0.38, 0.50355},
       RoundingRadius->0], RectangleBox[{-0.38, 0}, {-0.36, 0.49903},
       RoundingRadius->0], RectangleBox[{-0.36, 0}, {-0.34, 0.49703},
       RoundingRadius->0], RectangleBox[{-0.34, 0}, {-0.32, 0.50488},
       RoundingRadius->0], RectangleBox[{-0.32, 0}, {-0.3, 0.49917},
       RoundingRadius->0], RectangleBox[{-0.3, 0}, {-0.28, 0.50127},
       RoundingRadius->0], RectangleBox[{-0.28, 0}, {-0.26, 0.49972},
       RoundingRadius->0], RectangleBox[{-0.26, 0}, {-0.24, 0.5012},
       RoundingRadius->0], RectangleBox[{-0.24, 0}, {-0.22, 0.49795},
       RoundingRadius->0], RectangleBox[{-0.22, 0}, {-0.2, 0.49936},
       RoundingRadius->0], RectangleBox[{-0.2, 0}, {-0.18, 0.50151},
       RoundingRadius->0], RectangleBox[{-0.18, 0}, {-0.16, 0.49864},
       RoundingRadius->0], RectangleBox[{-0.16, 0}, {-0.14, 0.50072},
       RoundingRadius->0], RectangleBox[{-0.14, 0}, {-0.12, 0.49871},
       RoundingRadius->0], RectangleBox[{-0.12, 0}, {-0.1, 0.50008},
       RoundingRadius->0], RectangleBox[{-0.1, 0}, {-0.08, 0.50182},
       RoundingRadius->0], RectangleBox[{-0.08, 0}, {-0.06, 0.49829},
       RoundingRadius->0], RectangleBox[{-0.06, 0}, {-0.04, 0.49998},
       RoundingRadius->0], RectangleBox[{-0.04, 0}, {-0.02, 0.50026},
       RoundingRadius->0], RectangleBox[{-0.02, 0}, {0., 0.50029},
       RoundingRadius->0], RectangleBox[{0., 0}, {0.02, 0.50188},
       RoundingRadius->0], RectangleBox[{0.02, 0}, {0.04, 0.49906},
       RoundingRadius->0], RectangleBox[{0.04, 0}, {0.06, 0.49877},
       RoundingRadius->0], RectangleBox[{0.06, 0}, {0.08, 0.50014},
       RoundingRadius->0], RectangleBox[{0.08, 0}, {0.1, 0.50187},
       RoundingRadius->0], RectangleBox[{0.1, 0}, {0.12, 0.49819},
       RoundingRadius->0], RectangleBox[{0.12, 0}, {0.14, 0.49674},
       RoundingRadius->0], RectangleBox[{0.14, 0}, {0.16, 0.50242},
       RoundingRadius->0], RectangleBox[{0.16, 0}, {0.18, 0.49731},
       RoundingRadius->0], RectangleBox[{0.18, 0}, {0.2, 0.50458},
       RoundingRadius->0], RectangleBox[{0.2, 0}, {0.22, 0.49777},
       RoundingRadius->0], RectangleBox[{0.22, 0}, {0.24, 0.49877},
       RoundingRadius->0], RectangleBox[{0.24, 0}, {0.26, 0.50196},
       RoundingRadius->0], RectangleBox[{0.26, 0}, {0.28, 0.49766},
       RoundingRadius->0], RectangleBox[{0.28, 0}, {0.3, 0.49816},
       RoundingRadius->0], RectangleBox[{0.3, 0}, {0.32, 0.49768},
       RoundingRadius->0], RectangleBox[{0.32, 0}, {0.34, 0.50351},
       RoundingRadius->0], RectangleBox[{0.34, 0}, {0.36, 0.50154},
       RoundingRadius->0], RectangleBox[{0.36, 0}, {0.38, 0.49991},
       RoundingRadius->0], RectangleBox[{0.38, 0}, {0.4, 0.49931},
       RoundingRadius->0], RectangleBox[{0.4, 0}, {0.42, 0.50193},
       RoundingRadius->0], RectangleBox[{0.42, 0}, {0.44, 0.50234},
       RoundingRadius->0], RectangleBox[{0.44, 0}, {0.46, 0.49907},
       RoundingRadius->0], RectangleBox[{0.46, 0}, {0.48, 0.49635},
       RoundingRadius->0], RectangleBox[{0.48, 0}, {0.5, 0.50485},
       RoundingRadius->0], RectangleBox[{0.5, 0}, {0.52, 0.49774},
       RoundingRadius->0], RectangleBox[{0.52, 0}, {0.54, 0.50441},
       RoundingRadius->0], RectangleBox[{0.54, 0}, {0.56, 0.49958},
       RoundingRadius->0], RectangleBox[{0.56, 0}, {0.58, 0.50121},
       RoundingRadius->0], RectangleBox[{0.58, 0}, {0.6, 0.49869},
       RoundingRadius->0], RectangleBox[{0.6, 0}, {0.62, 0.49929},
       RoundingRadius->0], RectangleBox[{0.62, 0}, {0.64, 0.50025},
       RoundingRadius->0], RectangleBox[{0.64, 0}, {0.66, 0.49569},
       RoundingRadius->0], RectangleBox[{0.66, 0}, {0.68, 0.50312},
       RoundingRadius->0], RectangleBox[{0.68, 0}, {0.7, 0.49931},
       RoundingRadius->0], RectangleBox[{0.7, 0}, {0.72, 0.49858},
       RoundingRadius->0], RectangleBox[{0.72, 0}, {0.74, 0.49918},
       RoundingRadius->0], RectangleBox[{0.74, 0}, {0.76, 0.49798},
       RoundingRadius->0], RectangleBox[{0.76, 0}, {0.78, 0.49872},
       RoundingRadius->0], RectangleBox[{0.78, 0}, {0.8, 0.49837},
       RoundingRadius->0], RectangleBox[{0.8, 0}, {0.82, 0.50389},
       RoundingRadius->0], RectangleBox[{0.82, 0}, {0.84, 0.49764},
       RoundingRadius->0], RectangleBox[{0.84, 0}, {0.86, 0.49891},
       RoundingRadius->0], RectangleBox[{0.86, 0}, {0.88, 0.50022},
       RoundingRadius->0], RectangleBox[{0.88, 0}, {0.9, 0.50175},
       RoundingRadius->0], RectangleBox[{0.9, 0}, {0.92, 0.49886},
       RoundingRadius->0], RectangleBox[{0.92, 0}, {0.94, 0.49979},
       RoundingRadius->0], RectangleBox[{0.94, 0}, {0.96, 0.49979},
       RoundingRadius->0], RectangleBox[{0.96, 0}, {0.98, 0.50133},
       RoundingRadius->0], RectangleBox[{0.98, 0}, {1., 0.49563},
       RoundingRadius->
        0]}, {}, {}}, {{}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, \
{}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, \
{}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, \
{}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, \
{}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, \
{}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}}},
   AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
   Axes->{True, True},
   AxesLabel->{None, None},
   AxesOrigin->{-1.04, 0},
   FrameLabel->{{None, None}, {None, None}},
   FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
   GridLines->{None, None},
   GridLinesStyle->Directive[
     GrayLevel[0.5, 0.4]],
   PlotRange->{{-1, 1}, {All, All}},
   PlotRangePadding->{{
      Scaled[0.02], 
      Scaled[0.02]}, {
      Scaled[0.02], 
      Scaled[0.05]}},
   Ticks->{Automatic, Automatic}], TraditionalForm]], "Output",
 CellChangeTimes->{3.930211536749454*^9, 3.9308227693667088`*^9},
 CellTags->"Evaluation",
 CellLabel->
  "Out[1107]=",ExpressionUUID->"4b8a9453-048d-4a42-8c1d-b40a9434cbcd"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["3-body", "Subsection",
 CellChangeTimes->{{3.8851105707766137`*^9, 3.885110571588794*^9}},
 CellTags->
  "Evaluation",ExpressionUUID->"d01d56eb-8108-44d6-a33d-d966ebb2ff93"],

Cell[CellGroupData[{

Cell[TextData[{
 "Full phase space in terms of energies ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["E", "1"], ",", 
    SubscriptBox["E", "3"], ",", " ", "and", " "}], TraditionalForm]],
  ExpressionUUID->"254cca9e-b479-4e0b-8869-27418ce20526"],
 "uniformly distributed angles"
}], "Subsubsection",
 CellChangeTimes->{{3.888740449707328*^9, 3.888740469601725*^9}},
 CellTags->
  "Evaluation",ExpressionUUID->"b675334d-c2db-4331-8cc4-db8d7e72ed56"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Rotation", " ", "matrices", " ", "with", " ", "around", " ", "z", " ", 
    "axis", " ", 
    RowBox[{"(", 
     RowBox[{"\[Phi]", " ", "angle"}], ")"}], " ", "and", " ", "x", " ", 
    "axis", " ", 
    RowBox[{"(", 
     RowBox[{"\[Theta]", " ", "angle"}], ")"}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"\[Phi]RotMatrix", "[", "\[Phi]_", "]"}], "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Cos", "[", "\[Phi]", "]"}], ",", 
         RowBox[{"Sin", "[", "\[Phi]", "]"}], ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", 
          RowBox[{"Sin", "[", "\[Phi]", "]"}]}], ",", 
         RowBox[{"Cos", "[", "\[Phi]", "]"}], ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Theta]RotMatrix", "[", "\[Theta]_", "]"}], "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{"Cos", "[", "\[Theta]", "]"}], ",", 
         RowBox[{"Sin", "[", "\[Theta]", "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{"-", 
          RowBox[{"Sin", "[", "\[Theta]", "]"}]}], ",", 
         RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "}"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"pvecRotated", "[", 
      RowBox[{
      "px_", ",", "py_", ",", "pz_", ",", "\[Theta]V_", ",", "\[Phi]V_"}], 
      "]"}], "=", 
     RowBox[{
      RowBox[{"\[Phi]RotMatrix", "[", "\[Phi]V", "]"}], ".", 
      RowBox[{"\[Theta]RotMatrix", "[", "\[Theta]V", "]"}], ".", 
      RowBox[{"{", 
       RowBox[{"px", ",", "py", ",", "pz"}], "}"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Momenta", " ", "at", " ", "frame", " ", "where", " ", 
     SubscriptBox["p", "1"], " ", "is", " ", "aligned", " ", "along", " ", 
     "z", " ", "axis"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"p1unrotated", "=", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", 
       RowBox[{"pPar", "[", 
        RowBox[{"E1", ",", "m1"}], "]"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"p2unrotated", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"pPar", "[", 
         RowBox[{
          RowBox[{"E2valEnergies", "[", 
           RowBox[{"m", ",", "E1", ",", "E3"}], "]"}], ",", "m2"}], "]"}], 
        "*", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Theta]12", "[", 
          RowBox[{
          "E1", ",", "E3", ",", "m", ",", "m1", ",", "m2", ",", "m3"}], "]"}],
          "]"}], "*", 
        RowBox[{"Sin", "[", "\[Kappa]", "]"}]}], ",", 
       RowBox[{
        RowBox[{"pPar", "[", 
         RowBox[{
          RowBox[{"E2valEnergies", "[", 
           RowBox[{"m", ",", "E1", ",", "E3"}], "]"}], ",", "m2"}], "]"}], 
        "*", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Theta]12", "[", 
          RowBox[{
          "E1", ",", "E3", ",", "m", ",", "m1", ",", "m2", ",", "m3"}], "]"}],
          "]"}], "*", 
        RowBox[{"Cos", "[", "\[Kappa]", "]"}]}], ",", 
       RowBox[{
        RowBox[{"pPar", "[", 
         RowBox[{
          RowBox[{"E2valEnergies", "[", 
           RowBox[{"m", ",", "E1", ",", "E3"}], "]"}], ",", "m2"}], "]"}], 
        "*", 
        RowBox[{"Cos", "[", 
         RowBox[{"\[Theta]12", "[", 
          RowBox[{
          "E1", ",", "E3", ",", "m", ",", "m1", ",", "m2", ",", "m3"}], "]"}],
          "]"}]}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"p3unrotated", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         RowBox[{"pPar", "[", 
          RowBox[{"E3", ",", "m3"}], "]"}]}], "*", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Theta]13", "[", 
          RowBox[{
          "E1", ",", "E3", ",", "m", ",", "m1", ",", "m2", ",", "m3"}], "]"}],
          "]"}], "*", 
        RowBox[{"Sin", "[", "\[Kappa]", "]"}]}], ",", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"pPar", "[", 
          RowBox[{"E3", ",", "m3"}], "]"}]}], "*", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Theta]13", "[", 
          RowBox[{
          "E1", ",", "E3", ",", "m", ",", "m1", ",", "m2", ",", "m3"}], "]"}],
          "]"}], "*", 
        RowBox[{"Cos", "[", "\[Kappa]", "]"}]}], ",", 
       RowBox[{
        RowBox[{"pPar", "[", 
         RowBox[{"E3", ",", "m3"}], "]"}], "*", 
        RowBox[{"Cos", "[", 
         RowBox[{"\[Theta]13", "[", 
          RowBox[{
          "E1", ",", "E3", ",", "m", ",", "m1", ",", "m2", ",", "m3"}], "]"}],
          "]"}]}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"\[Theta]rand", "=", 
      RowBox[{"RandomReal", "[", 
       RowBox[{"{", 
        RowBox[{"0", ",", "Pi"}], "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"\[Phi]rand", "=", 
      RowBox[{"RandomReal", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "Pi"}], ",", "Pi"}], "}"}], "]"}]}], ";"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"p1rotatedX", "[", 
        RowBox[{"E1_", ",", "m1_", ",", "\[Theta]V_", ",", "\[Phi]V_"}], 
        "]"}], ",", 
       RowBox[{"p1rotatedY", "[", 
        RowBox[{"E1_", ",", "m1_", ",", "\[Theta]V_", ",", "\[Phi]V_"}], 
        "]"}], ",", 
       RowBox[{"p1rotatedZ", "[", 
        RowBox[{"E1_", ",", "m1_", ",", "\[Theta]V_", ",", "\[Phi]V_"}], 
        "]"}]}], "}"}], "=", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"\[Phi]RotMatrix", "[", "\[Phi]V", "]"}], ".", 
       RowBox[{"\[Theta]RotMatrix", "[", "\[Theta]V", "]"}], ".", 
       "p1Unrotated"}], "*)"}], 
     RowBox[{"pvecRotated", "[", 
      RowBox[{
       RowBox[{"p1unrotated", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", 
       RowBox[{"p1unrotated", "[", 
        RowBox[{"[", "2", "]"}], "]"}], ",", 
       RowBox[{"p1unrotated", "[", 
        RowBox[{"[", "3", "]"}], "]"}], ",", "\[Theta]V", ",", "\[Phi]V"}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"p2rotatedX", "[", 
        RowBox[{
        "E1_", ",", "E3_", ",", "m_", ",", "m1_", ",", "m2_", ",", "m3_", ",",
          "\[Theta]V_", ",", "\[Phi]V_", ",", "\[Kappa]_"}], "]"}], ",", 
       RowBox[{"p2rotatedY", "[", 
        RowBox[{
        "E1_", ",", "E3_", ",", "m_", ",", "m1_", ",", "m2_", ",", "m3_", ",",
          "\[Theta]V_", ",", "\[Phi]V_", ",", "\[Kappa]_"}], "]"}], ",", 
       RowBox[{"p2rotatedZ", "[", 
        RowBox[{
        "E1_", ",", "E3_", ",", "m_", ",", "m1_", ",", "m2_", ",", "m3_", ",",
          "\[Theta]V_", ",", "\[Phi]V_", ",", "\[Kappa]_"}], "]"}]}], "}"}], 
     "=", 
     RowBox[{
      RowBox[{"pvecRotated", "[", 
       RowBox[{
        RowBox[{"p2unrotated", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", 
        RowBox[{"p2unrotated", "[", 
         RowBox[{"[", "2", "]"}], "]"}], ",", 
        RowBox[{"p2unrotated", "[", 
         RowBox[{"[", "3", "]"}], "]"}], ",", "\[Theta]V", ",", "\[Phi]V"}], 
       "]"}], "//", "Simplify"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"p3rotatedX", "[", 
        RowBox[{
        "E1_", ",", "E3_", ",", "m_", ",", "m1_", ",", "m2_", ",", "m3_", ",",
          "\[Theta]V_", ",", "\[Phi]V_", ",", "\[Kappa]_"}], "]"}], ",", 
       RowBox[{"p3rotatedY", "[", 
        RowBox[{
        "E1_", ",", "E3_", ",", "m_", ",", "m1_", ",", "m2_", ",", "m3_", ",",
          "\[Theta]V_", ",", "\[Phi]V_", ",", "\[Kappa]_"}], "]"}], ",", 
       RowBox[{"p3rotatedZ", "[", 
        RowBox[{
        "E1_", ",", "E3_", ",", "m_", ",", "m1_", ",", "m2_", ",", "m3_", ",",
          "\[Theta]V_", ",", "\[Phi]V_", ",", "\[Kappa]_"}], "]"}]}], "}"}], 
     "=", 
     RowBox[{
      RowBox[{"pvecRotated", "[", 
       RowBox[{
        RowBox[{"p3unrotated", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", 
        RowBox[{"p3unrotated", "[", 
         RowBox[{"[", "2", "]"}], "]"}], ",", 
        RowBox[{"p3unrotated", "[", 
         RowBox[{"[", "3", "]"}], "]"}], ",", "\[Theta]V", ",", "\[Phi]V"}], 
       "]"}], "//", "Simplify"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.875774080283636*^9, 3.8757740812840986`*^9}, {
  3.9137109662938423`*^9, 3.9137109804364815`*^9}, {3.913711066503023*^9, 
  3.91371115073063*^9}},
 CellTags->"Evaluation",
 CellLabel->
  "In[1108]:=",ExpressionUUID->"3833a449-84e5-4bfe-98f1-7f94cf51d80b"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Table with distributions", "Subsubsection",
 CellChangeTimes->{{3.88874044132189*^9, 3.8887404447294207`*^9}},
 CellTags->
  "Evaluation",ExpressionUUID->"16977a76-d291-4155-8cc8-6ffad80b8c7e"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "The", " ", "block", " ", "that", " ", "produces", " ", "random", " ", 
     "energies", " ", 
     SubscriptBox["E", "1"]}], ",", 
    RowBox[{
     RowBox[{
      SubscriptBox["E", "3"], " ", "from", " ", "3"}], "-", 
     RowBox[{"body", " ", "phase", " ", "space"}], " ", "-", " ", 
     RowBox[{"assuming", " ", "uniform", " ", 
      SuperscriptBox["M", "2"], " ", 
      RowBox[{"(", 
       RowBox[{"preliminary", " ", "sampling"}], ")"}], " ", "and", " ", "do",
       " ", "not", " ", "taking", " ", "into", " ", "account", " ", 
      SubscriptBox["\[CapitalDelta]E", "3"], 
      RowBox[{"(", 
       SubscriptBox["E", "1"], ")"}]}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"It", " ", "first", " ", "generates", " ", 
     SubscriptBox["E", "1"], " ", "within", " ", 
     SubscriptBox["E", 
      RowBox[{"1", ",", "min"}]]}], ",", 
    RowBox[{
     SubscriptBox["E", 
      RowBox[{"1", ",", "max"}]], ".", " ", "Then"}], ",", " ", 
    RowBox[{"it", " ", "generates", " ", 
     SubscriptBox["E", "3"], " ", "until", " ", "it", " ", "is", " ", 
     "within", " ", "the", " ", "range", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        SubscriptBox["E", 
         RowBox[{"3", ",", "min"}]], 
        RowBox[{"(", 
         SubscriptBox["E", "1"], ")"}]}], ",", 
       RowBox[{
        SubscriptBox["E", 
         RowBox[{"3", ",", "max"}]], 
        RowBox[{"(", 
         SubscriptBox["E", "1"], ")"}]}]}], "}"}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"BlockRandomEnergiesOld", "=", 
     RowBox[{"Compile", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "m", ",", "m1", ",", "m2", ",", "m3", ",", "E1min", ",", "E1max"}], 
        "}"}], ",", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"E1r", "=", "0."}], ",", 
           RowBox[{"E2v", "=", "0."}], ",", 
           RowBox[{"E3r", "=", "0."}]}], "}"}], ",", 
         RowBox[{
          RowBox[{"While", "[", 
           RowBox[{
            RowBox[{"E3r", "=", 
             RowBox[{"RandomReal", "[", 
              RowBox[{"{", 
               RowBox[{"m3", ",", 
                FractionBox[
                 RowBox[{
                  SuperscriptBox["m", "2"], "+", 
                  SuperscriptBox["m3", "2"], "-", 
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{"m1", "+", "m2"}], ")"}], "2"]}], 
                 RowBox[{"2", "*", "m"}]]}], "}"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"E1r", "=", 
             RowBox[{"RandomReal", "[", 
              RowBox[{"{", 
               RowBox[{"E1min", ",", "E1max"}], "}"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"E2v", "=", 
             RowBox[{"m", "-", "E1r", "-", "E3r"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"E2v", "\[LessEqual]", "m2"}], "||", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 SuperscriptBox["E2v", "2"], "-", 
                 SuperscriptBox["m2", "2"], "-", 
                 RowBox[{"(", 
                  RowBox[{
                   SuperscriptBox["E1r", "2"], "-", 
                   SuperscriptBox["m1", "2"]}], ")"}], "-", 
                 RowBox[{"(", 
                  RowBox[{
                   SuperscriptBox["E3r", "2"], "-", 
                   SuperscriptBox["m3", "2"]}], ")"}]}], ")"}], "2"], 
              "\[GreaterEqual]", 
              RowBox[{"4", "*", 
               RowBox[{"(", 
                RowBox[{
                 SuperscriptBox["E1r", "2"], "-", 
                 SuperscriptBox["m1", "2"]}], ")"}], "*", 
               RowBox[{"(", 
                RowBox[{
                 SuperscriptBox["E3r", "2"], "-", 
                 SuperscriptBox["m3", "2"]}], ")"}]}]}]}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"E1r", ",", "E3r"}], "}"}]}]}], "]"}], ",", 
       RowBox[{"CompilationTarget", "\[Rule]", "\"\<C\>\""}], ",", 
       RowBox[{"RuntimeOptions", "\[Rule]", "\"\<Speed\>\""}], ",", 
       RowBox[{"RuntimeAttributes", "->", 
        RowBox[{"{", "Listable", "}"}]}], ",", 
       RowBox[{"Parallelization", "->", "True"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "The", " ", "routine", " ", "that", " ", "computes", " ", "the", " ", 
      "weights", " ", 
      SuperscriptBox["M", "2"], 
      RowBox[{"(", 
       RowBox[{
        SubscriptBox["E", "1"], ",", 
        SubscriptBox["E", "3"]}], ")"}], 
      SubscriptBox["\[CapitalDelta]E", "3"], 
      RowBox[{"(", 
       SubscriptBox["E", "1"], ")"}], " ", "for", " ", "the", " ", "given", 
      " ", "uniformly", " ", "distributed", " ", 
      SubscriptBox["E", "1"]}], ",", 
     SubscriptBox["E", "3"]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"weightsNonUniformComp", ":=", 
     RowBox[{
      RowBox[{
       RowBox[{"Hold", "@", 
        RowBox[{"Compile", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"tabe1e3", ",", "_Real", ",", "1"}], "}"}], ",", "MASSM",
             ",", "MASS1", ",", "MASS2", ",", "MASS3"}], "}"}], ",", 
          RowBox[{"Module", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"e1", ",", "e3"}], "}"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"e1", "=", 
              RowBox[{"Compile`GetElement", "[", 
               RowBox[{"tabe1e3", ",", "1"}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"e3", "=", 
              RowBox[{"Compile`GetElement", "[", 
               RowBox[{"tabe1e3", ",", "2"}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"Abs", "[", 
              RowBox[{
               RowBox[{"distr", "[", 
                RowBox[{"e1", ",", "e3"}], "]"}], "*", 
               RowBox[{"\[CapitalDelta]E3", "[", 
                RowBox[{
                "e1", ",", "MASSM", ",", "MASS1", ",", "MASS2", ",", 
                 "MASS3"}], "]"}]}], "]"}]}]}], "\[IndentingNewLine]", "]"}], 
          ",", 
          RowBox[{"CompilationTarget", "\[Rule]", "\"\<MVM\>\""}], ",", 
          RowBox[{"RuntimeOptions", "\[Rule]", "\"\<Speed\>\""}], ",", 
          RowBox[{"RuntimeAttributes", "->", 
           RowBox[{"{", "Listable", "}"}]}], ",", 
          RowBox[{"Parallelization", "->", "True"}]}], "]"}]}], "/.", 
       RowBox[{"ruleDown", "[", 
        RowBox[{"{", 
         RowBox[{"distr", ",", "\[CapitalDelta]E3"}], "}"}], "]"}]}], "//", 
      "ReleaseHold"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"weightsUniformComp", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"Hold", "@", 
        RowBox[{"Compile", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"tabe1e3", ",", "_Real", ",", "1"}], "}"}], ",", "MASSM",
             ",", "MASS1", ",", "MASS2", ",", "MASS3"}], "}"}], ",", 
          RowBox[{"Module", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"e1", ",", "e3"}], "}"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"e1", "=", 
              RowBox[{"Compile`GetElement", "[", 
               RowBox[{"tabe1e3", ",", "1"}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"Abs", "[", 
              RowBox[{"\[CapitalDelta]E3", "[", 
               RowBox[{
               "e1", ",", "MASSM", ",", "MASS1", ",", "MASS2", ",", "MASS3"}],
                "]"}], "]"}]}]}], "\[IndentingNewLine]", "]"}], ",", 
          RowBox[{"CompilationTarget", "\[Rule]", "\"\<C\>\""}], ",", 
          RowBox[{"RuntimeOptions", "\[Rule]", "\"\<Speed\>\""}], ",", 
          RowBox[{"RuntimeAttributes", "->", 
           RowBox[{"{", "Listable", "}"}]}], ",", 
          RowBox[{"Parallelization", "->", "True"}]}], "]"}]}], "/.", 
       RowBox[{"ruleDown", "[", 
        RowBox[{"{", "\[CapitalDelta]E3", "}"}], "]"}]}], "//", 
      "ReleaseHold"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"E3valsComp", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"Hold", "@", 
       RowBox[{"Compile", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"E1vals", ",", "_Real"}], "}"}], ",", "MASSM", ",", 
           "MASS1", ",", "MASS2", ",", "MASS3"}], "}"}], ",", 
         RowBox[{"Module", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"e3max", ",", "e3min"}], "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"e3min", "=", 
             RowBox[{"Abs", "[", 
              RowBox[{"E3domain1", "[", 
               RowBox[{
               "E1vals", ",", "MASSM", ",", "MASS1", ",", "MASS2", ",", 
                "MASS3"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"e3max", "=", 
             RowBox[{"Abs", "[", 
              RowBox[{"E3domain2", "[", 
               RowBox[{
               "E1vals", ",", "MASSM", ",", "MASS1", ",", "MASS2", ",", 
                "MASS3"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"RandomReal", "[", 
             RowBox[{"{", 
              RowBox[{"e3min", ",", "e3max"}], "}"}], "]"}]}]}], 
          "\[IndentingNewLine]", "]"}], ",", 
         RowBox[{"CompilationTarget", "->", "\"\<C\>\""}], ",", 
         RowBox[{"RuntimeOptions", "->", "\"\<Speed\>\""}], ",", 
         RowBox[{"RuntimeAttributes", "->", 
          RowBox[{"{", "Listable", "}"}]}], ",", 
         RowBox[{"Parallelization", "->", "True"}]}], "]"}]}], "/.", 
      RowBox[{"ruleDown", "[", 
       RowBox[{"{", 
        RowBox[{"E3domain2", ",", "E3domain1"}], "}"}], "]"}]}], "//", 
     "ReleaseHold"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"NN", "=", 
     SuperscriptBox["10", "6"]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BlockRandomEnergies", "[", 
     RowBox[{"LLP_", ",", "Process_", ",", "mLLP_", ",", "Nevents_"}], "]"}], 
    ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"partcontent", ",", "m", ",", "m1", ",", "m2", ",", "m3"}], 
       "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"partcontent", "=", 
        RowBox[{"ReactionProductsList", "[", 
         RowBox[{"LLP", ",", "Process"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"m", ",", "m1", ",", "m2", ",", "m3"}], "}"}], "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"mSM", "[", 
           RowBox[{"partcontent", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
          RowBox[{"mSM", "[", 
           RowBox[{"partcontent", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"partcontent", "[", 
              RowBox[{"[", "3", "]"}], "]"}], "==", "LLP"}], ",", "mLLP", ",", 
            RowBox[{"mSM", "[", 
             RowBox[{"partcontent", "[", 
              RowBox[{"[", "3", "]"}], "]"}], "]"}]}], "]"}], ",", "mLLP"}], 
         "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"distr", "[", 
         RowBox[{"E1_", ",", "E3_"}], "]"}], "=", 
        RowBox[{
         RowBox[{"Msquared3Body", "[", 
          RowBox[{"LLP", ",", "Process", ",", "m", ",", "E1", ",", "E3"}], 
          "]"}], "//", "Simplify"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"E1maxval", "=", 
        RowBox[{
         RowBox[{"E1domain", "[", 
          RowBox[{"m", ",", "m1", ",", "m2", ",", "m3"}], "]"}], "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"E1vals", "=", 
        RowBox[{"RandomReal", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"m1", ",", "E1maxval"}], "}"}], ",", 
          RowBox[{"Max", "[", 
           RowBox[{"NN", ",", "Nevents"}], "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"E3vals", "=", 
        RowBox[{"E3valsComp", "[", 
         RowBox[{"E1vals", ",", "m", ",", "m1", ",", "m2", ",", "m3"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"tabE1E3unweighted", "=", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"E1vals", ",", "E3vals"}], "}"}], "//", "Transpose"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "Weights", " ", "for", " ", "the", " ", "generated", " ", "values", 
         " ", "of", " ", 
         RowBox[{"{", 
          RowBox[{"E1", ",", "E3"}], "}"}], " ", "from", " ", "matrix", " ", 
         "element", " ", "squared"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"distr", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"tabE1E3unweighted", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            RowBox[{
             RowBox[{"tabE1E3unweighted", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "!=", "1"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
          "Table", " ", "with", " ", "random", " ", "energies", " ", 
           "distributed", " ", "in", " ", "the", " ", "Dalitz", " ", "range", 
           " ", "before", " ", "accounting", " ", "for", " ", "weights"}], 
          "*)"}], "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"weights1", "=", "weightsNonUniformComp"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"Weights", " ", "from", " ", "matrix", " ", 
             RowBox[{"element", ".", " ", "Near"}], " ", "the", " ", 
             "boundary", " ", "values", " ", "of", " ", "E1"}], ",", " ", 
            "E3", ",", " ", 
            RowBox[{"they", " ", "may", " ", "become", " ", "negative", " ", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Mathematica", "'"}], "s", " ", "numeric", " ", 
                "inaccuracy"}], ")"}], ".", " ", "Because"}], " ", "of", " ", 
             "that"}], ",", " ", 
            RowBox[{
            "I", " ", "will", " ", "just", " ", "replace", " ", "such", " ", 
             "weights", " ", "by", " ", "zero"}]}], "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"weights", "=", 
           RowBox[{"weights1", "[", 
            RowBox[{
            "tabE1E3unweighted", ",", "m", ",", "m1", ",", "m2", ",", "m3"}], 
            "]"}]}], 
          RowBox[{"(*", 
           RowBox[{"/.", 
            RowBox[{
             RowBox[{"_", "?", "Negative"}], "\[Rule]", "0"}]}], "*)"}], 
          ";"}], "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"weights1", "=", "weightsUniformComp"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"weights", "=", 
           RowBox[{"weights1", "[", 
            RowBox[{
            "tabE1E3unweighted", ",", "m", ",", "m1", ",", "m2", ",", "m3"}], 
            "]"}]}], 
          RowBox[{"(*", 
           RowBox[{"/.", 
            RowBox[{
             RowBox[{"_", "?", "Negative"}], "\[Rule]", "0"}]}], "*)"}], 
          ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"True", " ", "random", " ", 
         RowBox[{"energies", ".", " ", "Computed"}], " ", "via", " ", 
         "empirical", " ", "distribution", " ", "from", " ", "the", " ", 
         "weigthed", " ", "data"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"RandomChoice", "[", 
        RowBox[{
         RowBox[{"weights", "->", "tabE1E3unweighted"}], ",", "Nevents"}], 
        "]"}]}]}], "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"(*", 
       RowBox[{"Weighted", " ", "random", " ", "points"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"weightedData", "=", 
        RowBox[{"WeightedData", "[", 
         RowBox[{"tabE1E3unweighted", ",", "weights"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"True", " ", "random", " ", 
         RowBox[{"energies", ".", " ", "Computed"}], " ", "via", " ", 
         "empirical", " ", "distribution", " ", "from", " ", "the", " ", 
         "weigthed", " ", "data"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"edist", "=", 
        RowBox[{"EmpiricalDistribution", "[", "weightedData", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"RandomVariate", "[", 
        RowBox[{"edist", ",", "Nevents"}], "]"}], ";"}], "*)"}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"(*", "Temp", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"E12E23domain", "[", 
     RowBox[{
     "m_", ",", "m1_", ",", "m2_", ",", "m3_", ",", "Emin_", ",", "Emax_"}], 
     "]"}], ":=", 
    RowBox[{"NIntegrate", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"UnitStep", "[", 
        RowBox[{"E3v", "-", "Emin"}], "]"}], "*", 
       RowBox[{"UnitStep", "[", 
        RowBox[{"Emax", "-", "E3v"}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"E1v", ",", 
        RowBox[{
         RowBox[{"E1domain", "[", 
          RowBox[{"m", ",", "m1", ",", "m2", ",", "m3"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", 
        RowBox[{
         RowBox[{"E1domain", "[", 
          RowBox[{"m", ",", "m1", ",", "m2", ",", "m3"}], "]"}], "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"E3v", ",", 
        RowBox[{"Max", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"E3domain", "[", 
            RowBox[{"E1v", ",", "m", ",", "m1", ",", "m2", ",", "m3"}], "]"}],
            "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", "Emin"}], "]"}], ",", 
        RowBox[{"Min", "[", 
         RowBox[{"Emax", ",", 
          RowBox[{
           RowBox[{"E3domain", "[", 
            RowBox[{"E1v", ",", "m", ",", "m1", ",", "m2", ",", "m3"}], "]"}],
            "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "}"}], ",", 
      RowBox[{"Method", "\[Rule]", "\"\<AdaptiveMonteCarlo\>\""}]}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
       "The", " ", "block", " ", "that", " ", "returns", " ", "the", " ", 
        "phase", " ", "space", " ", "of", " ", "3"}], "-", 
       RowBox[{"body", " ", "decays", " ", "0"}]}], " ", "->", " ", 
      RowBox[{"1", "+", "2", "+", 
       RowBox[{
       "3", " ", "given", " ", "the", " ", "set", " ", "of", " ", "energies", 
        " ", 
        SubscriptBox["E", "1"]}]}]}], ",", 
     RowBox[{
      SubscriptBox["E", "3"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"obtained", " ", "after", " ", "re"}], "-", 
        RowBox[{"sampling", " ", "with", " ", "the", " ", "true", " ", 
         SuperscriptBox["M", "2"]}]}], ")"}]}], ",", " ", 
     RowBox[{"the", " ", "angles", " ", "\[Theta]"}], ",", "\[Phi]"}], "*)"}],
    "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"tabPS3bodyCompiled", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"Hold", "@", 
        RowBox[{"Compile", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"tabPSenergies", ",", "_Real", ",", "1"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"MASSM", ",", "_Real"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"MASS1", ",", "_Real"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"MASS2", ",", "_Real"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"MASS3", ",", "_Real"}], "}"}]}], "}"}], ",", 
          RowBox[{"Module", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
             "e1", ",", "e3", ",", "p1x", ",", "p1y", ",", "p1z", ",", "p2x", 
              ",", "p2y", ",", "p2z", ",", "p3x", ",", "p3y", ",", "p3z", ",",
               "\[Theta]randTab", ",", "\[Phi]randTab", ",", 
              "\[Kappa]randTab"}], "}"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"e1", "=", 
              RowBox[{"Compile`GetElement", "[", 
               RowBox[{"tabPSenergies", ",", "1"}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"e3", "=", 
              RowBox[{"Compile`GetElement", "[", 
               RowBox[{"tabPSenergies", ",", "2"}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{
               RowBox[{
               "Angles", " ", "relating", " ", "generated", " ", "energies", 
                " ", "to", " ", "the", " ", "4"}], "-", "momenta"}], "*)"}], 
             "\[IndentingNewLine]", 
             RowBox[{"\[Theta]randTab", "=", 
              RowBox[{"ArcCos", "[", 
               RowBox[{"RandomReal", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"\[Phi]randTab", "=", 
              RowBox[{"RandomReal", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "Pi"}], ",", "Pi"}], "}"}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"\[Kappa]randTab", "=", 
              RowBox[{"RandomReal", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "Pi"}], ",", "Pi"}], "}"}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"p2x", "=", 
              RowBox[{"p2rotatedX", "[", 
               RowBox[{
               "e1", ",", "e3", ",", "MASSM", ",", "MASS1", ",", "MASS2", ",",
                 "MASS3", ",", "\[Theta]randTab", ",", "\[Phi]randTab", ",", 
                "\[Kappa]randTab"}], "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"p2y", "=", 
              RowBox[{"p2rotatedY", "[", 
               RowBox[{
               "e1", ",", "e3", ",", "MASSM", ",", "MASS1", ",", "MASS2", ",",
                 "MASS3", ",", "\[Theta]randTab", ",", "\[Phi]randTab", ",", 
                "\[Kappa]randTab"}], "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"p2z", "=", 
              RowBox[{"p2rotatedZ", "[", 
               RowBox[{
               "e1", ",", "e3", ",", "MASSM", ",", "MASS1", ",", "MASS2", ",",
                 "MASS3", ",", "\[Theta]randTab", ",", "\[Phi]randTab", ",", 
                "\[Kappa]randTab"}], "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"p3x", "=", 
              RowBox[{"p3rotatedX", "[", 
               RowBox[{
               "e1", ",", "e3", ",", "MASSM", ",", "MASS1", ",", "MASS2", ",",
                 "MASS3", ",", "\[Theta]randTab", ",", "\[Phi]randTab", ",", 
                "\[Kappa]randTab"}], "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"p3y", "=", 
              RowBox[{"p3rotatedY", "[", 
               RowBox[{
               "e1", ",", "e3", ",", "MASSM", ",", "MASS1", ",", "MASS2", ",",
                 "MASS3", ",", "\[Theta]randTab", ",", "\[Phi]randTab", ",", 
                "\[Kappa]randTab"}], "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"p3z", "=", 
              RowBox[{"p3rotatedZ", "[", 
               RowBox[{
               "e1", ",", "e3", ",", "MASSM", ",", "MASS1", ",", "MASS2", ",",
                 "MASS3", ",", "\[Theta]randTab", ",", "\[Phi]randTab", ",", 
                "\[Kappa]randTab"}], "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"p1x", "=", 
              RowBox[{
               RowBox[{"-", "p2x"}], "-", "p3x"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"p1y", "=", 
              RowBox[{
               RowBox[{"-", "p2y"}], "-", "p3y"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"p1z", "=", 
              RowBox[{
               RowBox[{"-", "p2z"}], "-", "p3z"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{
              "p1x", ",", "p1y", ",", "p1z", ",", "e1", ",", "MASS1", ",", 
               "p2x", ",", "p2y", ",", "p2z", ",", 
               RowBox[{"MASSM", "-", "e1", "-", "e3"}], ",", "MASS2", ",", 
               "p3x", ",", "p3y", ",", "p3z", ",", "e3", ",", "MASS3"}], 
              "}"}]}]}], "\[IndentingNewLine]", "]"}], ",", 
          RowBox[{"CompilationTarget", "\[Rule]", "\"\<C\>\""}], ",", 
          RowBox[{"RuntimeOptions", "\[Rule]", "\"\<Speed\>\""}], ",", 
          RowBox[{"RuntimeAttributes", "->", 
           RowBox[{"{", "Listable", "}"}]}], ",", 
          RowBox[{"Parallelization", "->", "True"}]}], "]"}]}], "/.", 
       RowBox[{"ruleDown", "[", 
        RowBox[{"{", 
         RowBox[{
         "p2rotatedX", ",", "p2rotatedY", ",", "p2rotatedZ", ",", 
          "p3rotatedX", ",", "p3rotatedY", ",", "p3rotatedZ"}], "}"}], 
        "]"}]}], "//", "ReleaseHold"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"<<", "CompiledFunctionTools`"}], "\n", 
   RowBox[{
    RowBox[{"CompilePrint", "@", "tabPS3bodyCompiled"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "The", " ", "block", " ", "that", " ", "collects", " ", "altogether", 
      " ", "and", " ", "produces", " ", "the", " ", "phase", " ", "space", 
      " ", "of", " ", "3"}], "-", 
     RowBox[{"body", " ", "decay", " ", "with", " ", "LLPs", " ", "only"}]}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ThreeBodyDecaysEventsAtRest", "[", 
     RowBox[{"LLP_", ",", "Process_", ",", "mLLP_", ",", "Nevents_"}], "]"}], 
    ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"partcontent", 
        RowBox[{"(*", 
         RowBox[{",", "MASSM", ",", "MASS1", ",", "MASS2", ",", "MASS3"}], 
         "*)"}], ",", "E1maxval"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "___", "___", "___", "___", "___", "___", "___", "___", "___", "___", 
        "___", "__"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "Extracting", " ", "information", " ", "about", " ", "the", " ", 
        "decay"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "___", "___", "___", "___", "___", "___", "___", "___", "___", "___", 
        "___", "__"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"partcontent", "=", 
        RowBox[{"ReactionProductsList", "[", 
         RowBox[{"LLP", ",", "Process"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"MASSM", ",", "MASS1", ",", "MASS2", ",", "MASS3"}], "}"}], 
        "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"mSM", "[", 
           RowBox[{"partcontent", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
          RowBox[{"mSM", "[", 
           RowBox[{"partcontent", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"partcontent", "[", 
              RowBox[{"[", "3", "]"}], "]"}], "==", "LLP"}], ",", "mLLP", ",", 
            RowBox[{"mSM", "[", 
             RowBox[{"partcontent", "[", 
              RowBox[{"[", "3", "]"}], "]"}], "]"}]}], "]"}], ",", "mLLP"}], 
         "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "___", "___", "___", "___", "___", "___", "___", "___", "___", "___", 
         "___", "__"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Generating", " ", "the", " ", "true", " ", 
          SubscriptBox["E", "1"]}], ",", 
         RowBox[{
          RowBox[{
           SubscriptBox["E", "3"], " ", "for", " ", "the", " ", "decay", " ", 
           "process", " ", "0"}], "->", 
          RowBox[{"1", "+", "2", "+", "3"}]}]}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "___", "___", "___", "___", "___", "___", "___", "___", "___", "___", 
         "___", "__"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"tabE1E3true", "=", 
        RowBox[{"BlockRandomEnergies", "[", 
         RowBox[{"LLP", ",", "Process", ",", "mLLP", ",", "Nevents"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "___", "___", "___", "___", "___", "___", "___", "___", "___", "___", 
         "___", "___", "___", "___", "___"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Final", " ", "phase", " ", "space"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "___", "___", "___", "___", "___", "___", "___", "___", "___", "___", 
         "___", "___", "___", "___", "___"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"tabPS3bodyTemp", "=", 
        RowBox[{"tabPS3bodyCompiled", "[", 
         RowBox[{
         "tabE1E3true", ",", "MASSM", ",", "MASS1", ",", "MASS2", ",", 
          "MASS3"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"If", " ", "there", " ", "are", " ", "two", " ", "LLPs"}], 
         ",", " ", 
         RowBox[{
         "then", " ", "the", " ", "code", " ", "below", " ", "extracts", " ", 
          "their", " ", "data", " ", "and", " ", "combines", " ", "in", " ", 
          "a", " ", "way", " ", "such", " ", "that", " ", "the", " ", "data", 
          " ", "for", " ", "two", " ", "LLPs", " ", "from", " ", "each", " ", 
          "decay", " ", "is", " ", 
          RowBox[{"neighboring", ".", " ", "Otherwise"}]}], ",", " ", 
         RowBox[{
         "it", " ", "just", " ", "extracts", " ", "the", " ", "data", " ", 
          "per", " ", "one", " ", "LLP"}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"tabPS3body", "=", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"partcontent", "[", 
            RowBox[{"[", "3", "]"}], "]"}], "==", "LLP"}], ",", 
          RowBox[{"Riffle", "[", 
           RowBox[{
            RowBox[{"tabPS3bodyTemp", "[", 
             RowBox[{"[", 
              RowBox[{"All", ",", 
               RowBox[{"Range", "[", 
                RowBox[{"6", ",", "10"}], "]"}]}], "]"}], "]"}], ",", 
            RowBox[{"tabPS3bodyTemp", "[", 
             RowBox[{"[", 
              RowBox[{"All", ",", 
               RowBox[{"Range", "[", 
                RowBox[{"11", ",", "15"}], "]"}]}], "]"}], "]"}]}], "]"}], 
          ",", 
          RowBox[{"tabPS3bodyTemp", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", 
             RowBox[{"Range", "[", 
              RowBox[{"11", ",", "15"}], "]"}]}], "]"}], "]"}]}], "]"}]}], 
       ";", "\[IndentingNewLine]", "tabPS3body"}]}], "\[IndentingNewLine]", 
     "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.913264710200877*^9, 3.913265115758671*^9}, {
   3.913265173305608*^9, 3.913265354266617*^9}, {3.913265400759661*^9, 
   3.91326567779567*^9}, {3.9132657631419477`*^9, 3.913265917086711*^9}, 
   3.913266303168403*^9, {3.913266358692699*^9, 3.913266563737873*^9}, {
   3.913266635521587*^9, 3.913266994761554*^9}, 3.913267055435528*^9, 
   3.913267085549587*^9, {3.913267130688492*^9, 3.913267131792413*^9}, {
   3.913267174056632*^9, 3.9132671795072765`*^9}, {3.9132672142027273`*^9, 
   3.913267217450534*^9}, {3.913267249698397*^9, 3.91326724990281*^9}, {
   3.9132747674345856`*^9, 3.91327477244037*^9}, {3.913274928484173*^9, 
   3.913275054589828*^9}, {3.91327510197361*^9, 3.913275137363209*^9}, {
   3.9132785822789145`*^9, 3.9132785823886557`*^9}, 3.913280729333438*^9, {
   3.9132814373908*^9, 3.913281442333693*^9}, {3.913350694530268*^9, 
   3.9133506972804146`*^9}, {3.913355961160433*^9, 3.913355963561562*^9}, {
   3.913394330225109*^9, 3.913394334846341*^9}, {3.913401155625531*^9, 
   3.9134011601769285`*^9}, 3.913452782115724*^9, {3.915438811673065*^9, 
   3.915438811745575*^9}, 3.915440966148792*^9, {3.915604420525011*^9, 
   3.9156045240674953`*^9}, {3.91560458479875*^9, 3.915604587715353*^9}, {
   3.91560585077905*^9, 3.915605943434367*^9}, {3.915606141299294*^9, 
   3.915606151077884*^9}, {3.915606581883541*^9, 3.9156065898619905`*^9}, {
   3.915606920907429*^9, 3.915606966802859*^9}, {3.915607001062357*^9, 
   3.9156070077858124`*^9}, {3.9156072037535563`*^9, 3.915607206257887*^9}, {
   3.9156078532517366`*^9, 3.915607856169332*^9}, {3.915607908855616*^9, 
   3.9156079134496593`*^9}, {3.915611741282547*^9, 3.915611744261462*^9}, {
   3.915612098648364*^9, 3.915612101196424*^9}, {3.91561493345383*^9, 
   3.915614978452826*^9}, {3.915615090454375*^9, 3.91561510728859*^9}, {
   3.915615716952904*^9, 3.915615734644256*^9}, {3.9156157694755545`*^9, 
   3.915615790802581*^9}, {3.915615825983793*^9, 3.915615826031905*^9}, {
   3.915615984961304*^9, 3.915615990041733*^9}, {3.9156160546113925`*^9, 
   3.915616096319703*^9}, {3.915616156348111*^9, 3.915616170772035*^9}, {
   3.9156162073987126`*^9, 3.915616223915195*^9}, {3.915616262006734*^9, 
   3.915616339748254*^9}, 3.9156164749502096`*^9, {3.9156165828021665`*^9, 
   3.915616647872923*^9}, {3.915617575896723*^9, 3.91561758674124*^9}, {
   3.915617647285694*^9, 3.91561765241809*^9}, 3.916137560247003*^9, {
   3.916647952343763*^9, 3.91664808622732*^9}, {3.916648390498725*^9, 
   3.916648413324727*^9}, {3.9166487312097588`*^9, 3.916648743147747*^9}, {
   3.916649136258546*^9, 3.91664913947373*^9}, {3.916649599785737*^9, 
   3.9166496289963713`*^9}},
 CellTags->"Evaluation",
 CellLabel->
  "In[1117]:=",ExpressionUUID->"7385994f-8eee-4fd5-9f1f-28cba2f65c54"],

Cell[BoxData[
 FormBox[
  InterpretationBox[
   RowBox[{
    TagBox["CompiledFunction",
     "SummaryHead"], "[", 
    DynamicModuleBox[{Typeset`open$$ = False, Typeset`embedState$$ = "Ready"}, 
     TemplateBox[{
       PaneSelectorBox[{False -> GridBox[{{
             PaneBox[
              ButtonBox[
               DynamicBox[
                FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxOpener"]], 
               ButtonFunction :> (Typeset`open$$ = True), Appearance -> None, 
               BaseStyle -> {}, Evaluator -> Automatic, Method -> 
               "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
              Dynamic[{
                Automatic, 
                 3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                  Magnification])}]], 
             GraphicsBox[{
               Thickness[0.038461538461538464`], {
                FaceForm[{
                  GrayLevel[0.93], 
                  Opacity[1.]}], 
                
                FilledCurveBox[{{{1, 4, 3}, {0, 1, 0}, {1, 3, 3}, {0, 1, 0}, {
                 1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {0, 1, 0}}}, {{{
                 25.499999999999996`, 2.5}, {25.499999999999996`, 
                 1.3953100000000003`}, {24.604699999999998`, 
                 0.49999999999999994`}, {23.5, 0.49999999999999994`}, {2.5, 
                 0.49999999999999994`}, {1.3953100000000003`, 
                 0.49999999999999994`}, {0.49999999999999994`, 
                 1.3953100000000003`}, {0.49999999999999994`, 2.5}, {
                 0.49999999999999994`, 23.5}, {0.49999999999999994`, 
                 24.604699999999998`}, {1.3953100000000003`, 
                 25.499999999999996`}, {2.5, 25.499999999999996`}, {23.5, 
                 25.499999999999996`}, {24.604699999999998`, 
                 25.499999999999996`}, {25.499999999999996`, 
                 24.604699999999998`}, {25.499999999999996`, 23.5}, {
                 25.499999999999996`, 2.5}}}]}, {
                FaceForm[{
                  RGBColor[0.5, 0.5, 0.5], 
                  Opacity[1.]}], 
                
                FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {
                 0, 1, 0}, {0, 1, 0}, {0, 1, 0}}}, {{{20.5426, 
                 19.116799999999998`}, {16.3832, 21.876199999999997`}, {
                 16.3832, 20.021499999999996`}, {6.930469999999999, 
                 20.021499999999996`}, {6.930469999999999, 
                 18.212100000000003`}, {16.3832, 18.212100000000003`}, {
                 16.3832, 16.357399999999995`}, {20.5426, 
                 19.116799999999998`}}}], 
                
                FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {
                 0, 1, 0}, {0, 1, 0}, {0, 1, 0}}}, {{{5.30508, 13.8391}, {
                 9.46445, 11.079700000000003`}, {9.46445, 
                 12.933999999999997`}, {18.917199999999998`, 
                 12.933999999999997`}, {18.917199999999998`, 14.7438}, {
                 9.46445, 14.7438}, {9.46445, 16.598}, {5.30508, 13.8391}}}], 
                
                
                FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {
                 0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
                 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {
                 1, 3, 3}, {1, 3, 3}, {1, 3, 3}}}, CompressedData["
1:eJxTTMoPSmVmYGBgBGJjIGYCYq4u+eR3VWoOxhkv5j+Qk3SA8fu/r5rKOVHM
Yd2vmNyjZ9Qcrt9QXbW9S8RBg59767IidQcPMYPGaHFhB+Nn61SfiGo4xBwp
T7o2V9Dh0Iolfg6/NBxEHv/x1Xgi4FB1XNNqkqQWnP+axUTQjFkbzn+oO2HB
j/3aDg/Xn5T6WiDoYLs3aJpiqI7DrHN+bO6tQg4zfUR7vF7pQOyfIQyRd9d1
WLL0U1kLoyjEPdm6DpoTXfQX7xBzKPjQejLkhDacL5J4+LL2Gm2HtNnSl4Vf
iELM69J2qPZM3tLnJerQX1oozZugDfHPUxGI/4W1HQ5p3TthoyDi4D7lG1v8
Mi2HgqL9zoEHhB1inOxe3BRG8MH62zXhfIbN1Z82CGhC/GMg4nCm3mN/7TYN
iHlCUPdGakDc/1kUEr46GhD/eYnD+d9iBf/kC0vC+TuCrSL+X5Vy2HGR4R5T
uAbEfxYykPBYp+HQqsCuesZAFhL+rJoQ/2rIQdxTpwkJ7yVycPfD+GDzVqLx
xbUd5HYt2JfqBdWfpA2Jj9mykPDpgYaXtaxDy7yzq86vg8qvlIHE5ylY/Eo7
XAt7o787TxfOB5ufqesQ9PbyxxkPZSDhZ6nrMAGU3u7LQtLLEx2HN2253UbX
ofZ76jis/Pay4oynAsT8QG0HKZMv/gW7FCDyTFpwPsz/MD44/Mw1HFjb1uR9
TVVwWKy880/7FHWIexrkIfLX1RzOMDZZVjHIOaDkh3vSDuj5AwCF11Vc
                 "]]}}, Background -> GrayLevel[0.93], Axes -> False, 
              AspectRatio -> 1, ImageSize -> 
              Dynamic[{
                Automatic, 
                 3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                  Magnification])}], Frame -> True, FrameTicks -> None, 
              FrameStyle -> Directive[
                Thickness[Tiny], 
                GrayLevel[0.7]]], 
             GridBox[{{
                RowBox[{
                  TagBox["\"Argument count: \"", "SummaryItemAnnotation"], 
                  "\[InvisibleSpace]", 
                  TagBox["5", "SummaryItem"]}]}, {
                RowBox[{
                  TagBox["\"Argument types: \"", "SummaryItemAnnotation"], 
                  "\[InvisibleSpace]", 
                  TagBox[
                   StyleBox[
                    PaneBox[
                    RowBox[{"{", 
                    
                    RowBox[{
                    "_Real", ",", "_Real", ",", "_Real", ",", "_Real", ",", 
                    "_Real"}], "}"}], ContentPadding -> False, FrameMargins -> 
                    0, StripOnInput -> True, BaselinePosition -> Baseline, 
                    ImageSize -> {{1, 300}, Automatic}], LineBreakWithin -> 
                    False], "SummaryItem"]}]}}, 
              GridBoxAlignment -> {
               "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
              False, GridBoxItemSize -> {
               "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
              GridBoxSpacings -> {
               "Columns" -> {{2}}, "Rows" -> {{Automatic}}}, 
              BaseStyle -> {
               ShowStringCharacters -> False, NumberMarks -> False, 
                PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
           GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
           AutoDelete -> False, 
           GridBoxItemSize -> {
            "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
           BaselinePosition -> {1, 1}], True -> GridBox[{{
             PaneBox[
              ButtonBox[
               DynamicBox[
                FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxCloser"]], 
               ButtonFunction :> (Typeset`open$$ = False), Appearance -> None,
                BaseStyle -> {}, Evaluator -> Automatic, Method -> 
               "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
              Dynamic[{
                Automatic, 
                 3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                  Magnification])}]], 
             GraphicsBox[{
               Thickness[0.038461538461538464`], {
                FaceForm[{
                  GrayLevel[0.93], 
                  Opacity[1.]}], 
                
                FilledCurveBox[{{{1, 4, 3}, {0, 1, 0}, {1, 3, 3}, {0, 1, 0}, {
                 1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {0, 1, 0}}}, {{{
                 25.499999999999996`, 2.5}, {25.499999999999996`, 
                 1.3953100000000003`}, {24.604699999999998`, 
                 0.49999999999999994`}, {23.5, 0.49999999999999994`}, {2.5, 
                 0.49999999999999994`}, {1.3953100000000003`, 
                 0.49999999999999994`}, {0.49999999999999994`, 
                 1.3953100000000003`}, {0.49999999999999994`, 2.5}, {
                 0.49999999999999994`, 23.5}, {0.49999999999999994`, 
                 24.604699999999998`}, {1.3953100000000003`, 
                 25.499999999999996`}, {2.5, 25.499999999999996`}, {23.5, 
                 25.499999999999996`}, {24.604699999999998`, 
                 25.499999999999996`}, {25.499999999999996`, 
                 24.604699999999998`}, {25.499999999999996`, 23.5}, {
                 25.499999999999996`, 2.5}}}]}, {
                FaceForm[{
                  RGBColor[0.5, 0.5, 0.5], 
                  Opacity[1.]}], 
                
                FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {
                 0, 1, 0}, {0, 1, 0}, {0, 1, 0}}}, {{{20.5426, 
                 19.116799999999998`}, {16.3832, 21.876199999999997`}, {
                 16.3832, 20.021499999999996`}, {6.930469999999999, 
                 20.021499999999996`}, {6.930469999999999, 
                 18.212100000000003`}, {16.3832, 18.212100000000003`}, {
                 16.3832, 16.357399999999995`}, {20.5426, 
                 19.116799999999998`}}}], 
                
                FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {
                 0, 1, 0}, {0, 1, 0}, {0, 1, 0}}}, {{{5.30508, 13.8391}, {
                 9.46445, 11.079700000000003`}, {9.46445, 
                 12.933999999999997`}, {18.917199999999998`, 
                 12.933999999999997`}, {18.917199999999998`, 14.7438}, {
                 9.46445, 14.7438}, {9.46445, 16.598}, {5.30508, 13.8391}}}], 
                
                
                FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {
                 0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
                 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {
                 1, 3, 3}, {1, 3, 3}, {1, 3, 3}}}, CompressedData["
1:eJxTTMoPSmVmYGBgBGJjIGYCYq4u+eR3VWoOxhkv5j+Qk3SA8fu/r5rKOVHM
Yd2vmNyjZ9Qcrt9QXbW9S8RBg59767IidQcPMYPGaHFhB+Nn61SfiGo4xBwp
T7o2V9Dh0Iolfg6/NBxEHv/x1Xgi4FB1XNNqkqQWnP+axUTQjFkbzn+oO2HB
j/3aDg/Xn5T6WiDoYLs3aJpiqI7DrHN+bO6tQg4zfUR7vF7pQOyfIQyRd9d1
WLL0U1kLoyjEPdm6DpoTXfQX7xBzKPjQejLkhDacL5J4+LL2Gm2HtNnSl4Vf
iELM69J2qPZM3tLnJerQX1oozZugDfHPUxGI/4W1HQ5p3TthoyDi4D7lG1v8
Mi2HgqL9zoEHhB1inOxe3BRG8MH62zXhfIbN1Z82CGhC/GMg4nCm3mN/7TYN
iHlCUPdGakDc/1kUEr46GhD/eYnD+d9iBf/kC0vC+TuCrSL+X5Vy2HGR4R5T
uAbEfxYykPBYp+HQqsCuesZAFhL+rJoQ/2rIQdxTpwkJ7yVycPfD+GDzVqLx
xbUd5HYt2JfqBdWfpA2Jj9mykPDpgYaXtaxDy7yzq86vg8qvlIHE5ylY/Eo7
XAt7o787TxfOB5ufqesQ9PbyxxkPZSDhZ6nrMAGU3u7LQtLLEx2HN2253UbX
ofZ76jis/Pay4oynAsT8QG0HKZMv/gW7FCDyTFpwPsz/MD44/Mw1HFjb1uR9
TVVwWKy880/7FHWIexrkIfLX1RzOMDZZVjHIOaDkh3vSDuj5AwCF11Vc
                 "]]}}, Background -> GrayLevel[0.93], Axes -> False, 
              AspectRatio -> 1, ImageSize -> 
              Dynamic[{
                Automatic, 
                 3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                  Magnification])}], Frame -> True, FrameTicks -> None, 
              FrameStyle -> Directive[
                Thickness[Tiny], 
                GrayLevel[0.7]]], 
             GridBox[{{
                RowBox[{
                  TagBox["\"Argument count: \"", "SummaryItemAnnotation"], 
                  "\[InvisibleSpace]", 
                  TagBox["5", "SummaryItem"]}]}, {
                RowBox[{
                  TagBox["\"Argument types: \"", "SummaryItemAnnotation"], 
                  "\[InvisibleSpace]", 
                  TagBox[
                   PaneBox[
                    RowBox[{"{", 
                    
                    RowBox[{
                    "_Real", ",", "_Real", ",", "_Real", ",", "_Real", ",", 
                    "_Real"}], "}"}], ImageSize -> {{1, 500}, Automatic}, 
                    BaselinePosition -> Baseline, ContentPadding -> False, 
                    FrameMargins -> 0, StripOnInput -> True], 
                   "SummaryItem"]}]}, {
                RowBox[{
                  TagBox["\"Variables: \"", "SummaryItemAnnotation"], 
                  "\[InvisibleSpace]", 
                  TagBox[
                   RowBox[{"{", 
                    
                    RowBox[{
                    "E1vals", ",", "MASSM", ",", "MASS1", ",", "MASS2", ",", 
                    "MASS3"}], "}"}], "SummaryItem"]}]}, {
                RowBox[{
                  TagBox["\"Expression: \"", "SummaryItemAnnotation"], 
                  "\[InvisibleSpace]", 
                  TagBox[
                   PaneBox[
                    RowBox[{"Block", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    
                    RowBox[{
                    "Compile`$3", ",", "Compile`$10", ",", "Compile`$78", ",",
                     "Compile`$82", ",", "Compile`$37", ",", "Compile`$143", 
                    ",", "Compile`$144", ",", "Compile`$193", ",", 
                    "Compile`$194", ",", "Compile`$251", ",", "Compile`$254", 
                    ",", "Compile`$228", ",", "Compile`$271", ",", 
                    "Compile`$272"}], "}"}], ",", 
                    RowBox[{"Module", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"e3max", ",", "e3min"}], "}"}], ",", 
                    RowBox[{
                    RowBox[{"e3min", "=", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Compile`$3", "=", 
                    SuperscriptBox["MASSM", "2"]}], ";", 
                    RowBox[{"Compile`$10", "=", 
                    SuperscriptBox["MASS1", "2"]}], ";", 
                    RowBox[{"Compile`$78", "=", 
                    SuperscriptBox["MASS2", "2"]}], ";", 
                    RowBox[{"Compile`$82", "=", 
                    SuperscriptBox["MASS3", "2"]}], ";", 
                    RowBox[{"Compile`$37", "=", 
                    SuperscriptBox["E1vals", "2"]}], ";", 
                    RowBox[{"Compile`$143", "=", 
                    RowBox[{"-", "Compile`$78"}]}], ";", 
                    RowBox[{"Compile`$144", "=", 
                    RowBox[{"-", "Compile`$82"}]}], ";", 
                    TemplateBox[{
                    FractionBox[
                    RowBox[{
                    RowBox[{"-", 
                    SuperscriptBox["MASSM", "3"]}], "-", 
                    RowBox[{"Compile`$10", " ", "MASSM"}], "-", 
                    RowBox[{"2", " ", "Compile`$37", " ", "MASSM"}], "+", 
                    RowBox[{"Compile`$78", " ", "MASSM"}], "-", 
                    RowBox[{"Compile`$82", " ", "MASSM"}], "+", 
                    RowBox[{"E1vals", " ", "Compile`$10"}], "+", 
                    RowBox[{"3", " ", "E1vals", " ", "Compile`$3"}], "-", 
                    RowBox[{"E1vals", " ", "Compile`$78"}], "+", 
                    RowBox[{"E1vals", " ", "Compile`$82"}], "+", 
                    SqrtBox[
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"Compile`$37", "-", "Compile`$10"}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    SuperscriptBox["MASS1", "4"], "+", 
                    SuperscriptBox["MASS2", "4"], "+", 
                    SuperscriptBox["MASS3", "4"], "+", 
                    SuperscriptBox["MASSM", "4"], "-", 
                    RowBox[{"4", " ", "E1vals", " ", "MASSM", " ", 
                    RowBox[{"(", 
                    
                    RowBox[{"Compile`$10", "+", "Compile`$143", "+", 
                    "Compile`$144", "+", "Compile`$3"}], ")"}]}], "+", 
                    RowBox[{"2", " ", 
                    RowBox[{"(", 
                    
                    RowBox[{"Compile`$10", "+", "Compile`$143", "+", 
                    "Compile`$144"}], ")"}], " ", "Compile`$3"}], "+", 
                    RowBox[{"4", " ", "Compile`$3", " ", "Compile`$37"}], "-", 
                    RowBox[{"2", " ", "Compile`$10", " ", "Compile`$78"}], 
                    "-", 
                    RowBox[{"2", " ", "Compile`$10", " ", "Compile`$82"}], 
                    "-", 
                    RowBox[{"2", " ", "Compile`$78", " ", "Compile`$82"}]}], 
                    ")"}]}]]}], 
                    RowBox[{
                    RowBox[{"4", " ", "E1vals", " ", "MASSM"}], "-", 
                    RowBox[{"2", " ", 
                    RowBox[{"(", 
                    RowBox[{"Compile`$10", "+", "Compile`$3"}], ")"}]}]}]]}, 
                    "Abs"]}], ")"}]}], ";", 
                    RowBox[{"e3max", "=", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Compile`$193", "=", 
                    SuperscriptBox["MASSM", "2"]}], ";", 
                    RowBox[{"Compile`$194", "=", 
                    SuperscriptBox["MASS1", "2"]}], ";", 
                    RowBox[{"Compile`$251", "=", 
                    SuperscriptBox["MASS2", "2"]}], ";", 
                    RowBox[{"Compile`$254", "=", 
                    SuperscriptBox["MASS3", "2"]}], ";", 
                    RowBox[{"Compile`$228", "=", 
                    SuperscriptBox["E1vals", "2"]}], ";", 
                    RowBox[{"Compile`$271", "=", 
                    RowBox[{"-", "Compile`$251"}]}], ";", 
                    RowBox[{"Compile`$272", "=", 
                    RowBox[{"-", "Compile`$254"}]}], ";", 
                    TemplateBox[{
                    RowBox[{"-", 
                    FractionBox[
                    RowBox[{
                    SuperscriptBox["MASSM", "3"], "+", 
                    RowBox[{"Compile`$194", " ", "MASSM"}], "+", 
                    RowBox[{"2", " ", "Compile`$228", " ", "MASSM"}], "-", 
                    RowBox[{"Compile`$251", " ", "MASSM"}], "+", 
                    RowBox[{"Compile`$254", " ", "MASSM"}], "-", 
                    RowBox[{"3", " ", "E1vals", " ", "Compile`$193"}], "-", 
                    RowBox[{"E1vals", " ", "Compile`$194"}], "+", 
                    RowBox[{"E1vals", " ", "Compile`$251"}], "-", 
                    RowBox[{"E1vals", " ", "Compile`$254"}], "+", 
                    SqrtBox[
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"Compile`$228", "-", "Compile`$194"}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    SuperscriptBox["MASS1", "4"], "+", 
                    SuperscriptBox["MASS2", "4"], "+", 
                    SuperscriptBox["MASS3", "4"], "+", 
                    SuperscriptBox["MASSM", "4"], "+", 
                    RowBox[{"4", " ", "Compile`$193", " ", "Compile`$228"}], 
                    "-", 
                    RowBox[{"2", " ", "Compile`$194", " ", "Compile`$251"}], 
                    "-", 
                    RowBox[{"2", " ", "Compile`$194", " ", "Compile`$254"}], 
                    "-", 
                    RowBox[{"2", " ", "Compile`$251", " ", "Compile`$254"}], 
                    "+", 
                    RowBox[{"2", " ", "Compile`$193", " ", 
                    RowBox[{"(", 
                    
                    RowBox[{"Compile`$194", "+", "Compile`$271", "+", 
                    "Compile`$272"}], ")"}]}], "-", 
                    RowBox[{"4", " ", "E1vals", " ", "MASSM", " ", 
                    RowBox[{"(", 
                    
                    RowBox[{"Compile`$193", "+", "Compile`$194", "+", 
                    "Compile`$271", "+", "Compile`$272"}], ")"}]}]}], 
                    ")"}]}]]}], 
                    RowBox[{
                    RowBox[{"4", " ", "E1vals", " ", "MASSM"}], "-", 
                    RowBox[{"2", " ", 
                    RowBox[{"(", 
                    RowBox[{"Compile`$193", "+", "Compile`$194"}], 
                    ")"}]}]}]]}]}, "Abs"]}], ")"}]}], ";", 
                    RowBox[{"RandomReal", "[", 
                    RowBox[{"{", 
                    RowBox[{"e3min", ",", "e3max"}], "}"}], "]"}]}]}], 
                    "]"}]}], "]"}], ImageSize -> {{1, 500}, Automatic}, 
                    BaselinePosition -> Baseline, ContentPadding -> False, 
                    FrameMargins -> 0, StripOnInput -> True], 
                   "SummaryItem"]}]}}, 
              GridBoxAlignment -> {
               "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
              False, GridBoxItemSize -> {
               "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
              GridBoxSpacings -> {
               "Columns" -> {{2}}, "Rows" -> {{Automatic}}}, 
              BaseStyle -> {
               ShowStringCharacters -> False, NumberMarks -> False, 
                PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
           GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
           AutoDelete -> False, 
           GridBoxItemSize -> {
            "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
           BaselinePosition -> {1, 1}]}, 
        Dynamic[Typeset`open$$], ImageSize -> Automatic]},
      "SummaryPanel"],
     DynamicModuleValues:>{}], "]"}],
   CompiledFunction[{11, 14., 5848}, {
     Blank[Real], 
     Blank[Real], 
     Blank[Real], 
     Blank[Real], 
     Blank[Real]}, {{3, 0, 0}, {3, 0, 1}, {3, 0, 2}, {3, 0, 3}, {3, 0, 4}, {3,
     0, 20}}, {{0., {3, 0, 34}}, {-2, {2, 0, 1}}, {-4, {2, 0, 4}}, {
     2, {2, 0, 3}}, {-3, {2, 0, 5}}, {3, {2, 0, 2}}, {4, {2, 0, 0}}}, {0, 6, 
    43, 10, 0}, {{40, 56, 3, 0, 1, 3, 0, 5}, {40, 56, 3, 0, 2, 3, 0, 6}, {40, 
     56, 3, 0, 3, 3, 0, 7}, {40, 56, 3, 0, 4, 3, 0, 8}, {40, 56, 3, 0, 0, 3, 
     0, 9}, {19, 7, 10}, {19, 8, 11}, {10, 0, 12}, {16, 12, 0, 1, 12}, {13, 5,
      6, 13}, {10, 1, 14}, {16, 14, 13, 14}, {13, 12, 14, 12}, {40, 60, 3, 0, 
     12, 3, 0, 14}, {10, 1, 12}, {16, 12, 9, 1, 12}, {10, 2, 13}, {16, 13, 0, 
     5, 13}, {41, 263, 3, 0, 1, 2, 0, 2, 3, 0, 15}, {19, 15, 16}, {16, 0, 6, 
     15}, {16, 1, 6, 17}, {19, 17, 18}, {16, 0, 7, 17}, {19, 17, 19}, {16, 1, 
     7, 17}, {16, 0, 8, 20}, {16, 1, 8, 21}, {19, 21, 22}, {19, 6, 21}, {13, 
     9, 21, 23}, {10, 0, 21}, {16, 21, 9, 5, 21}, {41, 263, 3, 0, 1, 2, 0, 0, 
     3, 0, 24}, {41, 263, 3, 0, 2, 2, 0, 0, 3, 0, 25}, {10, 1, 26}, {16, 26, 
     6, 7, 26}, {41, 263, 3, 0, 3, 2, 0, 0, 3, 0, 27}, {10, 1, 28}, {16, 28, 
     6, 8, 28}, {10, 1, 29}, {16, 29, 7, 8, 29}, {41, 263, 3, 0, 4, 2, 0, 0, 
     3, 0, 30}, {13, 6, 10, 11, 31}, {10, 3, 32}, {16, 32, 5, 31, 32}, {13, 5,
      6, 10, 11, 31}, {10, 4, 33}, {16, 33, 0, 1, 31, 33}, {13, 21, 24, 25, 
     26, 27, 28, 29, 30, 32, 33, 21}, {16, 23, 21, 23}, {40, 57, 3, 0, 23, 4, 
     0, 0}, {11, 12, 34, 1}, {11, 13, 34, 2}, {11, 16, 34, 3}, {11, 15, 34, 
     4}, {11, 18, 34, 5}, {11, 19, 34, 6}, {11, 17, 34, 7}, {11, 20, 34, 8}, {
     11, 22, 34, 9}, {14, 1, 2, 3, 4, 5, 6, 7, 8, 9, 0, 1}, {11, 14, 34, 0}, {
     17, 0, 1, 0}, {40, 38, 4, 0, 0, 3, 0, 14}, {40, 56, 3, 0, 1, 3, 0, 12}, {
     40, 56, 3, 0, 2, 3, 0, 13}, {40, 56, 3, 0, 3, 3, 0, 16}, {40, 56, 3, 0, 
     4, 3, 0, 15}, {40, 56, 3, 0, 0, 3, 0, 18}, {19, 16, 19}, {19, 15, 17}, {
     10, 0, 20}, {16, 20, 0, 1, 20}, {13, 12, 13, 22}, {10, 1, 21}, {16, 21, 
     22, 21}, {13, 20, 21, 20}, {40, 60, 3, 0, 20, 3, 0, 21}, {10, 3, 20}, {
     16, 20, 18, 1, 20}, {10, 5, 22}, {16, 22, 0, 12, 22}, {41, 263, 3, 0, 1, 
     2, 0, 2, 3, 0, 24}, {16, 0, 13, 25}, {19, 25, 26}, {16, 1, 13, 25}, {16, 
     0, 16, 27}, {16, 1, 16, 28}, {19, 28, 29}, {16, 0, 15, 28}, {19, 28, 
     30}, {16, 1, 15, 28}, {19, 13, 32}, {13, 18, 32, 33}, {10, 0, 32}, {16, 
     32, 18, 12, 32}, {41, 263, 3, 0, 1, 2, 0, 0, 3, 0, 31}, {41, 263, 3, 0, 
     2, 2, 0, 0, 3, 0, 23}, {10, 1, 35}, {16, 35, 13, 16, 35}, {41, 263, 3, 0,
      3, 2, 0, 0, 3, 0, 36}, {10, 1, 37}, {16, 37, 13, 15, 37}, {10, 1, 38}, {
     16, 38, 16, 15, 38}, {41, 263, 3, 0, 4, 2, 0, 0, 3, 0, 39}, {13, 13, 19, 
     17, 40}, {10, 3, 41}, {16, 41, 12, 40, 41}, {13, 12, 13, 19, 17, 40}, {
     10, 4, 42}, {16, 42, 0, 1, 40, 42}, {13, 32, 31, 23, 35, 36, 37, 38, 39, 
     41, 42, 32}, {16, 33, 32, 33}, {40, 57, 3, 0, 33, 4, 0, 0}, {11, 20, 34, 
     1}, {11, 22, 34, 2}, {11, 24, 34, 3}, {11, 26, 34, 4}, {11, 25, 34, 5}, {
     11, 27, 34, 6}, {11, 29, 34, 7}, {11, 30, 34, 8}, {11, 28, 34, 9}, {14, 
     1, 2, 3, 4, 5, 6, 7, 8, 9, 0, 1}, {11, 21, 34, 0}, {17, 0, 1, 0}, {20, 0,
      1}, {40, 38, 4, 0, 1, 3, 0, 21}, {
     42, "RandomReal", 3, 0, 14, 3, 0, 21, 3, 0, 20}, {1}}, 
    Function[{$CellContext`E1vals, $CellContext`MASSM, $CellContext`MASS1, \
$CellContext`MASS2, $CellContext`MASS3}, 
     Block[{
      Compile`$3, Compile`$10, Compile`$78, Compile`$82, Compile`$37, 
       Compile`$143, Compile`$144, Compile`$193, Compile`$194, Compile`$251, 
       Compile`$254, Compile`$228, Compile`$271, Compile`$272}, 
      Module[{$CellContext`e3max, $CellContext`e3min}, $CellContext`e3min = (
         Compile`$3 = $CellContext`MASSM^2; 
         Compile`$10 = $CellContext`MASS1^2; 
         Compile`$78 = $CellContext`MASS2^2; 
         Compile`$82 = $CellContext`MASS3^2; 
         Compile`$37 = $CellContext`E1vals^2; Compile`$143 = -Compile`$78; 
         Compile`$144 = -Compile`$82; 
         Abs[(4 $CellContext`E1vals $CellContext`MASSM - 
             2 (Compile`$3 + Compile`$10))^(-1) ((-2) 
             Compile`$37 $CellContext`MASSM + 
            3 $CellContext`E1vals 
             Compile`$3 - $CellContext`MASSM^3 + $CellContext`E1vals 
             Compile`$10 - $CellContext`MASSM 
            Compile`$10 - $CellContext`E1vals 
            Compile`$78 + $CellContext`MASSM 
             Compile`$78 + $CellContext`E1vals 
             Compile`$82 - $CellContext`MASSM 
            Compile`$82 + ((Compile`$37 - Compile`$10) (
               4 Compile`$37 
                Compile`$3 + $CellContext`MASSM^4 + $CellContext`MASS1^4 - 2 
               Compile`$10 Compile`$78 + $CellContext`MASS2^4 - 2 Compile`$10 
               Compile`$82 - 2 Compile`$78 Compile`$82 + $CellContext`MASS3^4 + 
               2 Compile`$3 (Compile`$10 + Compile`$143 + Compile`$144) - 
               4 $CellContext`E1vals $CellContext`MASSM (Compile`$3 + 
                Compile`$10 + Compile`$143 + Compile`$144)))^
             Rational[1, 2])]); $CellContext`e3max = (
         Compile`$193 = $CellContext`MASSM^2; 
         Compile`$194 = $CellContext`MASS1^2; 
         Compile`$251 = $CellContext`MASS2^2; 
         Compile`$254 = $CellContext`MASS3^2; 
         Compile`$228 = $CellContext`E1vals^2; Compile`$271 = -Compile`$251; 
         Compile`$272 = -Compile`$254; 
         Abs[((-1)/(4 $CellContext`E1vals $CellContext`MASSM - 
            2 (Compile`$193 + Compile`$194))) (
            2 Compile`$228 $CellContext`MASSM - 3 $CellContext`E1vals 
            Compile`$193 + $CellContext`MASSM^3 - $CellContext`E1vals 
            Compile`$194 + $CellContext`MASSM 
             Compile`$194 + $CellContext`E1vals 
             Compile`$251 - $CellContext`MASSM 
            Compile`$251 - $CellContext`E1vals 
            Compile`$254 + $CellContext`MASSM 
             Compile`$254 + ((Compile`$228 - Compile`$194) (
               4 Compile`$228 
                Compile`$193 + $CellContext`MASSM^4 + $CellContext`MASS1^4 - 
               2 Compile`$194 Compile`$251 + $CellContext`MASS2^4 - 2 
               Compile`$194 Compile`$254 - 2 Compile`$251 
               Compile`$254 + $CellContext`MASS3^4 + 
               2 Compile`$193 (Compile`$194 + Compile`$271 + Compile`$272) - 
               4 $CellContext`E1vals $CellContext`MASSM (Compile`$193 + 
                Compile`$194 + Compile`$271 + Compile`$272)))^Rational[1, 2])]
          ); RandomReal[{$CellContext`e3min, $CellContext`e3max}]]], 
     Listable], Evaluate, 
    LibraryFunction[
    "/Users/alberto/Library/Mathematica/ApplicationData/CCompilerDriver/\
BuildFolder/eduroam-4014-1219/compiledFunction54.dylib", 
     "compiledFunction54", {{Real, 0, "Constant"}, {Real, 0, "Constant"}, {
      Real, 0, "Constant"}, {Real, 0, "Constant"}, {Real, 0, "Constant"}}, 
     Real]],
   Editable->False,
   SelectWithContents->True,
   Selectable->False], TraditionalForm]], "Output",
 CellChangeTimes->{3.930211545475031*^9, 3.930822777519259*^9},
 CellTags->"Evaluation",
 CellLabel->
  "Out[1120]=",ExpressionUUID->"8152cee4-4f9c-4517-a1a0-086433f23fba"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Test - Dalitz plot for spinless decays", "Subsubsection",
 CellChangeTimes->{{3.888741046096051*^9, 3.888741046637385*^9}, {
  3.888742953595984*^9, 3.888742962505891*^9}},
 CellTags->
  "Evaluation",ExpressionUUID->"503b0256-0c8a-4ff3-a0ad-953eabe8080a"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"mtest", "=", "0.3"}], ";", "\[IndentingNewLine]", 
      RowBox[{"TestPhaseSpace", "=", 
       RowBox[{"ThreeBodyDecaysEventsAtRest", "[", 
        RowBox[{
        "mtest", ",", "0", ",", "\"\<test\>\"", ",", "\"\<test\>\"", ",", 
         SuperscriptBox["10", "4"]}], "]"}]}], ";"}], "//", 
     RowBox[{"AbsoluteTiming", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"m12test", "[", 
        RowBox[{
        "E1_", ",", "E2_", ",", "p1x_", ",", "p1y_", ",", "p1z_", ",", "p2x_",
          ",", "p2y_", ",", "p2z_", ",", "m1_", ",", "m2_"}], "]"}], "=", 
       RowBox[{
        SuperscriptBox["m1", "2"], "+", 
        SuperscriptBox["m2", "2"], "+", 
        RowBox[{"2", "*", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"E1", "*", "E2"}], "-", 
           RowBox[{"p1x", "*", "p2x"}], "-", 
           RowBox[{"p1y", "*", "p2y"}], "-", 
           RowBox[{"p1z", "*", "p2z"}]}], ")"}]}]}]}]}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"m23test", "[", 
      RowBox[{
      "E2_", ",", "E3_", ",", "p2x_", ",", "p2y_", ",", "p2z_", ",", "p3x_", 
       ",", "p3y_", ",", "p3z_", ",", "m2_", ",", "m3_"}], "]"}], "=", 
     RowBox[{
      SuperscriptBox["m2", "2"], "+", 
      SuperscriptBox["m3", "2"], "+", 
      RowBox[{"2", "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"E2", "*", "E3"}], "-", 
         RowBox[{"p2x", "*", "p3x"}], "-", 
         RowBox[{"p2y", "*", "p3y"}], "-", 
         RowBox[{"p2z", "*", "p3z"}]}], ")"}]}]}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"Testm12m23Compiled", "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Hold", "@", 
          RowBox[{"Compile", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"TestPhaseSpace", ",", "_Real", ",", "2"}], "}"}], ",",
               "m1", ",", "m2", ",", "m3"}], "}"}], ",", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"m12test", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"TestPhaseSpace", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", 
                   RowBox[{"[", "4", "]"}], "]"}], ",", 
                  RowBox[{
                   RowBox[{"TestPhaseSpace", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", 
                   RowBox[{"[", "8", "]"}], "]"}], ",", 
                  RowBox[{
                   RowBox[{"TestPhaseSpace", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", 
                   RowBox[{"[", "1", "]"}], "]"}], ",", 
                  RowBox[{
                   RowBox[{"TestPhaseSpace", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", 
                   RowBox[{"[", "2", "]"}], "]"}], ",", 
                  RowBox[{
                   RowBox[{"TestPhaseSpace", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", 
                   RowBox[{"[", "3", "]"}], "]"}], ",", 
                  RowBox[{
                   RowBox[{"TestPhaseSpace", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", 
                   RowBox[{"[", "5", "]"}], "]"}], ",", 
                  RowBox[{
                   RowBox[{"TestPhaseSpace", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", 
                   RowBox[{"[", "6", "]"}], "]"}], ",", 
                  RowBox[{
                   RowBox[{"TestPhaseSpace", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", 
                   RowBox[{"[", "7", "]"}], "]"}], ",", "m1", ",", "m2"}], 
                 "]"}], ",", 
                RowBox[{"m23test", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"TestPhaseSpace", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", 
                   RowBox[{"[", "8", "]"}], "]"}], ",", 
                  RowBox[{
                   RowBox[{"TestPhaseSpace", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", 
                   RowBox[{"[", "12", "]"}], "]"}], ",", 
                  RowBox[{
                   RowBox[{"TestPhaseSpace", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", 
                   RowBox[{"[", "5", "]"}], "]"}], ",", 
                  RowBox[{
                   RowBox[{"TestPhaseSpace", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", 
                   RowBox[{"[", "6", "]"}], "]"}], ",", 
                  RowBox[{
                   RowBox[{"TestPhaseSpace", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", 
                   RowBox[{"[", "7", "]"}], "]"}], ",", 
                  RowBox[{
                   RowBox[{"TestPhaseSpace", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", 
                   RowBox[{"[", "9", "]"}], "]"}], ",", 
                  RowBox[{
                   RowBox[{"TestPhaseSpace", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", 
                   RowBox[{"[", "10", "]"}], "]"}], ",", 
                  RowBox[{
                   RowBox[{"TestPhaseSpace", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", 
                   RowBox[{"[", "11", "]"}], "]"}], ",", "m2", ",", "m3"}], 
                 "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "1", ",", 
                RowBox[{"Length", "[", "TestPhaseSpace", "]"}], ",", "1"}], 
               "}"}]}], "]"}], ",", 
            RowBox[{"CompilationTarget", "\[Rule]", "\"\<C\>\""}], ",", 
            RowBox[{"RuntimeOptions", "\[Rule]", "\"\<Speed\>\""}]}], "]"}]}],
          "/.", 
         RowBox[{"DownValues", "@", "m12test"}]}], "/.", 
        RowBox[{"DownValues", "@", "m23test"}]}], "//", 
       RowBox[{"ReleaseHold", "\[IndentingNewLine]", "Testm12m23"}]}], "=", 
      RowBox[{"Testm12m23Compiled", "[", 
       RowBox[{"TestPhaseSpace", ",", 
        RowBox[{"mass13bodyProcess", "[", 
         RowBox[{"\"\<test\>\"", ",", "\"\<test\>\""}], "]"}], ",", 
        RowBox[{"mass23bodyProcess", "[", 
         RowBox[{"\"\<test\>\"", ",", "\"\<test\>\"", ",", "0", ",", "0"}], 
         "]"}], ",", "mtest"}], "]"}]}]}], ";"}], "//", 
   RowBox[{"AbsoluteTiming", "\[IndentingNewLine]", 
    RowBox[{"ListPlot", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"Testm12m23", ",", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{"mass13bodyProcess", "[", 
                RowBox[{"\"\<test\>\"", ",", "\"\<test\>\""}], "]"}], "+", 
               RowBox[{"mass23bodyProcess", "[", 
                RowBox[{
                "\"\<test\>\"", ",", "\"\<test\>\"", ",", "0", ",", "0"}], 
                "]"}]}], ")"}], "2"], ",", "x"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"x", ",", "0", ",", 
            RowBox[{"massM3bodyProcess", "[", 
             RowBox[{"\"\<test\>\"", ",", "\"\<test\>\""}], "]"}], ",", 
            "0.05"}], "}"}]}], "]"}], ",", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"x", ",", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{"mass23bodyProcess", "[", 
                RowBox[{
                "\"\<test\>\"", ",", "\"\<test\>\"", ",", "0", ",", "0"}], 
                "]"}], "+", "mtest"}], ")"}], "2"]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"x", ",", "0", ",", 
            RowBox[{"massM3bodyProcess", "[", 
             RowBox[{"\"\<test\>\"", ",", "\"\<test\>\""}], "]"}], ",", 
            "0.05"}], "}"}]}], "]"}], ",", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"x", ",", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{"massM3bodyProcess", "[", 
                RowBox[{"\"\<test\>\"", ",", "\"\<test\>\""}], "]"}], "-", 
               RowBox[{"mass13bodyProcess", "[", 
                RowBox[{"\"\<test\>\"", ",", "\"\<test\>\""}], "]"}]}], ")"}],
              "2"]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"x", ",", "0", ",", 
            RowBox[{"massM3bodyProcess", "[", 
             RowBox[{"\"\<test\>\"", ",", "\"\<test\>\""}], "]"}], ",", 
            "0.05"}], "}"}]}], "]"}], ",", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{"massM3bodyProcess", "[", 
                RowBox[{"\"\<test\>\"", ",", "\"\<test\>\""}], "]"}], "-", 
               "mtest"}], ")"}], "2"], ",", "x"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"x", ",", "0", ",", 
            RowBox[{"massM3bodyProcess", "[", 
             RowBox[{"\"\<test\>\"", ",", "\"\<test\>\""}], "]"}], ",", 
            "0.05"}], "}"}]}], "]"}]}], "}"}], ",", 
      RowBox[{"Frame", "\[Rule]", "True"}], ",", 
      RowBox[{"Joined", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"False", ",", "True", ",", "True", ",", "True", ",", "True"}],
         "}"}]}], ",", 
      RowBox[{"FrameLabel", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
        "\"\<\!\(\*SubscriptBox[\(m\), \(12\)]\) \
[\!\(\*SuperscriptBox[\(GeV\), \(2\)]\)]\>\"", " ", ",", " ", 
         "\"\<\!\(\*SubscriptBox[\(m\), \(23\)]\) [\!\(\*SuperscriptBox[\(GeV\
\), \(2\)]\)]\>\""}], "}"}]}], ",", 
      RowBox[{"FrameStyle", "\[Rule]", 
       RowBox[{"Directive", "[", 
        RowBox[{"Black", ",", " ", "23"}], "]"}]}], ",", 
      RowBox[{"PlotStyle", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"Thick", ",", "Blue"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"Thick", ",", "Black", ",", 
           RowBox[{"Dashing", "[", "0.01", "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"Thick", ",", "Black", ",", 
           RowBox[{"Dashing", "[", "0.02", "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"Thick", ",", "Black", ",", 
           RowBox[{"Dashing", "[", "0.03", "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"Thick", ",", "Black", ",", 
           RowBox[{"Dashing", "[", "0.04", "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"Thick", ",", 
           RowBox[{"Darker", "@", "Cyan"}], ",", 
           RowBox[{"PointSize", "[", "0.01", "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"Thick", ",", 
           RowBox[{"Darker", "@", "Red"}], ",", 
           RowBox[{"Dashing", "[", "0.02", "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"Thick", ",", 
           RowBox[{"Darker", "@", 
            RowBox[{"Darker", "@", "Green"}]}], ",", 
           RowBox[{"Dashing", "[", "0.02", "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Darker", "@", "Red"}], ",", 
           RowBox[{"PointSize", "[", "0.04", "]"}]}], "}"}]}], "}"}]}], ",", 
      RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
      RowBox[{"PlotRange", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", 
           RowBox[{"massM3bodyProcess", "[", 
            RowBox[{"\"\<test\>\"", ",", "\"\<test\>\""}], "]"}]}], "}"}], 
         ",", "All"}], "}"}]}], ",", 
      RowBox[{"PlotLabel", "\[Rule]", 
       RowBox[{"Style", "[", 
        RowBox[{
         RowBox[{"Row", "[", 
          RowBox[{"{", 
           RowBox[{
           "\"\<Dalitz plot for \!\(\*SuperscriptBox[\(M\), \(2\)]\) = const, \
\!\(\*SubscriptBox[\(m\), \(mother\)]\) = \>\"", ",", 
            RowBox[{"massM3bodyProcess", "[", 
             RowBox[{"\"\<test\>\"", ",", "\"\<test\>\""}], "]"}], ",", 
            "\"\< GeV, \!\(\*SubscriptBox[\(m\), \(1\)]\) = \>\"", ",", 
            RowBox[{"mass13bodyProcess", "[", 
             RowBox[{"\"\<test\>\"", ",", "\"\<test\>\""}], "]"}], ",", 
            "\"\< GeV, \!\(\*SubscriptBox[\(m\), \(2\)]\) = \>\"", ",", 
            RowBox[{"mass23bodyProcess", "[", 
             RowBox[{
             "\"\<test\>\"", ",", "\"\<test\>\"", ",", "0", ",", "0"}], "]"}],
             " ", ",", "\"\< GeV, \!\(\*SubscriptBox[\(m\), \(3\)]\) = \>\"", 
            ",", "mtest", ",", " ", "\"\< GeV\>\""}], "}"}], "]"}], ",", "15",
          ",", "Black"}], "]"}]}], ",", 
      RowBox[{"PlotLegends", "\[Rule]", 
       RowBox[{"Placed", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Style", "[", 
            RowBox[{"#", ",", "15"}], "]"}], "&"}], "/@", 
          RowBox[{"{", 
           RowBox[{
           "\"\<Dalitz plot\>\"", ",", 
            "\"\<(\!\(\*SubscriptBox[\(m\), \
\(1\)]\)+\!\(\*SubscriptBox[\(m\), \(2\)]\)\!\(\*SuperscriptBox[\()\), \(2\)]\
\)\>\"", ",", 
            "\"\<(\!\(\*SubscriptBox[\(m\), \
\(2\)]\)+\!\(\*SubscriptBox[\(m\), \(3\)]\)\!\(\*SuperscriptBox[\()\), \(2\)]\
\)\>\"", ",", 
            "\"\<(m - \!\(\*SubscriptBox[\(m\), \(1\)]\)\!\(\*SuperscriptBox[\
\()\), \(2\)]\)\>\"", ",", 
            "\"\<(m - \!\(\*SubscriptBox[\(m\), \(3\)]\)\!\(\*SuperscriptBox[\
\()\), \(2\)]\)\>\""}], "}"}]}], ",", "Right"}], "]"}]}]}], "]"}]}]}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.888741066556158*^9, 3.888741090177514*^9}, {
  3.888741409638892*^9, 3.888741830195922*^9}, {3.888741872976215*^9, 
  3.888741884957648*^9}, {3.8887419861361713`*^9, 3.888742001956536*^9}, {
  3.8887420365671043`*^9, 3.88874205309033*^9}, {3.888742120575762*^9, 
  3.88874220894046*^9}, {3.888742263645993*^9, 3.888742331316066*^9}, {
  3.888742391426902*^9, 3.888742540678205*^9}, {3.888742579395517*^9, 
  3.888742720565861*^9}, {3.888742751775171*^9, 3.8887427681662493`*^9}, {
  3.8887428002661715`*^9, 3.888742908105803*^9}, {3.8887429779197564`*^9, 
  3.8887429801103535`*^9}},
 CellTags->"Evaluation",
 CellLabel->
  "In[1128]:=",ExpressionUUID->"4d06c093-9a88-44d7-a919-51cf305457a2"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Lorentz boosts", "Section",
 CellChangeTimes->{{3.88511052681753*^9, 3.885110528825957*^9}},
 CellTags->
  "Evaluation",ExpressionUUID->"f367f544-74c6-4b26-b14b-30abac03ef1d"],

Cell[CellGroupData[{

Cell["Boosting to the lab frame of the decaying mother particle", "Subsection",
 CellChangeTimes->{{3.8777050146470547`*^9, 3.8777050204151073`*^9}, {
  3.885108835458666*^9, 3.8851088370396*^9}},
 CellTags->
  "Evaluation",ExpressionUUID->"7d0ac78d-f6b5-454b-b41b-c56bc84fbc0b"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]Val", "[", 
    RowBox[{"px_", ",", "py_"}], "]"}], "=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"py", ">", "0"}], ",", 
     RowBox[{"ArcCos", "[", 
      FractionBox["px", 
       SqrtBox[
        RowBox[{
         SuperscriptBox["px", "2"], "+", 
         SuperscriptBox["py", "2"]}]]], "]"}], ",", 
     RowBox[{"-", 
      RowBox[{"ArcCos", "[", 
       FractionBox["px", 
        SqrtBox[
         RowBox[{
          SuperscriptBox["px", "2"], "+", 
          SuperscriptBox["py", "2"]}]]], "]"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"\[Theta]Val", "[", 
     RowBox[{"px_", ",", "py_", ",", "pz_"}], "]"}], "=", 
    RowBox[{"ArcCos", "[", 
     FractionBox["pz", 
      SqrtBox[
       RowBox[{
        SuperscriptBox["px", "2"], "+", 
        SuperscriptBox["py", "2"], "+", 
        SuperscriptBox["pz", "2"]}]]], "]"}]}], ";"}], "\[IndentingNewLine]", 
  
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Mother", " ", "particle", " ", "momentum"}], ",", " ", 
    RowBox[{"velocity", " ", "and", " ", "\[Gamma]"}], ",", 
    RowBox[{
    "\[CapitalGamma]", " ", "factors", " ", "at", " ", "its", " ", "lab", " ",
      "frame"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"pvecMotherLab", "[", 
    RowBox[{"pMotherLab1_", ",", "pMotherLab2_", ",", "pMotherLab3_"}], "]"}],
    "=", 
   RowBox[{"{", 
    RowBox[{"pMotherLab1", ",", "pMotherLab2", ",", "pMotherLab3"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"vvecMotherLab", "[", 
    RowBox[{
    "EmotherLab_", ",", "pMotherLab1_", ",", "pMotherLab2_", ",", 
     "pMotherLab3_"}], "]"}], "=", 
   RowBox[{"+", 
    FractionBox[
     RowBox[{"pvecMotherLab", "[", 
      RowBox[{"pMotherLab1", ",", "pMotherLab2", ",", "pMotherLab3"}], "]"}], 
     "EmotherLab"]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Gamma]Factor", "[", 
    RowBox[{"Energy_", ",", "m_"}], "]"}], "=", 
   FractionBox["Energy", "m"]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"\[CapitalGamma]factorMotherLab", "[", 
     RowBox[{"EmotherLab_", ",", "mMother_"}], "]"}], "=", 
    RowBox[{"Simplify", "[", 
     FractionBox[
      RowBox[{
       RowBox[{"\[Gamma]Factor", "[", 
        RowBox[{"EmotherLab", ",", "mMother"}], "]"}], "-", "1"}], 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"v", "/.", 
          RowBox[{"Solve", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"\[Gamma]Factor", "[", 
              RowBox[{"EmotherLab", ",", "mMother"}], "]"}], "\[Equal]", 
             FractionBox["1", 
              SqrtBox[
               RowBox[{"1", "-", 
                SuperscriptBox["v", "2"]}]]]}], ",", "v"}], "]"}]}], ")"}], 
        "2"], "[", 
       RowBox[{"[", "1", "]"}], "]"}]], "]"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Momentum", " ", "of", " ", "decay", " ", "product", " ", "at", " ", "the",
     " ", "rest", " ", "frame", " ", "of", " ", "mother", " ", "particle"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"pVecProdRest", "[", 
     RowBox[{"pProdRest1_", ",", "pProdRest2_", ",", "pProdRest3_"}], "]"}], 
    "=", 
    RowBox[{"{", 
     RowBox[{"pProdRest1", ",", "pProdRest2", ",", "pProdRest3"}], "}"}]}], 
   ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Decay", " ", 
    RowBox[{"product", "'"}], "s", " ", "momentum", " ", "and", " ", "energy",
     " ", "at", " ", 
    RowBox[{"HNL", "'"}], "s", " ", "lab", " ", "frame"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"pVecProdLab", "[", 
    RowBox[{
    "EmotherLab_", ",", "mMother_", ",", "pMotherLab1_", ",", "pMotherLab2_", 
     ",", "pMotherLab3_", ",", "EProdRest_", ",", "pProdRest1_", ",", 
     "pProdRest2_", ",", "pProdRest3_"}], "]"}], "=", 
   RowBox[{
    RowBox[{"Simplify", "[", 
     RowBox[{
      RowBox[{"pVecProdRest", "[", 
       RowBox[{"pProdRest1", ",", "pProdRest2", ",", "pProdRest3"}], "]"}], 
      "+", 
      RowBox[{
       RowBox[{"\[Gamma]Factor", "[", 
        RowBox[{"EmotherLab", ",", "mMother"}], "]"}], "*", 
       RowBox[{"vvecMotherLab", "[", 
        RowBox[{
        "EmotherLab", ",", "pMotherLab1", ",", "pMotherLab2", ",", 
         "pMotherLab3"}], "]"}], "*", "EProdRest"}], "+", 
      RowBox[{
       RowBox[{"\[CapitalGamma]factorMotherLab", "[", 
        RowBox[{"EmotherLab", ",", "mMother"}], "]"}], "*", 
       RowBox[{"vvecMotherLab", "[", 
        RowBox[{
        "EmotherLab", ",", "pMotherLab1", ",", "pMotherLab2", ",", 
         "pMotherLab3"}], "]"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"vvecMotherLab", "[", 
          RowBox[{
          "EmotherLab", ",", "pMotherLab1", ",", "pMotherLab2", ",", 
           "pMotherLab3"}], "]"}], ".", 
         RowBox[{"pVecProdRest", "[", 
          RowBox[{"pProdRest1", ",", "pProdRest2", ",", "pProdRest3"}], 
          "]"}]}], ")"}]}]}], "]"}], "//", "Expand"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"EProdLab", "[", 
     RowBox[{
     "EmotherLab_", ",", "mMother_", ",", "pMotherLab1_", ",", "pMotherLab2_",
       ",", "pMotherLab3_", ",", "EProdRest_", ",", "pProdRest1_", ",", 
      "pProdRest2_", ",", "pProdRest3_"}], "]"}], "=", 
    RowBox[{"Simplify", "[", 
     RowBox[{
      RowBox[{"\[Gamma]Factor", "[", 
       RowBox[{"EmotherLab", ",", "mMother"}], "]"}], 
      RowBox[{"(", 
       RowBox[{"EProdRest", "+", 
        RowBox[{
         RowBox[{"vvecMotherLab", "[", 
          RowBox[{
          "EmotherLab", ",", "pMotherLab1", ",", "pMotherLab2", ",", 
           "pMotherLab3"}], "]"}], ".", 
         RowBox[{"pVecProdRest", "[", 
          RowBox[{"pProdRest1", ",", "pProdRest2", ",", "pProdRest3"}], 
          "]"}]}]}], ")"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Decay", " ", 
    RowBox[{"product", "'"}], "s", " ", "momentum", " ", "components", " ", 
    "in", " ", "lab", " ", "frame"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"pProductLab1", "[", 
    RowBox[{
    "EmotherLab_", ",", "mMother_", ",", "pMotherLab1_", ",", "pMotherLab2_", 
     ",", "pMotherLab3_", ",", "EProdRest_", ",", "pProdRest1_", ",", 
     "pProdRest2_", ",", "pProdRest3_"}], "]"}], "=", 
   RowBox[{
    RowBox[{"pVecProdLab", "[", 
     RowBox[{
     "EmotherLab", ",", "mMother", ",", "pMotherLab1", ",", "pMotherLab2", 
      ",", "pMotherLab3", ",", "EProdRest", ",", "pProdRest1", ",", 
      "pProdRest2", ",", "pProdRest3"}], "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"pProductLab2", "[", 
    RowBox[{
    "EmotherLab_", ",", "mMother_", ",", "pMotherLab1_", ",", "pMotherLab2_", 
     ",", "pMotherLab3_", ",", "EProdRest_", ",", "pProdRest1_", ",", 
     "pProdRest2_", ",", "pProdRest3_"}], "]"}], "=", 
   RowBox[{
    RowBox[{"pVecProdLab", "[", 
     RowBox[{
     "EmotherLab", ",", "mMother", ",", "pMotherLab1", ",", "pMotherLab2", 
      ",", "pMotherLab3", ",", "EProdRest", ",", "pProdRest1", ",", 
      "pProdRest2", ",", "pProdRest3"}], "]"}], "[", 
    RowBox[{"[", "2", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"pProductLab3", "[", 
    RowBox[{
    "EmotherLab_", ",", "mMother_", ",", "pMotherLab1_", ",", "pMotherLab2_", 
     ",", "pMotherLab3_", ",", "EProdRest_", ",", "pProdRest1_", ",", 
     "pProdRest2_", ",", "pProdRest3_"}], "]"}], "=", 
   RowBox[{
    RowBox[{"pVecProdLab", "[", 
     RowBox[{
     "EmotherLab", ",", "mMother", ",", "pMotherLab1", ",", "pMotherLab2", 
      ",", "pMotherLab3", ",", "EProdRest", ",", "pProdRest1", ",", 
      "pProdRest2", ",", "pProdRest3"}], "]"}], "[", 
    RowBox[{"[", "3", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  "\"\<Checking that \!\(\*SubscriptBox[SuperscriptBox[\(E\), \(2\)], \
\(boosted\)]\)-\!\(\*SubscriptBox[SuperscriptBox[OverscriptBox[\(p\), \(_\)], \
\(2\)], \(boosted\)]\) = \!\(\*SuperscriptBox[\(m\), \(2\)]\):\>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"expr", "=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"EProdLab", "[", 
            RowBox[{
            "EmotherLab", ",", "mMother", ",", "pMotherLab1", ",", 
             "pMotherLab2", ",", "pMotherLab3", ",", "EProdRest", ",", 
             "pProdRest1", ",", "pProdRest2", ",", "pProdRest3"}], "]"}], 
           "2"], "-", 
          SuperscriptBox[
           RowBox[{"pProductLab1", "[", 
            RowBox[{
            "EmotherLab", ",", "mMother", ",", "pMotherLab1", ",", 
             "pMotherLab2", ",", "pMotherLab3", ",", "EProdRest", ",", 
             "pProdRest1", ",", "pProdRest2", ",", "pProdRest3"}], "]"}], 
           "2"], "-", 
          SuperscriptBox[
           RowBox[{"pProductLab2", "[", 
            RowBox[{
            "EmotherLab", ",", "mMother", ",", "pMotherLab1", ",", 
             "pMotherLab2", ",", "pMotherLab3", ",", "EProdRest", ",", 
             "pProdRest1", ",", "pProdRest2", ",", "pProdRest3"}], "]"}], 
           "2"], "-", 
          SuperscriptBox[
           RowBox[{"pProductLab3", "[", 
            RowBox[{
            "EmotherLab", ",", "mMother", ",", "pMotherLab1", ",", 
             "pMotherLab2", ",", "pMotherLab3", ",", "EProdRest", ",", 
             "pProdRest1", ",", "pProdRest2", ",", "pProdRest3"}], "]"}], 
           "2"]}], ")"}], "//", "Expand"}], "//", "Simplify"}], ")"}], "/.", 
     RowBox[{"{", 
      RowBox[{"EmotherLab", "\[Rule]", 
       SqrtBox[
        RowBox[{
         SuperscriptBox["mMother", "2"], "+", 
         SuperscriptBox["pMotherLab1", "2"], "+", 
         SuperscriptBox["pMotherLab2", "2"], "+", 
         SuperscriptBox["pMotherLab3", "2"]}]]}], "}"}]}], "/.", 
    RowBox[{"{", 
     RowBox[{"EProdRest", "\[Rule]", 
      SqrtBox[
       RowBox[{
        SuperscriptBox["pProdRest1", "2"], "+", 
        SuperscriptBox["pProdRest2", "2"], "+", 
        SuperscriptBox["pProdRest3", "2"], "+", 
        SuperscriptBox["mProd", "2"]}]]}], "}"}]}], "//", 
   "Simplify"}]}]}], "Input",
 CellChangeTimes->{{3.884934752690374*^9, 3.884934797243472*^9}, {
   3.888738492178235*^9, 3.888738806120147*^9}, {3.888738836628004*^9, 
   3.8887388703965206`*^9}, {3.888738903401521*^9, 3.8887389997358527`*^9}, {
   3.88873904199261*^9, 3.8887391190407124`*^9}, {3.888739153154332*^9, 
   3.8887391884536047`*^9}, {3.888739251723329*^9, 3.888739251845861*^9}, 
   3.888739526380254*^9, {3.888739736896021*^9, 3.888739746720702*^9}, {
   3.888739836849163*^9, 3.888739972477136*^9}, {3.8887400060554514`*^9, 
   3.888740062970625*^9}, {3.892026397949119*^9, 3.892026398118095*^9}},
 CellTags->"Evaluation",
 CellLabel->
  "In[1129]:=",ExpressionUUID->"87cd4ce0-fa9f-4740-b66b-ae761b233c32"],

Cell[BoxData[
 FormBox[
  TemplateBox[{
   "Solve", "nongen", 
    "\"There may be values of the parameters for which some or all solutions \
are not valid.\"", 2, 1134, 26, 29079336519732941073, "Local"},
   "MessageTemplate"], TraditionalForm]], "Message", "MSG",
 CellChangeTimes->{3.930211546366149*^9, 3.930822778337468*^9},
 CellTags->"Evaluation",
 CellLabel->
  "Durante la evaluaci\[OAcute]n de \
In[1129]:=",ExpressionUUID->"af4951aa-4b0b-4392-a56a-9fa5339f3210"],

Cell[BoxData[
 FormBox["\<\"Checking that \\!\\(\\*SubscriptBox[SuperscriptBox[\\(E\\), \
\\(2\\)], \
\\(boosted\\)]\\)-\\!\\(\\*SubscriptBox[SuperscriptBox[OverscriptBox[\\(p\\), \
\\(_\\)], \\(2\\)], \\(boosted\\)]\\) = \\!\\(\\*SuperscriptBox[\\(m\\), \\(2\
\\)]\\):\"\>", TraditionalForm]], "Print",
 CellChangeTimes->{3.930211546422606*^9, 3.930822778389186*^9},
 CellTags->"Evaluation",
 CellLabel->
  "Durante la evaluaci\[OAcute]n de \
In[1129]:=",ExpressionUUID->"50f15b05-1d97-4a20-8410-937f85b9b2e5"],

Cell[BoxData[
 FormBox[
  SuperscriptBox["mProd", "2"], TraditionalForm]], "Output",
 CellChangeTimes->{3.9302115466508718`*^9, 3.930822778613262*^9},
 CellTags->"Evaluation",
 CellLabel->
  "Out[1142]=",ExpressionUUID->"165e6315-03ef-4c48-8e97-d4005a421e85"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Table with 4-momentum of boosted LLPs", "Subsection",
 CellChangeTimes->{3.885110500646716*^9, 3.915438811768559*^9},
 CellTags->
  "Evaluation",ExpressionUUID->"01958e91-c9fc-4d82-8a1a-4b6851ee4e54"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Table", " ", 
     SubscriptBox["p", 
      RowBox[{"product", ",", "x"}]]}], ",", " ", 
    SubscriptBox["p", 
     RowBox[{"product", ",", "y"}]], ",", " ", 
    SubscriptBox["p", 
     RowBox[{"product", ",", "z"}]], ",", " ", 
    SubscriptBox["E", "product"]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"indexpx", "=", "1"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"indexpy", "=", "2"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"indexpz", "=", "3"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"indexE", "=", "4"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"indexm", "=", "5"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BoostedLLPsFromDecaysTable", "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Hold", "@", 
         RowBox[{"Compile", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"tablemother", ",", "_Real", ",", "1"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"tabledaughter", ",", "_Real", ",", "1"}], "}"}]}], 
            "}"}], ",", 
           RowBox[{"Module", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
              "motherE", ",", "motherpx", ",", "motherpy", ",", "motherpz", 
               ",", "daughterErest", ",", "daughterpxrest", ",", 
               "daughterpyrest", ",", "daughterpzrest", ",", "daughterElab", 
               ",", "daughterpxlab", ",", "daughterpylab", ",", 
               "daughterpzlab", ",", "mmother"}], "}"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"mmother", "=", 
               RowBox[{"Compile`GetElement", "[", 
                RowBox[{"tablemother", ",", "indexm"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"motherE", "=", 
               RowBox[{"Compile`GetElement", "[", 
                RowBox[{"tablemother", ",", "indexE"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"motherpx", "=", 
               RowBox[{"Compile`GetElement", "[", 
                RowBox[{"tablemother", ",", "indexpx"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"motherpy", "=", 
               RowBox[{"Compile`GetElement", "[", 
                RowBox[{"tablemother", ",", "indexpy"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"motherpz", "=", 
               RowBox[{"Compile`GetElement", "[", 
                RowBox[{"tablemother", ",", "indexpz"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"daughterErest", "=", 
               RowBox[{"Compile`GetElement", "[", 
                RowBox[{"tabledaughter", ",", "indexE"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"daughterpxrest", "=", 
               RowBox[{"Compile`GetElement", "[", 
                RowBox[{"tabledaughter", ",", "indexpx"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"daughterpyrest", "=", 
               RowBox[{"Compile`GetElement", "[", 
                RowBox[{"tabledaughter", ",", "indexpy"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"daughterpzrest", "=", 
               RowBox[{"Compile`GetElement", "[", 
                RowBox[{"tabledaughter", ",", "indexpz"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"daughterElab", "=", 
               RowBox[{"EProdLab", "[", 
                RowBox[{
                "motherE", ",", "mmother", ",", "motherpx", ",", "motherpy", 
                 ",", "motherpz", ",", "daughterErest", ",", "daughterpxrest",
                  ",", "daughterpyrest", ",", "daughterpzrest"}], "]"}]}], 
              ";", "\[IndentingNewLine]", 
              RowBox[{"daughterpxlab", "=", 
               RowBox[{"pProductLab1", "[", 
                RowBox[{
                "motherE", ",", "mmother", ",", "motherpx", ",", "motherpy", 
                 ",", "motherpz", ",", "daughterErest", ",", "daughterpxrest",
                  ",", "daughterpyrest", ",", "daughterpzrest"}], "]"}]}], 
              ";", "\[IndentingNewLine]", 
              RowBox[{"daughterpylab", "=", 
               RowBox[{"pProductLab2", "[", 
                RowBox[{
                "motherE", ",", "mmother", ",", "motherpx", ",", "motherpy", 
                 ",", "motherpz", ",", "daughterErest", ",", "daughterpxrest",
                  ",", "daughterpyrest", ",", "daughterpzrest"}], "]"}]}], 
              ";", "\[IndentingNewLine]", 
              RowBox[{"daughterpzlab", "=", 
               RowBox[{"pProductLab3", "[", 
                RowBox[{
                "motherE", ",", "mmother", ",", "motherpx", ",", "motherpy", 
                 ",", "motherpz", ",", "daughterErest", ",", "daughterpxrest",
                  ",", "daughterpyrest", ",", "daughterpzrest"}], "]"}]}], 
              ";", "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{
               "daughterpxlab", ",", "daughterpylab", ",", "daughterpzlab", 
                ",", "daughterElab"}], "}"}]}]}], "\[IndentingNewLine]", 
            "]"}], ",", 
           RowBox[{"CompilationTarget", "\[Rule]", "\"\<C\>\""}], ",", 
           RowBox[{"RuntimeOptions", "\[Rule]", "\"\<Speed\>\""}], ",", 
           RowBox[{"RuntimeAttributes", "\[Rule]", 
            RowBox[{"{", "Listable", "}"}]}]}], "]"}]}], "/.", 
        RowBox[{"ruleDown", "[", 
         RowBox[{"{", 
          RowBox[{
          "pProductLab1", ",", "pProductLab2", ",", "pProductLab3", ",", 
           "EProdLab"}], "}"}], "]"}]}], "/.", 
       RowBox[{"ruleOwn", "[", 
        RowBox[{"{", 
         RowBox[{
         "indexpx", ",", "indexpy", ",", "indexpz", ",", "indexE", ",", 
          "indexm"}], "}"}], "]"}]}], "//", "ReleaseHold"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "This", " ", "code", " ", "converts", " ", "the", " ", "data", " ", "in",
       " ", "the", " ", "form", " ", 
      RowBox[{"{", 
       RowBox[{
        SubscriptBox["p", "x"], ",", 
        SubscriptBox["p", "y"], ",", 
        SubscriptBox["p", "z"], ",", "E", ",", "m"}], "}"}], " ", "into", " ", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\[Theta]", ",", "E"}], "}"}], ".", " ", "If"}], " ", "the", 
      " ", "facility", " ", "is", " ", "based", " ", "on", " ", "symmetric", 
      " ", "pp", " ", "collisions"}], ",", " ", 
     RowBox[{
     "it", " ", "also", " ", "converts", " ", "everything", " ", "to", " ", 
      "the", " ", "forward", " ", "hemisphere", " ", "to", " ", "increase", 
      " ", "the", " ", "statistics"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"BoostedLLPsAngleEnergyData", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"Hold", "@", 
       RowBox[{"Compile", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"BoostedLLPs", ",", "_Real", ",", "1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"mLLP", ",", "_Real"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"abs", ",", "_Integer"}], "}"}]}], "}"}], ",", 
         RowBox[{"Module", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"pzvals", ",", "Evals"}], "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"pzvals", "=", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"abs", "==", "1"}], ",", 
               RowBox[{"Abs", "[", 
                RowBox[{"Compile`GetElement", "[", 
                 RowBox[{"BoostedLLPs", ",", "indexpz"}], "]"}], "]"}], ",", 
               RowBox[{"Compile`GetElement", "[", 
                RowBox[{"BoostedLLPs", ",", "indexpz"}], "]"}]}], "]"}]}], 
            ";", "\[IndentingNewLine]", 
            RowBox[{"Evals", "=", 
             RowBox[{"Compile`GetElement", "[", 
              RowBox[{"BoostedLLPs", ",", "indexE"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"ArcCos", "[", 
               FractionBox["pzvals", 
                SqrtBox[
                 RowBox[{
                  SuperscriptBox["Evals", "2"], "-", 
                  SuperscriptBox["mLLP", "2"]}]]], "]"}], ",", "Evals"}], 
             "}"}]}]}], "]"}], ",", 
         RowBox[{"CompilationTarget", "\[Rule]", "\"\<C\>\""}], ",", 
         RowBox[{"RuntimeOptions", "\[Rule]", "\"\<Speed\>\""}], ",", 
         RowBox[{"RuntimeAttributes", "\[Rule]", 
          RowBox[{"{", "Listable", "}"}]}]}], "]"}]}], "/.", 
      RowBox[{"ruleOwn", "[", 
       RowBox[{"{", 
        RowBox[{"indexpz", ",", "indexE"}], "}"}], "]"}]}], "//", 
     "ReleaseHold"}]}], "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.8777051070651913`*^9, 3.8777051076161757`*^9}, {
   3.877707242386143*^9, 3.877707250384223*^9}, 3.884619473643638*^9, {
   3.8848801603587303`*^9, 3.884880195287534*^9}, 3.8851087401615815`*^9, {
   3.8887384921859083`*^9, 3.8887385051492825`*^9}, {3.88873978796301*^9, 
   3.88873981680283*^9}, 3.892829791602918*^9, {3.892830979665717*^9, 
   3.8928310498101373`*^9}, {3.892831093094026*^9, 3.892831201197757*^9}, {
   3.8928312316318154`*^9, 3.8928312364319353`*^9}, {3.8928313110059085`*^9, 
   3.8928313128799424`*^9}, {3.892831506767464*^9, 3.892831511093667*^9}, 
   3.9043788086123967`*^9, {3.91326729885575*^9, 3.913267359780249*^9}, {
   3.913276757002309*^9, 3.913276798526258*^9}, {3.913276837658628*^9, 
   3.9132768434011116`*^9}, {3.913349818022299*^9, 3.9133498515704284`*^9}, {
   3.9133556548493633`*^9, 3.913355666674196*^9}, {3.9133670584229326`*^9, 
   3.913367133483798*^9}, {3.91543881178265*^9, 3.9154388118116393`*^9}},
 CellTags->"Evaluation",
 CellLabel->
  "In[1143]:=",ExpressionUUID->"2578dee9-aa07-401c-913e-4b52d3ad8240"],

Cell[BoxData[
 FormBox[
  InterpretationBox[
   RowBox[{
    TagBox["CompiledFunction",
     "SummaryHead"], "[", 
    DynamicModuleBox[{Typeset`open$$ = False, Typeset`embedState$$ = "Ready"}, 
     TemplateBox[{
       PaneSelectorBox[{False -> GridBox[{{
             PaneBox[
              ButtonBox[
               DynamicBox[
                FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxOpener"]], 
               ButtonFunction :> (Typeset`open$$ = True), Appearance -> None, 
               BaseStyle -> {}, Evaluator -> Automatic, Method -> 
               "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
              Dynamic[{
                Automatic, 
                 3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                  Magnification])}]], 
             GraphicsBox[{
               Thickness[0.038461538461538464`], {
                FaceForm[{
                  GrayLevel[0.93], 
                  Opacity[1.]}], 
                
                FilledCurveBox[{{{1, 4, 3}, {0, 1, 0}, {1, 3, 3}, {0, 1, 0}, {
                 1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {0, 1, 0}}}, {{{
                 25.499999999999996`, 2.5}, {25.499999999999996`, 
                 1.3953100000000003`}, {24.604699999999998`, 
                 0.49999999999999994`}, {23.5, 0.49999999999999994`}, {2.5, 
                 0.49999999999999994`}, {1.3953100000000003`, 
                 0.49999999999999994`}, {0.49999999999999994`, 
                 1.3953100000000003`}, {0.49999999999999994`, 2.5}, {
                 0.49999999999999994`, 23.5}, {0.49999999999999994`, 
                 24.604699999999998`}, {1.3953100000000003`, 
                 25.499999999999996`}, {2.5, 25.499999999999996`}, {23.5, 
                 25.499999999999996`}, {24.604699999999998`, 
                 25.499999999999996`}, {25.499999999999996`, 
                 24.604699999999998`}, {25.499999999999996`, 23.5}, {
                 25.499999999999996`, 2.5}}}]}, {
                FaceForm[{
                  RGBColor[0.5, 0.5, 0.5], 
                  Opacity[1.]}], 
                
                FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {
                 0, 1, 0}, {0, 1, 0}, {0, 1, 0}}}, {{{20.5426, 
                 19.116799999999998`}, {16.3832, 21.876199999999997`}, {
                 16.3832, 20.021499999999996`}, {6.930469999999999, 
                 20.021499999999996`}, {6.930469999999999, 
                 18.212100000000003`}, {16.3832, 18.212100000000003`}, {
                 16.3832, 16.357399999999995`}, {20.5426, 
                 19.116799999999998`}}}], 
                
                FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {
                 0, 1, 0}, {0, 1, 0}, {0, 1, 0}}}, {{{5.30508, 13.8391}, {
                 9.46445, 11.079700000000003`}, {9.46445, 
                 12.933999999999997`}, {18.917199999999998`, 
                 12.933999999999997`}, {18.917199999999998`, 14.7438}, {
                 9.46445, 14.7438}, {9.46445, 16.598}, {5.30508, 13.8391}}}], 
                
                
                FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {
                 0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
                 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {
                 1, 3, 3}, {1, 3, 3}, {1, 3, 3}}}, CompressedData["
1:eJxTTMoPSmVmYGBgBGJjIGYCYq4u+eR3VWoOxhkv5j+Qk3SA8fu/r5rKOVHM
Yd2vmNyjZ9Qcrt9QXbW9S8RBg59767IidQcPMYPGaHFhB+Nn61SfiGo4xBwp
T7o2V9Dh0Iolfg6/NBxEHv/x1Xgi4FB1XNNqkqQWnP+axUTQjFkbzn+oO2HB
j/3aDg/Xn5T6WiDoYLs3aJpiqI7DrHN+bO6tQg4zfUR7vF7pQOyfIQyRd9d1
WLL0U1kLoyjEPdm6DpoTXfQX7xBzKPjQejLkhDacL5J4+LL2Gm2HtNnSl4Vf
iELM69J2qPZM3tLnJerQX1oozZugDfHPUxGI/4W1HQ5p3TthoyDi4D7lG1v8
Mi2HgqL9zoEHhB1inOxe3BRG8MH62zXhfIbN1Z82CGhC/GMg4nCm3mN/7TYN
iHlCUPdGakDc/1kUEr46GhD/eYnD+d9iBf/kC0vC+TuCrSL+X5Vy2HGR4R5T
uAbEfxYykPBYp+HQqsCuesZAFhL+rJoQ/2rIQdxTpwkJ7yVycPfD+GDzVqLx
xbUd5HYt2JfqBdWfpA2Jj9mykPDpgYaXtaxDy7yzq86vg8qvlIHE5ylY/Eo7
XAt7o787TxfOB5ufqesQ9PbyxxkPZSDhZ6nrMAGU3u7LQtLLEx2HN2253UbX
ofZ76jis/Pay4oynAsT8QG0HKZMv/gW7FCDyTFpwPsz/MD44/Mw1HFjb1uR9
TVVwWKy880/7FHWIexrkIfLX1RzOMDZZVjHIOaDkh3vSDuj5AwCF11Vc
                 "]]}}, Background -> GrayLevel[0.93], Axes -> False, 
              AspectRatio -> 1, ImageSize -> 
              Dynamic[{
                Automatic, 
                 3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                  Magnification])}], Frame -> True, FrameTicks -> None, 
              FrameStyle -> Directive[
                Thickness[Tiny], 
                GrayLevel[0.7]]], 
             GridBox[{{
                RowBox[{
                  TagBox["\"Argument count: \"", "SummaryItemAnnotation"], 
                  "\[InvisibleSpace]", 
                  TagBox["3", "SummaryItem"]}]}, {
                RowBox[{
                  TagBox["\"Argument types: \"", "SummaryItemAnnotation"], 
                  "\[InvisibleSpace]", 
                  TagBox[
                   StyleBox[
                    PaneBox[
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"_Real", ",", "1"}], "}"}], ",", "_Real", ",", 
                    "_Integer"}], "}"}], ContentPadding -> False, 
                    FrameMargins -> 0, StripOnInput -> True, BaselinePosition -> 
                    Baseline, ImageSize -> {{1, 300}, Automatic}], 
                    LineBreakWithin -> False], "SummaryItem"]}]}}, 
              GridBoxAlignment -> {
               "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
              False, GridBoxItemSize -> {
               "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
              GridBoxSpacings -> {
               "Columns" -> {{2}}, "Rows" -> {{Automatic}}}, 
              BaseStyle -> {
               ShowStringCharacters -> False, NumberMarks -> False, 
                PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
           GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
           AutoDelete -> False, 
           GridBoxItemSize -> {
            "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
           BaselinePosition -> {1, 1}], True -> GridBox[{{
             PaneBox[
              ButtonBox[
               DynamicBox[
                FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxCloser"]], 
               ButtonFunction :> (Typeset`open$$ = False), Appearance -> None,
                BaseStyle -> {}, Evaluator -> Automatic, Method -> 
               "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
              Dynamic[{
                Automatic, 
                 3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                  Magnification])}]], 
             GraphicsBox[{
               Thickness[0.038461538461538464`], {
                FaceForm[{
                  GrayLevel[0.93], 
                  Opacity[1.]}], 
                
                FilledCurveBox[{{{1, 4, 3}, {0, 1, 0}, {1, 3, 3}, {0, 1, 0}, {
                 1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {0, 1, 0}}}, {{{
                 25.499999999999996`, 2.5}, {25.499999999999996`, 
                 1.3953100000000003`}, {24.604699999999998`, 
                 0.49999999999999994`}, {23.5, 0.49999999999999994`}, {2.5, 
                 0.49999999999999994`}, {1.3953100000000003`, 
                 0.49999999999999994`}, {0.49999999999999994`, 
                 1.3953100000000003`}, {0.49999999999999994`, 2.5}, {
                 0.49999999999999994`, 23.5}, {0.49999999999999994`, 
                 24.604699999999998`}, {1.3953100000000003`, 
                 25.499999999999996`}, {2.5, 25.499999999999996`}, {23.5, 
                 25.499999999999996`}, {24.604699999999998`, 
                 25.499999999999996`}, {25.499999999999996`, 
                 24.604699999999998`}, {25.499999999999996`, 23.5}, {
                 25.499999999999996`, 2.5}}}]}, {
                FaceForm[{
                  RGBColor[0.5, 0.5, 0.5], 
                  Opacity[1.]}], 
                
                FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {
                 0, 1, 0}, {0, 1, 0}, {0, 1, 0}}}, {{{20.5426, 
                 19.116799999999998`}, {16.3832, 21.876199999999997`}, {
                 16.3832, 20.021499999999996`}, {6.930469999999999, 
                 20.021499999999996`}, {6.930469999999999, 
                 18.212100000000003`}, {16.3832, 18.212100000000003`}, {
                 16.3832, 16.357399999999995`}, {20.5426, 
                 19.116799999999998`}}}], 
                
                FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {
                 0, 1, 0}, {0, 1, 0}, {0, 1, 0}}}, {{{5.30508, 13.8391}, {
                 9.46445, 11.079700000000003`}, {9.46445, 
                 12.933999999999997`}, {18.917199999999998`, 
                 12.933999999999997`}, {18.917199999999998`, 14.7438}, {
                 9.46445, 14.7438}, {9.46445, 16.598}, {5.30508, 13.8391}}}], 
                
                
                FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {
                 0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
                 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {
                 1, 3, 3}, {1, 3, 3}, {1, 3, 3}}}, CompressedData["
1:eJxTTMoPSmVmYGBgBGJjIGYCYq4u+eR3VWoOxhkv5j+Qk3SA8fu/r5rKOVHM
Yd2vmNyjZ9Qcrt9QXbW9S8RBg59767IidQcPMYPGaHFhB+Nn61SfiGo4xBwp
T7o2V9Dh0Iolfg6/NBxEHv/x1Xgi4FB1XNNqkqQWnP+axUTQjFkbzn+oO2HB
j/3aDg/Xn5T6WiDoYLs3aJpiqI7DrHN+bO6tQg4zfUR7vF7pQOyfIQyRd9d1
WLL0U1kLoyjEPdm6DpoTXfQX7xBzKPjQejLkhDacL5J4+LL2Gm2HtNnSl4Vf
iELM69J2qPZM3tLnJerQX1oozZugDfHPUxGI/4W1HQ5p3TthoyDi4D7lG1v8
Mi2HgqL9zoEHhB1inOxe3BRG8MH62zXhfIbN1Z82CGhC/GMg4nCm3mN/7TYN
iHlCUPdGakDc/1kUEr46GhD/eYnD+d9iBf/kC0vC+TuCrSL+X5Vy2HGR4R5T
uAbEfxYykPBYp+HQqsCuesZAFhL+rJoQ/2rIQdxTpwkJ7yVycPfD+GDzVqLx
xbUd5HYt2JfqBdWfpA2Jj9mykPDpgYaXtaxDy7yzq86vg8qvlIHE5ylY/Eo7
XAt7o787TxfOB5ufqesQ9PbyxxkPZSDhZ6nrMAGU3u7LQtLLEx2HN2253UbX
ofZ76jis/Pay4oynAsT8QG0HKZMv/gW7FCDyTFpwPsz/MD44/Mw1HFjb1uR9
TVVwWKy880/7FHWIexrkIfLX1RzOMDZZVjHIOaDkh3vSDuj5AwCF11Vc
                 "]]}}, Background -> GrayLevel[0.93], Axes -> False, 
              AspectRatio -> 1, ImageSize -> 
              Dynamic[{
                Automatic, 
                 3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                  Magnification])}], Frame -> True, FrameTicks -> None, 
              FrameStyle -> Directive[
                Thickness[Tiny], 
                GrayLevel[0.7]]], 
             GridBox[{{
                RowBox[{
                  TagBox["\"Argument count: \"", "SummaryItemAnnotation"], 
                  "\[InvisibleSpace]", 
                  TagBox["3", "SummaryItem"]}]}, {
                RowBox[{
                  TagBox["\"Argument types: \"", "SummaryItemAnnotation"], 
                  "\[InvisibleSpace]", 
                  TagBox[
                   PaneBox[
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"_Real", ",", "1"}], "}"}], ",", "_Real", ",", 
                    "_Integer"}], "}"}], ImageSize -> {{1, 500}, Automatic}, 
                    BaselinePosition -> Baseline, ContentPadding -> False, 
                    FrameMargins -> 0, StripOnInput -> True], 
                   "SummaryItem"]}]}, {
                RowBox[{
                  TagBox["\"Variables: \"", "SummaryItemAnnotation"], 
                  "\[InvisibleSpace]", 
                  TagBox[
                   RowBox[{"{", 
                    RowBox[{"BoostedLLPs", ",", "mLLP", ",", "abs"}], "}"}], 
                   "SummaryItem"]}]}, {
                RowBox[{
                  TagBox["\"Expression: \"", "SummaryItemAnnotation"], 
                  "\[InvisibleSpace]", 
                  TagBox[
                   PaneBox[
                    RowBox[{"Module", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"pzvals", ",", "Evals"}], "}"}], ",", 
                    RowBox[{
                    RowBox[{"pzvals", "=", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"abs", "\[LongEqual]", "1"}], ",", 
                    TemplateBox[{
                    RowBox[{"Compile`GetElement", "(", 
                    RowBox[{"BoostedLLPs", ",", "3"}], ")"}]}, "Abs"], ",", 
                    RowBox[{"Compile`GetElement", "(", 
                    RowBox[{"BoostedLLPs", ",", "3"}], ")"}]}], "]"}]}], ";", 
                    
                    RowBox[{"Evals", "=", 
                    RowBox[{"Compile`GetElement", "(", 
                    RowBox[{"BoostedLLPs", ",", "4"}], ")"}]}], ";", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    SuperscriptBox["cos", 
                    RowBox[{"-", "1"}]], "(", 
                    FractionBox["pzvals", 
                    SqrtBox[
                    RowBox[{
                    SuperscriptBox["Evals", "2"], "-", 
                    SuperscriptBox["mLLP", "2"]}]]], ")"}], ",", "Evals"}], 
                    "}"}]}]}], "]"}], ImageSize -> {{1, 500}, Automatic}, 
                    BaselinePosition -> Baseline, ContentPadding -> False, 
                    FrameMargins -> 0, StripOnInput -> True], 
                   "SummaryItem"]}]}}, 
              GridBoxAlignment -> {
               "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
              False, GridBoxItemSize -> {
               "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
              GridBoxSpacings -> {
               "Columns" -> {{2}}, "Rows" -> {{Automatic}}}, 
              BaseStyle -> {
               ShowStringCharacters -> False, NumberMarks -> False, 
                PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
           GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
           AutoDelete -> False, 
           GridBoxItemSize -> {
            "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
           BaselinePosition -> {1, 1}]}, 
        Dynamic[Typeset`open$$], ImageSize -> Automatic]},
      "SummaryPanel"],
     DynamicModuleValues:>{}], "]"}],
   CompiledFunction[{11, 14., 5592}, {{
      Blank[Real], 1}, 
     Blank[Real], 
     Blank[Integer]}, {{3, 1, 0}, {3, 0, 0}, {2, 0, 0}, {3, 1, 
    1}}, {{1, {2, 0, 1}}, {3, {2, 0, 2}}, {4, {2, 0, 3}}}, {1, 4, 6, 0, 
    2}, {{24, 0, 1, 0}, {2, 0, 5}, {37, 0, 2, 3, 1}, {40, 38, 3, 0, 1, 3, 0, 
     2}, {7, 2, 3}, {3, 3}, {37, 0, 2, 3, 1}, {7, 1, 3}, {37, 0, 3, 3, 2}, {
     40, 56, 3, 0, 2, 3, 0, 1}, {40, 56, 3, 0, 0, 3, 0, 4}, {19, 4, 5}, {13, 
     1, 5, 1}, {40, 57, 3, 0, 1, 3, 0, 5}, {40, 60, 3, 0, 5, 3, 0, 1}, {16, 3,
      1, 5}, {40, 18, 3, 0, 5, 3, 0, 1}, {34, 1, 2, 1, 2, 3, 1}, {1}}, 
    Function[{$CellContext`BoostedLLPs, $CellContext`mLLP, $CellContext`abs}, 
     
     Module[{$CellContext`pzvals, $CellContext`Evals}, $CellContext`pzvals = 
       If[$CellContext`abs == 1, 
         Abs[
          Compile`GetElement[$CellContext`BoostedLLPs, 3]], 
         Compile`GetElement[$CellContext`BoostedLLPs, 3]]; $CellContext`Evals = 
       Compile`GetElement[$CellContext`BoostedLLPs, 4]; {
        ArcCos[$CellContext`pzvals/
         Sqrt[$CellContext`Evals^2 - $CellContext`mLLP^2]], \
$CellContext`Evals}], Listable], Evaluate, 
    LibraryFunction[
    "/Users/alberto/Library/Mathematica/ApplicationData/CCompilerDriver/\
BuildFolder/eduroam-4014-1219/compiledFunction57.dylib", 
     "compiledFunction57", {{Real, 1, "Constant"}, {Real, 0, "Constant"}, {
      Integer, 0, "Constant"}}, {Real, 1}]],
   Editable->False,
   SelectWithContents->True,
   Selectable->False], TraditionalForm]], "Output",
 CellChangeTimes->{3.930211547880916*^9, 3.93082277986162*^9},
 CellTags->"Evaluation",
 CellLabel->
  "Out[1149]=",ExpressionUUID->"9403ae91-cc6b-4846-bb9c-09ba9af279b5"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Block computing the phase space at rest and boosting it", "Subsection",
 CellChangeTimes->{{3.9132766186545777`*^9, 3.913276628170206*^9}},
 CellTags->
  "Evaluation",ExpressionUUID->"aea5f4a7-7e80-4ef3-8261-fdf5a582ee77"],

Cell[CellGroupData[{

Cell["If no averaging over various channels is performed", "Subsubsection",
 CellChangeTimes->{{3.913282657957387*^9, 3.913282665174071*^9}},
 CellTags->
  "Evaluation",ExpressionUUID->"906a3cc7-4794-4d81-918a-9042ea7865fe"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"BoostedLLPsBlock", "[", 
   RowBox[{
   "LLP_", ",", "Facility_", ",", "mLLP_", ",", "process_", ",", "Nevents_"}],
    "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"(*", 
      RowBox[{
      "MotherMass", ",", "topology", ",", "mother", ",", "IfTwoLLPs", ",", 
       "partcontent"}], "*)"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"partcontent", "=", 
      RowBox[{"ReactionProductsList", "[", 
       RowBox[{"LLP", ",", "process"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"mother", "=", 
      RowBox[{"partcontent", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"IfTwoLLPs", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", 
          RowBox[{"Select", "[", 
           RowBox[{"partcontent", ",", 
            RowBox[{
             RowBox[{"#", "==", "LLP"}], "&"}]}], "]"}], "]"}], "==", "2"}], 
        ",", "\"\<True\>\"", ",", "\"\<False\>\""}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"nproducts", "=", 
      RowBox[{
       RowBox[{"Length", "[", "partcontent", "]"}], "-", "1"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", 
         RowBox[{"MotherPoints", "[", 
          RowBox[{"mother", ",", "Facility", ",", "IfTwoLLPs"}], "]"}], "]"}],
         "!=", "Nevents"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"MotherPoints", "[", 
         RowBox[{"mother", ",", "Facility", ",", "IfTwoLLPs"}], "]"}], "=", 
        RowBox[{"PointsSampler", "[", 
         RowBox[{
         "Facility", ",", "mother", ",", "Nevents", ",", "IfTwoLLPs"}], 
         "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"NevSampl", "=", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"IfTwoLLPs", "==", "\"\<True\>\""}], ",", 
         FractionBox["1", "2"], ",", "1"}], "]"}], "Nevents"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "Phase", " ", "space", " ", "of", " ", "HNLs", " ", "at", " ", "the", 
       " ", "rest", " ", "frame", " ", "of", " ", "the", " ", "decaying", " ",
        "particle"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"DataRest", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"nproducts", "==", "3"}], ",", 
        RowBox[{"ThreeBodyDecaysEventsAtRest", "[", 
         RowBox[{"LLP", ",", "process", ",", "mLLP", ",", "NevSampl"}], "]"}],
         ",", 
        RowBox[{"TwoBodyDecaysEventsAtRest", "[", 
         RowBox[{"LLP", ",", "process", ",", "mLLP", ",", "NevSampl"}], 
         "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{
       "Boosting", " ", "and", " ", "returning", " ", "the", " ", "data", " ",
         "in", " ", "the", " ", "form", " ", 
        RowBox[{"Log", "[", "\[Theta]", "]"}]}], ",", 
       RowBox[{"Log", "[", "E", "]"}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Facility", "==", "\"\<ESS\>\""}], "&&", 
        RowBox[{"MemberQ", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"\"\<PiCharged\>\"", ",", "\"\<mu\>\""}], "}"}], ",", 
          "mother"}], "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"datafinal", "=", 
        RowBox[{"BoostedLLPsAngleEnergyData", "[", 
         RowBox[{"DataRest", ",", "mLLP", ",", "0"}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"DataBoosted", "=", 
         RowBox[{"BoostedLLPsFromDecaysTable", "[", 
          RowBox[{
           RowBox[{"MotherPoints", "[", 
            RowBox[{"mother", ",", "Facility", ",", "IfTwoLLPs"}], "]"}], ",",
            "DataRest"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"datafinal", "=", 
         RowBox[{"BoostedLLPsAngleEnergyData", "[", 
          RowBox[{"DataBoosted", ",", "mLLP", ",", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"MemberQ", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"\"\<LHC\>\"", ",", "\"\<FCC-hh\>\""}], "}"}], ",", 
                "Facility"}], "]"}], "==", "True"}], ",", "1", ",", "0"}], 
            "]"}]}], "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", "datafinal"}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"pts", "=", 
        RowBox[{"PointsSampler", "[", 
         RowBox[{"\"\<LHC\>\"", ",", "\"\<Bplus\>\"", ",", 
          SuperscriptBox["10", "6"], ",", "\"\<False\>\""}], "]"}]}], ";"}], "//", 
      RowBox[{"AbsoluteTiming", "\[IndentingNewLine]", 
       RowBox[{"BoostedLLPsBlock", "[", 
        RowBox[{
        "\"\<HNL-mixing-e\>\"", ",", "\"\<B-2-body\>\"", ",", "5.2", ",", 
         "pts"}], "]"}]}]}], ";"}], "//", 
    RowBox[{"AbsoluteTiming", "\[IndentingNewLine]", 
     RowBox[{"Histogram", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"DataBoosted", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "4"}], "]"}], "]"}], ",", 
         RowBox[{"pts", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "4"}], "]"}], "]"}]}], "}"}], ",", "1000", ",", 
       RowBox[{"ScalingFunctions", "->", 
        RowBox[{"{", 
         RowBox[{"\"\<Log\>\"", ",", "\"\<Log\>\""}], "}"}]}]}], "]"}]}]}], 
   "*)"}]}]}], "Input",
 CellChangeTimes->{{3.913276635055531*^9, 3.913276724184464*^9}, 
   3.91327680949527*^9, {3.91327685085491*^9, 3.9132768512161*^9}, {
   3.913277137256299*^9, 3.9132771478802247`*^9}, {3.9132777970076485`*^9, 
   3.9132777974468746`*^9}, {3.9132824703074865`*^9, 
   3.9132825155812597`*^9}, {3.913282632771162*^9, 3.913282647770756*^9}, {
   3.9132826789608793`*^9, 3.913282857704444*^9}, {3.913282933045665*^9, 
   3.913282939119652*^9}, {3.9133498570300493`*^9, 3.91334987388033*^9}, 
   3.913355665782878*^9, {3.913366909723243*^9, 3.913366921550502*^9}, {
   3.913394898034992*^9, 3.913394898909567*^9}, {3.913451816741021*^9, 
   3.913451820166819*^9}, {3.9134519493771753`*^9, 3.913452008825906*^9}, {
   3.914833974385343*^9, 3.914834044030738*^9}, {3.914835813783077*^9, 
   3.914835823387859*^9}, {3.9154388118376307`*^9, 3.9154388119166718`*^9}, {
   3.915439172205876*^9, 3.915439189059957*^9}, 3.915440189974284*^9, {
   3.915440413322027*^9, 3.915440430923261*^9}, {3.915440484521723*^9, 
   3.9154405205723734`*^9}, 3.915440966161051*^9},
 CellTags->"Evaluation",
 CellLabel->
  "In[1150]:=",ExpressionUUID->"6170bea7-0a36-4d2c-bd34-0673a1930274"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Averaging over several production channels (complicated HNL case)\
\>", "Subsubsection",
 CellChangeTimes->{{3.913279331129129*^9, 3.9132793409506*^9}},
 CellTags->
  "Evaluation",ExpressionUUID->"4896fb44-7b77-4532-961a-3e71ba936caf"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"BoostedHNLsBlockTemp", "[", 
   RowBox[{
   "LLP_", ",", "Facility_", ",", "mLLP_", ",", "process_", ",", 
    "MotherData_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"MotherMass", ",", "topology", ",", "Nev"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"partcontent", "=", 
      RowBox[{"ReactionProductsList", "[", 
       RowBox[{"LLP", ",", "process"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"nproducts", "=", 
      RowBox[{
       RowBox[{"Length", "[", "partcontent", "]"}], "-", "1"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Nev", "=", 
      RowBox[{"Length", "[", "MotherData", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "Phase", " ", "space", " ", "of", " ", "HNLs", " ", "at", " ", "the", 
       " ", "rest", " ", "frame", " ", "of", " ", "the", " ", "decaying", " ",
        "particle"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"DataRest", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"nproducts", "==", "3"}], ",", 
        RowBox[{"ThreeBodyDecaysEventsAtRest", "[", 
         RowBox[{"LLP", ",", "process", ",", "mLLP", ",", "Nev"}], "]"}], ",", 
        RowBox[{"TwoBodyDecaysEventsAtRest", "[", 
         RowBox[{"LLP", ",", "process", ",", "mLLP", ",", "Nev"}], "]"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{
       "Boosting", " ", "and", " ", "returning", " ", "the", " ", "data", " ",
         "in", " ", "the", " ", "form", " ", 
        RowBox[{"Log", "[", "\[Theta]", "]"}]}], ",", 
       RowBox[{"Log", "[", "E", "]"}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"DataBoosted", "=", 
      RowBox[{"BoostedLLPsFromDecaysTable", "[", 
       RowBox[{"MotherData", ",", "DataRest"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"BoostedLLPsAngleEnergyData", "[", 
      RowBox[{"DataBoosted", ",", "mLLP", ",", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"MemberQ", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"\"\<LHC\>\"", ",", "\"\<FCC-hh\>\""}], "}"}], ",", 
            "Facility"}], "]"}], "==", "True"}], ",", "1", ",", "0"}], 
        "]"}]}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BoostedHNLsBlock", "[", 
   RowBox[{
   "HNL_", ",", "Facility_", ",", "mN_", ",", "process_", ",", "Nevents_"}], 
   "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "IfTwoLLPs", ",", "proc", ",", "nev", ",", "proclist", ",", "mother"}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"IfTwoLLPs", "=", "\"\<False\>\""}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"process", "==", "\"\<B\>\""}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"proclist", "=", 
         RowBox[{"{", 
          RowBox[{
          "\"\<B-3-body\>\"", ",", "\"\<B-2-body\>\"", ",", "\"\<Bc\>\""}], 
          "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", 
            RowBox[{"MotherPoints", "[", 
             RowBox[{"\"\<Bplus\>\"", ",", "Facility", ",", "IfTwoLLPs"}], 
             "]"}], "]"}], "!=", "Nevents"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"MotherPoints", "[", 
            RowBox[{"\"\<Bplus\>\"", ",", "Facility", ",", "IfTwoLLPs"}], 
            "]"}], "=", 
           RowBox[{"PointsSampler", "[", 
            RowBox[{
            "Facility", ",", "\"\<Bplus\>\"", ",", "Nevents", ",", 
             "IfTwoLLPs"}], "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", 
            RowBox[{"MotherPoints", "[", 
             RowBox[{"\"\<Bc\>\"", ",", "Facility", ",", "IfTwoLLPs"}], "]"}],
             "]"}], "!=", "Nevents"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"MotherPoints", "[", 
            RowBox[{"\"\<Bc\>\"", ",", "Facility", ",", "IfTwoLLPs"}], "]"}], 
           "=", 
           RowBox[{"DataConverted", "[", 
            RowBox[{
             RowBox[{"MotherPoints", "[", 
              RowBox[{"\"\<Bplus\>\"", ",", "Facility", ",", "IfTwoLLPs"}], 
              "]"}], ",", 
             RowBox[{"mSM", "[", "\"\<Bc\>\"", "]"}]}], "]"}]}]}], "]"}], 
        ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"process", "==", "\"\<D\>\""}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"proclist", "=", 
         RowBox[{"{", 
          RowBox[{
          "\"\<D-3-body\>\"", ",", "\"\<D-2-body\>\"", ",", 
           "\"\<\[Tau]-2-body\>\"", ",", "\"\<\[Tau]-3-body\>\""}], "}"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", 
            RowBox[{"MotherPoints", "[", 
             RowBox[{"\"\<Ds\>\"", ",", "Facility", ",", "IfTwoLLPs"}], "]"}],
             "]"}], "!=", "Nevents"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"MotherPoints", "[", 
            RowBox[{"\"\<Ds\>\"", ",", "Facility", ",", "IfTwoLLPs"}], "]"}], 
           "=", 
           RowBox[{"PointsSampler", "[", 
            RowBox[{
            "Facility", ",", "\"\<Ds\>\"", ",", "Nevents", ",", "IfTwoLLPs"}],
             "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", 
            RowBox[{"MotherPoints", "[", 
             RowBox[{"\"\<Dplus\>\"", ",", "Facility", ",", "IfTwoLLPs"}], 
             "]"}], "]"}], "!=", "Nevents"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"MotherPoints", "[", 
            RowBox[{"\"\<Dplus\>\"", ",", "Facility", ",", "IfTwoLLPs"}], 
            "]"}], "=", 
           RowBox[{"DataConverted", "[", 
            RowBox[{
             RowBox[{"MotherPoints", "[", 
              RowBox[{"\"\<Ds\>\"", ",", "Facility", ",", "IfTwoLLPs"}], 
              "]"}], ",", 
             RowBox[{"mSM", "[", "\"\<Dplus\>\"", "]"}]}], "]"}]}]}], "]"}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", 
            RowBox[{"MotherPoints", "[", 
             RowBox[{"\"\<tau\>\"", ",", "Facility", ",", "IfTwoLLPs"}], 
             "]"}], "]"}], "!=", "Nevents"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"MotherPoints", "[", 
            RowBox[{"\"\<tau\>\"", ",", "Facility", ",", "IfTwoLLPs"}], "]"}],
            "=", 
           RowBox[{"DataConverted", "[", 
            RowBox[{
             RowBox[{"MotherPoints", "[", 
              RowBox[{"\"\<Ds\>\"", ",", "Facility", ",", "IfTwoLLPs"}], 
              "]"}], ",", 
             RowBox[{"mSM", "[", "\"\<tau\>\"", "]"}]}], "]"}]}]}], "]"}], 
        ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"MemberQ", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"\"\<B\>\"", ",", "\"\<D\>\""}], "}"}], ",", "process"}], 
        "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"proclistspl", "=", 
         RowBox[{"NeventsSplitterHNL", "[", 
          RowBox[{
          "HNL", ",", "Facility", ",", "proclist", ",", "mN", ",", 
           "Nevents"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"boosteddata", "=", 
         RowBox[{"{", 
          RowBox[{"{", "}"}], "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Do", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{"proc", ",", "nev"}], "}"}], "=", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"proclistspl", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", 
              RowBox[{
               RowBox[{"proclistspl", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"mother", "=", 
            RowBox[{
             RowBox[{"ReactionProductsList", "[", 
              RowBox[{"HNL", ",", "proc"}], "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"boosteddata", "=", 
            RowBox[{"Join", "[", 
             RowBox[{"boosteddata", ",", 
              RowBox[{"BoostedHNLsBlockTemp", "[", 
               RowBox[{"HNL", ",", "Facility", ",", "mN", ",", "proc", ",", 
                RowBox[{"Take", "[", 
                 RowBox[{
                  RowBox[{"MotherPoints", "[", 
                   RowBox[{"mother", ",", "Facility", ",", "IfTwoLLPs"}], 
                   "]"}], ",", "nev"}], "]"}]}], "]"}]}], "]"}]}], ";"}], 
          "\[IndentingNewLine]", ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"Length", "[", "proclistspl", "]"}], ",", "1"}], "}"}]}], 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"boosteddata", "=", 
         RowBox[{"Drop", "[", 
          RowBox[{"boosteddata", ",", "1"}], "]"}]}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"MemberQ", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"\"\<B\>\"", ",", "\"\<D\>\""}], "}"}], ",", "process"}], 
         "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"boosteddata", "=", 
         RowBox[{"BoostedLLPsBlock", "[", 
          RowBox[{
          "HNL", ",", "Facility", ",", "mN", ",", "process", ",", "Nevents"}],
           "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", "boosteddata"}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.9132793449053106`*^9, 3.913279346003558*^9}, {
   3.913279408329975*^9, 3.9132794605127983`*^9}, {3.913279498171851*^9, 
   3.913279519527809*^9}, {3.913279580013357*^9, 3.913279688655737*^9}, {
   3.913279745103171*^9, 3.913279805187897*^9}, {3.913280026417532*^9, 
   3.913280026998374*^9}, {3.9132801236548877`*^9, 3.91328012575774*^9}, {
   3.9132801565812483`*^9, 3.913280161132337*^9}, {3.913280255710074*^9, 
   3.913280390937107*^9}, {3.9132804256305947`*^9, 3.913280425787722*^9}, {
   3.913280495544731*^9, 3.9132805928334136`*^9}, {3.913280640831369*^9, 
   3.9132807038180933`*^9}, {3.913280748686411*^9, 3.913280891838624*^9}, {
   3.9132809225765676`*^9, 3.913280946655202*^9}, {3.913280980590913*^9, 
   3.913281012236035*^9}, {3.9132815450771894`*^9, 3.913281548875499*^9}, {
   3.913282124576722*^9, 3.9132821396034665`*^9}, {3.913282221414588*^9, 
   3.913282303414307*^9}, {3.913282494423591*^9, 3.913282495160875*^9}, {
   3.913282607441057*^9, 3.9132826128073606`*^9}, 3.913282731548091*^9, {
   3.913306316476384*^9, 3.9133063174004297`*^9}, {3.91334989094145*^9, 
   3.913349892031466*^9}, {3.913349995091698*^9, 3.913350066617115*^9}, {
   3.913350105151244*^9, 3.913350123451234*^9}, 3.913355665799286*^9, {
   3.913366960719495*^9, 3.913367044440323*^9}, {3.913367149851327*^9, 
   3.913367160880118*^9}, {3.913394355531282*^9, 3.913394389364807*^9}, {
   3.913394420967258*^9, 3.9133944716014357`*^9}, {3.913394825306978*^9, 
   3.913394828539708*^9}, {3.913710602242689*^9, 3.913710602572151*^9}, {
   3.914835609600112*^9, 3.914835613725318*^9}, {3.9154388119367447`*^9, 
   3.915438812086255*^9}, {3.915439207580928*^9, 3.915439228026534*^9}, {
   3.9154392581937356`*^9, 3.9154392597664194`*^9}, 3.915440189985119*^9, {
   3.915440554719097*^9, 3.915440590643652*^9}, {3.915440966167076*^9, 
   3.915440966173041*^9}},
 CellTags->"Evaluation",
 CellLabel->
  "In[1151]:=",ExpressionUUID->"0591216c-b934-4ffa-9068-f81bf8ac5919"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Production via decays: converting boosted LLPs data into PDF", "Chapter",
 CellChangeTimes->{{3.913276543846873*^9, 3.913276546120432*^9}, 
   3.9132779180717936`*^9, {3.913461087303244*^9, 3.913461104799628*^9}, 
   3.915438812095248*^9},
 CellTags->
  "Evaluation",ExpressionUUID->"6ce9c6c5-267f-4281-845d-ee1e4a6f158c"],

Cell[CellGroupData[{

Cell["Converting data Log[\[Theta]], Log[E] into PDF", "Section",
 CellChangeTimes->{{3.893861995593613*^9, 3.8938619969999332`*^9}, {
  3.913263196246865*^9, 3.9132632222020884`*^9}},
 CellTags->
  "Evaluation",ExpressionUUID->"f7ce7329-1054-402b-ae07-4c91d94bf548"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]listBinning", "[", "\"\<SPS\>\"", "]"}], "=", 
   RowBox[{
    RowBox[{"\[Theta]listBinning", "[", "\"\<Serpukhov\>\"", "]"}], "=", 
    RowBox[{
     RowBox[{"\[Theta]listBinning", "[", "\"\<FermilabBD\>\"", "]"}], "=", 
     RowBox[{
      RowBox[{"\[Theta]listBinning", "[", "\"\<LHC_fixed_target\>\"", "]"}], 
      "=", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             SuperscriptBox["10", 
              RowBox[{"-", "6."}]], ",", 
             SuperscriptBox["10", 
              RowBox[{"-", "5."}]], ",", 
             RowBox[{"(*", 
              RowBox[{
               RowBox[{"3", "*", 
                SuperscriptBox["10", 
                 RowBox[{"-", "5."}]]}], ",", 
               RowBox[{"6", "*", 
                SuperscriptBox["10", 
                 RowBox[{"-", "5."}]]}], ","}], "*)"}], ",", 
             SuperscriptBox["10", 
              RowBox[{"-", "4."}]], ",", 
             RowBox[{"5", "*", 
              SuperscriptBox["10", 
               RowBox[{"-", "4."}]]}], ",", 
             SuperscriptBox["10", 
              RowBox[{"-", "3."}]], ",", 
             RowBox[{"2", "*", 
              SuperscriptBox["10", 
               RowBox[{"-", "3."}]]}], ",", 
             RowBox[{"4", "*", 
              SuperscriptBox["10", 
               RowBox[{"-", "3."}]]}], ",", 
             RowBox[{"6", "*", 
              SuperscriptBox["10", 
               RowBox[{"-", "3."}]]}], ",", 
             RowBox[{"8", "*", 
              SuperscriptBox["10", 
               RowBox[{"-", "3."}]]}]}], "}"}], ",", 
           RowBox[{"Table", "[", 
            RowBox[{
             SuperscriptBox["10", "\[Theta]N"], ",", 
             RowBox[{"{", 
              RowBox[{"\[Theta]N", ",", 
               RowBox[{"Log10", "[", 
                SuperscriptBox["10", 
                 RowBox[{"-", "2"}]], "]"}], ",", 
               RowBox[{"Log10", "[", "0.5", "]"}], ",", "0.025"}], "}"}]}], 
            "]"}], ",", 
           RowBox[{"Table", "[", 
            RowBox[{
             SuperscriptBox["10", "\[Theta]N"], ",", 
             RowBox[{"{", 
              RowBox[{"\[Theta]N", ",", 
               RowBox[{"Log10", "[", "0.52", "]"}], ",", 
               RowBox[{"Log10", "[", "Pi", "]"}], ",", "0.015"}], "}"}]}], 
            "]"}], ",", 
           RowBox[{"{", "Pi", "}"}]}], "]"}], "//", "N"}], "//", 
        "DeleteDuplicates"}], "//", "Developer`ToPackedArray"}]}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]listBinning", "[", "\"\<LHC\>\"", "]"}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          SuperscriptBox["10", 
           RowBox[{"-", "6."}]], ",", 
          SuperscriptBox["10", 
           RowBox[{"-", "5."}]], ",", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"3", "*", 
             SuperscriptBox["10", 
              RowBox[{"-", "5."}]]}], ",", 
            RowBox[{"6", "*", 
             SuperscriptBox["10", 
              RowBox[{"-", "5."}]]}], ","}], "*)"}], 
          RowBox[{"5", "*", 
           SuperscriptBox["10", 
            RowBox[{"-", "5."}]]}], ",", 
          SuperscriptBox["10", 
           RowBox[{"-", "4."}]], ",", 
          RowBox[{"3", "*", 
           SuperscriptBox["10", 
            RowBox[{"-", "4."}]]}], ",", 
          RowBox[{"6", "*", 
           SuperscriptBox["10", 
            RowBox[{"-", "4."}]]}], ",", 
          SuperscriptBox["10", 
           RowBox[{"-", "3."}]], ",", 
          RowBox[{"2", "*", 
           SuperscriptBox["10", 
            RowBox[{"-", "3."}]]}], ",", 
          RowBox[{"4", "*", 
           SuperscriptBox["10", 
            RowBox[{"-", "3."}]]}], ",", 
          RowBox[{"6", "*", 
           SuperscriptBox["10", 
            RowBox[{"-", "3."}]]}], ",", 
          RowBox[{"8", "*", 
           SuperscriptBox["10", 
            RowBox[{"-", "3."}]]}]}], "}"}], ",", 
        RowBox[{"Table", "[", 
         RowBox[{
          SuperscriptBox["10", "\[Theta]N"], ",", 
          RowBox[{"{", 
           RowBox[{"\[Theta]N", ",", 
            RowBox[{"Log10", "[", 
             SuperscriptBox["10", 
              RowBox[{"-", "2."}]], "]"}], ",", 
            RowBox[{"Log10", "[", "0.5", "]"}], ",", "0.025"}], "}"}]}], 
         "]"}], ",", 
        RowBox[{"Table", "[", 
         RowBox[{
          SuperscriptBox["10", "\[Theta]N"], ",", 
          RowBox[{"{", 
           RowBox[{"\[Theta]N", ",", 
            RowBox[{"Log10", "[", "0.52", "]"}], ",", 
            RowBox[{"Log10", "[", "1.", "]"}], ",", "0.015"}], "}"}]}], "]"}],
         ",", 
        RowBox[{"Table", "[", 
         RowBox[{
          SuperscriptBox["10", "\[Theta]N"], ",", 
          RowBox[{"{", 
           RowBox[{"\[Theta]N", ",", 
            RowBox[{"Log10", "[", "1.02", "]"}], ",", 
            RowBox[{"Log10", "[", 
             FractionBox["Pi", "2"], "]"}], ",", "0.01"}], "}"}]}], "]"}], 
        ",", 
        RowBox[{"{", 
         FractionBox["Pi", "2"], "}"}]}], "]"}], "//", "N"}], "//", 
     "DeleteDuplicates"}], "//", "Developer`ToPackedArray"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]listBinning", "[", "\"\<FCC-hh\>\"", "]"}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          SuperscriptBox["10", 
           RowBox[{"-", "6."}]], ",", 
          SuperscriptBox["10", 
           RowBox[{"-", "5."}]], ",", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"3", "*", 
             SuperscriptBox["10", 
              RowBox[{"-", "5."}]]}], ",", 
            RowBox[{"6", "*", 
             SuperscriptBox["10", 
              RowBox[{"-", "5."}]]}], ","}], "*)"}], 
          RowBox[{"7", "*", 
           SuperscriptBox["10", 
            RowBox[{"-", "5."}]]}], ",", 
          SuperscriptBox["10", 
           RowBox[{"-", "4."}]], ",", 
          RowBox[{"3", "*", 
           SuperscriptBox["10", 
            RowBox[{"-", "4."}]]}], ",", 
          RowBox[{"6", "*", 
           SuperscriptBox["10", 
            RowBox[{"-", "4."}]]}], ",", 
          SuperscriptBox["10", 
           RowBox[{"-", "3."}]], ",", 
          RowBox[{"2", "*", 
           SuperscriptBox["10", 
            RowBox[{"-", "3."}]]}], ",", 
          RowBox[{"4", "*", 
           SuperscriptBox["10", 
            RowBox[{"-", "3."}]]}], ",", 
          RowBox[{"6", "*", 
           SuperscriptBox["10", 
            RowBox[{"-", "3."}]]}], ",", 
          RowBox[{"8", "*", 
           SuperscriptBox["10", 
            RowBox[{"-", "3."}]]}]}], "}"}], ",", 
        RowBox[{"Table", "[", 
         RowBox[{
          SuperscriptBox["10", "\[Theta]N"], ",", 
          RowBox[{"{", 
           RowBox[{"\[Theta]N", ",", 
            RowBox[{"Log10", "[", 
             SuperscriptBox["10", 
              RowBox[{"-", "2"}]], "]"}], ",", 
            RowBox[{"Log10", "[", "0.5", "]"}], ",", "0.025"}], "}"}]}], 
         "]"}], ",", 
        RowBox[{"Table", "[", 
         RowBox[{
          SuperscriptBox["10", "\[Theta]N"], ",", 
          RowBox[{"{", 
           RowBox[{"\[Theta]N", ",", 
            RowBox[{"Log10", "[", "0.52", "]"}], ",", 
            RowBox[{"Log10", "[", 
             FractionBox["Pi", "2"], "]"}], ",", "0.02"}], "}"}]}], "]"}], 
        ",", 
        RowBox[{"{", 
         FractionBox["Pi", "2"], "}"}]}], "]"}], "//", "N"}], "//", 
     "DeleteDuplicates"}], "//", "Developer`ToPackedArray"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"\[Theta]listBinning", "[", "\"\<ESS\>\"", "]"}], "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SuperscriptBox["10", 
            RowBox[{"-", "6."}]], ",", 
           SuperscriptBox["10", 
            RowBox[{"-", "5."}]], ",", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"3", "*", 
              SuperscriptBox["10", 
               RowBox[{"-", "5."}]]}], ",", 
             RowBox[{"6", "*", 
              SuperscriptBox["10", 
               RowBox[{"-", "5."}]]}], ","}], "*)"}], 
           SuperscriptBox["10", 
            RowBox[{"-", "4."}]], ",", 
           SuperscriptBox["10", 
            RowBox[{"-", "3."}]], ",", 
           SuperscriptBox["10", 
            RowBox[{"-", "2."}]]}], "}"}], ",", 
         RowBox[{"Table", "[", 
          RowBox[{
           SuperscriptBox["10", "\[Theta]N"], ",", 
           RowBox[{"{", 
            RowBox[{"\[Theta]N", ",", 
             RowBox[{"Log10", "[", 
              RowBox[{"3", "*", 
               SuperscriptBox["10", 
                RowBox[{"-", "2."}]]}], "]"}], ",", 
             RowBox[{"Log10", "[", "0.5", "]"}], ",", "0.25"}], "}"}]}], 
          "]"}], ",", 
         RowBox[{"Table", "[", 
          RowBox[{
           SuperscriptBox["10", "\[Theta]N"], ",", 
           RowBox[{"{", 
            RowBox[{"\[Theta]N", ",", 
             RowBox[{"Log10", "[", "0.52", "]"}], ",", 
             RowBox[{"Log10", "[", "Pi", "]"}], ",", "0.1"}], "}"}]}], "]"}], 
         ",", 
         RowBox[{"{", "Pi", "}"}]}], "]"}], "//", "N"}], "//", 
      "DeleteDuplicates"}], "//", "Developer`ToPackedArray"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "The", " ", "block", " ", "that", " ", "computes", " ", "the", " ", 
     "smooth", " ", "pdf", " ", 
     SubscriptBox["f", 
      RowBox[{"\[Theta]", ",", "E"}]], " ", "from", " ", "the", " ", "data", 
     " ", "BoostedData", " ", "in", " ", "the", " ", "form", " ", 
     RowBox[{"Log", "[", "\[Theta]", "]"}]}], ",", 
    RowBox[{"Log", "[", "E", "]"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FromDataToSmoothDistribution", "[", 
   RowBox[{
   "BoostedData_", ",", "mass_", ",", "Facility_", ",", "IfTesting_"}], "]"}],
   ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\[Theta]minDistr", ",", "\[Theta]maxDistr"}], "}"}], "=", 
      RowBox[{"MinMax", "[", 
       RowBox[{"BoostedData", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"EminDistr", ",", "EmaxDistr"}], "}"}], "=", 
      RowBox[{"MinMax", "[", 
       RowBox[{"BoostedData", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"vals\[Theta]", "=", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"\[Theta]listBinning", "[", "Facility", "]"}], ",", 
          RowBox[{
           RowBox[{"#", "<", "\[Theta]maxDistr"}], "&"}]}], "]"}], ",", 
        RowBox[{"{", "\[Theta]maxDistr", "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"Facility", "==", "\"\<ESS\>\""}], ",", "\[IndentingNewLine]", 
       
       RowBox[{"valsE", "=", 
        RowBox[{"ENlist", "[", "\"\<ESS\>\"", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"valsE", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Join", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0.97", "EminDistr"}], "}"}], ",", 
             RowBox[{"With", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"start", "=", "EminDistr"}], ",", 
                 RowBox[{"end", "=", "EmaxDistr"}]}], "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"NestWhileList", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"#", "+", 
                   RowBox[{"StepEtemp", "[", "#", "]"}]}], "&"}], ",", 
                 "start", ",", 
                 RowBox[{
                  RowBox[{"#", "\[LessEqual]", "end"}], "&"}], ",", "1", ",", 
                 "\[Infinity]", ",", 
                 RowBox[{"-", "1"}]}], "]"}]}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"EmaxDistr", ",", 
               RowBox[{"1.03", "EmaxDistr"}]}], "}"}]}], "]"}], "//", "N"}], "//",
           "DeleteDuplicates"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"bcc", "=", 
      RowBox[{"BinCounts", "[", 
       RowBox[{"BoostedData", ",", 
        RowBox[{"{", "vals\[Theta]", "}"}], ",", 
        RowBox[{"{", "valsE", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"tabpdf", "=", 
      RowBox[{"Flatten", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            FractionBox[
             RowBox[{
              RowBox[{"vals\[Theta]", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "+", 
              RowBox[{"vals\[Theta]", "[", 
               RowBox[{"[", 
                RowBox[{"i", "+", "1"}], "]"}], "]"}]}], "2"], ",", 
            FractionBox[
             RowBox[{
              RowBox[{"valsE", "[", 
               RowBox[{"[", "j", "]"}], "]"}], "+", 
              RowBox[{"valsE", "[", 
               RowBox[{"[", 
                RowBox[{"j", "+", "1"}], "]"}], "]"}]}], "2"], ",", 
            RowBox[{"Max", "[", 
             RowBox[{
              SuperscriptBox["10", 
               RowBox[{"-", "90."}]], ",", 
              FractionBox[
               RowBox[{
                RowBox[{"bcc", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "[", 
                RowBox[{"[", "j", "]"}], "]"}], 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"valsE", "[", 
                   RowBox[{"[", 
                    RowBox[{"j", "+", "1"}], "]"}], "]"}], "-", 
                  RowBox[{"valsE", "[", 
                   RowBox[{"[", "j", "]"}], "]"}]}], ")"}], "*", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"vals\[Theta]", "[", 
                   RowBox[{"[", 
                    RowBox[{"i", "+", "1"}], "]"}], "]"}], "-", 
                  RowBox[{"vals\[Theta]", "[", 
                   RowBox[{"[", "i", "]"}], "]"}]}], ")"}]}]]}], "]"}]}], 
           "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{
             RowBox[{"Length", "[", "vals\[Theta]", "]"}], "-", "1"}], ",", 
            "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "1", ",", 
            RowBox[{
             RowBox[{"Length", "[", "valsE", "]"}], "-", "1"}], ",", "1"}], 
           "}"}]}], "]"}], ",", "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"thmin", ",", "thmax", ",", "emin", ",", "emax"}], "}"}], "=", 
      
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"tabpdf", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "1"}], "]"}], "]"}], "//", "Min"}], ",", 
          RowBox[{"Min", "[", 
           RowBox[{"Pi", ",", 
            RowBox[{
             RowBox[{"tabpdf", "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", "1"}], "]"}], "]"}], "//", "Max"}]}], 
           "]"}], ",", 
          RowBox[{
           RowBox[{"tabpdf", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "2"}], "]"}], "]"}], "//", "MinMax"}]}], 
         "}"}], "//", "Flatten"}], "//", "N"}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"(*", 
      RowBox[{
       RowBox[{
        RowBox[{"DoubleDistr", "[", 
         RowBox[{"\[Theta]LLP_", ",", "ELLP_"}], "]"}], "=", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"emin", "<=", "ELLP", "<=", "emax"}], "&&", 
           RowBox[{"thmin", "<=", "\[Theta]LLP", "<=", "thmax"}]}], ",", 
          RowBox[{"Evaluate", "[", 
           RowBox[{
            FractionBox["1", 
             RowBox[{"Length", "[", "BoostedData", "]"}]], 
            RowBox[{
             RowBox[{"Interpolation", "[", 
              RowBox[{"tabpdf", ",", 
               RowBox[{"InterpolationOrder", "->", "1"}]}], "]"}], "[", 
             RowBox[{"\[Theta]LLP", ",", "ELLP"}], "]"}]}], "]"}], ",", 
          SuperscriptBox["10", 
           RowBox[{"-", "90."}]]}], "]"}]}], ";"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"DoubleDistr", "[", 
       RowBox[{"\[Theta]LLP_", ",", "ELLP_"}], "]"}], "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"emin", "<=", "ELLP", "<=", "emax"}], "&&", 
         RowBox[{"thmin", "<=", "\[Theta]LLP", "<=", "thmax"}]}], ",", 
        RowBox[{"Evaluate", "[", 
         RowBox[{
          FractionBox["1", 
           RowBox[{"Length", "[", "BoostedData", "]"}]], 
          RowBox[{
           RowBox[{"Interpolation", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Log", "[", 
                  RowBox[{"#", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
                 RowBox[{"Log", "[", 
                  RowBox[{"#", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", 
                 RowBox[{"#", "[", 
                  RowBox[{"[", "3", "]"}], "]"}]}], "}"}], "&"}], "/@", 
              "tabpdf"}], ",", 
             RowBox[{"InterpolationOrder", "->", "1"}]}], "]"}], "[", 
           RowBox[{
            RowBox[{"Log", "[", "\[Theta]LLP", "]"}], ",", 
            RowBox[{"Log", "[", "ELLP", "]"}]}], "]"}]}], "]"}], ",", 
        SuperscriptBox["10", 
         RowBox[{"-", "90."}]]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{
        RowBox[{"DoubleDistr", "[", 
         RowBox[{"\[Theta]LLP_", ",", "ELLP_"}], "]"}], "=", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"emin", "<=", "ELLP", "<=", "emax"}], "&&", 
           RowBox[{"thmin", "<=", "\[Theta]LLP", "<=", "thmax"}]}], ",", 
          RowBox[{"Evaluate", "[", 
           RowBox[{
            FractionBox["1", 
             RowBox[{"Length", "[", "BoostedData", "]"}]], 
            RowBox[{"10", "^", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Interpolation", "[", 
                RowBox[{
                 RowBox[{"Log10", "[", "tabpdf", "]"}], ",", 
                 RowBox[{"InterpolationOrder", "->", "1"}]}], "]"}], "[", 
               RowBox[{
                RowBox[{"Log10", "[", "\[Theta]LLP", "]"}], ",", 
                RowBox[{"Log10", "[", "ELLP", "]"}]}], "]"}], ")"}]}]}], 
           "]"}], ",", 
          SuperscriptBox["10", 
           RowBox[{"-", "90."}]]}], "]"}]}], ";"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"collopt", "=", 
      RowBox[{"MemberQ", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"\"\<LHC\>\"", ",", "\"\<FCC-hh\>\""}], "}"}], ",", 
        "Facility"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{"collopt", ",", 
       RowBox[{
        RowBox[{"DoubleDistr", "[", 
         RowBox[{"\[Theta]LLP_", ",", "ELLP_"}], "]"}], "=", 
        RowBox[{
         FractionBox["1", "2"], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"DoubleDistr", "[", 
            RowBox[{"\[Theta]LLP", ",", "ELLP"}], "]"}], "+", 
           RowBox[{"DoubleDistr", "[", 
            RowBox[{
             RowBox[{"Pi", "-", "\[Theta]LLP"}], ",", "ELLP"}], "]"}]}], 
          ")"}]}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "___", "___", "___", "___", "___", "___", "___", "___", "___", "___", 
       "___", "___", "___"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"For", " ", "cross"}], "-", 
       RowBox[{
        RowBox[{"checks", ".", " ", "Uncomment"}], " ", "if", " ", 
        "needed"}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "___", "___", "___", "___", "___", "___", "___", "___", "___", "___", 
       "___", "___", "___"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"IfTesting", "==", "\"\<True\>\""}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"normPDF", "=", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{"collopt", ",", "2", ",", "1"}], "]"}], "*", 
          RowBox[{"NIntegrate", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"DoubleDistr", "[", 
              RowBox[{
               RowBox[{"Exp", "[", "x", "]"}], ",", 
               RowBox[{"Exp", "[", "y", "]"}]}], "]"}], 
             RowBox[{"Exp", "[", 
              RowBox[{"x", "+", "y"}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"x", ",", 
              RowBox[{"Log", "[", "thmin", "]"}], ",", 
              RowBox[{"Log", "[", "thmax", "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"y", ",", 
              RowBox[{"Log", "[", "emin", "]"}], ",", 
              RowBox[{"Log", "[", "emax", "]"}]}], "}"}], ",", 
            RowBox[{
            "Method", "->", "\"\<InterpolationPointsSubdivision\>\""}]}], 
           "]"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"tabpdf\[Theta]temp", ",", "tabpdfEtemp"}], "}"}], "=", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"BinCounts", "[", 
            RowBox[{
             RowBox[{"BoostedData", "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", 
             RowBox[{"{", "vals\[Theta]", "}"}]}], "]"}], ",", 
           RowBox[{"BinCounts", "[", 
            RowBox[{
             RowBox[{"BoostedData", "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", "2"}], "]"}], "]"}], ",", 
             RowBox[{"{", "valsE", "}"}]}], "]"}]}], "}"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"tabpdf\[Theta]", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             FractionBox[
              RowBox[{
               RowBox[{"vals\[Theta]", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "+", 
               RowBox[{"vals\[Theta]", "[", 
                RowBox[{"[", 
                 RowBox[{"i", "+", "1"}], "]"}], "]"}]}], "2"], ",", 
             RowBox[{"Max", "[", 
              RowBox[{
               SuperscriptBox["10", 
                RowBox[{"-", "90."}]], ",", 
               FractionBox[
                RowBox[{"tabpdf\[Theta]temp", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"vals\[Theta]", "[", 
                   RowBox[{"[", 
                    RowBox[{"i", "+", "1"}], "]"}], "]"}], "-", 
                  RowBox[{"vals\[Theta]", "[", 
                   RowBox[{"[", "i", "]"}], "]"}]}], ")"}]]}], "]"}]}], "}"}],
            ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", 
             RowBox[{
              RowBox[{"Length", "[", "vals\[Theta]", "]"}], "-", "1"}], ",", 
             "1"}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"tabpdfE", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             FractionBox[
              RowBox[{
               RowBox[{"valsE", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "+", 
               RowBox[{"valsE", "[", 
                RowBox[{"[", 
                 RowBox[{"i", "+", "1"}], "]"}], "]"}]}], "2"], ",", 
             RowBox[{"Max", "[", 
              RowBox[{
               SuperscriptBox["10", 
                RowBox[{"-", "90."}]], ",", 
               FractionBox[
                RowBox[{"tabpdfEtemp", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"valsE", "[", 
                   RowBox[{"[", 
                    RowBox[{"i", "+", "1"}], "]"}], "]"}], "-", 
                  RowBox[{"valsE", "[", 
                   RowBox[{"[", "i", "]"}], "]"}]}], ")"}]]}], "]"}]}], "}"}],
            ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", 
             RowBox[{
              RowBox[{"Length", "[", "valsE", "]"}], "-", "1"}], ",", "1"}], 
            "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"AngleDistr", "[", "\[Theta]LLP_", "]"}], "=", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
           "thmin", "\[LessEqual]", "\[Theta]LLP", "\[LessEqual]", "thmax"}], 
           ",", 
           RowBox[{"Evaluate", "[", 
            RowBox[{
             FractionBox["1", 
              RowBox[{"Length", "[", "BoostedData", "]"}]], 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"Interpolation", "[", 
                 RowBox[{
                  RowBox[{"Log", "[", "tabpdf\[Theta]", "]"}], ",", 
                  RowBox[{"InterpolationOrder", "->", "1"}]}], "]"}], "[", 
                RowBox[{"Log", "[", "\[Theta]LLP", "]"}], "]"}], "//", 
               "Exp"}], ")"}]}], "]"}], ",", "0."}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"EnergyDistr", "[", "ELLP_", "]"}], "=", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
           "emin", "\[LessEqual]", " ", "ELLP", "\[LessEqual]", "emax"}], ",", 
           RowBox[{"Evaluate", "[", 
            RowBox[{
             FractionBox["1", 
              RowBox[{"Length", "[", "BoostedData", "]"}]], 
             RowBox[{
              RowBox[{"Interpolation", "[", 
               RowBox[{"tabpdfE", ",", 
                RowBox[{"InterpolationOrder", "->", "1"}]}], "]"}], "[", 
              "ELLP", "]"}]}], "]"}], ",", "0."}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"MemberQ", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"\"\<LHC\>\"", ",", "\"\<FCC-hh\>\""}], "}"}], ",", 
             "Facility"}], "]"}], "==", "True"}], ",", 
          RowBox[{
           RowBox[{"AngleDistr", "[", "\[Theta]LLP_", "]"}], "=", 
           RowBox[{
            FractionBox["1", "2"], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"AngleDistr", "[", "\[Theta]LLP", "]"}], "+", 
              RowBox[{"AngleDistr", "[", 
               RowBox[{"Pi", "-", "\[Theta]LLP"}], "]"}]}], ")"}]}]}]}], 
         "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "___", "___", "___", "___", "___", "___", "___", "___", "___", "___", 
     "___", "___", "___"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Old", " ", 
     RowBox[{"method", ".", " ", "Much"}], " ", "slower"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "___", "___", "___", "___", "___", "___", "___", "___", "___", "___", 
     "___", "___", "___"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"smoothkerneldistrX", "=", 
      RowBox[{"SmoothKernelDistribution", "[", 
       RowBox[{"BoostedData", ",", "\"\<LeastSquaresCrossValidation\>\"", ",", 
        RowBox[{"{", 
         RowBox[{"\"\<Bounded\>\"", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"Log\[Theta]minDistr", ",", "Log\[Theta]maxDistr"}], 
             "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"LogEminDistr", ",", "LogEmaxDistr"}], "}"}]}], "}"}], 
          ",", "\"\<Gaussian\>\""}], "}"}], ",", 
        RowBox[{"MaxMixtureKernels", "\[Rule]", "All"}], ",", 
        RowBox[{"InterpolationPoints", "\[Rule]", "300"}], ",", 
        RowBox[{"MaxExtraBandwidths", "\[Rule]", "0"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"Double", " ", "and", " ", "marginal", " ", "PDFs"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"DoubleDistr", "[", 
       RowBox[{"\[Theta]LLP_", ",", "ELLP_"}], "]"}], "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Exp", "[", "Log\[Theta]minDistr", "]"}], "\[LessEqual]", 
          "\[Theta]LLP", "\[LessEqual]", 
          RowBox[{"Exp", "[", "Log\[Theta]maxDistr", "]"}]}], "&&", 
         RowBox[{"mass", "\[LessEqual]", " ", "ELLP", "\[LessEqual]", 
          RowBox[{"Exp", "[", "LogEmaxDistr", "]"}]}]}], ",", 
        RowBox[{"Evaluate", "[", 
         RowBox[{
          RowBox[{
           FractionBox["1", "\[Theta]LLP"], 
           FractionBox["1", "ELLP"], 
           RowBox[{"PDF", "[", 
            RowBox[{"smoothkerneldistrX", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Log", "[", "\[Theta]LLP", "]"}], ",", 
               RowBox[{"Log", "[", "ELLP", "]"}]}], "}"}]}], "]"}]}], ",", 
          "0"}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"AngleDistr", "[", "\[Theta]LLP_", "]"}], "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Exp", "[", "Log\[Theta]minDistr", "]"}], "\[LessEqual]", 
         "\[Theta]LLP", "\[LessEqual]", 
         RowBox[{"Exp", "[", "Log\[Theta]maxDistr", "]"}]}], ",", 
        RowBox[{"Evaluate", "[", 
         RowBox[{
          RowBox[{
           FractionBox["1", "\[Theta]LLP"], 
           RowBox[{"PDF", "[", 
            RowBox[{
             RowBox[{"MarginalDistribution", "[", 
              RowBox[{"smoothkerneldistrX", ",", "1"}], "]"}], ",", 
             RowBox[{"Log", "[", "\[Theta]LLP", "]"}]}], "]"}]}], ",", "0"}], 
         "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"EnergyDistr", "[", "ELLP_", "]"}], "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"mass", "\[LessEqual]", " ", "ELLP", "\[LessEqual]", 
         RowBox[{"Exp", "[", "LogEmaxDistr", "]"}]}], ",", 
        RowBox[{"Evaluate", "[", 
         RowBox[{
          RowBox[{
           FractionBox["1", "ELLP"], 
           RowBox[{"PDF", "[", 
            RowBox[{
             RowBox[{"MarginalDistribution", "[", 
              RowBox[{"smoothkerneldistrX", ",", "2"}], "]"}], ",", 
             RowBox[{"Log", "[", "ELLP", "]"}]}], "]"}]}], ",", "0"}], 
         "]"}]}], "]"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.8938620761580563`*^9, 3.89386220370938*^9}, {
   3.893862259102283*^9, 3.893862315407897*^9}, {3.893866107225377*^9, 
   3.893866110781206*^9}, {3.89386620145057*^9, 3.893866213504322*^9}, {
   3.893866437327328*^9, 3.893866443978986*^9}, {3.893866505071568*^9, 
   3.8938665076709847`*^9}, {3.893866847284219*^9, 3.893866853093513*^9}, {
   3.893866969255508*^9, 3.8938670684768085`*^9}, {3.913198356372077*^9, 
   3.913198394683163*^9}, {3.913198590147167*^9, 3.9131985903021035`*^9}, {
   3.9131986957518153`*^9, 3.913198701713362*^9}, {3.9131987700031796`*^9, 
   3.9131988898394966`*^9}, {3.9131991463112097`*^9, 3.913199270047336*^9}, {
   3.913199498352162*^9, 3.913199507322229*^9}, {3.913199550601918*^9, 
   3.913199553221092*^9}, {3.9131995911711392`*^9, 3.913199788384001*^9}, {
   3.913199858546198*^9, 3.9132000670032473`*^9}, {3.913200133066129*^9, 
   3.913200136152978*^9}, {3.913201856782288*^9, 3.91320185962296*^9}, {
   3.913284756822955*^9, 3.913284759224432*^9}, {3.913284858084095*^9, 
   3.9132848927615285`*^9}, 3.913286311138811*^9, {3.913309834616569*^9, 
   3.913309838343187*^9}, {3.913309937677439*^9, 3.9133099473272486`*^9}, {
   3.913310355187586*^9, 3.913310355816386*^9}, {3.9133108188262615`*^9, 
   3.9133108854473696`*^9}, {3.913311333735514*^9, 3.91331134807082*^9}, {
   3.913312265507454*^9, 3.913312274769553*^9}, {3.913312336683548*^9, 
   3.9133123877681847`*^9}, {3.9133124948377028`*^9, 3.913312520090728*^9}, {
   3.9133125986275196`*^9, 3.913312599217389*^9}, {3.913314284626512*^9, 
   3.913314285736671*^9}, {3.913314765792462*^9, 3.913314766200354*^9}, {
   3.913314911054226*^9, 3.9133149174321012`*^9}, {3.913315216539731*^9, 
   3.913315218056263*^9}, {3.913315278327413*^9, 3.913315283367931*^9}, {
   3.913315362529094*^9, 3.91331536683943*^9}, {3.913315422035448*^9, 
   3.9133155364105673`*^9}, {3.9133492030179877`*^9, 3.913349220111556*^9}, {
   3.913349311930163*^9, 3.913349393710166*^9}, {3.9133494434000278`*^9, 
   3.913349566150315*^9}, {3.913350165991381*^9, 3.913350166201167*^9}, {
   3.913350224750269*^9, 3.9133502277511415`*^9}, {3.913351145153783*^9, 
   3.913351190391424*^9}, {3.913351224984251*^9, 3.9133512338492713`*^9}, {
   3.913351387021455*^9, 3.913351389593725*^9}, 3.9133514506451445`*^9, {
   3.913351958710447*^9, 3.913352014894545*^9}, {3.913352161654259*^9, 
   3.9133521629811087`*^9}, {3.913352213964215*^9, 3.913352234531459*^9}, {
   3.913352268839217*^9, 3.913352306531377*^9}, {3.913353865502134*^9, 
   3.9133538657415266`*^9}, {3.9133539358392177`*^9, 
   3.9133539438916073`*^9}, {3.913354071291775*^9, 3.9133540864610844`*^9}, {
   3.913354203102628*^9, 3.913354203151433*^9}, {3.913354309294236*^9, 
   3.913354365311132*^9}, {3.913354559119169*^9, 3.9133545655825996`*^9}, {
   3.913355574500475*^9, 3.913355646331547*^9}, {3.913355736670104*^9, 
   3.913355740051502*^9}, {3.913365309118777*^9, 3.913365339616091*^9}, {
   3.9133660641870403`*^9, 3.9133660880539293`*^9}, {3.913366187246639*^9, 
   3.913366213965789*^9}, {3.91336629315773*^9, 3.913366295555339*^9}, {
   3.913887778096642*^9, 3.913887780121197*^9}, {3.914833655795296*^9, 
   3.914833696115719*^9}, {3.9154388121366997`*^9, 3.915438812574622*^9}, {
   3.915727913083697*^9, 3.9157279156872673`*^9}, {3.915810486740222*^9, 
   3.915810493858383*^9}, {3.91581054028869*^9, 3.915810548337533*^9}, {
   3.9158110015564394`*^9, 3.915811045298648*^9}, {3.916738156304834*^9, 
   3.9167381780395403`*^9}, {3.916937270977048*^9, 3.9169372817442875`*^9}, {
   3.9169373766091185`*^9, 3.916937386826414*^9}, {3.930990420868196*^9, 
   3.9309904428249807`*^9}},
 CellTags->
  "Evaluation",ExpressionUUID->"7c16f4a4-bc39-49f2-ab99-395d54db6c27"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Tabulated distribution and its exporting", "Section",
 CellChangeTimes->{{3.913279106857311*^9, 3.913279109902794*^9}, {
  3.913285842775052*^9, 3.9132858510195303`*^9}},
 CellTags->
  "Evaluation",ExpressionUUID->"89946c5d-55e9-4d17-a3a2-ef3d9bb45859"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"TabZeroDistr", "[", 
    RowBox[{"mLLP_", ",", "\[Theta]list_", ",", "Elist_"}], "]"}], ":=", 
   RowBox[{"Flatten", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"mLLP", ",", "\[Theta]N", ",", "EN", ",", 
         SuperscriptBox["10", 
          RowBox[{"-", "90."}]]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Theta]N", ",", "\[Theta]list"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"EN", ",", "Elist"}], "}"}]}], "]"}], ",", "1"}], "]"}]}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "This", " ", "block", " ", "produces", " ", "the", " ", "tabulated", " ", 
     "PDF", " ", "for", " ", "the", " ", "fixed", " ", "mass", " ", 
     RowBox[{"mLLP", ".", " ", "Tabulation"}], " ", "is", " ", "for", " ", 
     "the", " ", "values", " ", "of", " ", "\[Theta]"}], ",", 
    RowBox[{"E", " ", "belonging", " ", "to", " ", "\[Theta]list"}], ",", " ",
     "Elist"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"The", " ", "argument", " ", 
    SubscriptBox["\[Theta]", "extr"], " ", "defines", " ", "the", " ", 
    "angle", " ", "below", " ", "which", " ", "the", " ", "angular", " ", 
    "distribution", " ", "is", " ", 
    RowBox[{"just", " ", "~", "sin"}], 
    RowBox[{"(", "\[Theta]", ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
     "the", " ", "true", " ", "distribution", " ", "has", " ", "wiggles", " ",
       "there", " ", "due", " ", "to", " ", "low", " ", "statistics"}]}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BlockTabulatedPDFsFromDecaysMass", "[", 
   RowBox[{
   "LLP_", ",", "Facility_", ",", "mLLP_", ",", "process_", ",", "Nevents_", 
    ",", "\[Theta]list_", ",", "Elist_", ",", "\[Theta]minExtr_", ",", 
    "IfTesting_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"tab1", ",", 
      RowBox[{"(*", 
       RowBox[{"boosteddata", ","}], "*)"}], "maxmass"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"maxmass", "=", 
      RowBox[{"MaxMass", "[", 
       RowBox[{"LLP", ",", "Facility", ",", "process"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"mLLP", "<", "maxmass"}], ",", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
         "If", " ", "the", " ", "mother", " ", "particle", " ", "is", " ", 
          "at", " ", "rest"}], ",", " ", 
         RowBox[{
          RowBox[{"then", " ", "the", " ", "angle"}], "-", 
          RowBox[{
          "energy", " ", "distribution", " ", "of", " ", "the", " ", 
           "daughter", " ", "is", " ", "just", " ", "the", " ", "product", 
           " ", "of", " ", 
           FractionBox[
            RowBox[{"sin", 
             RowBox[{"(", 
              SubscriptBox["\[Theta]", "LLP"], ")"}]}], "2"], "*", 
           RowBox[{"f", "[", 
            SubscriptBox["E", "LLP"], "]"}]}]}], ",", " ", 
         RowBox[{"0", " ", "<", " ", 
          SubscriptBox["\[Theta]", "LLP"], " ", "<", " ", "Pi"}], ",", " ", 
         RowBox[{
         "and", " ", "with", " ", "f", " ", "normalized", " ", "by", " ", 
          "one"}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Facility", "==", "\"\<ESS\>\""}], "&&", 
           RowBox[{"MemberQ", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"\"\<mu\>\"", ",", "\"\<PiCharged\>\""}], "}"}], ",", 
             "process"}], "]"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"DoubleDistr", "[", 
            RowBox[{"\[Theta]LLP_", ",", "ELLP_"}], "]"}], "=", 
           RowBox[{"\[Theta]EdistrRest", "[", 
            RowBox[{
            "LLP", ",", "process", ",", "mLLP", ",", "\[Theta]LLP", ",", 
             "ELLP"}], "]"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{
            "If", " ", "the", " ", "mother", " ", "particle", " ", "is", " ", 
             "not", " ", "at", " ", "rest"}], ",", " ", 
            RowBox[{
            "the", " ", "launch", " ", "the", " ", "routine", " ", 
             "calculating", " ", "the", " ", "phase", " ", "space", " ", "at",
              " ", "rest", " ", "and", " ", "boosting", " ", "it", " ", "to", 
             " ", "lab", " ", "frame", " ", "of", " ", "the", " ", "mother", 
             " ", "particle"}]}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
           "Producing", " ", "the", " ", "boosted", " ", "LLPs", " ", "from", 
            " ", "the", " ", "given", " ", "decay", " ", "process"}], "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"boosteddata", "=", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"MemberQ", "[", 
                RowBox[{"ListHNLs", ",", "LLP"}], "]"}], ",", 
               RowBox[{"BoostedHNLsBlock", "[", 
                RowBox[{
                "LLP", ",", "Facility", ",", "mLLP", ",", "process", ",", 
                 "Nevents"}], "]"}], ",", 
               RowBox[{"BoostedLLPsBlock", "[", 
                RowBox[{
                "LLP", ",", "Facility", ",", "mLLP", ",", "process", ",", 
                 "Nevents"}], "]"}]}], "]"}], "//", 
             "Developer`ToPackedArray"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"Making", " ", "the", " ", 
              RowBox[{"PDF", ".", " ", "It"}], " ", "defines", " ", "the", 
              " ", "functions", " ", 
              RowBox[{"DoubleDist", "[", 
               RowBox[{"\[Theta]", ",", "E"}], "]"}]}], ",", 
             RowBox[{"AngleDistr", "[", "\[Theta]", "]"}], ",", 
             RowBox[{"EnergyDistr", "[", "E", "]"}], ",", " ", 
             RowBox[{
             "which", " ", "are", " ", "PDF", " ", "in", " ", "these", " ", 
              "variables"}]}], "*)"}], "\[IndentingNewLine]", 
           RowBox[{"FromDataToSmoothDistribution", "[", 
            RowBox[{
            "boosteddata", ",", "mLLP", ",", "Facility", ",", "IfTesting"}], 
            "]"}]}]}], "\[IndentingNewLine]", "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"The", " ", "tabulated", " ", "distribution"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"tab1", "=", 
         RowBox[{"Flatten", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"mLLP", ",", "\[Theta]LLP", ",", "ELLP", ",", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"\[Theta]LLP", "<", "\[Theta]minExtr"}], ",", 
                 RowBox[{
                  FractionBox["\[Theta]LLP", "\[Theta]minExtr"], 
                  RowBox[{"DoubleDistr", "[", 
                   RowBox[{"\[Theta]minExtr", ",", "ELLP"}], "]"}]}], ",", 
                 RowBox[{"DoubleDistr", "[", 
                  RowBox[{"\[Theta]LLP", ",", "ELLP"}], "]"}]}], "]"}]}], 
              "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"\[Theta]LLP", ",", "\[Theta]list"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"ELLP", ",", "Elist"}], "}"}]}], "]"}], ",", "1"}], 
          "]"}]}]}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"mLLP", ">=", "maxmass"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"tab1", "=", 
         RowBox[{"TabZeroDistr", "[", 
          RowBox[{"mLLP", ",", "\[Theta]list", ",", "Elist"}], "]"}]}], 
        ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     "tab1"}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"filenameToExport", "[", 
    RowBox[{"\"\<HNL-mixing-e\>\"", ",", "\"\<B\>\"", ",", "\"\<LHC\>\""}], 
    "]"}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.913279117482838*^9, 3.913279172573497*^9}, {
   3.913283525437169*^9, 3.9132836487221956`*^9}, {3.9132836796973996`*^9, 
   3.913283880068771*^9}, {3.913285457347539*^9, 3.913285462963901*^9}, {
   3.913285712382317*^9, 3.9132857609023743`*^9}, {3.9132858147509136`*^9, 
   3.9132858211041837`*^9}, {3.913286139326886*^9, 3.913286173721944*^9}, {
   3.913286964710668*^9, 3.913286968665586*^9}, {3.91328747301415*^9, 
   3.913287478030207*^9}, 3.9132876071985545`*^9, {3.913288958076723*^9, 
   3.9132890504549484`*^9}, {3.913304878273347*^9, 3.913304878854036*^9}, {
   3.913304977844197*^9, 3.913304981732072*^9}, {3.913305022503151*^9, 
   3.913305052542234*^9}, 3.91330509035813*^9, {3.913306377757175*^9, 
   3.913306380546525*^9}, {3.913315206286387*^9, 3.913315207785378*^9}, {
   3.913352038910324*^9, 3.913352048461528*^9}, 3.913436207161077*^9, {
   3.913438786999912*^9, 3.913438826414377*^9}, 3.913440669554513*^9, {
   3.913440785046051*^9, 3.9134407880845203`*^9}, {3.913451625126102*^9, 
   3.913451627476891*^9}, {3.913460180015368*^9, 3.913460180306641*^9}, {
   3.913460214076883*^9, 3.913460214857069*^9}, 3.91388412300566*^9, {
   3.914849634753387*^9, 3.91484992888001*^9}, {3.914909432200574*^9, 
   3.9149094870450025`*^9}, 3.915083934274112*^9, {3.9154388126026316`*^9, 
   3.915438812813918*^9}, {3.9154426042006855`*^9, 3.915442615293381*^9}},
 CellTags->"Evaluation",
 CellLabel->
  "In[1158]:=",ExpressionUUID->"4f46895f-6a27-4874-8c29-66bdff8b71bf"],

Cell[CellGroupData[{

Cell["Test", "Subsection",
 CellChangeTimes->{{3.9133516988212576`*^9, 3.9133516994311724`*^9}},
 CellTags->
  "Evaluation",ExpressionUUID->"06943df8-4649-4c77-acb4-efe84a4c9e80"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"TestingBlock", "[", 
   RowBox[{
   "LLP_", ",", "Facility_", ",", "mLLP_", ",", "process_", ",", "Nev_", ",", 
    "\[Theta]list_", ",", "Elist_", ",", "\[Theta]extr_"}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Quiet", "[", 
      RowBox[{"BlockTabulatedPDFsFromDecaysMass", "[", 
       RowBox[{
       "LLP", ",", "Facility", ",", "mLLP", ",", "process", ",", "Nev", ",", 
        "\[Theta]list", ",", "Elist", ",", "\[Theta]extr", ",", 
        "\"\<True\>\""}], "]"}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"normtab", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "\"\<\!\(\*SubscriptBox[\(Normalization\), \(PDF[\[Theta], E]\)]\)\>\
\"", ",", " ", 
          "\"\<\!\(\*SubscriptBox[\(Normalization\), \
\(PDF[\[Theta]]\)]\)\>\"", ",", 
          "\"\<\!\(\*SubscriptBox[\(Normalization\), \(PDF[E]\)]\)\>\""}], 
         "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"normPDF", ",", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{"collopt", ",", "2", ",", "1"}], "]"}], "*", 
           RowBox[{"NIntegrate", "[", 
            RowBox[{
             RowBox[{"AngleDistr", "[", "\[Theta]LLP", "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"\[Theta]LLP", ",", "thmin", ",", 
               RowBox[{"Min", "[", 
                RowBox[{"thmax", ",", "Pi"}], "]"}]}], "}"}], ",", 
             RowBox[{
             "Method", "->", "\"\<InterpolationPointsSubdivision\>\""}]}], 
            "]"}]}], ",", 
          RowBox[{"NIntegrate", "[", 
           RowBox[{
            RowBox[{"EnergyDistr", "[", "ELLP", "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"ELLP", ",", "emin", ",", "emax"}], "}"}], ",", 
            RowBox[{
            "Method", "->", "\"\<InterpolationPointsSubdivision\>\""}]}], 
           "]"}]}], "}"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"angdistr2data", "=", 
      RowBox[{"ParallelTable", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          SuperscriptBox["10", "x"], ",", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{"collopt", ",", 
             FractionBox["1", "2"], ",", "1"}], "]"}], "*", 
           RowBox[{"Quiet", "[", 
            RowBox[{"NIntegrate", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"DoubleDistr", "[", 
                RowBox[{
                 SuperscriptBox["10", "x"], ",", 
                 RowBox[{"Exp", "[", "y", "]"}]}], "]"}], 
               RowBox[{"Exp", "[", "y", "]"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"y", ",", 
                RowBox[{"Log", "[", "emin", "]"}], ",", 
                RowBox[{"Log", "[", "emax", "]"}]}], "}"}], ",", 
              RowBox[{"Method", "->", "\"\<AdaptiveMonteCarlo\>\""}]}], "]"}],
             "]"}]}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", 
          RowBox[{"Log10", "[", "thmin", "]"}], ",", 
          RowBox[{"Log10", "[", 
           FractionBox["Pi", "2."], "]"}], ",", "0.05"}], "}"}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"angdistr2", "[", "\[Theta]X_", "]"}], "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Interpolation", "[", 
         RowBox[{
          RowBox[{"Log", "[", "angdistr2data", "]"}], ",", 
          RowBox[{"InterpolationOrder", "->", "1"}]}], "]"}], "[", 
        RowBox[{"Log", "[", "\[Theta]X", "]"}], "]"}], "//", "Exp"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"pt1", "=", 
      RowBox[{"LogLogPlot", "[", 
       RowBox[{
        RowBox[{"Evaluate", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{"collopt", ",", 
              FractionBox["1", "2"], ",", "1"}], "]"}], "*", 
            RowBox[{"AngleDistr", "[", "x", "]"}]}], ",", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"x", "<", "thextr"}], ",", 
             RowBox[{"Evaluate", "[", 
              RowBox[{
               FractionBox["x", "thextr"], 
               RowBox[{"angdistr2", "[", "thextr", "]"}]}], "]"}], ",", 
             RowBox[{"Evaluate", "[", 
              RowBox[{"angdistr2", "[", "x", "]"}], "]"}]}], "]"}]}], "}"}], 
         "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", "thmin", ",", 
          FractionBox["Pi", "2"]}], "}"}], ",", 
        RowBox[{"Frame", "\[Rule]", "True"}], ",", 
        RowBox[{"FrameStyle", "\[Rule]", 
         RowBox[{"Directive", "[", 
          RowBox[{"Black", ",", " ", "20"}], "]"}]}], ",", 
        RowBox[{"PlotRange", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"thmin", ",", 
             FractionBox["Pi", "2"]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             SuperscriptBox["10", 
              RowBox[{"-", "4"}]], ",", 
             RowBox[{"2", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"angdistr2data", "[", 
                 RowBox[{"[", 
                  RowBox[{"All", ",", "2"}], "]"}], "]"}], "//", "Max"}], 
               ")"}]}]}], "}"}]}], "}"}]}], ",", 
        RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
        RowBox[{"FrameLabel", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"\"\<\[Theta] [rad]\>\"", ",", "\"\<PDF[\[Theta]]\>\""}], 
          "}"}]}], ",", 
        RowBox[{"PlotLegends", "\[Rule]", 
         RowBox[{"Placed", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Style", "[", 
              RowBox[{"#", ",", "16"}], "]"}], "&"}], "/@", 
            RowBox[{"{", 
             RowBox[{
             "\"\<data->PDF[\[Theta]]\>\"", ",", 
              "\"\<data->PDF[\[Theta],E]->PDF[\[Theta]]\>\""}], "}"}]}], ",", 
           
           RowBox[{"{", 
            RowBox[{"0.25", ",", "0.2"}], "}"}]}], "]"}]}], ",", 
        RowBox[{"PlotStyle", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Thickness", "[", "0.003", "]"}], ",", "Blue"}], "}"}], 
           ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Thickness", "[", "0.003", "]"}], ",", 
             RowBox[{"Darker", "@", "Red"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Thickness", "[", "0.003", "]"}], ",", 
             RowBox[{"Darker", "@", "Green"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Thickness", "[", "0.003", "]"}], ",", 
             RowBox[{"Darker", "@", "Red"}], ",", 
             RowBox[{"Dashing", "[", "0.02", "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Thickness", "[", "0.003", "]"}], ",", "Blue", ",", 
             RowBox[{"Dashing", "[", "0.02", "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Thickness", "[", "0.003", "]"}], ",", 
             RowBox[{"Darker", "@", "Green"}], ",", 
             RowBox[{"Dashing", "[", "0.02", "]"}]}], "}"}]}], "}"}]}]}], 
       RowBox[{"(*", 
        RowBox[{",", 
         RowBox[{"PlotLabel", "\[Rule]", 
          RowBox[{"Style", "[", 
           RowBox[{
            RowBox[{"Row", "[", 
             RowBox[{
             "{", "\"\<Normalized on events with \
2<\!\(\*SubscriptBox[\(\[Eta]\), \(B\)]\)<5\>\"", "}"}], "]"}], ",", "18", 
            ",", "Black"}], "]"}]}]}], "*)"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"endistr2data", "=", 
      RowBox[{"ParallelTable", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          SuperscriptBox["10", "x"], ",", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{"collopt", ",", "2", ",", "1"}], "]"}], "*", 
           RowBox[{"Quiet", "[", 
            RowBox[{"NIntegrate", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"DoubleDistr", "[", 
                RowBox[{
                 RowBox[{"Exp", "[", "y", "]"}], ",", 
                 SuperscriptBox["10", "x"]}], "]"}], 
               RowBox[{"Exp", "[", "y", "]"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"y", ",", 
                RowBox[{"Log", "[", "thmin", "]"}], ",", 
                RowBox[{"Log", "[", "thmax", "]"}]}], "}"}], ",", 
              RowBox[{"Method", "->", "\"\<AdaptiveMonteCarlo\>\""}]}], "]"}],
             "]"}]}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", 
          RowBox[{"Log10", "[", "emin", "]"}], ",", 
          RowBox[{"Log10", "[", "emax", "]"}], ",", "0.015"}], "}"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"endistr2", "[", "EX_", "]"}], "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Interpolation", "[", 
         RowBox[{
          RowBox[{"Log", "[", "endistr2data", "]"}], ",", 
          RowBox[{"InterpolationOrder", "->", "1"}]}], "]"}], "[", 
        RowBox[{"Log", "[", "EX", "]"}], "]"}], "//", "Exp"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"pt2", "=", 
      RowBox[{"LogLogPlot", "[", 
       RowBox[{
        RowBox[{"Evaluate", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"EnergyDistr", "[", "x", "]"}], ",", 
           RowBox[{"endistr2", "[", "x", "]"}]}], "}"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", "emin", ",", "emax"}], "}"}], ",", 
        RowBox[{"Frame", "\[Rule]", "True"}], ",", 
        RowBox[{"FrameStyle", "\[Rule]", 
         RowBox[{"Directive", "[", 
          RowBox[{"Black", ",", " ", "20"}], "]"}]}], ",", 
        RowBox[{"PlotRange", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"emin", ",", "emax"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             SuperscriptBox["10", 
              RowBox[{"-", "10"}]], ",", 
             RowBox[{"2", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"endistr2data", "[", 
                 RowBox[{"[", 
                  RowBox[{"All", ",", "2"}], "]"}], "]"}], "//", "Max"}], 
               ")"}]}]}], "}"}]}], "}"}]}], ",", 
        RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
        RowBox[{"FrameLabel", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"\"\<E [GeV]\>\"", ",", "\"\<PDF[E]\>\""}], "}"}]}], ",", 
        RowBox[{"PlotLegends", "\[Rule]", 
         RowBox[{"Placed", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Style", "[", 
              RowBox[{"#", ",", "16"}], "]"}], "&"}], "/@", 
            RowBox[{"{", 
             RowBox[{
             "\"\<data->PDF[E]\>\"", ",", 
              "\"\<data->PDF[\[Theta],E]->PDF[E]\>\""}], "}"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"0.25", ",", "0.2"}], "}"}]}], "]"}]}], ",", 
        RowBox[{"PlotStyle", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Thickness", "[", "0.003", "]"}], ",", "Blue"}], "}"}], 
           ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Thickness", "[", "0.003", "]"}], ",", 
             RowBox[{"Darker", "@", "Red"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Thickness", "[", "0.003", "]"}], ",", 
             RowBox[{"Darker", "@", "Green"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Thickness", "[", "0.003", "]"}], ",", 
             RowBox[{"Darker", "@", "Red"}], ",", 
             RowBox[{"Dashing", "[", "0.02", "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Thickness", "[", "0.003", "]"}], ",", "Blue", ",", 
             RowBox[{"Dashing", "[", "0.02", "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Thickness", "[", "0.003", "]"}], ",", 
             RowBox[{"Darker", "@", "Green"}], ",", 
             RowBox[{"Dashing", "[", "0.02", "]"}]}], "}"}]}], "}"}]}]}], 
       RowBox[{"(*", 
        RowBox[{",", 
         RowBox[{"PlotLabel", "\[Rule]", 
          RowBox[{"Style", "[", 
           RowBox[{
            RowBox[{"Row", "[", 
             RowBox[{
             "{", "\"\<Normalized on events with \
2<\!\(\*SubscriptBox[\(\[Eta]\), \(B\)]\)<5\>\"", "}"}], "]"}], ",", "18", 
            ",", "Black"}], "]"}]}]}], "*)"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"pdfplots", "=", 
      RowBox[{"Style", "[", 
       RowBox[{
        RowBox[{"Row", "[", 
         RowBox[{"{", 
          RowBox[{"pt1", ",", "pt2"}], "}"}], "]"}], ",", 
        RowBox[{"ImageSizeMultipliers", "->", 
         RowBox[{"{", 
          RowBox[{"1", ",", " ", "1"}], "}"}]}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"histoenergy", "=", 
      RowBox[{"With", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"min", "=", 
           RowBox[{"Min", "[", 
            RowBox[{"boosteddata", "[", 
             RowBox[{"[", 
              RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}]}], ",", 
          RowBox[{"max", "=", 
           RowBox[{"Max", "[", 
            RowBox[{"PTS", "[", 
             RowBox[{"[", 
              RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}]}]}], "}"}], ",", 
        
        RowBox[{"Histogram", "[", 
         RowBox[{
          RowBox[{"Evaluate", "[", 
           RowBox[{"{", 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{"erand", "//", "Exp"}], ","}], "*)"}], 
            RowBox[{
             RowBox[{"PTS", "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", "2"}], "]"}], "]"}], ",", 
             RowBox[{"boosteddata", "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", "2"}], "]"}], "]"}]}], "}"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"min", ",", "max", ",", 
            FractionBox[
             RowBox[{"(", 
              RowBox[{"max", "-", "min"}], ")"}], "100"]}], "}"}], ",", 
          "\"\<ProbabilityDensity\>\"", ",", 
          RowBox[{"ScalingFunctions", "->", 
           RowBox[{"{", 
            RowBox[{"\"\<Log\>\"", ",", "\"\<Log\>\""}], "}"}]}], ",", 
          RowBox[{"PlotRange", "->", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"min", ",", "max"}], "}"}], ",", "All"}], "}"}]}], ",", 
          
          RowBox[{"Frame", "\[Rule]", " ", "True"}], ",", 
          RowBox[{"ChartStyle", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Opacity", "[", 
              RowBox[{".25", ",", "Red"}], "]"}], ",", 
             RowBox[{"Opacity", "[", 
              RowBox[{".25", ",", "Blue"}], "]"}], ",", 
             RowBox[{"Opacity", "[", 
              RowBox[{".25", ",", 
               RowBox[{"Darker", "@", 
                RowBox[{"Darker", "@", "Green"}]}]}], "]"}]}], "}"}]}], ",", 
          RowBox[{"FrameStyle", "\[Rule]", 
           RowBox[{"Directive", "[", 
            RowBox[{"Black", ",", " ", "22"}], "]"}]}], ",", 
          RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
          RowBox[{"FrameLabel", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"\"\<E, GeV\>\"", ",", "\"\<Fraction\>\""}], "}"}]}], ",", 
          RowBox[{"PlotLabel", "\[Rule]", 
           RowBox[{"Style", "[", 
            RowBox[{
             RowBox[{"Row", "[", 
              RowBox[{"{", 
               RowBox[{
               "LLPtest", ",", "\"\<, \>\"", ",", "fac", ",", 
                "\"\<, production: \>\"", ",", "prodtest", ",", 
                "\"\<, \!\(\*SubscriptBox[\(m\), \(LLP\)]\) = \>\"", ",", " ",
                 "masstest", ",", "\"\< GeV\>\""}], "}"}], "]"}], ",", "18", 
             ",", "Black"}], "]"}]}], ",", 
          RowBox[{"ChartLegends", "\[Rule]", 
           RowBox[{"Placed", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"(*", 
               RowBox[{
               "\"\<\!\(\*SubscriptBox[\(mother\), \(unweighted\)]\)\>\"", 
                ","}], "*)"}], 
              RowBox[{"\"\<mother\>\"", ",", "LLPtest"}], "}"}], ",", 
             "Bottom"}], "]"}]}]}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"histoangle", "=", 
      RowBox[{"With", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"min", "=", 
           RowBox[{"Min", "[", 
            RowBox[{"PTS", "[", 
             RowBox[{"[", 
              RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}]}], ",", 
          RowBox[{"max", "=", 
           RowBox[{"Max", "[", 
            RowBox[{"boosteddata", "[", 
             RowBox[{"[", 
              RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}]}]}], "}"}], ",", 
        
        RowBox[{"Histogram", "[", 
         RowBox[{
          RowBox[{"Evaluate", "[", 
           RowBox[{"{", 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{"\[Theta]rand", "//", "Exp"}], ","}], "*)"}], 
            RowBox[{
             RowBox[{"PTS", "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", 
             RowBox[{"boosteddata", "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", "1"}], "]"}], "]"}]}], "}"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"min", ",", "max", ",", 
            FractionBox[
             RowBox[{"(", 
              RowBox[{"max", "-", "min"}], ")"}], "100"]}], "}"}], ",", 
          "\"\<ProbabilityDensity\>\"", ",", 
          RowBox[{"ScalingFunctions", "->", 
           RowBox[{"{", 
            RowBox[{"\"\<Log\>\"", ",", "\"\<Log\>\""}], "}"}]}], ",", 
          RowBox[{"PlotRange", "->", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"min", ",", "max"}], "}"}], ",", "All"}], "}"}]}], ",", 
          
          RowBox[{"Frame", "\[Rule]", " ", "True"}], ",", 
          RowBox[{"ChartStyle", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Opacity", "[", 
              RowBox[{".25", ",", "Red"}], "]"}], ",", 
             RowBox[{"Opacity", "[", 
              RowBox[{".25", ",", "Blue"}], "]"}], ",", 
             RowBox[{"Opacity", "[", 
              RowBox[{".25", ",", 
               RowBox[{"Darker", "@", 
                RowBox[{"Darker", "@", "Green"}]}]}], "]"}]}], "}"}]}], ",", 
          RowBox[{"FrameStyle", "\[Rule]", 
           RowBox[{"Directive", "[", 
            RowBox[{"Black", ",", " ", "22"}], "]"}]}], ",", 
          RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
          RowBox[{"FrameLabel", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"\"\<\[Theta], rad\>\"", ",", "\"\<Fraction\>\""}], 
            "}"}]}], ",", 
          RowBox[{"PlotLabel", "\[Rule]", 
           RowBox[{"Style", "[", 
            RowBox[{
             RowBox[{"Row", "[", 
              RowBox[{"{", 
               RowBox[{
               "LLPtest", ",", "\"\<, \>\"", ",", "fac", ",", 
                "\"\<, production: \>\"", ",", "prodtest", ",", 
                "\"\<, \!\(\*SubscriptBox[\(m\), \(LLP\)]\) = \>\"", ",", " ",
                 "masstest", ",", "\"\< GeV\>\""}], "}"}], "]"}], ",", "18", 
             ",", "Black"}], "]"}]}], ",", 
          RowBox[{"ChartLegends", "\[Rule]", 
           RowBox[{"Placed", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"(*", 
               RowBox[{
               "\"\<\!\(\*SubscriptBox[\(mother\), \(unweighted\)]\)\>\"", 
                ","}], "*)"}], 
              RowBox[{"\"\<mother\>\"", ",", "LLPtest"}], "}"}], ",", 
             "Bottom"}], "]"}]}]}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"histoplots", "=", 
      RowBox[{"Style", "[", 
       RowBox[{
        RowBox[{"Row", "[", 
         RowBox[{"{", 
          RowBox[{"histoangle", ",", "histoenergy"}], "}"}], "]"}], ",", 
        RowBox[{"ImageSizeMultipliers", "->", 
         RowBox[{"{", 
          RowBox[{"1", ",", " ", "1"}], "}"}]}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"testdata", "=", 
      RowBox[{"{", 
       RowBox[{"histoplots", ",", "normtab", ",", "pdfplots"}], "}"}]}]}]}], 
   "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"IfTest", "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"IfTest", "==", "1"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"fac", "=", "\"\<LHC\>\""}], ";", "\[IndentingNewLine]", 
    RowBox[{"num", "=", 
     SuperscriptBox["10", "7"]}], ";", "\[IndentingNewLine]", 
    RowBox[{"masstest", "=", "3."}], ";", "\[IndentingNewLine]", 
    RowBox[{"LLPtest", "=", "\"\<Scalar\>\""}], ";", "\[IndentingNewLine]", 
    RowBox[{"prodtest", "=", "\"\<B-mixing\>\""}], ";", "\[IndentingNewLine]", 
    RowBox[{"thextr", "=", 
     RowBox[{"0.5", "*", 
      SuperscriptBox["10", 
       RowBox[{"-", "3"}]]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"TestingBlock", "[", 
     RowBox[{
     "LLPtest", ",", "fac", ",", "masstest", ",", "prodtest", ",", "num", ",", 
      RowBox[{"\[Theta]Nlist", "[", "fac", "]"}], ",", 
      RowBox[{"ENlist", "[", "fac", "]"}], ",", "thextr"}], "]"}]}]}], 
  "\[IndentingNewLine]", "]"}]}], "Input",
 CellChangeTimes->{{3.9133666530965853`*^9, 3.9133667658488226`*^9}, {
   3.913366806585408*^9, 3.913366806832791*^9}, {3.913366842832277*^9, 
   3.9133668430622673`*^9}, {3.913367217950544*^9, 3.913367218519312*^9}, {
   3.913367292319772*^9, 3.913367292572063*^9}, {3.9133940811718693`*^9, 
   3.913394089922868*^9}, {3.913395049754373*^9, 3.913395053328302*^9}, {
   3.9134007047656193`*^9, 3.913400715245592*^9}, {3.913400846726993*^9, 
   3.913400847139907*^9}, {3.9134009248266587`*^9, 3.91340092498487*^9}, {
   3.9134361667486706`*^9, 3.9134361680747223`*^9}, 3.913436271388617*^9, {
   3.9134363929780693`*^9, 3.913436395041768*^9}, 3.913436556411934*^9, {
   3.91343868694238*^9, 3.9134386871824512`*^9}, {3.913807866396742*^9, 
   3.913807866428958*^9}, {3.914488134143307*^9, 3.914488158509461*^9}, {
   3.914488759557181*^9, 3.914488759584239*^9}, {3.9144899604651628`*^9, 
   3.91448996081855*^9}, {3.914490010071698*^9, 3.914490010281769*^9}, {
   3.914491763644738*^9, 3.9144917672737155`*^9}, {3.914492129949712*^9, 
   3.914492131696255*^9}, {3.914492183860233*^9, 3.91449219327791*^9}, 
   3.914492257462107*^9, 3.9150839337687416`*^9, {3.915438812884365*^9, 
   3.91543881307095*^9}, {3.915442619471672*^9, 3.915442621874764*^9}, {
   3.9157079064264417`*^9, 3.91570793828646*^9}, {3.915727829835729*^9, 
   3.915727829919737*^9}, {3.915727932464973*^9, 3.915727937238025*^9}, {
   3.915808397224187*^9, 3.915808406241226*^9}, {3.915808447245122*^9, 
   3.915808448461207*^9}, {3.915808678405654*^9, 3.915808678473737*^9}, {
   3.915808893565119*^9, 3.915808894051321*^9}, 3.915808977489647*^9, 
   3.91580906931955*^9, 3.91580923633923*^9, {3.915810389078092*^9, 
   3.9158103949773197`*^9}, {3.9158107980437965`*^9, 3.915810798227306*^9}, 
   3.915810837796278*^9, {3.915811161517281*^9, 3.915811165224146*^9}, 
   3.915811211490591*^9, {3.9158114784453306`*^9, 3.915811480149528*^9}, {
   3.9158760588362184`*^9, 3.915876059039949*^9}, {3.916937095410488*^9, 
   3.916937115282776*^9}, {3.9169371521112146`*^9, 3.916937152326856*^9}, 
   3.9169371899270687`*^9, 3.916937579976533*^9},
 CellTags->"Evaluation",
 CellLabel->
  "In[1160]:=",ExpressionUUID->"0ab61bf6-daa3-40e8-acb6-496831dff47c"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Production via mixing: PDF", "Chapter",
 CellChangeTimes->{{3.913459771566974*^9, 3.9134597736762543`*^9}, {
  3.913461115960853*^9, 3.913461116761843*^9}},
 CellTags->
  "Evaluation",ExpressionUUID->"b2f8440f-0c01-4955-ba05-493e98af5200"],

Cell[CellGroupData[{

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[Theta]", "mother"], ",", 
    RowBox[{
     SubscriptBox["E", "mother"], "->", 
     SubscriptBox["\[Theta]", "LLP"]}], ",", 
    SubscriptBox["E", "LLP"]}], TraditionalForm]],ExpressionUUID->
  "ad7e08f4-ae21-407d-9f91-f3a2f81fafbd"],
 ", following 2201.05170"
}], "Section",
 CellChangeTimes->{{3.913458830855912*^9, 3.9134588664358993`*^9}, 
   3.9134597783208*^9, {3.915438813079967*^9, 3.915438813082215*^9}},
 CellTags->
  "Evaluation",ExpressionUUID->"125727f8-06b9-47fc-a1af-4d0d283d5432"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"LLPkinematicsMixing", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Hold", "@", 
      RowBox[{"Compile", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"mdata", ",", "_Real", ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"mLLP", ",", "_Real"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"Eplab", ",", "_Real"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"IfCollider", ",", 
            RowBox[{"True", "|", "False"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"IfESS", ",", 
            RowBox[{"True", "|", "False"}]}], "}"}]}], "}"}], ",", 
        RowBox[{"Module", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"\[Theta]llpFin", "=", "0."}], ",", 
            RowBox[{"ellpFin", "=", "0."}], ",", 
            RowBox[{"pboost", "=", "0."}], ",", 
            RowBox[{"emes", "=", "0."}], ",", 
            RowBox[{"pxmes", "=", "0."}], ",", 
            RowBox[{"pymes", "=", "0."}], ",", 
            RowBox[{"pzmes", "=", "0."}], ",", 
            RowBox[{"mmes", "=", "0."}], ",", 
            RowBox[{"pzmesCM", "=", "0."}], ",", 
            RowBox[{"pzllpCM", "=", "0."}], ",", 
            RowBox[{"ellpCM", "=", "0."}], ",", 
            RowBox[{"pxllpLab", "=", "0."}], ",", 
            RowBox[{"pyllpLab", "=", "0."}], ",", 
            RowBox[{"pzllpLab", "=", "0."}]}], "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"pboost", "=", 
            SqrtBox[
             RowBox[{
              SuperscriptBox["Eplab", "2"], "-", 
              SuperscriptBox["0.938", "2"]}]]}], ";", "\[IndentingNewLine]", 
           RowBox[{"emes", "=", 
            RowBox[{"Compile`GetElement", "[", 
             RowBox[{"mdata", ",", "4"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"pxmes", "=", 
            RowBox[{"Compile`GetElement", "[", 
             RowBox[{"mdata", ",", "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"pymes", "=", 
            RowBox[{"Compile`GetElement", "[", 
             RowBox[{"mdata", ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"pzmes", "=", 
            RowBox[{"Compile`GetElement", "[", 
             RowBox[{"mdata", ",", "3"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"mmes", "=", 
            RowBox[{"Compile`GetElement", "[", 
             RowBox[{"mdata", ",", "5"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{
             "If", " ", "the", " ", "facility", " ", "is", " ", "beam", " ", 
              "dump"}], ",", " ", 
             RowBox[{"then", " ", "boost", " ", "the", " ", 
              RowBox[{"meson", "'"}], "s", " ", "kinematics", " ", "to", " ", 
              "CM", " ", "frame"}], ",", " ", 
             RowBox[{"relate", " ", "it", " ", "to", " ", "the", " ", 
              RowBox[{"LLP", "'"}], "s", " ", "kinematics"}], ",", " ", 
             RowBox[{"and", " ", "boost", " ", 
              RowBox[{"back", ".", " ", "Otherwise"}], " ", 
              RowBox[{"(", 
               RowBox[{"if", " ", "it", " ", "is", " ", "collider"}], ")"}]}],
              ",", " ", 
             RowBox[{
             "simply", " ", "renormalize", " ", "the", " ", "LLP", " ", 
              "energy"}]}], "*)"}], "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"!", "IfCollider"}], ",", "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{
               RowBox[{
                RowBox[{"Meson", "'"}], "s", " ", "and", " ", 
                RowBox[{"LLP", "'"}], "s", " ", "kinematics", " ", "at", " ", 
                "CM", " ", "frame"}], ",", " ", 
               RowBox[{
               "assuming", " ", "that", " ", "their", " ", "CM", " ", 
                "momenta", " ", "are", " ", "the", " ", 
                RowBox[{"same", ".", " ", "It"}], " ", "is", " ", "also", " ",
                 "assumed", " ", "that", " ", "the", " ", "boost", " ", "is", 
                " ", "in", " ", "the", " ", "z", " ", "direction"}]}], "*)"}],
              "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"pzmesCM", "=", 
               RowBox[{"pzllpCM", "=", 
                RowBox[{"pProductLab3", "[", 
                 RowBox[{"Eplab", ",", "0.938", ",", "0.", ",", "0.", ",", 
                  RowBox[{"-", "pboost"}], ",", "emes", ",", "pxmes", ",", 
                  "pymes", ",", "pzmes"}], "]"}]}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"ellpCM", "=", 
               SqrtBox[
                RowBox[{
                 SuperscriptBox["pxmes", "2"], "+", 
                 SuperscriptBox["pymes", "2"], "+", 
                 SuperscriptBox["pzllpCM", "2"], "+", 
                 SuperscriptBox["mLLP", "2"]}]]}], ";", "\[IndentingNewLine]", 
              RowBox[{"(*", 
               RowBox[{
                RowBox[{"LLP", "'"}], "s", " ", "kinematics", " ", "at", " ", 
                "lab", " ", "frame"}], "*)"}], "\[IndentingNewLine]", 
              RowBox[{"pxllpLab", "=", "pxmes"}], ";", "\[IndentingNewLine]", 
              
              RowBox[{"pyllpLab", "=", "pymes"}], ";", "\[IndentingNewLine]", 
              
              RowBox[{"pzllpLab", "=", 
               RowBox[{"pProductLab3", "[", 
                RowBox[{
                "Eplab", ",", "0.938", ",", "0.", ",", "0.", ",", "pboost", 
                 ",", "ellpCM", ",", "pxmes", ",", "pymes", ",", "pzllpCM"}], 
                "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"ellpFin", "=", 
               SqrtBox[
                RowBox[{
                 SuperscriptBox["pxllpLab", "2"], "+", 
                 SuperscriptBox["pyllpLab", "2"], "+", 
                 SuperscriptBox["pzllpLab", "2"], "+", 
                 SuperscriptBox["mLLP", "2"]}]]}], ";", "\[IndentingNewLine]", 
              RowBox[{"(*", 
               RowBox[{
                RowBox[{
                 RowBox[{"Warning", "!"}], " ", "If", " ", "relating", " ", 
                 "the", " ", "angle", " ", "of", " ", "the", " ", "LLP", " ", 
                 "to", " ", "the", " ", "meson", " ", "angle", " ", "by", " ",
                  "boosting", " ", "to", " ", "CM", " ", "frame"}], ",", " ", 
                
                RowBox[{
                "inadequate", " ", "results", " ", "may", " ", "be", " ", 
                 RowBox[{"produced", ".", " ", "I"}], " ", "am", " ", 
                 "working", " ", "on", " ", "improved", " ", "approach", " ", 
                 "of", " ", "the", " ", "production", " ", "via", " ", 
                 "mixing"}]}], "*)"}], "\[IndentingNewLine]", 
              RowBox[{"\[Theta]llpFin", "=", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"!", "IfESS"}], ",", 
                 RowBox[{"ArcCos", "[", 
                  FractionBox["pzllpLab", 
                   SqrtBox[
                    RowBox[{
                    SuperscriptBox["pxllpLab", "2"], "+", 
                    SuperscriptBox["pyllpLab", "2"], "+", 
                    SuperscriptBox["pzllpLab", "2"]}]]], "]"}], ",", 
                 RowBox[{"ArcCos", "[", 
                  FractionBox["pzmes", 
                   SqrtBox[
                    RowBox[{
                    SuperscriptBox["pxmes", "2"], "+", 
                    SuperscriptBox["pymes", "2"], "+", 
                    SuperscriptBox["pzmes", "2"]}]]], "]"}]}], "]"}]}], ";"}],
              "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"ellpFin", "=", 
               SqrtBox[
                RowBox[{
                 SuperscriptBox["pxmes", "2"], "+", 
                 SuperscriptBox["pymes", "2"], "+", 
                 SuperscriptBox["pzmes", "2"], "+", 
                 SuperscriptBox["mLLP", "2"]}]]}], ";", "\[IndentingNewLine]", 
              RowBox[{"\[Theta]llpFin", "=", 
               RowBox[{"ArcCos", "[", 
                FractionBox[
                 RowBox[{"Abs", "[", "pzmes", "]"}], 
                 SqrtBox[
                  RowBox[{
                   SuperscriptBox["pxmes", "2"], "+", 
                   SuperscriptBox["pymes", "2"], "+", 
                   SuperscriptBox["pzmes", "2"]}]]], "]"}]}], ";"}]}], 
            "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"\[Theta]llpFin", ",", "ellpFin"}], "}"}]}]}], 
         "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", ",", 
        RowBox[{"CompilationTarget", "->", "\"\<C\>\""}], ",", 
        RowBox[{"RuntimeOptions", "->", "\"\<Speed\>\""}], ",", 
        RowBox[{"RuntimeAttributes", "->", 
         RowBox[{"{", "Listable", "}"}]}], ",", 
        RowBox[{"Parallelization", "->", "True"}]}], "]"}]}], "/.", 
     RowBox[{"ruleDown", "[", 
      RowBox[{"{", "pProductLab3", "}"}], "]"}]}], "//", "ReleaseHold"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"<<", "CompiledFunctionTools`"}], "\n", 
 RowBox[{
  RowBox[{"CompilePrint", "@", "LLPkinematicsMixing"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"(*", 
    RowBox[{
     SubscriptBox["p", "CM"], " ", 
     RowBox[{"(", 
      RowBox[{"proton", "-", 
       RowBox[{"proton", " ", "collisions"}]}], ")"}], " ", "in", " ", 
     "terms", " ", "of", " ", 
     SubscriptBox["p", "lab"], " ", "assuming", " ", "that", " ", 
     SubscriptBox["p", "lab"], " ", "is", " ", "aligned", " ", "along", " ", 
     "the", " ", "boost"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"PcmPlab", "[", 
      RowBox[{"plab_", ",", "m_", ",", "Eplab_", ",", "mp_"}], "]"}], "=", 
     RowBox[{"Assuming", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"mp", ">", "0"}], "&&", 
        RowBox[{"Eplab", ">", "0"}]}], ",", 
       RowBox[{"Simplify", "[", 
        RowBox[{
         RowBox[{"\[Gamma]CMbeamDump", "[", 
          RowBox[{"Eplab", ",", "mp"}], "]"}], 
         RowBox[{"(", 
          RowBox[{"plab", "-", 
           RowBox[{
            RowBox[{"vCMbeamDump", "[", 
             RowBox[{"Eplab", ",", "mp"}], "]"}], "*", 
            SqrtBox[
             RowBox[{
              SuperscriptBox["plab", "2"], "+", 
              SuperscriptBox["m", "2"]}]]}]}], ")"}]}], "]"}]}], "]"}]}], ";",
     "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"inverse", " ", "relation"}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"PlabPcm", "[", 
      RowBox[{"pcm_", ",", "m_", ",", "Eplab_", ",", "mp_"}], "]"}], "=", 
     RowBox[{
      RowBox[{"plab", "/.", 
       RowBox[{
        RowBox[{"Solve", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"PcmPlab", "[", 
            RowBox[{"plab", ",", "m", ",", "Eplab", ",", "mp"}], "]"}], 
           "\[Equal]", "pcm"}], ",", "plab"}], "]"}], "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], "//", "Simplify"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{
       RowBox[{
       "Relation", " ", "between", " ", "the", " ", "meson", " ", "and", " ", 
        "DP", " ", "energies", " ", "and", " ", "angles", " ", "in", " ", 
        "the", " ", "CM", " ", 
        RowBox[{"frame", ".", " ", "Obtained"}], " ", "under", " ", 
        "assumption", " ", "that", " ", "at", " ", "the", " ", "CM", " ", 
        "frame", " ", "of", " ", "proton"}], "-", 
       RowBox[{
       "proton", " ", "collisions", " ", "the", " ", "meson", " ", "and", " ",
         "DP"}]}], " ", "|", "momenta", "|", " ", 
      RowBox[{"are", " ", "the", " ", "same"}]}], "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"EcmMesonEcmLLP", "[", 
      RowBox[{"EV_", ",", "mV_", ",", "mmeson_"}], "]"}], "=", 
     SqrtBox[
      RowBox[{
       SuperscriptBox["EV", "2"], "-", 
       SuperscriptBox["mV", "2"], "+", 
       SuperscriptBox["mmeson", "2"]}]]}], ";", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{
       RowBox[{
       "Relation", " ", "between", " ", "meson", " ", "and", " ", "DP", " ", 
        "kinematics", " ", "in", " ", "lab", " ", 
        RowBox[{"frame", ".", " ", "Obtained"}], " ", "under", " ", 
        "assumption", " ", "that", " ", "at", " ", "the", " ", "CM", " ", 
        "frame", " ", "of", " ", "proton"}], "-", 
       RowBox[{
       "proton", " ", "collisions", " ", "the", " ", "meson", " ", "and", " ",
         "DP"}]}], " ", "|", "momenta", "|", " ", 
      RowBox[{"are", " ", "the", " ", "same"}]}], "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"plabMesonElabLLP", "[", 
      RowBox[{"EV_", ",", "mmeson_", ",", "mV_", ",", "Eplab_", ",", "mp_"}], 
      "]"}], "=", 
     RowBox[{"Assuming", "[", 
      RowBox[{
       RowBox[{"EV", ">", "0"}], ",", 
       RowBox[{"Simplify", "[", 
        RowBox[{"PlabPcm", "[", 
         RowBox[{
          RowBox[{"PcmPlab", "[", 
           RowBox[{
            SqrtBox[
             RowBox[{
              SuperscriptBox["EV", "2"], "-", 
              SuperscriptBox["mV", "2"]}]], ",", "mV", ",", "Eplab", ",", 
            "mp"}], "]"}], ",", "mmeson", ",", "Eplab", ",", "mp"}], "]"}], 
        "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ElabMesonElabDP", "[", 
      RowBox[{"EV_", ",", "mmeson_", ",", "mV_", ",", "Eplab_", ",", "mp_"}], 
      "]"}], "=", 
     SqrtBox[
      RowBox[{
       SuperscriptBox[
        RowBox[{"plabMesonElabLLP", "[", 
         RowBox[{"EV", ",", "mmeson", ",", "mV", ",", "Eplab", ",", "mp"}], 
         "]"}], "2"], "+", 
       SuperscriptBox["mmeson", "2"]}]]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\[Theta]labMeson\[Theta]ElabDP", "[", 
      RowBox[{
      "EV_", ",", "\[Theta]V_", ",", "mmeson_", ",", "mV_", ",", "Eplab_", 
       ",", "mp_"}], "]"}], "=", 
     RowBox[{"ArcSin", "[", 
      RowBox[{
       RowBox[{"Sin", "[", "\[Theta]V", "]"}], 
       FractionBox[
        SqrtBox[
         RowBox[{
          SuperscriptBox["EV", "2"], "-", 
          SuperscriptBox["mV", "2"]}]], 
        RowBox[{"plabMesonElabLLP", "[", 
         RowBox[{"EV", ",", "mmeson", ",", "mV", ",", "Eplab", ",", "mp"}], 
         "]"}]]}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{
       RowBox[{"If", " ", 
        SubscriptBox["E", "a"]}], " ", "<", " ", 
       SubscriptBox["E", 
        RowBox[{"a", ",", "min"}]]}], ",", " ", 
      RowBox[{
      "then", " ", "there", " ", "is", " ", "no", " ", "solution", " ", 
       SubscriptBox["E", "meson"], 
       RowBox[{"(", 
        SubscriptBox["E", "a"], ")"}]}]}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"EVminBeamDump", "[", 
      RowBox[{"mmeson_", ",", "mV_", ",", "Eplab_", ",", "mp_"}], "]"}], "=", 
     
     RowBox[{"EV", "/.", 
      RowBox[{
       RowBox[{"Solve", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"plabMesonElabLLP", "[", 
           RowBox[{"EV", ",", "mmeson", ",", "mV", ",", "Eplab", ",", "mp"}], 
           "]"}], "\[Equal]", "0"}], ",", "EV"}], "]"}], "[", 
       RowBox[{"[", "4", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"EVminCM", "[", 
      RowBox[{"mmeson_", ",", "mV_"}], "]"}], "=", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"mV", ">", "mmeson"}], ",", 
       RowBox[{"Evaluate", "[", 
        RowBox[{"EV", "/.", 
         RowBox[{
          RowBox[{"Solve", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"EcmMesonEcmLLP", "[", 
              RowBox[{"EV", ",", "mV", ",", "mmeson"}], "]"}], "\[Equal]", 
             "0"}], ",", "EV"}], "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], "]"}], ",", "mV"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"Jacobian", " ", 
       SubscriptBox["E", "meson"]}], ",", 
      RowBox[{
       SubscriptBox["\[Theta]", "meson"], " ", "\[Rule]", " ", 
       SubscriptBox["E", "a"]}], ",", 
      SubscriptBox["\[Theta]", "a"]}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Jacobian\[Theta]mesonEmesonTo\[Theta]VEVBeamDump", "[", 
      RowBox[{
      "Eplab_", ",", "mp_", ",", "mmeson_", ",", "mV_", ",", "\[Theta]V_", 
       ",", "EV_"}], "]"}], "=", 
     RowBox[{
      RowBox[{"Abs", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{"\[Theta]labMeson\[Theta]ElabDP", "[", 
            RowBox[{
            "EV", ",", "\[Theta]V", ",", "mmeson", ",", "mV", ",", "Eplab", 
             ",", "mp"}], "]"}], ",", "\[Theta]V"}], "]"}], "*", 
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{"ElabMesonElabDP", "[", 
            RowBox[{"EV", ",", "mmeson", ",", "mV", ",", "Eplab", ",", "mp"}],
             "]"}], ",", "EV"}], "]"}]}], "-", 
        RowBox[{
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{"\[Theta]labMeson\[Theta]ElabDP", "[", 
            RowBox[{
            "EV", ",", "\[Theta]V", ",", "mmeson", ",", "mV", ",", "Eplab", 
             ",", "mp"}], "]"}], ",", "EV"}], "]"}], "*", 
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{"ElabMesonElabDP", "[", 
            RowBox[{"EV", ",", "mmeson", ",", "mV", ",", "Eplab", ",", "mp"}],
             "]"}], ",", "\[Theta]V"}], "]"}]}]}], "]"}], "//", 
      "Simplify"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"JacobianEmesonToEVCollider", "[", 
      RowBox[{"EV_", ",", "mV_", ",", "mmeson_"}], "]"}], "=", 
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"EcmMesonEcmLLP", "[", 
        RowBox[{"EV", ",", "mV", ",", "mmeson"}], "]"}], ",", "EV"}], "]"}]}],
     ";"}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.887820755505718*^9, 3.887820778838458*^9}, {
   3.8878208916198773`*^9, 3.887820893659738*^9}, {3.913458914135668*^9, 
   3.913458914735282*^9}, {3.91629922979214*^9, 3.916299256298482*^9}, 
   3.916306139185005*^9, {3.9164670679404135`*^9, 3.916467093841219*^9}, {
   3.916467132771764*^9, 3.916467144409526*^9}, {3.916484558159028*^9, 
   3.916484574451497*^9}, {3.917284452828832*^9, 3.917284456411309*^9}, {
   3.917284490013545*^9, 3.9172844952406764`*^9}, {3.918135737000326*^9, 
   3.918135802172912*^9}, {3.918135935319717*^9, 3.9181359399533167`*^9}, {
   3.918146283917324*^9, 3.918146341479133*^9}},
 CellTags->"Evaluation",
 CellLabel->
  "In[1163]:=",ExpressionUUID->"da44903f-05ef-4242-b267-549f4284480a"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Distribution of LLPs obtained using the transformation ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["E", "meson"], ",", 
    RowBox[{
     SubscriptBox["\[Theta]", "meson"], " ", "\[Rule]", 
     SubscriptBox["E", "LLP"]}], ",", " ", 
    SubscriptBox["\[Theta]", "LLP"]}], TraditionalForm]],ExpressionUUID->
  "4c8bbf6b-f3ad-4967-9627-8e26f14ce609"]
}], "Section",
 CellChangeTimes->{
  3.9134597857722178`*^9, {3.915438817296666*^9, 3.91543881730466*^9}},
 CellTags->
  "Evaluation",ExpressionUUID->"12b0e6e0-df96-4812-a894-224449fc0ed6"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"BlockTabulatedPDFsFromMixingsMass", "[", 
   RowBox[{
   "LLP_", ",", "Facility_", ",", "mLLP_", ",", "process_", ",", "Nevents_", 
    ",", "\[Theta]list_", ",", "Elist_", ",", "\[Theta]minExtr_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"maxmass", "=", 
      RowBox[{"MaxMass", "[", 
       RowBox[{"LLP", ",", "Facility", ",", "process"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"mLLP", "<", "maxmass"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"partcontent", "=", 
         RowBox[{"ReactionProductsList", "[", 
          RowBox[{"LLP", ",", "process"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"meson", "=", 
         RowBox[{"partcontent", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"mmeson", "=", 
         RowBox[{"mSM", "[", "meson", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"elab", "=", 
         RowBox[{"EmaxFacility", "[", "Facility", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", 
            RowBox[{"MotherPoints", "[", 
             RowBox[{"meson", ",", "Facility", ",", "\"\<False\>\""}], "]"}], 
            "]"}], "!=", "Nevents"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"MotherPoints", "[", 
             RowBox[{"meson", ",", "Facility", ",", "\"\<False\>\""}], "]"}], 
            "=", 
            RowBox[{"PointsSampler", "[", 
             RowBox[{
             "Facility", ",", "meson", ",", "Nevents", ",", "\"\<False\>\""}],
              "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"IfCollider", "=", 
         RowBox[{"MemberQ", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"\"\<LHC\>\"", ",", "\"\<FCC-hh\>\""}], "}"}], ",", 
           "Facility"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"IfESS", "=", 
         RowBox[{"Facility", "==", "\"\<ESS\>\""}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"\[Theta]Edata", "=", 
         RowBox[{"LLPkinematicsMixing", "[", 
          RowBox[{
           RowBox[{"MotherPoints", "[", 
            RowBox[{"meson", ",", "Facility", ",", "\"\<False\>\""}], "]"}], 
           ",", "mLLP", ",", "elab", ",", "IfCollider", ",", "IfESS"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"FromDataToSmoothDistribution", "[", 
         RowBox[{
         "\[Theta]Edata", ",", "mLLP", ",", "Facility", ",", 
          "\"\<False\>\""}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"The", " ", "tabulated", " ", "distribution"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"tab1", "=", 
         RowBox[{"Flatten", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"mLLP", ",", "\[Theta]LLP", ",", "ELLP", ",", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"\[Theta]LLP", "<", "\[Theta]minExtr"}], ",", 
                 RowBox[{
                  FractionBox["\[Theta]LLP", "\[Theta]minExtr"], 
                  RowBox[{"DoubleDistr", "[", 
                   RowBox[{"\[Theta]minExtr", ",", "ELLP"}], "]"}]}], ",", 
                 RowBox[{"DoubleDistr", "[", 
                  RowBox[{"\[Theta]LLP", ",", "ELLP"}], "]"}]}], "]"}]}], 
              "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"\[Theta]LLP", ",", "\[Theta]list"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"ELLP", ",", "Elist"}], "}"}]}], "]"}], ",", "1"}], 
          "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"mLLP", ">=", "maxmass"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"tab1", "=", 
         RowBox[{"TabZeroDistr", "[", 
          RowBox[{"mLLP", ",", "\[Theta]list", ",", "Elist"}], "]"}]}], 
        ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     "tab1"}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"DoubleDistrLLPfromMixing", "[", 
     RowBox[{"mLLP_", ",", "meson_", ",", "Facility_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"mmeson", ",", "elab"}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "This", " ", "block", " ", "produces", " ", "the", " ", 
          "interpolation", " ", "of", " ", "the", " ", "mother", " ", 
          "distribution", " ", "function"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"mmeson", "=", 
          RowBox[{"mSM", "[", "meson", "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"elab", "=", 
          RowBox[{"EmaxFacility", "[", "Facility", "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"distr", "[", 
           RowBox[{"th_", ",", "e_"}], "]"}], "=", 
          RowBox[{"DoubleDistrMotherInt", "[", 
           RowBox[{"th", ",", "e", ",", "Facility", ",", "meson"}], "]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"MemberQ", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"\"\<FCC-hh\>\"", ",", "\"\<LHC\>\""}], "}"}], ",", 
              "Facility"}], "]"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"Facility", "!=", "\"\<ESS\>\""}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"distrmixing", "[", 
                RowBox[{"\[Theta]LLP_", ",", "ELLP_"}], "]"}], "=", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"ELLP", ">", 
                   RowBox[{"Max", "[", 
                    RowBox[{"mLLP", ",", 
                    RowBox[{"EVminBeamDump", "[", 
                    RowBox[{"mmeson", ",", "mLLP", ",", "elab", ",", 
                    RowBox[{"mSM", "[", "\"\<p\>\"", "]"}]}], "]"}]}], 
                    "]"}]}], "&&", 
                  RowBox[{"0", "<", 
                   RowBox[{
                    RowBox[{"Sin", "[", "\[Theta]LLP", "]"}], 
                    FractionBox[
                    SqrtBox[
                    RowBox[{
                    SuperscriptBox["ELLP", "2"], "-", 
                    SuperscriptBox["mLLP", "2"]}]], 
                    RowBox[{"plabMesonElabLLP", "[", 
                    RowBox[{
                    "ELLP", ",", "mmeson", ",", "mLLP", ",", "elab", ",", 
                    RowBox[{"mSM", "[", "\"\<p\>\"", "]"}]}], "]"}]]}], "<", 
                   "1"}]}], ",", 
                 RowBox[{"Evaluate", "[", 
                  RowBox[{
                   RowBox[{
                   "Jacobian\[Theta]mesonEmesonTo\[Theta]VEVBeamDump", "[", 
                    RowBox[{"elab", ",", 
                    RowBox[{"mSM", "[", "\"\<p\>\"", "]"}], ",", "mmeson", 
                    ",", "mLLP", ",", "\[Theta]LLP", ",", "ELLP"}], "]"}], 
                   "*", 
                   RowBox[{"distr", "[", 
                    RowBox[{
                    RowBox[{"\[Theta]labMeson\[Theta]ElabDP", "[", 
                    RowBox[{
                    "ELLP", ",", "\[Theta]LLP", ",", "mmeson", ",", "mLLP", 
                    ",", "elab", ",", 
                    RowBox[{"mSM", "[", "\"\<p\>\"", "]"}]}], "]"}], ",", 
                    RowBox[{"ElabMesonElabDP", "[", 
                    RowBox[{
                    "ELLP", ",", "mmeson", ",", "mLLP", ",", "elab", ",", 
                    RowBox[{"mSM", "[", "\"\<p\>\"", "]"}]}], "]"}]}], 
                    "]"}]}], "]"}], ",", "0."}], "]"}]}], ";"}], 
             "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{
               RowBox[{
                RowBox[{"distrmixingTemp", "[", 
                 RowBox[{"\[Theta]LLP_", ",", "ELLP_"}], "]"}], "=", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"ELLP", ">", "mLLP"}], ",", 
                  RowBox[{"Evaluate", "[", 
                   RowBox[{"distr", "[", 
                    RowBox[{"\[Theta]LLP", ",", "ELLP"}], "]"}], "]"}], ",", 
                  "0."}], "]"}]}], ";", "\[IndentingNewLine]", 
               RowBox[{"distrmixingNorm", "=", 
                RowBox[{"NIntegrate", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"distrmixingTemp", "[", 
                    RowBox[{
                    RowBox[{"Exp", "[", "\[Theta]LLP", "]"}], ",", 
                    RowBox[{"Exp", "[", "ELLP", "]"}]}], "]"}], 
                   RowBox[{"Exp", "[", 
                    RowBox[{"\[Theta]LLP", "+", "ELLP"}], "]"}]}], ",", 
                  RowBox[{"{", 
                   RowBox[{"\[Theta]LLP", ",", 
                    RowBox[{"Log", "[", 
                    SuperscriptBox["10", 
                    RowBox[{"-", "5."}]], "]"}], ",", 
                    RowBox[{"Log", "[", 
                    RowBox[{"Pi", "-", 
                    SuperscriptBox["10", 
                    RowBox[{"-", "5."}]]}], "]"}]}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"ELLP", ",", 
                    RowBox[{"Log", "[", "mLLP", "]"}], ",", 
                    RowBox[{"Log", "[", "elab", "]"}]}], "}"}], ",", 
                  RowBox[{
                  "Method", "->", 
                   "\"\<InterpolationPointsSubdivision\>\""}]}], "]"}]}], ";",
                "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"distrmixing", "[", 
                 RowBox[{"\[Theta]LLP_", ",", "ELLP_"}], "]"}], "=", 
                FractionBox[
                 RowBox[{"distrmixingTemp", "[", 
                  RowBox[{"\[Theta]LLP", ",", "ELLP"}], "]"}], 
                 "distrmixingNorm"]}], ";"}], "*)"}], "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"distrmixing", "[", 
                RowBox[{"\[Theta]LLP_", ",", "ELLP_"}], "]"}], "=", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"ELLP", ">", 
                   RowBox[{"Max", "[", 
                    RowBox[{"mLLP", ",", 
                    RowBox[{"EVminBeamDump", "[", 
                    RowBox[{"mmeson", ",", "mLLP", ",", "elab", ",", 
                    RowBox[{"mSM", "[", "\"\<p\>\"", "]"}]}], "]"}]}], 
                    "]"}]}], "&&", 
                  RowBox[{"0", "<", 
                   RowBox[{
                    RowBox[{"Sin", "[", "\[Theta]LLP", "]"}], 
                    FractionBox[
                    SqrtBox[
                    RowBox[{
                    SuperscriptBox["ELLP", "2"], "-", 
                    SuperscriptBox["mLLP", "2"]}]], 
                    RowBox[{"plabMesonElabLLP", "[", 
                    RowBox[{
                    "ELLP", ",", "mmeson", ",", "mLLP", ",", "elab", ",", 
                    RowBox[{"mSM", "[", "\"\<p\>\"", "]"}]}], "]"}]]}], "<", 
                   "1"}]}], ",", 
                 RowBox[{"Evaluate", "[", 
                  RowBox[{
                   RowBox[{
                   "Jacobian\[Theta]mesonEmesonTo\[Theta]VEVBeamDump", "[", 
                    RowBox[{"elab", ",", 
                    RowBox[{"mSM", "[", "\"\<p\>\"", "]"}], ",", "mmeson", 
                    ",", "mLLP", ",", "\[Theta]LLP", ",", "ELLP"}], "]"}], 
                   "*", 
                   RowBox[{"distr", "[", 
                    RowBox[{
                    RowBox[{"\[Theta]labMeson\[Theta]ElabDP", "[", 
                    RowBox[{
                    "ELLP", ",", "\[Theta]LLP", ",", "mmeson", ",", "mLLP", 
                    ",", "elab", ",", 
                    RowBox[{"mSM", "[", "\"\<p\>\"", "]"}]}], "]"}], ",", 
                    RowBox[{"ElabMesonElabDP", "[", 
                    RowBox[{
                    "ELLP", ",", "mmeson", ",", "mLLP", ",", "elab", ",", 
                    RowBox[{"mSM", "[", "\"\<p\>\"", "]"}]}], "]"}]}], 
                    "]"}]}], "]"}], ",", "0."}], "]"}]}], ";"}]}], 
            "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"distrmixing", "[", 
              RowBox[{"\[Theta]LLP_", ",", "ELLP_"}], "]"}], "=", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"ELLP", ">", 
                RowBox[{"Max", "[", 
                 RowBox[{"mLLP", ",", 
                  RowBox[{"EVminCM", "[", 
                   RowBox[{"mmeson", ",", "mLLP"}], "]"}]}], "]"}]}], ",", 
               RowBox[{"Evaluate", "[", 
                RowBox[{
                 RowBox[{"JacobianEmesonToEVCollider", "[", 
                  RowBox[{"ELLP", ",", "mLLP", ",", "mmeson"}], "]"}], "*", 
                 RowBox[{"distr", "[", 
                  RowBox[{"\[Theta]LLP", ",", 
                   RowBox[{"EcmMesonEcmLLP", "[", 
                    RowBox[{"ELLP", ",", "mLLP", ",", "mmeson"}], "]"}]}], 
                  "]"}]}], "]"}], ",", "0."}], "]"}]}], ";"}]}], 
          "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"distrmixing", "[", 
          RowBox[{"\[Theta]LLP", ",", "ELLP"}], "]"}]}]}], 
       "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
      RowBox[{"BlockTabulatedPDFsFromMixing", "[", 
       RowBox[{
       "LLP_", ",", "Facility_", ",", "mLLP_", ",", "mode_", ",", 
        "\[Theta]list_", ",", "Elist_"}], "]"}]}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"(*", 
         RowBox[{"meson", ",", "distr", ",", "tab1", ",", "maxmass"}], "*)"}],
         "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"meson", "=", 
         RowBox[{
          RowBox[{"ReactionProductsList", "[", 
           RowBox[{"LLP", ",", "mode"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"!", 
           RowBox[{"IfMotherInterpolated", "[", 
            RowBox[{"Facility", ",", "meson"}], "]"}]}], ",", 
          RowBox[{"MotherInterpolation", "[", 
           RowBox[{"Facility", ",", "meson"}], "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"distrMixing", "[", 
          RowBox[{"\[Theta]LLP_", ",", "ELLP_"}], "]"}], "=", 
         RowBox[{"DoubleDistrLLPfromMixing", "[", 
          RowBox[{"mLLP", ",", "meson", ",", "Facility"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"maxmass", "=", 
         RowBox[{"MaxMass", "[", 
          RowBox[{"LLP", ",", "Facility", ",", "mode"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"mLLP", "<", "maxmass"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"tab1", "=", 
            RowBox[{"Quiet", "[", 
             RowBox[{"Flatten", "[", 
              RowBox[{
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"mLLP", ",", "\[Theta]LLP", ",", "ELLP", ",", 
                   RowBox[{"distrMixing", "[", 
                    RowBox[{"\[Theta]LLP", ",", "ELLP"}], "]"}]}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"\[Theta]LLP", ",", "\[Theta]list"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"ELLP", ",", "Elist"}], "}"}]}], "]"}], ",", "1"}], 
              "]"}], "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"mLLP", ">=", "maxmass"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"tab1", "=", 
            RowBox[{"TabZeroDistr", "[", 
             RowBox[{"mLLP", ",", "\[Theta]list", ",", "Elist"}], "]"}]}], 
           ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        "tab1"}]}], "\[IndentingNewLine]", "]"}]}]}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.892706366484842*^9, 3.892706367154895*^9}, {
   3.894706218755332*^9, 3.894706219417214*^9}, {3.913458935645393*^9, 
   3.913458962067128*^9}, {3.913459001827169*^9, 3.9134591181654263`*^9}, {
   3.913459148176505*^9, 3.913459181717247*^9}, {3.9134593070753903`*^9, 
   3.9134594162969933`*^9}, {3.9134594470565405`*^9, 3.91345957430658*^9}, {
   3.9134596520246434`*^9, 3.913459694635381*^9}, {3.9134601634554663`*^9, 
   3.9134601637156563`*^9}, {3.913460245465927*^9, 3.91346039761585*^9}, {
   3.913887786035822*^9, 3.9138877885773606`*^9}, 3.914396764645307*^9, {
   3.915438817320672*^9, 3.915438817548157*^9}, 3.9154409661820283`*^9, {
   3.915608805266134*^9, 3.915608826911299*^9}, {3.916298256776675*^9, 
   3.916298259846875*^9}, {3.9162983371083875`*^9, 3.916298341303644*^9}, {
   3.916300242001726*^9, 3.916300246297705*^9}, {3.91630067227152*^9, 
   3.91630067448092*^9}, {3.9163294677972217`*^9, 3.9163295219195547`*^9}, {
   3.916329750384121*^9, 3.916329834290462*^9}, 3.9163299829065704`*^9, 
   3.916330224445789*^9, {3.916330534761789*^9, 3.9163306338743334`*^9}, 
   3.9163307735447073`*^9, {3.916331697219954*^9, 3.916331737906413*^9}, {
   3.9163317732181625`*^9, 3.916331776694725*^9}, {3.916390095187765*^9, 
   3.916390098605654*^9}, {3.9164670679574475`*^9, 3.916467093322209*^9}, {
   3.916467132786764*^9, 3.9164671440888624`*^9}, {3.916484579319687*^9, 
   3.91648461580857*^9}, 3.9181468498541465`*^9},
 CellTags->"Evaluation",
 CellLabel->
  "In[1166]:=",ExpressionUUID->"56819cf5-9a3b-4ba2-ae85-c810358c19fd"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Production via bremsstrahlung: PDF and normalization", "Chapter",
 CellChangeTimes->{{3.9134611253346887`*^9, 3.91346112984895*^9}, 
   3.916852619439444*^9},
 CellTags->
  "Evaluation",ExpressionUUID->"853db63b-6868-4690-a70f-51ee3f3c9d64"],

Cell[BoxData[
 RowBox[{
  RowBox[{"BlockTabulatedPDFsFromBrem", "[", 
   RowBox[{"LLP_", ",", "Facility_", ",", "mlist_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"(*", 
      RowBox[{
      "pbeam", ",", "eminbrem", ",", "\[Theta]Vlistbrem", ",", 
       "EvlistBremTemp", ",", "EvlistBrem", ",", "\[Theta]list1"}], "*)"}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"pbeam", "=", 
      RowBox[{"EmaxFacility", "[", "Facility", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"eminbrem", "=", 
      RowBox[{"ELLPminBrem", "[", "Facility", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"Computing", " ", "the", " ", "normalization"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"distrbrem", "[", 
       RowBox[{"mV_", ",", "\[Theta]V_", ",", "EV_"}], "]"}], "=", 
      RowBox[{"DoubleDistrBremNonNormalized", "[", 
       RowBox[{
       "mV", ",", "\[Theta]V", ",", "EV", ",", "LLP", ",", "Facility"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"normdata", "=", 
      RowBox[{"ParallelTable", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"mV", ",", 
          RowBox[{"NIntegrate", "[", 
           RowBox[{
            RowBox[{"distrbrem", "[", 
             RowBox[{"mV", ",", "\[Theta]V", ",", "EV"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"\[Theta]V", ",", "0", ",", 
              RowBox[{"\[Theta]maxBrem", "[", "Facility", "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"EV", ",", "eminbrem", ",", 
              RowBox[{"Max", "[", 
               RowBox[{"eminbrem", ",", 
                RowBox[{"ELLPmaxBrem", "[", 
                 RowBox[{"Facility", ",", "mV", ",", "\[Theta]V"}], "]"}]}], 
               "]"}]}], "}"}]}], "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"mV", ",", "mVminFromBrem", ",", "mVmaxFromBrem", ",", 
          FractionBox[
           RowBox[{"(", 
            RowBox[{"mVmaxFromBrem", "-", "mVminFromBrem"}], ")"}], "25"]}], 
         "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"normBrem", "[", "mV_", "]"}], "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Interpolation", "[", 
         RowBox[{
          RowBox[{"normdata", "//", "Log"}], ",", 
          RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[", 
        RowBox[{"Log", "[", "mV", "]"}], "]"}], "//", "Exp"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"DoubleDistrBrem", "[", 
       RowBox[{"mV_", ",", "\[Theta]V_", ",", "EV_"}], "]"}], "=", 
      FractionBox[
       RowBox[{"DoubleDistrBremNonNormalized", "[", 
        RowBox[{
        "mV", ",", "\[Theta]V", ",", "EV", ",", "LLP", ",", "Facility"}], 
        "]"}], 
       RowBox[{"normBrem", "[", "mV", "]"}]]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"NormalizationBrem", "[", "mLLP_", "]"}], "=", 
      RowBox[{
       RowBox[{"normBrem", "[", "mLLP", "]"}], "*", 
       RowBox[{"FormFactorSquaredBrem", "[", 
        RowBox[{"mLLP", ",", "LLP"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Export", "[", 
      RowBox[{
       RowBox[{"FileNameJoin", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"NotebookDirectory", "[", "]"}], ",", 
          RowBox[{
          "\"\<phenomenology/\>\"", "<>", "LLP", "<>", 
           "\"\</Production probabilities/Pbrem_\>\"", "<>", "LLP", "<>", 
           "\"\<_\>\"", "<>", "Facility", "<>", "\"\<.m\>\""}]}], "}"}], 
        "]"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"NormalizationBrem", "[", "mLLP", "]"}], ",", "eminbrem", 
         ",", 
         RowBox[{"ELLPmaxBrem", "[", 
          RowBox[{"Facility", ",", "mLLP", ",", "\[Theta]LLP"}], "]"}]}], 
        "}"}], ",", "\"\<MX\>\""}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"tabbrem", "=", 
      RowBox[{"Flatten", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"mV", ",", "\[Theta]V", ",", "EV", ",", 
            RowBox[{"DoubleDistrBrem", "[", 
             RowBox[{"mV", ",", "\[Theta]V", ",", "EV"}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"mV", ",", "mlist"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"\[Theta]V", ",", 
            RowBox[{"\[Theta]LLPgridBrem", "[", "Facility", "]"}]}], "}"}], 
          ",", 
          RowBox[{"{", 
           RowBox[{"EV", ",", 
            RowBox[{"ELLPgridBrem", "[", "Facility", "]"}]}], "}"}]}], "]"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"bremname", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"LLP", "==", "\"\<Scalar\>\""}], ",", 
        "\"\<Bremsstrahlung-mixing\>\"", ",", "\"\<Bremsstrahlung\>\""}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"filename", "=", 
      RowBox[{"filenameToExport", "[", 
       RowBox[{"LLP", ",", "bremname", ",", "Facility"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Export", "[", 
      RowBox[{"filename", ",", "tabbrem", ",", "\"\<MX\>\""}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.9134611326669645`*^9, 3.913461154765275*^9}, {
   3.913461275772606*^9, 3.9134613057720785`*^9}, {3.9134614850989933`*^9, 
   3.9134614873941975`*^9}, 3.9134799132775173`*^9, {3.913887871134832*^9, 
   3.91388787537938*^9}, {3.9138884940656395`*^9, 3.91388849668608*^9}, {
   3.9138900167749043`*^9, 3.9138900435933714`*^9}, {3.913890172802967*^9, 
   3.913890251049158*^9}, {3.914055484165147*^9, 3.914055507732421*^9}, {
   3.914055640113051*^9, 3.914055888421193*^9}, {3.914055926716466*^9, 
   3.91405593887613*^9}, {3.914055987718655*^9, 3.9140560736436377`*^9}, {
   3.914056379233598*^9, 3.914056384297064*^9}, {3.9140564198991365`*^9, 
   3.914056459996372*^9}, {3.9140566972650137`*^9, 3.9140567016203213`*^9}, {
   3.914056794106888*^9, 3.914056814407315*^9}, 3.9140571076079054`*^9, {
   3.91543881756443*^9, 3.915438817614164*^9}, {3.915727955297183*^9, 
   3.915727956121067*^9}, {3.9168526468963423`*^9, 3.916852647052813*^9}, {
   3.916855926425822*^9, 3.916855949596497*^9}, {3.91716201539716*^9, 
   3.9171620154049625`*^9}, {3.917163779939214*^9, 3.917163781203268*^9}, {
   3.917164358538873*^9, 3.917164374978002*^9}, {3.917164436015372*^9, 
   3.9171644808541*^9}, 3.917165687069251*^9, {3.919012895004699*^9, 
   3.919012895265682*^9}, {3.929116659995929*^9, 3.929116679671391*^9}},
 CellTags->"Evaluation",
 CellLabel->
  "In[1167]:=",ExpressionUUID->"4028c5b9-b1a4-4cea-8fa0-6a2cb8751f66"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Production via Primakov process: PDF and normalization", "Chapter",
 CellChangeTimes->{{3.913478380065708*^9, 3.913478401203979*^9}},
 CellTags->
  "Evaluation",ExpressionUUID->"ede618e1-db1f-4052-9341-3ad98669ba20"],

Cell[BoxData[
 RowBox[{
  RowBox[{"BlockTabulatedPDFsFromPrimakov", "[", 
   RowBox[{
   "Facility_", ",", "Nucleus_", ",", "\[Theta]list_", ",", "Elist_"}], "]"}],
   ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "\[Theta]min", ",", "\[Theta]max", ",", "mlist", ",", "filename1", ",", 
      "filename2", ",", "proc", ",", "fipn"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"proc", "=", "\"\<Primakov\>\""}], ";", "\[IndentingNewLine]", 
     RowBox[{"fipn", "=", "\"\<ALP-photon\>\""}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"mlist", "=", 
      RowBox[{"MassList", "[", 
       RowBox[{"fipn", ",", "proc", ",", "Facility"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"ProbPrimakovTab", "=", 
      RowBox[{"Flatten", "[", 
       RowBox[{
        RowBox[{"ParallelTable", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"ma", ",", "E\[Gamma]", ",", 
            RowBox[{"Max", "[", 
             RowBox[{
              SuperscriptBox["10", 
               RowBox[{"-", "90."}]], ",", 
              RowBox[{
               FractionBox["1", 
                RowBox[{"\[Sigma]\[Gamma]Abs", "[", "Nucleus", "]"}]], 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Quiet", "[", 
                  RowBox[{"\[Sigma]PrimakovNucleus", "[", 
                   RowBox[{"ma", ",", "E\[Gamma]", ",", 
                    RowBox[{"mnucleus", "[", "Nucleus", "]"}], ",", 
                    RowBox[{"anucleus", "[", "Nucleus", "]"}], ",", 
                    RowBox[{"znucleus", "[", "Nucleus", "]"}]}], "]"}], "]"}],
                  "+", 
                 RowBox[{"Quiet", "[", 
                  RowBox[{"\[Sigma]PrimakovNucleons", "[", 
                   RowBox[{"ma", ",", "E\[Gamma]", ",", 
                    RowBox[{"znucleus", "[", "Nucleus", "]"}]}], "]"}], 
                  "]"}]}], ")"}]}]}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"ma", ",", "mlist"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"E\[Gamma]", ",", 
            RowBox[{"ENlist", "[", "Facility", "]"}]}], "}"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"1", ",", "2"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{
        RowBox[{"Approximation", ":", " ", 
         SubscriptBox["E", "a"]}], " ", "=", " ", 
        SubscriptBox["E", "\[Gamma]"]}], ",", " ", 
       RowBox[{
        SubscriptBox["\[Theta]", "a"], " ", "=", " ", 
        SubscriptBox["\[Theta]", "\[Gamma]"]}]}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ProbPrimakov", "[", 
       RowBox[{"ma_", ",", "Ea_"}], "]"}], "=", 
      RowBox[{"Exp", "[", 
       RowBox[{
        RowBox[{"Interpolation", "[", 
         RowBox[{
          RowBox[{"Log", "[", "ProbPrimakovTab", "]"}], ",", 
          RowBox[{"InterpolationOrder", "->", "1"}]}], "]"}], "[", 
        RowBox[{
         RowBox[{"Log", "[", "ma", "]"}], ",", 
         RowBox[{"Log", "[", "Ea", "]"}]}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"MotherInterpolation", "[", 
      RowBox[{"Facility", ",", "\"\<photon\>\""}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ALPdoubleFlux", "[", 
       RowBox[{"ma_", ",", "\[Theta]a_", ",", "Ea_"}], "]"}], "=", 
      RowBox[{
       RowBox[{"DoubleDistrMotherInt", "[", 
        RowBox[{
        "\[Theta]a", ",", "Ea", ",", "Facility", ",", "\"\<photon\>\""}], 
        "]"}], "*", 
       RowBox[{"ProbPrimakov", "[", 
        RowBox[{"ma", ",", "Ea"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\[Theta]min", ",", "\[Theta]max"}], "}"}], "=", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"\[Theta]MinMax", "[", 
          RowBox[{"Facility", ",", "\"\<photon\>\""}], "]"}], "[", 
         RowBox[{"[", "#", "]"}], "]"}], "&"}], "/@", 
       RowBox[{"{", 
        RowBox[{"1", ",", "2"}], "}"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"NormalizationALP", "[", "ma_", "]"}], "=", 
      RowBox[{
       RowBox[{"Interpolation", "[", 
        RowBox[{
         RowBox[{"ParallelTable", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"ma", ",", 
             RowBox[{"Quiet", "[", 
              RowBox[{"NIntegrate", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"ALPdoubleFlux", "[", 
                  RowBox[{"ma", ",", 
                   RowBox[{"Exp", "[", "t", "]"}], ",", 
                   RowBox[{"Exp", "[", "e", "]"}]}], "]"}], 
                 RowBox[{"Exp", "[", 
                  RowBox[{"t", "+", "e"}], "]"}]}], ",", 
                RowBox[{"{", 
                 RowBox[{"t", ",", 
                  RowBox[{"Log", "[", "\[Theta]min", "]"}], ",", 
                  RowBox[{"Log", "[", "\[Theta]max", "]"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"e", ",", 
                  RowBox[{"Log", "[", "ma", "]"}], ",", 
                  RowBox[{"Log", "[", 
                   RowBox[{"Emax", "[", 
                    RowBox[{
                    "\[Theta]min", ",", "Facility", ",", "\"\<photon\>\""}], 
                    "]"}], "]"}]}], "}"}], ",", 
                RowBox[{
                "Method", "->", "\"\<InterpolationPointsSubdivision\>\""}]}], 
               "]"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"ma", ",", "mlist"}], "}"}]}], "]"}], ",", 
         RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "[", "ma", 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"DoubleDistrALP", "[", 
       RowBox[{"ma_", ",", "\[Theta]a_", ",", "Ea_"}], "]"}], "=", 
      RowBox[{
       RowBox[{"ALPdoubleFlux", "[", 
        RowBox[{"ma", ",", "\[Theta]a", ",", "Ea"}], "]"}], "/", 
       RowBox[{"NormalizationALP", "[", "ma", "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"filename1", "=", 
      RowBox[{"FileNameJoin", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"NotebookDirectory", "[", "]"}], ",", 
         "\"\<spectra/New physics particles spectra\>\"", ",", 
         RowBox[{"LLPfolder", "[", "\"\<ALP-photon\>\"", "]"}], ",", 
         RowBox[{"ToString", "@", 
          RowBox[{"StringForm", "[", 
           RowBox[{"\"\<DoubleDistr_``_``-``_``.m\>\"", ",", 
            RowBox[{"Sequence", "@@", 
             RowBox[{"{", 
              RowBox[{"fipn", ",", "proc", ",", "Nucleus", ",", "Facility"}], 
              "}"}]}]}], "]"}]}]}], "}"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"filename2", "=", 
      RowBox[{"FileNameJoin", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"NotebookDirectory", "[", "]"}], ",", 
         "\"\<phenomenology/\>\"", ",", 
         RowBox[{"LLPfolder", "[", "fipn", "]"}], ",", 
         "\"\<Production probabilities\>\"", ",", 
         RowBox[{"ToString", "@", 
          RowBox[{"StringForm", "[", 
           RowBox[{"\"\<Pprod_``_``-``_``.m\>\"", ",", 
            RowBox[{"Sequence", "@@", 
             RowBox[{"{", 
              RowBox[{"fipn", ",", "proc", ",", "Nucleus", ",", "Facility"}], 
              "}"}]}]}], "]"}]}]}], "}"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Export", "[", 
      RowBox[{"filename1", ",", 
       RowBox[{
        RowBox[{"Flatten", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"ma", ",", "\[Theta]a", ",", "Ea", ",", 
              RowBox[{"DoubleDistrALP", "[", 
               RowBox[{"ma", ",", "\[Theta]a", ",", "Ea"}], "]"}]}], "}"}], 
            ",", 
            RowBox[{"{", 
             RowBox[{"ma", ",", "mlist"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"\[Theta]a", ",", "\[Theta]list"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"Ea", ",", "Elist"}], "}"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], "]"}], "//", 
        "Developer`ToPackedArray"}], ",", "\"\<MX\>\""}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Export", "[", 
      RowBox[{"filename2", ",", 
       RowBox[{"NormalizationALP", "[", "ma", "]"}], ",", "\"\<MX\>\""}], 
      "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.913478598526929*^9, 3.9134786088906193`*^9}, {
   3.913479045210778*^9, 3.9134790484558215`*^9}, {3.913479859567234*^9, 
   3.9134798610344944`*^9}, {3.91362896698688*^9, 3.913629003229072*^9}, {
   3.913629090443605*^9, 3.9136290914999332`*^9}, 3.913883326179581*^9, {
   3.913883380744624*^9, 3.913883402165001*^9}, {3.913887808984487*^9, 
   3.913887814403036*^9}, 3.915082852511978*^9, {3.915438817629887*^9, 
   3.915438817634068*^9}},
 CellTags->"Evaluation",
 CellLabel->
  "In[1168]:=",ExpressionUUID->"1b07e271-afb1-4157-a0b3-9451e6471051"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Production via photon fusion: PDF and normalization", "Chapter",
 CellChangeTimes->{{3.913478380065708*^9, 3.913478401203979*^9}, {
  3.913627395484844*^9, 3.913627396913028*^9}},
 CellTags->
  "Evaluation",ExpressionUUID->"af9d6ef0-a707-4b09-bb51-ae1bcb296b9c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"TabulatedDistrFusion", "[", 
    RowBox[{
    "m_", ",", "Facility_", ",", "Nucleus_", ",", "\[Theta]list_", ",", 
     "Elist_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"(*", 
       RowBox[{"norm", ",", "tabulateddistr", ",", "distr"}], "*)"}], 
      RowBox[{"logemin", ",", "logemax", ",", "logthmin", ",", "logthmax"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"tabulateddistr", "=", 
       RowBox[{"Flatten", "[", 
        RowBox[{
         RowBox[{"ParallelTable", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"m", ",", "th", ",", "e", ",", 
             RowBox[{"Max", "[", 
              RowBox[{
               RowBox[{"Quiet", "[", 
                RowBox[{"d2Pd\[Theta]adEaFusion1", "[", 
                 RowBox[{
                 "m", ",", "th", ",", "e", ",", "Facility", ",", "Nucleus"}], 
                 "]"}], "]"}], ",", 
               SuperscriptBox["10", 
                RowBox[{"-", "90."}]]}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"th", ",", "\[Theta]list"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"e", ",", "Elist"}], "}"}]}], "]"}], ",", "1"}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"distr", "[", 
        RowBox[{"logth_", ",", "loge_"}], "]"}], "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Interpolation", "[", 
          RowBox[{
           RowBox[{"Log", "[", 
            RowBox[{"tabulateddistr", "[", 
             RowBox[{"[", 
              RowBox[{"All", ",", 
               RowBox[{"{", 
                RowBox[{"2", ",", "3", ",", "4"}], "}"}]}], "]"}], "]"}], 
            "]"}], ",", 
           RowBox[{"InterpolationOrder", "->", "1"}]}], "]"}], "[", 
         RowBox[{"logth", ",", "loge"}], "]"}], "//", "Exp"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"logthmin", ",", "logthmax", ",", "logemin", ",", "logemax"}],
         "}"}], "=", 
       RowBox[{"Log", "[", 
        RowBox[{"Flatten", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"MinMax", "[", 
            RowBox[{"tabulateddistr", "[", 
             RowBox[{"[", 
              RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}], ",", 
           RowBox[{"MinMax", "[", 
            RowBox[{"tabulateddistr", "[", 
             RowBox[{"[", 
              RowBox[{"All", ",", "3"}], "]"}], "]"}], "]"}]}], "}"}], "]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"norm", "=", 
       RowBox[{"Quiet", "[", 
        RowBox[{"NIntegrate", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"distr", "[", 
            RowBox[{"logth", ",", "loge"}], "]"}], 
           RowBox[{"Exp", "[", 
            RowBox[{"logth", "+", "loge"}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"logth", ",", "logthmin", ",", "logthmax"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"loge", ",", 
            RowBox[{"Max", "[", 
             RowBox[{
              RowBox[{"Log", "[", "m", "]"}], ",", "logemin"}], "]"}], ",", 
            "logemax"}], "}"}], ",", 
          RowBox[{
          "Method", "->", "\"\<InterpolationPointsSubdivision\>\""}]}], "]"}],
         "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            RowBox[{"#", "[", 
             RowBox[{"[", "2", "]"}], "]"}], ",", 
            RowBox[{"#", "[", 
             RowBox[{"[", "3", "]"}], "]"}], ",", 
            FractionBox[
             RowBox[{"#", "[", 
              RowBox[{"[", "4", "]"}], "]"}], "norm"]}], "}"}], "&"}], "/@", 
         "tabulateddistr"}], ",", 
        RowBox[{"{", 
         RowBox[{"m", ",", "norm"}], "}"}]}], "}"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BlockTabulatedPDFsFromFusion", "[", 
   RowBox[{
   "Facility_", ",", "Nucleus_", ",", "\[Theta]list_", ",", "Elist_"}], "]"}],
   ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "\[Theta]min", ",", "\[Theta]max", ",", "mlist", ",", "filename1", ",", 
      "filename2", ",", "fipn", ",", "procn"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"fipn", "=", "\"\<ALP-photon\>\""}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"procn", "=", "\"\<Photon-fusion\>\""}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"mlist", "=", 
      RowBox[{"MassList", "[", 
       RowBox[{"fipn", ",", "procn", ",", "Facility"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"tabphoton", "=", 
      RowBox[{"Monitor", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"TabulatedDistrFusion", "[", 
           RowBox[{
            RowBox[{"mlist", "[", 
             RowBox[{"[", "t", "]"}], "]"}], ",", "Facility", ",", "Nucleus", 
            ",", "\[Theta]list", ",", "Elist"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"t", ",", "1", ",", 
            RowBox[{"Length", "[", "mlist", "]"}], ",", "1"}], "}"}]}], "]"}],
         ",", 
        RowBox[{"Row", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"ProgressIndicator", "[", 
             RowBox[{"t", ",", 
              RowBox[{"{", 
               RowBox[{"1", ",", 
                RowBox[{"Length", "[", "mlist", "]"}]}], "}"}]}], "]"}], ",", 
            "\"\< \!\(\*SubscriptBox[\(m\), \(LLP\)]\) = \>\"", ",", 
            RowBox[{"mlist", "[", 
             RowBox[{"[", "t", "]"}], "]"}], ",", "\"\< GeV\>\"", ",", 
            "\"\< (\>\"", ",", "t", ",", "\"\</\>\"", ",", 
            RowBox[{"Length", "[", "mlist", "]"}], ",", "\"\<)\>\""}], "}"}], 
          ",", "\"\< \>\""}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{
        RowBox[{"Approximation", ":", " ", 
         SubscriptBox["E", "a"]}], " ", "=", " ", 
        SubscriptBox["E", "\[Gamma]"]}], ",", " ", 
       RowBox[{
        SubscriptBox["\[Theta]", "a"], " ", "=", " ", 
        SubscriptBox["\[Theta]", "\[Gamma]"]}]}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ProbFusion", "[", "ma_", "]"}], "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Interpolation", "[", 
         RowBox[{
          RowBox[{"Log", "[", 
           RowBox[{"tabphoton", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}], ",", 
          RowBox[{"InterpolationOrder", "->", "1"}]}], "]"}], "[", 
        RowBox[{"Log", "[", "ma", "]"}], "]"}], "//", "Exp"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"DoubleDistrDataTemp", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Join", "[", "##", "]"}], "&"}], "@@", 
       RowBox[{"tabphoton", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "1"}], "]"}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"filename1", "=", 
      RowBox[{"FileNameJoin", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"NotebookDirectory", "[", "]"}], ",", 
         "\"\<spectra/New physics particles spectra\>\"", ",", 
         RowBox[{"LLPfolder", "[", "fipn", "]"}], ",", 
         RowBox[{"ToString", "@", 
          RowBox[{"StringForm", "[", 
           RowBox[{"\"\<DoubleDistr_``_``-``_``.m\>\"", ",", 
            RowBox[{"Sequence", "@@", 
             RowBox[{"{", 
              RowBox[{"fipn", ",", "procn", ",", "Nucleus", ",", "Facility"}],
               "}"}]}]}], "]"}]}]}], "}"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"filename2", "=", 
      RowBox[{"FileNameJoin", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"NotebookDirectory", "[", "]"}], ",", 
         "\"\<phenomenology/\>\"", ",", 
         RowBox[{"LLPfolder", "[", "fipn", "]"}], ",", 
         "\"\<Production probabilities\>\"", ",", 
         RowBox[{"ToString", "@", 
          RowBox[{"StringForm", "[", 
           RowBox[{"\"\<Pprod_``_``-``_``.m\>\"", ",", 
            RowBox[{"Sequence", "@@", 
             RowBox[{"{", 
              RowBox[{"fipn", ",", "procn", ",", "Nucleus", ",", "Facility"}],
               "}"}]}]}], "]"}]}]}], "}"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Export", "[", 
      RowBox[{"filename1", ",", 
       RowBox[{"DoubleDistrDataTemp", "//", "Developer`ToPackedArray"}], ",", 
       "\"\<MX\>\""}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Export", "[", 
      RowBox[{"filename2", ",", 
       RowBox[{"ProbFusion", "[", "ma", "]"}], ",", "\"\<MX\>\""}], "]"}], 
     ";"}]}], "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.913627425572337*^9, 3.913627427006501*^9}, 
   3.913627465032012*^9, {3.913627509276449*^9, 3.9136278742102737`*^9}, {
   3.9136279246778717`*^9, 3.913628135432181*^9}, {3.913628232624867*^9, 
   3.913628281699194*^9}, {3.913628363496106*^9, 3.913628367727805*^9}, {
   3.913628420175748*^9, 3.913628457803237*^9}, {3.913629020516521*^9, 
   3.9136290251922073`*^9}, {3.913629580494795*^9, 3.913629585016095*^9}, {
   3.9136297750593214`*^9, 3.913629778222994*^9}, 3.913655122894487*^9, {
   3.913712412805249*^9, 3.9137124446999893`*^9}, 3.9137128438911424`*^9, 
   3.9138833261850767`*^9, {3.913883412726009*^9, 3.913883463983104*^9}, 
   3.913887831994038*^9, 3.915082868680538*^9, {3.915438817648608*^9, 
   3.915438817655858*^9}, {3.9168310963628426`*^9, 3.9168311002503395`*^9}, {
   3.916831572415639*^9, 3.916831687536377*^9}, 3.928649513119931*^9, {
   3.928650754837075*^9, 3.928650777490618*^9}, {3.928651788576705*^9, 
   3.928651807576391*^9}, {3.928651924333969*^9, 3.928651927339662*^9}},
 CellTags->"Evaluation",
 CellLabel->
  "In[1169]:=",ExpressionUUID->"7101a228-73dd-406a-8181-affd5068b625"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Choose LLP and run", "Title",
 CellChangeTimes->{{3.887784015564708*^9, 3.8877840343466644`*^9}, {
   3.887791431291815*^9, 3.8877914390326653`*^9}, {3.893298575660539*^9, 
   3.8932985763148823`*^9}, 3.9134743097921*^9, {3.913714798339867*^9, 
   3.913714809434396*^9}, {3.913714865395189*^9, 3.913714880073966*^9}, 
   3.915438817662835*^9},
 CellTags->
  "Evaluation",ExpressionUUID->"a71a0f7a-e822-4051-8bff-ebc5c2c75f52"],

Cell[CellGroupData[{

Cell["Some definitions", "Chapter",
 CellChangeTimes->{{3.893865496194309*^9, 3.893865513654553*^9}, {
  3.9140499380670767`*^9, 3.914049939916734*^9}},
 CellTags->
  "Evaluation",ExpressionUUID->"775189f9-9eab-4b5c-a388-a430aebaaeea"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"infoDialog", "[", "phrase_", "]"}], ":=", 
   RowBox[{"DialogInput", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"choice", "=", "\"\<\>\""}], "}"}], ",", 
     RowBox[{"Column", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"TextCell", "[", "phrase", "]"}], ",", 
        RowBox[{"Button", "[", 
         RowBox[{"\"\<Proceed\>\"", ",", 
          RowBox[{"DialogReturn", "[", "choice", "]"}]}], "]"}]}], "}"}], 
      "]"}]}], "]"}]}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "The", " ", "code", " ", "which", " ", "evaluates", " ", "the", " ", 
    "sections", " ", "whose", " ", "tags", " ", "are", " ", "included", " ", 
    "in", " ", "the", " ", "list", " ", "listproduction"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"headstypes", "=", 
   RowBox[{"{", 
    RowBox[{
    "\"\<Title\>\"", ",", "\"\<Chapter\>\"", ",", "\"\<Section\>\"", ",", 
     "\"\<Subsection\>\"", ",", "\"\<Subsubsection\>\""}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cells", "=", 
   RowBox[{"Association", "[", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"type", "->", 
       RowBox[{"Select", "[", 
        RowBox[{
         RowBox[{"Cells", "[", "]"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"CurrentValue", "[", 
            RowBox[{"#", ",", "\"\<CellStyle\>\""}], "]"}], "==", 
           RowBox[{"{", "type", "}"}]}], "&"}]}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"type", ",", "headstypes"}], "}"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"inp", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"#", "->", 
       RowBox[{"First", "@", 
        RowBox[{"NotebookRead", "[", "#", "]"}]}]}], ")"}], "&"}], "/@", 
    RowBox[{"cells", "[", "\"\<Section\>\"", "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SectionEvaluator", "[", "section_", "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"SectionCell", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Select", "[", 
         RowBox[{"inp", ",", 
          RowBox[{
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "==", "section"}], "&"}]}], 
         "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"(", 
         RowBox[{"SectionCell", "=!=", "$Canceled"}], ")"}]}], ",", 
       RowBox[{"infoDialog", "[", 
        RowBox[{"Column", "[", 
         RowBox[{"{", 
          RowBox[{
          "\"\<There is no section/section name associated with the given LLP \
and production channel: \>\"", ",", "section", ",", "\"\<Add them\>\""}], 
          "}"}], "]"}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"SectionCell", "=!=", "$Canceled"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"SelectionMove", "[", 
            RowBox[{"SectionCell", ",", "All", ",", "CellGroup"}], "]"}], ";",
            "\[IndentingNewLine]", 
           RowBox[{"SelectionEvaluate", "[", 
            RowBox[{"InputNotebook", "[", "]"}], "]"}]}]}], "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BlockProductionComputation", "[", 
    RowBox[{"LLP_", ",", "prodlist_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "seclist", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"seclist", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"LLP", "<>", "\"\<_\>\"", "<>", "#"}], "&"}], "/@", 
        "prodlist"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{"SectionEvaluator", "[", "sec", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"sec", ",", "seclist"}], "}"}]}], "]"}]}]}], "]"}]}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Pattern", " ", "for", " ", "filename", " ", "of", " ", "the", " ", 
    "tabulated", " ", "distribution"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"filenameToExport", "[", 
    RowBox[{"LLP_", ",", "mode_", ",", "facility_"}], "]"}], ":=", 
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"NotebookDirectory", "[", "]"}], ",", 
      "\"\<spectra/New physics particles spectra\>\"", ",", 
      RowBox[{"LLPfolder", "[", "LLP", "]"}], ",", 
      RowBox[{"ToString", "@", 
       RowBox[{"StringForm", "[", 
        RowBox[{"\"\<DoubleDistr_``_``_``.m\>\"", ",", 
         RowBox[{"Sequence", "@@", 
          RowBox[{"{", 
           RowBox[{"LLP", ",", "mode", ",", "facility"}], "}"}]}]}], 
        "]"}]}]}], "}"}], "]"}]}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "This", " ", "block", " ", "produces", " ", "the", " ", "table", " ", 
     "m"}], ",", "\[Theta]", ",", "E", ",", 
    RowBox[{"distr", " ", "for", " ", "m", " ", "belonging", " ", "to", " ", 
     RowBox[{"mlist", ".", " ", "function"}], " ", "is", " ", 
     RowBox[{"BlockTabulatedPDFsFromDecays", "/", "Mixing"}], " ", "where", 
     " ", "all", " ", "the", " ", "arguments", " ", "except", " ", "for", " ",
      "mLLP", " ", "are", " ", "fixed"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"tabulatedblock", "[", 
    RowBox[{"function_", ",", "mlist_", ",", "filename_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"tabb", "=", 
       RowBox[{"Monitor", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"function", "[", 
            RowBox[{"mlist", "[", 
             RowBox[{"[", "t", "]"}], "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"t", ",", "1", ",", 
             RowBox[{"Length", "[", "mlist", "]"}], ",", "1"}], "}"}]}], 
          "]"}], ",", 
         RowBox[{"Row", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"ProgressIndicator", "[", 
              RowBox[{"t", ",", 
               RowBox[{"{", 
                RowBox[{"1", ",", 
                 RowBox[{"Length", "[", "mlist", "]"}]}], "}"}]}], "]"}], 
             ",", "\"\<i = \>\"", ",", "t", ",", "\"\</\>\"", ",", 
             RowBox[{"Length", "[", "mlist", "]"}], ",", "\"\<, m = \>\"", 
             ",", 
             RowBox[{"mlist", "[", 
              RowBox[{"[", "t", "]"}], "]"}], ",", "\"\< GeV\>\""}], "}"}], 
           ",", "\"\< \>\""}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"tabb", "=", 
       RowBox[{
        RowBox[{"Flatten", "[", 
         RowBox[{"tabb", ",", "1"}], "]"}], "//", 
        "Developer`ToPackedArray"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Export", "[", 
       RowBox[{"filename", ",", "tabb", ",", "\"\<MX\>\""}], "]"}], ";"}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "List", " ", "of", " ", "the", " ", "directories", " ", "associated", " ", 
    "with", " ", "the", " ", "given", " ", "LLP"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"StringContainsQ", "[", 
         RowBox[{"LLP", ",", "\"\<HNL\>\""}], "]"}]}], ",", 
       RowBox[{
        RowBox[{"LLPfolder", "[", "LLP", "]"}], "=", "LLP"}], ",", 
       RowBox[{
        RowBox[{"LLPfolder", "[", "LLP", "]"}], "=", "\"\<HNL\>\""}]}], "]"}],
      ";"}], "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{"LLP", ",", "LLPlist"}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"directories", "=", 
   RowBox[{
    RowBox[{"Join", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"FileNameJoin", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"NotebookDirectory", "[", "]"}], ",", "#"}], "}"}], "]"}], 
        "&"}], "/@", 
       RowBox[{"{", 
        RowBox[{
        "\"\<spectra\>\"", ",", 
         "\"\<spectra/New physics particles spectra\>\""}], "}"}]}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"FileNameJoin", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"NotebookDirectory", "[", "]"}], ",", 
           "\"\<spectra/New physics particles spectra\>\"", ",", 
           RowBox[{"LLPfolder", "[", "#", "]"}]}], "}"}], "]"}], "&"}], "/@", 
       
       RowBox[{
        RowBox[{"Keys", "[", 
         RowBox[{"DownValues", "@", "LLPfolder"}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "1", ",", "1"}], "]"}], "]"}]}]}], "]"}], "//", 
    "DeleteDuplicates"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"!", 
      RowBox[{"DirectoryQ", "[", "dir", "]"}]}], ",", 
     RowBox[{"CreateDirectory", "[", "dir", "]"}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"dir", ",", "directories"}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.893865537217741*^9, 3.8938655376639433`*^9}, {
   3.894122299733735*^9, 3.8941223286113205`*^9}, {3.894122366800346*^9, 
   3.8941223962681375`*^9}, {3.897238812169268*^9, 3.897239079920702*^9}, {
   3.9025632810894732`*^9, 3.902563283315619*^9}, 3.903791345150028*^9, {
   3.910412636912963*^9, 3.910412703661873*^9}, {3.911724665489585*^9, 
   3.9117246655986705`*^9}, {3.913200579318905*^9, 3.913200625965861*^9}, {
   3.913287016225128*^9, 3.913287150247571*^9}, {3.913373723744917*^9, 
   3.913373737291639*^9}, 3.9133951039371195`*^9, {3.913395706796802*^9, 
   3.9133957249272814`*^9}, {3.913438638644628*^9, 3.9134386432634664`*^9}, {
   3.9134387165942554`*^9, 3.913438733803418*^9}, {3.913439158064307*^9, 
   3.913439160205146*^9}, 3.9134472993271427`*^9, 3.913448405836543*^9, {
   3.9134484360656986`*^9, 3.9134484778561773`*^9}, {3.9134601876556797`*^9, 
   3.913460226175341*^9}, {3.913474027385814*^9, 3.913474030584878*^9}, {
   3.913478855934716*^9, 3.9134788565203648`*^9}, {3.913707828807783*^9, 
   3.9137078756180644`*^9}, {3.9137082801239147`*^9, 
   3.9137082802810836`*^9}, {3.913709326965829*^9, 3.913709327483696*^9}, {
   3.91371008970698*^9, 3.913710279837864*^9}, {3.9139723978764243`*^9, 
   3.913972402609686*^9}, {3.913972489100063*^9, 3.913972555353795*^9}, {
   3.9139726070152063`*^9, 3.913972662839348*^9}, 3.913972805078136*^9, {
   3.915438817670823*^9, 3.915438817744719*^9}},
 CellTags->"Evaluation",
 CellLabel->
  "In[1171]:=",ExpressionUUID->"bcd78e34-e5dd-47ca-ac7c-801c6238170a"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Selecting LLP, facility, and production channels", "Chapter",
 CellChangeTimes->{{3.893861633234589*^9, 3.8938616430817575`*^9}, 
   3.9154388177517138`*^9},
 CellTags->
  "Evaluation",ExpressionUUID->"ca953807-2e9a-48d4-a863-7393320df9ea"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"NotebookDirectory", "[", "]"}], "//", "ParentDirectory"}], ";"}],
   "\[IndentingNewLine]", 
  RowBox[{"(*", "Facilities", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", "\"\<List of implemented LLPs:\>\"", 
  "]"}], "\[IndentingNewLine]", "LLPlist", "\[IndentingNewLine]", 
 RowBox[{"Print", "[", "\"\<Selected facility:\>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dropdownDialog", "[", 
   RowBox[{"list_", ",", "phrase_"}], "]"}], ":=", 
  RowBox[{"DialogInput", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"choice", "=", "\"\<\>\""}], "}"}], ",", 
    RowBox[{"Column", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"TextCell", "[", "phrase", "]"}], ",", 
       RowBox[{"PopupMenu", "[", 
        RowBox[{
         RowBox[{"Dynamic", "[", "choice", "]"}], ",", "list"}], "]"}], ",", 
       RowBox[{"Button", "[", 
        RowBox[{"\"\<OK\>\"", ",", 
         RowBox[{"DialogReturn", "[", "choice", "]"}]}], "]"}]}], "}"}], 
     "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"SelectedFacility", "=", 
  RowBox[{"dropdownDialog", "[", 
   RowBox[{"FacilitiesList", ",", "\"\<Select the facility:\>\""}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", "\"\<Selected LLP:\>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"LLPlistFacility", "=", 
   RowBox[{"Select", "[", 
    RowBox[{"LLPlistEffective", ",", 
     RowBox[{
      RowBox[{
       RowBox[{"Length", "[", 
        RowBox[{"ProcessesListFacility", "[", 
         RowBox[{"#", ",", "SelectedFacility"}], "]"}], "]"}], "!=", "0"}], 
      "&"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"SelectedLLP", "=", 
  RowBox[{"dropdownDialog", "[", 
   RowBox[{"LLPlistFacility", ",", "\"\<Select the LLP:\>\""}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", "\"\<Implemented production channels:\>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"listproductionall", "=", 
   RowBox[{"ProcessesListFacility", "[", 
    RowBox[{"SelectedLLP", ",", "SelectedFacility"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"listproductionall", "//", "TableForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"selectionDialog", "[", "list_", "]"}], ":=", 
  RowBox[{"DialogInput", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"choice", "=", 
      RowBox[{"{", "}"}]}], "}"}], ",", 
    RowBox[{"Column", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Row", "[", 
        RowBox[{
        "{", "\"\<Select the production channels by clicking on them:\>\"", 
         "}"}], "]"}], ",", 
       RowBox[{"TogglerBar", "[", 
        RowBox[{
         RowBox[{"Dynamic", "[", "choice", "]"}], ",", "list", ",", 
         RowBox[{"Appearance", "->", "\"\<Vertical\>\""}]}], "]"}], ",", 
       RowBox[{"Button", "[", 
        RowBox[{"\"\<OK\>\"", ",", 
         RowBox[{"DialogReturn", "[", "choice", "]"}]}], "]"}]}], "}"}], 
     "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"listproductionForComputation", "=", 
   RowBox[{"selectionDialog", "[", 
    RowBox[{"Join", "[", 
     RowBox[{
      RowBox[{"{", "\"\<All channels\>\"", "}"}], ",", "listproductionall"}], 
     "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"listproductionForComputation", "==", 
     RowBox[{"{", "\"\<All channels\>\"", "}"}]}], ",", 
    RowBox[{"listproductionForComputation", "=", "listproductionall"}]}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  "\"\<Production channels selected for the computation:\>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"listproductionForComputation", "//", 
  "TableForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"BlockProductionComputation", "[", "listproduction_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "facility", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"nb", "=", 
        RowBox[{"EvaluationNotebook", "[", "]"}]}], ";", "\n", 
       RowBox[{"Do", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"NotebookFind", "[", 
           RowBox[{"nb", ",", 
            RowBox[{"listproduction", "[", 
             RowBox[{"[", "index", "]"}], "]"}], ",", "All", ",", 
            "CellTags"}], "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"SelectionEvaluate", "[", "nb", "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"index", ",", "1", ",", 
           RowBox[{"Length", "[", "listproduction", "]"}], ",", "1"}], 
          "}"}]}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
   "*)"}]}]}], "Input",
 CellChangeTimes->{{3.887784092651166*^9, 3.8877841265212803`*^9}, {
   3.8877841954864836`*^9, 3.887784246654004*^9}, {3.887791445495814*^9, 
   3.887791465945515*^9}, {3.887794871982456*^9, 3.887794882280743*^9}, {
   3.887859885983081*^9, 3.887859886289671*^9}, {3.887860095194285*^9, 
   3.887860101822935*^9}, {3.887873202927859*^9, 3.887873236647534*^9}, {
   3.888939762018503*^9, 3.888939762578591*^9}, {3.889085520153724*^9, 
   3.889085520818149*^9}, {3.8891512099157887`*^9, 3.889151230031513*^9}, {
   3.892191434964569*^9, 3.8921915091667824`*^9}, {3.893233932931842*^9, 
   3.893234026065314*^9}, 3.893265857923341*^9, 3.89352067331574*^9, 
   3.893521036094074*^9, 3.893859828533881*^9, {3.893860392838662*^9, 
   3.893860404633194*^9}, {3.8938604620730333`*^9, 3.893860499232582*^9}, {
   3.8938606855284767`*^9, 3.893860702480075*^9}, {3.893860772050495*^9, 
   3.893860827648593*^9}, 3.8938608738413453`*^9, {3.893860918358939*^9, 
   3.8938609434521427`*^9}, {3.893860984876114*^9, 3.893860990788611*^9}, {
   3.893865539813223*^9, 3.893865540032844*^9}, {3.89386917070556*^9, 
   3.893869334092266*^9}, {3.8941223738505487`*^9, 3.894122404397846*^9}, {
   3.904379678571033*^9, 3.9043796953410316`*^9}, {3.910412687902003*^9, 
   3.910412742700834*^9}, {3.910414936979153*^9, 3.9104149391156273`*^9}, {
   3.9131840441989946`*^9, 3.913184045741905*^9}, {3.913261903866212*^9, 
   3.913261905024354*^9}, {3.913439186443252*^9, 3.913439277784563*^9}, {
   3.913439425364357*^9, 3.9134394878867207`*^9}, {3.9134407599526505`*^9, 
   3.913440765697504*^9}, 3.913440977963427*^9, {3.9134470738768973`*^9, 
   3.913447104920935*^9}, {3.9134471444349084`*^9, 3.913447282627247*^9}, {
   3.9134486622967525`*^9, 3.913448668880019*^9}, {3.915438817784819*^9, 
   3.915438817817238*^9}},
 CellTags->"Evaluation",
 CellLabel->
  "In[1182]:=",ExpressionUUID->"adc76db4-8a20-4f83-b656-3220b99a5305"],

Cell[BoxData[
 FormBox["\<\"List of implemented LLPs:\"\>", TraditionalForm]], "Print",
 CellChangeTimes->{3.930211549416668*^9, 3.930822781528912*^9},
 CellTags->"Evaluation",
 CellLabel->
  "Durante la evaluaci\[OAcute]n de \
In[1182]:=",ExpressionUUID->"6e7bf31a-e69c-4e2e-9534-1871757db46e"],

Cell[BoxData[
 FormBox[
  RowBox[{"{", 
   RowBox[{"\<\"ALP-fermion\"\>", ",", "\<\"ALP-gluon\"\>", 
    ",", "\<\"ALP-photon\"\>", ",", "\<\"B-3Le-Lmu+Ltau\"\>", 
    ",", "\<\"B-3Lmu\"\>", ",", "\<\"B-L\"\>", ",", "\<\"B-Le-3Lmu+Ltau\"\>", 
    ",", "\<\"DP\"\>", ",", "\<\"HNL-mixing-e\"\>", 
    ",", "\<\"HNL-mixing-mu\"\>", ",", "\<\"HNL-mixing-tau\"\>", 
    ",", "\<\"MCP\"\>", ",", "\<\"Scalar\"\>"}], "}"}], 
  TraditionalForm]], "Output",
 CellChangeTimes->{3.930211549472019*^9, 3.930822781531464*^9},
 CellTags->"Evaluation",
 CellLabel->
  "Out[1184]=",ExpressionUUID->"8cd6410d-8300-4302-8636-a9a33024affc"],

Cell[BoxData[
 FormBox["\<\"Selected facility:\"\>", TraditionalForm]], "Print",
 CellChangeTimes->{3.930211549416668*^9, 3.930822781533839*^9},
 CellTags->"Evaluation",
 CellLabel->
  "Durante la evaluaci\[OAcute]n de \
In[1182]:=",ExpressionUUID->"53590713-f496-4553-8f74-05fe709b709c"],

Cell[BoxData[
 FormBox["$Canceled", TraditionalForm]], "Output",
 CellChangeTimes->{3.930211549472019*^9, 3.930822797793179*^9},
 CellTags->"Evaluation",
 CellLabel->
  "Out[1187]=",ExpressionUUID->"4aa8004d-d70e-4a85-b40e-d546b3e7f202"],

Cell[BoxData[
 FormBox["\<\"Selected LLP:\"\>", TraditionalForm]], "Print",
 CellChangeTimes->{3.930211549416668*^9, 3.930822797797563*^9},
 CellTags->"Evaluation",
 CellLabel->
  "Durante la evaluaci\[OAcute]n de \
In[1182]:=",ExpressionUUID->"e49251f3-2352-466d-abf6-383b9cde7475"],

Cell[BoxData[
 FormBox["$Canceled", TraditionalForm]], "Output",
 CellChangeTimes->{3.930211549472019*^9, 3.930822799958829*^9},
 CellTags->"Evaluation",
 CellLabel->
  "Out[1190]=",ExpressionUUID->"55d0a94c-d0ca-4f5c-a6e4-4c70b3f05fc4"],

Cell[BoxData[
 FormBox["\<\"Implemented production channels:\"\>", 
  TraditionalForm]], "Print",
 CellChangeTimes->{3.930211549416668*^9, 3.930822799965537*^9},
 CellTags->"Evaluation",
 CellLabel->
  "Durante la evaluaci\[OAcute]n de \
In[1182]:=",ExpressionUUID->"b5bf56b2-d115-4df1-b36d-a5596f4a8fd0"],

Cell[BoxData[
 FormBox[
  TagBox[
   RowBox[{"ProcessesListFacility", "(", 
    RowBox[{"$Canceled", ",", "$Canceled"}], ")"}],
   Function[BoxForm`e$, 
    TableForm[BoxForm`e$]]], TraditionalForm]], "Output",
 CellChangeTimes->{3.930211549472019*^9, 3.9308227999696817`*^9},
 CellTags->"Evaluation",
 CellLabel->
  "Out[1193]//TableForm=",ExpressionUUID->"565aebaf-e8e7-4d93-9f33-\
915210fd5fb5"],

Cell[BoxData[
 FormBox[
  TemplateBox[{
   "Join", "heads", 
    "\"Heads \\!\\(\\*FormBox[\\\"List\\\", TraditionalForm]\\) and \
\\!\\(\\*FormBox[\\\"ProcessesListFacility\\\", TraditionalForm]\\) at \
positions \\!\\(\\*FormBox[\\\"1\\\", TraditionalForm]\\) and \
\\!\\(\\*FormBox[\\\"2\\\", TraditionalForm]\\) are expected to be the \
same.\"", 2, 1195, 27, 29079336519732941073, "Local"},
   "MessageTemplate"], TraditionalForm]], "Message", "MSG",
 CellChangeTimes->{3.930822800019518*^9},
 CellTags->"Evaluation",
 CellLabel->
  "Durante la evaluaci\[OAcute]n de \
In[1182]:=",ExpressionUUID->"9f541da3-e618-41d1-a503-43e7c9a8c7df"],

Cell[BoxData[
 FormBox["\<\"Production channels selected for the computation:\"\>", 
  TraditionalForm]], "Print",
 CellChangeTimes->{3.930211549416668*^9, 3.930822802403226*^9},
 CellTags->"Evaluation",
 CellLabel->
  "Durante la evaluaci\[OAcute]n de \
In[1182]:=",ExpressionUUID->"ef999b29-d5e0-4d3e-968a-6d92945e2076"],

Cell[BoxData[
 FormBox[
  TagBox["$Canceled",
   Function[BoxForm`e$, 
    TableForm[BoxForm`e$]]], TraditionalForm]], "Output",
 CellChangeTimes->{3.930211549472019*^9, 3.930822802409643*^9},
 CellTags->"Evaluation",
 CellLabel->
  "Out[1198]//TableForm=",ExpressionUUID->"4fba07d8-df0b-4e08-9a71-\
0dec39a6e191"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Computing the distributions of LLPs", "Chapter",
 CellChangeTimes->{{3.887859893320729*^9, 3.8878599435964117`*^9}, 
   3.915438817835745*^9},
 CellTags->
  "Evaluation",ExpressionUUID->"1d42ed8a-55b1-48cd-be60-4ba46cd2ce8a"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Print", "[", "\"\<Number of simulated decays:\>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nsim", "=", 
   RowBox[{
    RowBox[{"DialogInput", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"br", "=", 
        SuperscriptBox["10", "6"]}], "}"}], ",", 
      RowBox[{"Column", "[", 
       RowBox[{"{", 
        RowBox[{
        "\"\<Enter the number of simulated decays (for decays only) in the \
form y*10^x. Reasonable values are ~\!\(\*SuperscriptBox[\(10\), \
\(6\)]\)-\!\(\*SuperscriptBox[\(10\), \(7\)]\)\>\"", ",", 
         RowBox[{"InputField", "[", 
          RowBox[{
           RowBox[{"Dynamic", "[", "br", "]"}], ",", "Expression"}], "]"}], 
         ",", 
         RowBox[{"Button", "[", 
          RowBox[{"\"\<Proceed\>\"", ",", 
           RowBox[{"DialogReturn", "[", "br", "]"}], ",", 
           RowBox[{"ImageSize", "\[Rule]", "Automatic"}]}], "]"}]}], "}"}], 
       "]"}]}], "]"}], "//", "IntegerPart"}]}], ";"}], "\[IndentingNewLine]", 

 RowBox[{
  RowBox[{"nsim", "=", 
   RowBox[{
    RowBox[{"Ceiling", "[", 
     RowBox[{"nsim", "-", "0.5"}], "]"}], "+", 
    RowBox[{"Mod", "[", 
     RowBox[{
      RowBox[{"Ceiling", "[", 
       RowBox[{"nsim", "-", "0.5"}], "]"}], ",", "2"}], "]"}]}]}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Empirical", " ", "estimate", " ", "of", " ", "the", " ", "angles", " ", 
    "below", " ", "which", " ", "the", " ", "distribution", " ", 
    SuperscriptBox["d", "2"], 
    RowBox[{"f", "/", 
     RowBox[{"d\[Theta]dE", " ", "~", " ", "sin"}]}], 
    RowBox[{"(", "\[Theta]", ")"}], 
    RowBox[{"df", "/", "dE"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"modes", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"ProcessesListFacility", "[", 
        RowBox[{"LLP", ",", "Facility"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"LLP", ",", "LLPlistEffective"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"Facility", ",", "FacilitiesList"}], "}"}]}], "]"}], "//", 
     "Flatten"}], "//", "DeleteDuplicates"}]}], ";"}], "\[IndentingNewLine]", 

 RowBox[{
  RowBox[{"Do", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"\[Theta]minExtrFacility", "[", 
       RowBox[{"\"\<ESS\>\"", ",", "mode"}], "]"}], "=", "0.1"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Theta]minExtrFacility", "[", 
       RowBox[{"\"\<Serpukhov\>\"", ",", "mode"}], "]"}], "=", 
      SuperscriptBox["10", 
       RowBox[{"-", "1.3"}]]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Theta]minExtrFacility", "[", 
       RowBox[{"\"\<SPS\>\"", ",", "mode"}], "]"}], "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"StringContainsQ", "[", 
          RowBox[{"mode", ",", "\"\<Pi0\>\""}], "]"}], "||", 
         RowBox[{"StringContainsQ", "[", 
          RowBox[{"mode", ",", "\"\<Primakov\>\""}], "]"}], "||", 
         RowBox[{"StringContainsQ", "[", 
          RowBox[{"mode", ",", "\"\<Eta\>\""}], "]"}], "||", 
         RowBox[{"StringContainsQ", "[", 
          RowBox[{"mode", ",", "\"\<Rho0\>\""}], "]"}], "||", 
         RowBox[{"StringContainsQ", "[", 
          RowBox[{"mode", ",", "\"\<Omega\>\""}], "]"}]}], ",", 
        RowBox[{"0.5", "*", 
         SuperscriptBox["10", 
          RowBox[{"-", "3."}]]}], ",", 
        SuperscriptBox["10", 
         RowBox[{"-", "3."}]]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Theta]minExtrFacility", "[", 
       RowBox[{"\"\<FermilabBD\>\"", ",", "mode"}], "]"}], "=", 
      RowBox[{
       RowBox[{"\[Theta]minExtrFacility", "[", 
        RowBox[{"\"\<Serpukhov\>\"", ",", "mode"}], "]"}], "=", 
       SuperscriptBox["10", 
        RowBox[{"-", "3."}]]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Theta]minExtrFacility", "[", 
       RowBox[{"\"\<LHC\>\"", ",", "mode"}], "]"}], "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"StringContainsQ", "[", 
          RowBox[{"mode", ",", "\"\<Pi0\>\""}], "]"}], "||", 
         RowBox[{"StringContainsQ", "[", 
          RowBox[{"mode", ",", "\"\<Primakov\>\""}], "]"}], "||", 
         RowBox[{"StringContainsQ", "[", 
          RowBox[{"mode", ",", "\"\<Eta\>\""}], "]"}], "||", 
         RowBox[{"StringContainsQ", "[", 
          RowBox[{"mode", ",", "\"\<Rho0\>\""}], "]"}], "||", 
         RowBox[{"StringContainsQ", "[", 
          RowBox[{"mode", ",", "\"\<Omega\>\""}], "]"}], "||", 
         RowBox[{"StringContainsQ", "[", 
          RowBox[{"mode", ",", "\"\<EtaPr\>\""}], "]"}]}], ",", 
        SuperscriptBox["10", 
         RowBox[{"-", "4"}]], ",", 
        RowBox[{"0.5", "*", 
         SuperscriptBox["10", 
          RowBox[{"-", "3."}]]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Theta]minExtrFacility", "[", 
       RowBox[{"\"\<FCC-hh\>\"", ",", "mode"}], "]"}], "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"StringContainsQ", "[", 
          RowBox[{"mode", ",", "\"\<Pi0\>\""}], "]"}], "||", 
         RowBox[{"StringContainsQ", "[", 
          RowBox[{"mode", ",", "\"\<Primakov\>\""}], "]"}], "||", 
         RowBox[{"StringContainsQ", "[", 
          RowBox[{"mode", ",", "\"\<Eta\>\""}], "]"}], "||", 
         RowBox[{"StringContainsQ", "[", 
          RowBox[{"mode", ",", "\"\<Rho0\>\""}], "]"}], "||", 
         RowBox[{"StringContainsQ", "[", 
          RowBox[{"mode", ",", "\"\<Omega\>\""}], "]"}], "||", 
         RowBox[{"StringContainsQ", "[", 
          RowBox[{"mode", ",", "\"\<EtaPr\>\""}], "]"}]}], ",", 
        RowBox[{"0.7", "*", 
         SuperscriptBox["10", 
          RowBox[{"-", "4"}]]}], ",", 
        RowBox[{"2", "*", 
         SuperscriptBox["10", 
          RowBox[{"-", "4."}]]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Theta]minExtrFacility", "[", 
       RowBox[{"\"\<LHC_fixed_target\>\"", ",", "mode"}], "]"}], "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"StringContainsQ", "[", 
          RowBox[{"mode", ",", "\"\<Pi0\>\""}], "]"}], "||", 
         RowBox[{"StringContainsQ", "[", 
          RowBox[{"mode", ",", "\"\<Primakov\>\""}], "]"}], "||", 
         RowBox[{"StringContainsQ", "[", 
          RowBox[{"mode", ",", "\"\<Eta\>\""}], "]"}], "||", 
         RowBox[{"StringContainsQ", "[", 
          RowBox[{"mode", ",", "\"\<Rho0\>\""}], "]"}], "||", 
         RowBox[{"StringContainsQ", "[", 
          RowBox[{"mode", ",", "\"\<Omega\>\""}], "]"}]}], ",", 
        RowBox[{"0.5", "*", 
         SuperscriptBox["10", 
          RowBox[{"-", "3."}]]}], ",", 
        SuperscriptBox["10", 
         RowBox[{"-", "3."}]]}], "]"}]}], ";"}], "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{"mode", ",", "modes"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Launch", " ", "if", " ", "you", " ", "are", " ", "interested", " ", "in", 
    " ", "all", " ", "production", " ", "channels", " ", "implemented", " ", 
    "in", " ", "this", " ", "notebook", " ", "for", " ", "the", " ", "given", 
    " ", "LLP"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"BlockProductionComputation", "[", 
  RowBox[{"SelectedLLP", ",", "listproductionForComputation"}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.8878599136688776`*^9, 3.887859948661124*^9}, {
   3.887860071864422*^9, 3.887860085670662*^9}, {3.892016161222783*^9, 
   3.892016163547074*^9}, 3.893860736238044*^9, {3.8972935740206113`*^9, 
   3.897293574754801*^9}, {3.903792655319484*^9, 3.9037926558956356`*^9}, {
   3.904378168074625*^9, 3.90437817796526*^9}, 3.904378307584463*^9, {
   3.9134400578326015`*^9, 3.913440111723555*^9}, {3.9134401870075207`*^9, 
   3.913440269183227*^9}, {3.9134403452834125`*^9, 3.913440464231469*^9}, 
   3.913440500863364*^9, {3.913447322476786*^9, 3.91344734502505*^9}, 
   3.913448532187081*^9, {3.913709259019933*^9, 3.913709261717366*^9}, 
   3.913866186642615*^9, {3.914836062566773*^9, 3.914836080075364*^9}, {
   3.914911641473986*^9, 3.914911648575084*^9}, {3.915438817880509*^9, 
   3.91543881789577*^9}, {3.917502118204741*^9, 3.9175021661531677`*^9}, {
   3.917948182058846*^9, 3.9179482110920744`*^9}, {3.930990508271673*^9, 
   3.930990514693705*^9}},
 CellTags->
  "Evaluation",ExpressionUUID->"ad17ac27-c9b6-4baf-b3e5-aa882d324cbd"],

Cell[BoxData[
 FormBox["\<\"Number of simulated decays:\"\>", TraditionalForm]], "Print",
 CellChangeTimes->{3.930211643441173*^9, 3.930822802556875*^9},
 CellTags->"Evaluation",
 CellLabel->
  "Durante la evaluaci\[OAcute]n de \
In[1199]:=",ExpressionUUID->"1dd983ac-6005-4d26-a165-dfc2dbf6d315"],

Cell[BoxData[
 FormBox[
  RowBox[{
   TemplateBox[{
     TemplateBox[{
       RowBox[{
         RowBox[{"IntegerPart", "[", "$Canceled", "]"}], "-", "0.5`"}]}, 
      "Ceiling"], "2"},
    "Mod"], "+", 
   TemplateBox[{
     RowBox[{
       RowBox[{"IntegerPart", "[", "$Canceled", "]"}], "-", "0.5`"}]},
    "Ceiling"]}], TraditionalForm]], "Output",
 CellChangeTimes->{3.930211648800232*^9, 3.930822803818812*^9},
 CellTags->"Evaluation",
 CellLabel->
  "Out[1201]=",ExpressionUUID->"a2ac2716-799d-4ad0-8af1-c9fa409db540"],

Cell[BoxData[
 FormBox[
  TemplateBox[{
   "Do", "iterb", 
    "\"Iterator \\!\\(\\*FormBox[RowBox[{\\\"{\\\", RowBox[{\\\"sec\\\", \
\\\",\\\", \\\"seclist$248648\\\"}], \\\"}\\\"}], TraditionalForm]\\) does \
not have appropriate bounds.\"", 2, 1204, 28, 29079336519732941073, "Local"},
   "MessageTemplate"], TraditionalForm]], "Message", "MSG",
 CellChangeTimes->{3.9308228038635793`*^9},
 CellTags->"Evaluation",
 CellLabel->
  "Durante la evaluaci\[OAcute]n de \
In[1199]:=",ExpressionUUID->"276c5700-904f-4e4b-a1d6-a6ec74fbafee"],

Cell[BoxData[
 FormBox[
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{"SectionEvaluator", "(", "sec", ")"}], ",", 
    RowBox[{"{", 
     RowBox[{"sec", ",", "seclist$248648"}], "}"}]}], "]"}], 
  TraditionalForm]], "Output",
 CellChangeTimes->{3.930211648800232*^9, 3.9308228038744993`*^9},
 CellTags->"Evaluation",
 CellLabel->
  "Out[1204]=",ExpressionUUID->"26287bb7-b1ad-43c6-bde5-972e5fee30a7"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Actual computation of the distributions", "Title",
 CellChangeTimes->{{3.913278260231255*^9, 
  3.913278265623356*^9}},ExpressionUUID->"16dd71f7-218e-4adb-aca8-\
cb8402969238"],

Cell[CellGroupData[{

Cell["HNL", "Chapter",
 CellChangeTimes->{{3.913278278125745*^9, 3.913278278596824*^9}, 
   3.913971795016664*^9},ExpressionUUID->"d853beda-46cd-4cdb-b135-\
6600d1bc9809"],

Cell[CellGroupData[{

Cell["HNL_W", "Section",
 CellChangeTimes->{{3.913278288470327*^9, 3.913278297244123*^9}, {
  3.9134478150059166`*^9, 
  3.9134478161661773`*^9}},ExpressionUUID->"26118c4a-3748-4b3a-94d9-\
0f7a26888927"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"MemberQ", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "\"\<LHC\>\"", ",", "\"\<FCC-hh\>\"", ",", " ", 
         "\"\<LHC_fixed_target\>\""}], "}"}], ",", "SelectedFacility"}], 
      "]"}], "==", "True"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"proc", "=", "\"\<W\>\""}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "List", " ", "of", " ", "masses", " ", "for", " ", "which", " ", "the", 
       " ", "distribution", " ", "will", " ", "be", " ", "tabulated"}], 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"MassList", "[", 
          RowBox[{"\"\<HNL\>\"", ",", "proc", ",", "Facility"}], "]"}], "=", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "0.02", ",", "0.05", ",", "1", ",", "2", ",", "5", ",", "7", ",", 
            "10", ",", "15", ",", "20", ",", "25", ",", "30", ",", "35", ",", 
            "40", ",", "50", ",", "60", ",", "65", ",", "70", ",", "75", ",", 
            
            RowBox[{
             RowBox[{"mSM", "[", "\"\<W\>\"", "]"}], "-", 
             RowBox[{"mSM", "[", "\"\<e\>\"", "]"}], "-", "0.1"}]}], "}"}], "//",
           "N"}]}], ";"}], "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"Facility", ",", 
         RowBox[{"{", 
          RowBox[{
          "\"\<LHC\>\"", ",", "\"\<FCC-hh\>\"", ",", " ", 
           "\"\<LHC_fixed_target\>\""}], "}"}]}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"TabulatedPDF", "[", "mLLP_", "]"}], ":=", 
         RowBox[{"BlockTabulatedPDFsFromDecaysMass", "[", 
          RowBox[{
          "LLP", ",", "SelectedFacility", ",", "mLLP", ",", "proc", ",", 
           "nsim", ",", 
           RowBox[{"\[Theta]Nlist", "[", "SelectedFacility", "]"}], ",", 
           RowBox[{"ENlist", "[", "SelectedFacility", "]"}], ",", 
           RowBox[{"\[Theta]minExtrFacility", "[", 
            RowBox[{"SelectedFacility", ",", "proc"}], "]"}], ",", 
           "\"\<False\>\""}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"filename", "=", 
         RowBox[{"filenameToExport", "[", 
          RowBox[{"LLP", ",", "proc", ",", "SelectedFacility"}], "]"}]}], ";",
         "\[IndentingNewLine]", 
        RowBox[{"mlist", "=", 
         RowBox[{"MassList", "[", 
          RowBox[{"\"\<HNL\>\"", ",", "proc", ",", "SelectedFacility"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"tabulatedblock", "[", 
         RowBox[{"TabulatedPDF", ",", "mlist", ",", "filename"}], "]"}]}], 
       "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"LLP", ",", "ListHNLs"}], "}"}]}], "\[IndentingNewLine]", 
      "]"}]}]}], "\[IndentingNewLine]", "]"}], "//", 
  "AbsoluteTiming"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"{", 
   RowBox[{"proc", ",", "mlist"}], "}"}], "//", "Clear"}]}], "Input",
 CellChangeTimes->{{3.913278674938585*^9, 3.913278698258821*^9}, {
   3.913278759129886*^9, 3.913278950101345*^9}, {3.913285546188745*^9, 
   3.913285546612489*^9}, {3.9132855805610156`*^9, 3.913285651956158*^9}, {
   3.913286213756109*^9, 3.913286235509224*^9}, 3.913286311154421*^9, {
   3.9132867162986393`*^9, 3.91328682119934*^9}, {3.913286856221624*^9, 
   3.913286928994157*^9}, {3.913287210457896*^9, 3.9132872524540296`*^9}, {
   3.913287336473469*^9, 3.913287346876382*^9}, {3.913287630587763*^9, 
   3.913287633674054*^9}, 3.913289114899906*^9, {3.913439760454449*^9, 
   3.913439834023179*^9}, {3.9134398658535633`*^9, 3.913439878313297*^9}, {
   3.913440523109484*^9, 3.913440523872667*^9}, {3.913447817876144*^9, 
   3.913447865172559*^9}, 3.915083933779237*^9, {3.9154388179068775`*^9, 
   3.9154388179196587`*^9}, 3.9157846050952168`*^9, {3.916987925801975*^9, 
   3.9169879465535107`*^9}, {3.930990528623534*^9, 
   3.930990543103201*^9}},ExpressionUUID->"16f4dcfe-c8a3-4935-8eca-\
059c13300749"]
}, Open  ]],

Cell[CellGroupData[{

Cell["HNL_B", "Section",
 CellChangeTimes->{{3.913278288470327*^9, 3.9132782893333178`*^9}, {
  3.913447810674886*^9, 
  3.913447812426114*^9}},ExpressionUUID->"bf39957e-fd62-43f4-b298-\
e12ec728b564"],

Cell[BoxData[
 RowBox[{"Module", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"LLPn", ",", "LLP", ",", "mlist", ",", "proc"}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"LLPn", "=", "\"\<HNL\>\""}], ";", "\[IndentingNewLine]", 
    RowBox[{"proc", "=", "\"\<B\>\""}], ";", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
     "List", " ", "of", " ", "masses", " ", "for", " ", "which", " ", "the", 
      " ", "distribution", " ", "will", " ", "be", " ", "tabulated"}], "*)"}],
     "\[IndentingNewLine]", 
    RowBox[{"Do", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"MassList", "[", 
         RowBox[{"LLPn", ",", "proc", ",", "Facility"}], "]"}], "=", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"MemberQ", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
               "\"\<LHC\>\"", ",", "\"\<FCC-hh\>\"", ",", " ", 
                "\"\<LHC_fixed_target\>\""}], "}"}], ",", "Facility"}], "]"}],
             "==", "True"}], ",", 
           RowBox[{"{", 
            RowBox[{
            "0.02", ",", "0.05", ",", "0.1", ",", "0.15", ",", "0.2", ",", 
             "0.5", ",", "1", ",", "1.5", ",", "2.", ",", "2.5", ",", "2.8", 
             ",", "3.", ",", "3.45", ",", "4.", ",", "4.5", ",", "5.16", ",", 
             "5.27", ",", "5.8", ",", "6.25"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
            "0.05", ",", "0.2", ",", "0.5", ",", "1", ",", "1.5", ",", "2.", 
             ",", "2.5", ",", "2.8", ",", "3.", ",", "3.45", ",", "4.", ",", 
             "4.5", ",", "5.16", ",", "5.27"}], "}"}]}], "]"}], "//", "N"}]}],
        ";"}], "\[IndentingNewLine]", ",", 
      RowBox[{"{", 
       RowBox[{"Facility", ",", "FacilitiesList"}], "}"}]}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Monitor", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"LLP", "=", 
           RowBox[{"ListHNLs", "[", 
            RowBox[{"[", "k", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"TabulatedPDF", "[", "mLLP_", "]"}], ":=", 
           RowBox[{"BlockTabulatedPDFsFromDecaysMass", "[", 
            RowBox[{
            "LLP", ",", "SelectedFacility", ",", "mLLP", ",", "proc", ",", 
             "nsim", ",", 
             RowBox[{"\[Theta]Nlist", "[", "SelectedFacility", "]"}], ",", 
             RowBox[{"ENlist", "[", "SelectedFacility", "]"}], ",", 
             RowBox[{"\[Theta]minExtrFacility", "[", 
              RowBox[{"SelectedFacility", ",", "proc"}], "]"}], ",", 
             "\"\<False\>\""}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"filename", "=", 
           RowBox[{"filenameToExport", "[", 
            RowBox[{"LLP", ",", "proc", ",", "SelectedFacility"}], "]"}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"mlist", "=", 
           RowBox[{"MassList", "[", 
            RowBox[{"LLPn", ",", "proc", ",", "SelectedFacility"}], "]"}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"tabulatedblock", "[", 
           RowBox[{"TabulatedPDF", ",", "mlist", ",", "filename"}], "]"}]}], 
         "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", "1", ",", 
           RowBox[{"Length", "[", "ListHNLs", "]"}], ",", "1"}], "}"}]}], 
        "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Row", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"ProgressIndicator", "[", 
           RowBox[{"k", ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", 
              RowBox[{"Length", "[", "ListHNLs", "]"}]}], "}"}]}], "]"}], 
          ",", "\"\< \>\"", ",", "\"\<HNL = \>\"", ",", 
          RowBox[{"ListHNLs", "[", 
           RowBox[{"[", "k", "]"}], "]"}], ",", "\"\< (\>\"", ",", "k", ",", 
          "\"\</\>\"", ",", 
          RowBox[{"Length", "[", "ListHNLs", "]"}], ",", "\"\<)\>\""}], "}"}],
         "]"}]}], "]"}], "//", "AbsoluteTiming"}]}]}], "\[IndentingNewLine]", 
  "]"}]], "Input",
 CellChangeTimes->{{3.913287731128636*^9, 3.913287740419882*^9}, {
   3.913287842670073*^9, 3.913287846937502*^9}, {3.913305158732304*^9, 
   3.913305290162189*^9}, {3.913306663150398*^9, 3.913306676051849*^9}, {
   3.913439626584699*^9, 3.913439667674616*^9}, {3.913439824293267*^9, 
   3.913439824584635*^9}, {3.9134398896584225`*^9, 3.9134398930532837`*^9}, {
   3.913440532628166*^9, 3.913440533683214*^9}, {3.913447724695129*^9, 
   3.9134477599257355`*^9}, {3.9137114833014984`*^9, 3.9137115483667583`*^9}, 
   3.913711618627786*^9, {3.91371248514944*^9, 3.9137124974517107`*^9}, {
   3.9137126303195324`*^9, 3.913712669983138*^9}, 3.915083933786233*^9, {
   3.915438817930664*^9, 3.915438817961663*^9}, {3.9292030549775653`*^9, 
   3.929203058926385*^9}, 
   3.9309905498537903`*^9},ExpressionUUID->"982b5ac6-71df-482c-9725-\
30feba386bb6"]
}, Open  ]],

Cell[CellGroupData[{

Cell["HNL_D", "Section",
 CellChangeTimes->{{3.913278288470327*^9, 3.913278292834437*^9}, {
  3.913447805004904*^9, 
  3.913447807706941*^9}},ExpressionUUID->"e62f76e1-dd2d-4319-808f-\
0ff869601c12"],

Cell[BoxData[
 RowBox[{"Module", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"LLPn", ",", "LLP", ",", "mlist", ",", "proc"}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"LLPn", "=", "\"\<HNL\>\""}], ";", "\[IndentingNewLine]", 
    RowBox[{"proc", "=", "\"\<D\>\""}], ";", "\[IndentingNewLine]", 
    RowBox[{"Do", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"MassList", "[", 
         RowBox[{"LLPn", ",", "proc", ",", "Facility"}], "]"}], "=", 
        RowBox[{"{", 
         RowBox[{
         "0.02", ",", "0.05`", ",", "0.1", ",", "0.15", ",", "0.17", ",", 
          "0.1825", ",", "0.2`", ",", "0.5`", ",", "0.7`", ",", "1.", ",", 
          "1.2`", ",", "1.5`", ",", "1.75`", ",", "1.84", ",", "1.95`"}], 
         "}"}]}], ";"}], "\[IndentingNewLine]", ",", 
      RowBox[{"{", 
       RowBox[{"Facility", ",", "FacilitiesList"}], "}"}]}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Monitor", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"LLP", "=", 
           RowBox[{"ListHNLs", "[", 
            RowBox[{"[", "k", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"TabulatedPDF", "[", "mLLP_", "]"}], ":=", 
           RowBox[{"BlockTabulatedPDFsFromDecaysMass", "[", 
            RowBox[{
            "LLP", ",", "SelectedFacility", ",", "mLLP", ",", "proc", ",", 
             "nsim", ",", 
             RowBox[{"\[Theta]Nlist", "[", "SelectedFacility", "]"}], ",", 
             RowBox[{"ENlist", "[", "SelectedFacility", "]"}], ",", 
             RowBox[{"\[Theta]minExtrFacility", "[", 
              RowBox[{"SelectedFacility", ",", "proc"}], "]"}], ",", 
             "\"\<False\>\""}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"filename", "=", 
           RowBox[{"filenameToExport", "[", 
            RowBox[{"LLP", ",", "proc", ",", "SelectedFacility"}], "]"}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"mlist", "=", 
           RowBox[{"MassList", "[", 
            RowBox[{"LLPn", ",", "proc", ",", "SelectedFacility"}], "]"}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"tabulatedblock", "[", 
           RowBox[{"TabulatedPDF", ",", "mlist", ",", "filename"}], "]"}]}], 
         "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", "1", ",", 
           RowBox[{"Length", "[", "ListHNLs", "]"}], ",", "1"}], "}"}]}], 
        "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Row", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"ProgressIndicator", "[", 
           RowBox[{"k", ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", 
              RowBox[{"Length", "[", "ListHNLs", "]"}]}], "}"}]}], "]"}], 
          ",", "\"\< \>\"", ",", "\"\<HNL = \>\"", ",", 
          RowBox[{"ListHNLs", "[", 
           RowBox[{"[", "k", "]"}], "]"}], ",", "\"\< (\>\"", ",", "k", ",", 
          "\"\</\>\"", ",", 
          RowBox[{"Length", "[", "ListHNLs", "]"}], ",", "\"\<)\>\""}], "}"}],
         "]"}]}], "]"}], "//", "AbsoluteTiming"}]}]}], "\[IndentingNewLine]", 
  "]"}]], "Input",
 CellChangeTimes->{{3.913287851204857*^9, 3.913287859357921*^9}, {
   3.91330741599636*^9, 3.913307452724727*^9}, {3.913439655434664*^9, 
   3.913439678003095*^9}, {3.913439905707557*^9, 3.9134399117636757`*^9}, {
   3.9134405412916822`*^9, 3.913440544832391*^9}, 3.913440592282471*^9, {
   3.913447669106067*^9, 3.913447719036167*^9}, {3.913447765717295*^9, 
   3.913447768526089*^9}, {3.913711466435387*^9, 3.913711476001455*^9}, 
   3.913711626731611*^9, {3.9137121444181423`*^9, 3.913712333693115*^9}, {
   3.913712473912722*^9, 3.91371247488516*^9}, {3.913712679520397*^9, 
   3.913712705049835*^9}, 3.915083933792327*^9, {3.91543881797072*^9, 
   3.9154388180098267`*^9}, {3.929203030953474*^9, 3.929203036524565*^9}, {
   3.9296148140955534`*^9, 3.929614818280311*^9}, {3.9296160484085283`*^9, 
   3.929616079032939*^9}, {3.929616112358932*^9, 3.929616123337043*^9}},
 CellLabel->
  "In[536]:=",ExpressionUUID->"d4bd6742-98f4-45d5-8243-7302c738d5e5"]
}, Open  ]],

Cell[CellGroupData[{

Cell["HNL_K", "Section",
 CellChangeTimes->{{3.913278288470327*^9, 3.913278292834437*^9}, {
  3.9133096134774485`*^9, 3.913309613810117*^9}, {3.913447896014166*^9, 
  3.9134478974270306`*^9}},ExpressionUUID->"a8d16280-fc7b-406a-a959-\
809e0c08611c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"MemberQ", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\"\<SPS\>\"", ",", " ", "\"\<LHC_fixed_target\>\""}], "}"}], 
      ",", "SelectedFacility"}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"proc", "=", "\"\<K\>\""}], ";", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"MassList", "[", 
          RowBox[{"\"\<HNL\>\"", ",", "proc", ",", "Facility"}], "]"}], "=", 
         RowBox[{"{", 
          RowBox[{"0.05`", ",", "0.1", ",", "0.2", ",", "0.4", ",", 
           RowBox[{"0.99", "*", 
            RowBox[{"MaxMass", "[", 
             RowBox[{
              RowBox[{"ListHNLs", "[", 
               RowBox[{"[", "2", "]"}], "]"}], ",", "SelectedFacility", ",", 
              "proc"}], "]"}]}], ",", 
           RowBox[{"0.99", "*", 
            RowBox[{"MaxMass", "[", 
             RowBox[{
              RowBox[{"ListHNLs", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", "SelectedFacility", ",", 
              "proc"}], "]"}]}]}], "}"}]}], ";"}], "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"Facility", ",", "FacilitiesList"}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"TabulatedPDF", "[", "mLLP_", "]"}], ":=", 
         RowBox[{"BlockTabulatedPDFsFromDecaysMass", "[", 
          RowBox[{
          "LLP", ",", "SelectedFacility", ",", "mLLP", ",", "proc", ",", 
           "nsim", ",", 
           RowBox[{"\[Theta]Nlist", "[", "SelectedFacility", "]"}], ",", 
           RowBox[{"ENlist", "[", "SelectedFacility", "]"}], ",", 
           RowBox[{"\[Theta]minExtrFacility", "[", 
            RowBox[{"SelectedFacility", ",", "proc"}], "]"}], ",", 
           "\"\<False\>\""}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"filename", "=", 
         RowBox[{"filenameToExport", "[", 
          RowBox[{"LLP", ",", "proc", ",", "SelectedFacility"}], "]"}]}], ";",
         "\[IndentingNewLine]", 
        RowBox[{"mlist", "=", 
         RowBox[{"MassList", "[", 
          RowBox[{"\"\<HNL\>\"", ",", "proc", ",", "SelectedFacility"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"tabulatedblock", "[", 
         RowBox[{"TabulatedPDF", ",", "mlist", ",", "filename"}], "]"}]}], 
       "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"LLP", ",", 
         RowBox[{"Drop", "[", 
          RowBox[{"ListHNLs", ",", 
           RowBox[{"-", "1"}]}], "]"}]}], "}"}]}], "\[IndentingNewLine]", 
      "]"}]}]}], "\[IndentingNewLine]", "]"}], "//", 
  "AbsoluteTiming"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"proc", ",", "mlist"}], "}"}], "//", "Clear"}], ";"}]}], "Input",
 CellChangeTimes->{{3.913287851204857*^9, 3.913287859357921*^9}, {
   3.91330741599636*^9, 3.913307452724727*^9}, {3.913309617717517*^9, 
   3.913309737827447*^9}, {3.913439694563271*^9, 3.913439722784535*^9}, {
   3.9134399197133465`*^9, 3.913439919855297*^9}, {3.913440548830753*^9, 
   3.913440585974586*^9}, {3.913447647575073*^9, 3.91344766387704*^9}, {
   3.9134477709960084`*^9, 3.913447795667177*^9}, {3.913447922255859*^9, 
   3.913447943022871*^9}, {3.913711420897914*^9, 3.913711453547987*^9}, 
   3.915083933797961*^9, {3.915438818021824*^9, 3.915438818039808*^9}, {
   3.930990560171813*^9, 
   3.930990570546739*^9}},ExpressionUUID->"40f16543-3a10-4025-b0f7-\
0072ee4d53aa"]
}, Open  ]],

Cell[CellGroupData[{

Cell["HNL_mu", "Section",
 CellChangeTimes->{{3.913278288470327*^9, 3.913278292834437*^9}, {
  3.9133096134774485`*^9, 3.913309613810117*^9}, {3.913447896014166*^9, 
  3.9134478974270306`*^9}, {3.914834484486705*^9, 
  3.9148344846553593`*^9}},ExpressionUUID->"60385646-ad4d-4cf0-9045-\
232461d61193"],

Cell[BoxData[{
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"MemberQ", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\"\<ESS\>\"", ",", " ", "\"\<LHC_fixed_target\>\""}], "}"}], 
     ",", "SelectedFacility"}], "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"proc", "=", "\"\<mu\>\""}], ";", "\[IndentingNewLine]", 
    RowBox[{"Do", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"MassList", "[", 
         RowBox[{"\"\<HNL\>\"", ",", "proc", ",", "Facility"}], "]"}], "=", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "0.005", ",", "0.01", ",", "0.015", ",", "0.02", ",", "0.025", ",",
             "0.03", ",", "0.035", ",", "0.04", ",", "0.045", ",", "0.05", 
            ",", "0.055", ",", "0.06", ",", "0.065", ",", "0.07", ",", 
            "0.075", ",", "0.08", ",", "0.085", ",", "0.09", ",", "0.095", 
            ",", "0.1", ",", 
            RowBox[{"0.99", "*", 
             RowBox[{"MaxMass", "[", 
              RowBox[{
               RowBox[{"ListHNLs", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", "SelectedFacility", ",", 
               "proc"}], "]"}]}]}], "}"}], "//", "Sort"}], "//", 
         "DeleteDuplicates"}]}], ";"}], "\[IndentingNewLine]", ",", 
      RowBox[{"{", 
       RowBox[{"Facility", ",", "FacilitiesList"}], "}"}]}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"mlist", "=", 
         RowBox[{"MassList", "[", 
          RowBox[{"\"\<HNL\>\"", ",", "proc", ",", "SelectedFacility"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"mlistExt", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Join", "[", 
            RowBox[{"mlist", ",", 
             RowBox[{
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"With", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"mass", "=", 
                    RowBox[{"mlist", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], ",", 
                    RowBox[{"mmax", "=", 
                    FractionBox[
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"mSM", "[", "\"\<mu\>\"", "]"}], "2"], "-", 
                    SuperscriptBox[
                    RowBox[{"mSM", "[", "\"\<e\>\"", "]"}], "2"], "+", 
                    SuperscriptBox[
                    RowBox[{"mlist", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "2"]}], 
                    RowBox[{"2", 
                    RowBox[{"mSM", "[", "\"\<mu\>\"", "]"}]}]]}]}], "}"}], 
                  ",", 
                  RowBox[{"Table", "[", 
                   RowBox[{"m", ",", 
                    RowBox[{"{", 
                    RowBox[{"m", ",", 
                    RowBox[{"mass", "+", 
                    RowBox[{"0.01", 
                    RowBox[{"(", 
                    RowBox[{"mmax", "-", "mass"}], ")"}]}]}], ",", 
                    RowBox[{"mass", "+", 
                    RowBox[{"0.99", 
                    RowBox[{"(", 
                    RowBox[{"mmax", "-", "mass"}], ")"}]}]}], ",", 
                    FractionBox[
                    RowBox[{"0.9", 
                    RowBox[{"(", 
                    RowBox[{"mmax", "-", "mass"}], ")"}]}], "20"]}], "}"}]}], 
                   "]"}]}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"i", ",", "1", ",", 
                  RowBox[{"Length", "[", "mlist", "]"}], ",", "1"}], "}"}]}], 
               "]"}], "//", "Flatten"}]}], "]"}], "//", "Sort"}], "//", 
          "DeleteDuplicates"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"elist", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Join", "[", 
            RowBox[{
             RowBox[{"Table", "[", 
              RowBox[{"e", ",", 
               RowBox[{"{", 
                RowBox[{"e", ",", 
                 SuperscriptBox["10", 
                  RowBox[{"-", "3."}]], ",", 
                 RowBox[{"mSM", "[", "\"\<mu\>\"", "]"}], ",", "0.001"}], 
                "}"}]}], "]"}], ",", "mlistExt", ",", 
             RowBox[{"{", 
              RowBox[{"mSM", "[", "\"\<mu\>\"", "]"}], "}"}]}], "]"}], "//", 
           "DeleteDuplicates"}], "//", "Sort"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"TabulatedPDF", "[", "mLLP_", "]"}], ":=", 
         RowBox[{"BlockTabulatedPDFsFromDecaysMass", "[", 
          RowBox[{
          "LLP", ",", "SelectedFacility", ",", "mLLP", ",", "proc", ",", 
           "nsim", ",", 
           RowBox[{"\[Theta]Nlist", "[", "SelectedFacility", "]"}], ",", 
           "elist", ",", 
           RowBox[{"\[Theta]minExtrFacility", "[", 
            RowBox[{"SelectedFacility", ",", "proc"}], "]"}], ",", 
           "\"\<False\>\""}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"filename", "=", 
         RowBox[{"filenameToExport", "[", 
          RowBox[{"LLP", ",", "proc", ",", "SelectedFacility"}], "]"}]}], ";",
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"tabulatedblock", "[", 
         RowBox[{"TabulatedPDF", ",", "mlist", ",", "filename"}], "]"}]}], 
       "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"LLP", ",", 
         RowBox[{"Drop", "[", 
          RowBox[{"ListHNLs", ",", 
           RowBox[{"-", "1"}]}], "]"}]}], "}"}]}], "\[IndentingNewLine]", 
      "]"}], "//", "AbsoluteTiming"}]}]}], "\[IndentingNewLine]", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"proc", ",", "mlist"}], "}"}], "//", "Clear"}], ";"}]}], "Input",
 CellChangeTimes->{{3.913287851204857*^9, 3.913287859357921*^9}, {
   3.91330741599636*^9, 3.913307452724727*^9}, {3.913309617717517*^9, 
   3.913309737827447*^9}, {3.913439694563271*^9, 3.913439722784535*^9}, {
   3.9134399197133465`*^9, 3.913439919855297*^9}, {3.913440548830753*^9, 
   3.913440585974586*^9}, {3.913447647575073*^9, 3.91344766387704*^9}, {
   3.9134477709960084`*^9, 3.913447795667177*^9}, {3.913447922255859*^9, 
   3.913447943022871*^9}, {3.913711420897914*^9, 3.913711453547987*^9}, {
   3.9148348468154*^9, 3.914834865835432*^9}, {3.914850140058737*^9, 
   3.914850222901676*^9}, {3.914850259027645*^9, 3.91485028703768*^9}, {
   3.914915745084867*^9, 3.91491575752492*^9}, {3.914916878687452*^9, 
   3.9149169066576247`*^9}, {3.9149177155114946`*^9, 3.914917724165298*^9}, {
   3.9149177862481413`*^9, 3.914917792174158*^9}, {3.914917848930315*^9, 
   3.914917886877094*^9}, {3.9149179267533035`*^9, 3.914918121069985*^9}, {
   3.91491815404558*^9, 3.91491818354054*^9}, {3.914918231257552*^9, 
   3.914918233259268*^9}, {3.914918334777732*^9, 3.914918411088078*^9}, {
   3.914918568195139*^9, 3.9149185688430476`*^9}, {3.914925122177499*^9, 
   3.914925148784086*^9}, {3.914925632277098*^9, 3.914925635748077*^9}, 
   3.91508393380603*^9, {3.915438818058284*^9, 3.915438818083269*^9}, {
   3.930990575756473*^9, 
   3.9309905799310417`*^9}},ExpressionUUID->"179d3ca4-a32c-444e-a3a3-\
15c09587ee50"]
}, Open  ]],

Cell[CellGroupData[{

Cell["HNL_PiCharged", "Section",
 CellChangeTimes->{{3.913278288470327*^9, 3.913278292834437*^9}, {
  3.9133096134774485`*^9, 3.913309613810117*^9}, {3.913447896014166*^9, 
  3.9134478974270306`*^9}, {3.914834484486705*^9, 3.9148344846553593`*^9}, {
  3.91490883972186*^9, 
  3.914908841131825*^9}},ExpressionUUID->"c87b1f13-ed80-4ea5-aba8-\
54fc50e487cb"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"MemberQ", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\"\<ESS\>\"", ",", " ", "\"\<LHC_fixed_target\>\""}], "}"}], 
      ",", "SelectedFacility"}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"proc", "=", "\"\<PiCharged\>\""}], ";", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"MassList", "[", 
          RowBox[{"\"\<HNL\>\"", ",", "proc", ",", "Facility"}], "]"}], "=", 
         RowBox[{"{", 
          RowBox[{
          "0.001", ",", "0.005", ",", "0.01", ",", "0.015", ",", "0.02", ",", 
           "0.027", ",", "0.032", ",", "0.04", ",", "0.05", ",", "0.06", ",", 
           "0.07", ",", "0.08", ",", "0.09", ",", "0.1", ",", "0.11", ",", 
           "0.115", ",", "0.12", ",", "0.125", ",", "0.13", ",", "0.135"}], 
          "}"}]}], ";"}], "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"Facility", ",", 
         RowBox[{"{", 
          RowBox[{"\"\<ESS\>\"", ",", " ", "\"\<LHC_fixed_target\>\""}], 
          "}"}]}], "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"elist", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Join", "[", 
            RowBox[{
             FractionBox[
              RowBox[{
               SuperscriptBox[
                RowBox[{"mSM", "[", "\"\<PiCharged\>\"", "]"}], "2"], "-", 
               SuperscriptBox[
                RowBox[{"mSM", "[", "\"\<e\>\"", "]"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"MassList", "[", 
                 RowBox[{"\"\<HNL\>\"", ",", "proc", ",", "\"\<ESS\>\""}], 
                 "]"}], "2"]}], 
              RowBox[{"2", 
               RowBox[{"mSM", "[", "\"\<PiCharged\>\"", "]"}]}]], ",", 
             FractionBox[
              RowBox[{
               SuperscriptBox[
                RowBox[{"mSM", "[", "\"\<PiCharged\>\"", "]"}], "2"], "-", 
               SuperscriptBox[
                RowBox[{"mSM", "[", "\"\<mu\>\"", "]"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"MassList", "[", 
                 RowBox[{"\"\<HNL\>\"", ",", "proc", ",", "\"\<ESS\>\""}], 
                 "]"}], "2"]}], 
              RowBox[{"2", 
               RowBox[{"mSM", "[", "\"\<PiCharged\>\"", "]"}]}]]}], "]"}], "//",
            "DeleteDuplicates"}], "//", "Sort"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"TabulatedPDF", "[", "mLLP_", "]"}], ":=", 
         RowBox[{"BlockTabulatedPDFsFromDecaysMass", "[", 
          RowBox[{
          "LLP", ",", "SelectedFacility", ",", "mLLP", ",", "proc", ",", 
           "nsim", ",", 
           RowBox[{"\[Theta]Nlist", "[", "SelectedFacility", "]"}], ",", 
           "elist", ",", 
           RowBox[{"\[Theta]minExtrFacility", "[", 
            RowBox[{"SelectedFacility", ",", "proc"}], "]"}], ",", 
           "\"\<False\>\""}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"filename", "=", 
         RowBox[{"filenameToExport", "[", 
          RowBox[{"LLP", ",", "proc", ",", "SelectedFacility"}], "]"}]}], ";",
         "\[IndentingNewLine]", 
        RowBox[{"mlist", "=", 
         RowBox[{"MassList", "[", 
          RowBox[{"\"\<HNL\>\"", ",", "proc", ",", "SelectedFacility"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"tabulatedblock", "[", 
         RowBox[{"TabulatedPDF", ",", "mlist", ",", "filename"}], "]"}]}], 
       "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"LLP", ",", 
         RowBox[{"Drop", "[", 
          RowBox[{"ListHNLs", ",", 
           RowBox[{"-", "1"}]}], "]"}]}], "}"}]}], "\[IndentingNewLine]", 
      "]"}]}]}], "\[IndentingNewLine]", "]"}], "//", 
  "AbsoluteTiming"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"proc", ",", "mlist"}], "}"}], "//", "Clear"}], ";"}]}], "Input",
 CellChangeTimes->{{3.913287851204857*^9, 3.913287859357921*^9}, {
   3.91330741599636*^9, 3.913307452724727*^9}, {3.913309617717517*^9, 
   3.913309737827447*^9}, {3.913439694563271*^9, 3.913439722784535*^9}, {
   3.9134399197133465`*^9, 3.913439919855297*^9}, {3.913440548830753*^9, 
   3.913440585974586*^9}, {3.913447647575073*^9, 3.91344766387704*^9}, {
   3.9134477709960084`*^9, 3.913447795667177*^9}, {3.913447922255859*^9, 
   3.913447943022871*^9}, {3.913711420897914*^9, 3.913711453547987*^9}, {
   3.9148348468154*^9, 3.914834865835432*^9}, {3.914850140058737*^9, 
   3.914850222901676*^9}, {3.914850259027645*^9, 3.91485028703768*^9}, {
   3.914908919905053*^9, 3.914908924720897*^9}, {3.91490896185084*^9, 
   3.914909118510659*^9}, 3.914909341510496*^9, {3.91490957922182*^9, 
   3.914909579491809*^9}, {3.914910052419633*^9, 3.914910054078763*^9}, {
   3.9149157674407825`*^9, 3.9149157794949875`*^9}, {3.914929914345007*^9, 
   3.91492992928703*^9}, 3.9150839338150187`*^9, {3.915438818098244*^9, 
   3.91543881812323*^9}, {3.9309905909538803`*^9, 
   3.930990599575368*^9}},ExpressionUUID->"8febb02f-a209-49e2-a75d-\
467370f83e9b"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Scalar", "Chapter",
 CellChangeTimes->{{3.91344144967334*^9, 3.913441455340948*^9}, {
   3.913441825113173*^9, 3.9134418258593936`*^9}, {3.913441936913423*^9, 
   3.9134419384733877`*^9}, {3.913442132020331*^9, 3.91344213360353*^9}, 
   3.9134482243227367`*^9},ExpressionUUID->"3c746fb7-6e36-4915-8879-\
cad74039dfaa"],

Cell[CellGroupData[{

Cell["Scalar_B-mixing", "Section",
 CellChangeTimes->{{3.9134415168446145`*^9, 3.913441517813478*^9}, {
  3.913441586515154*^9, 3.9134415875071993`*^9}, {3.913441709585079*^9, 
  3.913441711662386*^9}, {3.913442140735273*^9, 
  3.913442145498228*^9}},ExpressionUUID->"1714effd-fdc0-455a-9663-\
ecf54047feb5"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"proc", "=", "\"\<B-mixing\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"LLPv", "=", "\"\<Scalar\>\""}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "List", " ", "of", " ", "masses", " ", "for", " ", "which", " ", "the", 
    " ", "distribution", " ", "will", " ", "be", " ", "tabulated"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"MassList", "[", 
       RowBox[{"LLPv", ",", "proc", ",", "Facility"}], "]"}], "=", 
      RowBox[{"{", 
       RowBox[{
       "0.02", ",", "0.05", ",", "0.2", ",", "0.5", ",", "1", ",", "1.3", ",",
         "1.5", ",", "1.7", ",", "2.", ",", "2.3", ",", "2.5", ",", "2.7", 
        ",", "3.", ",", "3.3", ",", "3.6", ",", "4.", ",", "4.4", ",", "4.8", 
        ",", "5.13"}], "}"}]}], ";"}], "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{"Facility", ",", "FacilitiesList"}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TabulatedPDF", "[", "mLLP_", "]"}], ":=", 
   RowBox[{"BlockTabulatedPDFsFromDecaysMass", "[", 
    RowBox[{
    "LLPv", ",", "SelectedFacility", ",", "mLLP", ",", "proc", ",", "nsim", 
     ",", 
     RowBox[{"\[Theta]Nlist", "[", "SelectedFacility", "]"}], ",", 
     RowBox[{"ENlist", "[", "SelectedFacility", "]"}], ",", 
     RowBox[{"\[Theta]minExtrFacility", "[", 
      RowBox[{"SelectedFacility", ",", "proc"}], "]"}], ",", 
     "\"\<False\>\""}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"filename", "=", 
   RowBox[{"filenameToExport", "[", 
    RowBox[{"LLPv", ",", "proc", ",", "SelectedFacility"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mlist", "=", 
   RowBox[{"MassList", "[", 
    RowBox[{"LLPv", ",", "proc", ",", "SelectedFacility"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tabulatedblock", "[", 
   RowBox[{"TabulatedPDF", ",", "mlist", ",", "filename"}], "]"}], "//", 
  "AbsoluteTiming"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"{", 
   RowBox[{"LLPv", ",", "proc", ",", "mlist"}], "}"}], "//", 
  "Clear"}]}], "Input",
 CellChangeTimes->{{3.913447449536884*^9, 3.913447637086103*^9}, {
   3.913447959385062*^9, 3.913447990395999*^9}, {3.913448030396103*^9, 
   3.913448049320239*^9}, {3.913453038617915*^9, 3.9134530410485325`*^9}, {
   3.913453424443082*^9, 3.9134534260653133`*^9}, 3.915083933821011*^9, {
   3.915438818136731*^9, 3.915438818157709*^9}, {3.916939691075319*^9, 
   3.91693972025876*^9}},
 CellLabel->
  "In[1831]:=",ExpressionUUID->"f794f041-61cf-427a-ba7e-5871cfd09877"]
}, Closed]],

Cell[CellGroupData[{

Cell["Scalar_B-quartic", "Section",
 CellChangeTimes->{{3.9134415168446145`*^9, 3.913441517813478*^9}, {
  3.913448032517132*^9, 
  3.913448035592166*^9}},ExpressionUUID->"e832b21a-40c0-4109-994d-\
ba51e4a25b79"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"LLPv", "=", "\"\<Scalar\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"proc", "=", "\"\<B-quartic\>\""}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "List", " ", "of", " ", "masses", " ", "for", " ", "which", " ", "the", 
    " ", "distribution", " ", "will", " ", "be", " ", "tabulated"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"MassList", "[", 
       RowBox[{"LLPv", ",", "proc", ",", "Facility"}], "]"}], "=", 
      RowBox[{"Select", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "0.02", ",", "0.05", ",", "0.2", ",", "0.5", ",", "1", ",", "1.5", 
          ",", "2.", ",", "2.2", ",", "2.39"}], "}"}], ",", 
        RowBox[{
         RowBox[{"#", "<", 
          RowBox[{"MaxMass", "[", 
           RowBox[{"LLPv", ",", "SelectedFacility", ",", "proc"}], "]"}]}], 
         "&"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{"Facility", ",", "FacilitiesList"}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TabulatedPDF", "[", "mLLP_", "]"}], ":=", 
   RowBox[{"BlockTabulatedPDFsFromDecaysMass", "[", 
    RowBox[{
    "LLPv", ",", "SelectedFacility", ",", "mLLP", ",", "proc", ",", "nsim", 
     ",", 
     RowBox[{"\[Theta]Nlist", "[", "SelectedFacility", "]"}], ",", 
     RowBox[{"ENlist", "[", "SelectedFacility", "]"}], ",", 
     RowBox[{"\[Theta]minExtrFacility", "[", 
      RowBox[{"SelectedFacility", ",", "proc"}], "]"}], ",", 
     "\"\<False\>\""}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"filename", "=", 
   RowBox[{"filenameToExport", "[", 
    RowBox[{"LLPv", ",", "proc", ",", "SelectedFacility"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mlist", "=", 
   RowBox[{"MassList", "[", 
    RowBox[{"LLPv", ",", "proc", ",", "SelectedFacility"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tabulatedblock", "[", 
   RowBox[{"TabulatedPDF", ",", "mlist", ",", "filename"}], "]"}], "//", 
  "AbsoluteTiming"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"{", 
   RowBox[{"LLPv", ",", "proc", ",", "mlist", ",", "filename"}], "}"}], "//", 
  "Clear"}]}], "Input",
 CellChangeTimes->{{3.9134469943378687`*^9, 3.913446996567292*^9}, {
   3.9134480393462048`*^9, 3.913448081707168*^9}, {3.913448239250302*^9, 
   3.913448239590337*^9}, 3.913453044543589*^9, {3.913453419270545*^9, 
   3.913453421046371*^9}, {3.913827709695099*^9, 3.91382771424861*^9}, {
   3.913829018907609*^9, 3.9138290208477755`*^9}, {3.913829307184166*^9, 
   3.9138293363063526`*^9}, 3.9150839338261633`*^9, {3.9154388181657047`*^9, 
   3.9154388181866827`*^9}},
 CellLabel->
  "In[1847]:=",ExpressionUUID->"d8654445-2591-457c-ac53-59248775fa97"]
}, Closed]],

Cell[CellGroupData[{

Cell["Scalar_Bs-quartic", "Section",
 CellChangeTimes->{{3.9134415168446145`*^9, 3.913441517813478*^9}, {
  3.913448099007034*^9, 
  3.913448102547238*^9}},ExpressionUUID->"67d456ee-bbcd-4d49-96ac-\
21b1fbf02c19"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"proc", "=", "\"\<Bs-quartic\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"LLPv", "=", "\"\<Scalar\>\""}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "List", " ", "of", " ", "masses", " ", "for", " ", "which", " ", "the", 
    " ", "distribution", " ", "will", " ", "be", " ", "tabulated"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"MassList", "[", 
       RowBox[{"LLPv", ",", "proc", ",", "Facility"}], "]"}], "=", 
      RowBox[{"{", 
       RowBox[{
       "0.02", ",", "0.05", ",", "0.2", ",", "0.5", ",", "1", ",", "1.5", ",",
         "2.", ",", "2.5", ",", "2.65"}], "}"}]}], ";"}], 
    "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{"Facility", ",", "FacilitiesList"}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TabulatedPDF", "[", "mLLP_", "]"}], ":=", 
   RowBox[{"BlockTabulatedPDFsFromDecaysMass", "[", 
    RowBox[{
    "LLPv", ",", "SelectedFacility", ",", "mLLP", ",", "proc", ",", "nsim", 
     ",", 
     RowBox[{"\[Theta]Nlist", "[", "SelectedFacility", "]"}], ",", 
     RowBox[{"ENlist", "[", "SelectedFacility", "]"}], ",", 
     RowBox[{"\[Theta]minExtrFacility", "[", 
      RowBox[{"SelectedFacility", ",", "proc"}], "]"}], ",", 
     "\"\<False\>\""}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"filename", "=", 
   RowBox[{"filenameToExport", "[", 
    RowBox[{"LLPv", ",", "proc", ",", "SelectedFacility"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mlist", "=", 
   RowBox[{"MassList", "[", 
    RowBox[{"LLPv", ",", "proc", ",", "SelectedFacility"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tabulatedblock", "[", 
   RowBox[{"TabulatedPDF", ",", "mlist", ",", "filename"}], "]"}], "//", 
  "AbsoluteTiming"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"{", 
   RowBox[{"LLPv", ",", "proc", ",", "mlist"}], "}"}], "//", 
  "Clear"}]}], "Input",
 CellChangeTimes->{
  3.913448105071498*^9, 3.913453046033691*^9, {3.913453415137869*^9, 
   3.913453417074925*^9}, 3.915083933831151*^9, {3.9154388181946774`*^9, 
   3.915438818213779*^9}},
 CellLabel->
  "In[1839]:=",ExpressionUUID->"70364653-607b-4580-8af1-b8a08e851708"]
}, Closed]],

Cell[CellGroupData[{

Cell["Scalar_h-quartic", "Section",
 CellChangeTimes->{{3.9134415168446145`*^9, 3.913441517813478*^9}, {
   3.913448099007034*^9, 3.913448102547238*^9}, 
   3.913448250779744*^9},ExpressionUUID->"af3e18b1-0b62-4cf5-95e7-\
5dae8c11ec33"],

Cell[BoxData[{
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"MemberQ", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\"\<LHC\>\"", ",", "\"\<FCC-hh\>\""}], "}"}], ",", 
     "SelectedFacility"}], "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"proc", "=", "\"\<h-quartic\>\""}], ";", "\[IndentingNewLine]", 
     RowBox[{"LLPv", "=", "\"\<Scalar\>\""}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "List", " ", "of", " ", "masses", " ", "for", " ", "which", " ", "the", 
       " ", "distribution", " ", "will", " ", "be", " ", "tabulated"}], 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"MassList", "[", 
          RowBox[{"LLPv", ",", "proc", ",", "Facility"}], "]"}], "=", 
         RowBox[{"{", 
          RowBox[{
          "0.02", ",", "0.1", ",", "1.", ",", "5.", ",", "10.", ",", "15.", 
           ",", "20.", ",", "25.", ",", "30.", ",", "35.", ",", "40.", ",", 
           "45.", ",", "50.", ",", "55.", ",", "59.", ",", "60.", ",", "61.", 
           ",", "62.", ",", "62.49"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
       ",", 
       RowBox[{"{", 
        RowBox[{"Facility", ",", "FacilitiesList"}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"TabulatedPDF", "[", "mLLP_", "]"}], ":=", 
      RowBox[{"BlockTabulatedPDFsFromDecaysMass", "[", 
       RowBox[{
       "LLPv", ",", "SelectedFacility", ",", "mLLP", ",", "proc", ",", "nsim",
         ",", 
        RowBox[{"\[Theta]Nlist", "[", "SelectedFacility", "]"}], ",", 
        RowBox[{"ENlist", "[", "SelectedFacility", "]"}], ",", 
        RowBox[{"\[Theta]minExtrFacility", "[", 
         RowBox[{"SelectedFacility", ",", "proc"}], "]"}], ",", 
        "\"\<False\>\""}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"filename", "=", 
      RowBox[{"filenameToExport", "[", 
       RowBox[{"LLPv", ",", "proc", ",", "SelectedFacility"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"mlist", "=", 
      RowBox[{"MassList", "[", 
       RowBox[{"LLPv", ",", "proc", ",", "SelectedFacility"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"tabulatedblock", "[", 
      RowBox[{"TabulatedPDF", ",", "mlist", ",", "filename"}], "]"}], ";"}], "//",
     "AbsoluteTiming"}]}], "\[IndentingNewLine]", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"{", 
   RowBox[{"LLPv", ",", "proc", ",", "mlist"}], "}"}], "//", 
  "Clear"}]}], "Input",
 CellChangeTimes->{
  3.913448105071498*^9, {3.913448253327696*^9, 3.913448336760991*^9}, {
   3.913453409723026*^9, 3.9134534117416334`*^9}, 3.915083933836466*^9, {
   3.9154388182228947`*^9, 3.915438818248384*^9}},
 CellLabel->
  "In[1855]:=",ExpressionUUID->"4d579646-0369-4c41-b5c7-51e11d533929"]
}, Closed]],

Cell[CellGroupData[{

Cell["Scalar_K-mixing", "Section",
 CellChangeTimes->{{3.9134415168446145`*^9, 3.913441517813478*^9}, {
  3.913441586515154*^9, 3.9134415875071993`*^9}, {3.913441709585079*^9, 
  3.913441711662386*^9}, {3.913442140735273*^9, 3.913442145498228*^9}, {
  3.9137097926237316`*^9, 
  3.913709793345215*^9}},ExpressionUUID->"428b62d1-6456-489a-b805-\
3f6d1a2af3d3"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"proc", "=", "\"\<K-mixing\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"LLPv", "=", "\"\<Scalar\>\""}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "List", " ", "of", " ", "masses", " ", "for", " ", "which", " ", "the", 
    " ", "distribution", " ", "will", " ", "be", " ", "tabulated"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"MassList", "[", 
       RowBox[{"LLPv", ",", "proc", ",", "Facility"}], "]"}], "=", 
      RowBox[{"Select", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0.02", ",", "0.05", ",", "0.2", ",", "0.3", ",", 
          RowBox[{"0.99", 
           RowBox[{"MaxMass", "[", 
            RowBox[{"\"\<Scalar\>\"", ",", "SelectedFacility", ",", "proc"}], 
            "]"}]}]}], "}"}], ",", 
        RowBox[{
         RowBox[{"#", "<", 
          RowBox[{"MaxMass", "[", 
           RowBox[{"\"\<Scalar\>\"", ",", "SelectedFacility", ",", "proc"}], 
           "]"}]}], "&"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{"Facility", ",", "FacilitiesList"}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TabulatedPDF", "[", "mLLP_", "]"}], ":=", 
   RowBox[{"BlockTabulatedPDFsFromDecaysMass", "[", 
    RowBox[{
    "LLPv", ",", "SelectedFacility", ",", "mLLP", ",", "proc", ",", "nsim", 
     ",", 
     RowBox[{"\[Theta]Nlist", "[", "SelectedFacility", "]"}], ",", 
     RowBox[{"ENlist", "[", "SelectedFacility", "]"}], ",", 
     RowBox[{"\[Theta]minExtrFacility", "[", 
      RowBox[{"SelectedFacility", ",", "proc"}], "]"}], ",", 
     "\"\<False\>\""}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"filename", "=", 
   RowBox[{"filenameToExport", "[", 
    RowBox[{"LLPv", ",", "proc", ",", "SelectedFacility"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mlist", "=", 
   RowBox[{"MassList", "[", 
    RowBox[{"LLPv", ",", "proc", ",", "SelectedFacility"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tabulatedblock", "[", 
   RowBox[{"TabulatedPDF", ",", "mlist", ",", "filename"}], "]"}], "//", 
  "AbsoluteTiming"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"{", 
   RowBox[{"LLPv", ",", "proc", ",", "mlist"}], "}"}], "//", 
  "Clear"}]}], "Input",
 CellChangeTimes->{{3.913447449536884*^9, 3.913447637086103*^9}, {
   3.913447959385062*^9, 3.913447990395999*^9}, {3.913448030396103*^9, 
   3.913448049320239*^9}, {3.913453038617915*^9, 3.9134530410485325`*^9}, {
   3.913453424443082*^9, 3.9134534260653133`*^9}, {3.913709798996786*^9, 
   3.913709838047145*^9}, 3.915083933841454*^9, {3.9154388182604814`*^9, 
   3.915438818278961*^9}},
 CellLabel->
  "In[1741]:=",ExpressionUUID->"c2a64537-63ec-41c5-af12-708801d08728"]
}, Closed]],

Cell[CellGroupData[{

Cell["Scalar_Bremsstrahlung", "Section",
 CellChangeTimes->{{3.9134415168446145`*^9, 3.913441517813478*^9}, {
  3.913441586515154*^9, 3.9134415875071993`*^9}, {3.913441709585079*^9, 
  3.913441711662386*^9}, {3.913442140735273*^9, 3.913442145498228*^9}, {
  3.9137097926237316`*^9, 3.913709793345215*^9}, {3.9138084851794767`*^9, 
  3.913808487090199*^9}},ExpressionUUID->"010a69df-5572-4d9c-9c11-\
15b9580959c8"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"LLPv", "=", "\"\<Scalar\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"proc", "=", "\"\<Bremsstrahlung\>\""}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "List", " ", "of", " ", "masses", " ", "for", " ", "which", " ", "the", 
    " ", "distribution", " ", "will", " ", "be", " ", "tabulated"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"MassList", "[", 
       RowBox[{"LLPv", ",", "proc", ",", "Facility"}], "]"}], "=", 
      RowBox[{"Table", "[", 
       RowBox[{"mV", ",", 
        RowBox[{"{", 
         RowBox[{"mV", ",", "mVminFromBrem", ",", 
          RowBox[{"mVmaxFromBrem", "//", "N"}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"mVmaxFromBrem", "//", "N"}], ")"}], "-", 
             "mVminFromBrem"}], ")"}], "/", "10"}]}], "}"}]}], "]"}]}], ";"}],
     "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{"Facility", ",", "FacilitiesList"}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Theta]listBrem", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"\[Theta]Nlist", "[", "SelectedFacility", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Theta]maxBrem", "[", "SelectedFacility", "]"}], "}"}]}], 
      "]"}], "//", "DeleteDuplicates"}], "//", "Sort"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mlist", "=", 
   RowBox[{"MassList", "[", 
    RowBox[{"LLPv", ",", "proc", ",", "SelectedFacility"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BlockTabulatedPDFsFromBrem", "[", 
    RowBox[{"LLPv", ",", "SelectedFacility", ",", "mlist"}], "]"}], "//", 
   "AbsoluteTiming"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"TabulatedPDF", "[", "mLLP_", "]"}], ":=", 
      RowBox[{"BlockTabulatedPDFsFromBrem", "[", 
       RowBox[{
       "LLPv", ",", "mLLP", ",", "\[Theta]listBrem", ",", 
        "SelectedFacility"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"filename", "=", 
      RowBox[{"filenameToExport", "[", 
       RowBox[{"LLPv", ",", "proc", ",", "SelectedFacility"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"mlist", "=", 
      RowBox[{"MassList", "[", 
       RowBox[{"LLPv", ",", "proc", ",", "SelectedFacility"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"tabulatedblock", "[", 
      RowBox[{"TabulatedPDF", ",", "mlist", ",", "filename"}], "]"}], ";"}], "//",
     "AbsoluteTiming"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"{", 
   RowBox[{"LLPv", ",", "proc", ",", "mlist"}], "}"}], "//", 
  "Clear"}]}], "Input",
 CellChangeTimes->{{3.913447449536884*^9, 3.913447637086103*^9}, {
   3.913447959385062*^9, 3.913447990395999*^9}, {3.913448030396103*^9, 
   3.913448049320239*^9}, {3.913453038617915*^9, 3.9134530410485325`*^9}, {
   3.913453424443082*^9, 3.9134534260653133`*^9}, {3.913709798996786*^9, 
   3.913709838047145*^9}, {3.913808506989125*^9, 3.913808510329254*^9}, {
   3.913827395386332*^9, 3.913827431875143*^9}, 3.9140562156643724`*^9, {
   3.915438818286958*^9, 3.915438818309931*^9}, 3.91587696541369*^9, {
   3.917165696824815*^9, 
   3.917165697068122*^9}},ExpressionUUID->"adcd37db-f9ea-46f5-8d82-\
a679b8a37295"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["MCP", "Chapter",
 CellChangeTimes->{{3.91344144967334*^9, 3.913441455340948*^9}, {
   3.913441825113173*^9, 3.9134418258593936`*^9}, {3.913441936913423*^9, 
   3.9134419384733877`*^9}, {3.913442132020331*^9, 3.91344213360353*^9}, 
   3.9134482243227367`*^9, {3.91345317520315*^9, 3.9134531776043587`*^9}, {
   3.9134532278636904`*^9, 
   3.913453228043385*^9}},ExpressionUUID->"44a588f4-ac3c-4868-9adc-\
df21a540965e"],

Cell[CellGroupData[{

Cell["MCP_Pi0", "Section",
 CellChangeTimes->{{3.913453352185865*^9, 
  3.913453353528895*^9}},ExpressionUUID->"a8197812-02ef-4756-9aca-\
2cbb0f54c041"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"LLPv", "=", "\"\<MCP\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"proc", "=", "\"\<Pi0\>\""}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "List", " ", "of", " ", "masses", " ", "for", " ", "which", " ", "the", 
    " ", "distribution", " ", "will", " ", "be", " ", "tabulated"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"MassList", "[", 
       RowBox[{"LLPv", ",", "proc", ",", "Facility"}], "]"}], "=", 
      RowBox[{"{", 
       RowBox[{"0.02", ",", "0.05", ",", 
        RowBox[{
         FractionBox[
          RowBox[{"mSM", "[", "\"\<Pi0\>\"", "]"}], "2"], "*", "0.99"}]}], 
       "}"}]}], ";"}], "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{"Facility", ",", "FacilitiesList"}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TabulatedPDF", "[", "mLLP_", "]"}], ":=", 
   RowBox[{"BlockTabulatedPDFsFromDecaysMass", "[", 
    RowBox[{
    "LLPv", ",", "SelectedFacility", ",", "mLLP", ",", "proc", ",", "nsim", 
     ",", 
     RowBox[{"\[Theta]Nlist", "[", "SelectedFacility", "]"}], ",", 
     RowBox[{"ENlist", "[", "SelectedFacility", "]"}], ",", 
     RowBox[{"\[Theta]minExtrFacility", "[", 
      RowBox[{"SelectedFacility", ",", "proc"}], "]"}], ",", 
     "\"\<False\>\""}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"filename", "=", 
   RowBox[{"filenameToExport", "[", 
    RowBox[{"LLPv", ",", "proc", ",", "SelectedFacility"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mlist", "=", 
   RowBox[{"MassList", "[", 
    RowBox[{"LLPv", ",", "proc", ",", "SelectedFacility"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tabulatedblock", "[", 
   RowBox[{"TabulatedPDF", ",", "mlist", ",", "filename"}], "]"}], "//", 
  "AbsoluteTiming"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"{", 
   RowBox[{"LLPv", ",", "proc", ",", "mlist"}], "}"}], "//", 
  "Clear"}]}], "Input",
 CellChangeTimes->{{3.913453398917997*^9, 3.9134534876234827`*^9}, 
   3.915083933846015*^9, {3.915438818317926*^9, 3.915438818338147*^9}},
 CellLabel->
  "In[940]:=",ExpressionUUID->"6d14c362-9b35-4e0a-81ba-5dd6583753e5"]
}, Closed]],

Cell[CellGroupData[{

Cell["MCP_Eta", "Section",
 CellChangeTimes->{{3.913453352185865*^9, 3.91345336202357*^9}, 
   3.913453496631274*^9},ExpressionUUID->"6d2cac28-5a86-4d7e-8e88-\
d4e31e8cabe4"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"LLPv", "=", "\"\<MCP\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"proc", "=", "\"\<Eta\>\""}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "List", " ", "of", " ", "masses", " ", "for", " ", "which", " ", "the", 
    " ", "distribution", " ", "will", " ", "be", " ", "tabulated"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"MassList", "[", 
       RowBox[{"LLPv", ",", "proc", ",", "Facility"}], "]"}], "=", 
      RowBox[{"{", 
       RowBox[{"0.02", ",", "0.05", ",", "0.1", ",", "0.2", ",", 
        RowBox[{
         FractionBox[
          RowBox[{"mSM", "[", "\"\<Eta\>\"", "]"}], "2"], "*", "0.99"}]}], 
       "}"}]}], ";"}], "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{"Facility", ",", "FacilitiesList"}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TabulatedPDF", "[", "mLLP_", "]"}], ":=", 
   RowBox[{"BlockTabulatedPDFsFromDecaysMass", "[", 
    RowBox[{
    "LLPv", ",", "SelectedFacility", ",", "mLLP", ",", "proc", ",", "nsim", 
     ",", 
     RowBox[{"\[Theta]Nlist", "[", "SelectedFacility", "]"}], ",", 
     RowBox[{"ENlist", "[", "SelectedFacility", "]"}], ",", 
     RowBox[{"\[Theta]minExtrFacility", "[", 
      RowBox[{"SelectedFacility", ",", "proc"}], "]"}], ",", 
     "\"\<False\>\""}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"filename", "=", 
   RowBox[{"filenameToExport", "[", 
    RowBox[{"LLPv", ",", "proc", ",", "SelectedFacility"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mlist", "=", 
   RowBox[{"MassList", "[", 
    RowBox[{"LLPv", ",", "proc", ",", "SelectedFacility"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tabulatedblock", "[", 
   RowBox[{"TabulatedPDF", ",", "mlist", ",", "filename"}], "]"}], "//", 
  "AbsoluteTiming"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"{", 
   RowBox[{"LLPv", ",", "proc", ",", "mlist"}], "}"}], "//", 
  "Clear"}]}], "Input",
 CellChangeTimes->{{3.913453398917997*^9, 3.9134535140634174`*^9}, 
   3.915083933851003*^9, {3.9154388183506517`*^9, 3.915438818372321*^9}},
 CellLabel->
  "In[948]:=",ExpressionUUID->"0a504073-ea7c-4639-b415-5a80571a8059"]
}, Closed]],

Cell[CellGroupData[{

Cell["MCP_Phi", "Section",
 CellChangeTimes->{{3.913453352185865*^9, 
  3.913453365211176*^9}},ExpressionUUID->"fee03952-7996-482c-baca-\
9ba7f86eb782"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"LLPv", "=", "\"\<MCP\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"proc", "=", "\"\<Phi\>\""}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "List", " ", "of", " ", "masses", " ", "for", " ", "which", " ", "the", 
    " ", "distribution", " ", "will", " ", "be", " ", "tabulated"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"MassList", "[", 
       RowBox[{"LLPv", ",", "proc", ",", "Facility"}], "]"}], "=", 
      RowBox[{"Select", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "0.02", ",", "0.05", ",", "0.1", ",", "0.2", ",", "0.3", ",", "0.45",
           ",", 
          RowBox[{
           RowBox[{"MaxMass", "[", 
            RowBox[{"LLPv", ",", "Facility", ",", "proc"}], "]"}], "*", 
           "0.99"}]}], "}"}], ",", 
        RowBox[{
         RowBox[{"0", "<", "#", "<", 
          RowBox[{"MaxMass", "[", 
           RowBox[{"LLPv", ",", "Facility", ",", "proc"}], "]"}]}], "&"}]}], 
       "]"}]}], ";"}], "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{"Facility", ",", "FacilitiesList"}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TabulatedPDF", "[", "mLLP_", "]"}], ":=", 
   RowBox[{"BlockTabulatedPDFsFromDecaysMass", "[", 
    RowBox[{
    "LLPv", ",", "SelectedFacility", ",", "mLLP", ",", "proc", ",", "nsim", 
     ",", 
     RowBox[{"\[Theta]Nlist", "[", "SelectedFacility", "]"}], ",", 
     RowBox[{"ENlist", "[", "SelectedFacility", "]"}], ",", 
     RowBox[{"\[Theta]minExtrFacility", "[", 
      RowBox[{"SelectedFacility", ",", "proc"}], "]"}], ",", 
     "\"\<False\>\""}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"filename", "=", 
   RowBox[{"filenameToExport", "[", 
    RowBox[{"LLPv", ",", "proc", ",", "SelectedFacility"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mlist", "=", 
   RowBox[{"MassList", "[", 
    RowBox[{"LLPv", ",", "proc", ",", "SelectedFacility"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tabulatedblock", "[", 
   RowBox[{"TabulatedPDF", ",", "mlist", ",", "filename"}], "]"}], "//", 
  "AbsoluteTiming"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"{", 
   RowBox[{"LLPv", ",", "proc", ",", "mlist"}], "}"}], "//", 
  "Clear"}]}], "Input",
 CellChangeTimes->{{3.913453563572097*^9, 3.913453628958343*^9}, {
   3.9134537759088764`*^9, 3.913453779007164*^9}, 3.915083933856005*^9, {
   3.91543881838081*^9, 3.915438818405992*^9}},
 CellLabel->
  "In[956]:=",ExpressionUUID->"ae48d8e9-dbb5-4199-b93a-79c8587eacf3"]
}, Closed]],

Cell[CellGroupData[{

Cell["MCP_JPsi", "Section",
 CellChangeTimes->{{3.913453352185865*^9, 
  3.9134533678736973`*^9}},ExpressionUUID->"78852c84-b7b2-43c7-9d00-\
eded9c82a903"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"LLPv", "=", "\"\<MCP\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"proc", "=", "\"\<JPsi\>\""}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "List", " ", "of", " ", "masses", " ", "for", " ", "which", " ", "the", 
    " ", "distribution", " ", "will", " ", "be", " ", "tabulated"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"MassList", "[", 
       RowBox[{"LLPv", ",", "proc", ",", "Facility"}], "]"}], "=", 
      RowBox[{"Select", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "0.02", ",", "0.05", ",", "0.1", ",", "0.2", ",", "0.3", ",", "0.5", 
          ",", "0.7", ",", "1.", ",", "1.3", ",", 
          RowBox[{
           RowBox[{"MaxMass", "[", 
            RowBox[{"LLPv", ",", "Facility", ",", "proc"}], "]"}], "*", 
           "0.99"}]}], "}"}], ",", 
        RowBox[{
         RowBox[{"0", "<", "#", "<", 
          RowBox[{"MaxMass", "[", 
           RowBox[{"LLPv", ",", "Facility", ",", "proc"}], "]"}]}], "&"}]}], 
       "]"}]}], ";"}], "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{"Facility", ",", "FacilitiesList"}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TabulatedPDF", "[", "mLLP_", "]"}], ":=", 
   RowBox[{"BlockTabulatedPDFsFromDecaysMass", "[", 
    RowBox[{
    "LLPv", ",", "SelectedFacility", ",", "mLLP", ",", "proc", ",", "nsim", 
     ",", 
     RowBox[{"\[Theta]Nlist", "[", "SelectedFacility", "]"}], ",", 
     RowBox[{"ENlist", "[", "SelectedFacility", "]"}], ",", 
     RowBox[{"\[Theta]minExtrFacility", "[", 
      RowBox[{"SelectedFacility", ",", "proc"}], "]"}], ",", 
     "\"\<False\>\""}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"filename", "=", 
   RowBox[{"filenameToExport", "[", 
    RowBox[{"LLPv", ",", "proc", ",", "SelectedFacility"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mlist", "=", 
   RowBox[{"MassList", "[", 
    RowBox[{"LLPv", ",", "proc", ",", "SelectedFacility"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tabulatedblock", "[", 
   RowBox[{"TabulatedPDF", ",", "mlist", ",", "filename"}], "]"}], "//", 
  "AbsoluteTiming"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"{", 
   RowBox[{"LLPv", ",", "proc", ",", "mlist"}], "}"}], "//", 
  "Clear"}]}], "Input",
 CellChangeTimes->{{3.9134535687192*^9, 3.913453569208849*^9}, {
   3.913453636381206*^9, 3.913453651992774*^9}, {3.913453764575688*^9, 
   3.91345376874395*^9}, 3.915083933861015*^9, {3.915438818415987*^9, 
   3.9154388184464617`*^9}},
 CellLabel->
  "In[964]:=",ExpressionUUID->"73613ab9-1a32-4c06-a437-d2d5a1e0a9f8"]
}, Closed]],

Cell[CellGroupData[{

Cell["MCP_Rho0", "Section",
 CellChangeTimes->{{3.913453352185865*^9, 
  3.91345337152242*^9}},ExpressionUUID->"3d664a96-e56f-4964-b4e6-\
954083817918"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"LLPv", "=", "\"\<MCP\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"proc", "=", "\"\<Rho0\>\""}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "List", " ", "of", " ", "masses", " ", "for", " ", "which", " ", "the", 
    " ", "distribution", " ", "will", " ", "be", " ", "tabulated"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"MassList", "[", 
       RowBox[{"LLPv", ",", "proc", ",", "Facility"}], "]"}], "=", 
      RowBox[{"Select", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0.02", ",", "0.05", ",", "0.1", ",", "0.2", ",", "0.3", ",", 
          RowBox[{
           RowBox[{"MaxMass", "[", 
            RowBox[{"LLPv", ",", "Facility", ",", "proc"}], "]"}], "*", 
           "0.99"}]}], "}"}], ",", 
        RowBox[{
         RowBox[{"0", "<", "#", "<", 
          RowBox[{"MaxMass", "[", 
           RowBox[{"LLPv", ",", "Facility", ",", "proc"}], "]"}]}], "&"}]}], 
       "]"}]}], ";"}], "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{"Facility", ",", "FacilitiesList"}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TabulatedPDF", "[", "mLLP_", "]"}], ":=", 
   RowBox[{"BlockTabulatedPDFsFromDecaysMass", "[", 
    RowBox[{
    "LLPv", ",", "SelectedFacility", ",", "mLLP", ",", "proc", ",", "nsim", 
     ",", 
     RowBox[{"\[Theta]Nlist", "[", "SelectedFacility", "]"}], ",", 
     RowBox[{"ENlist", "[", "SelectedFacility", "]"}], ",", 
     RowBox[{"\[Theta]minExtrFacility", "[", 
      RowBox[{"SelectedFacility", ",", "proc"}], "]"}], ",", 
     "\"\<False\>\""}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"filename", "=", 
   RowBox[{"filenameToExport", "[", 
    RowBox[{"LLPv", ",", "proc", ",", "SelectedFacility"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mlist", "=", 
   RowBox[{"MassList", "[", 
    RowBox[{"LLPv", ",", "proc", ",", "SelectedFacility"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tabulatedblock", "[", 
   RowBox[{"TabulatedPDF", ",", "mlist", ",", "filename"}], "]"}], "//", 
  "AbsoluteTiming"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"{", 
   RowBox[{"LLPv", ",", "proc", ",", "mlist"}], "}"}], "//", 
  "Clear"}]}], "Input",
 CellChangeTimes->{{3.9134536878010798`*^9, 3.91345369346714*^9}, {
   3.9134537583905*^9, 3.913453761973124*^9}, 3.915083933866534*^9, {
   3.915438818458*^9, 3.9154388184827476`*^9}},
 CellLabel->
  "In[972]:=",ExpressionUUID->"ea97491a-c467-40cd-aad0-4e395f20ad06"]
}, Closed]],

Cell[CellGroupData[{

Cell["MCP_Omega", "Section",
 CellChangeTimes->{{3.913453352185865*^9, 
  3.9134533750469522`*^9}},ExpressionUUID->"6a0f58bd-44b1-402e-be7a-\
a6098d415606"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"LLPv", "=", "\"\<MCP\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"proc", "=", "\"\<Omega\>\""}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "List", " ", "of", " ", "masses", " ", "for", " ", "which", " ", "the", 
    " ", "distribution", " ", "will", " ", "be", " ", "tabulated"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"MassList", "[", 
       RowBox[{"LLPv", ",", "proc", ",", "Facility"}], "]"}], "=", 
      RowBox[{"Select", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0.02", ",", "0.05", ",", "0.1", ",", "0.2", ",", "0.3", ",", 
          RowBox[{
           RowBox[{"MaxMass", "[", 
            RowBox[{"LLPv", ",", "Facility", ",", "proc"}], "]"}], "*", 
           "0.99"}]}], "}"}], ",", 
        RowBox[{
         RowBox[{"0", "<", "#", "<", 
          RowBox[{"MaxMass", "[", 
           RowBox[{"LLPv", ",", "Facility", ",", "proc"}], "]"}]}], "&"}]}], 
       "]"}]}], ";"}], "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{"Facility", ",", "FacilitiesList"}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TabulatedPDF", "[", "mLLP_", "]"}], ":=", 
   RowBox[{"BlockTabulatedPDFsFromDecaysMass", "[", 
    RowBox[{
    "LLPv", ",", "SelectedFacility", ",", "mLLP", ",", "proc", ",", "nsim", 
     ",", 
     RowBox[{"\[Theta]Nlist", "[", "SelectedFacility", "]"}], ",", 
     RowBox[{"ENlist", "[", "SelectedFacility", "]"}], ",", 
     RowBox[{"\[Theta]minExtrFacility", "[", 
      RowBox[{"SelectedFacility", ",", "proc"}], "]"}], ",", 
     "\"\<False\>\""}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"filename", "=", 
   RowBox[{"filenameToExport", "[", 
    RowBox[{"LLPv", ",", "proc", ",", "SelectedFacility"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mlist", "=", 
   RowBox[{"MassList", "[", 
    RowBox[{"LLPv", ",", "proc", ",", "SelectedFacility"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tabulatedblock", "[", 
   RowBox[{"TabulatedPDF", ",", "mlist", ",", "filename"}], "]"}], "//", 
  "AbsoluteTiming"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"{", 
   RowBox[{"LLPv", ",", "proc", ",", "mlist"}], "}"}], "//", 
  "Clear"}]}], "Input",
 CellChangeTimes->{{3.9134537021334953`*^9, 3.913453702721325*^9}, {
   3.913453743598807*^9, 3.9134537506009874`*^9}, 3.915083933872041*^9, {
   3.915438818494852*^9, 3.9154388185251107`*^9}},
 CellLabel->
  "In[980]:=",ExpressionUUID->"bd523f4c-a69c-4d9a-aa45-bb914d906c33"]
}, Closed]],

Cell[CellGroupData[{

Cell["MCP_Upsilon", "Section",
 CellChangeTimes->{{3.913453352185865*^9, 
  3.9134533782464876`*^9}},ExpressionUUID->"8fd04a6c-a6bd-4e55-afdb-\
03712e9df8cb"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"LLPv", "=", "\"\<MCP\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"proc", "=", "\"\<Upsilon\>\""}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "List", " ", "of", " ", "masses", " ", "for", " ", "which", " ", "the", 
    " ", "distribution", " ", "will", " ", "be", " ", "tabulated"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"MassList", "[", 
       RowBox[{"LLPv", ",", "proc", ",", "Facility"}], "]"}], "=", 
      RowBox[{"Select", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0.02", ",", "0.05", ",", "0.1", ",", "0.2", ",", "0.3", ",", 
          RowBox[{
           RowBox[{"MaxMass", "[", 
            RowBox[{"LLPv", ",", "Facility", ",", "proc"}], "]"}], "*", 
           "0.99"}]}], "}"}], ",", 
        RowBox[{
         RowBox[{"0", "<", "#", "<", 
          RowBox[{"MaxMass", "[", 
           RowBox[{"LLPv", ",", "Facility", ",", "proc"}], "]"}]}], "&"}]}], 
       "]"}]}], ";"}], "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{"Facility", ",", "FacilitiesList"}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TabulatedPDF", "[", "mLLP_", "]"}], ":=", 
   RowBox[{"BlockTabulatedPDFsFromDecaysMass", "[", 
    RowBox[{
    "LLPv", ",", "SelectedFacility", ",", "mLLP", ",", "proc", ",", "nsim", 
     ",", 
     RowBox[{"\[Theta]Nlist", "[", "SelectedFacility", "]"}], ",", 
     RowBox[{"ENlist", "[", "SelectedFacility", "]"}], ",", 
     RowBox[{"\[Theta]minExtrFacility", "[", 
      RowBox[{"SelectedFacility", ",", "proc"}], "]"}], ",", 
     "\"\<False\>\""}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"filename", "=", 
   RowBox[{"filenameToExport", "[", 
    RowBox[{"LLPv", ",", "proc", ",", "SelectedFacility"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mlist", "=", 
   RowBox[{"MassList", "[", 
    RowBox[{"LLPv", ",", "proc", ",", "SelectedFacility"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tabulatedblock", "[", 
   RowBox[{"TabulatedPDF", ",", "mlist", ",", "filename"}], "]"}], "//", 
  "AbsoluteTiming"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"{", 
   RowBox[{"LLPv", ",", "proc", ",", "mlist"}], "}"}], "//", 
  "Clear"}]}], "Input",
 CellChangeTimes->{{3.9134537073423805`*^9, 3.913453735839065*^9}, 
   3.915083933877155*^9, {3.915438818536619*^9, 
   3.91543881856163*^9}},ExpressionUUID->"6f957d25-6dec-4af9-a685-\
15a21b940d65"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["DP", "Chapter",
 CellChangeTimes->{{3.91344144967334*^9, 3.913441455340948*^9}, {
   3.913441825113173*^9, 3.9134418258593936`*^9}, {3.913441936913423*^9, 
   3.9134419384733877`*^9}, {3.913442132020331*^9, 3.91344213360353*^9}, 
   3.9134482243227367`*^9, {3.91345317520315*^9, 3.9134531776043587`*^9}, {
   3.917340452513105*^9, 
   3.917340452589266*^9}},ExpressionUUID->"e18f2a4f-1511-4779-87a6-\
46fa379f64bc"],

Cell[CellGroupData[{

Cell["DP_Bremsstrahlung", "Section",
 CellChangeTimes->{{3.913453352185865*^9, 3.9134533782464876`*^9}, {
   3.913453922929523*^9, 3.913453926944298*^9}, 
   3.913711197462783*^9},ExpressionUUID->"3867b48b-b17b-4056-8c33-\
23d5dcd435ac"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"LLPv", "=", "\"\<DP\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"proc", "=", "\"\<Bremsstrahlung\>\""}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "List", " ", "of", " ", "masses", " ", "for", " ", "which", " ", "the", 
    " ", "distribution", " ", "will", " ", "be", " ", "tabulated"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"MassList", "[", 
       RowBox[{"LLPv", ",", "proc", ",", "Facility"}], "]"}], "=", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{"mV", ",", 
         RowBox[{"{", 
          RowBox[{"mV", ",", "mVminFromBrem", ",", "mVmaxFromBrem", ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"mVmaxFromBrem", "-", "mVminFromBrem"}], ")"}], "/", 
            "22"}]}], "}"}]}], "]"}], "//", "N"}]}], ";"}], 
    "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{"Facility", ",", "FacilitiesList"}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Theta]listBrem", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"\[Theta]Nlist", "[", "SelectedFacility", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Theta]maxBrem", "[", "SelectedFacility", "]"}], "}"}]}], 
      "]"}], "//", "DeleteDuplicates"}], "//", "Sort"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mlist", "=", 
   RowBox[{"MassList", "[", 
    RowBox[{"LLPv", ",", "proc", ",", "SelectedFacility"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"BlockTabulatedPDFsFromBrem", "[", 
     RowBox[{"LLPv", ",", "SelectedFacility", ",", "mlist"}], "]"}], ";"}], "//",
    "AbsoluteTiming"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"TabulatedPDF", "[", "mLLP_", "]"}], ":=", 
      RowBox[{"BlockTabulatedPDFsFromBrem", "[", 
       RowBox[{
       "LLPv", ",", "mLLP", ",", "\[Theta]listBrem", ",", 
        "SelectedFacility"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"filename", "=", 
      RowBox[{"filenameToExport", "[", 
       RowBox[{"LLPv", ",", "proc", ",", "SelectedFacility"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"mlist", "=", 
      RowBox[{"MassList", "[", 
       RowBox[{"LLPv", ",", "proc", ",", "SelectedFacility"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"tabulatedblock", "[", 
      RowBox[{"TabulatedPDF", ",", "mlist", ",", "filename"}], "]"}], ";"}], "//",
     "AbsoluteTiming"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"{", 
   RowBox[{"LLPv", ",", "proc", ",", "mlist"}], "}"}], "//", 
  "Clear"}]}], "Input",
 CellChangeTimes->{{3.913457551250987*^9, 3.913457646228073*^9}, {
   3.913460464105325*^9, 3.913460464216425*^9}, {3.913461240924551*^9, 
   3.913461246579915*^9}, {3.91346132605719*^9, 3.913461391391589*^9}, 
   3.913827445926437*^9, 3.913888832299034*^9, {3.9140560944852057`*^9, 
   3.914056155187054*^9}, {3.914494736802878*^9, 3.914494746760509*^9}, {
   3.915438818570635*^9, 3.9154388185996647`*^9}, {3.916847196996725*^9, 
   3.916847199514638*^9}, {3.9171648885090494`*^9, 3.917164890102831*^9}, 
   3.9171657097848034`*^9, {3.917859885143154*^9, 3.9178598891873274`*^9}},
 CellLabel->
  "In[1206]:=",ExpressionUUID->"89f2fc85-2fb9-4bc8-b97e-5a8f182395aa"],

Cell[BoxData[
 FormBox[
  RowBox[{
   StyleBox[
    RowBox[{"NIntegrate", "::", "slwcon"}], "MessageName"], " ", ":", 
   "  ", "\<\"Numerical integration converging too slowly; suspect one of the \
following: singularity, value of the integration is 0, highly oscillatory \
integrand, or WorkingPrecision too small.\"\>"}], TraditionalForm]], "Message",\
 "MSG",
 ShowCellLabel->True,
 CellChangeTimes->{3.930211685216854*^9},
 CellLabel->
  "(kernel 5)",ExpressionUUID->"ff26d495-9f11-471d-89f4-e217d0208685"],

Cell[BoxData[
 FormBox[
  RowBox[{
   StyleBox[
    RowBox[{"NIntegrate", "::", "slwcon"}], "MessageName"], " ", ":", 
   "  ", "\<\"Numerical integration converging too slowly; suspect one of the \
following: singularity, value of the integration is 0, highly oscillatory \
integrand, or WorkingPrecision too small.\"\>"}], TraditionalForm]], "Message",\
 "MSG",
 ShowCellLabel->True,
 CellChangeTimes->{3.9302116952669764`*^9},
 CellLabel->
  "(kernel 8)",ExpressionUUID->"4477a153-e295-42e1-aff7-c13727623d50"],

Cell[BoxData[
 FormBox[
  RowBox[{
   StyleBox[
    RowBox[{"NIntegrate", "::", "slwcon"}], "MessageName"], " ", ":", 
   "  ", "\<\"Numerical integration converging too slowly; suspect one of the \
following: singularity, value of the integration is 0, highly oscillatory \
integrand, or WorkingPrecision too small.\"\>"}], TraditionalForm]], "Message",\
 "MSG",
 ShowCellLabel->True,
 CellChangeTimes->{3.930211700343841*^9},
 CellLabel->
  "(kernel 7)",ExpressionUUID->"054b17ce-6807-44f6-beee-724e663e662d"],

Cell[BoxData[
 FormBox[
  RowBox[{
   StyleBox[
    RowBox[{"NIntegrate", "::", "slwcon"}], "MessageName"], " ", ":", 
   "  ", "\<\"Numerical integration converging too slowly; suspect one of the \
following: singularity, value of the integration is 0, highly oscillatory \
integrand, or WorkingPrecision too small.\"\>"}], TraditionalForm]], "Message",\
 "MSG",
 ShowCellLabel->True,
 CellChangeTimes->{3.930211705450922*^9},
 CellLabel->
  "(kernel 7)",ExpressionUUID->"2c21d4d4-6425-45a3-8672-8a5fc1646a9c"],

Cell[BoxData[
 FormBox[
  RowBox[{
   StyleBox[
    RowBox[{"NIntegrate", "::", "slwcon"}], "MessageName"], " ", ":", 
   "  ", "\<\"Numerical integration converging too slowly; suspect one of the \
following: singularity, value of the integration is 0, highly oscillatory \
integrand, or WorkingPrecision too small.\"\>"}], TraditionalForm]], "Message",\
 "MSG",
 ShowCellLabel->True,
 CellChangeTimes->{3.930211705527872*^9},
 CellLabel->
  "(kernel 5)",ExpressionUUID->"7ce4e0aa-a971-4d7f-b7c9-35f72fd4323e"],

Cell[BoxData[
 FormBox[
  RowBox[{
   StyleBox[
    RowBox[{"NIntegrate", "::", "slwcon"}], "MessageName"], " ", ":", 
   "  ", "\<\"Numerical integration converging too slowly; suspect one of the \
following: singularity, value of the integration is 0, highly oscillatory \
integrand, or WorkingPrecision too small.\"\>"}], TraditionalForm]], "Message",\
 "MSG",
 ShowCellLabel->True,
 CellChangeTimes->{3.930211710540711*^9},
 CellLabel->
  "(kernel 6)",ExpressionUUID->"3439519a-c5c1-497d-a9ed-008d51935043"],

Cell[BoxData[
 FormBox[
  RowBox[{
   StyleBox[
    RowBox[{"NIntegrate", "::", "slwcon"}], "MessageName"], " ", ":", 
   "  ", "\<\"Numerical integration converging too slowly; suspect one of the \
following: singularity, value of the integration is 0, highly oscillatory \
integrand, or WorkingPrecision too small.\"\>"}], TraditionalForm]], "Message",\
 "MSG",
 ShowCellLabel->True,
 CellChangeTimes->{3.930211710640027*^9},
 CellLabel->
  "(kernel 5)",ExpressionUUID->"984ded1b-4346-4852-8507-33b95501c8b6"],

Cell[BoxData[
 FormBox[
  RowBox[{
   StyleBox[
    RowBox[{"NIntegrate", "::", "slwcon"}], "MessageName"], " ", ":", 
   "  ", "\<\"Numerical integration converging too slowly; suspect one of the \
following: singularity, value of the integration is 0, highly oscillatory \
integrand, or WorkingPrecision too small.\"\>"}], TraditionalForm]], "Message",\
 "MSG",
 ShowCellLabel->True,
 CellChangeTimes->{3.930211715643612*^9},
 CellLabel->
  "(kernel 6)",ExpressionUUID->"8693bfc1-b800-44cf-bbbd-4875abf81bfb"],

Cell[BoxData[
 FormBox[
  RowBox[{
   StyleBox[
    RowBox[{"NIntegrate", "::", "slwcon"}], "MessageName"], " ", ":", 
   "  ", "\<\"Numerical integration converging too slowly; suspect one of the \
following: singularity, value of the integration is 0, highly oscillatory \
integrand, or WorkingPrecision too small.\"\>"}], TraditionalForm]], "Message",\
 "MSG",
 ShowCellLabel->True,
 CellChangeTimes->{3.9302117157269278`*^9},
 CellLabel->
  "(kernel 5)",ExpressionUUID->"3ac65254-99bd-4bc8-9558-58031e7f2ae4"],

Cell[BoxData[
 FormBox[
  RowBox[{
   StyleBox[
    RowBox[{"General", "::", "stop"}], "MessageName"], " ", ":", 
   "  ", "\<\"Further output of \
\\!\\(\\*FormBox[StyleBox[RowBox[{\\\"NIntegrate\\\", \\\"::\\\", \
\\\"slwcon\\\"}], \\\"MessageName\\\"], TraditionalForm]\\) will be \
suppressed during this calculation.\"\>"}], TraditionalForm]], "Message", \
"MSG",
 ShowCellLabel->True,
 CellChangeTimes->{3.930211715747469*^9},
 CellLabel->
  "(kernel 5)",ExpressionUUID->"1ade5be9-0038-48db-85f6-94b97f7d481e"],

Cell[BoxData[
 FormBox[
  RowBox[{"{", 
   RowBox[{"81.486431`", ",", "Null"}], "}"}], TraditionalForm]], "Output",
 CellChangeTimes->{3.930211761524036*^9},
 CellLabel->
  "Out[1211]=",ExpressionUUID->"10a539e6-3afd-4f56-8906-6ea6cd830a5c"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["DP_Pi0", "Section",
 CellChangeTimes->{{3.913453352185865*^9, 3.9134533782464876`*^9}, {
  3.913453922929523*^9, 
  3.9134539415854807`*^9}},ExpressionUUID->"4f8a695c-eca1-427a-b0b3-\
29376ac24f12"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"LLPv", "=", "\"\<DP\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"proc", "=", "\"\<Pi0\>\""}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "List", " ", "of", " ", "masses", " ", "for", " ", "which", " ", "the", 
    " ", "distribution", " ", "will", " ", "be", " ", "tabulated"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"MassList", "[", 
       RowBox[{"LLPv", ",", "proc", ",", "Facility"}], "]"}], "=", 
      RowBox[{"Select", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0.02", ",", "0.05", ",", "0.1", ",", 
          RowBox[{
           RowBox[{"MaxMass", "[", 
            RowBox[{"LLPv", ",", "Facility", ",", "proc"}], "]"}], "*", 
           "0.99"}]}], "}"}], ",", 
        RowBox[{
         RowBox[{"0", "<", "#", "<", 
          RowBox[{"MaxMass", "[", 
           RowBox[{"LLPv", ",", "Facility", ",", "proc"}], "]"}]}], "&"}]}], 
       "]"}]}], ";"}], "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{"Facility", ",", "FacilitiesList"}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TabulatedPDF", "[", "mLLP_", "]"}], ":=", 
   RowBox[{"BlockTabulatedPDFsFromDecaysMass", "[", 
    RowBox[{
    "LLPv", ",", "SelectedFacility", ",", "mLLP", ",", "proc", ",", "nsim", 
     ",", 
     RowBox[{"\[Theta]NlistLight", "[", "SelectedFacility", "]"}], ",", 
     RowBox[{"ENlist", "[", "SelectedFacility", "]"}], ",", 
     RowBox[{"\[Theta]minExtrFacility", "[", 
      RowBox[{"SelectedFacility", ",", "proc"}], "]"}], ",", 
     "\"\<False\>\""}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"filename", "=", 
   RowBox[{"filenameToExport", "[", 
    RowBox[{"LLPv", ",", "proc", ",", "SelectedFacility"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mlist", "=", 
   RowBox[{"MassList", "[", 
    RowBox[{"LLPv", ",", "proc", ",", "SelectedFacility"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tabulatedblock", "[", 
   RowBox[{"TabulatedPDF", ",", "mlist", ",", "filename"}], "]"}], "//", 
  "AbsoluteTiming"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"{", 
   RowBox[{"LLPv", ",", "proc", ",", "mlist"}], "}"}], "//", 
  "Clear"}]}], "Input",
 CellChangeTimes->{{3.9134539970875425`*^9, 3.9134540004022136`*^9}, {
   3.913454051763443*^9, 3.913454052133419*^9}, 3.915083933882143*^9, {
   3.915438818607714*^9, 3.9154388186374116`*^9}, {3.917281591443675*^9, 
   3.9172815919346685`*^9}},
 CellLabel->
  "In[1182]:=",ExpressionUUID->"ea2d17b1-6832-4c8b-83b7-de080d51ce24"],

Cell[BoxData[
 FormBox[
  RowBox[{"{", 
   RowBox[{"5.820773`", ",", "Null"}], "}"}], TraditionalForm]], "Output",
 CellChangeTimes->{3.930211654865879*^9},
 CellLabel->
  "Out[1188]=",ExpressionUUID->"03fcd51c-dcfe-4787-b8c8-2a6dc5169e3c"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["DP_Eta", "Section",
 CellChangeTimes->{{3.913453352185865*^9, 3.9134533782464876`*^9}, {
  3.913453922929523*^9, 
  3.91345394437442*^9}},ExpressionUUID->"21268ba0-af89-46ad-8db8-\
c2c852874af8"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"LLPv", "=", "\"\<DP\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"proc", "=", "\"\<Eta\>\""}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "List", " ", "of", " ", "masses", " ", "for", " ", "which", " ", "the", 
    " ", "distribution", " ", "will", " ", "be", " ", "tabulated"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"MassList", "[", 
       RowBox[{"LLPv", ",", "proc", ",", "Facility"}], "]"}], "=", 
      RowBox[{"Select", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "0.02", ",", "0.05", ",", "0.1", ",", "0.2", ",", "0.3", ",", "0.45",
           ",", 
          RowBox[{
           RowBox[{"MaxMass", "[", 
            RowBox[{"LLPv", ",", "Facility", ",", "proc"}], "]"}], "*", 
           "0.99"}]}], "}"}], ",", 
        RowBox[{
         RowBox[{"0", "<", "#", "<", 
          RowBox[{"MaxMass", "[", 
           RowBox[{"LLPv", ",", "Facility", ",", "proc"}], "]"}]}], "&"}]}], 
       "]"}]}], ";"}], "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{"Facility", ",", "FacilitiesList"}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TabulatedPDF", "[", "mLLP_", "]"}], ":=", 
   RowBox[{"BlockTabulatedPDFsFromDecaysMass", "[", 
    RowBox[{
    "LLPv", ",", "SelectedFacility", ",", "mLLP", ",", "proc", ",", "nsim", 
     ",", 
     RowBox[{"\[Theta]NlistLight", "[", "SelectedFacility", "]"}], ",", 
     RowBox[{"ENlist", "[", "SelectedFacility", "]"}], ",", 
     RowBox[{"\[Theta]minExtrFacility", "[", 
      RowBox[{"SelectedFacility", ",", "proc"}], "]"}], ",", 
     "\"\<False\>\""}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"filename", "=", 
   RowBox[{"filenameToExport", "[", 
    RowBox[{"LLPv", ",", "proc", ",", "SelectedFacility"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mlist", "=", 
   RowBox[{"MassList", "[", 
    RowBox[{"LLPv", ",", "proc", ",", "SelectedFacility"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tabulatedblock", "[", 
   RowBox[{"TabulatedPDF", ",", "mlist", ",", "filename"}], "]"}], "//", 
  "AbsoluteTiming"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"{", 
   RowBox[{"LLPv", ",", "proc", ",", "mlist"}], "}"}], "//", 
  "Clear"}]}], "Input",
 CellChangeTimes->{{3.913454045623446*^9, 3.913454071794718*^9}, 
   3.9150839338863173`*^9, {3.915438818649909*^9, 3.915438818677471*^9}, 
   3.9172816066186132`*^9},
 CellLabel->
  "In[1190]:=",ExpressionUUID->"4043af29-8297-4ae9-b68b-a7ac8ba30063"],

Cell[BoxData[
 FormBox[
  RowBox[{"{", 
   RowBox[{"10.51186`", ",", "Null"}], "}"}], TraditionalForm]], "Output",
 CellChangeTimes->{3.93021166542148*^9},
 CellLabel->
  "Out[1196]=",ExpressionUUID->"cb336005-fd08-4152-83e6-6df51ee1d0a7"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["DP_EtaPr", "Section",
 CellChangeTimes->{{3.913453352185865*^9, 3.9134533782464876`*^9}, {
  3.913453922929523*^9, 
  3.9134539472505245`*^9}},ExpressionUUID->"b637261e-5f38-43f1-9aed-\
21ea0fffb69b"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"LLPv", "=", "\"\<DP\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"proc", "=", "\"\<EtaPr\>\""}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "List", " ", "of", " ", "masses", " ", "for", " ", "which", " ", "the", 
    " ", "distribution", " ", "will", " ", "be", " ", "tabulated"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"MassList", "[", 
       RowBox[{"LLPv", ",", "proc", ",", "Facility"}], "]"}], "=", 
      RowBox[{"Select", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "0.02", ",", "0.05", ",", "0.1", ",", "0.2", ",", "0.3", ",", "0.5", 
          ",", "0.7", ",", "0.9", ",", 
          RowBox[{
           RowBox[{"MaxMass", "[", 
            RowBox[{"LLPv", ",", "Facility", ",", "proc"}], "]"}], "*", 
           "0.99"}]}], "}"}], ",", 
        RowBox[{
         RowBox[{"0", "<", "#", "<", 
          RowBox[{"MaxMass", "[", 
           RowBox[{"LLPv", ",", "Facility", ",", "proc"}], "]"}]}], "&"}]}], 
       "]"}]}], ";"}], "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{"Facility", ",", "FacilitiesList"}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TabulatedPDF", "[", "mLLP_", "]"}], ":=", 
   RowBox[{"BlockTabulatedPDFsFromDecaysMass", "[", 
    RowBox[{
    "LLPv", ",", "SelectedFacility", ",", "mLLP", ",", "proc", ",", "nsim", 
     ",", 
     RowBox[{"\[Theta]NlistLight", "[", "SelectedFacility", "]"}], ",", 
     RowBox[{"ENlist", "[", "SelectedFacility", "]"}], ",", 
     RowBox[{"\[Theta]minExtrFacility", "[", 
      RowBox[{"SelectedFacility", ",", "proc"}], "]"}], ",", 
     "\"\<False\>\""}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"filename", "=", 
   RowBox[{"filenameToExport", "[", 
    RowBox[{"LLPv", ",", "proc", ",", "SelectedFacility"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mlist", "=", 
   RowBox[{"MassList", "[", 
    RowBox[{"LLPv", ",", "proc", ",", "SelectedFacility"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tabulatedblock", "[", 
   RowBox[{"TabulatedPDF", ",", "mlist", ",", "filename"}], "]"}], "//", 
  "AbsoluteTiming"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"{", 
   RowBox[{"LLPv", ",", "proc", ",", "mlist"}], "}"}], "//", 
  "Clear"}]}], "Input",
 CellChangeTimes->{{3.913454078743132*^9, 3.913454084343245*^9}, 
   3.915083933891303*^9, {3.915438818686054*^9, 3.915438818711033*^9}, 
   3.917281611790371*^9},
 CellLabel->
  "In[1198]:=",ExpressionUUID->"b844b0c2-dda3-490f-942a-5905a10479e9"],

Cell[BoxData[
 FormBox[
  RowBox[{"{", 
   RowBox[{"14.530802`", ",", "Null"}], "}"}], TraditionalForm]], "Output",
 CellChangeTimes->{3.930211679995401*^9},
 CellLabel->
  "Out[1204]=",ExpressionUUID->"195ad73b-c093-400e-9471-6dae2e02109a"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["DP_Rho0", "Section",
 CellChangeTimes->{{3.913453352185865*^9, 3.9134533782464876`*^9}, {
  3.913453922929523*^9, 
  3.913453955095156*^9}},ExpressionUUID->"967b5acc-e7f2-4620-8c96-\
0a4eee9552a8"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"LLPv", "=", "\"\<DP\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"proc", "=", "\"\<Rho0\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"MassList", "[", 
       RowBox[{"LLPv", ",", "proc", ",", "Facility"}], "]"}], "=", 
      RowBox[{"Select", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "0.02", ",", "0.05", ",", "0.1", ",", "0.3", ",", "0.5", ",", "0.77",
           ",", "1.", ",", "1.2", ",", "1.3", ",", "1.4", ",", "1.5", ",", 
          "1.6", ",", "1.7", ",", "1.8", ",", "1.9", ",", "2.", ",", "2.1", 
          ",", "2.2", ",", "2.3", ",", "2.4", ",", "2.5", ",", "2.6", ",", 
          "2.7", ",", "2.8", ",", "2.9", ",", "3.", ",", "3.1", ",", "3.2", 
          ",", "3.3", ",", "3.5"}], "}"}], ",", 
        RowBox[{
         RowBox[{"0", "<", "#", "<", 
          RowBox[{"MaxMass", "[", 
           RowBox[{"LLPv", ",", "Facility", ",", "proc"}], "]"}]}], "&"}]}], 
       "]"}]}], ";"}], "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{"Facility", ",", "FacilitiesList"}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TabulatedPDF", "[", "mLLP_", "]"}], ":=", 
   RowBox[{"BlockTabulatedPDFsFromMixingsMass", "[", 
    RowBox[{
    "LLPv", ",", "SelectedFacility", ",", "mLLP", ",", "proc", ",", "nsim", 
     ",", 
     RowBox[{"\[Theta]NlistLight", "[", "SelectedFacility", "]"}], ",", 
     RowBox[{"ENlist", "[", "SelectedFacility", "]"}], ",", 
     RowBox[{"\[Theta]minExtrFacility", "[", 
      RowBox[{"SelectedFacility", ",", "proc"}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mlist", "=", 
   RowBox[{"MassList", "[", 
    RowBox[{"LLPv", ",", "proc", ",", "SelectedFacility"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"filename", "=", 
   RowBox[{"filenameToExport", "[", 
    RowBox[{"LLPv", ",", "proc", ",", "SelectedFacility"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tabulatedblock", "[", 
   RowBox[{"TabulatedPDF", ",", "mlist", ",", "filename"}], "]"}], "//", 
  "AbsoluteTiming"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"{", 
   RowBox[{"LLPv", ",", "proc", ",", "mlist"}], "}"}], "//", 
  "Clear"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.9134598115456*^9, 3.913460057146787*^9}, {
   3.9134600913866944`*^9, 3.9134601415454865`*^9}, {3.913460487915667*^9, 
   3.9134605161660013`*^9}, {3.913460556176756*^9, 3.91346055780594*^9}, {
   3.9143991176421185`*^9, 3.914399141311505*^9}, {3.915438818719019*^9, 
   3.9154388187410283`*^9}, {3.916484706738619*^9, 3.916484710814911*^9}, {
   3.9164848786425843`*^9, 3.916484923479421*^9}, 3.9172816166809006`*^9},
 CellLabel->
  "In[1213]:=",ExpressionUUID->"fe6abf7a-2c18-4e14-b9cd-14aa6668723d"],

Cell[BoxData[
 FormBox[
  RowBox[{"{", 
   RowBox[{"42.104393`", ",", "Null"}], "}"}], TraditionalForm]], "Output",
 CellChangeTimes->{3.9302118036829157`*^9},
 CellLabel->
  "Out[1219]=",ExpressionUUID->"b1a7c303-df76-4c04-a254-ad132067f39e"]
}, Closed]]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["B-L", "Chapter",
 CellChangeTimes->{{3.91344144967334*^9, 3.913441455340948*^9}, {
   3.913441825113173*^9, 3.9134418258593936`*^9}, {3.913441936913423*^9, 
   3.9134419384733877`*^9}, {3.913442132020331*^9, 3.91344213360353*^9}, 
   3.9134482243227367`*^9, {3.91345317520315*^9, 3.9134531776043587`*^9}, {
   3.9134539629830503`*^9, 
   3.913453963424157*^9}},ExpressionUUID->"3b4a9075-fad5-4efb-849a-\
40a2956706d2"],

Cell[CellGroupData[{

Cell["B-L_Bremsstrahlung", "Section",
 CellChangeTimes->{{3.913453352185865*^9, 3.9134533782464876`*^9}, {
  3.913453922929523*^9, 3.913453926944298*^9}, {3.913458295350587*^9, 
  3.913458296391029*^9}, {3.9139726988411436`*^9, 
  3.9139726989164495`*^9}},ExpressionUUID->"9ea85647-f1d7-4f09-a601-\
da12fb44b8ef"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"LLPv", "=", "\"\<B-L\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"proc", "=", "\"\<Bremsstrahlung\>\""}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "List", " ", "of", " ", "masses", " ", "for", " ", "which", " ", "the", 
    " ", "distribution", " ", "will", " ", "be", " ", "tabulated"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"MassList", "[", 
       RowBox[{"LLPv", ",", "proc", ",", "Facility"}], "]"}], "=", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{"mV", ",", 
         RowBox[{"{", 
          RowBox[{"mV", ",", "mVminFromBrem", ",", "mVmaxFromBrem", ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", "mVmaxFromBrem", ")"}], "-", "mVminFromBrem"}], 
             ")"}], "/", "20"}]}], "}"}]}], "]"}], "//", "N"}]}], ";"}], 
    "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{"Facility", ",", "FacilitiesList"}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Theta]listBrem", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"\[Theta]Nlist", "[", "SelectedFacility", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Theta]maxBrem", "[", "SelectedFacility", "]"}], "}"}]}], 
      "]"}], "//", "DeleteDuplicates"}], "//", "Sort"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mlist", "=", 
   RowBox[{"MassList", "[", 
    RowBox[{"LLPv", ",", "proc", ",", "SelectedFacility"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BlockTabulatedPDFsFromBrem", "[", 
    RowBox[{"LLPv", ",", "SelectedFacility", ",", "mlist"}], "]"}], "//", 
   "AbsoluteTiming"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"TabulatedPDF", "[", "mLLP_", "]"}], ":=", 
      RowBox[{"BlockTabulatedPDFsFromBrem", "[", 
       RowBox[{
       "LLPv", ",", "mLLP", ",", "\[Theta]listBrem", ",", 
        "SelectedFacility"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"filename", "=", 
      RowBox[{"filenameToExport", "[", 
       RowBox[{"LLPv", ",", "proc", ",", "SelectedFacility"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"mlist", "=", 
      RowBox[{"MassList", "[", 
       RowBox[{"LLPv", ",", "proc", ",", "SelectedFacility"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"tabulatedblock", "[", 
      RowBox[{"TabulatedPDF", ",", "mlist", ",", "filename"}], "]"}], ";"}], "//",
     "AbsoluteTiming"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"{", 
   RowBox[{"LLPv", ",", "proc", ",", "mlist"}], "}"}], "//", 
  "Clear"}]}], "Input",
 CellChangeTimes->{{3.913457551250987*^9, 3.913457646228073*^9}, {
   3.913458630065926*^9, 3.913458638183439*^9}, {3.913461405272519*^9, 
   3.913461433780708*^9}, 3.913827457266136*^9, 3.914056189649167*^9, 
   3.914494758925645*^9, {3.915438818750021*^9, 3.915438818774499*^9}, 
   3.915876571322917*^9, 3.9171657092262487`*^9},
 CellLabel->
  "In[1732]:=",ExpressionUUID->"e9394e5b-bf3e-4732-80cb-d39e2fa391f2"]
}, Closed]],

Cell[CellGroupData[{

Cell["B-L_Pi0", "Section",
 CellChangeTimes->{{3.913453352185865*^9, 3.9134533782464876`*^9}, {
   3.913453922929523*^9, 3.9134539415854807`*^9}, 
   3.913454105998377*^9},ExpressionUUID->"866a930d-597a-473f-862c-\
6fa7797d2c83"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"LLPv", "=", "\"\<B-L\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"proc", "=", "\"\<Pi0\>\""}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "List", " ", "of", " ", "masses", " ", "for", " ", "which", " ", "the", 
    " ", "distribution", " ", "will", " ", "be", " ", "tabulated"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"MassList", "[", 
       RowBox[{"LLPv", ",", "proc", ",", "Facility"}], "]"}], "=", 
      RowBox[{"Select", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0.02", ",", "0.05", ",", "0.1", ",", 
          RowBox[{
           RowBox[{"MaxMass", "[", 
            RowBox[{"LLPv", ",", "Facility", ",", "proc"}], "]"}], "*", 
           "0.99"}]}], "}"}], ",", 
        RowBox[{
         RowBox[{"0", "<", "#", "<", 
          RowBox[{"MaxMass", "[", 
           RowBox[{"LLPv", ",", "Facility", ",", "proc"}], "]"}]}], "&"}]}], 
       "]"}]}], ";"}], "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{"Facility", ",", "FacilitiesList"}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TabulatedPDF", "[", "mLLP_", "]"}], ":=", 
   RowBox[{"BlockTabulatedPDFsFromDecaysMass", "[", 
    RowBox[{
    "LLPv", ",", "SelectedFacility", ",", "mLLP", ",", "proc", ",", "nsim", 
     ",", 
     RowBox[{"\[Theta]NlistLight", "[", "SelectedFacility", "]"}], ",", 
     RowBox[{"ENlist", "[", "SelectedFacility", "]"}], ",", 
     RowBox[{"\[Theta]minExtrFacility", "[", 
      RowBox[{"SelectedFacility", ",", "proc"}], "]"}], ",", 
     "\"\<False\>\""}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"filename", "=", 
   RowBox[{"filenameToExport", "[", 
    RowBox[{"LLPv", ",", "proc", ",", "SelectedFacility"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mlist", "=", 
   RowBox[{"MassList", "[", 
    RowBox[{"LLPv", ",", "proc", ",", "SelectedFacility"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tabulatedblock", "[", 
   RowBox[{"TabulatedPDF", ",", "mlist", ",", "filename"}], "]"}], "//", 
  "AbsoluteTiming"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"{", 
   RowBox[{"LLPv", ",", "proc", ",", "mlist"}], "}"}], "//", 
  "Clear"}]}], "Input",
 CellChangeTimes->{{3.9134539970875425`*^9, 3.9134540004022136`*^9}, {
   3.913454051763443*^9, 3.913454052133419*^9}, {3.913454102913801*^9, 
   3.91345410336136*^9}, 3.915083933896372*^9, {3.915438818783493*^9, 
   3.915438818808464*^9}, 3.9172816249910746`*^9},
 CellLabel->
  "In[1708]:=",ExpressionUUID->"c3bf300a-ccec-49c2-aa85-3ef28ffabb70"]
}, Closed]],

Cell[CellGroupData[{

Cell["B-L_Eta", "Section",
 CellChangeTimes->{{3.913453352185865*^9, 3.9134533782464876`*^9}, {
   3.913453922929523*^9, 3.91345394437442*^9}, 
   3.9134541077646427`*^9},ExpressionUUID->"27be1a7b-e612-47cb-9ea9-\
3e73d1671ee4"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"LLPv", "=", "\"\<B-L\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"proc", "=", "\"\<Eta\>\""}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "List", " ", "of", " ", "masses", " ", "for", " ", "which", " ", "the", 
    " ", "distribution", " ", "will", " ", "be", " ", "tabulated"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"MassList", "[", 
       RowBox[{"LLPv", ",", "proc", ",", "Facility"}], "]"}], "=", 
      RowBox[{"Select", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "0.02", ",", "0.05", ",", "0.1", ",", "0.2", ",", "0.3", ",", "0.45",
           ",", 
          RowBox[{
           RowBox[{"MaxMass", "[", 
            RowBox[{"LLPv", ",", "Facility", ",", "proc"}], "]"}], "*", 
           "0.99"}]}], "}"}], ",", 
        RowBox[{
         RowBox[{"0", "<", "#", "<", 
          RowBox[{"MaxMass", "[", 
           RowBox[{"LLPv", ",", "Facility", ",", "proc"}], "]"}]}], "&"}]}], 
       "]"}]}], ";"}], "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{"Facility", ",", "FacilitiesList"}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TabulatedPDF", "[", "mLLP_", "]"}], ":=", 
   RowBox[{"BlockTabulatedPDFsFromDecaysMass", "[", 
    RowBox[{
    "LLPv", ",", "SelectedFacility", ",", "mLLP", ",", "proc", ",", "nsim", 
     ",", 
     RowBox[{"\[Theta]NlistLight", "[", "SelectedFacility", "]"}], ",", 
     RowBox[{"ENlist", "[", "SelectedFacility", "]"}], ",", 
     RowBox[{"\[Theta]minExtrFacility", "[", 
      RowBox[{"SelectedFacility", ",", "proc"}], "]"}], ",", 
     "\"\<False\>\""}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"filename", "=", 
   RowBox[{"filenameToExport", "[", 
    RowBox[{"LLPv", ",", "proc", ",", "SelectedFacility"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mlist", "=", 
   RowBox[{"MassList", "[", 
    RowBox[{"LLPv", ",", "proc", ",", "SelectedFacility"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tabulatedblock", "[", 
   RowBox[{"TabulatedPDF", ",", "mlist", ",", "filename"}], "]"}], "//", 
  "AbsoluteTiming"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"{", 
   RowBox[{"LLPv", ",", "proc", ",", "mlist"}], "}"}], "//", 
  "Clear"}]}], "Input",
 CellChangeTimes->{{3.913454045623446*^9, 3.913454071794718*^9}, 
   3.913454109393179*^9, 3.91508393390136*^9, {3.915438818817458*^9, 
   3.915438818846437*^9}, 3.9172816297161093`*^9},
 CellLabel->
  "In[1716]:=",ExpressionUUID->"aa49fc9f-5adf-4e72-94d6-2273fe505797"]
}, Closed]],

Cell[CellGroupData[{

Cell["B-L_EtaPr", "Section",
 CellChangeTimes->{{3.913453352185865*^9, 3.9134533782464876`*^9}, {
   3.913453922929523*^9, 3.9134539472505245`*^9}, 
   3.9134541137458167`*^9},ExpressionUUID->"6ccbb58c-dd0b-472e-bb46-\
90b01b770aa9"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"LLPv", "=", "\"\<B-L\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"proc", "=", "\"\<EtaPr\>\""}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "List", " ", "of", " ", "masses", " ", "for", " ", "which", " ", "the", 
    " ", "distribution", " ", "will", " ", "be", " ", "tabulated"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"MassList", "[", 
       RowBox[{"LLPv", ",", "proc", ",", "Facility"}], "]"}], "=", 
      RowBox[{"Select", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "0.02", ",", "0.05", ",", "0.1", ",", "0.2", ",", "0.3", ",", "0.5", 
          ",", "0.7", ",", "0.9", ",", 
          RowBox[{
           RowBox[{"MaxMass", "[", 
            RowBox[{"LLPv", ",", "Facility", ",", "proc"}], "]"}], "*", 
           "0.99"}]}], "}"}], ",", 
        RowBox[{
         RowBox[{"0", "<", "#", "<", 
          RowBox[{"MaxMass", "[", 
           RowBox[{"LLPv", ",", "Facility", ",", "proc"}], "]"}]}], "&"}]}], 
       "]"}]}], ";"}], "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{"Facility", ",", "FacilitiesList"}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TabulatedPDF", "[", "mLLP_", "]"}], ":=", 
   RowBox[{"BlockTabulatedPDFsFromDecaysMass", "[", 
    RowBox[{
    "LLPv", ",", "SelectedFacility", ",", "mLLP", ",", "proc", ",", "nsim", 
     ",", 
     RowBox[{"\[Theta]NlistLight", "[", "SelectedFacility", "]"}], ",", 
     RowBox[{"ENlist", "[", "SelectedFacility", "]"}], ",", 
     RowBox[{"\[Theta]minExtrFacility", "[", 
      RowBox[{"SelectedFacility", ",", "proc"}], "]"}], ",", 
     "\"\<False\>\""}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"filename", "=", 
   RowBox[{"filenameToExport", "[", 
    RowBox[{"LLPv", ",", "proc", ",", "SelectedFacility"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mlist", "=", 
   RowBox[{"MassList", "[", 
    RowBox[{"LLPv", ",", "proc", ",", "SelectedFacility"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tabulatedblock", "[", 
   RowBox[{"TabulatedPDF", ",", "mlist", ",", "filename"}], "]"}], "//", 
  "AbsoluteTiming"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"{", 
   RowBox[{"LLPv", ",", "proc", ",", "mlist"}], "}"}], "//", 
  "Clear"}]}], "Input",
 CellChangeTimes->{{3.913454078743132*^9, 3.913454111494183*^9}, 
   3.915083933906857*^9, {3.9154388188544483`*^9, 3.915438818885839*^9}, 
   3.917281634290452*^9},
 CellLabel->
  "In[1724]:=",ExpressionUUID->"51450d53-ee3f-4422-b599-c31e2eaf5c2f"]
}, Closed]],

Cell[CellGroupData[{

Cell["B-L_Omega", "Section",
 CellChangeTimes->{{3.913453352185865*^9, 3.9134533782464876`*^9}, {
  3.913453922929523*^9, 
  3.913453974067208*^9}},ExpressionUUID->"0ef1c7c2-06ef-4d81-845e-\
3983b61efba3"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"LLPv", "=", "\"\<B-L\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"proc", "=", "\"\<Omega\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"MassList", "[", 
       RowBox[{"LLPv", ",", "proc", ",", "Facility"}], "]"}], "=", 
      RowBox[{"Select", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "0.02", ",", "0.05", ",", "0.1", ",", "0.3", ",", "0.5", ",", "0.77",
           ",", "1.", ",", "1.2", ",", "1.3", ",", "1.4", ",", "1.5", ",", 
          "1.6", ",", "1.7", ",", "1.8", ",", "1.9", ",", "2.", ",", "2.1", 
          ",", "2.2", ",", "2.3", ",", "2.4", ",", "2.5", ",", "2.6", ",", 
          "2.7", ",", "2.8", ",", "2.9", ",", "3.", ",", "3.1", ",", "3.2", 
          ",", "3.3", ",", "3.5"}], "}"}], ",", 
        RowBox[{
         RowBox[{"0", "<", "#", "<", 
          RowBox[{"MaxMass", "[", 
           RowBox[{"LLPv", ",", "Facility", ",", "proc"}], "]"}]}], "&"}]}], 
       "]"}]}], ";"}], "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{"Facility", ",", "FacilitiesList"}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TabulatedPDF", "[", "mLLP_", "]"}], ":=", 
   RowBox[{"BlockTabulatedPDFsFromMixingsMass", "[", 
    RowBox[{
    "LLPv", ",", "SelectedFacility", ",", "mLLP", ",", "proc", ",", "nsim", 
     ",", 
     RowBox[{"\[Theta]NlistLight", "[", "SelectedFacility", "]"}], ",", 
     RowBox[{"ENlist", "[", "SelectedFacility", "]"}], ",", 
     RowBox[{"\[Theta]minExtrFacility", "[", 
      RowBox[{"SelectedFacility", ",", "proc"}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mlist", "=", 
   RowBox[{"MassList", "[", 
    RowBox[{"LLPv", ",", "proc", ",", "SelectedFacility"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"filename", "=", 
   RowBox[{"filenameToExport", "[", 
    RowBox[{"LLPv", ",", "proc", ",", "SelectedFacility"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tabulatedblock", "[", 
   RowBox[{"TabulatedPDF", ",", "mlist", ",", "filename"}], "]"}], "//", 
  "AbsoluteTiming"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"{", 
   RowBox[{"LLPv", ",", "proc", ",", "mlist"}], "}"}], "//", 
  "Clear"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.91346054127559*^9, 3.913460547406306*^9}, {
   3.9139718867913437`*^9, 3.913971887174934*^9}, 3.9143991601705604`*^9, {
   3.9154388188949995`*^9, 3.915438818920843*^9}, 3.916484942063748*^9, 
   3.917281642744874*^9, {3.91750645960399*^9, 3.91750648999504*^9}, {
   3.91750724276508*^9, 3.917507244985194*^9}},
 CellLabel->
  "In[1140]:=",ExpressionUUID->"acff3d38-7a8c-45d5-9977-20883682e854"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["B-3Lmu", "Chapter",
 CellChangeTimes->{{3.91344144967334*^9, 3.913441455340948*^9}, {
   3.913441825113173*^9, 3.9134418258593936`*^9}, {3.913441936913423*^9, 
   3.9134419384733877`*^9}, {3.913442132020331*^9, 3.91344213360353*^9}, 
   3.9134482243227367`*^9, {3.91345317520315*^9, 3.9134531776043587`*^9}, {
   3.9134539629830503`*^9, 3.913453963424157*^9}, {3.913971802634257*^9, 
   3.913971804598317*^9}},ExpressionUUID->"16388e30-af43-4624-ad00-\
20b41052f8aa"],

Cell[CellGroupData[{

Cell["B-3Lmu_Bremsstrahlung", "Section",
 CellChangeTimes->{{3.913453352185865*^9, 3.9134533782464876`*^9}, {
   3.913453922929523*^9, 3.913453926944298*^9}, {3.913458295350587*^9, 
   3.913458296391029*^9}, 3.913971821819154*^9, 
   3.913972327758503*^9},ExpressionUUID->"50a92348-8403-4363-98ab-\
e5dd7560ed07"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"LLPv", "=", "\"\<B-3Lmu\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"proc", "=", "\"\<Bremsstrahlung\>\""}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "List", " ", "of", " ", "masses", " ", "for", " ", "which", " ", "the", 
    " ", "distribution", " ", "will", " ", "be", " ", "tabulated"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"MassList", "[", 
       RowBox[{"LLPv", ",", "proc", ",", "Facility"}], "]"}], "=", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{"mV", ",", 
         RowBox[{"{", 
          RowBox[{"mV", ",", "mVminFromBrem", ",", "mVmaxFromBrem", ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", "mVmaxFromBrem", ")"}], "-", "mVminFromBrem"}], 
             ")"}], "/", "20"}]}], "}"}]}], "]"}], "//", "N"}]}], ";"}], 
    "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{"Facility", ",", "FacilitiesList"}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Theta]listBrem", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"\[Theta]Nlist", "[", "SelectedFacility", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Theta]maxBrem", "[", "SelectedFacility", "]"}], "}"}]}], 
      "]"}], "//", "DeleteDuplicates"}], "//", "Sort"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mlist", "=", 
   RowBox[{"MassList", "[", 
    RowBox[{"LLPv", ",", "proc", ",", "SelectedFacility"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BlockTabulatedPDFsFromBrem", "[", 
   RowBox[{"LLPv", ",", "SelectedFacility", ",", "mlist"}], "]"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"TabulatedPDF", "[", "mLLP_", "]"}], ":=", 
      RowBox[{"BlockTabulatedPDFsFromBrem", "[", 
       RowBox[{
       "LLPv", ",", "mLLP", ",", "\[Theta]listBrem", ",", 
        "SelectedFacility"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"filename", "=", 
      RowBox[{"filenameToExport", "[", 
       RowBox[{"LLPv", ",", "proc", ",", "SelectedFacility"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"mlist", "=", 
      RowBox[{"MassList", "[", 
       RowBox[{"LLPv", ",", "proc", ",", "SelectedFacility"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"tabulatedblock", "[", 
      RowBox[{"TabulatedPDF", ",", "mlist", ",", "filename"}], "]"}], ";"}], "//",
     "AbsoluteTiming"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"{", 
   RowBox[{"LLPv", ",", "proc", ",", "mlist"}], "}"}], "//", 
  "Clear"}]}], "Input",
 CellChangeTimes->{{3.913457551250987*^9, 3.913457646228073*^9}, {
   3.913458630065926*^9, 3.913458638183439*^9}, {3.913461405272519*^9, 
   3.913461433780708*^9}, 3.913827457266136*^9, {3.913971828621466*^9, 
   3.913971845750946*^9}, 3.9140562247099047`*^9, 3.914494766481464*^9, {
   3.9154388189283433`*^9, 3.915438818953345*^9}, 3.917165709235631*^9, {
   3.917281687552331*^9, 
   3.917281703442515*^9}},ExpressionUUID->"b57d46d6-4872-48c1-aeef-\
b23173da4c28"]
}, Closed]],

Cell[CellGroupData[{

Cell["B-3Lmu_Pi0", "Section",
 CellChangeTimes->{{3.913453352185865*^9, 3.9134533782464876`*^9}, {
   3.913453922929523*^9, 3.9134539415854807`*^9}, 3.913454105998377*^9, 
   3.9139718225642037`*^9},ExpressionUUID->"0d0c22a9-328c-4164-94e4-\
3e8854d55fbb"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"LLPv", "=", "\"\<B-3Lmu\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"proc", "=", "\"\<Pi0\>\""}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "List", " ", "of", " ", "masses", " ", "for", " ", "which", " ", "the", 
    " ", "distribution", " ", "will", " ", "be", " ", "tabulated"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"MassList", "[", 
       RowBox[{"LLPv", ",", "proc", ",", "Facility"}], "]"}], "=", 
      RowBox[{"Select", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0.02", ",", "0.05", ",", "0.1", ",", 
          RowBox[{
           RowBox[{"MaxMass", "[", 
            RowBox[{"LLPv", ",", "Facility", ",", "proc"}], "]"}], "*", 
           "0.99"}]}], "}"}], ",", 
        RowBox[{
         RowBox[{"0", "<", "#", "<", 
          RowBox[{"MaxMass", "[", 
           RowBox[{"LLPv", ",", "Facility", ",", "proc"}], "]"}]}], "&"}]}], 
       "]"}]}], ";"}], "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{"Facility", ",", "FacilitiesList"}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TabulatedPDF", "[", "mLLP_", "]"}], ":=", 
   RowBox[{"BlockTabulatedPDFsFromDecaysMass", "[", 
    RowBox[{
    "LLPv", ",", "SelectedFacility", ",", "mLLP", ",", "proc", ",", "nsim", 
     ",", 
     RowBox[{"\[Theta]NlistLight", "[", "SelectedFacility", "]"}], ",", 
     RowBox[{"ENlist", "[", "SelectedFacility", "]"}], ",", 
     RowBox[{"\[Theta]minExtrFacility", "[", 
      RowBox[{"SelectedFacility", ",", "proc"}], "]"}], ",", 
     "\"\<False\>\""}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"filename", "=", 
   RowBox[{"filenameToExport", "[", 
    RowBox[{"LLPv", ",", "proc", ",", "SelectedFacility"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mlist", "=", 
   RowBox[{"MassList", "[", 
    RowBox[{"LLPv", ",", "proc", ",", "SelectedFacility"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tabulatedblock", "[", 
   RowBox[{"TabulatedPDF", ",", "mlist", ",", "filename"}], "]"}], "//", 
  "AbsoluteTiming"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"{", 
   RowBox[{"LLPv", ",", "proc", ",", "mlist"}], "}"}], "//", 
  "Clear"}]}], "Input",
 CellChangeTimes->{{3.9134539970875425`*^9, 3.9134540004022136`*^9}, {
   3.913454051763443*^9, 3.913454052133419*^9}, {3.913454102913801*^9, 
   3.91345410336136*^9}, 3.913971854535929*^9, 3.915083933910847*^9, {
   3.915438818965331*^9, 3.915438818992313*^9}, 
   3.917281687555929*^9},ExpressionUUID->"43fa2da4-0967-46af-af2f-\
9ff96e4fdaa7"]
}, Closed]],

Cell[CellGroupData[{

Cell["B-3Lmu_Eta", "Section",
 CellChangeTimes->{{3.913453352185865*^9, 3.9134533782464876`*^9}, {
   3.913453922929523*^9, 3.91345394437442*^9}, 3.9134541077646427`*^9, 
   3.913971823419543*^9},ExpressionUUID->"8ffc3357-2f61-4e66-8cf8-\
71764a5f1082"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"LLPv", "=", "\"\<B-3Lmu\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"proc", "=", "\"\<Eta\>\""}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "List", " ", "of", " ", "masses", " ", "for", " ", "which", " ", "the", 
    " ", "distribution", " ", "will", " ", "be", " ", "tabulated"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"MassList", "[", 
       RowBox[{"LLPv", ",", "proc", ",", "Facility"}], "]"}], "=", 
      RowBox[{"Select", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "0.02", ",", "0.05", ",", "0.1", ",", "0.2", ",", "0.3", ",", "0.45",
           ",", 
          RowBox[{
           RowBox[{"MaxMass", "[", 
            RowBox[{"LLPv", ",", "Facility", ",", "proc"}], "]"}], "*", 
           "0.99"}]}], "}"}], ",", 
        RowBox[{
         RowBox[{"0", "<", "#", "<", 
          RowBox[{"MaxMass", "[", 
           RowBox[{"LLPv", ",", "Facility", ",", "proc"}], "]"}]}], "&"}]}], 
       "]"}]}], ";"}], "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{"Facility", ",", "FacilitiesList"}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TabulatedPDF", "[", "mLLP_", "]"}], ":=", 
   RowBox[{"BlockTabulatedPDFsFromDecaysMass", "[", 
    RowBox[{
    "LLPv", ",", "SelectedFacility", ",", "mLLP", ",", "proc", ",", "nsim", 
     ",", 
     RowBox[{"\[Theta]NlistLight", "[", "SelectedFacility", "]"}], ",", 
     RowBox[{"ENlist", "[", "SelectedFacility", "]"}], ",", 
     RowBox[{"\[Theta]minExtrFacility", "[", 
      RowBox[{"SelectedFacility", ",", "proc"}], "]"}], ",", 
     "\"\<False\>\""}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"filename", "=", 
   RowBox[{"filenameToExport", "[", 
    RowBox[{"LLPv", ",", "proc", ",", "SelectedFacility"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mlist", "=", 
   RowBox[{"MassList", "[", 
    RowBox[{"LLPv", ",", "proc", ",", "SelectedFacility"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tabulatedblock", "[", 
   RowBox[{"TabulatedPDF", ",", "mlist", ",", "filename"}], "]"}], "//", 
  "AbsoluteTiming"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"{", 
   RowBox[{"LLPv", ",", "proc", ",", "mlist"}], "}"}], "//", 
  "Clear"}]}], "Input",
 CellChangeTimes->{{3.913454045623446*^9, 3.913454071794718*^9}, 
   3.913454109393179*^9, 3.913971854540631*^9, 3.915083933916967*^9, {
   3.915438819002304*^9, 3.915438819028774*^9}, 
   3.917281687560452*^9},ExpressionUUID->"51d3fcfa-7b15-4d6b-8f4f-\
a72f60d9fcc1"]
}, Closed]],

Cell[CellGroupData[{

Cell["B-3Lmu_EtaPr", "Section",
 CellChangeTimes->{{3.913453352185865*^9, 3.9134533782464876`*^9}, {
   3.913453922929523*^9, 3.9134539472505245`*^9}, 3.9134541137458167`*^9, 
   3.9139718242393785`*^9},ExpressionUUID->"49dc79fb-3a86-4373-b3d0-\
ec141cc7652c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"LLPv", "=", "\"\<B-3Lmu\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"proc", "=", "\"\<EtaPr\>\""}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "List", " ", "of", " ", "masses", " ", "for", " ", "which", " ", "the", 
    " ", "distribution", " ", "will", " ", "be", " ", "tabulated"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"MassList", "[", 
       RowBox[{"LLPv", ",", "proc", ",", "Facility"}], "]"}], "=", 
      RowBox[{"Select", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "0.02", ",", "0.05", ",", "0.1", ",", "0.2", ",", "0.3", ",", "0.5", 
          ",", "0.7", ",", "0.9", ",", 
          RowBox[{
           RowBox[{"MaxMass", "[", 
            RowBox[{"LLPv", ",", "Facility", ",", "proc"}], "]"}], "*", 
           "0.99"}]}], "}"}], ",", 
        RowBox[{
         RowBox[{"0", "<", "#", "<", 
          RowBox[{"MaxMass", "[", 
           RowBox[{"LLPv", ",", "Facility", ",", "proc"}], "]"}]}], "&"}]}], 
       "]"}]}], ";"}], "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{"Facility", ",", "FacilitiesList"}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TabulatedPDF", "[", "mLLP_", "]"}], ":=", 
   RowBox[{"BlockTabulatedPDFsFromDecaysMass", "[", 
    RowBox[{
    "LLPv", ",", "SelectedFacility", ",", "mLLP", ",", "proc", ",", "nsim", 
     ",", 
     RowBox[{"\[Theta]NlistLight", "[", "SelectedFacility", "]"}], ",", 
     RowBox[{"ENlist", "[", "SelectedFacility", "]"}], ",", 
     RowBox[{"\[Theta]minExtrFacility", "[", 
      RowBox[{"SelectedFacility", ",", "proc"}], "]"}], ",", 
     "\"\<False\>\""}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"filename", "=", 
   RowBox[{"filenameToExport", "[", 
    RowBox[{"LLPv", ",", "proc", ",", "SelectedFacility"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mlist", "=", 
   RowBox[{"MassList", "[", 
    RowBox[{"LLPv", ",", "proc", ",", "SelectedFacility"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tabulatedblock", "[", 
   RowBox[{"TabulatedPDF", ",", "mlist", ",", "filename"}], "]"}], "//", 
  "AbsoluteTiming"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"{", 
   RowBox[{"LLPv", ",", "proc", ",", "mlist"}], "}"}], "//", 
  "Clear"}]}], "Input",
 CellChangeTimes->{{3.913454078743132*^9, 3.913454111494183*^9}, 
   3.913971854544437*^9, 3.915083933920955*^9, {3.9154388190372663`*^9, 
   3.9154388190642486`*^9}, 
   3.9172816875644507`*^9},ExpressionUUID->"c1cc08d3-9289-433a-b7b1-\
07100126d508"]
}, Closed]],

Cell[CellGroupData[{

Cell["B-3Lmu_Omega", "Section",
 CellChangeTimes->{{3.913453352185865*^9, 3.9134533782464876`*^9}, {
   3.913453922929523*^9, 3.913453974067208*^9}, 
   3.913971825080752*^9},ExpressionUUID->"4a43cdfb-c5c6-4bf6-9c43-\
0ebc120a467f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"LLPv", "=", "\"\<B-3Lmu\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"proc", "=", "\"\<Omega\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"MassList", "[", 
       RowBox[{"LLPv", ",", "proc", ",", "Facility"}], "]"}], "=", 
      RowBox[{"Select", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "0.02", ",", "0.05", ",", "0.1", ",", "0.3", ",", "0.5", ",", "0.77",
           ",", "1.", ",", "1.2", ",", "1.3", ",", "1.4", ",", "1.5", ",", 
          "1.6", ",", "1.7", ",", "1.8", ",", "1.9", ",", "2.", ",", "2.1", 
          ",", "2.2", ",", "2.3", ",", "2.4", ",", "2.5", ",", "2.6", ",", 
          "2.7", ",", "2.8", ",", "2.9", ",", "3.", ",", "3.1", ",", "3.2", 
          ",", "3.3", ",", "3.5"}], "}"}], ",", 
        RowBox[{
         RowBox[{"0", "<", "#", "<", 
          RowBox[{"MaxMass", "[", 
           RowBox[{"LLPv", ",", "Facility", ",", "proc"}], "]"}]}], "&"}]}], 
       "]"}]}], ";"}], "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{"Facility", ",", "FacilitiesList"}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TabulatedPDF", "[", "mLLP_", "]"}], ":=", 
   RowBox[{"BlockTabulatedPDFsFromMixingsMass", "[", 
    RowBox[{
    "LLPv", ",", "SelectedFacility", ",", "mLLP", ",", "proc", ",", "nsim", 
     ",", 
     RowBox[{"\[Theta]NlistLight", "[", "SelectedFacility", "]"}], ",", 
     RowBox[{"ENlist", "[", "SelectedFacility", "]"}], ",", 
     RowBox[{"\[Theta]minExtrFacility", "[", 
      RowBox[{"SelectedFacility", ",", "proc"}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mlist", "=", 
   RowBox[{"MassList", "[", 
    RowBox[{"LLPv", ",", "proc", ",", "SelectedFacility"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"filename", "=", 
   RowBox[{"filenameToExport", "[", 
    RowBox[{"LLPv", ",", "proc", ",", "SelectedFacility"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tabulatedblock", "[", 
   RowBox[{"TabulatedPDF", ",", "mlist", ",", "filename"}], "]"}], "//", 
  "AbsoluteTiming"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"{", 
   RowBox[{"LLPv", ",", "proc", ",", "mlist"}], "}"}], "//", 
  "Clear"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.91346054127559*^9, 3.913460547406306*^9}, {
   3.91397186966551*^9, 3.913971870920455*^9}, 3.914399168797298*^9, {
   3.915438819072245*^9, 3.9154388190958233`*^9}, 3.9164849495752387`*^9, 
   3.917281687568957*^9},ExpressionUUID->"836b6ebf-9b2e-46b8-ab59-\
bb966e22fcd6"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["B-Le-3Lmu+Ltau", "Chapter",
 CellChangeTimes->{{3.91344144967334*^9, 3.913441455340948*^9}, {
   3.913441825113173*^9, 3.9134418258593936`*^9}, {3.913441936913423*^9, 
   3.9134419384733877`*^9}, {3.913442132020331*^9, 3.91344213360353*^9}, 
   3.9134482243227367`*^9, {3.91345317520315*^9, 3.9134531776043587`*^9}, {
   3.9134539629830503`*^9, 3.913453963424157*^9}, {3.913971806212079*^9, 
   3.913971809828298*^9}, {3.913971899491206*^9, 
   3.913971908367789*^9}},ExpressionUUID->"ca0169e1-1506-4920-a654-\
c36523988742"],

Cell[CellGroupData[{

Cell["B-Le-3Lmu+Ltau_Bremsstrahlung", "Section",
 CellChangeTimes->{{3.913453352185865*^9, 3.9134533782464876`*^9}, {
   3.913453922929523*^9, 3.913453926944298*^9}, {3.913458295350587*^9, 
   3.913458296391029*^9}, 3.9139718995004396`*^9, 
   3.913972323997619*^9},ExpressionUUID->"0e636e28-9cd5-40f7-afc1-\
5285012e8b6c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"LLPv", "=", "\"\<B-Le-3Lmu+Ltau\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"proc", "=", "\"\<Bremsstrahlung\>\""}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "List", " ", "of", " ", "masses", " ", "for", " ", "which", " ", "the", 
    " ", "distribution", " ", "will", " ", "be", " ", "tabulated"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"MassList", "[", 
       RowBox[{"LLPv", ",", "proc", ",", "Facility"}], "]"}], "=", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{"mV", ",", 
         RowBox[{"{", 
          RowBox[{"mV", ",", "mVminFromBrem", ",", "mVmaxFromBrem", ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", "mVmaxFromBrem", ")"}], "-", "mVminFromBrem"}], 
             ")"}], "/", "20"}]}], "}"}]}], "]"}], "//", "N"}]}], ";"}], 
    "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{"Facility", ",", "FacilitiesList"}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Theta]listBrem", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"\[Theta]Nlist", "[", "SelectedFacility", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Theta]maxBrem", "[", "SelectedFacility", "]"}], "}"}]}], 
      "]"}], "//", "DeleteDuplicates"}], "//", "Sort"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mlist", "=", 
   RowBox[{"MassList", "[", 
    RowBox[{"LLPv", ",", "proc", ",", "SelectedFacility"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BlockTabulatedPDFsFromBrem", "[", 
   RowBox[{"LLPv", ",", "SelectedFacility", ",", "mlist"}], "]"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"TabulatedPDF", "[", "mLLP_", "]"}], ":=", 
      RowBox[{"BlockTabulatedPDFsFromBrem", "[", 
       RowBox[{
       "LLPv", ",", "mLLP", ",", "\[Theta]listBrem", ",", 
        "SelectedFacility"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"filename", "=", 
      RowBox[{"filenameToExport", "[", 
       RowBox[{"LLPv", ",", "proc", ",", "SelectedFacility"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"mlist", "=", 
      RowBox[{"MassList", "[", 
       RowBox[{"LLPv", ",", "proc", ",", "SelectedFacility"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"tabulatedblock", "[", 
      RowBox[{"TabulatedPDF", ",", "mlist", ",", "filename"}], "]"}], ";"}], "//",
     "AbsoluteTiming"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"{", 
   RowBox[{"LLPv", ",", "proc", ",", "mlist"}], "}"}], "//", 
  "Clear"}]}], "Input",
 CellChangeTimes->{{3.913457551250987*^9, 3.913457646228073*^9}, {
   3.913458630065926*^9, 3.913458638183439*^9}, {3.913461405272519*^9, 
   3.913461433780708*^9}, 3.913827457266136*^9, 3.9139718995055065`*^9, 
   3.914056229620321*^9, 3.9144947728842835`*^9, {3.9154388191039453`*^9, 
   3.915438819132448*^9}, 3.917165709245206*^9, {3.9172816875735803`*^9, 
   3.917281703101052*^9}},ExpressionUUID->"bd211e6c-fc57-4dbc-9c4d-\
02c6cfe43c86"]
}, Closed]],

Cell[CellGroupData[{

Cell["B-Le-3Lmu+Ltau_Pi0", "Section",
 CellChangeTimes->{{3.913453352185865*^9, 3.9134533782464876`*^9}, {
   3.913453922929523*^9, 3.9134539415854807`*^9}, 3.913454105998377*^9, 
   3.9139718995139914`*^9},ExpressionUUID->"8bfb98bf-4268-47d3-9b34-\
445fa8bde8ef"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"LLPv", "=", "\"\<B-Le-3Lmu+Ltau\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"proc", "=", "\"\<Pi0\>\""}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "List", " ", "of", " ", "masses", " ", "for", " ", "which", " ", "the", 
    " ", "distribution", " ", "will", " ", "be", " ", "tabulated"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"MassList", "[", 
       RowBox[{"LLPv", ",", "proc", ",", "Facility"}], "]"}], "=", 
      RowBox[{"Select", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0.02", ",", "0.05", ",", "0.1", ",", 
          RowBox[{
           RowBox[{"MaxMass", "[", 
            RowBox[{"LLPv", ",", "Facility", ",", "proc"}], "]"}], "*", 
           "0.99"}]}], "}"}], ",", 
        RowBox[{
         RowBox[{"0", "<", "#", "<", 
          RowBox[{"MaxMass", "[", 
           RowBox[{"LLPv", ",", "Facility", ",", "proc"}], "]"}]}], "&"}]}], 
       "]"}]}], ";"}], "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{"Facility", ",", "FacilitiesList"}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TabulatedPDF", "[", "mLLP_", "]"}], ":=", 
   RowBox[{"BlockTabulatedPDFsFromDecaysMass", "[", 
    RowBox[{
    "LLPv", ",", "SelectedFacility", ",", "mLLP", ",", "proc", ",", "nsim", 
     ",", 
     RowBox[{"\[Theta]NlistLight", "[", "SelectedFacility", "]"}], ",", 
     RowBox[{"ENlist", "[", "SelectedFacility", "]"}], ",", 
     RowBox[{"\[Theta]minExtrFacility", "[", 
      RowBox[{"SelectedFacility", ",", "proc"}], "]"}], ",", 
     "\"\<False\>\""}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"filename", "=", 
   RowBox[{"filenameToExport", "[", 
    RowBox[{"LLPv", ",", "proc", ",", "SelectedFacility"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mlist", "=", 
   RowBox[{"MassList", "[", 
    RowBox[{"LLPv", ",", "proc", ",", "SelectedFacility"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tabulatedblock", "[", 
   RowBox[{"TabulatedPDF", ",", "mlist", ",", "filename"}], "]"}], "//", 
  "AbsoluteTiming"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"{", 
   RowBox[{"LLPv", ",", "proc", ",", "mlist"}], "}"}], "//", 
  "Clear"}]}], "Input",
 CellChangeTimes->{{3.9134539970875425`*^9, 3.9134540004022136`*^9}, {
   3.913454051763443*^9, 3.913454052133419*^9}, {3.913454102913801*^9, 
   3.91345410336136*^9}, 3.913971899517999*^9, 3.9150839339260173`*^9, {
   3.915438819144433*^9, 3.915438819178827*^9}, 
   3.9172816875784893`*^9},ExpressionUUID->"4a8dab22-c56e-4595-9b4f-\
0089f8167f8a"]
}, Closed]],

Cell[CellGroupData[{

Cell["B-Le-3Lmu+Ltau_Eta", "Section",
 CellChangeTimes->{{3.913453352185865*^9, 3.9134533782464876`*^9}, {
   3.913453922929523*^9, 3.91345394437442*^9}, 3.9134541077646427`*^9, 
   3.913971899523983*^9},ExpressionUUID->"eac7d75d-30e9-45e5-9479-\
d0cff64fefea"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"LLPv", "=", "\"\<B-Le-3Lmu+Ltau\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"proc", "=", "\"\<Eta\>\""}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "List", " ", "of", " ", "masses", " ", "for", " ", "which", " ", "the", 
    " ", "distribution", " ", "will", " ", "be", " ", "tabulated"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"MassList", "[", 
       RowBox[{"LLPv", ",", "proc", ",", "Facility"}], "]"}], "=", 
      RowBox[{"Select", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "0.02", ",", "0.05", ",", "0.1", ",", "0.2", ",", "0.3", ",", "0.45",
           ",", 
          RowBox[{
           RowBox[{"MaxMass", "[", 
            RowBox[{"LLPv", ",", "Facility", ",", "proc"}], "]"}], "*", 
           "0.99"}]}], "}"}], ",", 
        RowBox[{
         RowBox[{"0", "<", "#", "<", 
          RowBox[{"MaxMass", "[", 
           RowBox[{"LLPv", ",", "Facility", ",", "proc"}], "]"}]}], "&"}]}], 
       "]"}]}], ";"}], "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{"Facility", ",", "FacilitiesList"}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TabulatedPDF", "[", "mLLP_", "]"}], ":=", 
   RowBox[{"BlockTabulatedPDFsFromDecaysMass", "[", 
    RowBox[{
    "LLPv", ",", "SelectedFacility", ",", "mLLP", ",", "proc", ",", "nsim", 
     ",", 
     RowBox[{"\[Theta]NlistLight", "[", "SelectedFacility", "]"}], ",", 
     RowBox[{"ENlist", "[", "SelectedFacility", "]"}], ",", 
     RowBox[{"\[Theta]minExtrFacility", "[", 
      RowBox[{"SelectedFacility", ",", "proc"}], "]"}], ",", 
     "\"\<False\>\""}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"filename", "=", 
   RowBox[{"filenameToExport", "[", 
    RowBox[{"LLPv", ",", "proc", ",", "SelectedFacility"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mlist", "=", 
   RowBox[{"MassList", "[", 
    RowBox[{"LLPv", ",", "proc", ",", "SelectedFacility"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tabulatedblock", "[", 
   RowBox[{"TabulatedPDF", ",", "mlist", ",", "filename"}], "]"}], "//", 
  "AbsoluteTiming"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"{", 
   RowBox[{"LLPv", ",", "proc", ",", "mlist"}], "}"}], "//", 
  "Clear"}]}], "Input",
 CellChangeTimes->{{3.913454045623446*^9, 3.913454071794718*^9}, 
   3.913454109393179*^9, 3.913971899530501*^9, 3.9150839339310036`*^9, {
   3.9154388191890006`*^9, 3.915438819216039*^9}, 
   3.91728168758257*^9},ExpressionUUID->"323a8d6f-ddd0-405e-aa34-\
26f7aee6b570"]
}, Closed]],

Cell[CellGroupData[{

Cell["B-Le-3Lmu+Ltau_EtaPr", "Section",
 CellChangeTimes->{{3.913453352185865*^9, 3.9134533782464876`*^9}, {
   3.913453922929523*^9, 3.9134539472505245`*^9}, 3.9134541137458167`*^9, 
   3.913971899538669*^9},ExpressionUUID->"c98fa74f-d7e5-45dd-bb1d-\
30973e1d1342"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"LLPv", "=", "\"\<B-Le-3Lmu+Ltau\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"proc", "=", "\"\<EtaPr\>\""}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "List", " ", "of", " ", "masses", " ", "for", " ", "which", " ", "the", 
    " ", "distribution", " ", "will", " ", "be", " ", "tabulated"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"MassList", "[", 
       RowBox[{"LLPv", ",", "proc", ",", "Facility"}], "]"}], "=", 
      RowBox[{"Select", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "0.02", ",", "0.05", ",", "0.1", ",", "0.2", ",", "0.3", ",", "0.5", 
          ",", "0.7", ",", "0.9", ",", 
          RowBox[{
           RowBox[{"MaxMass", "[", 
            RowBox[{"LLPv", ",", "Facility", ",", "proc"}], "]"}], "*", 
           "0.99"}]}], "}"}], ",", 
        RowBox[{
         RowBox[{"0", "<", "#", "<", 
          RowBox[{"MaxMass", "[", 
           RowBox[{"LLPv", ",", "Facility", ",", "proc"}], "]"}]}], "&"}]}], 
       "]"}]}], ";"}], "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{"Facility", ",", "FacilitiesList"}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TabulatedPDF", "[", "mLLP_", "]"}], ":=", 
   RowBox[{"BlockTabulatedPDFsFromDecaysMass", "[", 
    RowBox[{
    "LLPv", ",", "SelectedFacility", ",", "mLLP", ",", "proc", ",", "nsim", 
     ",", 
     RowBox[{"\[Theta]NlistLight", "[", "SelectedFacility", "]"}], ",", 
     RowBox[{"ENlist", "[", "SelectedFacility", "]"}], ",", 
     RowBox[{"\[Theta]minExtrFacility", "[", 
      RowBox[{"SelectedFacility", ",", "proc"}], "]"}], ",", 
     "\"\<False\>\""}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"filename", "=", 
   RowBox[{"filenameToExport", "[", 
    RowBox[{"LLPv", ",", "proc", ",", "SelectedFacility"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mlist", "=", 
   RowBox[{"MassList", "[", 
    RowBox[{"LLPv", ",", "proc", ",", "SelectedFacility"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tabulatedblock", "[", 
   RowBox[{"TabulatedPDF", ",", "mlist", ",", "filename"}], "]"}], "//", 
  "AbsoluteTiming"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"{", 
   RowBox[{"LLPv", ",", "proc", ",", "mlist"}], "}"}], "//", 
  "Clear"}]}], "Input",
 CellChangeTimes->{{3.913454078743132*^9, 3.913454111494183*^9}, 
   3.9139718995436554`*^9, 3.915083933936114*^9, {3.915438819224036*^9, 
   3.915438819253889*^9}, 
   3.917281687587673*^9},ExpressionUUID->"bf0636f4-70cc-4ec2-97cc-\
d8cb2e56c225"]
}, Closed]],

Cell[CellGroupData[{

Cell["B-Le-3Lmu+Ltau_Omega", "Section",
 CellChangeTimes->{{3.913453352185865*^9, 3.9134533782464876`*^9}, {
  3.913453922929523*^9, 3.913453974067208*^9}, {3.913971899551*^9, 
  3.913971918139333*^9}},ExpressionUUID->"1a68ad9f-77c8-42d6-89e6-\
c9bad98d3783"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"LLPv", "=", "\"\<B-Le-3Lmu+Ltau\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"proc", "=", "\"\<Omega\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"MassList", "[", 
       RowBox[{"LLPv", ",", "proc", ",", "Facility"}], "]"}], "=", 
      RowBox[{"Select", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "0.02", ",", "0.05", ",", "0.1", ",", "0.3", ",", "0.5", ",", "0.77",
           ",", "1.", ",", "1.2", ",", "1.3", ",", "1.4", ",", "1.5", ",", 
          "1.6", ",", "1.7", ",", "1.8", ",", "1.9", ",", "2.", ",", "2.1", 
          ",", "2.2", ",", "2.3", ",", "2.4", ",", "2.5", ",", "2.6", ",", 
          "2.7", ",", "2.8", ",", "2.9", ",", "3.", ",", "3.1", ",", "3.2", 
          ",", "3.3", ",", "3.5"}], "}"}], ",", 
        RowBox[{
         RowBox[{"0", "<", "#", "<", 
          RowBox[{"MaxMass", "[", 
           RowBox[{"LLPv", ",", "Facility", ",", "proc"}], "]"}]}], "&"}]}], 
       "]"}]}], ";"}], "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{"Facility", ",", "FacilitiesList"}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TabulatedPDF", "[", "mLLP_", "]"}], ":=", 
   RowBox[{"BlockTabulatedPDFsFromMixingsMass", "[", 
    RowBox[{
    "LLPv", ",", "SelectedFacility", ",", "mLLP", ",", "proc", ",", "nsim", 
     ",", 
     RowBox[{"\[Theta]NlistLight", "[", "SelectedFacility", "]"}], ",", 
     RowBox[{"ENlist", "[", "SelectedFacility", "]"}], ",", 
     RowBox[{"\[Theta]minExtrFacility", "[", 
      RowBox[{"SelectedFacility", ",", "proc"}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mlist", "=", 
   RowBox[{"MassList", "[", 
    RowBox[{"LLPv", ",", "proc", ",", "SelectedFacility"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"filename", "=", 
   RowBox[{"filenameToExport", "[", 
    RowBox[{"LLPv", ",", "proc", ",", "SelectedFacility"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tabulatedblock", "[", 
   RowBox[{"TabulatedPDF", ",", "mlist", ",", "filename"}], "]"}], "//", 
  "AbsoluteTiming"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"{", 
   RowBox[{"LLPv", ",", "proc", ",", "mlist"}], "}"}], "//", 
  "Clear"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.91346054127559*^9, 3.913460547406306*^9}, 
   3.913971925690368*^9, 3.914399175660119*^9, {3.91543881926388*^9, 
   3.915438819288652*^9}, 3.9164849583951025`*^9, 
   3.917281687591569*^9},ExpressionUUID->"3a5bd2e6-2cc8-4af6-bf58-\
733814264940"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["B-3Le-Lmu+Ltau", "Chapter",
 CellChangeTimes->{{3.91344144967334*^9, 3.913441455340948*^9}, {
   3.913441825113173*^9, 3.9134418258593936`*^9}, {3.913441936913423*^9, 
   3.9134419384733877`*^9}, {3.913442132020331*^9, 3.91344213360353*^9}, 
   3.9134482243227367`*^9, {3.91345317520315*^9, 3.9134531776043587`*^9}, {
   3.9134539629830503`*^9, 3.913453963424157*^9}, {3.913971813608838*^9, 
   3.913971815722853*^9}},ExpressionUUID->"eae968d8-5baa-42ac-a0db-\
10942f4085d7"],

Cell[CellGroupData[{

Cell["B-3Le-Lmu+Ltau_Bremsstrahlung", "Section",
 CellChangeTimes->{{3.913453352185865*^9, 3.9134533782464876`*^9}, {
   3.913453922929523*^9, 3.913453926944298*^9}, {3.913458295350587*^9, 
   3.913458296391029*^9}, 3.913971947610252*^9, 
   3.913972319588424*^9},ExpressionUUID->"424512e9-f719-4d07-94e6-\
c4bbf89ce856"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"LLPv", "=", "\"\<B-3Le-Lmu+Ltau\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"proc", "=", "\"\<Bremsstrahlung\>\""}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "List", " ", "of", " ", "masses", " ", "for", " ", "which", " ", "the", 
    " ", "distribution", " ", "will", " ", "be", " ", "tabulated"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"MassList", "[", 
       RowBox[{"LLPv", ",", "proc", ",", "Facility"}], "]"}], "=", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{"mV", ",", 
         RowBox[{"{", 
          RowBox[{"mV", ",", "mVminFromBrem", ",", "mVmaxFromBrem", ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", "mVmaxFromBrem", ")"}], "-", "mVminFromBrem"}], 
             ")"}], "/", "20"}]}], "}"}]}], "]"}], "//", "N"}]}], ";"}], 
    "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{"Facility", ",", "FacilitiesList"}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Theta]listBrem", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"\[Theta]Nlist", "[", "SelectedFacility", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Theta]maxBrem", "[", "SelectedFacility", "]"}], "}"}]}], 
      "]"}], "//", "DeleteDuplicates"}], "//", "Sort"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mlist", "=", 
   RowBox[{"MassList", "[", 
    RowBox[{"LLPv", ",", "proc", ",", "SelectedFacility"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BlockTabulatedPDFsFromBrem", "[", 
   RowBox[{"LLPv", ",", "SelectedFacility", ",", "mlist"}], "]"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"TabulatedPDF", "[", "mLLP_", "]"}], ":=", 
      RowBox[{"BlockTabulatedPDFsFromBrem", "[", 
       RowBox[{
       "LLPv", ",", "mLLP", ",", "\[Theta]listBrem", ",", 
        "SelectedFacility"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"filename", "=", 
      RowBox[{"filenameToExport", "[", 
       RowBox[{"LLPv", ",", "proc", ",", "SelectedFacility"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"mlist", "=", 
      RowBox[{"MassList", "[", 
       RowBox[{"LLPv", ",", "proc", ",", "SelectedFacility"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"tabulatedblock", "[", 
      RowBox[{"TabulatedPDF", ",", "mlist", ",", "filename"}], "]"}], ";"}], "//",
     "AbsoluteTiming"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"{", 
   RowBox[{"LLPv", ",", "proc", ",", "mlist"}], "}"}], "//", 
  "Clear"}]}], "Input",
 CellChangeTimes->{{3.913457551250987*^9, 3.913457646228073*^9}, {
   3.913458630065926*^9, 3.913458638183439*^9}, {3.913461405272519*^9, 
   3.913461433780708*^9}, 3.913827457266136*^9, 3.913971947614239*^9, 
   3.9140562348564367`*^9, 3.914494778805792*^9, {3.915438819298685*^9, 
   3.915438819321699*^9}, 3.9171657092514105`*^9, {3.917281687596603*^9, 
   3.9172817031062613`*^9}},ExpressionUUID->"9334e8af-383e-4e38-8282-\
b1f11c2f2232"]
}, Closed]],

Cell[CellGroupData[{

Cell["B-3Le-Lmu+Ltau_Pi0", "Section",
 CellChangeTimes->{{3.913453352185865*^9, 3.9134533782464876`*^9}, {
   3.913453922929523*^9, 3.9134539415854807`*^9}, 3.913454105998377*^9, 
   3.913971947622102*^9},ExpressionUUID->"28ab8c80-3963-4ee8-9f09-\
392e4b424d50"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"LLPv", "=", "\"\<B-3Le-Lmu+Ltau\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"proc", "=", "\"\<Pi0\>\""}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "List", " ", "of", " ", "masses", " ", "for", " ", "which", " ", "the", 
    " ", "distribution", " ", "will", " ", "be", " ", "tabulated"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"MassList", "[", 
       RowBox[{"LLPv", ",", "proc", ",", "Facility"}], "]"}], "=", 
      RowBox[{"Select", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0.02", ",", "0.05", ",", "0.1", ",", 
          RowBox[{
           RowBox[{"MaxMass", "[", 
            RowBox[{"LLPv", ",", "Facility", ",", "proc"}], "]"}], "*", 
           "0.99"}]}], "}"}], ",", 
        RowBox[{
         RowBox[{"0", "<", "#", "<", 
          RowBox[{"MaxMass", "[", 
           RowBox[{"LLPv", ",", "Facility", ",", "proc"}], "]"}]}], "&"}]}], 
       "]"}]}], ";"}], "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{"Facility", ",", "FacilitiesList"}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TabulatedPDF", "[", "mLLP_", "]"}], ":=", 
   RowBox[{"BlockTabulatedPDFsFromDecaysMass", "[", 
    RowBox[{
    "LLPv", ",", "SelectedFacility", ",", "mLLP", ",", "proc", ",", "nsim", 
     ",", 
     RowBox[{"\[Theta]NlistLight", "[", "SelectedFacility", "]"}], ",", 
     RowBox[{"ENlist", "[", "SelectedFacility", "]"}], ",", 
     RowBox[{"\[Theta]minExtrFacility", "[", 
      RowBox[{"SelectedFacility", ",", "proc"}], "]"}], ",", 
     "\"\<False\>\""}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"filename", "=", 
   RowBox[{"filenameToExport", "[", 
    RowBox[{"LLPv", ",", "proc", ",", "SelectedFacility"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mlist", "=", 
   RowBox[{"MassList", "[", 
    RowBox[{"LLPv", ",", "proc", ",", "SelectedFacility"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tabulatedblock", "[", 
   RowBox[{"TabulatedPDF", ",", "mlist", ",", "filename"}], "]"}], "//", 
  "AbsoluteTiming"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"{", 
   RowBox[{"LLPv", ",", "proc", ",", "mlist"}], "}"}], "//", 
  "Clear"}]}], "Input",
 CellChangeTimes->{{3.9134539970875425`*^9, 3.9134540004022136`*^9}, {
   3.913454051763443*^9, 3.913454052133419*^9}, {3.913454102913801*^9, 
   3.91345410336136*^9}, 3.913971947627108*^9, 3.915083933941103*^9, {
   3.915438819330698*^9, 3.915438819357689*^9}, 
   3.917281687600602*^9},ExpressionUUID->"7bb4844f-f742-4ef6-aa35-\
568e65ac38cf"]
}, Closed]],

Cell[CellGroupData[{

Cell["B-3Le-Lmu+Ltau_Eta", "Section",
 CellChangeTimes->{{3.913453352185865*^9, 3.9134533782464876`*^9}, {
   3.913453922929523*^9, 3.91345394437442*^9}, 3.9134541077646427`*^9, 
   3.913971947634092*^9},ExpressionUUID->"651189a8-2e51-4e02-9f8c-\
f6ed1e694eaf"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"LLPv", "=", "\"\<B-3Le-Lmu+Ltau\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"proc", "=", "\"\<Eta\>\""}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "List", " ", "of", " ", "masses", " ", "for", " ", "which", " ", "the", 
    " ", "distribution", " ", "will", " ", "be", " ", "tabulated"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"MassList", "[", 
       RowBox[{"LLPv", ",", "proc", ",", "Facility"}], "]"}], "=", 
      RowBox[{"Select", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "0.02", ",", "0.05", ",", "0.1", ",", "0.2", ",", "0.3", ",", "0.45",
           ",", 
          RowBox[{
           RowBox[{"MaxMass", "[", 
            RowBox[{"LLPv", ",", "Facility", ",", "proc"}], "]"}], "*", 
           "0.99"}]}], "}"}], ",", 
        RowBox[{
         RowBox[{"0", "<", "#", "<", 
          RowBox[{"MaxMass", "[", 
           RowBox[{"LLPv", ",", "Facility", ",", "proc"}], "]"}]}], "&"}]}], 
       "]"}]}], ";"}], "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{"Facility", ",", "FacilitiesList"}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TabulatedPDF", "[", "mLLP_", "]"}], ":=", 
   RowBox[{"BlockTabulatedPDFsFromDecaysMass", "[", 
    RowBox[{
    "LLPv", ",", "SelectedFacility", ",", "mLLP", ",", "proc", ",", "nsim", 
     ",", 
     RowBox[{"\[Theta]NlistLight", "[", "SelectedFacility", "]"}], ",", 
     RowBox[{"ENlist", "[", "SelectedFacility", "]"}], ",", 
     RowBox[{"\[Theta]minExtrFacility", "[", 
      RowBox[{"SelectedFacility", ",", "proc"}], "]"}], ",", 
     "\"\<False\>\""}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"filename", "=", 
   RowBox[{"filenameToExport", "[", 
    RowBox[{"LLPv", ",", "proc", ",", "SelectedFacility"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mlist", "=", 
   RowBox[{"MassList", "[", 
    RowBox[{"LLPv", ",", "proc", ",", "SelectedFacility"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tabulatedblock", "[", 
   RowBox[{"TabulatedPDF", ",", "mlist", ",", "filename"}], "]"}], "//", 
  "AbsoluteTiming"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"{", 
   RowBox[{"LLPv", ",", "proc", ",", "mlist"}], "}"}], "//", 
  "Clear"}]}], "Input",
 CellChangeTimes->{{3.913454045623446*^9, 3.913454071794718*^9}, 
   3.913454109393179*^9, 3.913971947639202*^9, 3.915083933946108*^9, {
   3.915438819366692*^9, 3.9154388193948975`*^9}, 
   3.917281687605877*^9},ExpressionUUID->"7e49053e-10cf-446e-8dbc-\
62f07135b0de"]
}, Closed]],

Cell[CellGroupData[{

Cell["B-3Le-Lmu+Ltau_EtaPr", "Section",
 CellChangeTimes->{{3.913453352185865*^9, 3.9134533782464876`*^9}, {
   3.913453922929523*^9, 3.9134539472505245`*^9}, 3.9134541137458167`*^9, 
   3.913971947646202*^9},ExpressionUUID->"7133dd8e-4b5f-4dd4-be24-\
7225ca87c5aa"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"LLPv", "=", "\"\<B-3Le-Lmu+Ltau\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"proc", "=", "\"\<EtaPr\>\""}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "List", " ", "of", " ", "masses", " ", "for", " ", "which", " ", "the", 
    " ", "distribution", " ", "will", " ", "be", " ", "tabulated"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"MassList", "[", 
       RowBox[{"LLPv", ",", "proc", ",", "Facility"}], "]"}], "=", 
      RowBox[{"Select", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "0.02", ",", "0.05", ",", "0.1", ",", "0.2", ",", "0.3", ",", "0.5", 
          ",", "0.7", ",", "0.9", ",", 
          RowBox[{
           RowBox[{"MaxMass", "[", 
            RowBox[{"LLPv", ",", "Facility", ",", "proc"}], "]"}], "*", 
           "0.99"}]}], "}"}], ",", 
        RowBox[{
         RowBox[{"0", "<", "#", "<", 
          RowBox[{"MaxMass", "[", 
           RowBox[{"LLPv", ",", "Facility", ",", "proc"}], "]"}]}], "&"}]}], 
       "]"}]}], ";"}], "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{"Facility", ",", "FacilitiesList"}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TabulatedPDF", "[", "mLLP_", "]"}], ":=", 
   RowBox[{"BlockTabulatedPDFsFromDecaysMass", "[", 
    RowBox[{
    "LLPv", ",", "SelectedFacility", ",", "mLLP", ",", "proc", ",", "nsim", 
     ",", 
     RowBox[{"\[Theta]NlistLight", "[", "SelectedFacility", "]"}], ",", 
     RowBox[{"ENlist", "[", "SelectedFacility", "]"}], ",", 
     RowBox[{"\[Theta]minExtrFacility", "[", 
      RowBox[{"SelectedFacility", ",", "proc"}], "]"}], ",", 
     "\"\<False\>\""}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"filename", "=", 
   RowBox[{"filenameToExport", "[", 
    RowBox[{"LLPv", ",", "proc", ",", "SelectedFacility"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mlist", "=", 
   RowBox[{"MassList", "[", 
    RowBox[{"LLPv", ",", "proc", ",", "SelectedFacility"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tabulatedblock", "[", 
   RowBox[{"TabulatedPDF", ",", "mlist", ",", "filename"}], "]"}], "//", 
  "AbsoluteTiming"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"{", 
   RowBox[{"LLPv", ",", "proc", ",", "mlist"}], "}"}], "//", 
  "Clear"}]}], "Input",
 CellChangeTimes->{{3.913454078743132*^9, 3.913454111494183*^9}, 
   3.913971947650023*^9, 3.9150839339510937`*^9, {3.9154388194080663`*^9, 
   3.91543881943762*^9}, 
   3.9172816876098833`*^9},ExpressionUUID->"cf1de428-c657-4783-a369-\
9b323e9bdc54"]
}, Closed]],

Cell[CellGroupData[{

Cell["B-3Le-Lmu+Ltau_Omega", "Section",
 CellChangeTimes->{{3.913453352185865*^9, 3.9134533782464876`*^9}, {
   3.913453922929523*^9, 3.913453974067208*^9}, 
   3.9139719476575203`*^9},ExpressionUUID->"376807d7-c880-4710-bdc3-\
b0a2de4f7c05"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"LLPv", "=", "\"\<B-3Le-Lmu+Ltau\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"proc", "=", "\"\<Omega\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"MassList", "[", 
       RowBox[{"LLPv", ",", "proc", ",", "Facility"}], "]"}], "=", 
      RowBox[{"Select", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "0.02", ",", "0.05", ",", "0.1", ",", "0.3", ",", "0.5", ",", "0.77",
           ",", "1.", ",", "1.2", ",", "1.3", ",", "1.4", ",", "1.5", ",", 
          "1.6", ",", "1.7", ",", "1.8", ",", "1.9", ",", "2.", ",", "2.1", 
          ",", "2.2", ",", "2.3", ",", "2.4", ",", "2.5", ",", "2.6", ",", 
          "2.7", ",", "2.8", ",", "2.9", ",", "3.", ",", "3.1", ",", "3.2", 
          ",", "3.3", ",", "3.5"}], "}"}], ",", 
        RowBox[{
         RowBox[{"0", "<", "#", "<", 
          RowBox[{"MaxMass", "[", 
           RowBox[{"LLPv", ",", "Facility", ",", "proc"}], "]"}]}], "&"}]}], 
       "]"}]}], ";"}], "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{"Facility", ",", "FacilitiesList"}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TabulatedPDF", "[", "mLLP_", "]"}], ":=", 
   RowBox[{"BlockTabulatedPDFsFromMixingsMass", "[", 
    RowBox[{
    "LLPv", ",", "SelectedFacility", ",", "mLLP", ",", "proc", ",", "nsim", 
     ",", 
     RowBox[{"\[Theta]NlistLight", "[", "SelectedFacility", "]"}], ",", 
     RowBox[{"ENlist", "[", "SelectedFacility", "]"}], ",", 
     RowBox[{"\[Theta]minExtrFacility", "[", 
      RowBox[{"SelectedFacility", ",", "proc"}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mlist", "=", 
   RowBox[{"MassList", "[", 
    RowBox[{"LLPv", ",", "proc", ",", "SelectedFacility"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"filename", "=", 
   RowBox[{"filenameToExport", "[", 
    RowBox[{"LLPv", ",", "proc", ",", "SelectedFacility"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tabulatedblock", "[", 
   RowBox[{"TabulatedPDF", ",", "mlist", ",", "filename"}], "]"}], "//", 
  "AbsoluteTiming"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"{", 
   RowBox[{"LLPv", ",", "proc", ",", "mlist"}], "}"}], "//", 
  "Clear"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.91346054127559*^9, 3.913460547406306*^9}, 
   3.91397195675774*^9, 3.914399181915732*^9, {3.915438819450126*^9, 
   3.9154388194744577`*^9}, 3.916484966706641*^9, 
   3.917281687614996*^9},ExpressionUUID->"7ad477aa-f875-4aba-b4e8-\
9d5a231c7213"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["ALP-photon", "Chapter",
 CellChangeTimes->{{3.91344144967334*^9, 3.913441455340948*^9}, {
   3.913441825113173*^9, 3.9134418258593936`*^9}, {3.913441936913423*^9, 
   3.9134419384733877`*^9}, {3.913442132020331*^9, 3.91344213360353*^9}, 
   3.9134482243227367`*^9, {3.91345317520315*^9, 3.9134531776043587`*^9}, {
   3.913453211473675*^9, 
   3.913453213313236*^9}},ExpressionUUID->"1ff679f7-11c2-47ef-a94a-\
5eaa4e1c27d3"],

Cell[CellGroupData[{

Cell["ALP-photon_Pi0", "Section",
 CellChangeTimes->{{3.913453352185865*^9, 3.9134533782464876`*^9}, {
   3.913453922929523*^9, 3.913453974067208*^9}, {3.9134608232129736`*^9, 
   3.913460832416258*^9}, 3.913460973505757*^9, {3.91347421718079*^9, 
   3.9134742245406713`*^9}},ExpressionUUID->"dc38b62d-01b4-4a1b-b9f4-\
68ae754543a2"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"LLPv", "=", "\"\<ALP-photon\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"proc", "=", "\"\<Pi0\>\""}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "List", " ", "of", " ", "masses", " ", "for", " ", "which", " ", "the", 
    " ", "distribution", " ", "will", " ", "be", " ", "tabulated"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"MassList", "[", 
       RowBox[{"LLPv", ",", "proc", ",", "Facility"}], "]"}], "=", 
      RowBox[{"Select", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "0.02", ",", "0.05", ",", "0.1", ",", "0.115", ",", "0.132"}], "}"}],
         ",", 
        RowBox[{
         RowBox[{"0", "<", "#", "<", 
          RowBox[{"MaxMass", "[", 
           RowBox[{"LLPv", ",", "Facility", ",", "proc"}], "]"}]}], "&"}]}], 
       "]"}]}], ";"}], "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{"Facility", ",", "FacilitiesList"}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TabulatedPDF", "[", "mLLP_", "]"}], ":=", 
   RowBox[{"BlockTabulatedPDFsFromDecaysMass", "[", 
    RowBox[{
    "LLPv", ",", "SelectedFacility", ",", "mLLP", ",", "proc", ",", "nsim", 
     ",", 
     RowBox[{"\[Theta]Nlist", "[", "SelectedFacility", "]"}], ",", 
     RowBox[{"ENlist", "[", "SelectedFacility", "]"}], ",", 
     RowBox[{"\[Theta]minExtrFacility", "[", 
      RowBox[{"SelectedFacility", ",", "proc"}], "]"}], ",", 
     "\"\<False\>\""}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"filename", "=", 
   RowBox[{"filenameToExport", "[", 
    RowBox[{"LLPv", ",", "proc", ",", "SelectedFacility"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mlist", "=", 
   RowBox[{"MassList", "[", 
    RowBox[{"LLPv", ",", "proc", ",", "SelectedFacility"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tabulatedblock", "[", 
   RowBox[{"TabulatedPDF", ",", "mlist", ",", "filename"}], "]"}], "//", 
  "AbsoluteTiming"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"{", 
   RowBox[{"LLPv", ",", "proc", ",", "mlist"}], "}"}], "//", 
  "Clear"}]}], "Input",
 CellChangeTimes->{{3.913474334639536*^9, 3.913474345582692*^9}, 
   3.9150839339560995`*^9, {3.915438819483558*^9, 3.915438819510817*^9}, {
   3.9166475714867525`*^9, 3.91664758104018*^9}, {3.916649061891786*^9, 
   3.9166490654344563`*^9}, {3.916650638026409*^9, 3.916650642795153*^9}},
 CellLabel->
  "In[1695]:=",ExpressionUUID->"c5bc112b-779d-4417-a559-b057ff607c66"]
}, Closed]],

Cell[CellGroupData[{

Cell["ALP-photon_Eta", "Section",
 CellChangeTimes->{{3.913453352185865*^9, 3.9134533782464876`*^9}, {
   3.913453922929523*^9, 3.913453974067208*^9}, {3.9134608232129736`*^9, 
   3.913460832416258*^9}, 3.913460973505757*^9, {3.913474220530658*^9, 
   3.913474229609611*^9}},ExpressionUUID->"c3b0b688-7334-4095-9583-\
39aeb045e083"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"LLPv", "=", "\"\<ALP-photon\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"proc", "=", "\"\<Eta\>\""}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "List", " ", "of", " ", "masses", " ", "for", " ", "which", " ", "the", 
    " ", "distribution", " ", "will", " ", "be", " ", "tabulated"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"MassList", "[", 
       RowBox[{"LLPv", ",", "proc", ",", "Facility"}], "]"}], "=", 
      RowBox[{"Select", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "0.02", ",", "0.05", ",", "0.1", ",", "0.25", ",", "0.4", ",", "0.5",
           ",", 
          RowBox[{
           RowBox[{"MaxMass", "[", 
            RowBox[{"LLPv", ",", "Facility", ",", "proc"}], "]"}], "*", 
           "0.99"}]}], "}"}], ",", 
        RowBox[{
         RowBox[{"0", "<", "#", "<", 
          RowBox[{"MaxMass", "[", 
           RowBox[{"LLPv", ",", "Facility", ",", "proc"}], "]"}]}], "&"}]}], 
       "]"}]}], ";"}], "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{"Facility", ",", "FacilitiesList"}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TabulatedPDF", "[", "mLLP_", "]"}], ":=", 
   RowBox[{"BlockTabulatedPDFsFromDecaysMass", "[", 
    RowBox[{
    "LLPv", ",", "SelectedFacility", ",", "mLLP", ",", "proc", ",", "nsim", 
     ",", 
     RowBox[{"\[Theta]Nlist", "[", "SelectedFacility", "]"}], ",", 
     RowBox[{"ENlist", "[", "SelectedFacility", "]"}], ",", 
     RowBox[{"\[Theta]minExtrFacility", "[", 
      RowBox[{"SelectedFacility", ",", "proc"}], "]"}], ",", 
     "\"\<False\>\""}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"filename", "=", 
   RowBox[{"filenameToExport", "[", 
    RowBox[{"LLPv", ",", "proc", ",", "SelectedFacility"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mlist", "=", 
   RowBox[{"MassList", "[", 
    RowBox[{"LLPv", ",", "proc", ",", "SelectedFacility"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tabulatedblock", "[", 
   RowBox[{"TabulatedPDF", ",", "mlist", ",", "filename"}], "]"}], "//", 
  "AbsoluteTiming"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"{", 
   RowBox[{"LLPv", ",", "proc", ",", "mlist"}], "}"}], "//", 
  "Clear"}]}], "Input",
 CellChangeTimes->{{3.91347435613622*^9, 3.913474367303986*^9}, 
   3.915083933961097*^9, {3.91543881952296*^9, 3.915438819558494*^9}},
 CellLabel->
  "In[1703]:=",ExpressionUUID->"90617451-111e-4106-831c-e46b65fea4b9"]
}, Closed]],

Cell[CellGroupData[{

Cell["ALP-photon_Primakov", "Section",
 CellChangeTimes->{{3.913453352185865*^9, 3.9134533782464876`*^9}, {
   3.913453922929523*^9, 3.913453974067208*^9}, {3.9134608232129736`*^9, 
   3.913460832416258*^9}, 3.913460973505757*^9, {3.913474220530658*^9, 
   3.913474247660492*^9}},ExpressionUUID->"53c9e46b-c0fb-4172-8bda-\
45896eb4142e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"LLPv", "=", "\"\<ALP-photon\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"proc", "=", "\"\<Primakov\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"MassList", "[", 
      RowBox[{"LLPv", ",", "proc", ",", "Facility"}], "]"}], "=", 
     RowBox[{"{", 
      RowBox[{
      "0.02", ",", "0.05", ",", "0.1", ",", "0.25", ",", "0.5", ",", "0.75", 
       ",", "1.", ",", "1.3", ",", "1.5", ",", "1.75", ",", "2.", ",", "2.25",
        ",", "2.5", ",", "2.75", ",", "3.", ",", "3.25", ",", "3.5", ",", 
       "3.75", ",", "4."}], "}"}]}], ";"}], "\[IndentingNewLine]", ",", 
   RowBox[{"{", 
    RowBox[{"Facility", ",", "FacilitiesList"}], "}"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Zlist", "=", 
   RowBox[{"NucleiList", "[", 
    RowBox[{"SelectedFacility", ",", "proc"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Monitor", "[", 
   RowBox[{
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{"BlockTabulatedPDFsFromPrimakov", "[", 
       RowBox[{"SelectedFacility", ",", 
        RowBox[{"Zlist", "[", 
         RowBox[{"[", "l", "]"}], "]"}], ",", 
        RowBox[{"\[Theta]Nlist", "[", "SelectedFacility", "]"}], ",", 
        RowBox[{"ENlist", "[", "SelectedFacility", "]"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"l", ",", "1", ",", 
        RowBox[{"Length", "[", "Zlist", "]"}], ",", "1"}], "}"}]}], "]"}], 
    ",", 
    RowBox[{"Row", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"ProgressIndicator", "[", 
        RowBox[{"l", ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", 
           RowBox[{"Length", "[", "Zlist", "]"}]}], "}"}]}], "]"}], ",", 
       "\"\< Nucleus = \>\"", ",", 
       RowBox[{"Zlist", "[", 
        RowBox[{"[", "l", "]"}], "]"}], ",", "\"\< (\>\"", ",", "l", ",", 
       "\"\</\>\"", ",", 
       RowBox[{"Length", "[", "Zlist", "]"}], ",", "\"\<)\>\""}], "}"}], 
     "]"}]}], "]"}], "//", "AbsoluteTiming"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"{", 
   RowBox[{"LLPv", ",", "proc", ",", "Zlist"}], "}"}], "//", 
  "Clear"}]}], "Input",
 CellChangeTimes->{{3.913475655624738*^9, 3.9134757070248585`*^9}, {
   3.913476416948311*^9, 3.913476539264863*^9}, 3.9134766260560637`*^9, {
   3.913476735484501*^9, 3.913476867558789*^9}, {3.913477018964658*^9, 
   3.9134770302755775`*^9}, {3.913477133014517*^9, 3.913477357674809*^9}, {
   3.913477393614634*^9, 3.913477420303617*^9}, {3.913477460984788*^9, 
   3.913477503235527*^9}, {3.9134775815447273`*^9, 3.913477601565693*^9}, {
   3.913477665756231*^9, 3.9134779255744267`*^9}, {3.913477967685485*^9, 
   3.913478060835605*^9}, {3.913478102094883*^9, 3.913478121424763*^9}, {
   3.913478197145369*^9, 3.913478353594558*^9}, {3.9134784334947376`*^9, 
   3.913478504265826*^9}, {3.9134790772388473`*^9, 3.913479114318435*^9}, 
   3.913479227463941*^9, {3.913707818674203*^9, 3.913707818920031*^9}, {
   3.9137083792153797`*^9, 3.9137084049781284`*^9}, {3.9137084921378713`*^9, 
   3.913708518372843*^9}, 3.9137143032593594`*^9, 3.913714377985925*^9, 
   3.915082852073013*^9, {3.91543881956849*^9, 3.9154388195743127`*^9}},
 CellLabel->
  "In[972]:=",ExpressionUUID->"1ad078a1-636a-460a-8113-b8e2d575e180"]
}, Closed]],

Cell[CellGroupData[{

Cell["ALP-photon_Photon-fusion", "Section",
 CellChangeTimes->{{3.913453352185865*^9, 3.9134533782464876`*^9}, {
   3.913453922929523*^9, 3.913453974067208*^9}, {3.9134608232129736`*^9, 
   3.913460832416258*^9}, 3.913460973505757*^9, {3.913474220530658*^9, 
   3.913474252930853*^9}},ExpressionUUID->"407b885d-c528-4bb6-80ea-\
a5a1259d4b81"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Currently", ",", " ", 
    RowBox[{
     RowBox[{
     "it", " ", "is", " ", "very", " ", "slow", " ", "for", " ", "LHC", " ", 
      "and", " ", "FCC"}], "-", 
     RowBox[{
      RowBox[{"hh", ".", " ", "I"}], " ", "cannot", " ", "efficiently", " ", 
      "handle", " ", "the", " ", "singularity", " ", "at", " ", "the", " ", 
      "integration", " ", "boundaries"}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"LLPv", "=", "\"\<ALP-photon\>\""}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"proc", "=", "\"\<Photon-fusion\>\""}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"MassList", "[", 
        RowBox[{"LLPv", ",", "proc", ",", "Facility"}], "]"}], "=", 
       RowBox[{"{", 
        RowBox[{
        "0.02", ",", "0.05", ",", "0.1", ",", "0.25", ",", "0.5", ",", "0.75",
          ",", "1.", ",", "1.3", ",", "1.5", ",", "1.75", ",", "2."}], 
        "}"}]}], ";"}], "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{"Facility", ",", "FacilitiesList"}], "}"}]}], "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Zlist", "=", 
     RowBox[{"NucleiList", "[", 
      RowBox[{"SelectedFacility", ",", "proc"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Monitor", "[", 
     RowBox[{
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{"BlockTabulatedPDFsFromFusion", "[", 
         RowBox[{"SelectedFacility", ",", 
          RowBox[{"Zlist", "[", 
           RowBox[{"[", "l", "]"}], "]"}], ",", 
          RowBox[{"\[Theta]Nlist", "[", "SelectedFacility", "]"}], ",", 
          RowBox[{"ENlist", "[", "SelectedFacility", "]"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"l", ",", "1", ",", 
          RowBox[{"Length", "[", "Zlist", "]"}], ",", "1"}], "}"}]}], "]"}], 
      ",", 
      RowBox[{"Row", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"ProgressIndicator", "[", 
          RowBox[{"l", ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", 
             RowBox[{"Length", "[", "Zlist", "]"}]}], "}"}]}], "]"}], ",", 
         "\"\< Nucleus = \>\"", ",", 
         RowBox[{"Zlist", "[", 
          RowBox[{"[", "l", "]"}], "]"}], ",", "\"\< (\>\"", ",", "l", ",", 
         "\"\</\>\"", ",", 
         RowBox[{"Length", "[", "Zlist", "]"}], ",", "\"\<)\>\""}], "}"}], 
       "]"}]}], "]"}], "//", "AbsoluteTiming"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"LLPv", ",", "proc"}], "}"}], "//", "Clear"}]}]}]], "Input",
 CellChangeTimes->{{3.913628493799095*^9, 3.9136285623413587`*^9}, {
   3.913707324022438*^9, 3.913707459818387*^9}, {3.913707763590597*^9, 
   3.913707779203494*^9}, {3.913708383670935*^9, 3.9137084812780333`*^9}, {
   3.913714236006479*^9, 3.913714304529477*^9}, 3.913714374190718*^9, 
   3.91508286838514*^9, {3.9154388195833063`*^9, 3.915438819589798*^9}},
 CellLabel->
  "In[730]:=",ExpressionUUID->"6e09d98e-c619-4b6d-bfca-c18434d55906"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["ALP-gluon", "Chapter",
 CellChangeTimes->{{3.91344144967334*^9, 3.913441455340948*^9}, {
   3.913441825113173*^9, 3.9134418258593936`*^9}, {3.913441936913423*^9, 
   3.9134419384733877`*^9}, {3.913442132020331*^9, 3.91344213360353*^9}, 
   3.9134482243227367`*^9, {3.91345317520315*^9, 3.9134531776043587`*^9}, {
   3.913453215805359*^9, 
   3.913453218272456*^9}},ExpressionUUID->"c3df3bae-3a65-45c7-ad4d-\
5d271052cba7"],

Cell[CellGroupData[{

Cell["ALP-gluon_B", "Section",
 CellChangeTimes->{{3.913453352185865*^9, 3.9134533782464876`*^9}, {
  3.913453922929523*^9, 3.913453974067208*^9}, {3.9134608232129736`*^9, 
  3.913460832416258*^9}},ExpressionUUID->"693c69cb-91f9-4db0-95f2-\
dc2b419fd7d7"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"LLPv", "=", "\"\<ALP-gluon\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"proc", "=", "\"\<B\>\""}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "List", " ", "of", " ", "masses", " ", "for", " ", "which", " ", "the", 
    " ", "distribution", " ", "will", " ", "be", " ", "tabulated"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"MassList", "[", 
       RowBox[{"LLPv", ",", "proc", ",", "Facility"}], "]"}], "=", 
      RowBox[{"{", 
       RowBox[{
       "0.02", ",", "0.05", ",", "0.2", ",", "0.5", ",", "1", ",", "1.5", ",",
         "2.", ",", "2.5", ",", "3.", ",", "3.5", ",", "4.", ",", "4.8", ",", 
        "5.13"}], "}"}]}], ";"}], "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{"Facility", ",", "FacilitiesList"}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TabulatedPDF", "[", "mLLP_", "]"}], ":=", 
   RowBox[{"BlockTabulatedPDFsFromDecaysMass", "[", 
    RowBox[{
    "LLPv", ",", "SelectedFacility", ",", "mLLP", ",", "proc", ",", "nsim", 
     ",", 
     RowBox[{"\[Theta]Nlist", "[", "SelectedFacility", "]"}], ",", 
     RowBox[{"ENlist", "[", "SelectedFacility", "]"}], ",", 
     RowBox[{"\[Theta]minExtrFacility", "[", 
      RowBox[{"SelectedFacility", ",", "proc"}], "]"}], ",", 
     "\"\<False\>\""}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"filename", "=", 
   RowBox[{"filenameToExport", "[", 
    RowBox[{"LLPv", ",", "proc", ",", "SelectedFacility"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mlist", "=", 
   RowBox[{"MassList", "[", 
    RowBox[{"LLPv", ",", "proc", ",", "SelectedFacility"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tabulatedblock", "[", 
   RowBox[{"TabulatedPDF", ",", "mlist", ",", "filename"}], "]"}], "//", 
  "AbsoluteTiming"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"{", 
   RowBox[{"LLPv", ",", "proc", ",", "mlist"}], "}"}], "//", 
  "Clear"}]}], "Input",
 CellChangeTimes->{{3.913460932762819*^9, 3.913460941897598*^9}, 
   3.9150839339661016`*^9, {3.915438819598284*^9, 3.915438819620054*^9}},
 CellLabel->
  "In[676]:=",ExpressionUUID->"c05ccb26-07ab-4d09-936b-328762403958"]
}, Closed]],

Cell[CellGroupData[{

Cell["ALP-gluon_Pi0", "Section",
 CellChangeTimes->{{3.913453352185865*^9, 3.9134533782464876`*^9}, {
  3.913453922929523*^9, 3.913453974067208*^9}, {3.9134608304473605`*^9, 
  3.913460834702962*^9}},ExpressionUUID->"1f53f8f3-a879-4e1d-a372-\
bcaa226efa05"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"LLPv", "=", "\"\<ALP-gluon\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"proc", "=", "\"\<Pi0\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"Facility", "!=", "\"\<ESS\>\""}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"MassList", "[", 
         RowBox[{"LLPv", ",", "proc", ",", "Facility"}], "]"}], "=", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "0.02", ",", "0.05", ",", "0.1", ",", "0.135", ",", "0.2", ",", 
            "0.3", ",", "0.4", ",", "0.5", ",", "0.65", ",", "0.7", ",", 
            "0.8", ",", "0.9", ",", "1.", ",", "1.1", ",", "1.2", ",", "1.3", 
            ",", "1.4", ",", "1.5", ",", "1.6", ",", "1.7", ",", "1.8", ",", 
            "1.9", ",", "2.", ",", "2.1", ",", "2.2", ",", "2.3", ",", "2.4", 
            ",", "2.5", ",", "2.6", ",", "2.7", ",", "2.8", ",", "2.9", ",", 
            "3.", ",", "3.1", ",", "3.2", ",", "3.3", ",", "3.4", ",", 
            "3.5"}], "}"}], ",", 
          RowBox[{
           RowBox[{"0", "<", "#", "<", 
            RowBox[{"MaxMass", "[", 
             RowBox[{"LLPv", ",", "Facility", ",", "proc"}], "]"}]}], "&"}]}],
          "]"}]}], ";"}], "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"MassList", "[", 
         RowBox[{"LLPv", ",", "proc", ",", "Facility"}], "]"}], "=", 
        RowBox[{"{", 
         RowBox[{
         "0.02", ",", "0.03", ",", "0.04", ",", "0.05", ",", "0.06", ",", 
          "0.065", ",", "0.07", ",", "0.075", ",", "0.08", ",", "0.085", ",", 
          "0.09", ",", "0.095", ",", "0.1", ",", "0.105", ",", "0.11", ",", 
          "0.115", ",", "0.12", ",", "0.125", ",", "0.13", ",", "0.135"}], 
         "}"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], 
    "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{"Facility", ",", "FacilitiesList"}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TabulatedPDF", "[", "mLLP_", "]"}], ":=", 
   RowBox[{"BlockTabulatedPDFsFromMixingsMass", "[", 
    RowBox[{
    "LLPv", ",", "SelectedFacility", ",", "mLLP", ",", "proc", ",", "nsim", 
     ",", 
     RowBox[{"\[Theta]Nlist", "[", "SelectedFacility", "]"}], ",", 
     RowBox[{"ENlist", "[", "SelectedFacility", "]"}], ",", 
     RowBox[{"\[Theta]minExtrFacility", "[", 
      RowBox[{"SelectedFacility", ",", "proc"}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mlist", "=", 
   RowBox[{"MassList", "[", 
    RowBox[{"LLPv", ",", "proc", ",", "SelectedFacility"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"filename", "=", 
   RowBox[{"filenameToExport", "[", 
    RowBox[{"LLPv", ",", "proc", ",", "SelectedFacility"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tabulatedblock", "[", 
   RowBox[{"TabulatedPDF", ",", "mlist", ",", "filename"}], "]"}], "//", 
  "AbsoluteTiming"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"{", 
   RowBox[{"LLPv", ",", "proc", ",", "mlist"}], "}"}], "//", 
  "Clear"}]}], "Input",
 CellChangeTimes->{{3.91346054127559*^9, 3.913460547406306*^9}, {
   3.913460855788334*^9, 3.9134608674017687`*^9}, {3.9143978142599297`*^9, 
   3.914397868721172*^9}, {3.914398156720154*^9, 3.914398200297174*^9}, {
   3.915438819632364*^9, 3.915438819655339*^9}, 3.916286001659078*^9, {
   3.916286190856291*^9, 3.916286196130876*^9}, {3.916286241459485*^9, 
   3.916286245776383*^9}, {3.916286304773733*^9, 3.916286308970378*^9}, {
   3.916286359931918*^9, 3.916286361945492*^9}, {3.916287009589689*^9, 
   3.9162870173109283`*^9}, {3.916388654810366*^9, 3.916388713846266*^9}, 
   3.91639005673259*^9, {3.916390729071457*^9, 3.916390757382484*^9}, 
   3.916484975042451*^9},
 CellLabel->
  "In[684]:=",ExpressionUUID->"5760f377-ef1a-47e2-bf65-7495a9037542"]
}, Closed]],

Cell[CellGroupData[{

Cell["ALP-gluon_Eta", "Section",
 CellChangeTimes->{{3.913453352185865*^9, 3.9134533782464876`*^9}, {
  3.913453922929523*^9, 3.913453974067208*^9}, {3.913460838422539*^9, 
  3.913460842251025*^9}},ExpressionUUID->"1af52a9e-a656-472e-b530-\
4596f963b740"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"LLPv", "=", "\"\<ALP-gluon\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"proc", "=", "\"\<Eta\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"MassList", "[", 
       RowBox[{"LLPv", ",", "proc", ",", "Facility"}], "]"}], "=", 
      RowBox[{"Select", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "0.02", ",", "0.05", ",", "0.1", ",", "0.135", ",", "0.2", ",", 
          "0.3", ",", "0.4", ",", "0.547", ",", "0.65", ",", "0.7", ",", 
          "0.8", ",", "0.9", ",", "1.", ",", "1.1", ",", "1.2", ",", "1.3", 
          ",", "1.4", ",", "1.5", ",", "1.6", ",", "1.7", ",", "1.8", ",", 
          "1.9", ",", "2.", ",", "2.1", ",", "2.2", ",", "2.3", ",", "2.4", 
          ",", "2.5", ",", "2.6", ",", "2.7", ",", "2.8", ",", "2.9", ",", 
          "3.", ",", "3.1", ",", "3.2", ",", "3.3", ",", "3.4", ",", "3.5"}], 
         "}"}], ",", 
        RowBox[{
         RowBox[{"0", "<", "#", "<", 
          RowBox[{"MaxMass", "[", 
           RowBox[{"LLPv", ",", "Facility", ",", "proc"}], "]"}]}], "&"}]}], 
       "]"}]}], ";"}], "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{"Facility", ",", "FacilitiesList"}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TabulatedPDF", "[", "mLLP_", "]"}], ":=", 
   RowBox[{"BlockTabulatedPDFsFromMixingsMass", "[", 
    RowBox[{
    "LLPv", ",", "SelectedFacility", ",", "mLLP", ",", "proc", ",", "nsim", 
     ",", 
     RowBox[{"\[Theta]Nlist", "[", "SelectedFacility", "]"}], ",", 
     RowBox[{"ENlist", "[", "SelectedFacility", "]"}], ",", 
     RowBox[{"\[Theta]minExtrFacility", "[", 
      RowBox[{"SelectedFacility", ",", "proc"}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mlist", "=", 
   RowBox[{"MassList", "[", 
    RowBox[{"LLPv", ",", "proc", ",", "SelectedFacility"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"filename", "=", 
   RowBox[{"filenameToExport", "[", 
    RowBox[{"LLPv", ",", "proc", ",", "SelectedFacility"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tabulatedblock", "[", 
   RowBox[{"TabulatedPDF", ",", "mlist", ",", "filename"}], "]"}], "//", 
  "AbsoluteTiming"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"{", 
   RowBox[{"LLPv", ",", "proc", ",", "mlist"}], "}"}], "//", 
  "Clear"}]}], "Input",
 CellChangeTimes->{{3.913460878309366*^9, 3.913460884333234*^9}, {
   3.9143986579729357`*^9, 3.9143986620881667`*^9}, {3.915438819667972*^9, 
   3.915438819694645*^9}, 3.9164849842904778`*^9},
 CellLabel->
  "In[692]:=",ExpressionUUID->"e9bec580-02f3-4bc6-a250-d13e10d1e39f"]
}, Closed]],

Cell[CellGroupData[{

Cell["ALP-gluon_EtaPr", "Section",
 CellChangeTimes->{{3.913453352185865*^9, 3.9134533782464876`*^9}, {
  3.913453922929523*^9, 3.913453974067208*^9}, {3.913460839305838*^9, 
  3.913460845039537*^9}},ExpressionUUID->"5d2947c4-0896-4c48-b151-\
6a45530ca881"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"LLPv", "=", "\"\<ALP-gluon\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"proc", "=", "\"\<EtaPr\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"MassList", "[", 
       RowBox[{"LLPv", ",", "proc", ",", "Facility"}], "]"}], "=", 
      RowBox[{"Select", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "0.02", ",", "0.05", ",", "0.1", ",", "0.3", ",", "0.5", ",", "0.7", 
          ",", "0.95", ",", "1.5", ",", "2.", ",", "2.5", ",", "3.", ",", 
          "3.5"}], "}"}], ",", 
        RowBox[{
         RowBox[{"0", "<", "#", "<", 
          RowBox[{"MaxMass", "[", 
           RowBox[{"LLPv", ",", "Facility", ",", "proc"}], "]"}]}], "&"}]}], 
       "]"}]}], ";"}], "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{"Facility", ",", "FacilitiesList"}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TabulatedPDF", "[", "mLLP_", "]"}], ":=", 
   RowBox[{"BlockTabulatedPDFsFromMixingsMass", "[", 
    RowBox[{
    "LLPv", ",", "SelectedFacility", ",", "mLLP", ",", "proc", ",", "nsim", 
     ",", 
     RowBox[{"\[Theta]Nlist", "[", "SelectedFacility", "]"}], ",", 
     RowBox[{"ENlist", "[", "SelectedFacility", "]"}], ",", 
     RowBox[{"\[Theta]minExtrFacility", "[", 
      RowBox[{"SelectedFacility", ",", "proc"}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mlist", "=", 
   RowBox[{"MassList", "[", 
    RowBox[{"LLPv", ",", "proc", ",", "SelectedFacility"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"filename", "=", 
   RowBox[{"filenameToExport", "[", 
    RowBox[{"LLPv", ",", "proc", ",", "SelectedFacility"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tabulatedblock", "[", 
   RowBox[{"TabulatedPDF", ",", "mlist", ",", "filename"}], "]"}], "//", 
  "AbsoluteTiming"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"{", 
   RowBox[{"LLPv", ",", "proc", ",", "mlist"}], "}"}], "//", 
  "Clear"}]}], "Input",
 CellChangeTimes->{{3.9134608921947737`*^9, 3.9134609019156566`*^9}, {
   3.915438819703649*^9, 3.9154388197297482`*^9}, 3.916484988850535*^9},
 CellLabel->
  "In[700]:=",ExpressionUUID->"48e5dcdf-caa0-45ca-be10-758776392a16"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["ALP-fermion", "Chapter",
 CellChangeTimes->{{3.91344144967334*^9, 3.913441455340948*^9}, {
   3.913441825113173*^9, 3.9134418258593936`*^9}, {3.913441936913423*^9, 
   3.9134419384733877`*^9}, {3.913442132020331*^9, 3.91344213360353*^9}, 
   3.9134482243227367`*^9, {3.91345317520315*^9, 3.9134531776043587`*^9}, {
   3.913453215805359*^9, 3.913453218272456*^9}, {3.9134609657528477`*^9, 
   3.9134609667793694`*^9}},ExpressionUUID->"d7ca20cb-cb80-436a-9add-\
b8b38c9862f6"],

Cell[CellGroupData[{

Cell["ALP-fermion_B", "Section",
 CellChangeTimes->{{3.913453352185865*^9, 3.9134533782464876`*^9}, {
   3.913453922929523*^9, 3.913453974067208*^9}, {3.9134608232129736`*^9, 
   3.913460832416258*^9}, 
   3.913460973505757*^9},ExpressionUUID->"0e808307-80ae-4563-b2e0-\
3b8e43e4279e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"LLPv", "=", "\"\<ALP-fermion\>\""}], ";"}], "\[IndentingNewLine]", 

 RowBox[{
  RowBox[{
   RowBox[{"proc", "=", "\"\<B\>\""}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "List", " ", "of", " ", "masses", " ", "for", " ", "which", " ", "the", 
    " ", "distribution", " ", "will", " ", "be", " ", "tabulated"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"MassList", "[", 
       RowBox[{"LLPv", ",", "proc", ",", "Facility"}], "]"}], "=", 
      RowBox[{"{", 
       RowBox[{
       "0.02", ",", "0.05", ",", "0.1", ",", "0.2", ",", "0.3", ",", "0.5", 
        ",", "0.7", ",", "1.2", ",", "1.5", ",", "2.", ",", "2.5", ",", "3.", 
        ",", "3.5", ",", "4.", ",", "4.8", ",", "5.13"}], "}"}]}], ";"}], 
    "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{"Facility", ",", "FacilitiesList"}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TabulatedPDF", "[", "mLLP_", "]"}], ":=", 
   RowBox[{"BlockTabulatedPDFsFromDecaysMass", "[", 
    RowBox[{
    "LLPv", ",", "SelectedFacility", ",", "mLLP", ",", "proc", ",", "nsim", 
     ",", 
     RowBox[{"\[Theta]Nlist", "[", "SelectedFacility", "]"}], ",", 
     RowBox[{"ENlist", "[", "SelectedFacility", "]"}], ",", 
     RowBox[{"\[Theta]minExtrFacility", "[", 
      RowBox[{"SelectedFacility", ",", "proc"}], "]"}], ",", 
     "\"\<False\>\""}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"filename", "=", 
   RowBox[{"filenameToExport", "[", 
    RowBox[{"LLPv", ",", "proc", ",", "SelectedFacility"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mlist", "=", 
   RowBox[{"MassList", "[", 
    RowBox[{"LLPv", ",", "proc", ",", "SelectedFacility"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tabulatedblock", "[", 
   RowBox[{"TabulatedPDF", ",", "mlist", ",", "filename"}], "]"}], "//", 
  "AbsoluteTiming"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"{", 
   RowBox[{"LLPv", ",", "proc", ",", "mlist"}], "}"}], "//", 
  "Clear"}]}], "Input",
 CellChangeTimes->{{3.913460932762819*^9, 3.913460971835065*^9}, 
   3.915083933970597*^9, {3.9154388197381*^9, 3.915438819760598*^9}, {
   3.918131416490734*^9, 3.918131426115335*^9}},
 CellLabel->
  "In[2488]:=",ExpressionUUID->"51eea68e-2d3c-47dd-a198-8d99f331707d"]
}, Closed]],

Cell[CellGroupData[{

Cell["ALP-fermion_Pi0", "Section",
 CellChangeTimes->{{3.913453352185865*^9, 3.9134533782464876`*^9}, {
   3.913453922929523*^9, 3.913453974067208*^9}, {3.9134608304473605`*^9, 
   3.913460834702962*^9}, 
   3.913460976606228*^9},ExpressionUUID->"348b1674-4f72-4a7d-9533-\
11f504ef8914"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"LLPv", "=", "\"\<ALP-fermion\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"proc", "=", "\"\<Pi0\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"Facility", "!=", "\"\<ESS\>\""}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"MassList", "[", 
            RowBox[{"LLPv", ",", "proc", ",", "Facility"}], "]"}], "=", 
           RowBox[{"Select", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
              "0.02", ",", "0.05", ",", "0.1", ",", "0.135", ",", "0.2", ",", 
               "0.3", ",", "0.4", ",", "0.5", ",", "0.65", ",", "0.7", ",", 
               "0.8", ",", "0.9", ",", "1.", ",", "1.1", ",", "1.2", ",", 
               "1.3", ",", "1.4", ",", "1.5", ",", "1.6", ",", "1.7", ",", 
               "1.8", ",", "1.9", ",", "2.", ",", "2.1", ",", "2.2", ",", 
               "2.3", ",", "2.4", ",", "2.5", ",", "2.6", ",", "2.7", ",", 
               "2.8", ",", "2.9", ",", "3.", ",", "3.1", ",", "3.2", ",", 
               "3.3", ",", "3.4", ",", "3.5"}], "}"}], ",", 
             RowBox[{
              RowBox[{"0", "<", "#", "<", 
               RowBox[{"MaxMass", "[", 
                RowBox[{"LLPv", ",", "Facility", ",", "proc"}], "]"}]}], 
              "&"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"MassList", "[", 
            RowBox[{"LLPv", ",", "proc", ",", "Facility"}], "]"}], "=", 
           RowBox[{"{", 
            RowBox[{
            "0.02", ",", "0.03", ",", "0.04", ",", "0.05", ",", "0.06", ",", 
             "0.065", ",", "0.07", ",", "0.075", ",", "0.08", ",", "0.085", 
             ",", "0.09", ",", "0.095", ",", "0.1", ",", "0.105", ",", "0.11",
              ",", "0.115", ",", "0.12", ",", "0.125", ",", "0.13", ",", 
             "0.135"}], "}"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], 
       "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"Facility", ",", "FacilitiesList"}], "}"}]}], "]"}], ";"}], 
    "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{"Facility", ",", "FacilitiesList"}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TabulatedPDF", "[", "mLLP_", "]"}], ":=", 
   RowBox[{"BlockTabulatedPDFsFromMixingsMass", "[", 
    RowBox[{
    "LLPv", ",", "SelectedFacility", ",", "mLLP", ",", "proc", ",", "nsim", 
     ",", 
     RowBox[{"\[Theta]Nlist", "[", "SelectedFacility", "]"}], ",", 
     RowBox[{"ENlist", "[", "SelectedFacility", "]"}], ",", 
     RowBox[{"\[Theta]minExtrFacility", "[", 
      RowBox[{"SelectedFacility", ",", "proc"}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mlist", "=", 
   RowBox[{"MassList", "[", 
    RowBox[{"LLPv", ",", "proc", ",", "SelectedFacility"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"filename", "=", 
   RowBox[{"filenameToExport", "[", 
    RowBox[{"LLPv", ",", "proc", ",", "SelectedFacility"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tabulatedblock", "[", 
   RowBox[{"TabulatedPDF", ",", "mlist", ",", "filename"}], "]"}], "//", 
  "AbsoluteTiming"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"{", 
   RowBox[{"LLPv", ",", "proc", ",", "mlist"}], "}"}], "//", 
  "Clear"}]}], "Input",
 CellChangeTimes->{{3.91346054127559*^9, 3.913460547406306*^9}, {
   3.913460855788334*^9, 3.9134608674017687`*^9}, 3.913460977864487*^9, 
   3.914398646927179*^9, {3.915438819768584*^9, 3.915438819793632*^9}, 
   3.916286147586484*^9, 3.9163887484474196`*^9, 3.9164849959733067`*^9, {
   3.916761809171353*^9, 3.916761810674497*^9}},
 CellLabel->
  "In[2167]:=",ExpressionUUID->"c0c26a68-b995-4c98-a6e8-e9fa0b27913a"]
}, Closed]],

Cell[CellGroupData[{

Cell["ALP-fermion_Eta", "Section",
 CellChangeTimes->{{3.913453352185865*^9, 3.9134533782464876`*^9}, {
   3.913453922929523*^9, 3.913453974067208*^9}, {3.913460838422539*^9, 
   3.913460842251025*^9}, 
   3.913460981989302*^9},ExpressionUUID->"477f463b-ec67-43b1-8c03-\
e849ec244ba0"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"LLPv", "=", "\"\<ALP-fermion\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"proc", "=", "\"\<Eta\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"MassList", "[", 
       RowBox[{"LLPv", ",", "proc", ",", "Facility"}], "]"}], "=", 
      RowBox[{"Select", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "0.02", ",", "0.05", ",", "0.1", ",", "0.135", ",", "0.2", ",", 
          "0.3", ",", "0.4", ",", "0.547", ",", "0.65", ",", "0.7", ",", 
          "0.8", ",", "0.9", ",", "1.", ",", "1.1", ",", "1.2", ",", "1.3", 
          ",", "1.4", ",", "1.5", ",", "1.6", ",", "1.7", ",", "1.8", ",", 
          "1.9", ",", "2.", ",", "2.1", ",", "2.2", ",", "2.3", ",", "2.4", 
          ",", "2.5", ",", "2.6", ",", "2.7", ",", "2.8", ",", "2.9", ",", 
          "3.", ",", "3.1", ",", "3.2", ",", "3.3", ",", "3.4", ",", "3.5"}], 
         "}"}], ",", 
        RowBox[{
         RowBox[{"0", "<", "#", "<", 
          RowBox[{"MaxMass", "[", 
           RowBox[{"LLPv", ",", "Facility", ",", "proc"}], "]"}]}], "&"}]}], 
       "]"}]}], ";"}], "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{"Facility", ",", "FacilitiesList"}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TabulatedPDF", "[", "mLLP_", "]"}], ":=", 
   RowBox[{"BlockTabulatedPDFsFromMixingsMass", "[", 
    RowBox[{
    "LLPv", ",", "SelectedFacility", ",", "mLLP", ",", "proc", ",", "nsim", 
     ",", 
     RowBox[{"\[Theta]Nlist", "[", "SelectedFacility", "]"}], ",", 
     RowBox[{"ENlist", "[", "SelectedFacility", "]"}], ",", 
     RowBox[{"\[Theta]minExtrFacility", "[", 
      RowBox[{"SelectedFacility", ",", "proc"}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mlist", "=", 
   RowBox[{"MassList", "[", 
    RowBox[{"LLPv", ",", "proc", ",", "SelectedFacility"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"filename", "=", 
   RowBox[{"filenameToExport", "[", 
    RowBox[{"LLPv", ",", "proc", ",", "SelectedFacility"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tabulatedblock", "[", 
   RowBox[{"TabulatedPDF", ",", "mlist", ",", "filename"}], "]"}], "//", 
  "AbsoluteTiming"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"{", 
   RowBox[{"LLPv", ",", "proc", ",", "mlist"}], "}"}], "//", 
  "Clear"}]}], "Input",
 CellChangeTimes->{{3.913460878309366*^9, 3.913460884333234*^9}, 
   3.913460980070481*^9, 3.914398683972721*^9, {3.915438819805675*^9, 
   3.915438819829223*^9}, 3.916485000435871*^9},
 CellLabel->
  "In[2175]:=",ExpressionUUID->"a580770c-46cb-46a0-bba9-7b7f9a341ecb"]
}, Closed]],

Cell[CellGroupData[{

Cell["ALP-fermion_EtaPr", "Section",
 CellChangeTimes->{{3.913453352185865*^9, 3.9134533782464876`*^9}, {
   3.913453922929523*^9, 3.913453974067208*^9}, {3.913460839305838*^9, 
   3.913460845039537*^9}, 
   3.913460984032293*^9},ExpressionUUID->"4a52c497-be7d-43f9-a2b4-\
044115160167"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"LLPv", "=", "\"\<ALP-fermion\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"proc", "=", "\"\<EtaPr\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"MassList", "[", 
       RowBox[{"LLPv", ",", "proc", ",", "Facility"}], "]"}], "=", 
      RowBox[{"Select", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "0.02", ",", "0.05", ",", "0.1", ",", "0.3", ",", "0.5", ",", "0.7", 
          ",", "0.95", ",", "1.5", ",", "2.", ",", "2.5", ",", "3.", ",", 
          "3.5"}], "}"}], ",", 
        RowBox[{
         RowBox[{"0", "<", "#", "<", 
          RowBox[{"MaxMass", "[", 
           RowBox[{"LLPv", ",", "Facility", ",", "proc"}], "]"}]}], "&"}]}], 
       "]"}]}], ";"}], "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{"Facility", ",", "FacilitiesList"}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TabulatedPDF", "[", "mLLP_", "]"}], ":=", 
   RowBox[{"BlockTabulatedPDFsFromMixingsMass", "[", 
    RowBox[{
    "LLPv", ",", "SelectedFacility", ",", "mLLP", ",", "proc", ",", "nsim", 
     ",", 
     RowBox[{"\[Theta]Nlist", "[", "SelectedFacility", "]"}], ",", 
     RowBox[{"ENlist", "[", "SelectedFacility", "]"}], ",", 
     RowBox[{"\[Theta]minExtrFacility", "[", 
      RowBox[{"SelectedFacility", ",", "proc"}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mlist", "=", 
   RowBox[{"MassList", "[", 
    RowBox[{"LLPv", ",", "proc", ",", "SelectedFacility"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"filename", "=", 
   RowBox[{"filenameToExport", "[", 
    RowBox[{"LLPv", ",", "proc", ",", "SelectedFacility"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tabulatedblock", "[", 
   RowBox[{"TabulatedPDF", ",", "mlist", ",", "filename"}], "]"}], "//", 
  "AbsoluteTiming"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"{", 
   RowBox[{"LLPv", ",", "proc", ",", "mlist"}], "}"}], "//", 
  "Clear"}]}], "Input",
 CellChangeTimes->{{3.9134608921947737`*^9, 3.9134609019156566`*^9}, 
   3.913460985168969*^9, {3.915438819837214*^9, 3.915438819859702*^9}, 
   3.916485004403736*^9},
 CellLabel->
  "In[2183]:=",ExpressionUUID->"1b8a3050-ca24-440d-9f67-f587aea93886"]
}, Closed]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Deleting generated cells", "Title",
 CellChangeTimes->{{3.902555946514994*^9, 
  3.9025559494966083`*^9}},ExpressionUUID->"357bb516-74b9-4f59-af92-\
4e8774ff06b1"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"dropdownDialog", "[", 
   RowBox[{"list_", ",", "phrase_"}], "]"}], ":=", 
  RowBox[{"DialogInput", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"choice", "=", "\"\<\>\""}], "}"}], ",", 
    RowBox[{"Column", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"TextCell", "[", "phrase", "]"}], ",", 
       RowBox[{"PopupMenu", "[", 
        RowBox[{
         RowBox[{"Dynamic", "[", "choice", "]"}], ",", "list"}], "]"}], ",", 
       RowBox[{"Button", "[", 
        RowBox[{"\"\<OK\>\"", ",", 
         RowBox[{"DialogReturn", "[", "choice", "]"}]}], "]"}]}], "}"}], 
     "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"deletecellsopt", "=", 
  RowBox[{"dropdownDialog", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"\"\<Yes\>\"", ",", "\"\<No\>\""}], "}"}], ",", 
    RowBox[{"Row", "[", 
     RowBox[{
     "{", "\"\<Would you like to remove all the generated output cells?\>\"", 
      "}"}], "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"deletecellsopt", "==", "\"\<Yes\>\""}], ",", 
   RowBox[{
   "FrontEndTokenExecute", "[", "\"\<DeleteGeneratedCells\>\"", "]"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"FrontEndTokenExecute", "[", "\"\<SelectAll\>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"FrontEndTokenExecute", "[", "\"\<SelectionCloseAllGroups\>\"", 
  "]"}]}], "Input",
 CellChangeTimes->{{3.9025559062888594`*^9, 3.9025559062888594`*^9}, {
  3.902555964086707*^9, 3.902555989355214*^9}, {3.9027633074676013`*^9, 
  3.902763307657353*^9}, {3.9039692788393974`*^9, 3.903969296101183*^9}, {
  3.914671028606657*^9, 3.914671029706971*^9}},
 CellLabel->
  "In[791]:=",ExpressionUUID->"a096c229-043c-45ad-9a4b-87df478e633b"]
}, Closed]]
},
WindowSize->{Full, Full},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
TaggingRules->{
 "WelcomeScreenSettings" -> {"FEStarting" -> False}, "TryRealOnly" -> False},
ShowCellTags->True,
Magnification:>0.9 Inherited,
FrontEndVersion->"14.0 para Mac OS X x86 (64-bit) (December 12, 2023)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"4c255f37-b6e3-4c03-96ec-3dc21a10e58e"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{
 "Evaluation"->{
  Cell[2747, 77, 428, 6, 78, "Title",ExpressionUUID->"9f74c6f1-3857-4415-bd05-374f4b0a6d43",
   CellTags->"Evaluation"],
  Cell[3200, 87, 275, 4, 76, "Chapter",ExpressionUUID->"4350f6b8-70ba-426b-b952-c2d172f0b593",
   CellTags->"Evaluation"],
  Cell[3500, 95, 1133, 30, 169, "Input",ExpressionUUID->"164a4a0f-e0b1-4b2d-91f1-566d65334670",
   CellTags->"Evaluation"],
  Cell[4636, 127, 674, 16, 39, "Print",ExpressionUUID->"6ec5e9b5-62f4-414a-93e3-efa74abdc54f",
   CellTags->"Evaluation"],
  Cell[5313, 145, 237, 5, 42, "Output",ExpressionUUID->"a78a7710-8828-457c-bc1c-74b8104edab4",
   CellTags->"Evaluation"],
  Cell[5599, 156, 182, 3, 76, "Chapter",ExpressionUUID->"f8243e93-a44c-4fe5-894e-0743d4884863",
   CellTags->"Evaluation"],
  Cell[5806, 163, 186, 3, 73, "Section",ExpressionUUID->"80187575-21b6-468f-8e4a-db311a554398",
   CellTags->"Evaluation"],
  Cell[5995, 168, 893, 27, 83, "Input",ExpressionUUID->"a1ffc0dc-1570-4f50-ba14-bbefddbce453",
   CellTags->"Evaluation"],
  Cell[6925, 200, 260, 4, 73, "Section",ExpressionUUID->"802f0307-65bf-44e4-9bdd-603d6615efc3",
   CellTags->"Evaluation"],
  Cell[7188, 206, 4152, 115, 424, "Input",ExpressionUUID->"ce0d3f6c-f69d-4974-bd82-3355d8c6b198",
   CellTags->"Evaluation"],
  Cell[11377, 326, 201, 3, 73, "Section",ExpressionUUID->"16dbf08b-1200-4ac4-ad9a-ed04d15b41ef",
   CellTags->"Evaluation"],
  Cell[11603, 333, 234, 4, 61, "Subsection",ExpressionUUID->"be5850ea-72d1-4eb6-b945-f4862fadb6d4",
   CellTags->"Evaluation"],
  Cell[11840, 339, 2024, 56, 174, "Input",ExpressionUUID->"57b13a59-bbda-47bd-bcb1-94321ca663e9",
   CellTags->"Evaluation"],
  Cell[13901, 400, 174, 3, 61, "Subsection",ExpressionUUID->"22b5bbc3-3951-46d3-ad9a-83114d344b4c",
   CellTags->"Evaluation"],
  Cell[14078, 405, 1715, 50, 306, "Input",ExpressionUUID->"d9f77161-a435-4e0d-a1e7-77d7f183b93b",
   CellTags->"Evaluation"],
  Cell[15830, 460, 332, 6, 61, "Subsection",ExpressionUUID->"095611fb-9a2e-4c4f-91d9-5d2e63f6be49",
   CellTags->"Evaluation"],
  Cell[16165, 468, 1073, 30, 174, "Input",ExpressionUUID->"79c3c6d2-bec6-41b6-9818-7d5c26b7676d",
   CellTags->"Evaluation"],
  Cell[18419, 542, 314, 5, 73, "Section",ExpressionUUID->"e56a72b1-83e0-4714-b342-2b505f68174b",
   CellTags->"Evaluation"],
  Cell[18758, 551, 13248, 324, 833, "Input",ExpressionUUID->"2e3fc200-3d1f-489f-b96a-9e47e0198bbe",
   CellTags->"Evaluation"],
  Cell[32009, 877, 672, 16, 39, "Print",ExpressionUUID->"41149713-9fda-4b06-8969-5909ba4e2c02",
   CellTags->"Evaluation"],
  Cell[32684, 895, 237, 5, 42, "Output",ExpressionUUID->"dd5ee897-2890-4c89-80bf-f1e2fea317f3",
   CellTags->"Evaluation"],
  Cell[32924, 902, 875, 16, 42, "Output",ExpressionUUID->"da38fc3e-cd51-461e-b381-0a79a489739a",
   CellTags->"Evaluation"],
  Cell[33848, 924, 363, 5, 73, "Section",ExpressionUUID->"ed0ed593-049b-46cb-876d-fd2059f1978e",
   CellTags->"Evaluation"],
  Cell[34214, 931, 27456, 760, 1303, "Input",ExpressionUUID->"72c7a1cb-121c-4aae-ac1f-468c38ac6100",
   CellTags->"Evaluation"],
  Cell[61731, 1698, 310, 5, 101, "Title",ExpressionUUID->"76b860cd-984b-41b4-99cf-16aba9d2025c",
   CellTags->"Evaluation"],
  Cell[62066, 1707, 368, 5, 76, "Chapter",ExpressionUUID->"7c2d3d9c-4846-4861-bd3f-24c69d50f1dc",
   CellTags->"Evaluation"],
  Cell[62459, 1716, 6458, 166, 411, "Input",ExpressionUUID->"322a1ea8-52b2-4163-8d33-47a158740375",
   CellTags->"Evaluation"],
  Cell[68920, 1884, 286, 7, 42, "Output",ExpressionUUID->"ce7f742b-21f1-45ed-8b9a-53ce5c507312",
   CellTags->"Evaluation"],
  Cell[69255, 1897, 408, 8, 76, "Chapter",ExpressionUUID->"a19a94ae-a3db-4a44-b250-a8a4225019c3",
   CellTags->"Evaluation"],
  Cell[69688, 1909, 217, 4, 73, "Section",ExpressionUUID->"20b535ef-a1ee-45b0-9a6f-d52026ce2181",
   CellTags->"Evaluation"],
  Cell[69930, 1917, 439, 9, 61, "Subsection",ExpressionUUID->"b94b25f8-4bb1-4586-a3a5-2c943d15b6ef",
   CellTags->"Evaluation"],
  Cell[70372, 1928, 7528, 184, 407, "Input",ExpressionUUID->"d59e1373-0f6f-4224-85da-ecd147c98905",
   CellTags->"Evaluation"],
  Cell[77937, 2117, 653, 18, 62, "Subsection",ExpressionUUID->"b772a033-a7b6-45f9-bf82-037ca4e21689",
   CellTags->"Evaluation"],
  Cell[78615, 2139, 12248, 289, 988, "Input",ExpressionUUID->"350c467b-7755-44e9-a68b-9e78f62450ae",
   CellTags->"Evaluation"],
  Cell[90866, 2430, 26177, 495, 70, "Output",ExpressionUUID->"db8dcd1a-5ab4-494e-8cdd-f9e86a4fb3c4",
   CellTags->"Evaluation"],
  Cell[117046, 2927, 18101, 348, 69, "Output",ExpressionUUID->"8b409073-dd31-43a4-a023-99e479e9692d",
   CellTags->"Evaluation"],
  Cell[135196, 3281, 477, 12, 62, "Subsection",ExpressionUUID->"f83049fd-8fed-4560-865f-95bb871146be",
   CellTags->"Evaluation"],
  Cell[135676, 3295, 24340, 574, 1637, "Input",ExpressionUUID->"1526fbf7-ef3a-4a98-bdc1-4389e2074498",
   CellTags->"Evaluation"],
  Cell[160065, 3875, 183, 3, 73, "Section",ExpressionUUID->"1ff15133-44cb-4c98-a0fa-56621f6338fa",
   CellTags->"Evaluation"],
  Cell[160273, 3882, 16879, 393, 1403, "Input",ExpressionUUID->"2ec450ed-9c77-4c44-8a53-5405c2d3f3a5",
   CellTags->"Evaluation"],
  Cell[177155, 4277, 16735, 323, 69, "Output",ExpressionUUID->"cd34b1ea-7dbf-41a8-8dc5-4f01540a10aa",
   CellTags->"Evaluation"],
  Cell[193893, 4602, 15704, 301, 69, "Output",ExpressionUUID->"903c21f6-cbdd-4de8-88e3-1b97db727d32",
   CellTags->"Evaluation"],
  Cell[209658, 4910, 305, 5, 76, "Chapter",ExpressionUUID->"e54bbe8c-2f3c-464c-8714-8e4597d33d99",
   CellTags->"Evaluation"],
  Cell[209988, 4919, 190, 3, 73, "Section",ExpressionUUID->"6a284235-3c44-4a3d-bb13-b42fe2ecb30a",
   CellTags->"Evaluation"],
  Cell[210203, 4926, 13392, 322, 891, "Input",ExpressionUUID->"b82b39d0-f01e-440a-b4d1-dc5e7ce1ccbf",
   CellTags->"Evaluation"],
  Cell[223598, 5250, 282, 7, 42, "Output",ExpressionUUID->"2bba2473-dac8-4dbb-ba25-36668b0f82d1",
   CellTags->"Evaluation"],
  Cell[223929, 5263, 176, 3, 73, "Section",ExpressionUUID->"390f4661-3512-4be2-86d0-5fc0e3625611",
   CellTags->"Evaluation"],
  Cell[224108, 5268, 13348, 318, 462, "Input",ExpressionUUID->"f067bd9f-1c0a-4be7-aa46-c364af47de64",
   CellTags->"Evaluation"],
  Cell[237517, 5593, 264, 4, 101, "Title",ExpressionUUID->"b7431e4b-8fd3-4b39-abd9-5de880c5126c",
   CellTags->"Evaluation"],
  Cell[237806, 5601, 192, 3, 76, "Chapter",ExpressionUUID->"cb022232-9785-4115-9e3d-4db1fdd7c520",
   CellTags->"Evaluation"],
  Cell[238023, 5608, 463, 12, 74, "Section",ExpressionUUID->"91a14f45-0875-4e85-a61d-49cc362d42eb",
   CellTags->"Evaluation"],
  Cell[238511, 5624, 14950, 423, 643, "Input",ExpressionUUID->"53a6dfba-6611-4b8e-874f-a8a4e369b2f2",
   CellTags->"Evaluation"],
  Cell[253464, 6049, 473, 11, 39, "Message",ExpressionUUID->"1779dff2-a3e0-4a0f-883c-e65ea594844a",
   CellTags->"Evaluation"],
  Cell[253940, 6062, 4878, 137, 119, "Output",ExpressionUUID->"5943677d-5a12-4a81-ada0-a022e968638e",
   CellTags->"Evaluation"],
  Cell[258821, 6201, 1692, 49, 67, "Output",ExpressionUUID->"5bf9de3f-d91a-489f-9996-b49440eaff39",
   CellTags->"Evaluation"],
  Cell[260516, 6252, 505, 15, 62, "Output",ExpressionUUID->"5ecf5ef1-6ecf-435f-9899-f4245e028911",
   CellTags->"Evaluation"],
  Cell[261024, 6269, 473, 11, 39, "Message",ExpressionUUID->"15883a0a-e5cb-4b2d-9901-83672ac077e2",
   CellTags->"Evaluation"],
  Cell[261500, 6282, 4878, 137, 119, "Output",ExpressionUUID->"baecb409-73d0-42da-b5e7-94dd58f43f72",
   CellTags->"Evaluation"],
  Cell[266381, 6421, 535, 15, 62, "Output",ExpressionUUID->"18491e02-6e55-40b9-9e1d-6b085e2ab925",
   CellTags->"Evaluation"],
  Cell[266919, 6438, 391, 10, 44, "Output",ExpressionUUID->"bf7b2c58-b780-4477-892d-ac366330dcdc",
   CellTags->"Evaluation"],
  Cell[267313, 6450, 369, 10, 44, "Output",ExpressionUUID->"284a65cb-70dc-4387-85ef-06089727d5a8",
   CellTags->"Evaluation"],
  Cell[267719, 6465, 212, 3, 61, "Subsection",ExpressionUUID->"da999496-62ed-45f4-a17e-11b68f45cddb",
   CellTags->"Evaluation"],
  Cell[267934, 6470, 2048, 60, 219, "Input",ExpressionUUID->"6193526c-612d-4041-a81d-d0aed1dec4a4",
   CellTags->"Evaluation"],
  Cell[270031, 6536, 350, 7, 73, "Section",ExpressionUUID->"fb2d743c-1d47-4f3e-9d37-480a38ea1b24",
   CellTags->"Evaluation"],
  Cell[270675, 6553, 18243, 456, 1296, "Input",ExpressionUUID->"06209544-3773-489e-b401-f3c8152c8319",
   CellTags->"Evaluation"],
  Cell[288921, 7011, 562, 13, 39, "Message",ExpressionUUID->"6134ddab-b135-47c2-85ca-9b5e14fe36fc",
   CellTags->"Evaluation"],
  Cell[289486, 7026, 562, 13, 39, "Message",ExpressionUUID->"ee525567-b012-48d5-81b5-f9e56b217b93",
   CellTags->"Evaluation"],
  Cell[290051, 7041, 560, 13, 39, "Message",ExpressionUUID->"76c2ce01-0118-498b-b884-1ade7054a0a3",
   CellTags->"Evaluation"],
  Cell[290614, 7056, 575, 13, 39, "Message",ExpressionUUID->"8825f3ef-0780-43c6-a7d2-eec386a7a2f6",
   CellTags->"Evaluation"],
  Cell[296709, 7220, 212, 3, 73, "Section",ExpressionUUID->"ecf5bab7-5ea6-437a-9631-ce3f62c4edfb",
   CellTags->"Evaluation"],
  Cell[296946, 7227, 196, 3, 61, "Subsection",ExpressionUUID->"aa0f2d30-2951-433c-8422-3eae16d65609",
   CellTags->"Evaluation"],
  Cell[297167, 7234, 6111, 181, 554, "Input",ExpressionUUID->"c49b2c57-3f81-4950-8334-7fcac9bc22cf",
   CellTags->"Evaluation"],
  Cell[303281, 7417, 833, 26, 78, "Output",ExpressionUUID->"1f41b548-adad-4f40-b82a-2d69d7ca3b6a",
   CellTags->"Evaluation"],
  Cell[304163, 7449, 213, 3, 61, "Subsection",ExpressionUUID->"a245a9ad-be57-4780-b644-b1f1504e0331",
   CellTags->"Evaluation"],
  Cell[304379, 7454, 4742, 135, 271, "Input",ExpressionUUID->"f5a0a55d-2b6c-42d3-81db-68110c8f100d",
   CellTags->"Evaluation"],
  Cell[309182, 7596, 319, 5, 76, "Chapter",ExpressionUUID->"a8f49eab-e7b1-4705-9448-f2a995602fd0",
   CellTags->"Evaluation"],
  Cell[309526, 7605, 188, 3, 73, "Section",ExpressionUUID->"c08c78a0-7415-4dd4-a1ce-05c6eb37994e",
   CellTags->"Evaluation"],
  Cell[309717, 7610, 12361, 313, 740, "Input",ExpressionUUID->"0c0fb3ea-7b74-4498-9c9b-983eee5abfd7",
   CellTags->"Evaluation"],
  Cell[322115, 7928, 343, 5, 73, "Section",ExpressionUUID->"ffe71289-67cd-43b9-8115-56413162d724",
   CellTags->"Evaluation"],
  Cell[322483, 7937, 230, 4, 61, "Subsection",ExpressionUUID->"7e519fd0-4951-4f22-871f-ef83ce20d9e7",
   CellTags->"Evaluation"],
  Cell[322716, 7943, 7924, 203, 443, "Input",ExpressionUUID->"5a037ee8-f108-4a7f-b5e1-64caca67a36d",
   CellTags->"Evaluation"],
  Cell[330677, 8151, 193, 3, 61, "Subsection",ExpressionUUID->"9a37a07e-462a-4aaf-b23b-e1694ff76248",
   CellTags->"Evaluation"],
  Cell[330895, 8158, 9281, 233, 571, "Input",ExpressionUUID->"1505a48e-36d3-4bc5-9467-a888c370264b",
   CellTags->"Evaluation"],
  Cell[340179, 8393, 661, 17, 59, "Output",ExpressionUUID->"464c05b8-6c31-4e7c-bcd7-e62fe007952c",
   CellTags->"Evaluation"],
  Cell[340843, 8412, 645, 17, 59, "Output",ExpressionUUID->"550e0412-0a9b-49d7-8914-30bbf0cfd2dc",
   CellTags->"Evaluation"],
  Cell[341549, 8436, 636, 13, 74, "Section",ExpressionUUID->"87cf203d-07c5-44e4-84d2-b9c06c63b425",
   CellTags->"Evaluation"],
  Cell[342210, 8453, 184, 3, 61, "Subsection",ExpressionUUID->"26146eba-46ad-47c9-a195-57d58effde05",
   CellTags->"Evaluation"],
  Cell[342397, 8458, 3492, 84, 201, "Input",ExpressionUUID->"42f2e7ee-39f5-4f67-a823-602471499d45",
   CellTags->"Evaluation"],
  Cell[345926, 8547, 423, 10, 62, "Subsection",ExpressionUUID->"211335e5-7f8a-43a9-8ce5-ece646b965e2",
   CellTags->"Evaluation"],
  Cell[346352, 8559, 17879, 476, 782, "Input",ExpressionUUID->"db561fe9-9b2a-4977-a5a6-1f008030ce10",
   CellTags->"Evaluation"],
  Cell[364268, 9040, 448, 11, 62, "Subsection",ExpressionUUID->"36c14be9-b412-45f7-9bf3-03acd0e0de40",
   CellTags->"Evaluation"],
  Cell[364719, 9053, 10439, 280, 477, "Input",ExpressionUUID->"822f4d77-af6c-4066-91bd-8cc13c8b6d92",
   CellTags->"Evaluation"],
  Cell[375195, 9338, 558, 12, 62, "Subsection",ExpressionUUID->"3bf4776a-9a9b-4383-aa96-3910e1a621a2",
   CellTags->"Evaluation"],
  Cell[375756, 9352, 4266, 112, 230, "Input",ExpressionUUID->"9bd49d09-9738-4659-858a-a54557b2b0ee",
   CellTags->"Evaluation"],
  Cell[380059, 9469, 868, 21, 64, "Subsection",ExpressionUUID->"54283de7-deea-4f58-ad14-5dafbd438d01",
   CellTags->"Evaluation"],
  Cell[380930, 9492, 8766, 238, 457, "Input",ExpressionUUID->"13fba45d-94f9-4916-8795-2b6683129869",
   CellTags->"Evaluation"],
  Cell[389745, 9736, 268, 6, 73, "Section",ExpressionUUID->"667aee5b-504d-4798-9ccf-7c7f5c539e14",
   CellTags->"Evaluation"],
  Cell[390038, 9746, 648, 17, 56, "Subsubsection",ExpressionUUID->"ad9e56ec-edc5-45b2-b48a-83ea0326342a",
   CellTags->"Evaluation"],
  Cell[390689, 9765, 5363, 134, 412, "Input",ExpressionUUID->"11ecbafc-a5e8-47ed-a97f-18a09b37df83",
   CellTags->"Evaluation"],
  Cell[396089, 9904, 188, 3, 61, "Subsection",ExpressionUUID->"291cf4c3-322d-4335-9bdc-e9d66b0d9acf",
   CellTags->"Evaluation"],
  Cell[396280, 9909, 2402, 62, 206, "Input",ExpressionUUID->"573c73b7-657e-46a8-a6d7-31c4c6f46f48",
   CellTags->"Evaluation"],
  Cell[398743, 9978, 230, 4, 76, "Chapter",ExpressionUUID->"e6032420-000f-4c70-862b-c0e99d95a710",
   CellTags->"Evaluation"],
  Cell[398998, 9986, 188, 3, 73, "Section",ExpressionUUID->"d7772fe1-303e-43a1-a6e2-f52f668cffdb",
   CellTags->"Evaluation"],
  Cell[399189, 9991, 3611, 92, 251, "Input",ExpressionUUID->"4e0e9899-fded-4d72-8877-13bc67a0fdf7",
   CellTags->"Evaluation"],
  Cell[402849, 10089, 230, 4, 76, "Chapter",ExpressionUUID->"0f30225e-de51-473d-8156-16ddf2e7a477",
   CellTags->"Evaluation"],
  Cell[403104, 10097, 188, 3, 73, "Section",ExpressionUUID->"fbe6c10f-8446-4672-85b1-ebf7ba71b704",
   CellTags->"Evaluation"],
  Cell[403295, 10102, 6263, 157, 390, "Input",ExpressionUUID->"ab7d6d0f-dab9-431e-8716-0468ee58c642",
   CellTags->"Evaluation"],
  Cell[409595, 10264, 202, 3, 73, "Section",ExpressionUUID->"5d63056d-9fc8-4495-ac24-5e9fd33dd9c5",
   CellTags->"Evaluation"],
  Cell[409822, 10271, 366, 10, 63, "Subsection",ExpressionUUID->"4d9b925b-3422-4531-b2f2-fb793c1b1962",
   CellTags->"Evaluation"],
  Cell[410191, 10283, 8833, 232, 386, "Input",ExpressionUUID->"1828b044-1bf8-4f21-b901-afd828bd05c5",
   CellTags->"Evaluation"],
  Cell[419073, 10521, 192, 3, 73, "Section",ExpressionUUID->"8caf92d5-70a9-4c4b-b9ed-16ae9de4c52f",
   CellTags->"Evaluation"],
  Cell[419290, 10528, 211, 4, 61, "Subsection",ExpressionUUID->"e08d29a5-6da2-449e-ad91-5f45d20ef30c",
   CellTags->"Evaluation"],
  Cell[419526, 10536, 12416, 356, 743, "Input",ExpressionUUID->"79ee2751-71ac-43ae-9273-0e4f4fdee8cc",
   CellTags->"Evaluation"],
  Cell[431945, 10894, 491, 10, 37, "Print",ExpressionUUID->"c4aff447-3018-4bad-8fdb-7ebe9c8d2a89",
   CellTags->"Evaluation"],
  Cell[432439, 10906, 343, 9, 59, "Output",ExpressionUUID->"aa39e359-5427-4471-a73f-f8b58f2b8306",
   CellTags->"Evaluation"],
  Cell[432785, 10917, 375, 7, 35, "Print",ExpressionUUID->"ef6af8a9-7a2f-45ee-99fe-f8c010c155af",
   CellTags->"Evaluation"],
  Cell[433163, 10926, 254, 6, 42, "Output",ExpressionUUID->"0da25b29-89da-4dfc-a7a5-07cccea1698c",
   CellTags->"Evaluation"],
  Cell[433420, 10934, 816, 15, 36, "Print",ExpressionUUID->"34ff7d6d-ca66-48cd-b4ca-d914dc770228",
   CellTags->"Evaluation"],
  Cell[434239, 10951, 1350, 40, 86, "Output",ExpressionUUID->"220f840f-ba92-4b99-8a57-bd964b4d08e1",
   CellTags->"Evaluation"],
  Cell[435592, 10993, 1444, 43, 86, "Output",ExpressionUUID->"8f9148bb-74de-4d29-b918-2a055fefef27",
   CellTags->"Evaluation"],
  Cell[437085, 11042, 192, 3, 61, "Subsection",ExpressionUUID->"e8574462-a41d-4945-b7dd-fa72d898c863",
   CellTags->"Evaluation"],
  Cell[437280, 11047, 13450, 351, 525, "Input",ExpressionUUID->"aa38e0a1-a817-4b7b-a76e-98552d3dae1f",
   CellTags->"Evaluation"],
  Cell[450779, 11404, 299, 6, 73, "Section",ExpressionUUID->"f5fbce2e-bd61-4cb2-8cc6-8bef2d5b3fae",
   CellTags->"Evaluation"],
  Cell[451103, 11414, 248, 5, 61, "Subsection",ExpressionUUID->"d4edb50b-69e7-4aef-bf71-487cbcc8e1c5",
   CellTags->"Evaluation"],
  Cell[451354, 11421, 4131, 110, 292, "Input",ExpressionUUID->"5f3ed18a-4865-483b-9084-1c493c97c698",
   CellTags->"Evaluation"],
  Cell[455522, 11536, 259, 4, 61, "Subsection",ExpressionUUID->"129ed7d0-3b9a-4c3b-b008-b68f20fdb211",
   CellTags->"Evaluation"],
  Cell[455806, 11544, 12747, 343, 707, "Input",ExpressionUUID->"eb94db9a-b0be-4ec4-a74c-00f25a0acfd3",
   CellTags->"Evaluation"],
  Cell[468556, 11889, 473, 11, 39, "Message",ExpressionUUID->"4f8baeed-6e1b-4564-9f60-5abe007a30b3",
   CellTags->"Evaluation"],
  Cell[469032, 11902, 1587, 51, 87, "Output",ExpressionUUID->"a4d1980b-a2f3-4f4c-b4b5-efcb30b9222e",
   CellTags->"Evaluation"],
  Cell[470656, 11958, 220, 3, 53, "Subsubsection",ExpressionUUID->"444afafe-c64f-41b7-b6cf-aa908a1e192f",
   CellTags->"Evaluation"],
  Cell[470901, 11965, 29795, 691, 1314, "Input",ExpressionUUID->"327c34bc-65bf-496b-b6ce-ace808862596",
   CellTags->"Evaluation"],
  Cell[500699, 12658, 307, 8, 47, "Output",ExpressionUUID->"e4ef8695-e24c-40e8-a7b3-a11e5a01ecf8",
   CellTags->"Evaluation"],
  Cell[504792, 12780, 579, 16, 56, "Subsubsection",ExpressionUUID->"bf14ac37-c134-491d-affc-c438fea539d6",
   CellTags->"Evaluation"],
  Cell[505396, 12800, 170, 3, 43, "Item",ExpressionUUID->"f68843f3-917e-475e-942c-cdc3a338c4d9",
   CellTags->"Evaluation"],
  Cell[505569, 12805, 3803, 92, 154, "Input",ExpressionUUID->"d10de36e-1aea-4fd7-b054-4e006d790cb3",
   CellTags->"Evaluation"],
  Cell[509409, 12902, 173, 3, 43, "Item",ExpressionUUID->"e0222495-2a30-444e-95b1-1ffda468252f",
   CellTags->"Evaluation"],
  Cell[509585, 12907, 3609, 89, 168, "Input",ExpressionUUID->"1aa3601e-3cf5-4a65-ab2b-e8461899e49e",
   CellTags->"Evaluation"],
  Cell[513255, 13003, 260, 4, 61, "Subsection",ExpressionUUID->"82f5b9ee-eff5-4f8a-90eb-19c98e947bd1",
   CellTags->"Evaluation"],
  Cell[513540, 13011, 9038, 232, 445, "Input",ExpressionUUID->"4ddf9aea-d127-4514-9c49-953ffbcc3e21",
   CellTags->"Evaluation"],
  Cell[522581, 13245, 471, 11, 39, "Message",ExpressionUUID->"6e10fa7e-339d-4d3b-b413-2ed070682892",
   CellTags->"Evaluation"],
  Cell[523089, 13261, 220, 3, 53, "Subsubsection",ExpressionUUID->"fcfc4fa2-fd1d-4eed-8d52-0dd17a028b08",
   CellTags->"Evaluation"],
  Cell[523334, 13268, 31673, 736, 1344, "Input",ExpressionUUID->"f2da0d26-3c00-49af-bd13-df9967726d3d",
   CellTags->"Evaluation"],
  Cell[555010, 14006, 250, 5, 44, "Output",ExpressionUUID->"5b70f01b-9d42-4a19-a1ca-8c39f760dab9",
   CellTags->"Evaluation"],
  Cell[555263, 14013, 1344, 25, 47, "Message",ExpressionUUID->"88f8481d-3d25-4c00-9152-a7f4b84a488b",
   CellTags->"Evaluation"],
  Cell[556610, 14040, 305, 8, 47, "Output",ExpressionUUID->"0ed8f885-a490-41bd-bc3c-345e9f71a996",
   CellTags->"Evaluation"],
  Cell[557000, 14057, 228, 4, 76, "Chapter",ExpressionUUID->"9a636fc2-d498-4319-80ef-14ed0a162393",
   CellTags->"Evaluation"],
  Cell[557253, 14065, 188, 3, 73, "Section",ExpressionUUID->"c5166301-41a3-4dfe-a676-ad3eb38406fd",
   CellTags->"Evaluation"],
  Cell[557444, 14070, 3201, 84, 232, "Input",ExpressionUUID->"5d8a13e1-6fe7-4b7c-ac02-33c32d8f05a3",
   CellTags->"Evaluation"],
  Cell[560694, 14160, 223, 4, 76, "Chapter",ExpressionUUID->"2f10beda-a98e-47ce-9b25-6d5b2e9fb0bb",
   CellTags->"Evaluation"],
  Cell[560942, 14168, 188, 3, 73, "Section",ExpressionUUID->"3242138f-40ad-4247-a5df-a2c5fd3b5d6b",
   CellTags->"Evaluation"],
  Cell[561133, 14173, 3592, 92, 251, "Input",ExpressionUUID->"8d58ff6f-3146-4e5b-93dd-e4eae55647ba",
   CellTags->"Evaluation"],
  Cell[564762, 14270, 205, 3, 73, "Section",ExpressionUUID->"c612d41a-c2ca-437f-aa92-cc3f13f94bcc",
   CellTags->"Evaluation"],
  Cell[564992, 14277, 279, 4, 61, "Subsection",ExpressionUUID->"b35bbc0d-1a12-4b76-9979-036733dfba57",
   CellTags->"Evaluation"],
  Cell[565274, 14283, 8451, 217, 422, "Input",ExpressionUUID->"af1793a9-c991-4eb5-bb7b-068722ea5e83",
   CellTags->"Evaluation"],
  Cell[573762, 14505, 294, 5, 61, "Subsection",ExpressionUUID->"66f54253-4a11-4da9-92bf-5b4a170d0c9c",
   CellTags->"Evaluation"],
  Cell[574059, 14512, 16720, 384, 765, "Input",ExpressionUUID->"888ea411-eb05-433d-82af-9b42dc20abe5",
   CellTags->"Evaluation"],
  Cell[590840, 14903, 362, 9, 76, "Chapter",ExpressionUUID->"0c16d797-cf97-45d5-a5da-b7b1cf6d99d3",
   CellTags->"Evaluation"],
  Cell[591227, 14916, 188, 3, 73, "Section",ExpressionUUID->"22ac6846-672b-4d66-9cfa-1e19aad1e49d",
   CellTags->"Evaluation"],
  Cell[591418, 14921, 4024, 98, 321, "Input",ExpressionUUID->"0923bf32-7001-48e0-b6cc-8caa6b1a676a",
   CellTags->"Evaluation"],
  Cell[595479, 15024, 205, 3, 73, "Section",ExpressionUUID->"6f4c2c05-ba47-4584-a3a8-5975da8e7acd",
   CellTags->"Evaluation"],
  Cell[595709, 15031, 279, 4, 61, "Subsection",ExpressionUUID->"eddd0b80-7620-4305-bdc4-6d501e9ea0d1",
   CellTags->"Evaluation"],
  Cell[595991, 15037, 7874, 218, 574, "Input",ExpressionUUID->"9a3e14c8-a701-4a7b-bd5e-079830f196e6",
   CellTags->"Evaluation"],
  Cell[603902, 15260, 294, 5, 61, "Subsection",ExpressionUUID->"bd015ad4-8be9-47db-97c8-e1ef0e8bd304",
   CellTags->"Evaluation"],
  Cell[604199, 15267, 4015, 101, 325, "Input",ExpressionUUID->"44f080a3-313f-4151-85aa-82221d6fcc7f",
   CellTags->"Evaluation"],
  Cell[608275, 15375, 227, 4, 76, "Chapter",ExpressionUUID->"b06bae0d-0042-4908-8c65-fa53403402b2",
   CellTags->"Evaluation"],
  Cell[608527, 15383, 188, 3, 73, "Section",ExpressionUUID->"87dbf68c-da68-49fd-aa77-8727e25def3f",
   CellTags->"Evaluation"],
  Cell[608718, 15388, 5570, 123, 257, "Input",ExpressionUUID->"e1ed0d49-9570-4820-b744-0bdb07787dba",
   CellTags->"Evaluation"],
  Cell[614325, 15516, 544, 11, 74, "Section",ExpressionUUID->"b97b4e66-c521-4117-8848-be907144e732",
   CellTags->"Evaluation"],
  Cell[614894, 15531, 2002, 53, 159, "Input",ExpressionUUID->"e9469ab9-0236-4da8-981e-4f96c1d0f893",
   CellTags->"Evaluation"],
  Cell[616899, 15586, 499, 14, 62, "Output",ExpressionUUID->"e1efcd43-45e8-471c-aa88-c6c234cd6788",
   CellTags->"Evaluation"],
  Cell[617447, 15606, 201, 3, 73, "Section",ExpressionUUID->"cc2312ac-4e04-4612-9e6b-593fe31948b9",
   CellTags->"Evaluation"],
  Cell[617673, 15613, 189, 3, 61, "Subsection",ExpressionUUID->"346ee184-7723-44c1-b589-5bb27d0a63ef",
   CellTags->"Evaluation"],
  Cell[617865, 15618, 3925, 103, 358, "Input",ExpressionUUID->"fbde88eb-bc2d-4ac9-a0dd-e946ef2c3168",
   CellTags->"Evaluation"],
  Cell[621827, 15726, 207, 3, 61, "Subsection",ExpressionUUID->"cb40b9db-653b-4159-a38b-7faabf033ced",
   CellTags->"Evaluation"],
  Cell[622059, 15733, 13628, 355, 1026, "Input",ExpressionUUID->"95b0b7c6-bc89-4a24-aed8-0f38fa0b1f5d",
   CellTags->"Evaluation"],
  Cell[635690, 16090, 316, 7, 33, "Print",ExpressionUUID->"b2c50bb1-78a2-4b29-b7a8-c815c814fe95",
   CellTags->"Evaluation"],
  Cell[636009, 16099, 679, 22, 66, "Output",ExpressionUUID->"47ba5612-5e44-4d09-ab6c-f99e2fb7ae9b",
   CellTags->"Evaluation"],
  Cell[636761, 16129, 176, 3, 76, "Chapter",ExpressionUUID->"6abe80dc-cac1-4951-a70c-ab85c8903212",
   CellTags->"Evaluation"],
  Cell[636962, 16136, 188, 3, 73, "Section",ExpressionUUID->"4f876c3d-1254-4870-97d6-e76e6b07ff3f",
   CellTags->"Evaluation"],
  Cell[637153, 16141, 3582, 92, 219, "Input",ExpressionUUID->"6daf334b-bcc0-4439-b3da-8dbd64e4d545",
   CellTags->"Evaluation"],
  Cell[640772, 16238, 202, 3, 73, "Section",ExpressionUUID->"4564a7c0-aa3b-445e-81ec-851b73c8ebfb",
   CellTags->"Evaluation"],
  Cell[640999, 16245, 366, 10, 63, "Subsection",ExpressionUUID->"eeca7a08-c73f-42d8-a8cd-007897690c92",
   CellTags->"Evaluation"],
  Cell[641368, 16257, 5786, 153, 301, "Input",ExpressionUUID->"6c06cb31-19e9-4bf7-8220-6ba1b3081bb2",
   CellTags->"Evaluation"],
  Cell[647215, 16417, 187, 3, 76, "Chapter",ExpressionUUID->"3fa2b705-4843-44b9-81de-a4a582e96a5b",
   CellTags->"Evaluation"],
  Cell[647427, 16424, 202, 3, 73, "Section",ExpressionUUID->"b447eeb3-44b8-4ee7-a162-5aca9ea00874",
   CellTags->"Evaluation"],
  Cell[647632, 16429, 10290, 252, 856, "Input",ExpressionUUID->"bedfb77e-9a79-45eb-a4fb-5477f78b7dda",
   CellTags->"Evaluation"],
  Cell[657959, 16686, 255, 4, 73, "Section",ExpressionUUID->"4284abbf-6507-47bb-af57-77152272f71f",
   CellTags->"Evaluation"],
  Cell[658239, 16694, 11869, 264, 940, "Input",ExpressionUUID->"ce721738-ca6a-40b8-920b-aaf912e39c22",
   CellTags->"Evaluation"],
  Cell[670111, 16960, 306, 7, 33, "Print",ExpressionUUID->"126c85d9-072b-4783-b558-ea9f91a77c14",
   CellTags->"Evaluation"],
  Cell[670420, 16969, 13583, 289, 1323, "Output",ExpressionUUID->"51f0b98c-7f8c-46ec-880c-e3b2c8cac0b8",
   CellTags->"Evaluation"],
  Cell[684076, 17266, 425, 6, 101, "Title",ExpressionUUID->"745366ac-d59b-4ddb-b8ff-34a888539c66",
   CellTags->"Evaluation"],
  Cell[684526, 17276, 392, 6, 76, "Chapter",ExpressionUUID->"60e6b013-89b6-4931-8d1e-85654302cfde",
   CellTags->"Evaluation"],
  Cell[684943, 17286, 376, 8, 73, "Section",ExpressionUUID->"9fab6c33-4c62-41ba-93ab-0c39e3261114",
   CellTags->"Evaluation"],
  Cell[685344, 17298, 230, 4, 61, "Subsection",ExpressionUUID->"2031739c-957f-45b9-906c-9275efa46dd4",
   CellTags->"Evaluation"],
  Cell[685599, 17306, 9965, 243, 784, "Input",ExpressionUUID->"529007c0-1e37-442a-b393-824254dc20bf",
   CellTags->"Evaluation"],
  Cell[695567, 17551, 287, 7, 42, "Output",ExpressionUUID->"a13d4f85-9be4-4284-b645-10f415769c53",
   CellTags->"Evaluation"],
  Cell[695857, 17560, 325, 7, 33, "Print",ExpressionUUID->"34c09bca-6830-4b57-9f40-e9649c03f098",
   CellTags->"Evaluation"],
  Cell[696185, 17569, 8245, 132, 230, "Output",ExpressionUUID->"4b8a9453-048d-4a42-8c1d-b40a9434cbcd",
   CellTags->"Evaluation"],
  Cell[704479, 17707, 179, 3, 61, "Subsection",ExpressionUUID->"d01d56eb-8108-44d6-a33d-d966ebb2ff93",
   CellTags->"Evaluation"],
  Cell[704683, 17714, 462, 12, 53, "Subsubsection",ExpressionUUID->"b675334d-c2db-4331-8cc4-db8d7e72ed56",
   CellTags->"Evaluation"],
  Cell[705148, 17728, 8824, 240, 436, "Input",ExpressionUUID->"3833a449-84e5-4bfe-98f1-7f94cf51d80b",
   CellTags->"Evaluation"],
  Cell[714009, 17973, 199, 3, 53, "Subsubsection",ExpressionUUID->"16977a76-d291-4155-8cc8-6ffad80b8c7e",
   CellTags->"Evaluation"],
  Cell[714233, 17980, 34080, 786, 2330, "Input",ExpressionUUID->"7385994f-8eee-4fd5-9f1f-28cba2f65c54",
   CellTags->"Evaluation"],
  Cell[748316, 18768, 27860, 517, 69, "Output",ExpressionUUID->"8152cee4-4f9c-4517-a1a0-086433f23fba",
   CellTags->"Evaluation"],
  Cell[776225, 19291, 261, 4, 53, "Subsubsection",ExpressionUUID->"503b0256-0c8a-4ff3-a0ad-953eabe8080a",
   CellTags->"Evaluation"],
  Cell[776489, 19297, 14226, 330, 458, "Input",ExpressionUUID->"4d06c093-9a88-44d7-a919-51cf305457a2",
   CellTags->"Evaluation"],
  Cell[790776, 19634, 181, 3, 73, "Section",ExpressionUUID->"f367f544-74c6-4b26-b14b-30abac03ef1d",
   CellTags->"Evaluation"],
  Cell[790982, 19641, 279, 4, 61, "Subsection",ExpressionUUID->"7d0ac78d-f6b5-454b-b41b-c56bc84fbc0b",
   CellTags->"Evaluation"],
  Cell[791286, 19649, 11106, 285, 846, "Input",ExpressionUUID->"87cd4ce0-fa9f-4740-b66b-ae761b233c32",
   CellTags->"Evaluation"],
  Cell[802395, 19936, 473, 11, 39, "Message",ExpressionUUID->"af4951aa-4b0b-4392-a56a-9fa5339f3210",
   CellTags->"Evaluation"],
  Cell[802871, 19949, 511, 10, 37, "Print",ExpressionUUID->"50f15b05-1d97-4a20-8410-937f85b9b2e5",
   CellTags->"Evaluation"],
  Cell[803385, 19961, 259, 6, 55, "Output",ExpressionUUID->"165e6315-03ef-4c48-8e97-d4005a421e85",
   CellTags->"Evaluation"],
  Cell[803693, 19973, 206, 3, 61, "Subsection",ExpressionUUID->"01958e91-c9fc-4d82-8a1a-4b6851ee4e54",
   CellTags->"Evaluation"],
  Cell[803924, 19980, 10074, 218, 755, "Input",ExpressionUUID->"2578dee9-aa07-401c-913e-4b52d3ad8240",
   CellTags->"Evaluation"],
  Cell[814001, 20200, 16105, 311, 69, "Output",ExpressionUUID->"9403ae91-cc6b-4846-bb9c-09ba9af279b5",
   CellTags->"Evaluation"],
  Cell[830155, 20517, 228, 3, 61, "Subsection",ExpressionUUID->"aea5f4a7-7e80-4ef3-8261-fdf5a582ee77",
   CellTags->"Evaluation"],
  Cell[830408, 20524, 224, 3, 53, "Subsubsection",ExpressionUUID->"906a3cc7-4794-4d81-918a-9042ea7865fe",
   CellTags->"Evaluation"],
  Cell[830635, 20529, 6782, 159, 556, "Input",ExpressionUUID->"6170bea7-0a36-4d2c-bd34-0673a1930274",
   CellTags->"Evaluation"],
  Cell[837454, 20693, 245, 5, 53, "Subsubsection",ExpressionUUID->"4896fb44-7b77-4532-961a-3e71ba936caf",
   CellTags->"Evaluation"],
  Cell[837702, 20700, 12245, 277, 1086, "Input",ExpressionUUID->"0591216c-b934-4ffa-9068-f81bf8ac5919",
   CellTags->"Evaluation"],
  Cell[850020, 20985, 328, 5, 76, "Chapter",ExpressionUUID->"6ce9c6c5-267f-4281-845d-ee1e4a6f158c",
   CellTags->"Evaluation"],
  Cell[850373, 20994, 267, 4, 73, "Section",ExpressionUUID->"f7ce7329-1054-402b-ae07-4c91d94bf548",
   CellTags->"Evaluation"],
  Cell[850643, 21000, 34743, 867, 1780, "Input",ExpressionUUID->"7c16f4a4-bc39-49f2-ab99-395d54db6c27",
   CellTags->"Evaluation"],
  Cell[885423, 21872, 259, 4, 73, "Section",ExpressionUUID->"89946c5d-55e9-4d17-a3a2-ef3d9bb45859",
   CellTags->"Evaluation"],
  Cell[885685, 21878, 9611, 209, 623, "Input",ExpressionUUID->"4f46895f-6a27-4874-8c29-66bdff8b71bf",
   CellTags->"Evaluation"],
  Cell[895321, 22091, 179, 3, 61, "Subsection",ExpressionUUID->"06943df8-4649-4c77-acb4-efe84a4c9e80",
   CellTags->"Evaluation"],
  Cell[895503, 22096, 23752, 571, 1446, "Input",ExpressionUUID->"0ab61bf6-daa3-40e8-acb6-496831dff47c",
   CellTags->"Evaluation"],
  Cell[919316, 22674, 245, 4, 76, "Chapter",ExpressionUUID->"b2f8440f-0c01-4955-ba05-493e98af5200",
   CellTags->"Evaluation"],
  Cell[919586, 22682, 571, 15, 74, "Section",ExpressionUUID->"125727f8-06b9-47fc-a1af-4d0d283d5432",
   CellTags->"Evaluation"],
  Cell[920160, 22699, 18653, 433, 1204, "Input",ExpressionUUID->"da44903f-05ef-4242-b267-549f4284480a",
   CellTags->"Evaluation"],
  Cell[938850, 23137, 571, 15, 74, "Section",ExpressionUUID->"12b0e6e0-df96-4812-a894-224449fc0ed6",
   CellTags->"Evaluation"],
  Cell[939424, 23154, 18248, 395, 1327, "Input",ExpressionUUID->"56819cf5-9a3b-4ba2-ae85-c810358c19fd",
   CellTags->"Evaluation"],
  Cell[957721, 23555, 247, 4, 76, "Chapter",ExpressionUUID->"853db63b-6868-4690-a70f-51ee3f3c9d64",
   CellTags->"Evaluation"],
  Cell[957971, 23561, 6753, 152, 493, "Input",ExpressionUUID->"4028c5b9-b1a4-4cea-8fa0-6a2cb8751f66",
   CellTags->"Evaluation"],
  Cell[964761, 23718, 222, 3, 76, "Chapter",ExpressionUUID->"ede618e1-db1f-4052-9341-3ad98669ba20",
   CellTags->"Evaluation"],
  Cell[964986, 23723, 9003, 216, 752, "Input",ExpressionUUID->"1b07e271-afb1-4157-a0b3-9451e6471051",
   CellTags->"Evaluation"],
  Cell[974026, 23944, 268, 4, 76, "Chapter",ExpressionUUID->"af9d6ef0-a707-4b09-bb51-ae1bcb296b9c",
   CellTags->"Evaluation"],
  Cell[974297, 23950, 9999, 245, 701, "Input",ExpressionUUID->"7101a228-73dd-406a-8181-affd5068b625",
   CellTags->"Evaluation"],
  Cell[984345, 24201, 432, 7, 101, "Title",ExpressionUUID->"a71a0f7a-e822-4051-8bff-ebc5c2c75f52",
   CellTags->"Evaluation"],
  Cell[984802, 24212, 235, 4, 76, "Chapter",ExpressionUUID->"775189f9-9eab-4b5c-a388-a430aebaaeea",
   CellTags->"Evaluation"],
  Cell[985040, 24218, 10902, 276, 903, "Input",ExpressionUUID->"bcd78e34-e5dd-47ca-ac7c-801c6238170a",
   CellTags->"Evaluation"],
  Cell[995979, 24499, 246, 4, 76, "Chapter",ExpressionUUID->"ca953807-2e9a-48d4-a863-7393320df9ea",
   CellTags->"Evaluation"],
  Cell[996250, 24507, 6584, 149, 679, "Input",ExpressionUUID->"adc76db4-8a20-4f83-b656-3220b99a5305",
   CellTags->"Evaluation"],
  Cell[1002837, 24658, 295, 6, 33, "Print",ExpressionUUID->"6e7bf31a-e69c-4e2e-9534-1871757db46e",
   CellTags->"Evaluation"],
  Cell[1003135, 24666, 622, 13, 42, "Output",ExpressionUUID->"8cd6410d-8300-4302-8636-a9a33024affc",
   CellTags->"Evaluation"],
  Cell[1003760, 24681, 288, 6, 33, "Print",ExpressionUUID->"53590713-f496-4553-8f74-05fe709b709c",
   CellTags->"Evaluation"],
  Cell[1004051, 24689, 237, 5, 42, "Output",ExpressionUUID->"4aa8004d-d70e-4a85-b40e-d546b3e7f202",
   CellTags->"Evaluation"],
  Cell[1004291, 24696, 283, 6, 33, "Print",ExpressionUUID->"e49251f3-2352-466d-abf6-383b9cde7475",
   CellTags->"Evaluation"],
  Cell[1004577, 24704, 237, 5, 42, "Output",ExpressionUUID->"55d0a94c-d0ca-4f5c-a6e4-4c70b3f05fc4",
   CellTags->"Evaluation"],
  Cell[1004817, 24711, 305, 7, 33, "Print",ExpressionUUID->"b5bf56b2-d115-4df1-b36d-a5596f4a8fd0",
   CellTags->"Evaluation"],
  Cell[1005125, 24720, 398, 11, 53, "Output",ExpressionUUID->"565aebaf-e8e7-4d93-9f33-915210fd5fb5",
   CellTags->"Evaluation"],
  Cell[1005526, 24733, 641, 14, 39, "Message",ExpressionUUID->"9f541da3-e618-41d1-a503-43e7c9a8c7df",
   CellTags->"Evaluation"],
  Cell[1006170, 24749, 322, 7, 33, "Print",ExpressionUUID->"ef999b29-d5e0-4d3e-968a-6d92945e2076",
   CellTags->"Evaluation"],
  Cell[1006495, 24758, 314, 9, 53, "Output",ExpressionUUID->"4fba07d8-df0b-4e08-9a71-0dec39a6e191",
   CellTags->"Evaluation"],
  Cell[1006858, 24773, 231, 4, 76, "Chapter",ExpressionUUID->"1d42ed8a-55b1-48cd-be60-4ba46cd2ce8a",
   CellTags->"Evaluation"],
  Cell[1007114, 24781, 8453, 196, 655, "Input",ExpressionUUID->"ad17ac27-c9b6-4baf-b3e5-aa882d324cbd",
   CellTags->"Evaluation"],
  Cell[1015570, 24979, 297, 6, 33, "Print",ExpressionUUID->"1dd983ac-6005-4d26-a165-dfc2dbf6d315",
   CellTags->"Evaluation"],
  Cell[1015870, 24987, 524, 16, 42, "Output",ExpressionUUID->"a2ac2716-799d-4ad0-8af1-c9fa409db540",
   CellTags->"Evaluation"],
  Cell[1016397, 25005, 536, 12, 39, "Message",ExpressionUUID->"276c5700-904f-4e4b-a1d6-a6ec74fbafee",
   CellTags->"Evaluation"],
  Cell[1016936, 25019, 400, 11, 42, "Output",ExpressionUUID->"26287bb7-b1ad-43c6-bde5-972e5fee30a7",
   CellTags->"Evaluation"]}
 }
*)
(*CellTagsIndex
CellTagsIndex->{
 {"Evaluation", 1218188, 30221}
 }
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 259, 4, 88, "Title",ExpressionUUID->"3ad7abe4-49cc-42b5-bac5-0bcccffa73c5"],
Cell[CellGroupData[{
Cell[864, 30, 1328, 28, 297, "Input",ExpressionUUID->"6fc3bbf2-99e6-4e07-be13-873a72c87351"],
Cell[2195, 60, 503, 11, 26, "Message",ExpressionUUID->"ebf4d63f-ae6e-4bf5-b051-f030cee3309e"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[2747, 77, 428, 6, 78, "Title",ExpressionUUID->"9f74c6f1-3857-4415-bd05-374f4b0a6d43",
 CellTags->"Evaluation"],
Cell[CellGroupData[{
Cell[3200, 87, 275, 4, 76, "Chapter",ExpressionUUID->"4350f6b8-70ba-426b-b952-c2d172f0b593",
 CellTags->"Evaluation"],
Cell[CellGroupData[{
Cell[3500, 95, 1133, 30, 169, "Input",ExpressionUUID->"164a4a0f-e0b1-4b2d-91f1-566d65334670",
 CellTags->"Evaluation"],
Cell[4636, 127, 674, 16, 39, "Print",ExpressionUUID->"6ec5e9b5-62f4-414a-93e3-efa74abdc54f",
 CellTags->"Evaluation"],
Cell[5313, 145, 237, 5, 42, "Output",ExpressionUUID->"a78a7710-8828-457c-bc1c-74b8104edab4",
 CellTags->"Evaluation"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[5599, 156, 182, 3, 76, "Chapter",ExpressionUUID->"f8243e93-a44c-4fe5-894e-0743d4884863",
 CellTags->"Evaluation"],
Cell[CellGroupData[{
Cell[5806, 163, 186, 3, 73, "Section",ExpressionUUID->"80187575-21b6-468f-8e4a-db311a554398",
 CellTags->"Evaluation"],
Cell[5995, 168, 893, 27, 83, "Input",ExpressionUUID->"a1ffc0dc-1570-4f50-ba14-bbefddbce453",
 CellTags->"Evaluation"]
}, Open  ]],
Cell[CellGroupData[{
Cell[6925, 200, 260, 4, 73, "Section",ExpressionUUID->"802f0307-65bf-44e4-9bdd-603d6615efc3",
 CellTags->"Evaluation"],
Cell[7188, 206, 4152, 115, 424, "Input",ExpressionUUID->"ce0d3f6c-f69d-4974-bd82-3355d8c6b198",
 CellTags->"Evaluation"]
}, Open  ]],
Cell[CellGroupData[{
Cell[11377, 326, 201, 3, 73, "Section",ExpressionUUID->"16dbf08b-1200-4ac4-ad9a-ed04d15b41ef",
 CellTags->"Evaluation"],
Cell[CellGroupData[{
Cell[11603, 333, 234, 4, 61, "Subsection",ExpressionUUID->"be5850ea-72d1-4eb6-b945-f4862fadb6d4",
 CellTags->"Evaluation"],
Cell[11840, 339, 2024, 56, 174, "Input",ExpressionUUID->"57b13a59-bbda-47bd-bcb1-94321ca663e9",
 CellTags->"Evaluation"]
}, Open  ]],
Cell[CellGroupData[{
Cell[13901, 400, 174, 3, 61, "Subsection",ExpressionUUID->"22b5bbc3-3951-46d3-ad9a-83114d344b4c",
 CellTags->"Evaluation"],
Cell[14078, 405, 1715, 50, 306, "Input",ExpressionUUID->"d9f77161-a435-4e0d-a1e7-77d7f183b93b",
 CellTags->"Evaluation"]
}, Open  ]],
Cell[CellGroupData[{
Cell[15830, 460, 332, 6, 61, "Subsection",ExpressionUUID->"095611fb-9a2e-4c4f-91d9-5d2e63f6be49",
 CellTags->"Evaluation"],
Cell[16165, 468, 1073, 30, 174, "Input",ExpressionUUID->"79c3c6d2-bec6-41b6-9818-7d5c26b7676d",
 CellTags->"Evaluation"]
}, Open  ]],
Cell[CellGroupData[{
Cell[17275, 503, 166, 3, 48, "Subsection",ExpressionUUID->"239b0731-d9a0-413a-a3de-2e64f11459dd"],
Cell[17444, 508, 81, 0, 27, "Input",ExpressionUUID->"5b3fec8b-320e-4e23-b87c-6ac77025406a"],
Cell[17528, 510, 842, 26, 123, "Input",ExpressionUUID->"c1207ebb-e6f9-40a5-a407-6f08a7175e21"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[18419, 542, 314, 5, 73, "Section",ExpressionUUID->"e56a72b1-83e0-4714-b342-2b505f68174b",
 CellTags->"Evaluation"],
Cell[CellGroupData[{
Cell[18758, 551, 13248, 324, 833, "Input",ExpressionUUID->"2e3fc200-3d1f-489f-b96a-9e47e0198bbe",
 CellTags->"Evaluation"],
Cell[32009, 877, 672, 16, 39, "Print",ExpressionUUID->"41149713-9fda-4b06-8969-5909ba4e2c02",
 CellTags->"Evaluation"],
Cell[32684, 895, 237, 5, 42, "Output",ExpressionUUID->"dd5ee897-2890-4c89-80bf-f1e2fea317f3",
 CellTags->"Evaluation"],
Cell[32924, 902, 875, 16, 42, "Output",ExpressionUUID->"da38fc3e-cd51-461e-b381-0a79a489739a",
 CellTags->"Evaluation"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[33848, 924, 363, 5, 73, "Section",ExpressionUUID->"ed0ed593-049b-46cb-876d-fd2059f1978e",
 CellTags->"Evaluation"],
Cell[34214, 931, 27456, 760, 1303, "Input",ExpressionUUID->"72c7a1cb-121c-4aae-ac1f-468c38ac6100",
 CellTags->"Evaluation"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[61731, 1698, 310, 5, 101, "Title",ExpressionUUID->"76b860cd-984b-41b4-99cf-16aba9d2025c",
 CellTags->"Evaluation"],
Cell[CellGroupData[{
Cell[62066, 1707, 368, 5, 76, "Chapter",ExpressionUUID->"7c2d3d9c-4846-4861-bd3f-24c69d50f1dc",
 CellTags->"Evaluation"],
Cell[CellGroupData[{
Cell[62459, 1716, 6458, 166, 411, "Input",ExpressionUUID->"322a1ea8-52b2-4163-8d33-47a158740375",
 CellTags->"Evaluation"],
Cell[68920, 1884, 286, 7, 42, "Output",ExpressionUUID->"ce7f742b-21f1-45ed-8b9a-53ce5c507312",
 CellTags->"Evaluation"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[69255, 1897, 408, 8, 76, "Chapter",ExpressionUUID->"a19a94ae-a3db-4a44-b250-a8a4225019c3",
 CellTags->"Evaluation"],
Cell[CellGroupData[{
Cell[69688, 1909, 217, 4, 73, "Section",ExpressionUUID->"20b535ef-a1ee-45b0-9a6f-d52026ce2181",
 CellTags->"Evaluation"],
Cell[CellGroupData[{
Cell[69930, 1917, 439, 9, 61, "Subsection",ExpressionUUID->"b94b25f8-4bb1-4586-a3a5-2c943d15b6ef",
 CellTags->"Evaluation"],
Cell[70372, 1928, 7528, 184, 407, "Input",ExpressionUUID->"d59e1373-0f6f-4224-85da-ecd147c98905",
 CellTags->"Evaluation"]
}, Open  ]],
Cell[CellGroupData[{
Cell[77937, 2117, 653, 18, 62, "Subsection",ExpressionUUID->"b772a033-a7b6-45f9-bf82-037ca4e21689",
 CellTags->"Evaluation"],
Cell[CellGroupData[{
Cell[78615, 2139, 12248, 289, 988, "Input",ExpressionUUID->"350c467b-7755-44e9-a68b-9e78f62450ae",
 CellTags->"Evaluation"],
Cell[90866, 2430, 26177, 495, 70, "Output",ExpressionUUID->"db8dcd1a-5ab4-494e-8cdd-f9e86a4fb3c4",
 CellTags->"Evaluation"],
Cell[117046, 2927, 18101, 348, 69, "Output",ExpressionUUID->"8b409073-dd31-43a4-a023-99e479e9692d",
 CellTags->"Evaluation"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[135196, 3281, 477, 12, 62, "Subsection",ExpressionUUID->"f83049fd-8fed-4560-865f-95bb871146be",
 CellTags->"Evaluation"],
Cell[135676, 3295, 24340, 574, 1637, "Input",ExpressionUUID->"1526fbf7-ef3a-4a98-bdc1-4389e2074498",
 CellTags->"Evaluation"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[160065, 3875, 183, 3, 73, "Section",ExpressionUUID->"1ff15133-44cb-4c98-a0fa-56621f6338fa",
 CellTags->"Evaluation"],
Cell[CellGroupData[{
Cell[160273, 3882, 16879, 393, 1403, "Input",ExpressionUUID->"2ec450ed-9c77-4c44-8a53-5405c2d3f3a5",
 CellTags->"Evaluation"],
Cell[177155, 4277, 16735, 323, 69, "Output",ExpressionUUID->"cd34b1ea-7dbf-41a8-8dc5-4f01540a10aa",
 CellTags->"Evaluation"],
Cell[193893, 4602, 15704, 301, 69, "Output",ExpressionUUID->"903c21f6-cbdd-4de8-88e3-1b97db727d32",
 CellTags->"Evaluation"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[209658, 4910, 305, 5, 76, "Chapter",ExpressionUUID->"e54bbe8c-2f3c-464c-8714-8e4597d33d99",
 CellTags->"Evaluation"],
Cell[CellGroupData[{
Cell[209988, 4919, 190, 3, 73, "Section",ExpressionUUID->"6a284235-3c44-4a3d-bb13-b42fe2ecb30a",
 CellTags->"Evaluation"],
Cell[CellGroupData[{
Cell[210203, 4926, 13392, 322, 891, "Input",ExpressionUUID->"b82b39d0-f01e-440a-b4d1-dc5e7ce1ccbf",
 CellTags->"Evaluation"],
Cell[223598, 5250, 282, 7, 42, "Output",ExpressionUUID->"2bba2473-dac8-4dbb-ba25-36668b0f82d1",
 CellTags->"Evaluation"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[223929, 5263, 176, 3, 73, "Section",ExpressionUUID->"390f4661-3512-4be2-86d0-5fc0e3625611",
 CellTags->"Evaluation"],
Cell[224108, 5268, 13348, 318, 462, "Input",ExpressionUUID->"f067bd9f-1c0a-4be7-aa46-c364af47de64",
 CellTags->"Evaluation"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[237517, 5593, 264, 4, 101, "Title",ExpressionUUID->"b7431e4b-8fd3-4b39-abd9-5de880c5126c",
 CellTags->"Evaluation"],
Cell[CellGroupData[{
Cell[237806, 5601, 192, 3, 76, "Chapter",ExpressionUUID->"cb022232-9785-4115-9e3d-4db1fdd7c520",
 CellTags->"Evaluation"],
Cell[CellGroupData[{
Cell[238023, 5608, 463, 12, 74, "Section",ExpressionUUID->"91a14f45-0875-4e85-a61d-49cc362d42eb",
 CellTags->"Evaluation"],
Cell[CellGroupData[{
Cell[238511, 5624, 14950, 423, 643, "Input",ExpressionUUID->"53a6dfba-6611-4b8e-874f-a8a4e369b2f2",
 CellTags->"Evaluation"],
Cell[253464, 6049, 473, 11, 39, "Message",ExpressionUUID->"1779dff2-a3e0-4a0f-883c-e65ea594844a",
 CellTags->"Evaluation"],
Cell[253940, 6062, 4878, 137, 119, "Output",ExpressionUUID->"5943677d-5a12-4a81-ada0-a022e968638e",
 CellTags->"Evaluation"],
Cell[258821, 6201, 1692, 49, 67, "Output",ExpressionUUID->"5bf9de3f-d91a-489f-9996-b49440eaff39",
 CellTags->"Evaluation"],
Cell[260516, 6252, 505, 15, 62, "Output",ExpressionUUID->"5ecf5ef1-6ecf-435f-9899-f4245e028911",
 CellTags->"Evaluation"],
Cell[261024, 6269, 473, 11, 39, "Message",ExpressionUUID->"15883a0a-e5cb-4b2d-9901-83672ac077e2",
 CellTags->"Evaluation"],
Cell[261500, 6282, 4878, 137, 119, "Output",ExpressionUUID->"baecb409-73d0-42da-b5e7-94dd58f43f72",
 CellTags->"Evaluation"],
Cell[266381, 6421, 535, 15, 62, "Output",ExpressionUUID->"18491e02-6e55-40b9-9e1d-6b085e2ab925",
 CellTags->"Evaluation"],
Cell[266919, 6438, 391, 10, 44, "Output",ExpressionUUID->"bf7b2c58-b780-4477-892d-ac366330dcdc",
 CellTags->"Evaluation"],
Cell[267313, 6450, 369, 10, 44, "Output",ExpressionUUID->"284a65cb-70dc-4387-85ef-06089727d5a8",
 CellTags->"Evaluation"]
}, Open  ]],
Cell[CellGroupData[{
Cell[267719, 6465, 212, 3, 61, "Subsection",ExpressionUUID->"da999496-62ed-45f4-a17e-11b68f45cddb",
 CellTags->"Evaluation"],
Cell[267934, 6470, 2048, 60, 219, "Input",ExpressionUUID->"6193526c-612d-4041-a81d-d0aed1dec4a4",
 CellTags->"Evaluation"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[270031, 6536, 350, 7, 73, "Section",ExpressionUUID->"fb2d743c-1d47-4f3e-9d37-480a38ea1b24",
 CellTags->"Evaluation"],
Cell[270384, 6545, 266, 4, 27, "Input",ExpressionUUID->"66e3f84d-a4f6-4f5b-bf9a-60d76027ac3f"],
Cell[CellGroupData[{
Cell[270675, 6553, 18243, 456, 1296, "Input",ExpressionUUID->"06209544-3773-489e-b401-f3c8152c8319",
 CellTags->"Evaluation"],
Cell[288921, 7011, 562, 13, 39, "Message",ExpressionUUID->"6134ddab-b135-47c2-85ca-9b5e14fe36fc",
 CellTags->"Evaluation"],
Cell[289486, 7026, 562, 13, 39, "Message",ExpressionUUID->"ee525567-b012-48d5-81b5-f9e56b217b93",
 CellTags->"Evaluation"],
Cell[290051, 7041, 560, 13, 39, "Message",ExpressionUUID->"76c2ce01-0118-498b-b884-1ade7054a0a3",
 CellTags->"Evaluation"],
Cell[290614, 7056, 575, 13, 39, "Message",ExpressionUUID->"8825f3ef-0780-43c6-a7d2-eec386a7a2f6",
 CellTags->"Evaluation"]
}, Open  ]],
Cell[291204, 7072, 273, 5, 27, "Input",ExpressionUUID->"b6b539ad-e103-4e6b-a93c-1a724b07a7e3"],
Cell[291480, 7079, 467, 8, 47, "Input",ExpressionUUID->"44b1315f-4233-44e4-afa3-8a7a4afdf9c6"],
Cell[291950, 7089, 129, 2, 27, "Input",ExpressionUUID->"7728b850-d838-470f-84b5-9ccfb0ce3e24"],
Cell[292082, 7093, 516, 13, 41, "Input",ExpressionUUID->"e763adb4-f64c-4d95-b2fa-3cbcadba7692"],
Cell[292601, 7108, 3917, 102, 242, "Input",ExpressionUUID->"b558505e-b45f-4d12-972b-488d98c48566"],
Cell[296521, 7212, 151, 3, 27, "Input",ExpressionUUID->"1947cb8b-94c6-4847-a144-30b6c66d1f4b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[296709, 7220, 212, 3, 73, "Section",ExpressionUUID->"ecf5bab7-5ea6-437a-9631-ce3f62c4edfb",
 CellTags->"Evaluation"],
Cell[CellGroupData[{
Cell[296946, 7227, 196, 3, 61, "Subsection",ExpressionUUID->"aa0f2d30-2951-433c-8422-3eae16d65609",
 CellTags->"Evaluation"],
Cell[CellGroupData[{
Cell[297167, 7234, 6111, 181, 554, "Input",ExpressionUUID->"c49b2c57-3f81-4950-8334-7fcac9bc22cf",
 CellTags->"Evaluation"],
Cell[303281, 7417, 833, 26, 78, "Output",ExpressionUUID->"1f41b548-adad-4f40-b82a-2d69d7ca3b6a",
 CellTags->"Evaluation"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[304163, 7449, 213, 3, 61, "Subsection",ExpressionUUID->"a245a9ad-be57-4780-b644-b1f1504e0331",
 CellTags->"Evaluation"],
Cell[304379, 7454, 4742, 135, 271, "Input",ExpressionUUID->"f5a0a55d-2b6c-42d3-81db-68110c8f100d",
 CellTags->"Evaluation"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[309182, 7596, 319, 5, 76, "Chapter",ExpressionUUID->"a8f49eab-e7b1-4705-9448-f2a995602fd0",
 CellTags->"Evaluation"],
Cell[CellGroupData[{
Cell[309526, 7605, 188, 3, 73, "Section",ExpressionUUID->"c08c78a0-7415-4dd4-a1ce-05c6eb37994e",
 CellTags->"Evaluation"],
Cell[309717, 7610, 12361, 313, 740, "Input",ExpressionUUID->"0c0fb3ea-7b74-4498-9c9b-983eee5abfd7",
 CellTags->"Evaluation"]
}, Open  ]],
Cell[CellGroupData[{
Cell[322115, 7928, 343, 5, 73, "Section",ExpressionUUID->"ffe71289-67cd-43b9-8115-56413162d724",
 CellTags->"Evaluation"],
Cell[CellGroupData[{
Cell[322483, 7937, 230, 4, 61, "Subsection",ExpressionUUID->"7e519fd0-4951-4f22-871f-ef83ce20d9e7",
 CellTags->"Evaluation"],
Cell[322716, 7943, 7924, 203, 443, "Input",ExpressionUUID->"5a037ee8-f108-4a7f-b5e1-64caca67a36d",
 CellTags->"Evaluation"]
}, Open  ]],
Cell[CellGroupData[{
Cell[330677, 8151, 193, 3, 61, "Subsection",ExpressionUUID->"9a37a07e-462a-4aaf-b23b-e1694ff76248",
 CellTags->"Evaluation"],
Cell[CellGroupData[{
Cell[330895, 8158, 9281, 233, 571, "Input",ExpressionUUID->"1505a48e-36d3-4bc5-9467-a888c370264b",
 CellTags->"Evaluation"],
Cell[340179, 8393, 661, 17, 59, "Output",ExpressionUUID->"464c05b8-6c31-4e7c-bcd7-e62fe007952c",
 CellTags->"Evaluation"],
Cell[340843, 8412, 645, 17, 59, "Output",ExpressionUUID->"550e0412-0a9b-49d7-8914-30bbf0cfd2dc",
 CellTags->"Evaluation"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[341549, 8436, 636, 13, 74, "Section",ExpressionUUID->"87cf203d-07c5-44e4-84d2-b9c06c63b425",
 CellTags->"Evaluation"],
Cell[CellGroupData[{
Cell[342210, 8453, 184, 3, 61, "Subsection",ExpressionUUID->"26146eba-46ad-47c9-a195-57d58effde05",
 CellTags->"Evaluation"],
Cell[342397, 8458, 3492, 84, 201, "Input",ExpressionUUID->"42f2e7ee-39f5-4f67-a823-602471499d45",
 CellTags->"Evaluation"]
}, Open  ]],
Cell[CellGroupData[{
Cell[345926, 8547, 423, 10, 62, "Subsection",ExpressionUUID->"211335e5-7f8a-43a9-8ce5-ece646b965e2",
 CellTags->"Evaluation"],
Cell[346352, 8559, 17879, 476, 782, "Input",ExpressionUUID->"db561fe9-9b2a-4977-a5a6-1f008030ce10",
 CellTags->"Evaluation"]
}, Open  ]],
Cell[CellGroupData[{
Cell[364268, 9040, 448, 11, 62, "Subsection",ExpressionUUID->"36c14be9-b412-45f7-9bf3-03acd0e0de40",
 CellTags->"Evaluation"],
Cell[364719, 9053, 10439, 280, 477, "Input",ExpressionUUID->"822f4d77-af6c-4066-91bd-8cc13c8b6d92",
 CellTags->"Evaluation"]
}, Open  ]],
Cell[CellGroupData[{
Cell[375195, 9338, 558, 12, 62, "Subsection",ExpressionUUID->"3bf4776a-9a9b-4383-aa96-3910e1a621a2",
 CellTags->"Evaluation"],
Cell[375756, 9352, 4266, 112, 230, "Input",ExpressionUUID->"9bd49d09-9738-4659-858a-a54557b2b0ee",
 CellTags->"Evaluation"]
}, Open  ]],
Cell[CellGroupData[{
Cell[380059, 9469, 868, 21, 64, "Subsection",ExpressionUUID->"54283de7-deea-4f58-ad14-5dafbd438d01",
 CellTags->"Evaluation"],
Cell[380930, 9492, 8766, 238, 457, "Input",ExpressionUUID->"13fba45d-94f9-4916-8795-2b6683129869",
 CellTags->"Evaluation"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[389745, 9736, 268, 6, 73, "Section",ExpressionUUID->"667aee5b-504d-4798-9ccf-7c7f5c539e14",
 CellTags->"Evaluation"],
Cell[CellGroupData[{
Cell[390038, 9746, 648, 17, 56, "Subsubsection",ExpressionUUID->"ad9e56ec-edc5-45b2-b48a-83ea0326342a",
 CellTags->"Evaluation"],
Cell[390689, 9765, 5363, 134, 412, "Input",ExpressionUUID->"11ecbafc-a5e8-47ed-a97f-18a09b37df83",
 CellTags->"Evaluation"]
}, Open  ]],
Cell[CellGroupData[{
Cell[396089, 9904, 188, 3, 61, "Subsection",ExpressionUUID->"291cf4c3-322d-4335-9bdc-e9d66b0d9acf",
 CellTags->"Evaluation"],
Cell[396280, 9909, 2402, 62, 206, "Input",ExpressionUUID->"573c73b7-657e-46a8-a6d7-31c4c6f46f48",
 CellTags->"Evaluation"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[398743, 9978, 230, 4, 76, "Chapter",ExpressionUUID->"e6032420-000f-4c70-862b-c0e99d95a710",
 CellTags->"Evaluation"],
Cell[CellGroupData[{
Cell[398998, 9986, 188, 3, 73, "Section",ExpressionUUID->"d7772fe1-303e-43a1-a6e2-f52f668cffdb",
 CellTags->"Evaluation"],
Cell[399189, 9991, 3611, 92, 251, "Input",ExpressionUUID->"4e0e9899-fded-4d72-8877-13bc67a0fdf7",
 CellTags->"Evaluation"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[402849, 10089, 230, 4, 76, "Chapter",ExpressionUUID->"0f30225e-de51-473d-8156-16ddf2e7a477",
 CellTags->"Evaluation"],
Cell[CellGroupData[{
Cell[403104, 10097, 188, 3, 73, "Section",ExpressionUUID->"fbe6c10f-8446-4672-85b1-ebf7ba71b704",
 CellTags->"Evaluation"],
Cell[403295, 10102, 6263, 157, 390, "Input",ExpressionUUID->"ab7d6d0f-dab9-431e-8716-0468ee58c642",
 CellTags->"Evaluation"]
}, Open  ]],
Cell[CellGroupData[{
Cell[409595, 10264, 202, 3, 73, "Section",ExpressionUUID->"5d63056d-9fc8-4495-ac24-5e9fd33dd9c5",
 CellTags->"Evaluation"],
Cell[CellGroupData[{
Cell[409822, 10271, 366, 10, 63, "Subsection",ExpressionUUID->"4d9b925b-3422-4531-b2f2-fb793c1b1962",
 CellTags->"Evaluation"],
Cell[410191, 10283, 8833, 232, 386, "Input",ExpressionUUID->"1828b044-1bf8-4f21-b901-afd828bd05c5",
 CellTags->"Evaluation"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[419073, 10521, 192, 3, 73, "Section",ExpressionUUID->"8caf92d5-70a9-4c4b-b9ed-16ae9de4c52f",
 CellTags->"Evaluation"],
Cell[CellGroupData[{
Cell[419290, 10528, 211, 4, 61, "Subsection",ExpressionUUID->"e08d29a5-6da2-449e-ad91-5f45d20ef30c",
 CellTags->"Evaluation"],
Cell[CellGroupData[{
Cell[419526, 10536, 12416, 356, 743, "Input",ExpressionUUID->"79ee2751-71ac-43ae-9273-0e4f4fdee8cc",
 CellTags->"Evaluation"],
Cell[431945, 10894, 491, 10, 37, "Print",ExpressionUUID->"c4aff447-3018-4bad-8fdb-7ebe9c8d2a89",
 CellTags->"Evaluation"],
Cell[432439, 10906, 343, 9, 59, "Output",ExpressionUUID->"aa39e359-5427-4471-a73f-f8b58f2b8306",
 CellTags->"Evaluation"],
Cell[432785, 10917, 375, 7, 35, "Print",ExpressionUUID->"ef6af8a9-7a2f-45ee-99fe-f8c010c155af",
 CellTags->"Evaluation"],
Cell[433163, 10926, 254, 6, 42, "Output",ExpressionUUID->"0da25b29-89da-4dfc-a7a5-07cccea1698c",
 CellTags->"Evaluation"],
Cell[433420, 10934, 816, 15, 36, "Print",ExpressionUUID->"34ff7d6d-ca66-48cd-b4ca-d914dc770228",
 CellTags->"Evaluation"],
Cell[434239, 10951, 1350, 40, 86, "Output",ExpressionUUID->"220f840f-ba92-4b99-8a57-bd964b4d08e1",
 CellTags->"Evaluation"],
Cell[435592, 10993, 1444, 43, 86, "Output",ExpressionUUID->"8f9148bb-74de-4d29-b918-2a055fefef27",
 CellTags->"Evaluation"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[437085, 11042, 192, 3, 61, "Subsection",ExpressionUUID->"e8574462-a41d-4945-b7dd-fa72d898c863",
 CellTags->"Evaluation"],
Cell[437280, 11047, 13450, 351, 525, "Input",ExpressionUUID->"aa38e0a1-a817-4b7b-a76e-98552d3dae1f",
 CellTags->"Evaluation"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[450779, 11404, 299, 6, 73, "Section",ExpressionUUID->"f5fbce2e-bd61-4cb2-8cc6-8bef2d5b3fae",
 CellTags->"Evaluation"],
Cell[CellGroupData[{
Cell[451103, 11414, 248, 5, 61, "Subsection",ExpressionUUID->"d4edb50b-69e7-4aef-bf71-487cbcc8e1c5",
 CellTags->"Evaluation"],
Cell[451354, 11421, 4131, 110, 292, "Input",ExpressionUUID->"5f3ed18a-4865-483b-9084-1c493c97c698",
 CellTags->"Evaluation"]
}, Open  ]],
Cell[CellGroupData[{
Cell[455522, 11536, 259, 4, 61, "Subsection",ExpressionUUID->"129ed7d0-3b9a-4c3b-b008-b68f20fdb211",
 CellTags->"Evaluation"],
Cell[CellGroupData[{
Cell[455806, 11544, 12747, 343, 707, "Input",ExpressionUUID->"eb94db9a-b0be-4ec4-a74c-00f25a0acfd3",
 CellTags->"Evaluation"],
Cell[468556, 11889, 473, 11, 39, "Message",ExpressionUUID->"4f8baeed-6e1b-4564-9f60-5abe007a30b3",
 CellTags->"Evaluation"],
Cell[469032, 11902, 1587, 51, 87, "Output",ExpressionUUID->"a4d1980b-a2f3-4f4c-b4b5-efcb30b9222e",
 CellTags->"Evaluation"]
}, Open  ]],
Cell[CellGroupData[{
Cell[470656, 11958, 220, 3, 53, "Subsubsection",ExpressionUUID->"444afafe-c64f-41b7-b6cf-aa908a1e192f",
 CellTags->"Evaluation"],
Cell[CellGroupData[{
Cell[470901, 11965, 29795, 691, 1314, "Input",ExpressionUUID->"327c34bc-65bf-496b-b6ce-ace808862596",
 CellTags->"Evaluation"],
Cell[500699, 12658, 307, 8, 47, "Output",ExpressionUUID->"e4ef8695-e24c-40e8-a7b3-a11e5a01ecf8",
 CellTags->"Evaluation"]
}, Open  ]],
Cell[501021, 12669, 857, 23, 73, "Input",ExpressionUUID->"6bc9af04-7e00-4a29-a187-7213669d03bf"],
Cell[501881, 12694, 570, 15, 60, "Input",ExpressionUUID->"845047b1-c6bc-4878-bc39-d5470b5da3c2"],
Cell[502454, 12711, 1225, 32, 127, "Input",ExpressionUUID->"736e1286-be83-486d-a71b-089ba3c3a599"],
Cell[503682, 12745, 517, 12, 47, "Input",ExpressionUUID->"99771ca0-5cca-4c57-91f4-14b03a0063b1"],
Cell[504202, 12759, 553, 16, 41, "Input",ExpressionUUID->"d3a6f92f-307d-40ee-b3d9-d448ec857e30"]
}, Open  ]],
Cell[CellGroupData[{
Cell[504792, 12780, 579, 16, 56, "Subsubsection",ExpressionUUID->"bf14ac37-c134-491d-affc-c438fea539d6",
 CellTags->"Evaluation"],
Cell[CellGroupData[{
Cell[505396, 12800, 170, 3, 43, "Item",ExpressionUUID->"f68843f3-917e-475e-942c-cdc3a338c4d9",
 CellTags->"Evaluation"],
Cell[505569, 12805, 3803, 92, 154, "Input",ExpressionUUID->"d10de36e-1aea-4fd7-b054-4e006d790cb3",
 CellTags->"Evaluation"]
}, Open  ]],
Cell[CellGroupData[{
Cell[509409, 12902, 173, 3, 43, "Item",ExpressionUUID->"e0222495-2a30-444e-95b1-1ffda468252f",
 CellTags->"Evaluation"],
Cell[509585, 12907, 3609, 89, 168, "Input",ExpressionUUID->"1aa3601e-3cf5-4a65-ab2b-e8461899e49e",
 CellTags->"Evaluation"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[513255, 13003, 260, 4, 61, "Subsection",ExpressionUUID->"82f5b9ee-eff5-4f8a-90eb-19c98e947bd1",
 CellTags->"Evaluation"],
Cell[CellGroupData[{
Cell[513540, 13011, 9038, 232, 445, "Input",ExpressionUUID->"4ddf9aea-d127-4514-9c49-953ffbcc3e21",
 CellTags->"Evaluation"],
Cell[522581, 13245, 471, 11, 39, "Message",ExpressionUUID->"6e10fa7e-339d-4d3b-b413-2ed070682892",
 CellTags->"Evaluation"]
}, Open  ]],
Cell[CellGroupData[{
Cell[523089, 13261, 220, 3, 53, "Subsubsection",ExpressionUUID->"fcfc4fa2-fd1d-4eed-8d52-0dd17a028b08",
 CellTags->"Evaluation"],
Cell[CellGroupData[{
Cell[523334, 13268, 31673, 736, 1344, "Input",ExpressionUUID->"f2da0d26-3c00-49af-bd13-df9967726d3d",
 CellTags->"Evaluation"],
Cell[555010, 14006, 250, 5, 44, "Output",ExpressionUUID->"5b70f01b-9d42-4a19-a1ca-8c39f760dab9",
 CellTags->"Evaluation"],
Cell[555263, 14013, 1344, 25, 47, "Message",ExpressionUUID->"88f8481d-3d25-4c00-9152-a7f4b84a488b",
 CellTags->"Evaluation"],
Cell[556610, 14040, 305, 8, 47, "Output",ExpressionUUID->"0ed8f885-a490-41bd-bc3c-345e9f71a996",
 CellTags->"Evaluation"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[557000, 14057, 228, 4, 76, "Chapter",ExpressionUUID->"9a636fc2-d498-4319-80ef-14ed0a162393",
 CellTags->"Evaluation"],
Cell[CellGroupData[{
Cell[557253, 14065, 188, 3, 73, "Section",ExpressionUUID->"c5166301-41a3-4dfe-a676-ad3eb38406fd",
 CellTags->"Evaluation"],
Cell[557444, 14070, 3201, 84, 232, "Input",ExpressionUUID->"5d8a13e1-6fe7-4b7c-ac02-33c32d8f05a3",
 CellTags->"Evaluation"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[560694, 14160, 223, 4, 76, "Chapter",ExpressionUUID->"2f10beda-a98e-47ce-9b25-6d5b2e9fb0bb",
 CellTags->"Evaluation"],
Cell[CellGroupData[{
Cell[560942, 14168, 188, 3, 73, "Section",ExpressionUUID->"3242138f-40ad-4247-a5df-a2c5fd3b5d6b",
 CellTags->"Evaluation"],
Cell[561133, 14173, 3592, 92, 251, "Input",ExpressionUUID->"8d58ff6f-3146-4e5b-93dd-e4eae55647ba",
 CellTags->"Evaluation"]
}, Open  ]],
Cell[CellGroupData[{
Cell[564762, 14270, 205, 3, 73, "Section",ExpressionUUID->"c612d41a-c2ca-437f-aa92-cc3f13f94bcc",
 CellTags->"Evaluation"],
Cell[CellGroupData[{
Cell[564992, 14277, 279, 4, 61, "Subsection",ExpressionUUID->"b35bbc0d-1a12-4b76-9979-036733dfba57",
 CellTags->"Evaluation"],
Cell[565274, 14283, 8451, 217, 422, "Input",ExpressionUUID->"af1793a9-c991-4eb5-bb7b-068722ea5e83",
 CellTags->"Evaluation"]
}, Open  ]],
Cell[CellGroupData[{
Cell[573762, 14505, 294, 5, 61, "Subsection",ExpressionUUID->"66f54253-4a11-4da9-92bf-5b4a170d0c9c",
 CellTags->"Evaluation"],
Cell[574059, 14512, 16720, 384, 765, "Input",ExpressionUUID->"888ea411-eb05-433d-82af-9b42dc20abe5",
 CellTags->"Evaluation"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[590840, 14903, 362, 9, 76, "Chapter",ExpressionUUID->"0c16d797-cf97-45d5-a5da-b7b1cf6d99d3",
 CellTags->"Evaluation"],
Cell[CellGroupData[{
Cell[591227, 14916, 188, 3, 73, "Section",ExpressionUUID->"22ac6846-672b-4d66-9cfa-1e19aad1e49d",
 CellTags->"Evaluation"],
Cell[591418, 14921, 4024, 98, 321, "Input",ExpressionUUID->"0923bf32-7001-48e0-b6cc-8caa6b1a676a",
 CellTags->"Evaluation"]
}, Open  ]],
Cell[CellGroupData[{
Cell[595479, 15024, 205, 3, 73, "Section",ExpressionUUID->"6f4c2c05-ba47-4584-a3a8-5975da8e7acd",
 CellTags->"Evaluation"],
Cell[CellGroupData[{
Cell[595709, 15031, 279, 4, 61, "Subsection",ExpressionUUID->"eddd0b80-7620-4305-bdc4-6d501e9ea0d1",
 CellTags->"Evaluation"],
Cell[595991, 15037, 7874, 218, 574, "Input",ExpressionUUID->"9a3e14c8-a701-4a7b-bd5e-079830f196e6",
 CellTags->"Evaluation"]
}, Open  ]],
Cell[CellGroupData[{
Cell[603902, 15260, 294, 5, 61, "Subsection",ExpressionUUID->"bd015ad4-8be9-47db-97c8-e1ef0e8bd304",
 CellTags->"Evaluation"],
Cell[604199, 15267, 4015, 101, 325, "Input",ExpressionUUID->"44f080a3-313f-4151-85aa-82221d6fcc7f",
 CellTags->"Evaluation"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[608275, 15375, 227, 4, 76, "Chapter",ExpressionUUID->"b06bae0d-0042-4908-8c65-fa53403402b2",
 CellTags->"Evaluation"],
Cell[CellGroupData[{
Cell[608527, 15383, 188, 3, 73, "Section",ExpressionUUID->"87dbf68c-da68-49fd-aa77-8727e25def3f",
 CellTags->"Evaluation"],
Cell[608718, 15388, 5570, 123, 257, "Input",ExpressionUUID->"e1ed0d49-9570-4820-b744-0bdb07787dba",
 CellTags->"Evaluation"]
}, Open  ]],
Cell[CellGroupData[{
Cell[614325, 15516, 544, 11, 74, "Section",ExpressionUUID->"b97b4e66-c521-4117-8848-be907144e732",
 CellTags->"Evaluation"],
Cell[CellGroupData[{
Cell[614894, 15531, 2002, 53, 159, "Input",ExpressionUUID->"e9469ab9-0236-4da8-981e-4f96c1d0f893",
 CellTags->"Evaluation"],
Cell[616899, 15586, 499, 14, 62, "Output",ExpressionUUID->"e1efcd43-45e8-471c-aa88-c6c234cd6788",
 CellTags->"Evaluation"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[617447, 15606, 201, 3, 73, "Section",ExpressionUUID->"cc2312ac-4e04-4612-9e6b-593fe31948b9",
 CellTags->"Evaluation"],
Cell[CellGroupData[{
Cell[617673, 15613, 189, 3, 61, "Subsection",ExpressionUUID->"346ee184-7723-44c1-b589-5bb27d0a63ef",
 CellTags->"Evaluation"],
Cell[617865, 15618, 3925, 103, 358, "Input",ExpressionUUID->"fbde88eb-bc2d-4ac9-a0dd-e946ef2c3168",
 CellTags->"Evaluation"]
}, Open  ]],
Cell[CellGroupData[{
Cell[621827, 15726, 207, 3, 61, "Subsection",ExpressionUUID->"cb40b9db-653b-4159-a38b-7faabf033ced",
 CellTags->"Evaluation"],
Cell[CellGroupData[{
Cell[622059, 15733, 13628, 355, 1026, "Input",ExpressionUUID->"95b0b7c6-bc89-4a24-aed8-0f38fa0b1f5d",
 CellTags->"Evaluation"],
Cell[635690, 16090, 316, 7, 33, "Print",ExpressionUUID->"b2c50bb1-78a2-4b29-b7a8-c815c814fe95",
 CellTags->"Evaluation"],
Cell[636009, 16099, 679, 22, 66, "Output",ExpressionUUID->"47ba5612-5e44-4d09-ab6c-f99e2fb7ae9b",
 CellTags->"Evaluation"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[636761, 16129, 176, 3, 76, "Chapter",ExpressionUUID->"6abe80dc-cac1-4951-a70c-ab85c8903212",
 CellTags->"Evaluation"],
Cell[CellGroupData[{
Cell[636962, 16136, 188, 3, 73, "Section",ExpressionUUID->"4f876c3d-1254-4870-97d6-e76e6b07ff3f",
 CellTags->"Evaluation"],
Cell[637153, 16141, 3582, 92, 219, "Input",ExpressionUUID->"6daf334b-bcc0-4439-b3da-8dbd64e4d545",
 CellTags->"Evaluation"]
}, Open  ]],
Cell[CellGroupData[{
Cell[640772, 16238, 202, 3, 73, "Section",ExpressionUUID->"4564a7c0-aa3b-445e-81ec-851b73c8ebfb",
 CellTags->"Evaluation"],
Cell[CellGroupData[{
Cell[640999, 16245, 366, 10, 63, "Subsection",ExpressionUUID->"eeca7a08-c73f-42d8-a8cd-007897690c92",
 CellTags->"Evaluation"],
Cell[641368, 16257, 5786, 153, 301, "Input",ExpressionUUID->"6c06cb31-19e9-4bf7-8220-6ba1b3081bb2",
 CellTags->"Evaluation"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[647215, 16417, 187, 3, 76, "Chapter",ExpressionUUID->"3fa2b705-4843-44b9-81de-a4a582e96a5b",
 CellTags->"Evaluation"],
Cell[CellGroupData[{
Cell[647427, 16424, 202, 3, 73, "Section",ExpressionUUID->"b447eeb3-44b8-4ee7-a162-5aca9ea00874",
 CellTags->"Evaluation"],
Cell[647632, 16429, 10290, 252, 856, "Input",ExpressionUUID->"bedfb77e-9a79-45eb-a4fb-5477f78b7dda",
 CellTags->"Evaluation"]
}, Open  ]],
Cell[CellGroupData[{
Cell[657959, 16686, 255, 4, 73, "Section",ExpressionUUID->"4284abbf-6507-47bb-af57-77152272f71f",
 CellTags->"Evaluation"],
Cell[CellGroupData[{
Cell[658239, 16694, 11869, 264, 940, "Input",ExpressionUUID->"ce721738-ca6a-40b8-920b-aaf912e39c22",
 CellTags->"Evaluation"],
Cell[670111, 16960, 306, 7, 33, "Print",ExpressionUUID->"126c85d9-072b-4783-b558-ea9f91a77c14",
 CellTags->"Evaluation"],
Cell[670420, 16969, 13583, 289, 1323, "Output",ExpressionUUID->"51f0b98c-7f8c-46ec-880c-e3b2c8cac0b8",
 CellTags->"Evaluation"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[684076, 17266, 425, 6, 101, "Title",ExpressionUUID->"745366ac-d59b-4ddb-b8ff-34a888539c66",
 CellTags->"Evaluation"],
Cell[CellGroupData[{
Cell[684526, 17276, 392, 6, 76, "Chapter",ExpressionUUID->"60e6b013-89b6-4931-8d1e-85654302cfde",
 CellTags->"Evaluation"],
Cell[CellGroupData[{
Cell[684943, 17286, 376, 8, 73, "Section",ExpressionUUID->"9fab6c33-4c62-41ba-93ab-0c39e3261114",
 CellTags->"Evaluation"],
Cell[CellGroupData[{
Cell[685344, 17298, 230, 4, 61, "Subsection",ExpressionUUID->"2031739c-957f-45b9-906c-9275efa46dd4",
 CellTags->"Evaluation"],
Cell[CellGroupData[{
Cell[685599, 17306, 9965, 243, 784, "Input",ExpressionUUID->"529007c0-1e37-442a-b393-824254dc20bf",
 CellTags->"Evaluation"],
Cell[695567, 17551, 287, 7, 42, "Output",ExpressionUUID->"a13d4f85-9be4-4284-b645-10f415769c53",
 CellTags->"Evaluation"],
Cell[695857, 17560, 325, 7, 33, "Print",ExpressionUUID->"34c09bca-6830-4b57-9f40-e9649c03f098",
 CellTags->"Evaluation"],
Cell[696185, 17569, 8245, 132, 230, "Output",ExpressionUUID->"4b8a9453-048d-4a42-8c1d-b40a9434cbcd",
 CellTags->"Evaluation"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[704479, 17707, 179, 3, 61, "Subsection",ExpressionUUID->"d01d56eb-8108-44d6-a33d-d966ebb2ff93",
 CellTags->"Evaluation"],
Cell[CellGroupData[{
Cell[704683, 17714, 462, 12, 53, "Subsubsection",ExpressionUUID->"b675334d-c2db-4331-8cc4-db8d7e72ed56",
 CellTags->"Evaluation"],
Cell[705148, 17728, 8824, 240, 436, "Input",ExpressionUUID->"3833a449-84e5-4bfe-98f1-7f94cf51d80b",
 CellTags->"Evaluation"]
}, Open  ]],
Cell[CellGroupData[{
Cell[714009, 17973, 199, 3, 53, "Subsubsection",ExpressionUUID->"16977a76-d291-4155-8cc8-6ffad80b8c7e",
 CellTags->"Evaluation"],
Cell[CellGroupData[{
Cell[714233, 17980, 34080, 786, 2330, "Input",ExpressionUUID->"7385994f-8eee-4fd5-9f1f-28cba2f65c54",
 CellTags->"Evaluation"],
Cell[748316, 18768, 27860, 517, 69, "Output",ExpressionUUID->"8152cee4-4f9c-4517-a1a0-086433f23fba",
 CellTags->"Evaluation"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[776225, 19291, 261, 4, 53, "Subsubsection",ExpressionUUID->"503b0256-0c8a-4ff3-a0ad-953eabe8080a",
 CellTags->"Evaluation"],
Cell[776489, 19297, 14226, 330, 458, "Input",ExpressionUUID->"4d06c093-9a88-44d7-a919-51cf305457a2",
 CellTags->"Evaluation"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[790776, 19634, 181, 3, 73, "Section",ExpressionUUID->"f367f544-74c6-4b26-b14b-30abac03ef1d",
 CellTags->"Evaluation"],
Cell[CellGroupData[{
Cell[790982, 19641, 279, 4, 61, "Subsection",ExpressionUUID->"7d0ac78d-f6b5-454b-b41b-c56bc84fbc0b",
 CellTags->"Evaluation"],
Cell[CellGroupData[{
Cell[791286, 19649, 11106, 285, 846, "Input",ExpressionUUID->"87cd4ce0-fa9f-4740-b66b-ae761b233c32",
 CellTags->"Evaluation"],
Cell[802395, 19936, 473, 11, 39, "Message",ExpressionUUID->"af4951aa-4b0b-4392-a56a-9fa5339f3210",
 CellTags->"Evaluation"],
Cell[802871, 19949, 511, 10, 37, "Print",ExpressionUUID->"50f15b05-1d97-4a20-8410-937f85b9b2e5",
 CellTags->"Evaluation"],
Cell[803385, 19961, 259, 6, 55, "Output",ExpressionUUID->"165e6315-03ef-4c48-8e97-d4005a421e85",
 CellTags->"Evaluation"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[803693, 19973, 206, 3, 61, "Subsection",ExpressionUUID->"01958e91-c9fc-4d82-8a1a-4b6851ee4e54",
 CellTags->"Evaluation"],
Cell[CellGroupData[{
Cell[803924, 19980, 10074, 218, 755, "Input",ExpressionUUID->"2578dee9-aa07-401c-913e-4b52d3ad8240",
 CellTags->"Evaluation"],
Cell[814001, 20200, 16105, 311, 69, "Output",ExpressionUUID->"9403ae91-cc6b-4846-bb9c-09ba9af279b5",
 CellTags->"Evaluation"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[830155, 20517, 228, 3, 61, "Subsection",ExpressionUUID->"aea5f4a7-7e80-4ef3-8261-fdf5a582ee77",
 CellTags->"Evaluation"],
Cell[CellGroupData[{
Cell[830408, 20524, 224, 3, 53, "Subsubsection",ExpressionUUID->"906a3cc7-4794-4d81-918a-9042ea7865fe",
 CellTags->"Evaluation"],
Cell[830635, 20529, 6782, 159, 556, "Input",ExpressionUUID->"6170bea7-0a36-4d2c-bd34-0673a1930274",
 CellTags->"Evaluation"]
}, Open  ]],
Cell[CellGroupData[{
Cell[837454, 20693, 245, 5, 53, "Subsubsection",ExpressionUUID->"4896fb44-7b77-4532-961a-3e71ba936caf",
 CellTags->"Evaluation"],
Cell[837702, 20700, 12245, 277, 1086, "Input",ExpressionUUID->"0591216c-b934-4ffa-9068-f81bf8ac5919",
 CellTags->"Evaluation"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[850020, 20985, 328, 5, 76, "Chapter",ExpressionUUID->"6ce9c6c5-267f-4281-845d-ee1e4a6f158c",
 CellTags->"Evaluation"],
Cell[CellGroupData[{
Cell[850373, 20994, 267, 4, 73, "Section",ExpressionUUID->"f7ce7329-1054-402b-ae07-4c91d94bf548",
 CellTags->"Evaluation"],
Cell[850643, 21000, 34743, 867, 1780, "Input",ExpressionUUID->"7c16f4a4-bc39-49f2-ab99-395d54db6c27",
 CellTags->"Evaluation"]
}, Open  ]],
Cell[CellGroupData[{
Cell[885423, 21872, 259, 4, 73, "Section",ExpressionUUID->"89946c5d-55e9-4d17-a3a2-ef3d9bb45859",
 CellTags->"Evaluation"],
Cell[885685, 21878, 9611, 209, 623, "Input",ExpressionUUID->"4f46895f-6a27-4874-8c29-66bdff8b71bf",
 CellTags->"Evaluation"],
Cell[CellGroupData[{
Cell[895321, 22091, 179, 3, 61, "Subsection",ExpressionUUID->"06943df8-4649-4c77-acb4-efe84a4c9e80",
 CellTags->"Evaluation"],
Cell[895503, 22096, 23752, 571, 1446, "Input",ExpressionUUID->"0ab61bf6-daa3-40e8-acb6-496831dff47c",
 CellTags->"Evaluation"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[919316, 22674, 245, 4, 76, "Chapter",ExpressionUUID->"b2f8440f-0c01-4955-ba05-493e98af5200",
 CellTags->"Evaluation"],
Cell[CellGroupData[{
Cell[919586, 22682, 571, 15, 74, "Section",ExpressionUUID->"125727f8-06b9-47fc-a1af-4d0d283d5432",
 CellTags->"Evaluation"],
Cell[920160, 22699, 18653, 433, 1204, "Input",ExpressionUUID->"da44903f-05ef-4242-b267-549f4284480a",
 CellTags->"Evaluation"]
}, Open  ]],
Cell[CellGroupData[{
Cell[938850, 23137, 571, 15, 74, "Section",ExpressionUUID->"12b0e6e0-df96-4812-a894-224449fc0ed6",
 CellTags->"Evaluation"],
Cell[939424, 23154, 18248, 395, 1327, "Input",ExpressionUUID->"56819cf5-9a3b-4ba2-ae85-c810358c19fd",
 CellTags->"Evaluation"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[957721, 23555, 247, 4, 76, "Chapter",ExpressionUUID->"853db63b-6868-4690-a70f-51ee3f3c9d64",
 CellTags->"Evaluation"],
Cell[957971, 23561, 6753, 152, 493, "Input",ExpressionUUID->"4028c5b9-b1a4-4cea-8fa0-6a2cb8751f66",
 CellTags->"Evaluation"]
}, Open  ]],
Cell[CellGroupData[{
Cell[964761, 23718, 222, 3, 76, "Chapter",ExpressionUUID->"ede618e1-db1f-4052-9341-3ad98669ba20",
 CellTags->"Evaluation"],
Cell[964986, 23723, 9003, 216, 752, "Input",ExpressionUUID->"1b07e271-afb1-4157-a0b3-9451e6471051",
 CellTags->"Evaluation"]
}, Open  ]],
Cell[CellGroupData[{
Cell[974026, 23944, 268, 4, 76, "Chapter",ExpressionUUID->"af9d6ef0-a707-4b09-bb51-ae1bcb296b9c",
 CellTags->"Evaluation"],
Cell[974297, 23950, 9999, 245, 701, "Input",ExpressionUUID->"7101a228-73dd-406a-8181-affd5068b625",
 CellTags->"Evaluation"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[984345, 24201, 432, 7, 101, "Title",ExpressionUUID->"a71a0f7a-e822-4051-8bff-ebc5c2c75f52",
 CellTags->"Evaluation"],
Cell[CellGroupData[{
Cell[984802, 24212, 235, 4, 76, "Chapter",ExpressionUUID->"775189f9-9eab-4b5c-a388-a430aebaaeea",
 CellTags->"Evaluation"],
Cell[985040, 24218, 10902, 276, 903, "Input",ExpressionUUID->"bcd78e34-e5dd-47ca-ac7c-801c6238170a",
 CellTags->"Evaluation"]
}, Open  ]],
Cell[CellGroupData[{
Cell[995979, 24499, 246, 4, 76, "Chapter",ExpressionUUID->"ca953807-2e9a-48d4-a863-7393320df9ea",
 CellTags->"Evaluation"],
Cell[CellGroupData[{
Cell[996250, 24507, 6584, 149, 679, "Input",ExpressionUUID->"adc76db4-8a20-4f83-b656-3220b99a5305",
 CellTags->"Evaluation"],
Cell[1002837, 24658, 295, 6, 33, "Print",ExpressionUUID->"6e7bf31a-e69c-4e2e-9534-1871757db46e",
 CellTags->"Evaluation"],
Cell[1003135, 24666, 622, 13, 42, "Output",ExpressionUUID->"8cd6410d-8300-4302-8636-a9a33024affc",
 CellTags->"Evaluation"],
Cell[1003760, 24681, 288, 6, 33, "Print",ExpressionUUID->"53590713-f496-4553-8f74-05fe709b709c",
 CellTags->"Evaluation"],
Cell[1004051, 24689, 237, 5, 42, "Output",ExpressionUUID->"4aa8004d-d70e-4a85-b40e-d546b3e7f202",
 CellTags->"Evaluation"],
Cell[1004291, 24696, 283, 6, 33, "Print",ExpressionUUID->"e49251f3-2352-466d-abf6-383b9cde7475",
 CellTags->"Evaluation"],
Cell[1004577, 24704, 237, 5, 42, "Output",ExpressionUUID->"55d0a94c-d0ca-4f5c-a6e4-4c70b3f05fc4",
 CellTags->"Evaluation"],
Cell[1004817, 24711, 305, 7, 33, "Print",ExpressionUUID->"b5bf56b2-d115-4df1-b36d-a5596f4a8fd0",
 CellTags->"Evaluation"],
Cell[1005125, 24720, 398, 11, 53, "Output",ExpressionUUID->"565aebaf-e8e7-4d93-9f33-915210fd5fb5",
 CellTags->"Evaluation"],
Cell[1005526, 24733, 641, 14, 39, "Message",ExpressionUUID->"9f541da3-e618-41d1-a503-43e7c9a8c7df",
 CellTags->"Evaluation"],
Cell[1006170, 24749, 322, 7, 33, "Print",ExpressionUUID->"ef999b29-d5e0-4d3e-968a-6d92945e2076",
 CellTags->"Evaluation"],
Cell[1006495, 24758, 314, 9, 53, "Output",ExpressionUUID->"4fba07d8-df0b-4e08-9a71-0dec39a6e191",
 CellTags->"Evaluation"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[1006858, 24773, 231, 4, 76, "Chapter",ExpressionUUID->"1d42ed8a-55b1-48cd-be60-4ba46cd2ce8a",
 CellTags->"Evaluation"],
Cell[CellGroupData[{
Cell[1007114, 24781, 8453, 196, 655, "Input",ExpressionUUID->"ad17ac27-c9b6-4baf-b3e5-aa882d324cbd",
 CellTags->"Evaluation"],
Cell[1015570, 24979, 297, 6, 33, "Print",ExpressionUUID->"1dd983ac-6005-4d26-a165-dfc2dbf6d315",
 CellTags->"Evaluation"],
Cell[1015870, 24987, 524, 16, 42, "Output",ExpressionUUID->"a2ac2716-799d-4ad0-8af1-c9fa409db540",
 CellTags->"Evaluation"],
Cell[1016397, 25005, 536, 12, 39, "Message",ExpressionUUID->"276c5700-904f-4e4b-a1d6-a6ec74fbafee",
 CellTags->"Evaluation"],
Cell[1016936, 25019, 400, 11, 42, "Output",ExpressionUUID->"26287bb7-b1ad-43c6-bde5-972e5fee30a7",
 CellTags->"Evaluation"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[1017397, 25037, 182, 3, 88, "Title",ExpressionUUID->"16dd71f7-218e-4adb-aca8-cb8402969238"],
Cell[CellGroupData[{
Cell[1017604, 25044, 171, 3, 63, "Chapter",ExpressionUUID->"d853beda-46cd-4cdb-b135-6600d1bc9809"],
Cell[CellGroupData[{
Cell[1017800, 25051, 203, 4, 60, "Section",ExpressionUUID->"26118c4a-3748-4b3a-94d9-0f7a26888927"],
Cell[1018006, 25057, 4144, 89, 391, "Input",ExpressionUUID->"16f4dcfe-c8a3-4935-8eca-059c13300749"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1022187, 25151, 201, 4, 60, "Section",ExpressionUUID->"bf39957e-fd62-43f4-b298-e12ec728b564"],
Cell[1022391, 25157, 5034, 108, 493, "Input",ExpressionUUID->"982b5ac6-71df-482c-9725-30feba386bb6"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1027462, 25270, 199, 4, 60, "Section",ExpressionUUID->"e62f76e1-dd2d-4319-808f-0ff869601c12"],
Cell[1027664, 25276, 4206, 87, 410, "Input",ExpressionUUID->"d4bd6742-98f4-45d5-8243-7302c738d5e5"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1031907, 25368, 249, 4, 60, "Section",ExpressionUUID->"a8d16280-fc7b-406a-a959-809e0c08611c"],
Cell[1032159, 25374, 3605, 80, 372, "Input",ExpressionUUID->"40f16543-3a10-4025-b0f7-0072ee4d53aa"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1035801, 25459, 301, 5, 60, "Section",ExpressionUUID->"60385646-ad4d-4cf0-9045-232461d61193"],
Cell[1036105, 25466, 7208, 158, 609, "Input",ExpressionUUID->"179d3ca4-a32c-444e-a3a3-15c09587ee50"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1043350, 25629, 356, 6, 60, "Section",ExpressionUUID->"c87b1f13-ed80-4ea5-aba8-54fc50e487cb"],
Cell[1043709, 25637, 5197, 112, 433, "Input",ExpressionUUID->"8febb02f-a209-49e2-a75d-467370f83e9b"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[1048955, 25755, 324, 5, 63, "Chapter",ExpressionUUID->"3c746fb7-6e36-4915-8879-cad74039dfaa"],
Cell[CellGroupData[{
Cell[1049304, 25764, 308, 5, 59, "Section",ExpressionUUID->"1714effd-fdc0-455a-9663-ecf54047feb5"],
Cell[1049615, 25771, 2681, 64, 228, "Input",ExpressionUUID->"f794f041-61cf-427a-ba7e-5871cfd09877"]
}, Closed]],
Cell[CellGroupData[{
Cell[1052333, 25840, 212, 4, 47, "Section",ExpressionUUID->"e832b21a-40c0-4109-994d-ba51e4a25b79"],
Cell[1052548, 25846, 2887, 70, 228, "Input",ExpressionUUID->"d8654445-2591-457c-ac53-59248775fa97"]
}, Closed]],
Cell[CellGroupData[{
Cell[1055472, 25921, 213, 4, 47, "Section",ExpressionUUID->"67d456ee-bbcd-4d49-96ac-21b1fbf02c19"],
Cell[1055688, 25927, 2356, 61, 228, "Input",ExpressionUUID->"70364653-607b-4580-8af1-b8a08e851708"]
}, Closed]],
Cell[CellGroupData[{
Cell[1058081, 25993, 236, 4, 47, "Section",ExpressionUUID->"af3e18b1-0b62-4cf5-95e7-5dae8c11ec33"],
Cell[1058320, 25999, 2847, 65, 262, "Input",ExpressionUUID->"4d579646-0369-4c41-b5c7-51e11d533929"]
}, Closed]],
Cell[CellGroupData[{
Cell[1061204, 26069, 359, 6, 47, "Section",ExpressionUUID->"428b62d1-6456-489a-b805-3f6d1a2af3d3"],
Cell[1061566, 26077, 2892, 71, 208, "Input",ExpressionUUID->"c2a64537-63ec-41c5-af12-708801d08728"]
}, Closed]],
Cell[CellGroupData[{
Cell[1064495, 26153, 413, 6, 47, "Section",ExpressionUUID->"010a69df-5572-4d9c-9c11-15b9580959c8"],
Cell[1064911, 26161, 3474, 88, 249, "Input",ExpressionUUID->"adcd37db-f9ea-46f5-8d82-a679b8a37295"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[1068434, 26255, 424, 7, 53, "Chapter",ExpressionUUID->"44a588f4-ac3c-4868-9adc-df21a540965e"],
Cell[CellGroupData[{
Cell[1068883, 26266, 152, 3, 59, "Section",ExpressionUUID->"a8197812-02ef-4756-9aca-2cbb0f54c041"],
Cell[1069038, 26271, 2316, 60, 249, "Input",ExpressionUUID->"6d14c362-9b35-4e0a-81ba-5dd6583753e5"]
}, Closed]],
Cell[CellGroupData[{
Cell[1071391, 26336, 174, 3, 59, "Section",ExpressionUUID->"6d2cac28-5a86-4d7e-8e88-d4e31e8cabe4"],
Cell[1071568, 26341, 2342, 60, 247, "Input",ExpressionUUID->"0a504073-ea7c-4639-b415-5a80571a8059"]
}, Closed]],
Cell[CellGroupData[{
Cell[1073947, 26406, 152, 3, 59, "Section",ExpressionUUID->"fee03952-7996-482c-baca-9ba7f86eb782"],
Cell[1074102, 26411, 2702, 70, 215, "Input",ExpressionUUID->"ae48d8e9-dbb5-4199-b93a-79c8587eacf3"]
}, Closed]],
Cell[CellGroupData[{
Cell[1076841, 26486, 155, 3, 59, "Section",ExpressionUUID->"78852c84-b7b2-43c7-9d00-eded9c82a903"],
Cell[1076999, 26491, 2785, 71, 232, "Input",ExpressionUUID->"73613ab9-1a32-4c06-a437-d2d5a1e0a9f8"]
}, Closed]],
Cell[CellGroupData[{
Cell[1079821, 26567, 152, 3, 59, "Section",ExpressionUUID->"3d664a96-e56f-4964-b4e6-954083817918"],
Cell[1079976, 26572, 2666, 68, 215, "Input",ExpressionUUID->"ea97491a-c467-40cd-aad0-4e395f20ad06"]
}, Closed]],
Cell[CellGroupData[{
Cell[1082679, 26645, 156, 3, 59, "Section",ExpressionUUID->"6a0f58bd-44b1-402e-be7a-a6098d415606"],
Cell[1082838, 26650, 2675, 68, 215, "Input",ExpressionUUID->"bd523f4c-a69c-4d9a-aa45-bb914d906c33"]
}, Closed]],
Cell[CellGroupData[{
Cell[1085550, 26723, 158, 3, 59, "Section",ExpressionUUID->"8fd04a6c-a6bd-4e55-afdb-03712e9df8cb"],
Cell[1085711, 26728, 2600, 67, 215, "Input",ExpressionUUID->"6f957d25-6dec-4af9-a685-15a21b940d65"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[1088360, 26801, 421, 7, 53, "Chapter",ExpressionUUID->"e18f2a4f-1511-4779-87a6-46fa379f64bc"],
Cell[CellGroupData[{
Cell[1088806, 26812, 237, 4, 60, "Section",ExpressionUUID->"3867b48b-b17b-4056-8c33-23d5dcd435ac"],
Cell[CellGroupData[{
Cell[1089068, 26820, 3472, 87, 340, "Input",ExpressionUUID->"89f2fc85-2fb9-4bc8-b97e-5a8f182395aa"],
Cell[1092543, 26909, 511, 12, 70, "Message",ExpressionUUID->"ff26d495-9f11-471d-89f4-e217d0208685"],
Cell[1093057, 26923, 513, 12, 70, "Message",ExpressionUUID->"4477a153-e295-42e1-aff7-c13727623d50"],
Cell[1093573, 26937, 511, 12, 70, "Message",ExpressionUUID->"054b17ce-6807-44f6-beee-724e663e662d"],
Cell[1094087, 26951, 511, 12, 70, "Message",ExpressionUUID->"2c21d4d4-6425-45a3-8672-8a5fc1646a9c"],
Cell[1094601, 26965, 511, 12, 70, "Message",ExpressionUUID->"7ce4e0aa-a971-4d7f-b7c9-35f72fd4323e"],
Cell[1095115, 26979, 511, 12, 70, "Message",ExpressionUUID->"3439519a-c5c1-497d-a9ed-008d51935043"],
Cell[1095629, 26993, 511, 12, 70, "Message",ExpressionUUID->"984ded1b-4346-4852-8507-33b95501c8b6"],
Cell[1096143, 27007, 511, 12, 70, "Message",ExpressionUUID->"8693bfc1-b800-44cf-bbbd-4875abf81bfb"],
Cell[1096657, 27021, 513, 12, 70, "Message",ExpressionUUID->"3ac65254-99bd-4bc8-9558-58031e7f2ae4"],
Cell[1097173, 27035, 516, 13, 70, "Message",ExpressionUUID->"1ade5be9-0038-48db-85f6-94b97f7d481e"],
Cell[1097692, 27050, 241, 6, 70, "Output",ExpressionUUID->"10a539e6-3afd-4f56-8906-6ea6cd830a5c"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[1097982, 27062, 204, 4, 48, "Section",ExpressionUUID->"4f8a695c-eca1-427a-b0b3-29376ac24f12"],
Cell[CellGroupData[{
Cell[1098211, 27070, 2706, 69, 289, "Input",ExpressionUUID->"ea2d17b1-6832-4c8b-83b7-de080d51ce24"],
Cell[1100920, 27141, 240, 6, 70, "Output",ExpressionUUID->"03fcd51c-dcfe-4787-b8c8-2a6dc5169e3c"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[1101209, 27153, 201, 4, 48, "Section",ExpressionUUID->"21268ba0-af89-46ad-8db8-c2c852874af8"],
Cell[CellGroupData[{
Cell[1101435, 27161, 2686, 70, 289, "Input",ExpressionUUID->"4043af29-8297-4ae9-b68b-a7ac8ba30063"],
Cell[1104124, 27233, 239, 6, 70, "Output",ExpressionUUID->"cb336005-fd08-4152-83e6-6df51ee1d0a7"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[1104412, 27245, 206, 4, 48, "Section",ExpressionUUID->"b637261e-5f38-43f1-9aed-21ea0fffb69b"],
Cell[CellGroupData[{
Cell[1104643, 27253, 2707, 70, 289, "Input",ExpressionUUID->"b844b0c2-dda3-490f-942a-5905a10479e9"],
Cell[1107353, 27325, 241, 6, 70, "Output",ExpressionUUID->"195ad73b-c093-400e-9471-6dae2e02109a"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[1107643, 27337, 203, 4, 48, "Section",ExpressionUUID->"967b5acc-e7f2-4620-8c96-0a4eee9552a8"],
Cell[CellGroupData[{
Cell[1107871, 27345, 2909, 67, 308, "Input",ExpressionUUID->"fe6abf7a-2c18-4e14-b9cd-14aa6668723d"],
Cell[1110783, 27414, 243, 6, 70, "Output",ExpressionUUID->"b1a7c303-df76-4c04-a254-ad132067f39e"]
}, Closed]]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[1111087, 27427, 424, 7, 63, "Chapter",ExpressionUUID->"3b4a9075-fad5-4efb-849a-40a2956706d2"],
Cell[CellGroupData[{
Cell[1111536, 27438, 313, 5, 59, "Section",ExpressionUUID->"9ea85647-f1d7-4f09-a601-da12fb44b8ef"],
Cell[1111852, 27445, 3237, 84, 249, "Input",ExpressionUUID->"e9394e5b-bf3e-4732-80cb-d39e2fa391f2"]
}, Closed]],
Cell[CellGroupData[{
Cell[1115126, 27534, 229, 4, 47, "Section",ExpressionUUID->"866a930d-597a-473f-862c-6fa7797d2c83"],
Cell[1115358, 27540, 2726, 69, 215, "Input",ExpressionUUID->"c3bf300a-ccec-49c2-aa85-3ef28ffabb70"]
}, Closed]],
Cell[CellGroupData[{
Cell[1118121, 27614, 228, 4, 47, "Section",ExpressionUUID->"27be1a7b-e612-47cb-9ea9-3e73d1671ee4"],
Cell[1118352, 27620, 2706, 70, 215, "Input",ExpressionUUID->"aa49fc9f-5adf-4e72-94d6-2273fe505797"]
}, Closed]],
Cell[CellGroupData[{
Cell[1121095, 27695, 233, 4, 47, "Section",ExpressionUUID->"6ccbb58c-dd0b-472e-bb46-90b01b770aa9"],
Cell[1121331, 27701, 2710, 70, 232, "Input",ExpressionUUID->"51450d53-ee3f-4422-b599-c31e2eaf5c2f"]
}, Closed]],
Cell[CellGroupData[{
Cell[1124078, 27776, 205, 4, 47, "Section",ExpressionUUID->"0ef1c7c2-06ef-4d81-845e-3983b61efba3"],
Cell[1124286, 27782, 2804, 66, 262, "Input",ExpressionUUID->"acff3d38-7a8c-45d5-9977-20883682e854"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[1127139, 27854, 473, 7, 53, "Chapter",ExpressionUUID->"16388e30-af43-4624-ad00-20b41052f8aa"],
Cell[CellGroupData[{
Cell[1127637, 27865, 313, 5, 67, "Section",ExpressionUUID->"50a92348-8403-4363-98ab-e5dd7560ed07"],
Cell[1127953, 27872, 3253, 84, 276, "Input",ExpressionUUID->"b57d46d6-4872-48c1-aeef-b23173da4c28"]
}, Closed]],
Cell[CellGroupData[{
Cell[1131243, 27961, 256, 4, 67, "Section",ExpressionUUID->"0d0c22a9-328c-4164-94e4-3e8854d55fbb"],
Cell[1131502, 27967, 2726, 69, 238, "Input",ExpressionUUID->"43fa2da4-0967-46af-af2f-9ff96e4fdaa7"]
}, Closed]],
Cell[CellGroupData[{
Cell[1134265, 28041, 253, 4, 67, "Section",ExpressionUUID->"8ffc3357-2f61-4e66-8cf8-71764a5f1082"],
Cell[1134521, 28047, 2707, 70, 196, "Input",ExpressionUUID->"51d3fcfa-7b15-4d6b-8f4f-a72f60d9fcc1"]
}, Closed]],
Cell[CellGroupData[{
Cell[1137265, 28122, 260, 4, 53, "Section",ExpressionUUID->"49dc79fb-3a86-4373-b3d0-ec141cc7652c"],
Cell[1137528, 28128, 2716, 70, 196, "Input",ExpressionUUID->"c1cc08d3-9289-433a-b7b1-07100126d508"]
}, Closed]],
Cell[CellGroupData[{
Cell[1140281, 28203, 232, 4, 53, "Section",ExpressionUUID->"4a43cdfb-c5c6-4bf6-9c43-0ebc120a467f"],
Cell[1140516, 28209, 2684, 64, 197, "Input",ExpressionUUID->"836b6ebf-9b2e-46b8-ab59-bb966e22fcd6"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[1143249, 28279, 531, 8, 53, "Chapter",ExpressionUUID->"ca0169e1-1506-4920-a654-c36523988742"],
Cell[CellGroupData[{
Cell[1143805, 28291, 323, 5, 59, "Section",ExpressionUUID->"0e636e28-9cd5-40f7-afc1-5285012e8b6c"],
Cell[1144131, 28298, 3240, 84, 249, "Input",ExpressionUUID->"bd211e6c-fc57-4dbc-9c4d-02c6cfe43c86"]
}, Closed]],
Cell[CellGroupData[{
Cell[1147408, 28387, 264, 4, 59, "Section",ExpressionUUID->"8bfb98bf-4268-47d3-9b34-445fa8bde8ef"],
Cell[1147675, 28393, 2741, 70, 196, "Input",ExpressionUUID->"4a8dab22-c56e-4595-9b4f-0089f8167f8a"]
}, Closed]],
Cell[CellGroupData[{
Cell[1150453, 28468, 261, 4, 47, "Section",ExpressionUUID->"eac7d75d-30e9-45e5-9479-d0cff64fefea"],
Cell[1150717, 28474, 2721, 71, 196, "Input",ExpressionUUID->"323a8d6f-ddd0-405e-aa34-26f7aee6b570"]
}, Closed]],
Cell[CellGroupData[{
Cell[1153475, 28550, 266, 4, 47, "Section",ExpressionUUID->"c98fa74f-d7e5-45dd-bb1d-30973e1d1342"],
Cell[1153744, 28556, 2723, 71, 196, "Input",ExpressionUUID->"bf0636f4-70cc-4ec2-97cc-d8cb2e56c225"]
}, Closed]],
Cell[CellGroupData[{
Cell[1156504, 28632, 259, 4, 47, "Section",ExpressionUUID->"1a68ad9f-77c8-42d6-89e6-c9bad98d3783"],
Cell[1156766, 28638, 2669, 65, 197, "Input",ExpressionUUID->"3a5bd2e6-2cc8-4af6-bf58-733814264940"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[1159484, 28709, 481, 7, 53, "Chapter",ExpressionUUID->"eae968d8-5baa-42ac-a0db-10942f4085d7"],
Cell[CellGroupData[{
Cell[1159990, 28720, 321, 5, 59, "Section",ExpressionUUID->"424512e9-f719-4d07-94e6-c4bbf89ce856"],
Cell[1160314, 28727, 3238, 84, 249, "Input",ExpressionUUID->"9334e8af-383e-4e38-8282-b1f11c2f2232"]
}, Closed]],
Cell[CellGroupData[{
Cell[1163589, 28816, 262, 4, 59, "Section",ExpressionUUID->"28ab8c80-3963-4ee8-9f09-392e4b424d50"],
Cell[1163854, 28822, 2737, 70, 196, "Input",ExpressionUUID->"7bb4844f-f742-4ef6-aa35-568e65ac38cf"]
}, Closed]],
Cell[CellGroupData[{
Cell[1166628, 28897, 261, 4, 47, "Section",ExpressionUUID->"651189a8-2e51-4e02-9f8c-f6ed1e694eaf"],
Cell[1166892, 28903, 2720, 71, 196, "Input",ExpressionUUID->"7e49053e-10cf-446e-8dbc-62f07135b0de"]
}, Closed]],
Cell[CellGroupData[{
Cell[1169649, 28979, 266, 4, 47, "Section",ExpressionUUID->"7133dd8e-4b5f-4dd4-be24-7225ca87c5aa"],
Cell[1169918, 28985, 2726, 71, 196, "Input",ExpressionUUID->"cf1de428-c657-4783-a369-9b323e9bdc54"]
}, Closed]],
Cell[CellGroupData[{
Cell[1172681, 29061, 242, 4, 47, "Section",ExpressionUUID->"376807d7-c880-4710-bdc3-b0a2de4f7c05"],
Cell[1172926, 29067, 2669, 65, 197, "Input",ExpressionUUID->"7ad477aa-f875-4aba-b4e8-9d5a231c7213"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[1175644, 29138, 429, 7, 53, "Chapter",ExpressionUUID->"1ff679f7-11c2-47ef-a94a-5eaa4e1c27d3"],
Cell[CellGroupData[{
Cell[1176098, 29149, 333, 5, 59, "Section",ExpressionUUID->"dc38b62d-01b4-4a1b-b9f4-68ae754543a2"],
Cell[1176434, 29156, 2644, 67, 214, "Input",ExpressionUUID->"c5bc112b-779d-4417-a559-b057ff607c66"]
}, Closed]],
Cell[CellGroupData[{
Cell[1179115, 29228, 332, 5, 47, "Section",ExpressionUUID->"c3b0b688-7334-4095-9583-39aeb045e083"],
Cell[1179450, 29235, 2657, 69, 198, "Input",ExpressionUUID->"90617451-111e-4106-831c-e46b65fea4b9"]
}, Closed]],
Cell[CellGroupData[{
Cell[1182144, 29309, 337, 5, 47, "Section",ExpressionUUID->"53c9e46b-c0fb-4172-8bda-45896eb4142e"],
Cell[1182484, 29316, 3287, 73, 164, "Input",ExpressionUUID->"1ad078a1-636a-460a-8113-b8e2d575e180"]
}, Closed]],
Cell[CellGroupData[{
Cell[1185808, 29394, 342, 5, 47, "Section",ExpressionUUID->"407b885d-c528-4bb6-80ea-a5a1259d4b81"],
Cell[1186153, 29401, 3066, 75, 164, "Input",ExpressionUUID->"6e09d98e-c619-4b6d-bfca-c18434d55906"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[1189268, 29482, 428, 7, 53, "Chapter",ExpressionUUID->"c3df3bae-3a65-45c7-ad4d-5d271052cba7"],
Cell[CellGroupData[{
Cell[1189721, 29493, 255, 4, 59, "Section",ExpressionUUID->"693c69cb-91f9-4db0-95f2-dc2b419fd7d7"],
Cell[1189979, 29499, 2348, 59, 215, "Input",ExpressionUUID->"c05ccb26-07ab-4d09-936b-328762403958"]
}, Closed]],
Cell[CellGroupData[{
Cell[1192364, 29563, 257, 4, 59, "Section",ExpressionUUID->"1f53f8f3-a879-4e1d-a372-bcaa226efa05"],
Cell[1192624, 29569, 3997, 88, 301, "Input",ExpressionUUID->"5760f377-ef1a-47e2-bf65-7495a9037542"]
}, Closed]],
Cell[CellGroupData[{
Cell[1196658, 29662, 255, 4, 59, "Section",ExpressionUUID->"1af52a9e-a656-472e-b530-4596f963b740"],
Cell[1196916, 29668, 2760, 66, 232, "Input",ExpressionUUID->"e9bec580-02f3-4bc6-a250-d13e10d1e39f"]
}, Closed]],
Cell[CellGroupData[{
Cell[1199713, 29739, 257, 4, 59, "Section",ExpressionUUID->"5d2947c4-0896-4c48-b151-6a45530ca881"],
Cell[1199973, 29745, 2343, 60, 198, "Input",ExpressionUUID->"48e5dcdf-caa0-45ca-be10-758776392a16"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[1202365, 29811, 480, 7, 53, "Chapter",ExpressionUUID->"d7ca20cb-cb80-436a-9add-b8b38c9862f6"],
Cell[CellGroupData[{
Cell[1202870, 29822, 285, 5, 60, "Section",ExpressionUUID->"0e808307-80ae-4563-b2e0-3b8e43e4279e"],
Cell[1203158, 29829, 2441, 62, 276, "Input",ExpressionUUID->"51eea68e-2d3c-47dd-a198-8d99f331707d"]
}, Closed]],
Cell[CellGroupData[{
Cell[1205636, 29896, 287, 5, 48, "Section",ExpressionUUID->"348b1674-4f72-4a7d-9533-11f504ef8914"],
Cell[1205926, 29903, 3998, 92, 429, "Input",ExpressionUUID->"c0c26a68-b995-4c98-a6e8-e9fa0b27913a"]
}, Closed]],
Cell[CellGroupData[{
Cell[1209961, 30000, 285, 5, 48, "Section",ExpressionUUID->"477f463b-ec67-43b1-8c03-e849ec244ba0"],
Cell[1210249, 30007, 2758, 67, 289, "Input",ExpressionUUID->"a580770c-46cb-46a0-bba9-7b7f9a341ecb"]
}, Closed]],
Cell[CellGroupData[{
Cell[1213044, 30079, 287, 5, 48, "Section",ExpressionUUID->"4a52c497-be7d-43f9-a2b4-044115160167"],
Cell[1213334, 30086, 2373, 62, 270, "Input",ExpressionUUID->"1b8a3050-ca24-440d-9f67-f587aea93886"]
}, Closed]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[1215768, 30155, 169, 3, 88, "Title",ExpressionUUID->"357bb516-74b9-4f59-af92-4e8774ff06b1"],
Cell[1215940, 30160, 1738, 43, 112, "Input",ExpressionUUID->"a096c229-043c-45ad-9a4b-87df478e633b"]
}, Closed]]
}
]
*)

